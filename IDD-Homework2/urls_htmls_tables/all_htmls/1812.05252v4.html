<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1812.05252] Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering</title><meta property="og:description" content="Learning effective fusion of multi-modality features is at the heart of visual question answering. We propose a novel method of dynamically fusing multi-modal features with intra- and inter-modality information flow, w…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1812.05252">

<!--Generated on Sat Mar 16 07:16:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Dynamic Fusion with Intra- and Inter-modality Attention 
<br class="ltx_break">Flow for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Peng Gao<sup id="id1.1.id1" class="ltx_sup">1</sup>,  Zhengkai Jiang<sup id="id2.2.id2" class="ltx_sup">3</sup>,  Haoxuan You<sup id="id3.3.id3" class="ltx_sup">4</sup>,
<br class="ltx_break">Pan Lu<sup id="id4.4.id4" class="ltx_sup">4</sup>, Steven Hoi <sup id="id5.5.id5" class="ltx_sup">2</sup>, Xiaogang Wang <sup id="id6.6.id6" class="ltx_sup">1</sup>,  Hongsheng Li <sup id="id7.7.id7" class="ltx_sup">1</sup> 
<br class="ltx_break"><sup id="id8.8.id8" class="ltx_sup">1</sup>CUHK-SenseTime Joint Lab, The Chinese University of Hong Kong
<br class="ltx_break"><sup id="id9.9.id9" class="ltx_sup">2</sup>Singapore Management University  <sup id="id10.10.id10" class="ltx_sup">3</sup>NLPR, CASIA  <sup id="id11.11.id11" class="ltx_sup">4</sup>Tsinghua University
<br class="ltx_break">{<span id="id12.12.id12" class="ltx_text ltx_font_italic">1155102382@link, xgwang@ee, hsli@ee</span>}<span id="id13.13.id13" class="ltx_text ltx_font_italic">.cuhk.edu.hk
<br class="ltx_break"></span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Peng Gao<sup id="id14.1.id1" class="ltx_sup">1</sup>,  Zhengkai Jiang<sup id="id15.2.id2" class="ltx_sup">3</sup>,  Haoxuan You<sup id="id16.3.id3" class="ltx_sup">4</sup>,
<br class="ltx_break">Pan Lu<sup id="id17.4.id4" class="ltx_sup">4</sup>, Steven Hoi <sup id="id18.5.id5" class="ltx_sup">2</sup>, Xiaogang Wang <sup id="id19.6.id6" class="ltx_sup">1</sup>,  Hongsheng Li <sup id="id20.7.id7" class="ltx_sup">1</sup> 
<br class="ltx_break"><sup id="id21.8.id8" class="ltx_sup">1</sup>CUHK-SenseTime Joint Lab, The Chinese University of Hong Kong
<br class="ltx_break"><sup id="id22.9.id9" class="ltx_sup">2</sup>Singapore Management University  <sup id="id23.10.id10" class="ltx_sup">3</sup>NLPR, CASIA  <sup id="id24.11.id11" class="ltx_sup">4</sup>Tsinghua University
<br class="ltx_break">{<span id="id25.12.id12" class="ltx_text ltx_font_italic">1155102382@link, xgwang@ee, hsli@ee</span>}<span id="id26.13.id13" class="ltx_text ltx_font_italic">.cuhk.edu.hk
<br class="ltx_break"></span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id27.id1" class="ltx_p">Learning effective fusion of multi-modality features is at the heart of visual question answering. We propose a novel method of dynamically fusing multi-modal features with intra- and inter-modality information flow, which alternatively pass dynamic information between and across the visual and language modalities. It can robustly capture the high-level interactions
between language and vision domains, thus significantly improves the performance of visual
question answering. We also show that the proposed dynamic intra-modality attention flow conditioned on the other modality can
dynamically modulate the intra-modality attention of the target modality, which is vital for multimodality feature fusion. Experimental evaluations on the VQA 2.0 dataset show that the proposed method achieves state-of-the-art VQA performance. Extensive
ablation studies are carried out for the comprehensive analysis of the proposed method.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> aims at automatically answering a natural language question related to the contents of a given image.
It has extensive applications in practice, such as assisting blind people <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and education of young children,
and therefore become a hot research topic recently.
The performance of Visual Question Answering (VQA) has been substantially improved in recent years thanks to three lines of works.
Firstly, better visual and language feature representations are at the core for boosting VQA performance.
The feature learning capability from VGG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, FishNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> to the recent bottom-up &amp; top-down features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> increases
the VQA performance significantly.
Secondly, different variants of attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> can adaptively select important features which can help deep learning achieve better
recognition accuracy. Thirdly, better multi-modality fusion approaches, such Bilinear Fusion  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, MCB  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and
MUTAN  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, have been proposed
for better capturing the high-level interactions between language and visual features.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Despite being studied extensively, most existing VQA approaches focus on learning inter-modality relations between visual and language features.
Bilinear feature fusion approaches  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> focus on capturing the higher order relations between language and visual modalities
by feature outer product. Co-attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> or bilinear attention-based approaches  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
learn the inter-modality relations between
word-region pairs to identify key pairs for question answering. On the other hand, there exist computer vision and natural language
processing algorithms focusing on learning intra-modality relations. Hu <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S1.p2.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> proposed to explore intra-modality object-to-object
relations to boost object detection accuracy. Yao <em id="S1.p2.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S1.p2.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> modeled intra-modality object-to-object relations for improving image
captioning performance. In the recently proposed BERT algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> for natural language processing, intra-modality word relations
are modelled by self-attention mechanism to learn state-of-the-art word embedding.
However, the inter- and intra-modality relations were never jointly investigated in a unified framework for solving the VQA problem.
We argue that, for the VQA problem, the intra-modality relations within each modality is
complementary to the inter-modality relations, which were mostly ignored by existing VQA methods.
For instance, for the image modality, each image region should obtain information not only from its associate words/phrases in the question
but also from related image regions to infer the answer of the question.
For the question modality, better understanding of question can be acquired by inferring other words.
Such cases motivate us to propose a unified framework for modelling
both inter- and intra-modality information flow.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1812.05252/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="140" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">Illustration of the proposed Dynamic Fusion with Intra- and Inter-modality Attention Flow (DFAF) for visual question answering. Each DFAF module contains one Inter-Modality Attention Flow and one of Intra-Modality Attention Flow Module. Stacking several blocks of DFAF can help the network gradually focus on important image regions , question words and the latent alignments.</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To overcome the limitations, we propose a novel Dynamic Fusion with Intra- and Inter-modality Attention Flow (DFAF) framework for efficient
multi-modality feature fusion to accurately answer visual questions. The overall diagram is shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Our DFAF framework integrates cross-modal
self-attention and cross-modal co-attention mechanisms to achieve effective information flows within and between the image and
language modalities.
Given visual and question features encoded by deep neural networks, the DFAF framework first generates inter-modality
attention flow (InterMAF) to pass information between image and language.
In the InterMAF module, visual and language features generate
a joint-modality co-attention matrix.
Each visual region would select question features according to the joint-modality co-attention matrix and vice versa.
The InterMAF module fuses and updates each image region and each word’s features according to the attention-weighted
information flows from the other modality. Following the InterMAF module, DFAF calculates the dynamic intra-modality attention
flow (DyIntraMAF) for passing information flows within each modality to capture the complex intra-modality relations.
Visual regions and sentence words generate self-attention weights and aggregate attention-weighted information
from other instances in the same modality. More importantly, although the information are only propagated within
the same modalities, information of the other modality is considered and used to modulate intra-modality attention weights and flows.
With such an operation, the attention flows within each modality are dynamically conditioned on the other modality
and is the key difference compared with existing intra-modality
message passing methods on object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.
DyIntraMAF is shown to be substantially better than its
variant using only internal information for intra-modality
information flow and is the key to the success of the proposed framework.
We alternatively use InterMA and DyIntraMA modules to create the basic blocks of
the DFAF. Multiple stacks of DFAF blocks are shown to further improve the VQA performance.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our contributions can be summarized into threefold.
(1)
A novel Dynamic Fusion with Intra- and Inter-modality Attention Flow (DFAF) framework is proposed for multi-modality fusion by
interleaving intra- and inter-modality feature fusion. Such a framework for the first time integrates inter-modality
and dynamic intra-modality information flow in a unified framework for tackling the VQA task.
(2)
Dynamic Intra-modality Attention Flow (DyIntraMAF) module is proposed for generating effective attention
flows within each modality, which are dynamically conditioned on the information of the other modality. It is one of the core novelties of our proposed framework.
(3)
Extensive experiments and ablation studies are performed to examine the effectiveness of the proposed DFAF framework, in which state-of-the-art VQA performance is achieved by our proposed DFAF framework.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Representation learning for VQA.</span>
The recent boost of VQA performance is due to the success of deep representation learning.
In the early stage of VQA methods, the VGG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> network was commonly used. With the introduction of ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, the VQA community shift to ResNet networks, which outperform VGG by large margins. Recently, the bottom-up and top-down network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
derived from faster RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> are shown to be suitable for VQA and image captioning tasks. Feature learning is an essential component for the development of VQA algorithms.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Bilinear Fusion for VQA.</span>
Solving VQA requires understanding of visual and language contents as well as the relation between them. In early VQA methods, simple concatenation or
element-wise multiplication <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> between visual and language are used for cross-modal feature fusion.
To capture the high-level interactions between the two modalities, Bilinear Fusion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> has been proposed to adopt bilinear pooling to fuse features from the two modalities. To overcome the limitation of high computational cost of bilinear pooling, many approximated fusion methods, including
MCB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, MLB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> and MUTAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, were proposed, which have shown better performance than bilinear fusion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> with much fewer parameters.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Self-attention-based methods.</span>
The attention mechanism in deep learning tries to mimic how human vision works. By automatically ignoring irrelevant information from the data, neural networks can selectively focus on important features. This approach has achieved great success in Natural Language Processing (NLP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> and VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>. There are many variants of the attention mechanism.
Our approach are mainly motivated by self-attention and co-attention based methods. The self-attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> transforms features into query, key and value features. The attention matrix between different features are then calculated by the inner product of query and key features. After acquiring the attention matrix, features are aggregated as the attention-weighted summation of the original features. Motivated by the self-attention mechanism, many vision tasks’ performances were improved significantly. Non-local neural network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> proposed a non-local module for aggregating information between different frames within one video and achieved state-of-the-art performance in video classification. Relation Network learn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> the relationship between object proposals by adopting the self-attention mechanism. The in-place module can boost Faster RCNN  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and Non-Maximum-Suppression (NMS) performance.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Co-attention-based methods.</span>
The co-attention based <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> vision and language methods model the interactions across the two modalities.
For each word, every image region features are aggregated to the word according to the co-attention weights. The co-attention mechanism has been widely used in NLP and VQA tasks. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, Dense Symmetric Co-attention (DCN) has been proposed. It achieved state-of-the-art performances on VQAv1 and VQAv2 datasets without using any bottom-up and top-down features. The success of DCN is due to dense concatenation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> of symmetric co-attention.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p"><span id="S2.p5.1.1" class="ltx_text ltx_font_bold">Other works for language and vision tasks.</span>
Beyond above mentioned methods, many algorithms have also been proposed for fusion of cross-modal language and visual features.
Dynamic Parameter Prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and Question-guided Hybrid Convolution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
utilized dynamically predicted parameters for feature fusion. Adaptive attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> introduced a visual
sensual which can skip attention during image captioning. Structured attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> adopted the MRF model over attention maps for better modelling better spatial attention distributions. Locally weighted deformable neighbours <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> proposed to predict offset and modulation weight.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Dynamic Fusion with Intra- and Inter-modality Attention Flow for VQA</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The proposed approach consists of a series of DFAF modules. The whole pipeline is illustrated at figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> Visual and language features between the two modalities are first weighted with the co-attention mechanism and aggregated between the modalities to each image region and each word by the proposed Inter-modality Attention Flow (InterMAF) module, which learns the cross-modal interactions between the image regions and question words. Following the inter-modality module, to model the relationships within each modality, <em id="S3.SS1.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS1.p1.1.2" class="ltx_text"></span>, word-to-word relations and region-to-region relations, the Dynamic Intra-modality Attention Flow (DyIntraMAF) module is adopted. It weights words and regions within each modality and aggregates their features to the words and regions again, which could be viewed as passing information flows within each modality. Importantly, in our proposed intra-modality module, the attention flows are dynamically conditioned on the information from the other modality, which is a key difference compared with existing self-attention based methods. Such InterMAF and DyIntraMAF modules could be stacked multiple times to pass the information flows among words and regions iteratively to model the latent alignments for visual question answering.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Base visual and language feature extraction</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.5" class="ltx_p">To obtain base visual and language features, we extract image features from bottom-up &amp; top-down attention model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
The visual region features are obtained from a Faster RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> model pretrained on Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> dataset. For each image, we extract 100 region proposals and its associated region features. Given the input image <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">I</annotation></semantics></math>, the obtained region visual features are denoted as <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="R\in\mathbb{R}^{{\mu}\times{2048}}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">R</mi><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.3.2" xref="S3.SS2.p1.2.m2.1.1.3.3.2.cmml">μ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.2.m2.1.1.3.3.1" xref="S3.SS2.p1.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p1.2.m2.1.1.3.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.3.cmml">2048</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><in id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></in><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑅</ci><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3"><times id="S3.SS2.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.2">𝜇</ci><cn type="integer" id="S3.SS2.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.3">2048</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">R\in\mathbb{R}^{{\mu}\times{2048}}</annotation></semantics></math>, where the <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="i^{\text{th}}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">i</mi><mtext id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑖</ci><ci id="S3.SS2.p1.3.m3.1.1.3a.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">i^{\text{th}}</annotation></semantics></math> region feature is denoted as <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="r_{i}\in\mathbb{R}^{2048}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><msub id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.2.2.cmml">r</mi><mi id="S3.SS2.p1.4.m4.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">2048</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><in id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></in><apply id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2">𝑟</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">2048</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">r_{i}\in\mathbb{R}^{2048}</annotation></semantics></math> and there are <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mu</annotation></semantics></math> object regions in total. The object visual features are fixed during training.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">We adopt GLoVe word embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> as the inputs of the Gated Recurrent Unit (GRU) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> for encoding question word features. Given the question <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">Q</annotation></semantics></math>, we obtain word-level features <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="E\in\mathbb{R}^{{14}\times{1280}}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">E</mi><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml"><mn id="S3.SS2.p2.2.m2.1.1.3.3.2" xref="S3.SS2.p2.2.m2.1.1.3.3.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.2.m2.1.1.3.3.1" xref="S3.SS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p2.2.m2.1.1.3.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.3.cmml">1280</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><in id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></in><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐸</ci><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3"><times id="S3.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.1"></times><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.2">14</cn><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.3">1280</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">E\in\mathbb{R}^{{14}\times{1280}}</annotation></semantics></math> from GRU, where the <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="j^{\text{th}}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msup id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">j</mi><mtext id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑗</ci><ci id="S3.SS2.p2.3.m3.1.1.3a.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">j^{\text{th}}</annotation></semantics></math> word feature is denoted as <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="e_{j}\in\mathbb{R}^{1280}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><msub id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.cmml">e</mi><mi id="S3.SS2.p2.4.m4.1.1.2.3" xref="S3.SS2.p2.4.m4.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3.2" xref="S3.SS2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS2.p2.4.m4.1.1.3.3" xref="S3.SS2.p2.4.m4.1.1.3.3.cmml">1280</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><in id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></in><apply id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2">𝑒</ci><ci id="S3.SS2.p2.4.m4.1.1.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.3">𝑗</ci></apply><apply id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3">1280</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">e_{j}\in\mathbb{R}^{1280}</annotation></semantics></math> and all questions are padded and truncated to the same length 14.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.2" class="ltx_p">The obtained visual object region features <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">R</annotation></semantics></math> and question features <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">E</annotation></semantics></math> could be denoted as</p>
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle R" display="inline"><semantics id="S3.E1.m1.1a"><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle R</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1.m2.2" class="ltx_Math" alttext="\displaystyle=\textnormal{RCNN}(I;\theta_{\text{RCNN}})," display="inline"><semantics id="S3.E1.m2.2a"><mrow id="S3.E1.m2.2.2.1" xref="S3.E1.m2.2.2.1.1.cmml"><mrow id="S3.E1.m2.2.2.1.1" xref="S3.E1.m2.2.2.1.1.cmml"><mi id="S3.E1.m2.2.2.1.1.3" xref="S3.E1.m2.2.2.1.1.3.cmml"></mi><mo id="S3.E1.m2.2.2.1.1.2" xref="S3.E1.m2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E1.m2.2.2.1.1.1" xref="S3.E1.m2.2.2.1.1.1.cmml"><mtext id="S3.E1.m2.2.2.1.1.1.3" xref="S3.E1.m2.2.2.1.1.1.3a.cmml">RCNN</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m2.2.2.1.1.1.2" xref="S3.E1.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m2.2.2.1.1.1.1.1" xref="S3.E1.m2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m2.2.2.1.1.1.1.1.2" xref="S3.E1.m2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m2.1.1" xref="S3.E1.m2.1.1.cmml">I</mi><mo id="S3.E1.m2.2.2.1.1.1.1.1.3" xref="S3.E1.m2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E1.m2.2.2.1.1.1.1.1.1" xref="S3.E1.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m2.2.2.1.1.1.1.1.1.2" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mtext id="S3.E1.m2.2.2.1.1.1.1.1.1.3" xref="S3.E1.m2.2.2.1.1.1.1.1.1.3a.cmml">RCNN</mtext></msub><mo stretchy="false" id="S3.E1.m2.2.2.1.1.1.1.1.4" xref="S3.E1.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m2.2.2.1.2" xref="S3.E1.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m2.2b"><apply id="S3.E1.m2.2.2.1.1.cmml" xref="S3.E1.m2.2.2.1"><eq id="S3.E1.m2.2.2.1.1.2.cmml" xref="S3.E1.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E1.m2.2.2.1.1.3.cmml" xref="S3.E1.m2.2.2.1.1.3">absent</csymbol><apply id="S3.E1.m2.2.2.1.1.1.cmml" xref="S3.E1.m2.2.2.1.1.1"><times id="S3.E1.m2.2.2.1.1.1.2.cmml" xref="S3.E1.m2.2.2.1.1.1.2"></times><ci id="S3.E1.m2.2.2.1.1.1.3a.cmml" xref="S3.E1.m2.2.2.1.1.1.3"><mtext id="S3.E1.m2.2.2.1.1.1.3.cmml" xref="S3.E1.m2.2.2.1.1.1.3">RCNN</mtext></ci><list id="S3.E1.m2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1"><ci id="S3.E1.m2.1.1.cmml" xref="S3.E1.m2.1.1">𝐼</ci><apply id="S3.E1.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E1.m2.2.2.1.1.1.1.1.1.3a.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E1.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.3">RCNN</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m2.2c">\displaystyle=\textnormal{RCNN}(I;\theta_{\text{RCNN}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle E" display="inline"><semantics id="S3.E2.m1.1a"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle E</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m2.2" class="ltx_Math" alttext="\displaystyle=\textnormal{GRU}(Q;\theta_{\text{GRU}})." display="inline"><semantics id="S3.E2.m2.2a"><mrow id="S3.E2.m2.2.2.1" xref="S3.E2.m2.2.2.1.1.cmml"><mrow id="S3.E2.m2.2.2.1.1" xref="S3.E2.m2.2.2.1.1.cmml"><mi id="S3.E2.m2.2.2.1.1.3" xref="S3.E2.m2.2.2.1.1.3.cmml"></mi><mo id="S3.E2.m2.2.2.1.1.2" xref="S3.E2.m2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E2.m2.2.2.1.1.1" xref="S3.E2.m2.2.2.1.1.1.cmml"><mtext id="S3.E2.m2.2.2.1.1.1.3" xref="S3.E2.m2.2.2.1.1.1.3a.cmml">GRU</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m2.2.2.1.1.1.2" xref="S3.E2.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m2.2.2.1.1.1.1.1" xref="S3.E2.m2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m2.2.2.1.1.1.1.1.2" xref="S3.E2.m2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m2.1.1" xref="S3.E2.m2.1.1.cmml">Q</mi><mo id="S3.E2.m2.2.2.1.1.1.1.1.3" xref="S3.E2.m2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E2.m2.2.2.1.1.1.1.1.1" xref="S3.E2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m2.2.2.1.1.1.1.1.1.2" xref="S3.E2.m2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mtext id="S3.E2.m2.2.2.1.1.1.1.1.1.3" xref="S3.E2.m2.2.2.1.1.1.1.1.1.3a.cmml">GRU</mtext></msub><mo stretchy="false" id="S3.E2.m2.2.2.1.1.1.1.1.4" xref="S3.E2.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m2.2.2.1.2" xref="S3.E2.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.2b"><apply id="S3.E2.m2.2.2.1.1.cmml" xref="S3.E2.m2.2.2.1"><eq id="S3.E2.m2.2.2.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E2.m2.2.2.1.1.3.cmml" xref="S3.E2.m2.2.2.1.1.3">absent</csymbol><apply id="S3.E2.m2.2.2.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1"><times id="S3.E2.m2.2.2.1.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.1.2"></times><ci id="S3.E2.m2.2.2.1.1.1.3a.cmml" xref="S3.E2.m2.2.2.1.1.1.3"><mtext id="S3.E2.m2.2.2.1.1.1.3.cmml" xref="S3.E2.m2.2.2.1.1.1.3">GRU</mtext></ci><list id="S3.E2.m2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1"><ci id="S3.E2.m2.1.1.cmml" xref="S3.E2.m2.1.1">𝑄</ci><apply id="S3.E2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E2.m2.2.2.1.1.1.1.1.1.3a.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1.1.3">GRU</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.2c">\displaystyle=\textnormal{GRU}(Q;\theta_{\text{GRU}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.4" class="ltx_p">where visual feature parameters <math id="S3.SS2.p3.3.m1.1" class="ltx_Math" alttext="\theta_{\text{RCNN}}" display="inline"><semantics id="S3.SS2.p3.3.m1.1a"><msub id="S3.SS2.p3.3.m1.1.1" xref="S3.SS2.p3.3.m1.1.1.cmml"><mi id="S3.SS2.p3.3.m1.1.1.2" xref="S3.SS2.p3.3.m1.1.1.2.cmml">θ</mi><mtext id="S3.SS2.p3.3.m1.1.1.3" xref="S3.SS2.p3.3.m1.1.1.3a.cmml">RCNN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m1.1b"><apply id="S3.SS2.p3.3.m1.1.1.cmml" xref="S3.SS2.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m1.1.1.1.cmml" xref="S3.SS2.p3.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m1.1.1.2.cmml" xref="S3.SS2.p3.3.m1.1.1.2">𝜃</ci><ci id="S3.SS2.p3.3.m1.1.1.3a.cmml" xref="S3.SS2.p3.3.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.3.m1.1.1.3.cmml" xref="S3.SS2.p3.3.m1.1.1.3">RCNN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m1.1c">\theta_{\text{RCNN}}</annotation></semantics></math> are fixed while question features <math id="S3.SS2.p3.4.m2.1" class="ltx_Math" alttext="\theta_{\text{GRU}}" display="inline"><semantics id="S3.SS2.p3.4.m2.1a"><msub id="S3.SS2.p3.4.m2.1.1" xref="S3.SS2.p3.4.m2.1.1.cmml"><mi id="S3.SS2.p3.4.m2.1.1.2" xref="S3.SS2.p3.4.m2.1.1.2.cmml">θ</mi><mtext id="S3.SS2.p3.4.m2.1.1.3" xref="S3.SS2.p3.4.m2.1.1.3a.cmml">GRU</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m2.1b"><apply id="S3.SS2.p3.4.m2.1.1.cmml" xref="S3.SS2.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m2.1.1.1.cmml" xref="S3.SS2.p3.4.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m2.1.1.2.cmml" xref="S3.SS2.p3.4.m2.1.1.2">𝜃</ci><ci id="S3.SS2.p3.4.m2.1.1.3a.cmml" xref="S3.SS2.p3.4.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.4.m2.1.1.3.cmml" xref="S3.SS2.p3.4.m2.1.1.3">GRU</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m2.1c">\theta_{\text{GRU}}</annotation></semantics></math> are learned from scratch and updated together when training our proposed framework.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Inter-modality Attention Flow</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The Inter-modality Attention Flow (InterMAF) module as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> first learns to capture the importance between each pair of visual region and word features. It then passes information flows between the two modalities according to the learned importance weights and aggregate features to update each word feature and image region feature. Such an information flow process is able to identify cross-modal relations between visual regions and words.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.6" class="ltx_p">Given visual region and word features, we first calculate the association weights between every pair of visual region and word.
Each visual region and word features are first transformed into query, key and value features following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, where
the transformed region features are denoted as <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="R_{K}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">R</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑅</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">R_{K}</annotation></semantics></math>, <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="R_{Q}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">R</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑅</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">R_{Q}</annotation></semantics></math>, <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="R_{V}\in\mathbb{R}^{{\mu}\times dim}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><msub id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">R</mi><mi id="S3.SS3.p2.3.m3.1.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.3.cmml">V</mi></msub><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml"><mrow id="S3.SS3.p2.3.m3.1.1.3.3.2" xref="S3.SS3.p2.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.3.2.2" xref="S3.SS3.p2.3.m3.1.1.3.3.2.2.cmml">μ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.3.m3.1.1.3.3.2.1" xref="S3.SS3.p2.3.m3.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS3.p2.3.m3.1.1.3.3.2.3" xref="S3.SS3.p2.3.m3.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.3.3.1" xref="S3.SS3.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m3.1.1.3.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.3.3.1a" xref="S3.SS3.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m3.1.1.3.3.4" xref="S3.SS3.p2.3.m3.1.1.3.3.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><in id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></in><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝑅</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3">𝑉</ci></apply><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3"><times id="S3.SS3.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.1"></times><apply id="S3.SS3.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2"><times id="S3.SS3.p2.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2.1"></times><ci id="S3.SS3.p2.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2.2">𝜇</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2.3">𝑑</ci></apply><ci id="S3.SS3.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.3">𝑖</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.4.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">R_{V}\in\mathbb{R}^{{\mu}\times dim}</annotation></semantics></math>; Transformed word features are denoted as <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="E_{K}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">E</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝐸</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">E_{K}</annotation></semantics></math>, <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="E_{Q}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">E</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝐸</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">E_{Q}</annotation></semantics></math> and <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="E_{V}\in\mathbb{R}^{{14}\times dim}" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mrow id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><msub id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2.2" xref="S3.SS3.p2.6.m6.1.1.2.2.cmml">E</mi><mi id="S3.SS3.p2.6.m6.1.1.2.3" xref="S3.SS3.p2.6.m6.1.1.2.3.cmml">V</mi></msub><mo id="S3.SS3.p2.6.m6.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml"><mi id="S3.SS3.p2.6.m6.1.1.3.2" xref="S3.SS3.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.6.m6.1.1.3.3" xref="S3.SS3.p2.6.m6.1.1.3.3.cmml"><mrow id="S3.SS3.p2.6.m6.1.1.3.3.2" xref="S3.SS3.p2.6.m6.1.1.3.3.2.cmml"><mn id="S3.SS3.p2.6.m6.1.1.3.3.2.2" xref="S3.SS3.p2.6.m6.1.1.3.3.2.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.6.m6.1.1.3.3.2.1" xref="S3.SS3.p2.6.m6.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS3.p2.6.m6.1.1.3.3.2.3" xref="S3.SS3.p2.6.m6.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.1.1.3.3.1" xref="S3.SS3.p2.6.m6.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p2.6.m6.1.1.3.3.3" xref="S3.SS3.p2.6.m6.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.1.1.3.3.1a" xref="S3.SS3.p2.6.m6.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p2.6.m6.1.1.3.3.4" xref="S3.SS3.p2.6.m6.1.1.3.3.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><in id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1"></in><apply id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.2.1.cmml" xref="S3.SS3.p2.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2.2">𝐸</ci><ci id="S3.SS3.p2.6.m6.1.1.2.3.cmml" xref="S3.SS3.p2.6.m6.1.1.2.3">𝑉</ci></apply><apply id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.3.2.cmml" xref="S3.SS3.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.6.m6.1.1.3.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3"><times id="S3.SS3.p2.6.m6.1.1.3.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3.1"></times><apply id="S3.SS3.p2.6.m6.1.1.3.3.2.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3.2"><times id="S3.SS3.p2.6.m6.1.1.3.3.2.1.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3.2.1"></times><cn type="integer" id="S3.SS3.p2.6.m6.1.1.3.3.2.2.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3.2.2">14</cn><ci id="S3.SS3.p2.6.m6.1.1.3.3.2.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3.2.3">𝑑</ci></apply><ci id="S3.SS3.p2.6.m6.1.1.3.3.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3.3">𝑖</ci><ci id="S3.SS3.p2.6.m6.1.1.3.3.4.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">E_{V}\in\mathbb{R}^{{14}\times dim}</annotation></semantics></math>,</p>
<table id="Sx1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\displaystyle R_{K}=\text{Linear}({R;\theta_{RK}})," display="inline"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml">R</mi><mi id="S3.E3.m1.2.2.1.1.3.3" xref="S3.E3.m1.2.2.1.1.3.3.cmml">K</mi></msub><mo id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><mtext id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">R</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3.cmml">K</mi></mrow></msub><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.1.4" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"></eq><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2">𝑅</ci><ci id="S3.E3.m1.2.2.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3">𝐾</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"></times><ci id="S3.E3.m1.2.2.1.1.1.3a.cmml" xref="S3.E3.m1.2.2.1.1.1.3"><mtext id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3">Linear</mtext></ci><list id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑅</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E3.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.2">𝑅</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3">𝐾</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle R_{K}=\text{Linear}({R;\theta_{RK}}),</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m2.2" class="ltx_Math" alttext="\displaystyle E_{K}=\text{Linear}({R;\theta_{EK}})," display="inline"><semantics id="S3.E3.m2.2a"><mrow id="S3.E3.m2.2.2.1" xref="S3.E3.m2.2.2.1.1.cmml"><mrow id="S3.E3.m2.2.2.1.1" xref="S3.E3.m2.2.2.1.1.cmml"><msub id="S3.E3.m2.2.2.1.1.3" xref="S3.E3.m2.2.2.1.1.3.cmml"><mi id="S3.E3.m2.2.2.1.1.3.2" xref="S3.E3.m2.2.2.1.1.3.2.cmml">E</mi><mi id="S3.E3.m2.2.2.1.1.3.3" xref="S3.E3.m2.2.2.1.1.3.3.cmml">K</mi></msub><mo id="S3.E3.m2.2.2.1.1.2" xref="S3.E3.m2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E3.m2.2.2.1.1.1" xref="S3.E3.m2.2.2.1.1.1.cmml"><mtext id="S3.E3.m2.2.2.1.1.1.3" xref="S3.E3.m2.2.2.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.1.1.2" xref="S3.E3.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m2.2.2.1.1.1.1.1" xref="S3.E3.m2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m2.2.2.1.1.1.1.1.2" xref="S3.E3.m2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E3.m2.1.1" xref="S3.E3.m2.1.1.cmml">R</mi><mo id="S3.E3.m2.2.2.1.1.1.1.1.3" xref="S3.E3.m2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E3.m2.2.2.1.1.1.1.1.1" xref="S3.E3.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E3.m2.2.2.1.1.1.1.1.1.2" xref="S3.E3.m2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E3.m2.2.2.1.1.1.1.1.1.3" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.2.2.1.1.1.1.1.1.3.2" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.1.1.1.1.1.3.1" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3.m2.2.2.1.1.1.1.1.1.3.3" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3.3.cmml">K</mi></mrow></msub><mo stretchy="false" id="S3.E3.m2.2.2.1.1.1.1.1.4" xref="S3.E3.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m2.2.2.1.2" xref="S3.E3.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.2b"><apply id="S3.E3.m2.2.2.1.1.cmml" xref="S3.E3.m2.2.2.1"><eq id="S3.E3.m2.2.2.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.2"></eq><apply id="S3.E3.m2.2.2.1.1.3.cmml" xref="S3.E3.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.3.1.cmml" xref="S3.E3.m2.2.2.1.1.3">subscript</csymbol><ci id="S3.E3.m2.2.2.1.1.3.2.cmml" xref="S3.E3.m2.2.2.1.1.3.2">𝐸</ci><ci id="S3.E3.m2.2.2.1.1.3.3.cmml" xref="S3.E3.m2.2.2.1.1.3.3">𝐾</ci></apply><apply id="S3.E3.m2.2.2.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1"><times id="S3.E3.m2.2.2.1.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.1.2"></times><ci id="S3.E3.m2.2.2.1.1.1.3a.cmml" xref="S3.E3.m2.2.2.1.1.1.3"><mtext id="S3.E3.m2.2.2.1.1.1.3.cmml" xref="S3.E3.m2.2.2.1.1.1.3">Linear</mtext></ci><list id="S3.E3.m2.2.2.1.1.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1"><ci id="S3.E3.m2.1.1.cmml" xref="S3.E3.m2.1.1">𝑅</ci><apply id="S3.E3.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E3.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3"><times id="S3.E3.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E3.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E3.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3.3">𝐾</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.2c">\displaystyle E_{K}=\text{Linear}({R;\theta_{EK}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\displaystyle R_{Q}=\text{Linear}({R;\theta_{RQ}})," display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.3.2" xref="S3.E4.m1.2.2.1.1.3.2.cmml">R</mi><mi id="S3.E4.m1.2.2.1.1.3.3" xref="S3.E4.m1.2.2.1.1.3.3.cmml">Q</mi></msub><mo id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mtext id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">R</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.3.cmml">Q</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2"></eq><apply id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2">𝑅</ci><ci id="S3.E4.m1.2.2.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3">𝑄</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2"></times><ci id="S3.E4.m1.2.2.1.1.1.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.3"><mtext id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">Linear</mtext></ci><list id="S3.E4.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑅</ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E4.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.2">𝑅</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle R_{Q}=\text{Linear}({R;\theta_{RQ}}),</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m2.2" class="ltx_Math" alttext="\displaystyle E_{Q}=\text{Linear}({E;\theta_{EQ}})," display="inline"><semantics id="S3.E4.m2.2a"><mrow id="S3.E4.m2.2.2.1" xref="S3.E4.m2.2.2.1.1.cmml"><mrow id="S3.E4.m2.2.2.1.1" xref="S3.E4.m2.2.2.1.1.cmml"><msub id="S3.E4.m2.2.2.1.1.3" xref="S3.E4.m2.2.2.1.1.3.cmml"><mi id="S3.E4.m2.2.2.1.1.3.2" xref="S3.E4.m2.2.2.1.1.3.2.cmml">E</mi><mi id="S3.E4.m2.2.2.1.1.3.3" xref="S3.E4.m2.2.2.1.1.3.3.cmml">Q</mi></msub><mo id="S3.E4.m2.2.2.1.1.2" xref="S3.E4.m2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E4.m2.2.2.1.1.1" xref="S3.E4.m2.2.2.1.1.1.cmml"><mtext id="S3.E4.m2.2.2.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m2.2.2.1.1.1.2" xref="S3.E4.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m2.2.2.1.1.1.1.1" xref="S3.E4.m2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m2.2.2.1.1.1.1.1.2" xref="S3.E4.m2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m2.1.1" xref="S3.E4.m2.1.1.cmml">E</mi><mo id="S3.E4.m2.2.2.1.1.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E4.m2.2.2.1.1.1.1.1.1" xref="S3.E4.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.2.2.1.1.1.1.1.1.2" xref="S3.E4.m2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E4.m2.2.2.1.1.1.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m2.2.2.1.1.1.1.1.1.3.2" xref="S3.E4.m2.2.2.1.1.1.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.2.2.1.1.1.1.1.1.3.1" xref="S3.E4.m2.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E4.m2.2.2.1.1.1.1.1.1.3.3" xref="S3.E4.m2.2.2.1.1.1.1.1.1.3.3.cmml">Q</mi></mrow></msub><mo stretchy="false" id="S3.E4.m2.2.2.1.1.1.1.1.4" xref="S3.E4.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m2.2.2.1.2" xref="S3.E4.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.2b"><apply id="S3.E4.m2.2.2.1.1.cmml" xref="S3.E4.m2.2.2.1"><eq id="S3.E4.m2.2.2.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.2"></eq><apply id="S3.E4.m2.2.2.1.1.3.cmml" xref="S3.E4.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.3.1.cmml" xref="S3.E4.m2.2.2.1.1.3">subscript</csymbol><ci id="S3.E4.m2.2.2.1.1.3.2.cmml" xref="S3.E4.m2.2.2.1.1.3.2">𝐸</ci><ci id="S3.E4.m2.2.2.1.1.3.3.cmml" xref="S3.E4.m2.2.2.1.1.3.3">𝑄</ci></apply><apply id="S3.E4.m2.2.2.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1"><times id="S3.E4.m2.2.2.1.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1.2"></times><ci id="S3.E4.m2.2.2.1.1.1.3a.cmml" xref="S3.E4.m2.2.2.1.1.1.3"><mtext id="S3.E4.m2.2.2.1.1.1.3.cmml" xref="S3.E4.m2.2.2.1.1.1.3">Linear</mtext></ci><list id="S3.E4.m2.2.2.1.1.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1"><ci id="S3.E4.m2.1.1.cmml" xref="S3.E4.m2.1.1">𝐸</ci><apply id="S3.E4.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E4.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.3"><times id="S3.E4.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E4.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E4.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.2c">\displaystyle E_{Q}=\text{Linear}({E;\theta_{EQ}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\displaystyle R_{V}=\text{Linear}({R;\theta_{RV}})," display="inline"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.3.2" xref="S3.E5.m1.2.2.1.1.3.2.cmml">R</mi><mi id="S3.E5.m1.2.2.1.1.3.3" xref="S3.E5.m1.2.2.1.1.3.3.cmml">V</mi></msub><mo id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mtext id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">R</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml">V</mi></mrow></msub><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><eq id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"></eq><apply id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2">𝑅</ci><ci id="S3.E5.m1.2.2.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3">𝑉</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2"></times><ci id="S3.E5.m1.2.2.1.1.1.3a.cmml" xref="S3.E5.m1.2.2.1.1.1.3"><mtext id="S3.E5.m1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3">Linear</mtext></ci><list id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑅</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2">𝑅</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3">𝑉</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\displaystyle R_{V}=\text{Linear}({R;\theta_{RV}}),</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m2.2" class="ltx_Math" alttext="\displaystyle E_{V}=\text{Linear}({E;\theta_{EV}})." display="inline"><semantics id="S3.E5.m2.2a"><mrow id="S3.E5.m2.2.2.1" xref="S3.E5.m2.2.2.1.1.cmml"><mrow id="S3.E5.m2.2.2.1.1" xref="S3.E5.m2.2.2.1.1.cmml"><msub id="S3.E5.m2.2.2.1.1.3" xref="S3.E5.m2.2.2.1.1.3.cmml"><mi id="S3.E5.m2.2.2.1.1.3.2" xref="S3.E5.m2.2.2.1.1.3.2.cmml">E</mi><mi id="S3.E5.m2.2.2.1.1.3.3" xref="S3.E5.m2.2.2.1.1.3.3.cmml">V</mi></msub><mo id="S3.E5.m2.2.2.1.1.2" xref="S3.E5.m2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E5.m2.2.2.1.1.1" xref="S3.E5.m2.2.2.1.1.1.cmml"><mtext id="S3.E5.m2.2.2.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m2.2.2.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m2.2.2.1.1.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m2.1.1" xref="S3.E5.m2.1.1.cmml">E</mi><mo id="S3.E5.m2.2.2.1.1.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E5.m2.2.2.1.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E5.m2.2.2.1.1.1.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.3.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E5.m2.2.2.1.1.1.1.1.1.3.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.cmml">V</mi></mrow></msub><mo stretchy="false" id="S3.E5.m2.2.2.1.1.1.1.1.4" xref="S3.E5.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m2.2.2.1.2" xref="S3.E5.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.2b"><apply id="S3.E5.m2.2.2.1.1.cmml" xref="S3.E5.m2.2.2.1"><eq id="S3.E5.m2.2.2.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.2"></eq><apply id="S3.E5.m2.2.2.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.3.1.cmml" xref="S3.E5.m2.2.2.1.1.3">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.3.2.cmml" xref="S3.E5.m2.2.2.1.1.3.2">𝐸</ci><ci id="S3.E5.m2.2.2.1.1.3.3.cmml" xref="S3.E5.m2.2.2.1.1.3.3">𝑉</ci></apply><apply id="S3.E5.m2.2.2.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1"><times id="S3.E5.m2.2.2.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.2"></times><ci id="S3.E5.m2.2.2.1.1.1.3a.cmml" xref="S3.E5.m2.2.2.1.1.1.3"><mtext id="S3.E5.m2.2.2.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.3">Linear</mtext></ci><list id="S3.E5.m2.2.2.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1"><ci id="S3.E5.m2.1.1.cmml" xref="S3.E5.m2.1.1">𝐸</ci><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3"><times id="S3.E5.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3">𝑉</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.2c">\displaystyle E_{V}=\text{Linear}({E;\theta_{EV}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.8" class="ltx_p">where “Linear” denotes a fully-connected layer with parameter <math id="S3.SS3.p2.7.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p2.7.m1.1a"><mi id="S3.SS3.p2.7.m1.1.1" xref="S3.SS3.p2.7.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m1.1b"><ci id="S3.SS3.p2.7.m1.1.1.cmml" xref="S3.SS3.p2.7.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m1.1c">\theta</annotation></semantics></math>, and <math id="S3.SS3.p2.8.m2.1" class="ltx_Math" alttext="dim" display="inline"><semantics id="S3.SS3.p2.8.m2.1a"><mrow id="S3.SS3.p2.8.m2.1.1" xref="S3.SS3.p2.8.m2.1.1.cmml"><mi id="S3.SS3.p2.8.m2.1.1.2" xref="S3.SS3.p2.8.m2.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m2.1.1.1" xref="S3.SS3.p2.8.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.8.m2.1.1.3" xref="S3.SS3.p2.8.m2.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m2.1.1.1a" xref="S3.SS3.p2.8.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.8.m2.1.1.4" xref="S3.SS3.p2.8.m2.1.1.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m2.1b"><apply id="S3.SS3.p2.8.m2.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1"><times id="S3.SS3.p2.8.m2.1.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1.1"></times><ci id="S3.SS3.p2.8.m2.1.1.2.cmml" xref="S3.SS3.p2.8.m2.1.1.2">𝑑</ci><ci id="S3.SS3.p2.8.m2.1.1.3.cmml" xref="S3.SS3.p2.8.m2.1.1.3">𝑖</ci><ci id="S3.SS3.p2.8.m2.1.1.4.cmml" xref="S3.SS3.p2.8.m2.1.1.4">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m2.1c">dim</annotation></semantics></math> represents the common dimension of transformed features from both modalities.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.5" class="ltx_p">By calculating the inner product <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="R_{Q}E_{K}^{T}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2.2" xref="S3.SS3.p3.1.m1.1.1.2.2.cmml">R</mi><mi id="S3.SS3.p3.1.m1.1.1.2.3" xref="S3.SS3.p3.1.m1.1.1.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.cmml">​</mo><msubsup id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2.2" xref="S3.SS3.p3.1.m1.1.1.3.2.2.cmml">E</mi><mi id="S3.SS3.p3.1.m1.1.1.3.2.3" xref="S3.SS3.p3.1.m1.1.1.3.2.3.cmml">K</mi><mi id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><times id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1"></times><apply id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2.2">𝑅</ci><ci id="S3.SS3.p3.1.m1.1.1.2.3.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3">𝑄</ci></apply><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3">superscript</csymbol><apply id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.3.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.3.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2.2">𝐸</ci><ci id="S3.SS3.p3.1.m1.1.1.3.2.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2.3">𝐾</ci></apply><ci id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">R_{Q}E_{K}^{T}</annotation></semantics></math> between every pair of visual region feature <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="R_{Q}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">R</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑅</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">R_{Q}</annotation></semantics></math> and word key feature <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="E_{K}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msub id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">E</mi><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝐸</ci><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">E_{K}</annotation></semantics></math>, we obtain the raw attention weights for aggregating information from word features to each of the visual features, and vice versa. After normalizing the raw weights with the square root of the dimension number and a softmax non-linearity function, we obtain the two sets of attention weights, <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\textnormal{InterMAF}_{R\leftarrow E}\in\mathbb{R}^{{\mu}\times{14}}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mrow id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><msub id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml"><mtext id="S3.SS3.p3.4.m4.1.1.2.2" xref="S3.SS3.p3.4.m4.1.1.2.2a.cmml">InterMAF</mtext><mrow id="S3.SS3.p3.4.m4.1.1.2.3" xref="S3.SS3.p3.4.m4.1.1.2.3.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2.3.2" xref="S3.SS3.p3.4.m4.1.1.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.SS3.p3.4.m4.1.1.2.3.1" xref="S3.SS3.p3.4.m4.1.1.2.3.1.cmml">←</mo><mi id="S3.SS3.p3.4.m4.1.1.2.3.3" xref="S3.SS3.p3.4.m4.1.1.2.3.3.cmml">E</mi></mrow></msub><mo id="S3.SS3.p3.4.m4.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml"><mi id="S3.SS3.p3.4.m4.1.1.3.2" xref="S3.SS3.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.4.m4.1.1.3.3" xref="S3.SS3.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.p3.4.m4.1.1.3.3.2" xref="S3.SS3.p3.4.m4.1.1.3.3.2.cmml">μ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p3.4.m4.1.1.3.3.1" xref="S3.SS3.p3.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.p3.4.m4.1.1.3.3.3" xref="S3.SS3.p3.4.m4.1.1.3.3.3.cmml">14</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><in id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1"></in><apply id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.2.1.cmml" xref="S3.SS3.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.2a.cmml" xref="S3.SS3.p3.4.m4.1.1.2.2"><mtext id="S3.SS3.p3.4.m4.1.1.2.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2.2">InterMAF</mtext></ci><apply id="S3.SS3.p3.4.m4.1.1.2.3.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3"><ci id="S3.SS3.p3.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3.1">←</ci><ci id="S3.SS3.p3.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3.2">𝑅</ci><ci id="S3.SS3.p3.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.3.1.cmml" xref="S3.SS3.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.3.2.cmml" xref="S3.SS3.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p3.4.m4.1.1.3.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3.3"><times id="S3.SS3.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p3.4.m4.1.1.3.3.1"></times><ci id="S3.SS3.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p3.4.m4.1.1.3.3.2">𝜇</ci><cn type="integer" id="S3.SS3.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3.3.3">14</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\textnormal{InterMAF}_{R\leftarrow E}\in\mathbb{R}^{{\mu}\times{14}}</annotation></semantics></math> for weighting information flow transmitted from words to image regions, and <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\textnormal{InterMAF}_{R\rightarrow E}\in\mathbb{R}^{{14}\times{\mu}}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mrow id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><msub id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml"><mtext id="S3.SS3.p3.5.m5.1.1.2.2" xref="S3.SS3.p3.5.m5.1.1.2.2a.cmml">InterMAF</mtext><mrow id="S3.SS3.p3.5.m5.1.1.2.3" xref="S3.SS3.p3.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2.3.2" xref="S3.SS3.p3.5.m5.1.1.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.SS3.p3.5.m5.1.1.2.3.1" xref="S3.SS3.p3.5.m5.1.1.2.3.1.cmml">→</mo><mi id="S3.SS3.p3.5.m5.1.1.2.3.3" xref="S3.SS3.p3.5.m5.1.1.2.3.3.cmml">E</mi></mrow></msub><mo id="S3.SS3.p3.5.m5.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml"><mi id="S3.SS3.p3.5.m5.1.1.3.2" xref="S3.SS3.p3.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.5.m5.1.1.3.3" xref="S3.SS3.p3.5.m5.1.1.3.3.cmml"><mn id="S3.SS3.p3.5.m5.1.1.3.3.2" xref="S3.SS3.p3.5.m5.1.1.3.3.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p3.5.m5.1.1.3.3.1" xref="S3.SS3.p3.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p3.5.m5.1.1.3.3.3" xref="S3.SS3.p3.5.m5.1.1.3.3.3.cmml">μ</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><in id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1"></in><apply id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.2.1.cmml" xref="S3.SS3.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.2a.cmml" xref="S3.SS3.p3.5.m5.1.1.2.2"><mtext id="S3.SS3.p3.5.m5.1.1.2.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2.2">InterMAF</mtext></ci><apply id="S3.SS3.p3.5.m5.1.1.2.3.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3"><ci id="S3.SS3.p3.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3.1">→</ci><ci id="S3.SS3.p3.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3.2">𝑅</ci><ci id="S3.SS3.p3.5.m5.1.1.2.3.3.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.3.1.cmml" xref="S3.SS3.p3.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.3.2.cmml" xref="S3.SS3.p3.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS3.p3.5.m5.1.1.3.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3.3"><times id="S3.SS3.p3.5.m5.1.1.3.3.1.cmml" xref="S3.SS3.p3.5.m5.1.1.3.3.1"></times><cn type="integer" id="S3.SS3.p3.5.m5.1.1.3.3.2.cmml" xref="S3.SS3.p3.5.m5.1.1.3.3.2">14</cn><ci id="S3.SS3.p3.5.m5.1.1.3.3.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3.3.3">𝜇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\textnormal{InterMAF}_{R\rightarrow E}\in\mathbb{R}^{{14}\times{\mu}}</annotation></semantics></math> for weighting information flow transmitted from image regions to sentence words,</p>
<table id="Sx1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.2" class="ltx_Math" alttext="\displaystyle\textnormal{InterMAF}_{R\leftarrow E}=\textnormal{softmax}(\frac{R_{Q}E_{K}^{T}}{\sqrt{dim}})," display="inline"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.2.cmml"><mtext id="S3.E6.m1.2.2.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.2a.cmml">InterMAF</mtext><mrow id="S3.E6.m1.2.2.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.3.2" xref="S3.E6.m1.2.2.1.1.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.E6.m1.2.2.1.1.2.3.1" xref="S3.E6.m1.2.2.1.1.2.3.1.cmml">←</mo><mi id="S3.E6.m1.2.2.1.1.2.3.3" xref="S3.E6.m1.2.2.1.1.2.3.3.cmml">E</mi></mrow></msub><mo id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml"><mtext id="S3.E6.m1.2.2.1.1.3.2" xref="S3.E6.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.3.1" xref="S3.E6.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.3.3.2" xref="S3.E6.m1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.3.3.2.1" xref="S3.E6.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mfrac id="S3.E6.m1.1.1a" xref="S3.E6.m1.1.1.cmml"><mrow id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml"><msub id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml"><mi id="S3.E6.m1.1.1.2.2.2" xref="S3.E6.m1.1.1.2.2.2.cmml">R</mi><mi id="S3.E6.m1.1.1.2.2.3" xref="S3.E6.m1.1.1.2.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.2.1" xref="S3.E6.m1.1.1.2.1.cmml">​</mo><msubsup id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.2.3.2.2" xref="S3.E6.m1.1.1.2.3.2.2.cmml">E</mi><mi id="S3.E6.m1.1.1.2.3.2.3" xref="S3.E6.m1.1.1.2.3.2.3.cmml">K</mi><mi id="S3.E6.m1.1.1.2.3.3" xref="S3.E6.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mrow id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.3.2.1" xref="S3.E6.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.3.2.1a" xref="S3.E6.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E6.m1.1.1.3.2.4" xref="S3.E6.m1.1.1.3.2.4.cmml">m</mi></mrow></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E6.m1.2.2.1.1.3.3.2.2" xref="S3.E6.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1"><eq id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1"></eq><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.2a.cmml" xref="S3.E6.m1.2.2.1.1.2.2"><mtext id="S3.E6.m1.2.2.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2">InterMAF</mtext></ci><apply id="S3.E6.m1.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3"><ci id="S3.E6.m1.2.2.1.1.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.3.1">←</ci><ci id="S3.E6.m1.2.2.1.1.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.3.2">𝑅</ci><ci id="S3.E6.m1.2.2.1.1.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3"><times id="S3.E6.m1.2.2.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.3.1"></times><ci id="S3.E6.m1.2.2.1.1.3.2a.cmml" xref="S3.E6.m1.2.2.1.1.3.2"><mtext id="S3.E6.m1.2.2.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.3.3.2"><divide id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.3.3.2"></divide><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"><times id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.2.1"></times><apply id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.2.2.2">𝑅</ci><ci id="S3.E6.m1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.2.2.3">𝑄</ci></apply><apply id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.2.3">superscript</csymbol><apply id="S3.E6.m1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.3.2.1.cmml" xref="S3.E6.m1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.2.3.2.2.cmml" xref="S3.E6.m1.1.1.2.3.2.2">𝐸</ci><ci id="S3.E6.m1.1.1.2.3.2.3.cmml" xref="S3.E6.m1.1.1.2.3.2.3">𝐾</ci></apply><ci id="S3.E6.m1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><root id="S3.E6.m1.1.1.3a.cmml" xref="S3.E6.m1.1.1.3"></root><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><times id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2.1"></times><ci id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2">𝑑</ci><ci id="S3.E6.m1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.3">𝑖</ci><ci id="S3.E6.m1.1.1.3.2.4.cmml" xref="S3.E6.m1.1.1.3.2.4">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">\displaystyle\textnormal{InterMAF}_{R\leftarrow E}=\textnormal{softmax}(\frac{R_{Q}E_{K}^{T}}{\sqrt{dim}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.2" class="ltx_Math" alttext="\displaystyle\textnormal{InterMAF}_{R\rightarrow E}=\textnormal{softmax}(\frac{E_{Q}R_{K}^{T}}{\sqrt{dim}})." display="inline"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.1.cmml"><mrow id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml"><msub id="S3.E7.m1.2.2.1.1.2" xref="S3.E7.m1.2.2.1.1.2.cmml"><mtext id="S3.E7.m1.2.2.1.1.2.2" xref="S3.E7.m1.2.2.1.1.2.2a.cmml">InterMAF</mtext><mrow id="S3.E7.m1.2.2.1.1.2.3" xref="S3.E7.m1.2.2.1.1.2.3.cmml"><mi id="S3.E7.m1.2.2.1.1.2.3.2" xref="S3.E7.m1.2.2.1.1.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.E7.m1.2.2.1.1.2.3.1" xref="S3.E7.m1.2.2.1.1.2.3.1.cmml">→</mo><mi id="S3.E7.m1.2.2.1.1.2.3.3" xref="S3.E7.m1.2.2.1.1.2.3.3.cmml">E</mi></mrow></msub><mo id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.2.2.1.1.3" xref="S3.E7.m1.2.2.1.1.3.cmml"><mtext id="S3.E7.m1.2.2.1.1.3.2" xref="S3.E7.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.3.1" xref="S3.E7.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.3.3.2" xref="S3.E7.m1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.3.3.2.1" xref="S3.E7.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mfrac id="S3.E7.m1.1.1a" xref="S3.E7.m1.1.1.cmml"><mrow id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml"><msub id="S3.E7.m1.1.1.2.2" xref="S3.E7.m1.1.1.2.2.cmml"><mi id="S3.E7.m1.1.1.2.2.2" xref="S3.E7.m1.1.1.2.2.2.cmml">E</mi><mi id="S3.E7.m1.1.1.2.2.3" xref="S3.E7.m1.1.1.2.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.2.1" xref="S3.E7.m1.1.1.2.1.cmml">​</mo><msubsup id="S3.E7.m1.1.1.2.3" xref="S3.E7.m1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.2.3.2.2" xref="S3.E7.m1.1.1.2.3.2.2.cmml">R</mi><mi id="S3.E7.m1.1.1.2.3.2.3" xref="S3.E7.m1.1.1.2.3.2.3.cmml">K</mi><mi id="S3.E7.m1.1.1.2.3.3" xref="S3.E7.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><mrow id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.3.2.2" xref="S3.E7.m1.1.1.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.3.2.1" xref="S3.E7.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E7.m1.1.1.3.2.3" xref="S3.E7.m1.1.1.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.3.2.1a" xref="S3.E7.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E7.m1.1.1.3.2.4" xref="S3.E7.m1.1.1.3.2.4.cmml">m</mi></mrow></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E7.m1.2.2.1.1.3.3.2.2" xref="S3.E7.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1"><eq id="S3.E7.m1.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1"></eq><apply id="S3.E7.m1.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.2.1.cmml" xref="S3.E7.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.2.2a.cmml" xref="S3.E7.m1.2.2.1.1.2.2"><mtext id="S3.E7.m1.2.2.1.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2">InterMAF</mtext></ci><apply id="S3.E7.m1.2.2.1.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.2.3"><ci id="S3.E7.m1.2.2.1.1.2.3.1.cmml" xref="S3.E7.m1.2.2.1.1.2.3.1">→</ci><ci id="S3.E7.m1.2.2.1.1.2.3.2.cmml" xref="S3.E7.m1.2.2.1.1.2.3.2">𝑅</ci><ci id="S3.E7.m1.2.2.1.1.2.3.3.cmml" xref="S3.E7.m1.2.2.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.E7.m1.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.3"><times id="S3.E7.m1.2.2.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.3.1"></times><ci id="S3.E7.m1.2.2.1.1.3.2a.cmml" xref="S3.E7.m1.2.2.1.1.3.2"><mtext id="S3.E7.m1.2.2.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.3.3.2"><divide id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.3.3.2"></divide><apply id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"><times id="S3.E7.m1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.2.1"></times><apply id="S3.E7.m1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.2.2.2">𝐸</ci><ci id="S3.E7.m1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.2.2.3">𝑄</ci></apply><apply id="S3.E7.m1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.2.3">superscript</csymbol><apply id="S3.E7.m1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.2.3.2.1.cmml" xref="S3.E7.m1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.1.1.2.3.2.2.cmml" xref="S3.E7.m1.1.1.2.3.2.2">𝑅</ci><ci id="S3.E7.m1.1.1.2.3.2.3.cmml" xref="S3.E7.m1.1.1.2.3.2.3">𝐾</ci></apply><ci id="S3.E7.m1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><root id="S3.E7.m1.1.1.3a.cmml" xref="S3.E7.m1.1.1.3"></root><apply id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2"><times id="S3.E7.m1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.3.2.1"></times><ci id="S3.E7.m1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2">𝑑</ci><ci id="S3.E7.m1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.3.2.3">𝑖</ci><ci id="S3.E7.m1.1.1.3.2.4.cmml" xref="S3.E7.m1.1.1.3.2.4">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\displaystyle\textnormal{InterMAF}_{R\rightarrow E}=\textnormal{softmax}(\frac{E_{Q}R_{K}^{T}}{\sqrt{dim}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.6" class="ltx_p">The inner product values are proportional to the dimension of hidden feature space, thus need to be normalized by the square root of hidden dimension.
The softmax non-linearity function is applied row-wisely.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.4" class="ltx_p">The two bi-directional InterMAF matrices capture the importances between every image region and word pairs. Take the <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\textnormal{InterMAF}_{R\leftarrow E}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><msub id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mtext id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2a.cmml">InterMAF</mtext><mrow id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">R</mi><mo stretchy="false" id="S3.SS3.p4.1.m1.1.1.3.1" xref="S3.SS3.p4.1.m1.1.1.3.1.cmml">←</mo><mi id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2a.cmml" xref="S3.SS3.p4.1.m1.1.1.2"><mtext id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">InterMAF</mtext></ci><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><ci id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.1">←</ci><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">𝑅</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\textnormal{InterMAF}_{R\leftarrow E}</annotation></semantics></math> for example, each row stands for the attention weights between one visual region and all word embeddings. Information from all word embeddings to this one image region feature could be aggregated as the weighted summation of the word value features <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="E_{V}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">E</mi><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝐸</ci><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">E_{V}</annotation></semantics></math>. We denote the information flows to update visual region features and word features by the InterMAF module as <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="R_{update}\in\mathbb{R}^{\mu\times dim}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mrow id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><msub id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2.2" xref="S3.SS3.p4.3.m3.1.1.2.2.cmml">R</mi><mrow id="S3.SS3.p4.3.m3.1.1.2.3" xref="S3.SS3.p4.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2.3.2" xref="S3.SS3.p4.3.m3.1.1.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.2.3.1" xref="S3.SS3.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.2.3.3" xref="S3.SS3.p4.3.m3.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.2.3.1a" xref="S3.SS3.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.2.3.4" xref="S3.SS3.p4.3.m3.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.2.3.1b" xref="S3.SS3.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.2.3.5" xref="S3.SS3.p4.3.m3.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.2.3.1c" xref="S3.SS3.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.2.3.6" xref="S3.SS3.p4.3.m3.1.1.2.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.2.3.1d" xref="S3.SS3.p4.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.2.3.7" xref="S3.SS3.p4.3.m3.1.1.2.3.7.cmml">e</mi></mrow></msub><mo id="S3.SS3.p4.3.m3.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.2" xref="S3.SS3.p4.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.3.m3.1.1.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.cmml"><mrow id="S3.SS3.p4.3.m3.1.1.3.3.2" xref="S3.SS3.p4.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.3.2.2" xref="S3.SS3.p4.3.m3.1.1.3.3.2.2.cmml">μ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.3.m3.1.1.3.3.2.1" xref="S3.SS3.p4.3.m3.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS3.p4.3.m3.1.1.3.3.2.3" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.3.3.1" xref="S3.SS3.p4.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.3.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.3.3.1a" xref="S3.SS3.p4.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.3.3.4" xref="S3.SS3.p4.3.m3.1.1.3.3.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><in id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1"></in><apply id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2.2">𝑅</ci><apply id="S3.SS3.p4.3.m3.1.1.2.3.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3"><times id="S3.SS3.p4.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.p4.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3.2">𝑢</ci><ci id="S3.SS3.p4.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3.3">𝑝</ci><ci id="S3.SS3.p4.3.m3.1.1.2.3.4.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3.4">𝑑</ci><ci id="S3.SS3.p4.3.m3.1.1.2.3.5.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3.5">𝑎</ci><ci id="S3.SS3.p4.3.m3.1.1.2.3.6.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3.6">𝑡</ci><ci id="S3.SS3.p4.3.m3.1.1.2.3.7.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.3.m3.1.1.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3"><times id="S3.SS3.p4.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.1"></times><apply id="S3.SS3.p4.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2"><times id="S3.SS3.p4.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.1"></times><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.2">𝜇</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3">𝑑</ci></apply><ci id="S3.SS3.p4.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3">𝑖</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.4.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">R_{update}\in\mathbb{R}^{\mu\times dim}</annotation></semantics></math> and <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="E_{update}\in\mathbb{R}^{14\times dim}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mrow id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><msub id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2.2" xref="S3.SS3.p4.4.m4.1.1.2.2.cmml">E</mi><mrow id="S3.SS3.p4.4.m4.1.1.2.3" xref="S3.SS3.p4.4.m4.1.1.2.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2.3.2" xref="S3.SS3.p4.4.m4.1.1.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.2.3.1" xref="S3.SS3.p4.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.2.3.3" xref="S3.SS3.p4.4.m4.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.2.3.1a" xref="S3.SS3.p4.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.2.3.4" xref="S3.SS3.p4.4.m4.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.2.3.1b" xref="S3.SS3.p4.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.2.3.5" xref="S3.SS3.p4.4.m4.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.2.3.1c" xref="S3.SS3.p4.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.2.3.6" xref="S3.SS3.p4.4.m4.1.1.2.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.2.3.1d" xref="S3.SS3.p4.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.2.3.7" xref="S3.SS3.p4.4.m4.1.1.2.3.7.cmml">e</mi></mrow></msub><mo id="S3.SS3.p4.4.m4.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.4.m4.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.cmml"><mrow id="S3.SS3.p4.4.m4.1.1.3.3.2" xref="S3.SS3.p4.4.m4.1.1.3.3.2.cmml"><mn id="S3.SS3.p4.4.m4.1.1.3.3.2.2" xref="S3.SS3.p4.4.m4.1.1.3.3.2.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.4.m4.1.1.3.3.2.1" xref="S3.SS3.p4.4.m4.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS3.p4.4.m4.1.1.3.3.2.3" xref="S3.SS3.p4.4.m4.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.3.3.1" xref="S3.SS3.p4.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.3.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.3.3.1a" xref="S3.SS3.p4.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.3.3.4" xref="S3.SS3.p4.4.m4.1.1.3.3.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><in id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1"></in><apply id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2">𝐸</ci><apply id="S3.SS3.p4.4.m4.1.1.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3"><times id="S3.SS3.p4.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.1"></times><ci id="S3.SS3.p4.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.2">𝑢</ci><ci id="S3.SS3.p4.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.3">𝑝</ci><ci id="S3.SS3.p4.4.m4.1.1.2.3.4.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.4">𝑑</ci><ci id="S3.SS3.p4.4.m4.1.1.2.3.5.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.5">𝑎</ci><ci id="S3.SS3.p4.4.m4.1.1.2.3.6.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.6">𝑡</ci><ci id="S3.SS3.p4.4.m4.1.1.2.3.7.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.4.m4.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3"><times id="S3.SS3.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.1"></times><apply id="S3.SS3.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.2"><times id="S3.SS3.p4.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.2.1"></times><cn type="integer" id="S3.SS3.p4.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.2.2">14</cn><ci id="S3.SS3.p4.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.2.3">𝑑</ci></apply><ci id="S3.SS3.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3">𝑖</ci><ci id="S3.SS3.p4.4.m4.1.1.3.3.4.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">E_{update}\in\mathbb{R}^{14\times dim}</annotation></semantics></math>, respectively,</p>
<table id="Sx1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle R_{update}=\textnormal{InterMAF}_{R\leftarrow E}\times E_{V}," display="inline"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml">R</mi><mrow id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.3.2" xref="S3.E8.m1.1.1.1.1.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.3" xref="S3.E8.m1.1.1.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1a" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.4" xref="S3.E8.m1.1.1.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1b" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.5" xref="S3.E8.m1.1.1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1c" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.6" xref="S3.E8.m1.1.1.1.1.2.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.3.1d" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.2.3.7" xref="S3.E8.m1.1.1.1.1.2.3.7.cmml">e</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><msub id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mtext id="S3.E8.m1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2a.cmml">InterMAF</mtext><mrow id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.3.2" xref="S3.E8.m1.1.1.1.1.3.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.E8.m1.1.1.1.1.3.2.3.1" xref="S3.E8.m1.1.1.1.1.3.2.3.1.cmml">←</mo><mi id="S3.E8.m1.1.1.1.1.3.2.3.3" xref="S3.E8.m1.1.1.1.1.3.2.3.3.cmml">E</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">×</mo><msub id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.3.3.2.cmml">E</mi><mi id="S3.E8.m1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.cmml">V</mi></msub></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2">𝑅</ci><apply id="S3.E8.m1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3"><times id="S3.E8.m1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.3.2">𝑢</ci><ci id="S3.E8.m1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3.3">𝑝</ci><ci id="S3.E8.m1.1.1.1.1.2.3.4.cmml" xref="S3.E8.m1.1.1.1.1.2.3.4">𝑑</ci><ci id="S3.E8.m1.1.1.1.1.2.3.5.cmml" xref="S3.E8.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S3.E8.m1.1.1.1.1.2.3.6.cmml" xref="S3.E8.m1.1.1.1.1.2.3.6">𝑡</ci><ci id="S3.E8.m1.1.1.1.1.2.3.7.cmml" xref="S3.E8.m1.1.1.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><times id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"></times><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2"><mtext id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2">InterMAF</mtext></ci><apply id="S3.E8.m1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3"><ci id="S3.E8.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1">←</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2">𝑅</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.3">𝐸</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2">𝐸</ci><ci id="S3.E8.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle R_{update}=\textnormal{InterMAF}_{R\leftarrow E}\times E_{V},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\displaystyle E_{update}=\textnormal{InterMAF}_{R\rightarrow E}\times R_{V}." display="inline"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.2.2.cmml">E</mi><mrow id="S3.E9.m1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.2.3.2" xref="S3.E9.m1.1.1.1.1.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.2.3.1" xref="S3.E9.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.2.3.3" xref="S3.E9.m1.1.1.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.2.3.1a" xref="S3.E9.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.2.3.4" xref="S3.E9.m1.1.1.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.2.3.1b" xref="S3.E9.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.2.3.5" xref="S3.E9.m1.1.1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.2.3.1c" xref="S3.E9.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.2.3.6" xref="S3.E9.m1.1.1.1.1.2.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.2.3.1d" xref="S3.E9.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.2.3.7" xref="S3.E9.m1.1.1.1.1.2.3.7.cmml">e</mi></mrow></msub><mo id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><msub id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml"><mtext id="S3.E9.m1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.3.2.2a.cmml">InterMAF</mtext><mrow id="S3.E9.m1.1.1.1.1.3.2.3" xref="S3.E9.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.3.2" xref="S3.E9.m1.1.1.1.1.3.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.E9.m1.1.1.1.1.3.2.3.1" xref="S3.E9.m1.1.1.1.1.3.2.3.1.cmml">→</mo><mi id="S3.E9.m1.1.1.1.1.3.2.3.3" xref="S3.E9.m1.1.1.1.1.3.2.3.3.cmml">E</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E9.m1.1.1.1.1.3.1" xref="S3.E9.m1.1.1.1.1.3.1.cmml">×</mo><msub id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.3.3.2.cmml">R</mi><mi id="S3.E9.m1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.3.3.3.cmml">V</mi></msub></mrow></mrow><mo lspace="0em" id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"></eq><apply id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.2.2">𝐸</ci><apply id="S3.E9.m1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.2.3"><times id="S3.E9.m1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.2.3.1"></times><ci id="S3.E9.m1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.2.3.2">𝑢</ci><ci id="S3.E9.m1.1.1.1.1.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.2.3.3">𝑝</ci><ci id="S3.E9.m1.1.1.1.1.2.3.4.cmml" xref="S3.E9.m1.1.1.1.1.2.3.4">𝑑</ci><ci id="S3.E9.m1.1.1.1.1.2.3.5.cmml" xref="S3.E9.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S3.E9.m1.1.1.1.1.2.3.6.cmml" xref="S3.E9.m1.1.1.1.1.2.3.6">𝑡</ci><ci id="S3.E9.m1.1.1.1.1.2.3.7.cmml" xref="S3.E9.m1.1.1.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><times id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.1"></times><apply id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2"><mtext id="S3.E9.m1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2">InterMAF</mtext></ci><apply id="S3.E9.m1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3"><ci id="S3.E9.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.1">→</ci><ci id="S3.E9.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.2">𝑅</ci><ci id="S3.E9.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.3">𝐸</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.2">𝑅</ci><ci id="S3.E9.m1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle E_{update}=\textnormal{InterMAF}_{R\rightarrow E}\times R_{V}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.6" class="ltx_p">where <math id="S3.SS3.p4.5.m1.1" class="ltx_Math" alttext="E_{V}" display="inline"><semantics id="S3.SS3.p4.5.m1.1a"><msub id="S3.SS3.p4.5.m1.1.1" xref="S3.SS3.p4.5.m1.1.1.cmml"><mi id="S3.SS3.p4.5.m1.1.1.2" xref="S3.SS3.p4.5.m1.1.1.2.cmml">E</mi><mi id="S3.SS3.p4.5.m1.1.1.3" xref="S3.SS3.p4.5.m1.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m1.1b"><apply id="S3.SS3.p4.5.m1.1.1.cmml" xref="S3.SS3.p4.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m1.1.1.1.cmml" xref="S3.SS3.p4.5.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.5.m1.1.1.2.cmml" xref="S3.SS3.p4.5.m1.1.1.2">𝐸</ci><ci id="S3.SS3.p4.5.m1.1.1.3.cmml" xref="S3.SS3.p4.5.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m1.1c">E_{V}</annotation></semantics></math> and <math id="S3.SS3.p4.6.m2.1" class="ltx_Math" alttext="R_{V}" display="inline"><semantics id="S3.SS3.p4.6.m2.1a"><msub id="S3.SS3.p4.6.m2.1.1" xref="S3.SS3.p4.6.m2.1.1.cmml"><mi id="S3.SS3.p4.6.m2.1.1.2" xref="S3.SS3.p4.6.m2.1.1.2.cmml">R</mi><mi id="S3.SS3.p4.6.m2.1.1.3" xref="S3.SS3.p4.6.m2.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m2.1b"><apply id="S3.SS3.p4.6.m2.1.1.cmml" xref="S3.SS3.p4.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m2.1.1.1.cmml" xref="S3.SS3.p4.6.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.6.m2.1.1.2.cmml" xref="S3.SS3.p4.6.m2.1.1.2">𝑅</ci><ci id="S3.SS3.p4.6.m2.1.1.3.cmml" xref="S3.SS3.p4.6.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m2.1c">R_{V}</annotation></semantics></math> are the un-weighted information flows(value features) to update visual region features and word features in Eq. (<a href="#S3.E5" title="In 3.3 Inter-modality Attention Flow ‣ 3 Dynamic Fusion with Intra- and Inter-modality Attention Flow for VQA ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), and the two InterMAF matrices are used to weight such information flows.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.2" class="ltx_p">After acquiring the updated visual and word features, we concatenate them with original visual features <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">R</annotation></semantics></math> and word features <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mi id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><ci id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">E</annotation></semantics></math>. A fully connected layer is utilized to transform the concatenated features into output features,</p>
<table id="Sx1.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.2" class="ltx_Math" alttext="\displaystyle R=\textnormal{Linear}([R,\,R_{update}]^{T};\theta_{RT})," display="inline"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.4" xref="S3.E10.m1.2.2.1.1.4.cmml">R</mi><mo id="S3.E10.m1.2.2.1.1.3" xref="S3.E10.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E10.m1.2.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.cmml"><mtext id="S3.E10.m1.2.2.1.1.2.4" xref="S3.E10.m1.2.2.1.1.2.4a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.2.3" xref="S3.E10.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E10.m1.2.2.1.1.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.2.2.2.3" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml">(</mo><msup id="S3.E10.m1.2.2.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.2.cmml">[</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">R</mi><mo rspace="0.337em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.4" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1b" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.5" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1c" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.6" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1d" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.7" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.7.cmml">e</mi></mrow></msub><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.2.cmml">]</mo></mrow><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S3.E10.m1.2.2.1.1.2.2.2.4" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml">;</mo><msub id="S3.E10.m1.2.2.1.1.2.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.1.1.2.2.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E10.m1.2.2.1.1.2.2.2.2.3" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.E10.m1.2.2.1.1.2.2.2.2.3.2" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.2.2.2.2.3.1" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S3.E10.m1.2.2.1.1.2.2.2.5" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m1.2.2.1.2" xref="S3.E10.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1"><eq id="S3.E10.m1.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.3"></eq><ci id="S3.E10.m1.2.2.1.1.4.cmml" xref="S3.E10.m1.2.2.1.1.4">𝑅</ci><apply id="S3.E10.m1.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2"><times id="S3.E10.m1.2.2.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.3"></times><ci id="S3.E10.m1.2.2.1.1.2.4a.cmml" xref="S3.E10.m1.2.2.1.1.2.4"><mtext id="S3.E10.m1.2.2.1.1.2.4.cmml" xref="S3.E10.m1.2.2.1.1.2.4">Linear</mtext></ci><list id="S3.E10.m1.2.2.1.1.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2"><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1">superscript</csymbol><interval closure="closed" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1"><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝑅</ci><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑅</ci><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3"><times id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑢</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑝</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.4">𝑑</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.5">𝑎</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.6.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.6">𝑡</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.7.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.3.7">𝑒</ci></apply></apply></interval><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E10.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.2">𝜃</ci><apply id="S3.E10.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3"><times id="S3.E10.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.1"></times><ci id="S3.E10.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.2">𝑅</ci><ci id="S3.E10.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.3">𝑇</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\displaystyle R=\textnormal{Linear}([R,\,R_{update}]^{T};\theta_{RT}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11.m1.2" class="ltx_Math" alttext="\displaystyle E=\textnormal{Linear}([E,\,E_{update}]^{T};\theta_{ET})." display="inline"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.2.1" xref="S3.E11.m1.2.2.1.1.cmml"><mrow id="S3.E11.m1.2.2.1.1" xref="S3.E11.m1.2.2.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.4" xref="S3.E11.m1.2.2.1.1.4.cmml">E</mi><mo id="S3.E11.m1.2.2.1.1.3" xref="S3.E11.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E11.m1.2.2.1.1.2" xref="S3.E11.m1.2.2.1.1.2.cmml"><mtext id="S3.E11.m1.2.2.1.1.2.4" xref="S3.E11.m1.2.2.1.1.2.4a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.1.1.2.3" xref="S3.E11.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E11.m1.2.2.1.1.2.2.2" xref="S3.E11.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E11.m1.2.2.1.1.2.2.2.3" xref="S3.E11.m1.2.2.1.1.2.2.3.cmml">(</mo><msup id="S3.E11.m1.2.2.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml">[</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">E</mi><mo rspace="0.337em" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">E</mi><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.4" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1b" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.5" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1c" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.6" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1d" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.7" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.7.cmml">e</mi></mrow></msub><mo stretchy="false" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml">]</mo></mrow><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S3.E11.m1.2.2.1.1.2.2.2.4" xref="S3.E11.m1.2.2.1.1.2.2.3.cmml">;</mo><msub id="S3.E11.m1.2.2.1.1.2.2.2.2" xref="S3.E11.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E11.m1.2.2.1.1.2.2.2.2.2" xref="S3.E11.m1.2.2.1.1.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E11.m1.2.2.1.1.2.2.2.2.3" xref="S3.E11.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.E11.m1.2.2.1.1.2.2.2.2.3.2" xref="S3.E11.m1.2.2.1.1.2.2.2.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.1.1.2.2.2.2.3.1" xref="S3.E11.m1.2.2.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E11.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.E11.m1.2.2.1.1.2.2.2.2.3.3.cmml">T</mi></mrow></msub><mo stretchy="false" id="S3.E11.m1.2.2.1.1.2.2.2.5" xref="S3.E11.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E11.m1.2.2.1.2" xref="S3.E11.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.2.1.1.cmml" xref="S3.E11.m1.2.2.1"><eq id="S3.E11.m1.2.2.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.3"></eq><ci id="S3.E11.m1.2.2.1.1.4.cmml" xref="S3.E11.m1.2.2.1.1.4">𝐸</ci><apply id="S3.E11.m1.2.2.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.2"><times id="S3.E11.m1.2.2.1.1.2.3.cmml" xref="S3.E11.m1.2.2.1.1.2.3"></times><ci id="S3.E11.m1.2.2.1.1.2.4a.cmml" xref="S3.E11.m1.2.2.1.1.2.4"><mtext id="S3.E11.m1.2.2.1.1.2.4.cmml" xref="S3.E11.m1.2.2.1.1.2.4">Linear</mtext></ci><list id="S3.E11.m1.2.2.1.1.2.2.3.cmml" xref="S3.E11.m1.2.2.1.1.2.2.2"><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1">superscript</csymbol><interval closure="closed" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1"><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝐸</ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝐸</ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3"><times id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑢</ci><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑝</ci><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.4">𝑑</ci><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.5">𝑎</ci><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.6.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.6">𝑡</ci><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.7.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.7">𝑒</ci></apply></apply></interval><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E11.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.1.1.2.2.2.2.2">𝜃</ci><apply id="S3.E11.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.1.1.2.2.2.2.3"><times id="S3.E11.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.E11.m1.2.2.1.1.2.2.2.2.3.1"></times><ci id="S3.E11.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.E11.m1.2.2.1.1.2.2.2.2.3.2">𝐸</ci><ci id="S3.E11.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.E11.m1.2.2.1.1.2.2.2.2.3.3">𝑇</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\displaystyle E=\textnormal{Linear}([E,\,E_{update}]^{T};\theta_{ET}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.1" class="ltx_p">The output features by the InterMAF module would then be fed into the following Dynamic Intra-modality Attention Flow module for learning intra-modality information flows to further update the visual region and word features for capturing region-to-region and word-to-word relations.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Dynamic Intra-modality Attention Flow</h3>

<figure id="S3.F2" class="ltx_figure"><img src="/html/1812.05252/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="383" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">Illustration of the proposed Dynamic Intra-Modality Attention Flow module. Only intra-modality attention flow within the visual modality conditioned on question are shown. By average pooling over question features, the conditional gating vector can be acquired for controlling the information flows among region features. Attention will focus on question related information flows. Row-wise softmax is applied to obtain the attention weight.</span></figcaption>
</figure>
<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">The input visual regions and word features of DyIntraMAF have encoded cross-modal relations between visual regions and words. However, we argue that relationships within each modality are complementary to the cross-modal relations and should be taken into account for improving the VQA accuracy. For example, for the question, “who is above the skateboard ?”, the intra-modality module should relate the region above the skateboard and the skateboard region to infer the final answer. Therefore, we propose the Dynamic Intra-modality Attention Flow (DyIntraMAF) module for modelling such within-modality relations with a dynamic attention mechanism. The implementation of DyIntraMAF is illustrated at Figure <a href="#S3.F2" title="Figure 2 ‣ 3.4 Dynamic Intra-modality Attention Flow ‣ 3 Dynamic Fusion with Intra- and Inter-modality Attention Flow for VQA ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">The naive intra-modality matrices to capture the importance between regions and between words could be defined similarly to Eq. (<a href="#S3.E5" title="In 3.3 Inter-modality Attention Flow ‣ 3 Dynamic Fusion with Intra- and Inter-modality Attention Flow for VQA ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) as,</p>
<table id="Sx1.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12.m1.2" class="ltx_Math" alttext="\displaystyle\textnormal{IntraMAF}_{R\leftarrow R}=\textnormal{softmax}(\frac{R_{Q}R_{K}^{T}}{\sqrt{dim}})," display="inline"><semantics id="S3.E12.m1.2a"><mrow id="S3.E12.m1.2.2.1" xref="S3.E12.m1.2.2.1.1.cmml"><mrow id="S3.E12.m1.2.2.1.1" xref="S3.E12.m1.2.2.1.1.cmml"><msub id="S3.E12.m1.2.2.1.1.2" xref="S3.E12.m1.2.2.1.1.2.cmml"><mtext id="S3.E12.m1.2.2.1.1.2.2" xref="S3.E12.m1.2.2.1.1.2.2a.cmml">IntraMAF</mtext><mrow id="S3.E12.m1.2.2.1.1.2.3" xref="S3.E12.m1.2.2.1.1.2.3.cmml"><mi id="S3.E12.m1.2.2.1.1.2.3.2" xref="S3.E12.m1.2.2.1.1.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.E12.m1.2.2.1.1.2.3.1" xref="S3.E12.m1.2.2.1.1.2.3.1.cmml">←</mo><mi id="S3.E12.m1.2.2.1.1.2.3.3" xref="S3.E12.m1.2.2.1.1.2.3.3.cmml">R</mi></mrow></msub><mo id="S3.E12.m1.2.2.1.1.1" xref="S3.E12.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E12.m1.2.2.1.1.3" xref="S3.E12.m1.2.2.1.1.3.cmml"><mtext id="S3.E12.m1.2.2.1.1.3.2" xref="S3.E12.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.3.1" xref="S3.E12.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E12.m1.2.2.1.1.3.3.2" xref="S3.E12.m1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.2.2.1.1.3.3.2.1" xref="S3.E12.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><mfrac id="S3.E12.m1.1.1a" xref="S3.E12.m1.1.1.cmml"><mrow id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml"><msub id="S3.E12.m1.1.1.2.2" xref="S3.E12.m1.1.1.2.2.cmml"><mi id="S3.E12.m1.1.1.2.2.2" xref="S3.E12.m1.1.1.2.2.2.cmml">R</mi><mi id="S3.E12.m1.1.1.2.2.3" xref="S3.E12.m1.1.1.2.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.2.1" xref="S3.E12.m1.1.1.2.1.cmml">​</mo><msubsup id="S3.E12.m1.1.1.2.3" xref="S3.E12.m1.1.1.2.3.cmml"><mi id="S3.E12.m1.1.1.2.3.2.2" xref="S3.E12.m1.1.1.2.3.2.2.cmml">R</mi><mi id="S3.E12.m1.1.1.2.3.2.3" xref="S3.E12.m1.1.1.2.3.2.3.cmml">K</mi><mi id="S3.E12.m1.1.1.2.3.3" xref="S3.E12.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3.cmml"><mrow id="S3.E12.m1.1.1.3.2" xref="S3.E12.m1.1.1.3.2.cmml"><mi id="S3.E12.m1.1.1.3.2.2" xref="S3.E12.m1.1.1.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.3.2.1" xref="S3.E12.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E12.m1.1.1.3.2.3" xref="S3.E12.m1.1.1.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.3.2.1a" xref="S3.E12.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E12.m1.1.1.3.2.4" xref="S3.E12.m1.1.1.3.2.4.cmml">m</mi></mrow></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E12.m1.2.2.1.1.3.3.2.2" xref="S3.E12.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m1.2.2.1.2" xref="S3.E12.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.2b"><apply id="S3.E12.m1.2.2.1.1.cmml" xref="S3.E12.m1.2.2.1"><eq id="S3.E12.m1.2.2.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1"></eq><apply id="S3.E12.m1.2.2.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.1.1.2.1.cmml" xref="S3.E12.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E12.m1.2.2.1.1.2.2a.cmml" xref="S3.E12.m1.2.2.1.1.2.2"><mtext id="S3.E12.m1.2.2.1.1.2.2.cmml" xref="S3.E12.m1.2.2.1.1.2.2">IntraMAF</mtext></ci><apply id="S3.E12.m1.2.2.1.1.2.3.cmml" xref="S3.E12.m1.2.2.1.1.2.3"><ci id="S3.E12.m1.2.2.1.1.2.3.1.cmml" xref="S3.E12.m1.2.2.1.1.2.3.1">←</ci><ci id="S3.E12.m1.2.2.1.1.2.3.2.cmml" xref="S3.E12.m1.2.2.1.1.2.3.2">𝑅</ci><ci id="S3.E12.m1.2.2.1.1.2.3.3.cmml" xref="S3.E12.m1.2.2.1.1.2.3.3">𝑅</ci></apply></apply><apply id="S3.E12.m1.2.2.1.1.3.cmml" xref="S3.E12.m1.2.2.1.1.3"><times id="S3.E12.m1.2.2.1.1.3.1.cmml" xref="S3.E12.m1.2.2.1.1.3.1"></times><ci id="S3.E12.m1.2.2.1.1.3.2a.cmml" xref="S3.E12.m1.2.2.1.1.3.2"><mtext id="S3.E12.m1.2.2.1.1.3.2.cmml" xref="S3.E12.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.3.3.2"><divide id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.3.3.2"></divide><apply id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2"><times id="S3.E12.m1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.2.1"></times><apply id="S3.E12.m1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.2.2.1.cmml" xref="S3.E12.m1.1.1.2.2">subscript</csymbol><ci id="S3.E12.m1.1.1.2.2.2.cmml" xref="S3.E12.m1.1.1.2.2.2">𝑅</ci><ci id="S3.E12.m1.1.1.2.2.3.cmml" xref="S3.E12.m1.1.1.2.2.3">𝑄</ci></apply><apply id="S3.E12.m1.1.1.2.3.cmml" xref="S3.E12.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.2.3.1.cmml" xref="S3.E12.m1.1.1.2.3">superscript</csymbol><apply id="S3.E12.m1.1.1.2.3.2.cmml" xref="S3.E12.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.2.3.2.1.cmml" xref="S3.E12.m1.1.1.2.3">subscript</csymbol><ci id="S3.E12.m1.1.1.2.3.2.2.cmml" xref="S3.E12.m1.1.1.2.3.2.2">𝑅</ci><ci id="S3.E12.m1.1.1.2.3.2.3.cmml" xref="S3.E12.m1.1.1.2.3.2.3">𝐾</ci></apply><ci id="S3.E12.m1.1.1.2.3.3.cmml" xref="S3.E12.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3"><root id="S3.E12.m1.1.1.3a.cmml" xref="S3.E12.m1.1.1.3"></root><apply id="S3.E12.m1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.3.2"><times id="S3.E12.m1.1.1.3.2.1.cmml" xref="S3.E12.m1.1.1.3.2.1"></times><ci id="S3.E12.m1.1.1.3.2.2.cmml" xref="S3.E12.m1.1.1.3.2.2">𝑑</ci><ci id="S3.E12.m1.1.1.3.2.3.cmml" xref="S3.E12.m1.1.1.3.2.3">𝑖</ci><ci id="S3.E12.m1.1.1.3.2.4.cmml" xref="S3.E12.m1.1.1.3.2.4">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.2c">\displaystyle\textnormal{IntraMAF}_{R\leftarrow R}=\textnormal{softmax}(\frac{R_{Q}R_{K}^{T}}{\sqrt{dim}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13.m1.2" class="ltx_Math" alttext="\displaystyle\textnormal{IntraMAF}_{E\leftarrow E}=\textnormal{softmax}(\frac{E_{Q}E_{K}^{T}}{\sqrt{dim}})." display="inline"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2.1" xref="S3.E13.m1.2.2.1.1.cmml"><mrow id="S3.E13.m1.2.2.1.1" xref="S3.E13.m1.2.2.1.1.cmml"><msub id="S3.E13.m1.2.2.1.1.2" xref="S3.E13.m1.2.2.1.1.2.cmml"><mtext id="S3.E13.m1.2.2.1.1.2.2" xref="S3.E13.m1.2.2.1.1.2.2a.cmml">IntraMAF</mtext><mrow id="S3.E13.m1.2.2.1.1.2.3" xref="S3.E13.m1.2.2.1.1.2.3.cmml"><mi id="S3.E13.m1.2.2.1.1.2.3.2" xref="S3.E13.m1.2.2.1.1.2.3.2.cmml">E</mi><mo stretchy="false" id="S3.E13.m1.2.2.1.1.2.3.1" xref="S3.E13.m1.2.2.1.1.2.3.1.cmml">←</mo><mi id="S3.E13.m1.2.2.1.1.2.3.3" xref="S3.E13.m1.2.2.1.1.2.3.3.cmml">E</mi></mrow></msub><mo id="S3.E13.m1.2.2.1.1.1" xref="S3.E13.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.2.2.1.1.3" xref="S3.E13.m1.2.2.1.1.3.cmml"><mtext id="S3.E13.m1.2.2.1.1.3.2" xref="S3.E13.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.3.1" xref="S3.E13.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E13.m1.2.2.1.1.3.3.2" xref="S3.E13.m1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.1.1.3.3.2.1" xref="S3.E13.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><mfrac id="S3.E13.m1.1.1a" xref="S3.E13.m1.1.1.cmml"><mrow id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml"><msub id="S3.E13.m1.1.1.2.2" xref="S3.E13.m1.1.1.2.2.cmml"><mi id="S3.E13.m1.1.1.2.2.2" xref="S3.E13.m1.1.1.2.2.2.cmml">E</mi><mi id="S3.E13.m1.1.1.2.2.3" xref="S3.E13.m1.1.1.2.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.2.1" xref="S3.E13.m1.1.1.2.1.cmml">​</mo><msubsup id="S3.E13.m1.1.1.2.3" xref="S3.E13.m1.1.1.2.3.cmml"><mi id="S3.E13.m1.1.1.2.3.2.2" xref="S3.E13.m1.1.1.2.3.2.2.cmml">E</mi><mi id="S3.E13.m1.1.1.2.3.2.3" xref="S3.E13.m1.1.1.2.3.2.3.cmml">K</mi><mi id="S3.E13.m1.1.1.2.3.3" xref="S3.E13.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3.cmml"><mrow id="S3.E13.m1.1.1.3.2" xref="S3.E13.m1.1.1.3.2.cmml"><mi id="S3.E13.m1.1.1.3.2.2" xref="S3.E13.m1.1.1.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.2.1" xref="S3.E13.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.2.3" xref="S3.E13.m1.1.1.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.2.1a" xref="S3.E13.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.2.4" xref="S3.E13.m1.1.1.3.2.4.cmml">m</mi></mrow></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E13.m1.2.2.1.1.3.3.2.2" xref="S3.E13.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E13.m1.2.2.1.2" xref="S3.E13.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.1.1.cmml" xref="S3.E13.m1.2.2.1"><eq id="S3.E13.m1.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1"></eq><apply id="S3.E13.m1.2.2.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.2.1.cmml" xref="S3.E13.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.2.2a.cmml" xref="S3.E13.m1.2.2.1.1.2.2"><mtext id="S3.E13.m1.2.2.1.1.2.2.cmml" xref="S3.E13.m1.2.2.1.1.2.2">IntraMAF</mtext></ci><apply id="S3.E13.m1.2.2.1.1.2.3.cmml" xref="S3.E13.m1.2.2.1.1.2.3"><ci id="S3.E13.m1.2.2.1.1.2.3.1.cmml" xref="S3.E13.m1.2.2.1.1.2.3.1">←</ci><ci id="S3.E13.m1.2.2.1.1.2.3.2.cmml" xref="S3.E13.m1.2.2.1.1.2.3.2">𝐸</ci><ci id="S3.E13.m1.2.2.1.1.2.3.3.cmml" xref="S3.E13.m1.2.2.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.E13.m1.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.3"><times id="S3.E13.m1.2.2.1.1.3.1.cmml" xref="S3.E13.m1.2.2.1.1.3.1"></times><ci id="S3.E13.m1.2.2.1.1.3.2a.cmml" xref="S3.E13.m1.2.2.1.1.3.2"><mtext id="S3.E13.m1.2.2.1.1.3.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.3.3.2"><divide id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.3.3.2"></divide><apply id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2"><times id="S3.E13.m1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.2.1"></times><apply id="S3.E13.m1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.2.2.1.cmml" xref="S3.E13.m1.1.1.2.2">subscript</csymbol><ci id="S3.E13.m1.1.1.2.2.2.cmml" xref="S3.E13.m1.1.1.2.2.2">𝐸</ci><ci id="S3.E13.m1.1.1.2.2.3.cmml" xref="S3.E13.m1.1.1.2.2.3">𝑄</ci></apply><apply id="S3.E13.m1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.2.3.1.cmml" xref="S3.E13.m1.1.1.2.3">superscript</csymbol><apply id="S3.E13.m1.1.1.2.3.2.cmml" xref="S3.E13.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.2.3.2.1.cmml" xref="S3.E13.m1.1.1.2.3">subscript</csymbol><ci id="S3.E13.m1.1.1.2.3.2.2.cmml" xref="S3.E13.m1.1.1.2.3.2.2">𝐸</ci><ci id="S3.E13.m1.1.1.2.3.2.3.cmml" xref="S3.E13.m1.1.1.2.3.2.3">𝐾</ci></apply><ci id="S3.E13.m1.1.1.2.3.3.cmml" xref="S3.E13.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E13.m1.1.1.3.cmml" xref="S3.E13.m1.1.1.3"><root id="S3.E13.m1.1.1.3a.cmml" xref="S3.E13.m1.1.1.3"></root><apply id="S3.E13.m1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.3.2"><times id="S3.E13.m1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.3.2.1"></times><ci id="S3.E13.m1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.3.2.2">𝑑</ci><ci id="S3.E13.m1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.3.2.3">𝑖</ci><ci id="S3.E13.m1.1.1.3.2.4.cmml" xref="S3.E13.m1.1.1.3.2.4">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">\displaystyle\textnormal{IntraMAF}_{E\leftarrow E}=\textnormal{softmax}(\frac{E_{Q}E_{K}^{T}}{\sqrt{dim}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.2" class="ltx_p">The dot products are utilized to estimate their within-modality importance between the same modality’s query and key features.
Such weight matrices could then be used to weight the information flows transmitted within each modality.
Modelling within-modality relationships have been shown to be effective in object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, image captioning
and BERT word embedding pretraining <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.1" class="ltx_p">However, the naive IntraMAF module only utilizes within-modality information for estimating the region-to-region and word-to-word importance. Some relations are important but could only be identified conditioned on information from the other modality. For instance, even for the same input image, relations between different visual region pairs should be weighted differently according to different questions. We therefore propose a Dynamic Intra-modality Attention Flow (DyIntraMAF) module to estimate within-modality relation importance conditioned on the information from the other modality.</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.4" class="ltx_p">To summarize the conditioning information from the other modality, we average pool the visual region features along the object-index dimension and the word features along the word-index dimension. The average pooled features of both modalities are then transformed to a <math id="S3.SS4.p4.1.m1.1" class="ltx_Math" alttext="dim" display="inline"><semantics id="S3.SS4.p4.1.m1.1a"><mrow id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p4.1.m1.1.1.1" xref="S3.SS4.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p4.1.m1.1.1.1a" xref="S3.SS4.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS4.p4.1.m1.1.1.4" xref="S3.SS4.p4.1.m1.1.1.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><times id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1.1"></times><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝑑</ci><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">𝑖</ci><ci id="S3.SS4.p4.1.m1.1.1.4.cmml" xref="S3.SS4.p4.1.m1.1.1.4">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">dim</annotation></semantics></math>-dimensional feature vector to match the dimension of the query and key features <math id="S3.SS4.p4.2.m2.4" class="ltx_Math" alttext="R_{Q},R_{K},E_{Q},E_{K}" display="inline"><semantics id="S3.SS4.p4.2.m2.4a"><mrow id="S3.SS4.p4.2.m2.4.4.4" xref="S3.SS4.p4.2.m2.4.4.5.cmml"><msub id="S3.SS4.p4.2.m2.1.1.1.1" xref="S3.SS4.p4.2.m2.1.1.1.1.cmml"><mi id="S3.SS4.p4.2.m2.1.1.1.1.2" xref="S3.SS4.p4.2.m2.1.1.1.1.2.cmml">R</mi><mi id="S3.SS4.p4.2.m2.1.1.1.1.3" xref="S3.SS4.p4.2.m2.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.SS4.p4.2.m2.4.4.4.5" xref="S3.SS4.p4.2.m2.4.4.5.cmml">,</mo><msub id="S3.SS4.p4.2.m2.2.2.2.2" xref="S3.SS4.p4.2.m2.2.2.2.2.cmml"><mi id="S3.SS4.p4.2.m2.2.2.2.2.2" xref="S3.SS4.p4.2.m2.2.2.2.2.2.cmml">R</mi><mi id="S3.SS4.p4.2.m2.2.2.2.2.3" xref="S3.SS4.p4.2.m2.2.2.2.2.3.cmml">K</mi></msub><mo id="S3.SS4.p4.2.m2.4.4.4.6" xref="S3.SS4.p4.2.m2.4.4.5.cmml">,</mo><msub id="S3.SS4.p4.2.m2.3.3.3.3" xref="S3.SS4.p4.2.m2.3.3.3.3.cmml"><mi id="S3.SS4.p4.2.m2.3.3.3.3.2" xref="S3.SS4.p4.2.m2.3.3.3.3.2.cmml">E</mi><mi id="S3.SS4.p4.2.m2.3.3.3.3.3" xref="S3.SS4.p4.2.m2.3.3.3.3.3.cmml">Q</mi></msub><mo id="S3.SS4.p4.2.m2.4.4.4.7" xref="S3.SS4.p4.2.m2.4.4.5.cmml">,</mo><msub id="S3.SS4.p4.2.m2.4.4.4.4" xref="S3.SS4.p4.2.m2.4.4.4.4.cmml"><mi id="S3.SS4.p4.2.m2.4.4.4.4.2" xref="S3.SS4.p4.2.m2.4.4.4.4.2.cmml">E</mi><mi id="S3.SS4.p4.2.m2.4.4.4.4.3" xref="S3.SS4.p4.2.m2.4.4.4.4.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.4b"><list id="S3.SS4.p4.2.m2.4.4.5.cmml" xref="S3.SS4.p4.2.m2.4.4.4"><apply id="S3.SS4.p4.2.m2.1.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1.2">𝑅</ci><ci id="S3.SS4.p4.2.m2.1.1.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS4.p4.2.m2.2.2.2.2.cmml" xref="S3.SS4.p4.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.2.2.2.2.1.cmml" xref="S3.SS4.p4.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p4.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.p4.2.m2.2.2.2.2.2">𝑅</ci><ci id="S3.SS4.p4.2.m2.2.2.2.2.3.cmml" xref="S3.SS4.p4.2.m2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS4.p4.2.m2.3.3.3.3.cmml" xref="S3.SS4.p4.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.3.3.3.3.1.cmml" xref="S3.SS4.p4.2.m2.3.3.3.3">subscript</csymbol><ci id="S3.SS4.p4.2.m2.3.3.3.3.2.cmml" xref="S3.SS4.p4.2.m2.3.3.3.3.2">𝐸</ci><ci id="S3.SS4.p4.2.m2.3.3.3.3.3.cmml" xref="S3.SS4.p4.2.m2.3.3.3.3.3">𝑄</ci></apply><apply id="S3.SS4.p4.2.m2.4.4.4.4.cmml" xref="S3.SS4.p4.2.m2.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.4.4.4.4.1.cmml" xref="S3.SS4.p4.2.m2.4.4.4.4">subscript</csymbol><ci id="S3.SS4.p4.2.m2.4.4.4.4.2.cmml" xref="S3.SS4.p4.2.m2.4.4.4.4.2">𝐸</ci><ci id="S3.SS4.p4.2.m2.4.4.4.4.3.cmml" xref="S3.SS4.p4.2.m2.4.4.4.4.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.4c">R_{Q},R_{K},E_{Q},E_{K}</annotation></semantics></math>. The <math id="S3.SS4.p4.3.m3.1" class="ltx_Math" alttext="dim" display="inline"><semantics id="S3.SS4.p4.3.m3.1a"><mrow id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml"><mi id="S3.SS4.p4.3.m3.1.1.2" xref="S3.SS4.p4.3.m3.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p4.3.m3.1.1.1" xref="S3.SS4.p4.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS4.p4.3.m3.1.1.3" xref="S3.SS4.p4.3.m3.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p4.3.m3.1.1.1a" xref="S3.SS4.p4.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS4.p4.3.m3.1.1.4" xref="S3.SS4.p4.3.m3.1.1.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><apply id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1"><times id="S3.SS4.p4.3.m3.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1.1"></times><ci id="S3.SS4.p4.3.m3.1.1.2.cmml" xref="S3.SS4.p4.3.m3.1.1.2">𝑑</ci><ci id="S3.SS4.p4.3.m3.1.1.3.cmml" xref="S3.SS4.p4.3.m3.1.1.3">𝑖</ci><ci id="S3.SS4.p4.3.m3.1.1.4.cmml" xref="S3.SS4.p4.3.m3.1.1.4">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">dim</annotation></semantics></math>-dimensional feature vector of each modality is then processed by a sigmoid non-linearity function <math id="S3.SS4.p4.4.m4.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S3.SS4.p4.4.m4.1a"><mrow id="S3.SS4.p4.4.m4.1.2" xref="S3.SS4.p4.4.m4.1.2.cmml"><mi id="S3.SS4.p4.4.m4.1.2.2" xref="S3.SS4.p4.4.m4.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p4.4.m4.1.2.1" xref="S3.SS4.p4.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS4.p4.4.m4.1.2.3.2" xref="S3.SS4.p4.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS4.p4.4.m4.1.2.3.2.1" xref="S3.SS4.p4.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p4.4.m4.1.1" xref="S3.SS4.p4.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS4.p4.4.m4.1.2.3.2.2" xref="S3.SS4.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.1b"><apply id="S3.SS4.p4.4.m4.1.2.cmml" xref="S3.SS4.p4.4.m4.1.2"><times id="S3.SS4.p4.4.m4.1.2.1.cmml" xref="S3.SS4.p4.4.m4.1.2.1"></times><ci id="S3.SS4.p4.4.m4.1.2.2.cmml" xref="S3.SS4.p4.4.m4.1.2.2">𝜎</ci><ci id="S3.SS4.p4.4.m4.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.1c">\sigma(\cdot)</annotation></semantics></math> to generate channel-wise conditioning gates for the other modality,</p>
<table id="Sx1.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E14.m1.2" class="ltx_Math" alttext="\displaystyle G_{R\rightarrow E}=\sigma(\text{Linear}(\text{Avg\_Pool}(R);\theta_{RP}))," display="inline"><semantics id="S3.E14.m1.2a"><mrow id="S3.E14.m1.2.2.1" xref="S3.E14.m1.2.2.1.1.cmml"><mrow id="S3.E14.m1.2.2.1.1" xref="S3.E14.m1.2.2.1.1.cmml"><msub id="S3.E14.m1.2.2.1.1.3" xref="S3.E14.m1.2.2.1.1.3.cmml"><mi id="S3.E14.m1.2.2.1.1.3.2" xref="S3.E14.m1.2.2.1.1.3.2.cmml">G</mi><mrow id="S3.E14.m1.2.2.1.1.3.3" xref="S3.E14.m1.2.2.1.1.3.3.cmml"><mi id="S3.E14.m1.2.2.1.1.3.3.2" xref="S3.E14.m1.2.2.1.1.3.3.2.cmml">R</mi><mo stretchy="false" id="S3.E14.m1.2.2.1.1.3.3.1" xref="S3.E14.m1.2.2.1.1.3.3.1.cmml">→</mo><mi id="S3.E14.m1.2.2.1.1.3.3.3" xref="S3.E14.m1.2.2.1.1.3.3.3.cmml">E</mi></mrow></msub><mo id="S3.E14.m1.2.2.1.1.2" xref="S3.E14.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.2.2.1.1.1" xref="S3.E14.m1.2.2.1.1.1.cmml"><mi id="S3.E14.m1.2.2.1.1.1.3" xref="S3.E14.m1.2.2.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.2.2.1.1.1.2" xref="S3.E14.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.2.2.1.1.1.1.1.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.cmml"><mtext id="S3.E14.m1.2.2.1.1.1.1.1.1.4" xref="S3.E14.m1.2.2.1.1.1.1.1.1.4a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E14.m1.2.2.1.1.1.1.1.1.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2a.cmml">Avg_Pool</mtext><mo lspace="0em" rspace="0em" id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml">R</mi><mo stretchy="false" id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.4" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml">P</mi></mrow></msub><mo stretchy="false" id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.5" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E14.m1.2.2.1.1.1.1.1.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E14.m1.2.2.1.2" xref="S3.E14.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.2b"><apply id="S3.E14.m1.2.2.1.1.cmml" xref="S3.E14.m1.2.2.1"><eq id="S3.E14.m1.2.2.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.2"></eq><apply id="S3.E14.m1.2.2.1.1.3.cmml" xref="S3.E14.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.3.1.cmml" xref="S3.E14.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.3.2.cmml" xref="S3.E14.m1.2.2.1.1.3.2">𝐺</ci><apply id="S3.E14.m1.2.2.1.1.3.3.cmml" xref="S3.E14.m1.2.2.1.1.3.3"><ci id="S3.E14.m1.2.2.1.1.3.3.1.cmml" xref="S3.E14.m1.2.2.1.1.3.3.1">→</ci><ci id="S3.E14.m1.2.2.1.1.3.3.2.cmml" xref="S3.E14.m1.2.2.1.1.3.3.2">𝑅</ci><ci id="S3.E14.m1.2.2.1.1.3.3.3.cmml" xref="S3.E14.m1.2.2.1.1.3.3.3">𝐸</ci></apply></apply><apply id="S3.E14.m1.2.2.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1"><times id="S3.E14.m1.2.2.1.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.1.2"></times><ci id="S3.E14.m1.2.2.1.1.1.3.cmml" xref="S3.E14.m1.2.2.1.1.1.3">𝜎</ci><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1"><times id="S3.E14.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.3"></times><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.4a.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.4"><mtext id="S3.E14.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.4">Linear</mtext></ci><list id="S3.E14.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2"><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2">Avg_Pool</mtext></ci><ci id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1">𝑅</ci></apply><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3"><times id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.2">𝑅</ci><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.2.2.2.3.3">𝑃</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.2c">\displaystyle G_{R\rightarrow E}=\sigma(\text{Linear}(\text{Avg\_Pool}(R);\theta_{RP})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E15.m1.2" class="ltx_Math" alttext="\displaystyle G_{R\leftarrow E}=\sigma(\text{Linear}(\text{Avg\_Pool}(E);\theta_{EP}))." display="inline"><semantics id="S3.E15.m1.2a"><mrow id="S3.E15.m1.2.2.1" xref="S3.E15.m1.2.2.1.1.cmml"><mrow id="S3.E15.m1.2.2.1.1" xref="S3.E15.m1.2.2.1.1.cmml"><msub id="S3.E15.m1.2.2.1.1.3" xref="S3.E15.m1.2.2.1.1.3.cmml"><mi id="S3.E15.m1.2.2.1.1.3.2" xref="S3.E15.m1.2.2.1.1.3.2.cmml">G</mi><mrow id="S3.E15.m1.2.2.1.1.3.3" xref="S3.E15.m1.2.2.1.1.3.3.cmml"><mi id="S3.E15.m1.2.2.1.1.3.3.2" xref="S3.E15.m1.2.2.1.1.3.3.2.cmml">R</mi><mo stretchy="false" id="S3.E15.m1.2.2.1.1.3.3.1" xref="S3.E15.m1.2.2.1.1.3.3.1.cmml">←</mo><mi id="S3.E15.m1.2.2.1.1.3.3.3" xref="S3.E15.m1.2.2.1.1.3.3.3.cmml">E</mi></mrow></msub><mo id="S3.E15.m1.2.2.1.1.2" xref="S3.E15.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E15.m1.2.2.1.1.1" xref="S3.E15.m1.2.2.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml"><mtext id="S3.E15.m1.2.2.1.1.1.1.1.1.4" xref="S3.E15.m1.2.2.1.1.1.1.1.1.4a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2a.cmml">Avg_Pool</mtext><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml">E</mi><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.4" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml">P</mi></mrow></msub><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.5" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E15.m1.2.2.1.2" xref="S3.E15.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.2b"><apply id="S3.E15.m1.2.2.1.1.cmml" xref="S3.E15.m1.2.2.1"><eq id="S3.E15.m1.2.2.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.2"></eq><apply id="S3.E15.m1.2.2.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.3.1.cmml" xref="S3.E15.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2">𝐺</ci><apply id="S3.E15.m1.2.2.1.1.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.3"><ci id="S3.E15.m1.2.2.1.1.3.3.1.cmml" xref="S3.E15.m1.2.2.1.1.3.3.1">←</ci><ci id="S3.E15.m1.2.2.1.1.3.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.3.2">𝑅</ci><ci id="S3.E15.m1.2.2.1.1.3.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.3.3">𝐸</ci></apply></apply><apply id="S3.E15.m1.2.2.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1"><times id="S3.E15.m1.2.2.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.2"></times><ci id="S3.E15.m1.2.2.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.3">𝜎</ci><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1"><times id="S3.E15.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3"></times><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.4a.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.4"><mtext id="S3.E15.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.4">Linear</mtext></ci><list id="S3.E15.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2"><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2">Avg_Pool</mtext></ci><ci id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1">𝐸</ci></apply><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3"><times id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.2">𝐸</ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.2.2.3.3">𝑃</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.2c">\displaystyle G_{R\leftarrow E}=\sigma(\text{Linear}(\text{Avg\_Pool}(E);\theta_{EP})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.6" class="ltx_p">The query and key features from both modalities are then modulated by the conditional gates from the other modality</p>
<table id="Sx1.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\hat{R}_{Q}=(1+G_{R\leftarrow E})\odot R_{Q},\,\,\,\hat{R}_{K}=(1+G_{R\leftarrow E})\odot R_{K}," display="inline"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1.1"><mrow id="S3.Ex1.m1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.3.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.Ex1.m1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.2.cmml">R</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.3.2.1" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml">Q</mi></msub><mo id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">G</mi><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">R</mi><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">←</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.Ex1.m1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.2.cmml">R</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msub></mrow></mrow><mo rspace="0.667em" id="S3.Ex1.m1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.Ex1.m1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.2.2.cmml"><msub id="S3.Ex1.m1.1.1.1.1.2.2.3" xref="S3.Ex1.m1.1.1.1.1.2.2.3.cmml"><mover accent="true" id="S3.Ex1.m1.1.1.1.1.2.2.3.2" xref="S3.Ex1.m1.1.1.1.1.2.2.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.2.2.3.2.2" xref="S3.Ex1.m1.1.1.1.1.2.2.3.2.2.cmml">R</mi><mo id="S3.Ex1.m1.1.1.1.1.2.2.3.2.1" xref="S3.Ex1.m1.1.1.1.1.2.2.3.2.1.cmml">^</mo></mover><mi id="S3.Ex1.m1.1.1.1.1.2.2.3.3" xref="S3.Ex1.m1.1.1.1.1.2.2.3.3.cmml">K</mi></msub><mo id="S3.Ex1.m1.1.1.1.1.2.2.2" xref="S3.Ex1.m1.1.1.1.1.2.2.2.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1.1.2.2.1" xref="S3.Ex1.m1.1.1.1.1.2.2.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mn id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.2.cmml">1</mn><mo id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.1.cmml">+</mo><msub id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">G</mi><mrow id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.2.cmml">R</mi><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.1" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.1.cmml">←</mo><mi id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.Ex1.m1.1.1.1.1.2.2.1.2" xref="S3.Ex1.m1.1.1.1.1.2.2.1.2.cmml">⊙</mo><msub id="S3.Ex1.m1.1.1.1.1.2.2.1.3" xref="S3.Ex1.m1.1.1.1.1.2.2.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.2.2.1.3.2" xref="S3.Ex1.m1.1.1.1.1.2.2.1.3.2.cmml">R</mi><mi id="S3.Ex1.m1.1.1.1.1.2.2.1.3.3" xref="S3.Ex1.m1.1.1.1.1.2.2.1.3.3.cmml">K</mi></msub></mrow></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3a.cmml" xref="S3.Ex1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1"><eq id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2"></eq><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2"><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.2">𝑅</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3">𝑄</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1"><plus id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐺</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3"><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1">←</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑅</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝐸</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.2">𝑅</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2"><eq id="S3.Ex1.m1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.2"></eq><apply id="S3.Ex1.m1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.3">subscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.3.2"><ci id="S3.Ex1.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.3.2.1">^</ci><ci id="S3.Ex1.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.3.2.2">𝑅</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.3.3">𝐾</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1"><csymbol cd="latexml" id="S3.Ex1.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.2">direct-product</csymbol><apply id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1"><plus id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.1"></plus><cn type="integer" id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.2">1</cn><apply id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.2">𝐺</ci><apply id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3"><ci id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.1">←</ci><ci id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.2">𝑅</ci><ci id="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.1.1.1.3.3.3">𝐸</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.2.2.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.2.2.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.2.2.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.3.2">𝑅</ci><ci id="S3.Ex1.m1.1.1.1.1.2.2.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2.1.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\hat{R}_{Q}=(1+G_{R\leftarrow E})\odot R_{Q},\,\,\,\hat{R}_{K}=(1+G_{R\leftarrow E})\odot R_{K},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E16.m1.1" class="ltx_Math" alttext="\displaystyle\hat{E}_{Q}=(1+G_{R\leftarrow E})\odot R_{Q},\,\,\,\hat{E}_{K}=(1+G_{R\leftarrow E})\odot E_{K}." display="inline"><semantics id="S3.E16.m1.1a"><mrow id="S3.E16.m1.1.1.1"><mrow id="S3.E16.m1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.3.cmml"><mrow id="S3.E16.m1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.cmml"><msub id="S3.E16.m1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E16.m1.1.1.1.1.1.1.3.2" xref="S3.E16.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E16.m1.1.1.1.1.1.1.3.2.2" xref="S3.E16.m1.1.1.1.1.1.1.3.2.2.cmml">E</mi><mo id="S3.E16.m1.1.1.1.1.1.1.3.2.1" xref="S3.E16.m1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E16.m1.1.1.1.1.1.1.3.3" xref="S3.E16.m1.1.1.1.1.1.1.3.3.cmml">Q</mi></msub><mo id="S3.E16.m1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E16.m1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">G</mi><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">R</mi><mo stretchy="false" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">←</mo><mi id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E16.m1.1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="S3.E16.m1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E16.m1.1.1.1.1.1.1.1.3.2" xref="S3.E16.m1.1.1.1.1.1.1.1.3.2.cmml">R</mi><mi id="S3.E16.m1.1.1.1.1.1.1.1.3.3" xref="S3.E16.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msub></mrow></mrow><mo rspace="0.667em" id="S3.E16.m1.1.1.1.1.2.3" xref="S3.E16.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E16.m1.1.1.1.1.2.2" xref="S3.E16.m1.1.1.1.1.2.2.cmml"><msub id="S3.E16.m1.1.1.1.1.2.2.3" xref="S3.E16.m1.1.1.1.1.2.2.3.cmml"><mover accent="true" id="S3.E16.m1.1.1.1.1.2.2.3.2" xref="S3.E16.m1.1.1.1.1.2.2.3.2.cmml"><mi id="S3.E16.m1.1.1.1.1.2.2.3.2.2" xref="S3.E16.m1.1.1.1.1.2.2.3.2.2.cmml">E</mi><mo id="S3.E16.m1.1.1.1.1.2.2.3.2.1" xref="S3.E16.m1.1.1.1.1.2.2.3.2.1.cmml">^</mo></mover><mi id="S3.E16.m1.1.1.1.1.2.2.3.3" xref="S3.E16.m1.1.1.1.1.2.2.3.3.cmml">K</mi></msub><mo id="S3.E16.m1.1.1.1.1.2.2.2" xref="S3.E16.m1.1.1.1.1.2.2.2.cmml">=</mo><mrow id="S3.E16.m1.1.1.1.1.2.2.1" xref="S3.E16.m1.1.1.1.1.2.2.1.cmml"><mrow id="S3.E16.m1.1.1.1.1.2.2.1.1.1" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m1.1.1.1.1.2.2.1.1.1.2" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mn id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.2.cmml">1</mn><mo id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.1.cmml">+</mo><msub id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">G</mi><mrow id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml"><mi id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.2" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.2.cmml">R</mi><mo stretchy="false" id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.1" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.1.cmml">←</mo><mi id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.3" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E16.m1.1.1.1.1.2.2.1.1.1.3" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E16.m1.1.1.1.1.2.2.1.2" xref="S3.E16.m1.1.1.1.1.2.2.1.2.cmml">⊙</mo><msub id="S3.E16.m1.1.1.1.1.2.2.1.3" xref="S3.E16.m1.1.1.1.1.2.2.1.3.cmml"><mi id="S3.E16.m1.1.1.1.1.2.2.1.3.2" xref="S3.E16.m1.1.1.1.1.2.2.1.3.2.cmml">E</mi><mi id="S3.E16.m1.1.1.1.1.2.2.1.3.3" xref="S3.E16.m1.1.1.1.1.2.2.1.3.3.cmml">K</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="S3.E16.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.1b"><apply id="S3.E16.m1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.3a.cmml" xref="S3.E16.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E16.m1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1"><eq id="S3.E16.m1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.2"></eq><apply id="S3.E16.m1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E16.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3.2"><ci id="S3.E16.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E16.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3.2.2">𝐸</ci></apply><ci id="S3.E16.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3.3">𝑄</ci></apply><apply id="S3.E16.m1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E16.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1"><plus id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><cn type="integer" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐺</ci><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3"><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.1">←</ci><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑅</ci><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝐸</ci></apply></apply></apply><apply id="S3.E16.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E16.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.3.2">𝑅</ci><ci id="S3.E16.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply></apply><apply id="S3.E16.m1.1.1.1.1.2.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2"><eq id="S3.E16.m1.1.1.1.1.2.2.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2.2"></eq><apply id="S3.E16.m1.1.1.1.1.2.2.3.cmml" xref="S3.E16.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E16.m1.1.1.1.1.2.2.3">subscript</csymbol><apply id="S3.E16.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2.3.2"><ci id="S3.E16.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E16.m1.1.1.1.1.2.2.3.2.1">^</ci><ci id="S3.E16.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2.3.2.2">𝐸</ci></apply><ci id="S3.E16.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E16.m1.1.1.1.1.2.2.3.3">𝐾</ci></apply><apply id="S3.E16.m1.1.1.1.1.2.2.1.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1"><csymbol cd="latexml" id="S3.E16.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.2">direct-product</csymbol><apply id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1"><plus id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.1"></plus><cn type="integer" id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.2">1</cn><apply id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.2">𝐺</ci><apply id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3"><ci id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.1">←</ci><ci id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.2">𝑅</ci><ci id="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.1.1.1.3.3.3">𝐸</ci></apply></apply></apply><apply id="S3.E16.m1.1.1.1.1.2.2.1.3.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.2.2.1.3.1.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.3">subscript</csymbol><ci id="S3.E16.m1.1.1.1.1.2.2.1.3.2.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.3.2">𝐸</ci><ci id="S3.E16.m1.1.1.1.1.2.2.1.3.3.cmml" xref="S3.E16.m1.1.1.1.1.2.2.1.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.1c">\displaystyle\hat{E}_{Q}=(1+G_{R\leftarrow E})\odot R_{Q},\,\,\,\hat{E}_{K}=(1+G_{R\leftarrow E})\odot E_{K}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.5" class="ltx_p">where <math id="S3.SS4.p4.5.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS4.p4.5.m1.1a"><mo id="S3.SS4.p4.5.m1.1.1" xref="S3.SS4.p4.5.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m1.1b"><csymbol cd="latexml" id="S3.SS4.p4.5.m1.1.1.cmml" xref="S3.SS4.p4.5.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m1.1c">\odot</annotation></semantics></math> denotes element-wise multiplication. Channels of query and key features would be activated or deactivated by channel-wise gates conditioned on the other modality. Such a design of the two gating vectors share the similar spirit with Squeeze and Excitation Network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and the Gated Convolution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. The key difference is that the channel-wise gating vector is created based on cross-modal information.</p>
</div>
<div id="S3.SS4.p5" class="ltx_para">
<p id="S3.SS4.p5.2" class="ltx_p">The dynamic intra-modality attention flow matrices <math id="S3.SS4.p5.1.m1.1" class="ltx_Math" alttext="\text{DyIntraMAF}_{R\leftarrow R}\in\mathbb{R}^{\mu\times\mu}" display="inline"><semantics id="S3.SS4.p5.1.m1.1a"><mrow id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml"><msub id="S3.SS4.p5.1.m1.1.1.2" xref="S3.SS4.p5.1.m1.1.1.2.cmml"><mtext id="S3.SS4.p5.1.m1.1.1.2.2" xref="S3.SS4.p5.1.m1.1.1.2.2a.cmml">DyIntraMAF</mtext><mrow id="S3.SS4.p5.1.m1.1.1.2.3" xref="S3.SS4.p5.1.m1.1.1.2.3.cmml"><mi id="S3.SS4.p5.1.m1.1.1.2.3.2" xref="S3.SS4.p5.1.m1.1.1.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.SS4.p5.1.m1.1.1.2.3.1" xref="S3.SS4.p5.1.m1.1.1.2.3.1.cmml">←</mo><mi id="S3.SS4.p5.1.m1.1.1.2.3.3" xref="S3.SS4.p5.1.m1.1.1.2.3.3.cmml">R</mi></mrow></msub><mo id="S3.SS4.p5.1.m1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p5.1.m1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.3.cmml"><mi id="S3.SS4.p5.1.m1.1.1.3.2" xref="S3.SS4.p5.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p5.1.m1.1.1.3.3" xref="S3.SS4.p5.1.m1.1.1.3.3.cmml"><mi id="S3.SS4.p5.1.m1.1.1.3.3.2" xref="S3.SS4.p5.1.m1.1.1.3.3.2.cmml">μ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p5.1.m1.1.1.3.3.1" xref="S3.SS4.p5.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p5.1.m1.1.1.3.3.3" xref="S3.SS4.p5.1.m1.1.1.3.3.3.cmml">μ</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><apply id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1"><in id="S3.SS4.p5.1.m1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1"></in><apply id="S3.SS4.p5.1.m1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p5.1.m1.1.1.2.1.cmml" xref="S3.SS4.p5.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS4.p5.1.m1.1.1.2.2a.cmml" xref="S3.SS4.p5.1.m1.1.1.2.2"><mtext id="S3.SS4.p5.1.m1.1.1.2.2.cmml" xref="S3.SS4.p5.1.m1.1.1.2.2">DyIntraMAF</mtext></ci><apply id="S3.SS4.p5.1.m1.1.1.2.3.cmml" xref="S3.SS4.p5.1.m1.1.1.2.3"><ci id="S3.SS4.p5.1.m1.1.1.2.3.1.cmml" xref="S3.SS4.p5.1.m1.1.1.2.3.1">←</ci><ci id="S3.SS4.p5.1.m1.1.1.2.3.2.cmml" xref="S3.SS4.p5.1.m1.1.1.2.3.2">𝑅</ci><ci id="S3.SS4.p5.1.m1.1.1.2.3.3.cmml" xref="S3.SS4.p5.1.m1.1.1.2.3.3">𝑅</ci></apply></apply><apply id="S3.SS4.p5.1.m1.1.1.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p5.1.m1.1.1.3.1.cmml" xref="S3.SS4.p5.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p5.1.m1.1.1.3.2.cmml" xref="S3.SS4.p5.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS4.p5.1.m1.1.1.3.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3.3"><times id="S3.SS4.p5.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p5.1.m1.1.1.3.3.1"></times><ci id="S3.SS4.p5.1.m1.1.1.3.3.2.cmml" xref="S3.SS4.p5.1.m1.1.1.3.3.2">𝜇</ci><ci id="S3.SS4.p5.1.m1.1.1.3.3.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3.3.3">𝜇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">\text{DyIntraMAF}_{R\leftarrow R}\in\mathbb{R}^{\mu\times\mu}</annotation></semantics></math> and <math id="S3.SS4.p5.2.m2.1" class="ltx_Math" alttext="\text{DyIntraMAF}_{E\leftarrow E}\in\mathbb{R}^{14\times 14}" display="inline"><semantics id="S3.SS4.p5.2.m2.1a"><mrow id="S3.SS4.p5.2.m2.1.1" xref="S3.SS4.p5.2.m2.1.1.cmml"><msub id="S3.SS4.p5.2.m2.1.1.2" xref="S3.SS4.p5.2.m2.1.1.2.cmml"><mtext id="S3.SS4.p5.2.m2.1.1.2.2" xref="S3.SS4.p5.2.m2.1.1.2.2a.cmml">DyIntraMAF</mtext><mrow id="S3.SS4.p5.2.m2.1.1.2.3" xref="S3.SS4.p5.2.m2.1.1.2.3.cmml"><mi id="S3.SS4.p5.2.m2.1.1.2.3.2" xref="S3.SS4.p5.2.m2.1.1.2.3.2.cmml">E</mi><mo stretchy="false" id="S3.SS4.p5.2.m2.1.1.2.3.1" xref="S3.SS4.p5.2.m2.1.1.2.3.1.cmml">←</mo><mi id="S3.SS4.p5.2.m2.1.1.2.3.3" xref="S3.SS4.p5.2.m2.1.1.2.3.3.cmml">E</mi></mrow></msub><mo id="S3.SS4.p5.2.m2.1.1.1" xref="S3.SS4.p5.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p5.2.m2.1.1.3" xref="S3.SS4.p5.2.m2.1.1.3.cmml"><mi id="S3.SS4.p5.2.m2.1.1.3.2" xref="S3.SS4.p5.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p5.2.m2.1.1.3.3" xref="S3.SS4.p5.2.m2.1.1.3.3.cmml"><mn id="S3.SS4.p5.2.m2.1.1.3.3.2" xref="S3.SS4.p5.2.m2.1.1.3.3.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p5.2.m2.1.1.3.3.1" xref="S3.SS4.p5.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p5.2.m2.1.1.3.3.3" xref="S3.SS4.p5.2.m2.1.1.3.3.3.cmml">14</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b"><apply id="S3.SS4.p5.2.m2.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1"><in id="S3.SS4.p5.2.m2.1.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1.1"></in><apply id="S3.SS4.p5.2.m2.1.1.2.cmml" xref="S3.SS4.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.1.1.2.1.cmml" xref="S3.SS4.p5.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS4.p5.2.m2.1.1.2.2a.cmml" xref="S3.SS4.p5.2.m2.1.1.2.2"><mtext id="S3.SS4.p5.2.m2.1.1.2.2.cmml" xref="S3.SS4.p5.2.m2.1.1.2.2">DyIntraMAF</mtext></ci><apply id="S3.SS4.p5.2.m2.1.1.2.3.cmml" xref="S3.SS4.p5.2.m2.1.1.2.3"><ci id="S3.SS4.p5.2.m2.1.1.2.3.1.cmml" xref="S3.SS4.p5.2.m2.1.1.2.3.1">←</ci><ci id="S3.SS4.p5.2.m2.1.1.2.3.2.cmml" xref="S3.SS4.p5.2.m2.1.1.2.3.2">𝐸</ci><ci id="S3.SS4.p5.2.m2.1.1.2.3.3.cmml" xref="S3.SS4.p5.2.m2.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.SS4.p5.2.m2.1.1.3.cmml" xref="S3.SS4.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.1.1.3.1.cmml" xref="S3.SS4.p5.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p5.2.m2.1.1.3.2.cmml" xref="S3.SS4.p5.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS4.p5.2.m2.1.1.3.3.cmml" xref="S3.SS4.p5.2.m2.1.1.3.3"><times id="S3.SS4.p5.2.m2.1.1.3.3.1.cmml" xref="S3.SS4.p5.2.m2.1.1.3.3.1"></times><cn type="integer" id="S3.SS4.p5.2.m2.1.1.3.3.2.cmml" xref="S3.SS4.p5.2.m2.1.1.3.3.2">14</cn><cn type="integer" id="S3.SS4.p5.2.m2.1.1.3.3.3.cmml" xref="S3.SS4.p5.2.m2.1.1.3.3.3">14</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">\text{DyIntraMAF}_{E\leftarrow E}\in\mathbb{R}^{14\times 14}</annotation></semantics></math> are then obtained by the gated query and key features to weight different within-modality relations,</p>
<table id="Sx1.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E17.m1.2" class="ltx_Math" alttext="\displaystyle\textnormal{DyIntraMAF}_{R\leftarrow R}=\textnormal{softmax}(\frac{\hat{R}_{Q}\hat{R}_{K}^{T}}{\sqrt{dim}})," display="inline"><semantics id="S3.E17.m1.2a"><mrow id="S3.E17.m1.2.2.1" xref="S3.E17.m1.2.2.1.1.cmml"><mrow id="S3.E17.m1.2.2.1.1" xref="S3.E17.m1.2.2.1.1.cmml"><msub id="S3.E17.m1.2.2.1.1.2" xref="S3.E17.m1.2.2.1.1.2.cmml"><mtext id="S3.E17.m1.2.2.1.1.2.2" xref="S3.E17.m1.2.2.1.1.2.2a.cmml">DyIntraMAF</mtext><mrow id="S3.E17.m1.2.2.1.1.2.3" xref="S3.E17.m1.2.2.1.1.2.3.cmml"><mi id="S3.E17.m1.2.2.1.1.2.3.2" xref="S3.E17.m1.2.2.1.1.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.E17.m1.2.2.1.1.2.3.1" xref="S3.E17.m1.2.2.1.1.2.3.1.cmml">←</mo><mi id="S3.E17.m1.2.2.1.1.2.3.3" xref="S3.E17.m1.2.2.1.1.2.3.3.cmml">R</mi></mrow></msub><mo id="S3.E17.m1.2.2.1.1.1" xref="S3.E17.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E17.m1.2.2.1.1.3" xref="S3.E17.m1.2.2.1.1.3.cmml"><mtext id="S3.E17.m1.2.2.1.1.3.2" xref="S3.E17.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.3.1" xref="S3.E17.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E17.m1.2.2.1.1.3.3.2" xref="S3.E17.m1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.2.2.1.1.3.3.2.1" xref="S3.E17.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E17.m1.1.1" xref="S3.E17.m1.1.1.cmml"><mfrac id="S3.E17.m1.1.1a" xref="S3.E17.m1.1.1.cmml"><mrow id="S3.E17.m1.1.1.2" xref="S3.E17.m1.1.1.2.cmml"><msub id="S3.E17.m1.1.1.2.2" xref="S3.E17.m1.1.1.2.2.cmml"><mover accent="true" id="S3.E17.m1.1.1.2.2.2" xref="S3.E17.m1.1.1.2.2.2.cmml"><mi id="S3.E17.m1.1.1.2.2.2.2" xref="S3.E17.m1.1.1.2.2.2.2.cmml">R</mi><mo id="S3.E17.m1.1.1.2.2.2.1" xref="S3.E17.m1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E17.m1.1.1.2.2.3" xref="S3.E17.m1.1.1.2.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E17.m1.1.1.2.1" xref="S3.E17.m1.1.1.2.1.cmml">​</mo><msubsup id="S3.E17.m1.1.1.2.3" xref="S3.E17.m1.1.1.2.3.cmml"><mover accent="true" id="S3.E17.m1.1.1.2.3.2.2" xref="S3.E17.m1.1.1.2.3.2.2.cmml"><mi id="S3.E17.m1.1.1.2.3.2.2.2" xref="S3.E17.m1.1.1.2.3.2.2.2.cmml">R</mi><mo id="S3.E17.m1.1.1.2.3.2.2.1" xref="S3.E17.m1.1.1.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.E17.m1.1.1.2.3.2.3" xref="S3.E17.m1.1.1.2.3.2.3.cmml">K</mi><mi id="S3.E17.m1.1.1.2.3.3" xref="S3.E17.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E17.m1.1.1.3" xref="S3.E17.m1.1.1.3.cmml"><mrow id="S3.E17.m1.1.1.3.2" xref="S3.E17.m1.1.1.3.2.cmml"><mi id="S3.E17.m1.1.1.3.2.2" xref="S3.E17.m1.1.1.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.1.1.3.2.1" xref="S3.E17.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E17.m1.1.1.3.2.3" xref="S3.E17.m1.1.1.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.1.1.3.2.1a" xref="S3.E17.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E17.m1.1.1.3.2.4" xref="S3.E17.m1.1.1.3.2.4.cmml">m</mi></mrow></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E17.m1.2.2.1.1.3.3.2.2" xref="S3.E17.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E17.m1.2.2.1.2" xref="S3.E17.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.2b"><apply id="S3.E17.m1.2.2.1.1.cmml" xref="S3.E17.m1.2.2.1"><eq id="S3.E17.m1.2.2.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1"></eq><apply id="S3.E17.m1.2.2.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.2.1.cmml" xref="S3.E17.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.2.2a.cmml" xref="S3.E17.m1.2.2.1.1.2.2"><mtext id="S3.E17.m1.2.2.1.1.2.2.cmml" xref="S3.E17.m1.2.2.1.1.2.2">DyIntraMAF</mtext></ci><apply id="S3.E17.m1.2.2.1.1.2.3.cmml" xref="S3.E17.m1.2.2.1.1.2.3"><ci id="S3.E17.m1.2.2.1.1.2.3.1.cmml" xref="S3.E17.m1.2.2.1.1.2.3.1">←</ci><ci id="S3.E17.m1.2.2.1.1.2.3.2.cmml" xref="S3.E17.m1.2.2.1.1.2.3.2">𝑅</ci><ci id="S3.E17.m1.2.2.1.1.2.3.3.cmml" xref="S3.E17.m1.2.2.1.1.2.3.3">𝑅</ci></apply></apply><apply id="S3.E17.m1.2.2.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.3"><times id="S3.E17.m1.2.2.1.1.3.1.cmml" xref="S3.E17.m1.2.2.1.1.3.1"></times><ci id="S3.E17.m1.2.2.1.1.3.2a.cmml" xref="S3.E17.m1.2.2.1.1.3.2"><mtext id="S3.E17.m1.2.2.1.1.3.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S3.E17.m1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.3.3.2"><divide id="S3.E17.m1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.3.3.2"></divide><apply id="S3.E17.m1.1.1.2.cmml" xref="S3.E17.m1.1.1.2"><times id="S3.E17.m1.1.1.2.1.cmml" xref="S3.E17.m1.1.1.2.1"></times><apply id="S3.E17.m1.1.1.2.2.cmml" xref="S3.E17.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.2.2.1.cmml" xref="S3.E17.m1.1.1.2.2">subscript</csymbol><apply id="S3.E17.m1.1.1.2.2.2.cmml" xref="S3.E17.m1.1.1.2.2.2"><ci id="S3.E17.m1.1.1.2.2.2.1.cmml" xref="S3.E17.m1.1.1.2.2.2.1">^</ci><ci id="S3.E17.m1.1.1.2.2.2.2.cmml" xref="S3.E17.m1.1.1.2.2.2.2">𝑅</ci></apply><ci id="S3.E17.m1.1.1.2.2.3.cmml" xref="S3.E17.m1.1.1.2.2.3">𝑄</ci></apply><apply id="S3.E17.m1.1.1.2.3.cmml" xref="S3.E17.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.2.3.1.cmml" xref="S3.E17.m1.1.1.2.3">superscript</csymbol><apply id="S3.E17.m1.1.1.2.3.2.cmml" xref="S3.E17.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.2.3.2.1.cmml" xref="S3.E17.m1.1.1.2.3">subscript</csymbol><apply id="S3.E17.m1.1.1.2.3.2.2.cmml" xref="S3.E17.m1.1.1.2.3.2.2"><ci id="S3.E17.m1.1.1.2.3.2.2.1.cmml" xref="S3.E17.m1.1.1.2.3.2.2.1">^</ci><ci id="S3.E17.m1.1.1.2.3.2.2.2.cmml" xref="S3.E17.m1.1.1.2.3.2.2.2">𝑅</ci></apply><ci id="S3.E17.m1.1.1.2.3.2.3.cmml" xref="S3.E17.m1.1.1.2.3.2.3">𝐾</ci></apply><ci id="S3.E17.m1.1.1.2.3.3.cmml" xref="S3.E17.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E17.m1.1.1.3.cmml" xref="S3.E17.m1.1.1.3"><root id="S3.E17.m1.1.1.3a.cmml" xref="S3.E17.m1.1.1.3"></root><apply id="S3.E17.m1.1.1.3.2.cmml" xref="S3.E17.m1.1.1.3.2"><times id="S3.E17.m1.1.1.3.2.1.cmml" xref="S3.E17.m1.1.1.3.2.1"></times><ci id="S3.E17.m1.1.1.3.2.2.cmml" xref="S3.E17.m1.1.1.3.2.2">𝑑</ci><ci id="S3.E17.m1.1.1.3.2.3.cmml" xref="S3.E17.m1.1.1.3.2.3">𝑖</ci><ci id="S3.E17.m1.1.1.3.2.4.cmml" xref="S3.E17.m1.1.1.3.2.4">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.2c">\displaystyle\textnormal{DyIntraMAF}_{R\leftarrow R}=\textnormal{softmax}(\frac{\hat{R}_{Q}\hat{R}_{K}^{T}}{\sqrt{dim}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
<tbody id="S3.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E18.m1.2" class="ltx_Math" alttext="\displaystyle\textnormal{DyIntraMAF}_{E\leftarrow E}=\textnormal{softmax}(\frac{\hat{E}_{Q}\hat{E}_{K}^{T}}{\sqrt{dim}})." display="inline"><semantics id="S3.E18.m1.2a"><mrow id="S3.E18.m1.2.2.1" xref="S3.E18.m1.2.2.1.1.cmml"><mrow id="S3.E18.m1.2.2.1.1" xref="S3.E18.m1.2.2.1.1.cmml"><msub id="S3.E18.m1.2.2.1.1.2" xref="S3.E18.m1.2.2.1.1.2.cmml"><mtext id="S3.E18.m1.2.2.1.1.2.2" xref="S3.E18.m1.2.2.1.1.2.2a.cmml">DyIntraMAF</mtext><mrow id="S3.E18.m1.2.2.1.1.2.3" xref="S3.E18.m1.2.2.1.1.2.3.cmml"><mi id="S3.E18.m1.2.2.1.1.2.3.2" xref="S3.E18.m1.2.2.1.1.2.3.2.cmml">E</mi><mo stretchy="false" id="S3.E18.m1.2.2.1.1.2.3.1" xref="S3.E18.m1.2.2.1.1.2.3.1.cmml">←</mo><mi id="S3.E18.m1.2.2.1.1.2.3.3" xref="S3.E18.m1.2.2.1.1.2.3.3.cmml">E</mi></mrow></msub><mo id="S3.E18.m1.2.2.1.1.1" xref="S3.E18.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E18.m1.2.2.1.1.3" xref="S3.E18.m1.2.2.1.1.3.cmml"><mtext id="S3.E18.m1.2.2.1.1.3.2" xref="S3.E18.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.2.1.1.3.1" xref="S3.E18.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E18.m1.2.2.1.1.3.3.2" xref="S3.E18.m1.1.1.cmml"><mo stretchy="false" id="S3.E18.m1.2.2.1.1.3.3.2.1" xref="S3.E18.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E18.m1.1.1" xref="S3.E18.m1.1.1.cmml"><mfrac id="S3.E18.m1.1.1a" xref="S3.E18.m1.1.1.cmml"><mrow id="S3.E18.m1.1.1.2" xref="S3.E18.m1.1.1.2.cmml"><msub id="S3.E18.m1.1.1.2.2" xref="S3.E18.m1.1.1.2.2.cmml"><mover accent="true" id="S3.E18.m1.1.1.2.2.2" xref="S3.E18.m1.1.1.2.2.2.cmml"><mi id="S3.E18.m1.1.1.2.2.2.2" xref="S3.E18.m1.1.1.2.2.2.2.cmml">E</mi><mo id="S3.E18.m1.1.1.2.2.2.1" xref="S3.E18.m1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E18.m1.1.1.2.2.3" xref="S3.E18.m1.1.1.2.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.2.1" xref="S3.E18.m1.1.1.2.1.cmml">​</mo><msubsup id="S3.E18.m1.1.1.2.3" xref="S3.E18.m1.1.1.2.3.cmml"><mover accent="true" id="S3.E18.m1.1.1.2.3.2.2" xref="S3.E18.m1.1.1.2.3.2.2.cmml"><mi id="S3.E18.m1.1.1.2.3.2.2.2" xref="S3.E18.m1.1.1.2.3.2.2.2.cmml">E</mi><mo id="S3.E18.m1.1.1.2.3.2.2.1" xref="S3.E18.m1.1.1.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.E18.m1.1.1.2.3.2.3" xref="S3.E18.m1.1.1.2.3.2.3.cmml">K</mi><mi id="S3.E18.m1.1.1.2.3.3" xref="S3.E18.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E18.m1.1.1.3" xref="S3.E18.m1.1.1.3.cmml"><mrow id="S3.E18.m1.1.1.3.2" xref="S3.E18.m1.1.1.3.2.cmml"><mi id="S3.E18.m1.1.1.3.2.2" xref="S3.E18.m1.1.1.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.3.2.1" xref="S3.E18.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E18.m1.1.1.3.2.3" xref="S3.E18.m1.1.1.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.3.2.1a" xref="S3.E18.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E18.m1.1.1.3.2.4" xref="S3.E18.m1.1.1.3.2.4.cmml">m</mi></mrow></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E18.m1.2.2.1.1.3.3.2.2" xref="S3.E18.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E18.m1.2.2.1.2" xref="S3.E18.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.2b"><apply id="S3.E18.m1.2.2.1.1.cmml" xref="S3.E18.m1.2.2.1"><eq id="S3.E18.m1.2.2.1.1.1.cmml" xref="S3.E18.m1.2.2.1.1.1"></eq><apply id="S3.E18.m1.2.2.1.1.2.cmml" xref="S3.E18.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E18.m1.2.2.1.1.2.1.cmml" xref="S3.E18.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E18.m1.2.2.1.1.2.2a.cmml" xref="S3.E18.m1.2.2.1.1.2.2"><mtext id="S3.E18.m1.2.2.1.1.2.2.cmml" xref="S3.E18.m1.2.2.1.1.2.2">DyIntraMAF</mtext></ci><apply id="S3.E18.m1.2.2.1.1.2.3.cmml" xref="S3.E18.m1.2.2.1.1.2.3"><ci id="S3.E18.m1.2.2.1.1.2.3.1.cmml" xref="S3.E18.m1.2.2.1.1.2.3.1">←</ci><ci id="S3.E18.m1.2.2.1.1.2.3.2.cmml" xref="S3.E18.m1.2.2.1.1.2.3.2">𝐸</ci><ci id="S3.E18.m1.2.2.1.1.2.3.3.cmml" xref="S3.E18.m1.2.2.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.E18.m1.2.2.1.1.3.cmml" xref="S3.E18.m1.2.2.1.1.3"><times id="S3.E18.m1.2.2.1.1.3.1.cmml" xref="S3.E18.m1.2.2.1.1.3.1"></times><ci id="S3.E18.m1.2.2.1.1.3.2a.cmml" xref="S3.E18.m1.2.2.1.1.3.2"><mtext id="S3.E18.m1.2.2.1.1.3.2.cmml" xref="S3.E18.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S3.E18.m1.1.1.cmml" xref="S3.E18.m1.2.2.1.1.3.3.2"><divide id="S3.E18.m1.1.1.1.cmml" xref="S3.E18.m1.2.2.1.1.3.3.2"></divide><apply id="S3.E18.m1.1.1.2.cmml" xref="S3.E18.m1.1.1.2"><times id="S3.E18.m1.1.1.2.1.cmml" xref="S3.E18.m1.1.1.2.1"></times><apply id="S3.E18.m1.1.1.2.2.cmml" xref="S3.E18.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.2.2.1.cmml" xref="S3.E18.m1.1.1.2.2">subscript</csymbol><apply id="S3.E18.m1.1.1.2.2.2.cmml" xref="S3.E18.m1.1.1.2.2.2"><ci id="S3.E18.m1.1.1.2.2.2.1.cmml" xref="S3.E18.m1.1.1.2.2.2.1">^</ci><ci id="S3.E18.m1.1.1.2.2.2.2.cmml" xref="S3.E18.m1.1.1.2.2.2.2">𝐸</ci></apply><ci id="S3.E18.m1.1.1.2.2.3.cmml" xref="S3.E18.m1.1.1.2.2.3">𝑄</ci></apply><apply id="S3.E18.m1.1.1.2.3.cmml" xref="S3.E18.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.2.3.1.cmml" xref="S3.E18.m1.1.1.2.3">superscript</csymbol><apply id="S3.E18.m1.1.1.2.3.2.cmml" xref="S3.E18.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.2.3.2.1.cmml" xref="S3.E18.m1.1.1.2.3">subscript</csymbol><apply id="S3.E18.m1.1.1.2.3.2.2.cmml" xref="S3.E18.m1.1.1.2.3.2.2"><ci id="S3.E18.m1.1.1.2.3.2.2.1.cmml" xref="S3.E18.m1.1.1.2.3.2.2.1">^</ci><ci id="S3.E18.m1.1.1.2.3.2.2.2.cmml" xref="S3.E18.m1.1.1.2.3.2.2.2">𝐸</ci></apply><ci id="S3.E18.m1.1.1.2.3.2.3.cmml" xref="S3.E18.m1.1.1.2.3.2.3">𝐾</ci></apply><ci id="S3.E18.m1.1.1.2.3.3.cmml" xref="S3.E18.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E18.m1.1.1.3.cmml" xref="S3.E18.m1.1.1.3"><root id="S3.E18.m1.1.1.3a.cmml" xref="S3.E18.m1.1.1.3"></root><apply id="S3.E18.m1.1.1.3.2.cmml" xref="S3.E18.m1.1.1.3.2"><times id="S3.E18.m1.1.1.3.2.1.cmml" xref="S3.E18.m1.1.1.3.2.1"></times><ci id="S3.E18.m1.1.1.3.2.2.cmml" xref="S3.E18.m1.1.1.3.2.2">𝑑</ci><ci id="S3.E18.m1.1.1.3.2.3.cmml" xref="S3.E18.m1.1.1.3.2.3">𝑖</ci><ci id="S3.E18.m1.1.1.3.2.4.cmml" xref="S3.E18.m1.1.1.3.2.4">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.2c">\displaystyle\textnormal{DyIntraMAF}_{E\leftarrow E}=\textnormal{softmax}(\frac{\hat{E}_{Q}\hat{E}_{K}^{T}}{\sqrt{dim}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p6" class="ltx_para">
<p id="S3.SS4.p6.2" class="ltx_p">Visual region and word features are then updated by the weighted value features <math id="S3.SS4.p6.1.m1.1" class="ltx_Math" alttext="R_{V}" display="inline"><semantics id="S3.SS4.p6.1.m1.1a"><msub id="S3.SS4.p6.1.m1.1.1" xref="S3.SS4.p6.1.m1.1.1.cmml"><mi id="S3.SS4.p6.1.m1.1.1.2" xref="S3.SS4.p6.1.m1.1.1.2.cmml">R</mi><mi id="S3.SS4.p6.1.m1.1.1.3" xref="S3.SS4.p6.1.m1.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.1.m1.1b"><apply id="S3.SS4.p6.1.m1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.1.m1.1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p6.1.m1.1.1.2.cmml" xref="S3.SS4.p6.1.m1.1.1.2">𝑅</ci><ci id="S3.SS4.p6.1.m1.1.1.3.cmml" xref="S3.SS4.p6.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.1.m1.1c">R_{V}</annotation></semantics></math> and <math id="S3.SS4.p6.2.m2.1" class="ltx_Math" alttext="E_{V}" display="inline"><semantics id="S3.SS4.p6.2.m2.1a"><msub id="S3.SS4.p6.2.m2.1.1" xref="S3.SS4.p6.2.m2.1.1.cmml"><mi id="S3.SS4.p6.2.m2.1.1.2" xref="S3.SS4.p6.2.m2.1.1.2.cmml">E</mi><mi id="S3.SS4.p6.2.m2.1.1.3" xref="S3.SS4.p6.2.m2.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.2.m2.1b"><apply id="S3.SS4.p6.2.m2.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.2.m2.1.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p6.2.m2.1.1.2.cmml" xref="S3.SS4.p6.2.m2.1.1.2">𝐸</ci><ci id="S3.SS4.p6.2.m2.1.1.3.cmml" xref="S3.SS4.p6.2.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.2.m2.1c">E_{V}</annotation></semantics></math> via residual,</p>
<table id="Sx1.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E19.m1.1" class="ltx_Math" alttext="\displaystyle R=\textnormal{Linear}(R+R_{update};\theta_{RD})," display="inline"><semantics id="S3.E19.m1.1a"><mrow id="S3.E19.m1.1.1.1" xref="S3.E19.m1.1.1.1.1.cmml"><mrow id="S3.E19.m1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.cmml"><mi id="S3.E19.m1.1.1.1.1.4" xref="S3.E19.m1.1.1.1.1.4.cmml">R</mi><mo id="S3.E19.m1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E19.m1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.2.cmml"><mtext id="S3.E19.m1.1.1.1.1.2.4" xref="S3.E19.m1.1.1.1.1.2.4a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.2.3" xref="S3.E19.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E19.m1.1.1.1.1.2.2.2" xref="S3.E19.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E19.m1.1.1.1.1.2.2.2.3" xref="S3.E19.m1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S3.E19.m1.1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.E19.m1.1.1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E19.m1.1.1.1.1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.2.cmml">R</mi><mrow id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1b" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1c" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.6" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1d" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.7" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.7.cmml">e</mi></mrow></msub></mrow><mo id="S3.E19.m1.1.1.1.1.2.2.2.4" xref="S3.E19.m1.1.1.1.1.2.2.3.cmml">;</mo><msub id="S3.E19.m1.1.1.1.1.2.2.2.2" xref="S3.E19.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E19.m1.1.1.1.1.2.2.2.2.2" xref="S3.E19.m1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E19.m1.1.1.1.1.2.2.2.2.3" xref="S3.E19.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E19.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E19.m1.1.1.1.1.2.2.2.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.2.2.2.2.3.1" xref="S3.E19.m1.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E19.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E19.m1.1.1.1.1.2.2.2.2.3.3.cmml">D</mi></mrow></msub><mo stretchy="false" id="S3.E19.m1.1.1.1.1.2.2.2.5" xref="S3.E19.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E19.m1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E19.m1.1b"><apply id="S3.E19.m1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1"><eq id="S3.E19.m1.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.3"></eq><ci id="S3.E19.m1.1.1.1.1.4.cmml" xref="S3.E19.m1.1.1.1.1.4">𝑅</ci><apply id="S3.E19.m1.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.2"><times id="S3.E19.m1.1.1.1.1.2.3.cmml" xref="S3.E19.m1.1.1.1.1.2.3"></times><ci id="S3.E19.m1.1.1.1.1.2.4a.cmml" xref="S3.E19.m1.1.1.1.1.2.4"><mtext id="S3.E19.m1.1.1.1.1.2.4.cmml" xref="S3.E19.m1.1.1.1.1.2.4">Linear</mtext></ci><list id="S3.E19.m1.1.1.1.1.2.2.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2"><apply id="S3.E19.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1"><plus id="S3.E19.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.2">𝑅</ci><apply id="S3.E19.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.2">𝑅</ci><apply id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.2">𝑢</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.3">𝑝</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.4">𝑑</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.5">𝑎</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.6.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.6">𝑡</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.7.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.3.7">𝑒</ci></apply></apply></apply><apply id="S3.E19.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E19.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2.2.2">𝜃</ci><apply id="S3.E19.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2.2.3"><times id="S3.E19.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.E19.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2.2.3.2">𝑅</ci><ci id="S3.E19.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2.2.3.3">𝐷</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E19.m1.1c">\displaystyle R=\textnormal{Linear}(R+R_{update};\theta_{RD}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
<tbody id="S3.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E20.m1.1" class="ltx_Math" alttext="\displaystyle E=\textnormal{Linear}(E+E_{update};\theta_{ED})." display="inline"><semantics id="S3.E20.m1.1a"><mrow id="S3.E20.m1.1.1.1" xref="S3.E20.m1.1.1.1.1.cmml"><mrow id="S3.E20.m1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.cmml"><mi id="S3.E20.m1.1.1.1.1.4" xref="S3.E20.m1.1.1.1.1.4.cmml">E</mi><mo id="S3.E20.m1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E20.m1.1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.2.cmml"><mtext id="S3.E20.m1.1.1.1.1.2.4" xref="S3.E20.m1.1.1.1.1.2.4a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.2.3" xref="S3.E20.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E20.m1.1.1.1.1.2.2.2" xref="S3.E20.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E20.m1.1.1.1.1.2.2.2.3" xref="S3.E20.m1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S3.E20.m1.1.1.1.1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.1.1.1.1.2.cmml">E</mi><mo id="S3.E20.m1.1.1.1.1.1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E20.m1.1.1.1.1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.2.cmml">E</mi><mrow id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1b" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1c" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.6" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1d" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.7" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.7.cmml">e</mi></mrow></msub></mrow><mo id="S3.E20.m1.1.1.1.1.2.2.2.4" xref="S3.E20.m1.1.1.1.1.2.2.3.cmml">;</mo><msub id="S3.E20.m1.1.1.1.1.2.2.2.2" xref="S3.E20.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E20.m1.1.1.1.1.2.2.2.2.2" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E20.m1.1.1.1.1.2.2.2.2.3" xref="S3.E20.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E20.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E20.m1.1.1.1.1.2.2.2.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.2.2.2.2.3.1" xref="S3.E20.m1.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E20.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E20.m1.1.1.1.1.2.2.2.2.3.3.cmml">D</mi></mrow></msub><mo stretchy="false" id="S3.E20.m1.1.1.1.1.2.2.2.5" xref="S3.E20.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E20.m1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E20.m1.1b"><apply id="S3.E20.m1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1"><eq id="S3.E20.m1.1.1.1.1.3.cmml" xref="S3.E20.m1.1.1.1.1.3"></eq><ci id="S3.E20.m1.1.1.1.1.4.cmml" xref="S3.E20.m1.1.1.1.1.4">𝐸</ci><apply id="S3.E20.m1.1.1.1.1.2.cmml" xref="S3.E20.m1.1.1.1.1.2"><times id="S3.E20.m1.1.1.1.1.2.3.cmml" xref="S3.E20.m1.1.1.1.1.2.3"></times><ci id="S3.E20.m1.1.1.1.1.2.4a.cmml" xref="S3.E20.m1.1.1.1.1.2.4"><mtext id="S3.E20.m1.1.1.1.1.2.4.cmml" xref="S3.E20.m1.1.1.1.1.2.4">Linear</mtext></ci><list id="S3.E20.m1.1.1.1.1.2.2.3.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2"><apply id="S3.E20.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1"><plus id="S3.E20.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.2">𝐸</ci><apply id="S3.E20.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.2">𝐸</ci><apply id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.2">𝑢</ci><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.3">𝑝</ci><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.4">𝑑</ci><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.5">𝑎</ci><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.6.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.6">𝑡</ci><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.7.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3.3.7">𝑒</ci></apply></apply></apply><apply id="S3.E20.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E20.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2">𝜃</ci><apply id="S3.E20.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.3"><times id="S3.E20.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.E20.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.3.2">𝐸</ci><ci id="S3.E20.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.3.3">𝐷</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E20.m1.1c">\displaystyle E=\textnormal{Linear}(E+E_{update};\theta_{ED}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p6.3" class="ltx_p">where</p>
<table id="Sx1.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E21.m1.1" class="ltx_Math" alttext="\displaystyle R_{update}=\textnormal{DyIntraMAF}_{R\leftarrow R}\times R_{V}," display="inline"><semantics id="S3.E21.m1.1a"><mrow id="S3.E21.m1.1.1.1" xref="S3.E21.m1.1.1.1.1.cmml"><mrow id="S3.E21.m1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.cmml"><msub id="S3.E21.m1.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.2.cmml"><mi id="S3.E21.m1.1.1.1.1.2.2" xref="S3.E21.m1.1.1.1.1.2.2.cmml">R</mi><mrow id="S3.E21.m1.1.1.1.1.2.3" xref="S3.E21.m1.1.1.1.1.2.3.cmml"><mi id="S3.E21.m1.1.1.1.1.2.3.2" xref="S3.E21.m1.1.1.1.1.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E21.m1.1.1.1.1.2.3.1" xref="S3.E21.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E21.m1.1.1.1.1.2.3.3" xref="S3.E21.m1.1.1.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E21.m1.1.1.1.1.2.3.1a" xref="S3.E21.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E21.m1.1.1.1.1.2.3.4" xref="S3.E21.m1.1.1.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E21.m1.1.1.1.1.2.3.1b" xref="S3.E21.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E21.m1.1.1.1.1.2.3.5" xref="S3.E21.m1.1.1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E21.m1.1.1.1.1.2.3.1c" xref="S3.E21.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E21.m1.1.1.1.1.2.3.6" xref="S3.E21.m1.1.1.1.1.2.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E21.m1.1.1.1.1.2.3.1d" xref="S3.E21.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E21.m1.1.1.1.1.2.3.7" xref="S3.E21.m1.1.1.1.1.2.3.7.cmml">e</mi></mrow></msub><mo id="S3.E21.m1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E21.m1.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.3.cmml"><msub id="S3.E21.m1.1.1.1.1.3.2" xref="S3.E21.m1.1.1.1.1.3.2.cmml"><mtext id="S3.E21.m1.1.1.1.1.3.2.2" xref="S3.E21.m1.1.1.1.1.3.2.2a.cmml">DyIntraMAF</mtext><mrow id="S3.E21.m1.1.1.1.1.3.2.3" xref="S3.E21.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E21.m1.1.1.1.1.3.2.3.2" xref="S3.E21.m1.1.1.1.1.3.2.3.2.cmml">R</mi><mo stretchy="false" id="S3.E21.m1.1.1.1.1.3.2.3.1" xref="S3.E21.m1.1.1.1.1.3.2.3.1.cmml">←</mo><mi id="S3.E21.m1.1.1.1.1.3.2.3.3" xref="S3.E21.m1.1.1.1.1.3.2.3.3.cmml">R</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E21.m1.1.1.1.1.3.1" xref="S3.E21.m1.1.1.1.1.3.1.cmml">×</mo><msub id="S3.E21.m1.1.1.1.1.3.3" xref="S3.E21.m1.1.1.1.1.3.3.cmml"><mi id="S3.E21.m1.1.1.1.1.3.3.2" xref="S3.E21.m1.1.1.1.1.3.3.2.cmml">R</mi><mi id="S3.E21.m1.1.1.1.1.3.3.3" xref="S3.E21.m1.1.1.1.1.3.3.3.cmml">V</mi></msub></mrow></mrow><mo id="S3.E21.m1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E21.m1.1b"><apply id="S3.E21.m1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1"><eq id="S3.E21.m1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1"></eq><apply id="S3.E21.m1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.2.1.cmml" xref="S3.E21.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.2.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2">𝑅</ci><apply id="S3.E21.m1.1.1.1.1.2.3.cmml" xref="S3.E21.m1.1.1.1.1.2.3"><times id="S3.E21.m1.1.1.1.1.2.3.1.cmml" xref="S3.E21.m1.1.1.1.1.2.3.1"></times><ci id="S3.E21.m1.1.1.1.1.2.3.2.cmml" xref="S3.E21.m1.1.1.1.1.2.3.2">𝑢</ci><ci id="S3.E21.m1.1.1.1.1.2.3.3.cmml" xref="S3.E21.m1.1.1.1.1.2.3.3">𝑝</ci><ci id="S3.E21.m1.1.1.1.1.2.3.4.cmml" xref="S3.E21.m1.1.1.1.1.2.3.4">𝑑</ci><ci id="S3.E21.m1.1.1.1.1.2.3.5.cmml" xref="S3.E21.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S3.E21.m1.1.1.1.1.2.3.6.cmml" xref="S3.E21.m1.1.1.1.1.2.3.6">𝑡</ci><ci id="S3.E21.m1.1.1.1.1.2.3.7.cmml" xref="S3.E21.m1.1.1.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S3.E21.m1.1.1.1.1.3.cmml" xref="S3.E21.m1.1.1.1.1.3"><times id="S3.E21.m1.1.1.1.1.3.1.cmml" xref="S3.E21.m1.1.1.1.1.3.1"></times><apply id="S3.E21.m1.1.1.1.1.3.2.cmml" xref="S3.E21.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.3.2.1.cmml" xref="S3.E21.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E21.m1.1.1.1.1.3.2.2"><mtext id="S3.E21.m1.1.1.1.1.3.2.2.cmml" xref="S3.E21.m1.1.1.1.1.3.2.2">DyIntraMAF</mtext></ci><apply id="S3.E21.m1.1.1.1.1.3.2.3.cmml" xref="S3.E21.m1.1.1.1.1.3.2.3"><ci id="S3.E21.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E21.m1.1.1.1.1.3.2.3.1">←</ci><ci id="S3.E21.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E21.m1.1.1.1.1.3.2.3.2">𝑅</ci><ci id="S3.E21.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E21.m1.1.1.1.1.3.2.3.3">𝑅</ci></apply></apply><apply id="S3.E21.m1.1.1.1.1.3.3.cmml" xref="S3.E21.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.3.3.1.cmml" xref="S3.E21.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.3.3.2.cmml" xref="S3.E21.m1.1.1.1.1.3.3.2">𝑅</ci><ci id="S3.E21.m1.1.1.1.1.3.3.3.cmml" xref="S3.E21.m1.1.1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m1.1c">\displaystyle R_{update}=\textnormal{DyIntraMAF}_{R\leftarrow R}\times R_{V},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
<tbody id="S3.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E22.m1.1" class="ltx_Math" alttext="\displaystyle E_{update}=\textnormal{DyIntraMAF}_{E\leftarrow E}\times E_{V}." display="inline"><semantics id="S3.E22.m1.1a"><mrow id="S3.E22.m1.1.1.1" xref="S3.E22.m1.1.1.1.1.cmml"><mrow id="S3.E22.m1.1.1.1.1" xref="S3.E22.m1.1.1.1.1.cmml"><msub id="S3.E22.m1.1.1.1.1.2" xref="S3.E22.m1.1.1.1.1.2.cmml"><mi id="S3.E22.m1.1.1.1.1.2.2" xref="S3.E22.m1.1.1.1.1.2.2.cmml">E</mi><mrow id="S3.E22.m1.1.1.1.1.2.3" xref="S3.E22.m1.1.1.1.1.2.3.cmml"><mi id="S3.E22.m1.1.1.1.1.2.3.2" xref="S3.E22.m1.1.1.1.1.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E22.m1.1.1.1.1.2.3.1" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E22.m1.1.1.1.1.2.3.3" xref="S3.E22.m1.1.1.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E22.m1.1.1.1.1.2.3.1a" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E22.m1.1.1.1.1.2.3.4" xref="S3.E22.m1.1.1.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E22.m1.1.1.1.1.2.3.1b" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E22.m1.1.1.1.1.2.3.5" xref="S3.E22.m1.1.1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E22.m1.1.1.1.1.2.3.1c" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E22.m1.1.1.1.1.2.3.6" xref="S3.E22.m1.1.1.1.1.2.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E22.m1.1.1.1.1.2.3.1d" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E22.m1.1.1.1.1.2.3.7" xref="S3.E22.m1.1.1.1.1.2.3.7.cmml">e</mi></mrow></msub><mo id="S3.E22.m1.1.1.1.1.1" xref="S3.E22.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E22.m1.1.1.1.1.3" xref="S3.E22.m1.1.1.1.1.3.cmml"><msub id="S3.E22.m1.1.1.1.1.3.2" xref="S3.E22.m1.1.1.1.1.3.2.cmml"><mtext id="S3.E22.m1.1.1.1.1.3.2.2" xref="S3.E22.m1.1.1.1.1.3.2.2a.cmml">DyIntraMAF</mtext><mrow id="S3.E22.m1.1.1.1.1.3.2.3" xref="S3.E22.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E22.m1.1.1.1.1.3.2.3.2" xref="S3.E22.m1.1.1.1.1.3.2.3.2.cmml">E</mi><mo stretchy="false" id="S3.E22.m1.1.1.1.1.3.2.3.1" xref="S3.E22.m1.1.1.1.1.3.2.3.1.cmml">←</mo><mi id="S3.E22.m1.1.1.1.1.3.2.3.3" xref="S3.E22.m1.1.1.1.1.3.2.3.3.cmml">E</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E22.m1.1.1.1.1.3.1" xref="S3.E22.m1.1.1.1.1.3.1.cmml">×</mo><msub id="S3.E22.m1.1.1.1.1.3.3" xref="S3.E22.m1.1.1.1.1.3.3.cmml"><mi id="S3.E22.m1.1.1.1.1.3.3.2" xref="S3.E22.m1.1.1.1.1.3.3.2.cmml">E</mi><mi id="S3.E22.m1.1.1.1.1.3.3.3" xref="S3.E22.m1.1.1.1.1.3.3.3.cmml">V</mi></msub></mrow></mrow><mo lspace="0em" id="S3.E22.m1.1.1.1.2" xref="S3.E22.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E22.m1.1b"><apply id="S3.E22.m1.1.1.1.1.cmml" xref="S3.E22.m1.1.1.1"><eq id="S3.E22.m1.1.1.1.1.1.cmml" xref="S3.E22.m1.1.1.1.1.1"></eq><apply id="S3.E22.m1.1.1.1.1.2.cmml" xref="S3.E22.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.2.1.cmml" xref="S3.E22.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.2.2.cmml" xref="S3.E22.m1.1.1.1.1.2.2">𝐸</ci><apply id="S3.E22.m1.1.1.1.1.2.3.cmml" xref="S3.E22.m1.1.1.1.1.2.3"><times id="S3.E22.m1.1.1.1.1.2.3.1.cmml" xref="S3.E22.m1.1.1.1.1.2.3.1"></times><ci id="S3.E22.m1.1.1.1.1.2.3.2.cmml" xref="S3.E22.m1.1.1.1.1.2.3.2">𝑢</ci><ci id="S3.E22.m1.1.1.1.1.2.3.3.cmml" xref="S3.E22.m1.1.1.1.1.2.3.3">𝑝</ci><ci id="S3.E22.m1.1.1.1.1.2.3.4.cmml" xref="S3.E22.m1.1.1.1.1.2.3.4">𝑑</ci><ci id="S3.E22.m1.1.1.1.1.2.3.5.cmml" xref="S3.E22.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S3.E22.m1.1.1.1.1.2.3.6.cmml" xref="S3.E22.m1.1.1.1.1.2.3.6">𝑡</ci><ci id="S3.E22.m1.1.1.1.1.2.3.7.cmml" xref="S3.E22.m1.1.1.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S3.E22.m1.1.1.1.1.3.cmml" xref="S3.E22.m1.1.1.1.1.3"><times id="S3.E22.m1.1.1.1.1.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.1"></times><apply id="S3.E22.m1.1.1.1.1.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.3.2.1.cmml" xref="S3.E22.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E22.m1.1.1.1.1.3.2.2"><mtext id="S3.E22.m1.1.1.1.1.3.2.2.cmml" xref="S3.E22.m1.1.1.1.1.3.2.2">DyIntraMAF</mtext></ci><apply id="S3.E22.m1.1.1.1.1.3.2.3.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3"><ci id="S3.E22.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3.1">←</ci><ci id="S3.E22.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3.2">𝐸</ci><ci id="S3.E22.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3.3">𝐸</ci></apply></apply><apply id="S3.E22.m1.1.1.1.1.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.3.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.3.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2">𝐸</ci><ci id="S3.E22.m1.1.1.1.1.3.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E22.m1.1c">\displaystyle E_{update}=\textnormal{DyIntraMAF}_{E\leftarrow E}\times E_{V}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p7" class="ltx_para">
<p id="S3.SS4.p7.1" class="ltx_p">Note that here we only make key and query features conditioned on the other modality to adaptively weight within-modality information flows. In our ablation studies, we observe that the proposed DyIntraMAF module by a large margin outperforms the naive IntraMAF module.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>The Framework with Intra- and Inter-modality Attention Flow</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">In this section, we introduce how to integrate intra- and inter-modality attention flow modules into our proposed framework. The whole pipeline is illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.The proposed framework first extracts visual region features and word features from the input image and question by utilizing the Faster RCNN and GRU models, respectively. Faster R-CNN model weights are fixed during training our proposed framework, while GRU weights are updated with our framework from scratch.</p>
</div>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.1" class="ltx_p">After visual region features and word features being transformed into vectors of the same dimension by fully connected layers. The InterMAF module passes information flows between each pair of visual region and question word and aggregates updated features to each region and each word. Such aggregated features integrate information from the other modality to update the visual and word features according to the cross-modal relations.</p>
</div>
<div id="S3.SS5.p3" class="ltx_para">
<p id="S3.SS5.p3.1" class="ltx_p">Given the InterMAF outputs, the DyIntraMAF module is utilized for dynamically passing information flows within each modality. The visual region and word features would be updated again with information within the same modality via residual connections.</p>
</div>
<div id="S3.SS5.p4" class="ltx_para">
<p id="S3.SS5.p4.1" class="ltx_p">We use one InterMAF module followed by one DyIntraMAF module to form a basic block in our proposed DFAF framework. Multiple blocks could be stacked thanks to the feature concatenation and residual connection in the feature updating procedures. Very deep intra- and inter-modality information flows can be effectively trained with stochastic gradient descent. In addition, we utilize multi-head attention in practice.
The original features are split along channel dimensions into groups and different groups would generate parallel attentions to update visual and word features in different groups independently.</p>
</div>
</section>
<section id="S3.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Answer Prediction Layer and Loss Function</h3>

<div id="S3.SS6.p1" class="ltx_para">
<p id="S3.SS6.p1.1" class="ltx_p">After several blocks of feature updating by InterMAF and DyIntraMAF modules, we obtain the final visual region and word features encoding inter-modality and intra-modality relations for VQA.
By average pooling over region features and over word features, we could obtain discriminative representations for image and question, respectively. Such features could then be fused via either feature concatenation, or feature element-wise product, or feature addition to obtain fused features. We experiment with the three fusion approaches in which the element-wise product between visual and language representations achieves the best performance with a trivial margin.</p>
</div>
<div id="S3.SS6.p2" class="ltx_para">
<p id="S3.SS6.p2.1" class="ltx_p">Similar to state-of-the-art VQA approaches, we treat VQA as a classification problem. The fused multi-modal features are transformed into
a probability vector by a 2-layer multi-layer perceptron with ReLU non-linearity function between the layers and a final softmax function. The ground-truth answers are extracted from annotated answers that appear for more than 5 times. Cross-entropy loss function is adopted as the objective function.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We used VQA version 2.0 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> for our experiment. VQA dataset contains human annotated
question-answer pairs for images from Microsoft COCO dataset  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
VQA 2.0 is an updated of previous VQA 1.0 with much more annotations and less dataset bias.
VQA 2.0 is split into train, validation and test-standard sets.
Among test-standard test, 25% are served as test-dev set. All questions types are divided into Yes/No, Number and other categories.
Train, validation and test-standard contains 82,783, 40,504 and 81,434 images, with 443,757, 214,354, 447,793 questions,respectively. Each question
contains 10 answers from different annotators. Answers with the highest frequency are treated as the ground-truth. Following previous
approaches, we perform ablation studies over the validation set and utilize the train and validation splits for test.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experimental Setup</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Visual features of dimension 2048 are extracted from Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> while word features are encoded into features of dimension 1280 by GRU<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. The visual features and word features are then embedded into 512 dimensions by a fully-connected layer, respectively. Inside InterMAF, features are transformed into 8 multi-head attention with 64 dimensions for each head. For
DyIntraMAF, the average pooled features from both modality are transformed into 512 dimensions by MLP followed by element-wise sigmoid
activation to obtain the conditioning gating vectors. They are then multiplied with 512 dimension
visual key and query features at every position of visual and word features for dynamic attention flows. Previous approaches achieve
significantly better results with sentinel and relative position information. However, sentinel and relative position do not affect
the performance of our method.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.2" class="ltx_p">All fully connected layers have the same dropout rate 0.1. All gradients are clipped to 0.25. Batch size is set as 512.
Adamax optimizer  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>,
a variant of Adam, is used. The learning rate is set as <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="10^{-3}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msup id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">10</mn><mrow id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mo id="S4.SS2.p2.1.m1.1.1.3a" xref="S4.SS2.p2.1.m1.1.1.3.cmml">−</mo><mn id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">10</cn><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><minus id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3"></minus><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">10^{-3}</annotation></semantics></math> for the first 2 epoch, <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="2\times 10^{-3}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">×</mo><msup id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mn id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml"><mo id="S4.SS2.p2.2.m2.1.1.3.3a" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS2.p2.2.m2.1.1.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">2</cn><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">10</cn><apply id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3"><minus id="S4.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3"></minus><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">2\times 10^{-3}</annotation></semantics></math> for the next 8 epochs and decayed by 1/4 for the rest
epochs.
Our method is implemented with Pytorch  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.
All initilizations are Pytorch default initilization.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">All ablation studies are conducted on the validation dataset, while train, validation datasets and extra visual genome dataset are combined for testing on test-dev.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.4.5.1" class="ltx_tr">
<th id="S4.T1.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S4.T1.4.5.1.1.1" class="ltx_text" style="font-size:90%;">Component</span></th>
<td id="S4.T1.4.5.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.4.5.1.2.1" class="ltx_text" style="font-size:90%;">Setting</span></td>
<td id="S4.T1.4.5.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.4.5.1.3.1" class="ltx_text" style="font-size:90%;">Accuracy</span></td>
</tr>
<tr id="S4.T1.4.6.2" class="ltx_tr">
<th id="S4.T1.4.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">
<span id="S4.T1.4.6.2.1.1" class="ltx_text" style="font-size:90%;">Bottom-up </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.4.6.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S4.T1.4.6.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.4.6.2.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.4.6.2.2.1" class="ltx_text" style="font-size:90%;">Bottom-up</span></td>
<td id="S4.T1.4.6.2.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T1.4.6.2.3.1" class="ltx_text" style="font-size:90%;">63.37</span></td>
</tr>
<tr id="S4.T1.4.7.3" class="ltx_tr">
<th id="S4.T1.4.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S4.T1.4.7.3.1.1" class="ltx_text" style="font-size:90%;">Bilinear Attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite></span></th>
<td id="S4.T1.4.7.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.7.3.2.1" class="ltx_text" style="font-size:90%;">BAN-1</span></td>
<td id="S4.T1.4.7.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.7.3.3.1" class="ltx_text" style="font-size:90%;">65.36</span></td>
</tr>
<tr id="S4.T1.4.8.4" class="ltx_tr">
<td id="S4.T1.4.8.4.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.8.4.1.1" class="ltx_text" style="font-size:90%;">BAN-4</span></td>
<td id="S4.T1.4.8.4.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.8.4.2.1" class="ltx_text" style="font-size:90%;">65.81</span></td>
</tr>
<tr id="S4.T1.4.9.5" class="ltx_tr">
<td id="S4.T1.4.9.5.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.9.5.1.1" class="ltx_text" style="font-size:90%;">BAN-12</span></td>
<td id="S4.T1.4.9.5.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.9.5.2.1" class="ltx_text" style="font-size:90%;">66.04</span></td>
</tr>
<tr id="S4.T1.4.10.6" class="ltx_tr">
<th id="S4.T1.4.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T1.4.10.6.1.1" class="ltx_text" style="font-size:90%;">Default</span></th>
<td id="S4.T1.4.10.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.10.6.2.1" class="ltx_text" style="font-size:90%;">DFAF-1</span></td>
<td id="S4.T1.4.10.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.10.6.3.1" class="ltx_text" style="font-size:90%;">66.21</span></td>
</tr>
<tr id="S4.T1.4.11.7" class="ltx_tr">
<th id="S4.T1.4.11.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S4.T1.4.11.7.1.1" class="ltx_text" style="font-size:90%;"># of stacked blocks</span></th>
<td id="S4.T1.4.11.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.11.7.2.1" class="ltx_text" style="font-size:90%;">DFAF-2</span></td>
<td id="S4.T1.4.11.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.11.7.3.1" class="ltx_text" style="font-size:90%;">66.43</span></td>
</tr>
<tr id="S4.T1.4.12.8" class="ltx_tr">
<td id="S4.T1.4.12.8.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.12.8.1.1" class="ltx_text" style="font-size:90%;">DFAF-5</span></td>
<td id="S4.T1.4.12.8.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.12.8.2.1" class="ltx_text" style="font-size:90%;">66.58</span></td>
</tr>
<tr id="S4.T1.4.13.9" class="ltx_tr">
<td id="S4.T1.4.13.9.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.13.9.1.1" class="ltx_text" style="font-size:90%;">DFAF-8</span></td>
<td id="S4.T1.4.13.9.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.13.9.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.66</span></td>
</tr>
<tr id="S4.T1.4.14.10" class="ltx_tr">
<th id="S4.T1.4.14.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S4.T1.4.14.10.1.1" class="ltx_text" style="font-size:90%;">Attention type</span></th>
<td id="S4.T1.4.14.10.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.14.10.2.1" class="ltx_text" style="font-size:90%;">InterMAF only</span></td>
<td id="S4.T1.4.14.10.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.14.10.3.1" class="ltx_text" style="font-size:90%;">64.37</span></td>
</tr>
<tr id="S4.T1.4.15.11" class="ltx_tr">
<td id="S4.T1.4.15.11.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.15.11.1.1" class="ltx_text" style="font-size:90%;">IntraMAF only</span></td>
<td id="S4.T1.4.15.11.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.15.11.2.1" class="ltx_text" style="font-size:90%;">62.34</span></td>
</tr>
<tr id="S4.T1.4.16.12" class="ltx_tr">
<th id="S4.T1.4.16.12.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T1.4.16.12.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.16.12.2.1" class="ltx_text" style="font-size:90%;">DyIntraMAF only</span></td>
<td id="S4.T1.4.16.12.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.16.12.3.1" class="ltx_text" style="font-size:90%;">65.51</span></td>
</tr>
<tr id="S4.T1.4.17.13" class="ltx_tr">
<th id="S4.T1.4.17.13.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T1.4.17.13.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.17.13.2.1" class="ltx_text" style="font-size:90%;">InterMAF + DyIntraMAF</span></td>
<td id="S4.T1.4.17.13.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.17.13.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.21</span></td>
</tr>
<tr id="S4.T1.4.18.14" class="ltx_tr">
<th id="S4.T1.4.18.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S4.T1.4.18.14.1.1" class="ltx_text" style="font-size:90%;">Attention Direction inside InterMAF</span></th>
<td id="S4.T1.4.18.14.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.18.14.2.1" class="ltx_text" style="font-size:90%;">Parallel</span></td>
<td id="S4.T1.4.18.14.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.18.14.3.1" class="ltx_text" style="font-size:90%;">65.99</span></td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_center">
<math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="R\rightarrow E" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mi mathsize="90%" id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2.cmml">R</mi><mo mathsize="90%" stretchy="false" id="S4.T1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.m1.1.1.1.cmml">→</mo><mi mathsize="90%" id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><ci id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1">→</ci><ci id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">𝑅</ci><ci id="S4.T1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">R\rightarrow E</annotation></semantics></math><span id="S4.T1.2.2.2.1" class="ltx_text" style="font-size:90%;">, </span><math id="S4.T1.2.2.2.m2.1" class="ltx_Math" alttext="E\rightarrow R" display="inline"><semantics id="S4.T1.2.2.2.m2.1a"><mrow id="S4.T1.2.2.2.m2.1.1" xref="S4.T1.2.2.2.m2.1.1.cmml"><mi mathsize="90%" id="S4.T1.2.2.2.m2.1.1.2" xref="S4.T1.2.2.2.m2.1.1.2.cmml">E</mi><mo mathsize="90%" stretchy="false" id="S4.T1.2.2.2.m2.1.1.1" xref="S4.T1.2.2.2.m2.1.1.1.cmml">→</mo><mi mathsize="90%" id="S4.T1.2.2.2.m2.1.1.3" xref="S4.T1.2.2.2.m2.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m2.1b"><apply id="S4.T1.2.2.2.m2.1.1.cmml" xref="S4.T1.2.2.2.m2.1.1"><ci id="S4.T1.2.2.2.m2.1.1.1.cmml" xref="S4.T1.2.2.2.m2.1.1.1">→</ci><ci id="S4.T1.2.2.2.m2.1.1.2.cmml" xref="S4.T1.2.2.2.m2.1.1.2">𝐸</ci><ci id="S4.T1.2.2.2.m2.1.1.3.cmml" xref="S4.T1.2.2.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m2.1c">E\rightarrow R</annotation></semantics></math>
</td>
<td id="S4.T1.2.2.3" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.21</span></td>
</tr>
<tr id="S4.T1.4.4" class="ltx_tr">
<th id="S4.T1.4.4.3" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T1.4.4.2" class="ltx_td ltx_align_center">
<math id="S4.T1.3.3.1.m1.1" class="ltx_Math" alttext="E\rightarrow R" display="inline"><semantics id="S4.T1.3.3.1.m1.1a"><mrow id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml"><mi mathsize="90%" id="S4.T1.3.3.1.m1.1.1.2" xref="S4.T1.3.3.1.m1.1.1.2.cmml">E</mi><mo mathsize="90%" stretchy="false" id="S4.T1.3.3.1.m1.1.1.1" xref="S4.T1.3.3.1.m1.1.1.1.cmml">→</mo><mi mathsize="90%" id="S4.T1.3.3.1.m1.1.1.3" xref="S4.T1.3.3.1.m1.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><apply id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1"><ci id="S4.T1.3.3.1.m1.1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1.1">→</ci><ci id="S4.T1.3.3.1.m1.1.1.2.cmml" xref="S4.T1.3.3.1.m1.1.1.2">𝐸</ci><ci id="S4.T1.3.3.1.m1.1.1.3.cmml" xref="S4.T1.3.3.1.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">E\rightarrow R</annotation></semantics></math><span id="S4.T1.4.4.2.1" class="ltx_text" style="font-size:90%;">, </span><math id="S4.T1.4.4.2.m2.1" class="ltx_Math" alttext="R\rightarrow E" display="inline"><semantics id="S4.T1.4.4.2.m2.1a"><mrow id="S4.T1.4.4.2.m2.1.1" xref="S4.T1.4.4.2.m2.1.1.cmml"><mi mathsize="90%" id="S4.T1.4.4.2.m2.1.1.2" xref="S4.T1.4.4.2.m2.1.1.2.cmml">R</mi><mo mathsize="90%" stretchy="false" id="S4.T1.4.4.2.m2.1.1.1" xref="S4.T1.4.4.2.m2.1.1.1.cmml">→</mo><mi mathsize="90%" id="S4.T1.4.4.2.m2.1.1.3" xref="S4.T1.4.4.2.m2.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.2.m2.1b"><apply id="S4.T1.4.4.2.m2.1.1.cmml" xref="S4.T1.4.4.2.m2.1.1"><ci id="S4.T1.4.4.2.m2.1.1.1.cmml" xref="S4.T1.4.4.2.m2.1.1.1">→</ci><ci id="S4.T1.4.4.2.m2.1.1.2.cmml" xref="S4.T1.4.4.2.m2.1.1.2">𝑅</ci><ci id="S4.T1.4.4.2.m2.1.1.3.cmml" xref="S4.T1.4.4.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.2.m2.1c">R\rightarrow E</annotation></semantics></math>
</td>
<td id="S4.T1.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.1" class="ltx_text" style="font-size:90%;">66.19</span></td>
</tr>
<tr id="S4.T1.4.19.15" class="ltx_tr">
<th id="S4.T1.4.19.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S4.T1.4.19.15.1.1" class="ltx_text" style="font-size:90%;">Embedding dimension</span></th>
<td id="S4.T1.4.19.15.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.19.15.2.1" class="ltx_text" style="font-size:90%;">512</span></td>
<td id="S4.T1.4.19.15.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.19.15.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.21</span></td>
</tr>
<tr id="S4.T1.4.20.16" class="ltx_tr">
<td id="S4.T1.4.20.16.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.20.16.1.1" class="ltx_text" style="font-size:90%;">1024</span></td>
<td id="S4.T1.4.20.16.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.20.16.2.1" class="ltx_text" style="font-size:90%;">65.89</span></td>
</tr>
<tr id="S4.T1.4.21.17" class="ltx_tr">
<th id="S4.T1.4.21.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S4.T1.4.21.17.1.1" class="ltx_text" style="font-size:90%;">Cross-model feature fusion</span></th>
<td id="S4.T1.4.21.17.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.21.17.2.1" class="ltx_text" style="font-size:90%;">Multiplication</span></td>
<td id="S4.T1.4.21.17.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.21.17.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.21</span></td>
</tr>
<tr id="S4.T1.4.22.18" class="ltx_tr">
<td id="S4.T1.4.22.18.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.22.18.1.1" class="ltx_text" style="font-size:90%;">Addition</span></td>
<td id="S4.T1.4.22.18.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.22.18.2.1" class="ltx_text" style="font-size:90%;">66.11</span></td>
</tr>
<tr id="S4.T1.4.23.19" class="ltx_tr">
<td id="S4.T1.4.23.19.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.23.19.1.1" class="ltx_text" style="font-size:90%;">Concatenation</span></td>
<td id="S4.T1.4.23.19.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.23.19.2.1" class="ltx_text" style="font-size:90%;">66.14</span></td>
</tr>
<tr id="S4.T1.4.24.20" class="ltx_tr">
<th id="S4.T1.4.24.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S4.T1.4.24.20.1.1" class="ltx_text" style="font-size:90%;">Visual Sentinel</span></th>
<td id="S4.T1.4.24.20.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.24.20.2.1" class="ltx_text" style="font-size:90%;">None</span></td>
<td id="S4.T1.4.24.20.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.24.20.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.21</span></td>
</tr>
<tr id="S4.T1.4.25.21" class="ltx_tr">
<td id="S4.T1.4.25.21.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.25.21.1.1" class="ltx_text" style="font-size:90%;">1</span></td>
<td id="S4.T1.4.25.21.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.25.21.2.1" class="ltx_text" style="font-size:90%;">66.01</span></td>
</tr>
<tr id="S4.T1.4.26.22" class="ltx_tr">
<td id="S4.T1.4.26.22.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.26.22.1.1" class="ltx_text" style="font-size:90%;">3</span></td>
<td id="S4.T1.4.26.22.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.26.22.2.1" class="ltx_text" style="font-size:90%;">66.02</span></td>
</tr>
<tr id="S4.T1.4.27.23" class="ltx_tr">
<th id="S4.T1.4.27.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S4.T1.4.27.23.1.1" class="ltx_text" style="font-size:90%;">Bounding Box Embedding</span></th>
<td id="S4.T1.4.27.23.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.27.23.2.1" class="ltx_text" style="font-size:90%;">None</span></td>
<td id="S4.T1.4.27.23.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.27.23.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.21</span></td>
</tr>
<tr id="S4.T1.4.28.24" class="ltx_tr">
<td id="S4.T1.4.28.24.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.28.24.1.1" class="ltx_text" style="font-size:90%;">Absolute Position</span></td>
<td id="S4.T1.4.28.24.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.28.24.2.1" class="ltx_text" style="font-size:90%;">65.88</span></td>
</tr>
<tr id="S4.T1.4.29.25" class="ltx_tr">
<th id="S4.T1.4.29.25.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T1.4.29.25.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.29.25.2.1" class="ltx_text" style="font-size:90%;">Relative Position</span></td>
<td id="S4.T1.4.29.25.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.29.25.3.1" class="ltx_text" style="font-size:90%;">65.23</span></td>
</tr>
<tr id="S4.T1.4.30.26" class="ltx_tr">
<th id="S4.T1.4.30.26.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T1.4.30.26.1.1" class="ltx_text" style="font-size:90%;">Parallel Heads</span></th>
<td id="S4.T1.4.30.26.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.30.26.2.1" class="ltx_text" style="font-size:90%;">1 head each 512</span></td>
<td id="S4.T1.4.30.26.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.30.26.3.1" class="ltx_text" style="font-size:90%;">65.84</span></td>
</tr>
<tr id="S4.T1.4.31.27" class="ltx_tr">
<th id="S4.T1.4.31.27.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T1.4.31.27.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.31.27.2.1" class="ltx_text" style="font-size:90%;">4 heads each 128</span></td>
<td id="S4.T1.4.31.27.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.31.27.3.1" class="ltx_text" style="font-size:90%;">66.17</span></td>
</tr>
<tr id="S4.T1.4.32.28" class="ltx_tr">
<th id="S4.T1.4.32.28.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb"></th>
<td id="S4.T1.4.32.28.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.4.32.28.2.1" class="ltx_text" style="font-size:90%;">8 heads each 64</span></td>
<td id="S4.T1.4.32.28.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.4.32.28.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.21</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Ablation studies of our proposed DFAF on VQA 2.0 validation dataset. R stands for region features while E stands for word
embedding features</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation study of DFAF</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We perform extensive ablation studies on the VQA 2.0 validation dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. The results are shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Experimental Setup ‣ 4 Experiments ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Our default setting only has 1 block of DFAF module. Region features with 2,048 dimensions are extracted
from the input image by Faster RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, word features with 1,024 dimensions are extracted by GRU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. By default, all modules inside DFAF has 512
dimensions. In the final fusion layer, feature multiplication is employed, which shows a trivial improvement. Visual sentinel <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
and bounding box position embedding are also tested which give a slight drop in the final performance. 8 parallel attention heads with
dimensions 64 for each head is utilized in the default setting.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">We first investigate the influence of the number of stacked DFAF blocks. The default setting has one stack. As one can see from Table
 <a href="#S4.T1" title="Table 1 ‣ 4.2 Experimental Setup ‣ 4 Experiments ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, more stacks can improve the performance thanks to the residual connection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Different from ResNet,
we do not employ any normalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> technique during residual connection. The performance of single layer DFAF is comparable with BAN-12 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">Then, we investigate the influence of attention type. The attention mechanism in Bottom up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> utilizes simple attention methods. Bilinear
attention network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> proposed a bilinear attention which learns the joint attention distribution between each word and region pairs. By adding
the InterMAF, performance can improve by 1% because of the modelling the inter-modality relations between image regions and question words.
Integrating only the IntraMAF module would harm the performance because too many unrelated information flows hinder the learning process.
By adding dynamically conditioned information flow DyIntra MAF module, we achieve a 2.15% performance improvement. By combining Intra- and Inter-modality attention flows, we significantly outperform the baseline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> by 2.83% and previous state-of-the-art BAN-1 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> by 0.85%.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.4" class="ltx_p">There are several orders for passing information within the InterMAF module, namely, parallel and sequential <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. For parallel InterMAF, both region and word
features are updated at the same time. For the sequential information flow, we experiment with passing attention flow from regions to
words first, which updates word features, and then passing message from words to regions, which then update region features, and vice versa. We denote the first
sequential order as <math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="R\rightarrow E" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><mrow id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2" xref="S4.SS3.p4.1.m1.1.1.2.cmml">R</mi><mo stretchy="false" id="S4.SS3.p4.1.m1.1.1.1" xref="S4.SS3.p4.1.m1.1.1.1.cmml">→</mo><mi id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><ci id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1.1">→</ci><ci id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2">𝑅</ci><ci id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">R\rightarrow E</annotation></semantics></math>, <math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="E\rightarrow R" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><mrow id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><mi id="S4.SS3.p4.2.m2.1.1.2" xref="S4.SS3.p4.2.m2.1.1.2.cmml">E</mi><mo stretchy="false" id="S4.SS3.p4.2.m2.1.1.1" xref="S4.SS3.p4.2.m2.1.1.1.cmml">→</mo><mi id="S4.SS3.p4.2.m2.1.1.3" xref="S4.SS3.p4.2.m2.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><ci id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1.1">→</ci><ci id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2">𝐸</ci><ci id="S4.SS3.p4.2.m2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">E\rightarrow R</annotation></semantics></math>, and the second one as <math id="S4.SS3.p4.3.m3.1" class="ltx_Math" alttext="E\rightarrow R" display="inline"><semantics id="S4.SS3.p4.3.m3.1a"><mrow id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml"><mi id="S4.SS3.p4.3.m3.1.1.2" xref="S4.SS3.p4.3.m3.1.1.2.cmml">E</mi><mo stretchy="false" id="S4.SS3.p4.3.m3.1.1.1" xref="S4.SS3.p4.3.m3.1.1.1.cmml">→</mo><mi id="S4.SS3.p4.3.m3.1.1.3" xref="S4.SS3.p4.3.m3.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><apply id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1"><ci id="S4.SS3.p4.3.m3.1.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1.1">→</ci><ci id="S4.SS3.p4.3.m3.1.1.2.cmml" xref="S4.SS3.p4.3.m3.1.1.2">𝐸</ci><ci id="S4.SS3.p4.3.m3.1.1.3.cmml" xref="S4.SS3.p4.3.m3.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">E\rightarrow R</annotation></semantics></math>, <math id="S4.SS3.p4.4.m4.1" class="ltx_Math" alttext="R\rightarrow E" display="inline"><semantics id="S4.SS3.p4.4.m4.1a"><mrow id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml"><mi id="S4.SS3.p4.4.m4.1.1.2" xref="S4.SS3.p4.4.m4.1.1.2.cmml">R</mi><mo stretchy="false" id="S4.SS3.p4.4.m4.1.1.1" xref="S4.SS3.p4.4.m4.1.1.1.cmml">→</mo><mi id="S4.SS3.p4.4.m4.1.1.3" xref="S4.SS3.p4.4.m4.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><apply id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1"><ci id="S4.SS3.p4.4.m4.1.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1.1">→</ci><ci id="S4.SS3.p4.4.m4.1.1.2.cmml" xref="S4.SS3.p4.4.m4.1.1.2">𝑅</ci><ci id="S4.SS3.p4.4.m4.1.1.3.cmml" xref="S4.SS3.p4.4.m4.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">R\rightarrow E</annotation></semantics></math>. Sequential update outperforms parallel update way, while the specific order does not matter.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p">Next, we perform ablation study on the influence of embedding dimension and cross-model feature fusion. 512 dimensions result in better performance than
1024 dimensions. For the fusion method, multiplication shows a slight better performance than feature addition and concatenation.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.2" class="ltx_p">Visual sentinel <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> were utilized in many previous VQA methods, which was shown to increase the VQA accuracy. We treat sentinel as a general 512
dimension features and concatenate sentinel with all region and word features. Previous <math id="S4.SS3.p6.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p6.1.m1.1a"><mi id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><ci id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">\mu</annotation></semantics></math> region features and 14 word features become
into <math id="S4.SS3.p6.2.m2.1" class="ltx_Math" alttext="\mu+1" display="inline"><semantics id="S4.SS3.p6.2.m2.1a"><mrow id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml"><mi id="S4.SS3.p6.2.m2.1.1.2" xref="S4.SS3.p6.2.m2.1.1.2.cmml">μ</mi><mo id="S4.SS3.p6.2.m2.1.1.1" xref="S4.SS3.p6.2.m2.1.1.1.cmml">+</mo><mn id="S4.SS3.p6.2.m2.1.1.3" xref="S4.SS3.p6.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.1b"><apply id="S4.SS3.p6.2.m2.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1"><plus id="S4.SS3.p6.2.m2.1.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1.1"></plus><ci id="S4.SS3.p6.2.m2.1.1.2.cmml" xref="S4.SS3.p6.2.m2.1.1.2">𝜇</ci><cn type="integer" id="S4.SS3.p6.2.m2.1.1.3.cmml" xref="S4.SS3.p6.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.1c">\mu+1</annotation></semantics></math> and 15 respectively. In our experiments, adding visual sentinel do not show improvement.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<table id="S4.F3.8" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F3.8.8" class="ltx_tr">
<td id="S4.F3.8.8.8" class="ltx_td ltx_nopad_l ltx_align_center">
<table id="S4.F3.8.8.8.8" class="ltx_tabular ltx_align_middle">
<tr id="S4.F3.8.8.8.8.9" class="ltx_tr">
<td id="S4.F3.8.8.8.8.9.1" class="ltx_td ltx_align_center"><span id="S4.F3.8.8.8.8.9.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">IntraMAF weights</span></td>
<td id="S4.F3.8.8.8.8.9.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.9.2.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.9.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">          DyIntraMAF weights</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.9.3" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.9.3.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.9.3.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">          DyIntraMAF weights</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.9.4" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.9.4.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.9.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">          DyIntraMAF weights</span></span>
</span>
</td>
</tr>
<tr id="S4.F3.4.4.4.4.4" class="ltx_tr">
<td id="S4.F3.1.1.1.1.1.1" class="ltx_td ltx_align_center">
<span id="S4.F3.1.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">
</span><img src="/html/1812.05252/assets/picture/graph1_1.png" id="S4.F3.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="160" height="106" alt="Refer to caption">
</td>
<td id="S4.F3.2.2.2.2.2.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.2.2.2.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.2.2.2.2.2.2.1.1" class="ltx_p" style="width:115.6pt;"><img src="/html/1812.05252/assets/picture/graph1_3.png" id="S4.F3.2.2.2.2.2.2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="160" height="106" alt="Refer to caption"></span>
</span>
</td>
<td id="S4.F3.3.3.3.3.3.3" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.3.3.3.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.3.3.3.3.3.3.1.1" class="ltx_p" style="width:115.6pt;"><img src="/html/1812.05252/assets/picture/graph1_4.png" id="S4.F3.3.3.3.3.3.3.1.1.g1" class="ltx_graphics ltx_img_landscape" width="160" height="106" alt="Refer to caption"></span>
</span>
</td>
<td id="S4.F3.4.4.4.4.4.4" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.4.4.4.4.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.4.4.4.4.4.4.1.1" class="ltx_p" style="width:115.6pt;"><img src="/html/1812.05252/assets/picture/graph1_2.png" id="S4.F3.4.4.4.4.4.4.1.1.g1" class="ltx_graphics ltx_img_landscape" width="160" height="106" alt="Refer to caption"></span>
</span>
</td>
</tr>
<tr id="S4.F3.8.8.8.8.10" class="ltx_tr">
<td id="S4.F3.8.8.8.8.10.1" class="ltx_td ltx_align_center">
<span id="S4.F3.8.8.8.8.10.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.10.1.2" class="ltx_text" style="font-size:80%;">: Is the </span><span id="S4.F3.8.8.8.8.10.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.10.1.3.1" class="ltx_emph ltx_font_italic">skier</em></span><span id="S4.F3.8.8.8.8.10.1.4" class="ltx_text" style="font-size:80%;"> wearing </span><span id="S4.F3.8.8.8.8.10.1.5" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.10.1.5.1" class="ltx_emph ltx_font_italic">goggles</em></span><span id="S4.F3.8.8.8.8.10.1.6" class="ltx_text" style="font-size:80%;">? </span><span id="S4.F3.8.8.8.8.10.1.7" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.10.1.8" class="ltx_text" style="font-size:80%;">:</span><span id="S4.F3.8.8.8.8.10.1.9" class="ltx_text" style="font-size:80%;color:#FF0000;">No</span>
</td>
<td id="S4.F3.8.8.8.8.10.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.10.2.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.10.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.10.2.1.1.2" class="ltx_text" style="font-size:80%;">: Is the </span><span id="S4.F3.8.8.8.8.10.2.1.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.10.2.1.1.3.1" class="ltx_emph ltx_font_italic">skier</em></span><span id="S4.F3.8.8.8.8.10.2.1.1.4" class="ltx_text" style="font-size:80%;"> wearing </span><span id="S4.F3.8.8.8.8.10.2.1.1.5" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.10.2.1.1.5.1" class="ltx_emph ltx_font_italic">goggles</em></span><span id="S4.F3.8.8.8.8.10.2.1.1.6" class="ltx_text" style="font-size:80%;">?</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.10.3" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.10.3.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.10.3.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.10.3.1.1.2" class="ltx_text" style="font-size:80%;">: Is this </span><span id="S4.F3.8.8.8.8.10.3.1.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.10.3.1.1.3.1" class="ltx_emph ltx_font_italic">skier</em></span><span id="S4.F3.8.8.8.8.10.3.1.1.4" class="ltx_text" style="font-size:80%;"> using </span><span id="S4.F3.8.8.8.8.10.3.1.1.5" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.10.3.1.1.5.1" class="ltx_emph ltx_font_italic">poles</em></span><span id="S4.F3.8.8.8.8.10.3.1.1.6" class="ltx_text" style="font-size:80%;">?</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.10.4" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.10.4.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.10.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.10.4.1.1.2" class="ltx_text" style="font-size:80%;">: What is the </span><span id="S4.F3.8.8.8.8.10.4.1.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.10.4.1.1.3.1" class="ltx_emph ltx_font_italic">person</em></span><span id="S4.F3.8.8.8.8.10.4.1.1.4" class="ltx_text" style="font-size:80%;"> standing on?</span></span>
</span>
</td>
</tr>
<tr id="S4.F3.8.8.8.8.11" class="ltx_tr">
<td id="S4.F3.8.8.8.8.11.1" class="ltx_td ltx_align_center">
<span id="S4.F3.8.8.8.8.11.1.1" class="ltx_text" style="font-size:80%;">
</span><span id="S4.F3.8.8.8.8.11.1.2" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.11.1.3" class="ltx_text" style="font-size:80%;">: What is the </span><span id="S4.F3.8.8.8.8.11.1.4" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.11.1.4.1" class="ltx_emph ltx_font_italic">person</em></span><span id="S4.F3.8.8.8.8.11.1.5" class="ltx_text" style="font-size:80%;"> standing?  </span><span id="S4.F3.8.8.8.8.11.1.6" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.11.1.7" class="ltx_text" style="font-size:80%;">:</span><span id="S4.F3.8.8.8.8.11.1.8" class="ltx_text" style="font-size:80%;color:#00FF00;">Skis</span>
</td>
<td id="S4.F3.8.8.8.8.11.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.11.2.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.11.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.11.2.1.1.2" class="ltx_text" style="font-size:80%;">: </span><span id="S4.F3.8.8.8.8.11.2.1.1.3" class="ltx_text" style="font-size:80%;color:#00FF00;">Yes</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.11.3" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.11.3.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.11.3.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.11.3.1.1.2" class="ltx_text" style="font-size:80%;">: </span><span id="S4.F3.8.8.8.8.11.3.1.1.3" class="ltx_text" style="font-size:80%;color:#00FF00;">Yes</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.11.4" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.11.4.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.11.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.11.4.1.1.2" class="ltx_text" style="font-size:80%;">: </span><span id="S4.F3.8.8.8.8.11.4.1.1.3" class="ltx_text" style="font-size:80%;color:#00FF00;">Skis</span></span>
</span>
</td>
</tr>
<tr id="S4.F3.8.8.8.8.12" class="ltx_tr">
<td id="S4.F3.8.8.8.8.12.1" class="ltx_td ltx_align_center">
<span id="S4.F3.8.8.8.8.12.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.12.1.2" class="ltx_text" style="font-size:80%;">: Is this </span><span id="S4.F3.8.8.8.8.12.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.12.1.3.1" class="ltx_emph ltx_font_italic">skier</em></span><span id="S4.F3.8.8.8.8.12.1.4" class="ltx_text" style="font-size:80%;"> using </span><span id="S4.F3.8.8.8.8.12.1.5" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.12.1.5.1" class="ltx_emph ltx_font_italic">poles</em></span><span id="S4.F3.8.8.8.8.12.1.6" class="ltx_text" style="font-size:80%;">? </span><span id="S4.F3.8.8.8.8.12.1.7" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.12.1.8" class="ltx_text" style="font-size:80%;">:</span><span id="S4.F3.8.8.8.8.12.1.9" class="ltx_text" style="font-size:80%;color:#FF0000;">No</span>
</td>
<td id="S4.F3.8.8.8.8.12.2" class="ltx_td ltx_nopad_l ltx_align_top"></td>
<td id="S4.F3.8.8.8.8.12.3" class="ltx_td ltx_nopad_l ltx_align_top"></td>
<td id="S4.F3.8.8.8.8.12.4" class="ltx_td ltx_nopad_l ltx_align_top"></td>
</tr>
<tr id="S4.F3.8.8.8.8.8" class="ltx_tr">
<td id="S4.F3.5.5.5.5.5.1" class="ltx_td ltx_align_center"><img src="/html/1812.05252/assets/picture/graph2_1.png" id="S4.F3.5.5.5.5.5.1.g1" class="ltx_graphics ltx_img_landscape" width="160" height="102" alt="Refer to caption"></td>
<td id="S4.F3.6.6.6.6.6.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.6.6.6.6.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.6.6.6.6.6.2.1.1" class="ltx_p" style="width:115.6pt;"><img src="/html/1812.05252/assets/picture/graph2_2.png" id="S4.F3.6.6.6.6.6.2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="160" height="102" alt="Refer to caption"></span>
</span>
</td>
<td id="S4.F3.7.7.7.7.7.3" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.7.7.7.7.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.7.7.7.7.7.3.1.1" class="ltx_p" style="width:115.6pt;"><img src="/html/1812.05252/assets/picture/graph2_4.png" id="S4.F3.7.7.7.7.7.3.1.1.g1" class="ltx_graphics ltx_img_landscape" width="160" height="102" alt="Refer to caption"></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.8.4" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.8.4.1.1" class="ltx_p" style="width:115.6pt;"><img src="/html/1812.05252/assets/picture/graph2_3.png" id="S4.F3.8.8.8.8.8.4.1.1.g1" class="ltx_graphics ltx_img_landscape" width="160" height="102" alt="Refer to caption"></span>
</span>
</td>
</tr>
<tr id="S4.F3.8.8.8.8.13" class="ltx_tr">
<td id="S4.F3.8.8.8.8.13.1" class="ltx_td ltx_align_center">
<span id="S4.F3.8.8.8.8.13.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.13.1.2" class="ltx_text" style="font-size:80%;">: How many </span><span id="S4.F3.8.8.8.8.13.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.13.1.3.1" class="ltx_emph ltx_font_italic">vehicles</em></span><span id="S4.F3.8.8.8.8.13.1.4" class="ltx_text" style="font-size:80%;"> are in the street? </span><span id="S4.F3.8.8.8.8.13.1.5" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.13.1.6" class="ltx_text" style="font-size:80%;">:</span><span id="S4.F3.8.8.8.8.13.1.7" class="ltx_text" style="font-size:80%;color:#FF0000;">1</span>
</td>
<td id="S4.F3.8.8.8.8.13.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.13.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.13.2.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.13.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.13.2.1.1.2" class="ltx_text" style="font-size:80%;">: How many </span><span id="S4.F3.8.8.8.8.13.2.1.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.13.2.1.1.3.1" class="ltx_emph ltx_font_italic">vehicles</em></span><span id="S4.F3.8.8.8.8.13.2.1.1.4" class="ltx_text" style="font-size:80%;"> are in street?</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.13.3" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.13.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.13.3.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.13.3.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.13.3.1.1.2" class="ltx_text" style="font-size:80%;">: Are there any </span><span id="S4.F3.8.8.8.8.13.3.1.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.13.3.1.1.3.1" class="ltx_emph ltx_font_italic">people</em></span><span id="S4.F3.8.8.8.8.13.3.1.1.4" class="ltx_text" style="font-size:80%;"> on street?</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.13.4" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.13.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.13.4.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.13.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.13.4.1.1.2" class="ltx_text" style="font-size:80%;">: Where will the bus </span><span id="S4.F3.8.8.8.8.13.4.1.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.13.4.1.1.3.1" class="ltx_emph ltx_font_italic">go</em></span><span id="S4.F3.8.8.8.8.13.4.1.1.4" class="ltx_text" style="font-size:80%;">?</span></span>
</span>
</td>
</tr>
<tr id="S4.F3.8.8.8.8.14" class="ltx_tr">
<td id="S4.F3.8.8.8.8.14.1" class="ltx_td ltx_align_center">
<span id="S4.F3.8.8.8.8.14.1.1" class="ltx_text" style="font-size:80%;">
</span><span id="S4.F3.8.8.8.8.14.1.2" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.14.1.3" class="ltx_text" style="font-size:80%;">: Are there any </span><span id="S4.F3.8.8.8.8.14.1.4" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.14.1.4.1" class="ltx_emph ltx_font_italic">people</em></span><span id="S4.F3.8.8.8.8.14.1.5" class="ltx_text" style="font-size:80%;"> on the street?  </span><span id="S4.F3.8.8.8.8.14.1.6" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.14.1.7" class="ltx_text" style="font-size:80%;">:</span><span id="S4.F3.8.8.8.8.14.1.8" class="ltx_text" style="font-size:80%;color:#00FF00;">No</span>
</td>
<td id="S4.F3.8.8.8.8.14.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.14.2.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.14.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.14.2.1.1.2" class="ltx_text" style="font-size:80%;">: </span><span id="S4.F3.8.8.8.8.14.2.1.1.3" class="ltx_text" style="font-size:80%;color:#00FF00;">2</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.14.3" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.14.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.14.3.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.14.3.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.14.3.1.1.2" class="ltx_text" style="font-size:80%;">: </span><span id="S4.F3.8.8.8.8.14.3.1.1.3" class="ltx_text" style="font-size:80%;color:#00FF00;">No</span></span>
</span>
</td>
<td id="S4.F3.8.8.8.8.14.4" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top">
<span id="S4.F3.8.8.8.8.14.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.F3.8.8.8.8.14.4.1.1" class="ltx_p" style="width:115.6pt;"><span id="S4.F3.8.8.8.8.14.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.14.4.1.1.2" class="ltx_text" style="font-size:80%;">: </span><span id="S4.F3.8.8.8.8.14.4.1.1.3" class="ltx_text" style="font-size:80%;color:#FF0000;">School</span></span>
</span>
</td>
</tr>
<tr id="S4.F3.8.8.8.8.15" class="ltx_tr">
<td id="S4.F3.8.8.8.8.15.1" class="ltx_td ltx_align_center">
<span id="S4.F3.8.8.8.8.15.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Q</span><span id="S4.F3.8.8.8.8.15.1.2" class="ltx_text" style="font-size:80%;">: Where will the bus </span><span id="S4.F3.8.8.8.8.15.1.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:80%;"><em id="S4.F3.8.8.8.8.15.1.3.1" class="ltx_emph ltx_font_italic">go</em></span><span id="S4.F3.8.8.8.8.15.1.4" class="ltx_text" style="font-size:80%;">? </span><span id="S4.F3.8.8.8.8.15.1.5" class="ltx_text ltx_font_bold" style="font-size:80%;">A</span><span id="S4.F3.8.8.8.8.15.1.6" class="ltx_text" style="font-size:80%;">:</span><span id="S4.F3.8.8.8.8.15.1.7" class="ltx_text" style="font-size:80%;color:#FF0000;">School</span>
</td>
<td id="S4.F3.8.8.8.8.15.2" class="ltx_td ltx_nopad_l ltx_align_top"></td>
<td id="S4.F3.8.8.8.8.15.3" class="ltx_td ltx_nopad_l ltx_align_top"></td>
<td id="S4.F3.8.8.8.8.15.4" class="ltx_td ltx_nopad_l ltx_align_top"></td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:80%;"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.12.1.1" class="ltx_text" style="font-size:113%;">Figure 3</span>: </span><span id="S4.F3.13.2" class="ltx_text" style="font-size:113%;">Visualisation of IntraMAF and DyIntraMAF attention weights between central region(red) and other related regions. (Left) The IntraMAF module treats different questions equally and generate uninformative weight for different questions. (Right) The proposed DyIntraMAF module dynamically changes attention weights according to input questions.</span></figcaption>
</figure>
<div id="S4.SS3.p7" class="ltx_para">
<p id="S4.SS3.p7.1" class="ltx_p">The positions of bounding boxes were widely utilized as a part of image region features in previous methods. Absolute position embedding has been employed in
Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, BERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and Gated CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> in NLP. Relative position was adopted in relation network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> for object
detection. In our experiment, adding absolute or relative positions would drop the performance.</p>
</div>
<div id="S4.SS3.p8" class="ltx_para">
<p id="S4.SS3.p8.1" class="ltx_p">At last, we experiment on the influence of multi-head attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.
We keep the overall dimensions to be 512. 1, 4 and 8 attention heads are experimented. As can be seen in Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Experimental Setup ‣ 4 Experiments ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>,
8 attention can achieve better performance at the same number of parameters.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Visualisation of the proposed Attention Flow Weights</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">In Figure <a href="#S4.F3" title="Figure 3 ‣ 4.3 Ablation study of DFAF ‣ 4 Experiments ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we visualise the intra-modality attention flow weights to analyse VQA model. The attention weights modulate information flow from contextual regions(orange, blue and green) to center region(red). The left column stands for the attention flow weights in the IntraMAF module. While the rest columns represent dynamic attention flow weights in the DyIntraMAF module. In the DyIntraMAF module, unrelated information flow are filtered out by question features and thus generate the correct answer.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Comparison with State-of-the-arts methods</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.5 Comparison with State-of-the-arts methods ‣ 4 Experiments ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the performance of our proposed algorithm trained with extra visual genome dataset and state-of-the-art methods on VQA.
Bottom up in Table  <a href="#S4.T2" title="Table 2 ‣ 4.5 Comparison with State-of-the-arts methods ‣ 4 Experiments ‣ Dynamic Fusion with Intra- and Inter-modality Attention Flow for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is the winner of VQA challenge 2017. This approach proposed to use features based on Faster RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> instead of
ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Multi-modal Factorized High-order Pooling (MFH) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> is a state-of-the-art bilinear pooling methods. Dense Co-Attention Network (DCN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> utilized dense stack of multiple
layers of Co-attention mechanism which significantly outperform previous methods with ResNet features. Counting methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> are good at counting
questions by utilizing the information of bounding boxes. Bilinear Attention Network (BAN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> is a state-of-the-art approach on VQA 2.0 which has 12 stacked blocks of BAN modules. By utilising contextualised word embedding BERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, the performance of VQA can be further boosted.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.2.1.1" class="ltx_tr">
<th id="S4.T2.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T2.2.1.1.1.1" class="ltx_text" style="font-size:80%;">Model</span></th>
<td id="S4.T2.2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S4.T2.2.1.1.2.1" class="ltx_text" style="font-size:80%;">test-dev</span></td>
<td id="S4.T2.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.2.1.1.3.1" class="ltx_text" style="font-size:80%;">test-std</span></td>
</tr>
<tr id="S4.T2.2.2.2" class="ltx_tr">
<td id="S4.T2.2.2.2.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.2.2.1.1" class="ltx_text" style="font-size:80%;">Y/N</span></td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.2.2.2.1" class="ltx_text" style="font-size:80%;">No.</span></td>
<td id="S4.T2.2.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.2.2.3.1" class="ltx_text" style="font-size:80%;">Other</span></td>
<td id="S4.T2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.2.2.4.1" class="ltx_text" style="font-size:80%;">All</span></td>
<td id="S4.T2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.2.2.5.1" class="ltx_text" style="font-size:80%;">All</span></td>
</tr>
<tr id="S4.T2.2.3.3" class="ltx_tr">
<th id="S4.T2.2.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S4.T2.2.3.3.1.1" class="ltx_text" style="font-size:80%;">Bottom-up </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.3.3.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S4.T2.2.3.3.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T2.2.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.3.3.2.1" class="ltx_text" style="font-size:80%;">81.82</span></td>
<td id="S4.T2.2.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.3.3.3.1" class="ltx_text" style="font-size:80%;">44.21</span></td>
<td id="S4.T2.2.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.3.3.4.1" class="ltx_text" style="font-size:80%;">56.05</span></td>
<td id="S4.T2.2.3.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.3.3.5.1" class="ltx_text" style="font-size:80%;">65.32</span></td>
<td id="S4.T2.2.3.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.3.3.6.1" class="ltx_text" style="font-size:80%;">65.67</span></td>
</tr>
<tr id="S4.T2.2.4.4" class="ltx_tr">
<th id="S4.T2.2.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.4.4.1.1" class="ltx_text" style="font-size:80%;">MFH </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.4.4.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T2.2.4.4.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T2.2.4.4.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.4.4.2.1" class="ltx_text" style="font-size:80%;">n/a</span></td>
<td id="S4.T2.2.4.4.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.4.4.3.1" class="ltx_text" style="font-size:80%;">n/a</span></td>
<td id="S4.T2.2.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.4.4.4.1" class="ltx_text" style="font-size:80%;">n/a</span></td>
<td id="S4.T2.2.4.4.5" class="ltx_td ltx_align_center"><span id="S4.T2.2.4.4.5.1" class="ltx_text" style="font-size:80%;">66.12</span></td>
<td id="S4.T2.2.4.4.6" class="ltx_td ltx_align_center"><span id="S4.T2.2.4.4.6.1" class="ltx_text" style="font-size:80%;">n/a</span></td>
</tr>
<tr id="S4.T2.2.5.5" class="ltx_tr">
<th id="S4.T2.2.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.5.5.1.1" class="ltx_text" style="font-size:80%;">DCN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.5.5.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib29" title="" class="ltx_ref">29</a><span id="S4.T2.2.5.5.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T2.2.5.5.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.5.5.2.1" class="ltx_text" style="font-size:80%;">83.51</span></td>
<td id="S4.T2.2.5.5.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.5.5.3.1" class="ltx_text" style="font-size:80%;">46.61</span></td>
<td id="S4.T2.2.5.5.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.5.5.4.1" class="ltx_text" style="font-size:80%;">57.26</span></td>
<td id="S4.T2.2.5.5.5" class="ltx_td ltx_align_center"><span id="S4.T2.2.5.5.5.1" class="ltx_text" style="font-size:80%;">66.87</span></td>
<td id="S4.T2.2.5.5.6" class="ltx_td ltx_align_center"><span id="S4.T2.2.5.5.6.1" class="ltx_text" style="font-size:80%;">66.97</span></td>
</tr>
<tr id="S4.T2.2.6.6" class="ltx_tr">
<th id="S4.T2.2.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.6.6.1.1" class="ltx_text" style="font-size:80%;">Counter </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.6.6.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib44" title="" class="ltx_ref">44</a><span id="S4.T2.2.6.6.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T2.2.6.6.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.6.6.2.1" class="ltx_text" style="font-size:80%;">83.14</span></td>
<td id="S4.T2.2.6.6.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.6.6.3.1" class="ltx_text" style="font-size:80%;">51.62</span></td>
<td id="S4.T2.2.6.6.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.6.6.4.1" class="ltx_text" style="font-size:80%;">58.97</span></td>
<td id="S4.T2.2.6.6.5" class="ltx_td ltx_align_center"><span id="S4.T2.2.6.6.5.1" class="ltx_text" style="font-size:80%;">68.09</span></td>
<td id="S4.T2.2.6.6.6" class="ltx_td ltx_align_center"><span id="S4.T2.2.6.6.6.1" class="ltx_text" style="font-size:80%;">68.41</span></td>
</tr>
<tr id="S4.T2.2.7.7" class="ltx_tr">
<th id="S4.T2.2.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.7.7.1.1" class="ltx_text" style="font-size:80%;">MFH+Bottom-Up </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.7.7.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T2.2.7.7.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T2.2.7.7.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.7.7.2.1" class="ltx_text" style="font-size:80%;">84.27</span></td>
<td id="S4.T2.2.7.7.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.7.7.3.1" class="ltx_text" style="font-size:80%;">49.56</span></td>
<td id="S4.T2.2.7.7.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.7.7.4.1" class="ltx_text" style="font-size:80%;">59.89</span></td>
<td id="S4.T2.2.7.7.5" class="ltx_td ltx_align_center"><span id="S4.T2.2.7.7.5.1" class="ltx_text" style="font-size:80%;">68.76</span></td>
<td id="S4.T2.2.7.7.6" class="ltx_td ltx_align_center"><span id="S4.T2.2.7.7.6.1" class="ltx_text" style="font-size:80%;">n/a</span></td>
</tr>
<tr id="S4.T2.2.8.8" class="ltx_tr">
<th id="S4.T2.2.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.8.8.1.1" class="ltx_text" style="font-size:80%;">BAN+Glove </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.8.8.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib19" title="" class="ltx_ref">19</a><span id="S4.T2.2.8.8.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T2.2.8.8.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.8.8.2.1" class="ltx_text" style="font-size:80%;">85.46</span></td>
<td id="S4.T2.2.8.8.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.8.8.3.1" class="ltx_text" style="font-size:80%;">50.66</span></td>
<td id="S4.T2.2.8.8.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">60.50</span></td>
<td id="S4.T2.2.8.8.5" class="ltx_td ltx_align_center"><span id="S4.T2.2.8.8.5.1" class="ltx_text" style="font-size:80%;">69.66</span></td>
<td id="S4.T2.2.8.8.6" class="ltx_td ltx_align_center"><span id="S4.T2.2.8.8.6.1" class="ltx_text" style="font-size:80%;">n/a</span></td>
</tr>
<tr id="S4.T2.2.9.9" class="ltx_tr">
<th id="S4.T2.2.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T2.2.9.9.1.1" class="ltx_text" style="font-size:80%;">DFAF(ours)</span></th>
<td id="S4.T2.2.9.9.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.9.9.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">86.09</span></td>
<td id="S4.T2.2.9.9.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.9.9.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">53.32</span></td>
<td id="S4.T2.2.9.9.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.9.9.4.1" class="ltx_text" style="font-size:80%;">60.49</span></td>
<td id="S4.T2.2.9.9.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.9.9.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">70.22</span></td>
<td id="S4.T2.2.9.9.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.9.9.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">70.34</span></td>
</tr>
<tr id="S4.T2.2.10.10" class="ltx_tr">
<th id="S4.T2.2.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S4.T2.2.10.10.1.1" class="ltx_text" style="font-size:80%;">DFAF-BERT(ours)</span></th>
<td id="S4.T2.2.10.10.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.10.10.2.1" class="ltx_text" style="font-size:80%;">86.73</span></td>
<td id="S4.T2.2.10.10.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.10.10.3.1" class="ltx_text" style="font-size:80%;">52.92</span></td>
<td id="S4.T2.2.10.10.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.10.10.4.1" class="ltx_text" style="font-size:80%;">61.04</span></td>
<td id="S4.T2.2.10.10.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.10.10.5.1" class="ltx_text" style="font-size:80%;">70.59</span></td>
<td id="S4.T2.2.10.10.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.10.10.6.1" class="ltx_text" style="font-size:80%;">70.81</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.5.1.1" class="ltx_text" style="font-size:113%;">Table 2</span>: </span><span id="S4.T2.6.2" class="ltx_text" style="font-size:113%;">Comparison with previous state-of-the-art methods on VQA 2.0 test dataset.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we proposed a novel framework Dynamic Fusion with Intra- and Inter-modality Attention Flow (DFAF) for visual question answering. The DFAF framework alternatively passes information within and across different modalities based on an inter-modality and intra-modality attention mechanisms. The information flow inside visual features are
dynamically conditioned on the question features. Stacking multiple blocks of DFAF are shown to improve the performance of VQA.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work is supported in part by SenseTime Group Limited, in part by the General Research Fund through the Research Grants Council of Hong Kong under Grants CUHK14202217, CUHK14203118, CUHK14205615, CUHK14207814, CUHK14213616, CUHK14208417, CUHK14239816, and in part by CUHK Direct Grant.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Bottom-up and top-down attention for image captioning and visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">,
2018.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra,
C Lawrence Zitnick, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Vqa: Visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE International Conference on Computer Vision</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, pages
2425–2433, 2015.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Neural machine translation by jointly learning to align and
translate.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Hedi Ben-younes, Remi Cadene, Matthieu Cord, and Nicolas Thome.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">MUTAN: Multimodal Tucker Fusion for Visual Question
Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE International Conference on Computer Vision</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Junyoung Chung, Caglar Gulcehre, KyungHyun Cho, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Empirical evaluation of gated recurrent neural networks on sequence
modeling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.3555</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Bert: Pre-training of deep bidirectional transformers for language
understanding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1810.04805</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Akira Fukui, Dong Huk Park, Daylen Yang, Anna Rohrbach, Trevor Darrell, and
Marcus Rohrbach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Multimodal compact bilinear pooling for visual question answering and
visual grounding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2016 Conference on Empirical Methods in
Natural Language Processing</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, pages 457–468, 2016.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Peng Gao, Hongsheng Li, Shuang Li, Pan Lu, Yikang Li, Steven CH Hoi, and
Xiaogang Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Question-guided hybrid convolution for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, pages 469–485, 2018.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Yang Gao, Oscar Beijbom, Ning Zhang, and Trevor Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Compact bilinear pooling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">,
pages 317–326, 2016.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Jonas Gehring, Michael Auli, David Grangier, Denis Yarats, and Yann N Dauphin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Convolutional sequence to sequence learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, pages
1243–1252, 2017.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Making the V in VQA matter: Elevating the role of image
understanding in Visual Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">,
2017.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Danna Gurari, Qing Li, Abigale J Stangl, Anhong Guo, Chi Lin, Kristen Grauman,
Jiebo Luo, and Jeffrey P Bigham.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Vizwiz grand challenge: Answering visual questions from blind people.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">,
2018.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">,
pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Han Hu, Jiayuan Gu, Zheng Zhang, Jifeng Dai, and Yichen Wei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Relation networks for object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">,
volume 2, 2018.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Jie Hu, Li Shen, and Gang Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Squeeze-and-excitation networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">,
2017.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Gao Huang, Zhuang Liu, Laurens Van Der Maaten, and Kilian Q Weinberger.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Densely connected convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">,
volume 1, page 3, 2017.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Sergey Ioffe and Christian Szegedy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Batch normalization: Accelerating deep network training by reducing
internal covariate shift.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1502.03167</span><span id="bib.bib17.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Zhengkai Jiang, Peng Gao, Chaoxu Guo, Qian Zhang, Shiming Xiang, and Chunhong
Pan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Video object detection with locally-weighted deformable neighbors.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial Intelligence</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">,
33(01):8529–8536, Jul. 2019.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Jin-Hwa Kim, Jaehyun Jun, and Byoung-Tak Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Bilinear attention networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1805.07932</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Jin-Hwa Kim, Kyoung Woon On, Woosang Lim, Jeonghee Kim, Jung-Woo Ha, and
Byoung-Tak Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Hadamard product for low-rank bilinear pooling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Yoon Kim, Carl Denton, Luong Hoang, and Alexander M Rush.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Structured attention networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Diederik P Kingma and Jimmy Ba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.6980</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A Shamma, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">International Journal of Computer Vision</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 123(1):32–73, 2017.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Shuang Li, Tong Xiao, Hongsheng Li, Wei Yang, and Xiaogang Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Identity-aware textual-visual matching with latent co-attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision (ICCV), 2017 IEEE International Conference
on</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, pages 1908–1917. IEEE, 2017.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages 740–755. Springer, 2014.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Xihui Liu, Hongsheng Li, Jing Shao, Dapeng Chen, and Xiaogang Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Show, tell and discriminate: Image captioning by self-retrieval with
partially labeled data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European Conference on Computer Vision</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, pages 353–369.
Springer, 2018.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Jiasen Lu, Caiming Xiong, Devi Parikh, and Richard Socher.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Knowing when to look: Adaptive attention via a visual sentinel for
image captioning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">,
pages 3242–3250. IEEE, 2017.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Jiasen Lu, Jianwei Yang, Dhruv Batra, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Hierarchical question-image co-attention for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances In Neural Information Processing Systems</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, pages
289–297, 2016.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Duy-Kien Nguyen and Takayuki Okatani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Improved fusion of visual and language representations by dense
symmetric co-attention for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">,
2018.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Hyeonwoo Noh, Paul Hongsuck Seo, and Bohyung Han.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Image question answering using convolutional neural network with
dynamic parameter prediction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">,
pages 30–38, 2016.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Adam Paszke, Sam Gross, Soumith Chintala, Gregory Chanan, Edward Yang, Zachary
DeVito, Zeming Lin, Alban Desmaison, Luca Antiga, and Adam Lerer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Automatic differentiation in pytorch.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">2017.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Jeffrey Pennington, Richard Socher, and Christopher Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Glove: Global vectors for word representation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">The Conference on Empirical Methods in Natural Language
Processing</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 1532–1543, 2014.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Faster r-cnn: Towards real-time object detection with region proposal
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, pages
91–99, 2015.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Peter Shaw, Jakob Uszkoreit, and Ashish Vaswani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Self-attention with relative position representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">The Conference of the North American Chapter of the
Association for Computational Linguistics</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, volume 2, pages 464–468, 2018.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Karen Simonyan and Andrew Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1409.1556</span><span id="bib.bib35.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Shuyang Sun, Jiangmiao Pang, Jianping Shi, Shuai Yi, and Wanli Ouyang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Fishnet: A versatile backbone for image, region, and pixel level
prediction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, pages
760–770, 2018.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, pages
5998–6008, 2017.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Xiaolong Wang, Ross Girshick, Abhinav Gupta, and Kaiming He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Non-local neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">,
2018.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Caiming Xiong, Victor Zhong, and Richard Socher.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Dynamic coattention networks for question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Kelvin Xu, Jimmy Ba, Ryan Kiros, Kyunghyun Cho, Aaron Courville, Ruslan
Salakhudinov, Rich Zemel, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Show, attend and tell: Neural image caption generation with visual
attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, pages
2048–2057, 2015.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Kui Xu, Zhe Wang, Jiangping Shi, Hongsheng Li, and Qiangfeng Cliff Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">A2-net: Molecular structure estimation from cryo-em density volumes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1901.00785</span><span id="bib.bib41.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Ting Yao, Yingwei Pan, Yehao Li, and Tao Mei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Exploring visual relationship for image captioning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, pages 684–699, 2018.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Zhou Yu, Jun Yu, Chenchao Xiang, Jianping Fan, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Beyond bilinear: Generalized multimodal factorized high-order pooling
for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</span><span id="bib.bib43.4.2" class="ltx_text" style="font-size:90%;">,
(99):1–13, 2018.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Yan Zhang, Jonathon Hare, and Adam Prügel-Bennett.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Learning to count objects in natural images for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib44.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib44.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Bolei Zhou, Yuandong Tian, Sainbayar Sukhbaatar, Arthur Szlam, and Rob Fergus.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Simple baseline for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1512.02167</span><span id="bib.bib45.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Chen Zhu, Yanpeng Zhao, Shuaiyi Huang, Kewei Tu, and Yi Ma.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Structured attentions for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE International Conference on Computer Vision (ICCV)</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">,
pages 1300–1309. IEEE, 2017.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1812.05251" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1812.05252" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1812.05252">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1812.05252" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1812.05253" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar 16 07:16:12 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
