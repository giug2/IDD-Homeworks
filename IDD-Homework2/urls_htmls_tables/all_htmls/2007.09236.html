<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2007.09236] Multi-Task Federated Learning for Personalised Deep Neural Networks in Edge Computing</title><meta property="og:description" content="Federated Learning (FL) is an emerging approach for collaboratively training Deep Neural Networks (DNNs) on mobile devices, without private user data leaving the devices. Previous works have shown that non-Independent …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Multi-Task Federated Learning for Personalised Deep Neural Networks in Edge Computing">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Multi-Task Federated Learning for Personalised Deep Neural Networks in Edge Computing">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2007.09236">

<!--Generated on Sat Mar  2 10:35:19 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated Learning,  Multi-Task Learning,  Deep Learning,  Edge Computing,  Adaptive Optimization.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Multi-Task Federated Learning for Personalised 
<br class="ltx_break">Deep Neural Networks in Edge Computing</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jed Mills, Jia Hu, Geyong Min
</span><span class="ltx_author_notes">
 J. Mills, J. Hu and G. Min are with the
Department of Computer Science, University of Exeter, EX4 4QF, United Kingdom.
E-mail: {jm729, j.hu, g.min}@exeter.ac.uk. Corresponding authors: Jia Hu, Geyong Min. This paper has been accepted by IEEE Transactions on Parallel and Distributed Systems.
Source code for reproducing experiments on GitHub: https://github.com/JedMills/MTFL-For-Personalised-DNNs.
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.2" class="ltx_p">Federated Learning (FL) is an emerging approach for collaboratively training Deep Neural Networks (DNNs) on mobile devices, without private user data leaving the devices. Previous works have shown that non-Independent and Identically Distributed (non-IID) user data harms the convergence speed of the FL algorithms. Furthermore, most existing work on FL measures global-model accuracy, but in many cases, such as user content-recommendation, improving individual User model Accuracy (UA) is the real objective. To address these issues, we propose a Multi-Task FL (MTFL) algorithm that introduces non-federated Batch-Normalization (BN) layers into the federated DNN. MTFL benefits UA and convergence speed by allowing users to train models personalised to their own data. MTFL is compatible with popular iterative FL optimisation algorithms such as Federated Averaging (FedAvg), and we show empirically that a distributed form of Adam optimisation (FedAvg-Adam) benefits convergence speed even further when used as the optimisation strategy within MTFL. Experiments using MNIST and CIFAR10 demonstrate that MTFL is able to significantly reduce the number of rounds required to reach a target UA, by up to <math id="id1.1.m1.1" class="ltx_math_unparsed" alttext="5\times" display="inline"><semantics id="id1.1.m1.1a"><mrow id="id1.1.m1.1b"><mn id="id1.1.m1.1.1">5</mn><mo lspace="0.222em" id="id1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="id1.1.m1.1c">5\times</annotation></semantics></math> when using existing FL optimisation strategies, and with a further <math id="id2.2.m2.1" class="ltx_math_unparsed" alttext="3\times" display="inline"><semantics id="id2.2.m2.1a"><mrow id="id2.2.m2.1b"><mn id="id2.2.m2.1.1">3</mn><mo lspace="0.222em" id="id2.2.m2.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="id2.2.m2.1c">3\times</annotation></semantics></math> improvement when using FedAvg-Adam. We compare MTFL to competing personalised FL algorithms, showing that it is able to achieve the best UA for MNIST and CIFAR10 in all considered scenarios. Finally, we evaluate MTFL with FedAvg-Adam on an edge-computing testbed, showing that its convergence and UA benefits outweigh its overhead.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated Learning, Multi-Task Learning, Deep Learning, Edge Computing, Adaptive Optimization.

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Multi-access Edge Computing (MEC) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> moves Cloud services to the network edge, enabling low-latency and real-time processing of applications via content caching and computation offloading <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Coupled with the rapidly increasing quantity of data collected by smartphones, Internet-of-Things (IoT) devices, and social networks (SNs), MEC presents an opportunity to store and process huge quantities of data at the edge, close to their source.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Deep Neural Networks (DNNs) for Machine Learning (ML) are becoming increasingly popular for their huge range of potential applications, ease of deployment, and state-of-the-art performance. Training DNNs in supervised learning, however, can be computationally expensive and require an enormous amount of training data, especially with the trend of increasing DNN size. The use of DNNs in MEC has typically involved collecting data from mobile phones/IoT devices/SNs, performing training in the cloud, and then deploying the model at the edge. Concerns about data privacy, however, mean that users are increasingly unwilling to upload their potentially sensitive data, raising the question about how these models will be trained.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> opens new horizons for ML at the edge. In FL, participating clients collaboratively train an ML model (typically DNNs), without revealing their private data. McMahan <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> published an initial investigation into FL with the <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">Federated Averaging</span> (FedAvg) algorithm. FedAvg works by initialising a model at a coordinating server before distributing this model to clients. These clients perform a round of training on their local datasets and push their new models to the server. The server averages these models together before sending the new aggregated model to the clients for the next round of training. <span id="S1.p3.1.3" class="ltx_text" style="color:#000000;">We refer to the people/institutions/etc. that own data for FL as ‘users’, and to the devices that actually participate in FL as ‘clients’.</span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">FL is a very promising approach for distributed ML in situations where data cannot be uploaded for protecting clients’ privacy. Therefore, FL is well suited for real-world scenarios such as analysing sensitive healthcare data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, next-word prediction on mobile keyboards <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, and content-recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. However, FL presents multiple unique challenges:</p>
</div>
<div id="S1.p5" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Clients usually do not have Independent and Identically Distributed (IID) training data. Each client has data generated by itself, and can have noisy data or only a subset of all features/labels. These factors can all substantially hinder training of the FL model.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text" style="color:#000000;">FL research typically uses the performance metric of global-model accuracy on a centralised test-set. However, in many cases, individual model accuracy on clients is the real objective - motivating ‘personalised FL’ that creates unique models for FL clients to improve local performance. However, the best way of incorporating personalisation into FL remains an under-researched topic.</span></p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Due to the non-IID nature of client datasets, the performance of the global FL model may be higher on some clients than others. This could even lead some clients to receive a worse model than the one they could have trained independently.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p"><span id="S1.p6.1.1" class="ltx_text" style="color:#000000;">This paper addresses the above challenges by proposing a Multi-Task FL algorithm (MTFL), that allows clients to train personalised DNNs that both improve local model accuracy, and help to further enhance client privacy. MTFL has lower storage cost of personalisation, and lower computing cost compared with other personalised FL algorithms (not requiring extra steps of SGD on clients during the training loop or at personalisation time) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. </span></p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">As client datasets in FL are usually non-IID, clients can be viewed as attempting to optimise their models during local training for disparate tasks. Our MTFL approach takes the Batch-Normalisation (BN) layers that are commonly incorporated into DNN architectures, and keeps them private to each client. Mudrarkarta <span id="S1.p7.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> previously showed that private BN layers improved Multi-Task Learning (MTL) performance for joint training on ImageNet/Places-365 in the centralised setting.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">Using private BN layers has the dual benefit of personalising each model to the clients’ local data as well as helping to preserve data privacy: as some parameters of client models are not uploaded to the server, less information about a client’s data distribution can be gleaned from the uploaded model. Our MTFL approach using BN layers also has a storage-cost benefit compared to other personalised FL algorithms: BN layers typically contain a tiny fraction of the total parameters of a DNN, and only these BN parameters need to be stored between FL rounds, compared to entire personalised DNN models of competing algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.</p>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">MTFL adds personalisation on top of the typical iterative FL framework. FedAvg and other popular algorithms are instances of this iterative optimisation framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Most of these FL algorithms use vanilla Stochastic Gradient Descent (SGD) on clients, however, momentum-based optimisation strategies such as Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> have the potential to improve convergence speed of FL training. We show that a distributed optimisation technique using Adam (FedAvg-Adam) shows substantial speedup in terms of communication rounds compared to FedAvg, and works very well within the MTFL algorithm.</p>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p">Our work makes the following contributions:</p>
</div>
<div id="S1.p11" class="ltx_para">
<ul id="S1.I2" class="ltx_itemize">
<li id="S1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i1.p1" class="ltx_para">
<p id="S1.I2.i1.p1.1" class="ltx_p">We propose an MTFL algorithm that adds Multi-Task learning on top of general iterative-FL algorithms, allowing users to learn DNN models that are personalised for their own data. MTFL uses private Batch Normalisation (BN) layers to achieve this personalisation, which provides an added privacy benefit.</p>
</div>
</li>
<li id="S1.I2.i2" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i2.p1" class="ltx_para">
<p id="S1.I2.i2.p1.1" class="ltx_p">We propose a new metric for measuring the performance of FL algorithms: User model Accuracy (UA). UA better reflects a common objective of FL (increasing test accuracy on clients), as opposed to the standard global-model accuracy.</p>
</div>
</li>
<li id="S1.I2.i3" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i3.p1" class="ltx_para">
<p id="S1.I2.i3.p1.1" class="ltx_p">We analyse the impact that private BN layers have on the activations of MTFL models during inference, providing insights into the source of their impact. We also analyse the training and testing performance of MTFL when keeping either the trained parameters or statistics of BN layers private, demonstrating that MTFL provides a better balance between convergence and regularisation compared to FL or independent training.</p>
</div>
</li>
<li id="S1.I2.i4" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i4.p1" class="ltx_para">
<p id="S1.I2.i4.p1.2" class="ltx_p">We conduct extensive simulations on the MNIST and CIFAR10 datasets. The results show that MTFL with FedAvg is able to reach a target UA in up to <math id="S1.I2.i4.p1.1.m1.1" class="ltx_math_unparsed" alttext="5\times" display="inline"><semantics id="S1.I2.i4.p1.1.m1.1a"><mrow id="S1.I2.i4.p1.1.m1.1b"><mn id="S1.I2.i4.p1.1.m1.1.1">5</mn><mo lspace="0.222em" id="S1.I2.i4.p1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S1.I2.i4.p1.1.m1.1c">5\times</annotation></semantics></math> less rounds than when using only FL, with FedAvg-Adam providing a further <math id="S1.I2.i4.p1.2.m2.1" class="ltx_math_unparsed" alttext="3\times" display="inline"><semantics id="S1.I2.i4.p1.2.m2.1a"><mrow id="S1.I2.i4.p1.2.m2.1b"><mn id="S1.I2.i4.p1.2.m2.1.1">3</mn><mo lspace="0.222em" id="S1.I2.i4.p1.2.m2.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S1.I2.i4.p1.2.m2.1c">3\times</annotation></semantics></math> improvement. Other experiments show that MTFL is able to significantly improve average UA compared to other state-of-the-art personalised FL algorithms.</p>
</div>
</li>
<li id="S1.I2.i5" class="ltx_item" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i5.p1" class="ltx_para">
<p id="S1.I2.i5.p1.1" class="ltx_p">We perform experiments using an MEC-like testbed consisting of Raspberry Pi clients and a FL server. The results show that MTFL with FedAvg-Adam’s overheads are outweighed by its substantial UA and convergence speed benefits.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p12" class="ltx_para">
<p id="S1.p12.1" class="ltx_p">The rest of this paper is organised as follows: Section 2 describes related work; Section 3 details the proposed MTFL algorithm, the effect that keeping private BN layers within MTFL has on training and inference, and the FedAvg-Adam optimisation strategy; Section 4 presents and discusses experiments using both simulations and an MEC-like testbed; and Section 5 concludes the paper.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2007.09236/assets/MTFL-system-diagram.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="263" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Operation of the MTFL algorithm in Edge Computing. Training is performed in rounds until a termination condition is met. <span id="S1.F1.9.1" class="ltx_text ltx_font_bold">Step 1</span>: the server selects a subset of clients from its database to participate in the round, and sends a work request to them. <span id="S1.F1.10.2" class="ltx_text ltx_font_bold">Step 2</span>: clients reply with an accept message depending on physical state and local preferences. <span id="S1.F1.11.3" class="ltx_text ltx_font_bold" style="color:#000000;">Step 3<span id="S1.F1.11.3.1" class="ltx_text ltx_font_medium">: clients download the global model (and any optimisation parameters) from the server, and update their copy of the global model with private patches (in this work, we use BN layers as patches).</span></span> <span id="S1.F1.12.4" class="ltx_text ltx_font_bold">Step 4</span>: clients perform local training, before saving their personal patches for the next round. <span id="S1.F1.13.5" class="ltx_text ltx_font_bold">Step 5</span>: the server waits for <math id="S1.F1.2.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S1.F1.2.m1.1b"><mi id="S1.F1.2.m1.1.1" xref="S1.F1.2.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S1.F1.2.m1.1c"><ci id="S1.F1.2.m1.1.1.cmml" xref="S1.F1.2.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.m1.1d">C</annotation></semantics></math> fraction of clients to upload their non-private model and optimiser values, or until a time limit. <span id="S1.F1.14.6" class="ltx_text ltx_font_bold">Step 6</span>: the server averages all models, saves the aggregate, and starts a new round.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">As this work addresses several challenges to existing FL algorithms, we overview the related work in three sub-topics of FL: works considering personalisation, works dealing with practical and deployment challenges, and works aiming to improve convergence speed and global-model performance.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span><span id="S2.SS1.1.1" class="ltx_text ltx_font_italic">Personalised Federated Learning</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p"><span id="S2.SS1.p1.1.1" class="ltx_text" style="color:#000000;">Several authors have considered the approach of ‘personalising’ FL models in order to tailor model performance to non-IID user datasets.</span></p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p"><span id="S2.SS1.p2.1.1" class="ltx_text" style="color:#000000;">Meta-Learning aims to train a model that is easy to fine-tune with few samples. Fallah <span id="S2.SS1.p2.1.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed the Per-FedAvg algorithm based on Model Agnostic Meta-Learning (MAML), that adds a first-order adaptation term to the client loss functions, so they can be tuned to client datasets with one step. Jiang <span id="S2.SS1.p2.1.1.2" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> highlighted the connection between FedAvg and first-order MAML updates, and proposed a three-stage training algorithm to improve personalisation. </span></p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p"><span id="S2.SS1.p3.1.1" class="ltx_text" style="color:#000000;">Other authors propose training a combination of local and global models in FL to improve personalisation. Hanzely and Richtárick <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> added a learnable parameter to allow clients to control the extent of local and global model mixing. Dinh <span id="S2.SS1.p3.1.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> kept a global model and a personal model for each user, performing SGD on their personal model and then updating their copy of the global model in an outer loop. Huang <span id="S2.SS1.p3.1.1.2" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> kept a local model on each client, and added a proximal term to client loss functions to keep these models close to a ‘personalised’ cloud model, for the cross-silo FL setting.</span></p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p"><span id="S2.SS1.p4.1.1" class="ltx_text" style="color:#000000;">Smith <span id="S2.SS1.p4.1.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> proposed MOCHA, which performs Federated MTL formulates FL as a function of the model weight matrix and a relationship matrix. Their algorithm takes into account the heterogeneous hardware of clients, meaning MOCHA is not directly comparable to our MTFL scheme. Recently, Dinh <span id="S2.SS1.p4.1.1.2" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> generalised MOCHA and other algorithms into the FedU framework, including proposing a decentralised version.</span></p>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.1" class="ltx_p"><span id="S2.SS1.p5.1.1" class="ltx_text" style="color:#000000;">Our work proposes a Multi-Task learning approach to achieve personalisation in FL (MTFL). We later show that our approach has substantial converge speed, personalisation performance, privacy and storage coast benefits compared to existing personalised FL algorithms. </span></p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span><span id="S2.SS2.1.1" class="ltx_text ltx_font_italic">Federated Learning in Edge Computing</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">FL performs distributed computing at the network edge. Some authors have considered the system design and communication costs of FL in this environment. Jiang <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> proposed an FL system that reduces the total data clients upload by selecting model weights with the largest gradient magnitudes. They also considered implementation details such as asynchronous or round-robin client updates. Bonawitz <span id="S2.SS2.p1.1.2" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> produced a FedAvg system design, specifying clients/server roles, fault handling, and security. They also provide analytics for their deployment of this system with over 10 million clients. To address the non-IID nature of client datasets in FL, Duan <span id="S2.SS2.p1.1.3" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> proposed the Astrea framework: client datasets are augmented to help reduce local class imbalances, and mediators are introduced to the global aggregation method.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Several authors have also investigated the impacts of wirelessly connected FL clients. Yang <span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> studied different scheduling policies in a wireless FL scenario. Their analysis showed that with a low Signal-to-Interference-plus-Noise Ratio (SINR), simple FL schemes perform well, but that as SINR increases, more intelligent methods of selecting clients are needed. Ahn <span id="S2.SS2.p2.1.2" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> proposed a Hybrid Federated Distillation scheme for FL with wireless edge devices, including using over-the-air computing and compression methods. Their results showed that their scheme gave better performance in high-noise wireless scenarios.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">Other authors have proposed schemes for considering the computing, networking and communication resources of FL clients in edge computing. Wang <span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> performed experiments with smartphones to argue that the computation-time (as opposed to communication-time) of FedAvg is the most significant bottleneck for real-world FL, and propose algorithms to accommodate this computational heterogeneity. Nishio and Yonetani <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> designed a system that collects information about the computing and wireless resources of clients before initiating a round of FL, reducing the real-time taken to reach a target accuracy for FedAvg.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.1" class="ltx_p">These previous works have proposed implementations of FL systems. However, they do not consider MTL within FL, which is a main contribution of our work with the MTFL algorithm.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span><span id="S2.SS3.1.1" class="ltx_text ltx_font_italic">Federated Learning Performance</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">The seminal FedAvg algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> collaboratively trains a model by sending an initial model to participating clients, who each perform SGD on the model using their local data. These new models are sent to the server for averaging and a new round is begun. Some progress has been made towards improving the convergence rate of FedAvg. Leroy <span id="S2.SS3.p1.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> used Adam adaptive optimisation when updating the global model on the server. Reddi <span id="S2.SS3.p1.1.2" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> also generalised other adaptive optimisation techniques in the same style and provided convergence guarantees. Our FedAvg-Adam algorithm differs from these as clients in FedAvg-Adam perform Adam SGD (as opposed to vanilla SGD), and the Adam parameters are averaged alongside model weights at the server. Liu <span id="S2.SS3.p1.1.3" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> used momentum-SGD on clients, and aggregated the momentum values of clients on the server alongside the model weights as an alternative method of accelerating convergence.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Some works have been produced investigating FL with non-IID or poor-quality client data. Zhao <span id="S2.SS3.p2.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> proposed sharing a small amount of data between clients to decrease the differences in their data distributions and improve global model accuracy. Konstantinov and Lampert <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> evaluated which clients have poor-quality data by finding the difference between a client model’s local predictions and predictions using a trusted dataset. Wang <span id="S2.SS3.p2.1.2" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> ignored <span id="S2.SS3.p2.1.3" class="ltx_text ltx_font_italic">irrelevant</span> client updates during training by checking if each client’s update aligns with the global model.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.1" class="ltx_p">The FedAvg-Adam optimisation method presented here uses adaptive optimisation on clients, rather than SGD, which we later show converges much faster than when using FedAvg or Adam optimisation purely on the server.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Multi-Task Federated Learning (MTFL)</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Fig. 1 shows a high-level overview of how the MTFL algorithm would operate in the edge-computing environment. More detailed descriptions of the use of BN patches in MTFL, and optimisation on clients is given in the later subsections.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">The MTFL algorithm is based on the client-server framework, however, rounds are initiated by the server, as shown in Fig 1. First, the server selects all, or a subset of all, known clients from its database and asks them to participate in the FL round (<span id="S3.p2.1.1" class="ltx_text ltx_font_bold">Step 1</span>), and sends a <span id="S3.p2.1.2" class="ltx_text ltx_font_italic">Work Request</span> message to them. Clients will accept a <span id="S3.p2.1.3" class="ltx_text ltx_font_italic">Work Request</span> depending on user preferences (for example, users can set their device to only participate in FL if charging and connected to WiFi). All accepting clients then send an <span id="S3.p2.1.4" class="ltx_text ltx_font_italic">Accept</span> message to the server (<span id="S3.p2.1.5" class="ltx_text ltx_font_bold">Step 2</span>). The server sends the global model (and any associated optimization parameters) to all accepting clients, who augment their copy of the global model with private patches (<span id="S3.p2.1.6" class="ltx_text ltx_font_bold">Step 3</span>). Clients then perform local training using their own data, creating a different model. Clients save the patch layers from their new model locally, and upload their non-private model parameters to the server (<span id="S3.p2.1.7" class="ltx_text ltx_font_bold">Step 4</span>).</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">The server waits for clients to finish training and upload their models (<span id="S3.p3.1.1" class="ltx_text ltx_font_bold">Step 5</span>). It can either wait for a maximum time limit, or for a given fraction of clients to upload before continuing, depending on the server preferences. After this, the server will aggregate all received models to produce a single global model (<span id="S3.p3.1.2" class="ltx_text ltx_font_bold">Step 6</span>) which is saved on the server, before starting a new round.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">MTFL therefore offloads the vast majority of computation to client devices, who perform the actual model training. It preserves users’ data-privacy more strongly than FedAvg and other personalised-FL algorithms: not only is user data not uploaded, but key parts of their local models are not uploaded. The framework also accounts for client stragglers with its round time/uploading client fraction limit. Moreover, MTFL utilises patch layers to improve <span id="S3.p4.1.1" class="ltx_text ltx_font_italic">local</span> model performance on individual users’ non-IID datasets, making MTFL more personalised.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span id="S3.SS1.1.1" class="ltx_text ltx_font_italic">User Model Accuracy and MTFL</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">In many FL works, such as the original FedAvg paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, the authors use a central IID test-set to measure FL performance. Depending on the FL scenario, this metric may or may not be desirable. If the intention is to create a single model that has good performance on IID data, then this method would be suitable. However, in many FL scenarios, the desire is to create a model that has good performance on individual user devices. For example, Google have used FedAvg for their GBoard next-word-prediction software <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. The objective was to improve the prediction score for individual users. As users do not typically have non-IID data, a single global model may display good performance for some users, and worse performance for others.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2007.09236/assets/patch-layer-diagram.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="509" height="452" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Example composition of a DNN model used in MTFL. Each client’s model consists of shared global parameters (<math id="S3.F2.3.m1.1" class="ltx_Math" alttext="\Omega_{1}-\Omega_{4}" display="inline"><semantics id="S3.F2.3.m1.1b"><mrow id="S3.F2.3.m1.1.1" xref="S3.F2.3.m1.1.1.cmml"><msub id="S3.F2.3.m1.1.1.2" xref="S3.F2.3.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.F2.3.m1.1.1.2.2" xref="S3.F2.3.m1.1.1.2.2.cmml">Ω</mi><mn id="S3.F2.3.m1.1.1.2.3" xref="S3.F2.3.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.F2.3.m1.1.1.1" xref="S3.F2.3.m1.1.1.1.cmml">−</mo><msub id="S3.F2.3.m1.1.1.3" xref="S3.F2.3.m1.1.1.3.cmml"><mi mathvariant="normal" id="S3.F2.3.m1.1.1.3.2" xref="S3.F2.3.m1.1.1.3.2.cmml">Ω</mi><mn id="S3.F2.3.m1.1.1.3.3" xref="S3.F2.3.m1.1.1.3.3.cmml">4</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.3.m1.1c"><apply id="S3.F2.3.m1.1.1.cmml" xref="S3.F2.3.m1.1.1"><minus id="S3.F2.3.m1.1.1.1.cmml" xref="S3.F2.3.m1.1.1.1"></minus><apply id="S3.F2.3.m1.1.1.2.cmml" xref="S3.F2.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.3.m1.1.1.2.1.cmml" xref="S3.F2.3.m1.1.1.2">subscript</csymbol><ci id="S3.F2.3.m1.1.1.2.2.cmml" xref="S3.F2.3.m1.1.1.2.2">Ω</ci><cn type="integer" id="S3.F2.3.m1.1.1.2.3.cmml" xref="S3.F2.3.m1.1.1.2.3">1</cn></apply><apply id="S3.F2.3.m1.1.1.3.cmml" xref="S3.F2.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.3.m1.1.1.3.1.cmml" xref="S3.F2.3.m1.1.1.3">subscript</csymbol><ci id="S3.F2.3.m1.1.1.3.2.cmml" xref="S3.F2.3.m1.1.1.3.2">Ω</ci><cn type="integer" id="S3.F2.3.m1.1.1.3.3.cmml" xref="S3.F2.3.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.m1.1d">\Omega_{1}-\Omega_{4}</annotation></semantics></math>) for Convolutional (Conv) and Fully-Connected (FC) layers, and private Batch-Normalization (BN) patch layers (<math id="S3.F2.4.m2.3" class="ltx_Math" alttext="P_{k_{1}},P_{k_{2}},P_{k_{3}}" display="inline"><semantics id="S3.F2.4.m2.3b"><mrow id="S3.F2.4.m2.3.3.3" xref="S3.F2.4.m2.3.3.4.cmml"><msub id="S3.F2.4.m2.1.1.1.1" xref="S3.F2.4.m2.1.1.1.1.cmml"><mi id="S3.F2.4.m2.1.1.1.1.2" xref="S3.F2.4.m2.1.1.1.1.2.cmml">P</mi><msub id="S3.F2.4.m2.1.1.1.1.3" xref="S3.F2.4.m2.1.1.1.1.3.cmml"><mi id="S3.F2.4.m2.1.1.1.1.3.2" xref="S3.F2.4.m2.1.1.1.1.3.2.cmml">k</mi><mn id="S3.F2.4.m2.1.1.1.1.3.3" xref="S3.F2.4.m2.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.F2.4.m2.3.3.3.4" xref="S3.F2.4.m2.3.3.4.cmml">,</mo><msub id="S3.F2.4.m2.2.2.2.2" xref="S3.F2.4.m2.2.2.2.2.cmml"><mi id="S3.F2.4.m2.2.2.2.2.2" xref="S3.F2.4.m2.2.2.2.2.2.cmml">P</mi><msub id="S3.F2.4.m2.2.2.2.2.3" xref="S3.F2.4.m2.2.2.2.2.3.cmml"><mi id="S3.F2.4.m2.2.2.2.2.3.2" xref="S3.F2.4.m2.2.2.2.2.3.2.cmml">k</mi><mn id="S3.F2.4.m2.2.2.2.2.3.3" xref="S3.F2.4.m2.2.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.F2.4.m2.3.3.3.5" xref="S3.F2.4.m2.3.3.4.cmml">,</mo><msub id="S3.F2.4.m2.3.3.3.3" xref="S3.F2.4.m2.3.3.3.3.cmml"><mi id="S3.F2.4.m2.3.3.3.3.2" xref="S3.F2.4.m2.3.3.3.3.2.cmml">P</mi><msub id="S3.F2.4.m2.3.3.3.3.3" xref="S3.F2.4.m2.3.3.3.3.3.cmml"><mi id="S3.F2.4.m2.3.3.3.3.3.2" xref="S3.F2.4.m2.3.3.3.3.3.2.cmml">k</mi><mn id="S3.F2.4.m2.3.3.3.3.3.3" xref="S3.F2.4.m2.3.3.3.3.3.3.cmml">3</mn></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.4.m2.3c"><list id="S3.F2.4.m2.3.3.4.cmml" xref="S3.F2.4.m2.3.3.3"><apply id="S3.F2.4.m2.1.1.1.1.cmml" xref="S3.F2.4.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.4.m2.1.1.1.1.1.cmml" xref="S3.F2.4.m2.1.1.1.1">subscript</csymbol><ci id="S3.F2.4.m2.1.1.1.1.2.cmml" xref="S3.F2.4.m2.1.1.1.1.2">𝑃</ci><apply id="S3.F2.4.m2.1.1.1.1.3.cmml" xref="S3.F2.4.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.4.m2.1.1.1.1.3.1.cmml" xref="S3.F2.4.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.F2.4.m2.1.1.1.1.3.2.cmml" xref="S3.F2.4.m2.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.F2.4.m2.1.1.1.1.3.3.cmml" xref="S3.F2.4.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.F2.4.m2.2.2.2.2.cmml" xref="S3.F2.4.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.F2.4.m2.2.2.2.2.1.cmml" xref="S3.F2.4.m2.2.2.2.2">subscript</csymbol><ci id="S3.F2.4.m2.2.2.2.2.2.cmml" xref="S3.F2.4.m2.2.2.2.2.2">𝑃</ci><apply id="S3.F2.4.m2.2.2.2.2.3.cmml" xref="S3.F2.4.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.F2.4.m2.2.2.2.2.3.1.cmml" xref="S3.F2.4.m2.2.2.2.2.3">subscript</csymbol><ci id="S3.F2.4.m2.2.2.2.2.3.2.cmml" xref="S3.F2.4.m2.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.F2.4.m2.2.2.2.2.3.3.cmml" xref="S3.F2.4.m2.2.2.2.2.3.3">2</cn></apply></apply><apply id="S3.F2.4.m2.3.3.3.3.cmml" xref="S3.F2.4.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.F2.4.m2.3.3.3.3.1.cmml" xref="S3.F2.4.m2.3.3.3.3">subscript</csymbol><ci id="S3.F2.4.m2.3.3.3.3.2.cmml" xref="S3.F2.4.m2.3.3.3.3.2">𝑃</ci><apply id="S3.F2.4.m2.3.3.3.3.3.cmml" xref="S3.F2.4.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.F2.4.m2.3.3.3.3.3.1.cmml" xref="S3.F2.4.m2.3.3.3.3.3">subscript</csymbol><ci id="S3.F2.4.m2.3.3.3.3.3.2.cmml" xref="S3.F2.4.m2.3.3.3.3.3.2">𝑘</ci><cn type="integer" id="S3.F2.4.m2.3.3.3.3.3.3.cmml" xref="S3.F2.4.m2.3.3.3.3.3.3">3</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.m2.3d">P_{k_{1}},P_{k_{2}},P_{k_{3}}</annotation></semantics></math>).</figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">We propose using the average User model Accuracy (UA) as an alternative metric of FL performance. UA is the accuracy on a client using a local test-set. This test-set for each client should be drawn from a similar distribution as its training data. In this paper, we perform experiments on classification problems, but UA could be altered for different metrics (e.g. error, recall).</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">In FL, user data is often non-IID, so users could be considered as having different but related learning tasks. It is possible for an FL scheme to achieve good global-model accuracy, but poor UA, as the aggregate model may perform poorly on some clients’ datasets (especially if they have a small number of local samples, so are weighted less in the FedAvg averaging step). We propose the MTFL algorithm that allows clients to build different models, while still benefiting from FL, in order to improve the average UA. Mudrakarta <span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> have previously shown that adding small per-task ‘patch’ layers to DNNs improved their performance in MTL scenarios. Patches are therefore a good candidate for training personalised models for clients.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">In FL, the aim is to minimise the following objective function:</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="F_{\mathrm{FL}}=\sum_{k=1}^{K}\frac{n_{k}}{n}\ell_{k}(\Omega)\\
" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.2" xref="S3.E1.m1.1.2.cmml"><msub id="S3.E1.m1.1.2.2" xref="S3.E1.m1.1.2.2.cmml"><mi id="S3.E1.m1.1.2.2.2" xref="S3.E1.m1.1.2.2.2.cmml">F</mi><mi id="S3.E1.m1.1.2.2.3" xref="S3.E1.m1.1.2.2.3.cmml">FL</mi></msub><mo rspace="0.111em" id="S3.E1.m1.1.2.1" xref="S3.E1.m1.1.2.1.cmml">=</mo><mrow id="S3.E1.m1.1.2.3" xref="S3.E1.m1.1.2.3.cmml"><munderover id="S3.E1.m1.1.2.3.1" xref="S3.E1.m1.1.2.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.1.2.3.1.2.2" xref="S3.E1.m1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.2.3.1.2.3" xref="S3.E1.m1.1.2.3.1.2.3.cmml"><mi id="S3.E1.m1.1.2.3.1.2.3.2" xref="S3.E1.m1.1.2.3.1.2.3.2.cmml">k</mi><mo id="S3.E1.m1.1.2.3.1.2.3.1" xref="S3.E1.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.2.3.1.2.3.3" xref="S3.E1.m1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.2.3.1.3" xref="S3.E1.m1.1.2.3.1.3.cmml">K</mi></munderover><mrow id="S3.E1.m1.1.2.3.2" xref="S3.E1.m1.1.2.3.2.cmml"><mfrac id="S3.E1.m1.1.2.3.2.2" xref="S3.E1.m1.1.2.3.2.2.cmml"><msub id="S3.E1.m1.1.2.3.2.2.2" xref="S3.E1.m1.1.2.3.2.2.2.cmml"><mi id="S3.E1.m1.1.2.3.2.2.2.2" xref="S3.E1.m1.1.2.3.2.2.2.2.cmml">n</mi><mi id="S3.E1.m1.1.2.3.2.2.2.3" xref="S3.E1.m1.1.2.3.2.2.2.3.cmml">k</mi></msub><mi id="S3.E1.m1.1.2.3.2.2.3" xref="S3.E1.m1.1.2.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.2.3.2.1" xref="S3.E1.m1.1.2.3.2.1.cmml">​</mo><msub id="S3.E1.m1.1.2.3.2.3" xref="S3.E1.m1.1.2.3.2.3.cmml"><mi mathvariant="normal" id="S3.E1.m1.1.2.3.2.3.2" xref="S3.E1.m1.1.2.3.2.3.2.cmml">ℓ</mi><mi id="S3.E1.m1.1.2.3.2.3.3" xref="S3.E1.m1.1.2.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.2.3.2.1a" xref="S3.E1.m1.1.2.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.1.2.3.2.4.2" xref="S3.E1.m1.1.2.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.2.3.2.4.2.1" xref="S3.E1.m1.1.2.3.2.cmml">(</mo><mi mathvariant="normal" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">Ω</mi><mo stretchy="false" id="S3.E1.m1.1.2.3.2.4.2.2" xref="S3.E1.m1.1.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.2.cmml" xref="S3.E1.m1.1.2"><eq id="S3.E1.m1.1.2.1.cmml" xref="S3.E1.m1.1.2.1"></eq><apply id="S3.E1.m1.1.2.2.cmml" xref="S3.E1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.2.1.cmml" xref="S3.E1.m1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.1.2.2.2.cmml" xref="S3.E1.m1.1.2.2.2">𝐹</ci><ci id="S3.E1.m1.1.2.2.3.cmml" xref="S3.E1.m1.1.2.2.3">FL</ci></apply><apply id="S3.E1.m1.1.2.3.cmml" xref="S3.E1.m1.1.2.3"><apply id="S3.E1.m1.1.2.3.1.cmml" xref="S3.E1.m1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.3.1.1.cmml" xref="S3.E1.m1.1.2.3.1">superscript</csymbol><apply id="S3.E1.m1.1.2.3.1.2.cmml" xref="S3.E1.m1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.3.1.2.1.cmml" xref="S3.E1.m1.1.2.3.1">subscript</csymbol><sum id="S3.E1.m1.1.2.3.1.2.2.cmml" xref="S3.E1.m1.1.2.3.1.2.2"></sum><apply id="S3.E1.m1.1.2.3.1.2.3.cmml" xref="S3.E1.m1.1.2.3.1.2.3"><eq id="S3.E1.m1.1.2.3.1.2.3.1.cmml" xref="S3.E1.m1.1.2.3.1.2.3.1"></eq><ci id="S3.E1.m1.1.2.3.1.2.3.2.cmml" xref="S3.E1.m1.1.2.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.1.2.3.1.2.3.3.cmml" xref="S3.E1.m1.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.2.3.1.3.cmml" xref="S3.E1.m1.1.2.3.1.3">𝐾</ci></apply><apply id="S3.E1.m1.1.2.3.2.cmml" xref="S3.E1.m1.1.2.3.2"><times id="S3.E1.m1.1.2.3.2.1.cmml" xref="S3.E1.m1.1.2.3.2.1"></times><apply id="S3.E1.m1.1.2.3.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2"><divide id="S3.E1.m1.1.2.3.2.2.1.cmml" xref="S3.E1.m1.1.2.3.2.2"></divide><apply id="S3.E1.m1.1.2.3.2.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.3.2.2.2.1.cmml" xref="S3.E1.m1.1.2.3.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.2.3.2.2.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2.2.2">𝑛</ci><ci id="S3.E1.m1.1.2.3.2.2.2.3.cmml" xref="S3.E1.m1.1.2.3.2.2.2.3">𝑘</ci></apply><ci id="S3.E1.m1.1.2.3.2.2.3.cmml" xref="S3.E1.m1.1.2.3.2.2.3">𝑛</ci></apply><apply id="S3.E1.m1.1.2.3.2.3.cmml" xref="S3.E1.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.3.2.3.1.cmml" xref="S3.E1.m1.1.2.3.2.3">subscript</csymbol><ci id="S3.E1.m1.1.2.3.2.3.2.cmml" xref="S3.E1.m1.1.2.3.2.3.2">ℓ</ci><ci id="S3.E1.m1.1.2.3.2.3.3.cmml" xref="S3.E1.m1.1.2.3.2.3.3">𝑘</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">Ω</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">F_{\mathrm{FL}}=\sum_{k=1}^{K}\frac{n_{k}}{n}\ell_{k}(\Omega)\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p6" class="ltx_para ltx_noindent">
<p id="S3.SS1.p6.7" class="ltx_p">where <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mi id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">K</annotation></semantics></math> is the total number of clients, <math id="S3.SS1.p6.2.m2.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.SS1.p6.2.m2.1a"><msub id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml"><mi id="S3.SS1.p6.2.m2.1.1.2" xref="S3.SS1.p6.2.m2.1.1.2.cmml">n</mi><mi id="S3.SS1.p6.2.m2.1.1.3" xref="S3.SS1.p6.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><apply id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p6.2.m2.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.2">𝑛</ci><ci id="S3.SS1.p6.2.m2.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">n_{k}</annotation></semantics></math> is the number of samples on client <math id="S3.SS1.p6.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p6.3.m3.1a"><mi id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><ci id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">k</annotation></semantics></math>, <math id="S3.SS1.p6.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p6.4.m4.1a"><mi id="S3.SS1.p6.4.m4.1.1" xref="S3.SS1.p6.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><ci id="S3.SS1.p6.4.m4.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">n</annotation></semantics></math> is the total number of samples across all clients, <math id="S3.SS1.p6.5.m5.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S3.SS1.p6.5.m5.1a"><msub id="S3.SS1.p6.5.m5.1.1" xref="S3.SS1.p6.5.m5.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p6.5.m5.1.1.2" xref="S3.SS1.p6.5.m5.1.1.2.cmml">ℓ</mi><mi id="S3.SS1.p6.5.m5.1.1.3" xref="S3.SS1.p6.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.5.m5.1b"><apply id="S3.SS1.p6.5.m5.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.1.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p6.5.m5.1.1.2.cmml" xref="S3.SS1.p6.5.m5.1.1.2">ℓ</ci><ci id="S3.SS1.p6.5.m5.1.1.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.5.m5.1c">\ell_{k}</annotation></semantics></math> is the loss function on client <math id="S3.SS1.p6.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p6.6.m6.1a"><mi id="S3.SS1.p6.6.m6.1.1" xref="S3.SS1.p6.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.6.m6.1b"><ci id="S3.SS1.p6.6.m6.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.6.m6.1c">k</annotation></semantics></math>, and <math id="S3.SS1.p6.7.m7.1" class="ltx_Math" alttext="\Omega" display="inline"><semantics id="S3.SS1.p6.7.m7.1a"><mi mathvariant="normal" id="S3.SS1.p6.7.m7.1.1" xref="S3.SS1.p6.7.m7.1.1.cmml">Ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.7.m7.1b"><ci id="S3.SS1.p6.7.m7.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1">Ω</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.7.m7.1c">\Omega</annotation></semantics></math> is the set of global model parameters. Adding unique client patches to the FL model changes the objective function of MTFL to:</p>
</div>
<div id="S3.SS1.p7" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="F_{\mathrm{MTFL}}=\sum_{k=1}^{K}\frac{n_{k}}{n}\ \ell_{k}(\mathcal{M}_{k})\\
" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><msub id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml">F</mi><mi id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml">MTFL</mi></msub><mo rspace="0.111em" id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><munderover id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.2.2.3.2" xref="S3.E2.m1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.1.1.1.2.2.3.1" xref="S3.E2.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.1.2.2.3.3" xref="S3.E2.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mfrac id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.3.2.2.cmml">n</mi><mi id="S3.E2.m1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml">k</mi></msub><mi id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo lspace="0.500em" rspace="0em" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.1.4.2.cmml">ℓ</mi><mi id="S3.E2.m1.1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2a" xref="S3.E2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml">ℳ</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"></eq><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2">𝐹</ci><ci id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3">MTFL</ci></apply><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.2.2.3"><eq id="S3.E2.m1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.2.3">𝐾</ci></apply><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><divide id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3"></divide><apply id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2">𝑛</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.1.4.2">ℓ</ci><ci id="S3.E2.m1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3">𝑘</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2">ℳ</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">F_{\mathrm{MTFL}}=\sum_{k=1}^{K}\frac{n_{k}}{n}\ \ell_{k}(\mathcal{M}_{k})\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="\mathcal{M}_{k}=(\Omega_{1}\cdots\Omega_{i_{1}},P_{k_{1}},\Omega_{i_{1}+1}\cdots\Omega_{i_{m}},P_{k_{m}},\Omega_{i_{m}+1}\cdots\Omega_{j})" display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><msub id="S3.E3.m1.5.5.7" xref="S3.E3.m1.5.5.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.7.2" xref="S3.E3.m1.5.5.7.2.cmml">ℳ</mi><mi id="S3.E3.m1.5.5.7.3" xref="S3.E3.m1.5.5.7.3.cmml">k</mi></msub><mo id="S3.E3.m1.5.5.6" xref="S3.E3.m1.5.5.6.cmml">=</mo><mrow id="S3.E3.m1.5.5.5.5" xref="S3.E3.m1.5.5.5.6.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.5.5.6" xref="S3.E3.m1.5.5.5.6.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.2.2.cmml">Ω</mi><mn id="S3.E3.m1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1a" xref="S3.E3.m1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.E3.m1.1.1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.1.1.4.2.cmml">Ω</mi><msub id="S3.E3.m1.1.1.1.1.1.4.3" xref="S3.E3.m1.1.1.1.1.1.4.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.4.3.2" xref="S3.E3.m1.1.1.1.1.1.4.3.2.cmml">i</mi><mn id="S3.E3.m1.1.1.1.1.1.4.3.3" xref="S3.E3.m1.1.1.1.1.1.4.3.3.cmml">1</mn></msub></msub></mrow><mo id="S3.E3.m1.5.5.5.5.7" xref="S3.E3.m1.5.5.5.6.cmml">,</mo><msub id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml">P</mi><msub id="S3.E3.m1.2.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.2.2.2.3.2" xref="S3.E3.m1.2.2.2.2.2.3.2.cmml">k</mi><mn id="S3.E3.m1.2.2.2.2.2.3.3" xref="S3.E3.m1.2.2.2.2.2.3.3.cmml">1</mn></msub></msub><mo id="S3.E3.m1.5.5.5.5.8" xref="S3.E3.m1.5.5.5.6.cmml">,</mo><mrow id="S3.E3.m1.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.cmml"><msub id="S3.E3.m1.3.3.3.3.3.2" xref="S3.E3.m1.3.3.3.3.3.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.3.3.3.3.3.2.2" xref="S3.E3.m1.3.3.3.3.3.2.2.cmml">Ω</mi><mrow id="S3.E3.m1.3.3.3.3.3.2.3" xref="S3.E3.m1.3.3.3.3.3.2.3.cmml"><msub id="S3.E3.m1.3.3.3.3.3.2.3.2" xref="S3.E3.m1.3.3.3.3.3.2.3.2.cmml"><mi id="S3.E3.m1.3.3.3.3.3.2.3.2.2" xref="S3.E3.m1.3.3.3.3.3.2.3.2.2.cmml">i</mi><mn id="S3.E3.m1.3.3.3.3.3.2.3.2.3" xref="S3.E3.m1.3.3.3.3.3.2.3.2.3.cmml">1</mn></msub><mo id="S3.E3.m1.3.3.3.3.3.2.3.1" xref="S3.E3.m1.3.3.3.3.3.2.3.1.cmml">+</mo><mn id="S3.E3.m1.3.3.3.3.3.2.3.3" xref="S3.E3.m1.3.3.3.3.3.2.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.3.3.1" xref="S3.E3.m1.3.3.3.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.3.3.1a" xref="S3.E3.m1.3.3.3.3.3.1.cmml">​</mo><msub id="S3.E3.m1.3.3.3.3.3.4" xref="S3.E3.m1.3.3.3.3.3.4.cmml"><mi mathvariant="normal" id="S3.E3.m1.3.3.3.3.3.4.2" xref="S3.E3.m1.3.3.3.3.3.4.2.cmml">Ω</mi><msub id="S3.E3.m1.3.3.3.3.3.4.3" xref="S3.E3.m1.3.3.3.3.3.4.3.cmml"><mi id="S3.E3.m1.3.3.3.3.3.4.3.2" xref="S3.E3.m1.3.3.3.3.3.4.3.2.cmml">i</mi><mi id="S3.E3.m1.3.3.3.3.3.4.3.3" xref="S3.E3.m1.3.3.3.3.3.4.3.3.cmml">m</mi></msub></msub></mrow><mo id="S3.E3.m1.5.5.5.5.9" xref="S3.E3.m1.5.5.5.6.cmml">,</mo><msub id="S3.E3.m1.4.4.4.4.4" xref="S3.E3.m1.4.4.4.4.4.cmml"><mi id="S3.E3.m1.4.4.4.4.4.2" xref="S3.E3.m1.4.4.4.4.4.2.cmml">P</mi><msub id="S3.E3.m1.4.4.4.4.4.3" xref="S3.E3.m1.4.4.4.4.4.3.cmml"><mi id="S3.E3.m1.4.4.4.4.4.3.2" xref="S3.E3.m1.4.4.4.4.4.3.2.cmml">k</mi><mi id="S3.E3.m1.4.4.4.4.4.3.3" xref="S3.E3.m1.4.4.4.4.4.3.3.cmml">m</mi></msub></msub><mo id="S3.E3.m1.5.5.5.5.10" xref="S3.E3.m1.5.5.5.6.cmml">,</mo><mrow id="S3.E3.m1.5.5.5.5.5" xref="S3.E3.m1.5.5.5.5.5.cmml"><msub id="S3.E3.m1.5.5.5.5.5.2" xref="S3.E3.m1.5.5.5.5.5.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.5.5.5.5.5.2.2" xref="S3.E3.m1.5.5.5.5.5.2.2.cmml">Ω</mi><mrow id="S3.E3.m1.5.5.5.5.5.2.3" xref="S3.E3.m1.5.5.5.5.5.2.3.cmml"><msub id="S3.E3.m1.5.5.5.5.5.2.3.2" xref="S3.E3.m1.5.5.5.5.5.2.3.2.cmml"><mi id="S3.E3.m1.5.5.5.5.5.2.3.2.2" xref="S3.E3.m1.5.5.5.5.5.2.3.2.2.cmml">i</mi><mi id="S3.E3.m1.5.5.5.5.5.2.3.2.3" xref="S3.E3.m1.5.5.5.5.5.2.3.2.3.cmml">m</mi></msub><mo id="S3.E3.m1.5.5.5.5.5.2.3.1" xref="S3.E3.m1.5.5.5.5.5.2.3.1.cmml">+</mo><mn id="S3.E3.m1.5.5.5.5.5.2.3.3" xref="S3.E3.m1.5.5.5.5.5.2.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.5.5.5.1" xref="S3.E3.m1.5.5.5.5.5.1.cmml">​</mo><mi mathvariant="normal" id="S3.E3.m1.5.5.5.5.5.3" xref="S3.E3.m1.5.5.5.5.5.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.5.5.5.1a" xref="S3.E3.m1.5.5.5.5.5.1.cmml">​</mo><msub id="S3.E3.m1.5.5.5.5.5.4" xref="S3.E3.m1.5.5.5.5.5.4.cmml"><mi mathvariant="normal" id="S3.E3.m1.5.5.5.5.5.4.2" xref="S3.E3.m1.5.5.5.5.5.4.2.cmml">Ω</mi><mi id="S3.E3.m1.5.5.5.5.5.4.3" xref="S3.E3.m1.5.5.5.5.5.4.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.5.5.5.5.11" xref="S3.E3.m1.5.5.5.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.6.cmml" xref="S3.E3.m1.5.5.6"></eq><apply id="S3.E3.m1.5.5.7.cmml" xref="S3.E3.m1.5.5.7"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.7.1.cmml" xref="S3.E3.m1.5.5.7">subscript</csymbol><ci id="S3.E3.m1.5.5.7.2.cmml" xref="S3.E3.m1.5.5.7.2">ℳ</ci><ci id="S3.E3.m1.5.5.7.3.cmml" xref="S3.E3.m1.5.5.7.3">𝑘</ci></apply><vector id="S3.E3.m1.5.5.5.6.cmml" xref="S3.E3.m1.5.5.5.5"><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.2">Ω</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">⋯</ci><apply id="S3.E3.m1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.4.2">Ω</ci><apply id="S3.E3.m1.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.4.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.4.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.4.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.4.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.4.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2">𝑃</ci><apply id="S3.E3.m1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3"><times id="S3.E3.m1.3.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.1"></times><apply id="S3.E3.m1.3.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.2.1.cmml" xref="S3.E3.m1.3.3.3.3.3.2">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.2.2.cmml" xref="S3.E3.m1.3.3.3.3.3.2.2">Ω</ci><apply id="S3.E3.m1.3.3.3.3.3.2.3.cmml" xref="S3.E3.m1.3.3.3.3.3.2.3"><plus id="S3.E3.m1.3.3.3.3.3.2.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.2.3.1"></plus><apply id="S3.E3.m1.3.3.3.3.3.2.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.2.3.2.1.cmml" xref="S3.E3.m1.3.3.3.3.3.2.3.2">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.2.3.2.2.cmml" xref="S3.E3.m1.3.3.3.3.3.2.3.2.2">𝑖</ci><cn type="integer" id="S3.E3.m1.3.3.3.3.3.2.3.2.3.cmml" xref="S3.E3.m1.3.3.3.3.3.2.3.2.3">1</cn></apply><cn type="integer" id="S3.E3.m1.3.3.3.3.3.2.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3">⋯</ci><apply id="S3.E3.m1.3.3.3.3.3.4.cmml" xref="S3.E3.m1.3.3.3.3.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.4.1.cmml" xref="S3.E3.m1.3.3.3.3.3.4">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.4.2.cmml" xref="S3.E3.m1.3.3.3.3.3.4.2">Ω</ci><apply id="S3.E3.m1.3.3.3.3.3.4.3.cmml" xref="S3.E3.m1.3.3.3.3.3.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.4.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.4.3">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.4.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.4.3.2">𝑖</ci><ci id="S3.E3.m1.3.3.3.3.3.4.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.4.3.3">𝑚</ci></apply></apply></apply><apply id="S3.E3.m1.4.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.4.4.1.cmml" xref="S3.E3.m1.4.4.4.4.4">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.4.2.cmml" xref="S3.E3.m1.4.4.4.4.4.2">𝑃</ci><apply id="S3.E3.m1.4.4.4.4.4.3.cmml" xref="S3.E3.m1.4.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.4.4.3.1.cmml" xref="S3.E3.m1.4.4.4.4.4.3">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.4.3.2.cmml" xref="S3.E3.m1.4.4.4.4.4.3.2">𝑘</ci><ci id="S3.E3.m1.4.4.4.4.4.3.3.cmml" xref="S3.E3.m1.4.4.4.4.4.3.3">𝑚</ci></apply></apply><apply id="S3.E3.m1.5.5.5.5.5.cmml" xref="S3.E3.m1.5.5.5.5.5"><times id="S3.E3.m1.5.5.5.5.5.1.cmml" xref="S3.E3.m1.5.5.5.5.5.1"></times><apply id="S3.E3.m1.5.5.5.5.5.2.cmml" xref="S3.E3.m1.5.5.5.5.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.5.5.5.2.1.cmml" xref="S3.E3.m1.5.5.5.5.5.2">subscript</csymbol><ci id="S3.E3.m1.5.5.5.5.5.2.2.cmml" xref="S3.E3.m1.5.5.5.5.5.2.2">Ω</ci><apply id="S3.E3.m1.5.5.5.5.5.2.3.cmml" xref="S3.E3.m1.5.5.5.5.5.2.3"><plus id="S3.E3.m1.5.5.5.5.5.2.3.1.cmml" xref="S3.E3.m1.5.5.5.5.5.2.3.1"></plus><apply id="S3.E3.m1.5.5.5.5.5.2.3.2.cmml" xref="S3.E3.m1.5.5.5.5.5.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.5.5.5.2.3.2.1.cmml" xref="S3.E3.m1.5.5.5.5.5.2.3.2">subscript</csymbol><ci id="S3.E3.m1.5.5.5.5.5.2.3.2.2.cmml" xref="S3.E3.m1.5.5.5.5.5.2.3.2.2">𝑖</ci><ci id="S3.E3.m1.5.5.5.5.5.2.3.2.3.cmml" xref="S3.E3.m1.5.5.5.5.5.2.3.2.3">𝑚</ci></apply><cn type="integer" id="S3.E3.m1.5.5.5.5.5.2.3.3.cmml" xref="S3.E3.m1.5.5.5.5.5.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.5.5.5.5.5.3.cmml" xref="S3.E3.m1.5.5.5.5.5.3">⋯</ci><apply id="S3.E3.m1.5.5.5.5.5.4.cmml" xref="S3.E3.m1.5.5.5.5.5.4"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.5.5.5.4.1.cmml" xref="S3.E3.m1.5.5.5.5.5.4">subscript</csymbol><ci id="S3.E3.m1.5.5.5.5.5.4.2.cmml" xref="S3.E3.m1.5.5.5.5.5.4.2">Ω</ci><ci id="S3.E3.m1.5.5.5.5.5.4.3.cmml" xref="S3.E3.m1.5.5.5.5.5.4.3">𝑗</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\mathcal{M}_{k}=(\Omega_{1}\cdots\Omega_{i_{1}},P_{k_{1}},\Omega_{i_{1}+1}\cdots\Omega_{i_{m}},P_{k_{m}},\Omega_{i_{m}+1}\cdots\Omega_{j})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p8" class="ltx_para ltx_noindent">
<p id="S3.SS1.p8.8" class="ltx_p"><span id="S3.SS1.p8.8.8" class="ltx_text" style="color:#000000;">where <math id="S3.SS1.p8.1.1.m1.1" class="ltx_Math" alttext="\mathcal{M}_{k}" display="inline"><semantics id="S3.SS1.p8.1.1.m1.1a"><msub id="S3.SS1.p8.1.1.m1.1.1" xref="S3.SS1.p8.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS1.p8.1.1.m1.1.1.2" xref="S3.SS1.p8.1.1.m1.1.1.2.cmml">ℳ</mi><mi mathcolor="#000000" id="S3.SS1.p8.1.1.m1.1.1.3" xref="S3.SS1.p8.1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.1.1.m1.1b"><apply id="S3.SS1.p8.1.1.m1.1.1.cmml" xref="S3.SS1.p8.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p8.1.1.m1.1.1.1.cmml" xref="S3.SS1.p8.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p8.1.1.m1.1.1.2.cmml" xref="S3.SS1.p8.1.1.m1.1.1.2">ℳ</ci><ci id="S3.SS1.p8.1.1.m1.1.1.3.cmml" xref="S3.SS1.p8.1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.1.1.m1.1c">\mathcal{M}_{k}</annotation></semantics></math> is the patched model on client <math id="S3.SS1.p8.2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p8.2.2.m2.1a"><mi mathcolor="#000000" id="S3.SS1.p8.2.2.m2.1.1" xref="S3.SS1.p8.2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.2.2.m2.1b"><ci id="S3.SS1.p8.2.2.m2.1.1.cmml" xref="S3.SS1.p8.2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.2.2.m2.1c">k</annotation></semantics></math>, composed of Federated model parameters <math id="S3.SS1.p8.3.3.m3.1" class="ltx_Math" alttext="\Omega_{1}\cdots\Omega_{j}" display="inline"><semantics id="S3.SS1.p8.3.3.m3.1a"><mrow id="S3.SS1.p8.3.3.m3.1.1" xref="S3.SS1.p8.3.3.m3.1.1.cmml"><msub id="S3.SS1.p8.3.3.m3.1.1.2" xref="S3.SS1.p8.3.3.m3.1.1.2.cmml"><mi mathcolor="#000000" mathvariant="normal" id="S3.SS1.p8.3.3.m3.1.1.2.2" xref="S3.SS1.p8.3.3.m3.1.1.2.2.cmml">Ω</mi><mn mathcolor="#000000" id="S3.SS1.p8.3.3.m3.1.1.2.3" xref="S3.SS1.p8.3.3.m3.1.1.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p8.3.3.m3.1.1.1" xref="S3.SS1.p8.3.3.m3.1.1.1.cmml">​</mo><mi mathcolor="#000000" mathvariant="normal" id="S3.SS1.p8.3.3.m3.1.1.3" xref="S3.SS1.p8.3.3.m3.1.1.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p8.3.3.m3.1.1.1a" xref="S3.SS1.p8.3.3.m3.1.1.1.cmml">​</mo><msub id="S3.SS1.p8.3.3.m3.1.1.4" xref="S3.SS1.p8.3.3.m3.1.1.4.cmml"><mi mathcolor="#000000" mathvariant="normal" id="S3.SS1.p8.3.3.m3.1.1.4.2" xref="S3.SS1.p8.3.3.m3.1.1.4.2.cmml">Ω</mi><mi mathcolor="#000000" id="S3.SS1.p8.3.3.m3.1.1.4.3" xref="S3.SS1.p8.3.3.m3.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.3.3.m3.1b"><apply id="S3.SS1.p8.3.3.m3.1.1.cmml" xref="S3.SS1.p8.3.3.m3.1.1"><times id="S3.SS1.p8.3.3.m3.1.1.1.cmml" xref="S3.SS1.p8.3.3.m3.1.1.1"></times><apply id="S3.SS1.p8.3.3.m3.1.1.2.cmml" xref="S3.SS1.p8.3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p8.3.3.m3.1.1.2.1.cmml" xref="S3.SS1.p8.3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p8.3.3.m3.1.1.2.2.cmml" xref="S3.SS1.p8.3.3.m3.1.1.2.2">Ω</ci><cn type="integer" id="S3.SS1.p8.3.3.m3.1.1.2.3.cmml" xref="S3.SS1.p8.3.3.m3.1.1.2.3">1</cn></apply><ci id="S3.SS1.p8.3.3.m3.1.1.3.cmml" xref="S3.SS1.p8.3.3.m3.1.1.3">⋯</ci><apply id="S3.SS1.p8.3.3.m3.1.1.4.cmml" xref="S3.SS1.p8.3.3.m3.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p8.3.3.m3.1.1.4.1.cmml" xref="S3.SS1.p8.3.3.m3.1.1.4">subscript</csymbol><ci id="S3.SS1.p8.3.3.m3.1.1.4.2.cmml" xref="S3.SS1.p8.3.3.m3.1.1.4.2">Ω</ci><ci id="S3.SS1.p8.3.3.m3.1.1.4.3.cmml" xref="S3.SS1.p8.3.3.m3.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.3.3.m3.1c">\Omega_{1}\cdots\Omega_{j}</annotation></semantics></math> (<math id="S3.SS1.p8.4.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p8.4.4.m4.1a"><mi mathcolor="#000000" id="S3.SS1.p8.4.4.m4.1.1" xref="S3.SS1.p8.4.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.4.4.m4.1b"><ci id="S3.SS1.p8.4.4.m4.1.1.cmml" xref="S3.SS1.p8.4.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.4.4.m4.1c">j</annotation></semantics></math> being the total number of Federated layers) and patch parameters <math id="S3.SS1.p8.5.5.m5.1" class="ltx_Math" alttext="P_{k_{1}}\cdots P_{k_{m}}" display="inline"><semantics id="S3.SS1.p8.5.5.m5.1a"><mrow id="S3.SS1.p8.5.5.m5.1.1" xref="S3.SS1.p8.5.5.m5.1.1.cmml"><msub id="S3.SS1.p8.5.5.m5.1.1.2" xref="S3.SS1.p8.5.5.m5.1.1.2.cmml"><mi mathcolor="#000000" id="S3.SS1.p8.5.5.m5.1.1.2.2" xref="S3.SS1.p8.5.5.m5.1.1.2.2.cmml">P</mi><msub id="S3.SS1.p8.5.5.m5.1.1.2.3" xref="S3.SS1.p8.5.5.m5.1.1.2.3.cmml"><mi mathcolor="#000000" id="S3.SS1.p8.5.5.m5.1.1.2.3.2" xref="S3.SS1.p8.5.5.m5.1.1.2.3.2.cmml">k</mi><mn mathcolor="#000000" id="S3.SS1.p8.5.5.m5.1.1.2.3.3" xref="S3.SS1.p8.5.5.m5.1.1.2.3.3.cmml">1</mn></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p8.5.5.m5.1.1.1" xref="S3.SS1.p8.5.5.m5.1.1.1.cmml">​</mo><mi mathcolor="#000000" mathvariant="normal" id="S3.SS1.p8.5.5.m5.1.1.3" xref="S3.SS1.p8.5.5.m5.1.1.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p8.5.5.m5.1.1.1a" xref="S3.SS1.p8.5.5.m5.1.1.1.cmml">​</mo><msub id="S3.SS1.p8.5.5.m5.1.1.4" xref="S3.SS1.p8.5.5.m5.1.1.4.cmml"><mi mathcolor="#000000" id="S3.SS1.p8.5.5.m5.1.1.4.2" xref="S3.SS1.p8.5.5.m5.1.1.4.2.cmml">P</mi><msub id="S3.SS1.p8.5.5.m5.1.1.4.3" xref="S3.SS1.p8.5.5.m5.1.1.4.3.cmml"><mi mathcolor="#000000" id="S3.SS1.p8.5.5.m5.1.1.4.3.2" xref="S3.SS1.p8.5.5.m5.1.1.4.3.2.cmml">k</mi><mi mathcolor="#000000" id="S3.SS1.p8.5.5.m5.1.1.4.3.3" xref="S3.SS1.p8.5.5.m5.1.1.4.3.3.cmml">m</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.5.5.m5.1b"><apply id="S3.SS1.p8.5.5.m5.1.1.cmml" xref="S3.SS1.p8.5.5.m5.1.1"><times id="S3.SS1.p8.5.5.m5.1.1.1.cmml" xref="S3.SS1.p8.5.5.m5.1.1.1"></times><apply id="S3.SS1.p8.5.5.m5.1.1.2.cmml" xref="S3.SS1.p8.5.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p8.5.5.m5.1.1.2.1.cmml" xref="S3.SS1.p8.5.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p8.5.5.m5.1.1.2.2.cmml" xref="S3.SS1.p8.5.5.m5.1.1.2.2">𝑃</ci><apply id="S3.SS1.p8.5.5.m5.1.1.2.3.cmml" xref="S3.SS1.p8.5.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p8.5.5.m5.1.1.2.3.1.cmml" xref="S3.SS1.p8.5.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p8.5.5.m5.1.1.2.3.2.cmml" xref="S3.SS1.p8.5.5.m5.1.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p8.5.5.m5.1.1.2.3.3.cmml" xref="S3.SS1.p8.5.5.m5.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p8.5.5.m5.1.1.3.cmml" xref="S3.SS1.p8.5.5.m5.1.1.3">⋯</ci><apply id="S3.SS1.p8.5.5.m5.1.1.4.cmml" xref="S3.SS1.p8.5.5.m5.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p8.5.5.m5.1.1.4.1.cmml" xref="S3.SS1.p8.5.5.m5.1.1.4">subscript</csymbol><ci id="S3.SS1.p8.5.5.m5.1.1.4.2.cmml" xref="S3.SS1.p8.5.5.m5.1.1.4.2">𝑃</ci><apply id="S3.SS1.p8.5.5.m5.1.1.4.3.cmml" xref="S3.SS1.p8.5.5.m5.1.1.4.3"><csymbol cd="ambiguous" id="S3.SS1.p8.5.5.m5.1.1.4.3.1.cmml" xref="S3.SS1.p8.5.5.m5.1.1.4.3">subscript</csymbol><ci id="S3.SS1.p8.5.5.m5.1.1.4.3.2.cmml" xref="S3.SS1.p8.5.5.m5.1.1.4.3.2">𝑘</ci><ci id="S3.SS1.p8.5.5.m5.1.1.4.3.3.cmml" xref="S3.SS1.p8.5.5.m5.1.1.4.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.5.5.m5.1c">P_{k_{1}}\cdots P_{k_{m}}</annotation></semantics></math> (<math id="S3.SS1.p8.6.6.m6.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p8.6.6.m6.1a"><mi mathcolor="#000000" id="S3.SS1.p8.6.6.m6.1.1" xref="S3.SS1.p8.6.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.6.6.m6.1b"><ci id="S3.SS1.p8.6.6.m6.1.1.cmml" xref="S3.SS1.p8.6.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.6.6.m6.1c">m</annotation></semantics></math> being the total number of local patches, <math id="S3.SS1.p8.7.7.m7.1" class="ltx_Math" alttext="\{i\}" display="inline"><semantics id="S3.SS1.p8.7.7.m7.1a"><mrow id="S3.SS1.p8.7.7.m7.1.2.2" xref="S3.SS1.p8.7.7.m7.1.2.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p8.7.7.m7.1.2.2.1" xref="S3.SS1.p8.7.7.m7.1.2.1.cmml">{</mo><mi mathcolor="#000000" id="S3.SS1.p8.7.7.m7.1.1" xref="S3.SS1.p8.7.7.m7.1.1.cmml">i</mi><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p8.7.7.m7.1.2.2.2" xref="S3.SS1.p8.7.7.m7.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.7.7.m7.1b"><set id="S3.SS1.p8.7.7.m7.1.2.1.cmml" xref="S3.SS1.p8.7.7.m7.1.2.2"><ci id="S3.SS1.p8.7.7.m7.1.1.cmml" xref="S3.SS1.p8.7.7.m7.1.1">𝑖</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.7.7.m7.1c">\{i\}</annotation></semantics></math> being the set of indexes of the patch parameters) unique to client <math id="S3.SS1.p8.8.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p8.8.8.m8.1a"><mi mathcolor="#000000" id="S3.SS1.p8.8.8.m8.1.1" xref="S3.SS1.p8.8.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.8.8.m8.1b"><ci id="S3.SS1.p8.8.8.m8.1.1.cmml" xref="S3.SS1.p8.8.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.8.8.m8.1c">k</annotation></semantics></math>. Fig. 2 shows an example composition of a DNN model used in MTFL.</span></p>
</div>
<div id="S3.SS1.p9" class="ltx_para">
<p id="S3.SS1.p9.1" class="ltx_p">MTFL is a general algorithm for incorporating MTL into FL. Different optimisation strategies (including FedAvg-Adam described in Section 3.3) can be used within MTFL, and we later show that MTFL can substantially reduce the number of rounds to reach target UA, regardless of the optimisation strategy used.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> MTFL</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>Initialise global model <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\Omega" display="inline"><semantics id="alg1.l1.m1.1a"><mi mathvariant="normal" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">Ω</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">Ω</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\Omega</annotation></semantics></math> and global optimiser values <math id="alg1.l1.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">V</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text ltx_font_bold">while</span> termination criteria not met <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>   Select round clients, <math id="alg1.l3.m1.1" class="ltx_Math" alttext="S_{r}\subset S" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msub id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">S</mi><mi id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">r</mi></msub><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">⊂</mo><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><subset id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></subset><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝑆</ci><ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">𝑟</ci></apply><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">S_{r}\subset S</annotation></semantics></math>, <math id="alg1.l3.m2.2" class="ltx_Math" alttext="|S_{r}|=C\cdot|S|" display="inline"><semantics id="alg1.l3.m2.2a"><mrow id="alg1.l3.m2.2.2" xref="alg1.l3.m2.2.2.cmml"><mrow id="alg1.l3.m2.2.2.1.1" xref="alg1.l3.m2.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l3.m2.2.2.1.1.2" xref="alg1.l3.m2.2.2.1.2.1.cmml">|</mo><msub id="alg1.l3.m2.2.2.1.1.1" xref="alg1.l3.m2.2.2.1.1.1.cmml"><mi id="alg1.l3.m2.2.2.1.1.1.2" xref="alg1.l3.m2.2.2.1.1.1.2.cmml">S</mi><mi id="alg1.l3.m2.2.2.1.1.1.3" xref="alg1.l3.m2.2.2.1.1.1.3.cmml">r</mi></msub><mo stretchy="false" id="alg1.l3.m2.2.2.1.1.3" xref="alg1.l3.m2.2.2.1.2.1.cmml">|</mo></mrow><mo id="alg1.l3.m2.2.2.2" xref="alg1.l3.m2.2.2.2.cmml">=</mo><mrow id="alg1.l3.m2.2.2.3" xref="alg1.l3.m2.2.2.3.cmml"><mi id="alg1.l3.m2.2.2.3.2" xref="alg1.l3.m2.2.2.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l3.m2.2.2.3.1" xref="alg1.l3.m2.2.2.3.1.cmml">⋅</mo><mrow id="alg1.l3.m2.2.2.3.3.2" xref="alg1.l3.m2.2.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l3.m2.2.2.3.3.2.1" xref="alg1.l3.m2.2.2.3.3.1.1.cmml">|</mo><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">S</mi><mo stretchy="false" id="alg1.l3.m2.2.2.3.3.2.2" xref="alg1.l3.m2.2.2.3.3.1.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.2b"><apply id="alg1.l3.m2.2.2.cmml" xref="alg1.l3.m2.2.2"><eq id="alg1.l3.m2.2.2.2.cmml" xref="alg1.l3.m2.2.2.2"></eq><apply id="alg1.l3.m2.2.2.1.2.cmml" xref="alg1.l3.m2.2.2.1.1"><abs id="alg1.l3.m2.2.2.1.2.1.cmml" xref="alg1.l3.m2.2.2.1.1.2"></abs><apply id="alg1.l3.m2.2.2.1.1.1.cmml" xref="alg1.l3.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.2.2.1.1.1.1.cmml" xref="alg1.l3.m2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l3.m2.2.2.1.1.1.2.cmml" xref="alg1.l3.m2.2.2.1.1.1.2">𝑆</ci><ci id="alg1.l3.m2.2.2.1.1.1.3.cmml" xref="alg1.l3.m2.2.2.1.1.1.3">𝑟</ci></apply></apply><apply id="alg1.l3.m2.2.2.3.cmml" xref="alg1.l3.m2.2.2.3"><ci id="alg1.l3.m2.2.2.3.1.cmml" xref="alg1.l3.m2.2.2.3.1">⋅</ci><ci id="alg1.l3.m2.2.2.3.2.cmml" xref="alg1.l3.m2.2.2.3.2">𝐶</ci><apply id="alg1.l3.m2.2.2.3.3.1.cmml" xref="alg1.l3.m2.2.2.3.3.2"><abs id="alg1.l3.m2.2.2.3.3.1.1.cmml" xref="alg1.l3.m2.2.2.3.3.2.1"></abs><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.2c">|S_{r}|=C\cdot|S|</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>   <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for each</span> client <math id="alg1.l5.m1.1" class="ltx_Math" alttext="s_{k}\in S_{r}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">s</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">∈</mo><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">S</mi><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><in id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></in><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑠</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝑆</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">s_{k}\in S_{r}</annotation></semantics></math> in parallel <span id="alg1.l5.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>      Download global parameters <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\mathcal{M}_{k}\leftarrow\Omega" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">ℳ</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mi mathvariant="normal" id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">Ω</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">ℳ</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">Ω</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathcal{M}_{k}\leftarrow\Omega</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>      Download optimiser values <math id="alg1.l7.m1.1" class="ltx_Math" alttext="V_{k}\leftarrow V" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">V</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑉</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">V_{k}\leftarrow V</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.2.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>      <span id="alg1.l8.3" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l8.m1.1" class="ltx_Math" alttext="i\in" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">∈</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><in id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></in><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑖</ci><csymbol cd="latexml" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">i\in</annotation></semantics></math> patchIdxs <span id="alg1.l8.4" class="ltx_text ltx_font_bold">do</span> <span id="alg1.l8.1" class="ltx_text" style="float:right;"><math id="alg1.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation></semantics></math> Apply local patches
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>         <math id="alg1.l9.m1.4" class="ltx_Math" alttext="\mathcal{M}_{k,i}\leftarrow P_{k,i}" display="inline"><semantics id="alg1.l9.m1.4a"><mrow id="alg1.l9.m1.4.5" xref="alg1.l9.m1.4.5.cmml"><msub id="alg1.l9.m1.4.5.2" xref="alg1.l9.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.4.5.2.2" xref="alg1.l9.m1.4.5.2.2.cmml">ℳ</mi><mrow id="alg1.l9.m1.2.2.2.4" xref="alg1.l9.m1.2.2.2.3.cmml"><mi id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l9.m1.2.2.2.4.1" xref="alg1.l9.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg1.l9.m1.4.5.1" xref="alg1.l9.m1.4.5.1.cmml">←</mo><msub id="alg1.l9.m1.4.5.3" xref="alg1.l9.m1.4.5.3.cmml"><mi id="alg1.l9.m1.4.5.3.2" xref="alg1.l9.m1.4.5.3.2.cmml">P</mi><mrow id="alg1.l9.m1.4.4.2.4" xref="alg1.l9.m1.4.4.2.3.cmml"><mi id="alg1.l9.m1.3.3.1.1" xref="alg1.l9.m1.3.3.1.1.cmml">k</mi><mo id="alg1.l9.m1.4.4.2.4.1" xref="alg1.l9.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l9.m1.4.4.2.2" xref="alg1.l9.m1.4.4.2.2.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.4b"><apply id="alg1.l9.m1.4.5.cmml" xref="alg1.l9.m1.4.5"><ci id="alg1.l9.m1.4.5.1.cmml" xref="alg1.l9.m1.4.5.1">←</ci><apply id="alg1.l9.m1.4.5.2.cmml" xref="alg1.l9.m1.4.5.2"><csymbol cd="ambiguous" id="alg1.l9.m1.4.5.2.1.cmml" xref="alg1.l9.m1.4.5.2">subscript</csymbol><ci id="alg1.l9.m1.4.5.2.2.cmml" xref="alg1.l9.m1.4.5.2.2">ℳ</ci><list id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.4"><ci id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1">𝑘</ci><ci id="alg1.l9.m1.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2">𝑖</ci></list></apply><apply id="alg1.l9.m1.4.5.3.cmml" xref="alg1.l9.m1.4.5.3"><csymbol cd="ambiguous" id="alg1.l9.m1.4.5.3.1.cmml" xref="alg1.l9.m1.4.5.3">subscript</csymbol><ci id="alg1.l9.m1.4.5.3.2.cmml" xref="alg1.l9.m1.4.5.3.2">𝑃</ci><list id="alg1.l9.m1.4.4.2.3.cmml" xref="alg1.l9.m1.4.4.2.4"><ci id="alg1.l9.m1.3.3.1.1.cmml" xref="alg1.l9.m1.3.3.1.1">𝑘</ci><ci id="alg1.l9.m1.4.4.2.2.cmml" xref="alg1.l9.m1.4.4.2.2">𝑖</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.4c">\mathcal{M}_{k,i}\leftarrow P_{k,i}</annotation></semantics></math>, <math id="alg1.l9.m2.4" class="ltx_Math" alttext="V_{k,i}\leftarrow W_{k,i}" display="inline"><semantics id="alg1.l9.m2.4a"><mrow id="alg1.l9.m2.4.5" xref="alg1.l9.m2.4.5.cmml"><msub id="alg1.l9.m2.4.5.2" xref="alg1.l9.m2.4.5.2.cmml"><mi id="alg1.l9.m2.4.5.2.2" xref="alg1.l9.m2.4.5.2.2.cmml">V</mi><mrow id="alg1.l9.m2.2.2.2.4" xref="alg1.l9.m2.2.2.2.3.cmml"><mi id="alg1.l9.m2.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.cmml">k</mi><mo id="alg1.l9.m2.2.2.2.4.1" xref="alg1.l9.m2.2.2.2.3.cmml">,</mo><mi id="alg1.l9.m2.2.2.2.2" xref="alg1.l9.m2.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg1.l9.m2.4.5.1" xref="alg1.l9.m2.4.5.1.cmml">←</mo><msub id="alg1.l9.m2.4.5.3" xref="alg1.l9.m2.4.5.3.cmml"><mi id="alg1.l9.m2.4.5.3.2" xref="alg1.l9.m2.4.5.3.2.cmml">W</mi><mrow id="alg1.l9.m2.4.4.2.4" xref="alg1.l9.m2.4.4.2.3.cmml"><mi id="alg1.l9.m2.3.3.1.1" xref="alg1.l9.m2.3.3.1.1.cmml">k</mi><mo id="alg1.l9.m2.4.4.2.4.1" xref="alg1.l9.m2.4.4.2.3.cmml">,</mo><mi id="alg1.l9.m2.4.4.2.2" xref="alg1.l9.m2.4.4.2.2.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.4b"><apply id="alg1.l9.m2.4.5.cmml" xref="alg1.l9.m2.4.5"><ci id="alg1.l9.m2.4.5.1.cmml" xref="alg1.l9.m2.4.5.1">←</ci><apply id="alg1.l9.m2.4.5.2.cmml" xref="alg1.l9.m2.4.5.2"><csymbol cd="ambiguous" id="alg1.l9.m2.4.5.2.1.cmml" xref="alg1.l9.m2.4.5.2">subscript</csymbol><ci id="alg1.l9.m2.4.5.2.2.cmml" xref="alg1.l9.m2.4.5.2.2">𝑉</ci><list id="alg1.l9.m2.2.2.2.3.cmml" xref="alg1.l9.m2.2.2.2.4"><ci id="alg1.l9.m2.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1">𝑘</ci><ci id="alg1.l9.m2.2.2.2.2.cmml" xref="alg1.l9.m2.2.2.2.2">𝑖</ci></list></apply><apply id="alg1.l9.m2.4.5.3.cmml" xref="alg1.l9.m2.4.5.3"><csymbol cd="ambiguous" id="alg1.l9.m2.4.5.3.1.cmml" xref="alg1.l9.m2.4.5.3">subscript</csymbol><ci id="alg1.l9.m2.4.5.3.2.cmml" xref="alg1.l9.m2.4.5.3.2">𝑊</ci><list id="alg1.l9.m2.4.4.2.3.cmml" xref="alg1.l9.m2.4.4.2.4"><ci id="alg1.l9.m2.3.3.1.1.cmml" xref="alg1.l9.m2.3.3.1.1">𝑘</ci><ci id="alg1.l9.m2.4.4.2.2.cmml" xref="alg1.l9.m2.4.4.2.2">𝑖</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.4c">V_{k,i}\leftarrow W_{k,i}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>      <span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>      <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l11.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="alg1.l11.m1.1a"><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">b</annotation></semantics></math> drawn from local data <math id="alg1.l11.m2.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="alg1.l11.m2.1a"><msub id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">D</mi><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝐷</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">D_{k}</annotation></semantics></math> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>         <math id="alg1.l12.m1.5" class="ltx_Math" alttext="\mathcal{M}_{k},V_{k}\leftarrow\mathrm{LocalUpdate}(\mathcal{M}_{k},V_{k},b)" display="inline"><semantics id="alg1.l12.m1.5a"><mrow id="alg1.l12.m1.5.5" xref="alg1.l12.m1.5.5.cmml"><mrow id="alg1.l12.m1.3.3.2.2" xref="alg1.l12.m1.3.3.2.3.cmml"><msub id="alg1.l12.m1.2.2.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.2.2.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.2.cmml">ℳ</mi><mi id="alg1.l12.m1.2.2.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l12.m1.3.3.2.2.3" xref="alg1.l12.m1.3.3.2.3.cmml">,</mo><msub id="alg1.l12.m1.3.3.2.2.2" xref="alg1.l12.m1.3.3.2.2.2.cmml"><mi id="alg1.l12.m1.3.3.2.2.2.2" xref="alg1.l12.m1.3.3.2.2.2.2.cmml">V</mi><mi id="alg1.l12.m1.3.3.2.2.2.3" xref="alg1.l12.m1.3.3.2.2.2.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="alg1.l12.m1.5.5.5" xref="alg1.l12.m1.5.5.5.cmml">←</mo><mrow id="alg1.l12.m1.5.5.4" xref="alg1.l12.m1.5.5.4.cmml"><mi id="alg1.l12.m1.5.5.4.4" xref="alg1.l12.m1.5.5.4.4.cmml">LocalUpdate</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.5.5.4.3" xref="alg1.l12.m1.5.5.4.3.cmml">​</mo><mrow id="alg1.l12.m1.5.5.4.2.2" xref="alg1.l12.m1.5.5.4.2.3.cmml"><mo stretchy="false" id="alg1.l12.m1.5.5.4.2.2.3" xref="alg1.l12.m1.5.5.4.2.3.cmml">(</mo><msub id="alg1.l12.m1.4.4.3.1.1.1" xref="alg1.l12.m1.4.4.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.4.4.3.1.1.1.2" xref="alg1.l12.m1.4.4.3.1.1.1.2.cmml">ℳ</mi><mi id="alg1.l12.m1.4.4.3.1.1.1.3" xref="alg1.l12.m1.4.4.3.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l12.m1.5.5.4.2.2.4" xref="alg1.l12.m1.5.5.4.2.3.cmml">,</mo><msub id="alg1.l12.m1.5.5.4.2.2.2" xref="alg1.l12.m1.5.5.4.2.2.2.cmml"><mi id="alg1.l12.m1.5.5.4.2.2.2.2" xref="alg1.l12.m1.5.5.4.2.2.2.2.cmml">V</mi><mi id="alg1.l12.m1.5.5.4.2.2.2.3" xref="alg1.l12.m1.5.5.4.2.2.2.3.cmml">k</mi></msub><mo id="alg1.l12.m1.5.5.4.2.2.5" xref="alg1.l12.m1.5.5.4.2.3.cmml">,</mo><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">b</mi><mo stretchy="false" id="alg1.l12.m1.5.5.4.2.2.6" xref="alg1.l12.m1.5.5.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.5b"><apply id="alg1.l12.m1.5.5.cmml" xref="alg1.l12.m1.5.5"><ci id="alg1.l12.m1.5.5.5.cmml" xref="alg1.l12.m1.5.5.5">←</ci><list id="alg1.l12.m1.3.3.2.3.cmml" xref="alg1.l12.m1.3.3.2.2"><apply id="alg1.l12.m1.2.2.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.2.2.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.2">ℳ</ci><ci id="alg1.l12.m1.2.2.1.1.1.3.cmml" xref="alg1.l12.m1.2.2.1.1.1.3">𝑘</ci></apply><apply id="alg1.l12.m1.3.3.2.2.2.cmml" xref="alg1.l12.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.2.2.2.1.cmml" xref="alg1.l12.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.3.3.2.2.2.2.cmml" xref="alg1.l12.m1.3.3.2.2.2.2">𝑉</ci><ci id="alg1.l12.m1.3.3.2.2.2.3.cmml" xref="alg1.l12.m1.3.3.2.2.2.3">𝑘</ci></apply></list><apply id="alg1.l12.m1.5.5.4.cmml" xref="alg1.l12.m1.5.5.4"><times id="alg1.l12.m1.5.5.4.3.cmml" xref="alg1.l12.m1.5.5.4.3"></times><ci id="alg1.l12.m1.5.5.4.4.cmml" xref="alg1.l12.m1.5.5.4.4">LocalUpdate</ci><vector id="alg1.l12.m1.5.5.4.2.3.cmml" xref="alg1.l12.m1.5.5.4.2.2"><apply id="alg1.l12.m1.4.4.3.1.1.1.cmml" xref="alg1.l12.m1.4.4.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.3.1.1.1.1.cmml" xref="alg1.l12.m1.4.4.3.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.4.4.3.1.1.1.2.cmml" xref="alg1.l12.m1.4.4.3.1.1.1.2">ℳ</ci><ci id="alg1.l12.m1.4.4.3.1.1.1.3.cmml" xref="alg1.l12.m1.4.4.3.1.1.1.3">𝑘</ci></apply><apply id="alg1.l12.m1.5.5.4.2.2.2.cmml" xref="alg1.l12.m1.5.5.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.4.2.2.2.1.cmml" xref="alg1.l12.m1.5.5.4.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.5.5.4.2.2.2.2.cmml" xref="alg1.l12.m1.5.5.4.2.2.2.2">𝑉</ci><ci id="alg1.l12.m1.5.5.4.2.2.2.3.cmml" xref="alg1.l12.m1.5.5.4.2.2.2.3">𝑘</ci></apply><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑏</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.5c">\mathcal{M}_{k},V_{k}\leftarrow\mathrm{LocalUpdate}(\mathcal{M}_{k},V_{k},b)</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>      <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.2.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>      <span id="alg1.l14.3" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l14.m1.1" class="ltx_Math" alttext="i\in" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">∈</mo><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><in id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></in><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑖</ci><csymbol cd="latexml" id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">i\in</annotation></semantics></math> patchIdxs <span id="alg1.l14.4" class="ltx_text ltx_font_bold">do</span> <span id="alg1.l14.1" class="ltx_text" style="float:right;"><math id="alg1.l14.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l14.1.m1.1a"><mo id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><ci id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">\triangleright</annotation></semantics></math> Save local patches
</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>         <math id="alg1.l15.m1.10" class="ltx_Math" alttext="P_{k,i}\leftarrow\mathcal{M}_{k,i},W_{k,i}\leftarrow V_{k,i}" display="inline"><semantics id="alg1.l15.m1.10a"><mrow id="alg1.l15.m1.10.10.2" xref="alg1.l15.m1.10.10.3.cmml"><mrow id="alg1.l15.m1.9.9.1.1" xref="alg1.l15.m1.9.9.1.1.cmml"><msub id="alg1.l15.m1.9.9.1.1.2" xref="alg1.l15.m1.9.9.1.1.2.cmml"><mi id="alg1.l15.m1.9.9.1.1.2.2" xref="alg1.l15.m1.9.9.1.1.2.2.cmml">P</mi><mrow id="alg1.l15.m1.2.2.2.4" xref="alg1.l15.m1.2.2.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l15.m1.2.2.2.4.1" xref="alg1.l15.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l15.m1.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg1.l15.m1.9.9.1.1.1" xref="alg1.l15.m1.9.9.1.1.1.cmml">←</mo><msub id="alg1.l15.m1.9.9.1.1.3" xref="alg1.l15.m1.9.9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.9.9.1.1.3.2" xref="alg1.l15.m1.9.9.1.1.3.2.cmml">ℳ</mi><mrow id="alg1.l15.m1.4.4.2.4" xref="alg1.l15.m1.4.4.2.3.cmml"><mi id="alg1.l15.m1.3.3.1.1" xref="alg1.l15.m1.3.3.1.1.cmml">k</mi><mo id="alg1.l15.m1.4.4.2.4.1" xref="alg1.l15.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l15.m1.4.4.2.2" xref="alg1.l15.m1.4.4.2.2.cmml">i</mi></mrow></msub></mrow><mo id="alg1.l15.m1.10.10.2.3" xref="alg1.l15.m1.10.10.3a.cmml">,</mo><mrow id="alg1.l15.m1.10.10.2.2" xref="alg1.l15.m1.10.10.2.2.cmml"><msub id="alg1.l15.m1.10.10.2.2.2" xref="alg1.l15.m1.10.10.2.2.2.cmml"><mi id="alg1.l15.m1.10.10.2.2.2.2" xref="alg1.l15.m1.10.10.2.2.2.2.cmml">W</mi><mrow id="alg1.l15.m1.6.6.2.4" xref="alg1.l15.m1.6.6.2.3.cmml"><mi id="alg1.l15.m1.5.5.1.1" xref="alg1.l15.m1.5.5.1.1.cmml">k</mi><mo id="alg1.l15.m1.6.6.2.4.1" xref="alg1.l15.m1.6.6.2.3.cmml">,</mo><mi id="alg1.l15.m1.6.6.2.2" xref="alg1.l15.m1.6.6.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg1.l15.m1.10.10.2.2.1" xref="alg1.l15.m1.10.10.2.2.1.cmml">←</mo><msub id="alg1.l15.m1.10.10.2.2.3" xref="alg1.l15.m1.10.10.2.2.3.cmml"><mi id="alg1.l15.m1.10.10.2.2.3.2" xref="alg1.l15.m1.10.10.2.2.3.2.cmml">V</mi><mrow id="alg1.l15.m1.8.8.2.4" xref="alg1.l15.m1.8.8.2.3.cmml"><mi id="alg1.l15.m1.7.7.1.1" xref="alg1.l15.m1.7.7.1.1.cmml">k</mi><mo id="alg1.l15.m1.8.8.2.4.1" xref="alg1.l15.m1.8.8.2.3.cmml">,</mo><mi id="alg1.l15.m1.8.8.2.2" xref="alg1.l15.m1.8.8.2.2.cmml">i</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.10b"><apply id="alg1.l15.m1.10.10.3.cmml" xref="alg1.l15.m1.10.10.2"><csymbol cd="ambiguous" id="alg1.l15.m1.10.10.3a.cmml" xref="alg1.l15.m1.10.10.2.3">formulae-sequence</csymbol><apply id="alg1.l15.m1.9.9.1.1.cmml" xref="alg1.l15.m1.9.9.1.1"><ci id="alg1.l15.m1.9.9.1.1.1.cmml" xref="alg1.l15.m1.9.9.1.1.1">←</ci><apply id="alg1.l15.m1.9.9.1.1.2.cmml" xref="alg1.l15.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.9.9.1.1.2.1.cmml" xref="alg1.l15.m1.9.9.1.1.2">subscript</csymbol><ci id="alg1.l15.m1.9.9.1.1.2.2.cmml" xref="alg1.l15.m1.9.9.1.1.2.2">𝑃</ci><list id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.4"><ci id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">𝑘</ci><ci id="alg1.l15.m1.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2">𝑖</ci></list></apply><apply id="alg1.l15.m1.9.9.1.1.3.cmml" xref="alg1.l15.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.9.9.1.1.3.1.cmml" xref="alg1.l15.m1.9.9.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.9.9.1.1.3.2.cmml" xref="alg1.l15.m1.9.9.1.1.3.2">ℳ</ci><list id="alg1.l15.m1.4.4.2.3.cmml" xref="alg1.l15.m1.4.4.2.4"><ci id="alg1.l15.m1.3.3.1.1.cmml" xref="alg1.l15.m1.3.3.1.1">𝑘</ci><ci id="alg1.l15.m1.4.4.2.2.cmml" xref="alg1.l15.m1.4.4.2.2">𝑖</ci></list></apply></apply><apply id="alg1.l15.m1.10.10.2.2.cmml" xref="alg1.l15.m1.10.10.2.2"><ci id="alg1.l15.m1.10.10.2.2.1.cmml" xref="alg1.l15.m1.10.10.2.2.1">←</ci><apply id="alg1.l15.m1.10.10.2.2.2.cmml" xref="alg1.l15.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.10.10.2.2.2.1.cmml" xref="alg1.l15.m1.10.10.2.2.2">subscript</csymbol><ci id="alg1.l15.m1.10.10.2.2.2.2.cmml" xref="alg1.l15.m1.10.10.2.2.2.2">𝑊</ci><list id="alg1.l15.m1.6.6.2.3.cmml" xref="alg1.l15.m1.6.6.2.4"><ci id="alg1.l15.m1.5.5.1.1.cmml" xref="alg1.l15.m1.5.5.1.1">𝑘</ci><ci id="alg1.l15.m1.6.6.2.2.cmml" xref="alg1.l15.m1.6.6.2.2">𝑖</ci></list></apply><apply id="alg1.l15.m1.10.10.2.2.3.cmml" xref="alg1.l15.m1.10.10.2.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.10.10.2.2.3.1.cmml" xref="alg1.l15.m1.10.10.2.2.3">subscript</csymbol><ci id="alg1.l15.m1.10.10.2.2.3.2.cmml" xref="alg1.l15.m1.10.10.2.2.3.2">𝑉</ci><list id="alg1.l15.m1.8.8.2.3.cmml" xref="alg1.l15.m1.8.8.2.4"><ci id="alg1.l15.m1.7.7.1.1.cmml" xref="alg1.l15.m1.7.7.1.1">𝑘</ci><ci id="alg1.l15.m1.8.8.2.2.cmml" xref="alg1.l15.m1.8.8.2.2">𝑖</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.10c">P_{k,i}\leftarrow\mathcal{M}_{k,i},W_{k,i}\leftarrow V_{k,i}</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>      <span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>      <span id="alg1.l17.2" class="ltx_text ltx_font_bold">for each</span> <math id="alg1.l17.m1.1" class="ltx_Math" alttext="i\notin" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">i</mi><mo id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">∉</mo><mi id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><notin id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"></notin><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝑖</ci><csymbol cd="latexml" id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">i\notin</annotation></semantics></math> patchIdxs <span id="alg1.l17.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>         Upload <math id="alg1.l18.m1.6" class="ltx_Math" alttext="\mathcal{M}_{k,i},V_{k,i}" display="inline"><semantics id="alg1.l18.m1.6a"><mrow id="alg1.l18.m1.6.6.2" xref="alg1.l18.m1.6.6.3.cmml"><msub id="alg1.l18.m1.5.5.1.1" xref="alg1.l18.m1.5.5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l18.m1.5.5.1.1.2" xref="alg1.l18.m1.5.5.1.1.2.cmml">ℳ</mi><mrow id="alg1.l18.m1.2.2.2.4" xref="alg1.l18.m1.2.2.2.3.cmml"><mi id="alg1.l18.m1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l18.m1.2.2.2.4.1" xref="alg1.l18.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l18.m1.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="alg1.l18.m1.6.6.2.3" xref="alg1.l18.m1.6.6.3.cmml">,</mo><msub id="alg1.l18.m1.6.6.2.2" xref="alg1.l18.m1.6.6.2.2.cmml"><mi id="alg1.l18.m1.6.6.2.2.2" xref="alg1.l18.m1.6.6.2.2.2.cmml">V</mi><mrow id="alg1.l18.m1.4.4.2.4" xref="alg1.l18.m1.4.4.2.3.cmml"><mi id="alg1.l18.m1.3.3.1.1" xref="alg1.l18.m1.3.3.1.1.cmml">k</mi><mo id="alg1.l18.m1.4.4.2.4.1" xref="alg1.l18.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l18.m1.4.4.2.2" xref="alg1.l18.m1.4.4.2.2.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.6b"><list id="alg1.l18.m1.6.6.3.cmml" xref="alg1.l18.m1.6.6.2"><apply id="alg1.l18.m1.5.5.1.1.cmml" xref="alg1.l18.m1.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.5.5.1.1.1.cmml" xref="alg1.l18.m1.5.5.1.1">subscript</csymbol><ci id="alg1.l18.m1.5.5.1.1.2.cmml" xref="alg1.l18.m1.5.5.1.1.2">ℳ</ci><list id="alg1.l18.m1.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.4"><ci id="alg1.l18.m1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1">𝑘</ci><ci id="alg1.l18.m1.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2">𝑖</ci></list></apply><apply id="alg1.l18.m1.6.6.2.2.cmml" xref="alg1.l18.m1.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.6.6.2.2.1.cmml" xref="alg1.l18.m1.6.6.2.2">subscript</csymbol><ci id="alg1.l18.m1.6.6.2.2.2.cmml" xref="alg1.l18.m1.6.6.2.2.2">𝑉</ci><list id="alg1.l18.m1.4.4.2.3.cmml" xref="alg1.l18.m1.4.4.2.4"><ci id="alg1.l18.m1.3.3.1.1.cmml" xref="alg1.l18.m1.3.3.1.1">𝑘</ci><ci id="alg1.l18.m1.4.4.2.2.cmml" xref="alg1.l18.m1.4.4.2.2">𝑖</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.6c">\mathcal{M}_{k,i},V_{k,i}</annotation></semantics></math> to server

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>      <span id="alg1.l19.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>   <span id="alg1.l20.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l20.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>
</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>   <span id="alg1.l22.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l22.m1.1" class="ltx_Math" alttext="i\notin" display="inline"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mi id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml">i</mi><mo id="alg1.l22.m1.1.1.1" xref="alg1.l22.m1.1.1.1.cmml">∉</mo><mi id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><notin id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1"></notin><ci id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2">𝑖</ci><csymbol cd="latexml" id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">i\notin</annotation></semantics></math> nonPatchIndexes <span id="alg1.l22.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>      <math id="alg1.l23.m1.4" class="ltx_Math" alttext="\Omega_{i}\leftarrow\mathrm{GlobalModelUpdate}(\Omega_{i},\{\mathcal{M}_{k,i}\}_{k\in S_{r}})" display="inline"><semantics id="alg1.l23.m1.4a"><mrow id="alg1.l23.m1.4.4" xref="alg1.l23.m1.4.4.cmml"><msub id="alg1.l23.m1.4.4.4" xref="alg1.l23.m1.4.4.4.cmml"><mi mathvariant="normal" id="alg1.l23.m1.4.4.4.2" xref="alg1.l23.m1.4.4.4.2.cmml">Ω</mi><mi id="alg1.l23.m1.4.4.4.3" xref="alg1.l23.m1.4.4.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l23.m1.4.4.3" xref="alg1.l23.m1.4.4.3.cmml">←</mo><mrow id="alg1.l23.m1.4.4.2" xref="alg1.l23.m1.4.4.2.cmml"><mi id="alg1.l23.m1.4.4.2.4" xref="alg1.l23.m1.4.4.2.4.cmml">GlobalModelUpdate</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.4.4.2.3" xref="alg1.l23.m1.4.4.2.3.cmml">​</mo><mrow id="alg1.l23.m1.4.4.2.2.2" xref="alg1.l23.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="alg1.l23.m1.4.4.2.2.2.3" xref="alg1.l23.m1.4.4.2.2.3.cmml">(</mo><msub id="alg1.l23.m1.3.3.1.1.1.1" xref="alg1.l23.m1.3.3.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l23.m1.3.3.1.1.1.1.2" xref="alg1.l23.m1.3.3.1.1.1.1.2.cmml">Ω</mi><mi id="alg1.l23.m1.3.3.1.1.1.1.3" xref="alg1.l23.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l23.m1.4.4.2.2.2.4" xref="alg1.l23.m1.4.4.2.2.3.cmml">,</mo><msub id="alg1.l23.m1.4.4.2.2.2.2" xref="alg1.l23.m1.4.4.2.2.2.2.cmml"><mrow id="alg1.l23.m1.4.4.2.2.2.2.1.1" xref="alg1.l23.m1.4.4.2.2.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l23.m1.4.4.2.2.2.2.1.1.2" xref="alg1.l23.m1.4.4.2.2.2.2.1.2.cmml">{</mo><msub id="alg1.l23.m1.4.4.2.2.2.2.1.1.1" xref="alg1.l23.m1.4.4.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l23.m1.4.4.2.2.2.2.1.1.1.2" xref="alg1.l23.m1.4.4.2.2.2.2.1.1.1.2.cmml">ℳ</mi><mrow id="alg1.l23.m1.2.2.2.4" xref="alg1.l23.m1.2.2.2.3.cmml"><mi id="alg1.l23.m1.1.1.1.1" xref="alg1.l23.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l23.m1.2.2.2.4.1" xref="alg1.l23.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l23.m1.2.2.2.2" xref="alg1.l23.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg1.l23.m1.4.4.2.2.2.2.1.1.3" xref="alg1.l23.m1.4.4.2.2.2.2.1.2.cmml">}</mo></mrow><mrow id="alg1.l23.m1.4.4.2.2.2.2.3" xref="alg1.l23.m1.4.4.2.2.2.2.3.cmml"><mi id="alg1.l23.m1.4.4.2.2.2.2.3.2" xref="alg1.l23.m1.4.4.2.2.2.2.3.2.cmml">k</mi><mo id="alg1.l23.m1.4.4.2.2.2.2.3.1" xref="alg1.l23.m1.4.4.2.2.2.2.3.1.cmml">∈</mo><msub id="alg1.l23.m1.4.4.2.2.2.2.3.3" xref="alg1.l23.m1.4.4.2.2.2.2.3.3.cmml"><mi id="alg1.l23.m1.4.4.2.2.2.2.3.3.2" xref="alg1.l23.m1.4.4.2.2.2.2.3.3.2.cmml">S</mi><mi id="alg1.l23.m1.4.4.2.2.2.2.3.3.3" xref="alg1.l23.m1.4.4.2.2.2.2.3.3.3.cmml">r</mi></msub></mrow></msub><mo stretchy="false" id="alg1.l23.m1.4.4.2.2.2.5" xref="alg1.l23.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.4b"><apply id="alg1.l23.m1.4.4.cmml" xref="alg1.l23.m1.4.4"><ci id="alg1.l23.m1.4.4.3.cmml" xref="alg1.l23.m1.4.4.3">←</ci><apply id="alg1.l23.m1.4.4.4.cmml" xref="alg1.l23.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l23.m1.4.4.4.1.cmml" xref="alg1.l23.m1.4.4.4">subscript</csymbol><ci id="alg1.l23.m1.4.4.4.2.cmml" xref="alg1.l23.m1.4.4.4.2">Ω</ci><ci id="alg1.l23.m1.4.4.4.3.cmml" xref="alg1.l23.m1.4.4.4.3">𝑖</ci></apply><apply id="alg1.l23.m1.4.4.2.cmml" xref="alg1.l23.m1.4.4.2"><times id="alg1.l23.m1.4.4.2.3.cmml" xref="alg1.l23.m1.4.4.2.3"></times><ci id="alg1.l23.m1.4.4.2.4.cmml" xref="alg1.l23.m1.4.4.2.4">GlobalModelUpdate</ci><interval closure="open" id="alg1.l23.m1.4.4.2.2.3.cmml" xref="alg1.l23.m1.4.4.2.2.2"><apply id="alg1.l23.m1.3.3.1.1.1.1.cmml" xref="alg1.l23.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l23.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l23.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l23.m1.3.3.1.1.1.1.2">Ω</ci><ci id="alg1.l23.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l23.m1.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l23.m1.4.4.2.2.2.2.cmml" xref="alg1.l23.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l23.m1.4.4.2.2.2.2">subscript</csymbol><set id="alg1.l23.m1.4.4.2.2.2.2.1.2.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.1.1"><apply id="alg1.l23.m1.4.4.2.2.2.2.1.1.1.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l23.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.1.1.1.2">ℳ</ci><list id="alg1.l23.m1.2.2.2.3.cmml" xref="alg1.l23.m1.2.2.2.4"><ci id="alg1.l23.m1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1">𝑘</ci><ci id="alg1.l23.m1.2.2.2.2.cmml" xref="alg1.l23.m1.2.2.2.2">𝑖</ci></list></apply></set><apply id="alg1.l23.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.3"><in id="alg1.l23.m1.4.4.2.2.2.2.3.1.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.3.1"></in><ci id="alg1.l23.m1.4.4.2.2.2.2.3.2.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.3.2">𝑘</ci><apply id="alg1.l23.m1.4.4.2.2.2.2.3.3.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l23.m1.4.4.2.2.2.2.3.3.1.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.3.3">subscript</csymbol><ci id="alg1.l23.m1.4.4.2.2.2.2.3.3.2.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.3.3.2">𝑆</ci><ci id="alg1.l23.m1.4.4.2.2.2.2.3.3.3.cmml" xref="alg1.l23.m1.4.4.2.2.2.2.3.3.3">𝑟</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.4c">\Omega_{i}\leftarrow\mathrm{GlobalModelUpdate}(\Omega_{i},\{\mathcal{M}_{k,i}\}_{k\in S_{r}})</annotation></semantics></math>

</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>      <math id="alg1.l24.m1.4" class="ltx_Math" alttext="V_{i}\leftarrow\mathrm{GlobalOptimUpdate}(V_{i},\{V_{k,i}\}_{k\in S_{r}})" display="inline"><semantics id="alg1.l24.m1.4a"><mrow id="alg1.l24.m1.4.4" xref="alg1.l24.m1.4.4.cmml"><msub id="alg1.l24.m1.4.4.4" xref="alg1.l24.m1.4.4.4.cmml"><mi id="alg1.l24.m1.4.4.4.2" xref="alg1.l24.m1.4.4.4.2.cmml">V</mi><mi id="alg1.l24.m1.4.4.4.3" xref="alg1.l24.m1.4.4.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l24.m1.4.4.3" xref="alg1.l24.m1.4.4.3.cmml">←</mo><mrow id="alg1.l24.m1.4.4.2" xref="alg1.l24.m1.4.4.2.cmml"><mi id="alg1.l24.m1.4.4.2.4" xref="alg1.l24.m1.4.4.2.4.cmml">GlobalOptimUpdate</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.4.4.2.3" xref="alg1.l24.m1.4.4.2.3.cmml">​</mo><mrow id="alg1.l24.m1.4.4.2.2.2" xref="alg1.l24.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="alg1.l24.m1.4.4.2.2.2.3" xref="alg1.l24.m1.4.4.2.2.3.cmml">(</mo><msub id="alg1.l24.m1.3.3.1.1.1.1" xref="alg1.l24.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l24.m1.3.3.1.1.1.1.2" xref="alg1.l24.m1.3.3.1.1.1.1.2.cmml">V</mi><mi id="alg1.l24.m1.3.3.1.1.1.1.3" xref="alg1.l24.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l24.m1.4.4.2.2.2.4" xref="alg1.l24.m1.4.4.2.2.3.cmml">,</mo><msub id="alg1.l24.m1.4.4.2.2.2.2" xref="alg1.l24.m1.4.4.2.2.2.2.cmml"><mrow id="alg1.l24.m1.4.4.2.2.2.2.1.1" xref="alg1.l24.m1.4.4.2.2.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l24.m1.4.4.2.2.2.2.1.1.2" xref="alg1.l24.m1.4.4.2.2.2.2.1.2.cmml">{</mo><msub id="alg1.l24.m1.4.4.2.2.2.2.1.1.1" xref="alg1.l24.m1.4.4.2.2.2.2.1.1.1.cmml"><mi id="alg1.l24.m1.4.4.2.2.2.2.1.1.1.2" xref="alg1.l24.m1.4.4.2.2.2.2.1.1.1.2.cmml">V</mi><mrow id="alg1.l24.m1.2.2.2.4" xref="alg1.l24.m1.2.2.2.3.cmml"><mi id="alg1.l24.m1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l24.m1.2.2.2.4.1" xref="alg1.l24.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l24.m1.2.2.2.2" xref="alg1.l24.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg1.l24.m1.4.4.2.2.2.2.1.1.3" xref="alg1.l24.m1.4.4.2.2.2.2.1.2.cmml">}</mo></mrow><mrow id="alg1.l24.m1.4.4.2.2.2.2.3" xref="alg1.l24.m1.4.4.2.2.2.2.3.cmml"><mi id="alg1.l24.m1.4.4.2.2.2.2.3.2" xref="alg1.l24.m1.4.4.2.2.2.2.3.2.cmml">k</mi><mo id="alg1.l24.m1.4.4.2.2.2.2.3.1" xref="alg1.l24.m1.4.4.2.2.2.2.3.1.cmml">∈</mo><msub id="alg1.l24.m1.4.4.2.2.2.2.3.3" xref="alg1.l24.m1.4.4.2.2.2.2.3.3.cmml"><mi id="alg1.l24.m1.4.4.2.2.2.2.3.3.2" xref="alg1.l24.m1.4.4.2.2.2.2.3.3.2.cmml">S</mi><mi id="alg1.l24.m1.4.4.2.2.2.2.3.3.3" xref="alg1.l24.m1.4.4.2.2.2.2.3.3.3.cmml">r</mi></msub></mrow></msub><mo stretchy="false" id="alg1.l24.m1.4.4.2.2.2.5" xref="alg1.l24.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.4b"><apply id="alg1.l24.m1.4.4.cmml" xref="alg1.l24.m1.4.4"><ci id="alg1.l24.m1.4.4.3.cmml" xref="alg1.l24.m1.4.4.3">←</ci><apply id="alg1.l24.m1.4.4.4.cmml" xref="alg1.l24.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l24.m1.4.4.4.1.cmml" xref="alg1.l24.m1.4.4.4">subscript</csymbol><ci id="alg1.l24.m1.4.4.4.2.cmml" xref="alg1.l24.m1.4.4.4.2">𝑉</ci><ci id="alg1.l24.m1.4.4.4.3.cmml" xref="alg1.l24.m1.4.4.4.3">𝑖</ci></apply><apply id="alg1.l24.m1.4.4.2.cmml" xref="alg1.l24.m1.4.4.2"><times id="alg1.l24.m1.4.4.2.3.cmml" xref="alg1.l24.m1.4.4.2.3"></times><ci id="alg1.l24.m1.4.4.2.4.cmml" xref="alg1.l24.m1.4.4.2.4">GlobalOptimUpdate</ci><interval closure="open" id="alg1.l24.m1.4.4.2.2.3.cmml" xref="alg1.l24.m1.4.4.2.2.2"><apply id="alg1.l24.m1.3.3.1.1.1.1.cmml" xref="alg1.l24.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l24.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l24.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.2">𝑉</ci><ci id="alg1.l24.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l24.m1.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l24.m1.4.4.2.2.2.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l24.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2">subscript</csymbol><set id="alg1.l24.m1.4.4.2.2.2.2.1.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.1.1"><apply id="alg1.l24.m1.4.4.2.2.2.2.1.1.1.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l24.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.1.1.1.2">𝑉</ci><list id="alg1.l24.m1.2.2.2.3.cmml" xref="alg1.l24.m1.2.2.2.4"><ci id="alg1.l24.m1.1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1.1">𝑘</ci><ci id="alg1.l24.m1.2.2.2.2.cmml" xref="alg1.l24.m1.2.2.2.2">𝑖</ci></list></apply></set><apply id="alg1.l24.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.3"><in id="alg1.l24.m1.4.4.2.2.2.2.3.1.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.3.1"></in><ci id="alg1.l24.m1.4.4.2.2.2.2.3.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.3.2">𝑘</ci><apply id="alg1.l24.m1.4.4.2.2.2.2.3.3.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l24.m1.4.4.2.2.2.2.3.3.1.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.3.3">subscript</csymbol><ci id="alg1.l24.m1.4.4.2.2.2.2.3.3.2.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.3.3.2">𝑆</ci><ci id="alg1.l24.m1.4.4.2.2.2.2.3.3.3.cmml" xref="alg1.l24.m1.4.4.2.2.2.2.3.3.3">𝑟</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.4c">V_{i}\leftarrow\mathrm{GlobalOptimUpdate}(V_{i},\{V_{k,i}\}_{k\in S_{r}})</annotation></semantics></math>

</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span>   <span id="alg1.l25.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l25.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span><span id="alg1.l26.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l26.3" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</figure>
<div id="S3.SS1.p10" class="ltx_para">
<p id="S3.SS1.p10.4" class="ltx_p">As shown in Algorithm 1, MTFL runs rounds of communication until a given termination criteria (such as target UA) is met (Line 2). At each round, a subset <math id="S3.SS1.p10.1.m1.1" class="ltx_Math" alttext="S_{r}" display="inline"><semantics id="S3.SS1.p10.1.m1.1a"><msub id="S3.SS1.p10.1.m1.1.1" xref="S3.SS1.p10.1.m1.1.1.cmml"><mi id="S3.SS1.p10.1.m1.1.1.2" xref="S3.SS1.p10.1.m1.1.1.2.cmml">S</mi><mi id="S3.SS1.p10.1.m1.1.1.3" xref="S3.SS1.p10.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.1.m1.1b"><apply id="S3.SS1.p10.1.m1.1.1.cmml" xref="S3.SS1.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p10.1.m1.1.1.1.cmml" xref="S3.SS1.p10.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p10.1.m1.1.1.2.cmml" xref="S3.SS1.p10.1.m1.1.1.2">𝑆</ci><ci id="S3.SS1.p10.1.m1.1.1.3.cmml" xref="S3.SS1.p10.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.1.m1.1c">S_{r}</annotation></semantics></math> of clients are selected to participate from the set of all clients <math id="S3.SS1.p10.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.p10.2.m2.1a"><mi id="S3.SS1.p10.2.m2.1.1" xref="S3.SS1.p10.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.2.m2.1b"><ci id="S3.SS1.p10.2.m2.1.1.cmml" xref="S3.SS1.p10.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.2.m2.1c">S</annotation></semantics></math> (Line 3). These clients download the global model <math id="S3.SS1.p10.3.m3.1" class="ltx_Math" alttext="\Omega" display="inline"><semantics id="S3.SS1.p10.3.m3.1a"><mi mathvariant="normal" id="S3.SS1.p10.3.m3.1.1" xref="S3.SS1.p10.3.m3.1.1.cmml">Ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.3.m3.1b"><ci id="S3.SS1.p10.3.m3.1.1.cmml" xref="S3.SS1.p10.3.m3.1.1">Ω</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.3.m3.1c">\Omega</annotation></semantics></math>, which is a tuple of model parameters, and the global optimiser <math id="S3.SS1.p10.4.m4.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS1.p10.4.m4.1a"><mi id="S3.SS1.p10.4.m4.1.1" xref="S3.SS1.p10.4.m4.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.4.m4.1b"><ci id="S3.SS1.p10.4.m4.1.1.cmml" xref="S3.SS1.p10.4.m4.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.4.m4.1c">V</annotation></semantics></math>, if used (Lines 5-6). The clients then update their copy of the global model and optimiser with their private patch layers (Lines 7-9), where the ‘patchIdxs’ variable contains the indexes of patch layer placement in the DNN. Clients perform training using their now-personalised copy of the global model and optimiser on their local data (Line 10). Depending on the choice of FL optimisation strategy to be used within MTFL, the LocalUpdate function represents local training of the model. For FedAvg, LocalUpdate is simply minibatch-SGD. We discuss this, and the proposed FedAvg-Adam optimisation strategy, further in Section 3.3. After local training, the updated local patches are saved (Lines 11-13), and the non-patch layers and optimiser values are uploaded to the server (Lines 14-16).</p>
</div>
<div id="S3.SS1.p11" class="ltx_para">
<p id="S3.SS1.p11.1" class="ltx_p">At the end of the round, the server makes a new global model and optimiser according to the GlobalModelUpdate and GlobalOptimUpdate functions (Lines 18-20). These functions are again dependent on the FL optimisation strategy used, and are discussed further in Section 3.3. FedAvg, for example, uses a weighted average of client models for GlobalModelUpdate. The updated global model marks the end of the round and a new round is begun.</p>
</div>
<div id="S3.SS1.p12" class="ltx_para">
<p id="S3.SS1.p12.3" class="ltx_p"><span id="S3.SS1.p12.3.3" class="ltx_text" style="color:#000000;">The total per-round computation complexity of MTFL scales with <math id="S3.SS1.p12.1.1.m1.1" class="ltx_Math" alttext="|S_{r}|" display="inline"><semantics id="S3.SS1.p12.1.1.m1.1a"><mrow id="S3.SS1.p12.1.1.m1.1.1.1" xref="S3.SS1.p12.1.1.m1.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p12.1.1.m1.1.1.1.2" xref="S3.SS1.p12.1.1.m1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p12.1.1.m1.1.1.1.1" xref="S3.SS1.p12.1.1.m1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.p12.1.1.m1.1.1.1.1.2" xref="S3.SS1.p12.1.1.m1.1.1.1.1.2.cmml">S</mi><mi mathcolor="#000000" id="S3.SS1.p12.1.1.m1.1.1.1.1.3" xref="S3.SS1.p12.1.1.m1.1.1.1.1.3.cmml">r</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p12.1.1.m1.1.1.1.3" xref="S3.SS1.p12.1.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p12.1.1.m1.1b"><apply id="S3.SS1.p12.1.1.m1.1.1.2.cmml" xref="S3.SS1.p12.1.1.m1.1.1.1"><abs id="S3.SS1.p12.1.1.m1.1.1.2.1.cmml" xref="S3.SS1.p12.1.1.m1.1.1.1.2"></abs><apply id="S3.SS1.p12.1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p12.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p12.1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p12.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p12.1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p12.1.1.m1.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p12.1.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p12.1.1.m1.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p12.1.1.m1.1c">|S_{r}|</annotation></semantics></math>, where <math id="S3.SS1.p12.2.2.m2.1" class="ltx_Math" alttext="|S_{r}|" display="inline"><semantics id="S3.SS1.p12.2.2.m2.1a"><mrow id="S3.SS1.p12.2.2.m2.1.1.1" xref="S3.SS1.p12.2.2.m2.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p12.2.2.m2.1.1.1.2" xref="S3.SS1.p12.2.2.m2.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p12.2.2.m2.1.1.1.1" xref="S3.SS1.p12.2.2.m2.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.p12.2.2.m2.1.1.1.1.2" xref="S3.SS1.p12.2.2.m2.1.1.1.1.2.cmml">S</mi><mi mathcolor="#000000" id="S3.SS1.p12.2.2.m2.1.1.1.1.3" xref="S3.SS1.p12.2.2.m2.1.1.1.1.3.cmml">r</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p12.2.2.m2.1.1.1.3" xref="S3.SS1.p12.2.2.m2.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p12.2.2.m2.1b"><apply id="S3.SS1.p12.2.2.m2.1.1.2.cmml" xref="S3.SS1.p12.2.2.m2.1.1.1"><abs id="S3.SS1.p12.2.2.m2.1.1.2.1.cmml" xref="S3.SS1.p12.2.2.m2.1.1.1.2"></abs><apply id="S3.SS1.p12.2.2.m2.1.1.1.1.cmml" xref="S3.SS1.p12.2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p12.2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p12.2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p12.2.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p12.2.2.m2.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p12.2.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p12.2.2.m2.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p12.2.2.m2.1c">|S_{r}|</annotation></semantics></math> is the number of clients participating per round. The computation performed by each client is independent of the total number of clients. As clients perform local computation in parallel, MTFL (like FedAvg) is eminently scalable. Scalability is important in FL as real-world deployments are expected to have huge numbers of low-powered clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. The global model and optimiser updates (Lines 20-23 in Algorithm 1) depend on the optimisation strategy used. For FedAvg and FedAvg-Adam, GlobalModelUpdate is essentially map-reduce (averaging after local training) - also <math id="S3.SS1.p12.3.3.m3.1" class="ltx_Math" alttext="\mathcal{O}(|S_{r}|)" display="inline"><semantics id="S3.SS1.p12.3.3.m3.1a"><mrow id="S3.SS1.p12.3.3.m3.1.1" xref="S3.SS1.p12.3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS1.p12.3.3.m3.1.1.3" xref="S3.SS1.p12.3.3.m3.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p12.3.3.m3.1.1.2" xref="S3.SS1.p12.3.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS1.p12.3.3.m3.1.1.1.1" xref="S3.SS1.p12.3.3.m3.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p12.3.3.m3.1.1.1.1.2" xref="S3.SS1.p12.3.3.m3.1.1.cmml">(</mo><mrow id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.2.cmml">S</mi><mi mathcolor="#000000" id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.3" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo mathcolor="#000000" stretchy="false" id="S3.SS1.p12.3.3.m3.1.1.1.1.3" xref="S3.SS1.p12.3.3.m3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p12.3.3.m3.1b"><apply id="S3.SS1.p12.3.3.m3.1.1.cmml" xref="S3.SS1.p12.3.3.m3.1.1"><times id="S3.SS1.p12.3.3.m3.1.1.2.cmml" xref="S3.SS1.p12.3.3.m3.1.1.2"></times><ci id="S3.SS1.p12.3.3.m3.1.1.3.cmml" xref="S3.SS1.p12.3.3.m3.1.1.3">𝒪</ci><apply id="S3.SS1.p12.3.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1"><abs id="S3.SS1.p12.3.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.2"></abs><apply id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p12.3.3.m3.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p12.3.3.m3.1c">\mathcal{O}(|S_{r}|)</annotation></semantics></math>. For FedAdam, the Adam step following the map-reduce in GlobalOptimUpdate is not dependent on the number of clients (only on the DNN architecture).</span></p>
</div>
<div id="S3.SS1.p13" class="ltx_para">
<p id="S3.SS1.p13.1" class="ltx_p"><span id="S3.SS1.p13.1.1" class="ltx_text" style="color:#000000;">There are numerous works investigating FL in the Peer-To-Peer (p2p) setting, which we do not consider in this paper. Simple p2p FL algorithms involve sending all client models to all participating peers for decentralised aggregation. Extension of MTFL to these schemes is trivial: peers would simply just send/aggregate the non-private layers. More sophisticated p2p FL algorithms may require more complex ways of incorporating private layers – an interesting direction we leave for future works.</span></p>
</div>
<div id="S3.SS1.p14" class="ltx_para">
<p id="S3.SS1.p14.1" class="ltx_p">Mudrakarta <span id="S3.SS1.p14.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> showed that Batch Normalisation (BN) layers can act as model patches for MTL in the centralised setting. We show later that BN layers work well as patches in MTFL, considering that they are very lightweight in terms of number of parameters. BN layers are given by:</p>
</div>
<div id="S3.SS1.p15" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.19" class="ltx_Math" alttext="\begin{gathered}\hat{x}_{i}=\frac{z_{i}-\operatorname*{\mathbb{E}}(z_{i})}{\sqrt{\mathrm{Var}(z_{i})+\epsilon}}\\
\mathrm{BN}(\hat{x}_{i})=\gamma_{i}\hat{x}_{i}+\beta_{i}\end{gathered}" display="block"><semantics id="S3.E4.m1.19a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E4.m1.19.19.2" xref="S3.E4.m1.18.18.1.cmml"><mtr id="S3.E4.m1.19.19.2a" xref="S3.E4.m1.18.18.1.cmml"><mtd id="S3.E4.m1.19.19.2b" xref="S3.E4.m1.18.18.1.cmml"><mrow id="S3.E4.m1.4.4.4.4.4" xref="S3.E4.m1.18.18.1.cmml"><msub id="S3.E4.m1.4.4.4.4.4.5" xref="S3.E4.m1.18.18.1.cmml"><mover accent="true" id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mi id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo id="S3.E4.m1.3.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.3.3.cmml">=</mo><mfrac id="S3.E4.m1.4.4.4.4.4.4" xref="S3.E4.m1.4.4.4.4.4.4.cmml"><mrow id="S3.E4.m1.4.4.4.4.4.4.2" xref="S3.E4.m1.4.4.4.4.4.4.2.cmml"><msub id="S3.E4.m1.4.4.4.4.4.4.2.4" xref="S3.E4.m1.4.4.4.4.4.4.2.4.cmml"><mi id="S3.E4.m1.4.4.4.4.4.4.2.4.2" xref="S3.E4.m1.4.4.4.4.4.4.2.4.2.cmml">z</mi><mi id="S3.E4.m1.4.4.4.4.4.4.2.4.3" xref="S3.E4.m1.4.4.4.4.4.4.2.4.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.4.4.4.4.2.3" xref="S3.E4.m1.4.4.4.4.4.4.2.3.cmml">−</mo><mrow id="S3.E4.m1.4.4.4.4.4.4.2.2.1" xref="S3.E4.m1.4.4.4.4.4.4.2.2.2.cmml"><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.4.4.4.1.1" xref="S3.E4.m1.4.4.4.4.4.4.1.1.cmml">𝔼</mo><mrow id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1" xref="S3.E4.m1.4.4.4.4.4.4.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.2" xref="S3.E4.m1.4.4.4.4.4.4.2.2.2.cmml">(</mo><msub id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1" xref="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.cmml"><mi id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.2" xref="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.2.cmml">z</mi><mi id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.3" xref="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.3" xref="S3.E4.m1.4.4.4.4.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow><msqrt id="S3.E4.m1.4.4.4.4.4.4.3" xref="S3.E4.m1.4.4.4.4.4.4.3.cmml"><mrow id="S3.E4.m1.4.4.4.4.4.4.3.1.1" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.cmml"><mrow id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.cmml"><mi id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.3" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.3.cmml">Var</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.2" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.2" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.3" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.4.4.4.4.3.1.1.2" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.2.cmml">+</mo><mi id="S3.E4.m1.4.4.4.4.4.4.3.1.1.3" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.3.cmml">ϵ</mi></mrow></msqrt></mfrac></mrow></mtd></mtr><mtr id="S3.E4.m1.19.19.2c" xref="S3.E4.m1.18.18.1.cmml"><mtd id="S3.E4.m1.19.19.2d" xref="S3.E4.m1.18.18.1.cmml"><mrow id="S3.E4.m1.19.19.2.18.14.14" xref="S3.E4.m1.18.18.1.cmml"><mrow id="S3.E4.m1.19.19.2.18.14.14.14" xref="S3.E4.m1.18.18.1.cmml"><mi id="S3.E4.m1.5.5.5.1.1.1" xref="S3.E4.m1.5.5.5.1.1.1.cmml">BN</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.19.19.2.18.14.14.14.2" xref="S3.E4.m1.18.18.1a.cmml">​</mo><mrow id="S3.E4.m1.19.19.2.18.14.14.14.1.1" xref="S3.E4.m1.18.18.1.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.6.2.2.2" xref="S3.E4.m1.18.18.1a.cmml">(</mo><msub id="S3.E4.m1.19.19.2.18.14.14.14.1.1.1" xref="S3.E4.m1.18.18.1.cmml"><mover accent="true" id="S3.E4.m1.7.7.7.3.3.3" xref="S3.E4.m1.7.7.7.3.3.3.cmml"><mi id="S3.E4.m1.7.7.7.3.3.3.2" xref="S3.E4.m1.7.7.7.3.3.3.2.cmml">x</mi><mo id="S3.E4.m1.7.7.7.3.3.3.1" xref="S3.E4.m1.7.7.7.3.3.3.1.cmml">^</mo></mover><mi id="S3.E4.m1.8.8.8.4.4.4.1" xref="S3.E4.m1.8.8.8.4.4.4.1.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.9.9.9.5.5.5" xref="S3.E4.m1.18.18.1a.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.10.10.10.6.6.6" xref="S3.E4.m1.10.10.10.6.6.6.cmml">=</mo><mrow id="S3.E4.m1.19.19.2.18.14.14.15" xref="S3.E4.m1.18.18.1.cmml"><mrow id="S3.E4.m1.19.19.2.18.14.14.15.1" xref="S3.E4.m1.18.18.1.cmml"><msub id="S3.E4.m1.19.19.2.18.14.14.15.1.2" xref="S3.E4.m1.18.18.1.cmml"><mi id="S3.E4.m1.11.11.11.7.7.7" xref="S3.E4.m1.11.11.11.7.7.7.cmml">γ</mi><mi id="S3.E4.m1.12.12.12.8.8.8.1" xref="S3.E4.m1.12.12.12.8.8.8.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.19.19.2.18.14.14.15.1.1" xref="S3.E4.m1.18.18.1a.cmml">​</mo><msub id="S3.E4.m1.19.19.2.18.14.14.15.1.3" xref="S3.E4.m1.18.18.1.cmml"><mover accent="true" id="S3.E4.m1.13.13.13.9.9.9" xref="S3.E4.m1.13.13.13.9.9.9.cmml"><mi id="S3.E4.m1.13.13.13.9.9.9.2" xref="S3.E4.m1.13.13.13.9.9.9.2.cmml">x</mi><mo id="S3.E4.m1.13.13.13.9.9.9.1" xref="S3.E4.m1.13.13.13.9.9.9.1.cmml">^</mo></mover><mi id="S3.E4.m1.14.14.14.10.10.10.1" xref="S3.E4.m1.14.14.14.10.10.10.1.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.15.15.15.11.11.11" xref="S3.E4.m1.15.15.15.11.11.11.cmml">+</mo><msub id="S3.E4.m1.19.19.2.18.14.14.15.2" xref="S3.E4.m1.18.18.1.cmml"><mi id="S3.E4.m1.16.16.16.12.12.12" xref="S3.E4.m1.16.16.16.12.12.12.cmml">β</mi><mi id="S3.E4.m1.17.17.17.13.13.13.1" xref="S3.E4.m1.17.17.17.13.13.13.1.cmml">i</mi></msub></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.19b"><apply id="S3.E4.m1.18.18.1.cmml" xref="S3.E4.m1.19.19.2"><and id="S3.E4.m1.18.18.1a.cmml" xref="S3.E4.m1.19.19.2.18.14.14.14.2"></and><apply id="S3.E4.m1.18.18.1b.cmml" xref="S3.E4.m1.19.19.2"><eq id="S3.E4.m1.3.3.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.3.3"></eq><apply id="S3.E4.m1.18.18.1.3.cmml" xref="S3.E4.m1.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.18.18.1.3.1.cmml" xref="S3.E4.m1.19.19.2.18.14.14.14.2">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><ci id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1">^</ci><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝑥</ci></apply><ci id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E4.m1.18.18.1.1.cmml" xref="S3.E4.m1.19.19.2"><times id="S3.E4.m1.18.18.1.1.2.cmml" xref="S3.E4.m1.19.19.2.18.14.14.14.2"></times><apply id="S3.E4.m1.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4"><divide id="S3.E4.m1.4.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4"></divide><apply id="S3.E4.m1.4.4.4.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2"><minus id="S3.E4.m1.4.4.4.4.4.4.2.3.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.3"></minus><apply id="S3.E4.m1.4.4.4.4.4.4.2.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.4.4.2.4.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.4">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.4.4.2.4.2.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.4.2">𝑧</ci><ci id="S3.E4.m1.4.4.4.4.4.4.2.4.3.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.4.3">𝑖</ci></apply><apply id="S3.E4.m1.4.4.4.4.4.4.2.2.2.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.2.1"><ci id="S3.E4.m1.4.4.4.4.4.4.1.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.1.1">𝔼</ci><apply id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.2.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.2">𝑧</ci><ci id="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.3.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.4.4.4.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3"><root id="S3.E4.m1.4.4.4.4.4.4.3a.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3"></root><apply id="S3.E4.m1.4.4.4.4.4.4.3.1.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1"><plus id="S3.E4.m1.4.4.4.4.4.4.3.1.1.2.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.2"></plus><apply id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1"><times id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.2.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.2"></times><ci id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.3.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.3">Var</ci><apply id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S3.E4.m1.4.4.4.4.4.4.3.1.1.3.cmml" xref="S3.E4.m1.4.4.4.4.4.4.3.1.1.3">italic-ϵ</ci></apply></apply></apply><ci id="S3.E4.m1.5.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.5.1.1.1">BN</ci><apply id="S3.E4.m1.18.18.1.1.1.1.1.cmml" xref="S3.E4.m1.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.18.18.1.1.1.1.1.1.cmml" xref="S3.E4.m1.19.19.2">subscript</csymbol><apply id="S3.E4.m1.7.7.7.3.3.3.cmml" xref="S3.E4.m1.7.7.7.3.3.3"><ci id="S3.E4.m1.7.7.7.3.3.3.1.cmml" xref="S3.E4.m1.7.7.7.3.3.3.1">^</ci><ci id="S3.E4.m1.7.7.7.3.3.3.2.cmml" xref="S3.E4.m1.7.7.7.3.3.3.2">𝑥</ci></apply><ci id="S3.E4.m1.8.8.8.4.4.4.1.cmml" xref="S3.E4.m1.8.8.8.4.4.4.1">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.18.18.1c.cmml" xref="S3.E4.m1.19.19.2"><eq id="S3.E4.m1.10.10.10.6.6.6.cmml" xref="S3.E4.m1.10.10.10.6.6.6"></eq><share href="#S3.E4.m1.18.18.1.1.cmml" id="S3.E4.m1.18.18.1d.cmml" xref="S3.E4.m1.19.19.2.18.14.14.14.2"></share><apply id="S3.E4.m1.18.18.1.6.cmml" xref="S3.E4.m1.19.19.2"><plus id="S3.E4.m1.15.15.15.11.11.11.cmml" xref="S3.E4.m1.15.15.15.11.11.11"></plus><apply id="S3.E4.m1.18.18.1.6.2.cmml" xref="S3.E4.m1.19.19.2"><times id="S3.E4.m1.18.18.1.6.2.1.cmml" xref="S3.E4.m1.19.19.2.18.14.14.14.2"></times><apply id="S3.E4.m1.18.18.1.6.2.2.cmml" xref="S3.E4.m1.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.18.18.1.6.2.2.1.cmml" xref="S3.E4.m1.19.19.2.18.14.14.14.2">subscript</csymbol><ci id="S3.E4.m1.11.11.11.7.7.7.cmml" xref="S3.E4.m1.11.11.11.7.7.7">𝛾</ci><ci id="S3.E4.m1.12.12.12.8.8.8.1.cmml" xref="S3.E4.m1.12.12.12.8.8.8.1">𝑖</ci></apply><apply id="S3.E4.m1.18.18.1.6.2.3.cmml" xref="S3.E4.m1.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.18.18.1.6.2.3.1.cmml" xref="S3.E4.m1.19.19.2.18.14.14.14.2">subscript</csymbol><apply id="S3.E4.m1.13.13.13.9.9.9.cmml" xref="S3.E4.m1.13.13.13.9.9.9"><ci id="S3.E4.m1.13.13.13.9.9.9.1.cmml" xref="S3.E4.m1.13.13.13.9.9.9.1">^</ci><ci id="S3.E4.m1.13.13.13.9.9.9.2.cmml" xref="S3.E4.m1.13.13.13.9.9.9.2">𝑥</ci></apply><ci id="S3.E4.m1.14.14.14.10.10.10.1.cmml" xref="S3.E4.m1.14.14.14.10.10.10.1">𝑖</ci></apply></apply><apply id="S3.E4.m1.18.18.1.6.3.cmml" xref="S3.E4.m1.19.19.2"><csymbol cd="ambiguous" id="S3.E4.m1.18.18.1.6.3.1.cmml" xref="S3.E4.m1.19.19.2.18.14.14.14.2">subscript</csymbol><ci id="S3.E4.m1.16.16.16.12.12.12.cmml" xref="S3.E4.m1.16.16.16.12.12.12">𝛽</ci><ci id="S3.E4.m1.17.17.17.13.13.13.1.cmml" xref="S3.E4.m1.17.17.17.13.13.13.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.19c">\begin{gathered}\hat{x}_{i}=\frac{z_{i}-\operatorname*{\mathbb{E}}(z_{i})}{\sqrt{\mathrm{Var}(z_{i})+\epsilon}}\\
\mathrm{BN}(\hat{x}_{i})=\gamma_{i}\hat{x}_{i}+\beta_{i}\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p16" class="ltx_para ltx_noindent">
<p id="S3.SS1.p16.11" class="ltx_p">where <math id="S3.SS1.p16.1.m1.2" class="ltx_Math" alttext="\operatorname*{\mathbb{E}}(z_{i})" display="inline"><semantics id="S3.SS1.p16.1.m1.2a"><mrow id="S3.SS1.p16.1.m1.2.2.1" xref="S3.SS1.p16.1.m1.2.2.2.cmml"><mo rspace="0em" id="S3.SS1.p16.1.m1.1.1" xref="S3.SS1.p16.1.m1.1.1.cmml">𝔼</mo><mrow id="S3.SS1.p16.1.m1.2.2.1.1" xref="S3.SS1.p16.1.m1.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p16.1.m1.2.2.1.1.2" xref="S3.SS1.p16.1.m1.2.2.2.cmml">(</mo><msub id="S3.SS1.p16.1.m1.2.2.1.1.1" xref="S3.SS1.p16.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p16.1.m1.2.2.1.1.1.2" xref="S3.SS1.p16.1.m1.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS1.p16.1.m1.2.2.1.1.1.3" xref="S3.SS1.p16.1.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p16.1.m1.2.2.1.1.3" xref="S3.SS1.p16.1.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.1.m1.2b"><apply id="S3.SS1.p16.1.m1.2.2.2.cmml" xref="S3.SS1.p16.1.m1.2.2.1"><ci id="S3.SS1.p16.1.m1.1.1.cmml" xref="S3.SS1.p16.1.m1.1.1">𝔼</ci><apply id="S3.SS1.p16.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p16.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p16.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p16.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p16.1.m1.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS1.p16.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p16.1.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.1.m1.2c">\operatorname*{\mathbb{E}}(z_{i})</annotation></semantics></math> and <math id="S3.SS1.p16.2.m2.1" class="ltx_Math" alttext="\mathrm{Var}(z_{i})" display="inline"><semantics id="S3.SS1.p16.2.m2.1a"><mrow id="S3.SS1.p16.2.m2.1.1" xref="S3.SS1.p16.2.m2.1.1.cmml"><mi id="S3.SS1.p16.2.m2.1.1.3" xref="S3.SS1.p16.2.m2.1.1.3.cmml">Var</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p16.2.m2.1.1.2" xref="S3.SS1.p16.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS1.p16.2.m2.1.1.1.1" xref="S3.SS1.p16.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p16.2.m2.1.1.1.1.2" xref="S3.SS1.p16.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p16.2.m2.1.1.1.1.1" xref="S3.SS1.p16.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p16.2.m2.1.1.1.1.1.2" xref="S3.SS1.p16.2.m2.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS1.p16.2.m2.1.1.1.1.1.3" xref="S3.SS1.p16.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p16.2.m2.1.1.1.1.3" xref="S3.SS1.p16.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.2.m2.1b"><apply id="S3.SS1.p16.2.m2.1.1.cmml" xref="S3.SS1.p16.2.m2.1.1"><times id="S3.SS1.p16.2.m2.1.1.2.cmml" xref="S3.SS1.p16.2.m2.1.1.2"></times><ci id="S3.SS1.p16.2.m2.1.1.3.cmml" xref="S3.SS1.p16.2.m2.1.1.3">Var</ci><apply id="S3.SS1.p16.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p16.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p16.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p16.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p16.2.m2.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS1.p16.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p16.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.2.m2.1c">\mathrm{Var}(z_{i})</annotation></semantics></math> are the mean and variance of a neuron’s activations (<math id="S3.SS1.p16.3.m3.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS1.p16.3.m3.1a"><msub id="S3.SS1.p16.3.m3.1.1" xref="S3.SS1.p16.3.m3.1.1.cmml"><mi id="S3.SS1.p16.3.m3.1.1.2" xref="S3.SS1.p16.3.m3.1.1.2.cmml">z</mi><mi id="S3.SS1.p16.3.m3.1.1.3" xref="S3.SS1.p16.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.3.m3.1b"><apply id="S3.SS1.p16.3.m3.1.1.cmml" xref="S3.SS1.p16.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.3.m3.1.1.1.cmml" xref="S3.SS1.p16.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p16.3.m3.1.1.2.cmml" xref="S3.SS1.p16.3.m3.1.1.2">𝑧</ci><ci id="S3.SS1.p16.3.m3.1.1.3.cmml" xref="S3.SS1.p16.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.3.m3.1c">z_{i}</annotation></semantics></math>, post-nonlinearity) across a minibatch, and <math id="S3.SS1.p16.4.m4.1" class="ltx_Math" alttext="\gamma_{i}" display="inline"><semantics id="S3.SS1.p16.4.m4.1a"><msub id="S3.SS1.p16.4.m4.1.1" xref="S3.SS1.p16.4.m4.1.1.cmml"><mi id="S3.SS1.p16.4.m4.1.1.2" xref="S3.SS1.p16.4.m4.1.1.2.cmml">γ</mi><mi id="S3.SS1.p16.4.m4.1.1.3" xref="S3.SS1.p16.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.4.m4.1b"><apply id="S3.SS1.p16.4.m4.1.1.cmml" xref="S3.SS1.p16.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.4.m4.1.1.1.cmml" xref="S3.SS1.p16.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p16.4.m4.1.1.2.cmml" xref="S3.SS1.p16.4.m4.1.1.2">𝛾</ci><ci id="S3.SS1.p16.4.m4.1.1.3.cmml" xref="S3.SS1.p16.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.4.m4.1c">\gamma_{i}</annotation></semantics></math> and <math id="S3.SS1.p16.5.m5.1" class="ltx_Math" alttext="\beta_{i}" display="inline"><semantics id="S3.SS1.p16.5.m5.1a"><msub id="S3.SS1.p16.5.m5.1.1" xref="S3.SS1.p16.5.m5.1.1.cmml"><mi id="S3.SS1.p16.5.m5.1.1.2" xref="S3.SS1.p16.5.m5.1.1.2.cmml">β</mi><mi id="S3.SS1.p16.5.m5.1.1.3" xref="S3.SS1.p16.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.5.m5.1b"><apply id="S3.SS1.p16.5.m5.1.1.cmml" xref="S3.SS1.p16.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.5.m5.1.1.1.cmml" xref="S3.SS1.p16.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p16.5.m5.1.1.2.cmml" xref="S3.SS1.p16.5.m5.1.1.2">𝛽</ci><ci id="S3.SS1.p16.5.m5.1.1.3.cmml" xref="S3.SS1.p16.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.5.m5.1c">\beta_{i}</annotation></semantics></math> are parameters learned during training. BN layers track a weighted moving average of <math id="S3.SS1.p16.6.m6.2" class="ltx_Math" alttext="\operatorname*{\mathbb{E}}(z_{i})" display="inline"><semantics id="S3.SS1.p16.6.m6.2a"><mrow id="S3.SS1.p16.6.m6.2.2.1" xref="S3.SS1.p16.6.m6.2.2.2.cmml"><mo rspace="0em" id="S3.SS1.p16.6.m6.1.1" xref="S3.SS1.p16.6.m6.1.1.cmml">𝔼</mo><mrow id="S3.SS1.p16.6.m6.2.2.1.1" xref="S3.SS1.p16.6.m6.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p16.6.m6.2.2.1.1.2" xref="S3.SS1.p16.6.m6.2.2.2.cmml">(</mo><msub id="S3.SS1.p16.6.m6.2.2.1.1.1" xref="S3.SS1.p16.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.p16.6.m6.2.2.1.1.1.2" xref="S3.SS1.p16.6.m6.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS1.p16.6.m6.2.2.1.1.1.3" xref="S3.SS1.p16.6.m6.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p16.6.m6.2.2.1.1.3" xref="S3.SS1.p16.6.m6.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.6.m6.2b"><apply id="S3.SS1.p16.6.m6.2.2.2.cmml" xref="S3.SS1.p16.6.m6.2.2.1"><ci id="S3.SS1.p16.6.m6.1.1.cmml" xref="S3.SS1.p16.6.m6.1.1">𝔼</ci><apply id="S3.SS1.p16.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.p16.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p16.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p16.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p16.6.m6.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS1.p16.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS1.p16.6.m6.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.6.m6.2c">\operatorname*{\mathbb{E}}(z_{i})</annotation></semantics></math> and <math id="S3.SS1.p16.7.m7.1" class="ltx_Math" alttext="\mathrm{Var}(z_{i})" display="inline"><semantics id="S3.SS1.p16.7.m7.1a"><mrow id="S3.SS1.p16.7.m7.1.1" xref="S3.SS1.p16.7.m7.1.1.cmml"><mi id="S3.SS1.p16.7.m7.1.1.3" xref="S3.SS1.p16.7.m7.1.1.3.cmml">Var</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p16.7.m7.1.1.2" xref="S3.SS1.p16.7.m7.1.1.2.cmml">​</mo><mrow id="S3.SS1.p16.7.m7.1.1.1.1" xref="S3.SS1.p16.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p16.7.m7.1.1.1.1.2" xref="S3.SS1.p16.7.m7.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p16.7.m7.1.1.1.1.1" xref="S3.SS1.p16.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS1.p16.7.m7.1.1.1.1.1.2" xref="S3.SS1.p16.7.m7.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS1.p16.7.m7.1.1.1.1.1.3" xref="S3.SS1.p16.7.m7.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p16.7.m7.1.1.1.1.3" xref="S3.SS1.p16.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.7.m7.1b"><apply id="S3.SS1.p16.7.m7.1.1.cmml" xref="S3.SS1.p16.7.m7.1.1"><times id="S3.SS1.p16.7.m7.1.1.2.cmml" xref="S3.SS1.p16.7.m7.1.1.2"></times><ci id="S3.SS1.p16.7.m7.1.1.3.cmml" xref="S3.SS1.p16.7.m7.1.1.3">Var</ci><apply id="S3.SS1.p16.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.p16.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p16.7.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p16.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.p16.7.m7.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS1.p16.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS1.p16.7.m7.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.7.m7.1c">\mathrm{Var}(z_{i})</annotation></semantics></math> during training: <math id="S3.SS1.p16.8.m8.1" class="ltx_Math" alttext="\mu_{i}" display="inline"><semantics id="S3.SS1.p16.8.m8.1a"><msub id="S3.SS1.p16.8.m8.1.1" xref="S3.SS1.p16.8.m8.1.1.cmml"><mi id="S3.SS1.p16.8.m8.1.1.2" xref="S3.SS1.p16.8.m8.1.1.2.cmml">μ</mi><mi id="S3.SS1.p16.8.m8.1.1.3" xref="S3.SS1.p16.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.8.m8.1b"><apply id="S3.SS1.p16.8.m8.1.1.cmml" xref="S3.SS1.p16.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.8.m8.1.1.1.cmml" xref="S3.SS1.p16.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p16.8.m8.1.1.2.cmml" xref="S3.SS1.p16.8.m8.1.1.2">𝜇</ci><ci id="S3.SS1.p16.8.m8.1.1.3.cmml" xref="S3.SS1.p16.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.8.m8.1c">\mu_{i}</annotation></semantics></math> and <math id="S3.SS1.p16.9.m9.1" class="ltx_Math" alttext="\sigma_{i}^{2}" display="inline"><semantics id="S3.SS1.p16.9.m9.1a"><msubsup id="S3.SS1.p16.9.m9.1.1" xref="S3.SS1.p16.9.m9.1.1.cmml"><mi id="S3.SS1.p16.9.m9.1.1.2.2" xref="S3.SS1.p16.9.m9.1.1.2.2.cmml">σ</mi><mi id="S3.SS1.p16.9.m9.1.1.2.3" xref="S3.SS1.p16.9.m9.1.1.2.3.cmml">i</mi><mn id="S3.SS1.p16.9.m9.1.1.3" xref="S3.SS1.p16.9.m9.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.9.m9.1b"><apply id="S3.SS1.p16.9.m9.1.1.cmml" xref="S3.SS1.p16.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.9.m9.1.1.1.cmml" xref="S3.SS1.p16.9.m9.1.1">superscript</csymbol><apply id="S3.SS1.p16.9.m9.1.1.2.cmml" xref="S3.SS1.p16.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p16.9.m9.1.1.2.1.cmml" xref="S3.SS1.p16.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p16.9.m9.1.1.2.2.cmml" xref="S3.SS1.p16.9.m9.1.1.2.2">𝜎</ci><ci id="S3.SS1.p16.9.m9.1.1.2.3.cmml" xref="S3.SS1.p16.9.m9.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS1.p16.9.m9.1.1.3.cmml" xref="S3.SS1.p16.9.m9.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.9.m9.1c">\sigma_{i}^{2}</annotation></semantics></math>, for use at inference time. In Section 4 we investigate the benefit of keeping statistics <math id="S3.SS1.p16.10.m10.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S3.SS1.p16.10.m10.2a"><mrow id="S3.SS1.p16.10.m10.2.3.2" xref="S3.SS1.p16.10.m10.2.3.1.cmml"><mi id="S3.SS1.p16.10.m10.1.1" xref="S3.SS1.p16.10.m10.1.1.cmml">μ</mi><mo id="S3.SS1.p16.10.m10.2.3.2.1" xref="S3.SS1.p16.10.m10.2.3.1.cmml">,</mo><mi id="S3.SS1.p16.10.m10.2.2" xref="S3.SS1.p16.10.m10.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.10.m10.2b"><list id="S3.SS1.p16.10.m10.2.3.1.cmml" xref="S3.SS1.p16.10.m10.2.3.2"><ci id="S3.SS1.p16.10.m10.1.1.cmml" xref="S3.SS1.p16.10.m10.1.1">𝜇</ci><ci id="S3.SS1.p16.10.m10.2.2.cmml" xref="S3.SS1.p16.10.m10.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.10.m10.2c">\mu,\sigma</annotation></semantics></math> and/or trainable parameters <math id="S3.SS1.p16.11.m11.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S3.SS1.p16.11.m11.2a"><mrow id="S3.SS1.p16.11.m11.2.3.2" xref="S3.SS1.p16.11.m11.2.3.1.cmml"><mi id="S3.SS1.p16.11.m11.1.1" xref="S3.SS1.p16.11.m11.1.1.cmml">γ</mi><mo id="S3.SS1.p16.11.m11.2.3.2.1" xref="S3.SS1.p16.11.m11.2.3.1.cmml">,</mo><mi id="S3.SS1.p16.11.m11.2.2" xref="S3.SS1.p16.11.m11.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p16.11.m11.2b"><list id="S3.SS1.p16.11.m11.2.3.1.cmml" xref="S3.SS1.p16.11.m11.2.3.2"><ci id="S3.SS1.p16.11.m11.1.1.cmml" xref="S3.SS1.p16.11.m11.1.1">𝛾</ci><ci id="S3.SS1.p16.11.m11.2.2.cmml" xref="S3.SS1.p16.11.m11.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p16.11.m11.2c">\gamma,\beta</annotation></semantics></math> as part of private patch layers.</p>
</div>
<div id="S3.SS1.p17" class="ltx_para">
<p id="S3.SS1.p17.1" class="ltx_p"><span id="S3.SS1.p17.1.1" class="ltx_text" style="color:#000000;">We have chosen to use BN layers for personalisation within MTFL. The reason for this choice is twofold: 1) they show excellent personalisation performance and 2) the storage cost of BN parameters is very small (<math id="S3.SS1.p17.1.1.m1.1" class="ltx_Math" alttext="&lt;1\%" display="inline"><semantics id="S3.SS1.p17.1.1.m1.1a"><mrow id="S3.SS1.p17.1.1.m1.1.1" xref="S3.SS1.p17.1.1.m1.1.1.cmml"><mi id="S3.SS1.p17.1.1.m1.1.1.2" xref="S3.SS1.p17.1.1.m1.1.1.2.cmml"></mi><mo mathcolor="#000000" id="S3.SS1.p17.1.1.m1.1.1.1" xref="S3.SS1.p17.1.1.m1.1.1.1.cmml">&lt;</mo><mrow id="S3.SS1.p17.1.1.m1.1.1.3" xref="S3.SS1.p17.1.1.m1.1.1.3.cmml"><mn mathcolor="#000000" id="S3.SS1.p17.1.1.m1.1.1.3.2" xref="S3.SS1.p17.1.1.m1.1.1.3.2.cmml">1</mn><mo mathcolor="#000000" id="S3.SS1.p17.1.1.m1.1.1.3.1" xref="S3.SS1.p17.1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p17.1.1.m1.1b"><apply id="S3.SS1.p17.1.1.m1.1.1.cmml" xref="S3.SS1.p17.1.1.m1.1.1"><lt id="S3.SS1.p17.1.1.m1.1.1.1.cmml" xref="S3.SS1.p17.1.1.m1.1.1.1"></lt><csymbol cd="latexml" id="S3.SS1.p17.1.1.m1.1.1.2.cmml" xref="S3.SS1.p17.1.1.m1.1.1.2">absent</csymbol><apply id="S3.SS1.p17.1.1.m1.1.1.3.cmml" xref="S3.SS1.p17.1.1.m1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p17.1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p17.1.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S3.SS1.p17.1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p17.1.1.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p17.1.1.m1.1c">&lt;1\%</annotation></semantics></math> of total model size for the tested model architectures). Mudrakarta <span id="S3.SS1.p17.1.1.1" class="ltx_text ltx_font_italic">et al</span>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> also investigated the use of depthwise-convolutional patches for centralised Multi-Task learning. Any model layers could in principle be kept private during MTFL, however, there is an inherent trade-off between the number of parameters kept private and the ability of the global model to converge.</span></p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span id="S3.SS2.1.1" class="ltx_text ltx_font_italic">Effect of BN Patches on Inference</span>
</h3>

<figure id="S3.F3" class="ltx_figure"><img src="/html/2007.09236/assets/bn-demo-graphs.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="479" height="643" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>(a) Federated Learning (FL) results in an accuracy curve where the UA decreases after aggregations and increases during local training, compared with the smoother accuracy curve when training independently (Ind). (b) Patch BN-layers help bring the distribution in outputs for neuron <math id="S3.F3.2.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.F3.2.m1.1b"><mi id="S3.F3.2.m1.1.1" xref="S3.F3.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.F3.2.m1.1c"><ci id="S3.F3.2.m1.1.1.cmml" xref="S3.F3.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.m1.1d">i</annotation></semantics></math> closer to the pre-aggregation distributions.</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">To understand the impact that BN-patch layers have on UA, we consider the change in internal DNN activations over a client’s local test-set immediately <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_italic">before</span> and immediately <span id="S3.SS2.p1.1.2" class="ltx_text ltx_font_italic">after</span> the FL aggregation step.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.3" class="ltx_p">As illustrated in Fig. 3 (a), UA typically drops after the aggregation step in iterative FL. This is because the model has been tuned on the local training set for several epochs, and suddenly has its model weights replaced by the Federated weights, which are unlikely to have better test performance than the pre-aggregation model. This idea is further examined in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> and showed later in our experimental section. Consider a simple DNN consisting of dense layers followed by BN and then nonlinearities. The vector of first-layer neuron activations over the client’s test-set (<math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">X</annotation></semantics></math>) from applying weights and biases (<math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="W_{0}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">W</mi><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝑊</ci><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">W_{0}</annotation></semantics></math>, <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="b_{0}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">b</mi><mn id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑏</ci><cn type="integer" id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">b_{0}</annotation></semantics></math>), can be modelled as a normal distribution, which BN relies on to work:</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.37" class="ltx_Math" alttext="\begin{gathered}{\color[rgb]{0,0,0}z_{i}\triangleq[W_{0}X+b_{0}]_{i}}\\
{\color[rgb]{0,0,0}z_{i}\sim N(\operatorname*{\mathbb{E}}[z_{i}],Var[z_{i}])}\end{gathered}" display="block"><semantics id="S3.E5.m1.37a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E5.m1.37.37.6" xref="S3.E5.m1.34.34.3.cmml"><mtr id="S3.E5.m1.37.37.6a" xref="S3.E5.m1.34.34.3.cmml"><mtd id="S3.E5.m1.37.37.6b" xref="S3.E5.m1.34.34.3.cmml"><mrow id="S3.E5.m1.35.35.4.32.13.13" xref="S3.E5.m1.34.34.3.cmml"><msub id="S3.E5.m1.35.35.4.32.13.13.14" xref="S3.E5.m1.34.34.3.cmml"><mi mathcolor="#000000" id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">z</mi><mi mathcolor="#000000" id="S3.E5.m1.2.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.cmml">≜</mo><msub id="S3.E5.m1.35.35.4.32.13.13.13" xref="S3.E5.m1.34.34.3.cmml"><mrow id="S3.E5.m1.35.35.4.32.13.13.13.1.1" xref="S3.E5.m1.34.34.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E5.m1.4.4.4.4.4.4" xref="S3.E5.m1.34.34.3a.cmml">[</mo><mrow id="S3.E5.m1.35.35.4.32.13.13.13.1.1.1" xref="S3.E5.m1.34.34.3.cmml"><mrow id="S3.E5.m1.35.35.4.32.13.13.13.1.1.1.1" xref="S3.E5.m1.34.34.3.cmml"><msub id="S3.E5.m1.35.35.4.32.13.13.13.1.1.1.1.2" xref="S3.E5.m1.34.34.3.cmml"><mi mathcolor="#000000" id="S3.E5.m1.5.5.5.5.5.5" xref="S3.E5.m1.5.5.5.5.5.5.cmml">W</mi><mn mathcolor="#000000" id="S3.E5.m1.6.6.6.6.6.6.1" xref="S3.E5.m1.6.6.6.6.6.6.1.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.35.35.4.32.13.13.13.1.1.1.1.1" xref="S3.E5.m1.34.34.3a.cmml">​</mo><mi mathcolor="#000000" id="S3.E5.m1.7.7.7.7.7.7" xref="S3.E5.m1.7.7.7.7.7.7.cmml">X</mi></mrow><mo mathcolor="#000000" id="S3.E5.m1.8.8.8.8.8.8" xref="S3.E5.m1.8.8.8.8.8.8.cmml">+</mo><msub id="S3.E5.m1.35.35.4.32.13.13.13.1.1.1.2" xref="S3.E5.m1.34.34.3.cmml"><mi mathcolor="#000000" id="S3.E5.m1.9.9.9.9.9.9" xref="S3.E5.m1.9.9.9.9.9.9.cmml">b</mi><mn mathcolor="#000000" id="S3.E5.m1.10.10.10.10.10.10.1" xref="S3.E5.m1.10.10.10.10.10.10.1.cmml">0</mn></msub></mrow><mo mathcolor="#000000" stretchy="false" id="S3.E5.m1.11.11.11.11.11.11" xref="S3.E5.m1.34.34.3a.cmml">]</mo></mrow><mi mathcolor="#000000" id="S3.E5.m1.12.12.12.12.12.12.1" xref="S3.E5.m1.12.12.12.12.12.12.1.cmml">i</mi></msub></mrow></mtd></mtr><mtr id="S3.E5.m1.37.37.6c" xref="S3.E5.m1.34.34.3.cmml"><mtd id="S3.E5.m1.37.37.6d" xref="S3.E5.m1.34.34.3.cmml"><mrow id="S3.E5.m1.37.37.6.34.21.21" xref="S3.E5.m1.34.34.3.cmml"><msub id="S3.E5.m1.37.37.6.34.21.21.22" xref="S3.E5.m1.34.34.3.cmml"><mi mathcolor="#000000" id="S3.E5.m1.13.13.13.1.1.1" xref="S3.E5.m1.13.13.13.1.1.1.cmml">z</mi><mi mathcolor="#000000" id="S3.E5.m1.14.14.14.2.2.2.1" xref="S3.E5.m1.14.14.14.2.2.2.1.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E5.m1.15.15.15.3.3.3" xref="S3.E5.m1.15.15.15.3.3.3.cmml">∼</mo><mrow id="S3.E5.m1.37.37.6.34.21.21.21" xref="S3.E5.m1.34.34.3.cmml"><mi mathcolor="#000000" id="S3.E5.m1.16.16.16.4.4.4" xref="S3.E5.m1.16.16.16.4.4.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.37.37.6.34.21.21.21.3" xref="S3.E5.m1.34.34.3a.cmml">​</mo><mrow id="S3.E5.m1.37.37.6.34.21.21.21.2.2" xref="S3.E5.m1.34.34.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E5.m1.17.17.17.5.5.5" xref="S3.E5.m1.34.34.3a.cmml">(</mo><mrow id="S3.E5.m1.36.36.5.33.20.20.20.1.1.1" xref="S3.E5.m1.34.34.3.cmml"><mo lspace="0em" mathcolor="#000000" rspace="0em" id="S3.E5.m1.18.18.18.6.6.6" xref="S3.E5.m1.18.18.18.6.6.6.cmml">𝔼</mo><mrow id="S3.E5.m1.36.36.5.33.20.20.20.1.1.1.1.1" xref="S3.E5.m1.34.34.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E5.m1.19.19.19.7.7.7" xref="S3.E5.m1.34.34.3a.cmml">[</mo><msub id="S3.E5.m1.36.36.5.33.20.20.20.1.1.1.1.1.1" xref="S3.E5.m1.34.34.3.cmml"><mi mathcolor="#000000" id="S3.E5.m1.20.20.20.8.8.8" xref="S3.E5.m1.20.20.20.8.8.8.cmml">z</mi><mi mathcolor="#000000" id="S3.E5.m1.21.21.21.9.9.9.1" xref="S3.E5.m1.21.21.21.9.9.9.1.cmml">i</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.E5.m1.22.22.22.10.10.10" xref="S3.E5.m1.34.34.3a.cmml">]</mo></mrow></mrow><mo mathcolor="#000000" id="S3.E5.m1.23.23.23.11.11.11" xref="S3.E5.m1.34.34.3a.cmml">,</mo><mrow id="S3.E5.m1.37.37.6.34.21.21.21.2.2.2" xref="S3.E5.m1.34.34.3.cmml"><mi mathcolor="#000000" id="S3.E5.m1.24.24.24.12.12.12" xref="S3.E5.m1.24.24.24.12.12.12.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.37.37.6.34.21.21.21.2.2.2.2" xref="S3.E5.m1.34.34.3a.cmml">​</mo><mi mathcolor="#000000" id="S3.E5.m1.25.25.25.13.13.13" xref="S3.E5.m1.25.25.25.13.13.13.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.37.37.6.34.21.21.21.2.2.2.2a" xref="S3.E5.m1.34.34.3a.cmml">​</mo><mi mathcolor="#000000" id="S3.E5.m1.26.26.26.14.14.14" xref="S3.E5.m1.26.26.26.14.14.14.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.37.37.6.34.21.21.21.2.2.2.2b" xref="S3.E5.m1.34.34.3a.cmml">​</mo><mrow id="S3.E5.m1.37.37.6.34.21.21.21.2.2.2.1.1" xref="S3.E5.m1.34.34.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E5.m1.27.27.27.15.15.15" xref="S3.E5.m1.34.34.3a.cmml">[</mo><msub id="S3.E5.m1.37.37.6.34.21.21.21.2.2.2.1.1.1" xref="S3.E5.m1.34.34.3.cmml"><mi mathcolor="#000000" id="S3.E5.m1.28.28.28.16.16.16" xref="S3.E5.m1.28.28.28.16.16.16.cmml">z</mi><mi mathcolor="#000000" id="S3.E5.m1.29.29.29.17.17.17.1" xref="S3.E5.m1.29.29.29.17.17.17.1.cmml">i</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.E5.m1.30.30.30.18.18.18" xref="S3.E5.m1.34.34.3a.cmml">]</mo></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S3.E5.m1.31.31.31.19.19.19" xref="S3.E5.m1.34.34.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.37b"><apply id="S3.E5.m1.34.34.3.cmml" xref="S3.E5.m1.37.37.6"><and id="S3.E5.m1.34.34.3a.cmml" xref="S3.E5.m1.4.4.4.4.4.4"></and><apply id="S3.E5.m1.34.34.3b.cmml" xref="S3.E5.m1.37.37.6"><ci id="S3.E5.m1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3">≜</ci><apply id="S3.E5.m1.34.34.3.5.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="ambiguous" id="S3.E5.m1.34.34.3.5.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">𝑧</ci><ci id="S3.E5.m1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E5.m1.32.32.1.1.cmml" xref="S3.E5.m1.37.37.6"><times id="S3.E5.m1.32.32.1.1.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4"></times><apply id="S3.E5.m1.32.32.1.1.1.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="ambiguous" id="S3.E5.m1.32.32.1.1.1.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S3.E5.m1.32.32.1.1.1.1.2.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="latexml" id="S3.E5.m1.32.32.1.1.1.1.2.1.cmml" xref="S3.E5.m1.37.37.6">delimited-[]</csymbol><apply id="S3.E5.m1.32.32.1.1.1.1.1.1.cmml" xref="S3.E5.m1.37.37.6"><plus id="S3.E5.m1.8.8.8.8.8.8.cmml" xref="S3.E5.m1.8.8.8.8.8.8"></plus><apply id="S3.E5.m1.32.32.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.37.37.6"><times id="S3.E5.m1.32.32.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.37.37.6"></times><apply id="S3.E5.m1.32.32.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="ambiguous" id="S3.E5.m1.32.32.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.37.37.6">subscript</csymbol><ci id="S3.E5.m1.5.5.5.5.5.5.cmml" xref="S3.E5.m1.5.5.5.5.5.5">𝑊</ci><cn type="integer" id="S3.E5.m1.6.6.6.6.6.6.1.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1">0</cn></apply><ci id="S3.E5.m1.7.7.7.7.7.7.cmml" xref="S3.E5.m1.7.7.7.7.7.7">𝑋</ci></apply><apply id="S3.E5.m1.32.32.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="ambiguous" id="S3.E5.m1.32.32.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.37.37.6">subscript</csymbol><ci id="S3.E5.m1.9.9.9.9.9.9.cmml" xref="S3.E5.m1.9.9.9.9.9.9">𝑏</ci><cn type="integer" id="S3.E5.m1.10.10.10.10.10.10.1.cmml" xref="S3.E5.m1.10.10.10.10.10.10.1">0</cn></apply></apply></apply><ci id="S3.E5.m1.12.12.12.12.12.12.1.cmml" xref="S3.E5.m1.12.12.12.12.12.12.1">𝑖</ci></apply><apply id="S3.E5.m1.32.32.1.1.3.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="ambiguous" id="S3.E5.m1.32.32.1.1.3.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4">subscript</csymbol><ci id="S3.E5.m1.13.13.13.1.1.1.cmml" xref="S3.E5.m1.13.13.13.1.1.1">𝑧</ci><ci id="S3.E5.m1.14.14.14.2.2.2.1.cmml" xref="S3.E5.m1.14.14.14.2.2.2.1">𝑖</ci></apply></apply></apply><apply id="S3.E5.m1.34.34.3c.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="latexml" id="S3.E5.m1.15.15.15.3.3.3.cmml" xref="S3.E5.m1.15.15.15.3.3.3">similar-to</csymbol><share href="#S3.E5.m1.32.32.1.1.cmml" id="S3.E5.m1.34.34.3d.cmml" xref="S3.E5.m1.4.4.4.4.4.4"></share><apply id="S3.E5.m1.34.34.3.3.cmml" xref="S3.E5.m1.37.37.6"><times id="S3.E5.m1.34.34.3.3.3.cmml" xref="S3.E5.m1.4.4.4.4.4.4"></times><ci id="S3.E5.m1.16.16.16.4.4.4.cmml" xref="S3.E5.m1.16.16.16.4.4.4">𝑁</ci><interval closure="open" id="S3.E5.m1.34.34.3.3.2.3.cmml" xref="S3.E5.m1.37.37.6"><apply id="S3.E5.m1.33.33.2.2.1.1.1.2.cmml" xref="S3.E5.m1.37.37.6"><ci id="S3.E5.m1.18.18.18.6.6.6.cmml" xref="S3.E5.m1.18.18.18.6.6.6">𝔼</ci><apply id="S3.E5.m1.33.33.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="ambiguous" id="S3.E5.m1.33.33.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.37.37.6">subscript</csymbol><ci id="S3.E5.m1.20.20.20.8.8.8.cmml" xref="S3.E5.m1.20.20.20.8.8.8">𝑧</ci><ci id="S3.E5.m1.21.21.21.9.9.9.1.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1">𝑖</ci></apply></apply><apply id="S3.E5.m1.34.34.3.3.2.2.2.cmml" xref="S3.E5.m1.37.37.6"><times id="S3.E5.m1.34.34.3.3.2.2.2.2.cmml" xref="S3.E5.m1.37.37.6"></times><ci id="S3.E5.m1.24.24.24.12.12.12.cmml" xref="S3.E5.m1.24.24.24.12.12.12">𝑉</ci><ci id="S3.E5.m1.25.25.25.13.13.13.cmml" xref="S3.E5.m1.25.25.25.13.13.13">𝑎</ci><ci id="S3.E5.m1.26.26.26.14.14.14.cmml" xref="S3.E5.m1.26.26.26.14.14.14">𝑟</ci><apply id="S3.E5.m1.34.34.3.3.2.2.2.1.2.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="latexml" id="S3.E5.m1.34.34.3.3.2.2.2.1.2.1.cmml" xref="S3.E5.m1.37.37.6">delimited-[]</csymbol><apply id="S3.E5.m1.34.34.3.3.2.2.2.1.1.1.cmml" xref="S3.E5.m1.37.37.6"><csymbol cd="ambiguous" id="S3.E5.m1.34.34.3.3.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.37.37.6">subscript</csymbol><ci id="S3.E5.m1.28.28.28.16.16.16.cmml" xref="S3.E5.m1.28.28.28.16.16.16">𝑧</ci><ci id="S3.E5.m1.29.29.29.17.17.17.1.cmml" xref="S3.E5.m1.29.29.29.17.17.17.1">𝑖</ci></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.37c">\begin{gathered}{\color[rgb]{0,0,0}z_{i}\triangleq[W_{0}X+b_{0}]_{i}}\\
{\color[rgb]{0,0,0}z_{i}\sim N(\operatorname*{\mathbb{E}}[z_{i}],Var[z_{i}])}\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.5" class="ltx_p">During local training, the client’s model has been adapted to the local dataset, and the BN-layer statistics used for inference (<math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mu</annotation></semantics></math>, <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="\sigma^{2}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msup id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">σ</mi><mn id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝜎</ci><cn type="integer" id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\sigma^{2}</annotation></semantics></math>) have been updated from the layer activations. Assuming, after local training (and before aggregation), <math id="S3.SS2.p4.3.m3.2" class="ltx_Math" alttext="\mu_{i}\approx\operatorname*{\mathbb{E}}[z_{i}]" display="inline"><semantics id="S3.SS2.p4.3.m3.2a"><mrow id="S3.SS2.p4.3.m3.2.2" xref="S3.SS2.p4.3.m3.2.2.cmml"><msub id="S3.SS2.p4.3.m3.2.2.3" xref="S3.SS2.p4.3.m3.2.2.3.cmml"><mi id="S3.SS2.p4.3.m3.2.2.3.2" xref="S3.SS2.p4.3.m3.2.2.3.2.cmml">μ</mi><mi id="S3.SS2.p4.3.m3.2.2.3.3" xref="S3.SS2.p4.3.m3.2.2.3.3.cmml">i</mi></msub><mo rspace="0.1389em" id="S3.SS2.p4.3.m3.2.2.2" xref="S3.SS2.p4.3.m3.2.2.2.cmml">≈</mo><mrow id="S3.SS2.p4.3.m3.2.2.1.1" xref="S3.SS2.p4.3.m3.2.2.1.2.cmml"><mo lspace="0.1389em" rspace="0em" id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">𝔼</mo><mrow id="S3.SS2.p4.3.m3.2.2.1.1.1" xref="S3.SS2.p4.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p4.3.m3.2.2.1.1.1.2" xref="S3.SS2.p4.3.m3.2.2.1.2.cmml">[</mo><msub id="S3.SS2.p4.3.m3.2.2.1.1.1.1" xref="S3.SS2.p4.3.m3.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p4.3.m3.2.2.1.1.1.1.2" xref="S3.SS2.p4.3.m3.2.2.1.1.1.1.2.cmml">z</mi><mi id="S3.SS2.p4.3.m3.2.2.1.1.1.1.3" xref="S3.SS2.p4.3.m3.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p4.3.m3.2.2.1.1.1.3" xref="S3.SS2.p4.3.m3.2.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.2b"><apply id="S3.SS2.p4.3.m3.2.2.cmml" xref="S3.SS2.p4.3.m3.2.2"><approx id="S3.SS2.p4.3.m3.2.2.2.cmml" xref="S3.SS2.p4.3.m3.2.2.2"></approx><apply id="S3.SS2.p4.3.m3.2.2.3.cmml" xref="S3.SS2.p4.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.2.3.1.cmml" xref="S3.SS2.p4.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS2.p4.3.m3.2.2.3.2.cmml" xref="S3.SS2.p4.3.m3.2.2.3.2">𝜇</ci><ci id="S3.SS2.p4.3.m3.2.2.3.3.cmml" xref="S3.SS2.p4.3.m3.2.2.3.3">𝑖</ci></apply><apply id="S3.SS2.p4.3.m3.2.2.1.2.cmml" xref="S3.SS2.p4.3.m3.2.2.1.1"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝔼</ci><apply id="S3.SS2.p4.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p4.3.m3.2.2.1.1.1.1.2">𝑧</ci><ci id="S3.SS2.p4.3.m3.2.2.1.1.1.1.3.cmml" xref="S3.SS2.p4.3.m3.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.2c">\mu_{i}\approx\operatorname*{\mathbb{E}}[z_{i}]</annotation></semantics></math>, and <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="\sigma_{i}^{2}\approx Var[z_{i}]" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><mrow id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><msubsup id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.3.2.2" xref="S3.SS2.p4.4.m4.1.1.3.2.2.cmml">σ</mi><mi id="S3.SS2.p4.4.m4.1.1.3.2.3" xref="S3.SS2.p4.4.m4.1.1.3.2.3.cmml">i</mi><mn id="S3.SS2.p4.4.m4.1.1.3.3" xref="S3.SS2.p4.4.m4.1.1.3.3.cmml">2</mn></msubsup><mo id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">≈</mo><mrow id="S3.SS2.p4.4.m4.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.1.3" xref="S3.SS2.p4.4.m4.1.1.1.3.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.1.1.1.2" xref="S3.SS2.p4.4.m4.1.1.1.2.cmml">​</mo><mi id="S3.SS2.p4.4.m4.1.1.1.4" xref="S3.SS2.p4.4.m4.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.1.1.1.2a" xref="S3.SS2.p4.4.m4.1.1.1.2.cmml">​</mo><mi id="S3.SS2.p4.4.m4.1.1.1.5" xref="S3.SS2.p4.4.m4.1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.1.1.1.2b" xref="S3.SS2.p4.4.m4.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p4.4.m4.1.1.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p4.4.m4.1.1.1.1.1.2" xref="S3.SS2.p4.4.m4.1.1.1.1.2.1.cmml">[</mo><msub id="S3.SS2.p4.4.m4.1.1.1.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.1.1.1.1.2" xref="S3.SS2.p4.4.m4.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS2.p4.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.p4.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p4.4.m4.1.1.1.1.1.3" xref="S3.SS2.p4.4.m4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><approx id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2"></approx><apply id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.3.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3">superscript</csymbol><apply id="S3.SS2.p4.4.m4.1.1.3.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3.2.2">𝜎</ci><ci id="S3.SS2.p4.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p4.4.m4.1.1.3.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3">2</cn></apply><apply id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1"><times id="S3.SS2.p4.4.m4.1.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.1.2"></times><ci id="S3.SS2.p4.4.m4.1.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.1.3">𝑉</ci><ci id="S3.SS2.p4.4.m4.1.1.1.4.cmml" xref="S3.SS2.p4.4.m4.1.1.1.4">𝑎</ci><ci id="S3.SS2.p4.4.m4.1.1.1.5.cmml" xref="S3.SS2.p4.4.m4.1.1.1.5">𝑟</ci><apply id="S3.SS2.p4.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p4.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p4.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS2.p4.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">\sigma_{i}^{2}\approx Var[z_{i}]</annotation></semantics></math>, then the BN-layer (ignoring <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">\epsilon</annotation></semantics></math>) computes:</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.34" class="ltx_Math" alttext="\begin{gathered}{\color[rgb]{0,0,0}\hat{x}_{i}\triangleq\frac{z_{i}-\mu_{i}}{\sigma_{i}}}\\
{\color[rgb]{0,0,0}\hat{x}_{i}\sim N(0,1)}\\
{\color[rgb]{0,0,0}\mathrm{BN}(\hat{x}_{i})\sim N(\beta_{i},\gamma_{i}^{2})}\end{gathered}" display="block"><semantics id="S3.E6.m1.34a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E6.m1.34.34.6" xref="S3.E6.m1.31.31.3.cmml"><mtr id="S3.E6.m1.34.34.6a" xref="S3.E6.m1.31.31.3.cmml"><mtd id="S3.E6.m1.34.34.6b" xref="S3.E6.m1.31.31.3.cmml"><mrow id="S3.E6.m1.4.4.4.4.4" xref="S3.E6.m1.31.31.3.cmml"><msub id="S3.E6.m1.4.4.4.4.4.5" xref="S3.E6.m1.31.31.3.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml">x</mi><mo mathcolor="#000000" id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mi mathcolor="#000000" id="S3.E6.m1.2.2.2.2.2.2.1" xref="S3.E6.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E6.m1.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.cmml">≜</mo><mfrac mathcolor="#000000" id="S3.E6.m1.4.4.4.4.4.4" xref="S3.E6.m1.4.4.4.4.4.4.cmml"><mrow id="S3.E6.m1.4.4.4.4.4.4.2" xref="S3.E6.m1.4.4.4.4.4.4.2.cmml"><msub id="S3.E6.m1.4.4.4.4.4.4.2.2" xref="S3.E6.m1.4.4.4.4.4.4.2.2.cmml"><mi mathcolor="#000000" id="S3.E6.m1.4.4.4.4.4.4.2.2.2" xref="S3.E6.m1.4.4.4.4.4.4.2.2.2.cmml">z</mi><mi mathcolor="#000000" id="S3.E6.m1.4.4.4.4.4.4.2.2.3" xref="S3.E6.m1.4.4.4.4.4.4.2.2.3.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E6.m1.4.4.4.4.4.4.2.1" xref="S3.E6.m1.4.4.4.4.4.4.2.1.cmml">−</mo><msub id="S3.E6.m1.4.4.4.4.4.4.2.3" xref="S3.E6.m1.4.4.4.4.4.4.2.3.cmml"><mi mathcolor="#000000" id="S3.E6.m1.4.4.4.4.4.4.2.3.2" xref="S3.E6.m1.4.4.4.4.4.4.2.3.2.cmml">μ</mi><mi mathcolor="#000000" id="S3.E6.m1.4.4.4.4.4.4.2.3.3" xref="S3.E6.m1.4.4.4.4.4.4.2.3.3.cmml">i</mi></msub></mrow><msub id="S3.E6.m1.4.4.4.4.4.4.3" xref="S3.E6.m1.4.4.4.4.4.4.3.cmml"><mi mathcolor="#000000" id="S3.E6.m1.4.4.4.4.4.4.3.2" xref="S3.E6.m1.4.4.4.4.4.4.3.2.cmml">σ</mi><mi mathcolor="#000000" id="S3.E6.m1.4.4.4.4.4.4.3.3" xref="S3.E6.m1.4.4.4.4.4.4.3.3.cmml">i</mi></msub></mfrac></mrow></mtd></mtr><mtr id="S3.E6.m1.34.34.6c" xref="S3.E6.m1.31.31.3.cmml"><mtd id="S3.E6.m1.34.34.6d" xref="S3.E6.m1.31.31.3.cmml"><mrow id="S3.E6.m1.13.13.13.9.9" xref="S3.E6.m1.31.31.3.cmml"><msub id="S3.E6.m1.13.13.13.9.9.10" xref="S3.E6.m1.31.31.3.cmml"><mover accent="true" id="S3.E6.m1.5.5.5.1.1.1" xref="S3.E6.m1.5.5.5.1.1.1.cmml"><mi mathcolor="#000000" id="S3.E6.m1.5.5.5.1.1.1.2" xref="S3.E6.m1.5.5.5.1.1.1.2.cmml">x</mi><mo mathcolor="#000000" id="S3.E6.m1.5.5.5.1.1.1.1" xref="S3.E6.m1.5.5.5.1.1.1.1.cmml">^</mo></mover><mi mathcolor="#000000" id="S3.E6.m1.6.6.6.2.2.2.1" xref="S3.E6.m1.6.6.6.2.2.2.1.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E6.m1.7.7.7.3.3.3" xref="S3.E6.m1.7.7.7.3.3.3.cmml">∼</mo><mrow id="S3.E6.m1.13.13.13.9.9.11" xref="S3.E6.m1.31.31.3.cmml"><mi mathcolor="#000000" id="S3.E6.m1.8.8.8.4.4.4" xref="S3.E6.m1.8.8.8.4.4.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.13.13.13.9.9.11.1" xref="S3.E6.m1.31.31.3a.cmml">​</mo><mrow id="S3.E6.m1.13.13.13.9.9.11.2" xref="S3.E6.m1.31.31.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E6.m1.9.9.9.5.5.5" xref="S3.E6.m1.31.31.3a.cmml">(</mo><mn mathcolor="#000000" id="S3.E6.m1.10.10.10.6.6.6" xref="S3.E6.m1.10.10.10.6.6.6.cmml">0</mn><mo mathcolor="#000000" id="S3.E6.m1.11.11.11.7.7.7" xref="S3.E6.m1.31.31.3a.cmml">,</mo><mn mathcolor="#000000" id="S3.E6.m1.12.12.12.8.8.8" xref="S3.E6.m1.12.12.12.8.8.8.cmml">1</mn><mo mathcolor="#000000" stretchy="false" id="S3.E6.m1.13.13.13.9.9.9" xref="S3.E6.m1.31.31.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.34.34.6e" xref="S3.E6.m1.31.31.3.cmml"><mtd id="S3.E6.m1.34.34.6f" xref="S3.E6.m1.31.31.3.cmml"><mrow id="S3.E6.m1.34.34.6.31.18.18" xref="S3.E6.m1.31.31.3.cmml"><mrow id="S3.E6.m1.32.32.4.29.16.16.16" xref="S3.E6.m1.31.31.3.cmml"><mi mathcolor="#000000" id="S3.E6.m1.14.14.14.1.1.1" xref="S3.E6.m1.14.14.14.1.1.1.cmml">BN</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.32.32.4.29.16.16.16.2" xref="S3.E6.m1.31.31.3a.cmml">​</mo><mrow id="S3.E6.m1.32.32.4.29.16.16.16.1.1" xref="S3.E6.m1.31.31.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E6.m1.15.15.15.2.2.2" xref="S3.E6.m1.31.31.3a.cmml">(</mo><msub id="S3.E6.m1.32.32.4.29.16.16.16.1.1.1" xref="S3.E6.m1.31.31.3.cmml"><mover accent="true" id="S3.E6.m1.16.16.16.3.3.3" xref="S3.E6.m1.16.16.16.3.3.3.cmml"><mi mathcolor="#000000" id="S3.E6.m1.16.16.16.3.3.3.2" xref="S3.E6.m1.16.16.16.3.3.3.2.cmml">x</mi><mo mathcolor="#000000" id="S3.E6.m1.16.16.16.3.3.3.1" xref="S3.E6.m1.16.16.16.3.3.3.1.cmml">^</mo></mover><mi mathcolor="#000000" id="S3.E6.m1.17.17.17.4.4.4.1" xref="S3.E6.m1.17.17.17.4.4.4.1.cmml">i</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.E6.m1.18.18.18.5.5.5" xref="S3.E6.m1.31.31.3a.cmml">)</mo></mrow></mrow><mo mathcolor="#000000" id="S3.E6.m1.19.19.19.6.6.6" xref="S3.E6.m1.19.19.19.6.6.6.cmml">∼</mo><mrow id="S3.E6.m1.34.34.6.31.18.18.18" xref="S3.E6.m1.31.31.3.cmml"><mi mathcolor="#000000" id="S3.E6.m1.20.20.20.7.7.7" xref="S3.E6.m1.20.20.20.7.7.7.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.34.34.6.31.18.18.18.3" xref="S3.E6.m1.31.31.3a.cmml">​</mo><mrow id="S3.E6.m1.34.34.6.31.18.18.18.2.2" xref="S3.E6.m1.31.31.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E6.m1.21.21.21.8.8.8" xref="S3.E6.m1.31.31.3a.cmml">(</mo><msub id="S3.E6.m1.33.33.5.30.17.17.17.1.1.1" xref="S3.E6.m1.31.31.3.cmml"><mi mathcolor="#000000" id="S3.E6.m1.22.22.22.9.9.9" xref="S3.E6.m1.22.22.22.9.9.9.cmml">β</mi><mi mathcolor="#000000" id="S3.E6.m1.23.23.23.10.10.10.1" xref="S3.E6.m1.23.23.23.10.10.10.1.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E6.m1.24.24.24.11.11.11" xref="S3.E6.m1.31.31.3a.cmml">,</mo><msubsup id="S3.E6.m1.34.34.6.31.18.18.18.2.2.2" xref="S3.E6.m1.31.31.3.cmml"><mi mathcolor="#000000" id="S3.E6.m1.25.25.25.12.12.12" xref="S3.E6.m1.25.25.25.12.12.12.cmml">γ</mi><mi mathcolor="#000000" id="S3.E6.m1.26.26.26.13.13.13.1" xref="S3.E6.m1.26.26.26.13.13.13.1.cmml">i</mi><mn mathcolor="#000000" id="S3.E6.m1.27.27.27.14.14.14.1" xref="S3.E6.m1.27.27.27.14.14.14.1.cmml">2</mn></msubsup><mo mathcolor="#000000" stretchy="false" id="S3.E6.m1.28.28.28.15.15.15" xref="S3.E6.m1.31.31.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E6.m1.34b"><apply id="S3.E6.m1.31.31.3.cmml" xref="S3.E6.m1.34.34.6"><and id="S3.E6.m1.31.31.3a.cmml" xref="S3.E6.m1.13.13.13.9.9.11.1"></and><apply id="S3.E6.m1.31.31.3b.cmml" xref="S3.E6.m1.34.34.6"><ci id="S3.E6.m1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3">≜</ci><apply id="S3.E6.m1.31.31.3.5.cmml" xref="S3.E6.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E6.m1.31.31.3.5.1.cmml" xref="S3.E6.m1.13.13.13.9.9.11.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><ci id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1">^</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">𝑥</ci></apply><ci id="S3.E6.m1.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E6.m1.31.31.3.7.cmml" xref="S3.E6.m1.34.34.6"><times id="S3.E6.m1.31.31.3.7.1.cmml" xref="S3.E6.m1.13.13.13.9.9.11.1"></times><apply id="S3.E6.m1.4.4.4.4.4.4.cmml" xref="S3.E6.m1.4.4.4.4.4.4"><divide id="S3.E6.m1.4.4.4.4.4.4.1.cmml" xref="S3.E6.m1.4.4.4.4.4.4"></divide><apply id="S3.E6.m1.4.4.4.4.4.4.2.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2"><minus id="S3.E6.m1.4.4.4.4.4.4.2.1.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.1"></minus><apply id="S3.E6.m1.4.4.4.4.4.4.2.2.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.4.4.4.2.2.1.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.2">subscript</csymbol><ci id="S3.E6.m1.4.4.4.4.4.4.2.2.2.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.2.2">𝑧</ci><ci id="S3.E6.m1.4.4.4.4.4.4.2.2.3.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.2.3">𝑖</ci></apply><apply id="S3.E6.m1.4.4.4.4.4.4.2.3.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.4.4.4.2.3.1.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.3">subscript</csymbol><ci id="S3.E6.m1.4.4.4.4.4.4.2.3.2.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.3.2">𝜇</ci><ci id="S3.E6.m1.4.4.4.4.4.4.2.3.3.cmml" xref="S3.E6.m1.4.4.4.4.4.4.2.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.4.4.4.4.4.4.3.cmml" xref="S3.E6.m1.4.4.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.4.4.4.3.1.cmml" xref="S3.E6.m1.4.4.4.4.4.4.3">subscript</csymbol><ci id="S3.E6.m1.4.4.4.4.4.4.3.2.cmml" xref="S3.E6.m1.4.4.4.4.4.4.3.2">𝜎</ci><ci id="S3.E6.m1.4.4.4.4.4.4.3.3.cmml" xref="S3.E6.m1.4.4.4.4.4.4.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.31.31.3.7.3.cmml" xref="S3.E6.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E6.m1.31.31.3.7.3.1.cmml" xref="S3.E6.m1.13.13.13.9.9.11.1">subscript</csymbol><apply id="S3.E6.m1.5.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.5.1.1.1"><ci id="S3.E6.m1.5.5.5.1.1.1.1.cmml" xref="S3.E6.m1.5.5.5.1.1.1.1">^</ci><ci id="S3.E6.m1.5.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.5.1.1.1.2">𝑥</ci></apply><ci id="S3.E6.m1.6.6.6.2.2.2.1.cmml" xref="S3.E6.m1.6.6.6.2.2.2.1">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.31.31.3c.cmml" xref="S3.E6.m1.34.34.6"><csymbol cd="latexml" id="S3.E6.m1.7.7.7.3.3.3.cmml" xref="S3.E6.m1.7.7.7.3.3.3">similar-to</csymbol><share href="#S3.E6.m1.31.31.3.7.cmml" id="S3.E6.m1.31.31.3d.cmml" xref="S3.E6.m1.13.13.13.9.9.11.1"></share><apply id="S3.E6.m1.29.29.1.1.cmml" xref="S3.E6.m1.34.34.6"><times id="S3.E6.m1.29.29.1.1.2.cmml" xref="S3.E6.m1.13.13.13.9.9.11.1"></times><ci id="S3.E6.m1.8.8.8.4.4.4.cmml" xref="S3.E6.m1.8.8.8.4.4.4">𝑁</ci><interval closure="open" id="S3.E6.m1.29.29.1.1.4.cmml" xref="S3.E6.m1.34.34.6"><cn type="integer" id="S3.E6.m1.10.10.10.6.6.6.cmml" xref="S3.E6.m1.10.10.10.6.6.6">0</cn><cn type="integer" id="S3.E6.m1.12.12.12.8.8.8.cmml" xref="S3.E6.m1.12.12.12.8.8.8">1</cn></interval><ci id="S3.E6.m1.14.14.14.1.1.1.cmml" xref="S3.E6.m1.14.14.14.1.1.1">BN</ci><apply id="S3.E6.m1.29.29.1.1.1.1.1.cmml" xref="S3.E6.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E6.m1.29.29.1.1.1.1.1.1.cmml" xref="S3.E6.m1.34.34.6">subscript</csymbol><apply id="S3.E6.m1.16.16.16.3.3.3.cmml" xref="S3.E6.m1.16.16.16.3.3.3"><ci id="S3.E6.m1.16.16.16.3.3.3.1.cmml" xref="S3.E6.m1.16.16.16.3.3.3.1">^</ci><ci id="S3.E6.m1.16.16.16.3.3.3.2.cmml" xref="S3.E6.m1.16.16.16.3.3.3.2">𝑥</ci></apply><ci id="S3.E6.m1.17.17.17.4.4.4.1.cmml" xref="S3.E6.m1.17.17.17.4.4.4.1">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.31.31.3e.cmml" xref="S3.E6.m1.34.34.6"><csymbol cd="latexml" id="S3.E6.m1.19.19.19.6.6.6.cmml" xref="S3.E6.m1.19.19.19.6.6.6">similar-to</csymbol><share href="#S3.E6.m1.29.29.1.1.cmml" id="S3.E6.m1.31.31.3f.cmml" xref="S3.E6.m1.13.13.13.9.9.11.1"></share><apply id="S3.E6.m1.31.31.3.3.cmml" xref="S3.E6.m1.34.34.6"><times id="S3.E6.m1.31.31.3.3.3.cmml" xref="S3.E6.m1.13.13.13.9.9.11.1"></times><ci id="S3.E6.m1.20.20.20.7.7.7.cmml" xref="S3.E6.m1.20.20.20.7.7.7">𝑁</ci><interval closure="open" id="S3.E6.m1.31.31.3.3.2.3.cmml" xref="S3.E6.m1.34.34.6"><apply id="S3.E6.m1.30.30.2.2.1.1.1.cmml" xref="S3.E6.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E6.m1.30.30.2.2.1.1.1.1.cmml" xref="S3.E6.m1.34.34.6">subscript</csymbol><ci id="S3.E6.m1.22.22.22.9.9.9.cmml" xref="S3.E6.m1.22.22.22.9.9.9">𝛽</ci><ci id="S3.E6.m1.23.23.23.10.10.10.1.cmml" xref="S3.E6.m1.23.23.23.10.10.10.1">𝑖</ci></apply><apply id="S3.E6.m1.31.31.3.3.2.2.2.cmml" xref="S3.E6.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E6.m1.31.31.3.3.2.2.2.1.cmml" xref="S3.E6.m1.34.34.6">superscript</csymbol><apply id="S3.E6.m1.31.31.3.3.2.2.2.2.cmml" xref="S3.E6.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E6.m1.31.31.3.3.2.2.2.2.1.cmml" xref="S3.E6.m1.34.34.6">subscript</csymbol><ci id="S3.E6.m1.25.25.25.12.12.12.cmml" xref="S3.E6.m1.25.25.25.12.12.12">𝛾</ci><ci id="S3.E6.m1.26.26.26.13.13.13.1.cmml" xref="S3.E6.m1.26.26.26.13.13.13.1">𝑖</ci></apply><cn type="integer" id="S3.E6.m1.27.27.27.14.14.14.1.cmml" xref="S3.E6.m1.27.27.27.14.14.14.1">2</cn></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.34c">\begin{gathered}{\color[rgb]{0,0,0}\hat{x}_{i}\triangleq\frac{z_{i}-\mu_{i}}{\sigma_{i}}}\\
{\color[rgb]{0,0,0}\hat{x}_{i}\sim N(0,1)}\\
{\color[rgb]{0,0,0}\mathrm{BN}(\hat{x}_{i})\sim N(\beta_{i},\gamma_{i}^{2})}\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p6" class="ltx_para ltx_noindent">
<p id="S3.SS2.p6.6" class="ltx_p">where <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\beta_{i}" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><msub id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">β</mi><mi id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2">𝛽</ci><ci id="S3.SS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\beta_{i}</annotation></semantics></math>, <math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="\gamma_{i}^{2}" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><msubsup id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml"><mi id="S3.SS2.p6.2.m2.1.1.2.2" xref="S3.SS2.p6.2.m2.1.1.2.2.cmml">γ</mi><mi id="S3.SS2.p6.2.m2.1.1.2.3" xref="S3.SS2.p6.2.m2.1.1.2.3.cmml">i</mi><mn id="S3.SS2.p6.2.m2.1.1.3" xref="S3.SS2.p6.2.m2.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><apply id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.2.m2.1.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p6.2.m2.1.1.2.cmml" xref="S3.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.2.m2.1.1.2.1.cmml" xref="S3.SS2.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p6.2.m2.1.1.2.2.cmml" xref="S3.SS2.p6.2.m2.1.1.2.2">𝛾</ci><ci id="S3.SS2.p6.2.m2.1.1.2.3.cmml" xref="S3.SS2.p6.2.m2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p6.2.m2.1.1.3.cmml" xref="S3.SS2.p6.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">\gamma_{i}^{2}</annotation></semantics></math> are the learned BN parameters. If the client is participating in FL or MTFL, then the model parameters <math id="S3.SS2.p6.3.m3.1" class="ltx_Math" alttext="W_{0}" display="inline"><semantics id="S3.SS2.p6.3.m3.1a"><msub id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml"><mi id="S3.SS2.p6.3.m3.1.1.2" xref="S3.SS2.p6.3.m3.1.1.2.cmml">W</mi><mn id="S3.SS2.p6.3.m3.1.1.3" xref="S3.SS2.p6.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><apply id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.3.m3.1.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p6.3.m3.1.1.2.cmml" xref="S3.SS2.p6.3.m3.1.1.2">𝑊</ci><cn type="integer" id="S3.SS2.p6.3.m3.1.1.3.cmml" xref="S3.SS2.p6.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">W_{0}</annotation></semantics></math>, <math id="S3.SS2.p6.4.m4.1" class="ltx_Math" alttext="b_{0}" display="inline"><semantics id="S3.SS2.p6.4.m4.1a"><msub id="S3.SS2.p6.4.m4.1.1" xref="S3.SS2.p6.4.m4.1.1.cmml"><mi id="S3.SS2.p6.4.m4.1.1.2" xref="S3.SS2.p6.4.m4.1.1.2.cmml">b</mi><mn id="S3.SS2.p6.4.m4.1.1.3" xref="S3.SS2.p6.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m4.1b"><apply id="S3.SS2.p6.4.m4.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.4.m4.1.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p6.4.m4.1.1.2.cmml" xref="S3.SS2.p6.4.m4.1.1.2">𝑏</ci><cn type="integer" id="S3.SS2.p6.4.m4.1.1.3.cmml" xref="S3.SS2.p6.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m4.1c">b_{0}</annotation></semantics></math> are updated after downloading the global model with federated values: <math id="S3.SS2.p6.5.m5.1" class="ltx_Math" alttext="\overline{W}_{0}" display="inline"><semantics id="S3.SS2.p6.5.m5.1a"><msub id="S3.SS2.p6.5.m5.1.1" xref="S3.SS2.p6.5.m5.1.1.cmml"><mover accent="true" id="S3.SS2.p6.5.m5.1.1.2" xref="S3.SS2.p6.5.m5.1.1.2.cmml"><mi id="S3.SS2.p6.5.m5.1.1.2.2" xref="S3.SS2.p6.5.m5.1.1.2.2.cmml">W</mi><mo id="S3.SS2.p6.5.m5.1.1.2.1" xref="S3.SS2.p6.5.m5.1.1.2.1.cmml">¯</mo></mover><mn id="S3.SS2.p6.5.m5.1.1.3" xref="S3.SS2.p6.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m5.1b"><apply id="S3.SS2.p6.5.m5.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.5.m5.1.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p6.5.m5.1.1.2.cmml" xref="S3.SS2.p6.5.m5.1.1.2"><ci id="S3.SS2.p6.5.m5.1.1.2.1.cmml" xref="S3.SS2.p6.5.m5.1.1.2.1">¯</ci><ci id="S3.SS2.p6.5.m5.1.1.2.2.cmml" xref="S3.SS2.p6.5.m5.1.1.2.2">𝑊</ci></apply><cn type="integer" id="S3.SS2.p6.5.m5.1.1.3.cmml" xref="S3.SS2.p6.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.5.m5.1c">\overline{W}_{0}</annotation></semantics></math>, <math id="S3.SS2.p6.6.m6.1" class="ltx_Math" alttext="\overline{b}_{0}" display="inline"><semantics id="S3.SS2.p6.6.m6.1a"><msub id="S3.SS2.p6.6.m6.1.1" xref="S3.SS2.p6.6.m6.1.1.cmml"><mover accent="true" id="S3.SS2.p6.6.m6.1.1.2" xref="S3.SS2.p6.6.m6.1.1.2.cmml"><mi id="S3.SS2.p6.6.m6.1.1.2.2" xref="S3.SS2.p6.6.m6.1.1.2.2.cmml">b</mi><mo id="S3.SS2.p6.6.m6.1.1.2.1" xref="S3.SS2.p6.6.m6.1.1.2.1.cmml">¯</mo></mover><mn id="S3.SS2.p6.6.m6.1.1.3" xref="S3.SS2.p6.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.6.m6.1b"><apply id="S3.SS2.p6.6.m6.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.6.m6.1.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1">subscript</csymbol><apply id="S3.SS2.p6.6.m6.1.1.2.cmml" xref="S3.SS2.p6.6.m6.1.1.2"><ci id="S3.SS2.p6.6.m6.1.1.2.1.cmml" xref="S3.SS2.p6.6.m6.1.1.2.1">¯</ci><ci id="S3.SS2.p6.6.m6.1.1.2.2.cmml" xref="S3.SS2.p6.6.m6.1.1.2.2">𝑏</ci></apply><cn type="integer" id="S3.SS2.p6.6.m6.1.1.3.cmml" xref="S3.SS2.p6.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.6.m6.1c">\overline{b}_{0}</annotation></semantics></math>. The activations of the first layer are then:</p>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.35" class="ltx_Math" alttext="\begin{gathered}{\color[rgb]{0,0,0}\overline{z}_{i}\triangleq[\overline{W}_{0}X+\overline{b}_{0}]_{i}}\\
{\color[rgb]{0,0,0}\overline{z}_{i}\sim N(\operatorname*{\mathbb{E}}[\overline{z}_{i}],\mathrm{Var}[\overline{z}_{i}])}\end{gathered}" display="block"><semantics id="S3.E7.m1.35a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E7.m1.35.35.6" xref="S3.E7.m1.32.32.3.cmml"><mtr id="S3.E7.m1.35.35.6a" xref="S3.E7.m1.32.32.3.cmml"><mtd id="S3.E7.m1.35.35.6b" xref="S3.E7.m1.32.32.3.cmml"><mrow id="S3.E7.m1.33.33.4.30.13.13" xref="S3.E7.m1.32.32.3.cmml"><msub id="S3.E7.m1.33.33.4.30.13.13.14" xref="S3.E7.m1.32.32.3.cmml"><mover accent="true" id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml">z</mi><mo mathcolor="#000000" id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">¯</mo></mover><mi mathcolor="#000000" id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.cmml">≜</mo><msub id="S3.E7.m1.33.33.4.30.13.13.13" xref="S3.E7.m1.32.32.3.cmml"><mrow id="S3.E7.m1.33.33.4.30.13.13.13.1.1" xref="S3.E7.m1.32.32.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E7.m1.4.4.4.4.4.4" xref="S3.E7.m1.32.32.3a.cmml">[</mo><mrow id="S3.E7.m1.33.33.4.30.13.13.13.1.1.1" xref="S3.E7.m1.32.32.3.cmml"><mrow id="S3.E7.m1.33.33.4.30.13.13.13.1.1.1.1" xref="S3.E7.m1.32.32.3.cmml"><msub id="S3.E7.m1.33.33.4.30.13.13.13.1.1.1.1.2" xref="S3.E7.m1.32.32.3.cmml"><mover accent="true" id="S3.E7.m1.5.5.5.5.5.5" xref="S3.E7.m1.5.5.5.5.5.5.cmml"><mi mathcolor="#000000" id="S3.E7.m1.5.5.5.5.5.5.2" xref="S3.E7.m1.5.5.5.5.5.5.2.cmml">W</mi><mo mathcolor="#000000" id="S3.E7.m1.5.5.5.5.5.5.1" xref="S3.E7.m1.5.5.5.5.5.5.1.cmml">¯</mo></mover><mn mathcolor="#000000" id="S3.E7.m1.6.6.6.6.6.6.1" xref="S3.E7.m1.6.6.6.6.6.6.1.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.33.33.4.30.13.13.13.1.1.1.1.1" xref="S3.E7.m1.32.32.3a.cmml">​</mo><mi mathcolor="#000000" id="S3.E7.m1.7.7.7.7.7.7" xref="S3.E7.m1.7.7.7.7.7.7.cmml">X</mi></mrow><mo mathcolor="#000000" id="S3.E7.m1.8.8.8.8.8.8" xref="S3.E7.m1.8.8.8.8.8.8.cmml">+</mo><msub id="S3.E7.m1.33.33.4.30.13.13.13.1.1.1.2" xref="S3.E7.m1.32.32.3.cmml"><mover accent="true" id="S3.E7.m1.9.9.9.9.9.9" xref="S3.E7.m1.9.9.9.9.9.9.cmml"><mi mathcolor="#000000" id="S3.E7.m1.9.9.9.9.9.9.2" xref="S3.E7.m1.9.9.9.9.9.9.2.cmml">b</mi><mo mathcolor="#000000" id="S3.E7.m1.9.9.9.9.9.9.1" xref="S3.E7.m1.9.9.9.9.9.9.1.cmml">¯</mo></mover><mn mathcolor="#000000" id="S3.E7.m1.10.10.10.10.10.10.1" xref="S3.E7.m1.10.10.10.10.10.10.1.cmml">0</mn></msub></mrow><mo mathcolor="#000000" stretchy="false" id="S3.E7.m1.11.11.11.11.11.11" xref="S3.E7.m1.32.32.3a.cmml">]</mo></mrow><mi mathcolor="#000000" id="S3.E7.m1.12.12.12.12.12.12.1" xref="S3.E7.m1.12.12.12.12.12.12.1.cmml">i</mi></msub></mrow></mtd></mtr><mtr id="S3.E7.m1.35.35.6c" xref="S3.E7.m1.32.32.3.cmml"><mtd id="S3.E7.m1.35.35.6d" xref="S3.E7.m1.32.32.3.cmml"><mrow id="S3.E7.m1.35.35.6.32.19.19" xref="S3.E7.m1.32.32.3.cmml"><msub id="S3.E7.m1.35.35.6.32.19.19.20" xref="S3.E7.m1.32.32.3.cmml"><mover accent="true" id="S3.E7.m1.13.13.13.1.1.1" xref="S3.E7.m1.13.13.13.1.1.1.cmml"><mi mathcolor="#000000" id="S3.E7.m1.13.13.13.1.1.1.2" xref="S3.E7.m1.13.13.13.1.1.1.2.cmml">z</mi><mo mathcolor="#000000" id="S3.E7.m1.13.13.13.1.1.1.1" xref="S3.E7.m1.13.13.13.1.1.1.1.cmml">¯</mo></mover><mi mathcolor="#000000" id="S3.E7.m1.14.14.14.2.2.2.1" xref="S3.E7.m1.14.14.14.2.2.2.1.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E7.m1.15.15.15.3.3.3" xref="S3.E7.m1.15.15.15.3.3.3.cmml">∼</mo><mrow id="S3.E7.m1.35.35.6.32.19.19.19" xref="S3.E7.m1.32.32.3.cmml"><mi mathcolor="#000000" id="S3.E7.m1.16.16.16.4.4.4" xref="S3.E7.m1.16.16.16.4.4.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.35.35.6.32.19.19.19.3" xref="S3.E7.m1.32.32.3a.cmml">​</mo><mrow id="S3.E7.m1.35.35.6.32.19.19.19.2.2" xref="S3.E7.m1.32.32.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E7.m1.17.17.17.5.5.5" xref="S3.E7.m1.32.32.3a.cmml">(</mo><mrow id="S3.E7.m1.34.34.5.31.18.18.18.1.1.1" xref="S3.E7.m1.32.32.3.cmml"><mo lspace="0em" mathcolor="#000000" rspace="0em" id="S3.E7.m1.18.18.18.6.6.6" xref="S3.E7.m1.18.18.18.6.6.6.cmml">𝔼</mo><mrow id="S3.E7.m1.34.34.5.31.18.18.18.1.1.1.1.1" xref="S3.E7.m1.32.32.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E7.m1.19.19.19.7.7.7" xref="S3.E7.m1.32.32.3a.cmml">[</mo><msub id="S3.E7.m1.34.34.5.31.18.18.18.1.1.1.1.1.1" xref="S3.E7.m1.32.32.3.cmml"><mover accent="true" id="S3.E7.m1.20.20.20.8.8.8" xref="S3.E7.m1.20.20.20.8.8.8.cmml"><mi mathcolor="#000000" id="S3.E7.m1.20.20.20.8.8.8.2" xref="S3.E7.m1.20.20.20.8.8.8.2.cmml">z</mi><mo mathcolor="#000000" id="S3.E7.m1.20.20.20.8.8.8.1" xref="S3.E7.m1.20.20.20.8.8.8.1.cmml">¯</mo></mover><mi mathcolor="#000000" id="S3.E7.m1.21.21.21.9.9.9.1" xref="S3.E7.m1.21.21.21.9.9.9.1.cmml">i</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.E7.m1.22.22.22.10.10.10" xref="S3.E7.m1.32.32.3a.cmml">]</mo></mrow></mrow><mo mathcolor="#000000" id="S3.E7.m1.23.23.23.11.11.11" xref="S3.E7.m1.32.32.3a.cmml">,</mo><mrow id="S3.E7.m1.35.35.6.32.19.19.19.2.2.2" xref="S3.E7.m1.32.32.3.cmml"><mi mathcolor="#000000" id="S3.E7.m1.24.24.24.12.12.12" xref="S3.E7.m1.24.24.24.12.12.12.cmml">Var</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.35.35.6.32.19.19.19.2.2.2.2" xref="S3.E7.m1.32.32.3a.cmml">​</mo><mrow id="S3.E7.m1.35.35.6.32.19.19.19.2.2.2.1.1" xref="S3.E7.m1.32.32.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E7.m1.25.25.25.13.13.13" xref="S3.E7.m1.32.32.3a.cmml">[</mo><msub id="S3.E7.m1.35.35.6.32.19.19.19.2.2.2.1.1.1" xref="S3.E7.m1.32.32.3.cmml"><mover accent="true" id="S3.E7.m1.26.26.26.14.14.14" xref="S3.E7.m1.26.26.26.14.14.14.cmml"><mi mathcolor="#000000" id="S3.E7.m1.26.26.26.14.14.14.2" xref="S3.E7.m1.26.26.26.14.14.14.2.cmml">z</mi><mo mathcolor="#000000" id="S3.E7.m1.26.26.26.14.14.14.1" xref="S3.E7.m1.26.26.26.14.14.14.1.cmml">¯</mo></mover><mi mathcolor="#000000" id="S3.E7.m1.27.27.27.15.15.15.1" xref="S3.E7.m1.27.27.27.15.15.15.1.cmml">i</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.E7.m1.28.28.28.16.16.16" xref="S3.E7.m1.32.32.3a.cmml">]</mo></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S3.E7.m1.29.29.29.17.17.17" xref="S3.E7.m1.32.32.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.35b"><apply id="S3.E7.m1.32.32.3.cmml" xref="S3.E7.m1.35.35.6"><and id="S3.E7.m1.32.32.3a.cmml" xref="S3.E7.m1.4.4.4.4.4.4"></and><apply id="S3.E7.m1.32.32.3b.cmml" xref="S3.E7.m1.35.35.6"><ci id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3">≜</ci><apply id="S3.E7.m1.32.32.3.5.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E7.m1.32.32.3.5.1.cmml" xref="S3.E7.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><ci id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1">¯</ci><ci id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2">𝑧</ci></apply><ci id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E7.m1.30.30.1.1.cmml" xref="S3.E7.m1.35.35.6"><times id="S3.E7.m1.30.30.1.1.2.cmml" xref="S3.E7.m1.4.4.4.4.4.4"></times><apply id="S3.E7.m1.30.30.1.1.1.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.2.cmml" xref="S3.E7.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S3.E7.m1.30.30.1.1.1.1.2.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="latexml" id="S3.E7.m1.30.30.1.1.1.1.2.1.cmml" xref="S3.E7.m1.35.35.6">delimited-[]</csymbol><apply id="S3.E7.m1.30.30.1.1.1.1.1.1.cmml" xref="S3.E7.m1.35.35.6"><plus id="S3.E7.m1.8.8.8.8.8.8.cmml" xref="S3.E7.m1.8.8.8.8.8.8"></plus><apply id="S3.E7.m1.30.30.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.35.35.6"><times id="S3.E7.m1.30.30.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.35.35.6"></times><apply id="S3.E7.m1.30.30.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.35.35.6">subscript</csymbol><apply id="S3.E7.m1.5.5.5.5.5.5.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><ci id="S3.E7.m1.5.5.5.5.5.5.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1">¯</ci><ci id="S3.E7.m1.5.5.5.5.5.5.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5.2">𝑊</ci></apply><cn type="integer" id="S3.E7.m1.6.6.6.6.6.6.1.cmml" xref="S3.E7.m1.6.6.6.6.6.6.1">0</cn></apply><ci id="S3.E7.m1.7.7.7.7.7.7.cmml" xref="S3.E7.m1.7.7.7.7.7.7">𝑋</ci></apply><apply id="S3.E7.m1.30.30.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.35.35.6">subscript</csymbol><apply id="S3.E7.m1.9.9.9.9.9.9.cmml" xref="S3.E7.m1.9.9.9.9.9.9"><ci id="S3.E7.m1.9.9.9.9.9.9.1.cmml" xref="S3.E7.m1.9.9.9.9.9.9.1">¯</ci><ci id="S3.E7.m1.9.9.9.9.9.9.2.cmml" xref="S3.E7.m1.9.9.9.9.9.9.2">𝑏</ci></apply><cn type="integer" id="S3.E7.m1.10.10.10.10.10.10.1.cmml" xref="S3.E7.m1.10.10.10.10.10.10.1">0</cn></apply></apply></apply><ci id="S3.E7.m1.12.12.12.12.12.12.1.cmml" xref="S3.E7.m1.12.12.12.12.12.12.1">𝑖</ci></apply><apply id="S3.E7.m1.30.30.1.1.3.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.3.1.cmml" xref="S3.E7.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S3.E7.m1.13.13.13.1.1.1.cmml" xref="S3.E7.m1.13.13.13.1.1.1"><ci id="S3.E7.m1.13.13.13.1.1.1.1.cmml" xref="S3.E7.m1.13.13.13.1.1.1.1">¯</ci><ci id="S3.E7.m1.13.13.13.1.1.1.2.cmml" xref="S3.E7.m1.13.13.13.1.1.1.2">𝑧</ci></apply><ci id="S3.E7.m1.14.14.14.2.2.2.1.cmml" xref="S3.E7.m1.14.14.14.2.2.2.1">𝑖</ci></apply></apply></apply><apply id="S3.E7.m1.32.32.3c.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="latexml" id="S3.E7.m1.15.15.15.3.3.3.cmml" xref="S3.E7.m1.15.15.15.3.3.3">similar-to</csymbol><share href="#S3.E7.m1.30.30.1.1.cmml" id="S3.E7.m1.32.32.3d.cmml" xref="S3.E7.m1.4.4.4.4.4.4"></share><apply id="S3.E7.m1.32.32.3.3.cmml" xref="S3.E7.m1.35.35.6"><times id="S3.E7.m1.32.32.3.3.3.cmml" xref="S3.E7.m1.4.4.4.4.4.4"></times><ci id="S3.E7.m1.16.16.16.4.4.4.cmml" xref="S3.E7.m1.16.16.16.4.4.4">𝑁</ci><interval closure="open" id="S3.E7.m1.32.32.3.3.2.3.cmml" xref="S3.E7.m1.35.35.6"><apply id="S3.E7.m1.31.31.2.2.1.1.1.2.cmml" xref="S3.E7.m1.35.35.6"><ci id="S3.E7.m1.18.18.18.6.6.6.cmml" xref="S3.E7.m1.18.18.18.6.6.6">𝔼</ci><apply id="S3.E7.m1.31.31.2.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E7.m1.31.31.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.35.35.6">subscript</csymbol><apply id="S3.E7.m1.20.20.20.8.8.8.cmml" xref="S3.E7.m1.20.20.20.8.8.8"><ci id="S3.E7.m1.20.20.20.8.8.8.1.cmml" xref="S3.E7.m1.20.20.20.8.8.8.1">¯</ci><ci id="S3.E7.m1.20.20.20.8.8.8.2.cmml" xref="S3.E7.m1.20.20.20.8.8.8.2">𝑧</ci></apply><ci id="S3.E7.m1.21.21.21.9.9.9.1.cmml" xref="S3.E7.m1.21.21.21.9.9.9.1">𝑖</ci></apply></apply><apply id="S3.E7.m1.32.32.3.3.2.2.2.cmml" xref="S3.E7.m1.35.35.6"><times id="S3.E7.m1.32.32.3.3.2.2.2.2.cmml" xref="S3.E7.m1.35.35.6"></times><ci id="S3.E7.m1.24.24.24.12.12.12.cmml" xref="S3.E7.m1.24.24.24.12.12.12">Var</ci><apply id="S3.E7.m1.32.32.3.3.2.2.2.1.2.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="latexml" id="S3.E7.m1.32.32.3.3.2.2.2.1.2.1.cmml" xref="S3.E7.m1.35.35.6">delimited-[]</csymbol><apply id="S3.E7.m1.32.32.3.3.2.2.2.1.1.1.cmml" xref="S3.E7.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E7.m1.32.32.3.3.2.2.2.1.1.1.1.cmml" xref="S3.E7.m1.35.35.6">subscript</csymbol><apply id="S3.E7.m1.26.26.26.14.14.14.cmml" xref="S3.E7.m1.26.26.26.14.14.14"><ci id="S3.E7.m1.26.26.26.14.14.14.1.cmml" xref="S3.E7.m1.26.26.26.14.14.14.1">¯</ci><ci id="S3.E7.m1.26.26.26.14.14.14.2.cmml" xref="S3.E7.m1.26.26.26.14.14.14.2">𝑧</ci></apply><ci id="S3.E7.m1.27.27.27.15.15.15.1.cmml" xref="S3.E7.m1.27.27.27.15.15.15.1">𝑖</ci></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.35c">\begin{gathered}{\color[rgb]{0,0,0}\overline{z}_{i}\triangleq[\overline{W}_{0}X+\overline{b}_{0}]_{i}}\\
{\color[rgb]{0,0,0}\overline{z}_{i}\sim N(\operatorname*{\mathbb{E}}[\overline{z}_{i}],\mathrm{Var}[\overline{z}_{i}])}\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p8" class="ltx_para ltx_noindent">
<p id="S3.SS2.p8.6" class="ltx_p">Defining the difference in mean and variance between pre- and post-aggregation activations, <math id="S3.SS2.p8.1.m1.4" class="ltx_Math" alttext="\Delta\mu_{i}=\operatorname*{\mathbb{E}}[\overline{z}_{i}]-\operatorname*{\mathbb{E}}[z_{i}]" display="inline"><semantics id="S3.SS2.p8.1.m1.4a"><mrow id="S3.SS2.p8.1.m1.4.4" xref="S3.SS2.p8.1.m1.4.4.cmml"><mrow id="S3.SS2.p8.1.m1.4.4.4" xref="S3.SS2.p8.1.m1.4.4.4.cmml"><mi mathvariant="normal" id="S3.SS2.p8.1.m1.4.4.4.2" xref="S3.SS2.p8.1.m1.4.4.4.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.1.m1.4.4.4.1" xref="S3.SS2.p8.1.m1.4.4.4.1.cmml">​</mo><msub id="S3.SS2.p8.1.m1.4.4.4.3" xref="S3.SS2.p8.1.m1.4.4.4.3.cmml"><mi id="S3.SS2.p8.1.m1.4.4.4.3.2" xref="S3.SS2.p8.1.m1.4.4.4.3.2.cmml">μ</mi><mi id="S3.SS2.p8.1.m1.4.4.4.3.3" xref="S3.SS2.p8.1.m1.4.4.4.3.3.cmml">i</mi></msub></mrow><mo rspace="0.1389em" id="S3.SS2.p8.1.m1.4.4.3" xref="S3.SS2.p8.1.m1.4.4.3.cmml">=</mo><mrow id="S3.SS2.p8.1.m1.4.4.2" xref="S3.SS2.p8.1.m1.4.4.2.cmml"><mrow id="S3.SS2.p8.1.m1.3.3.1.1.1" xref="S3.SS2.p8.1.m1.3.3.1.1.2.cmml"><mo lspace="0.1389em" rspace="0em" id="S3.SS2.p8.1.m1.1.1" xref="S3.SS2.p8.1.m1.1.1.cmml">𝔼</mo><mrow id="S3.SS2.p8.1.m1.3.3.1.1.1.1" xref="S3.SS2.p8.1.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p8.1.m1.3.3.1.1.1.1.2" xref="S3.SS2.p8.1.m1.3.3.1.1.2.cmml">[</mo><msub id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.2" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.2.cmml">z</mi><mo id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.1" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.3" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p8.1.m1.3.3.1.1.1.1.3" xref="S3.SS2.p8.1.m1.3.3.1.1.2.cmml">]</mo></mrow></mrow><mo id="S3.SS2.p8.1.m1.4.4.2.3" xref="S3.SS2.p8.1.m1.4.4.2.3.cmml">−</mo><mrow id="S3.SS2.p8.1.m1.4.4.2.2.1" xref="S3.SS2.p8.1.m1.4.4.2.2.2.cmml"><mo lspace="0em" rspace="0em" id="S3.SS2.p8.1.m1.2.2" xref="S3.SS2.p8.1.m1.2.2.cmml">𝔼</mo><mrow id="S3.SS2.p8.1.m1.4.4.2.2.1.1" xref="S3.SS2.p8.1.m1.4.4.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p8.1.m1.4.4.2.2.1.1.2" xref="S3.SS2.p8.1.m1.4.4.2.2.2.cmml">[</mo><msub id="S3.SS2.p8.1.m1.4.4.2.2.1.1.1" xref="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.cmml"><mi id="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.2" xref="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.3" xref="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p8.1.m1.4.4.2.2.1.1.3" xref="S3.SS2.p8.1.m1.4.4.2.2.2.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.4b"><apply id="S3.SS2.p8.1.m1.4.4.cmml" xref="S3.SS2.p8.1.m1.4.4"><eq id="S3.SS2.p8.1.m1.4.4.3.cmml" xref="S3.SS2.p8.1.m1.4.4.3"></eq><apply id="S3.SS2.p8.1.m1.4.4.4.cmml" xref="S3.SS2.p8.1.m1.4.4.4"><times id="S3.SS2.p8.1.m1.4.4.4.1.cmml" xref="S3.SS2.p8.1.m1.4.4.4.1"></times><ci id="S3.SS2.p8.1.m1.4.4.4.2.cmml" xref="S3.SS2.p8.1.m1.4.4.4.2">Δ</ci><apply id="S3.SS2.p8.1.m1.4.4.4.3.cmml" xref="S3.SS2.p8.1.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.4.4.4.3.1.cmml" xref="S3.SS2.p8.1.m1.4.4.4.3">subscript</csymbol><ci id="S3.SS2.p8.1.m1.4.4.4.3.2.cmml" xref="S3.SS2.p8.1.m1.4.4.4.3.2">𝜇</ci><ci id="S3.SS2.p8.1.m1.4.4.4.3.3.cmml" xref="S3.SS2.p8.1.m1.4.4.4.3.3">𝑖</ci></apply></apply><apply id="S3.SS2.p8.1.m1.4.4.2.cmml" xref="S3.SS2.p8.1.m1.4.4.2"><minus id="S3.SS2.p8.1.m1.4.4.2.3.cmml" xref="S3.SS2.p8.1.m1.4.4.2.3"></minus><apply id="S3.SS2.p8.1.m1.3.3.1.1.2.cmml" xref="S3.SS2.p8.1.m1.3.3.1.1.1"><ci id="S3.SS2.p8.1.m1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1">𝔼</ci><apply id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2"><ci id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.1">¯</ci><ci id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.2.2">𝑧</ci></apply><ci id="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS2.p8.1.m1.4.4.2.2.2.cmml" xref="S3.SS2.p8.1.m1.4.4.2.2.1"><ci id="S3.SS2.p8.1.m1.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2">𝔼</ci><apply id="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.cmml" xref="S3.SS2.p8.1.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.4.4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.4.4.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.4c">\Delta\mu_{i}=\operatorname*{\mathbb{E}}[\overline{z}_{i}]-\operatorname*{\mathbb{E}}[z_{i}]</annotation></semantics></math> and <math id="S3.SS2.p8.2.m2.2" class="ltx_Math" alttext="\Delta\sigma_{i}^{2}=\mathrm{Var}[\overline{z}_{i}]-\mathrm{Var}[z_{i}]" display="inline"><semantics id="S3.SS2.p8.2.m2.2a"><mrow id="S3.SS2.p8.2.m2.2.2" xref="S3.SS2.p8.2.m2.2.2.cmml"><mrow id="S3.SS2.p8.2.m2.2.2.4" xref="S3.SS2.p8.2.m2.2.2.4.cmml"><mi mathvariant="normal" id="S3.SS2.p8.2.m2.2.2.4.2" xref="S3.SS2.p8.2.m2.2.2.4.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.2.m2.2.2.4.1" xref="S3.SS2.p8.2.m2.2.2.4.1.cmml">​</mo><msubsup id="S3.SS2.p8.2.m2.2.2.4.3" xref="S3.SS2.p8.2.m2.2.2.4.3.cmml"><mi id="S3.SS2.p8.2.m2.2.2.4.3.2.2" xref="S3.SS2.p8.2.m2.2.2.4.3.2.2.cmml">σ</mi><mi id="S3.SS2.p8.2.m2.2.2.4.3.2.3" xref="S3.SS2.p8.2.m2.2.2.4.3.2.3.cmml">i</mi><mn id="S3.SS2.p8.2.m2.2.2.4.3.3" xref="S3.SS2.p8.2.m2.2.2.4.3.3.cmml">2</mn></msubsup></mrow><mo id="S3.SS2.p8.2.m2.2.2.3" xref="S3.SS2.p8.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS2.p8.2.m2.2.2.2" xref="S3.SS2.p8.2.m2.2.2.2.cmml"><mrow id="S3.SS2.p8.2.m2.1.1.1.1" xref="S3.SS2.p8.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.p8.2.m2.1.1.1.1.3" xref="S3.SS2.p8.2.m2.1.1.1.1.3.cmml">Var</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.2.m2.1.1.1.1.2" xref="S3.SS2.p8.2.m2.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p8.2.m2.1.1.1.1.1.1" xref="S3.SS2.p8.2.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p8.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.p8.2.m2.1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.2.cmml">z</mi><mo id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.1" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p8.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p8.2.m2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.p8.2.m2.2.2.2.3" xref="S3.SS2.p8.2.m2.2.2.2.3.cmml">−</mo><mrow id="S3.SS2.p8.2.m2.2.2.2.2" xref="S3.SS2.p8.2.m2.2.2.2.2.cmml"><mi id="S3.SS2.p8.2.m2.2.2.2.2.3" xref="S3.SS2.p8.2.m2.2.2.2.2.3.cmml">Var</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.2.m2.2.2.2.2.2" xref="S3.SS2.p8.2.m2.2.2.2.2.2.cmml">​</mo><mrow id="S3.SS2.p8.2.m2.2.2.2.2.1.1" xref="S3.SS2.p8.2.m2.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p8.2.m2.2.2.2.2.1.1.2" xref="S3.SS2.p8.2.m2.2.2.2.2.1.2.1.cmml">[</mo><msub id="S3.SS2.p8.2.m2.2.2.2.2.1.1.1" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.cmml"><mi id="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.2" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.3" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p8.2.m2.2.2.2.2.1.1.3" xref="S3.SS2.p8.2.m2.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.2.m2.2b"><apply id="S3.SS2.p8.2.m2.2.2.cmml" xref="S3.SS2.p8.2.m2.2.2"><eq id="S3.SS2.p8.2.m2.2.2.3.cmml" xref="S3.SS2.p8.2.m2.2.2.3"></eq><apply id="S3.SS2.p8.2.m2.2.2.4.cmml" xref="S3.SS2.p8.2.m2.2.2.4"><times id="S3.SS2.p8.2.m2.2.2.4.1.cmml" xref="S3.SS2.p8.2.m2.2.2.4.1"></times><ci id="S3.SS2.p8.2.m2.2.2.4.2.cmml" xref="S3.SS2.p8.2.m2.2.2.4.2">Δ</ci><apply id="S3.SS2.p8.2.m2.2.2.4.3.cmml" xref="S3.SS2.p8.2.m2.2.2.4.3"><csymbol cd="ambiguous" id="S3.SS2.p8.2.m2.2.2.4.3.1.cmml" xref="S3.SS2.p8.2.m2.2.2.4.3">superscript</csymbol><apply id="S3.SS2.p8.2.m2.2.2.4.3.2.cmml" xref="S3.SS2.p8.2.m2.2.2.4.3"><csymbol cd="ambiguous" id="S3.SS2.p8.2.m2.2.2.4.3.2.1.cmml" xref="S3.SS2.p8.2.m2.2.2.4.3">subscript</csymbol><ci id="S3.SS2.p8.2.m2.2.2.4.3.2.2.cmml" xref="S3.SS2.p8.2.m2.2.2.4.3.2.2">𝜎</ci><ci id="S3.SS2.p8.2.m2.2.2.4.3.2.3.cmml" xref="S3.SS2.p8.2.m2.2.2.4.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p8.2.m2.2.2.4.3.3.cmml" xref="S3.SS2.p8.2.m2.2.2.4.3.3">2</cn></apply></apply><apply id="S3.SS2.p8.2.m2.2.2.2.cmml" xref="S3.SS2.p8.2.m2.2.2.2"><minus id="S3.SS2.p8.2.m2.2.2.2.3.cmml" xref="S3.SS2.p8.2.m2.2.2.2.3"></minus><apply id="S3.SS2.p8.2.m2.1.1.1.1.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1"><times id="S3.SS2.p8.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.2"></times><ci id="S3.SS2.p8.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.3">Var</ci><apply id="S3.SS2.p8.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p8.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2"><ci id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.1">¯</ci><ci id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.2.2">𝑧</ci></apply><ci id="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p8.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.SS2.p8.2.m2.2.2.2.2.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2"><times id="S3.SS2.p8.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2.2"></times><ci id="S3.SS2.p8.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2.3">Var</ci><apply id="S3.SS2.p8.2.m2.2.2.2.2.1.2.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.p8.2.m2.2.2.2.2.1.2.1.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p8.2.m2.2.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.2.m2.2c">\Delta\sigma_{i}^{2}=\mathrm{Var}[\overline{z}_{i}]-\mathrm{Var}[z_{i}]</annotation></semantics></math>, the output from a BN-patch layer as part of MTFL (which maintains <math id="S3.SS2.p8.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS2.p8.3.m3.1a"><mi id="S3.SS2.p8.3.m3.1.1" xref="S3.SS2.p8.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.3.m3.1b"><ci id="S3.SS2.p8.3.m3.1.1.cmml" xref="S3.SS2.p8.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.3.m3.1c">\mu</annotation></semantics></math>, <math id="S3.SS2.p8.4.m4.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p8.4.m4.1a"><mi id="S3.SS2.p8.4.m4.1.1" xref="S3.SS2.p8.4.m4.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.4.m4.1b"><ci id="S3.SS2.p8.4.m4.1.1.cmml" xref="S3.SS2.p8.4.m4.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.4.m4.1c">\sigma</annotation></semantics></math>, <math id="S3.SS2.p8.5.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS2.p8.5.m5.1a"><mi id="S3.SS2.p8.5.m5.1.1" xref="S3.SS2.p8.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.5.m5.1b"><ci id="S3.SS2.p8.5.m5.1.1.cmml" xref="S3.SS2.p8.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.5.m5.1c">\beta</annotation></semantics></math>, <math id="S3.SS2.p8.6.m6.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS2.p8.6.m6.1a"><mi id="S3.SS2.p8.6.m6.1.1" xref="S3.SS2.p8.6.m6.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.6.m6.1b"><ci id="S3.SS2.p8.6.m6.1.1.cmml" xref="S3.SS2.p8.6.m6.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.6.m6.1c">\gamma</annotation></semantics></math> after aggregation) is:</p>
</div>
<div id="S3.SS2.p9" class="ltx_para">
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.42" class="ltx_Math" alttext="\begin{gathered}\hat{\bar{x}}_{i}\sim N\left(\frac{\Delta\mu_{i}}{\sigma_{i}},1+\frac{\Delta\sigma_{i}^{2}}{\sigma_{i}^{2}}\right)\\
\mathrm{BN}(\hat{\bar{x}}_{i})\sim N\left(\gamma\frac{\Delta\mu_{i}}{\sigma_{i}}+\beta_{i},\gamma_{i}^{2}\left(1+\frac{\Delta\sigma_{i}^{2}}{\sigma_{i}^{2}}\right)\right)\end{gathered}" display="block"><semantics id="S3.E8.m1.42a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E8.m1.42.42.8" xref="S3.E8.m1.38.38.4.cmml"><mtr id="S3.E8.m1.42.42.8a" xref="S3.E8.m1.38.38.4.cmml"><mtd id="S3.E8.m1.42.42.8b" xref="S3.E8.m1.38.38.4.cmml"><mrow id="S3.E8.m1.39.39.5.35.12.12" xref="S3.E8.m1.38.38.4.cmml"><msub id="S3.E8.m1.39.39.5.35.12.12.13" xref="S3.E8.m1.38.38.4.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S3.E8.m1.1.1.1.1.1.1.2.1" xref="S3.E8.m1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mo id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mi id="S3.E8.m1.2.2.2.2.2.2.1" xref="S3.E8.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo id="S3.E8.m1.3.3.3.3.3.3" xref="S3.E8.m1.3.3.3.3.3.3.cmml">∼</mo><mrow id="S3.E8.m1.39.39.5.35.12.12.12" xref="S3.E8.m1.38.38.4.cmml"><mi id="S3.E8.m1.4.4.4.4.4.4" xref="S3.E8.m1.4.4.4.4.4.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.39.39.5.35.12.12.12.2" xref="S3.E8.m1.38.38.4a.cmml">​</mo><mrow id="S3.E8.m1.39.39.5.35.12.12.12.1.1" xref="S3.E8.m1.38.38.4.cmml"><mo id="S3.E8.m1.5.5.5.5.5.5" xref="S3.E8.m1.38.38.4a.cmml">(</mo><mfrac id="S3.E8.m1.6.6.6.6.6.6" xref="S3.E8.m1.6.6.6.6.6.6.cmml"><mrow id="S3.E8.m1.6.6.6.6.6.6.2" xref="S3.E8.m1.6.6.6.6.6.6.2.cmml"><mi mathvariant="normal" id="S3.E8.m1.6.6.6.6.6.6.2.2" xref="S3.E8.m1.6.6.6.6.6.6.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.6.6.6.6.2.1" xref="S3.E8.m1.6.6.6.6.6.6.2.1.cmml">​</mo><msub id="S3.E8.m1.6.6.6.6.6.6.2.3" xref="S3.E8.m1.6.6.6.6.6.6.2.3.cmml"><mi id="S3.E8.m1.6.6.6.6.6.6.2.3.2" xref="S3.E8.m1.6.6.6.6.6.6.2.3.2.cmml">μ</mi><mi id="S3.E8.m1.6.6.6.6.6.6.2.3.3" xref="S3.E8.m1.6.6.6.6.6.6.2.3.3.cmml">i</mi></msub></mrow><msub id="S3.E8.m1.6.6.6.6.6.6.3" xref="S3.E8.m1.6.6.6.6.6.6.3.cmml"><mi id="S3.E8.m1.6.6.6.6.6.6.3.2" xref="S3.E8.m1.6.6.6.6.6.6.3.2.cmml">σ</mi><mi id="S3.E8.m1.6.6.6.6.6.6.3.3" xref="S3.E8.m1.6.6.6.6.6.6.3.3.cmml">i</mi></msub></mfrac><mo id="S3.E8.m1.7.7.7.7.7.7" xref="S3.E8.m1.38.38.4a.cmml">,</mo><mrow id="S3.E8.m1.39.39.5.35.12.12.12.1.1.1" xref="S3.E8.m1.38.38.4.cmml"><mn id="S3.E8.m1.8.8.8.8.8.8" xref="S3.E8.m1.8.8.8.8.8.8.cmml">1</mn><mo id="S3.E8.m1.9.9.9.9.9.9" xref="S3.E8.m1.9.9.9.9.9.9.cmml">+</mo><mfrac id="S3.E8.m1.10.10.10.10.10.10" xref="S3.E8.m1.10.10.10.10.10.10.cmml"><mrow id="S3.E8.m1.10.10.10.10.10.10.2" xref="S3.E8.m1.10.10.10.10.10.10.2.cmml"><mi mathvariant="normal" id="S3.E8.m1.10.10.10.10.10.10.2.2" xref="S3.E8.m1.10.10.10.10.10.10.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.10.10.10.10.10.10.2.1" xref="S3.E8.m1.10.10.10.10.10.10.2.1.cmml">​</mo><msubsup id="S3.E8.m1.10.10.10.10.10.10.2.3" xref="S3.E8.m1.10.10.10.10.10.10.2.3.cmml"><mi id="S3.E8.m1.10.10.10.10.10.10.2.3.2.2" xref="S3.E8.m1.10.10.10.10.10.10.2.3.2.2.cmml">σ</mi><mi id="S3.E8.m1.10.10.10.10.10.10.2.3.2.3" xref="S3.E8.m1.10.10.10.10.10.10.2.3.2.3.cmml">i</mi><mn id="S3.E8.m1.10.10.10.10.10.10.2.3.3" xref="S3.E8.m1.10.10.10.10.10.10.2.3.3.cmml">2</mn></msubsup></mrow><msubsup id="S3.E8.m1.10.10.10.10.10.10.3" xref="S3.E8.m1.10.10.10.10.10.10.3.cmml"><mi id="S3.E8.m1.10.10.10.10.10.10.3.2.2" xref="S3.E8.m1.10.10.10.10.10.10.3.2.2.cmml">σ</mi><mi id="S3.E8.m1.10.10.10.10.10.10.3.2.3" xref="S3.E8.m1.10.10.10.10.10.10.3.2.3.cmml">i</mi><mn id="S3.E8.m1.10.10.10.10.10.10.3.3" xref="S3.E8.m1.10.10.10.10.10.10.3.3.cmml">2</mn></msubsup></mfrac></mrow><mo id="S3.E8.m1.11.11.11.11.11.11" xref="S3.E8.m1.38.38.4a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E8.m1.42.42.8c" xref="S3.E8.m1.38.38.4.cmml"><mtd id="S3.E8.m1.42.42.8d" xref="S3.E8.m1.38.38.4.cmml"><mrow id="S3.E8.m1.42.42.8.38.26.26" xref="S3.E8.m1.38.38.4.cmml"><mrow id="S3.E8.m1.40.40.6.36.24.24.24" xref="S3.E8.m1.38.38.4.cmml"><mi id="S3.E8.m1.12.12.12.1.1.1" xref="S3.E8.m1.12.12.12.1.1.1.cmml">BN</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.40.40.6.36.24.24.24.2" xref="S3.E8.m1.38.38.4a.cmml">​</mo><mrow id="S3.E8.m1.40.40.6.36.24.24.24.1.1" xref="S3.E8.m1.38.38.4.cmml"><mo stretchy="false" id="S3.E8.m1.13.13.13.2.2.2" xref="S3.E8.m1.38.38.4a.cmml">(</mo><msub id="S3.E8.m1.40.40.6.36.24.24.24.1.1.1" xref="S3.E8.m1.38.38.4.cmml"><mover accent="true" id="S3.E8.m1.14.14.14.3.3.3" xref="S3.E8.m1.14.14.14.3.3.3.cmml"><mover accent="true" id="S3.E8.m1.14.14.14.3.3.3.2" xref="S3.E8.m1.14.14.14.3.3.3.2.cmml"><mi id="S3.E8.m1.14.14.14.3.3.3.2.2" xref="S3.E8.m1.14.14.14.3.3.3.2.2.cmml">x</mi><mo id="S3.E8.m1.14.14.14.3.3.3.2.1" xref="S3.E8.m1.14.14.14.3.3.3.2.1.cmml">¯</mo></mover><mo id="S3.E8.m1.14.14.14.3.3.3.1" xref="S3.E8.m1.14.14.14.3.3.3.1.cmml">^</mo></mover><mi id="S3.E8.m1.15.15.15.4.4.4.1" xref="S3.E8.m1.15.15.15.4.4.4.1.cmml">i</mi></msub><mo stretchy="false" id="S3.E8.m1.16.16.16.5.5.5" xref="S3.E8.m1.38.38.4a.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.17.17.17.6.6.6" xref="S3.E8.m1.17.17.17.6.6.6.cmml">∼</mo><mrow id="S3.E8.m1.42.42.8.38.26.26.26" xref="S3.E8.m1.38.38.4.cmml"><mi id="S3.E8.m1.18.18.18.7.7.7" xref="S3.E8.m1.18.18.18.7.7.7.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.42.42.8.38.26.26.26.3" xref="S3.E8.m1.38.38.4a.cmml">​</mo><mrow id="S3.E8.m1.42.42.8.38.26.26.26.2.2" xref="S3.E8.m1.38.38.4.cmml"><mo id="S3.E8.m1.19.19.19.8.8.8" xref="S3.E8.m1.38.38.4a.cmml">(</mo><mrow id="S3.E8.m1.41.41.7.37.25.25.25.1.1.1" xref="S3.E8.m1.38.38.4.cmml"><mrow id="S3.E8.m1.41.41.7.37.25.25.25.1.1.1.1" xref="S3.E8.m1.38.38.4.cmml"><mi id="S3.E8.m1.20.20.20.9.9.9" xref="S3.E8.m1.20.20.20.9.9.9.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.41.41.7.37.25.25.25.1.1.1.1.1" xref="S3.E8.m1.38.38.4a.cmml">​</mo><mfrac id="S3.E8.m1.21.21.21.10.10.10" xref="S3.E8.m1.21.21.21.10.10.10.cmml"><mrow id="S3.E8.m1.21.21.21.10.10.10.2" xref="S3.E8.m1.21.21.21.10.10.10.2.cmml"><mi mathvariant="normal" id="S3.E8.m1.21.21.21.10.10.10.2.2" xref="S3.E8.m1.21.21.21.10.10.10.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.21.21.21.10.10.10.2.1" xref="S3.E8.m1.21.21.21.10.10.10.2.1.cmml">​</mo><msub id="S3.E8.m1.21.21.21.10.10.10.2.3" xref="S3.E8.m1.21.21.21.10.10.10.2.3.cmml"><mi id="S3.E8.m1.21.21.21.10.10.10.2.3.2" xref="S3.E8.m1.21.21.21.10.10.10.2.3.2.cmml">μ</mi><mi id="S3.E8.m1.21.21.21.10.10.10.2.3.3" xref="S3.E8.m1.21.21.21.10.10.10.2.3.3.cmml">i</mi></msub></mrow><msub id="S3.E8.m1.21.21.21.10.10.10.3" xref="S3.E8.m1.21.21.21.10.10.10.3.cmml"><mi id="S3.E8.m1.21.21.21.10.10.10.3.2" xref="S3.E8.m1.21.21.21.10.10.10.3.2.cmml">σ</mi><mi id="S3.E8.m1.21.21.21.10.10.10.3.3" xref="S3.E8.m1.21.21.21.10.10.10.3.3.cmml">i</mi></msub></mfrac></mrow><mo id="S3.E8.m1.22.22.22.11.11.11" xref="S3.E8.m1.22.22.22.11.11.11.cmml">+</mo><msub id="S3.E8.m1.41.41.7.37.25.25.25.1.1.1.2" xref="S3.E8.m1.38.38.4.cmml"><mi id="S3.E8.m1.23.23.23.12.12.12" xref="S3.E8.m1.23.23.23.12.12.12.cmml">β</mi><mi id="S3.E8.m1.24.24.24.13.13.13.1" xref="S3.E8.m1.24.24.24.13.13.13.1.cmml">i</mi></msub></mrow><mo id="S3.E8.m1.25.25.25.14.14.14" xref="S3.E8.m1.38.38.4a.cmml">,</mo><mrow id="S3.E8.m1.42.42.8.38.26.26.26.2.2.2" xref="S3.E8.m1.38.38.4.cmml"><msubsup id="S3.E8.m1.42.42.8.38.26.26.26.2.2.2.3" xref="S3.E8.m1.38.38.4.cmml"><mi id="S3.E8.m1.26.26.26.15.15.15" xref="S3.E8.m1.26.26.26.15.15.15.cmml">γ</mi><mi id="S3.E8.m1.27.27.27.16.16.16.1" xref="S3.E8.m1.27.27.27.16.16.16.1.cmml">i</mi><mn id="S3.E8.m1.28.28.28.17.17.17.1" xref="S3.E8.m1.28.28.28.17.17.17.1.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.E8.m1.42.42.8.38.26.26.26.2.2.2.2" xref="S3.E8.m1.38.38.4a.cmml">​</mo><mrow id="S3.E8.m1.42.42.8.38.26.26.26.2.2.2.1.1" xref="S3.E8.m1.38.38.4.cmml"><mo id="S3.E8.m1.29.29.29.18.18.18" xref="S3.E8.m1.38.38.4a.cmml">(</mo><mrow id="S3.E8.m1.42.42.8.38.26.26.26.2.2.2.1.1.1" xref="S3.E8.m1.38.38.4.cmml"><mn id="S3.E8.m1.30.30.30.19.19.19" xref="S3.E8.m1.30.30.30.19.19.19.cmml">1</mn><mo id="S3.E8.m1.31.31.31.20.20.20" xref="S3.E8.m1.31.31.31.20.20.20.cmml">+</mo><mfrac id="S3.E8.m1.32.32.32.21.21.21" xref="S3.E8.m1.32.32.32.21.21.21.cmml"><mrow id="S3.E8.m1.32.32.32.21.21.21.2" xref="S3.E8.m1.32.32.32.21.21.21.2.cmml"><mi mathvariant="normal" id="S3.E8.m1.32.32.32.21.21.21.2.2" xref="S3.E8.m1.32.32.32.21.21.21.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.32.32.32.21.21.21.2.1" xref="S3.E8.m1.32.32.32.21.21.21.2.1.cmml">​</mo><msubsup id="S3.E8.m1.32.32.32.21.21.21.2.3" xref="S3.E8.m1.32.32.32.21.21.21.2.3.cmml"><mi id="S3.E8.m1.32.32.32.21.21.21.2.3.2.2" xref="S3.E8.m1.32.32.32.21.21.21.2.3.2.2.cmml">σ</mi><mi id="S3.E8.m1.32.32.32.21.21.21.2.3.2.3" xref="S3.E8.m1.32.32.32.21.21.21.2.3.2.3.cmml">i</mi><mn id="S3.E8.m1.32.32.32.21.21.21.2.3.3" xref="S3.E8.m1.32.32.32.21.21.21.2.3.3.cmml">2</mn></msubsup></mrow><msubsup id="S3.E8.m1.32.32.32.21.21.21.3" xref="S3.E8.m1.32.32.32.21.21.21.3.cmml"><mi id="S3.E8.m1.32.32.32.21.21.21.3.2.2" xref="S3.E8.m1.32.32.32.21.21.21.3.2.2.cmml">σ</mi><mi id="S3.E8.m1.32.32.32.21.21.21.3.2.3" xref="S3.E8.m1.32.32.32.21.21.21.3.2.3.cmml">i</mi><mn id="S3.E8.m1.32.32.32.21.21.21.3.3" xref="S3.E8.m1.32.32.32.21.21.21.3.3.cmml">2</mn></msubsup></mfrac></mrow><mo id="S3.E8.m1.33.33.33.22.22.22" xref="S3.E8.m1.38.38.4a.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.34.34.34.23.23.23" xref="S3.E8.m1.38.38.4a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E8.m1.42b"><apply id="S3.E8.m1.38.38.4.cmml" xref="S3.E8.m1.42.42.8"><and id="S3.E8.m1.38.38.4a.cmml" xref="S3.E8.m1.39.39.5.35.12.12.12.2"></and><apply id="S3.E8.m1.38.38.4b.cmml" xref="S3.E8.m1.42.42.8"><csymbol cd="latexml" id="S3.E8.m1.3.3.3.3.3.3.cmml" xref="S3.E8.m1.3.3.3.3.3.3">similar-to</csymbol><apply id="S3.E8.m1.38.38.4.6.cmml" xref="S3.E8.m1.42.42.8"><csymbol cd="ambiguous" id="S3.E8.m1.38.38.4.6.1.cmml" xref="S3.E8.m1.39.39.5.35.12.12.12.2">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><ci id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1">^</ci><apply id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2"><ci id="S3.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2.1">¯</ci><ci id="S3.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2.2">𝑥</ci></apply></apply><ci id="S3.E8.m1.2.2.2.2.2.2.1.cmml" xref="S3.E8.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E8.m1.36.36.2.2.cmml" xref="S3.E8.m1.42.42.8"><times id="S3.E8.m1.36.36.2.2.3.cmml" xref="S3.E8.m1.39.39.5.35.12.12.12.2"></times><ci id="S3.E8.m1.4.4.4.4.4.4.cmml" xref="S3.E8.m1.4.4.4.4.4.4">𝑁</ci><interval closure="open" id="S3.E8.m1.35.35.1.1.1.2.cmml" xref="S3.E8.m1.42.42.8"><apply id="S3.E8.m1.6.6.6.6.6.6.cmml" xref="S3.E8.m1.6.6.6.6.6.6"><divide id="S3.E8.m1.6.6.6.6.6.6.1.cmml" xref="S3.E8.m1.6.6.6.6.6.6"></divide><apply id="S3.E8.m1.6.6.6.6.6.6.2.cmml" xref="S3.E8.m1.6.6.6.6.6.6.2"><times id="S3.E8.m1.6.6.6.6.6.6.2.1.cmml" xref="S3.E8.m1.6.6.6.6.6.6.2.1"></times><ci id="S3.E8.m1.6.6.6.6.6.6.2.2.cmml" xref="S3.E8.m1.6.6.6.6.6.6.2.2">Δ</ci><apply id="S3.E8.m1.6.6.6.6.6.6.2.3.cmml" xref="S3.E8.m1.6.6.6.6.6.6.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.6.6.6.6.2.3.1.cmml" xref="S3.E8.m1.6.6.6.6.6.6.2.3">subscript</csymbol><ci id="S3.E8.m1.6.6.6.6.6.6.2.3.2.cmml" xref="S3.E8.m1.6.6.6.6.6.6.2.3.2">𝜇</ci><ci id="S3.E8.m1.6.6.6.6.6.6.2.3.3.cmml" xref="S3.E8.m1.6.6.6.6.6.6.2.3.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.6.6.6.6.6.6.3.cmml" xref="S3.E8.m1.6.6.6.6.6.6.3"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.6.6.6.6.3.1.cmml" xref="S3.E8.m1.6.6.6.6.6.6.3">subscript</csymbol><ci id="S3.E8.m1.6.6.6.6.6.6.3.2.cmml" xref="S3.E8.m1.6.6.6.6.6.6.3.2">𝜎</ci><ci id="S3.E8.m1.6.6.6.6.6.6.3.3.cmml" xref="S3.E8.m1.6.6.6.6.6.6.3.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.35.35.1.1.1.1.1.cmml" xref="S3.E8.m1.42.42.8"><plus id="S3.E8.m1.9.9.9.9.9.9.cmml" xref="S3.E8.m1.9.9.9.9.9.9"></plus><cn type="integer" id="S3.E8.m1.8.8.8.8.8.8.cmml" xref="S3.E8.m1.8.8.8.8.8.8">1</cn><apply id="S3.E8.m1.10.10.10.10.10.10.cmml" xref="S3.E8.m1.10.10.10.10.10.10"><divide id="S3.E8.m1.10.10.10.10.10.10.1.cmml" xref="S3.E8.m1.10.10.10.10.10.10"></divide><apply id="S3.E8.m1.10.10.10.10.10.10.2.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2"><times id="S3.E8.m1.10.10.10.10.10.10.2.1.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.1"></times><ci id="S3.E8.m1.10.10.10.10.10.10.2.2.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.2">Δ</ci><apply id="S3.E8.m1.10.10.10.10.10.10.2.3.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.10.10.10.10.2.3.1.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.3">superscript</csymbol><apply id="S3.E8.m1.10.10.10.10.10.10.2.3.2.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.10.10.10.10.2.3.2.1.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.3">subscript</csymbol><ci id="S3.E8.m1.10.10.10.10.10.10.2.3.2.2.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.3.2.2">𝜎</ci><ci id="S3.E8.m1.10.10.10.10.10.10.2.3.2.3.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E8.m1.10.10.10.10.10.10.2.3.3.cmml" xref="S3.E8.m1.10.10.10.10.10.10.2.3.3">2</cn></apply></apply><apply id="S3.E8.m1.10.10.10.10.10.10.3.cmml" xref="S3.E8.m1.10.10.10.10.10.10.3"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.10.10.10.10.3.1.cmml" xref="S3.E8.m1.10.10.10.10.10.10.3">superscript</csymbol><apply id="S3.E8.m1.10.10.10.10.10.10.3.2.cmml" xref="S3.E8.m1.10.10.10.10.10.10.3"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.10.10.10.10.3.2.1.cmml" xref="S3.E8.m1.10.10.10.10.10.10.3">subscript</csymbol><ci id="S3.E8.m1.10.10.10.10.10.10.3.2.2.cmml" xref="S3.E8.m1.10.10.10.10.10.10.3.2.2">𝜎</ci><ci id="S3.E8.m1.10.10.10.10.10.10.3.2.3.cmml" xref="S3.E8.m1.10.10.10.10.10.10.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E8.m1.10.10.10.10.10.10.3.3.cmml" xref="S3.E8.m1.10.10.10.10.10.10.3.3">2</cn></apply></apply></apply></interval><ci id="S3.E8.m1.12.12.12.1.1.1.cmml" xref="S3.E8.m1.12.12.12.1.1.1">BN</ci><apply id="S3.E8.m1.36.36.2.2.2.1.1.cmml" xref="S3.E8.m1.42.42.8"><csymbol cd="ambiguous" id="S3.E8.m1.36.36.2.2.2.1.1.1.cmml" xref="S3.E8.m1.42.42.8">subscript</csymbol><apply id="S3.E8.m1.14.14.14.3.3.3.cmml" xref="S3.E8.m1.14.14.14.3.3.3"><ci id="S3.E8.m1.14.14.14.3.3.3.1.cmml" xref="S3.E8.m1.14.14.14.3.3.3.1">^</ci><apply id="S3.E8.m1.14.14.14.3.3.3.2.cmml" xref="S3.E8.m1.14.14.14.3.3.3.2"><ci id="S3.E8.m1.14.14.14.3.3.3.2.1.cmml" xref="S3.E8.m1.14.14.14.3.3.3.2.1">¯</ci><ci id="S3.E8.m1.14.14.14.3.3.3.2.2.cmml" xref="S3.E8.m1.14.14.14.3.3.3.2.2">𝑥</ci></apply></apply><ci id="S3.E8.m1.15.15.15.4.4.4.1.cmml" xref="S3.E8.m1.15.15.15.4.4.4.1">𝑖</ci></apply></apply></apply><apply id="S3.E8.m1.38.38.4c.cmml" xref="S3.E8.m1.42.42.8"><csymbol cd="latexml" id="S3.E8.m1.17.17.17.6.6.6.cmml" xref="S3.E8.m1.17.17.17.6.6.6">similar-to</csymbol><share href="#S3.E8.m1.36.36.2.2.cmml" id="S3.E8.m1.38.38.4d.cmml" xref="S3.E8.m1.39.39.5.35.12.12.12.2"></share><apply id="S3.E8.m1.38.38.4.4.cmml" xref="S3.E8.m1.42.42.8"><times id="S3.E8.m1.38.38.4.4.3.cmml" xref="S3.E8.m1.39.39.5.35.12.12.12.2"></times><ci id="S3.E8.m1.18.18.18.7.7.7.cmml" xref="S3.E8.m1.18.18.18.7.7.7">𝑁</ci><interval closure="open" id="S3.E8.m1.38.38.4.4.2.3.cmml" xref="S3.E8.m1.42.42.8"><apply id="S3.E8.m1.37.37.3.3.1.1.1.cmml" xref="S3.E8.m1.42.42.8"><plus id="S3.E8.m1.22.22.22.11.11.11.cmml" xref="S3.E8.m1.22.22.22.11.11.11"></plus><apply id="S3.E8.m1.37.37.3.3.1.1.1.2.cmml" xref="S3.E8.m1.42.42.8"><times id="S3.E8.m1.37.37.3.3.1.1.1.2.1.cmml" xref="S3.E8.m1.42.42.8"></times><ci id="S3.E8.m1.20.20.20.9.9.9.cmml" xref="S3.E8.m1.20.20.20.9.9.9">𝛾</ci><apply id="S3.E8.m1.21.21.21.10.10.10.cmml" xref="S3.E8.m1.21.21.21.10.10.10"><divide id="S3.E8.m1.21.21.21.10.10.10.1.cmml" xref="S3.E8.m1.21.21.21.10.10.10"></divide><apply id="S3.E8.m1.21.21.21.10.10.10.2.cmml" xref="S3.E8.m1.21.21.21.10.10.10.2"><times id="S3.E8.m1.21.21.21.10.10.10.2.1.cmml" xref="S3.E8.m1.21.21.21.10.10.10.2.1"></times><ci id="S3.E8.m1.21.21.21.10.10.10.2.2.cmml" xref="S3.E8.m1.21.21.21.10.10.10.2.2">Δ</ci><apply id="S3.E8.m1.21.21.21.10.10.10.2.3.cmml" xref="S3.E8.m1.21.21.21.10.10.10.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.21.21.21.10.10.10.2.3.1.cmml" xref="S3.E8.m1.21.21.21.10.10.10.2.3">subscript</csymbol><ci id="S3.E8.m1.21.21.21.10.10.10.2.3.2.cmml" xref="S3.E8.m1.21.21.21.10.10.10.2.3.2">𝜇</ci><ci id="S3.E8.m1.21.21.21.10.10.10.2.3.3.cmml" xref="S3.E8.m1.21.21.21.10.10.10.2.3.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.21.21.21.10.10.10.3.cmml" xref="S3.E8.m1.21.21.21.10.10.10.3"><csymbol cd="ambiguous" id="S3.E8.m1.21.21.21.10.10.10.3.1.cmml" xref="S3.E8.m1.21.21.21.10.10.10.3">subscript</csymbol><ci id="S3.E8.m1.21.21.21.10.10.10.3.2.cmml" xref="S3.E8.m1.21.21.21.10.10.10.3.2">𝜎</ci><ci id="S3.E8.m1.21.21.21.10.10.10.3.3.cmml" xref="S3.E8.m1.21.21.21.10.10.10.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E8.m1.37.37.3.3.1.1.1.3.cmml" xref="S3.E8.m1.42.42.8"><csymbol cd="ambiguous" id="S3.E8.m1.37.37.3.3.1.1.1.3.1.cmml" xref="S3.E8.m1.42.42.8">subscript</csymbol><ci id="S3.E8.m1.23.23.23.12.12.12.cmml" xref="S3.E8.m1.23.23.23.12.12.12">𝛽</ci><ci id="S3.E8.m1.24.24.24.13.13.13.1.cmml" xref="S3.E8.m1.24.24.24.13.13.13.1">𝑖</ci></apply></apply><apply id="S3.E8.m1.38.38.4.4.2.2.2.cmml" xref="S3.E8.m1.42.42.8"><times id="S3.E8.m1.38.38.4.4.2.2.2.2.cmml" xref="S3.E8.m1.42.42.8"></times><apply id="S3.E8.m1.38.38.4.4.2.2.2.3.cmml" xref="S3.E8.m1.42.42.8"><csymbol cd="ambiguous" id="S3.E8.m1.38.38.4.4.2.2.2.3.1.cmml" xref="S3.E8.m1.42.42.8">superscript</csymbol><apply id="S3.E8.m1.38.38.4.4.2.2.2.3.2.cmml" xref="S3.E8.m1.42.42.8"><csymbol cd="ambiguous" id="S3.E8.m1.38.38.4.4.2.2.2.3.2.1.cmml" xref="S3.E8.m1.42.42.8">subscript</csymbol><ci id="S3.E8.m1.26.26.26.15.15.15.cmml" xref="S3.E8.m1.26.26.26.15.15.15">𝛾</ci><ci id="S3.E8.m1.27.27.27.16.16.16.1.cmml" xref="S3.E8.m1.27.27.27.16.16.16.1">𝑖</ci></apply><cn type="integer" id="S3.E8.m1.28.28.28.17.17.17.1.cmml" xref="S3.E8.m1.28.28.28.17.17.17.1">2</cn></apply><apply id="S3.E8.m1.38.38.4.4.2.2.2.1.1.1.cmml" xref="S3.E8.m1.42.42.8"><plus id="S3.E8.m1.31.31.31.20.20.20.cmml" xref="S3.E8.m1.31.31.31.20.20.20"></plus><cn type="integer" id="S3.E8.m1.30.30.30.19.19.19.cmml" xref="S3.E8.m1.30.30.30.19.19.19">1</cn><apply id="S3.E8.m1.32.32.32.21.21.21.cmml" xref="S3.E8.m1.32.32.32.21.21.21"><divide id="S3.E8.m1.32.32.32.21.21.21.1.cmml" xref="S3.E8.m1.32.32.32.21.21.21"></divide><apply id="S3.E8.m1.32.32.32.21.21.21.2.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2"><times id="S3.E8.m1.32.32.32.21.21.21.2.1.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.1"></times><ci id="S3.E8.m1.32.32.32.21.21.21.2.2.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.2">Δ</ci><apply id="S3.E8.m1.32.32.32.21.21.21.2.3.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.32.32.32.21.21.21.2.3.1.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.3">superscript</csymbol><apply id="S3.E8.m1.32.32.32.21.21.21.2.3.2.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.32.32.32.21.21.21.2.3.2.1.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.3">subscript</csymbol><ci id="S3.E8.m1.32.32.32.21.21.21.2.3.2.2.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.3.2.2">𝜎</ci><ci id="S3.E8.m1.32.32.32.21.21.21.2.3.2.3.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E8.m1.32.32.32.21.21.21.2.3.3.cmml" xref="S3.E8.m1.32.32.32.21.21.21.2.3.3">2</cn></apply></apply><apply id="S3.E8.m1.32.32.32.21.21.21.3.cmml" xref="S3.E8.m1.32.32.32.21.21.21.3"><csymbol cd="ambiguous" id="S3.E8.m1.32.32.32.21.21.21.3.1.cmml" xref="S3.E8.m1.32.32.32.21.21.21.3">superscript</csymbol><apply id="S3.E8.m1.32.32.32.21.21.21.3.2.cmml" xref="S3.E8.m1.32.32.32.21.21.21.3"><csymbol cd="ambiguous" id="S3.E8.m1.32.32.32.21.21.21.3.2.1.cmml" xref="S3.E8.m1.32.32.32.21.21.21.3">subscript</csymbol><ci id="S3.E8.m1.32.32.32.21.21.21.3.2.2.cmml" xref="S3.E8.m1.32.32.32.21.21.21.3.2.2">𝜎</ci><ci id="S3.E8.m1.32.32.32.21.21.21.3.2.3.cmml" xref="S3.E8.m1.32.32.32.21.21.21.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E8.m1.32.32.32.21.21.21.3.3.cmml" xref="S3.E8.m1.32.32.32.21.21.21.3.3">2</cn></apply></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.42c">\begin{gathered}\hat{\bar{x}}_{i}\sim N\left(\frac{\Delta\mu_{i}}{\sigma_{i}},1+\frac{\Delta\sigma_{i}^{2}}{\sigma_{i}^{2}}\right)\\
\mathrm{BN}(\hat{\bar{x}}_{i})\sim N\left(\gamma\frac{\Delta\mu_{i}}{\sigma_{i}}+\beta_{i},\gamma_{i}^{2}\left(1+\frac{\Delta\sigma_{i}^{2}}{\sigma_{i}^{2}}\right)\right)\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p10" class="ltx_para ltx_noindent">
<p id="S3.SS2.p10.4" class="ltx_p">If the BN layer is <em id="S3.SS2.p10.4.1" class="ltx_emph ltx_font_italic">not</em> a patch layer (i.e., the client is participating in FL, with federated BN values <math id="S3.SS2.p10.1.m1.1" class="ltx_Math" alttext="\bar{\mu}" display="inline"><semantics id="S3.SS2.p10.1.m1.1a"><mover accent="true" id="S3.SS2.p10.1.m1.1.1" xref="S3.SS2.p10.1.m1.1.1.cmml"><mi id="S3.SS2.p10.1.m1.1.1.2" xref="S3.SS2.p10.1.m1.1.1.2.cmml">μ</mi><mo id="S3.SS2.p10.1.m1.1.1.1" xref="S3.SS2.p10.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.1.m1.1b"><apply id="S3.SS2.p10.1.m1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1"><ci id="S3.SS2.p10.1.m1.1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1.1">¯</ci><ci id="S3.SS2.p10.1.m1.1.1.2.cmml" xref="S3.SS2.p10.1.m1.1.1.2">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.1.m1.1c">\bar{\mu}</annotation></semantics></math>, <math id="S3.SS2.p10.2.m2.1" class="ltx_Math" alttext="\bar{\sigma}" display="inline"><semantics id="S3.SS2.p10.2.m2.1a"><mover accent="true" id="S3.SS2.p10.2.m2.1.1" xref="S3.SS2.p10.2.m2.1.1.cmml"><mi id="S3.SS2.p10.2.m2.1.1.2" xref="S3.SS2.p10.2.m2.1.1.2.cmml">σ</mi><mo id="S3.SS2.p10.2.m2.1.1.1" xref="S3.SS2.p10.2.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.2.m2.1b"><apply id="S3.SS2.p10.2.m2.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1"><ci id="S3.SS2.p10.2.m2.1.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1.1">¯</ci><ci id="S3.SS2.p10.2.m2.1.1.2.cmml" xref="S3.SS2.p10.2.m2.1.1.2">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.2.m2.1c">\bar{\sigma}</annotation></semantics></math>, <math id="S3.SS2.p10.3.m3.1" class="ltx_Math" alttext="\bar{\beta}" display="inline"><semantics id="S3.SS2.p10.3.m3.1a"><mover accent="true" id="S3.SS2.p10.3.m3.1.1" xref="S3.SS2.p10.3.m3.1.1.cmml"><mi id="S3.SS2.p10.3.m3.1.1.2" xref="S3.SS2.p10.3.m3.1.1.2.cmml">β</mi><mo id="S3.SS2.p10.3.m3.1.1.1" xref="S3.SS2.p10.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.3.m3.1b"><apply id="S3.SS2.p10.3.m3.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1"><ci id="S3.SS2.p10.3.m3.1.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1.1">¯</ci><ci id="S3.SS2.p10.3.m3.1.1.2.cmml" xref="S3.SS2.p10.3.m3.1.1.2">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.3.m3.1c">\bar{\beta}</annotation></semantics></math>, <math id="S3.SS2.p10.4.m4.1" class="ltx_Math" alttext="\bar{\gamma}" display="inline"><semantics id="S3.SS2.p10.4.m4.1a"><mover accent="true" id="S3.SS2.p10.4.m4.1.1" xref="S3.SS2.p10.4.m4.1.1.cmml"><mi id="S3.SS2.p10.4.m4.1.1.2" xref="S3.SS2.p10.4.m4.1.1.2.cmml">γ</mi><mo id="S3.SS2.p10.4.m4.1.1.1" xref="S3.SS2.p10.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.4.m4.1b"><apply id="S3.SS2.p10.4.m4.1.1.cmml" xref="S3.SS2.p10.4.m4.1.1"><ci id="S3.SS2.p10.4.m4.1.1.1.cmml" xref="S3.SS2.p10.4.m4.1.1.1">¯</ci><ci id="S3.SS2.p10.4.m4.1.1.2.cmml" xref="S3.SS2.p10.4.m4.1.1.2">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.4.m4.1c">\bar{\gamma}</annotation></semantics></math>), the output of the BN layer is:</p>
</div>
<div id="S3.SS2.p11" class="ltx_para">
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.34" class="ltx_Math" alttext="\begin{gathered}\hat{\bar{x}}_{i}\sim N\left(\frac{\mu_{i}+\Delta\mu_{i}-\bar{\mu}_{i}}{\bar{\sigma}_{i}},\frac{\sigma_{i}^{2}+\Delta\sigma_{i}^{2}}{\bar{\sigma}_{i}^{2}}\right)\\
\overline{\mathrm{BN}}(\hat{\bar{x}}_{i})\sim N\left(\bar{\gamma}\frac{\mu_{i}+\Delta\mu_{i}-\bar{\mu}_{i}}{\bar{\sigma}_{i}}+\bar{\beta}_{i},\bar{\gamma}_{i}^{2}\frac{\sigma_{i}^{2}+\Delta\sigma_{i}^{2}}{\bar{\sigma}_{i}^{2}}\right)\end{gathered}" display="block"><semantics id="S3.E9.m1.34a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E9.m1.34.34.6" xref="S3.E9.m1.31.31.3.cmml"><mtr id="S3.E9.m1.34.34.6a" xref="S3.E9.m1.31.31.3.cmml"><mtd id="S3.E9.m1.34.34.6b" xref="S3.E9.m1.31.31.3.cmml"><mrow id="S3.E9.m1.9.9.9.9.9" xref="S3.E9.m1.31.31.3.cmml"><msub id="S3.E9.m1.9.9.9.9.9.10" xref="S3.E9.m1.31.31.3.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S3.E9.m1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mo id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mi id="S3.E9.m1.2.2.2.2.2.2.1" xref="S3.E9.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo id="S3.E9.m1.3.3.3.3.3.3" xref="S3.E9.m1.3.3.3.3.3.3.cmml">∼</mo><mrow id="S3.E9.m1.9.9.9.9.9.11" xref="S3.E9.m1.31.31.3.cmml"><mi id="S3.E9.m1.4.4.4.4.4.4" xref="S3.E9.m1.4.4.4.4.4.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.9.9.9.9.9.11.1" xref="S3.E9.m1.31.31.3a.cmml">​</mo><mrow id="S3.E9.m1.9.9.9.9.9.11.2" xref="S3.E9.m1.31.31.3.cmml"><mo id="S3.E9.m1.5.5.5.5.5.5" xref="S3.E9.m1.31.31.3a.cmml">(</mo><mfrac id="S3.E9.m1.6.6.6.6.6.6" xref="S3.E9.m1.6.6.6.6.6.6.cmml"><mrow id="S3.E9.m1.6.6.6.6.6.6.2" xref="S3.E9.m1.6.6.6.6.6.6.2.cmml"><mrow id="S3.E9.m1.6.6.6.6.6.6.2.2" xref="S3.E9.m1.6.6.6.6.6.6.2.2.cmml"><msub id="S3.E9.m1.6.6.6.6.6.6.2.2.2" xref="S3.E9.m1.6.6.6.6.6.6.2.2.2.cmml"><mi id="S3.E9.m1.6.6.6.6.6.6.2.2.2.2" xref="S3.E9.m1.6.6.6.6.6.6.2.2.2.2.cmml">μ</mi><mi id="S3.E9.m1.6.6.6.6.6.6.2.2.2.3" xref="S3.E9.m1.6.6.6.6.6.6.2.2.2.3.cmml">i</mi></msub><mo id="S3.E9.m1.6.6.6.6.6.6.2.2.1" xref="S3.E9.m1.6.6.6.6.6.6.2.2.1.cmml">+</mo><mrow id="S3.E9.m1.6.6.6.6.6.6.2.2.3" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.cmml"><mi mathvariant="normal" id="S3.E9.m1.6.6.6.6.6.6.2.2.3.2" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.6.6.6.6.6.6.2.2.3.1" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.1.cmml">​</mo><msub id="S3.E9.m1.6.6.6.6.6.6.2.2.3.3" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.cmml"><mi id="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.2" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.2.cmml">μ</mi><mi id="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.3" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E9.m1.6.6.6.6.6.6.2.1" xref="S3.E9.m1.6.6.6.6.6.6.2.1.cmml">−</mo><msub id="S3.E9.m1.6.6.6.6.6.6.2.3" xref="S3.E9.m1.6.6.6.6.6.6.2.3.cmml"><mover accent="true" id="S3.E9.m1.6.6.6.6.6.6.2.3.2" xref="S3.E9.m1.6.6.6.6.6.6.2.3.2.cmml"><mi id="S3.E9.m1.6.6.6.6.6.6.2.3.2.2" xref="S3.E9.m1.6.6.6.6.6.6.2.3.2.2.cmml">μ</mi><mo id="S3.E9.m1.6.6.6.6.6.6.2.3.2.1" xref="S3.E9.m1.6.6.6.6.6.6.2.3.2.1.cmml">¯</mo></mover><mi id="S3.E9.m1.6.6.6.6.6.6.2.3.3" xref="S3.E9.m1.6.6.6.6.6.6.2.3.3.cmml">i</mi></msub></mrow><msub id="S3.E9.m1.6.6.6.6.6.6.3" xref="S3.E9.m1.6.6.6.6.6.6.3.cmml"><mover accent="true" id="S3.E9.m1.6.6.6.6.6.6.3.2" xref="S3.E9.m1.6.6.6.6.6.6.3.2.cmml"><mi id="S3.E9.m1.6.6.6.6.6.6.3.2.2" xref="S3.E9.m1.6.6.6.6.6.6.3.2.2.cmml">σ</mi><mo id="S3.E9.m1.6.6.6.6.6.6.3.2.1" xref="S3.E9.m1.6.6.6.6.6.6.3.2.1.cmml">¯</mo></mover><mi id="S3.E9.m1.6.6.6.6.6.6.3.3" xref="S3.E9.m1.6.6.6.6.6.6.3.3.cmml">i</mi></msub></mfrac><mo id="S3.E9.m1.7.7.7.7.7.7" xref="S3.E9.m1.31.31.3a.cmml">,</mo><mfrac id="S3.E9.m1.8.8.8.8.8.8" xref="S3.E9.m1.8.8.8.8.8.8.cmml"><mrow id="S3.E9.m1.8.8.8.8.8.8.2" xref="S3.E9.m1.8.8.8.8.8.8.2.cmml"><msubsup id="S3.E9.m1.8.8.8.8.8.8.2.2" xref="S3.E9.m1.8.8.8.8.8.8.2.2.cmml"><mi id="S3.E9.m1.8.8.8.8.8.8.2.2.2.2" xref="S3.E9.m1.8.8.8.8.8.8.2.2.2.2.cmml">σ</mi><mi id="S3.E9.m1.8.8.8.8.8.8.2.2.2.3" xref="S3.E9.m1.8.8.8.8.8.8.2.2.2.3.cmml">i</mi><mn id="S3.E9.m1.8.8.8.8.8.8.2.2.3" xref="S3.E9.m1.8.8.8.8.8.8.2.2.3.cmml">2</mn></msubsup><mo id="S3.E9.m1.8.8.8.8.8.8.2.1" xref="S3.E9.m1.8.8.8.8.8.8.2.1.cmml">+</mo><mrow id="S3.E9.m1.8.8.8.8.8.8.2.3" xref="S3.E9.m1.8.8.8.8.8.8.2.3.cmml"><mi mathvariant="normal" id="S3.E9.m1.8.8.8.8.8.8.2.3.2" xref="S3.E9.m1.8.8.8.8.8.8.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.8.8.8.8.8.8.2.3.1" xref="S3.E9.m1.8.8.8.8.8.8.2.3.1.cmml">​</mo><msubsup id="S3.E9.m1.8.8.8.8.8.8.2.3.3" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3.cmml"><mi id="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.2" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.2.cmml">σ</mi><mi id="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.3" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.3.cmml">i</mi><mn id="S3.E9.m1.8.8.8.8.8.8.2.3.3.3" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3.3.cmml">2</mn></msubsup></mrow></mrow><msubsup id="S3.E9.m1.8.8.8.8.8.8.3" xref="S3.E9.m1.8.8.8.8.8.8.3.cmml"><mover accent="true" id="S3.E9.m1.8.8.8.8.8.8.3.2.2" xref="S3.E9.m1.8.8.8.8.8.8.3.2.2.cmml"><mi id="S3.E9.m1.8.8.8.8.8.8.3.2.2.2" xref="S3.E9.m1.8.8.8.8.8.8.3.2.2.2.cmml">σ</mi><mo id="S3.E9.m1.8.8.8.8.8.8.3.2.2.1" xref="S3.E9.m1.8.8.8.8.8.8.3.2.2.1.cmml">¯</mo></mover><mi id="S3.E9.m1.8.8.8.8.8.8.3.2.3" xref="S3.E9.m1.8.8.8.8.8.8.3.2.3.cmml">i</mi><mn id="S3.E9.m1.8.8.8.8.8.8.3.3" xref="S3.E9.m1.8.8.8.8.8.8.3.3.cmml">2</mn></msubsup></mfrac><mo id="S3.E9.m1.9.9.9.9.9.9" xref="S3.E9.m1.31.31.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E9.m1.34.34.6c" xref="S3.E9.m1.31.31.3.cmml"><mtd id="S3.E9.m1.34.34.6d" xref="S3.E9.m1.31.31.3.cmml"><mrow id="S3.E9.m1.34.34.6.31.22.22" xref="S3.E9.m1.31.31.3.cmml"><mrow id="S3.E9.m1.32.32.4.29.20.20.20" xref="S3.E9.m1.31.31.3.cmml"><mover accent="true" id="S3.E9.m1.10.10.10.1.1.1" xref="S3.E9.m1.10.10.10.1.1.1.cmml"><mi id="S3.E9.m1.10.10.10.1.1.1.2" xref="S3.E9.m1.10.10.10.1.1.1.2.cmml">BN</mi><mo id="S3.E9.m1.10.10.10.1.1.1.1" xref="S3.E9.m1.10.10.10.1.1.1.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S3.E9.m1.32.32.4.29.20.20.20.2" xref="S3.E9.m1.31.31.3a.cmml">​</mo><mrow id="S3.E9.m1.32.32.4.29.20.20.20.1.1" xref="S3.E9.m1.31.31.3.cmml"><mo stretchy="false" id="S3.E9.m1.11.11.11.2.2.2" xref="S3.E9.m1.31.31.3a.cmml">(</mo><msub id="S3.E9.m1.32.32.4.29.20.20.20.1.1.1" xref="S3.E9.m1.31.31.3.cmml"><mover accent="true" id="S3.E9.m1.12.12.12.3.3.3" xref="S3.E9.m1.12.12.12.3.3.3.cmml"><mover accent="true" id="S3.E9.m1.12.12.12.3.3.3.2" xref="S3.E9.m1.12.12.12.3.3.3.2.cmml"><mi id="S3.E9.m1.12.12.12.3.3.3.2.2" xref="S3.E9.m1.12.12.12.3.3.3.2.2.cmml">x</mi><mo id="S3.E9.m1.12.12.12.3.3.3.2.1" xref="S3.E9.m1.12.12.12.3.3.3.2.1.cmml">¯</mo></mover><mo id="S3.E9.m1.12.12.12.3.3.3.1" xref="S3.E9.m1.12.12.12.3.3.3.1.cmml">^</mo></mover><mi id="S3.E9.m1.13.13.13.4.4.4.1" xref="S3.E9.m1.13.13.13.4.4.4.1.cmml">i</mi></msub><mo stretchy="false" id="S3.E9.m1.14.14.14.5.5.5" xref="S3.E9.m1.31.31.3a.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.15.15.15.6.6.6" xref="S3.E9.m1.15.15.15.6.6.6.cmml">∼</mo><mrow id="S3.E9.m1.34.34.6.31.22.22.22" xref="S3.E9.m1.31.31.3.cmml"><mi id="S3.E9.m1.16.16.16.7.7.7" xref="S3.E9.m1.16.16.16.7.7.7.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.34.34.6.31.22.22.22.3" xref="S3.E9.m1.31.31.3a.cmml">​</mo><mrow id="S3.E9.m1.34.34.6.31.22.22.22.2.2" xref="S3.E9.m1.31.31.3.cmml"><mo id="S3.E9.m1.17.17.17.8.8.8" xref="S3.E9.m1.31.31.3a.cmml">(</mo><mrow id="S3.E9.m1.33.33.5.30.21.21.21.1.1.1" xref="S3.E9.m1.31.31.3.cmml"><mrow id="S3.E9.m1.33.33.5.30.21.21.21.1.1.1.1" xref="S3.E9.m1.31.31.3.cmml"><mover accent="true" id="S3.E9.m1.18.18.18.9.9.9" xref="S3.E9.m1.18.18.18.9.9.9.cmml"><mi id="S3.E9.m1.18.18.18.9.9.9.2" xref="S3.E9.m1.18.18.18.9.9.9.2.cmml">γ</mi><mo id="S3.E9.m1.18.18.18.9.9.9.1" xref="S3.E9.m1.18.18.18.9.9.9.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S3.E9.m1.33.33.5.30.21.21.21.1.1.1.1.1" xref="S3.E9.m1.31.31.3a.cmml">​</mo><mfrac id="S3.E9.m1.19.19.19.10.10.10" xref="S3.E9.m1.19.19.19.10.10.10.cmml"><mrow id="S3.E9.m1.19.19.19.10.10.10.2" xref="S3.E9.m1.19.19.19.10.10.10.2.cmml"><mrow id="S3.E9.m1.19.19.19.10.10.10.2.2" xref="S3.E9.m1.19.19.19.10.10.10.2.2.cmml"><msub id="S3.E9.m1.19.19.19.10.10.10.2.2.2" xref="S3.E9.m1.19.19.19.10.10.10.2.2.2.cmml"><mi id="S3.E9.m1.19.19.19.10.10.10.2.2.2.2" xref="S3.E9.m1.19.19.19.10.10.10.2.2.2.2.cmml">μ</mi><mi id="S3.E9.m1.19.19.19.10.10.10.2.2.2.3" xref="S3.E9.m1.19.19.19.10.10.10.2.2.2.3.cmml">i</mi></msub><mo id="S3.E9.m1.19.19.19.10.10.10.2.2.1" xref="S3.E9.m1.19.19.19.10.10.10.2.2.1.cmml">+</mo><mrow id="S3.E9.m1.19.19.19.10.10.10.2.2.3" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.cmml"><mi mathvariant="normal" id="S3.E9.m1.19.19.19.10.10.10.2.2.3.2" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.19.19.19.10.10.10.2.2.3.1" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.1.cmml">​</mo><msub id="S3.E9.m1.19.19.19.10.10.10.2.2.3.3" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.cmml"><mi id="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.2" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.2.cmml">μ</mi><mi id="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.3" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E9.m1.19.19.19.10.10.10.2.1" xref="S3.E9.m1.19.19.19.10.10.10.2.1.cmml">−</mo><msub id="S3.E9.m1.19.19.19.10.10.10.2.3" xref="S3.E9.m1.19.19.19.10.10.10.2.3.cmml"><mover accent="true" id="S3.E9.m1.19.19.19.10.10.10.2.3.2" xref="S3.E9.m1.19.19.19.10.10.10.2.3.2.cmml"><mi id="S3.E9.m1.19.19.19.10.10.10.2.3.2.2" xref="S3.E9.m1.19.19.19.10.10.10.2.3.2.2.cmml">μ</mi><mo id="S3.E9.m1.19.19.19.10.10.10.2.3.2.1" xref="S3.E9.m1.19.19.19.10.10.10.2.3.2.1.cmml">¯</mo></mover><mi id="S3.E9.m1.19.19.19.10.10.10.2.3.3" xref="S3.E9.m1.19.19.19.10.10.10.2.3.3.cmml">i</mi></msub></mrow><msub id="S3.E9.m1.19.19.19.10.10.10.3" xref="S3.E9.m1.19.19.19.10.10.10.3.cmml"><mover accent="true" id="S3.E9.m1.19.19.19.10.10.10.3.2" xref="S3.E9.m1.19.19.19.10.10.10.3.2.cmml"><mi id="S3.E9.m1.19.19.19.10.10.10.3.2.2" xref="S3.E9.m1.19.19.19.10.10.10.3.2.2.cmml">σ</mi><mo id="S3.E9.m1.19.19.19.10.10.10.3.2.1" xref="S3.E9.m1.19.19.19.10.10.10.3.2.1.cmml">¯</mo></mover><mi id="S3.E9.m1.19.19.19.10.10.10.3.3" xref="S3.E9.m1.19.19.19.10.10.10.3.3.cmml">i</mi></msub></mfrac></mrow><mo id="S3.E9.m1.20.20.20.11.11.11" xref="S3.E9.m1.20.20.20.11.11.11.cmml">+</mo><msub id="S3.E9.m1.33.33.5.30.21.21.21.1.1.1.2" xref="S3.E9.m1.31.31.3.cmml"><mover accent="true" id="S3.E9.m1.21.21.21.12.12.12" xref="S3.E9.m1.21.21.21.12.12.12.cmml"><mi id="S3.E9.m1.21.21.21.12.12.12.2" xref="S3.E9.m1.21.21.21.12.12.12.2.cmml">β</mi><mo id="S3.E9.m1.21.21.21.12.12.12.1" xref="S3.E9.m1.21.21.21.12.12.12.1.cmml">¯</mo></mover><mi id="S3.E9.m1.22.22.22.13.13.13.1" xref="S3.E9.m1.22.22.22.13.13.13.1.cmml">i</mi></msub></mrow><mo id="S3.E9.m1.23.23.23.14.14.14" xref="S3.E9.m1.31.31.3a.cmml">,</mo><mrow id="S3.E9.m1.34.34.6.31.22.22.22.2.2.2" xref="S3.E9.m1.31.31.3.cmml"><msubsup id="S3.E9.m1.34.34.6.31.22.22.22.2.2.2.2" xref="S3.E9.m1.31.31.3.cmml"><mover accent="true" id="S3.E9.m1.24.24.24.15.15.15" xref="S3.E9.m1.24.24.24.15.15.15.cmml"><mi id="S3.E9.m1.24.24.24.15.15.15.2" xref="S3.E9.m1.24.24.24.15.15.15.2.cmml">γ</mi><mo id="S3.E9.m1.24.24.24.15.15.15.1" xref="S3.E9.m1.24.24.24.15.15.15.1.cmml">¯</mo></mover><mi id="S3.E9.m1.25.25.25.16.16.16.1" xref="S3.E9.m1.25.25.25.16.16.16.1.cmml">i</mi><mn id="S3.E9.m1.26.26.26.17.17.17.1" xref="S3.E9.m1.26.26.26.17.17.17.1.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.E9.m1.34.34.6.31.22.22.22.2.2.2.1" xref="S3.E9.m1.31.31.3a.cmml">​</mo><mfrac id="S3.E9.m1.27.27.27.18.18.18" xref="S3.E9.m1.27.27.27.18.18.18.cmml"><mrow id="S3.E9.m1.27.27.27.18.18.18.2" xref="S3.E9.m1.27.27.27.18.18.18.2.cmml"><msubsup id="S3.E9.m1.27.27.27.18.18.18.2.2" xref="S3.E9.m1.27.27.27.18.18.18.2.2.cmml"><mi id="S3.E9.m1.27.27.27.18.18.18.2.2.2.2" xref="S3.E9.m1.27.27.27.18.18.18.2.2.2.2.cmml">σ</mi><mi id="S3.E9.m1.27.27.27.18.18.18.2.2.2.3" xref="S3.E9.m1.27.27.27.18.18.18.2.2.2.3.cmml">i</mi><mn id="S3.E9.m1.27.27.27.18.18.18.2.2.3" xref="S3.E9.m1.27.27.27.18.18.18.2.2.3.cmml">2</mn></msubsup><mo id="S3.E9.m1.27.27.27.18.18.18.2.1" xref="S3.E9.m1.27.27.27.18.18.18.2.1.cmml">+</mo><mrow id="S3.E9.m1.27.27.27.18.18.18.2.3" xref="S3.E9.m1.27.27.27.18.18.18.2.3.cmml"><mi mathvariant="normal" id="S3.E9.m1.27.27.27.18.18.18.2.3.2" xref="S3.E9.m1.27.27.27.18.18.18.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.27.27.27.18.18.18.2.3.1" xref="S3.E9.m1.27.27.27.18.18.18.2.3.1.cmml">​</mo><msubsup id="S3.E9.m1.27.27.27.18.18.18.2.3.3" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3.cmml"><mi id="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.2" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.2.cmml">σ</mi><mi id="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.3" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.3.cmml">i</mi><mn id="S3.E9.m1.27.27.27.18.18.18.2.3.3.3" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3.3.cmml">2</mn></msubsup></mrow></mrow><msubsup id="S3.E9.m1.27.27.27.18.18.18.3" xref="S3.E9.m1.27.27.27.18.18.18.3.cmml"><mover accent="true" id="S3.E9.m1.27.27.27.18.18.18.3.2.2" xref="S3.E9.m1.27.27.27.18.18.18.3.2.2.cmml"><mi id="S3.E9.m1.27.27.27.18.18.18.3.2.2.2" xref="S3.E9.m1.27.27.27.18.18.18.3.2.2.2.cmml">σ</mi><mo id="S3.E9.m1.27.27.27.18.18.18.3.2.2.1" xref="S3.E9.m1.27.27.27.18.18.18.3.2.2.1.cmml">¯</mo></mover><mi id="S3.E9.m1.27.27.27.18.18.18.3.2.3" xref="S3.E9.m1.27.27.27.18.18.18.3.2.3.cmml">i</mi><mn id="S3.E9.m1.27.27.27.18.18.18.3.3" xref="S3.E9.m1.27.27.27.18.18.18.3.3.cmml">2</mn></msubsup></mfrac></mrow><mo id="S3.E9.m1.28.28.28.19.19.19" xref="S3.E9.m1.31.31.3a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E9.m1.34b"><apply id="S3.E9.m1.31.31.3.cmml" xref="S3.E9.m1.34.34.6"><and id="S3.E9.m1.31.31.3a.cmml" xref="S3.E9.m1.9.9.9.9.9.11.1"></and><apply id="S3.E9.m1.31.31.3b.cmml" xref="S3.E9.m1.34.34.6"><csymbol cd="latexml" id="S3.E9.m1.3.3.3.3.3.3.cmml" xref="S3.E9.m1.3.3.3.3.3.3">similar-to</csymbol><apply id="S3.E9.m1.31.31.3.5.cmml" xref="S3.E9.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E9.m1.31.31.3.5.1.cmml" xref="S3.E9.m1.9.9.9.9.9.11.1">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><ci id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1">^</ci><apply id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2"><ci id="S3.E9.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.1">¯</ci><ci id="S3.E9.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.2">𝑥</ci></apply></apply><ci id="S3.E9.m1.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E9.m1.29.29.1.1.cmml" xref="S3.E9.m1.34.34.6"><times id="S3.E9.m1.29.29.1.1.2.cmml" xref="S3.E9.m1.9.9.9.9.9.11.1"></times><ci id="S3.E9.m1.4.4.4.4.4.4.cmml" xref="S3.E9.m1.4.4.4.4.4.4">𝑁</ci><interval closure="open" id="S3.E9.m1.29.29.1.1.4.cmml" xref="S3.E9.m1.34.34.6"><apply id="S3.E9.m1.6.6.6.6.6.6.cmml" xref="S3.E9.m1.6.6.6.6.6.6"><divide id="S3.E9.m1.6.6.6.6.6.6.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6"></divide><apply id="S3.E9.m1.6.6.6.6.6.6.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2"><minus id="S3.E9.m1.6.6.6.6.6.6.2.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.1"></minus><apply id="S3.E9.m1.6.6.6.6.6.6.2.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2"><plus id="S3.E9.m1.6.6.6.6.6.6.2.2.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.1"></plus><apply id="S3.E9.m1.6.6.6.6.6.6.2.2.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.6.6.6.6.2.2.2.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.2">subscript</csymbol><ci id="S3.E9.m1.6.6.6.6.6.6.2.2.2.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.2.2">𝜇</ci><ci id="S3.E9.m1.6.6.6.6.6.6.2.2.2.3.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.2.3">𝑖</ci></apply><apply id="S3.E9.m1.6.6.6.6.6.6.2.2.3.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3"><times id="S3.E9.m1.6.6.6.6.6.6.2.2.3.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.1"></times><ci id="S3.E9.m1.6.6.6.6.6.6.2.2.3.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.2">Δ</ci><apply id="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.3">subscript</csymbol><ci id="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.2">𝜇</ci><ci id="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.3.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E9.m1.6.6.6.6.6.6.2.3.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.6.6.6.6.2.3.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.3">subscript</csymbol><apply id="S3.E9.m1.6.6.6.6.6.6.2.3.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.3.2"><ci id="S3.E9.m1.6.6.6.6.6.6.2.3.2.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.3.2.1">¯</ci><ci id="S3.E9.m1.6.6.6.6.6.6.2.3.2.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.3.2.2">𝜇</ci></apply><ci id="S3.E9.m1.6.6.6.6.6.6.2.3.3.cmml" xref="S3.E9.m1.6.6.6.6.6.6.2.3.3">𝑖</ci></apply></apply><apply id="S3.E9.m1.6.6.6.6.6.6.3.cmml" xref="S3.E9.m1.6.6.6.6.6.6.3"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.6.6.6.6.3.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.3">subscript</csymbol><apply id="S3.E9.m1.6.6.6.6.6.6.3.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.3.2"><ci id="S3.E9.m1.6.6.6.6.6.6.3.2.1.cmml" xref="S3.E9.m1.6.6.6.6.6.6.3.2.1">¯</ci><ci id="S3.E9.m1.6.6.6.6.6.6.3.2.2.cmml" xref="S3.E9.m1.6.6.6.6.6.6.3.2.2">𝜎</ci></apply><ci id="S3.E9.m1.6.6.6.6.6.6.3.3.cmml" xref="S3.E9.m1.6.6.6.6.6.6.3.3">𝑖</ci></apply></apply><apply id="S3.E9.m1.8.8.8.8.8.8.cmml" xref="S3.E9.m1.8.8.8.8.8.8"><divide id="S3.E9.m1.8.8.8.8.8.8.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8"></divide><apply id="S3.E9.m1.8.8.8.8.8.8.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2"><plus id="S3.E9.m1.8.8.8.8.8.8.2.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.1"></plus><apply id="S3.E9.m1.8.8.8.8.8.8.2.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.8.8.8.8.2.2.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.2">superscript</csymbol><apply id="S3.E9.m1.8.8.8.8.8.8.2.2.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.8.8.8.8.2.2.2.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.2">subscript</csymbol><ci id="S3.E9.m1.8.8.8.8.8.8.2.2.2.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.2.2.2">𝜎</ci><ci id="S3.E9.m1.8.8.8.8.8.8.2.2.2.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.8.8.8.8.8.8.2.2.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.2.3">2</cn></apply><apply id="S3.E9.m1.8.8.8.8.8.8.2.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3"><times id="S3.E9.m1.8.8.8.8.8.8.2.3.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.1"></times><ci id="S3.E9.m1.8.8.8.8.8.8.2.3.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.2">Δ</ci><apply id="S3.E9.m1.8.8.8.8.8.8.2.3.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.8.8.8.8.2.3.3.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3">superscript</csymbol><apply id="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3">subscript</csymbol><ci id="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.2">𝜎</ci><ci id="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.8.8.8.8.8.8.2.3.3.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E9.m1.8.8.8.8.8.8.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.8.8.8.8.3.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3">superscript</csymbol><apply id="S3.E9.m1.8.8.8.8.8.8.3.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3"><csymbol cd="ambiguous" id="S3.E9.m1.8.8.8.8.8.8.3.2.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3">subscript</csymbol><apply id="S3.E9.m1.8.8.8.8.8.8.3.2.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3.2.2"><ci id="S3.E9.m1.8.8.8.8.8.8.3.2.2.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3.2.2.1">¯</ci><ci id="S3.E9.m1.8.8.8.8.8.8.3.2.2.2.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3.2.2.2">𝜎</ci></apply><ci id="S3.E9.m1.8.8.8.8.8.8.3.2.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.8.8.8.8.8.8.3.3.cmml" xref="S3.E9.m1.8.8.8.8.8.8.3.3">2</cn></apply></apply></interval><apply id="S3.E9.m1.10.10.10.1.1.1.cmml" xref="S3.E9.m1.10.10.10.1.1.1"><ci id="S3.E9.m1.10.10.10.1.1.1.1.cmml" xref="S3.E9.m1.10.10.10.1.1.1.1">¯</ci><ci id="S3.E9.m1.10.10.10.1.1.1.2.cmml" xref="S3.E9.m1.10.10.10.1.1.1.2">BN</ci></apply><apply id="S3.E9.m1.29.29.1.1.1.1.1.cmml" xref="S3.E9.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E9.m1.29.29.1.1.1.1.1.1.cmml" xref="S3.E9.m1.34.34.6">subscript</csymbol><apply id="S3.E9.m1.12.12.12.3.3.3.cmml" xref="S3.E9.m1.12.12.12.3.3.3"><ci id="S3.E9.m1.12.12.12.3.3.3.1.cmml" xref="S3.E9.m1.12.12.12.3.3.3.1">^</ci><apply id="S3.E9.m1.12.12.12.3.3.3.2.cmml" xref="S3.E9.m1.12.12.12.3.3.3.2"><ci id="S3.E9.m1.12.12.12.3.3.3.2.1.cmml" xref="S3.E9.m1.12.12.12.3.3.3.2.1">¯</ci><ci id="S3.E9.m1.12.12.12.3.3.3.2.2.cmml" xref="S3.E9.m1.12.12.12.3.3.3.2.2">𝑥</ci></apply></apply><ci id="S3.E9.m1.13.13.13.4.4.4.1.cmml" xref="S3.E9.m1.13.13.13.4.4.4.1">𝑖</ci></apply></apply></apply><apply id="S3.E9.m1.31.31.3c.cmml" xref="S3.E9.m1.34.34.6"><csymbol cd="latexml" id="S3.E9.m1.15.15.15.6.6.6.cmml" xref="S3.E9.m1.15.15.15.6.6.6">similar-to</csymbol><share href="#S3.E9.m1.29.29.1.1.cmml" id="S3.E9.m1.31.31.3d.cmml" xref="S3.E9.m1.9.9.9.9.9.11.1"></share><apply id="S3.E9.m1.31.31.3.3.cmml" xref="S3.E9.m1.34.34.6"><times id="S3.E9.m1.31.31.3.3.3.cmml" xref="S3.E9.m1.9.9.9.9.9.11.1"></times><ci id="S3.E9.m1.16.16.16.7.7.7.cmml" xref="S3.E9.m1.16.16.16.7.7.7">𝑁</ci><interval closure="open" id="S3.E9.m1.31.31.3.3.2.3.cmml" xref="S3.E9.m1.34.34.6"><apply id="S3.E9.m1.30.30.2.2.1.1.1.cmml" xref="S3.E9.m1.34.34.6"><plus id="S3.E9.m1.20.20.20.11.11.11.cmml" xref="S3.E9.m1.20.20.20.11.11.11"></plus><apply id="S3.E9.m1.30.30.2.2.1.1.1.2.cmml" xref="S3.E9.m1.34.34.6"><times id="S3.E9.m1.30.30.2.2.1.1.1.2.1.cmml" xref="S3.E9.m1.34.34.6"></times><apply id="S3.E9.m1.18.18.18.9.9.9.cmml" xref="S3.E9.m1.18.18.18.9.9.9"><ci id="S3.E9.m1.18.18.18.9.9.9.1.cmml" xref="S3.E9.m1.18.18.18.9.9.9.1">¯</ci><ci id="S3.E9.m1.18.18.18.9.9.9.2.cmml" xref="S3.E9.m1.18.18.18.9.9.9.2">𝛾</ci></apply><apply id="S3.E9.m1.19.19.19.10.10.10.cmml" xref="S3.E9.m1.19.19.19.10.10.10"><divide id="S3.E9.m1.19.19.19.10.10.10.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10"></divide><apply id="S3.E9.m1.19.19.19.10.10.10.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2"><minus id="S3.E9.m1.19.19.19.10.10.10.2.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.1"></minus><apply id="S3.E9.m1.19.19.19.10.10.10.2.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2"><plus id="S3.E9.m1.19.19.19.10.10.10.2.2.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.1"></plus><apply id="S3.E9.m1.19.19.19.10.10.10.2.2.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.19.19.19.10.10.10.2.2.2.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.2">subscript</csymbol><ci id="S3.E9.m1.19.19.19.10.10.10.2.2.2.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.2.2">𝜇</ci><ci id="S3.E9.m1.19.19.19.10.10.10.2.2.2.3.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.2.3">𝑖</ci></apply><apply id="S3.E9.m1.19.19.19.10.10.10.2.2.3.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3"><times id="S3.E9.m1.19.19.19.10.10.10.2.2.3.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.1"></times><ci id="S3.E9.m1.19.19.19.10.10.10.2.2.3.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.2">Δ</ci><apply id="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.3">subscript</csymbol><ci id="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.2">𝜇</ci><ci id="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.3.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E9.m1.19.19.19.10.10.10.2.3.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.19.19.19.10.10.10.2.3.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.3">subscript</csymbol><apply id="S3.E9.m1.19.19.19.10.10.10.2.3.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.3.2"><ci id="S3.E9.m1.19.19.19.10.10.10.2.3.2.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.3.2.1">¯</ci><ci id="S3.E9.m1.19.19.19.10.10.10.2.3.2.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.3.2.2">𝜇</ci></apply><ci id="S3.E9.m1.19.19.19.10.10.10.2.3.3.cmml" xref="S3.E9.m1.19.19.19.10.10.10.2.3.3">𝑖</ci></apply></apply><apply id="S3.E9.m1.19.19.19.10.10.10.3.cmml" xref="S3.E9.m1.19.19.19.10.10.10.3"><csymbol cd="ambiguous" id="S3.E9.m1.19.19.19.10.10.10.3.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.3">subscript</csymbol><apply id="S3.E9.m1.19.19.19.10.10.10.3.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.3.2"><ci id="S3.E9.m1.19.19.19.10.10.10.3.2.1.cmml" xref="S3.E9.m1.19.19.19.10.10.10.3.2.1">¯</ci><ci id="S3.E9.m1.19.19.19.10.10.10.3.2.2.cmml" xref="S3.E9.m1.19.19.19.10.10.10.3.2.2">𝜎</ci></apply><ci id="S3.E9.m1.19.19.19.10.10.10.3.3.cmml" xref="S3.E9.m1.19.19.19.10.10.10.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E9.m1.30.30.2.2.1.1.1.3.cmml" xref="S3.E9.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E9.m1.30.30.2.2.1.1.1.3.1.cmml" xref="S3.E9.m1.34.34.6">subscript</csymbol><apply id="S3.E9.m1.21.21.21.12.12.12.cmml" xref="S3.E9.m1.21.21.21.12.12.12"><ci id="S3.E9.m1.21.21.21.12.12.12.1.cmml" xref="S3.E9.m1.21.21.21.12.12.12.1">¯</ci><ci id="S3.E9.m1.21.21.21.12.12.12.2.cmml" xref="S3.E9.m1.21.21.21.12.12.12.2">𝛽</ci></apply><ci id="S3.E9.m1.22.22.22.13.13.13.1.cmml" xref="S3.E9.m1.22.22.22.13.13.13.1">𝑖</ci></apply></apply><apply id="S3.E9.m1.31.31.3.3.2.2.2.cmml" xref="S3.E9.m1.34.34.6"><times id="S3.E9.m1.31.31.3.3.2.2.2.1.cmml" xref="S3.E9.m1.34.34.6"></times><apply id="S3.E9.m1.31.31.3.3.2.2.2.2.cmml" xref="S3.E9.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E9.m1.31.31.3.3.2.2.2.2.1.cmml" xref="S3.E9.m1.34.34.6">superscript</csymbol><apply id="S3.E9.m1.31.31.3.3.2.2.2.2.2.cmml" xref="S3.E9.m1.34.34.6"><csymbol cd="ambiguous" id="S3.E9.m1.31.31.3.3.2.2.2.2.2.1.cmml" xref="S3.E9.m1.34.34.6">subscript</csymbol><apply id="S3.E9.m1.24.24.24.15.15.15.cmml" xref="S3.E9.m1.24.24.24.15.15.15"><ci id="S3.E9.m1.24.24.24.15.15.15.1.cmml" xref="S3.E9.m1.24.24.24.15.15.15.1">¯</ci><ci id="S3.E9.m1.24.24.24.15.15.15.2.cmml" xref="S3.E9.m1.24.24.24.15.15.15.2">𝛾</ci></apply><ci id="S3.E9.m1.25.25.25.16.16.16.1.cmml" xref="S3.E9.m1.25.25.25.16.16.16.1">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.26.26.26.17.17.17.1.cmml" xref="S3.E9.m1.26.26.26.17.17.17.1">2</cn></apply><apply id="S3.E9.m1.27.27.27.18.18.18.cmml" xref="S3.E9.m1.27.27.27.18.18.18"><divide id="S3.E9.m1.27.27.27.18.18.18.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18"></divide><apply id="S3.E9.m1.27.27.27.18.18.18.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2"><plus id="S3.E9.m1.27.27.27.18.18.18.2.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.1"></plus><apply id="S3.E9.m1.27.27.27.18.18.18.2.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.27.27.27.18.18.18.2.2.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.2">superscript</csymbol><apply id="S3.E9.m1.27.27.27.18.18.18.2.2.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.27.27.27.18.18.18.2.2.2.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.2">subscript</csymbol><ci id="S3.E9.m1.27.27.27.18.18.18.2.2.2.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.2.2.2">𝜎</ci><ci id="S3.E9.m1.27.27.27.18.18.18.2.2.2.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.27.27.27.18.18.18.2.2.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.2.3">2</cn></apply><apply id="S3.E9.m1.27.27.27.18.18.18.2.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3"><times id="S3.E9.m1.27.27.27.18.18.18.2.3.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.1"></times><ci id="S3.E9.m1.27.27.27.18.18.18.2.3.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.2">Δ</ci><apply id="S3.E9.m1.27.27.27.18.18.18.2.3.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.27.27.27.18.18.18.2.3.3.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3">superscript</csymbol><apply id="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3">subscript</csymbol><ci id="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.2">𝜎</ci><ci id="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.27.27.27.18.18.18.2.3.3.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E9.m1.27.27.27.18.18.18.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3"><csymbol cd="ambiguous" id="S3.E9.m1.27.27.27.18.18.18.3.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3">superscript</csymbol><apply id="S3.E9.m1.27.27.27.18.18.18.3.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3"><csymbol cd="ambiguous" id="S3.E9.m1.27.27.27.18.18.18.3.2.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3">subscript</csymbol><apply id="S3.E9.m1.27.27.27.18.18.18.3.2.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3.2.2"><ci id="S3.E9.m1.27.27.27.18.18.18.3.2.2.1.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3.2.2.1">¯</ci><ci id="S3.E9.m1.27.27.27.18.18.18.3.2.2.2.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3.2.2.2">𝜎</ci></apply><ci id="S3.E9.m1.27.27.27.18.18.18.3.2.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.27.27.27.18.18.18.3.3.cmml" xref="S3.E9.m1.27.27.27.18.18.18.3.3">2</cn></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.34c">\begin{gathered}\hat{\bar{x}}_{i}\sim N\left(\frac{\mu_{i}+\Delta\mu_{i}-\bar{\mu}_{i}}{\bar{\sigma}_{i}},\frac{\sigma_{i}^{2}+\Delta\sigma_{i}^{2}}{\bar{\sigma}_{i}^{2}}\right)\\
\overline{\mathrm{BN}}(\hat{\bar{x}}_{i})\sim N\left(\bar{\gamma}\frac{\mu_{i}+\Delta\mu_{i}-\bar{\mu}_{i}}{\bar{\sigma}_{i}}+\bar{\beta}_{i},\bar{\gamma}_{i}^{2}\frac{\sigma_{i}^{2}+\Delta\sigma_{i}^{2}}{\bar{\sigma}_{i}^{2}}\right)\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p12" class="ltx_para ltx_noindent">
<p id="S3.SS2.p12.1" class="ltx_p">We posit that using BN-patch layers in MTFL constrains neuron activations to be closer to what they were before the aggregation step, compared to non-patch BN layers as part of FL (as illustrated in Fig. 3 (b). I.e., the difference in means and variances pre- and post-aggregation using MTFL is smaller than when using FL:</p>
</div>
<div id="S3.SS2.p13" class="ltx_para">
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.40" class="ltx_Math" alttext="\begin{gathered}\left|\gamma\frac{\Delta\mu_{i}}{\sigma_{i}}\right|&lt;\left|\beta_{i}-\bar{\gamma}\frac{\mu_{i}+\Delta\mu_{i}-\bar{\mu}_{i}}{\bar{\sigma}_{i}}-\bar{\beta}_{i}\right|\\
\left|\gamma_{i}^{2}\frac{\Delta\sigma_{i}^{2}}{\sigma_{i}^{2}}\right|&lt;\left|\gamma_{i}^{2}-\bar{\gamma}_{i}^{2}\frac{\sigma_{i}^{2}+\Delta\sigma_{i}^{2}}{\bar{\sigma}_{i}^{2}}\right|\end{gathered}" display="block"><semantics id="S3.E10.m1.40a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E10.m1.40.40.8" xref="S3.E10.m1.36.36.4.cmml"><mtr id="S3.E10.m1.40.40.8a" xref="S3.E10.m1.36.36.4.cmml"><mtd id="S3.E10.m1.40.40.8b" xref="S3.E10.m1.36.36.4.cmml"><mrow id="S3.E10.m1.38.38.6.34.17.17" xref="S3.E10.m1.36.36.4.cmml"><mrow id="S3.E10.m1.37.37.5.33.16.16.16.1" xref="S3.E10.m1.36.36.4.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.36.36.4a.cmml">|</mo><mrow id="S3.E10.m1.37.37.5.33.16.16.16.1.1" xref="S3.E10.m1.36.36.4.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.37.37.5.33.16.16.16.1.1.1" xref="S3.E10.m1.36.36.4a.cmml">​</mo><mfrac id="S3.E10.m1.3.3.3.3.3.3" xref="S3.E10.m1.3.3.3.3.3.3.cmml"><mrow id="S3.E10.m1.3.3.3.3.3.3.2" xref="S3.E10.m1.3.3.3.3.3.3.2.cmml"><mi mathvariant="normal" id="S3.E10.m1.3.3.3.3.3.3.2.2" xref="S3.E10.m1.3.3.3.3.3.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.3.3.3.3.2.1" xref="S3.E10.m1.3.3.3.3.3.3.2.1.cmml">​</mo><msub id="S3.E10.m1.3.3.3.3.3.3.2.3" xref="S3.E10.m1.3.3.3.3.3.3.2.3.cmml"><mi id="S3.E10.m1.3.3.3.3.3.3.2.3.2" xref="S3.E10.m1.3.3.3.3.3.3.2.3.2.cmml">μ</mi><mi id="S3.E10.m1.3.3.3.3.3.3.2.3.3" xref="S3.E10.m1.3.3.3.3.3.3.2.3.3.cmml">i</mi></msub></mrow><msub id="S3.E10.m1.3.3.3.3.3.3.3" xref="S3.E10.m1.3.3.3.3.3.3.3.cmml"><mi id="S3.E10.m1.3.3.3.3.3.3.3.2" xref="S3.E10.m1.3.3.3.3.3.3.3.2.cmml">σ</mi><mi id="S3.E10.m1.3.3.3.3.3.3.3.3" xref="S3.E10.m1.3.3.3.3.3.3.3.3.cmml">i</mi></msub></mfrac></mrow><mo id="S3.E10.m1.4.4.4.4.4.4" xref="S3.E10.m1.36.36.4a.cmml">|</mo></mrow><mo id="S3.E10.m1.5.5.5.5.5.5" xref="S3.E10.m1.5.5.5.5.5.5.cmml">&lt;</mo><mrow id="S3.E10.m1.38.38.6.34.17.17.17.1" xref="S3.E10.m1.36.36.4.cmml"><mo id="S3.E10.m1.6.6.6.6.6.6" xref="S3.E10.m1.36.36.4a.cmml">|</mo><mrow id="S3.E10.m1.38.38.6.34.17.17.17.1.1" xref="S3.E10.m1.36.36.4.cmml"><msub id="S3.E10.m1.38.38.6.34.17.17.17.1.1.1" xref="S3.E10.m1.36.36.4.cmml"><mi id="S3.E10.m1.7.7.7.7.7.7" xref="S3.E10.m1.7.7.7.7.7.7.cmml">β</mi><mi id="S3.E10.m1.8.8.8.8.8.8.1" xref="S3.E10.m1.8.8.8.8.8.8.1.cmml">i</mi></msub><mo id="S3.E10.m1.9.9.9.9.9.9" xref="S3.E10.m1.9.9.9.9.9.9.cmml">−</mo><mrow id="S3.E10.m1.38.38.6.34.17.17.17.1.1.2" xref="S3.E10.m1.36.36.4.cmml"><mover accent="true" id="S3.E10.m1.10.10.10.10.10.10" xref="S3.E10.m1.10.10.10.10.10.10.cmml"><mi id="S3.E10.m1.10.10.10.10.10.10.2" xref="S3.E10.m1.10.10.10.10.10.10.2.cmml">γ</mi><mo id="S3.E10.m1.10.10.10.10.10.10.1" xref="S3.E10.m1.10.10.10.10.10.10.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S3.E10.m1.38.38.6.34.17.17.17.1.1.2.1" xref="S3.E10.m1.36.36.4a.cmml">​</mo><mfrac id="S3.E10.m1.11.11.11.11.11.11" xref="S3.E10.m1.11.11.11.11.11.11.cmml"><mrow id="S3.E10.m1.11.11.11.11.11.11.2" xref="S3.E10.m1.11.11.11.11.11.11.2.cmml"><mrow id="S3.E10.m1.11.11.11.11.11.11.2.2" xref="S3.E10.m1.11.11.11.11.11.11.2.2.cmml"><msub id="S3.E10.m1.11.11.11.11.11.11.2.2.2" xref="S3.E10.m1.11.11.11.11.11.11.2.2.2.cmml"><mi id="S3.E10.m1.11.11.11.11.11.11.2.2.2.2" xref="S3.E10.m1.11.11.11.11.11.11.2.2.2.2.cmml">μ</mi><mi id="S3.E10.m1.11.11.11.11.11.11.2.2.2.3" xref="S3.E10.m1.11.11.11.11.11.11.2.2.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.11.11.11.11.11.11.2.2.1" xref="S3.E10.m1.11.11.11.11.11.11.2.2.1.cmml">+</mo><mrow id="S3.E10.m1.11.11.11.11.11.11.2.2.3" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.cmml"><mi mathvariant="normal" id="S3.E10.m1.11.11.11.11.11.11.2.2.3.2" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.11.11.11.11.11.11.2.2.3.1" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.1.cmml">​</mo><msub id="S3.E10.m1.11.11.11.11.11.11.2.2.3.3" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.cmml"><mi id="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.2" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.2.cmml">μ</mi><mi id="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.3" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E10.m1.11.11.11.11.11.11.2.1" xref="S3.E10.m1.11.11.11.11.11.11.2.1.cmml">−</mo><msub id="S3.E10.m1.11.11.11.11.11.11.2.3" xref="S3.E10.m1.11.11.11.11.11.11.2.3.cmml"><mover accent="true" id="S3.E10.m1.11.11.11.11.11.11.2.3.2" xref="S3.E10.m1.11.11.11.11.11.11.2.3.2.cmml"><mi id="S3.E10.m1.11.11.11.11.11.11.2.3.2.2" xref="S3.E10.m1.11.11.11.11.11.11.2.3.2.2.cmml">μ</mi><mo id="S3.E10.m1.11.11.11.11.11.11.2.3.2.1" xref="S3.E10.m1.11.11.11.11.11.11.2.3.2.1.cmml">¯</mo></mover><mi id="S3.E10.m1.11.11.11.11.11.11.2.3.3" xref="S3.E10.m1.11.11.11.11.11.11.2.3.3.cmml">i</mi></msub></mrow><msub id="S3.E10.m1.11.11.11.11.11.11.3" xref="S3.E10.m1.11.11.11.11.11.11.3.cmml"><mover accent="true" id="S3.E10.m1.11.11.11.11.11.11.3.2" xref="S3.E10.m1.11.11.11.11.11.11.3.2.cmml"><mi id="S3.E10.m1.11.11.11.11.11.11.3.2.2" xref="S3.E10.m1.11.11.11.11.11.11.3.2.2.cmml">σ</mi><mo id="S3.E10.m1.11.11.11.11.11.11.3.2.1" xref="S3.E10.m1.11.11.11.11.11.11.3.2.1.cmml">¯</mo></mover><mi id="S3.E10.m1.11.11.11.11.11.11.3.3" xref="S3.E10.m1.11.11.11.11.11.11.3.3.cmml">i</mi></msub></mfrac></mrow><mo id="S3.E10.m1.9.9.9.9.9.9a" xref="S3.E10.m1.9.9.9.9.9.9.cmml">−</mo><msub id="S3.E10.m1.38.38.6.34.17.17.17.1.1.3" xref="S3.E10.m1.36.36.4.cmml"><mover accent="true" id="S3.E10.m1.13.13.13.13.13.13" xref="S3.E10.m1.13.13.13.13.13.13.cmml"><mi id="S3.E10.m1.13.13.13.13.13.13.2" xref="S3.E10.m1.13.13.13.13.13.13.2.cmml">β</mi><mo id="S3.E10.m1.13.13.13.13.13.13.1" xref="S3.E10.m1.13.13.13.13.13.13.1.cmml">¯</mo></mover><mi id="S3.E10.m1.14.14.14.14.14.14.1" xref="S3.E10.m1.14.14.14.14.14.14.1.cmml">i</mi></msub></mrow><mo id="S3.E10.m1.15.15.15.15.15.15" xref="S3.E10.m1.36.36.4a.cmml">|</mo></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.40.40.8c" xref="S3.E10.m1.36.36.4.cmml"><mtd id="S3.E10.m1.40.40.8d" xref="S3.E10.m1.36.36.4.cmml"><mrow id="S3.E10.m1.40.40.8.36.19.19" xref="S3.E10.m1.36.36.4.cmml"><mrow id="S3.E10.m1.39.39.7.35.18.18.18.1" xref="S3.E10.m1.36.36.4.cmml"><mo id="S3.E10.m1.16.16.16.1.1.1" xref="S3.E10.m1.36.36.4a.cmml">|</mo><mrow id="S3.E10.m1.39.39.7.35.18.18.18.1.1" xref="S3.E10.m1.36.36.4.cmml"><msubsup id="S3.E10.m1.39.39.7.35.18.18.18.1.1.2" xref="S3.E10.m1.36.36.4.cmml"><mi id="S3.E10.m1.17.17.17.2.2.2" xref="S3.E10.m1.17.17.17.2.2.2.cmml">γ</mi><mi id="S3.E10.m1.18.18.18.3.3.3.1" xref="S3.E10.m1.18.18.18.3.3.3.1.cmml">i</mi><mn id="S3.E10.m1.19.19.19.4.4.4.1" xref="S3.E10.m1.19.19.19.4.4.4.1.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.E10.m1.39.39.7.35.18.18.18.1.1.1" xref="S3.E10.m1.36.36.4a.cmml">​</mo><mfrac id="S3.E10.m1.20.20.20.5.5.5" xref="S3.E10.m1.20.20.20.5.5.5.cmml"><mrow id="S3.E10.m1.20.20.20.5.5.5.2" xref="S3.E10.m1.20.20.20.5.5.5.2.cmml"><mi mathvariant="normal" id="S3.E10.m1.20.20.20.5.5.5.2.2" xref="S3.E10.m1.20.20.20.5.5.5.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.20.20.20.5.5.5.2.1" xref="S3.E10.m1.20.20.20.5.5.5.2.1.cmml">​</mo><msubsup id="S3.E10.m1.20.20.20.5.5.5.2.3" xref="S3.E10.m1.20.20.20.5.5.5.2.3.cmml"><mi id="S3.E10.m1.20.20.20.5.5.5.2.3.2.2" xref="S3.E10.m1.20.20.20.5.5.5.2.3.2.2.cmml">σ</mi><mi id="S3.E10.m1.20.20.20.5.5.5.2.3.2.3" xref="S3.E10.m1.20.20.20.5.5.5.2.3.2.3.cmml">i</mi><mn id="S3.E10.m1.20.20.20.5.5.5.2.3.3" xref="S3.E10.m1.20.20.20.5.5.5.2.3.3.cmml">2</mn></msubsup></mrow><msubsup id="S3.E10.m1.20.20.20.5.5.5.3" xref="S3.E10.m1.20.20.20.5.5.5.3.cmml"><mi id="S3.E10.m1.20.20.20.5.5.5.3.2.2" xref="S3.E10.m1.20.20.20.5.5.5.3.2.2.cmml">σ</mi><mi id="S3.E10.m1.20.20.20.5.5.5.3.2.3" xref="S3.E10.m1.20.20.20.5.5.5.3.2.3.cmml">i</mi><mn id="S3.E10.m1.20.20.20.5.5.5.3.3" xref="S3.E10.m1.20.20.20.5.5.5.3.3.cmml">2</mn></msubsup></mfrac></mrow><mo id="S3.E10.m1.21.21.21.6.6.6" xref="S3.E10.m1.36.36.4a.cmml">|</mo></mrow><mo id="S3.E10.m1.22.22.22.7.7.7" xref="S3.E10.m1.22.22.22.7.7.7.cmml">&lt;</mo><mrow id="S3.E10.m1.40.40.8.36.19.19.19.1" xref="S3.E10.m1.36.36.4.cmml"><mo id="S3.E10.m1.23.23.23.8.8.8" xref="S3.E10.m1.36.36.4a.cmml">|</mo><mrow id="S3.E10.m1.40.40.8.36.19.19.19.1.1" xref="S3.E10.m1.36.36.4.cmml"><msubsup id="S3.E10.m1.40.40.8.36.19.19.19.1.1.1" xref="S3.E10.m1.36.36.4.cmml"><mi id="S3.E10.m1.24.24.24.9.9.9" xref="S3.E10.m1.24.24.24.9.9.9.cmml">γ</mi><mi id="S3.E10.m1.25.25.25.10.10.10.1" xref="S3.E10.m1.25.25.25.10.10.10.1.cmml">i</mi><mn id="S3.E10.m1.26.26.26.11.11.11.1" xref="S3.E10.m1.26.26.26.11.11.11.1.cmml">2</mn></msubsup><mo id="S3.E10.m1.27.27.27.12.12.12" xref="S3.E10.m1.27.27.27.12.12.12.cmml">−</mo><mrow id="S3.E10.m1.40.40.8.36.19.19.19.1.1.2" xref="S3.E10.m1.36.36.4.cmml"><msubsup id="S3.E10.m1.40.40.8.36.19.19.19.1.1.2.2" xref="S3.E10.m1.36.36.4.cmml"><mover accent="true" id="S3.E10.m1.28.28.28.13.13.13" xref="S3.E10.m1.28.28.28.13.13.13.cmml"><mi id="S3.E10.m1.28.28.28.13.13.13.2" xref="S3.E10.m1.28.28.28.13.13.13.2.cmml">γ</mi><mo id="S3.E10.m1.28.28.28.13.13.13.1" xref="S3.E10.m1.28.28.28.13.13.13.1.cmml">¯</mo></mover><mi id="S3.E10.m1.29.29.29.14.14.14.1" xref="S3.E10.m1.29.29.29.14.14.14.1.cmml">i</mi><mn id="S3.E10.m1.30.30.30.15.15.15.1" xref="S3.E10.m1.30.30.30.15.15.15.1.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.E10.m1.40.40.8.36.19.19.19.1.1.2.1" xref="S3.E10.m1.36.36.4a.cmml">​</mo><mfrac id="S3.E10.m1.31.31.31.16.16.16" xref="S3.E10.m1.31.31.31.16.16.16.cmml"><mrow id="S3.E10.m1.31.31.31.16.16.16.2" xref="S3.E10.m1.31.31.31.16.16.16.2.cmml"><msubsup id="S3.E10.m1.31.31.31.16.16.16.2.2" xref="S3.E10.m1.31.31.31.16.16.16.2.2.cmml"><mi id="S3.E10.m1.31.31.31.16.16.16.2.2.2.2" xref="S3.E10.m1.31.31.31.16.16.16.2.2.2.2.cmml">σ</mi><mi id="S3.E10.m1.31.31.31.16.16.16.2.2.2.3" xref="S3.E10.m1.31.31.31.16.16.16.2.2.2.3.cmml">i</mi><mn id="S3.E10.m1.31.31.31.16.16.16.2.2.3" xref="S3.E10.m1.31.31.31.16.16.16.2.2.3.cmml">2</mn></msubsup><mo id="S3.E10.m1.31.31.31.16.16.16.2.1" xref="S3.E10.m1.31.31.31.16.16.16.2.1.cmml">+</mo><mrow id="S3.E10.m1.31.31.31.16.16.16.2.3" xref="S3.E10.m1.31.31.31.16.16.16.2.3.cmml"><mi mathvariant="normal" id="S3.E10.m1.31.31.31.16.16.16.2.3.2" xref="S3.E10.m1.31.31.31.16.16.16.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.31.31.31.16.16.16.2.3.1" xref="S3.E10.m1.31.31.31.16.16.16.2.3.1.cmml">​</mo><msubsup id="S3.E10.m1.31.31.31.16.16.16.2.3.3" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3.cmml"><mi id="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.2" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.2.cmml">σ</mi><mi id="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.3" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.3.cmml">i</mi><mn id="S3.E10.m1.31.31.31.16.16.16.2.3.3.3" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3.3.cmml">2</mn></msubsup></mrow></mrow><msubsup id="S3.E10.m1.31.31.31.16.16.16.3" xref="S3.E10.m1.31.31.31.16.16.16.3.cmml"><mover accent="true" id="S3.E10.m1.31.31.31.16.16.16.3.2.2" xref="S3.E10.m1.31.31.31.16.16.16.3.2.2.cmml"><mi id="S3.E10.m1.31.31.31.16.16.16.3.2.2.2" xref="S3.E10.m1.31.31.31.16.16.16.3.2.2.2.cmml">σ</mi><mo id="S3.E10.m1.31.31.31.16.16.16.3.2.2.1" xref="S3.E10.m1.31.31.31.16.16.16.3.2.2.1.cmml">¯</mo></mover><mi id="S3.E10.m1.31.31.31.16.16.16.3.2.3" xref="S3.E10.m1.31.31.31.16.16.16.3.2.3.cmml">i</mi><mn id="S3.E10.m1.31.31.31.16.16.16.3.3" xref="S3.E10.m1.31.31.31.16.16.16.3.3.cmml">2</mn></msubsup></mfrac></mrow></mrow><mo id="S3.E10.m1.32.32.32.17.17.17" xref="S3.E10.m1.36.36.4a.cmml">|</mo></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E10.m1.40b"><apply id="S3.E10.m1.36.36.4.cmml" xref="S3.E10.m1.40.40.8"><and id="S3.E10.m1.36.36.4a.cmml" xref="S3.E10.m1.1.1.1.1.1.1"></and><apply id="S3.E10.m1.36.36.4b.cmml" xref="S3.E10.m1.40.40.8"><lt id="S3.E10.m1.5.5.5.5.5.5.cmml" xref="S3.E10.m1.5.5.5.5.5.5"></lt><apply id="S3.E10.m1.33.33.1.1.2.cmml" xref="S3.E10.m1.40.40.8"><abs id="S3.E10.m1.33.33.1.1.2.1.cmml" xref="S3.E10.m1.40.40.8"></abs><apply id="S3.E10.m1.33.33.1.1.1.1.cmml" xref="S3.E10.m1.40.40.8"><times id="S3.E10.m1.33.33.1.1.1.1.1.cmml" xref="S3.E10.m1.40.40.8"></times><ci id="S3.E10.m1.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2">𝛾</ci><apply id="S3.E10.m1.3.3.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3.3.3"><divide id="S3.E10.m1.3.3.3.3.3.3.1.cmml" xref="S3.E10.m1.3.3.3.3.3.3"></divide><apply id="S3.E10.m1.3.3.3.3.3.3.2.cmml" xref="S3.E10.m1.3.3.3.3.3.3.2"><times id="S3.E10.m1.3.3.3.3.3.3.2.1.cmml" xref="S3.E10.m1.3.3.3.3.3.3.2.1"></times><ci id="S3.E10.m1.3.3.3.3.3.3.2.2.cmml" xref="S3.E10.m1.3.3.3.3.3.3.2.2">Δ</ci><apply id="S3.E10.m1.3.3.3.3.3.3.2.3.cmml" xref="S3.E10.m1.3.3.3.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.3.3.3.3.2.3.1.cmml" xref="S3.E10.m1.3.3.3.3.3.3.2.3">subscript</csymbol><ci id="S3.E10.m1.3.3.3.3.3.3.2.3.2.cmml" xref="S3.E10.m1.3.3.3.3.3.3.2.3.2">𝜇</ci><ci id="S3.E10.m1.3.3.3.3.3.3.2.3.3.cmml" xref="S3.E10.m1.3.3.3.3.3.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E10.m1.3.3.3.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.E10.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E10.m1.3.3.3.3.3.3.3.2.cmml" xref="S3.E10.m1.3.3.3.3.3.3.3.2">𝜎</ci><ci id="S3.E10.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3.3.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E10.m1.35.35.3.3.cmml" xref="S3.E10.m1.40.40.8"><times id="S3.E10.m1.35.35.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1"></times><apply id="S3.E10.m1.34.34.2.2.1.2.cmml" xref="S3.E10.m1.40.40.8"><abs id="S3.E10.m1.34.34.2.2.1.2.1.cmml" xref="S3.E10.m1.40.40.8"></abs><apply id="S3.E10.m1.34.34.2.2.1.1.1.cmml" xref="S3.E10.m1.40.40.8"><minus id="S3.E10.m1.9.9.9.9.9.9.cmml" xref="S3.E10.m1.9.9.9.9.9.9"></minus><apply id="S3.E10.m1.34.34.2.2.1.1.1.2.cmml" xref="S3.E10.m1.40.40.8"><csymbol cd="ambiguous" id="S3.E10.m1.34.34.2.2.1.1.1.2.1.cmml" xref="S3.E10.m1.40.40.8">subscript</csymbol><ci id="S3.E10.m1.7.7.7.7.7.7.cmml" xref="S3.E10.m1.7.7.7.7.7.7">𝛽</ci><ci id="S3.E10.m1.8.8.8.8.8.8.1.cmml" xref="S3.E10.m1.8.8.8.8.8.8.1">𝑖</ci></apply><apply id="S3.E10.m1.34.34.2.2.1.1.1.3.cmml" xref="S3.E10.m1.40.40.8"><times id="S3.E10.m1.34.34.2.2.1.1.1.3.1.cmml" xref="S3.E10.m1.40.40.8"></times><apply id="S3.E10.m1.10.10.10.10.10.10.cmml" xref="S3.E10.m1.10.10.10.10.10.10"><ci id="S3.E10.m1.10.10.10.10.10.10.1.cmml" xref="S3.E10.m1.10.10.10.10.10.10.1">¯</ci><ci id="S3.E10.m1.10.10.10.10.10.10.2.cmml" xref="S3.E10.m1.10.10.10.10.10.10.2">𝛾</ci></apply><apply id="S3.E10.m1.11.11.11.11.11.11.cmml" xref="S3.E10.m1.11.11.11.11.11.11"><divide id="S3.E10.m1.11.11.11.11.11.11.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11"></divide><apply id="S3.E10.m1.11.11.11.11.11.11.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2"><minus id="S3.E10.m1.11.11.11.11.11.11.2.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.1"></minus><apply id="S3.E10.m1.11.11.11.11.11.11.2.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2"><plus id="S3.E10.m1.11.11.11.11.11.11.2.2.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.1"></plus><apply id="S3.E10.m1.11.11.11.11.11.11.2.2.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.11.11.11.11.2.2.2.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.2">subscript</csymbol><ci id="S3.E10.m1.11.11.11.11.11.11.2.2.2.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.2.2">𝜇</ci><ci id="S3.E10.m1.11.11.11.11.11.11.2.2.2.3.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.2.3">𝑖</ci></apply><apply id="S3.E10.m1.11.11.11.11.11.11.2.2.3.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3"><times id="S3.E10.m1.11.11.11.11.11.11.2.2.3.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.1"></times><ci id="S3.E10.m1.11.11.11.11.11.11.2.2.3.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.2">Δ</ci><apply id="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.3">subscript</csymbol><ci id="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.2">𝜇</ci><ci id="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.3.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E10.m1.11.11.11.11.11.11.2.3.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.11.11.11.11.2.3.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.3">subscript</csymbol><apply id="S3.E10.m1.11.11.11.11.11.11.2.3.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.3.2"><ci id="S3.E10.m1.11.11.11.11.11.11.2.3.2.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.3.2.1">¯</ci><ci id="S3.E10.m1.11.11.11.11.11.11.2.3.2.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.3.2.2">𝜇</ci></apply><ci id="S3.E10.m1.11.11.11.11.11.11.2.3.3.cmml" xref="S3.E10.m1.11.11.11.11.11.11.2.3.3">𝑖</ci></apply></apply><apply id="S3.E10.m1.11.11.11.11.11.11.3.cmml" xref="S3.E10.m1.11.11.11.11.11.11.3"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.11.11.11.11.3.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.3">subscript</csymbol><apply id="S3.E10.m1.11.11.11.11.11.11.3.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.3.2"><ci id="S3.E10.m1.11.11.11.11.11.11.3.2.1.cmml" xref="S3.E10.m1.11.11.11.11.11.11.3.2.1">¯</ci><ci id="S3.E10.m1.11.11.11.11.11.11.3.2.2.cmml" xref="S3.E10.m1.11.11.11.11.11.11.3.2.2">𝜎</ci></apply><ci id="S3.E10.m1.11.11.11.11.11.11.3.3.cmml" xref="S3.E10.m1.11.11.11.11.11.11.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E10.m1.34.34.2.2.1.1.1.4.cmml" xref="S3.E10.m1.40.40.8"><csymbol cd="ambiguous" id="S3.E10.m1.34.34.2.2.1.1.1.4.1.cmml" xref="S3.E10.m1.40.40.8">subscript</csymbol><apply id="S3.E10.m1.13.13.13.13.13.13.cmml" xref="S3.E10.m1.13.13.13.13.13.13"><ci id="S3.E10.m1.13.13.13.13.13.13.1.cmml" xref="S3.E10.m1.13.13.13.13.13.13.1">¯</ci><ci id="S3.E10.m1.13.13.13.13.13.13.2.cmml" xref="S3.E10.m1.13.13.13.13.13.13.2">𝛽</ci></apply><ci id="S3.E10.m1.14.14.14.14.14.14.1.cmml" xref="S3.E10.m1.14.14.14.14.14.14.1">𝑖</ci></apply></apply></apply><apply id="S3.E10.m1.35.35.3.3.2.2.cmml" xref="S3.E10.m1.40.40.8"><abs id="S3.E10.m1.35.35.3.3.2.2.1.cmml" xref="S3.E10.m1.40.40.8"></abs><apply id="S3.E10.m1.35.35.3.3.2.1.1.cmml" xref="S3.E10.m1.40.40.8"><times id="S3.E10.m1.35.35.3.3.2.1.1.1.cmml" xref="S3.E10.m1.40.40.8"></times><apply id="S3.E10.m1.35.35.3.3.2.1.1.2.cmml" xref="S3.E10.m1.40.40.8"><csymbol cd="ambiguous" id="S3.E10.m1.35.35.3.3.2.1.1.2.1.cmml" xref="S3.E10.m1.40.40.8">superscript</csymbol><apply id="S3.E10.m1.35.35.3.3.2.1.1.2.2.cmml" xref="S3.E10.m1.40.40.8"><csymbol cd="ambiguous" id="S3.E10.m1.35.35.3.3.2.1.1.2.2.1.cmml" xref="S3.E10.m1.40.40.8">subscript</csymbol><ci id="S3.E10.m1.17.17.17.2.2.2.cmml" xref="S3.E10.m1.17.17.17.2.2.2">𝛾</ci><ci id="S3.E10.m1.18.18.18.3.3.3.1.cmml" xref="S3.E10.m1.18.18.18.3.3.3.1">𝑖</ci></apply><cn type="integer" id="S3.E10.m1.19.19.19.4.4.4.1.cmml" xref="S3.E10.m1.19.19.19.4.4.4.1">2</cn></apply><apply id="S3.E10.m1.20.20.20.5.5.5.cmml" xref="S3.E10.m1.20.20.20.5.5.5"><divide id="S3.E10.m1.20.20.20.5.5.5.1.cmml" xref="S3.E10.m1.20.20.20.5.5.5"></divide><apply id="S3.E10.m1.20.20.20.5.5.5.2.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2"><times id="S3.E10.m1.20.20.20.5.5.5.2.1.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.1"></times><ci id="S3.E10.m1.20.20.20.5.5.5.2.2.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.2">Δ</ci><apply id="S3.E10.m1.20.20.20.5.5.5.2.3.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.20.20.20.5.5.5.2.3.1.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.3">superscript</csymbol><apply id="S3.E10.m1.20.20.20.5.5.5.2.3.2.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.20.20.20.5.5.5.2.3.2.1.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.3">subscript</csymbol><ci id="S3.E10.m1.20.20.20.5.5.5.2.3.2.2.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.3.2.2">𝜎</ci><ci id="S3.E10.m1.20.20.20.5.5.5.2.3.2.3.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E10.m1.20.20.20.5.5.5.2.3.3.cmml" xref="S3.E10.m1.20.20.20.5.5.5.2.3.3">2</cn></apply></apply><apply id="S3.E10.m1.20.20.20.5.5.5.3.cmml" xref="S3.E10.m1.20.20.20.5.5.5.3"><csymbol cd="ambiguous" id="S3.E10.m1.20.20.20.5.5.5.3.1.cmml" xref="S3.E10.m1.20.20.20.5.5.5.3">superscript</csymbol><apply id="S3.E10.m1.20.20.20.5.5.5.3.2.cmml" xref="S3.E10.m1.20.20.20.5.5.5.3"><csymbol cd="ambiguous" id="S3.E10.m1.20.20.20.5.5.5.3.2.1.cmml" xref="S3.E10.m1.20.20.20.5.5.5.3">subscript</csymbol><ci id="S3.E10.m1.20.20.20.5.5.5.3.2.2.cmml" xref="S3.E10.m1.20.20.20.5.5.5.3.2.2">𝜎</ci><ci id="S3.E10.m1.20.20.20.5.5.5.3.2.3.cmml" xref="S3.E10.m1.20.20.20.5.5.5.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E10.m1.20.20.20.5.5.5.3.3.cmml" xref="S3.E10.m1.20.20.20.5.5.5.3.3">2</cn></apply></apply></apply></apply></apply></apply><apply id="S3.E10.m1.36.36.4c.cmml" xref="S3.E10.m1.40.40.8"><lt id="S3.E10.m1.22.22.22.7.7.7.cmml" xref="S3.E10.m1.22.22.22.7.7.7"></lt><share href="#S3.E10.m1.35.35.3.3.cmml" id="S3.E10.m1.36.36.4d.cmml" xref="S3.E10.m1.1.1.1.1.1.1"></share><apply id="S3.E10.m1.36.36.4.4.2.cmml" xref="S3.E10.m1.40.40.8"><abs id="S3.E10.m1.36.36.4.4.2.1.cmml" xref="S3.E10.m1.40.40.8"></abs><apply id="S3.E10.m1.36.36.4.4.1.1.cmml" xref="S3.E10.m1.40.40.8"><minus id="S3.E10.m1.27.27.27.12.12.12.cmml" xref="S3.E10.m1.27.27.27.12.12.12"></minus><apply id="S3.E10.m1.36.36.4.4.1.1.2.cmml" xref="S3.E10.m1.40.40.8"><csymbol cd="ambiguous" id="S3.E10.m1.36.36.4.4.1.1.2.1.cmml" xref="S3.E10.m1.40.40.8">superscript</csymbol><apply id="S3.E10.m1.36.36.4.4.1.1.2.2.cmml" xref="S3.E10.m1.40.40.8"><csymbol cd="ambiguous" id="S3.E10.m1.36.36.4.4.1.1.2.2.1.cmml" xref="S3.E10.m1.40.40.8">subscript</csymbol><ci id="S3.E10.m1.24.24.24.9.9.9.cmml" xref="S3.E10.m1.24.24.24.9.9.9">𝛾</ci><ci id="S3.E10.m1.25.25.25.10.10.10.1.cmml" xref="S3.E10.m1.25.25.25.10.10.10.1">𝑖</ci></apply><cn type="integer" id="S3.E10.m1.26.26.26.11.11.11.1.cmml" xref="S3.E10.m1.26.26.26.11.11.11.1">2</cn></apply><apply id="S3.E10.m1.36.36.4.4.1.1.3.cmml" xref="S3.E10.m1.40.40.8"><times id="S3.E10.m1.36.36.4.4.1.1.3.1.cmml" xref="S3.E10.m1.40.40.8"></times><apply id="S3.E10.m1.36.36.4.4.1.1.3.2.cmml" xref="S3.E10.m1.40.40.8"><csymbol cd="ambiguous" id="S3.E10.m1.36.36.4.4.1.1.3.2.1.cmml" xref="S3.E10.m1.40.40.8">superscript</csymbol><apply id="S3.E10.m1.36.36.4.4.1.1.3.2.2.cmml" xref="S3.E10.m1.40.40.8"><csymbol cd="ambiguous" id="S3.E10.m1.36.36.4.4.1.1.3.2.2.1.cmml" xref="S3.E10.m1.40.40.8">subscript</csymbol><apply id="S3.E10.m1.28.28.28.13.13.13.cmml" xref="S3.E10.m1.28.28.28.13.13.13"><ci id="S3.E10.m1.28.28.28.13.13.13.1.cmml" xref="S3.E10.m1.28.28.28.13.13.13.1">¯</ci><ci id="S3.E10.m1.28.28.28.13.13.13.2.cmml" xref="S3.E10.m1.28.28.28.13.13.13.2">𝛾</ci></apply><ci id="S3.E10.m1.29.29.29.14.14.14.1.cmml" xref="S3.E10.m1.29.29.29.14.14.14.1">𝑖</ci></apply><cn type="integer" id="S3.E10.m1.30.30.30.15.15.15.1.cmml" xref="S3.E10.m1.30.30.30.15.15.15.1">2</cn></apply><apply id="S3.E10.m1.31.31.31.16.16.16.cmml" xref="S3.E10.m1.31.31.31.16.16.16"><divide id="S3.E10.m1.31.31.31.16.16.16.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16"></divide><apply id="S3.E10.m1.31.31.31.16.16.16.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2"><plus id="S3.E10.m1.31.31.31.16.16.16.2.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.1"></plus><apply id="S3.E10.m1.31.31.31.16.16.16.2.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.31.31.31.16.16.16.2.2.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.2">superscript</csymbol><apply id="S3.E10.m1.31.31.31.16.16.16.2.2.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.31.31.31.16.16.16.2.2.2.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.2">subscript</csymbol><ci id="S3.E10.m1.31.31.31.16.16.16.2.2.2.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.2.2.2">𝜎</ci><ci id="S3.E10.m1.31.31.31.16.16.16.2.2.2.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.E10.m1.31.31.31.16.16.16.2.2.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.2.3">2</cn></apply><apply id="S3.E10.m1.31.31.31.16.16.16.2.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3"><times id="S3.E10.m1.31.31.31.16.16.16.2.3.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.1"></times><ci id="S3.E10.m1.31.31.31.16.16.16.2.3.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.2">Δ</ci><apply id="S3.E10.m1.31.31.31.16.16.16.2.3.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.31.31.31.16.16.16.2.3.3.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3">superscript</csymbol><apply id="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3">subscript</csymbol><ci id="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.2">𝜎</ci><ci id="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E10.m1.31.31.31.16.16.16.2.3.3.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E10.m1.31.31.31.16.16.16.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3"><csymbol cd="ambiguous" id="S3.E10.m1.31.31.31.16.16.16.3.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3">superscript</csymbol><apply id="S3.E10.m1.31.31.31.16.16.16.3.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3"><csymbol cd="ambiguous" id="S3.E10.m1.31.31.31.16.16.16.3.2.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3">subscript</csymbol><apply id="S3.E10.m1.31.31.31.16.16.16.3.2.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3.2.2"><ci id="S3.E10.m1.31.31.31.16.16.16.3.2.2.1.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3.2.2.1">¯</ci><ci id="S3.E10.m1.31.31.31.16.16.16.3.2.2.2.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3.2.2.2">𝜎</ci></apply><ci id="S3.E10.m1.31.31.31.16.16.16.3.2.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.E10.m1.31.31.31.16.16.16.3.3.cmml" xref="S3.E10.m1.31.31.31.16.16.16.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.40c">\begin{gathered}\left|\gamma\frac{\Delta\mu_{i}}{\sigma_{i}}\right|&lt;\left|\beta_{i}-\bar{\gamma}\frac{\mu_{i}+\Delta\mu_{i}-\bar{\mu}_{i}}{\bar{\sigma}_{i}}-\bar{\beta}_{i}\right|\\
\left|\gamma_{i}^{2}\frac{\Delta\sigma_{i}^{2}}{\sigma_{i}^{2}}\right|&lt;\left|\gamma_{i}^{2}-\bar{\gamma}_{i}^{2}\frac{\sigma_{i}^{2}+\Delta\sigma_{i}^{2}}{\bar{\sigma}_{i}^{2}}\right|\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p14" class="ltx_para ltx_noindent">
<p id="S3.SS2.p14.1" class="ltx_p">Assuming the above inequality holds, it is easy to see how the values propagated through the network after the first layer are closer to the pre-aggregation values when using BN-patches as opposed to federated BN layers. If BN-patches are added throughout the network, the intermediate DNN values will be regularly ‘constrained’ to be closer to the pre-aggregation values, resulting ultimately in network outputs closer to the pre-aggregation outputs.</p>
</div>
<div id="S3.SS2.p15" class="ltx_para">
<p id="S3.SS2.p15.5" class="ltx_p">Looking at Eq. (8), if <math id="S3.SS2.p15.1.m1.1" class="ltx_Math" alttext="\Delta\mu_{i}" display="inline"><semantics id="S3.SS2.p15.1.m1.1a"><mrow id="S3.SS2.p15.1.m1.1.1" xref="S3.SS2.p15.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p15.1.m1.1.1.2" xref="S3.SS2.p15.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p15.1.m1.1.1.1" xref="S3.SS2.p15.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS2.p15.1.m1.1.1.3" xref="S3.SS2.p15.1.m1.1.1.3.cmml"><mi id="S3.SS2.p15.1.m1.1.1.3.2" xref="S3.SS2.p15.1.m1.1.1.3.2.cmml">μ</mi><mi id="S3.SS2.p15.1.m1.1.1.3.3" xref="S3.SS2.p15.1.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p15.1.m1.1b"><apply id="S3.SS2.p15.1.m1.1.1.cmml" xref="S3.SS2.p15.1.m1.1.1"><times id="S3.SS2.p15.1.m1.1.1.1.cmml" xref="S3.SS2.p15.1.m1.1.1.1"></times><ci id="S3.SS2.p15.1.m1.1.1.2.cmml" xref="S3.SS2.p15.1.m1.1.1.2">Δ</ci><apply id="S3.SS2.p15.1.m1.1.1.3.cmml" xref="S3.SS2.p15.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p15.1.m1.1.1.3.1.cmml" xref="S3.SS2.p15.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p15.1.m1.1.1.3.2.cmml" xref="S3.SS2.p15.1.m1.1.1.3.2">𝜇</ci><ci id="S3.SS2.p15.1.m1.1.1.3.3.cmml" xref="S3.SS2.p15.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p15.1.m1.1c">\Delta\mu_{i}</annotation></semantics></math> and <math id="S3.SS2.p15.2.m2.1" class="ltx_Math" alttext="\Delta\sigma_{i}^{2}" display="inline"><semantics id="S3.SS2.p15.2.m2.1a"><mrow id="S3.SS2.p15.2.m2.1.1" xref="S3.SS2.p15.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p15.2.m2.1.1.2" xref="S3.SS2.p15.2.m2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p15.2.m2.1.1.1" xref="S3.SS2.p15.2.m2.1.1.1.cmml">​</mo><msubsup id="S3.SS2.p15.2.m2.1.1.3" xref="S3.SS2.p15.2.m2.1.1.3.cmml"><mi id="S3.SS2.p15.2.m2.1.1.3.2.2" xref="S3.SS2.p15.2.m2.1.1.3.2.2.cmml">σ</mi><mi id="S3.SS2.p15.2.m2.1.1.3.2.3" xref="S3.SS2.p15.2.m2.1.1.3.2.3.cmml">i</mi><mn id="S3.SS2.p15.2.m2.1.1.3.3" xref="S3.SS2.p15.2.m2.1.1.3.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p15.2.m2.1b"><apply id="S3.SS2.p15.2.m2.1.1.cmml" xref="S3.SS2.p15.2.m2.1.1"><times id="S3.SS2.p15.2.m2.1.1.1.cmml" xref="S3.SS2.p15.2.m2.1.1.1"></times><ci id="S3.SS2.p15.2.m2.1.1.2.cmml" xref="S3.SS2.p15.2.m2.1.1.2">Δ</ci><apply id="S3.SS2.p15.2.m2.1.1.3.cmml" xref="S3.SS2.p15.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p15.2.m2.1.1.3.1.cmml" xref="S3.SS2.p15.2.m2.1.1.3">superscript</csymbol><apply id="S3.SS2.p15.2.m2.1.1.3.2.cmml" xref="S3.SS2.p15.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p15.2.m2.1.1.3.2.1.cmml" xref="S3.SS2.p15.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p15.2.m2.1.1.3.2.2.cmml" xref="S3.SS2.p15.2.m2.1.1.3.2.2">𝜎</ci><ci id="S3.SS2.p15.2.m2.1.1.3.2.3.cmml" xref="S3.SS2.p15.2.m2.1.1.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p15.2.m2.1.1.3.3.cmml" xref="S3.SS2.p15.2.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p15.2.m2.1c">\Delta\sigma_{i}^{2}</annotation></semantics></math> for neuron <math id="S3.SS2.p15.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p15.3.m3.1a"><mi id="S3.SS2.p15.3.m3.1.1" xref="S3.SS2.p15.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p15.3.m3.1b"><ci id="S3.SS2.p15.3.m3.1.1.cmml" xref="S3.SS2.p15.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p15.3.m3.1c">i</annotation></semantics></math> are large, then the output distribution of the neuron after the BN-patch layer (<math id="S3.SS2.p15.4.m4.1" class="ltx_Math" alttext="\mathrm{BN}(\hat{\bar{x}})_{i}" display="inline"><semantics id="S3.SS2.p15.4.m4.1a"><mrow id="S3.SS2.p15.4.m4.1.2" xref="S3.SS2.p15.4.m4.1.2.cmml"><mi id="S3.SS2.p15.4.m4.1.2.2" xref="S3.SS2.p15.4.m4.1.2.2.cmml">BN</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p15.4.m4.1.2.1" xref="S3.SS2.p15.4.m4.1.2.1.cmml">​</mo><msub id="S3.SS2.p15.4.m4.1.2.3" xref="S3.SS2.p15.4.m4.1.2.3.cmml"><mrow id="S3.SS2.p15.4.m4.1.2.3.2.2" xref="S3.SS2.p15.4.m4.1.1.cmml"><mo stretchy="false" id="S3.SS2.p15.4.m4.1.2.3.2.2.1" xref="S3.SS2.p15.4.m4.1.1.cmml">(</mo><mover accent="true" id="S3.SS2.p15.4.m4.1.1" xref="S3.SS2.p15.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.p15.4.m4.1.1.2" xref="S3.SS2.p15.4.m4.1.1.2.cmml"><mi id="S3.SS2.p15.4.m4.1.1.2.2" xref="S3.SS2.p15.4.m4.1.1.2.2.cmml">x</mi><mo id="S3.SS2.p15.4.m4.1.1.2.1" xref="S3.SS2.p15.4.m4.1.1.2.1.cmml">¯</mo></mover><mo id="S3.SS2.p15.4.m4.1.1.1" xref="S3.SS2.p15.4.m4.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.SS2.p15.4.m4.1.2.3.2.2.2" xref="S3.SS2.p15.4.m4.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p15.4.m4.1.2.3.3" xref="S3.SS2.p15.4.m4.1.2.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p15.4.m4.1b"><apply id="S3.SS2.p15.4.m4.1.2.cmml" xref="S3.SS2.p15.4.m4.1.2"><times id="S3.SS2.p15.4.m4.1.2.1.cmml" xref="S3.SS2.p15.4.m4.1.2.1"></times><ci id="S3.SS2.p15.4.m4.1.2.2.cmml" xref="S3.SS2.p15.4.m4.1.2.2">BN</ci><apply id="S3.SS2.p15.4.m4.1.2.3.cmml" xref="S3.SS2.p15.4.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p15.4.m4.1.2.3.1.cmml" xref="S3.SS2.p15.4.m4.1.2.3">subscript</csymbol><apply id="S3.SS2.p15.4.m4.1.1.cmml" xref="S3.SS2.p15.4.m4.1.2.3.2.2"><ci id="S3.SS2.p15.4.m4.1.1.1.cmml" xref="S3.SS2.p15.4.m4.1.1.1">^</ci><apply id="S3.SS2.p15.4.m4.1.1.2.cmml" xref="S3.SS2.p15.4.m4.1.1.2"><ci id="S3.SS2.p15.4.m4.1.1.2.1.cmml" xref="S3.SS2.p15.4.m4.1.1.2.1">¯</ci><ci id="S3.SS2.p15.4.m4.1.1.2.2.cmml" xref="S3.SS2.p15.4.m4.1.1.2.2">𝑥</ci></apply></apply><ci id="S3.SS2.p15.4.m4.1.2.3.3.cmml" xref="S3.SS2.p15.4.m4.1.2.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p15.4.m4.1c">\mathrm{BN}(\hat{\bar{x}})_{i}</annotation></semantics></math>) over the test-set will be quite different than <math id="S3.SS2.p15.5.m5.1" class="ltx_Math" alttext="\mathrm{BN}(\hat{x})_{i}" display="inline"><semantics id="S3.SS2.p15.5.m5.1a"><mrow id="S3.SS2.p15.5.m5.1.2" xref="S3.SS2.p15.5.m5.1.2.cmml"><mi id="S3.SS2.p15.5.m5.1.2.2" xref="S3.SS2.p15.5.m5.1.2.2.cmml">BN</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p15.5.m5.1.2.1" xref="S3.SS2.p15.5.m5.1.2.1.cmml">​</mo><msub id="S3.SS2.p15.5.m5.1.2.3" xref="S3.SS2.p15.5.m5.1.2.3.cmml"><mrow id="S3.SS2.p15.5.m5.1.2.3.2.2" xref="S3.SS2.p15.5.m5.1.1.cmml"><mo stretchy="false" id="S3.SS2.p15.5.m5.1.2.3.2.2.1" xref="S3.SS2.p15.5.m5.1.1.cmml">(</mo><mover accent="true" id="S3.SS2.p15.5.m5.1.1" xref="S3.SS2.p15.5.m5.1.1.cmml"><mi id="S3.SS2.p15.5.m5.1.1.2" xref="S3.SS2.p15.5.m5.1.1.2.cmml">x</mi><mo id="S3.SS2.p15.5.m5.1.1.1" xref="S3.SS2.p15.5.m5.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.SS2.p15.5.m5.1.2.3.2.2.2" xref="S3.SS2.p15.5.m5.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p15.5.m5.1.2.3.3" xref="S3.SS2.p15.5.m5.1.2.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p15.5.m5.1b"><apply id="S3.SS2.p15.5.m5.1.2.cmml" xref="S3.SS2.p15.5.m5.1.2"><times id="S3.SS2.p15.5.m5.1.2.1.cmml" xref="S3.SS2.p15.5.m5.1.2.1"></times><ci id="S3.SS2.p15.5.m5.1.2.2.cmml" xref="S3.SS2.p15.5.m5.1.2.2">BN</ci><apply id="S3.SS2.p15.5.m5.1.2.3.cmml" xref="S3.SS2.p15.5.m5.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p15.5.m5.1.2.3.1.cmml" xref="S3.SS2.p15.5.m5.1.2.3">subscript</csymbol><apply id="S3.SS2.p15.5.m5.1.1.cmml" xref="S3.SS2.p15.5.m5.1.2.3.2.2"><ci id="S3.SS2.p15.5.m5.1.1.1.cmml" xref="S3.SS2.p15.5.m5.1.1.1">^</ci><ci id="S3.SS2.p15.5.m5.1.1.2.cmml" xref="S3.SS2.p15.5.m5.1.1.2">𝑥</ci></apply><ci id="S3.SS2.p15.5.m5.1.2.3.3.cmml" xref="S3.SS2.p15.5.m5.1.2.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p15.5.m5.1c">\mathrm{BN}(\hat{x})_{i}</annotation></semantics></math>. The BN-patch layer will therefore provide little benefit over a federated BN layer, as the left hand sides of the inequalities in Eq. (10) are unlikely to be much smaller than the right hand sides. Large differences in pre- and post-aggregated model parameters are seen during the early stages of training, when gradients are large and client models diverge more during local training. This therefore implies that MTFL has less benefit during the early stages of training, and its benefit increases during training as gradient magnitudes decrease (as shown in Fig. 4).</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span id="S3.SS3.1.1" class="ltx_text ltx_font_italic">Federated Optimisation within MTFL</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">As shown in Algorithm 1, MTFL applies private patch layers for each client, and trains them alongside the federated (non-private) layers during LocalUpdate. At the end of each round, the server aggregates the uploaded federated layers from clients (and any distributed optimiser values used), producing a new global model using the GlobalModelUpdate function. If distributed adaptive-optimisation is used, then the GlobalOptimUpdate function will also be called. Table 1 details different FL training algorithms as characterised by their implementations of these functions.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.4" class="ltx_p">In FedAvg, LocalUpdate is simply minibatch-SGD, and GlobalModelUpdate produces the new global model as a weighted (by number of local samples) average of uploaded client models. FedAvg uses SGD with no adaptive optimisation, so the variable <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">V</annotation></semantics></math> in Algorithm 1 is a tuple of empty values, and GlobalOptimUpdate performs no function. For FedAdam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, clients also perform SGD during LocalUpdate. However, during GlobalModelUpdate, the server takes the difference (<math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\Delta_{r}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">Δ</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">Δ</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\Delta_{r}</annotation></semantics></math>) between the previous global model and the average uploaded client model. The server treats <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\Delta_{r}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">Δ</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">Δ</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\Delta_{r}</annotation></semantics></math> as a ‘psuedogradient’, and uses a set of <span id="S3.SS3.p2.4.1" class="ltx_ERROR undefined">\nth</span>1 and <span id="S3.SS3.p2.4.2" class="ltx_ERROR undefined">\nth</span>2 moment values stored on the server to update the global model using an Adam-like update step. Clients do not use distributed adaptive optimisation in FedAdam, so <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">V</annotation></semantics></math> is also a tuple of empty values and GlobalOptimUpdate performs no function.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.3" class="ltx_p">We propose using adaptive optimisation (namely, Adam) as the distributed optimisation strategy. We call this strategy FedAvg-Adam. In FedAvg-Adam, clients share a global set of Adam <span id="S3.SS3.p3.3.1" class="ltx_ERROR undefined">\nth</span>1 and <span id="S3.SS3.p3.3.2" class="ltx_ERROR undefined">\nth</span>2 moments, stored in the <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">V</annotation></semantics></math> variable in Algorithm 1. Clients store private optimiser values for their patch layers (<math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="W_{k}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">W</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑊</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">W_{k}</annotation></semantics></math>), as we find performance is better when keeping private optimiser values for patches. During LocalUpdate, clients perform Adam SGD, and the federated model layers and Adam values are uploaded by clients at the end of the round. To produce a new global model, the server averages the client models in GlobalModelUpdate and averages the Adam moments in GlobalOptimUpdate. FedAvg-Adam therefore has a <math id="S3.SS3.p3.3.m3.1" class="ltx_math_unparsed" alttext="3\times" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1b"><mn id="S3.SS3.p3.3.m3.1.1">3</mn><mo lspace="0.222em" id="S3.SS3.p3.3.m3.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">3\times</annotation></semantics></math> communication cost per round compared to FedAvg or FedAdam. However, in many FL scenarios, the major concern is reducing the number of communication rounds required for the model to converge. We later show that FedAvg-Adam considerably improves the convergence speed of FL and MTFL.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p">For the rest of the paper, we refer to iterative FL schemes that do not keep any private model patches as FL, with the optimisation strategy in brackets, e.g. FL(FedAvg). If clients keep private model patches, we refer to the scheme as MTFL, again with the optimisation strategy in brackets, e.g. MTFL(FedAvg).</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>LocalUpdate, GlobalModelUpdate and GlobalOptimUpdate used by the FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, FedAdam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and FedAvg-Adam FL training strategies. All of these strategies can be used within MTFL.</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S3.T1.1.1.1.1" class="ltx_text" style="font-size:90%;">Optimisation</span></td>
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S3.T1.1.1.2.1" class="ltx_text" style="font-size:90%;">LocalUpdate</span></td>
<td id="S3.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T1.1.1.3.1" class="ltx_text" style="font-size:90%;">GlobalModel</span></td>
<td id="S3.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T1.1.1.4.1" class="ltx_text" style="font-size:90%;">GlobalOptim</span></td>
</tr>
<tr id="S3.T1.1.2" class="ltx_tr">
<td id="S3.T1.1.2.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.1.2.1.1" class="ltx_text" style="font-size:90%;">Strategy</span></td>
<td id="S3.T1.1.2.2" class="ltx_td ltx_align_center"><span id="S3.T1.1.2.2.1" class="ltx_text" style="font-size:90%;">Update</span></td>
<td id="S3.T1.1.2.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.2.3.1" class="ltx_text" style="font-size:90%;">Update</span></td>
</tr>
<tr id="S3.T1.1.3" class="ltx_tr">
<td id="S3.T1.1.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.1.3.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S3.T1.1.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.3.2.1" class="ltx_text" style="font-size:90%;">SGD</span></td>
<td id="S3.T1.1.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.3.3.1" class="ltx_text" style="font-size:90%;">Average</span></td>
<td id="S3.T1.1.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.1.3.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S3.T1.1.4" class="ltx_tr">
<td id="S3.T1.1.4.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.1.4.1.1" class="ltx_text" style="font-size:90%;">FedAdam</span></td>
<td id="S3.T1.1.4.2" class="ltx_td ltx_align_center"><span id="S3.T1.1.4.2.1" class="ltx_text" style="font-size:90%;">SGD</span></td>
<td id="S3.T1.1.4.3" class="ltx_td ltx_align_center"><span id="S3.T1.1.4.3.1" class="ltx_text" style="font-size:90%;">Adam</span></td>
<td id="S3.T1.1.4.4" class="ltx_td ltx_align_center"><span id="S3.T1.1.4.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S3.T1.1.5" class="ltx_tr">
<td id="S3.T1.1.5.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T1.1.5.1.1" class="ltx_text" style="font-size:90%;">FedAvg-Adam</span></td>
<td id="S3.T1.1.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.1.5.2.1" class="ltx_text" style="font-size:90%;">Adam</span></td>
<td id="S3.T1.1.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.1.5.3.1" class="ltx_text" style="font-size:90%;">Average</span></td>
<td id="S3.T1.1.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.1.5.4.1" class="ltx_text" style="font-size:90%;">Average</span></td>
</tr>
</table>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Communication rounds required to reach target average user accuracies for different tasks using FL and MTFL (with private statistics <math id="S3.T2.7.m1.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S3.T2.7.m1.2b"><mrow id="S3.T2.7.m1.2.3.2" xref="S3.T2.7.m1.2.3.1.cmml"><mi id="S3.T2.7.m1.1.1" xref="S3.T2.7.m1.1.1.cmml">μ</mi><mo id="S3.T2.7.m1.2.3.2.1" xref="S3.T2.7.m1.2.3.1.cmml">,</mo><mi id="S3.T2.7.m1.2.2" xref="S3.T2.7.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.7.m1.2c"><list id="S3.T2.7.m1.2.3.1.cmml" xref="S3.T2.7.m1.2.3.2"><ci id="S3.T2.7.m1.1.1.cmml" xref="S3.T2.7.m1.1.1">𝜇</ci><ci id="S3.T2.7.m1.2.2.cmml" xref="S3.T2.7.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.m1.2d">\mu,\sigma</annotation></semantics></math> and/or trained parameters <math id="S3.T2.8.m2.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S3.T2.8.m2.2b"><mrow id="S3.T2.8.m2.2.3.2" xref="S3.T2.8.m2.2.3.1.cmml"><mi id="S3.T2.8.m2.1.1" xref="S3.T2.8.m2.1.1.cmml">γ</mi><mo id="S3.T2.8.m2.2.3.2.1" xref="S3.T2.8.m2.2.3.1.cmml">,</mo><mi id="S3.T2.8.m2.2.2" xref="S3.T2.8.m2.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.8.m2.2c"><list id="S3.T2.8.m2.2.3.1.cmml" xref="S3.T2.8.m2.2.3.2"><ci id="S3.T2.8.m2.1.1.cmml" xref="S3.T2.8.m2.1.1">𝛾</ci><ci id="S3.T2.8.m2.2.2.cmml" xref="S3.T2.8.m2.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.m2.2d">\gamma,\beta</annotation></semantics></math>), for different numbers of total clients <math id="S3.T2.9.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.T2.9.m3.1b"><mi id="S3.T2.9.m3.1.1" xref="S3.T2.9.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.T2.9.m3.1c"><ci id="S3.T2.9.m3.1.1.cmml" xref="S3.T2.9.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.m3.1d">W</annotation></semantics></math>, client participation rates <math id="S3.T2.10.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.T2.10.m4.1b"><mi id="S3.T2.10.m4.1.1" xref="S3.T2.10.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.T2.10.m4.1c"><ci id="S3.T2.10.m4.1.1.cmml" xref="S3.T2.10.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.m4.1d">C</annotation></semantics></math>, and optimisation strategies. Cases unable to reach the target UA within 500 rounds are denoted by X. Best results for each scenario (combination of <math id="S3.T2.11.m5.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.T2.11.m5.1b"><mi id="S3.T2.11.m5.1.1" xref="S3.T2.11.m5.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.T2.11.m5.1c"><ci id="S3.T2.11.m5.1.1.cmml" xref="S3.T2.11.m5.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.m5.1d">W</annotation></semantics></math> and <math id="S3.T2.12.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.T2.12.m6.1b"><mi id="S3.T2.12.m6.1.1" xref="S3.T2.12.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.T2.12.m6.1c"><ci id="S3.T2.12.m6.1.1.cmml" xref="S3.T2.12.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.m6.1d">C</annotation></semantics></math>) given in bold.</figcaption>
<table id="S3.T2.15" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T2.15.4" class="ltx_tr">
<td id="S3.T2.15.4.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="17"><span id="S3.T2.15.4.1.1" class="ltx_text" style="font-size:90%;">MNIST - 2NN</span></td>
</tr>
<tr id="S3.T2.15.5" class="ltx_tr">
<td id="S3.T2.15.5.1" class="ltx_td ltx_border_t"></td>
<td id="S3.T2.15.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4"><span id="S3.T2.15.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">FL</span></td>
<td id="S3.T2.15.5.3" class="ltx_td ltx_align_center ltx_border_t" colspan="12"><span id="S3.T2.15.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">MTFL</span></td>
</tr>
<tr id="S3.T2.15.3" class="ltx_tr">
<td id="S3.T2.15.3.4" class="ltx_td"></td>
<td id="S3.T2.15.3.5" class="ltx_td ltx_align_center ltx_border_r" colspan="4"><span id="S3.T2.15.3.5.1" class="ltx_text" style="font-size:90%;">Private values = None</span></td>
<td id="S3.T2.13.1.1" class="ltx_td ltx_align_center ltx_border_r" colspan="4"><math id="S3.T2.13.1.1.m1.4" class="ltx_Math" alttext="\mu,\sigma,\gamma,\beta" display="inline"><semantics id="S3.T2.13.1.1.m1.4a"><mrow id="S3.T2.13.1.1.m1.4.5.2" xref="S3.T2.13.1.1.m1.4.5.1.cmml"><mi mathsize="90%" id="S3.T2.13.1.1.m1.1.1" xref="S3.T2.13.1.1.m1.1.1.cmml">μ</mi><mo mathsize="90%" id="S3.T2.13.1.1.m1.4.5.2.1" xref="S3.T2.13.1.1.m1.4.5.1.cmml">,</mo><mi mathsize="90%" id="S3.T2.13.1.1.m1.2.2" xref="S3.T2.13.1.1.m1.2.2.cmml">σ</mi><mo mathsize="90%" id="S3.T2.13.1.1.m1.4.5.2.2" xref="S3.T2.13.1.1.m1.4.5.1.cmml">,</mo><mi mathsize="90%" id="S3.T2.13.1.1.m1.3.3" xref="S3.T2.13.1.1.m1.3.3.cmml">γ</mi><mo mathsize="90%" id="S3.T2.13.1.1.m1.4.5.2.3" xref="S3.T2.13.1.1.m1.4.5.1.cmml">,</mo><mi mathsize="90%" id="S3.T2.13.1.1.m1.4.4" xref="S3.T2.13.1.1.m1.4.4.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.13.1.1.m1.4b"><list id="S3.T2.13.1.1.m1.4.5.1.cmml" xref="S3.T2.13.1.1.m1.4.5.2"><ci id="S3.T2.13.1.1.m1.1.1.cmml" xref="S3.T2.13.1.1.m1.1.1">𝜇</ci><ci id="S3.T2.13.1.1.m1.2.2.cmml" xref="S3.T2.13.1.1.m1.2.2">𝜎</ci><ci id="S3.T2.13.1.1.m1.3.3.cmml" xref="S3.T2.13.1.1.m1.3.3">𝛾</ci><ci id="S3.T2.13.1.1.m1.4.4.cmml" xref="S3.T2.13.1.1.m1.4.4">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.13.1.1.m1.4c">\mu,\sigma,\gamma,\beta</annotation></semantics></math></td>
<td id="S3.T2.14.2.2" class="ltx_td ltx_align_center ltx_border_r" colspan="4"><math id="S3.T2.14.2.2.m1.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S3.T2.14.2.2.m1.2a"><mrow id="S3.T2.14.2.2.m1.2.3.2" xref="S3.T2.14.2.2.m1.2.3.1.cmml"><mi mathsize="90%" id="S3.T2.14.2.2.m1.1.1" xref="S3.T2.14.2.2.m1.1.1.cmml">μ</mi><mo mathsize="90%" id="S3.T2.14.2.2.m1.2.3.2.1" xref="S3.T2.14.2.2.m1.2.3.1.cmml">,</mo><mi mathsize="90%" id="S3.T2.14.2.2.m1.2.2" xref="S3.T2.14.2.2.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.14.2.2.m1.2b"><list id="S3.T2.14.2.2.m1.2.3.1.cmml" xref="S3.T2.14.2.2.m1.2.3.2"><ci id="S3.T2.14.2.2.m1.1.1.cmml" xref="S3.T2.14.2.2.m1.1.1">𝜇</ci><ci id="S3.T2.14.2.2.m1.2.2.cmml" xref="S3.T2.14.2.2.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.14.2.2.m1.2c">\mu,\sigma</annotation></semantics></math></td>
<td id="S3.T2.15.3.3" class="ltx_td ltx_align_center" colspan="4"><math id="S3.T2.15.3.3.m1.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S3.T2.15.3.3.m1.2a"><mrow id="S3.T2.15.3.3.m1.2.3.2" xref="S3.T2.15.3.3.m1.2.3.1.cmml"><mi mathsize="90%" id="S3.T2.15.3.3.m1.1.1" xref="S3.T2.15.3.3.m1.1.1.cmml">γ</mi><mo mathsize="90%" id="S3.T2.15.3.3.m1.2.3.2.1" xref="S3.T2.15.3.3.m1.2.3.1.cmml">,</mo><mi mathsize="90%" id="S3.T2.15.3.3.m1.2.2" xref="S3.T2.15.3.3.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.15.3.3.m1.2b"><list id="S3.T2.15.3.3.m1.2.3.1.cmml" xref="S3.T2.15.3.3.m1.2.3.2"><ci id="S3.T2.15.3.3.m1.1.1.cmml" xref="S3.T2.15.3.3.m1.1.1">𝛾</ci><ci id="S3.T2.15.3.3.m1.2.2.cmml" xref="S3.T2.15.3.3.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.15.3.3.m1.2c">\gamma,\beta</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.15.6" class="ltx_tr">
<td id="S3.T2.15.6.1" class="ltx_td ltx_align_center"><span id="S3.T2.15.6.1.1" class="ltx_text" style="font-size:90%;">Optimisation</span></td>
<td id="S3.T2.15.6.2" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T2.15.6.2.1" class="ltx_text" style="font-size:90%;">W = 200</span></td>
<td id="S3.T2.15.6.3" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T2.15.6.3.1" class="ltx_text" style="font-size:90%;">400</span></td>
<td id="S3.T2.15.6.4" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T2.15.6.4.1" class="ltx_text" style="font-size:90%;">200</span></td>
<td id="S3.T2.15.6.5" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T2.15.6.5.1" class="ltx_text" style="font-size:90%;">400</span></td>
<td id="S3.T2.15.6.6" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T2.15.6.6.1" class="ltx_text" style="font-size:90%;">200</span></td>
<td id="S3.T2.15.6.7" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T2.15.6.7.1" class="ltx_text" style="font-size:90%;">400</span></td>
<td id="S3.T2.15.6.8" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T2.15.6.8.1" class="ltx_text" style="font-size:90%;">200</span></td>
<td id="S3.T2.15.6.9" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T2.15.6.9.1" class="ltx_text" style="font-size:90%;">400</span></td>
</tr>
<tr id="S3.T2.15.7" class="ltx_tr">
<td id="S3.T2.15.7.1" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.1.1" class="ltx_text" style="font-size:90%;">Strategy</span></td>
<td id="S3.T2.15.7.2" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.2.1" class="ltx_text" style="font-size:90%;">C = 0.5</span></td>
<td id="S3.T2.15.7.3" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.3.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T2.15.7.4" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.4.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T2.15.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.15.7.5.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T2.15.7.6" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.6.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T2.15.7.7" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.7.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T2.15.7.8" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.8.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T2.15.7.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.15.7.9.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T2.15.7.10" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.10.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T2.15.7.11" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.11.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T2.15.7.12" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.12.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T2.15.7.13" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.15.7.13.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T2.15.7.14" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.14.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T2.15.7.15" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.15.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T2.15.7.16" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.16.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T2.15.7.17" class="ltx_td ltx_align_center"><span id="S3.T2.15.7.17.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
</tr>
<tr id="S3.T2.15.8" class="ltx_tr">
<td id="S3.T2.15.8.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.15.8.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S3.T2.15.8.2" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.2.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">99</span></td>
<td id="S3.T2.15.8.3" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.3.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">102</span></td>
<td id="S3.T2.15.8.4" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.4.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">107</span></td>
<td id="S3.T2.15.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.5.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">110</span></td>
<td id="S3.T2.15.8.6" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.6.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">85</span></td>
<td id="S3.T2.15.8.7" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.7.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">58</span></td>
<td id="S3.T2.15.8.8" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.8.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">101</span></td>
<td id="S3.T2.15.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.9.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">68</span></td>
<td id="S3.T2.15.8.10" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.10.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">X</span></td>
<td id="S3.T2.15.8.11" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.11.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">X</span></td>
<td id="S3.T2.15.8.12" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.12.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">X</span></td>
<td id="S3.T2.15.8.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.13.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">X</span></td>
<td id="S3.T2.15.8.14" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.14.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">29</span></td>
<td id="S3.T2.15.8.15" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.15.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">21</span></td>
<td id="S3.T2.15.8.16" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.16.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">34</span></td>
<td id="S3.T2.15.8.17" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.8.17.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">26</span></td>
</tr>
<tr id="S3.T2.15.9" class="ltx_tr">
<td id="S3.T2.15.9.1" class="ltx_td ltx_align_center"><span id="S3.T2.15.9.1.1" class="ltx_text" style="font-size:90%;">FedAdam</span></td>
<td id="S3.T2.15.9.2" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.2.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">85</span></td>
<td id="S3.T2.15.9.3" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.3.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">69</span></td>
<td id="S3.T2.15.9.4" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.4.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">88</span></td>
<td id="S3.T2.15.9.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T2.15.9.5.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">65</span></td>
<td id="S3.T2.15.9.6" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.6.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">56</span></td>
<td id="S3.T2.15.9.7" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.7.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">37</span></td>
<td id="S3.T2.15.9.8" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.8.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">75</span></td>
<td id="S3.T2.15.9.9" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T2.15.9.9.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">77</span></td>
<td id="S3.T2.15.9.10" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.10.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">109</span></td>
<td id="S3.T2.15.9.11" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.11.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">90</span></td>
<td id="S3.T2.15.9.12" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.12.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">194</span></td>
<td id="S3.T2.15.9.13" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T2.15.9.13.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">262</span></td>
<td id="S3.T2.15.9.14" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.14.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">31</span></td>
<td id="S3.T2.15.9.15" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.15.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">25</span></td>
<td id="S3.T2.15.9.16" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.16.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">31</span></td>
<td id="S3.T2.15.9.17" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.9.17.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">27</span></td>
</tr>
<tr id="S3.T2.15.10" class="ltx_tr">
<td id="S3.T2.15.10.1" class="ltx_td ltx_align_center"><span id="S3.T2.15.10.1.1" class="ltx_text" style="font-size:90%;">FedAvg-Adam</span></td>
<td id="S3.T2.15.10.2" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.2.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">44</span></td>
<td id="S3.T2.15.10.3" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.3.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">49</span></td>
<td id="S3.T2.15.10.4" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.4.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">40</span></td>
<td id="S3.T2.15.10.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.5.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">50</span></td>
<td id="S3.T2.15.10.6" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.6.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">17</span></td>
<td id="S3.T2.15.10.7" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.7.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">41</span></td>
<td id="S3.T2.15.10.8" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.8.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">19</span></td>
<td id="S3.T2.15.10.9" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.9.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">32</span></td>
<td id="S3.T2.15.10.10" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.10.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">131</span></td>
<td id="S3.T2.15.10.11" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.11.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">151</span></td>
<td id="S3.T2.15.10.12" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.12.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">170</span></td>
<td id="S3.T2.15.10.13" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.13.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">198</span></td>
<td id="S3.T2.15.10.14" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.14.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">9</span></td>
<td id="S3.T2.15.10.15" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.15.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">9</span></td>
<td id="S3.T2.15.10.16" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.16.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">10</span></td>
<td id="S3.T2.15.10.17" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T2.15.10.17.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">9</span></td>
</tr>
<tr id="S3.T2.15.11" class="ltx_tr">
<td id="S3.T2.15.11.1" class="ltx_td ltx_align_center ltx_border_t" colspan="17"><span id="S3.T2.15.11.1.1" class="ltx_text" style="font-size:90%;">CIFAR10 - CNN</span></td>
</tr>
<tr id="S3.T2.15.12" class="ltx_tr">
<td id="S3.T2.15.12.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.15.12.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S3.T2.15.12.2" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.2.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">139</span></td>
<td id="S3.T2.15.12.3" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.3.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">138</span></td>
<td id="S3.T2.15.12.4" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.4.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">171</span></td>
<td id="S3.T2.15.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.5.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">164</span></td>
<td id="S3.T2.15.12.6" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.6.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">49</span></td>
<td id="S3.T2.15.12.7" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.7.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">33</span></td>
<td id="S3.T2.15.12.8" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.8.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">55</span></td>
<td id="S3.T2.15.12.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.9.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">36</span></td>
<td id="S3.T2.15.12.10" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.10.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">231</span></td>
<td id="S3.T2.15.12.11" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.11.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">280</span></td>
<td id="S3.T2.15.12.12" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.12.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">258</span></td>
<td id="S3.T2.15.12.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.13.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">266</span></td>
<td id="S3.T2.15.12.14" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.14.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">37</span></td>
<td id="S3.T2.15.12.15" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.15.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">24</span></td>
<td id="S3.T2.15.12.16" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.16.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">45</span></td>
<td id="S3.T2.15.12.17" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T2.15.12.17.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">30</span></td>
</tr>
<tr id="S3.T2.15.13" class="ltx_tr">
<td id="S3.T2.15.13.1" class="ltx_td ltx_align_center"><span id="S3.T2.15.13.1.1" class="ltx_text" style="font-size:90%;">FedAdam</span></td>
<td id="S3.T2.15.13.2" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.2.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">105</span></td>
<td id="S3.T2.15.13.3" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.3.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">90</span></td>
<td id="S3.T2.15.13.4" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.4.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">83</span></td>
<td id="S3.T2.15.13.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T2.15.13.5.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">80</span></td>
<td id="S3.T2.15.13.6" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.6.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">21</span></td>
<td id="S3.T2.15.13.7" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.7.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">14</span></td>
<td id="S3.T2.15.13.8" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.8.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">22</span></td>
<td id="S3.T2.15.13.9" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T2.15.13.9.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">16</span></td>
<td id="S3.T2.15.13.10" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.10.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">67</span></td>
<td id="S3.T2.15.13.11" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.11.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">45</span></td>
<td id="S3.T2.15.13.12" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.12.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">48</span></td>
<td id="S3.T2.15.13.13" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T2.15.13.13.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">38</span></td>
<td id="S3.T2.15.13.14" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.14.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">24</span></td>
<td id="S3.T2.15.13.15" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.15.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">14</span></td>
<td id="S3.T2.15.13.16" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.16.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">25</span></td>
<td id="S3.T2.15.13.17" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T2.15.13.17.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">16</span></td>
</tr>
<tr id="S3.T2.15.14" class="ltx_tr">
<td id="S3.T2.15.14.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.15.14.1.1" class="ltx_text" style="font-size:90%;">FedAvg-Adam</span></td>
<td id="S3.T2.15.14.2" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.2.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">57</span></td>
<td id="S3.T2.15.14.3" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.3.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">43</span></td>
<td id="S3.T2.15.14.4" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.4.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">36</span></td>
<td id="S3.T2.15.14.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.5.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">31</span></td>
<td id="S3.T2.15.14.6" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.6.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">11</span></td>
<td id="S3.T2.15.14.7" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.7.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">9</span></td>
<td id="S3.T2.15.14.8" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.8.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">14</span></td>
<td id="S3.T2.15.14.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">8</span></td>
<td id="S3.T2.15.14.10" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.10.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">82</span></td>
<td id="S3.T2.15.14.11" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.11.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">79</span></td>
<td id="S3.T2.15.14.12" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.12.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">62</span></td>
<td id="S3.T2.15.14.13" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.13.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">63</span></td>
<td id="S3.T2.15.14.14" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.14.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">10</span></td>
<td id="S3.T2.15.14.15" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.15.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">7</span></td>
<td id="S3.T2.15.14.16" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.16.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">11</span></td>
<td id="S3.T2.15.14.17" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T2.15.14.17.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">8</span></td>
</tr>
</table>
</figure>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Communication rounds required to reach target average user accuracies (of non-noisy clients) for different tasks using FL and MTFL (with private statistics <math id="S3.T3.7.m1.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S3.T3.7.m1.2b"><mrow id="S3.T3.7.m1.2.3.2" xref="S3.T3.7.m1.2.3.1.cmml"><mi id="S3.T3.7.m1.1.1" xref="S3.T3.7.m1.1.1.cmml">μ</mi><mo id="S3.T3.7.m1.2.3.2.1" xref="S3.T3.7.m1.2.3.1.cmml">,</mo><mi id="S3.T3.7.m1.2.2" xref="S3.T3.7.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.7.m1.2c"><list id="S3.T3.7.m1.2.3.1.cmml" xref="S3.T3.7.m1.2.3.2"><ci id="S3.T3.7.m1.1.1.cmml" xref="S3.T3.7.m1.1.1">𝜇</ci><ci id="S3.T3.7.m1.2.2.cmml" xref="S3.T3.7.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.m1.2d">\mu,\sigma</annotation></semantics></math> and/or trained parameters <math id="S3.T3.8.m2.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S3.T3.8.m2.2b"><mrow id="S3.T3.8.m2.2.3.2" xref="S3.T3.8.m2.2.3.1.cmml"><mi id="S3.T3.8.m2.1.1" xref="S3.T3.8.m2.1.1.cmml">γ</mi><mo id="S3.T3.8.m2.2.3.2.1" xref="S3.T3.8.m2.2.3.1.cmml">,</mo><mi id="S3.T3.8.m2.2.2" xref="S3.T3.8.m2.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.8.m2.2c"><list id="S3.T3.8.m2.2.3.1.cmml" xref="S3.T3.8.m2.2.3.2"><ci id="S3.T3.8.m2.1.1.cmml" xref="S3.T3.8.m2.1.1">𝛾</ci><ci id="S3.T3.8.m2.2.2.cmml" xref="S3.T3.8.m2.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.m2.2d">\gamma,\beta</annotation></semantics></math>), when 20% of clients have noisy training data, for different numbers of total clients <math id="S3.T3.9.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.T3.9.m3.1b"><mi id="S3.T3.9.m3.1.1" xref="S3.T3.9.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.T3.9.m3.1c"><ci id="S3.T3.9.m3.1.1.cmml" xref="S3.T3.9.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.9.m3.1d">W</annotation></semantics></math>, client participation rates <math id="S3.T3.10.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.T3.10.m4.1b"><mi id="S3.T3.10.m4.1.1" xref="S3.T3.10.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.T3.10.m4.1c"><ci id="S3.T3.10.m4.1.1.cmml" xref="S3.T3.10.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.10.m4.1d">C</annotation></semantics></math>, and optimisation strategies. Cases unable to reach the target UA within 500 rounds are denoted by X. Best results for each scenario (combination of <math id="S3.T3.11.m5.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.T3.11.m5.1b"><mi id="S3.T3.11.m5.1.1" xref="S3.T3.11.m5.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.T3.11.m5.1c"><ci id="S3.T3.11.m5.1.1.cmml" xref="S3.T3.11.m5.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.11.m5.1d">W</annotation></semantics></math> and <math id="S3.T3.12.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.T3.12.m6.1b"><mi id="S3.T3.12.m6.1.1" xref="S3.T3.12.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.T3.12.m6.1c"><ci id="S3.T3.12.m6.1.1.cmml" xref="S3.T3.12.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.12.m6.1d">C</annotation></semantics></math>) given in bold.</figcaption>
<table id="S3.T3.15" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T3.15.4" class="ltx_tr">
<td id="S3.T3.15.4.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="17"><span id="S3.T3.15.4.1.1" class="ltx_text" style="font-size:90%;">MNIST - 2NN</span></td>
</tr>
<tr id="S3.T3.15.5" class="ltx_tr">
<td id="S3.T3.15.5.1" class="ltx_td ltx_border_t"></td>
<td id="S3.T3.15.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4"><span id="S3.T3.15.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">FL</span></td>
<td id="S3.T3.15.5.3" class="ltx_td ltx_align_center ltx_border_t" colspan="12"><span id="S3.T3.15.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">MTFL</span></td>
</tr>
<tr id="S3.T3.15.3" class="ltx_tr">
<td id="S3.T3.15.3.4" class="ltx_td"></td>
<td id="S3.T3.15.3.5" class="ltx_td ltx_align_center ltx_border_r" colspan="4"><span id="S3.T3.15.3.5.1" class="ltx_text" style="font-size:90%;">Private values = None</span></td>
<td id="S3.T3.13.1.1" class="ltx_td ltx_align_center ltx_border_r" colspan="4"><math id="S3.T3.13.1.1.m1.4" class="ltx_Math" alttext="\mu,\sigma,\gamma,\beta" display="inline"><semantics id="S3.T3.13.1.1.m1.4a"><mrow id="S3.T3.13.1.1.m1.4.5.2" xref="S3.T3.13.1.1.m1.4.5.1.cmml"><mi mathsize="90%" id="S3.T3.13.1.1.m1.1.1" xref="S3.T3.13.1.1.m1.1.1.cmml">μ</mi><mo mathsize="90%" id="S3.T3.13.1.1.m1.4.5.2.1" xref="S3.T3.13.1.1.m1.4.5.1.cmml">,</mo><mi mathsize="90%" id="S3.T3.13.1.1.m1.2.2" xref="S3.T3.13.1.1.m1.2.2.cmml">σ</mi><mo mathsize="90%" id="S3.T3.13.1.1.m1.4.5.2.2" xref="S3.T3.13.1.1.m1.4.5.1.cmml">,</mo><mi mathsize="90%" id="S3.T3.13.1.1.m1.3.3" xref="S3.T3.13.1.1.m1.3.3.cmml">γ</mi><mo mathsize="90%" id="S3.T3.13.1.1.m1.4.5.2.3" xref="S3.T3.13.1.1.m1.4.5.1.cmml">,</mo><mi mathsize="90%" id="S3.T3.13.1.1.m1.4.4" xref="S3.T3.13.1.1.m1.4.4.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.13.1.1.m1.4b"><list id="S3.T3.13.1.1.m1.4.5.1.cmml" xref="S3.T3.13.1.1.m1.4.5.2"><ci id="S3.T3.13.1.1.m1.1.1.cmml" xref="S3.T3.13.1.1.m1.1.1">𝜇</ci><ci id="S3.T3.13.1.1.m1.2.2.cmml" xref="S3.T3.13.1.1.m1.2.2">𝜎</ci><ci id="S3.T3.13.1.1.m1.3.3.cmml" xref="S3.T3.13.1.1.m1.3.3">𝛾</ci><ci id="S3.T3.13.1.1.m1.4.4.cmml" xref="S3.T3.13.1.1.m1.4.4">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.13.1.1.m1.4c">\mu,\sigma,\gamma,\beta</annotation></semantics></math></td>
<td id="S3.T3.14.2.2" class="ltx_td ltx_align_center ltx_border_r" colspan="4"><math id="S3.T3.14.2.2.m1.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S3.T3.14.2.2.m1.2a"><mrow id="S3.T3.14.2.2.m1.2.3.2" xref="S3.T3.14.2.2.m1.2.3.1.cmml"><mi mathsize="90%" id="S3.T3.14.2.2.m1.1.1" xref="S3.T3.14.2.2.m1.1.1.cmml">μ</mi><mo mathsize="90%" id="S3.T3.14.2.2.m1.2.3.2.1" xref="S3.T3.14.2.2.m1.2.3.1.cmml">,</mo><mi mathsize="90%" id="S3.T3.14.2.2.m1.2.2" xref="S3.T3.14.2.2.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.14.2.2.m1.2b"><list id="S3.T3.14.2.2.m1.2.3.1.cmml" xref="S3.T3.14.2.2.m1.2.3.2"><ci id="S3.T3.14.2.2.m1.1.1.cmml" xref="S3.T3.14.2.2.m1.1.1">𝜇</ci><ci id="S3.T3.14.2.2.m1.2.2.cmml" xref="S3.T3.14.2.2.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.14.2.2.m1.2c">\mu,\sigma</annotation></semantics></math></td>
<td id="S3.T3.15.3.3" class="ltx_td ltx_align_center" colspan="4"><math id="S3.T3.15.3.3.m1.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S3.T3.15.3.3.m1.2a"><mrow id="S3.T3.15.3.3.m1.2.3.2" xref="S3.T3.15.3.3.m1.2.3.1.cmml"><mi mathsize="90%" id="S3.T3.15.3.3.m1.1.1" xref="S3.T3.15.3.3.m1.1.1.cmml">γ</mi><mo mathsize="90%" id="S3.T3.15.3.3.m1.2.3.2.1" xref="S3.T3.15.3.3.m1.2.3.1.cmml">,</mo><mi mathsize="90%" id="S3.T3.15.3.3.m1.2.2" xref="S3.T3.15.3.3.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.15.3.3.m1.2b"><list id="S3.T3.15.3.3.m1.2.3.1.cmml" xref="S3.T3.15.3.3.m1.2.3.2"><ci id="S3.T3.15.3.3.m1.1.1.cmml" xref="S3.T3.15.3.3.m1.1.1">𝛾</ci><ci id="S3.T3.15.3.3.m1.2.2.cmml" xref="S3.T3.15.3.3.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.15.3.3.m1.2c">\gamma,\beta</annotation></semantics></math></td>
</tr>
<tr id="S3.T3.15.6" class="ltx_tr">
<td id="S3.T3.15.6.1" class="ltx_td ltx_align_center"><span id="S3.T3.15.6.1.1" class="ltx_text" style="font-size:90%;">Optimisation</span></td>
<td id="S3.T3.15.6.2" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T3.15.6.2.1" class="ltx_text" style="font-size:90%;">W = 200</span></td>
<td id="S3.T3.15.6.3" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T3.15.6.3.1" class="ltx_text" style="font-size:90%;">400</span></td>
<td id="S3.T3.15.6.4" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T3.15.6.4.1" class="ltx_text" style="font-size:90%;">200</span></td>
<td id="S3.T3.15.6.5" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T3.15.6.5.1" class="ltx_text" style="font-size:90%;">400</span></td>
<td id="S3.T3.15.6.6" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T3.15.6.6.1" class="ltx_text" style="font-size:90%;">200</span></td>
<td id="S3.T3.15.6.7" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T3.15.6.7.1" class="ltx_text" style="font-size:90%;">400</span></td>
<td id="S3.T3.15.6.8" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T3.15.6.8.1" class="ltx_text" style="font-size:90%;">200</span></td>
<td id="S3.T3.15.6.9" class="ltx_td ltx_align_center" colspan="2"><span id="S3.T3.15.6.9.1" class="ltx_text" style="font-size:90%;">400</span></td>
</tr>
<tr id="S3.T3.15.7" class="ltx_tr">
<td id="S3.T3.15.7.1" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.1.1" class="ltx_text" style="font-size:90%;">Strategy</span></td>
<td id="S3.T3.15.7.2" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.2.1" class="ltx_text" style="font-size:90%;">C = 0.5</span></td>
<td id="S3.T3.15.7.3" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.3.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T3.15.7.4" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.4.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T3.15.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T3.15.7.5.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T3.15.7.6" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.6.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T3.15.7.7" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.7.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T3.15.7.8" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.8.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T3.15.7.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T3.15.7.9.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T3.15.7.10" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.10.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T3.15.7.11" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.11.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T3.15.7.12" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.12.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T3.15.7.13" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T3.15.7.13.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T3.15.7.14" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.14.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T3.15.7.15" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.15.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
<td id="S3.T3.15.7.16" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.16.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T3.15.7.17" class="ltx_td ltx_align_center"><span id="S3.T3.15.7.17.1" class="ltx_text" style="font-size:90%;">1.0</span></td>
</tr>
<tr id="S3.T3.15.8" class="ltx_tr">
<td id="S3.T3.15.8.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.15.8.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S3.T3.15.8.2" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.2.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">276</span></td>
<td id="S3.T3.15.8.3" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.3.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">X</span></td>
<td id="S3.T3.15.8.4" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.4.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">290</span></td>
<td id="S3.T3.15.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.5.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">X</span></td>
<td id="S3.T3.15.8.6" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.6.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">115</span></td>
<td id="S3.T3.15.8.7" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.7.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">76</span></td>
<td id="S3.T3.15.8.8" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.8.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">144</span></td>
<td id="S3.T3.15.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.9.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">144</span></td>
<td id="S3.T3.15.8.10" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.10.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">85</span></td>
<td id="S3.T3.15.8.11" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.11.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">58</span></td>
<td id="S3.T3.15.8.12" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.12.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">102</span></td>
<td id="S3.T3.15.8.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.13.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">68</span></td>
<td id="S3.T3.15.8.14" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.14.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">50</span></td>
<td id="S3.T3.15.8.15" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.15.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">36</span></td>
<td id="S3.T3.15.8.16" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.16.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">65</span></td>
<td id="S3.T3.15.8.17" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.8.17.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">48</span></td>
</tr>
<tr id="S3.T3.15.9" class="ltx_tr">
<td id="S3.T3.15.9.1" class="ltx_td ltx_align_center"><span id="S3.T3.15.9.1.1" class="ltx_text" style="font-size:90%;">FedAdam</span></td>
<td id="S3.T3.15.9.2" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.2.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">X</span></td>
<td id="S3.T3.15.9.3" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.3.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">X</span></td>
<td id="S3.T3.15.9.4" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.4.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">X</span></td>
<td id="S3.T3.15.9.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T3.15.9.5.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">X</span></td>
<td id="S3.T3.15.9.6" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.6.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">76</span></td>
<td id="S3.T3.15.9.7" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.7.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">47</span></td>
<td id="S3.T3.15.9.8" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.8.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">110</span></td>
<td id="S3.T3.15.9.9" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T3.15.9.9.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">89</span></td>
<td id="S3.T3.15.9.10" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.10.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">56</span></td>
<td id="S3.T3.15.9.11" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.11.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">37</span></td>
<td id="S3.T3.15.9.12" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.12.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">75</span></td>
<td id="S3.T3.15.9.13" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T3.15.9.13.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">77</span></td>
<td id="S3.T3.15.9.14" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.14.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">43</span></td>
<td id="S3.T3.15.9.15" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.15.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">33</span></td>
<td id="S3.T3.15.9.16" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.16.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">46</span></td>
<td id="S3.T3.15.9.17" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.9.17.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">53</span></td>
</tr>
<tr id="S3.T3.15.10" class="ltx_tr">
<td id="S3.T3.15.10.1" class="ltx_td ltx_align_center"><span id="S3.T3.15.10.1.1" class="ltx_text" style="font-size:90%;">FedAvg-Adam</span></td>
<td id="S3.T3.15.10.2" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.2.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">133</span></td>
<td id="S3.T3.15.10.3" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.3.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">260</span></td>
<td id="S3.T3.15.10.4" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.4.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">191</span></td>
<td id="S3.T3.15.10.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.5.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">X</span></td>
<td id="S3.T3.15.10.6" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.6.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">20</span></td>
<td id="S3.T3.15.10.7" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.7.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">16</span></td>
<td id="S3.T3.15.10.8" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.8.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">24</span></td>
<td id="S3.T3.15.10.9" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.9.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">27</span></td>
<td id="S3.T3.15.10.10" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.10.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">17</span></td>
<td id="S3.T3.15.10.11" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.11.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">41</span></td>
<td id="S3.T3.15.10.12" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.12.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">19</span></td>
<td id="S3.T3.15.10.13" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.13.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">32</span></td>
<td id="S3.T3.15.10.14" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.14.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">12</span></td>
<td id="S3.T3.15.10.15" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.15.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">8</span></td>
<td id="S3.T3.15.10.16" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.16.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">15</span></td>
<td id="S3.T3.15.10.17" class="ltx_td ltx_align_center" style="background-color:#C6E0B4;"><span id="S3.T3.15.10.17.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">40</span></td>
</tr>
<tr id="S3.T3.15.11" class="ltx_tr">
<td id="S3.T3.15.11.1" class="ltx_td ltx_align_center ltx_border_t" colspan="17"><span id="S3.T3.15.11.1.1" class="ltx_text" style="font-size:90%;">CIFAR10 - CNN</span></td>
</tr>
<tr id="S3.T3.15.12" class="ltx_tr">
<td id="S3.T3.15.12.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.15.12.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S3.T3.15.12.2" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.2.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">148</span></td>
<td id="S3.T3.15.12.3" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.3.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">208</span></td>
<td id="S3.T3.15.12.4" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.4.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">202</span></td>
<td id="S3.T3.15.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.5.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">250</span></td>
<td id="S3.T3.15.12.6" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.6.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">47</span></td>
<td id="S3.T3.15.12.7" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.7.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">32</span></td>
<td id="S3.T3.15.12.8" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.8.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">52</span></td>
<td id="S3.T3.15.12.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.9.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">35</span></td>
<td id="S3.T3.15.12.10" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.10.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">239</span></td>
<td id="S3.T3.15.12.11" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.11.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">186</span></td>
<td id="S3.T3.15.12.12" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.12.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">260</span></td>
<td id="S3.T3.15.12.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.13.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">88</span></td>
<td id="S3.T3.15.12.14" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.14.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">36</span></td>
<td id="S3.T3.15.12.15" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.15.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">24</span></td>
<td id="S3.T3.15.12.16" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.16.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">43</span></td>
<td id="S3.T3.15.12.17" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#BDD7EE;"><span id="S3.T3.15.12.17.1" class="ltx_text" style="font-size:90%;background-color:#BDD7EE;">28</span></td>
</tr>
<tr id="S3.T3.15.13" class="ltx_tr">
<td id="S3.T3.15.13.1" class="ltx_td ltx_align_center"><span id="S3.T3.15.13.1.1" class="ltx_text" style="font-size:90%;">FedAdam</span></td>
<td id="S3.T3.15.13.2" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.2.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">159</span></td>
<td id="S3.T3.15.13.3" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.3.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">91</span></td>
<td id="S3.T3.15.13.4" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.4.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">92</span></td>
<td id="S3.T3.15.13.5" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T3.15.13.5.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">93</span></td>
<td id="S3.T3.15.13.6" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.6.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">21</span></td>
<td id="S3.T3.15.13.7" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.7.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">14</span></td>
<td id="S3.T3.15.13.8" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.8.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">21</span></td>
<td id="S3.T3.15.13.9" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T3.15.13.9.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">15</span></td>
<td id="S3.T3.15.13.10" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.10.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">74</span></td>
<td id="S3.T3.15.13.11" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.11.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">49</span></td>
<td id="S3.T3.15.13.12" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.12.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">51</span></td>
<td id="S3.T3.15.13.13" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#FFE699;"><span id="S3.T3.15.13.13.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">42</span></td>
<td id="S3.T3.15.13.14" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.14.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">34</span></td>
<td id="S3.T3.15.13.15" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.15.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">16</span></td>
<td id="S3.T3.15.13.16" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.16.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">21</span></td>
<td id="S3.T3.15.13.17" class="ltx_td ltx_align_center" style="background-color:#FFE699;"><span id="S3.T3.15.13.17.1" class="ltx_text" style="font-size:90%;background-color:#FFE699;">14</span></td>
</tr>
<tr id="S3.T3.15.14" class="ltx_tr">
<td id="S3.T3.15.14.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T3.15.14.1.1" class="ltx_text" style="font-size:90%;">FedAvg-Adam</span></td>
<td id="S3.T3.15.14.2" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.2.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">193</span></td>
<td id="S3.T3.15.14.3" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.3.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">X</span></td>
<td id="S3.T3.15.14.4" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.4.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">X</span></td>
<td id="S3.T3.15.14.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.5.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">X</span></td>
<td id="S3.T3.15.14.6" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.6.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">14</span></td>
<td id="S3.T3.15.14.7" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.7.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">10</span></td>
<td id="S3.T3.15.14.8" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.8.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">16</span></td>
<td id="S3.T3.15.14.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">9</span></td>
<td id="S3.T3.15.14.10" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.10.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">103</span></td>
<td id="S3.T3.15.14.11" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.11.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">111</span></td>
<td id="S3.T3.15.14.12" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.12.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">67</span></td>
<td id="S3.T3.15.14.13" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.13.1" class="ltx_text" style="font-size:90%;background-color:#C6E0B4;">74</span></td>
<td id="S3.T3.15.14.14" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.14.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">12</span></td>
<td id="S3.T3.15.14.15" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.15.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">8</span></td>
<td id="S3.T3.15.14.16" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.16.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">13</span></td>
<td id="S3.T3.15.14.17" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C6E0B4;"><span id="S3.T3.15.14.17.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#C6E0B4;">9</span></td>
</tr>
</table>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we first give details of the datasets, models and data partitioning scheme used for all the experiments. We then present extensive experiments analysing the impact that MTFL has on the number of rounds taken to reach a target UA. These experiments also examine which BN values, when kept private, give the best performance, and compare FL and MTFL with different optimisation strategies. After that, we investigate why different private BN values have different impacts on training, and compare MTFL to other state-of-the-art personalised FL algorithms. Finally, we evaluate the cost in terms of computation time of MTFL(FedAvg-Adam) on an MEC-like testbed.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span id="S4.SS1.1.1" class="ltx_text ltx_font_italic">Datasets and Models</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We conduct experiments using two image-classification datasets: MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and CIFAR10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, and two DNN architectures. 
<br class="ltx_break"></p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_italic">MNIST:</span> <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="(28\times 28)" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.1.m1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.cmml"><mn id="S4.SS1.p2.1.m1.1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.1.m1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.cmml">×</mo><mn id="S4.SS1.p2.1.m1.1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.1.3.cmml">28</mn></mrow><mo stretchy="false" id="S4.SS1.p2.1.m1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"><times id="S4.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1"></times><cn type="integer" id="S4.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.2">28</cn><cn type="integer" id="S4.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.3">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">(28\times 28)</annotation></semantics></math> pixel greyscale images of handwritten digits from 10 classes. The ‘2NN’ network used on this dataset had one Fully Connected (FC) layer of 200 neurons, a BN layer, a second 200-neuron FC layer, and a softmax output layer. 
<br class="ltx_break"></p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.5" class="ltx_p"><span id="S4.SS1.p3.5.1" class="ltx_text ltx_font_italic">CIFAR10:</span> <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="(32\times 32)" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.1.m1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml"><mn id="S4.SS1.p3.1.m1.1.1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.1.m1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.cmml">×</mo><mn id="S4.SS1.p3.1.m1.1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.3.cmml">32</mn></mrow><mo stretchy="false" id="S4.SS1.p3.1.m1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"><times id="S4.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1"></times><cn type="integer" id="S4.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2">32</cn><cn type="integer" id="S4.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">(32\times 32)</annotation></semantics></math> pixel RGB images of objects from 10 classes. The ‘CNN’ network used on this dataset had one <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="(3\times 3)" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.2.m2.1.1.1.2" xref="S4.SS1.p3.2.m2.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.2.m2.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.cmml"><mn id="S4.SS1.p3.2.m2.1.1.1.1.2" xref="S4.SS1.p3.2.m2.1.1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.2.m2.1.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml">×</mo><mn id="S4.SS1.p3.2.m2.1.1.1.1.3" xref="S4.SS1.p3.2.m2.1.1.1.1.3.cmml">3</mn></mrow><mo stretchy="false" id="S4.SS1.p3.2.m2.1.1.1.3" xref="S4.SS1.p3.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"><times id="S4.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1"></times><cn type="integer" id="S4.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.2">3</cn><cn type="integer" id="S4.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">(3\times 3)</annotation></semantics></math> convolutional (conv) layer with 32 filters followed by BN, ReLU and <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="(2\times 2)" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.3.m3.1.1.1.2" xref="S4.SS1.p3.3.m3.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.3.m3.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.cmml"><mn id="S4.SS1.p3.3.m3.1.1.1.1.2" xref="S4.SS1.p3.3.m3.1.1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.3.m3.1.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.1.cmml">×</mo><mn id="S4.SS1.p3.3.m3.1.1.1.1.3" xref="S4.SS1.p3.3.m3.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S4.SS1.p3.3.m3.1.1.1.3" xref="S4.SS1.p3.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1"><times id="S4.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1"></times><cn type="integer" id="S4.SS1.p3.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.2">2</cn><cn type="integer" id="S4.SS1.p3.3.m3.1.1.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">(2\times 2)</annotation></semantics></math> max pooling; a second <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="(3\times 3)" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.4.m4.1.1.1.2" xref="S4.SS1.p3.4.m4.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.4.m4.1.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.1.cmml"><mn id="S4.SS1.p3.4.m4.1.1.1.1.2" xref="S4.SS1.p3.4.m4.1.1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.4.m4.1.1.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.1.1.cmml">×</mo><mn id="S4.SS1.p3.4.m4.1.1.1.1.3" xref="S4.SS1.p3.4.m4.1.1.1.1.3.cmml">3</mn></mrow><mo stretchy="false" id="S4.SS1.p3.4.m4.1.1.1.3" xref="S4.SS1.p3.4.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1"><times id="S4.SS1.p3.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1.1.1"></times><cn type="integer" id="S4.SS1.p3.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.1.1.2">3</cn><cn type="integer" id="S4.SS1.p3.4.m4.1.1.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">(3\times 3)</annotation></semantics></math> conv ReLU layer with 64 filters, BN, ReLU and <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="(2\times 2)" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mrow id="S4.SS1.p3.5.m5.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.5.m5.1.1.1.2" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.5.m5.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml"><mn id="S4.SS1.p3.5.m5.1.1.1.1.2" xref="S4.SS1.p3.5.m5.1.1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.5.m5.1.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.cmml">×</mo><mn id="S4.SS1.p3.5.m5.1.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S4.SS1.p3.5.m5.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1"><times id="S4.SS1.p3.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1"></times><cn type="integer" id="S4.SS1.p3.5.m5.1.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.2">2</cn><cn type="integer" id="S4.SS1.p3.5.m5.1.1.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">(2\times 2)</annotation></semantics></math> max pooling; a 512 neuron ReLU FC layer; and a softmax output layer. 
<br class="ltx_break"></p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.3" class="ltx_p">Experiments were run with different numbers of clients <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">W</annotation></semantics></math>, client participation rates <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">C</annotation></semantics></math> and optimisation strategies, on non-IID clients. To produce non-IID client data, we take the popular approach from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>: order the training and testing data by label, split each into <math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="2W" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><mrow id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mn id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p4.3.m3.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.cmml">​</mo><mi id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><times id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1"></times><cn type="integer" id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">2</cn><ci id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">2W</annotation></semantics></math> shards, and assign each client two shards at random. Using the same assignment indexes for the testing data means that the classes in each client’s training set are the same as those in their test set. This splitting produces a strongly non-IID distribution across clients. All results are an average over 5 trials with different random seeds.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2007.09236/assets/mtfl-private-stats-params-graphs.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="145" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Average training (faint) and testing (solid) User Accuracy (UA) curves for every step of local SGD on the MNIST, <math id="S4.F4.5.m1.1" class="ltx_Math" alttext="W=200" display="inline"><semantics id="S4.F4.5.m1.1b"><mrow id="S4.F4.5.m1.1.1" xref="S4.F4.5.m1.1.1.cmml"><mi id="S4.F4.5.m1.1.1.2" xref="S4.F4.5.m1.1.1.2.cmml">W</mi><mo id="S4.F4.5.m1.1.1.1" xref="S4.F4.5.m1.1.1.1.cmml">=</mo><mn id="S4.F4.5.m1.1.1.3" xref="S4.F4.5.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.5.m1.1c"><apply id="S4.F4.5.m1.1.1.cmml" xref="S4.F4.5.m1.1.1"><eq id="S4.F4.5.m1.1.1.1.cmml" xref="S4.F4.5.m1.1.1.1"></eq><ci id="S4.F4.5.m1.1.1.2.cmml" xref="S4.F4.5.m1.1.1.2">𝑊</ci><cn type="integer" id="S4.F4.5.m1.1.1.3.cmml" xref="S4.F4.5.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.5.m1.1d">W=200</annotation></semantics></math>, <math id="S4.F4.6.m2.1" class="ltx_Math" alttext="C=1.0" display="inline"><semantics id="S4.F4.6.m2.1b"><mrow id="S4.F4.6.m2.1.1" xref="S4.F4.6.m2.1.1.cmml"><mi id="S4.F4.6.m2.1.1.2" xref="S4.F4.6.m2.1.1.2.cmml">C</mi><mo id="S4.F4.6.m2.1.1.1" xref="S4.F4.6.m2.1.1.1.cmml">=</mo><mn id="S4.F4.6.m2.1.1.3" xref="S4.F4.6.m2.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.6.m2.1c"><apply id="S4.F4.6.m2.1.1.cmml" xref="S4.F4.6.m2.1.1"><eq id="S4.F4.6.m2.1.1.1.cmml" xref="S4.F4.6.m2.1.1.1"></eq><ci id="S4.F4.6.m2.1.1.2.cmml" xref="S4.F4.6.m2.1.1.2">𝐶</ci><cn type="float" id="S4.F4.6.m2.1.1.3.cmml" xref="S4.F4.6.m2.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.6.m2.1d">C=1.0</annotation></semantics></math> scenario, using FL(FedAvg) (red), and MTFL(FedAvg) (blue). Each plot compares keeping different values within the BN layers of MTFL private: either statistics (<math id="S4.F4.7.m3.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S4.F4.7.m3.2b"><mrow id="S4.F4.7.m3.2.3.2" xref="S4.F4.7.m3.2.3.1.cmml"><mi id="S4.F4.7.m3.1.1" xref="S4.F4.7.m3.1.1.cmml">μ</mi><mo id="S4.F4.7.m3.2.3.2.1" xref="S4.F4.7.m3.2.3.1.cmml">,</mo><mi id="S4.F4.7.m3.2.2" xref="S4.F4.7.m3.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.7.m3.2c"><list id="S4.F4.7.m3.2.3.1.cmml" xref="S4.F4.7.m3.2.3.2"><ci id="S4.F4.7.m3.1.1.cmml" xref="S4.F4.7.m3.1.1">𝜇</ci><ci id="S4.F4.7.m3.2.2.cmml" xref="S4.F4.7.m3.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.7.m3.2d">\mu,\sigma</annotation></semantics></math>) and/or trainable parameters (<math id="S4.F4.8.m4.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.F4.8.m4.2b"><mrow id="S4.F4.8.m4.2.3.2" xref="S4.F4.8.m4.2.3.1.cmml"><mi id="S4.F4.8.m4.1.1" xref="S4.F4.8.m4.1.1.cmml">γ</mi><mo id="S4.F4.8.m4.2.3.2.1" xref="S4.F4.8.m4.2.3.1.cmml">,</mo><mi id="S4.F4.8.m4.2.2" xref="S4.F4.8.m4.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.8.m4.2c"><list id="S4.F4.8.m4.2.3.1.cmml" xref="S4.F4.8.m4.2.3.2"><ci id="S4.F4.8.m4.1.1.cmml" xref="S4.F4.8.m4.1.1">𝛾</ci><ci id="S4.F4.8.m4.2.2.cmml" xref="S4.F4.8.m4.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.8.m4.2d">\gamma,\beta</annotation></semantics></math>), to FL. All curves have been smoothed with an averaging kernel for presentation, except the inset of plot (b), which shows the cyclic drops in accuracy due to model averaging characteristic of FL.</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span id="S4.SS2.1.1" class="ltx_text ltx_font_italic">Patch Layers in FL</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p"><span id="S4.SS2.p1.2.1" class="ltx_text ltx_font_bold">Setup -</span> First, we compare how many rounds are needed to reach a target average UA (97% for MNIST, 65% for CIFAR10) for MTFL and FL. In FL, no model parameters are kept private (i.e. there are no patches), whereas in MTFL, some model parameters are kept private. For the MTFL columns in Tables 2 and 3, we present the effects of keeping BN-layer statistics (<math id="S4.SS2.p1.1.m1.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.3.2" xref="S4.SS2.p1.1.m1.2.3.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">μ</mi><mo id="S4.SS2.p1.1.m1.2.3.2.1" xref="S4.SS2.p1.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS2.p1.1.m1.2.2" xref="S4.SS2.p1.1.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><list id="S4.SS2.p1.1.m1.2.3.1.cmml" xref="S4.SS2.p1.1.m1.2.3.2"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝜇</ci><ci id="S4.SS2.p1.1.m1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">\mu,\sigma</annotation></semantics></math>) and/or trainable parameters (<math id="S4.SS2.p1.2.m2.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.SS2.p1.2.m2.2a"><mrow id="S4.SS2.p1.2.m2.2.3.2" xref="S4.SS2.p1.2.m2.2.3.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">γ</mi><mo id="S4.SS2.p1.2.m2.2.3.2.1" xref="S4.SS2.p1.2.m2.2.3.1.cmml">,</mo><mi id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.2b"><list id="S4.SS2.p1.2.m2.2.3.1.cmml" xref="S4.SS2.p1.2.m2.2.3.2"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝛾</ci><ci id="S4.SS2.p1.2.m2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.2c">\gamma,\beta</annotation></semantics></math>) private, as part of the patch layers.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">For these results, we fixed number of local epochs <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">E</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">E=1</annotation></semantics></math> and tuned the learning-rate hyperparameters for every scenario such that the target was reached in the fewest rounds. For FedAvg and FedAvg-Adam, we had to tune only one hyperparameter for each scenario, but FedAdam required training both client and server learning rate. Entries with ‘X’ in Tables 2 and 3 denote cases that could not reach the target within 500 communication rounds.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">In Table 3, we also investigate the robustness of MTFL to clients with noisy training data. Here, 20% of the clients at random had 0-mean Gaussian noise added to their training data. The average UA taken for Table 3 was for the non-noisy clients only, to test how MTFL helps to mitigate the effect of noisy clients on non-noisy clients. We used Gaussian noise with standard deviation 3 for MNIST and 0.2 for CIFAR10 (MNIST is a much simpler image classification task than CIFAR10, so required more noise to significantly hinder training). 
<br class="ltx_break"></p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.7" class="ltx_p"><span id="S4.SS2.p4.7.1" class="ltx_text ltx_font_bold">Results -</span> Table 2 shows that for MTFL, when all BN-layer values (<math id="S4.SS2.p4.1.m1.4" class="ltx_Math" alttext="\mu,\sigma,\gamma,\beta" display="inline"><semantics id="S4.SS2.p4.1.m1.4a"><mrow id="S4.SS2.p4.1.m1.4.5.2" xref="S4.SS2.p4.1.m1.4.5.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">μ</mi><mo id="S4.SS2.p4.1.m1.4.5.2.1" xref="S4.SS2.p4.1.m1.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.1.m1.2.2" xref="S4.SS2.p4.1.m1.2.2.cmml">σ</mi><mo id="S4.SS2.p4.1.m1.4.5.2.2" xref="S4.SS2.p4.1.m1.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.1.m1.3.3" xref="S4.SS2.p4.1.m1.3.3.cmml">γ</mi><mo id="S4.SS2.p4.1.m1.4.5.2.3" xref="S4.SS2.p4.1.m1.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.1.m1.4.4" xref="S4.SS2.p4.1.m1.4.4.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.4b"><list id="S4.SS2.p4.1.m1.4.5.1.cmml" xref="S4.SS2.p4.1.m1.4.5.2"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝜇</ci><ci id="S4.SS2.p4.1.m1.2.2.cmml" xref="S4.SS2.p4.1.m1.2.2">𝜎</ci><ci id="S4.SS2.p4.1.m1.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3">𝛾</ci><ci id="S4.SS2.p4.1.m1.4.4.cmml" xref="S4.SS2.p4.1.m1.4.4">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.4c">\mu,\sigma,\gamma,\beta</annotation></semantics></math>) are kept private, the number of rounds to reach a target average UA is substantially lower in almost all scenarios when compared to FL. For example for the CIFAR10 <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="W=400" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">W</mi><mo id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><eq id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1"></eq><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝑊</ci><cn type="integer" id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">W=400</annotation></semantics></math>, <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="C=1.0" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">C</mi><mo id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><eq id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1"></eq><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">𝐶</ci><cn type="float" id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">C=1.0</annotation></semantics></math> scenario, FL(FedAvg) took 164 rounds to reach the target average UA, whereas MTFL(FedAvg) with private (<math id="S4.SS2.p4.4.m4.4" class="ltx_Math" alttext="\mu,\sigma,\gamma,\beta" display="inline"><semantics id="S4.SS2.p4.4.m4.4a"><mrow id="S4.SS2.p4.4.m4.4.5.2" xref="S4.SS2.p4.4.m4.4.5.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml">μ</mi><mo id="S4.SS2.p4.4.m4.4.5.2.1" xref="S4.SS2.p4.4.m4.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.4.m4.2.2" xref="S4.SS2.p4.4.m4.2.2.cmml">σ</mi><mo id="S4.SS2.p4.4.m4.4.5.2.2" xref="S4.SS2.p4.4.m4.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.4.m4.3.3" xref="S4.SS2.p4.4.m4.3.3.cmml">γ</mi><mo id="S4.SS2.p4.4.m4.4.5.2.3" xref="S4.SS2.p4.4.m4.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.4.m4.4.4" xref="S4.SS2.p4.4.m4.4.4.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.4b"><list id="S4.SS2.p4.4.m4.4.5.1.cmml" xref="S4.SS2.p4.4.m4.4.5.2"><ci id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">𝜇</ci><ci id="S4.SS2.p4.4.m4.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2">𝜎</ci><ci id="S4.SS2.p4.4.m4.3.3.cmml" xref="S4.SS2.p4.4.m4.3.3">𝛾</ci><ci id="S4.SS2.p4.4.m4.4.4.cmml" xref="S4.SS2.p4.4.m4.4.4">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.4c">\mu,\sigma,\gamma,\beta</annotation></semantics></math>) took only 36 rounds. However, Tables 2 and 3 show that when keeping only the tracked statistics of BN patches private, UA is actually harmed. Conversely, MTFL with only private trainable parameters took even fewer rounds than MTFL will all-private (<math id="S4.SS2.p4.5.m5.4" class="ltx_Math" alttext="\mu,\sigma,\gamma,\beta" display="inline"><semantics id="S4.SS2.p4.5.m5.4a"><mrow id="S4.SS2.p4.5.m5.4.5.2" xref="S4.SS2.p4.5.m5.4.5.1.cmml"><mi id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml">μ</mi><mo id="S4.SS2.p4.5.m5.4.5.2.1" xref="S4.SS2.p4.5.m5.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.5.m5.2.2" xref="S4.SS2.p4.5.m5.2.2.cmml">σ</mi><mo id="S4.SS2.p4.5.m5.4.5.2.2" xref="S4.SS2.p4.5.m5.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.5.m5.3.3" xref="S4.SS2.p4.5.m5.3.3.cmml">γ</mi><mo id="S4.SS2.p4.5.m5.4.5.2.3" xref="S4.SS2.p4.5.m5.4.5.1.cmml">,</mo><mi id="S4.SS2.p4.5.m5.4.4" xref="S4.SS2.p4.5.m5.4.4.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.4b"><list id="S4.SS2.p4.5.m5.4.5.1.cmml" xref="S4.SS2.p4.5.m5.4.5.2"><ci id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">𝜇</ci><ci id="S4.SS2.p4.5.m5.2.2.cmml" xref="S4.SS2.p4.5.m5.2.2">𝜎</ci><ci id="S4.SS2.p4.5.m5.3.3.cmml" xref="S4.SS2.p4.5.m5.3.3">𝛾</ci><ci id="S4.SS2.p4.5.m5.4.4.cmml" xref="S4.SS2.p4.5.m5.4.4">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.4c">\mu,\sigma,\gamma,\beta</annotation></semantics></math>). For the same scenario, MTFL(FedAvg) with private (<math id="S4.SS2.p4.6.m6.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S4.SS2.p4.6.m6.2a"><mrow id="S4.SS2.p4.6.m6.2.3.2" xref="S4.SS2.p4.6.m6.2.3.1.cmml"><mi id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">μ</mi><mo id="S4.SS2.p4.6.m6.2.3.2.1" xref="S4.SS2.p4.6.m6.2.3.1.cmml">,</mo><mi id="S4.SS2.p4.6.m6.2.2" xref="S4.SS2.p4.6.m6.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.2b"><list id="S4.SS2.p4.6.m6.2.3.1.cmml" xref="S4.SS2.p4.6.m6.2.3.2"><ci id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">𝜇</ci><ci id="S4.SS2.p4.6.m6.2.2.cmml" xref="S4.SS2.p4.6.m6.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.2c">\mu,\sigma</annotation></semantics></math>) took 266 rounds, whereas MTFL(FedAvg) with private (<math id="S4.SS2.p4.7.m7.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.SS2.p4.7.m7.2a"><mrow id="S4.SS2.p4.7.m7.2.3.2" xref="S4.SS2.p4.7.m7.2.3.1.cmml"><mi id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml">γ</mi><mo id="S4.SS2.p4.7.m7.2.3.2.1" xref="S4.SS2.p4.7.m7.2.3.1.cmml">,</mo><mi id="S4.SS2.p4.7.m7.2.2" xref="S4.SS2.p4.7.m7.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.2b"><list id="S4.SS2.p4.7.m7.2.3.1.cmml" xref="S4.SS2.p4.7.m7.2.3.2"><ci id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">𝛾</ci><ci id="S4.SS2.p4.7.m7.2.2.cmml" xref="S4.SS2.p4.7.m7.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.2c">\gamma,\beta</annotation></semantics></math>) took just 30 rounds. We investigate the reason behind these differences further in Section 4.3.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p"><span id="S4.SS2.p5.1.1" class="ltx_text" style="color:#000000;">MTFL naturally increases the variance of UAs during training, as non-identical user models in MTFL would contribute to the variance of UAs. However, in the experiments we performed, the difference between the variance of UA for FL and MTFL is very small: at less than 1%.</span></p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.2" class="ltx_p">Table 3 shows that MTFL also helped to mitigate the impact of noisy clients on non-noisy clients. With FL, noisy clients prevented the average non-noisy UA from reaching the target in many scenarios. However, in most cases, MTFL allowed the non-noisy clients to reach the target average UA in a similar number of rounds than the corresponding non-noisy scenarios in Table 2. For example, for the CIFAR10 <math id="S4.SS2.p6.1.m1.2" class="ltx_Math" alttext="W=400,C=1.0" display="inline"><semantics id="S4.SS2.p6.1.m1.2a"><mrow id="S4.SS2.p6.1.m1.2.2.2" xref="S4.SS2.p6.1.m1.2.2.3.cmml"><mrow id="S4.SS2.p6.1.m1.1.1.1.1" xref="S4.SS2.p6.1.m1.1.1.1.1.cmml"><mi id="S4.SS2.p6.1.m1.1.1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.1.1.2.cmml">W</mi><mo id="S4.SS2.p6.1.m1.1.1.1.1.1" xref="S4.SS2.p6.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.p6.1.m1.1.1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.1.1.3.cmml">400</mn></mrow><mo id="S4.SS2.p6.1.m1.2.2.2.3" xref="S4.SS2.p6.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p6.1.m1.2.2.2.2" xref="S4.SS2.p6.1.m1.2.2.2.2.cmml"><mi id="S4.SS2.p6.1.m1.2.2.2.2.2" xref="S4.SS2.p6.1.m1.2.2.2.2.2.cmml">C</mi><mo id="S4.SS2.p6.1.m1.2.2.2.2.1" xref="S4.SS2.p6.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.SS2.p6.1.m1.2.2.2.2.3" xref="S4.SS2.p6.1.m1.2.2.2.2.3.cmml">1.0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.2b"><apply id="S4.SS2.p6.1.m1.2.2.3.cmml" xref="S4.SS2.p6.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.2.2.3a.cmml" xref="S4.SS2.p6.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p6.1.m1.1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1.1.1"><eq id="S4.SS2.p6.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1.1.1.1"></eq><ci id="S4.SS2.p6.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.1.1.2">𝑊</ci><cn type="integer" id="S4.SS2.p6.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.1.1.3">400</cn></apply><apply id="S4.SS2.p6.1.m1.2.2.2.2.cmml" xref="S4.SS2.p6.1.m1.2.2.2.2"><eq id="S4.SS2.p6.1.m1.2.2.2.2.1.cmml" xref="S4.SS2.p6.1.m1.2.2.2.2.1"></eq><ci id="S4.SS2.p6.1.m1.2.2.2.2.2.cmml" xref="S4.SS2.p6.1.m1.2.2.2.2.2">𝐶</ci><cn type="float" id="S4.SS2.p6.1.m1.2.2.2.2.3.cmml" xref="S4.SS2.p6.1.m1.2.2.2.2.3">1.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.2c">W=400,C=1.0</annotation></semantics></math> scenario, FL(FedAvg) took 250 rounds to reach the target, however MTFL(FedAvg) with private (<math id="S4.SS2.p6.2.m2.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.SS2.p6.2.m2.2a"><mrow id="S4.SS2.p6.2.m2.2.3.2" xref="S4.SS2.p6.2.m2.2.3.1.cmml"><mi id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml">γ</mi><mo id="S4.SS2.p6.2.m2.2.3.2.1" xref="S4.SS2.p6.2.m2.2.3.1.cmml">,</mo><mi id="S4.SS2.p6.2.m2.2.2" xref="S4.SS2.p6.2.m2.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.2b"><list id="S4.SS2.p6.2.m2.2.3.1.cmml" xref="S4.SS2.p6.2.m2.2.3.2"><ci id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">𝛾</ci><ci id="S4.SS2.p6.2.m2.2.2.cmml" xref="S4.SS2.p6.2.m2.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.2c">\gamma,\beta</annotation></semantics></math>) parameters, took just 28 rounds.</p>
</div>
<div id="S4.SS2.p7" class="ltx_para">
<p id="S4.SS2.p7.1" class="ltx_p"><span id="S4.SS2.p7.1.1" class="ltx_text" style="color:#000000;">As Table 3 displays the rounds required for the non-noisy clients to reach the target average UA, the improvements shown when using MTFL may be due to the non-noisy clients being more ‘decoupled’ from the noisy ones. As they do not share all model parameters, the harmful effect of receiving a global model that has been harmed by the participation of noisy clients has been reduced, allowing them to reach higher accuracies, faster.</span></p>
</div>
<div id="S4.SS2.p8" class="ltx_para">
<p id="S4.SS2.p8.1" class="ltx_p">Tables 2 and 3 also show that in most scenarios, the FedAvg-Adam optimisation strategy reached the target average UA in the fewest rounds, regardless of whether FL or MTFL is used. Taking the same CIFAR10 scenario in Table 2, FL(FedAvg) took 164 rounds, FL(FedAdam) 80 rounds, and FL(FedAvg-Adam) only 31 rounds to reach the target. Similarly, MTFL(FedAvg) took 36 rounds, MTFL(FedAdam) 16 rounds and MTFL(FedAvg-Adam) just 8 rounds with private (<math id="S4.SS2.p8.1.m1.4" class="ltx_Math" alttext="\mu,\sigma,\gamma,\beta" display="inline"><semantics id="S4.SS2.p8.1.m1.4a"><mrow id="S4.SS2.p8.1.m1.4.5.2" xref="S4.SS2.p8.1.m1.4.5.1.cmml"><mi id="S4.SS2.p8.1.m1.1.1" xref="S4.SS2.p8.1.m1.1.1.cmml">μ</mi><mo id="S4.SS2.p8.1.m1.4.5.2.1" xref="S4.SS2.p8.1.m1.4.5.1.cmml">,</mo><mi id="S4.SS2.p8.1.m1.2.2" xref="S4.SS2.p8.1.m1.2.2.cmml">σ</mi><mo id="S4.SS2.p8.1.m1.4.5.2.2" xref="S4.SS2.p8.1.m1.4.5.1.cmml">,</mo><mi id="S4.SS2.p8.1.m1.3.3" xref="S4.SS2.p8.1.m1.3.3.cmml">γ</mi><mo id="S4.SS2.p8.1.m1.4.5.2.3" xref="S4.SS2.p8.1.m1.4.5.1.cmml">,</mo><mi id="S4.SS2.p8.1.m1.4.4" xref="S4.SS2.p8.1.m1.4.4.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.1.m1.4b"><list id="S4.SS2.p8.1.m1.4.5.1.cmml" xref="S4.SS2.p8.1.m1.4.5.2"><ci id="S4.SS2.p8.1.m1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1">𝜇</ci><ci id="S4.SS2.p8.1.m1.2.2.cmml" xref="S4.SS2.p8.1.m1.2.2">𝜎</ci><ci id="S4.SS2.p8.1.m1.3.3.cmml" xref="S4.SS2.p8.1.m1.3.3">𝛾</ci><ci id="S4.SS2.p8.1.m1.4.4.cmml" xref="S4.SS2.p8.1.m1.4.4">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.1.m1.4c">\mu,\sigma,\gamma,\beta</annotation></semantics></math>).</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2007.09236/assets/personalised-fl-algs-comparison.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="206" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Per-round testing User Accuracy (UA) of four FL algorithms: FL(FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, MTFL(FedAvg) (using private <math id="S4.F5.6.m1.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.F5.6.m1.2b"><mrow id="S4.F5.6.m1.2.3.2" xref="S4.F5.6.m1.2.3.1.cmml"><mi id="S4.F5.6.m1.1.1" xref="S4.F5.6.m1.1.1.cmml">γ</mi><mo id="S4.F5.6.m1.2.3.2.1" xref="S4.F5.6.m1.2.3.1.cmml">,</mo><mi id="S4.F5.6.m1.2.2" xref="S4.F5.6.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.6.m1.2c"><list id="S4.F5.6.m1.2.3.1.cmml" xref="S4.F5.6.m1.2.3.2"><ci id="S4.F5.6.m1.1.1.cmml" xref="S4.F5.6.m1.1.1">𝛾</ci><ci id="S4.F5.6.m1.2.2.cmml" xref="S4.F5.6.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.m1.2d">\gamma,\beta</annotation></semantics></math>), pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. Experiments are conducted on MNIST and CIFAR10, with data divided in a non-IID fashion between <math id="S4.F5.7.m2.1" class="ltx_Math" alttext="W=200" display="inline"><semantics id="S4.F5.7.m2.1b"><mrow id="S4.F5.7.m2.1.1" xref="S4.F5.7.m2.1.1.cmml"><mi id="S4.F5.7.m2.1.1.2" xref="S4.F5.7.m2.1.1.2.cmml">W</mi><mo id="S4.F5.7.m2.1.1.1" xref="S4.F5.7.m2.1.1.1.cmml">=</mo><mn id="S4.F5.7.m2.1.1.3" xref="S4.F5.7.m2.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.7.m2.1c"><apply id="S4.F5.7.m2.1.1.cmml" xref="S4.F5.7.m2.1.1"><eq id="S4.F5.7.m2.1.1.1.cmml" xref="S4.F5.7.m2.1.1.1"></eq><ci id="S4.F5.7.m2.1.1.2.cmml" xref="S4.F5.7.m2.1.1.2">𝑊</ci><cn type="integer" id="S4.F5.7.m2.1.1.3.cmml" xref="S4.F5.7.m2.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.7.m2.1d">W=200</annotation></semantics></math> or <math id="S4.F5.8.m3.1" class="ltx_Math" alttext="400" display="inline"><semantics id="S4.F5.8.m3.1b"><mn id="S4.F5.8.m3.1.1" xref="S4.F5.8.m3.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="S4.F5.8.m3.1c"><cn type="integer" id="S4.F5.8.m3.1.1.cmml" xref="S4.F5.8.m3.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.8.m3.1d">400</annotation></semantics></math> clients, and <math id="S4.F5.9.m4.1" class="ltx_Math" alttext="C=0.5" display="inline"><semantics id="S4.F5.9.m4.1b"><mrow id="S4.F5.9.m4.1.1" xref="S4.F5.9.m4.1.1.cmml"><mi id="S4.F5.9.m4.1.1.2" xref="S4.F5.9.m4.1.1.2.cmml">C</mi><mo id="S4.F5.9.m4.1.1.1" xref="S4.F5.9.m4.1.1.1.cmml">=</mo><mn id="S4.F5.9.m4.1.1.3" xref="S4.F5.9.m4.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.9.m4.1c"><apply id="S4.F5.9.m4.1.1.cmml" xref="S4.F5.9.m4.1.1"><eq id="S4.F5.9.m4.1.1.1.cmml" xref="S4.F5.9.m4.1.1.1"></eq><ci id="S4.F5.9.m4.1.1.2.cmml" xref="S4.F5.9.m4.1.1.2">𝐶</ci><cn type="float" id="S4.F5.9.m4.1.1.3.cmml" xref="S4.F5.9.m4.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.9.m4.1d">C=0.5</annotation></semantics></math> or <math id="S4.F5.10.m5.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S4.F5.10.m5.1b"><mn id="S4.F5.10.m5.1.1" xref="S4.F5.10.m5.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S4.F5.10.m5.1c"><cn type="float" id="S4.F5.10.m5.1.1.cmml" xref="S4.F5.10.m5.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.10.m5.1d">1.0</annotation></semantics></math> fraction of users participating per round. Shaded regions show 95% confidence intervals per round over 5 trials with different random seeds.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span id="S4.SS3.1.1" class="ltx_text ltx_font_italic">Training and Testing Results Using MTFL</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.5" class="ltx_p"><span id="S4.SS3.p1.5.1" class="ltx_text ltx_font_bold">Setup -</span> To investigate why MTFL with BN patches using private (<math id="S4.SS3.p1.1.m1.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S4.SS3.p1.1.m1.2a"><mrow id="S4.SS3.p1.1.m1.2.3.2" xref="S4.SS3.p1.1.m1.2.3.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">μ</mi><mo id="S4.SS3.p1.1.m1.2.3.2.1" xref="S4.SS3.p1.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS3.p1.1.m1.2.2" xref="S4.SS3.p1.1.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.2b"><list id="S4.SS3.p1.1.m1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.2.3.2"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝜇</ci><ci id="S4.SS3.p1.1.m1.2.2.cmml" xref="S4.SS3.p1.1.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.2c">\mu,\sigma</annotation></semantics></math>) and/or private (<math id="S4.SS3.p1.2.m2.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.SS3.p1.2.m2.2a"><mrow id="S4.SS3.p1.2.m2.2.3.2" xref="S4.SS3.p1.2.m2.2.3.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">γ</mi><mo id="S4.SS3.p1.2.m2.2.3.2.1" xref="S4.SS3.p1.2.m2.2.3.1.cmml">,</mo><mi id="S4.SS3.p1.2.m2.2.2" xref="S4.SS3.p1.2.m2.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.2b"><list id="S4.SS3.p1.2.m2.2.3.1.cmml" xref="S4.SS3.p1.2.m2.2.3.2"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝛾</ci><ci id="S4.SS3.p1.2.m2.2.2.cmml" xref="S4.SS3.p1.2.m2.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.2c">\gamma,\beta</annotation></semantics></math>) give such different results (as shown in Tables 2 and 3), we plotted training and testing UA during one scenario from Table 2: namely MNIST with <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="W=200" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">W</mi><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><eq id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></eq><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">𝑊</ci><cn type="integer" id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">W=200</annotation></semantics></math>, <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="C=1.0" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">C</mi><mo id="S4.SS3.p1.4.m4.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><eq id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1"></eq><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝐶</ci><cn type="float" id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">C=1.0</annotation></semantics></math> for FL(FedAvg) and MTFL(FedAvg). We ran the algorithms for 600 communication rounds, where clients performed 10 steps of local training each round, and calculated the average training and testing UA for every local step. These graphs therefore present <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="600\times 10=6000" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mrow id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mrow id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml"><mn id="S4.SS3.p1.5.m5.1.1.2.2" xref="S4.SS3.p1.5.m5.1.1.2.2.cmml">600</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.5.m5.1.1.2.1" xref="S4.SS3.p1.5.m5.1.1.2.1.cmml">×</mo><mn id="S4.SS3.p1.5.m5.1.1.2.3" xref="S4.SS3.p1.5.m5.1.1.2.3.cmml">10</mn></mrow><mo id="S4.SS3.p1.5.m5.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">6000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><eq id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1"></eq><apply id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2"><times id="S4.SS3.p1.5.m5.1.1.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1.2.1"></times><cn type="integer" id="S4.SS3.p1.5.m5.1.1.2.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2.2">600</cn><cn type="integer" id="S4.SS3.p1.5.m5.1.1.2.3.cmml" xref="S4.SS3.p1.5.m5.1.1.2.3">10</cn></apply><cn type="integer" id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">6000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">600\times 10=6000</annotation></semantics></math> total steps. Measuring in this way allowed us to present the train/test accuracy trade-off, the impact that averaging has during training, and the effect on training and testing with different private BN values. 
<br class="ltx_break"></p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.7" class="ltx_p"><span id="S4.SS3.p2.7.1" class="ltx_text ltx_font_bold">Results -</span> Fig. 4 shows the (smoothed) training and testing UAs of the different combinations of BN layer statistics/parameters for the MNIST problem. Note that because the lines are smoothed for presentation, the steps where the curves reach the target accuracies may not correspond to the values in Table 2. In Fig. 4 (a), the training curves for FL(FedAvg) and MTFL(FedAvg) with private (<math id="S4.SS3.p2.1.m1.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S4.SS3.p2.1.m1.2a"><mrow id="S4.SS3.p2.1.m1.2.3.2" xref="S4.SS3.p2.1.m1.2.3.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">μ</mi><mo id="S4.SS3.p2.1.m1.2.3.2.1" xref="S4.SS3.p2.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS3.p2.1.m1.2.2" xref="S4.SS3.p2.1.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.2b"><list id="S4.SS3.p2.1.m1.2.3.1.cmml" xref="S4.SS3.p2.1.m1.2.3.2"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝜇</ci><ci id="S4.SS3.p2.1.m1.2.2.cmml" xref="S4.SS3.p2.1.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.2c">\mu,\sigma</annotation></semantics></math>) are the same: this is because the BN statistics are only used at test-time and do not influence training. The test accuracy for private (<math id="S4.SS3.p2.2.m2.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S4.SS3.p2.2.m2.2a"><mrow id="S4.SS3.p2.2.m2.2.3.2" xref="S4.SS3.p2.2.m2.2.3.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">μ</mi><mo id="S4.SS3.p2.2.m2.2.3.2.1" xref="S4.SS3.p2.2.m2.2.3.1.cmml">,</mo><mi id="S4.SS3.p2.2.m2.2.2" xref="S4.SS3.p2.2.m2.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.2b"><list id="S4.SS3.p2.2.m2.2.3.1.cmml" xref="S4.SS3.p2.2.m2.2.3.2"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝜇</ci><ci id="S4.SS3.p2.2.m2.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.2c">\mu,\sigma</annotation></semantics></math>) is lower than FedAvg, mirroring the results in Tables 2 and 3. The lower test accuracy may be due to mismatch in BN values: <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">\gamma</annotation></semantics></math> and <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">\beta</annotation></semantics></math> have been averaged, so output a different distribution than these private statistics have been tracking, thus harming the ability of the model. This seems to be supported by Fig. 4 (c). When keeping both private (<math id="S4.SS3.p2.5.m5.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S4.SS3.p2.5.m5.2a"><mrow id="S4.SS3.p2.5.m5.2.3.2" xref="S4.SS3.p2.5.m5.2.3.1.cmml"><mi id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">μ</mi><mo id="S4.SS3.p2.5.m5.2.3.2.1" xref="S4.SS3.p2.5.m5.2.3.1.cmml">,</mo><mi id="S4.SS3.p2.5.m5.2.2" xref="S4.SS3.p2.5.m5.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.2b"><list id="S4.SS3.p2.5.m5.2.3.1.cmml" xref="S4.SS3.p2.5.m5.2.3.2"><ci id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">𝜇</ci><ci id="S4.SS3.p2.5.m5.2.2.cmml" xref="S4.SS3.p2.5.m5.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.2c">\mu,\sigma</annotation></semantics></math>) and (<math id="S4.SS3.p2.6.m6.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.SS3.p2.6.m6.2a"><mrow id="S4.SS3.p2.6.m6.2.3.2" xref="S4.SS3.p2.6.m6.2.3.1.cmml"><mi id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml">γ</mi><mo id="S4.SS3.p2.6.m6.2.3.2.1" xref="S4.SS3.p2.6.m6.2.3.1.cmml">,</mo><mi id="S4.SS3.p2.6.m6.2.2" xref="S4.SS3.p2.6.m6.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.2b"><list id="S4.SS3.p2.6.m6.2.3.1.cmml" xref="S4.SS3.p2.6.m6.2.3.2"><ci id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">𝛾</ci><ci id="S4.SS3.p2.6.m6.2.2.cmml" xref="S4.SS3.p2.6.m6.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.2c">\gamma,\beta</annotation></semantics></math>) there is no substantial performance drop when compared to Fig 4 (b), when only (<math id="S4.SS3.p2.7.m7.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.SS3.p2.7.m7.2a"><mrow id="S4.SS3.p2.7.m7.2.3.2" xref="S4.SS3.p2.7.m7.2.3.1.cmml"><mi id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml">γ</mi><mo id="S4.SS3.p2.7.m7.2.3.2.1" xref="S4.SS3.p2.7.m7.2.3.1.cmml">,</mo><mi id="S4.SS3.p2.7.m7.2.2" xref="S4.SS3.p2.7.m7.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.2b"><list id="S4.SS3.p2.7.m7.2.3.1.cmml" xref="S4.SS3.p2.7.m7.2.3.2"><ci id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1">𝛾</ci><ci id="S4.SS3.p2.7.m7.2.2.cmml" xref="S4.SS3.p2.7.m7.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.2c">\gamma,\beta</annotation></semantics></math>) are kept private.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.3" class="ltx_p">Fig 4. (b) and (c) show that keeping private (<math id="S4.SS3.p3.1.m1.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S4.SS3.p3.1.m1.2a"><mrow id="S4.SS3.p3.1.m1.2.3.2" xref="S4.SS3.p3.1.m1.2.3.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">μ</mi><mo id="S4.SS3.p3.1.m1.2.3.2.1" xref="S4.SS3.p3.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS3.p3.1.m1.2.2" xref="S4.SS3.p3.1.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.2b"><list id="S4.SS3.p3.1.m1.2.3.1.cmml" xref="S4.SS3.p3.1.m1.2.3.2"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝜇</ci><ci id="S4.SS3.p3.1.m1.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.2c">\mu,\sigma</annotation></semantics></math>) significantly increases the rate at which the training accuracy can improve (see faint lines in Fig 4. (b) and (c)). Previous authors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> have commented that FedAvg can work as a kind of regularisation for client models. When clients have small local datasets, their training error would quickly reach near-0 as it is easy for independently-trained models to overfit. However, they would have poor generalisation performance (which is the motivation behind FL). Keeping some model parameters private (here <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\mu</annotation></semantics></math> and <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mi id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">\sigma</annotation></semantics></math> from the BN layers) seems to strike a balance between fast convergence (which would be achieved by a fully-private model) and regularisation due to FL (which is achieved by averaging client model parameters).</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span><span id="S4.SS4.1.1" class="ltx_text ltx_font_italic">Personalised FL Comparison</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.10" class="ltx_p"><span id="S4.SS4.p1.10.1" class="ltx_text ltx_font_bold">Setup -</span> We compare the personalisation performance of MTFL(FedAvg) with two other state-of-the-art Personalised FL algorithms: Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and FL(FedAvg) (where no model layers are private) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. We tuned the hyperparameters of each algorithm to achieve the maximum average UA within 200 communication rounds. We present MTFL(FedAvg) with private (<math id="S4.SS4.p1.1.m1.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S4.SS4.p1.1.m1.2a"><mrow id="S4.SS4.p1.1.m1.2.3.2" xref="S4.SS4.p1.1.m1.2.3.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">γ</mi><mo id="S4.SS4.p1.1.m1.2.3.2.1" xref="S4.SS4.p1.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS4.p1.1.m1.2.2" xref="S4.SS4.p1.1.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.2b"><list id="S4.SS4.p1.1.m1.2.3.1.cmml" xref="S4.SS4.p1.1.m1.2.3.2"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝛾</ci><ci id="S4.SS4.p1.1.m1.2.2.cmml" xref="S4.SS4.p1.1.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.2c">\gamma,\beta</annotation></semantics></math>), not MTFL(FedAvg-Adam), as we wish only to compare the personalisation algorithms, not the benefit of the adaptive optimisation strategy. We also fixed the amount of local computation to be roughly constant for the algorithms: we perform <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">E</mi><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><eq id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1"></eq><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝐸</ci><cn type="integer" id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">E=1</annotation></semantics></math> epoch of local training for MTFL(FedAvg) and FL(FedAvg). For MNIST, using a batch size of 20, this is equivalent to 15 and 8 steps of local SGD for <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="W=200" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">W</mi><mo id="S4.SS4.p1.3.m3.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><eq id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></eq><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝑊</ci><cn type="integer" id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">W=200</annotation></semantics></math> and <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="W=400" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mrow id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">W</mi><mo id="S4.SS4.p1.4.m4.1.1.1" xref="S4.SS4.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><eq id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1"></eq><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">𝑊</ci><cn type="integer" id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">W=400</annotation></semantics></math>, respectively. For CIFAR10, this is equivalent to 13 and 7 steps of local SGD for <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="W=200" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><mrow id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml"><mi id="S4.SS4.p1.5.m5.1.1.2" xref="S4.SS4.p1.5.m5.1.1.2.cmml">W</mi><mo id="S4.SS4.p1.5.m5.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.5.m5.1.1.3" xref="S4.SS4.p1.5.m5.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><apply id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><eq id="S4.SS4.p1.5.m5.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1"></eq><ci id="S4.SS4.p1.5.m5.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.2">𝑊</ci><cn type="integer" id="S4.SS4.p1.5.m5.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">W=200</annotation></semantics></math> and <math id="S4.SS4.p1.6.m6.1" class="ltx_Math" alttext="W=400" display="inline"><semantics id="S4.SS4.p1.6.m6.1a"><mrow id="S4.SS4.p1.6.m6.1.1" xref="S4.SS4.p1.6.m6.1.1.cmml"><mi id="S4.SS4.p1.6.m6.1.1.2" xref="S4.SS4.p1.6.m6.1.1.2.cmml">W</mi><mo id="S4.SS4.p1.6.m6.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.6.m6.1.1.3" xref="S4.SS4.p1.6.m6.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.1b"><apply id="S4.SS4.p1.6.m6.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1"><eq id="S4.SS4.p1.6.m6.1.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1"></eq><ci id="S4.SS4.p1.6.m6.1.1.2.cmml" xref="S4.SS4.p1.6.m6.1.1.2">𝑊</ci><cn type="integer" id="S4.SS4.p1.6.m6.1.1.3.cmml" xref="S4.SS4.p1.6.m6.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.1c">W=400</annotation></semantics></math>, respectively. Per-FedAvg uses the value <math id="S4.SS4.p1.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS4.p1.7.m7.1a"><mi id="S4.SS4.p1.7.m7.1.1" xref="S4.SS4.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m7.1b"><ci id="S4.SS4.p1.7.m7.1.1.cmml" xref="S4.SS4.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m7.1c">K</annotation></semantics></math> for local iterations, so we fix that the the same number of steps for FL and MTFL. pFedMe uses has two inner loops, and we set the number of outer-loops <math id="S4.SS4.p1.8.m8.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S4.SS4.p1.8.m8.1a"><mi id="S4.SS4.p1.8.m8.1.1" xref="S4.SS4.p1.8.m8.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m8.1b"><ci id="S4.SS4.p1.8.m8.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m8.1c">R</annotation></semantics></math> to the same value as <math id="S4.SS4.p1.9.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS4.p1.9.m9.1a"><mi id="S4.SS4.p1.9.m9.1.1" xref="S4.SS4.p1.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.9.m9.1b"><ci id="S4.SS4.p1.9.m9.1.1.cmml" xref="S4.SS4.p1.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.9.m9.1c">K</annotation></semantics></math> from Per-FedAvg, and fix the inner-loop number for pFedMe to 1 for all scenarios. This setup results in the same number of local steps performed for each algorithm, however, the cost per local step of Per-FedAvg and pFedMe is considerably higher than FL(FedAvg) and MTFL(FedAvg). Note also that MTFL(FedAvg) and FL(FedAvg) have only one hyperparameter, <math id="S4.SS4.p1.10.m10.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS4.p1.10.m10.1a"><mi id="S4.SS4.p1.10.m10.1.1" xref="S4.SS4.p1.10.m10.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.10.m10.1b"><ci id="S4.SS4.p1.10.m10.1.1.cmml" xref="S4.SS4.p1.10.m10.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.10.m10.1c">\eta</annotation></semantics></math> to tune, whereas Per-FedAvg and pFedMe both have two. This makes the hyperparameter search for Per-FedAvg and pFedMe considerably more costly. 
<br class="ltx_break"></p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.2" class="ltx_p"><span id="S4.SS4.p2.2.1" class="ltx_text ltx_font_bold">Results -</span> The plots in Fig. 5 show that MTFL(FedAvg) was able to achieve a higher UA compared to the other schemes in all tested scenarios. Per-FedAvg and pFedMe were able to reach a higher UA than FL(FedAvg) in the <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="W=200" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">W</mi><mo id="S4.SS4.p2.1.m1.1.1.1" xref="S4.SS4.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><eq id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1"></eq><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝑊</ci><cn type="integer" id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">W=200</annotation></semantics></math> cases for MNIST, but were actually slower in the <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="W=400" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">W</mi><mo id="S4.SS4.p2.2.m2.1.1.1" xref="S4.SS4.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><eq id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1.1"></eq><ci id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">𝑊</ci><cn type="integer" id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">W=400</annotation></semantics></math> cases. All the personalised-FL schemes were able to achieve good UA faster than FL(FedAvg) for the CIFAR10 experiments, however. This is likely due to the CIFAR10 task being a much harder one than MNIST. It is interesting to note that Per-FedAvg appeared to overfit quickly on this task. Also worthy of note is the fact that MTFL(FedAvg) was able to beat Per-FedAvg and pFedMe whilst also having one less hyperparameter to tune, and being computationally cheaper. MTFL also provides the extra benefit to privacy of keeping some model parameters private (pFedMe and Per-FedAvg both upload entire models).</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span><span id="S4.SS5.1.1" class="ltx_text ltx_font_italic">Testbed Results</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p"><span id="S4.SS5.p1.1.1" class="ltx_text ltx_font_bold">Setup -</span> To test MTFL in a more realistic MEC environment, we set up a testbed consisting of 10 clients: 5 Raspberry Pi (RPi) 2B’s and 5 RPi 3B’s, connected over WiFi to a server, in order to emulate a low-powered, heterogeneous set of clients. The RPi’s used Tensorflow to perform local training. The server did not perform any model testing, only receiving, averaging and distributing models. The average time over 10 rounds was taken, along with the percentage of time spent per round in downloading models from the server, local training, uploading models and work performed on the server. 
<br class="ltx_break"></p>
</div>
<div id="S4.SS5.p2" class="ltx_para ltx_noindent">
<p id="S4.SS5.p2.1" class="ltx_p"><span id="S4.SS5.p2.1.1" class="ltx_text ltx_font_bold">Results -</span> Table 4 shows the average time taken per round for FL(FedAvg), MTFL(FedAvg-Adam), and Independent learning, when one local epoch of training is performed. Each round is also split by time spent for each task within the round. As would be expected, Independent learning took the least time per round as clients did not have to download / upload any models. FL(FedAvg) took longer per round due to uploading / downloading, and MTFL(FedAvg-Adam) took the longest per round due to the increased number of weights that FedAvg-Adam communicates over FedAvg, indicated by the higher percentage of round time spent downloading and uploading models. However, the increase in communication time is likely to be outweighed in most cases by the far fewer rounds required to reach a target average UA (see Tables 2-3).</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">The majority of the round times were spent in local training rather than in communication for FL or MTFL. This is due to the low computing power of the RPi’s and the high computational cost of training DNN models. In real-world FL scenarios, the round times are influenced by the compute abilities of client devices, the computational cost of the models used, and the communication conditions.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Average time per round of different learning schemes on the MNIST and CIFAR10 datasets, and percentage of time spent downloading the model (<span id="S4.T4.5.1" class="ltx_text ltx_font_italic">Down</span>), training the model (<span id="S4.T4.6.2" class="ltx_text ltx_font_italic">Client</span>), uploading the model (<span id="S4.T4.7.3" class="ltx_text ltx_font_italic">Up</span>), and model aggregation/distribution on the server (<span id="S4.T4.8.4" class="ltx_text ltx_font_italic">Server</span>) took.</figcaption>
<table id="S4.T4.9" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T4.9.1" class="ltx_tr">
<td id="S4.T4.9.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.1pt;padding-right:4.1pt;" colspan="6"><span id="S4.T4.9.1.1.1" class="ltx_text" style="font-size:90%;">MNIST - 2NN</span></td>
</tr>
<tr id="S4.T4.9.2" class="ltx_tr">
<td id="S4.T4.9.2.1" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.2.1.1" class="ltx_text" style="font-size:90%;">Learning</span></td>
<td id="S4.T4.9.2.2" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.2.2.1" class="ltx_text" style="font-size:90%;">Round</span></td>
<td id="S4.T4.9.2.3" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;" colspan="4"><span id="S4.T4.9.2.3.1" class="ltx_text" style="font-size:90%;">Percentage of Round Time (%)</span></td>
</tr>
<tr id="S4.T4.9.3" class="ltx_tr">
<td id="S4.T4.9.3.1" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.3.1.1" class="ltx_text" style="font-size:90%;">Scheme</span></td>
<td id="S4.T4.9.3.2" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.3.2.1" class="ltx_text" style="font-size:90%;">Time (s)</span></td>
<td id="S4.T4.9.3.3" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Down</span></td>
<td id="S4.T4.9.3.4" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.3.4.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Client</span></td>
<td id="S4.T4.9.3.5" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.3.5.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Up</span></td>
<td id="S4.T4.9.3.6" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.3.6.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Server</span></td>
</tr>
<tr id="S4.T4.9.4" class="ltx_tr">
<td id="S4.T4.9.4.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.4.1.1" class="ltx_text" style="font-size:90%;">FL(FedAvg)</span></td>
<td id="S4.T4.9.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.4.2.1" class="ltx_text" style="font-size:90%;">30</span></td>
<td id="S4.T4.9.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.4.3.1" class="ltx_text" style="font-size:90%;">5</span></td>
<td id="S4.T4.9.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.4.4.1" class="ltx_text" style="font-size:90%;">88</span></td>
<td id="S4.T4.9.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.4.5.1" class="ltx_text" style="font-size:90%;">6</span></td>
<td id="S4.T4.9.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.4.6.1" class="ltx_text" style="font-size:90%;">1</span></td>
</tr>
<tr id="S4.T4.9.5" class="ltx_tr">
<td id="S4.T4.9.5.1" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.5.1.1" class="ltx_text" style="font-size:90%;">MTFL(FedAvg-Adam)</span></td>
<td id="S4.T4.9.5.2" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.5.2.1" class="ltx_text" style="font-size:90%;">38</span></td>
<td id="S4.T4.9.5.3" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.5.3.1" class="ltx_text" style="font-size:90%;">11</span></td>
<td id="S4.T4.9.5.4" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.5.4.1" class="ltx_text" style="font-size:90%;">76</span></td>
<td id="S4.T4.9.5.5" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.5.5.1" class="ltx_text" style="font-size:90%;">12</span></td>
<td id="S4.T4.9.5.6" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.5.6.1" class="ltx_text" style="font-size:90%;">1</span></td>
</tr>
<tr id="S4.T4.9.6" class="ltx_tr">
<td id="S4.T4.9.6.1" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.6.1.1" class="ltx_text" style="font-size:90%;">Independent</span></td>
<td id="S4.T4.9.6.2" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.6.2.1" class="ltx_text" style="font-size:90%;">29</span></td>
<td id="S4.T4.9.6.3" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.6.3.1" class="ltx_text" style="font-size:90%;">0</span></td>
<td id="S4.T4.9.6.4" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.6.4.1" class="ltx_text" style="font-size:90%;">100</span></td>
<td id="S4.T4.9.6.5" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.6.5.1" class="ltx_text" style="font-size:90%;">0</span></td>
<td id="S4.T4.9.6.6" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.6.6.1" class="ltx_text" style="font-size:90%;">0</span></td>
</tr>
<tr id="S4.T4.9.7" class="ltx_tr">
<td id="S4.T4.9.7.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;" colspan="6"><span id="S4.T4.9.7.1.1" class="ltx_text" style="font-size:90%;">CIFAR10 - CNN</span></td>
</tr>
<tr id="S4.T4.9.8" class="ltx_tr">
<td id="S4.T4.9.8.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.8.1.1" class="ltx_text" style="font-size:90%;">FL(FedAvg)</span></td>
<td id="S4.T4.9.8.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.8.2.1" class="ltx_text" style="font-size:90%;">108</span></td>
<td id="S4.T4.9.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.8.3.1" class="ltx_text" style="font-size:90%;">5</span></td>
<td id="S4.T4.9.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.8.4.1" class="ltx_text" style="font-size:90%;">86</span></td>
<td id="S4.T4.9.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.8.5.1" class="ltx_text" style="font-size:90%;">5</span></td>
<td id="S4.T4.9.8.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.8.6.1" class="ltx_text" style="font-size:90%;">4</span></td>
</tr>
<tr id="S4.T4.9.9" class="ltx_tr">
<td id="S4.T4.9.9.1" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.9.1.1" class="ltx_text" style="font-size:90%;">MTFL(FedAvg-Adam)</span></td>
<td id="S4.T4.9.9.2" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.9.2.1" class="ltx_text" style="font-size:90%;">136</span></td>
<td id="S4.T4.9.9.3" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.9.3.1" class="ltx_text" style="font-size:90%;">11</span></td>
<td id="S4.T4.9.9.4" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.9.4.1" class="ltx_text" style="font-size:90%;">74</span></td>
<td id="S4.T4.9.9.5" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.9.5.1" class="ltx_text" style="font-size:90%;">12</span></td>
<td id="S4.T4.9.9.6" class="ltx_td ltx_align_center" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.9.6.1" class="ltx_text" style="font-size:90%;">3</span></td>
</tr>
<tr id="S4.T4.9.10" class="ltx_tr">
<td id="S4.T4.9.10.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.10.1.1" class="ltx_text" style="font-size:90%;">Independent</span></td>
<td id="S4.T4.9.10.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.10.2.1" class="ltx_text" style="font-size:90%;">100</span></td>
<td id="S4.T4.9.10.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.10.3.1" class="ltx_text" style="font-size:90%;">0</span></td>
<td id="S4.T4.9.10.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.10.4.1" class="ltx_text" style="font-size:90%;">100</span></td>
<td id="S4.T4.9.10.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.10.5.1" class="ltx_text" style="font-size:90%;">0</span></td>
<td id="S4.T4.9.10.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.1pt;padding-right:4.1pt;"><span id="S4.T4.9.10.6.1" class="ltx_text" style="font-size:90%;">0</span></td>
</tr>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.4" class="ltx_p">We proposed a Multi-Task Federated Learning (MTFL) algorithm that builds on iterative FL algorithms by introducing private patch layers into the global model. Private layers allow users to have personalised models and significantly improves average User model Accuracy (UA). We analysed the use of BN layers as patches in MTFL, providing insight into the source of their benefit. MTFL is a general algorithm that requires a specific FL optimisation strategy, and we also proposed the FedAvg-Adam optimisation scheme that uses Adam on clients. Experiments using MNIST and CIFAR10 show that MTFL with FedAvg significantly reduces the number of rounds to reach a target average UA compared to FL, by up to <math id="S5.p1.1.m1.1" class="ltx_math_unparsed" alttext="5\times" display="inline"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1b"><mn id="S5.p1.1.m1.1.1">5</mn><mo lspace="0.222em" id="S5.p1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">5\times</annotation></semantics></math>. Further experiments show that MTFL with FedAvg-Adam reduces this number even further, by up to <math id="S5.p1.2.m2.1" class="ltx_math_unparsed" alttext="3\times" display="inline"><semantics id="S5.p1.2.m2.1a"><mrow id="S5.p1.2.m2.1b"><mn id="S5.p1.2.m2.1.1">3</mn><mo lspace="0.222em" id="S5.p1.2.m2.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">3\times</annotation></semantics></math>. These experiments also indicate that using private BN trainable parameters (<math id="S5.p1.3.m3.2" class="ltx_Math" alttext="\gamma,\beta" display="inline"><semantics id="S5.p1.3.m3.2a"><mrow id="S5.p1.3.m3.2.3.2" xref="S5.p1.3.m3.2.3.1.cmml"><mi id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml">γ</mi><mo id="S5.p1.3.m3.2.3.2.1" xref="S5.p1.3.m3.2.3.1.cmml">,</mo><mi id="S5.p1.3.m3.2.2" xref="S5.p1.3.m3.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.2b"><list id="S5.p1.3.m3.2.3.1.cmml" xref="S5.p1.3.m3.2.3.2"><ci id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1">𝛾</ci><ci id="S5.p1.3.m3.2.2.cmml" xref="S5.p1.3.m3.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.2c">\gamma,\beta</annotation></semantics></math>) instead of statistics (<math id="S5.p1.4.m4.2" class="ltx_Math" alttext="\mu,\sigma" display="inline"><semantics id="S5.p1.4.m4.2a"><mrow id="S5.p1.4.m4.2.3.2" xref="S5.p1.4.m4.2.3.1.cmml"><mi id="S5.p1.4.m4.1.1" xref="S5.p1.4.m4.1.1.cmml">μ</mi><mo id="S5.p1.4.m4.2.3.2.1" xref="S5.p1.4.m4.2.3.1.cmml">,</mo><mi id="S5.p1.4.m4.2.2" xref="S5.p1.4.m4.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.4.m4.2b"><list id="S5.p1.4.m4.2.3.1.cmml" xref="S5.p1.4.m4.2.3.2"><ci id="S5.p1.4.m4.1.1.cmml" xref="S5.p1.4.m4.1.1">𝜇</ci><ci id="S5.p1.4.m4.2.2.cmml" xref="S5.p1.4.m4.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.4.m4.2c">\mu,\sigma</annotation></semantics></math>) in model patches gives better convergence speed. Comparison to other state-of-the-art personalised FL algorithms show that MTFL is able to achieve the highest average UA given limited communication rounds. Lastly, we showed in experiments using a MEC-like testbed that the communication overhead of MTFL with FedAvg-Adam is outweighed by its significant benefits over FL with FedAvg in terms of UA and convergence speed.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Y. Mao, C. You, J. Zhang, K. Huang, and K. Letaief, “A survey on mobile edge
computing: The communication perspective,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE Communications Surveys
Tutorials</em>, vol. 19, no. 4, pp. 2322–2358, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
B. Yang, X. Cao, J. Bassey, X. Li, and L. Qian, “Computation offloading in
multi-access edge computing: A multi-task learning approach,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proc.
IEEE International Conference on Communications (ICC)</em>, pp. 1–6, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Y. Li, X. Wang, X. Gan, H. Jin, L. Fu, and X. Wang, “Learning-aided
computation offloading for trusted collaborative mobile edge computing,”
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Mobile Computing</em>, vol. 19, no. 12, pp.
2833–2849, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
T. Li, A. Sahu, A. Talwalkar, and V. Smith, “Federated learning: Challenges,
methods, and future directions,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>,
vol. 37, no. 3, pp. 50–60, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, and B. A. y Arcas, “Communication-efficient
learning of deep networks from decentralized data,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proc. 20th
International Conference on Artifical Intelligence and Statistics (AISTATS)</em>,
pp. 1273–1282, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
A. G. Roy, S. Siddiqui, S. Pölsterl, N. Navab, and C. Wachinger,
“Braintorrent: A peer-to-peer environment for decentralized federated
learning,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1905.06731</em>, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
L. Huang, A. L. Shea, H. Qian, A. Masurkar, H. Deng, and D. Liu, “Patient
clustering improves efficiency of federated machine learning to predict
mortality and hospital stay time using distributed electronic medical
records,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Journal of Biomedical Informatics</em>, vol. 99, 103291, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
A. Hard, K. Rao, R. Mathews, F. Beaufays, S. Augenstein, H. Eichner, C. Kiddon,
and D. Ramage, “Federated learning for mobile keyboard prediction,”
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.03604</em>, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
M. Ammad-ud-din, E. Ivannikova, S. A. Khan, W. Oyomno, Q. Fu, K. E. Tan,
and A. Flanagan, “Federated collaborative filtering for privacy-preserving
personalized recommendation system,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1901.09888</em>,
2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
C. T. Dinh, N. Tran, and J. Nguyen, “Personalized federated learning with
moreau envelopes,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proc. Neural Information Processing Systems
(NeurIPS)</em>, vol. 33, pp. 21394-21405, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Jiang, J. Konečný, K. Rush, and S. Kannan, “Improving federated
learing personalization via model agnostic meta learning,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:1909.12488</em>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Fallah, A. Mokhtari, and A. Ozdaglar, “Personalized federated learning with
theoretical guarantees: A model-agnostic meta-learning approach,” in
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proc. Neural Information Processing Systems (NeurIPS)</em>, vol. 33, pp.
3557-3568, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
V. Smith, C.-K. Chiang, M. Sanjabi, and A. Talwalkar, “Federated multi-task
learning,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proc. Neural Information Processing Systems (NeurIPS)</em>,
pp. 4427-4437, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
P. K. Mudrakarta, M. Sandler, A. Zhmoginov, and A. Howard, “K for the price of
1: Parameter efficient multi-task and transfer learning,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proc.
International Conference on Learning Representations (ICLR)</em>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
D. Leroy, A. Coucke, T. Lavril, T. Gisselbrecht, and J. Dureau, “Federated
learning for keyword spotting,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE International Conference
on Acoustics, Speech and Signal Processing (ICASSP)</em>, pp. 6341–6345, 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
S. Reddi, Z. Charles, M. Zaheer, Z. Garrett, K. Rush, J. Konečný,
S. Kumar, and H. McMahan, “Adaptive federated optimization,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proc.
International Conference on Learning Representations (ICLR)</em>, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
D. Kingma and J. Ba, “Adam: A method for stochastic optimization,” in
<em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proc. International Conference on Learning Representations (ICLR)</em>,
2014.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
F. Hanzely and P. Richtárik, “Federated learning of a mixture of global
and local models,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y. Huang, L. Chu, Z. Zhou, L. Wang, J. Liu, J. Pei, and Y. Zhang,
“Personalized cross-silo federated learning on non-iid data,” in
<em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proc. Association for the Advancement of Artificial Intelligene
(AAAI)</em>, vol. 35, no. 9, pp. 7865-7873, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
C. Dinh, T. Vu, N. Tran, M. Dao, and H. Zhang, “Fedu: A unified framework for
federated multi-task learning with laplacian regularization,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2102.07148</em>, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
H. Jiang, J. Starkman, Y.-J. Lee, H. Chen, X. Qian, and M.-C. Huang,
“Distributed deep learning optimized system over the cloud and smart phone
devices,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Mobile Computing</em>, vol. 20, no. 1, pp.
147–161, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
K. Bonawitz, H. Eichner, W. Grieskamp <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Towards federated
learning at scale: System design,” in <em id="bib.bib22.2.2" class="ltx_emph ltx_font_italic">Proc. Systems and Machine
Learning Conference (SysML)</em>, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
M. Duan, D. Liu, X. Chen, R. Liu, Y. Tan, and L. Liang, “Self-balancing
federated learning with global imbalanced data in mobile systems,”
<em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems</em>, vol. 32, no. 1,
pp. 59–71, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
H. Yang, Z. Liu, T. Quek, and H. Poor, “Scheduling policies for federated
learning in wireless networks,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Communications</em>,
vol. 68, no. 1, pp. 317–333, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
J. Ahn, O. Simeone, and J. Kang, “Wireless federated distillation for
distributed edge learning with heterogeneous data,” in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE 30th
Annual International Symposium on Personal, Indoor and Mobile Radio
Communications (PIMRC)</em>, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
C. Wang, Y. Yang, and P. Zhou, “Towards efficient scheduling of federated
mobile devices under computational and statistical heterogeneity,”
<em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems</em>, vol. 32, no. 2,
pp. 394–410, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
T. Nishio and R. Yonetani, “Client selection for federated learning with
heterogeneous resources in mobile edge,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE International
Conference on Communications (ICC)</em>, pp. 1-7, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
W. Liu, L. Chen, Y. Chen, and W. Zhang, “Accelerating federated learning via
momentum gradient descent,” <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and
Distributed Systems</em>, vol. 31, no. 8, pp. 1754–1766, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
N. Konstantinov and C. Lampert, “Robust learning from untrusted sources,” in
<em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proc. International Conference on Machine Learning (ICML)</em>, pp.
3488-3498, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
L. Wang, W. Wang, and B. Li, “CMFL: Mitigating communication overhead for
federated learning,” in <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE 39th International Conference on
Distributed Computing Systems (ICDCS)</em>, pp. 954–964, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
T. Yu, E. Bagdasaryan, and V. Shmatikov, “Salvaging federated learning by
local adaptation,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.04758</em>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. LeCun and C. Cortes, “Mnist handwritten digit database.” [Online].
Available: <span class="ltx_ref ltx_nolink ltx_url ltx_ref_self">http://yann.lecun.com/exdb/mnist/</span>

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
A. Krizhevsky, “Learning multiple layers of features from tiny images,”
University of Toronto, Toronto, Tech. Rep., 2019.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2007.09235" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2007.09236" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2007.09236">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2007.09236" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2007.09237" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 10:35:19 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
