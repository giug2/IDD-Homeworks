<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.00247] Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning</title><meta property="og:description" content="Federated learning (FL) offers privacy-preserving decentralized machine learning, optimizing models at edge clients without sharing private data. Simultaneously, foundation models (FMs) have gained traction in the arti…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.00247">

<!--Generated on Wed Feb 28 03:07:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sixing Yu<sup id="id6.6.id1" class="ltx_sup">1</sup>, J. Pablo Muñoz<sup id="id7.7.id2" class="ltx_sup">2</sup>, Ali Jannesari<sup id="id8.8.id3" class="ltx_sup">1</sup>

<br class="ltx_break"><sup id="id9.9.id4" class="ltx_sup"><span id="id9.9.id4.1" class="ltx_text ltx_font_italic">1</span></sup>Department of Computer Science, Iowa State University
<br class="ltx_break"><sup id="id10.10.id5" class="ltx_sup"><span id="id10.10.id5.1" class="ltx_text ltx_font_italic">2</span></sup>Intel Labs
<br class="ltx_break"><span id="id11.11.id6" class="ltx_text ltx_font_typewriter">{yusx, jannesar}@iastate.edu, pablo.munoz@intel.com</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id12.id1" class="ltx_p">Federated learning (FL) offers privacy-preserving decentralized machine learning, optimizing models at edge clients without sharing private data. Simultaneously, foundation models (FMs) have gained traction in the artificial intelligence (AI) community due to their exceptional performance across various tasks. However, integrating FMs into FL presents challenges, primarily due to their substantial size and intensive resource requirements. This is especially true when considering the resource heterogeneity in edge FL systems. We present an adaptive framework for Resource-aware Federated Foundation Models (RaFFM) to address these challenges. RaFFM introduces specialized model compression algorithms tailored for FL scenarios, such as salient parameter prioritization and high-performance subnetwork extraction. These algorithms enable dynamic scaling of given transformer-based FMs to fit heterogeneous resource constraints at the network edge during both FL’s optimization and deployment stages. Experimental results demonstrate that RaFFM shows significant superiority in resource utilization efficiency and uses fewer resources to deploy FMs to FL. Despite the lower resource consumption, target models optimized by RaFFM achieve performance on par with traditional FL methods applied to full-sized FMs. This is evident across tasks in both natural language processing and computer vision domains.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite> represents a significant advancement in machine learning, emphasizing decentralized training while preserving data privacy. FL enhances data privacy and collaboration compared to traditional machine learning by enabling model training across multitudes of decentralized devices without direct data sharing. However, challenges like non-identical independent distribution (non-IID) data and heterogeneous computational resources among devices present potential training failures.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Concurrently, transformer-based foundation models (FMs) <cite class="ltx_cite ltx_citemacro_citep">(Bommasani et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>, typified by GPT <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib27" title="" class="ltx_ref">2019</a>; Brown et al., <a href="#bib.bib3" title="" class="ltx_ref">2020a</a>; OpenAI, <a href="#bib.bib25" title="" class="ltx_ref">2023</a>)</cite>, BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib7" title="" class="ltx_ref">2018</a>)</cite>, and ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>, pre-trained on large-scale datasets, have revolutionized AI research.
FMs leverage their inherent pre-trained knowledge, achieving exceptional performance across multiple domains in downstream tasks even with limited fine-tuning data.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Given the superior strengths of FMs in few-shot transfer learning, they appear well-suited for non-IID FL environments <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib42" title="" class="ltx_ref">2023</a>; Zhuang et al., <a href="#bib.bib43" title="" class="ltx_ref">2023</a>)</cite>. However, seamlessly integrating FMs into FL presents significant challenges. The substantial size and intensive resource demands of FMs make their deployment on resource-constrained FL edge devices problematic. Furthermore, the uneven distribution of computational resources within FL increases the difficulty of existing challenges. A resource-limited device must first satisfy the resource requirements for FM optimization, despite the presence of more capable devices within the same FL network, leading to high system requirements overall.
Additionally, fine-tuning FMs typically requires approximately seven times the resources compared to inference. This disparity means that FL often faces resource-hungry during model training while leaving resources underutilized during inference.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">We propose a framework, Resource-aware Federated Foundation Models (RaFFM), to address the resource utilization challenges in FL. RaFFM uses specialized transformer-based FM compression algorithms tailored for FL-edge environments, and dynamically deploys resource-aware scaled FMs to local clients.
Since FMs are over-parameterized, a subset of salient parameters is more impactful to model performance. RaFFM first identifies and prioritizes the salient parameters in the given FM before FL communication starts. The salient parameter prioritization can ease the resource-aware sub-model extractions from FMs and model fusion in FL global updates via parallel matrix operations.
Then, RaFFM generates resource-aware sub-models with salient weights so clients can proceed with the FL fine-tuning cycle.
Post-training, given that model inference is more resource-friendly than training, RaFFM can deploy larger models, ensuring optimized performance and consistent resource allocation based on the client’s capabilities.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">In essence, RaFFM brings forth the following key contributions:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Designed specialized FM compression algorithms tailored for edge FL.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Proposed specialized salient parameter prioritization strategy for transformer-based FMs.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Enhanced resource utilization throughout the training and deployment stages of FL.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i4.p1.1" class="ltx_p">Significant reduction in communication overhead between edge devices and central servers.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">With growing concerns over data privacy, Federated Learning (FL) has emerged as a decentralized, privacy-preserving machine learning paradigm. It allows model training on private user data without compromising its confidentiality <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite>.
In FL, private data remains on local clients, and the target model is optimized locally, ensuring data privacy and security. Clients only share model updates, such as weights and gradients, asynchronously, minimizing the risk of data leaks.
A representative FL algorithm is FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite>. The innate privacy features of FL have made it a preferred choice in various applications, especially in sectors with stringent privacy requirements like healthcare.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p">However, data and resource heterogeneity in FL often lead to training failures. Unbalanced training across clients leads to poor model convergence and performance. Recent work in FL has focused on improving gradient descent to stabilize training <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>; Karimireddy et al., <a href="#bib.bib13" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>; personalizing model weights to enhance performance on downstream tasks <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib6" title="" class="ltx_ref">2020</a>; Tan et al., <a href="#bib.bib31" title="" class="ltx_ref">2022</a>; Yu et al., <a href="#bib.bib40" title="" class="ltx_ref">2022c</a>)</cite>; and employing model compression techniques like knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib41" title="" class="ltx_ref">2022d</a>)</cite>, dynamic dropout <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib37" title="" class="ltx_ref">2021b</a>)</cite>, and adaptive pruning to reduce overfitting on non-IID datasets and improve communication efficiency  <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a href="#bib.bib12" title="" class="ltx_ref">2022</a>; Yu et al., <a href="#bib.bib37" title="" class="ltx_ref">2021b</a>; Lin et al., <a href="#bib.bib18" title="" class="ltx_ref">2020</a>; Yu et al., <a href="#bib.bib39" title="" class="ltx_ref">2022b</a>)</cite>.
Despite these advances, there remains a gap between traditional model training and FL, particularly in heterogeneous FL-edge environments.
</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Foundation Models</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">Foundation models (FMs) <cite class="ltx_cite ltx_citemacro_citep">(Bommasani et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>, such as the GPT family <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a href="#bib.bib3" title="" class="ltx_ref">2020a</a>; Radford et al., <a href="#bib.bib27" title="" class="ltx_ref">2019</a>)</cite>, LLaMA <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite>, ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>, CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite>, and BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib7" title="" class="ltx_ref">2018</a>)</cite>, stand at the forefront of AI advancements. FMs pre-trained on vast datasets exhibiting remarkable performance across multiple tasks.
The typical lifecycle of an FM encompasses pre-training, fine-tuning, and application. During pre-training, models undergo unsupervised or self-supervised learning on large datasets. The fine-tuning phase tailors them for specific tasks. As an illustration, GPT models <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a href="#bib.bib3" title="" class="ltx_ref">2020a</a>; Radford et al., <a href="#bib.bib27" title="" class="ltx_ref">2019</a>; OpenAI, <a href="#bib.bib25" title="" class="ltx_ref">2023</a>)</cite> acquire grammar, syntax, and semantics during pre-training, making subsequent fine-tuning for tasks like text classification or sentiment analysis more effective.
FMs excel in few-shot transfer learning <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a href="#bib.bib4" title="" class="ltx_ref">2020b</a>)</cite>, making them particularly suited for data-heterogeneous FL environments where limited and imbalanced local data are present. However, the inherent large size and resource-hungry of FMs pose significant challenges to seamlessly apply in FL settings.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2310.00247/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="113" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Resource-aware Federated Foundation Model (RaFFM) Overview.</figcaption>
</figure>
<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">This section offers an in-depth overview of the primary components of the proposed Resource-Aware Federated Foundation Model (RaFFM): foundation model scaling and resource-aware federated learning.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Foundation Model Scaling</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">RaFFM employs a foundation model scaling technique, inspired by <cite class="ltx_cite ltx_citemacro_citep">(Muñoz et al., <a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite>, primarily designed to compress pre-trained FMs while ensuring adherence to the heterogeneous resource constraints in edge-FL systems. The overarching objective is to enhance resource utilization both during the training and inference phases in FL.
As highlighted in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, foundation model scaling incorporates two key components: salient parameter prioritization and high-performance sub-model extraction.</p>
</div>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Salient Parameter Prioritization</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS1.p1.1" class="ltx_p">Recent advancements in model compression, such as network pruning <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib9" title="" class="ltx_ref">2018</a>; Blalock et al., <a href="#bib.bib1" title="" class="ltx_ref">2020</a>; Yu et al., <a href="#bib.bib38" title="" class="ltx_ref">2022a</a>; <a href="#bib.bib36" title="" class="ltx_ref">2021a</a>)</cite> and neural architecture search <cite class="ltx_cite ltx_citemacro_citep">(White et al., <a href="#bib.bib35" title="" class="ltx_ref">2023</a>; Muñoz et al., <a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite>, underscore that deep neural networks, particularly pre-trained FMs, often exhibit over-parameterization. Only a subset of parameters critically influence the model’s performance.
Identifying these impactful parameters is of paramount importance in resource-limited FL settings.
Within RaFFM, we leverage salient parameter prioritization to identify salient parameters in FMs, and extract high-performance sub-models with salient parameters that are uniquely tailored for individual clients’ resources. Additionally, salient parameter prioritization can ease the resource-aware sub-model extractions and model fusion in FL global updates using parallel matrix slicing.</p>
</div>
<div id="S3.SS1.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS1.p2.2" class="ltx_p"><span id="S3.SS1.SSS1.p2.2.1" class="ltx_text ltx_font_bold">Parameter Salience Score.</span>
Inspired by magnitude-based pruning techniques, salient parameters are recognized by ranking model weights using a salience evaluation metric (examples include the L1 and L2 norms <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib16" title="" class="ltx_ref">2016</a>; Kumar et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>). Our experimental analysis preferred the L1 norm, thus adopted for our context. The L1 norm salience for a channel <math id="S3.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><mi id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><ci id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">c</annotation></semantics></math> within weight matrix <math id="S3.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.SSS1.p2.2.m2.1a"><mi id="S3.SS1.SSS1.p2.2.m2.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.2.m2.1b"><ci id="S3.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.2.m2.1c">W</annotation></semantics></math> is illustrated by:</p>
</div>
<div id="S3.SS1.SSS1.p3" class="ltx_para ltx_noindent">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\text{Salience}(c)=\sum_{i=1}^{n}|W_{c,i}|" display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><mtext id="S3.E1.m1.4.4.3.2" xref="S3.E1.m1.4.4.3.2a.cmml">Salience</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.3.1" xref="S3.E1.m1.4.4.3.1.cmml">​</mo><mrow id="S3.E1.m1.4.4.3.3.2" xref="S3.E1.m1.4.4.3.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.3.3.2.1" xref="S3.E1.m1.4.4.3.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">c</mi><mo stretchy="false" id="S3.E1.m1.4.4.3.3.2.2" xref="S3.E1.m1.4.4.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml">=</mo><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.cmml"><munderover id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E1.m1.4.4.1.2.2.2" xref="S3.E1.m1.4.4.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.4.4.1.2.2.3" xref="S3.E1.m1.4.4.1.2.2.3.cmml"><mi id="S3.E1.m1.4.4.1.2.2.3.2" xref="S3.E1.m1.4.4.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.4.4.1.2.2.3.1" xref="S3.E1.m1.4.4.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.4.4.1.2.2.3.3" xref="S3.E1.m1.4.4.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.4.4.1.2.3" xref="S3.E1.m1.4.4.1.2.3.cmml">n</mi></munderover><mrow id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.1.2" xref="S3.E1.m1.4.4.1.1.2.1.cmml">|</mo><msub id="S3.E1.m1.4.4.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.2.cmml">W</mi><mrow id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">c</mi><mo id="S3.E1.m1.2.2.2.4.1" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.4.4.1.1.1.3" xref="S3.E1.m1.4.4.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><eq id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"></eq><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><times id="S3.E1.m1.4.4.3.1.cmml" xref="S3.E1.m1.4.4.3.1"></times><ci id="S3.E1.m1.4.4.3.2a.cmml" xref="S3.E1.m1.4.4.3.2"><mtext id="S3.E1.m1.4.4.3.2.cmml" xref="S3.E1.m1.4.4.3.2">Salience</mtext></ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑐</ci></apply><apply id="S3.E1.m1.4.4.1.cmml" xref="S3.E1.m1.4.4.1"><apply id="S3.E1.m1.4.4.1.2.cmml" xref="S3.E1.m1.4.4.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.2.1.cmml" xref="S3.E1.m1.4.4.1.2">superscript</csymbol><apply id="S3.E1.m1.4.4.1.2.2.cmml" xref="S3.E1.m1.4.4.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.2.2.1.cmml" xref="S3.E1.m1.4.4.1.2">subscript</csymbol><sum id="S3.E1.m1.4.4.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.2.2.2"></sum><apply id="S3.E1.m1.4.4.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.2.2.3"><eq id="S3.E1.m1.4.4.1.2.2.3.1.cmml" xref="S3.E1.m1.4.4.1.2.2.3.1"></eq><ci id="S3.E1.m1.4.4.1.2.2.3.2.cmml" xref="S3.E1.m1.4.4.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.4.4.1.2.2.3.3.cmml" xref="S3.E1.m1.4.4.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.4.4.1.2.3.cmml" xref="S3.E1.m1.4.4.1.2.3">𝑛</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1"><abs id="S3.E1.m1.4.4.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.2"></abs><apply id="S3.E1.m1.4.4.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2">𝑊</ci><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑐</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑖</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\text{Salience}(c)=\sum_{i=1}^{n}|W_{c,i}|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p3.1" class="ltx_p">Equation <a href="#S3.E1" title="In 3.1.1 Salient Parameter Prioritization ‣ 3.1 Foundation Model Scaling ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> captures the L1 norm by aggregating the absolute weight values in a channel, reflecting the channel’s cumulative significance.</p>
</div>
<div id="S3.SS1.SSS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS1.p4.1" class="ltx_p"><span id="S3.SS1.SSS1.p4.1.1" class="ltx_text ltx_font_bold">Salient Parameter Prioritization.</span>
We rank the original model’s weight channels based on their salience scores. Prioritization ensures that channels with the highest salience are forefronted in the weight matrix.</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="c_{ranked}=\text{argsort}(\text{Salience}(c),\text{descending})" display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><msub id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml"><mi id="S3.E2.m1.3.3.3.2" xref="S3.E2.m1.3.3.3.2.cmml">c</mi><mrow id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml"><mi id="S3.E2.m1.3.3.3.3.2" xref="S3.E2.m1.3.3.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.3.3.1" xref="S3.E2.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.3.3.3" xref="S3.E2.m1.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.3.3.1a" xref="S3.E2.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.3.3.4" xref="S3.E2.m1.3.3.3.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.3.3.1b" xref="S3.E2.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.3.3.5" xref="S3.E2.m1.3.3.3.3.5.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.3.3.1c" xref="S3.E2.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.3.3.6" xref="S3.E2.m1.3.3.3.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.3.3.1d" xref="S3.E2.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.3.3.7" xref="S3.E2.m1.3.3.3.3.7.cmml">d</mi></mrow></msub><mo id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.2.cmml">=</mo><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.cmml"><mtext id="S3.E2.m1.3.3.1.3" xref="S3.E2.m1.3.3.1.3a.cmml">argsort</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mtext id="S3.E2.m1.3.3.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.2a.cmml">Salience</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.3.2.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.2.cmml">,</mo><mtext id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2a.cmml">descending</mtext><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.4" xref="S3.E2.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><eq id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2"></eq><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.2">𝑐</ci><apply id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3"><times id="S3.E2.m1.3.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.3.1"></times><ci id="S3.E2.m1.3.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.3.2">𝑟</ci><ci id="S3.E2.m1.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3">𝑎</ci><ci id="S3.E2.m1.3.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.3.4">𝑛</ci><ci id="S3.E2.m1.3.3.3.3.5.cmml" xref="S3.E2.m1.3.3.3.3.5">𝑘</ci><ci id="S3.E2.m1.3.3.3.3.6.cmml" xref="S3.E2.m1.3.3.3.3.6">𝑒</ci><ci id="S3.E2.m1.3.3.3.3.7.cmml" xref="S3.E2.m1.3.3.3.3.7">𝑑</ci></apply></apply><apply id="S3.E2.m1.3.3.1.cmml" xref="S3.E2.m1.3.3.1"><times id="S3.E2.m1.3.3.1.2.cmml" xref="S3.E2.m1.3.3.1.2"></times><ci id="S3.E2.m1.3.3.1.3a.cmml" xref="S3.E2.m1.3.3.1.3"><mtext id="S3.E2.m1.3.3.1.3.cmml" xref="S3.E2.m1.3.3.1.3">argsort</mtext></ci><interval closure="open" id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1"><apply id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1"><times id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"></times><ci id="S3.E2.m1.3.3.1.1.1.1.2a.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2"><mtext id="S3.E2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2">Salience</mtext></ci><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑐</ci></apply><ci id="S3.E2.m1.2.2a.cmml" xref="S3.E2.m1.2.2"><mtext id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">descending</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">c_{ranked}=\text{argsort}(\text{Salience}(c),\text{descending})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_math_unparsed" alttext="W_{ranked}=W[c_{ranked}:]" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1b"><msub id="S3.E3.m1.1.1"><mi id="S3.E3.m1.1.1.2">W</mi><mrow id="S3.E3.m1.1.1.3"><mi id="S3.E3.m1.1.1.3.2">r</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1">​</mo><mi id="S3.E3.m1.1.1.3.3">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1a">​</mo><mi id="S3.E3.m1.1.1.3.4">n</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1b">​</mo><mi id="S3.E3.m1.1.1.3.5">k</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1c">​</mo><mi id="S3.E3.m1.1.1.3.6">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1d">​</mo><mi id="S3.E3.m1.1.1.3.7">d</mi></mrow></msub><mo id="S3.E3.m1.1.2">=</mo><mi id="S3.E3.m1.1.3">W</mi><mrow id="S3.E3.m1.1.4"><mo stretchy="false" id="S3.E3.m1.1.4.1">[</mo><msub id="S3.E3.m1.1.4.2"><mi id="S3.E3.m1.1.4.2.2">c</mi><mrow id="S3.E3.m1.1.4.2.3"><mi id="S3.E3.m1.1.4.2.3.2">r</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.4.2.3.1">​</mo><mi id="S3.E3.m1.1.4.2.3.3">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.4.2.3.1a">​</mo><mi id="S3.E3.m1.1.4.2.3.4">n</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.4.2.3.1b">​</mo><mi id="S3.E3.m1.1.4.2.3.5">k</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.4.2.3.1c">​</mo><mi id="S3.E3.m1.1.4.2.3.6">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.4.2.3.1d">​</mo><mi id="S3.E3.m1.1.4.2.3.7">d</mi></mrow></msub><mo lspace="0.278em" rspace="0em" id="S3.E3.m1.1.4.3">:</mo><mo stretchy="false" id="S3.E3.m1.1.4.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.1c">W_{ranked}=W[c_{ranked}:]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p4.2" class="ltx_p">Equation <a href="#S3.E2" title="In 3.1.1 Salient Parameter Prioritization ‣ 3.1 Foundation Model Scaling ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Equation <a href="#S3.E3" title="In 3.1.1 Salient Parameter Prioritization ‣ 3.1 Foundation Model Scaling ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> delineate the procedure for ranking channels based on salience scores.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Parameter Prioritization in Transformer</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">While existing magnitude-based compression methods predominantly target convolutional neural networks (CNNs), applying salient parameter prioritization to multi-head attention transformers architectures <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib33" title="" class="ltx_ref">2017</a>)</cite> requires additional deliberation. We introduce a specialized salient parameter prioritization strategy tailored for transformers, which ensures the preservation of the inherent attention information present in the original FM.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para ltx_noindent">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.5" class="ltx_Math" alttext="\text{Attention}(W^{q},W^{k},W^{v},x)=\text{softmax}\left(\frac{xW^{q}(xW^{k})^{T}}{\sqrt{d_{k}}}\right)xW^{v}" display="block"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml"><mrow id="S3.E4.m1.5.5.3" xref="S3.E4.m1.5.5.3.cmml"><mtext id="S3.E4.m1.5.5.3.5" xref="S3.E4.m1.5.5.3.5a.cmml">Attention</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.3.4" xref="S3.E4.m1.5.5.3.4.cmml">​</mo><mrow id="S3.E4.m1.5.5.3.3.3" xref="S3.E4.m1.5.5.3.3.4.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.3.3.3.4" xref="S3.E4.m1.5.5.3.3.4.cmml">(</mo><msup id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml">W</mi><mi id="S3.E4.m1.3.3.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.3.cmml">q</mi></msup><mo id="S3.E4.m1.5.5.3.3.3.5" xref="S3.E4.m1.5.5.3.3.4.cmml">,</mo><msup id="S3.E4.m1.4.4.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.2.cmml"><mi id="S3.E4.m1.4.4.2.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.2.2.cmml">W</mi><mi id="S3.E4.m1.4.4.2.2.2.2.3" xref="S3.E4.m1.4.4.2.2.2.2.3.cmml">k</mi></msup><mo id="S3.E4.m1.5.5.3.3.3.6" xref="S3.E4.m1.5.5.3.3.4.cmml">,</mo><msup id="S3.E4.m1.5.5.3.3.3.3" xref="S3.E4.m1.5.5.3.3.3.3.cmml"><mi id="S3.E4.m1.5.5.3.3.3.3.2" xref="S3.E4.m1.5.5.3.3.3.3.2.cmml">W</mi><mi id="S3.E4.m1.5.5.3.3.3.3.3" xref="S3.E4.m1.5.5.3.3.3.3.3.cmml">v</mi></msup><mo id="S3.E4.m1.5.5.3.3.3.7" xref="S3.E4.m1.5.5.3.3.4.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.5.5.3.3.3.8" xref="S3.E4.m1.5.5.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.5.5.4" xref="S3.E4.m1.5.5.4.cmml">=</mo><mrow id="S3.E4.m1.5.5.5" xref="S3.E4.m1.5.5.5.cmml"><mtext id="S3.E4.m1.5.5.5.2" xref="S3.E4.m1.5.5.5.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.5.1" xref="S3.E4.m1.5.5.5.1.cmml">​</mo><mrow id="S3.E4.m1.5.5.5.3.2" xref="S3.E4.m1.1.1.cmml"><mo id="S3.E4.m1.5.5.5.3.2.1" xref="S3.E4.m1.1.1.cmml">(</mo><mfrac id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">​</mo><msup id="S3.E4.m1.1.1.1.4" xref="S3.E4.m1.1.1.1.4.cmml"><mi id="S3.E4.m1.1.1.1.4.2" xref="S3.E4.m1.1.1.1.4.2.cmml">W</mi><mi id="S3.E4.m1.1.1.1.4.3" xref="S3.E4.m1.1.1.1.4.3.cmml">q</mi></msup><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.2a" xref="S3.E4.m1.1.1.1.2.cmml">​</mo><msup id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml">T</mi></msup></mrow><msqrt id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><msub id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml"><mi id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml">d</mi><mi id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S3.E4.m1.5.5.5.3.2.2" xref="S3.E4.m1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.5.1a" xref="S3.E4.m1.5.5.5.1.cmml">​</mo><mi id="S3.E4.m1.5.5.5.4" xref="S3.E4.m1.5.5.5.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.5.1b" xref="S3.E4.m1.5.5.5.1.cmml">​</mo><msup id="S3.E4.m1.5.5.5.5" xref="S3.E4.m1.5.5.5.5.cmml"><mi id="S3.E4.m1.5.5.5.5.2" xref="S3.E4.m1.5.5.5.5.2.cmml">W</mi><mi id="S3.E4.m1.5.5.5.5.3" xref="S3.E4.m1.5.5.5.5.3.cmml">v</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"><eq id="S3.E4.m1.5.5.4.cmml" xref="S3.E4.m1.5.5.4"></eq><apply id="S3.E4.m1.5.5.3.cmml" xref="S3.E4.m1.5.5.3"><times id="S3.E4.m1.5.5.3.4.cmml" xref="S3.E4.m1.5.5.3.4"></times><ci id="S3.E4.m1.5.5.3.5a.cmml" xref="S3.E4.m1.5.5.3.5"><mtext id="S3.E4.m1.5.5.3.5.cmml" xref="S3.E4.m1.5.5.3.5">Attention</mtext></ci><vector id="S3.E4.m1.5.5.3.3.4.cmml" xref="S3.E4.m1.5.5.3.3.3"><apply id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2">𝑊</ci><ci id="S3.E4.m1.3.3.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3">𝑞</ci></apply><apply id="S3.E4.m1.4.4.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.4.4.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2">𝑊</ci><ci id="S3.E4.m1.4.4.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.2.3">𝑘</ci></apply><apply id="S3.E4.m1.5.5.3.3.3.3.cmml" xref="S3.E4.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.3.3.3.3.1.cmml" xref="S3.E4.m1.5.5.3.3.3.3">superscript</csymbol><ci id="S3.E4.m1.5.5.3.3.3.3.2.cmml" xref="S3.E4.m1.5.5.3.3.3.3.2">𝑊</ci><ci id="S3.E4.m1.5.5.3.3.3.3.3.cmml" xref="S3.E4.m1.5.5.3.3.3.3.3">𝑣</ci></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑥</ci></vector></apply><apply id="S3.E4.m1.5.5.5.cmml" xref="S3.E4.m1.5.5.5"><times id="S3.E4.m1.5.5.5.1.cmml" xref="S3.E4.m1.5.5.5.1"></times><ci id="S3.E4.m1.5.5.5.2a.cmml" xref="S3.E4.m1.5.5.5.2"><mtext id="S3.E4.m1.5.5.5.2.cmml" xref="S3.E4.m1.5.5.5.2">softmax</mtext></ci><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.5.5.5.3.2"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.5.5.5.3.2"></divide><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><times id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3">𝑥</ci><apply id="S3.E4.m1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.4.1.cmml" xref="S3.E4.m1.1.1.1.4">superscript</csymbol><ci id="S3.E4.m1.1.1.1.4.2.cmml" xref="S3.E4.m1.1.1.1.4.2">𝑊</ci><ci id="S3.E4.m1.1.1.1.4.3.cmml" xref="S3.E4.m1.1.1.1.4.3">𝑞</ci></apply><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"></times><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><ci id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><root id="S3.E4.m1.1.1.3a.cmml" xref="S3.E4.m1.1.1.3"></root><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2">𝑑</ci><ci id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.E4.m1.5.5.5.4.cmml" xref="S3.E4.m1.5.5.5.4">𝑥</ci><apply id="S3.E4.m1.5.5.5.5.cmml" xref="S3.E4.m1.5.5.5.5"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.5.1.cmml" xref="S3.E4.m1.5.5.5.5">superscript</csymbol><ci id="S3.E4.m1.5.5.5.5.2.cmml" xref="S3.E4.m1.5.5.5.5.2">𝑊</ci><ci id="S3.E4.m1.5.5.5.5.3.cmml" xref="S3.E4.m1.5.5.5.5.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\text{Attention}(W^{q},W^{k},W^{v},x)=\text{softmax}\left(\frac{xW^{q}(xW^{k})^{T}}{\sqrt{d_{k}}}\right)xW^{v}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p2.6" class="ltx_p">Equation <a href="#S3.E4" title="In 3.1.2 Parameter Prioritization in Transformer ‣ 3.1 Foundation Model Scaling ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> characterizes the attention-head. Here, the input sequence <math id="S3.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="x\in\mathbb{R}^{l\times d}" display="inline"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><mrow id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS1.SSS2.p2.1.m1.1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p2.1.m1.1.1.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.3.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p2.1.m1.1.1.3.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.3.3.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p2.1.m1.1.1.3.3.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS2.p2.1.m1.1.1.3.3.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><apply id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1"><in id="S3.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.1"></in><ci id="S3.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.2">𝑥</ci><apply id="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3"><times id="S3.SS1.SSS2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.SSS2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3.2">𝑙</ci><ci id="S3.SS1.SSS2.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">x\in\mathbb{R}^{l\times d}</annotation></semantics></math> has a sequence length of <math id="S3.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><mi id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><ci id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">l</annotation></semantics></math> and an embedding size of <math id="S3.SS1.SSS2.p2.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.SSS2.p2.3.m3.1a"><mi id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.1b"><ci id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.1c">d</annotation></semantics></math>. The matrices <math id="S3.SS1.SSS2.p2.4.m4.1" class="ltx_Math" alttext="W^{q}\in\mathbb{R}^{d\times d_{k}}" display="inline"><semantics id="S3.SS1.SSS2.p2.4.m4.1a"><mrow id="S3.SS1.SSS2.p2.4.m4.1.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.cmml"><msup id="S3.SS1.SSS2.p2.4.m4.1.1.2" xref="S3.SS1.SSS2.p2.4.m4.1.1.2.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.1.1.2.2" xref="S3.SS1.SSS2.p2.4.m4.1.1.2.2.cmml">W</mi><mi id="S3.SS1.SSS2.p2.4.m4.1.1.2.3" xref="S3.SS1.SSS2.p2.4.m4.1.1.2.3.cmml">q</mi></msup><mo id="S3.SS1.SSS2.p2.4.m4.1.1.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p2.4.m4.1.1.3" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.1.1.3.2" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p2.4.m4.1.1.3.3" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.2" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.2" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.3" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m4.1b"><apply id="S3.SS1.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1"><in id="S3.SS1.SSS2.p2.4.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.1"></in><apply id="S3.SS1.SSS2.p2.4.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.2.2">𝑊</ci><ci id="S3.SS1.SSS2.p2.4.m4.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.2.3">𝑞</ci></apply><apply id="S3.SS1.SSS2.p2.4.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3"><times id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.2">𝑑</ci><apply id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m4.1c">W^{q}\in\mathbb{R}^{d\times d_{k}}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p2.5.m5.1" class="ltx_Math" alttext="W^{k}\in\mathbb{R}^{d\times d_{k}}" display="inline"><semantics id="S3.SS1.SSS2.p2.5.m5.1a"><mrow id="S3.SS1.SSS2.p2.5.m5.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.cmml"><msup id="S3.SS1.SSS2.p2.5.m5.1.1.2" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.1.1.2.2" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.2.cmml">W</mi><mi id="S3.SS1.SSS2.p2.5.m5.1.1.2.3" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.3.cmml">k</mi></msup><mo id="S3.SS1.SSS2.p2.5.m5.1.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p2.5.m5.1.1.3" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.1.1.3.2" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p2.5.m5.1.1.3.3" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.2" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.2" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.3" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m5.1b"><apply id="S3.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1"><in id="S3.SS1.SSS2.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.1"></in><apply id="S3.SS1.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m5.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS2.p2.5.m5.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.2">𝑊</ci><ci id="S3.SS1.SSS2.p2.5.m5.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.SSS2.p2.5.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3"><times id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.1"></times><ci id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.2">𝑑</ci><apply id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m5.1c">W^{k}\in\mathbb{R}^{d\times d_{k}}</annotation></semantics></math> represent the query and key weights, respectively, while <math id="S3.SS1.SSS2.p2.6.m6.1" class="ltx_Math" alttext="W^{v}\in\mathbb{R}^{d\times d_{v}}" display="inline"><semantics id="S3.SS1.SSS2.p2.6.m6.1a"><mrow id="S3.SS1.SSS2.p2.6.m6.1.1" xref="S3.SS1.SSS2.p2.6.m6.1.1.cmml"><msup id="S3.SS1.SSS2.p2.6.m6.1.1.2" xref="S3.SS1.SSS2.p2.6.m6.1.1.2.cmml"><mi id="S3.SS1.SSS2.p2.6.m6.1.1.2.2" xref="S3.SS1.SSS2.p2.6.m6.1.1.2.2.cmml">W</mi><mi id="S3.SS1.SSS2.p2.6.m6.1.1.2.3" xref="S3.SS1.SSS2.p2.6.m6.1.1.2.3.cmml">v</mi></msup><mo id="S3.SS1.SSS2.p2.6.m6.1.1.1" xref="S3.SS1.SSS2.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p2.6.m6.1.1.3" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.6.m6.1.1.3.2" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p2.6.m6.1.1.3.3" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.2" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.1" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.2" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.3" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.6.m6.1b"><apply id="S3.SS1.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1"><in id="S3.SS1.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.1"></in><apply id="S3.SS1.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS2.p2.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.2.2">𝑊</ci><ci id="S3.SS1.SSS2.p2.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.2.3">𝑣</ci></apply><apply id="S3.SS1.SSS2.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.6.m6.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p2.6.m6.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3"><times id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.1"></times><ci id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.2">𝑑</ci><apply id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.6.m6.1c">W^{v}\in\mathbb{R}^{d\times d_{v}}</annotation></semantics></math> stands for the value weights.</p>
</div>
<div id="S3.SS1.SSS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS2.p3.14" class="ltx_p"><span id="S3.SS1.SSS2.p3.14.1" class="ltx_text ltx_font_bold">Theorem 1</span>: Given matrices <math id="S3.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="S3.SS1.SSS2.p3.1.m1.1a"><msup id="S3.SS1.SSS2.p3.1.m1.1.1" xref="S3.SS1.SSS2.p3.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p3.1.m1.1.1.2" xref="S3.SS1.SSS2.p3.1.m1.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p3.1.m1.1.1.3" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.1.m1.1b"><apply id="S3.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.1.m1.1c">W^{q}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p3.2.m2.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="S3.SS1.SSS2.p3.2.m2.1a"><msup id="S3.SS1.SSS2.p3.2.m2.1.1" xref="S3.SS1.SSS2.p3.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p3.2.m2.1.1.2" xref="S3.SS1.SSS2.p3.2.m2.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p3.2.m2.1.1.3" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.2.m2.1b"><apply id="S3.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.2.m2.1c">W^{k}</annotation></semantics></math> of dimensions <math id="S3.SS1.SSS2.p3.3.m3.1" class="ltx_Math" alttext="d\times d_{k}" display="inline"><semantics id="S3.SS1.SSS2.p3.3.m3.1a"><mrow id="S3.SS1.SSS2.p3.3.m3.1.1" xref="S3.SS1.SSS2.p3.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.p3.3.m3.1.1.2" xref="S3.SS1.SSS2.p3.3.m3.1.1.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.3.m3.1.1.1" xref="S3.SS1.SSS2.p3.3.m3.1.1.1.cmml">×</mo><msub id="S3.SS1.SSS2.p3.3.m3.1.1.3" xref="S3.SS1.SSS2.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.SSS2.p3.3.m3.1.1.3.2" xref="S3.SS1.SSS2.p3.3.m3.1.1.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p3.3.m3.1.1.3.3" xref="S3.SS1.SSS2.p3.3.m3.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.3.m3.1b"><apply id="S3.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1"><times id="S3.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1.1"></times><ci id="S3.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1.2">𝑑</ci><apply id="S3.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.3.m3.1c">d\times d_{k}</annotation></semantics></math> and an input <math id="S3.SS1.SSS2.p3.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.SSS2.p3.4.m4.1a"><mi id="S3.SS1.SSS2.p3.4.m4.1.1" xref="S3.SS1.SSS2.p3.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.4.m4.1b"><ci id="S3.SS1.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.4.m4.1c">x</annotation></semantics></math> of size <math id="S3.SS1.SSS2.p3.5.m5.1" class="ltx_Math" alttext="l\times d" display="inline"><semantics id="S3.SS1.SSS2.p3.5.m5.1a"><mrow id="S3.SS1.SSS2.p3.5.m5.1.1" xref="S3.SS1.SSS2.p3.5.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p3.5.m5.1.1.2" xref="S3.SS1.SSS2.p3.5.m5.1.1.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.5.m5.1.1.1" xref="S3.SS1.SSS2.p3.5.m5.1.1.1.cmml">×</mo><mi id="S3.SS1.SSS2.p3.5.m5.1.1.3" xref="S3.SS1.SSS2.p3.5.m5.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.5.m5.1b"><apply id="S3.SS1.SSS2.p3.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p3.5.m5.1.1"><times id="S3.SS1.SSS2.p3.5.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p3.5.m5.1.1.1"></times><ci id="S3.SS1.SSS2.p3.5.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p3.5.m5.1.1.2">𝑙</ci><ci id="S3.SS1.SSS2.p3.5.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p3.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.5.m5.1c">l\times d</annotation></semantics></math>, if we uniformly apply a permutation <math id="S3.SS1.SSS2.p3.6.m6.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.SS1.SSS2.p3.6.m6.1a"><mi id="S3.SS1.SSS2.p3.6.m6.1.1" xref="S3.SS1.SSS2.p3.6.m6.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.6.m6.1b"><ci id="S3.SS1.SSS2.p3.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p3.6.m6.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.6.m6.1c">\pi</annotation></semantics></math> to the columns of both <math id="S3.SS1.SSS2.p3.7.m7.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="S3.SS1.SSS2.p3.7.m7.1a"><msup id="S3.SS1.SSS2.p3.7.m7.1.1" xref="S3.SS1.SSS2.p3.7.m7.1.1.cmml"><mi id="S3.SS1.SSS2.p3.7.m7.1.1.2" xref="S3.SS1.SSS2.p3.7.m7.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p3.7.m7.1.1.3" xref="S3.SS1.SSS2.p3.7.m7.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.7.m7.1b"><apply id="S3.SS1.SSS2.p3.7.m7.1.1.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.7.m7.1.1.1.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.7.m7.1.1.2.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p3.7.m7.1.1.3.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.7.m7.1c">W^{q}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p3.8.m8.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="S3.SS1.SSS2.p3.8.m8.1a"><msup id="S3.SS1.SSS2.p3.8.m8.1.1" xref="S3.SS1.SSS2.p3.8.m8.1.1.cmml"><mi id="S3.SS1.SSS2.p3.8.m8.1.1.2" xref="S3.SS1.SSS2.p3.8.m8.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p3.8.m8.1.1.3" xref="S3.SS1.SSS2.p3.8.m8.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.8.m8.1b"><apply id="S3.SS1.SSS2.p3.8.m8.1.1.cmml" xref="S3.SS1.SSS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.8.m8.1.1.1.cmml" xref="S3.SS1.SSS2.p3.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.8.m8.1.1.2.cmml" xref="S3.SS1.SSS2.p3.8.m8.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p3.8.m8.1.1.3.cmml" xref="S3.SS1.SSS2.p3.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.8.m8.1c">W^{k}</annotation></semantics></math> to obtain <math id="S3.SS1.SSS2.p3.9.m9.1" class="ltx_Math" alttext="W^{q^{\prime}}" display="inline"><semantics id="S3.SS1.SSS2.p3.9.m9.1a"><msup id="S3.SS1.SSS2.p3.9.m9.1.1" xref="S3.SS1.SSS2.p3.9.m9.1.1.cmml"><mi id="S3.SS1.SSS2.p3.9.m9.1.1.2" xref="S3.SS1.SSS2.p3.9.m9.1.1.2.cmml">W</mi><msup id="S3.SS1.SSS2.p3.9.m9.1.1.3" xref="S3.SS1.SSS2.p3.9.m9.1.1.3.cmml"><mi id="S3.SS1.SSS2.p3.9.m9.1.1.3.2" xref="S3.SS1.SSS2.p3.9.m9.1.1.3.2.cmml">q</mi><mo id="S3.SS1.SSS2.p3.9.m9.1.1.3.3" xref="S3.SS1.SSS2.p3.9.m9.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.9.m9.1b"><apply id="S3.SS1.SSS2.p3.9.m9.1.1.cmml" xref="S3.SS1.SSS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.9.m9.1.1.1.cmml" xref="S3.SS1.SSS2.p3.9.m9.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.9.m9.1.1.2.cmml" xref="S3.SS1.SSS2.p3.9.m9.1.1.2">𝑊</ci><apply id="S3.SS1.SSS2.p3.9.m9.1.1.3.cmml" xref="S3.SS1.SSS2.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.9.m9.1.1.3.1.cmml" xref="S3.SS1.SSS2.p3.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p3.9.m9.1.1.3.2.cmml" xref="S3.SS1.SSS2.p3.9.m9.1.1.3.2">𝑞</ci><ci id="S3.SS1.SSS2.p3.9.m9.1.1.3.3.cmml" xref="S3.SS1.SSS2.p3.9.m9.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.9.m9.1c">W^{q^{\prime}}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p3.10.m10.1" class="ltx_Math" alttext="W^{k^{\prime}}" display="inline"><semantics id="S3.SS1.SSS2.p3.10.m10.1a"><msup id="S3.SS1.SSS2.p3.10.m10.1.1" xref="S3.SS1.SSS2.p3.10.m10.1.1.cmml"><mi id="S3.SS1.SSS2.p3.10.m10.1.1.2" xref="S3.SS1.SSS2.p3.10.m10.1.1.2.cmml">W</mi><msup id="S3.SS1.SSS2.p3.10.m10.1.1.3" xref="S3.SS1.SSS2.p3.10.m10.1.1.3.cmml"><mi id="S3.SS1.SSS2.p3.10.m10.1.1.3.2" xref="S3.SS1.SSS2.p3.10.m10.1.1.3.2.cmml">k</mi><mo id="S3.SS1.SSS2.p3.10.m10.1.1.3.3" xref="S3.SS1.SSS2.p3.10.m10.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.10.m10.1b"><apply id="S3.SS1.SSS2.p3.10.m10.1.1.cmml" xref="S3.SS1.SSS2.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.10.m10.1.1.1.cmml" xref="S3.SS1.SSS2.p3.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.10.m10.1.1.2.cmml" xref="S3.SS1.SSS2.p3.10.m10.1.1.2">𝑊</ci><apply id="S3.SS1.SSS2.p3.10.m10.1.1.3.cmml" xref="S3.SS1.SSS2.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.10.m10.1.1.3.1.cmml" xref="S3.SS1.SSS2.p3.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p3.10.m10.1.1.3.2.cmml" xref="S3.SS1.SSS2.p3.10.m10.1.1.3.2">𝑘</ci><ci id="S3.SS1.SSS2.p3.10.m10.1.1.3.3.cmml" xref="S3.SS1.SSS2.p3.10.m10.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.10.m10.1c">W^{k^{\prime}}</annotation></semantics></math> respectively, the subsequent dot-product attention scores determined using <math id="S3.SS1.SSS2.p3.11.m11.1" class="ltx_Math" alttext="W^{q^{\prime}}" display="inline"><semantics id="S3.SS1.SSS2.p3.11.m11.1a"><msup id="S3.SS1.SSS2.p3.11.m11.1.1" xref="S3.SS1.SSS2.p3.11.m11.1.1.cmml"><mi id="S3.SS1.SSS2.p3.11.m11.1.1.2" xref="S3.SS1.SSS2.p3.11.m11.1.1.2.cmml">W</mi><msup id="S3.SS1.SSS2.p3.11.m11.1.1.3" xref="S3.SS1.SSS2.p3.11.m11.1.1.3.cmml"><mi id="S3.SS1.SSS2.p3.11.m11.1.1.3.2" xref="S3.SS1.SSS2.p3.11.m11.1.1.3.2.cmml">q</mi><mo id="S3.SS1.SSS2.p3.11.m11.1.1.3.3" xref="S3.SS1.SSS2.p3.11.m11.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.11.m11.1b"><apply id="S3.SS1.SSS2.p3.11.m11.1.1.cmml" xref="S3.SS1.SSS2.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.11.m11.1.1.1.cmml" xref="S3.SS1.SSS2.p3.11.m11.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.11.m11.1.1.2.cmml" xref="S3.SS1.SSS2.p3.11.m11.1.1.2">𝑊</ci><apply id="S3.SS1.SSS2.p3.11.m11.1.1.3.cmml" xref="S3.SS1.SSS2.p3.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.11.m11.1.1.3.1.cmml" xref="S3.SS1.SSS2.p3.11.m11.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p3.11.m11.1.1.3.2.cmml" xref="S3.SS1.SSS2.p3.11.m11.1.1.3.2">𝑞</ci><ci id="S3.SS1.SSS2.p3.11.m11.1.1.3.3.cmml" xref="S3.SS1.SSS2.p3.11.m11.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.11.m11.1c">W^{q^{\prime}}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p3.12.m12.1" class="ltx_Math" alttext="W^{k^{\prime}}" display="inline"><semantics id="S3.SS1.SSS2.p3.12.m12.1a"><msup id="S3.SS1.SSS2.p3.12.m12.1.1" xref="S3.SS1.SSS2.p3.12.m12.1.1.cmml"><mi id="S3.SS1.SSS2.p3.12.m12.1.1.2" xref="S3.SS1.SSS2.p3.12.m12.1.1.2.cmml">W</mi><msup id="S3.SS1.SSS2.p3.12.m12.1.1.3" xref="S3.SS1.SSS2.p3.12.m12.1.1.3.cmml"><mi id="S3.SS1.SSS2.p3.12.m12.1.1.3.2" xref="S3.SS1.SSS2.p3.12.m12.1.1.3.2.cmml">k</mi><mo id="S3.SS1.SSS2.p3.12.m12.1.1.3.3" xref="S3.SS1.SSS2.p3.12.m12.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.12.m12.1b"><apply id="S3.SS1.SSS2.p3.12.m12.1.1.cmml" xref="S3.SS1.SSS2.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.12.m12.1.1.1.cmml" xref="S3.SS1.SSS2.p3.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.12.m12.1.1.2.cmml" xref="S3.SS1.SSS2.p3.12.m12.1.1.2">𝑊</ci><apply id="S3.SS1.SSS2.p3.12.m12.1.1.3.cmml" xref="S3.SS1.SSS2.p3.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.12.m12.1.1.3.1.cmml" xref="S3.SS1.SSS2.p3.12.m12.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p3.12.m12.1.1.3.2.cmml" xref="S3.SS1.SSS2.p3.12.m12.1.1.3.2">𝑘</ci><ci id="S3.SS1.SSS2.p3.12.m12.1.1.3.3.cmml" xref="S3.SS1.SSS2.p3.12.m12.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.12.m12.1c">W^{k^{\prime}}</annotation></semantics></math> will match those derived using the original <math id="S3.SS1.SSS2.p3.13.m13.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="S3.SS1.SSS2.p3.13.m13.1a"><msup id="S3.SS1.SSS2.p3.13.m13.1.1" xref="S3.SS1.SSS2.p3.13.m13.1.1.cmml"><mi id="S3.SS1.SSS2.p3.13.m13.1.1.2" xref="S3.SS1.SSS2.p3.13.m13.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p3.13.m13.1.1.3" xref="S3.SS1.SSS2.p3.13.m13.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.13.m13.1b"><apply id="S3.SS1.SSS2.p3.13.m13.1.1.cmml" xref="S3.SS1.SSS2.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.13.m13.1.1.1.cmml" xref="S3.SS1.SSS2.p3.13.m13.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.13.m13.1.1.2.cmml" xref="S3.SS1.SSS2.p3.13.m13.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p3.13.m13.1.1.3.cmml" xref="S3.SS1.SSS2.p3.13.m13.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.13.m13.1c">W^{q}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p3.14.m14.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="S3.SS1.SSS2.p3.14.m14.1a"><msup id="S3.SS1.SSS2.p3.14.m14.1.1" xref="S3.SS1.SSS2.p3.14.m14.1.1.cmml"><mi id="S3.SS1.SSS2.p3.14.m14.1.1.2" xref="S3.SS1.SSS2.p3.14.m14.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p3.14.m14.1.1.3" xref="S3.SS1.SSS2.p3.14.m14.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.14.m14.1b"><apply id="S3.SS1.SSS2.p3.14.m14.1.1.cmml" xref="S3.SS1.SSS2.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.14.m14.1.1.1.cmml" xref="S3.SS1.SSS2.p3.14.m14.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p3.14.m14.1.1.2.cmml" xref="S3.SS1.SSS2.p3.14.m14.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p3.14.m14.1.1.3.cmml" xref="S3.SS1.SSS2.p3.14.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.14.m14.1c">W^{k}</annotation></semantics></math>. (A detailed proof is provided in Appendix <a href="#A1.SS1" title="A.1 Proof for Theorem 1 ‣ Appendix A Appendix ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>).</p>
</div>
<div id="S3.SS1.SSS2.p4" class="ltx_para ltx_noindent">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.3" class="ltx_Math" alttext="\text{Salience}(c)=\frac{\text{Salience}(w^{q}_{c})+\text{Salience}(w^{k}_{c})}{2}" display="block"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.4" xref="S3.E5.m1.3.4.cmml"><mrow id="S3.E5.m1.3.4.2" xref="S3.E5.m1.3.4.2.cmml"><mtext id="S3.E5.m1.3.4.2.2" xref="S3.E5.m1.3.4.2.2a.cmml">Salience</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.4.2.1" xref="S3.E5.m1.3.4.2.1.cmml">​</mo><mrow id="S3.E5.m1.3.4.2.3.2" xref="S3.E5.m1.3.4.2.cmml"><mo stretchy="false" id="S3.E5.m1.3.4.2.3.2.1" xref="S3.E5.m1.3.4.2.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">c</mi><mo stretchy="false" id="S3.E5.m1.3.4.2.3.2.2" xref="S3.E5.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.4.1" xref="S3.E5.m1.3.4.1.cmml">=</mo><mfrac id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mtext id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3a.cmml">Salience</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.cmml">c</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3.cmml">q</mi></msubsup><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml">+</mo><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml"><mtext id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3a.cmml">Salience</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.2.2.1.1" xref="S3.E5.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.2.1.1.2" xref="S3.E5.m1.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.2.2.2.2.1.1.1" xref="S3.E5.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.1.1.2.2" xref="S3.E5.m1.2.2.2.2.1.1.1.2.2.cmml">w</mi><mi id="S3.E5.m1.2.2.2.2.1.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.1.3.cmml">c</mi><mi id="S3.E5.m1.2.2.2.2.1.1.1.2.3" xref="S3.E5.m1.2.2.2.2.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E5.m1.2.2.2.2.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mn id="S3.E5.m1.2.2.4" xref="S3.E5.m1.2.2.4.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.4.cmml" xref="S3.E5.m1.3.4"><eq id="S3.E5.m1.3.4.1.cmml" xref="S3.E5.m1.3.4.1"></eq><apply id="S3.E5.m1.3.4.2.cmml" xref="S3.E5.m1.3.4.2"><times id="S3.E5.m1.3.4.2.1.cmml" xref="S3.E5.m1.3.4.2.1"></times><ci id="S3.E5.m1.3.4.2.2a.cmml" xref="S3.E5.m1.3.4.2.2"><mtext id="S3.E5.m1.3.4.2.2.cmml" xref="S3.E5.m1.3.4.2.2">Salience</mtext></ci><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑐</ci></apply><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><divide id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2"></divide><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><plus id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.3"></plus><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.3"><mtext id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3">Salience</mtext></ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3">𝑞</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><times id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"></times><ci id="S3.E5.m1.2.2.2.2.3a.cmml" xref="S3.E5.m1.2.2.2.2.3"><mtext id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3">Salience</mtext></ci><apply id="S3.E5.m1.2.2.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S3.E5.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.2.2">𝑤</ci><ci id="S3.E5.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E5.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.3">𝑐</ci></apply></apply></apply><cn type="integer" id="S3.E5.m1.2.2.4.cmml" xref="S3.E5.m1.2.2.4">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\text{Salience}(c)=\frac{\text{Salience}(w^{q}_{c})+\text{Salience}(w^{k}_{c})}{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.SSS2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS2.p5.5" class="ltx_p">To retain the inherent attention characteristics of FMs, we prioritize <math id="S3.SS1.SSS2.p5.1.m1.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="S3.SS1.SSS2.p5.1.m1.1a"><msup id="S3.SS1.SSS2.p5.1.m1.1.1" xref="S3.SS1.SSS2.p5.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p5.1.m1.1.1.2" xref="S3.SS1.SSS2.p5.1.m1.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p5.1.m1.1.1.3" xref="S3.SS1.SSS2.p5.1.m1.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.1.m1.1b"><apply id="S3.SS1.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p5.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p5.1.m1.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p5.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p5.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.1.m1.1c">W^{q}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p5.2.m2.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="S3.SS1.SSS2.p5.2.m2.1a"><msup id="S3.SS1.SSS2.p5.2.m2.1.1" xref="S3.SS1.SSS2.p5.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p5.2.m2.1.1.2" xref="S3.SS1.SSS2.p5.2.m2.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p5.2.m2.1.1.3" xref="S3.SS1.SSS2.p5.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.2.m2.1b"><apply id="S3.SS1.SSS2.p5.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p5.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p5.2.m2.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p5.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p5.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.2.m2.1c">W^{k}</annotation></semantics></math> within an attention head by employing the same ranked permutation. The salience score, defined in Equation <a href="#S3.E5" title="In 3.1.2 Parameter Prioritization in Transformer ‣ 3.1 Foundation Model Scaling ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, calculates the average norm of the query and key matrices for each channel index <math id="S3.SS1.SSS2.p5.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.SSS2.p5.3.m3.1a"><mi id="S3.SS1.SSS2.p5.3.m3.1.1" xref="S3.SS1.SSS2.p5.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.3.m3.1b"><ci id="S3.SS1.SSS2.p5.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p5.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.3.m3.1c">c</annotation></semantics></math>. A consistent salience-based rank is concurrently imposed on both <math id="S3.SS1.SSS2.p5.4.m4.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="S3.SS1.SSS2.p5.4.m4.1a"><msup id="S3.SS1.SSS2.p5.4.m4.1.1" xref="S3.SS1.SSS2.p5.4.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p5.4.m4.1.1.2" xref="S3.SS1.SSS2.p5.4.m4.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p5.4.m4.1.1.3" xref="S3.SS1.SSS2.p5.4.m4.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.4.m4.1b"><apply id="S3.SS1.SSS2.p5.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.4.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p5.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p5.4.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p5.4.m4.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p5.4.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p5.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.4.m4.1c">W^{q}</annotation></semantics></math> and <math id="S3.SS1.SSS2.p5.5.m5.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="S3.SS1.SSS2.p5.5.m5.1a"><msup id="S3.SS1.SSS2.p5.5.m5.1.1" xref="S3.SS1.SSS2.p5.5.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p5.5.m5.1.1.2" xref="S3.SS1.SSS2.p5.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS2.p5.5.m5.1.1.3" xref="S3.SS1.SSS2.p5.5.m5.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.5.m5.1b"><apply id="S3.SS1.SSS2.p5.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.5.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p5.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p5.5.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p5.5.m5.1.1.2">𝑊</ci><ci id="S3.SS1.SSS2.p5.5.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p5.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.5.m5.1c">W^{k}</annotation></semantics></math>. As validated by <span id="S3.SS1.SSS2.p5.5.1" class="ltx_text ltx_font_bold">Theorem 1</span>, this ensures that post-prioritization, the derived dot-product attention scores will remain identical with the original attention head of the FMs.</p>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>High-performance Sub-Model extraction</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS3.p1.5" class="ltx_p">Given a resource constraint, denoted as <math id="S3.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.SSS3.p1.1.m1.1a"><mi id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.1b"><ci id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.1c">\tau</annotation></semantics></math>, and a FM <math id="S3.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{F(W)}" display="inline"><semantics id="S3.SS1.SSS3.p1.2.m2.1a"><mrow id="S3.SS1.SSS3.p1.2.m2.1.2" xref="S3.SS1.SSS3.p1.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.2.m2.1.2.2" xref="S3.SS1.SSS3.p1.2.m2.1.2.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p1.2.m2.1.2.1" xref="S3.SS1.SSS3.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS1.SSS3.p1.2.m2.1.2.3.2" xref="S3.SS1.SSS3.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p1.2.m2.1.2.3.2.1" xref="S3.SS1.SSS3.p1.2.m2.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.2.m2.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.cmml">𝒲</mi><mo stretchy="false" id="S3.SS1.SSS3.p1.2.m2.1.2.3.2.2" xref="S3.SS1.SSS3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m2.1b"><apply id="S3.SS1.SSS3.p1.2.m2.1.2.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.2"><times id="S3.SS1.SSS3.p1.2.m2.1.2.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.2.1"></times><ci id="S3.SS1.SSS3.p1.2.m2.1.2.2.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.2.2">ℱ</ci><ci id="S3.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m2.1c">\mathcal{F(W)}</annotation></semantics></math> with weights <math id="S3.SS1.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS1.SSS3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.3.m3.1.1" xref="S3.SS1.SSS3.p1.3.m3.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.3.m3.1b"><ci id="S3.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.3.m3.1c">\mathcal{W}</annotation></semantics></math>, the objective of high-performance sub-model extraction is to derive a sub-model from <math id="S3.SS1.SSS3.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{F(W)}" display="inline"><semantics id="S3.SS1.SSS3.p1.4.m4.1a"><mrow id="S3.SS1.SSS3.p1.4.m4.1.2" xref="S3.SS1.SSS3.p1.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.4.m4.1.2.2" xref="S3.SS1.SSS3.p1.4.m4.1.2.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p1.4.m4.1.2.1" xref="S3.SS1.SSS3.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS1.SSS3.p1.4.m4.1.2.3.2" xref="S3.SS1.SSS3.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p1.4.m4.1.2.3.2.1" xref="S3.SS1.SSS3.p1.4.m4.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.4.m4.1.1" xref="S3.SS1.SSS3.p1.4.m4.1.1.cmml">𝒲</mi><mo stretchy="false" id="S3.SS1.SSS3.p1.4.m4.1.2.3.2.2" xref="S3.SS1.SSS3.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.4.m4.1b"><apply id="S3.SS1.SSS3.p1.4.m4.1.2.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.2"><times id="S3.SS1.SSS3.p1.4.m4.1.2.1.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.2.1"></times><ci id="S3.SS1.SSS3.p1.4.m4.1.2.2.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.2.2">ℱ</ci><ci id="S3.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.1">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.4.m4.1c">\mathcal{F(W)}</annotation></semantics></math> that comprises salient parameters and adheres to constraints <math id="S3.SS1.SSS3.p1.5.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.SSS3.p1.5.m5.1a"><mi id="S3.SS1.SSS3.p1.5.m5.1.1" xref="S3.SS1.SSS3.p1.5.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.5.m5.1b"><ci id="S3.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.5.m5.1c">\tau</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS3.p2.8" class="ltx_p">Leveraging the salient parameter prioritization, we can easily extract high-performance sub-networks using weight matrix slicing. We represent a sub-model, <math id="S3.SS1.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{F}(\mathcal{W}_{c_{\tau}})" display="inline"><semantics id="S3.SS1.SSS3.p2.1.m1.1a"><mrow id="S3.SS1.SSS3.p2.1.m1.1.1" xref="S3.SS1.SSS3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p2.1.m1.1.1.3" xref="S3.SS1.SSS3.p2.1.m1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.1.m1.1.1.2" xref="S3.SS1.SSS3.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS3.p2.1.m1.1.1.1.1" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.2" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.cmml">𝒲</mi><msub id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.2.cmml">c</mi><mi id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.3.cmml">τ</mi></msub></msub><mo stretchy="false" id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.3" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.1.m1.1b"><apply id="S3.SS1.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1"><times id="S3.SS1.SSS3.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.2"></times><ci id="S3.SS1.SSS3.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.3">ℱ</ci><apply id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.2">𝒲</ci><apply id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.1.m1.1c">\mathcal{F}(\mathcal{W}_{c_{\tau}})</annotation></semantics></math>, as a network configuration <math id="S3.SS1.SSS3.p2.2.m2.1" class="ltx_Math" alttext="c_{\tau}\in\mathbb{R}^{n}" display="inline"><semantics id="S3.SS1.SSS3.p2.2.m2.1a"><mrow id="S3.SS1.SSS3.p2.2.m2.1.1" xref="S3.SS1.SSS3.p2.2.m2.1.1.cmml"><msub id="S3.SS1.SSS3.p2.2.m2.1.1.2" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.cmml"><mi id="S3.SS1.SSS3.p2.2.m2.1.1.2.2" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.2.cmml">c</mi><mi id="S3.SS1.SSS3.p2.2.m2.1.1.2.3" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.3.cmml">τ</mi></msub><mo id="S3.SS1.SSS3.p2.2.m2.1.1.1" xref="S3.SS1.SSS3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p2.2.m2.1.1.3" xref="S3.SS1.SSS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.2.m2.1.1.3.2" xref="S3.SS1.SSS3.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.SSS3.p2.2.m2.1.1.3.3" xref="S3.SS1.SSS3.p2.2.m2.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.2.m2.1b"><apply id="S3.SS1.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1"><in id="S3.SS1.SSS3.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.1"></in><apply id="S3.SS1.SSS3.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.2">𝑐</ci><ci id="S3.SS1.SSS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.3">𝜏</ci></apply><apply id="S3.SS1.SSS3.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS1.SSS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.2.m2.1c">c_{\tau}\in\mathbb{R}^{n}</annotation></semantics></math> satisfying constraint <math id="S3.SS1.SSS3.p2.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.SSS3.p2.3.m3.1a"><mi id="S3.SS1.SSS3.p2.3.m3.1.1" xref="S3.SS1.SSS3.p2.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.3.m3.1b"><ci id="S3.SS1.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.3.m3.1c">\tau</annotation></semantics></math>. The <math id="S3.SS1.SSS3.p2.4.m4.1" class="ltx_Math" alttext="c_{\tau}" display="inline"><semantics id="S3.SS1.SSS3.p2.4.m4.1a"><msub id="S3.SS1.SSS3.p2.4.m4.1.1" xref="S3.SS1.SSS3.p2.4.m4.1.1.cmml"><mi id="S3.SS1.SSS3.p2.4.m4.1.1.2" xref="S3.SS1.SSS3.p2.4.m4.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS3.p2.4.m4.1.1.3" xref="S3.SS1.SSS3.p2.4.m4.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.4.m4.1b"><apply id="S3.SS1.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.4.m4.1.1.1.cmml" xref="S3.SS1.SSS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.4.m4.1.1.2.cmml" xref="S3.SS1.SSS3.p2.4.m4.1.1.2">𝑐</ci><ci id="S3.SS1.SSS3.p2.4.m4.1.1.3.cmml" xref="S3.SS1.SSS3.p2.4.m4.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.4.m4.1c">c_{\tau}</annotation></semantics></math> is a list specifying the layer width for each hidden layer of the FM.
To sample the target <math id="S3.SS1.SSS3.p2.5.m5.1" class="ltx_Math" alttext="c_{\tau}" display="inline"><semantics id="S3.SS1.SSS3.p2.5.m5.1a"><msub id="S3.SS1.SSS3.p2.5.m5.1.1" xref="S3.SS1.SSS3.p2.5.m5.1.1.cmml"><mi id="S3.SS1.SSS3.p2.5.m5.1.1.2" xref="S3.SS1.SSS3.p2.5.m5.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS3.p2.5.m5.1.1.3" xref="S3.SS1.SSS3.p2.5.m5.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.5.m5.1b"><apply id="S3.SS1.SSS3.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.5.m5.1.1.2.cmml" xref="S3.SS1.SSS3.p2.5.m5.1.1.2">𝑐</ci><ci id="S3.SS1.SSS3.p2.5.m5.1.1.3.cmml" xref="S3.SS1.SSS3.p2.5.m5.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.5.m5.1c">c_{\tau}</annotation></semantics></math>, the sampling space is denoted by <math id="S3.SS1.SSS3.p2.6.m6.3" class="ltx_Math" alttext="\mathcal{S}=[s_{1},...,s_{n}]" display="inline"><semantics id="S3.SS1.SSS3.p2.6.m6.3a"><mrow id="S3.SS1.SSS3.p2.6.m6.3.3" xref="S3.SS1.SSS3.p2.6.m6.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p2.6.m6.3.3.4" xref="S3.SS1.SSS3.p2.6.m6.3.3.4.cmml">𝒮</mi><mo id="S3.SS1.SSS3.p2.6.m6.3.3.3" xref="S3.SS1.SSS3.p2.6.m6.3.3.3.cmml">=</mo><mrow id="S3.SS1.SSS3.p2.6.m6.3.3.2.2" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.3" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.3.cmml">[</mo><msub id="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1" xref="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.2" xref="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.3" xref="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.4" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS3.p2.6.m6.1.1" xref="S3.SS1.SSS3.p2.6.m6.1.1.cmml">…</mi><mo id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.5" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.3.cmml">,</mo><msub id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.2" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.2.cmml">s</mi><mi id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.3" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.6" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.6.m6.3b"><apply id="S3.SS1.SSS3.p2.6.m6.3.3.cmml" xref="S3.SS1.SSS3.p2.6.m6.3.3"><eq id="S3.SS1.SSS3.p2.6.m6.3.3.3.cmml" xref="S3.SS1.SSS3.p2.6.m6.3.3.3"></eq><ci id="S3.SS1.SSS3.p2.6.m6.3.3.4.cmml" xref="S3.SS1.SSS3.p2.6.m6.3.3.4">𝒮</ci><list id="S3.SS1.SSS3.p2.6.m6.3.3.2.3.cmml" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.2"><apply id="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.2">𝑠</ci><cn type="integer" id="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.6.m6.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.SSS3.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS3.p2.6.m6.1.1">…</ci><apply id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.cmml" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.2">𝑠</ci><ci id="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.6.m6.3.3.2.2.2.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.6.m6.3c">\mathcal{S}=[s_{1},...,s_{n}]</annotation></semantics></math> where <math id="S3.SS1.SSS3.p2.7.m7.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="S3.SS1.SSS3.p2.7.m7.1a"><msub id="S3.SS1.SSS3.p2.7.m7.1.1" xref="S3.SS1.SSS3.p2.7.m7.1.1.cmml"><mi id="S3.SS1.SSS3.p2.7.m7.1.1.2" xref="S3.SS1.SSS3.p2.7.m7.1.1.2.cmml">s</mi><mi id="S3.SS1.SSS3.p2.7.m7.1.1.3" xref="S3.SS1.SSS3.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.7.m7.1b"><apply id="S3.SS1.SSS3.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.7.m7.1.1.1.cmml" xref="S3.SS1.SSS3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.7.m7.1.1.2.cmml" xref="S3.SS1.SSS3.p2.7.m7.1.1.2">𝑠</ci><ci id="S3.SS1.SSS3.p2.7.m7.1.1.3.cmml" xref="S3.SS1.SSS3.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.7.m7.1c">s_{i}</annotation></semantics></math> denotes the width (number of channels) of the <math id="S3.SS1.SSS3.p2.8.m8.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS1.SSS3.p2.8.m8.1a"><msup id="S3.SS1.SSS3.p2.8.m8.1.1" xref="S3.SS1.SSS3.p2.8.m8.1.1.cmml"><mi id="S3.SS1.SSS3.p2.8.m8.1.1.2" xref="S3.SS1.SSS3.p2.8.m8.1.1.2.cmml">i</mi><mrow id="S3.SS1.SSS3.p2.8.m8.1.1.3" xref="S3.SS1.SSS3.p2.8.m8.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.8.m8.1.1.3.2" xref="S3.SS1.SSS3.p2.8.m8.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.8.m8.1.1.3.1" xref="S3.SS1.SSS3.p2.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS3.p2.8.m8.1.1.3.3" xref="S3.SS1.SSS3.p2.8.m8.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.8.m8.1b"><apply id="S3.SS1.SSS3.p2.8.m8.1.1.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.8.m8.1.1.1.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.SSS3.p2.8.m8.1.1.2.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1.2">𝑖</ci><apply id="S3.SS1.SSS3.p2.8.m8.1.1.3.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1.3"><times id="S3.SS1.SSS3.p2.8.m8.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1.3.1"></times><ci id="S3.SS1.SSS3.p2.8.m8.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS3.p2.8.m8.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.8.m8.1c">i^{th}</annotation></semantics></math> hidden layer.</p>
</div>
<div id="S3.SS1.SSS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS3.p3.4" class="ltx_p">For a sampled network configuration <math id="S3.SS1.SSS3.p3.1.m1.1" class="ltx_Math" alttext="c_{\tau}" display="inline"><semantics id="S3.SS1.SSS3.p3.1.m1.1a"><msub id="S3.SS1.SSS3.p3.1.m1.1.1" xref="S3.SS1.SSS3.p3.1.m1.1.1.cmml"><mi id="S3.SS1.SSS3.p3.1.m1.1.1.2" xref="S3.SS1.SSS3.p3.1.m1.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS3.p3.1.m1.1.1.3" xref="S3.SS1.SSS3.p3.1.m1.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.1.m1.1b"><apply id="S3.SS1.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1.2">𝑐</ci><ci id="S3.SS1.SSS3.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.1.m1.1c">c_{\tau}</annotation></semantics></math>, we evaluate the size of the sub-model <math id="S3.SS1.SSS3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{F}(\mathcal{W}_{c_{\tau}})" display="inline"><semantics id="S3.SS1.SSS3.p3.2.m2.1a"><mrow id="S3.SS1.SSS3.p3.2.m2.1.1" xref="S3.SS1.SSS3.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.2.m2.1.1.3" xref="S3.SS1.SSS3.p3.2.m2.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.2.m2.1.1.2" xref="S3.SS1.SSS3.p3.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS3.p3.2.m2.1.1.1.1" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.2" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.2.cmml">𝒲</mi><msub id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.2" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.2.cmml">c</mi><mi id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.3" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.3.cmml">τ</mi></msub></msub><mo stretchy="false" id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.3" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.2.m2.1b"><apply id="S3.SS1.SSS3.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1"><times id="S3.SS1.SSS3.p3.2.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.2"></times><ci id="S3.SS1.SSS3.p3.2.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.3">ℱ</ci><apply id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.2">𝒲</ci><apply id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.2.m2.1c">\mathcal{F}(\mathcal{W}_{c_{\tau}})</annotation></semantics></math> in terms of measurable metrics (e.g., number of parameters). If it aligns the constraints <math id="S3.SS1.SSS3.p3.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.SSS3.p3.3.m3.1a"><mi id="S3.SS1.SSS3.p3.3.m3.1.1" xref="S3.SS1.SSS3.p3.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.3.m3.1b"><ci id="S3.SS1.SSS3.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p3.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.3.m3.1c">\tau</annotation></semantics></math>, we extract <math id="S3.SS1.SSS3.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{F}(\mathcal{W}_{c_{\tau}})" display="inline"><semantics id="S3.SS1.SSS3.p3.4.m4.1a"><mrow id="S3.SS1.SSS3.p3.4.m4.1.1" xref="S3.SS1.SSS3.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.4.m4.1.1.3" xref="S3.SS1.SSS3.p3.4.m4.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.4.m4.1.1.2" xref="S3.SS1.SSS3.p3.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS3.p3.4.m4.1.1.1.1" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.2" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.2" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.2.cmml">𝒲</mi><msub id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.2" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.2.cmml">c</mi><mi id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.3" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.3.cmml">τ</mi></msub></msub><mo stretchy="false" id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.3" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.4.m4.1b"><apply id="S3.SS1.SSS3.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1"><times id="S3.SS1.SSS3.p3.4.m4.1.1.2.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.2"></times><ci id="S3.SS1.SSS3.p3.4.m4.1.1.3.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.3">ℱ</ci><apply id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.2">𝒲</ci><apply id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS3.p3.4.m4.1.1.1.1.1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.4.m4.1c">\mathcal{F}(\mathcal{W}_{c_{\tau}})</annotation></semantics></math> using Equation <a href="#S3.E6" title="In 3.1.3 High-performance Sub-Model extraction ‣ 3.1 Foundation Model Scaling ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>:</p>
</div>
<div id="S3.SS1.SSS3.p4" class="ltx_para ltx_noindent">
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_math_unparsed" alttext="\mathcal{W}_{c_{\tau}}=\mathcal{W}[:c_{\tau}]=\{w_{i}[:c_{i}]|w_{i}\in\mathcal{W},c_{i}\in c_{\tau},\text{and }i=1,...,n\}" display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1b"><msub id="S3.E6.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.2">𝒲</mi><msub id="S3.E6.m1.1.1.3"><mi id="S3.E6.m1.1.1.3.2">c</mi><mi id="S3.E6.m1.1.1.3.3">τ</mi></msub></msub><mo id="S3.E6.m1.1.2">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.3">𝒲</mi><mrow id="S3.E6.m1.1.4"><mo stretchy="false" id="S3.E6.m1.1.4.1">[</mo><mo rspace="0.278em" id="S3.E6.m1.1.4.2">:</mo><msub id="S3.E6.m1.1.4.3"><mi id="S3.E6.m1.1.4.3.2">c</mi><mi id="S3.E6.m1.1.4.3.3">τ</mi></msub><mo stretchy="false" id="S3.E6.m1.1.4.4">]</mo></mrow><mo id="S3.E6.m1.1.5">=</mo><mrow id="S3.E6.m1.1.6"><mo stretchy="false" id="S3.E6.m1.1.6.1">{</mo><msub id="S3.E6.m1.1.6.2"><mi id="S3.E6.m1.1.6.2.2">w</mi><mi id="S3.E6.m1.1.6.2.3">i</mi></msub><mrow id="S3.E6.m1.1.6.3"><mo stretchy="false" id="S3.E6.m1.1.6.3.1">[</mo><mo rspace="0.278em" id="S3.E6.m1.1.6.3.2">:</mo><msub id="S3.E6.m1.1.6.3.3"><mi id="S3.E6.m1.1.6.3.3.2">c</mi><mi id="S3.E6.m1.1.6.3.3.3">i</mi></msub><mo stretchy="false" id="S3.E6.m1.1.6.3.4">]</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E6.m1.1.6.4">|</mo><msub id="S3.E6.m1.1.6.5"><mi id="S3.E6.m1.1.6.5.2">w</mi><mi id="S3.E6.m1.1.6.5.3">i</mi></msub><mo id="S3.E6.m1.1.6.6">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.6.7">𝒲</mi><mo id="S3.E6.m1.1.6.8">,</mo><msub id="S3.E6.m1.1.6.9"><mi id="S3.E6.m1.1.6.9.2">c</mi><mi id="S3.E6.m1.1.6.9.3">i</mi></msub><mo id="S3.E6.m1.1.6.10">∈</mo><msub id="S3.E6.m1.1.6.11"><mi id="S3.E6.m1.1.6.11.2">c</mi><mi id="S3.E6.m1.1.6.11.3">τ</mi></msub><mo id="S3.E6.m1.1.6.12">,</mo><mtext id="S3.E6.m1.1.6.13">and </mtext><mi id="S3.E6.m1.1.6.14">i</mi><mo id="S3.E6.m1.1.6.15">=</mo><mn id="S3.E6.m1.1.6.16">1</mn><mo id="S3.E6.m1.1.6.17">,</mo><mi mathvariant="normal" id="S3.E6.m1.1.6.18">…</mi><mo id="S3.E6.m1.1.6.19">,</mo><mi id="S3.E6.m1.1.6.20">n</mi><mo stretchy="false" id="S3.E6.m1.1.6.21">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathcal{W}_{c_{\tau}}=\mathcal{W}[:c_{\tau}]=\{w_{i}[:c_{i}]|w_{i}\in\mathcal{W},c_{i}\in c_{\tau},\text{and }i=1,...,n\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.SSS3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS3.p5.5" class="ltx_p">In the above equation, <math id="S3.SS1.SSS3.p5.1.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS1.SSS3.p5.1.m1.1a"><msub id="S3.SS1.SSS3.p5.1.m1.1.1" xref="S3.SS1.SSS3.p5.1.m1.1.1.cmml"><mi id="S3.SS1.SSS3.p5.1.m1.1.1.2" xref="S3.SS1.SSS3.p5.1.m1.1.1.2.cmml">w</mi><mi id="S3.SS1.SSS3.p5.1.m1.1.1.3" xref="S3.SS1.SSS3.p5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p5.1.m1.1b"><apply id="S3.SS1.SSS3.p5.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p5.1.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p5.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p5.1.m1.1.1.2">𝑤</ci><ci id="S3.SS1.SSS3.p5.1.m1.1.1.3.cmml" xref="S3.SS1.SSS3.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p5.1.m1.1c">w_{i}</annotation></semantics></math> represents the weights of the <math id="S3.SS1.SSS3.p5.2.m2.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS1.SSS3.p5.2.m2.1a"><msup id="S3.SS1.SSS3.p5.2.m2.1.1" xref="S3.SS1.SSS3.p5.2.m2.1.1.cmml"><mi id="S3.SS1.SSS3.p5.2.m2.1.1.2" xref="S3.SS1.SSS3.p5.2.m2.1.1.2.cmml">i</mi><mrow id="S3.SS1.SSS3.p5.2.m2.1.1.3" xref="S3.SS1.SSS3.p5.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS3.p5.2.m2.1.1.3.2" xref="S3.SS1.SSS3.p5.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p5.2.m2.1.1.3.1" xref="S3.SS1.SSS3.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS3.p5.2.m2.1.1.3.3" xref="S3.SS1.SSS3.p5.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p5.2.m2.1b"><apply id="S3.SS1.SSS3.p5.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p5.2.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p5.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.SSS3.p5.2.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p5.2.m2.1.1.2">𝑖</ci><apply id="S3.SS1.SSS3.p5.2.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p5.2.m2.1.1.3"><times id="S3.SS1.SSS3.p5.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS3.p5.2.m2.1.1.3.1"></times><ci id="S3.SS1.SSS3.p5.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS3.p5.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS3.p5.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS3.p5.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p5.2.m2.1c">i^{th}</annotation></semantics></math> hidden layer, and <math id="S3.SS1.SSS3.p5.3.m3.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS1.SSS3.p5.3.m3.1a"><msub id="S3.SS1.SSS3.p5.3.m3.1.1" xref="S3.SS1.SSS3.p5.3.m3.1.1.cmml"><mi id="S3.SS1.SSS3.p5.3.m3.1.1.2" xref="S3.SS1.SSS3.p5.3.m3.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS3.p5.3.m3.1.1.3" xref="S3.SS1.SSS3.p5.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p5.3.m3.1b"><apply id="S3.SS1.SSS3.p5.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p5.3.m3.1.1.1.cmml" xref="S3.SS1.SSS3.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p5.3.m3.1.1.2.cmml" xref="S3.SS1.SSS3.p5.3.m3.1.1.2">𝑐</ci><ci id="S3.SS1.SSS3.p5.3.m3.1.1.3.cmml" xref="S3.SS1.SSS3.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p5.3.m3.1c">c_{i}</annotation></semantics></math> stands for the number of channels sampled from the <math id="S3.SS1.SSS3.p5.4.m4.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS1.SSS3.p5.4.m4.1a"><msup id="S3.SS1.SSS3.p5.4.m4.1.1" xref="S3.SS1.SSS3.p5.4.m4.1.1.cmml"><mi id="S3.SS1.SSS3.p5.4.m4.1.1.2" xref="S3.SS1.SSS3.p5.4.m4.1.1.2.cmml">i</mi><mrow id="S3.SS1.SSS3.p5.4.m4.1.1.3" xref="S3.SS1.SSS3.p5.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS3.p5.4.m4.1.1.3.2" xref="S3.SS1.SSS3.p5.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p5.4.m4.1.1.3.1" xref="S3.SS1.SSS3.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS3.p5.4.m4.1.1.3.3" xref="S3.SS1.SSS3.p5.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p5.4.m4.1b"><apply id="S3.SS1.SSS3.p5.4.m4.1.1.cmml" xref="S3.SS1.SSS3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p5.4.m4.1.1.1.cmml" xref="S3.SS1.SSS3.p5.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.SSS3.p5.4.m4.1.1.2.cmml" xref="S3.SS1.SSS3.p5.4.m4.1.1.2">𝑖</ci><apply id="S3.SS1.SSS3.p5.4.m4.1.1.3.cmml" xref="S3.SS1.SSS3.p5.4.m4.1.1.3"><times id="S3.SS1.SSS3.p5.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS3.p5.4.m4.1.1.3.1"></times><ci id="S3.SS1.SSS3.p5.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS3.p5.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS3.p5.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS3.p5.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p5.4.m4.1c">i^{th}</annotation></semantics></math> hidden layer. The salient parameter prioritization component ensures the extracted sub-model, <math id="S3.SS1.SSS3.p5.5.m5.1" class="ltx_Math" alttext="\mathcal{F}(\mathcal{W}_{c_{\tau}})" display="inline"><semantics id="S3.SS1.SSS3.p5.5.m5.1a"><mrow id="S3.SS1.SSS3.p5.5.m5.1.1" xref="S3.SS1.SSS3.p5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p5.5.m5.1.1.3" xref="S3.SS1.SSS3.p5.5.m5.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p5.5.m5.1.1.2" xref="S3.SS1.SSS3.p5.5.m5.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS3.p5.5.m5.1.1.1.1" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.2" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.2" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.2.cmml">𝒲</mi><msub id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.2" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.2.cmml">c</mi><mi id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.3" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.3.cmml">τ</mi></msub></msub><mo stretchy="false" id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.3" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p5.5.m5.1b"><apply id="S3.SS1.SSS3.p5.5.m5.1.1.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1"><times id="S3.SS1.SSS3.p5.5.m5.1.1.2.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.2"></times><ci id="S3.SS1.SSS3.p5.5.m5.1.1.3.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.3">ℱ</ci><apply id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.2">𝒲</ci><apply id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS3.p5.5.m5.1.1.1.1.1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p5.5.m5.1c">\mathcal{F}(\mathcal{W}_{c_{\tau}})</annotation></semantics></math>, retains the most salient weights from the original FM.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Resource-aware Federated Foundation Models</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">RaFFM can seamlessly integrate with mainstream FL model fusion algorithms, such as FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite> and Fedprox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. This is because all resource-aware local models in RaFFM are sub-networks derived from the forefront channels of the given FM. As a result, heterogeneous federated learning model fusion can be easily executed using matrix slicing, as demonstrated in Equations <a href="#S3.E6" title="In 3.1.3 High-performance Sub-Model extraction ‣ 3.1 Foundation Model Scaling ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and <a href="#S3.E7" title="In 3.2 Resource-aware Federated Foundation Models ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. In this paper, we use FedAvg as our backend algorithm.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_math_unparsed" alttext="\mathcal{W}^{t}=\sum_{c_{\tau}\in C}(\mathcal{W}^{t-1}[:c_{\tau}]+\eta_{c_{\tau}}\nabla\mathcal{W}_{c_{\tau}}^{t})" display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1b"><msup id="S3.E7.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.2">𝒲</mi><mi id="S3.E7.m1.1.1.3">t</mi></msup><mo rspace="0.111em" id="S3.E7.m1.1.2">=</mo><munder id="S3.E7.m1.1.3"><mo movablelimits="false" rspace="0em" id="S3.E7.m1.1.3.2">∑</mo><mrow id="S3.E7.m1.1.3.3"><msub id="S3.E7.m1.1.3.3.2"><mi id="S3.E7.m1.1.3.3.2.2">c</mi><mi id="S3.E7.m1.1.3.3.2.3">τ</mi></msub><mo id="S3.E7.m1.1.3.3.1">∈</mo><mi id="S3.E7.m1.1.3.3.3">C</mi></mrow></munder><mrow id="S3.E7.m1.1.4"><mo stretchy="false" id="S3.E7.m1.1.4.1">(</mo><msup id="S3.E7.m1.1.4.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.4.2.2">𝒲</mi><mrow id="S3.E7.m1.1.4.2.3"><mi id="S3.E7.m1.1.4.2.3.2">t</mi><mo id="S3.E7.m1.1.4.2.3.1">−</mo><mn id="S3.E7.m1.1.4.2.3.3">1</mn></mrow></msup><mrow id="S3.E7.m1.1.4.3"><mo stretchy="false" id="S3.E7.m1.1.4.3.1">[</mo><mo rspace="0.278em" id="S3.E7.m1.1.4.3.2">:</mo><msub id="S3.E7.m1.1.4.3.3"><mi id="S3.E7.m1.1.4.3.3.2">c</mi><mi id="S3.E7.m1.1.4.3.3.3">τ</mi></msub><mo stretchy="false" id="S3.E7.m1.1.4.3.4">]</mo></mrow><mo id="S3.E7.m1.1.4.4">+</mo><msub id="S3.E7.m1.1.4.5"><mi id="S3.E7.m1.1.4.5.2">η</mi><msub id="S3.E7.m1.1.4.5.3"><mi id="S3.E7.m1.1.4.5.3.2">c</mi><mi id="S3.E7.m1.1.4.5.3.3">τ</mi></msub></msub><mo lspace="0.167em" rspace="0.167em" id="S3.E7.m1.1.4.6">∇</mo><msubsup id="S3.E7.m1.1.4.7"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.4.7.2.2">𝒲</mi><msub id="S3.E7.m1.1.4.7.2.3"><mi id="S3.E7.m1.1.4.7.2.3.2">c</mi><mi id="S3.E7.m1.1.4.7.2.3.3">τ</mi></msub><mi id="S3.E7.m1.1.4.7.3">t</mi></msubsup><mo stretchy="false" id="S3.E7.m1.1.4.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\mathcal{W}^{t}=\sum_{c_{\tau}\in C}(\mathcal{W}^{t-1}[:c_{\tau}]+\eta_{c_{\tau}}\nabla\mathcal{W}_{c_{\tau}}^{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.3" class="ltx_p">Equation <a href="#S3.E7" title="In 3.2 Resource-aware Federated Foundation Models ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> aggregate resource-aware local models, <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="c_{\tau}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">c</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑐</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">c_{\tau}</annotation></semantics></math> represent the local model configuration satisfying constraint <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\tau</annotation></semantics></math>, and <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\eta_{c_{\tau}}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">η</mi><msub id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">c</mi><mi id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml">τ</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝜂</ci><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">𝑐</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\eta_{c_{\tau}}</annotation></semantics></math> signifies the learning step for the client.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p">The RaFFM procedure in an FL communication round can be described as follows:</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.2" class="ltx_p">In the <math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="t^{th}" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><msup id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml">t</mi><mrow id="S3.I1.i1.p1.1.m1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.3.2" xref="S3.I1.i1.p1.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.3.1" xref="S3.I1.i1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.3.3" xref="S3.I1.i1.p1.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2">𝑡</ci><apply id="S3.I1.i1.p1.1.m1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3"><times id="S3.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.1"></times><ci id="S3.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2">𝑡</ci><ci id="S3.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">t^{th}</annotation></semantics></math> communication round, RaFFM first perform salient parameters prioritization for the global FM <math id="S3.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{F}(\mathcal{W}^{t})" display="inline"><semantics id="S3.I1.i1.p1.2.m2.1a"><mrow id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.2.m2.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.I1.i1.p1.2.m2.1.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.I1.i1.p1.2.m2.1.1.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S3.I1.i1.p1.2.m2.1.1.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.2.m2.1.1.1.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml">𝒲</mi><mi id="S3.I1.i1.p1.2.m2.1.1.1.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.I1.i1.p1.2.m2.1.1.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><apply id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1"><times id="S3.I1.i1.p1.2.m2.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.2"></times><ci id="S3.I1.i1.p1.2.m2.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3">ℱ</ci><apply id="S3.I1.i1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.2">𝒲</ci><ci id="S3.I1.i1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">\mathcal{F}(\mathcal{W}^{t})</annotation></semantics></math>.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">RaFFM samples a set of sub-network configurations, <math id="S3.I1.i2.p1.1.m1.1" class="ltx_math_unparsed" alttext="C=\{c_{\tau 1},..,c_{\tau k}\}" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mrow id="S3.I1.i2.p1.1.m1.1b"><mi id="S3.I1.i2.p1.1.m1.1.1">C</mi><mo id="S3.I1.i2.p1.1.m1.1.2">=</mo><mrow id="S3.I1.i2.p1.1.m1.1.3"><mo stretchy="false" id="S3.I1.i2.p1.1.m1.1.3.1">{</mo><msub id="S3.I1.i2.p1.1.m1.1.3.2"><mi id="S3.I1.i2.p1.1.m1.1.3.2.2">c</mi><mrow id="S3.I1.i2.p1.1.m1.1.3.2.3"><mi id="S3.I1.i2.p1.1.m1.1.3.2.3.2">τ</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.1.m1.1.3.2.3.1">​</mo><mn id="S3.I1.i2.p1.1.m1.1.3.2.3.3">1</mn></mrow></msub><mo id="S3.I1.i2.p1.1.m1.1.3.3">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.I1.i2.p1.1.m1.1.3.4">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.I1.i2.p1.1.m1.1.3.5">.</mo><mo id="S3.I1.i2.p1.1.m1.1.3.6">,</mo><msub id="S3.I1.i2.p1.1.m1.1.3.7"><mi id="S3.I1.i2.p1.1.m1.1.3.7.2">c</mi><mrow id="S3.I1.i2.p1.1.m1.1.3.7.3"><mi id="S3.I1.i2.p1.1.m1.1.3.7.3.2">τ</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.1.m1.1.3.7.3.1">​</mo><mi id="S3.I1.i2.p1.1.m1.1.3.7.3.3">k</mi></mrow></msub><mo stretchy="false" id="S3.I1.i2.p1.1.m1.1.3.8">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">C=\{c_{\tau 1},..,c_{\tau k}\}</annotation></semantics></math>, in accordance with the resource constraints of participating clients, then generate sub-models.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">These sampled sub-models, represented as <math id="S3.I1.i3.p1.1.m1.2" class="ltx_Math" alttext="\{\mathcal{W}^{t}_{c_{\tau}}|{c_{\tau}}\in C\}" display="inline"><semantics id="S3.I1.i3.p1.1.m1.2a"><mrow id="S3.I1.i3.p1.1.m1.2.2.2" xref="S3.I1.i3.p1.1.m1.2.2.3.cmml"><mo stretchy="false" id="S3.I1.i3.p1.1.m1.2.2.2.3" xref="S3.I1.i3.p1.1.m1.2.2.3.1.cmml">{</mo><msubsup id="S3.I1.i3.p1.1.m1.1.1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p1.1.m1.1.1.1.1.2.2" xref="S3.I1.i3.p1.1.m1.1.1.1.1.2.2.cmml">𝒲</mi><msub id="S3.I1.i3.p1.1.m1.1.1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.1.1.3.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.1.1.3.2" xref="S3.I1.i3.p1.1.m1.1.1.1.1.3.2.cmml">c</mi><mi id="S3.I1.i3.p1.1.m1.1.1.1.1.3.3" xref="S3.I1.i3.p1.1.m1.1.1.1.1.3.3.cmml">τ</mi></msub><mi id="S3.I1.i3.p1.1.m1.1.1.1.1.2.3" xref="S3.I1.i3.p1.1.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.I1.i3.p1.1.m1.2.2.2.4" xref="S3.I1.i3.p1.1.m1.2.2.3.1.cmml">|</mo><mrow id="S3.I1.i3.p1.1.m1.2.2.2.2" xref="S3.I1.i3.p1.1.m1.2.2.2.2.cmml"><msub id="S3.I1.i3.p1.1.m1.2.2.2.2.2" xref="S3.I1.i3.p1.1.m1.2.2.2.2.2.cmml"><mi id="S3.I1.i3.p1.1.m1.2.2.2.2.2.2" xref="S3.I1.i3.p1.1.m1.2.2.2.2.2.2.cmml">c</mi><mi id="S3.I1.i3.p1.1.m1.2.2.2.2.2.3" xref="S3.I1.i3.p1.1.m1.2.2.2.2.2.3.cmml">τ</mi></msub><mo id="S3.I1.i3.p1.1.m1.2.2.2.2.1" xref="S3.I1.i3.p1.1.m1.2.2.2.2.1.cmml">∈</mo><mi id="S3.I1.i3.p1.1.m1.2.2.2.2.3" xref="S3.I1.i3.p1.1.m1.2.2.2.2.3.cmml">C</mi></mrow><mo stretchy="false" id="S3.I1.i3.p1.1.m1.2.2.2.5" xref="S3.I1.i3.p1.1.m1.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.2b"><apply id="S3.I1.i3.p1.1.m1.2.2.3.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2"><csymbol cd="latexml" id="S3.I1.i3.p1.1.m1.2.2.3.1.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2.3">conditional-set</csymbol><apply id="S3.I1.i3.p1.1.m1.1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.I1.i3.p1.1.m1.1.1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.1.2.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.1.1.2.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.2.2">𝒲</ci><ci id="S3.I1.i3.p1.1.m1.1.1.1.1.2.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.I1.i3.p1.1.m1.1.1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.3.2">𝑐</ci><ci id="S3.I1.i3.p1.1.m1.1.1.1.1.3.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1.1.3.3">𝜏</ci></apply></apply><apply id="S3.I1.i3.p1.1.m1.2.2.2.2.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2.2"><in id="S3.I1.i3.p1.1.m1.2.2.2.2.1.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2.2.1"></in><apply id="S3.I1.i3.p1.1.m1.2.2.2.2.2.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.I1.i3.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2.2.2.2">𝑐</ci><ci id="S3.I1.i3.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2.2.2.3">𝜏</ci></apply><ci id="S3.I1.i3.p1.1.m1.2.2.2.2.3.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2.2.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.2c">\{\mathcal{W}^{t}_{c_{\tau}}|{c_{\tau}}\in C\}</annotation></semantics></math>, are dispatched to the local participating clients for further training.</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.1" class="ltx_p">Once local training finished, the clients relay their model updates back to the server.</p>
</div>
</li>
<li id="S3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="S3.I1.i5.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i5.p1.1" class="ltx_p">The server then undertakes model fusion using Equation <a href="#S3.E7" title="In 3.2 Resource-aware Federated Foundation Models ‣ 3 Methodology ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
</li>
</ol>
<p id="S3.SS2.p3.2" class="ltx_p">The entire process is iteratively executed until federated learning is complete (Refer Appendix <a href="#alg1" title="Algorithm 1 ‣ A.2 Ablation Study ‣ Appendix A Appendix ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment setup</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Federated Learning Settings.</span>
RaFFM is designed to address the challenges posed by resource heterogeneity in Federated Learning (FL) scenarios, especially deploying resource-hungry FMs. Our experiments were conducted in a standard cross-silo FL setup. This environment comprises 100 local clients coordinated by a central server. In each communication round, 10% of the clients are randomly selected to participate in local updates. We employ FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite> as the underlying FL algorithm for model aggregation.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Model and Datasets.</span>
Our evaluations span a variety of pre-trained models:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">NLP models: DistilBert <cite class="ltx_cite ltx_citemacro_citep">(Sanh et al., <a href="#bib.bib30" title="" class="ltx_ref">2019</a>)</cite>, RoBERTa <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite>, BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib7" title="" class="ltx_ref">2018</a>)</cite>, and FLAN-T5 <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">Large language model: LLaMA2 <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S4.I1.i3.p1.1" class="ltx_p">Computer Vision model: ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</li>
</ul>
<p id="S4.SS1.p2.2" class="ltx_p">For our experiments, we employ diverse datasets, including the GLUE benchmark <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib34" title="" class="ltx_ref">2018</a>)</cite>, question-answering benchmarks like SQuAD and SQuAD-v2 <cite class="ltx_cite ltx_citemacro_citep">(Rajpurkar et al., <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite>, SVAMP <cite class="ltx_cite ltx_citemacro_citep">(Patel et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite>, CIFAR-10 and CIFAR-100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky &amp; Hinton, <a href="#bib.bib14" title="" class="ltx_ref">2009</a>)</cite>, and the Flower-102 dataset <cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib24" title="" class="ltx_ref">2008</a>)</cite>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Results on GLUE benchmark. </figcaption>
<div id="S4.T1.8" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:144pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-62.3pt,20.7pt) scale(0.776824838104998,0.776824838104998) ;">
<table id="S4.T1.8.8" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.8.8.9.1" class="ltx_tr">
<th id="S4.T1.8.8.9.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S4.T1.8.8.9.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.2.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T1.8.8.9.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.3.1" class="ltx_text ltx_font_bold">#Param</span></th>
<th id="S4.T1.8.8.9.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.4.1" class="ltx_text ltx_font_bold">QQP</span></th>
<th id="S4.T1.8.8.9.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.5.1" class="ltx_text ltx_font_bold">QNLI</span></th>
<th id="S4.T1.8.8.9.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.6.1" class="ltx_text ltx_font_bold">SST-2</span></th>
<th id="S4.T1.8.8.9.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.7.1" class="ltx_text ltx_font_bold">CoLA</span></th>
<th id="S4.T1.8.8.9.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.8.1" class="ltx_text ltx_font_bold">STS-B</span></th>
<th id="S4.T1.8.8.9.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.9.1" class="ltx_text ltx_font_bold">MRPC</span></th>
<th id="S4.T1.8.8.9.1.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.10.1" class="ltx_text ltx_font_bold">RTE</span></th>
<th id="S4.T1.8.8.9.1.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.11.1" class="ltx_text ltx_font_bold">MNLI</span></th>
<th id="S4.T1.8.8.9.1.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.12.1" class="ltx_text ltx_font_bold">AVG</span></th>
<th id="S4.T1.8.8.9.1.13" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T1.8.8.9.1.13.1" class="ltx_text">
<span id="S4.T1.8.8.9.1.13.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.8.8.9.1.13.1.1.1" class="ltx_tr">
<span id="S4.T1.8.8.9.1.13.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T1.8.8.9.1.13.1.1.1.1.1" class="ltx_text ltx_font_bold">Training</span></span></span>
<span id="S4.T1.8.8.9.1.13.1.1.2" class="ltx_tr">
<span id="S4.T1.8.8.9.1.13.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T1.8.8.9.1.13.1.1.2.1.1" class="ltx_text ltx_font_bold">Accel.</span></span></span>
</span></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T1.1.1.1.2.1" class="ltx_text">BERT-Large</span></td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.3.1" class="ltx_text">FL</span></td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.4.1" class="ltx_text">335M</span></td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.5.1" class="ltx_text">89.01</span></td>
<td id="S4.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.6.1" class="ltx_text">91.46</span></td>
<td id="S4.T1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.7.1" class="ltx_text">93.81</span></td>
<td id="S4.T1.1.1.1.8" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.8.1" class="ltx_text">56.08</span></td>
<td id="S4.T1.1.1.1.9" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.9.1" class="ltx_text">89.61</span></td>
<td id="S4.T1.1.1.1.10" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.10.1" class="ltx_text">75.24</span></td>
<td id="S4.T1.1.1.1.11" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.11.1" class="ltx_text">68.59</span></td>
<td id="S4.T1.1.1.1.12" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.12.1" class="ltx_text">85.71</span></td>
<td id="S4.T1.1.1.1.13" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.13.1" class="ltx_text">81.19</span></td>
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t"><span id="S4.T1.1.1.1.1.1" class="ltx_text">1.00 <math id="S4.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.1.1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.m1.1b"><times id="S4.T1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T1.2.2.2" class="ltx_tr">
<td id="S4.T1.2.2.2.2" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.2.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T1.2.2.2.3" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.3.1" class="ltx_text ltx_font_bold">100M</span></td>
<td id="S4.T1.2.2.2.4" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.4.1" class="ltx_text">88.40</span></td>
<td id="S4.T1.2.2.2.5" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.5.1" class="ltx_text">91.18</span></td>
<td id="S4.T1.2.2.2.6" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.6.1" class="ltx_text">94.15</span></td>
<td id="S4.T1.2.2.2.7" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.7.1" class="ltx_text">54.72</span></td>
<td id="S4.T1.2.2.2.8" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.8.1" class="ltx_text">88.81</span></td>
<td id="S4.T1.2.2.2.9" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.9.1" class="ltx_text">75.49</span></td>
<td id="S4.T1.2.2.2.10" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.10.1" class="ltx_text">68.23</span></td>
<td id="S4.T1.2.2.2.11" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.11.1" class="ltx_text">85.40</span></td>
<td id="S4.T1.2.2.2.12" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.12.1" class="ltx_text">80.80</span></td>
<td id="S4.T1.2.2.2.1" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.2.1.1" class="ltx_text ltx_font_bold">6.13 <math id="S4.T1.2.2.2.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.2.2.2.1.1.1.m1.1a"><mo id="S4.T1.2.2.2.1.1.1.m1.1.1" xref="S4.T1.2.2.2.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.1.1.m1.1b"><times id="S4.T1.2.2.2.1.1.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T1.3.3.3" class="ltx_tr">
<td id="S4.T1.3.3.3.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.T1.3.3.3.2.1" class="ltx_text">BERT-Base</span></td>
<td id="S4.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.3.1" class="ltx_text">FL</span></td>
<td id="S4.T1.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.4.1" class="ltx_text">109M</span></td>
<td id="S4.T1.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.5.1" class="ltx_text">88.34</span></td>
<td id="S4.T1.3.3.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.6.1" class="ltx_text">86.43</span></td>
<td id="S4.T1.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.7.1" class="ltx_text">91.74</span></td>
<td id="S4.T1.3.3.3.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.8.1" class="ltx_text">48.03</span></td>
<td id="S4.T1.3.3.3.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.9.1" class="ltx_text">86.34</span></td>
<td id="S4.T1.3.3.3.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.10.1" class="ltx_text">77.94</span></td>
<td id="S4.T1.3.3.3.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.11.1" class="ltx_text">64.26</span></td>
<td id="S4.T1.3.3.3.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.12.1" class="ltx_text">80.83</span></td>
<td id="S4.T1.3.3.3.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.13.1" class="ltx_text">77.99</span></td>
<td id="S4.T1.3.3.3.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.1.1" class="ltx_text">1.00 <math id="S4.T1.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.3.3.3.1.1.m1.1a"><mo id="S4.T1.3.3.3.1.1.m1.1.1" xref="S4.T1.3.3.3.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.1.m1.1b"><times id="S4.T1.3.3.3.1.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T1.4.4.4" class="ltx_tr">
<td id="S4.T1.4.4.4.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.2.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T1.4.4.4.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.3.1" class="ltx_text ltx_font_bold">60M</span></td>
<td id="S4.T1.4.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.4.1" class="ltx_text">88.00</span></td>
<td id="S4.T1.4.4.4.5" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.5.1" class="ltx_text">88.41</span></td>
<td id="S4.T1.4.4.4.6" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.6.1" class="ltx_text">91.63</span></td>
<td id="S4.T1.4.4.4.7" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.7.1" class="ltx_text">47.76</span></td>
<td id="S4.T1.4.4.4.8" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.8.1" class="ltx_text">86.00</span></td>
<td id="S4.T1.4.4.4.9" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.9.1" class="ltx_text">77.45</span></td>
<td id="S4.T1.4.4.4.10" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.10.1" class="ltx_text">63.90</span></td>
<td id="S4.T1.4.4.4.11" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.11.1" class="ltx_text">80.33</span></td>
<td id="S4.T1.4.4.4.12" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.12.1" class="ltx_text">77.94</span></td>
<td id="S4.T1.4.4.4.1" class="ltx_td ltx_align_center"><span id="S4.T1.4.4.4.1.1" class="ltx_text ltx_font_bold">2.45 <math id="S4.T1.4.4.4.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.4.4.4.1.1.1.m1.1a"><mo id="S4.T1.4.4.4.1.1.1.m1.1.1" xref="S4.T1.4.4.4.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.1.1.m1.1b"><times id="S4.T1.4.4.4.1.1.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T1.5.5.5" class="ltx_tr">
<td id="S4.T1.5.5.5.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.T1.5.5.5.2.1" class="ltx_text">RoBERTa</span></td>
<td id="S4.T1.5.5.5.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.3.1" class="ltx_text">FL</span></td>
<td id="S4.T1.5.5.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.4.1" class="ltx_text">125M</span></td>
<td id="S4.T1.5.5.5.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.5.1" class="ltx_text">89.19</span></td>
<td id="S4.T1.5.5.5.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.6.1" class="ltx_text">91.19</span></td>
<td id="S4.T1.5.5.5.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.7.1" class="ltx_text">93.92</span></td>
<td id="S4.T1.5.5.5.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.8.1" class="ltx_text">49.68</span></td>
<td id="S4.T1.5.5.5.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.9.1" class="ltx_text">87.11</span></td>
<td id="S4.T1.5.5.5.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.10.1" class="ltx_text">84.80</span></td>
<td id="S4.T1.5.5.5.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.11.1" class="ltx_text">71.48</span></td>
<td id="S4.T1.5.5.5.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.12.1" class="ltx_text">86.20</span></td>
<td id="S4.T1.5.5.5.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.13.1" class="ltx_text">81.70</span></td>
<td id="S4.T1.5.5.5.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.1.1" class="ltx_text">1.00 <math id="S4.T1.5.5.5.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.5.5.5.1.1.m1.1a"><mo id="S4.T1.5.5.5.1.1.m1.1.1" xref="S4.T1.5.5.5.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.1.1.m1.1b"><times id="S4.T1.5.5.5.1.1.m1.1.1.cmml" xref="S4.T1.5.5.5.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T1.6.6.6" class="ltx_tr">
<td id="S4.T1.6.6.6.2" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.2.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T1.6.6.6.3" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.3.1" class="ltx_text ltx_font_bold">53M</span></td>
<td id="S4.T1.6.6.6.4" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.4.1" class="ltx_text">89.14</span></td>
<td id="S4.T1.6.6.6.5" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.5.1" class="ltx_text">91.25</span></td>
<td id="S4.T1.6.6.6.6" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.6.1" class="ltx_text">93.92</span></td>
<td id="S4.T1.6.6.6.7" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.7.1" class="ltx_text">52.20</span></td>
<td id="S4.T1.6.6.6.8" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.8.1" class="ltx_text">87.67</span></td>
<td id="S4.T1.6.6.6.9" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.9.1" class="ltx_text">85.29</span></td>
<td id="S4.T1.6.6.6.10" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.10.1" class="ltx_text">65.34</span></td>
<td id="S4.T1.6.6.6.11" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.11.1" class="ltx_text">86.22</span></td>
<td id="S4.T1.6.6.6.12" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.12.1" class="ltx_text">81.38</span></td>
<td id="S4.T1.6.6.6.1" class="ltx_td ltx_align_center"><span id="S4.T1.6.6.6.1.1" class="ltx_text ltx_font_bold">3.62 <math id="S4.T1.6.6.6.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.6.6.6.1.1.1.m1.1a"><mo id="S4.T1.6.6.6.1.1.1.m1.1.1" xref="S4.T1.6.6.6.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.1.1.1.m1.1b"><times id="S4.T1.6.6.6.1.1.1.m1.1.1.cmml" xref="S4.T1.6.6.6.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T1.7.7.7" class="ltx_tr">
<td id="S4.T1.7.7.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" rowspan="2"><span id="S4.T1.7.7.7.2.1" class="ltx_text">DistilBERT</span></td>
<td id="S4.T1.7.7.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.3.1" class="ltx_text">FL</span></td>
<td id="S4.T1.7.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.4.1" class="ltx_text">67M</span></td>
<td id="S4.T1.7.7.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.5.1" class="ltx_text">86.73</span></td>
<td id="S4.T1.7.7.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.6.1" class="ltx_text">84.71</span></td>
<td id="S4.T1.7.7.7.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.7.1" class="ltx_text">89.91</span></td>
<td id="S4.T1.7.7.7.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.8.1" class="ltx_text">45.36</span></td>
<td id="S4.T1.7.7.7.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.9.1" class="ltx_text">83.76</span></td>
<td id="S4.T1.7.7.7.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.10.1" class="ltx_text">79.17</span></td>
<td id="S4.T1.7.7.7.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.11.1" class="ltx_text">55.60</span></td>
<td id="S4.T1.7.7.7.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.12.1" class="ltx_text">77.90</span></td>
<td id="S4.T1.7.7.7.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.13.1" class="ltx_text">75.39</span></td>
<td id="S4.T1.7.7.7.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.7.7.7.1.1" class="ltx_text">1.00 <math id="S4.T1.7.7.7.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.7.7.7.1.1.m1.1a"><mo id="S4.T1.7.7.7.1.1.m1.1.1" xref="S4.T1.7.7.7.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.1.1.m1.1b"><times id="S4.T1.7.7.7.1.1.m1.1.1.cmml" xref="S4.T1.7.7.7.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T1.8.8.8" class="ltx_tr">
<td id="S4.T1.8.8.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.2.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T1.8.8.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.3.1" class="ltx_text ltx_font_bold">50M</span></td>
<td id="S4.T1.8.8.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.4.1" class="ltx_text">86.80</span></td>
<td id="S4.T1.8.8.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.5.1" class="ltx_text">85.08</span></td>
<td id="S4.T1.8.8.8.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.6.1" class="ltx_text">90.48</span></td>
<td id="S4.T1.8.8.8.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.7.1" class="ltx_text">41.69</span></td>
<td id="S4.T1.8.8.8.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.8.1" class="ltx_text">82.85</span></td>
<td id="S4.T1.8.8.8.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.9.1" class="ltx_text">78.19</span></td>
<td id="S4.T1.8.8.8.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.10.1" class="ltx_text">57.40</span></td>
<td id="S4.T1.8.8.8.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.11.1" class="ltx_text">78.34</span></td>
<td id="S4.T1.8.8.8.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.12.1" class="ltx_text">75.10</span></td>
<td id="S4.T1.8.8.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T1.8.8.8.1.1" class="ltx_text"><span id="S4.T1.8.8.8.1.1.1" class="ltx_text ltx_font_bold">1.55 <math id="S4.T1.8.8.8.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.8.8.8.1.1.1.m1.1a"><mo id="S4.T1.8.8.8.1.1.1.m1.1.1" xref="S4.T1.8.8.8.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.1.1.1.m1.1b"><times id="S4.T1.8.8.8.1.1.1.m1.1.1.cmml" xref="S4.T1.8.8.8.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.1.1.1.m1.1c">\times</annotation></semantics></math></span></span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Learning Efficiency</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">Our primary objective with RaFFM is to achieve efficient FL by leveraging fewer computational resources without significantly compromising model performance. To this end, we compare the performance of resource-aware sub-models deployed through RaFFM against the conventional full-size FL model implementations.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Results on GLUE Benchmark</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">We assessed RaFFM’s efficacy using the NLP General Language Understanding Evaluation (GLUE) benchmark <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib34" title="" class="ltx_ref">2018</a>)</cite>, which comprises eight language datasets: QQP, QNLI, SST-2, CoLA, STS-B, MRPC, RTE, and MNLI.</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p">In experiments, baseline FL optimizes full-size FMs at local clients. In contrast, RaFFM deployed resource-aware sub-models tailored to individual clients. Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Experiment setup ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the results. Performance metrics were computed for the global model post-training on validation datasets. The column titled #Param represents the average count of local model parameters across all clients for the eight datasets. Training acceleration estimates the relative GPU hours. We also present an average score (AVG) as an aggregate performance indicator.</p>
</div>
<div id="S4.SS2.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS1.p3.1" class="ltx_p">Notably, RaFFM required fewer computational resources (evidenced by the reduced parameter count) and demonstrated faster training times than the conventional full-model FL. Impressively, despite the reduced model size at the client side, RaFFM-optimized models not only competitive but occasionally surpassed the performance of baseline full-size FL models. This superiority was particularly pronounced in datasets such as SST-2, MRPC, and MNLI.</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Results on Question Answering Benchmark</h4>

<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Experiments on question answering tasks</figcaption>
<div id="S4.T2.24" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:189.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-71.4pt,31.2pt) scale(0.752303339488844,0.752303339488844) ;">
<table id="S4.T2.24.24" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.24.24.25.1" class="ltx_tr">
<th id="S4.T2.24.24.25.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T2.24.24.25.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S4.T2.24.24.25.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T2.24.24.25.1.2.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T2.24.24.25.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="4"><span id="S4.T2.24.24.25.1.3.1" class="ltx_text ltx_font_bold">SQuAD</span></th>
<th id="S4.T2.24.24.25.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="4"><span id="S4.T2.24.24.25.1.4.1" class="ltx_text ltx_font_bold">SQuAD-V2</span></th>
</tr>
<tr id="S4.T2.24.24.26.2" class="ltx_tr">
<td id="S4.T2.24.24.26.2.1" class="ltx_td ltx_align_center"><span id="S4.T2.24.24.26.2.1.1" class="ltx_text ltx_font_bold">#Param</span></td>
<td id="S4.T2.24.24.26.2.2" class="ltx_td ltx_align_center"><span id="S4.T2.24.24.26.2.2.1" class="ltx_text ltx_font_bold">Exact Match</span></td>
<td id="S4.T2.24.24.26.2.3" class="ltx_td ltx_align_center"><span id="S4.T2.24.24.26.2.3.1" class="ltx_text ltx_font_bold">F1</span></td>
<td id="S4.T2.24.24.26.2.4" class="ltx_td ltx_align_center"><span id="S4.T2.24.24.26.2.4.1" class="ltx_text ltx_font_bold">Training Accel.</span></td>
<td id="S4.T2.24.24.26.2.5" class="ltx_td ltx_align_center"><span id="S4.T2.24.24.26.2.5.1" class="ltx_text ltx_font_bold">#Param</span></td>
<td id="S4.T2.24.24.26.2.6" class="ltx_td ltx_align_center"><span id="S4.T2.24.24.26.2.6.1" class="ltx_text ltx_font_bold">Exact Match</span></td>
<td id="S4.T2.24.24.26.2.7" class="ltx_td ltx_align_center"><span id="S4.T2.24.24.26.2.7.1" class="ltx_text ltx_font_bold">F1</span></td>
<td id="S4.T2.24.24.26.2.8" class="ltx_td ltx_align_center"><span id="S4.T2.24.24.26.2.8.1" class="ltx_text ltx_font_bold">Training Accel.</span></td>
</tr>
<tr id="S4.T2.2.2.2" class="ltx_tr">
<th id="S4.T2.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T2.2.2.2.3.1" class="ltx_text">BERT-Large</span></th>
<th id="S4.T2.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.2.2.2.4.1" class="ltx_text">FL</span></th>
<th id="S4.T2.2.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.2.2.2.5.1" class="ltx_text">334M</span></th>
<th id="S4.T2.2.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.2.2.2.6.1" class="ltx_text">83.29</span></th>
<th id="S4.T2.2.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.2.2.2.7.1" class="ltx_text">89.25</span></th>
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.1.1.1.1.1" class="ltx_text">1.00 <math id="S4.T2.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.1.1.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.1.m1.1b"><times id="S4.T2.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.1.m1.1c">\times</annotation></semantics></math></span></th>
<th id="S4.T2.2.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.2.2.2.8.1" class="ltx_text">335M</span></th>
<th id="S4.T2.2.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.2.2.2.9.1" class="ltx_text">82.05</span></th>
<th id="S4.T2.2.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.2.2.2.10.1" class="ltx_text">90.24</span></th>
<th id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T2.2.2.2.2.1" class="ltx_text">1.00 <math id="S4.T2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.2.2.2.2.1.m1.1a"><mo id="S4.T2.2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.1.m1.1b"><times id="S4.T2.2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.1.m1.1c">\times</annotation></semantics></math></span></th>
</tr>
<tr id="S4.T2.4.4.4" class="ltx_tr">
<td id="S4.T2.4.4.4.3" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.3.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.4.1" class="ltx_text ltx_font_bold">95M</span></td>
<td id="S4.T2.4.4.4.5" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.5.1" class="ltx_text">83.34</span></td>
<td id="S4.T2.4.4.4.6" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.6.1" class="ltx_text">90.87</span></td>
<td id="S4.T2.3.3.3.1" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.3.1.1" class="ltx_text ltx_font_bold">6.59 <math id="S4.T2.3.3.3.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.3.3.3.1.1.1.m1.1a"><mo id="S4.T2.3.3.3.1.1.1.m1.1.1" xref="S4.T2.3.3.3.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.1.1.1.m1.1b"><times id="S4.T2.3.3.3.1.1.1.m1.1.1.cmml" xref="S4.T2.3.3.3.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T2.4.4.4.7" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.7.1" class="ltx_text ltx_font_bold">103M</span></td>
<td id="S4.T2.4.4.4.8" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.8.1" class="ltx_text">82.27</span></td>
<td id="S4.T2.4.4.4.9" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.9.1" class="ltx_text">90.28</span></td>
<td id="S4.T2.4.4.4.2" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.2.1" class="ltx_text ltx_font_bold">6.59 <math id="S4.T2.4.4.4.2.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.4.4.4.2.1.1.m1.1a"><mo id="S4.T2.4.4.4.2.1.1.m1.1.1" xref="S4.T2.4.4.4.2.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.2.1.1.m1.1b"><times id="S4.T2.4.4.4.2.1.1.m1.1.1.cmml" xref="S4.T2.4.4.4.2.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.2.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T2.6.6.6" class="ltx_tr">
<th id="S4.T2.6.6.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T2.6.6.6.3.1" class="ltx_text">BERT-Base</span></th>
<th id="S4.T2.6.6.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.6.6.6.4.1" class="ltx_text">FL</span></th>
<th id="S4.T2.6.6.6.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.6.6.6.5.1" class="ltx_text">109M</span></th>
<th id="S4.T2.6.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.6.6.6.6.1" class="ltx_text">73.68</span></th>
<th id="S4.T2.6.6.6.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.6.6.6.7.1" class="ltx_text">82.99</span></th>
<th id="S4.T2.5.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.5.5.5.1.1" class="ltx_text">1.00 <math id="S4.T2.5.5.5.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.5.5.5.1.1.m1.1a"><mo id="S4.T2.5.5.5.1.1.m1.1.1" xref="S4.T2.5.5.5.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.1.1.m1.1b"><times id="S4.T2.5.5.5.1.1.m1.1.1.cmml" xref="S4.T2.5.5.5.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.1.1.m1.1c">\times</annotation></semantics></math></span></th>
<th id="S4.T2.6.6.6.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.6.6.6.8.1" class="ltx_text">109M</span></th>
<th id="S4.T2.6.6.6.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.6.6.6.9.1" class="ltx_text">72.85</span></th>
<th id="S4.T2.6.6.6.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.6.6.6.10.1" class="ltx_text">82.69</span></th>
<th id="S4.T2.6.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.6.6.6.2.1" class="ltx_text">1.00 <math id="S4.T2.6.6.6.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.6.6.6.2.1.m1.1a"><mo id="S4.T2.6.6.6.2.1.m1.1.1" xref="S4.T2.6.6.6.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.2.1.m1.1b"><times id="S4.T2.6.6.6.2.1.m1.1.1.cmml" xref="S4.T2.6.6.6.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.2.1.m1.1c">\times</annotation></semantics></math></span></th>
</tr>
<tr id="S4.T2.8.8.8" class="ltx_tr">
<td id="S4.T2.8.8.8.3" class="ltx_td ltx_align_center"><span id="S4.T2.8.8.8.3.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T2.8.8.8.4" class="ltx_td ltx_align_center"><span id="S4.T2.8.8.8.4.1" class="ltx_text ltx_font_bold">70M</span></td>
<td id="S4.T2.8.8.8.5" class="ltx_td ltx_align_center"><span id="S4.T2.8.8.8.5.1" class="ltx_text">72.37</span></td>
<td id="S4.T2.8.8.8.6" class="ltx_td ltx_align_center"><span id="S4.T2.8.8.8.6.1" class="ltx_text">82.00</span></td>
<td id="S4.T2.7.7.7.1" class="ltx_td ltx_align_center"><span id="S4.T2.7.7.7.1.1" class="ltx_text ltx_font_bold">1.94 <math id="S4.T2.7.7.7.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.7.7.7.1.1.1.m1.1a"><mo id="S4.T2.7.7.7.1.1.1.m1.1.1" xref="S4.T2.7.7.7.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.1.1.1.m1.1b"><times id="S4.T2.7.7.7.1.1.1.m1.1.1.cmml" xref="S4.T2.7.7.7.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T2.8.8.8.7" class="ltx_td ltx_align_center"><span id="S4.T2.8.8.8.7.1" class="ltx_text ltx_font_bold">73M</span></td>
<td id="S4.T2.8.8.8.8" class="ltx_td ltx_align_center"><span id="S4.T2.8.8.8.8.1" class="ltx_text">71.23</span></td>
<td id="S4.T2.8.8.8.9" class="ltx_td ltx_align_center"><span id="S4.T2.8.8.8.9.1" class="ltx_text">81.36</span></td>
<td id="S4.T2.8.8.8.2" class="ltx_td ltx_align_center"><span id="S4.T2.8.8.8.2.1" class="ltx_text ltx_font_bold">1.82 <math id="S4.T2.8.8.8.2.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.8.8.8.2.1.1.m1.1a"><mo id="S4.T2.8.8.8.2.1.1.m1.1.1" xref="S4.T2.8.8.8.2.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.2.1.1.m1.1b"><times id="S4.T2.8.8.8.2.1.1.m1.1.1.cmml" xref="S4.T2.8.8.8.2.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.2.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T2.10.10.10" class="ltx_tr">
<th id="S4.T2.10.10.10.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T2.10.10.10.3.1" class="ltx_text">DistillBERT</span></th>
<th id="S4.T2.10.10.10.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.10.10.10.4.1" class="ltx_text">FL</span></th>
<th id="S4.T2.10.10.10.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.10.10.10.5.1" class="ltx_text">67M</span></th>
<th id="S4.T2.10.10.10.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.10.10.10.6.1" class="ltx_text">71.70</span></th>
<th id="S4.T2.10.10.10.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.10.10.10.7.1" class="ltx_text">81.30</span></th>
<th id="S4.T2.9.9.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.9.9.9.1.1" class="ltx_text">1.00 <math id="S4.T2.9.9.9.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.9.9.9.1.1.m1.1a"><mo id="S4.T2.9.9.9.1.1.m1.1.1" xref="S4.T2.9.9.9.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.1.1.m1.1b"><times id="S4.T2.9.9.9.1.1.m1.1.1.cmml" xref="S4.T2.9.9.9.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.1.1.m1.1c">\times</annotation></semantics></math></span></th>
<th id="S4.T2.10.10.10.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.10.10.10.8.1" class="ltx_text">67M</span></th>
<th id="S4.T2.10.10.10.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.10.10.10.9.1" class="ltx_text">69.55</span></th>
<th id="S4.T2.10.10.10.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.10.10.10.10.1" class="ltx_text">79.55</span></th>
<th id="S4.T2.10.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.10.10.10.2.1" class="ltx_text">1.00 <math id="S4.T2.10.10.10.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.10.10.10.2.1.m1.1a"><mo id="S4.T2.10.10.10.2.1.m1.1.1" xref="S4.T2.10.10.10.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.2.1.m1.1b"><times id="S4.T2.10.10.10.2.1.m1.1.1.cmml" xref="S4.T2.10.10.10.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.2.1.m1.1c">\times</annotation></semantics></math></span></th>
</tr>
<tr id="S4.T2.12.12.12" class="ltx_tr">
<td id="S4.T2.12.12.12.3" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.3.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T2.12.12.12.4" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.4.1" class="ltx_text ltx_font_bold">34M</span></td>
<td id="S4.T2.12.12.12.5" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.5.1" class="ltx_text">70.59</span></td>
<td id="S4.T2.12.12.12.6" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.6.1" class="ltx_text">80.15</span></td>
<td id="S4.T2.11.11.11.1" class="ltx_td ltx_align_center"><span id="S4.T2.11.11.11.1.1" class="ltx_text ltx_font_bold">2.77 <math id="S4.T2.11.11.11.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.11.11.11.1.1.1.m1.1a"><mo id="S4.T2.11.11.11.1.1.1.m1.1.1" xref="S4.T2.11.11.11.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.1.1.1.m1.1b"><times id="S4.T2.11.11.11.1.1.1.m1.1.1.cmml" xref="S4.T2.11.11.11.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T2.12.12.12.7" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.7.1" class="ltx_text ltx_font_bold">34M</span></td>
<td id="S4.T2.12.12.12.8" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.8.1" class="ltx_text">69.60</span></td>
<td id="S4.T2.12.12.12.9" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.9.1" class="ltx_text">79.75</span></td>
<td id="S4.T2.12.12.12.2" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.2.1" class="ltx_text ltx_font_bold">2.77 <math id="S4.T2.12.12.12.2.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.12.12.12.2.1.1.m1.1a"><mo id="S4.T2.12.12.12.2.1.1.m1.1.1" xref="S4.T2.12.12.12.2.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.2.1.1.m1.1b"><times id="S4.T2.12.12.12.2.1.1.m1.1.1.cmml" xref="S4.T2.12.12.12.2.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.2.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T2.14.14.14" class="ltx_tr">
<th id="S4.T2.14.14.14.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T2.14.14.14.3.1" class="ltx_text">RoBERTa</span></th>
<th id="S4.T2.14.14.14.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.14.14.14.4.1" class="ltx_text">FL</span></th>
<th id="S4.T2.14.14.14.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.14.14.14.5.1" class="ltx_text">124M</span></th>
<th id="S4.T2.14.14.14.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.14.14.14.6.1" class="ltx_text">82.64</span></th>
<th id="S4.T2.14.14.14.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.14.14.14.7.1" class="ltx_text">89.75</span></th>
<th id="S4.T2.13.13.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.13.13.13.1.1" class="ltx_text">1.00 <math id="S4.T2.13.13.13.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.13.13.13.1.1.m1.1a"><mo id="S4.T2.13.13.13.1.1.m1.1.1" xref="S4.T2.13.13.13.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.13.1.1.m1.1b"><times id="S4.T2.13.13.13.1.1.m1.1.1.cmml" xref="S4.T2.13.13.13.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.13.1.1.m1.1c">\times</annotation></semantics></math></span></th>
<th id="S4.T2.14.14.14.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.14.14.14.8.1" class="ltx_text">124M</span></th>
<th id="S4.T2.14.14.14.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.14.14.14.9.1" class="ltx_text">81.05</span></th>
<th id="S4.T2.14.14.14.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.14.14.14.10.1" class="ltx_text">89.08</span></th>
<th id="S4.T2.14.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.14.14.14.2.1" class="ltx_text">1.00 <math id="S4.T2.14.14.14.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.14.14.14.2.1.m1.1a"><mo id="S4.T2.14.14.14.2.1.m1.1.1" xref="S4.T2.14.14.14.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.14.2.1.m1.1b"><times id="S4.T2.14.14.14.2.1.m1.1.1.cmml" xref="S4.T2.14.14.14.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.14.2.1.m1.1c">\times</annotation></semantics></math></span></th>
</tr>
<tr id="S4.T2.16.16.16" class="ltx_tr">
<td id="S4.T2.16.16.16.3" class="ltx_td ltx_align_center"><span id="S4.T2.16.16.16.3.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T2.16.16.16.4" class="ltx_td ltx_align_center"><span id="S4.T2.16.16.16.4.1" class="ltx_text ltx_font_bold">90M</span></td>
<td id="S4.T2.16.16.16.5" class="ltx_td ltx_align_center"><span id="S4.T2.16.16.16.5.1" class="ltx_text">82.42</span></td>
<td id="S4.T2.16.16.16.6" class="ltx_td ltx_align_center"><span id="S4.T2.16.16.16.6.1" class="ltx_text">89.71</span></td>
<td id="S4.T2.15.15.15.1" class="ltx_td ltx_align_center"><span id="S4.T2.15.15.15.1.1" class="ltx_text ltx_font_bold">1.61<math id="S4.T2.15.15.15.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.15.15.15.1.1.1.m1.1a"><mo id="S4.T2.15.15.15.1.1.1.m1.1.1" xref="S4.T2.15.15.15.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.15.1.1.1.m1.1b"><times id="S4.T2.15.15.15.1.1.1.m1.1.1.cmml" xref="S4.T2.15.15.15.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.15.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T2.16.16.16.7" class="ltx_td ltx_align_center"><span id="S4.T2.16.16.16.7.1" class="ltx_text ltx_font_bold">89M</span></td>
<td id="S4.T2.16.16.16.8" class="ltx_td ltx_align_center"><span id="S4.T2.16.16.16.8.1" class="ltx_text">80.77</span></td>
<td id="S4.T2.16.16.16.9" class="ltx_td ltx_align_center"><span id="S4.T2.16.16.16.9.1" class="ltx_text">88.83</span></td>
<td id="S4.T2.16.16.16.2" class="ltx_td ltx_align_center"><span id="S4.T2.16.16.16.2.1" class="ltx_text ltx_font_bold">1.64<math id="S4.T2.16.16.16.2.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.16.16.16.2.1.1.m1.1a"><mo id="S4.T2.16.16.16.2.1.1.m1.1.1" xref="S4.T2.16.16.16.2.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.16.2.1.1.m1.1b"><times id="S4.T2.16.16.16.2.1.1.m1.1.1.cmml" xref="S4.T2.16.16.16.2.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.16.2.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T2.18.18.18" class="ltx_tr">
<th id="S4.T2.18.18.18.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T2.18.18.18.3.1" class="ltx_text">
<span id="S4.T2.18.18.18.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.18.18.18.3.1.1.1" class="ltx_tr">
<span id="S4.T2.18.18.18.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">FLAN-T5</span></span>
<span id="S4.T2.18.18.18.3.1.1.2" class="ltx_tr">
<span id="S4.T2.18.18.18.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Small</span></span>
</span></span></th>
<th id="S4.T2.18.18.18.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.18.18.18.4.1" class="ltx_text">FL</span></th>
<th id="S4.T2.18.18.18.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.18.18.18.5.1" class="ltx_text">77M</span></th>
<th id="S4.T2.18.18.18.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.18.18.18.6.1" class="ltx_text">48.65</span></th>
<th id="S4.T2.18.18.18.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.18.18.18.7.1" class="ltx_text">64.43</span></th>
<th id="S4.T2.17.17.17.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.17.17.17.1.1" class="ltx_text">1.00 <math id="S4.T2.17.17.17.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.17.17.17.1.1.m1.1a"><mo id="S4.T2.17.17.17.1.1.m1.1.1" xref="S4.T2.17.17.17.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.17.17.17.1.1.m1.1b"><times id="S4.T2.17.17.17.1.1.m1.1.1.cmml" xref="S4.T2.17.17.17.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.17.17.1.1.m1.1c">\times</annotation></semantics></math></span></th>
<th id="S4.T2.18.18.18.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.18.18.18.8.1" class="ltx_text">77M</span></th>
<th id="S4.T2.18.18.18.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.18.18.18.9.1" class="ltx_text">49.80</span></th>
<th id="S4.T2.18.18.18.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.18.18.18.10.1" class="ltx_text">61.49</span></th>
<th id="S4.T2.18.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.18.18.18.2.1" class="ltx_text">1.00 <math id="S4.T2.18.18.18.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.18.18.18.2.1.m1.1a"><mo id="S4.T2.18.18.18.2.1.m1.1.1" xref="S4.T2.18.18.18.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.18.18.18.2.1.m1.1b"><times id="S4.T2.18.18.18.2.1.m1.1.1.cmml" xref="S4.T2.18.18.18.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.18.18.2.1.m1.1c">\times</annotation></semantics></math></span></th>
</tr>
<tr id="S4.T2.20.20.20" class="ltx_tr">
<td id="S4.T2.20.20.20.3" class="ltx_td ltx_align_center"><span id="S4.T2.20.20.20.3.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T2.20.20.20.4" class="ltx_td ltx_align_center"><span id="S4.T2.20.20.20.4.1" class="ltx_text ltx_font_bold">61M</span></td>
<td id="S4.T2.20.20.20.5" class="ltx_td ltx_align_center"><span id="S4.T2.20.20.20.5.1" class="ltx_text">48.83</span></td>
<td id="S4.T2.20.20.20.6" class="ltx_td ltx_align_center"><span id="S4.T2.20.20.20.6.1" class="ltx_text">64.60</span></td>
<td id="S4.T2.19.19.19.1" class="ltx_td ltx_align_center"><span id="S4.T2.19.19.19.1.1" class="ltx_text ltx_font_bold">1.42<math id="S4.T2.19.19.19.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.19.19.19.1.1.1.m1.1a"><mo id="S4.T2.19.19.19.1.1.1.m1.1.1" xref="S4.T2.19.19.19.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.19.19.19.1.1.1.m1.1b"><times id="S4.T2.19.19.19.1.1.1.m1.1.1.cmml" xref="S4.T2.19.19.19.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.19.19.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T2.20.20.20.7" class="ltx_td ltx_align_center"><span id="S4.T2.20.20.20.7.1" class="ltx_text ltx_font_bold">61M</span></td>
<td id="S4.T2.20.20.20.8" class="ltx_td ltx_align_center"><span id="S4.T2.20.20.20.8.1" class="ltx_text">50.00</span></td>
<td id="S4.T2.20.20.20.9" class="ltx_td ltx_align_center"><span id="S4.T2.20.20.20.9.1" class="ltx_text">61.74</span></td>
<td id="S4.T2.20.20.20.2" class="ltx_td ltx_align_center"><span id="S4.T2.20.20.20.2.1" class="ltx_text ltx_font_bold">1.42<math id="S4.T2.20.20.20.2.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.20.20.20.2.1.1.m1.1a"><mo id="S4.T2.20.20.20.2.1.1.m1.1.1" xref="S4.T2.20.20.20.2.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.20.20.20.2.1.1.m1.1b"><times id="S4.T2.20.20.20.2.1.1.m1.1.1.cmml" xref="S4.T2.20.20.20.2.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.20.20.2.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T2.22.22.22" class="ltx_tr">
<th id="S4.T2.22.22.22.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_bb ltx_border_b ltx_border_t" rowspan="2"><span id="S4.T2.22.22.22.3.1" class="ltx_text">
<span id="S4.T2.22.22.22.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.22.22.22.3.1.1.1" class="ltx_tr">
<span id="S4.T2.22.22.22.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">FLAN-T5</span></span>
<span id="S4.T2.22.22.22.3.1.1.2" class="ltx_tr">
<span id="S4.T2.22.22.22.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Base</span></span>
</span></span></th>
<th id="S4.T2.22.22.22.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.22.22.22.4.1" class="ltx_text">FL</span></th>
<th id="S4.T2.22.22.22.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.22.22.22.5.1" class="ltx_text">248M</span></th>
<th id="S4.T2.22.22.22.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.22.22.22.6.1" class="ltx_text">60.70</span></th>
<th id="S4.T2.22.22.22.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.22.22.22.7.1" class="ltx_text">77.75</span></th>
<th id="S4.T2.21.21.21.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.21.21.21.1.1" class="ltx_text">1.00 <math id="S4.T2.21.21.21.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.21.21.21.1.1.m1.1a"><mo id="S4.T2.21.21.21.1.1.m1.1.1" xref="S4.T2.21.21.21.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.21.21.21.1.1.m1.1b"><times id="S4.T2.21.21.21.1.1.m1.1.1.cmml" xref="S4.T2.21.21.21.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.21.21.21.1.1.m1.1c">\times</annotation></semantics></math></span></th>
<th id="S4.T2.22.22.22.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.22.22.22.8.1" class="ltx_text">248M</span></th>
<th id="S4.T2.22.22.22.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.22.22.22.9.1" class="ltx_text">67.22</span></th>
<th id="S4.T2.22.22.22.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.22.22.22.10.1" class="ltx_text">80.24</span></th>
<th id="S4.T2.22.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.22.22.22.2.1" class="ltx_text">1.00 <math id="S4.T2.22.22.22.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.22.22.22.2.1.m1.1a"><mo id="S4.T2.22.22.22.2.1.m1.1.1" xref="S4.T2.22.22.22.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.22.22.22.2.1.m1.1b"><times id="S4.T2.22.22.22.2.1.m1.1.1.cmml" xref="S4.T2.22.22.22.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.22.22.22.2.1.m1.1c">\times</annotation></semantics></math></span></th>
</tr>
<tr id="S4.T2.24.24.24" class="ltx_tr">
<td id="S4.T2.24.24.24.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.24.24.24.3.1" class="ltx_text">RaFFM</span></td>
<td id="S4.T2.24.24.24.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.24.24.24.4.1" class="ltx_text ltx_font_bold">163M</span></td>
<td id="S4.T2.24.24.24.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.24.24.24.5.1" class="ltx_text">60.92</span></td>
<td id="S4.T2.24.24.24.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.24.24.24.6.1" class="ltx_text">78.01</span></td>
<td id="S4.T2.23.23.23.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.23.23.23.1.1" class="ltx_text ltx_font_bold">1.88<math id="S4.T2.23.23.23.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.23.23.23.1.1.1.m1.1a"><mo id="S4.T2.23.23.23.1.1.1.m1.1.1" xref="S4.T2.23.23.23.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.23.23.23.1.1.1.m1.1b"><times id="S4.T2.23.23.23.1.1.1.m1.1.1.cmml" xref="S4.T2.23.23.23.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.23.23.23.1.1.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T2.24.24.24.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.24.24.24.7.1" class="ltx_text ltx_font_bold">164M</span></td>
<td id="S4.T2.24.24.24.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.24.24.24.8.1" class="ltx_text">67.67</span></td>
<td id="S4.T2.24.24.24.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.24.24.24.9.1" class="ltx_text">80.33</span></td>
<td id="S4.T2.24.24.24.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T2.24.24.24.2.1" class="ltx_text ltx_font_bold">1.86<math id="S4.T2.24.24.24.2.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.24.24.24.2.1.1.m1.1a"><mo id="S4.T2.24.24.24.2.1.1.m1.1.1" xref="S4.T2.24.24.24.2.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.24.24.24.2.1.1.m1.1b"><times id="S4.T2.24.24.24.2.1.1.m1.1.1.cmml" xref="S4.T2.24.24.24.2.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.24.24.24.2.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">Further, we evaluate RaFFM on the Stanford Question Answering Dataset (SQuAD and SQuAD-V2) <cite class="ltx_cite ltx_citemacro_citep">(Rajpurkar et al., <a href="#bib.bib29" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
<div id="S4.SS2.SSS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS2.p2.1" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.2.2 Results on Question Answering Benchmark ‣ 4.2 Learning Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the results across various models. Impressively, RaFFM consistently speeds up the training process on both SQuAD tasks. Taking BERT-Large as an example, RaFFM accelerates FL training (measured in GPU hours) by a factor of 6.59. Remarkably, despite deploying substantially trimmed models at edge clients, RaFFM’s efficiency advantage does not come at the cost of model performance. Indeed, in cases like FLAN-T5 base and BERT-Large, RaFFM’s performance even eclipses that of full-size FL deployments.</p>
</div>
<div id="S4.SS2.SSS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS2.p3.1" class="ltx_p">We further evaluate the parameter efficiency—especially vital in resource-tight FL settings. Figure <a href="#S4.F2" title="Figure 2 ‣ 4.3 Results on Computer Vision Tasks ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (a) and (b) visually depict RaFFM’s supremacy in parameter efficiency (higher values are preferable). As an illustrative point, in BERT-Large, RaFFM, with an average model size of 95M parameters, posts an Exact Match score of 83.34 and an F1 score of 90.87 on SQuAD, which stands in stark contrast to full-size FM deployment in FL, and the efficiency translates to a speed-up of 3.52 times.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results on Computer Vision Tasks</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">In addition to our evaluations on NLP benchmarks, we extended our assessment to ascertain the efficacy of RaFFM on computer vision (CV) tasks, specifically leveraging the Vision Transformer (ViT) <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>.
As shown in Table <a href="#S4.T3" title="Table 3 ‣ 4.3 Results on Computer Vision Tasks ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we fine-tune ViT with 12-shot learning. The results corroborate RaFFM’s consistent performance metrics on CV tasks. Specifically, in line with our findings from NLP benchmarks, RaFFM demonstrated a marked superiority in the training acceleration. Additionally, the reduced communication overhead and negligible compromise in model performance further underline its efficiency and robustness.</p>
</div>
<figure id="S4.F2" class="ltx_figure">
<div id="S4.F2.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:81pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(1.4pt,-0.3pt) scale(1.00633207890574,1.00633207890574) ;"><img src="/html/2310.00247/assets/x2.png" id="S4.F2.1.g1" class="ltx_graphics ltx_img_landscape" width="346" height="82" alt="Refer to caption"><img src="/html/2310.00247/assets/x3.png" id="S4.F2.2.g2" class="ltx_graphics ltx_img_landscape" width="106" height="85" alt="Refer to caption">
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>(a) parameter efficiency on SQuAD benchmark. (b) parameter efficiency on SQuAD-V2 benchmark. (c) Average communication footprint per communication round. (d) Communication cost in GLUE benchmark</figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Few-shot learning results on Vision Transformer</figcaption>
<div id="S4.T3.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:49.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-86.9pt,11.1pt) scale(0.691770508893993,0.691770508893993) ;">
<table id="S4.T3.2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.2.2.3.1" class="ltx_tr">
<th id="S4.T3.2.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T3.2.2.3.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S4.T3.2.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T3.2.2.3.1.2.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T3.2.2.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T3.2.2.3.1.3.1" class="ltx_text">
<span id="S4.T3.2.2.3.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.2.2.3.1.3.1.1.1" class="ltx_tr">
<span id="S4.T3.2.2.3.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T3.2.2.3.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">Training</span></span></span>
<span id="S4.T3.2.2.3.1.3.1.1.2" class="ltx_tr">
<span id="S4.T3.2.2.3.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T3.2.2.3.1.3.1.1.2.1.1" class="ltx_text ltx_font_bold">Accel.</span></span></span>
</span></span></th>
<th id="S4.T3.2.2.3.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T3.2.2.3.1.4.1" class="ltx_text">
<span id="S4.T3.2.2.3.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.2.2.3.1.4.1.1.1" class="ltx_tr">
<span id="S4.T3.2.2.3.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T3.2.2.3.1.4.1.1.1.1.1" class="ltx_text ltx_font_bold">Communication</span></span></span>
<span id="S4.T3.2.2.3.1.4.1.1.2" class="ltx_tr">
<span id="S4.T3.2.2.3.1.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T3.2.2.3.1.4.1.1.2.1.1" class="ltx_text ltx_font_bold">Traffic/Client</span></span></span>
</span></span></th>
<th id="S4.T3.2.2.3.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T3.2.2.3.1.5.1" class="ltx_text ltx_font_bold">#Param</span></th>
<th id="S4.T3.2.2.3.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="2"><span id="S4.T3.2.2.3.1.6.1" class="ltx_text ltx_font_bold">CIFAR-10</span></th>
<th id="S4.T3.2.2.3.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="2"><span id="S4.T3.2.2.3.1.7.1" class="ltx_text ltx_font_bold">CIFAR-100</span></th>
<th id="S4.T3.2.2.3.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="2"><span id="S4.T3.2.2.3.1.8.1" class="ltx_text ltx_font_bold">Flower102</span></th>
</tr>
<tr id="S4.T3.2.2.4.2" class="ltx_tr">
<td id="S4.T3.2.2.4.2.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.2.2.4.2.1.1" class="ltx_text ltx_font_bold">Accuracy</span></td>
<td id="S4.T3.2.2.4.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.2.2.4.2.2.1" class="ltx_text ltx_font_bold">F1</span></td>
<td id="S4.T3.2.2.4.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.2.2.4.2.3.1" class="ltx_text ltx_font_bold">Accuracy</span></td>
<td id="S4.T3.2.2.4.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.2.2.4.2.4.1" class="ltx_text ltx_font_bold">F1</span></td>
<td id="S4.T3.2.2.4.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.2.2.4.2.5.1" class="ltx_text ltx_font_bold">Accuracy</span></td>
<td id="S4.T3.2.2.4.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.2.2.4.2.6.1" class="ltx_text ltx_font_bold">F1</span></td>
</tr>
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_bb ltx_border_b ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T3.1.1.1.2.1" class="ltx_text">ViT</span></th>
<th id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">FL</th>
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><math id="S4.T3.1.1.1.1.m1.1" class="ltx_math_unparsed" alttext="1.00\times" display="inline"><semantics id="S4.T3.1.1.1.1.m1.1a"><mrow id="S4.T3.1.1.1.1.m1.1b"><mn id="S4.T3.1.1.1.1.m1.1.1">1.00</mn><mo lspace="0.222em" id="S4.T3.1.1.1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">1.00\times</annotation></semantics></math></th>
<th id="S4.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">360.87MB</th>
<th id="S4.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">86M</th>
<th id="S4.T3.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">97.26%</th>
<th id="S4.T3.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">97.26%</th>
<th id="S4.T3.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">91.26%</th>
<th id="S4.T3.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">91.27%</th>
<th id="S4.T3.1.1.1.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">94.71%</th>
<th id="S4.T3.1.1.1.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">94.56%</th>
</tr>
<tr id="S4.T3.2.2.2" class="ltx_tr">
<td id="S4.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">RaFFM</td>
<td id="S4.T3.2.2.2.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><math id="S4.T3.2.2.2.1.m1.1" class="ltx_math_unparsed" alttext="\textbf{1.76}\times" display="inline"><semantics id="S4.T3.2.2.2.1.m1.1a"><mrow id="S4.T3.2.2.2.1.m1.1b"><mtext class="ltx_mathvariant_bold" id="S4.T3.2.2.2.1.m1.1.1">1.76</mtext><mo lspace="0.222em" id="S4.T3.2.2.2.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S4.T3.2.2.2.1.m1.1c">\textbf{1.76}\times</annotation></semantics></math></td>
<td id="S4.T3.2.2.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T3.2.2.2.3.1" class="ltx_text ltx_font_bold">247.57MB</span></td>
<td id="S4.T3.2.2.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T3.2.2.2.4.1" class="ltx_text ltx_font_bold">59M</span></td>
<td id="S4.T3.2.2.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">96.27%</td>
<td id="S4.T3.2.2.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">96.26%</td>
<td id="S4.T3.2.2.2.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">90.37%</td>
<td id="S4.T3.2.2.2.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">90.39%</td>
<td id="S4.T3.2.2.2.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">94.29%</td>
<td id="S4.T3.2.2.2.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">94.09%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p">Conclusively, RaFFM offers an excellent balance between performance and computational efficiency. With fewer parameters and higher speed-up factors, it provides a viable alternative to more computationally intensive models without perceptible degradation in performance.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Communication Efficiency</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p">A key challenge in FL is the substantial communication cost, often due to frequent model weights or gradients sharing between edge devices and the central server.
Figure <a href="#S4.F2" title="Figure 2 ‣ 4.3 Results on Computer Vision Tasks ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (c) illustrates the average communication footprint of a client in each round under various FMs. RaFFM substantially reduces communication costs at the client level. The rationale is straightforward: its resource-aware model deployment leads to more compact models at the edge. Consequently, there is less information to relay between the edge devices and the server, reducing communication burdens.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p">Additionally, we optimized FMs to meet specific performance benchmarks (set to the average median convergence accuracy). We monitored the network traffic induced by the training process during communication. As highlighted in Table <a href="#S4.T4" title="Table 4 ‣ 4.4 Communication Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, it consistently underlines RaFFM’s superiority in minimizing communication costs across all experimental setups.
Furthermore, Figure <a href="#S4.F2" title="Figure 2 ‣ 4.3 Results on Computer Vision Tasks ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (d) showcases the network traffic needed to achieve the average median convergence performance on the GLUE benchmark. RaFFM also consistently outperforms full-size model deployment, evidencing significantly decreased average communication cost across different FMs.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Communication cost for achieving target performance on QA benchmark</figcaption>
<div id="S4.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:278.2pt;height:195.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-91.8pt,64.4pt) scale(0.602499889310866,0.602499889310866) ;">
<table id="S4.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.2.1" class="ltx_tr">
<th id="S4.T4.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T4.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S4.T4.1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T4.1.1.2.1.2.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T4.1.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T4.1.1.2.1.3.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S4.T4.1.1.2.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T4.1.1.2.1.4.1" class="ltx_text">
<span id="S4.T4.1.1.2.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T4.1.1.2.1.4.1.1.1" class="ltx_tr">
<span id="S4.T4.1.1.2.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T4.1.1.2.1.4.1.1.1.1.1" class="ltx_text ltx_font_bold">Target Performance</span></span></span>
<span id="S4.T4.1.1.2.1.4.1.1.2" class="ltx_tr">
<span id="S4.T4.1.1.2.1.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T4.1.1.2.1.4.1.1.2.1.1" class="ltx_text ltx_font_bold">(F1 Score)</span></span></span>
</span></span></th>
<th id="S4.T4.1.1.2.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="3"><span id="S4.T4.1.1.2.1.5.1" class="ltx_text ltx_font_bold">Communication Cost</span></th>
</tr>
<tr id="S4.T4.1.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.1.2.1" class="ltx_text ltx_font_bold">Traffic/Client</span></td>
<td id="S4.T4.1.1.1.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">Total</span></td>
<td id="S4.T4.1.1.1.1" class="ltx_td ltx_align_center">
<math id="S4.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S4.T4.1.1.1.1.m1.1a"><mi mathvariant="normal" id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">\Delta</annotation></semantics></math><span id="S4.T4.1.1.1.1.1" class="ltx_text ltx_font_bold"> Cost</span>
</td>
</tr>
<tr id="S4.T4.1.1.3.2" class="ltx_tr">
<th id="S4.T4.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="4"><span id="S4.T4.1.1.3.2.1.1" class="ltx_text">BERT-Large</span></th>
<th id="S4.T4.1.1.3.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">FL</th>
<th id="S4.T4.1.1.3.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T4.1.1.3.2.3.1" class="ltx_text">SQUADv1</span></th>
<th id="S4.T4.1.1.3.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T4.1.1.3.2.4.1" class="ltx_text">85%</span></th>
<th id="S4.T4.1.1.3.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">1401MB</th>
<th id="S4.T4.1.1.3.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t">109.45GB</th>
<th id="S4.T4.1.1.3.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T4.1.1.3.2.7.1" class="ltx_text ltx_font_bold">-62.81GB</span></th>
</tr>
<tr id="S4.T4.1.1.4.3" class="ltx_tr">
<td id="S4.T4.1.1.4.3.1" class="ltx_td ltx_align_center">RaFFM</td>
<td id="S4.T4.1.1.4.3.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.4.3.2.1" class="ltx_text ltx_font_bold">398MB</span></td>
<td id="S4.T4.1.1.4.3.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.4.3.3.1" class="ltx_text ltx_font_bold">46.64GB</span></td>
</tr>
<tr id="S4.T4.1.1.5.4" class="ltx_tr">
<th id="S4.T4.1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">FL</th>
<th id="S4.T4.1.1.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.5.4.2.1" class="ltx_text">SUQADv2</span></th>
<th id="S4.T4.1.1.5.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.5.4.3.1" class="ltx_text">90.09%</span></th>
<th id="S4.T4.1.1.5.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">1401MB</th>
<th id="S4.T4.1.1.5.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">73.88 GB</th>
<th id="S4.T4.1.1.5.4.6" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.5.4.6.1" class="ltx_text ltx_font_bold">-49.41 GB</span></th>
</tr>
<tr id="S4.T4.1.1.6.5" class="ltx_tr">
<td id="S4.T4.1.1.6.5.1" class="ltx_td ltx_align_center">RaFFM</td>
<td id="S4.T4.1.1.6.5.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.6.5.2.1" class="ltx_text ltx_font_bold">432MB</span></td>
<td id="S4.T4.1.1.6.5.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.6.5.3.1" class="ltx_text ltx_font_bold">24.47 GB</span></td>
</tr>
<tr id="S4.T4.1.1.7.6" class="ltx_tr">
<th id="S4.T4.1.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="4"><span id="S4.T4.1.1.7.6.1.1" class="ltx_text">DistillBERT</span></th>
<th id="S4.T4.1.1.7.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FL</th>
<th id="S4.T4.1.1.7.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.7.6.3.1" class="ltx_text">SQUADv1</span></th>
<th id="S4.T4.1.1.7.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.7.6.4.1" class="ltx_text">80.15%</span></th>
<th id="S4.T4.1.1.7.6.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">281.14MB</th>
<th id="S4.T4.1.1.7.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">29.65 GB</th>
<th id="S4.T4.1.1.7.6.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.7.6.7.1" class="ltx_text ltx_font_bold">-2.34 GB</span></th>
</tr>
<tr id="S4.T4.1.1.8.7" class="ltx_tr">
<td id="S4.T4.1.1.8.7.1" class="ltx_td ltx_align_center">RaFFM</td>
<td id="S4.T4.1.1.8.7.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.8.7.2.1" class="ltx_text ltx_font_bold">142.67MB</span></td>
<td id="S4.T4.1.1.8.7.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.8.7.3.1" class="ltx_text ltx_font_bold">27.31 GB</span></td>
</tr>
<tr id="S4.T4.1.1.9.8" class="ltx_tr">
<th id="S4.T4.1.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">FL</th>
<th id="S4.T4.1.1.9.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.9.8.2.1" class="ltx_text">SQUADv2</span></th>
<th id="S4.T4.1.1.9.8.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.9.8.3.1" class="ltx_text">79.55%</span></th>
<th id="S4.T4.1.1.9.8.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">281.14MB</th>
<th id="S4.T4.1.1.9.8.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">50.52 GB</th>
<th id="S4.T4.1.1.9.8.6" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.9.8.6.1" class="ltx_text ltx_font_bold">-24.88 GB</span></th>
</tr>
<tr id="S4.T4.1.1.10.9" class="ltx_tr">
<td id="S4.T4.1.1.10.9.1" class="ltx_td ltx_align_center">RaFFM</td>
<td id="S4.T4.1.1.10.9.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.10.9.2.1" class="ltx_text ltx_font_bold">142.67MB</span></td>
<td id="S4.T4.1.1.10.9.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.10.9.3.1" class="ltx_text ltx_font_bold">25.64 GB</span></td>
</tr>
<tr id="S4.T4.1.1.11.10" class="ltx_tr">
<th id="S4.T4.1.1.11.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="4"><span id="S4.T4.1.1.11.10.1.1" class="ltx_text">
<span id="S4.T4.1.1.11.10.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T4.1.1.11.10.1.1.1.1" class="ltx_tr">
<span id="S4.T4.1.1.11.10.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">FLAN-T5</span></span>
<span id="S4.T4.1.1.11.10.1.1.1.2" class="ltx_tr">
<span id="S4.T4.1.1.11.10.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Base</span></span>
</span></span></th>
<th id="S4.T4.1.1.11.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FL</th>
<th id="S4.T4.1.1.11.10.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.11.10.3.1" class="ltx_text">SQUADv1</span></th>
<th id="S4.T4.1.1.11.10.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.11.10.4.1" class="ltx_text">77.28%</span></th>
<th id="S4.T4.1.1.11.10.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1038.60MB</th>
<th id="S4.T4.1.1.11.10.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">223.14GB</th>
<th id="S4.T4.1.1.11.10.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.11.10.7.1" class="ltx_text ltx_font_bold">-75.36GB</span></th>
</tr>
<tr id="S4.T4.1.1.12.11" class="ltx_tr">
<td id="S4.T4.1.1.12.11.1" class="ltx_td ltx_align_center">RaFFM</td>
<td id="S4.T4.1.1.12.11.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.12.11.2.1" class="ltx_text ltx_font_bold">687.81MB</span></td>
<td id="S4.T4.1.1.12.11.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.12.11.3.1" class="ltx_text ltx_font_bold">147.78GB</span></td>
</tr>
<tr id="S4.T4.1.1.13.12" class="ltx_tr">
<th id="S4.T4.1.1.13.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">FL</th>
<th id="S4.T4.1.1.13.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.13.12.2.1" class="ltx_text">SQUADv2</span></th>
<th id="S4.T4.1.1.13.12.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.13.12.3.1" class="ltx_text">79.86%</span></th>
<th id="S4.T4.1.1.13.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">1038.60MB</th>
<th id="S4.T4.1.1.13.12.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">547.70GB</th>
<th id="S4.T4.1.1.13.12.6" class="ltx_td ltx_align_center ltx_th ltx_th_column" rowspan="2"><span id="S4.T4.1.1.13.12.6.1" class="ltx_text ltx_font_bold">-225.02GB</span></th>
</tr>
<tr id="S4.T4.1.1.14.13" class="ltx_tr">
<td id="S4.T4.1.1.14.13.1" class="ltx_td ltx_align_center">RaFFM</td>
<td id="S4.T4.1.1.14.13.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.14.13.2.1" class="ltx_text ltx_font_bold">688.40MB</span></td>
<td id="S4.T4.1.1.14.13.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.14.13.3.1" class="ltx_text ltx_font_bold">322.68GB</span></td>
</tr>
<tr id="S4.T4.1.1.15.14" class="ltx_tr">
<th id="S4.T4.1.1.15.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_bb ltx_border_b ltx_border_t" rowspan="4"><span id="S4.T4.1.1.15.14.1.1" class="ltx_text">
<span id="S4.T4.1.1.15.14.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T4.1.1.15.14.1.1.1.1" class="ltx_tr">
<span id="S4.T4.1.1.15.14.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">FLAN-T5</span></span>
<span id="S4.T4.1.1.15.14.1.1.1.2" class="ltx_tr">
<span id="S4.T4.1.1.15.14.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Small</span></span>
</span></span></th>
<th id="S4.T4.1.1.15.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FL</th>
<th id="S4.T4.1.1.15.14.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.15.14.3.1" class="ltx_text">SQUADv1</span></th>
<th id="S4.T4.1.1.15.14.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.15.14.4.1" class="ltx_text">61.45%</span></th>
<th id="S4.T4.1.1.15.14.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">322.39MB</th>
<th id="S4.T4.1.1.15.14.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">88.16GB</th>
<th id="S4.T4.1.1.15.14.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.15.14.7.1" class="ltx_text ltx_font_bold">-33.28GB</span></th>
</tr>
<tr id="S4.T4.1.1.16.15" class="ltx_tr">
<td id="S4.T4.1.1.16.15.1" class="ltx_td ltx_align_center">RaFFM</td>
<td id="S4.T4.1.1.16.15.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.16.15.2.1" class="ltx_text ltx_font_bold">255.32MB</span></td>
<td id="S4.T4.1.1.16.15.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.1.16.15.3.1" class="ltx_text ltx_font_bold">54.88GB</span></td>
</tr>
<tr id="S4.T4.1.1.17.16" class="ltx_tr">
<th id="S4.T4.1.1.17.16.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">FL</th>
<th id="S4.T4.1.1.17.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_bb ltx_border_b" rowspan="2"><span id="S4.T4.1.1.17.16.2.1" class="ltx_text">SQUADv2</span></th>
<th id="S4.T4.1.1.17.16.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_bb ltx_border_b" rowspan="2"><span id="S4.T4.1.1.17.16.3.1" class="ltx_text">60.89%</span></th>
<th id="S4.T4.1.1.17.16.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">322.39MB</th>
<th id="S4.T4.1.1.17.16.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">75.56GB</th>
<th id="S4.T4.1.1.17.16.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_bb ltx_border_b" rowspan="2"><span id="S4.T4.1.1.17.16.6.1" class="ltx_text ltx_font_bold">-5.70GB</span></th>
</tr>
<tr id="S4.T4.1.1.18.17" class="ltx_tr">
<td id="S4.T4.1.1.18.17.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">RaFFM</td>
<td id="S4.T4.1.1.18.17.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T4.1.1.18.17.2.1" class="ltx_text ltx_font_bold">255.48MB</span></td>
<td id="S4.T4.1.1.18.17.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T4.1.1.18.17.3.1" class="ltx_text ltx_font_bold">69.86GB</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Resource Efficiency</h3>

<figure id="S4.F3" class="ltx_figure">
<div id="S4.F3.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:107pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-5.0pt,1.2pt) scale(0.97745821830567,0.97745821830567) ;"><img src="/html/2310.00247/assets/x4.png" id="S4.F3.1.g1" class="ltx_graphics ltx_img_square" width="115" height="115" alt="Refer to caption"><img src="/html/2310.00247/assets/x5.png" id="S4.F3.2.g2" class="ltx_graphics ltx_img_square" width="115" height="115" alt="Refer to caption"><img src="/html/2310.00247/assets/x6.png" id="S4.F3.3.g3" class="ltx_graphics ltx_img_square" width="115" height="115" alt="Refer to caption"><img src="/html/2310.00247/assets/x7.png" id="S4.F3.4.g4" class="ltx_graphics ltx_img_square" width="115" height="115" alt="Refer to caption">
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>(a) Lowest system resource requirements for deploying various FMs in FL.
(b) System requirements for achieving target performance.
(c) Question answering performance under various resource budgets.
(d) Glue score under various resource budgets.
</figcaption>
</figure>
<section id="S4.SS5.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.1 </span>System Resource Efficiency</h4>

<div id="S4.SS5.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS5.SSS1.p1.1" class="ltx_p">Traditional FL approaches often suffer inefficient system resource utilization. When identical models are dispatched to both high-end and resource-constrained devices, the latter often dictates the constraints, compelling the entire system to conform to its limitations. This results in inflated system requirements and often leaves high-end devices underutilized.
Figure <a href="#S4.F3" title="Figure 3 ‣ 4.5 Resource Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (a) elucidates this challenge, showcasing the minimum system resource prerequisites for various FMs within a 100-client FL system to achieve the median F1 scores as detailed in Table <a href="#S4.T2" title="Table 2 ‣ 4.2.2 Results on Question Answering Benchmark ‣ 4.2 Learning Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. The baseline FL has lofty uniform resource demands, whereas RaFFM, illustrated through box plots, showcases a range of resource allocations wherein it attains the target performance. Evidently, RaFFM exhibits enhanced system resource efficiency, paving the way for a more cost-effective FL setup in terms of hardware requirements.</p>
</div>
<div id="S4.SS5.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS5.SSS1.p2.1" class="ltx_p">Further clarity is provided in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.5 Resource Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (b), which shows the system requirements of RoBERTa deployments for different performance levels on the SST-2 dataset. The red dashed line represents full-size FM deployment in traditional FL, which indicates high baseline system requirements, irrespective of the performance target. Conversely, RaFFM, depicted by the box plot, offers a flexible range of system requirements to attain similar performance outcomes. This adaptability of RaFFM enables dynamic system budget adjustments based on performance goals, maximizing resource efficiency and preventing unnecessary expenditures.</p>
</div>
<div id="S4.SS5.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS5.SSS1.p3.1" class="ltx_p">In Figure <a href="#S4.F3" title="Figure 3 ‣ 4.5 Resource Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (c) and (d), we further assess RaFFM’s robustness amidst a variety of system resource constraints, spanning Xlarge to XSmall budget categories. The findings underscore RaFFM’s consistency: even as resources swell or dwindle, its performance remains steadfast, signifying its adaptability in heterogeneous resource environments.</p>
</div>
</section>
<section id="S4.SS5.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.2 </span>Edge Resource Efficiency</h4>

<figure id="S4.F4" class="ltx_figure">
<div id="S4.F4.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:97.4pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-26.7pt,5.9pt) scale(0.890423082344956,0.890423082344956) ;"><img src="/html/2310.00247/assets/x8.png" id="S4.F4.1.g1" class="ltx_graphics ltx_img_square" width="115" height="115" alt="Refer to caption"><img src="/html/2310.00247/assets/x9.png" id="S4.F4.2.g2" class="ltx_graphics ltx_img_square" width="115" height="115" alt="Refer to caption"><img src="/html/2310.00247/assets/x10.png" id="S4.F4.3.g3" class="ltx_graphics ltx_img_landscape" width="161" height="115" alt="Refer to caption"><img src="/html/2310.00247/assets/x11.png" id="S4.F4.4.g4" class="ltx_graphics ltx_img_square" width="115" height="115" alt="Refer to caption">
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>(a) Resource distribution heat map of two distinct FL systems. (b) Client local model performance on SST-2 in distinct FL systems. (c) Heat map of local model performance under different model sizes. (d) Resource utilization efficiency in the training stage and inference stage.</figcaption>
</figure>
<div id="S4.SS5.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS5.SSS2.p1.1" class="ltx_p">In FL, not only do system-wide resource requirements matter, but individual client resources also play a pivotal role. Given the varied resource capacities of individual clients, ensuring stable performance of resource-aware models on these clients becomes crucial.</p>
</div>
<div id="S4.SS5.SSS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS5.SSS2.p2.1" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ 4.5.2 Edge Resource Efficiency ‣ 4.5 Resource Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (a) and (b) depict two distinct resource budget FL systems. The distribution heat map of clients’ resources for these two setups is showcased in (a). Figure <a href="#S4.F4" title="Figure 4 ‣ 4.5.2 Edge Resource Efficiency ‣ 4.5 Resource Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (b) depicts local clients’ performances, demonstrating the stability of local clients’ performance: even with notable variations in local resources, every client’s performance aligns closely with its peers. This inherent stability is further emphasized when comparing the two different FL systems; despite the system disparities, the local model performance across the two systems remains stable.
This consistency is underscored by Figure <a href="#S4.F4" title="Figure 4 ‣ 4.5.2 Edge Resource Efficiency ‣ 4.5 Resource Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (c), which plots the relationship between local model size and its achieved performance. Interestingly, even as the model sizes differ, each maintains commendable local performance.
To sum up, RaFFM showcases its prowess in adeptly navigating resource heterogeneity, ensuring that performance remains stable at the client level.</p>
</div>
</section>
<section id="S4.SS5.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.3 </span>Edge Inference Efficiency</h4>

<div id="S4.SS5.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS5.SSS3.p1.1" class="ltx_p">The resource consumption during the training phase is usually at least seven times that of the inference phase.
This disparity means that FL often faces resource-hungry during model training while leaving resources underutilized during inference.</p>
</div>
<div id="S4.SS5.SSS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS5.SSS3.p2.1" class="ltx_p">The mentioned observation is depicted in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.5.2 Edge Resource Efficiency ‣ 4.5 Resource Efficiency ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (d), which delineates the resource utilization efficiency during both training and inference phases for edge clients.
RaFFM, with its inherent FM scaling components,
enables the post-training deployment of relatively larger models at the edge during the inference stage, hence increasing the model performance and resource utilization.</p>
</div>
</section>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Enhancing RaFFM with Efficient Fine-tuning: A Case with LoRA</h3>

<div id="S4.SS6.p1" class="ltx_para ltx_noindent">
<p id="S4.SS6.p1.1" class="ltx_p">Incorporating parameter efficient fine-tuning (PEFT) methods like LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib10" title="" class="ltx_ref">2021</a>)</cite> into RaFFM holds potential for optimized performance, especially when dealing with large language models (LLMs) in an FL setting. Though PEFTs such as LoRA can markedly trim the trainable parameters of LLMs—often to less than 1% of the total parameters—it’s essential to note that the full-size weights and activations are still retained during training. This results in substantial memory overheads.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para ltx_noindent">
<p id="S4.SS6.p2.1" class="ltx_p">To investigate the benefits of this synergy, we paired RaFFM with LoRA and fine-tuned the LLaMA2 model <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite> using the preprocessed instruction math question answering dataset, SVAMP <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib11" title="" class="ltx_ref">2023</a>; Patel et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite>. This dataset was partitioned among 10 FL clients for the experiments.
Table <a href="#S4.T5" title="Table 5 ‣ 4.6 Enhancing RaFFM with Efficient Fine-tuning: A Case with LoRA ‣ 4 Experiments ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> highlights the strengths of the RaFFM-LoRA combination. Specifically, compared to a full-size model paired with LoRA in an FL context, RaFFM coupled with LoRA demonstrates enhanced communication efficiency and a marked acceleration in inference.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Efficient instruction tuning on LLM</figcaption>
<div id="S4.T5.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:303.5pt;height:54.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-63.2pt,11.4pt) scale(0.706162515182146,0.706162515182146) ;">
<table id="S4.T5.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T5.1.1.1.2.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S4.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T5.1.1.1.3.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T5.1.1.1.4.1" class="ltx_text ltx_font_bold">Adapter</span></th>
<th id="S4.T5.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T5.1.1.1.5.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S4.T5.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T5.1.1.1.6.1" class="ltx_text ltx_font_bold">#Clients</span></th>
<th id="S4.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T5.1.1.1.1.1" class="ltx_text">
<span id="S4.T5.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T5.1.1.1.1.1.1.2" class="ltx_tr">
<span id="S4.T5.1.1.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T5.1.1.1.1.1.1.2.1.1" class="ltx_text ltx_font_bold">Avg.</span></span></span>
<span id="S4.T5.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T5.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T5.1.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Memory </span><math id="S4.T5.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T5.1.1.1.1.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T5.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.T5.1.1.1.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.1.1.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math></span></span>
</span></span></th>
<th id="S4.T5.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T5.1.1.1.7.1" class="ltx_text">
<span id="S4.T5.1.1.1.7.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T5.1.1.1.7.1.1.1" class="ltx_tr">
<span id="S4.T5.1.1.1.7.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T5.1.1.1.7.1.1.1.1.1" class="ltx_text ltx_font_bold">#Trainable</span></span></span>
<span id="S4.T5.1.1.1.7.1.1.2" class="ltx_tr">
<span id="S4.T5.1.1.1.7.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T5.1.1.1.7.1.1.2.1.1" class="ltx_text ltx_font_bold">Param</span></span></span>
</span></span></th>
<th id="S4.T5.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t"><span id="S4.T5.1.1.1.8.1" class="ltx_text ltx_font_bold">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.2.2.2" class="ltx_tr">
<td id="S4.T5.2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T5.2.2.2.2.1" class="ltx_text">LLaMA-2</span></td>
<td id="S4.T5.2.2.2.3" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t">FL</td>
<td id="S4.T5.2.2.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T5.2.2.2.4.1" class="ltx_text">LoRA</span></td>
<td id="S4.T5.2.2.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T5.2.2.2.5.1" class="ltx_text">SVAMP</span></td>
<td id="S4.T5.2.2.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_tt ltx_border_t" rowspan="2"><span id="S4.T5.2.2.2.6.1" class="ltx_text">10</span></td>
<td id="S4.T5.2.2.2.1" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t">1.00 <math id="S4.T5.2.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T5.2.2.2.1.m1.1a"><mo id="S4.T5.2.2.2.1.m1.1.1" xref="S4.T5.2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.2.1.m1.1b"><times id="S4.T5.2.2.2.1.m1.1.1.cmml" xref="S4.T5.2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.2.1.m1.1c">\times</annotation></semantics></math>
</td>
<td id="S4.T5.2.2.2.7" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t">262.41M</td>
<td id="S4.T5.2.2.2.8" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t">53.44%</td>
</tr>
<tr id="S4.T5.3.3.3" class="ltx_tr">
<td id="S4.T5.3.3.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">RaFFM</td>
<td id="S4.T5.3.3.3.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T5.3.3.3.1.1" class="ltx_text ltx_font_bold">1.63 <math id="S4.T5.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T5.3.3.3.1.1.m1.1a"><mo id="S4.T5.3.3.3.1.1.m1.1.1" xref="S4.T5.3.3.3.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T5.3.3.3.1.1.m1.1b"><times id="S4.T5.3.3.3.1.1.m1.1.1.cmml" xref="S4.T5.3.3.3.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.3.3.1.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T5.3.3.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S4.T5.3.3.3.3.1" class="ltx_text ltx_font_bold">189.72M</span></td>
<td id="S4.T5.3.3.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b">52.80%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We propose RaFFM addressing the challenges when deploy FMs to resource-heterogeneous FL systems. RaFFM introduced specialized FM compression algorithms for edge-FL system that allows scaling down the FM to edge constraints. The experiments demonstrate RaFFM’s capability to optimize resource utilization during FL’s life cycle, showing its potential for resource-efficient FL.
Moreover, the flexibility of RaFFM allows for accelerated LLM fine-tuning in FL with PEFT. Nevertheless, it is essential to recognize the limitations of our approach. Notably, certain foundation models, even post-compression – such as Llama-7B – remain unsuitable for deployment on resource-constrained edge devices in FL settings. Addressing this limitation necessitates advancements in both hardware technology and algorithmic strategies, marking a promising avenue for our future research endeavors.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blalock et al. (2020)</span>
<span class="ltx_bibblock">
Davis W. Blalock, Jose Javier Gonzalez Ortiz, Jonathan Frankle, and John V. Guttag.

</span>
<span class="ltx_bibblock">What is the state of neural network pruning?

</span>
<span class="ltx_bibblock">In Inderjit S. Dhillon, Dimitris S. Papailiopoulos, and Vivienne Sze (eds.), <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">MLSys</em>. mlsys.org, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://dblp.uni-trier.de/db/conf/mlsys/mlsys2020.html#BlalockOFG20" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dblp.uni-trier.de/db/conf/mlsys/mlsys2020.html#BlalockOFG20</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bommasani et al. (2021)</span>
<span class="ltx_bibblock">
Rishi Bommasani, Drew A. Hudson, Ehsan Adeli, Russ Altman, Simran Arora, Sydney von Arx, Michael S. Bernstein, Jeannette Bohg, Antoine Bosselut, Emma Brunskill, Erik Brynjolfsson, S. Buch, Dallas Card, Rodrigo Castellon, Niladri S. Chatterji, Annie S. Chen, Kathleen A. Creel, Jared Davis, Dora Demszky, Chris Donahue, Moussa Doumbouya, Esin Durmus, Stefano Ermon, John Etchemendy, Kawin Ethayarajh, Li Fei-Fei, Chelsea Finn, Trevor Gale, Lauren E. Gillespie, Karan Goel, Noah D. Goodman, Shelby Grossman, Neel Guha, Tatsunori Hashimoto, Peter Henderson, John Hewitt, Daniel E. Ho, Jenny Hong, Kyle Hsu, Jing Huang, Thomas F. Icard, Saahil Jain, Dan Jurafsky, Pratyusha Kalluri, Siddharth Karamcheti, Geoff Keeling, Fereshte Khani, O. Khattab, Pang Wei Koh, Mark S. Krass, Ranjay Krishna, Rohith Kuditipudi, Ananya Kumar, Faisal Ladhak, Mina Lee, Tony Lee, Jure Leskovec, Isabelle Levent, Xiang Lisa Li, Xuechen Li, Tengyu Ma, Ali Malik, Christopher D. Manning, Suvir P. Mirchandani, Eric Mitchell, Zanele Munyikwa, Suraj
Nair, Avanika Narayan, Deepak Narayanan, Benjamin Newman, Allen Nie, Juan Carlos Niebles, Hamed Nilforoshan, J. F. Nyarko, Giray Ogut, Laurel Orr, Isabel Papadimitriou, Joon Sung Park, Chris Piech, Eva Portelance, Christopher Potts, Aditi Raghunathan, Robert Reich, Hongyu Ren, Frieda Rong, Yusuf H. Roohani, Camilo Ruiz, Jack Ryan, Christopher R’e, Dorsa Sadigh, Shiori Sagawa, Keshav Santhanam, Andy Shih, Krishna Parasuram Srinivasan, Alex Tamkin, Rohan Taori, Armin W. Thomas, Florian Tramèr, Rose E. Wang, William Wang, Bohan Wu, Jiajun Wu, Yuhuai Wu, Sang Michael Xie, Michihiro Yasunaga, Jiaxuan You, Matei A. Zaharia, Michael Zhang, Tianyi Zhang, Xikun Zhang, Yuhui Zhang, Lucia Zheng, Kaitlyn Zhou, and Percy Liang.

</span>
<span class="ltx_bibblock">On the opportunities and risks of foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://crfm.stanford.edu/assets/report.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://crfm.stanford.edu/assets/report.pdf</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020a)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:1877–1901, 2020a.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020b)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:1877–1901, 2020b.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al. (2022)</span>
<span class="ltx_bibblock">
Hyung Won Chung, Le Hou, Shayne Longpre, Barret Zoph, Yi Tay, William Fedus, Eric Li, Xuezhi Wang, Mostafa Dehghani, Siddhartha Brahma, et al.

</span>
<span class="ltx_bibblock">Scaling instruction-finetuned language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.11416</em>, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2020)</span>
<span class="ltx_bibblock">
Yuyang Deng, Mohammad Mahdi Kamani, and Mehrdad Mahdavi.

</span>
<span class="ltx_bibblock">Adaptive personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.13461</em>, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1810.04805</em>, 2018.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2018)</span>
<span class="ltx_bibblock">
Yihui He, Ji Lin, Zhijian Liu, Hanrui Wang, Li-Jia Li, and Song Han.

</span>
<span class="ltx_bibblock">Amc: Automl for model compression and acceleration on mobile devices.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European conference on computer vision (ECCV)</em>, pp.  784–800, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.09685</em>, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2023)</span>
<span class="ltx_bibblock">
Zhiqiang Hu, Yihuai Lan, Lei Wang, Wanyu Xu, Ee-Peng Lim, Roy Ka-Wei Lee, Lidong Bing, and Soujanya Poria.

</span>
<span class="ltx_bibblock">Llm-adapters: An adapter family for parameter-efficient fine-tuning of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.01933</em>, 2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2022)</span>
<span class="ltx_bibblock">
Yuang Jiang, Shiqiang Wang, Victor Valls, Bong Jun Ko, Wei-Han Lee, Kin K Leung, and Leandros Tassiulas.

</span>
<span class="ltx_bibblock">Model pruning enables efficient federated learning on edge devices.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky &amp; Hinton (2009)</span>
<span class="ltx_bibblock">
A Krizhevsky and G Hinton.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Learning multiple layers of features from tiny images</em>.

</span>
<span class="ltx_bibblock">Master’s thesis, Department of Computer Science, University of Toronto, 2009.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2021)</span>
<span class="ltx_bibblock">
Aakash Kumar, Ali Muhammad Shaikh, Yun Li, Hazrat Bilal, and Baoqun Yin.

</span>
<span class="ltx_bibblock">Pruning filters with l1-norm and capped l1-norm for cnn compression.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Applied Intelligence</em>, 51:1152–1160, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2016)</span>
<span class="ltx_bibblock">
Hao Li, Asim Kadav, Igor Durdanovic, Hanan Samet, and Hans Peter Graf.

</span>
<span class="ltx_bibblock">Pruning filters for efficient convnets.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2016.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2020)</span>
<span class="ltx_bibblock">
Tao Lin, Lingjing Kong, Sebastian U Stich, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:2351–2363, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Wei Liu, Li Chen, Yunfei Chen, and Wenyi Zhang.

</span>
<span class="ltx_bibblock">Accelerating federated learning via momentum gradient descent.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems</em>, 31(8):1754–1766, 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2019)</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized bert pretraining approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1907.11692</em>, 2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282. PMLR, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muñoz et al. (2022)</span>
<span class="ltx_bibblock">
J. Pablo Muñoz, Nikolay Lyalyushkin, Chaunte Lacewell, Anastasia Senina, Daniel Cummings, Anthony Sarah, Alexander Kozlov, and Nilesh Jain.

</span>
<span class="ltx_bibblock">Automated super-network generation for scalable neural architecture search.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">First Conference on Automated Machine Learning (Main Track)</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=HK-zmbTB8gq" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=HK-zmbTB8gq</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muñoz et al. (2022)</span>
<span class="ltx_bibblock">
J. Pablo Muñoz, Nikolay Lyalyushkin, Yash Akhauri, Anastasia Senina, Alexander Kozlov, and Nilesh Jain.

</span>
<span class="ltx_bibblock">Enabling nas with automated super-network generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Practical Deep Learning in the Wild, AAAI</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2112.10878" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2112.10878</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nilsback &amp; Zisserman (2008)</span>
<span class="ltx_bibblock">
Maria-Elena Nilsback and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Automated flower classification over a large number of classes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Indian Conference on Computer Vision, Graphics and Image Processing</em>, Dec 2008.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report, 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patel et al. (2021)</span>
<span class="ltx_bibblock">
Arkil Patel, Satwik Bhattamishra, and Navin Goyal.

</span>
<span class="ltx_bibblock">Are NLP models really able to solve simple math word problems?

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pp.  2080–2094, Online, June 2021. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2021.naacl-main.168</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/2021.naacl-main.168" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2021.naacl-main.168</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">OpenAI blog</em>, 1(8):9, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp.  8748–8763. PMLR, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajpurkar et al. (2016)</span>
<span class="ltx_bibblock">
Pranav Rajpurkar, Jian Zhang, Konstantin Lopyrev, and Percy Liang.

</span>
<span class="ltx_bibblock">SQuAD: 100,000+ Questions for Machine Comprehension of Text.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv e-prints</em>, art. arXiv:1606.05250, 2016.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et al. (2019)</span>
<span class="ltx_bibblock">
Victor Sanh, Lysandre Debut, Julien Chaumond, and Thomas Wolf.

</span>
<span class="ltx_bibblock">Distilbert, a distilled version of bert: smaller, faster, cheaper and lighter.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.01108</em>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022)</span>
<span class="ltx_bibblock">
Alysa Ziying Tan, Han Yu, Lizhen Cui, and Qiang Yang.

</span>
<span class="ltx_bibblock">Towards personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>, 2022.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>, 2023.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2018)</span>
<span class="ltx_bibblock">
Alex Wang, Amanpreet Singh, Julian Michael, Felix Hill, Omer Levy, and Samuel R Bowman.

</span>
<span class="ltx_bibblock">Glue: A multi-task benchmark and analysis platform for natural language understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1804.07461</em>, 2018.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">White et al. (2023)</span>
<span class="ltx_bibblock">
Colin White, Mahmoud Safari, Rhea Sukthanker, Binxin Ru, Thomas Elsken, Arber Zela, Debadeepta Dey, and Frank Hutter.

</span>
<span class="ltx_bibblock">Neural architecture search: Insights from 1000 papers, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2301.08727" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2301.08727</a>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2021a)</span>
<span class="ltx_bibblock">
Sixing Yu, Arya Mazaheri, and Ali Jannesari.

</span>
<span class="ltx_bibblock">Auto graph encoder-decoder for neural network pruning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  6362–6372, 2021a.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2021b)</span>
<span class="ltx_bibblock">
Sixing Yu, Phuong Nguyen, Ali Anwar, and Ali Jannesari.

</span>
<span class="ltx_bibblock">Adaptive dynamic pruning for non-iid federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.06921</em>, 2021b.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022a)</span>
<span class="ltx_bibblock">
Sixing Yu, Arya Mazaheri, and Ali Jannesari.

</span>
<span class="ltx_bibblock">Topology-aware network pruning using multi-stage graph embedding and reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  25656–25667. PMLR, 2022a.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022b)</span>
<span class="ltx_bibblock">
Sixing Yu, Phuong Nguyen, Waqwoya Abebe, Wei Qian, Ali Anwar, and Ali Jannesari.

</span>
<span class="ltx_bibblock">Spatl: salient parameter aggregation and transfer learning for heterogeneous federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">2022 SC22: International Conference for High Performance Computing, Networking, Storage and Analysis (SC)</em>, pp.  495–508. IEEE Computer Society, 2022b.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022c)</span>
<span class="ltx_bibblock">
Sixing Yu, Phuong Nguyen, Waqwoya Abebe, Justin Stanley, Pablo Munoz, and Ali Jannesari.

</span>
<span class="ltx_bibblock">Resource-aware heterogeneous federated learning using neural architecture search.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.05716</em>, 2022c.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022d)</span>
<span class="ltx_bibblock">
Sixing Yu, Wei Qian, and Ali Jannesari.

</span>
<span class="ltx_bibblock">Resource-aware federated learning using knowledge extraction and multi-model fusion.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.07978</em>, 2022d.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
<span class="ltx_bibblock">
Sixing Yu, J Pablo Muñoz, and Ali Jannesari.

</span>
<span class="ltx_bibblock">Federated foundation models: Privacy-preserving and collaborative learning for large models.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.11414</em>, 2023.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al. (2023)</span>
<span class="ltx_bibblock">
Weiming Zhuang, Chen Chen, and Lingjuan Lyu.

</span>
<span class="ltx_bibblock">When foundation model meets federated learning: Motivations, challenges, and future directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.15546</em>, 2023.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Proof for Theorem 1</h3>

<div id="A1.SS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.p1.2" class="ltx_p"><span id="A1.SS1.p1.2.1" class="ltx_text ltx_font_bold">Notations:</span> To better illustrate the proof, we decompose <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><msup id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.2.cmml">W</mi><mi id="A1.SS1.p1.1.m1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><apply id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2">𝑊</ci><ci id="A1.SS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">W^{q}</annotation></semantics></math> and <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><msup id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">W</mi><mi id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝑊</ci><ci id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">W^{k}</annotation></semantics></math> as a set of vectors:</p>
<table id="A1.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex1.m1.5" class="ltx_Math" alttext="W^{q}=[w^{q}_{1},...,w^{q}_{c},...,w^{q}_{d_{k}}]" display="block"><semantics id="A1.Ex1.m1.5a"><mrow id="A1.Ex1.m1.5.5" xref="A1.Ex1.m1.5.5.cmml"><msup id="A1.Ex1.m1.5.5.5" xref="A1.Ex1.m1.5.5.5.cmml"><mi id="A1.Ex1.m1.5.5.5.2" xref="A1.Ex1.m1.5.5.5.2.cmml">W</mi><mi id="A1.Ex1.m1.5.5.5.3" xref="A1.Ex1.m1.5.5.5.3.cmml">q</mi></msup><mo id="A1.Ex1.m1.5.5.4" xref="A1.Ex1.m1.5.5.4.cmml">=</mo><mrow id="A1.Ex1.m1.5.5.3.3" xref="A1.Ex1.m1.5.5.3.4.cmml"><mo stretchy="false" id="A1.Ex1.m1.5.5.3.3.4" xref="A1.Ex1.m1.5.5.3.4.cmml">[</mo><msubsup id="A1.Ex1.m1.3.3.1.1.1" xref="A1.Ex1.m1.3.3.1.1.1.cmml"><mi id="A1.Ex1.m1.3.3.1.1.1.2.2" xref="A1.Ex1.m1.3.3.1.1.1.2.2.cmml">w</mi><mn id="A1.Ex1.m1.3.3.1.1.1.3" xref="A1.Ex1.m1.3.3.1.1.1.3.cmml">1</mn><mi id="A1.Ex1.m1.3.3.1.1.1.2.3" xref="A1.Ex1.m1.3.3.1.1.1.2.3.cmml">q</mi></msubsup><mo id="A1.Ex1.m1.5.5.3.3.5" xref="A1.Ex1.m1.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="A1.Ex1.m1.1.1" xref="A1.Ex1.m1.1.1.cmml">…</mi><mo id="A1.Ex1.m1.5.5.3.3.6" xref="A1.Ex1.m1.5.5.3.4.cmml">,</mo><msubsup id="A1.Ex1.m1.4.4.2.2.2" xref="A1.Ex1.m1.4.4.2.2.2.cmml"><mi id="A1.Ex1.m1.4.4.2.2.2.2.2" xref="A1.Ex1.m1.4.4.2.2.2.2.2.cmml">w</mi><mi id="A1.Ex1.m1.4.4.2.2.2.3" xref="A1.Ex1.m1.4.4.2.2.2.3.cmml">c</mi><mi id="A1.Ex1.m1.4.4.2.2.2.2.3" xref="A1.Ex1.m1.4.4.2.2.2.2.3.cmml">q</mi></msubsup><mo id="A1.Ex1.m1.5.5.3.3.7" xref="A1.Ex1.m1.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="A1.Ex1.m1.2.2" xref="A1.Ex1.m1.2.2.cmml">…</mi><mo id="A1.Ex1.m1.5.5.3.3.8" xref="A1.Ex1.m1.5.5.3.4.cmml">,</mo><msubsup id="A1.Ex1.m1.5.5.3.3.3" xref="A1.Ex1.m1.5.5.3.3.3.cmml"><mi id="A1.Ex1.m1.5.5.3.3.3.2.2" xref="A1.Ex1.m1.5.5.3.3.3.2.2.cmml">w</mi><msub id="A1.Ex1.m1.5.5.3.3.3.3" xref="A1.Ex1.m1.5.5.3.3.3.3.cmml"><mi id="A1.Ex1.m1.5.5.3.3.3.3.2" xref="A1.Ex1.m1.5.5.3.3.3.3.2.cmml">d</mi><mi id="A1.Ex1.m1.5.5.3.3.3.3.3" xref="A1.Ex1.m1.5.5.3.3.3.3.3.cmml">k</mi></msub><mi id="A1.Ex1.m1.5.5.3.3.3.2.3" xref="A1.Ex1.m1.5.5.3.3.3.2.3.cmml">q</mi></msubsup><mo stretchy="false" id="A1.Ex1.m1.5.5.3.3.9" xref="A1.Ex1.m1.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.5b"><apply id="A1.Ex1.m1.5.5.cmml" xref="A1.Ex1.m1.5.5"><eq id="A1.Ex1.m1.5.5.4.cmml" xref="A1.Ex1.m1.5.5.4"></eq><apply id="A1.Ex1.m1.5.5.5.cmml" xref="A1.Ex1.m1.5.5.5"><csymbol cd="ambiguous" id="A1.Ex1.m1.5.5.5.1.cmml" xref="A1.Ex1.m1.5.5.5">superscript</csymbol><ci id="A1.Ex1.m1.5.5.5.2.cmml" xref="A1.Ex1.m1.5.5.5.2">𝑊</ci><ci id="A1.Ex1.m1.5.5.5.3.cmml" xref="A1.Ex1.m1.5.5.5.3">𝑞</ci></apply><list id="A1.Ex1.m1.5.5.3.4.cmml" xref="A1.Ex1.m1.5.5.3.3"><apply id="A1.Ex1.m1.3.3.1.1.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.3.3.1.1.1.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1">subscript</csymbol><apply id="A1.Ex1.m1.3.3.1.1.1.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.3.3.1.1.1.2.1.cmml" xref="A1.Ex1.m1.3.3.1.1.1">superscript</csymbol><ci id="A1.Ex1.m1.3.3.1.1.1.2.2.cmml" xref="A1.Ex1.m1.3.3.1.1.1.2.2">𝑤</ci><ci id="A1.Ex1.m1.3.3.1.1.1.2.3.cmml" xref="A1.Ex1.m1.3.3.1.1.1.2.3">𝑞</ci></apply><cn type="integer" id="A1.Ex1.m1.3.3.1.1.1.3.cmml" xref="A1.Ex1.m1.3.3.1.1.1.3">1</cn></apply><ci id="A1.Ex1.m1.1.1.cmml" xref="A1.Ex1.m1.1.1">…</ci><apply id="A1.Ex1.m1.4.4.2.2.2.cmml" xref="A1.Ex1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.4.4.2.2.2.1.cmml" xref="A1.Ex1.m1.4.4.2.2.2">subscript</csymbol><apply id="A1.Ex1.m1.4.4.2.2.2.2.cmml" xref="A1.Ex1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.4.4.2.2.2.2.1.cmml" xref="A1.Ex1.m1.4.4.2.2.2">superscript</csymbol><ci id="A1.Ex1.m1.4.4.2.2.2.2.2.cmml" xref="A1.Ex1.m1.4.4.2.2.2.2.2">𝑤</ci><ci id="A1.Ex1.m1.4.4.2.2.2.2.3.cmml" xref="A1.Ex1.m1.4.4.2.2.2.2.3">𝑞</ci></apply><ci id="A1.Ex1.m1.4.4.2.2.2.3.cmml" xref="A1.Ex1.m1.4.4.2.2.2.3">𝑐</ci></apply><ci id="A1.Ex1.m1.2.2.cmml" xref="A1.Ex1.m1.2.2">…</ci><apply id="A1.Ex1.m1.5.5.3.3.3.cmml" xref="A1.Ex1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.5.5.3.3.3.1.cmml" xref="A1.Ex1.m1.5.5.3.3.3">subscript</csymbol><apply id="A1.Ex1.m1.5.5.3.3.3.2.cmml" xref="A1.Ex1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.5.5.3.3.3.2.1.cmml" xref="A1.Ex1.m1.5.5.3.3.3">superscript</csymbol><ci id="A1.Ex1.m1.5.5.3.3.3.2.2.cmml" xref="A1.Ex1.m1.5.5.3.3.3.2.2">𝑤</ci><ci id="A1.Ex1.m1.5.5.3.3.3.2.3.cmml" xref="A1.Ex1.m1.5.5.3.3.3.2.3">𝑞</ci></apply><apply id="A1.Ex1.m1.5.5.3.3.3.3.cmml" xref="A1.Ex1.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.5.5.3.3.3.3.1.cmml" xref="A1.Ex1.m1.5.5.3.3.3.3">subscript</csymbol><ci id="A1.Ex1.m1.5.5.3.3.3.3.2.cmml" xref="A1.Ex1.m1.5.5.3.3.3.3.2">𝑑</ci><ci id="A1.Ex1.m1.5.5.3.3.3.3.3.cmml" xref="A1.Ex1.m1.5.5.3.3.3.3.3">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.5c">W^{q}=[w^{q}_{1},...,w^{q}_{c},...,w^{q}_{d_{k}}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.p1.7" class="ltx_p">and</p>
<table id="A1.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex2.m1.5" class="ltx_Math" alttext="W^{k}=[w^{k}_{1},...,w^{k}_{c},...,w^{k}_{d_{k}}]" display="block"><semantics id="A1.Ex2.m1.5a"><mrow id="A1.Ex2.m1.5.5" xref="A1.Ex2.m1.5.5.cmml"><msup id="A1.Ex2.m1.5.5.5" xref="A1.Ex2.m1.5.5.5.cmml"><mi id="A1.Ex2.m1.5.5.5.2" xref="A1.Ex2.m1.5.5.5.2.cmml">W</mi><mi id="A1.Ex2.m1.5.5.5.3" xref="A1.Ex2.m1.5.5.5.3.cmml">k</mi></msup><mo id="A1.Ex2.m1.5.5.4" xref="A1.Ex2.m1.5.5.4.cmml">=</mo><mrow id="A1.Ex2.m1.5.5.3.3" xref="A1.Ex2.m1.5.5.3.4.cmml"><mo stretchy="false" id="A1.Ex2.m1.5.5.3.3.4" xref="A1.Ex2.m1.5.5.3.4.cmml">[</mo><msubsup id="A1.Ex2.m1.3.3.1.1.1" xref="A1.Ex2.m1.3.3.1.1.1.cmml"><mi id="A1.Ex2.m1.3.3.1.1.1.2.2" xref="A1.Ex2.m1.3.3.1.1.1.2.2.cmml">w</mi><mn id="A1.Ex2.m1.3.3.1.1.1.3" xref="A1.Ex2.m1.3.3.1.1.1.3.cmml">1</mn><mi id="A1.Ex2.m1.3.3.1.1.1.2.3" xref="A1.Ex2.m1.3.3.1.1.1.2.3.cmml">k</mi></msubsup><mo id="A1.Ex2.m1.5.5.3.3.5" xref="A1.Ex2.m1.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="A1.Ex2.m1.1.1" xref="A1.Ex2.m1.1.1.cmml">…</mi><mo id="A1.Ex2.m1.5.5.3.3.6" xref="A1.Ex2.m1.5.5.3.4.cmml">,</mo><msubsup id="A1.Ex2.m1.4.4.2.2.2" xref="A1.Ex2.m1.4.4.2.2.2.cmml"><mi id="A1.Ex2.m1.4.4.2.2.2.2.2" xref="A1.Ex2.m1.4.4.2.2.2.2.2.cmml">w</mi><mi id="A1.Ex2.m1.4.4.2.2.2.3" xref="A1.Ex2.m1.4.4.2.2.2.3.cmml">c</mi><mi id="A1.Ex2.m1.4.4.2.2.2.2.3" xref="A1.Ex2.m1.4.4.2.2.2.2.3.cmml">k</mi></msubsup><mo id="A1.Ex2.m1.5.5.3.3.7" xref="A1.Ex2.m1.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="A1.Ex2.m1.2.2" xref="A1.Ex2.m1.2.2.cmml">…</mi><mo id="A1.Ex2.m1.5.5.3.3.8" xref="A1.Ex2.m1.5.5.3.4.cmml">,</mo><msubsup id="A1.Ex2.m1.5.5.3.3.3" xref="A1.Ex2.m1.5.5.3.3.3.cmml"><mi id="A1.Ex2.m1.5.5.3.3.3.2.2" xref="A1.Ex2.m1.5.5.3.3.3.2.2.cmml">w</mi><msub id="A1.Ex2.m1.5.5.3.3.3.3" xref="A1.Ex2.m1.5.5.3.3.3.3.cmml"><mi id="A1.Ex2.m1.5.5.3.3.3.3.2" xref="A1.Ex2.m1.5.5.3.3.3.3.2.cmml">d</mi><mi id="A1.Ex2.m1.5.5.3.3.3.3.3" xref="A1.Ex2.m1.5.5.3.3.3.3.3.cmml">k</mi></msub><mi id="A1.Ex2.m1.5.5.3.3.3.2.3" xref="A1.Ex2.m1.5.5.3.3.3.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.Ex2.m1.5.5.3.3.9" xref="A1.Ex2.m1.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2.m1.5b"><apply id="A1.Ex2.m1.5.5.cmml" xref="A1.Ex2.m1.5.5"><eq id="A1.Ex2.m1.5.5.4.cmml" xref="A1.Ex2.m1.5.5.4"></eq><apply id="A1.Ex2.m1.5.5.5.cmml" xref="A1.Ex2.m1.5.5.5"><csymbol cd="ambiguous" id="A1.Ex2.m1.5.5.5.1.cmml" xref="A1.Ex2.m1.5.5.5">superscript</csymbol><ci id="A1.Ex2.m1.5.5.5.2.cmml" xref="A1.Ex2.m1.5.5.5.2">𝑊</ci><ci id="A1.Ex2.m1.5.5.5.3.cmml" xref="A1.Ex2.m1.5.5.5.3">𝑘</ci></apply><list id="A1.Ex2.m1.5.5.3.4.cmml" xref="A1.Ex2.m1.5.5.3.3"><apply id="A1.Ex2.m1.3.3.1.1.1.cmml" xref="A1.Ex2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2.m1.3.3.1.1.1.1.cmml" xref="A1.Ex2.m1.3.3.1.1.1">subscript</csymbol><apply id="A1.Ex2.m1.3.3.1.1.1.2.cmml" xref="A1.Ex2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2.m1.3.3.1.1.1.2.1.cmml" xref="A1.Ex2.m1.3.3.1.1.1">superscript</csymbol><ci id="A1.Ex2.m1.3.3.1.1.1.2.2.cmml" xref="A1.Ex2.m1.3.3.1.1.1.2.2">𝑤</ci><ci id="A1.Ex2.m1.3.3.1.1.1.2.3.cmml" xref="A1.Ex2.m1.3.3.1.1.1.2.3">𝑘</ci></apply><cn type="integer" id="A1.Ex2.m1.3.3.1.1.1.3.cmml" xref="A1.Ex2.m1.3.3.1.1.1.3">1</cn></apply><ci id="A1.Ex2.m1.1.1.cmml" xref="A1.Ex2.m1.1.1">…</ci><apply id="A1.Ex2.m1.4.4.2.2.2.cmml" xref="A1.Ex2.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2.m1.4.4.2.2.2.1.cmml" xref="A1.Ex2.m1.4.4.2.2.2">subscript</csymbol><apply id="A1.Ex2.m1.4.4.2.2.2.2.cmml" xref="A1.Ex2.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2.m1.4.4.2.2.2.2.1.cmml" xref="A1.Ex2.m1.4.4.2.2.2">superscript</csymbol><ci id="A1.Ex2.m1.4.4.2.2.2.2.2.cmml" xref="A1.Ex2.m1.4.4.2.2.2.2.2">𝑤</ci><ci id="A1.Ex2.m1.4.4.2.2.2.2.3.cmml" xref="A1.Ex2.m1.4.4.2.2.2.2.3">𝑘</ci></apply><ci id="A1.Ex2.m1.4.4.2.2.2.3.cmml" xref="A1.Ex2.m1.4.4.2.2.2.3">𝑐</ci></apply><ci id="A1.Ex2.m1.2.2.cmml" xref="A1.Ex2.m1.2.2">…</ci><apply id="A1.Ex2.m1.5.5.3.3.3.cmml" xref="A1.Ex2.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="A1.Ex2.m1.5.5.3.3.3.1.cmml" xref="A1.Ex2.m1.5.5.3.3.3">subscript</csymbol><apply id="A1.Ex2.m1.5.5.3.3.3.2.cmml" xref="A1.Ex2.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="A1.Ex2.m1.5.5.3.3.3.2.1.cmml" xref="A1.Ex2.m1.5.5.3.3.3">superscript</csymbol><ci id="A1.Ex2.m1.5.5.3.3.3.2.2.cmml" xref="A1.Ex2.m1.5.5.3.3.3.2.2">𝑤</ci><ci id="A1.Ex2.m1.5.5.3.3.3.2.3.cmml" xref="A1.Ex2.m1.5.5.3.3.3.2.3">𝑘</ci></apply><apply id="A1.Ex2.m1.5.5.3.3.3.3.cmml" xref="A1.Ex2.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="A1.Ex2.m1.5.5.3.3.3.3.1.cmml" xref="A1.Ex2.m1.5.5.3.3.3.3">subscript</csymbol><ci id="A1.Ex2.m1.5.5.3.3.3.3.2.cmml" xref="A1.Ex2.m1.5.5.3.3.3.3.2">𝑑</ci><ci id="A1.Ex2.m1.5.5.3.3.3.3.3.cmml" xref="A1.Ex2.m1.5.5.3.3.3.3.3">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m1.5c">W^{k}=[w^{k}_{1},...,w^{k}_{c},...,w^{k}_{d_{k}}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.p1.6" class="ltx_p">, where <math id="A1.SS1.p1.3.m1.1" class="ltx_Math" alttext="w^{q}_{c}\text{, }w^{k}_{c}\in\mathcal{R}^{d\times 1}" display="inline"><semantics id="A1.SS1.p1.3.m1.1a"><mrow id="A1.SS1.p1.3.m1.1.1" xref="A1.SS1.p1.3.m1.1.1.cmml"><mrow id="A1.SS1.p1.3.m1.1.1.2" xref="A1.SS1.p1.3.m1.1.1.2.cmml"><msubsup id="A1.SS1.p1.3.m1.1.1.2.2" xref="A1.SS1.p1.3.m1.1.1.2.2.cmml"><mi id="A1.SS1.p1.3.m1.1.1.2.2.2.2" xref="A1.SS1.p1.3.m1.1.1.2.2.2.2.cmml">w</mi><mi id="A1.SS1.p1.3.m1.1.1.2.2.3" xref="A1.SS1.p1.3.m1.1.1.2.2.3.cmml">c</mi><mi id="A1.SS1.p1.3.m1.1.1.2.2.2.3" xref="A1.SS1.p1.3.m1.1.1.2.2.2.3.cmml">q</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.SS1.p1.3.m1.1.1.2.1" xref="A1.SS1.p1.3.m1.1.1.2.1.cmml">​</mo><mtext id="A1.SS1.p1.3.m1.1.1.2.3" xref="A1.SS1.p1.3.m1.1.1.2.3a.cmml">, </mtext><mo lspace="0em" rspace="0em" id="A1.SS1.p1.3.m1.1.1.2.1a" xref="A1.SS1.p1.3.m1.1.1.2.1.cmml">​</mo><msubsup id="A1.SS1.p1.3.m1.1.1.2.4" xref="A1.SS1.p1.3.m1.1.1.2.4.cmml"><mi id="A1.SS1.p1.3.m1.1.1.2.4.2.2" xref="A1.SS1.p1.3.m1.1.1.2.4.2.2.cmml">w</mi><mi id="A1.SS1.p1.3.m1.1.1.2.4.3" xref="A1.SS1.p1.3.m1.1.1.2.4.3.cmml">c</mi><mi id="A1.SS1.p1.3.m1.1.1.2.4.2.3" xref="A1.SS1.p1.3.m1.1.1.2.4.2.3.cmml">k</mi></msubsup></mrow><mo id="A1.SS1.p1.3.m1.1.1.1" xref="A1.SS1.p1.3.m1.1.1.1.cmml">∈</mo><msup id="A1.SS1.p1.3.m1.1.1.3" xref="A1.SS1.p1.3.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.3.m1.1.1.3.2" xref="A1.SS1.p1.3.m1.1.1.3.2.cmml">ℛ</mi><mrow id="A1.SS1.p1.3.m1.1.1.3.3" xref="A1.SS1.p1.3.m1.1.1.3.3.cmml"><mi id="A1.SS1.p1.3.m1.1.1.3.3.2" xref="A1.SS1.p1.3.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p1.3.m1.1.1.3.3.1" xref="A1.SS1.p1.3.m1.1.1.3.3.1.cmml">×</mo><mn id="A1.SS1.p1.3.m1.1.1.3.3.3" xref="A1.SS1.p1.3.m1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m1.1b"><apply id="A1.SS1.p1.3.m1.1.1.cmml" xref="A1.SS1.p1.3.m1.1.1"><in id="A1.SS1.p1.3.m1.1.1.1.cmml" xref="A1.SS1.p1.3.m1.1.1.1"></in><apply id="A1.SS1.p1.3.m1.1.1.2.cmml" xref="A1.SS1.p1.3.m1.1.1.2"><times id="A1.SS1.p1.3.m1.1.1.2.1.cmml" xref="A1.SS1.p1.3.m1.1.1.2.1"></times><apply id="A1.SS1.p1.3.m1.1.1.2.2.cmml" xref="A1.SS1.p1.3.m1.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.1.1.2.2.1.cmml" xref="A1.SS1.p1.3.m1.1.1.2.2">subscript</csymbol><apply id="A1.SS1.p1.3.m1.1.1.2.2.2.cmml" xref="A1.SS1.p1.3.m1.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.1.1.2.2.2.1.cmml" xref="A1.SS1.p1.3.m1.1.1.2.2">superscript</csymbol><ci id="A1.SS1.p1.3.m1.1.1.2.2.2.2.cmml" xref="A1.SS1.p1.3.m1.1.1.2.2.2.2">𝑤</ci><ci id="A1.SS1.p1.3.m1.1.1.2.2.2.3.cmml" xref="A1.SS1.p1.3.m1.1.1.2.2.2.3">𝑞</ci></apply><ci id="A1.SS1.p1.3.m1.1.1.2.2.3.cmml" xref="A1.SS1.p1.3.m1.1.1.2.2.3">𝑐</ci></apply><ci id="A1.SS1.p1.3.m1.1.1.2.3a.cmml" xref="A1.SS1.p1.3.m1.1.1.2.3"><mtext id="A1.SS1.p1.3.m1.1.1.2.3.cmml" xref="A1.SS1.p1.3.m1.1.1.2.3">, </mtext></ci><apply id="A1.SS1.p1.3.m1.1.1.2.4.cmml" xref="A1.SS1.p1.3.m1.1.1.2.4"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.1.1.2.4.1.cmml" xref="A1.SS1.p1.3.m1.1.1.2.4">subscript</csymbol><apply id="A1.SS1.p1.3.m1.1.1.2.4.2.cmml" xref="A1.SS1.p1.3.m1.1.1.2.4"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.1.1.2.4.2.1.cmml" xref="A1.SS1.p1.3.m1.1.1.2.4">superscript</csymbol><ci id="A1.SS1.p1.3.m1.1.1.2.4.2.2.cmml" xref="A1.SS1.p1.3.m1.1.1.2.4.2.2">𝑤</ci><ci id="A1.SS1.p1.3.m1.1.1.2.4.2.3.cmml" xref="A1.SS1.p1.3.m1.1.1.2.4.2.3">𝑘</ci></apply><ci id="A1.SS1.p1.3.m1.1.1.2.4.3.cmml" xref="A1.SS1.p1.3.m1.1.1.2.4.3">𝑐</ci></apply></apply><apply id="A1.SS1.p1.3.m1.1.1.3.cmml" xref="A1.SS1.p1.3.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m1.1.1.3.1.cmml" xref="A1.SS1.p1.3.m1.1.1.3">superscript</csymbol><ci id="A1.SS1.p1.3.m1.1.1.3.2.cmml" xref="A1.SS1.p1.3.m1.1.1.3.2">ℛ</ci><apply id="A1.SS1.p1.3.m1.1.1.3.3.cmml" xref="A1.SS1.p1.3.m1.1.1.3.3"><times id="A1.SS1.p1.3.m1.1.1.3.3.1.cmml" xref="A1.SS1.p1.3.m1.1.1.3.3.1"></times><ci id="A1.SS1.p1.3.m1.1.1.3.3.2.cmml" xref="A1.SS1.p1.3.m1.1.1.3.3.2">𝑑</ci><cn type="integer" id="A1.SS1.p1.3.m1.1.1.3.3.3.cmml" xref="A1.SS1.p1.3.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m1.1c">w^{q}_{c}\text{, }w^{k}_{c}\in\mathcal{R}^{d\times 1}</annotation></semantics></math>, and <math id="A1.SS1.p1.4.m2.2" class="ltx_Math" alttext="c\in[1,d_{k}]" display="inline"><semantics id="A1.SS1.p1.4.m2.2a"><mrow id="A1.SS1.p1.4.m2.2.2" xref="A1.SS1.p1.4.m2.2.2.cmml"><mi id="A1.SS1.p1.4.m2.2.2.3" xref="A1.SS1.p1.4.m2.2.2.3.cmml">c</mi><mo id="A1.SS1.p1.4.m2.2.2.2" xref="A1.SS1.p1.4.m2.2.2.2.cmml">∈</mo><mrow id="A1.SS1.p1.4.m2.2.2.1.1" xref="A1.SS1.p1.4.m2.2.2.1.2.cmml"><mo stretchy="false" id="A1.SS1.p1.4.m2.2.2.1.1.2" xref="A1.SS1.p1.4.m2.2.2.1.2.cmml">[</mo><mn id="A1.SS1.p1.4.m2.1.1" xref="A1.SS1.p1.4.m2.1.1.cmml">1</mn><mo id="A1.SS1.p1.4.m2.2.2.1.1.3" xref="A1.SS1.p1.4.m2.2.2.1.2.cmml">,</mo><msub id="A1.SS1.p1.4.m2.2.2.1.1.1" xref="A1.SS1.p1.4.m2.2.2.1.1.1.cmml"><mi id="A1.SS1.p1.4.m2.2.2.1.1.1.2" xref="A1.SS1.p1.4.m2.2.2.1.1.1.2.cmml">d</mi><mi id="A1.SS1.p1.4.m2.2.2.1.1.1.3" xref="A1.SS1.p1.4.m2.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="A1.SS1.p1.4.m2.2.2.1.1.4" xref="A1.SS1.p1.4.m2.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m2.2b"><apply id="A1.SS1.p1.4.m2.2.2.cmml" xref="A1.SS1.p1.4.m2.2.2"><in id="A1.SS1.p1.4.m2.2.2.2.cmml" xref="A1.SS1.p1.4.m2.2.2.2"></in><ci id="A1.SS1.p1.4.m2.2.2.3.cmml" xref="A1.SS1.p1.4.m2.2.2.3">𝑐</ci><interval closure="closed" id="A1.SS1.p1.4.m2.2.2.1.2.cmml" xref="A1.SS1.p1.4.m2.2.2.1.1"><cn type="integer" id="A1.SS1.p1.4.m2.1.1.cmml" xref="A1.SS1.p1.4.m2.1.1">1</cn><apply id="A1.SS1.p1.4.m2.2.2.1.1.1.cmml" xref="A1.SS1.p1.4.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m2.2.2.1.1.1.1.cmml" xref="A1.SS1.p1.4.m2.2.2.1.1.1">subscript</csymbol><ci id="A1.SS1.p1.4.m2.2.2.1.1.1.2.cmml" xref="A1.SS1.p1.4.m2.2.2.1.1.1.2">𝑑</ci><ci id="A1.SS1.p1.4.m2.2.2.1.1.1.3.cmml" xref="A1.SS1.p1.4.m2.2.2.1.1.1.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m2.2c">c\in[1,d_{k}]</annotation></semantics></math>.
Similarly, <math id="A1.SS1.p1.5.m3.1" class="ltx_Math" alttext="W^{q^{\prime}}" display="inline"><semantics id="A1.SS1.p1.5.m3.1a"><msup id="A1.SS1.p1.5.m3.1.1" xref="A1.SS1.p1.5.m3.1.1.cmml"><mi id="A1.SS1.p1.5.m3.1.1.2" xref="A1.SS1.p1.5.m3.1.1.2.cmml">W</mi><msup id="A1.SS1.p1.5.m3.1.1.3" xref="A1.SS1.p1.5.m3.1.1.3.cmml"><mi id="A1.SS1.p1.5.m3.1.1.3.2" xref="A1.SS1.p1.5.m3.1.1.3.2.cmml">q</mi><mo id="A1.SS1.p1.5.m3.1.1.3.3" xref="A1.SS1.p1.5.m3.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m3.1b"><apply id="A1.SS1.p1.5.m3.1.1.cmml" xref="A1.SS1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m3.1.1.1.cmml" xref="A1.SS1.p1.5.m3.1.1">superscript</csymbol><ci id="A1.SS1.p1.5.m3.1.1.2.cmml" xref="A1.SS1.p1.5.m3.1.1.2">𝑊</ci><apply id="A1.SS1.p1.5.m3.1.1.3.cmml" xref="A1.SS1.p1.5.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m3.1.1.3.1.cmml" xref="A1.SS1.p1.5.m3.1.1.3">superscript</csymbol><ci id="A1.SS1.p1.5.m3.1.1.3.2.cmml" xref="A1.SS1.p1.5.m3.1.1.3.2">𝑞</ci><ci id="A1.SS1.p1.5.m3.1.1.3.3.cmml" xref="A1.SS1.p1.5.m3.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m3.1c">W^{q^{\prime}}</annotation></semantics></math> and <math id="A1.SS1.p1.6.m4.1" class="ltx_Math" alttext="W^{k^{\prime}}" display="inline"><semantics id="A1.SS1.p1.6.m4.1a"><msup id="A1.SS1.p1.6.m4.1.1" xref="A1.SS1.p1.6.m4.1.1.cmml"><mi id="A1.SS1.p1.6.m4.1.1.2" xref="A1.SS1.p1.6.m4.1.1.2.cmml">W</mi><msup id="A1.SS1.p1.6.m4.1.1.3" xref="A1.SS1.p1.6.m4.1.1.3.cmml"><mi id="A1.SS1.p1.6.m4.1.1.3.2" xref="A1.SS1.p1.6.m4.1.1.3.2.cmml">k</mi><mo id="A1.SS1.p1.6.m4.1.1.3.3" xref="A1.SS1.p1.6.m4.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m4.1b"><apply id="A1.SS1.p1.6.m4.1.1.cmml" xref="A1.SS1.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m4.1.1.1.cmml" xref="A1.SS1.p1.6.m4.1.1">superscript</csymbol><ci id="A1.SS1.p1.6.m4.1.1.2.cmml" xref="A1.SS1.p1.6.m4.1.1.2">𝑊</ci><apply id="A1.SS1.p1.6.m4.1.1.3.cmml" xref="A1.SS1.p1.6.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m4.1.1.3.1.cmml" xref="A1.SS1.p1.6.m4.1.1.3">superscript</csymbol><ci id="A1.SS1.p1.6.m4.1.1.3.2.cmml" xref="A1.SS1.p1.6.m4.1.1.3.2">𝑘</ci><ci id="A1.SS1.p1.6.m4.1.1.3.3.cmml" xref="A1.SS1.p1.6.m4.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m4.1c">W^{k^{\prime}}</annotation></semantics></math> can be decomposed as:</p>
</div>
<div id="A1.SS1.p2" class="ltx_para ltx_noindent">
<table id="A1.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E8.m1.5" class="ltx_Math" alttext="W^{q^{\prime}}=[w^{q}_{\pi(1)},...,w^{q}_{\pi(d_{k})}]" display="block"><semantics id="A1.E8.m1.5a"><mrow id="A1.E8.m1.5.5" xref="A1.E8.m1.5.5.cmml"><msup id="A1.E8.m1.5.5.4" xref="A1.E8.m1.5.5.4.cmml"><mi id="A1.E8.m1.5.5.4.2" xref="A1.E8.m1.5.5.4.2.cmml">W</mi><msup id="A1.E8.m1.5.5.4.3" xref="A1.E8.m1.5.5.4.3.cmml"><mi id="A1.E8.m1.5.5.4.3.2" xref="A1.E8.m1.5.5.4.3.2.cmml">q</mi><mo id="A1.E8.m1.5.5.4.3.3" xref="A1.E8.m1.5.5.4.3.3.cmml">′</mo></msup></msup><mo id="A1.E8.m1.5.5.3" xref="A1.E8.m1.5.5.3.cmml">=</mo><mrow id="A1.E8.m1.5.5.2.2" xref="A1.E8.m1.5.5.2.3.cmml"><mo stretchy="false" id="A1.E8.m1.5.5.2.2.3" xref="A1.E8.m1.5.5.2.3.cmml">[</mo><msubsup id="A1.E8.m1.4.4.1.1.1" xref="A1.E8.m1.4.4.1.1.1.cmml"><mi id="A1.E8.m1.4.4.1.1.1.2.2" xref="A1.E8.m1.4.4.1.1.1.2.2.cmml">w</mi><mrow id="A1.E8.m1.1.1.1" xref="A1.E8.m1.1.1.1.cmml"><mi id="A1.E8.m1.1.1.1.3" xref="A1.E8.m1.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E8.m1.1.1.1.2" xref="A1.E8.m1.1.1.1.2.cmml">​</mo><mrow id="A1.E8.m1.1.1.1.4.2" xref="A1.E8.m1.1.1.1.cmml"><mo stretchy="false" id="A1.E8.m1.1.1.1.4.2.1" xref="A1.E8.m1.1.1.1.cmml">(</mo><mn id="A1.E8.m1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.cmml">1</mn><mo stretchy="false" id="A1.E8.m1.1.1.1.4.2.2" xref="A1.E8.m1.1.1.1.cmml">)</mo></mrow></mrow><mi id="A1.E8.m1.4.4.1.1.1.2.3" xref="A1.E8.m1.4.4.1.1.1.2.3.cmml">q</mi></msubsup><mo id="A1.E8.m1.5.5.2.2.4" xref="A1.E8.m1.5.5.2.3.cmml">,</mo><mi mathvariant="normal" id="A1.E8.m1.3.3" xref="A1.E8.m1.3.3.cmml">…</mi><mo id="A1.E8.m1.5.5.2.2.5" xref="A1.E8.m1.5.5.2.3.cmml">,</mo><msubsup id="A1.E8.m1.5.5.2.2.2" xref="A1.E8.m1.5.5.2.2.2.cmml"><mi id="A1.E8.m1.5.5.2.2.2.2.2" xref="A1.E8.m1.5.5.2.2.2.2.2.cmml">w</mi><mrow id="A1.E8.m1.2.2.1" xref="A1.E8.m1.2.2.1.cmml"><mi id="A1.E8.m1.2.2.1.3" xref="A1.E8.m1.2.2.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E8.m1.2.2.1.2" xref="A1.E8.m1.2.2.1.2.cmml">​</mo><mrow id="A1.E8.m1.2.2.1.1.1" xref="A1.E8.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A1.E8.m1.2.2.1.1.1.2" xref="A1.E8.m1.2.2.1.1.1.1.cmml">(</mo><msub id="A1.E8.m1.2.2.1.1.1.1" xref="A1.E8.m1.2.2.1.1.1.1.cmml"><mi id="A1.E8.m1.2.2.1.1.1.1.2" xref="A1.E8.m1.2.2.1.1.1.1.2.cmml">d</mi><mi id="A1.E8.m1.2.2.1.1.1.1.3" xref="A1.E8.m1.2.2.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="A1.E8.m1.2.2.1.1.1.3" xref="A1.E8.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mi id="A1.E8.m1.5.5.2.2.2.2.3" xref="A1.E8.m1.5.5.2.2.2.2.3.cmml">q</mi></msubsup><mo stretchy="false" id="A1.E8.m1.5.5.2.2.6" xref="A1.E8.m1.5.5.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.5b"><apply id="A1.E8.m1.5.5.cmml" xref="A1.E8.m1.5.5"><eq id="A1.E8.m1.5.5.3.cmml" xref="A1.E8.m1.5.5.3"></eq><apply id="A1.E8.m1.5.5.4.cmml" xref="A1.E8.m1.5.5.4"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.4.1.cmml" xref="A1.E8.m1.5.5.4">superscript</csymbol><ci id="A1.E8.m1.5.5.4.2.cmml" xref="A1.E8.m1.5.5.4.2">𝑊</ci><apply id="A1.E8.m1.5.5.4.3.cmml" xref="A1.E8.m1.5.5.4.3"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.4.3.1.cmml" xref="A1.E8.m1.5.5.4.3">superscript</csymbol><ci id="A1.E8.m1.5.5.4.3.2.cmml" xref="A1.E8.m1.5.5.4.3.2">𝑞</ci><ci id="A1.E8.m1.5.5.4.3.3.cmml" xref="A1.E8.m1.5.5.4.3.3">′</ci></apply></apply><list id="A1.E8.m1.5.5.2.3.cmml" xref="A1.E8.m1.5.5.2.2"><apply id="A1.E8.m1.4.4.1.1.1.cmml" xref="A1.E8.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.1.1.1.1.cmml" xref="A1.E8.m1.4.4.1.1.1">subscript</csymbol><apply id="A1.E8.m1.4.4.1.1.1.2.cmml" xref="A1.E8.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.1.1.1.2.1.cmml" xref="A1.E8.m1.4.4.1.1.1">superscript</csymbol><ci id="A1.E8.m1.4.4.1.1.1.2.2.cmml" xref="A1.E8.m1.4.4.1.1.1.2.2">𝑤</ci><ci id="A1.E8.m1.4.4.1.1.1.2.3.cmml" xref="A1.E8.m1.4.4.1.1.1.2.3">𝑞</ci></apply><apply id="A1.E8.m1.1.1.1.cmml" xref="A1.E8.m1.1.1.1"><times id="A1.E8.m1.1.1.1.2.cmml" xref="A1.E8.m1.1.1.1.2"></times><ci id="A1.E8.m1.1.1.1.3.cmml" xref="A1.E8.m1.1.1.1.3">𝜋</ci><cn type="integer" id="A1.E8.m1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1">1</cn></apply></apply><ci id="A1.E8.m1.3.3.cmml" xref="A1.E8.m1.3.3">…</ci><apply id="A1.E8.m1.5.5.2.2.2.cmml" xref="A1.E8.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.2.2.2.1.cmml" xref="A1.E8.m1.5.5.2.2.2">subscript</csymbol><apply id="A1.E8.m1.5.5.2.2.2.2.cmml" xref="A1.E8.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.2.2.2.2.1.cmml" xref="A1.E8.m1.5.5.2.2.2">superscript</csymbol><ci id="A1.E8.m1.5.5.2.2.2.2.2.cmml" xref="A1.E8.m1.5.5.2.2.2.2.2">𝑤</ci><ci id="A1.E8.m1.5.5.2.2.2.2.3.cmml" xref="A1.E8.m1.5.5.2.2.2.2.3">𝑞</ci></apply><apply id="A1.E8.m1.2.2.1.cmml" xref="A1.E8.m1.2.2.1"><times id="A1.E8.m1.2.2.1.2.cmml" xref="A1.E8.m1.2.2.1.2"></times><ci id="A1.E8.m1.2.2.1.3.cmml" xref="A1.E8.m1.2.2.1.3">𝜋</ci><apply id="A1.E8.m1.2.2.1.1.1.1.cmml" xref="A1.E8.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.2.2.1.1.1.1.1.cmml" xref="A1.E8.m1.2.2.1.1.1">subscript</csymbol><ci id="A1.E8.m1.2.2.1.1.1.1.2.cmml" xref="A1.E8.m1.2.2.1.1.1.1.2">𝑑</ci><ci id="A1.E8.m1.2.2.1.1.1.1.3.cmml" xref="A1.E8.m1.2.2.1.1.1.1.3">𝑘</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.5c">W^{q^{\prime}}=[w^{q}_{\pi(1)},...,w^{q}_{\pi(d_{k})}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.p3" class="ltx_para ltx_noindent">
<table id="A1.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E9.m1.5" class="ltx_Math" alttext="W^{k^{\prime}}=[w^{k}_{\pi(1)},...,w^{k}_{\pi(d_{k})}]" display="block"><semantics id="A1.E9.m1.5a"><mrow id="A1.E9.m1.5.5" xref="A1.E9.m1.5.5.cmml"><msup id="A1.E9.m1.5.5.4" xref="A1.E9.m1.5.5.4.cmml"><mi id="A1.E9.m1.5.5.4.2" xref="A1.E9.m1.5.5.4.2.cmml">W</mi><msup id="A1.E9.m1.5.5.4.3" xref="A1.E9.m1.5.5.4.3.cmml"><mi id="A1.E9.m1.5.5.4.3.2" xref="A1.E9.m1.5.5.4.3.2.cmml">k</mi><mo id="A1.E9.m1.5.5.4.3.3" xref="A1.E9.m1.5.5.4.3.3.cmml">′</mo></msup></msup><mo id="A1.E9.m1.5.5.3" xref="A1.E9.m1.5.5.3.cmml">=</mo><mrow id="A1.E9.m1.5.5.2.2" xref="A1.E9.m1.5.5.2.3.cmml"><mo stretchy="false" id="A1.E9.m1.5.5.2.2.3" xref="A1.E9.m1.5.5.2.3.cmml">[</mo><msubsup id="A1.E9.m1.4.4.1.1.1" xref="A1.E9.m1.4.4.1.1.1.cmml"><mi id="A1.E9.m1.4.4.1.1.1.2.2" xref="A1.E9.m1.4.4.1.1.1.2.2.cmml">w</mi><mrow id="A1.E9.m1.1.1.1" xref="A1.E9.m1.1.1.1.cmml"><mi id="A1.E9.m1.1.1.1.3" xref="A1.E9.m1.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E9.m1.1.1.1.2" xref="A1.E9.m1.1.1.1.2.cmml">​</mo><mrow id="A1.E9.m1.1.1.1.4.2" xref="A1.E9.m1.1.1.1.cmml"><mo stretchy="false" id="A1.E9.m1.1.1.1.4.2.1" xref="A1.E9.m1.1.1.1.cmml">(</mo><mn id="A1.E9.m1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml">1</mn><mo stretchy="false" id="A1.E9.m1.1.1.1.4.2.2" xref="A1.E9.m1.1.1.1.cmml">)</mo></mrow></mrow><mi id="A1.E9.m1.4.4.1.1.1.2.3" xref="A1.E9.m1.4.4.1.1.1.2.3.cmml">k</mi></msubsup><mo id="A1.E9.m1.5.5.2.2.4" xref="A1.E9.m1.5.5.2.3.cmml">,</mo><mi mathvariant="normal" id="A1.E9.m1.3.3" xref="A1.E9.m1.3.3.cmml">…</mi><mo id="A1.E9.m1.5.5.2.2.5" xref="A1.E9.m1.5.5.2.3.cmml">,</mo><msubsup id="A1.E9.m1.5.5.2.2.2" xref="A1.E9.m1.5.5.2.2.2.cmml"><mi id="A1.E9.m1.5.5.2.2.2.2.2" xref="A1.E9.m1.5.5.2.2.2.2.2.cmml">w</mi><mrow id="A1.E9.m1.2.2.1" xref="A1.E9.m1.2.2.1.cmml"><mi id="A1.E9.m1.2.2.1.3" xref="A1.E9.m1.2.2.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E9.m1.2.2.1.2" xref="A1.E9.m1.2.2.1.2.cmml">​</mo><mrow id="A1.E9.m1.2.2.1.1.1" xref="A1.E9.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A1.E9.m1.2.2.1.1.1.2" xref="A1.E9.m1.2.2.1.1.1.1.cmml">(</mo><msub id="A1.E9.m1.2.2.1.1.1.1" xref="A1.E9.m1.2.2.1.1.1.1.cmml"><mi id="A1.E9.m1.2.2.1.1.1.1.2" xref="A1.E9.m1.2.2.1.1.1.1.2.cmml">d</mi><mi id="A1.E9.m1.2.2.1.1.1.1.3" xref="A1.E9.m1.2.2.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="A1.E9.m1.2.2.1.1.1.3" xref="A1.E9.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mi id="A1.E9.m1.5.5.2.2.2.2.3" xref="A1.E9.m1.5.5.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="A1.E9.m1.5.5.2.2.6" xref="A1.E9.m1.5.5.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.5b"><apply id="A1.E9.m1.5.5.cmml" xref="A1.E9.m1.5.5"><eq id="A1.E9.m1.5.5.3.cmml" xref="A1.E9.m1.5.5.3"></eq><apply id="A1.E9.m1.5.5.4.cmml" xref="A1.E9.m1.5.5.4"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.4.1.cmml" xref="A1.E9.m1.5.5.4">superscript</csymbol><ci id="A1.E9.m1.5.5.4.2.cmml" xref="A1.E9.m1.5.5.4.2">𝑊</ci><apply id="A1.E9.m1.5.5.4.3.cmml" xref="A1.E9.m1.5.5.4.3"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.4.3.1.cmml" xref="A1.E9.m1.5.5.4.3">superscript</csymbol><ci id="A1.E9.m1.5.5.4.3.2.cmml" xref="A1.E9.m1.5.5.4.3.2">𝑘</ci><ci id="A1.E9.m1.5.5.4.3.3.cmml" xref="A1.E9.m1.5.5.4.3.3">′</ci></apply></apply><list id="A1.E9.m1.5.5.2.3.cmml" xref="A1.E9.m1.5.5.2.2"><apply id="A1.E9.m1.4.4.1.1.1.cmml" xref="A1.E9.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.1.1.1.1.cmml" xref="A1.E9.m1.4.4.1.1.1">subscript</csymbol><apply id="A1.E9.m1.4.4.1.1.1.2.cmml" xref="A1.E9.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.1.1.1.2.1.cmml" xref="A1.E9.m1.4.4.1.1.1">superscript</csymbol><ci id="A1.E9.m1.4.4.1.1.1.2.2.cmml" xref="A1.E9.m1.4.4.1.1.1.2.2">𝑤</ci><ci id="A1.E9.m1.4.4.1.1.1.2.3.cmml" xref="A1.E9.m1.4.4.1.1.1.2.3">𝑘</ci></apply><apply id="A1.E9.m1.1.1.1.cmml" xref="A1.E9.m1.1.1.1"><times id="A1.E9.m1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.2"></times><ci id="A1.E9.m1.1.1.1.3.cmml" xref="A1.E9.m1.1.1.1.3">𝜋</ci><cn type="integer" id="A1.E9.m1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1">1</cn></apply></apply><ci id="A1.E9.m1.3.3.cmml" xref="A1.E9.m1.3.3">…</ci><apply id="A1.E9.m1.5.5.2.2.2.cmml" xref="A1.E9.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.2.2.2.1.cmml" xref="A1.E9.m1.5.5.2.2.2">subscript</csymbol><apply id="A1.E9.m1.5.5.2.2.2.2.cmml" xref="A1.E9.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.2.2.2.2.1.cmml" xref="A1.E9.m1.5.5.2.2.2">superscript</csymbol><ci id="A1.E9.m1.5.5.2.2.2.2.2.cmml" xref="A1.E9.m1.5.5.2.2.2.2.2">𝑤</ci><ci id="A1.E9.m1.5.5.2.2.2.2.3.cmml" xref="A1.E9.m1.5.5.2.2.2.2.3">𝑘</ci></apply><apply id="A1.E9.m1.2.2.1.cmml" xref="A1.E9.m1.2.2.1"><times id="A1.E9.m1.2.2.1.2.cmml" xref="A1.E9.m1.2.2.1.2"></times><ci id="A1.E9.m1.2.2.1.3.cmml" xref="A1.E9.m1.2.2.1.3">𝜋</ci><apply id="A1.E9.m1.2.2.1.1.1.1.cmml" xref="A1.E9.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.2.2.1.1.1.1.1.cmml" xref="A1.E9.m1.2.2.1.1.1">subscript</csymbol><ci id="A1.E9.m1.2.2.1.1.1.1.2.cmml" xref="A1.E9.m1.2.2.1.1.1.1.2">𝑑</ci><ci id="A1.E9.m1.2.2.1.1.1.1.3.cmml" xref="A1.E9.m1.2.2.1.1.1.1.3">𝑘</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.5c">W^{k^{\prime}}=[w^{k}_{\pi(1)},...,w^{k}_{\pi(d_{k})}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.p4" class="ltx_para ltx_noindent">
<p id="A1.SS1.p4.14" class="ltx_p"><span id="A1.SS1.p4.14.1" class="ltx_text ltx_font_bold">Theorem</span>: Given matrices <math id="A1.SS1.p4.1.m1.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="A1.SS1.p4.1.m1.1a"><msup id="A1.SS1.p4.1.m1.1.1" xref="A1.SS1.p4.1.m1.1.1.cmml"><mi id="A1.SS1.p4.1.m1.1.1.2" xref="A1.SS1.p4.1.m1.1.1.2.cmml">W</mi><mi id="A1.SS1.p4.1.m1.1.1.3" xref="A1.SS1.p4.1.m1.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.1.m1.1b"><apply id="A1.SS1.p4.1.m1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.1.m1.1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1">superscript</csymbol><ci id="A1.SS1.p4.1.m1.1.1.2.cmml" xref="A1.SS1.p4.1.m1.1.1.2">𝑊</ci><ci id="A1.SS1.p4.1.m1.1.1.3.cmml" xref="A1.SS1.p4.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.1.m1.1c">W^{q}</annotation></semantics></math> and <math id="A1.SS1.p4.2.m2.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="A1.SS1.p4.2.m2.1a"><msup id="A1.SS1.p4.2.m2.1.1" xref="A1.SS1.p4.2.m2.1.1.cmml"><mi id="A1.SS1.p4.2.m2.1.1.2" xref="A1.SS1.p4.2.m2.1.1.2.cmml">W</mi><mi id="A1.SS1.p4.2.m2.1.1.3" xref="A1.SS1.p4.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.2.m2.1b"><apply id="A1.SS1.p4.2.m2.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.2.m2.1.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1">superscript</csymbol><ci id="A1.SS1.p4.2.m2.1.1.2.cmml" xref="A1.SS1.p4.2.m2.1.1.2">𝑊</ci><ci id="A1.SS1.p4.2.m2.1.1.3.cmml" xref="A1.SS1.p4.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.2.m2.1c">W^{k}</annotation></semantics></math> of size <math id="A1.SS1.p4.3.m3.1" class="ltx_Math" alttext="d\times d_{k}" display="inline"><semantics id="A1.SS1.p4.3.m3.1a"><mrow id="A1.SS1.p4.3.m3.1.1" xref="A1.SS1.p4.3.m3.1.1.cmml"><mi id="A1.SS1.p4.3.m3.1.1.2" xref="A1.SS1.p4.3.m3.1.1.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p4.3.m3.1.1.1" xref="A1.SS1.p4.3.m3.1.1.1.cmml">×</mo><msub id="A1.SS1.p4.3.m3.1.1.3" xref="A1.SS1.p4.3.m3.1.1.3.cmml"><mi id="A1.SS1.p4.3.m3.1.1.3.2" xref="A1.SS1.p4.3.m3.1.1.3.2.cmml">d</mi><mi id="A1.SS1.p4.3.m3.1.1.3.3" xref="A1.SS1.p4.3.m3.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.3.m3.1b"><apply id="A1.SS1.p4.3.m3.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1"><times id="A1.SS1.p4.3.m3.1.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1"></times><ci id="A1.SS1.p4.3.m3.1.1.2.cmml" xref="A1.SS1.p4.3.m3.1.1.2">𝑑</ci><apply id="A1.SS1.p4.3.m3.1.1.3.cmml" xref="A1.SS1.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.3.m3.1.1.3.1.cmml" xref="A1.SS1.p4.3.m3.1.1.3">subscript</csymbol><ci id="A1.SS1.p4.3.m3.1.1.3.2.cmml" xref="A1.SS1.p4.3.m3.1.1.3.2">𝑑</ci><ci id="A1.SS1.p4.3.m3.1.1.3.3.cmml" xref="A1.SS1.p4.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.3.m3.1c">d\times d_{k}</annotation></semantics></math> and an input <math id="A1.SS1.p4.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A1.SS1.p4.4.m4.1a"><mi id="A1.SS1.p4.4.m4.1.1" xref="A1.SS1.p4.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.4.m4.1b"><ci id="A1.SS1.p4.4.m4.1.1.cmml" xref="A1.SS1.p4.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.4.m4.1c">x</annotation></semantics></math> of size <math id="A1.SS1.p4.5.m5.1" class="ltx_Math" alttext="n\times d" display="inline"><semantics id="A1.SS1.p4.5.m5.1a"><mrow id="A1.SS1.p4.5.m5.1.1" xref="A1.SS1.p4.5.m5.1.1.cmml"><mi id="A1.SS1.p4.5.m5.1.1.2" xref="A1.SS1.p4.5.m5.1.1.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p4.5.m5.1.1.1" xref="A1.SS1.p4.5.m5.1.1.1.cmml">×</mo><mi id="A1.SS1.p4.5.m5.1.1.3" xref="A1.SS1.p4.5.m5.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.5.m5.1b"><apply id="A1.SS1.p4.5.m5.1.1.cmml" xref="A1.SS1.p4.5.m5.1.1"><times id="A1.SS1.p4.5.m5.1.1.1.cmml" xref="A1.SS1.p4.5.m5.1.1.1"></times><ci id="A1.SS1.p4.5.m5.1.1.2.cmml" xref="A1.SS1.p4.5.m5.1.1.2">𝑛</ci><ci id="A1.SS1.p4.5.m5.1.1.3.cmml" xref="A1.SS1.p4.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.5.m5.1c">n\times d</annotation></semantics></math>, if we apply a consistent permutation <math id="A1.SS1.p4.6.m6.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="A1.SS1.p4.6.m6.1a"><mi id="A1.SS1.p4.6.m6.1.1" xref="A1.SS1.p4.6.m6.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.6.m6.1b"><ci id="A1.SS1.p4.6.m6.1.1.cmml" xref="A1.SS1.p4.6.m6.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.6.m6.1c">\pi</annotation></semantics></math> to the columns of both <math id="A1.SS1.p4.7.m7.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="A1.SS1.p4.7.m7.1a"><msup id="A1.SS1.p4.7.m7.1.1" xref="A1.SS1.p4.7.m7.1.1.cmml"><mi id="A1.SS1.p4.7.m7.1.1.2" xref="A1.SS1.p4.7.m7.1.1.2.cmml">W</mi><mi id="A1.SS1.p4.7.m7.1.1.3" xref="A1.SS1.p4.7.m7.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.7.m7.1b"><apply id="A1.SS1.p4.7.m7.1.1.cmml" xref="A1.SS1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.7.m7.1.1.1.cmml" xref="A1.SS1.p4.7.m7.1.1">superscript</csymbol><ci id="A1.SS1.p4.7.m7.1.1.2.cmml" xref="A1.SS1.p4.7.m7.1.1.2">𝑊</ci><ci id="A1.SS1.p4.7.m7.1.1.3.cmml" xref="A1.SS1.p4.7.m7.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.7.m7.1c">W^{q}</annotation></semantics></math> and <math id="A1.SS1.p4.8.m8.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="A1.SS1.p4.8.m8.1a"><msup id="A1.SS1.p4.8.m8.1.1" xref="A1.SS1.p4.8.m8.1.1.cmml"><mi id="A1.SS1.p4.8.m8.1.1.2" xref="A1.SS1.p4.8.m8.1.1.2.cmml">W</mi><mi id="A1.SS1.p4.8.m8.1.1.3" xref="A1.SS1.p4.8.m8.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.8.m8.1b"><apply id="A1.SS1.p4.8.m8.1.1.cmml" xref="A1.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.8.m8.1.1.1.cmml" xref="A1.SS1.p4.8.m8.1.1">superscript</csymbol><ci id="A1.SS1.p4.8.m8.1.1.2.cmml" xref="A1.SS1.p4.8.m8.1.1.2">𝑊</ci><ci id="A1.SS1.p4.8.m8.1.1.3.cmml" xref="A1.SS1.p4.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.8.m8.1c">W^{k}</annotation></semantics></math> to obtain <math id="A1.SS1.p4.9.m9.1" class="ltx_Math" alttext="W^{q^{\prime}}" display="inline"><semantics id="A1.SS1.p4.9.m9.1a"><msup id="A1.SS1.p4.9.m9.1.1" xref="A1.SS1.p4.9.m9.1.1.cmml"><mi id="A1.SS1.p4.9.m9.1.1.2" xref="A1.SS1.p4.9.m9.1.1.2.cmml">W</mi><msup id="A1.SS1.p4.9.m9.1.1.3" xref="A1.SS1.p4.9.m9.1.1.3.cmml"><mi id="A1.SS1.p4.9.m9.1.1.3.2" xref="A1.SS1.p4.9.m9.1.1.3.2.cmml">q</mi><mo id="A1.SS1.p4.9.m9.1.1.3.3" xref="A1.SS1.p4.9.m9.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.9.m9.1b"><apply id="A1.SS1.p4.9.m9.1.1.cmml" xref="A1.SS1.p4.9.m9.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.9.m9.1.1.1.cmml" xref="A1.SS1.p4.9.m9.1.1">superscript</csymbol><ci id="A1.SS1.p4.9.m9.1.1.2.cmml" xref="A1.SS1.p4.9.m9.1.1.2">𝑊</ci><apply id="A1.SS1.p4.9.m9.1.1.3.cmml" xref="A1.SS1.p4.9.m9.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.9.m9.1.1.3.1.cmml" xref="A1.SS1.p4.9.m9.1.1.3">superscript</csymbol><ci id="A1.SS1.p4.9.m9.1.1.3.2.cmml" xref="A1.SS1.p4.9.m9.1.1.3.2">𝑞</ci><ci id="A1.SS1.p4.9.m9.1.1.3.3.cmml" xref="A1.SS1.p4.9.m9.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.9.m9.1c">W^{q^{\prime}}</annotation></semantics></math> and <math id="A1.SS1.p4.10.m10.1" class="ltx_Math" alttext="W^{k^{\prime}}" display="inline"><semantics id="A1.SS1.p4.10.m10.1a"><msup id="A1.SS1.p4.10.m10.1.1" xref="A1.SS1.p4.10.m10.1.1.cmml"><mi id="A1.SS1.p4.10.m10.1.1.2" xref="A1.SS1.p4.10.m10.1.1.2.cmml">W</mi><msup id="A1.SS1.p4.10.m10.1.1.3" xref="A1.SS1.p4.10.m10.1.1.3.cmml"><mi id="A1.SS1.p4.10.m10.1.1.3.2" xref="A1.SS1.p4.10.m10.1.1.3.2.cmml">k</mi><mo id="A1.SS1.p4.10.m10.1.1.3.3" xref="A1.SS1.p4.10.m10.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.10.m10.1b"><apply id="A1.SS1.p4.10.m10.1.1.cmml" xref="A1.SS1.p4.10.m10.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.10.m10.1.1.1.cmml" xref="A1.SS1.p4.10.m10.1.1">superscript</csymbol><ci id="A1.SS1.p4.10.m10.1.1.2.cmml" xref="A1.SS1.p4.10.m10.1.1.2">𝑊</ci><apply id="A1.SS1.p4.10.m10.1.1.3.cmml" xref="A1.SS1.p4.10.m10.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.10.m10.1.1.3.1.cmml" xref="A1.SS1.p4.10.m10.1.1.3">superscript</csymbol><ci id="A1.SS1.p4.10.m10.1.1.3.2.cmml" xref="A1.SS1.p4.10.m10.1.1.3.2">𝑘</ci><ci id="A1.SS1.p4.10.m10.1.1.3.3.cmml" xref="A1.SS1.p4.10.m10.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.10.m10.1c">W^{k^{\prime}}</annotation></semantics></math>, respectively, then the resulting dot-product attention scores computed using <math id="A1.SS1.p4.11.m11.1" class="ltx_Math" alttext="W^{q^{\prime}}" display="inline"><semantics id="A1.SS1.p4.11.m11.1a"><msup id="A1.SS1.p4.11.m11.1.1" xref="A1.SS1.p4.11.m11.1.1.cmml"><mi id="A1.SS1.p4.11.m11.1.1.2" xref="A1.SS1.p4.11.m11.1.1.2.cmml">W</mi><msup id="A1.SS1.p4.11.m11.1.1.3" xref="A1.SS1.p4.11.m11.1.1.3.cmml"><mi id="A1.SS1.p4.11.m11.1.1.3.2" xref="A1.SS1.p4.11.m11.1.1.3.2.cmml">q</mi><mo id="A1.SS1.p4.11.m11.1.1.3.3" xref="A1.SS1.p4.11.m11.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.11.m11.1b"><apply id="A1.SS1.p4.11.m11.1.1.cmml" xref="A1.SS1.p4.11.m11.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.11.m11.1.1.1.cmml" xref="A1.SS1.p4.11.m11.1.1">superscript</csymbol><ci id="A1.SS1.p4.11.m11.1.1.2.cmml" xref="A1.SS1.p4.11.m11.1.1.2">𝑊</ci><apply id="A1.SS1.p4.11.m11.1.1.3.cmml" xref="A1.SS1.p4.11.m11.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.11.m11.1.1.3.1.cmml" xref="A1.SS1.p4.11.m11.1.1.3">superscript</csymbol><ci id="A1.SS1.p4.11.m11.1.1.3.2.cmml" xref="A1.SS1.p4.11.m11.1.1.3.2">𝑞</ci><ci id="A1.SS1.p4.11.m11.1.1.3.3.cmml" xref="A1.SS1.p4.11.m11.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.11.m11.1c">W^{q^{\prime}}</annotation></semantics></math> and <math id="A1.SS1.p4.12.m12.1" class="ltx_Math" alttext="W^{k^{\prime}}" display="inline"><semantics id="A1.SS1.p4.12.m12.1a"><msup id="A1.SS1.p4.12.m12.1.1" xref="A1.SS1.p4.12.m12.1.1.cmml"><mi id="A1.SS1.p4.12.m12.1.1.2" xref="A1.SS1.p4.12.m12.1.1.2.cmml">W</mi><msup id="A1.SS1.p4.12.m12.1.1.3" xref="A1.SS1.p4.12.m12.1.1.3.cmml"><mi id="A1.SS1.p4.12.m12.1.1.3.2" xref="A1.SS1.p4.12.m12.1.1.3.2.cmml">k</mi><mo id="A1.SS1.p4.12.m12.1.1.3.3" xref="A1.SS1.p4.12.m12.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.12.m12.1b"><apply id="A1.SS1.p4.12.m12.1.1.cmml" xref="A1.SS1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.12.m12.1.1.1.cmml" xref="A1.SS1.p4.12.m12.1.1">superscript</csymbol><ci id="A1.SS1.p4.12.m12.1.1.2.cmml" xref="A1.SS1.p4.12.m12.1.1.2">𝑊</ci><apply id="A1.SS1.p4.12.m12.1.1.3.cmml" xref="A1.SS1.p4.12.m12.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.12.m12.1.1.3.1.cmml" xref="A1.SS1.p4.12.m12.1.1.3">superscript</csymbol><ci id="A1.SS1.p4.12.m12.1.1.3.2.cmml" xref="A1.SS1.p4.12.m12.1.1.3.2">𝑘</ci><ci id="A1.SS1.p4.12.m12.1.1.3.3.cmml" xref="A1.SS1.p4.12.m12.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.12.m12.1c">W^{k^{\prime}}</annotation></semantics></math> will be identical to those computed using the original <math id="A1.SS1.p4.13.m13.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="A1.SS1.p4.13.m13.1a"><msup id="A1.SS1.p4.13.m13.1.1" xref="A1.SS1.p4.13.m13.1.1.cmml"><mi id="A1.SS1.p4.13.m13.1.1.2" xref="A1.SS1.p4.13.m13.1.1.2.cmml">W</mi><mi id="A1.SS1.p4.13.m13.1.1.3" xref="A1.SS1.p4.13.m13.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.13.m13.1b"><apply id="A1.SS1.p4.13.m13.1.1.cmml" xref="A1.SS1.p4.13.m13.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.13.m13.1.1.1.cmml" xref="A1.SS1.p4.13.m13.1.1">superscript</csymbol><ci id="A1.SS1.p4.13.m13.1.1.2.cmml" xref="A1.SS1.p4.13.m13.1.1.2">𝑊</ci><ci id="A1.SS1.p4.13.m13.1.1.3.cmml" xref="A1.SS1.p4.13.m13.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.13.m13.1c">W^{q}</annotation></semantics></math> and <math id="A1.SS1.p4.14.m14.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="A1.SS1.p4.14.m14.1a"><msup id="A1.SS1.p4.14.m14.1.1" xref="A1.SS1.p4.14.m14.1.1.cmml"><mi id="A1.SS1.p4.14.m14.1.1.2" xref="A1.SS1.p4.14.m14.1.1.2.cmml">W</mi><mi id="A1.SS1.p4.14.m14.1.1.3" xref="A1.SS1.p4.14.m14.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.14.m14.1b"><apply id="A1.SS1.p4.14.m14.1.1.cmml" xref="A1.SS1.p4.14.m14.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.14.m14.1.1.1.cmml" xref="A1.SS1.p4.14.m14.1.1">superscript</csymbol><ci id="A1.SS1.p4.14.m14.1.1.2.cmml" xref="A1.SS1.p4.14.m14.1.1.2">𝑊</ci><ci id="A1.SS1.p4.14.m14.1.1.3.cmml" xref="A1.SS1.p4.14.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.14.m14.1c">W^{k}</annotation></semantics></math>.</p>
</div>
<div id="A1.SS1.p5" class="ltx_para ltx_noindent">
<p id="A1.SS1.p5.1" class="ltx_p"><span id="A1.SS1.p5.1.1" class="ltx_text ltx_font_bold">Proof</span>:</p>
</div>
<div id="A1.SS1.p6" class="ltx_para ltx_noindent">
<p id="A1.SS1.p6.3" class="ltx_p">Let <math id="A1.SS1.p6.1.m1.1" class="ltx_Math" alttext="Q=xW^{q}" display="inline"><semantics id="A1.SS1.p6.1.m1.1a"><mrow id="A1.SS1.p6.1.m1.1.1" xref="A1.SS1.p6.1.m1.1.1.cmml"><mi id="A1.SS1.p6.1.m1.1.1.2" xref="A1.SS1.p6.1.m1.1.1.2.cmml">Q</mi><mo id="A1.SS1.p6.1.m1.1.1.1" xref="A1.SS1.p6.1.m1.1.1.1.cmml">=</mo><mrow id="A1.SS1.p6.1.m1.1.1.3" xref="A1.SS1.p6.1.m1.1.1.3.cmml"><mi id="A1.SS1.p6.1.m1.1.1.3.2" xref="A1.SS1.p6.1.m1.1.1.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p6.1.m1.1.1.3.1" xref="A1.SS1.p6.1.m1.1.1.3.1.cmml">​</mo><msup id="A1.SS1.p6.1.m1.1.1.3.3" xref="A1.SS1.p6.1.m1.1.1.3.3.cmml"><mi id="A1.SS1.p6.1.m1.1.1.3.3.2" xref="A1.SS1.p6.1.m1.1.1.3.3.2.cmml">W</mi><mi id="A1.SS1.p6.1.m1.1.1.3.3.3" xref="A1.SS1.p6.1.m1.1.1.3.3.3.cmml">q</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p6.1.m1.1b"><apply id="A1.SS1.p6.1.m1.1.1.cmml" xref="A1.SS1.p6.1.m1.1.1"><eq id="A1.SS1.p6.1.m1.1.1.1.cmml" xref="A1.SS1.p6.1.m1.1.1.1"></eq><ci id="A1.SS1.p6.1.m1.1.1.2.cmml" xref="A1.SS1.p6.1.m1.1.1.2">𝑄</ci><apply id="A1.SS1.p6.1.m1.1.1.3.cmml" xref="A1.SS1.p6.1.m1.1.1.3"><times id="A1.SS1.p6.1.m1.1.1.3.1.cmml" xref="A1.SS1.p6.1.m1.1.1.3.1"></times><ci id="A1.SS1.p6.1.m1.1.1.3.2.cmml" xref="A1.SS1.p6.1.m1.1.1.3.2">𝑥</ci><apply id="A1.SS1.p6.1.m1.1.1.3.3.cmml" xref="A1.SS1.p6.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p6.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.p6.1.m1.1.1.3.3">superscript</csymbol><ci id="A1.SS1.p6.1.m1.1.1.3.3.2.cmml" xref="A1.SS1.p6.1.m1.1.1.3.3.2">𝑊</ci><ci id="A1.SS1.p6.1.m1.1.1.3.3.3.cmml" xref="A1.SS1.p6.1.m1.1.1.3.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p6.1.m1.1c">Q=xW^{q}</annotation></semantics></math> and <math id="A1.SS1.p6.2.m2.1" class="ltx_Math" alttext="K=xW^{k}" display="inline"><semantics id="A1.SS1.p6.2.m2.1a"><mrow id="A1.SS1.p6.2.m2.1.1" xref="A1.SS1.p6.2.m2.1.1.cmml"><mi id="A1.SS1.p6.2.m2.1.1.2" xref="A1.SS1.p6.2.m2.1.1.2.cmml">K</mi><mo id="A1.SS1.p6.2.m2.1.1.1" xref="A1.SS1.p6.2.m2.1.1.1.cmml">=</mo><mrow id="A1.SS1.p6.2.m2.1.1.3" xref="A1.SS1.p6.2.m2.1.1.3.cmml"><mi id="A1.SS1.p6.2.m2.1.1.3.2" xref="A1.SS1.p6.2.m2.1.1.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p6.2.m2.1.1.3.1" xref="A1.SS1.p6.2.m2.1.1.3.1.cmml">​</mo><msup id="A1.SS1.p6.2.m2.1.1.3.3" xref="A1.SS1.p6.2.m2.1.1.3.3.cmml"><mi id="A1.SS1.p6.2.m2.1.1.3.3.2" xref="A1.SS1.p6.2.m2.1.1.3.3.2.cmml">W</mi><mi id="A1.SS1.p6.2.m2.1.1.3.3.3" xref="A1.SS1.p6.2.m2.1.1.3.3.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p6.2.m2.1b"><apply id="A1.SS1.p6.2.m2.1.1.cmml" xref="A1.SS1.p6.2.m2.1.1"><eq id="A1.SS1.p6.2.m2.1.1.1.cmml" xref="A1.SS1.p6.2.m2.1.1.1"></eq><ci id="A1.SS1.p6.2.m2.1.1.2.cmml" xref="A1.SS1.p6.2.m2.1.1.2">𝐾</ci><apply id="A1.SS1.p6.2.m2.1.1.3.cmml" xref="A1.SS1.p6.2.m2.1.1.3"><times id="A1.SS1.p6.2.m2.1.1.3.1.cmml" xref="A1.SS1.p6.2.m2.1.1.3.1"></times><ci id="A1.SS1.p6.2.m2.1.1.3.2.cmml" xref="A1.SS1.p6.2.m2.1.1.3.2">𝑥</ci><apply id="A1.SS1.p6.2.m2.1.1.3.3.cmml" xref="A1.SS1.p6.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p6.2.m2.1.1.3.3.1.cmml" xref="A1.SS1.p6.2.m2.1.1.3.3">superscript</csymbol><ci id="A1.SS1.p6.2.m2.1.1.3.3.2.cmml" xref="A1.SS1.p6.2.m2.1.1.3.3.2">𝑊</ci><ci id="A1.SS1.p6.2.m2.1.1.3.3.3.cmml" xref="A1.SS1.p6.2.m2.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p6.2.m2.1c">K=xW^{k}</annotation></semantics></math> be the original query and key matrices. Their sizes are <math id="A1.SS1.p6.3.m3.1" class="ltx_Math" alttext="n\times d_{k}" display="inline"><semantics id="A1.SS1.p6.3.m3.1a"><mrow id="A1.SS1.p6.3.m3.1.1" xref="A1.SS1.p6.3.m3.1.1.cmml"><mi id="A1.SS1.p6.3.m3.1.1.2" xref="A1.SS1.p6.3.m3.1.1.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p6.3.m3.1.1.1" xref="A1.SS1.p6.3.m3.1.1.1.cmml">×</mo><msub id="A1.SS1.p6.3.m3.1.1.3" xref="A1.SS1.p6.3.m3.1.1.3.cmml"><mi id="A1.SS1.p6.3.m3.1.1.3.2" xref="A1.SS1.p6.3.m3.1.1.3.2.cmml">d</mi><mi id="A1.SS1.p6.3.m3.1.1.3.3" xref="A1.SS1.p6.3.m3.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p6.3.m3.1b"><apply id="A1.SS1.p6.3.m3.1.1.cmml" xref="A1.SS1.p6.3.m3.1.1"><times id="A1.SS1.p6.3.m3.1.1.1.cmml" xref="A1.SS1.p6.3.m3.1.1.1"></times><ci id="A1.SS1.p6.3.m3.1.1.2.cmml" xref="A1.SS1.p6.3.m3.1.1.2">𝑛</ci><apply id="A1.SS1.p6.3.m3.1.1.3.cmml" xref="A1.SS1.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p6.3.m3.1.1.3.1.cmml" xref="A1.SS1.p6.3.m3.1.1.3">subscript</csymbol><ci id="A1.SS1.p6.3.m3.1.1.3.2.cmml" xref="A1.SS1.p6.3.m3.1.1.3.2">𝑑</ci><ci id="A1.SS1.p6.3.m3.1.1.3.3.cmml" xref="A1.SS1.p6.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p6.3.m3.1c">n\times d_{k}</annotation></semantics></math>.</p>
</div>
<div id="A1.SS1.p7" class="ltx_para ltx_noindent">
<p id="A1.SS1.p7.3" class="ltx_p">Let <math id="A1.SS1.p7.1.m1.1" class="ltx_Math" alttext="Q^{\prime}=xW^{q^{\prime}}" display="inline"><semantics id="A1.SS1.p7.1.m1.1a"><mrow id="A1.SS1.p7.1.m1.1.1" xref="A1.SS1.p7.1.m1.1.1.cmml"><msup id="A1.SS1.p7.1.m1.1.1.2" xref="A1.SS1.p7.1.m1.1.1.2.cmml"><mi id="A1.SS1.p7.1.m1.1.1.2.2" xref="A1.SS1.p7.1.m1.1.1.2.2.cmml">Q</mi><mo id="A1.SS1.p7.1.m1.1.1.2.3" xref="A1.SS1.p7.1.m1.1.1.2.3.cmml">′</mo></msup><mo id="A1.SS1.p7.1.m1.1.1.1" xref="A1.SS1.p7.1.m1.1.1.1.cmml">=</mo><mrow id="A1.SS1.p7.1.m1.1.1.3" xref="A1.SS1.p7.1.m1.1.1.3.cmml"><mi id="A1.SS1.p7.1.m1.1.1.3.2" xref="A1.SS1.p7.1.m1.1.1.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p7.1.m1.1.1.3.1" xref="A1.SS1.p7.1.m1.1.1.3.1.cmml">​</mo><msup id="A1.SS1.p7.1.m1.1.1.3.3" xref="A1.SS1.p7.1.m1.1.1.3.3.cmml"><mi id="A1.SS1.p7.1.m1.1.1.3.3.2" xref="A1.SS1.p7.1.m1.1.1.3.3.2.cmml">W</mi><msup id="A1.SS1.p7.1.m1.1.1.3.3.3" xref="A1.SS1.p7.1.m1.1.1.3.3.3.cmml"><mi id="A1.SS1.p7.1.m1.1.1.3.3.3.2" xref="A1.SS1.p7.1.m1.1.1.3.3.3.2.cmml">q</mi><mo id="A1.SS1.p7.1.m1.1.1.3.3.3.3" xref="A1.SS1.p7.1.m1.1.1.3.3.3.3.cmml">′</mo></msup></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p7.1.m1.1b"><apply id="A1.SS1.p7.1.m1.1.1.cmml" xref="A1.SS1.p7.1.m1.1.1"><eq id="A1.SS1.p7.1.m1.1.1.1.cmml" xref="A1.SS1.p7.1.m1.1.1.1"></eq><apply id="A1.SS1.p7.1.m1.1.1.2.cmml" xref="A1.SS1.p7.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p7.1.m1.1.1.2.1.cmml" xref="A1.SS1.p7.1.m1.1.1.2">superscript</csymbol><ci id="A1.SS1.p7.1.m1.1.1.2.2.cmml" xref="A1.SS1.p7.1.m1.1.1.2.2">𝑄</ci><ci id="A1.SS1.p7.1.m1.1.1.2.3.cmml" xref="A1.SS1.p7.1.m1.1.1.2.3">′</ci></apply><apply id="A1.SS1.p7.1.m1.1.1.3.cmml" xref="A1.SS1.p7.1.m1.1.1.3"><times id="A1.SS1.p7.1.m1.1.1.3.1.cmml" xref="A1.SS1.p7.1.m1.1.1.3.1"></times><ci id="A1.SS1.p7.1.m1.1.1.3.2.cmml" xref="A1.SS1.p7.1.m1.1.1.3.2">𝑥</ci><apply id="A1.SS1.p7.1.m1.1.1.3.3.cmml" xref="A1.SS1.p7.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p7.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.p7.1.m1.1.1.3.3">superscript</csymbol><ci id="A1.SS1.p7.1.m1.1.1.3.3.2.cmml" xref="A1.SS1.p7.1.m1.1.1.3.3.2">𝑊</ci><apply id="A1.SS1.p7.1.m1.1.1.3.3.3.cmml" xref="A1.SS1.p7.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.p7.1.m1.1.1.3.3.3.1.cmml" xref="A1.SS1.p7.1.m1.1.1.3.3.3">superscript</csymbol><ci id="A1.SS1.p7.1.m1.1.1.3.3.3.2.cmml" xref="A1.SS1.p7.1.m1.1.1.3.3.3.2">𝑞</ci><ci id="A1.SS1.p7.1.m1.1.1.3.3.3.3.cmml" xref="A1.SS1.p7.1.m1.1.1.3.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p7.1.m1.1c">Q^{\prime}=xW^{q^{\prime}}</annotation></semantics></math> and <math id="A1.SS1.p7.2.m2.1" class="ltx_Math" alttext="K^{\prime}=xW^{k^{\prime}}" display="inline"><semantics id="A1.SS1.p7.2.m2.1a"><mrow id="A1.SS1.p7.2.m2.1.1" xref="A1.SS1.p7.2.m2.1.1.cmml"><msup id="A1.SS1.p7.2.m2.1.1.2" xref="A1.SS1.p7.2.m2.1.1.2.cmml"><mi id="A1.SS1.p7.2.m2.1.1.2.2" xref="A1.SS1.p7.2.m2.1.1.2.2.cmml">K</mi><mo id="A1.SS1.p7.2.m2.1.1.2.3" xref="A1.SS1.p7.2.m2.1.1.2.3.cmml">′</mo></msup><mo id="A1.SS1.p7.2.m2.1.1.1" xref="A1.SS1.p7.2.m2.1.1.1.cmml">=</mo><mrow id="A1.SS1.p7.2.m2.1.1.3" xref="A1.SS1.p7.2.m2.1.1.3.cmml"><mi id="A1.SS1.p7.2.m2.1.1.3.2" xref="A1.SS1.p7.2.m2.1.1.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p7.2.m2.1.1.3.1" xref="A1.SS1.p7.2.m2.1.1.3.1.cmml">​</mo><msup id="A1.SS1.p7.2.m2.1.1.3.3" xref="A1.SS1.p7.2.m2.1.1.3.3.cmml"><mi id="A1.SS1.p7.2.m2.1.1.3.3.2" xref="A1.SS1.p7.2.m2.1.1.3.3.2.cmml">W</mi><msup id="A1.SS1.p7.2.m2.1.1.3.3.3" xref="A1.SS1.p7.2.m2.1.1.3.3.3.cmml"><mi id="A1.SS1.p7.2.m2.1.1.3.3.3.2" xref="A1.SS1.p7.2.m2.1.1.3.3.3.2.cmml">k</mi><mo id="A1.SS1.p7.2.m2.1.1.3.3.3.3" xref="A1.SS1.p7.2.m2.1.1.3.3.3.3.cmml">′</mo></msup></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p7.2.m2.1b"><apply id="A1.SS1.p7.2.m2.1.1.cmml" xref="A1.SS1.p7.2.m2.1.1"><eq id="A1.SS1.p7.2.m2.1.1.1.cmml" xref="A1.SS1.p7.2.m2.1.1.1"></eq><apply id="A1.SS1.p7.2.m2.1.1.2.cmml" xref="A1.SS1.p7.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p7.2.m2.1.1.2.1.cmml" xref="A1.SS1.p7.2.m2.1.1.2">superscript</csymbol><ci id="A1.SS1.p7.2.m2.1.1.2.2.cmml" xref="A1.SS1.p7.2.m2.1.1.2.2">𝐾</ci><ci id="A1.SS1.p7.2.m2.1.1.2.3.cmml" xref="A1.SS1.p7.2.m2.1.1.2.3">′</ci></apply><apply id="A1.SS1.p7.2.m2.1.1.3.cmml" xref="A1.SS1.p7.2.m2.1.1.3"><times id="A1.SS1.p7.2.m2.1.1.3.1.cmml" xref="A1.SS1.p7.2.m2.1.1.3.1"></times><ci id="A1.SS1.p7.2.m2.1.1.3.2.cmml" xref="A1.SS1.p7.2.m2.1.1.3.2">𝑥</ci><apply id="A1.SS1.p7.2.m2.1.1.3.3.cmml" xref="A1.SS1.p7.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p7.2.m2.1.1.3.3.1.cmml" xref="A1.SS1.p7.2.m2.1.1.3.3">superscript</csymbol><ci id="A1.SS1.p7.2.m2.1.1.3.3.2.cmml" xref="A1.SS1.p7.2.m2.1.1.3.3.2">𝑊</ci><apply id="A1.SS1.p7.2.m2.1.1.3.3.3.cmml" xref="A1.SS1.p7.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.p7.2.m2.1.1.3.3.3.1.cmml" xref="A1.SS1.p7.2.m2.1.1.3.3.3">superscript</csymbol><ci id="A1.SS1.p7.2.m2.1.1.3.3.3.2.cmml" xref="A1.SS1.p7.2.m2.1.1.3.3.3.2">𝑘</ci><ci id="A1.SS1.p7.2.m2.1.1.3.3.3.3.cmml" xref="A1.SS1.p7.2.m2.1.1.3.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p7.2.m2.1c">K^{\prime}=xW^{k^{\prime}}</annotation></semantics></math> be the query and key matrices after applying the permutation <math id="A1.SS1.p7.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="A1.SS1.p7.3.m3.1a"><mi id="A1.SS1.p7.3.m3.1.1" xref="A1.SS1.p7.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p7.3.m3.1b"><ci id="A1.SS1.p7.3.m3.1.1.cmml" xref="A1.SS1.p7.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p7.3.m3.1c">\pi</annotation></semantics></math>.</p>
</div>
<div id="A1.SS1.p8" class="ltx_para ltx_noindent">
<p id="A1.SS1.p8.6" class="ltx_p">By our definition of the permutation, for each column <math id="A1.SS1.p8.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A1.SS1.p8.1.m1.1a"><mi id="A1.SS1.p8.1.m1.1.1" xref="A1.SS1.p8.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p8.1.m1.1b"><ci id="A1.SS1.p8.1.m1.1.1.cmml" xref="A1.SS1.p8.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p8.1.m1.1c">c</annotation></semantics></math> in <math id="A1.SS1.p8.2.m2.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="A1.SS1.p8.2.m2.1a"><msup id="A1.SS1.p8.2.m2.1.1" xref="A1.SS1.p8.2.m2.1.1.cmml"><mi id="A1.SS1.p8.2.m2.1.1.2" xref="A1.SS1.p8.2.m2.1.1.2.cmml">W</mi><mi id="A1.SS1.p8.2.m2.1.1.3" xref="A1.SS1.p8.2.m2.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p8.2.m2.1b"><apply id="A1.SS1.p8.2.m2.1.1.cmml" xref="A1.SS1.p8.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p8.2.m2.1.1.1.cmml" xref="A1.SS1.p8.2.m2.1.1">superscript</csymbol><ci id="A1.SS1.p8.2.m2.1.1.2.cmml" xref="A1.SS1.p8.2.m2.1.1.2">𝑊</ci><ci id="A1.SS1.p8.2.m2.1.1.3.cmml" xref="A1.SS1.p8.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p8.2.m2.1c">W^{q}</annotation></semantics></math> and <math id="A1.SS1.p8.3.m3.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="A1.SS1.p8.3.m3.1a"><msup id="A1.SS1.p8.3.m3.1.1" xref="A1.SS1.p8.3.m3.1.1.cmml"><mi id="A1.SS1.p8.3.m3.1.1.2" xref="A1.SS1.p8.3.m3.1.1.2.cmml">W</mi><mi id="A1.SS1.p8.3.m3.1.1.3" xref="A1.SS1.p8.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p8.3.m3.1b"><apply id="A1.SS1.p8.3.m3.1.1.cmml" xref="A1.SS1.p8.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p8.3.m3.1.1.1.cmml" xref="A1.SS1.p8.3.m3.1.1">superscript</csymbol><ci id="A1.SS1.p8.3.m3.1.1.2.cmml" xref="A1.SS1.p8.3.m3.1.1.2">𝑊</ci><ci id="A1.SS1.p8.3.m3.1.1.3.cmml" xref="A1.SS1.p8.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p8.3.m3.1c">W^{k}</annotation></semantics></math>, the new position in the permuted matrices is <math id="A1.SS1.p8.4.m4.1" class="ltx_Math" alttext="\pi(c)" display="inline"><semantics id="A1.SS1.p8.4.m4.1a"><mrow id="A1.SS1.p8.4.m4.1.2" xref="A1.SS1.p8.4.m4.1.2.cmml"><mi id="A1.SS1.p8.4.m4.1.2.2" xref="A1.SS1.p8.4.m4.1.2.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p8.4.m4.1.2.1" xref="A1.SS1.p8.4.m4.1.2.1.cmml">​</mo><mrow id="A1.SS1.p8.4.m4.1.2.3.2" xref="A1.SS1.p8.4.m4.1.2.cmml"><mo stretchy="false" id="A1.SS1.p8.4.m4.1.2.3.2.1" xref="A1.SS1.p8.4.m4.1.2.cmml">(</mo><mi id="A1.SS1.p8.4.m4.1.1" xref="A1.SS1.p8.4.m4.1.1.cmml">c</mi><mo stretchy="false" id="A1.SS1.p8.4.m4.1.2.3.2.2" xref="A1.SS1.p8.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p8.4.m4.1b"><apply id="A1.SS1.p8.4.m4.1.2.cmml" xref="A1.SS1.p8.4.m4.1.2"><times id="A1.SS1.p8.4.m4.1.2.1.cmml" xref="A1.SS1.p8.4.m4.1.2.1"></times><ci id="A1.SS1.p8.4.m4.1.2.2.cmml" xref="A1.SS1.p8.4.m4.1.2.2">𝜋</ci><ci id="A1.SS1.p8.4.m4.1.1.cmml" xref="A1.SS1.p8.4.m4.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p8.4.m4.1c">\pi(c)</annotation></semantics></math>. So, the elements of <math id="A1.SS1.p8.5.m5.1" class="ltx_Math" alttext="Q^{\prime}" display="inline"><semantics id="A1.SS1.p8.5.m5.1a"><msup id="A1.SS1.p8.5.m5.1.1" xref="A1.SS1.p8.5.m5.1.1.cmml"><mi id="A1.SS1.p8.5.m5.1.1.2" xref="A1.SS1.p8.5.m5.1.1.2.cmml">Q</mi><mo id="A1.SS1.p8.5.m5.1.1.3" xref="A1.SS1.p8.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p8.5.m5.1b"><apply id="A1.SS1.p8.5.m5.1.1.cmml" xref="A1.SS1.p8.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.p8.5.m5.1.1.1.cmml" xref="A1.SS1.p8.5.m5.1.1">superscript</csymbol><ci id="A1.SS1.p8.5.m5.1.1.2.cmml" xref="A1.SS1.p8.5.m5.1.1.2">𝑄</ci><ci id="A1.SS1.p8.5.m5.1.1.3.cmml" xref="A1.SS1.p8.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p8.5.m5.1c">Q^{\prime}</annotation></semantics></math> and <math id="A1.SS1.p8.6.m6.1" class="ltx_Math" alttext="K^{\prime}" display="inline"><semantics id="A1.SS1.p8.6.m6.1a"><msup id="A1.SS1.p8.6.m6.1.1" xref="A1.SS1.p8.6.m6.1.1.cmml"><mi id="A1.SS1.p8.6.m6.1.1.2" xref="A1.SS1.p8.6.m6.1.1.2.cmml">K</mi><mo id="A1.SS1.p8.6.m6.1.1.3" xref="A1.SS1.p8.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p8.6.m6.1b"><apply id="A1.SS1.p8.6.m6.1.1.cmml" xref="A1.SS1.p8.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p8.6.m6.1.1.1.cmml" xref="A1.SS1.p8.6.m6.1.1">superscript</csymbol><ci id="A1.SS1.p8.6.m6.1.1.2.cmml" xref="A1.SS1.p8.6.m6.1.1.2">𝐾</ci><ci id="A1.SS1.p8.6.m6.1.1.3.cmml" xref="A1.SS1.p8.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p8.6.m6.1c">K^{\prime}</annotation></semantics></math> are given by:</p>
<table id="A1.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E10.m1.2" class="ltx_Math" alttext="Q^{\prime}_{ij}=\sum_{c=1}^{d}x_{ic}W^{q^{\prime}}_{cj}=\sum_{c=1}^{d}x_{ic}W^{q}_{c\pi(j)}=x_{i}\cdot\vec{w}^{q}_{\pi(j)}" display="block"><semantics id="A1.E10.m1.2a"><mrow id="A1.E10.m1.2.3" xref="A1.E10.m1.2.3.cmml"><msubsup id="A1.E10.m1.2.3.2" xref="A1.E10.m1.2.3.2.cmml"><mi id="A1.E10.m1.2.3.2.2.2" xref="A1.E10.m1.2.3.2.2.2.cmml">Q</mi><mrow id="A1.E10.m1.2.3.2.3" xref="A1.E10.m1.2.3.2.3.cmml"><mi id="A1.E10.m1.2.3.2.3.2" xref="A1.E10.m1.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E10.m1.2.3.2.3.1" xref="A1.E10.m1.2.3.2.3.1.cmml">​</mo><mi id="A1.E10.m1.2.3.2.3.3" xref="A1.E10.m1.2.3.2.3.3.cmml">j</mi></mrow><mo id="A1.E10.m1.2.3.2.2.3" xref="A1.E10.m1.2.3.2.2.3.cmml">′</mo></msubsup><mo rspace="0.111em" id="A1.E10.m1.2.3.3" xref="A1.E10.m1.2.3.3.cmml">=</mo><mrow id="A1.E10.m1.2.3.4" xref="A1.E10.m1.2.3.4.cmml"><munderover id="A1.E10.m1.2.3.4.1" xref="A1.E10.m1.2.3.4.1.cmml"><mo movablelimits="false" id="A1.E10.m1.2.3.4.1.2.2" xref="A1.E10.m1.2.3.4.1.2.2.cmml">∑</mo><mrow id="A1.E10.m1.2.3.4.1.2.3" xref="A1.E10.m1.2.3.4.1.2.3.cmml"><mi id="A1.E10.m1.2.3.4.1.2.3.2" xref="A1.E10.m1.2.3.4.1.2.3.2.cmml">c</mi><mo id="A1.E10.m1.2.3.4.1.2.3.1" xref="A1.E10.m1.2.3.4.1.2.3.1.cmml">=</mo><mn id="A1.E10.m1.2.3.4.1.2.3.3" xref="A1.E10.m1.2.3.4.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E10.m1.2.3.4.1.3" xref="A1.E10.m1.2.3.4.1.3.cmml">d</mi></munderover><mrow id="A1.E10.m1.2.3.4.2" xref="A1.E10.m1.2.3.4.2.cmml"><msub id="A1.E10.m1.2.3.4.2.2" xref="A1.E10.m1.2.3.4.2.2.cmml"><mi id="A1.E10.m1.2.3.4.2.2.2" xref="A1.E10.m1.2.3.4.2.2.2.cmml">x</mi><mrow id="A1.E10.m1.2.3.4.2.2.3" xref="A1.E10.m1.2.3.4.2.2.3.cmml"><mi id="A1.E10.m1.2.3.4.2.2.3.2" xref="A1.E10.m1.2.3.4.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E10.m1.2.3.4.2.2.3.1" xref="A1.E10.m1.2.3.4.2.2.3.1.cmml">​</mo><mi id="A1.E10.m1.2.3.4.2.2.3.3" xref="A1.E10.m1.2.3.4.2.2.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E10.m1.2.3.4.2.1" xref="A1.E10.m1.2.3.4.2.1.cmml">​</mo><msubsup id="A1.E10.m1.2.3.4.2.3" xref="A1.E10.m1.2.3.4.2.3.cmml"><mi id="A1.E10.m1.2.3.4.2.3.2.2" xref="A1.E10.m1.2.3.4.2.3.2.2.cmml">W</mi><mrow id="A1.E10.m1.2.3.4.2.3.3" xref="A1.E10.m1.2.3.4.2.3.3.cmml"><mi id="A1.E10.m1.2.3.4.2.3.3.2" xref="A1.E10.m1.2.3.4.2.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A1.E10.m1.2.3.4.2.3.3.1" xref="A1.E10.m1.2.3.4.2.3.3.1.cmml">​</mo><mi id="A1.E10.m1.2.3.4.2.3.3.3" xref="A1.E10.m1.2.3.4.2.3.3.3.cmml">j</mi></mrow><msup id="A1.E10.m1.2.3.4.2.3.2.3" xref="A1.E10.m1.2.3.4.2.3.2.3.cmml"><mi id="A1.E10.m1.2.3.4.2.3.2.3.2" xref="A1.E10.m1.2.3.4.2.3.2.3.2.cmml">q</mi><mo id="A1.E10.m1.2.3.4.2.3.2.3.3" xref="A1.E10.m1.2.3.4.2.3.2.3.3.cmml">′</mo></msup></msubsup></mrow></mrow><mo rspace="0.111em" id="A1.E10.m1.2.3.5" xref="A1.E10.m1.2.3.5.cmml">=</mo><mrow id="A1.E10.m1.2.3.6" xref="A1.E10.m1.2.3.6.cmml"><munderover id="A1.E10.m1.2.3.6.1" xref="A1.E10.m1.2.3.6.1.cmml"><mo movablelimits="false" id="A1.E10.m1.2.3.6.1.2.2" xref="A1.E10.m1.2.3.6.1.2.2.cmml">∑</mo><mrow id="A1.E10.m1.2.3.6.1.2.3" xref="A1.E10.m1.2.3.6.1.2.3.cmml"><mi id="A1.E10.m1.2.3.6.1.2.3.2" xref="A1.E10.m1.2.3.6.1.2.3.2.cmml">c</mi><mo id="A1.E10.m1.2.3.6.1.2.3.1" xref="A1.E10.m1.2.3.6.1.2.3.1.cmml">=</mo><mn id="A1.E10.m1.2.3.6.1.2.3.3" xref="A1.E10.m1.2.3.6.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E10.m1.2.3.6.1.3" xref="A1.E10.m1.2.3.6.1.3.cmml">d</mi></munderover><mrow id="A1.E10.m1.2.3.6.2" xref="A1.E10.m1.2.3.6.2.cmml"><msub id="A1.E10.m1.2.3.6.2.2" xref="A1.E10.m1.2.3.6.2.2.cmml"><mi id="A1.E10.m1.2.3.6.2.2.2" xref="A1.E10.m1.2.3.6.2.2.2.cmml">x</mi><mrow id="A1.E10.m1.2.3.6.2.2.3" xref="A1.E10.m1.2.3.6.2.2.3.cmml"><mi id="A1.E10.m1.2.3.6.2.2.3.2" xref="A1.E10.m1.2.3.6.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E10.m1.2.3.6.2.2.3.1" xref="A1.E10.m1.2.3.6.2.2.3.1.cmml">​</mo><mi id="A1.E10.m1.2.3.6.2.2.3.3" xref="A1.E10.m1.2.3.6.2.2.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E10.m1.2.3.6.2.1" xref="A1.E10.m1.2.3.6.2.1.cmml">​</mo><msubsup id="A1.E10.m1.2.3.6.2.3" xref="A1.E10.m1.2.3.6.2.3.cmml"><mi id="A1.E10.m1.2.3.6.2.3.2.2" xref="A1.E10.m1.2.3.6.2.3.2.2.cmml">W</mi><mrow id="A1.E10.m1.1.1.1" xref="A1.E10.m1.1.1.1.cmml"><mi id="A1.E10.m1.1.1.1.3" xref="A1.E10.m1.1.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="A1.E10.m1.1.1.1.2" xref="A1.E10.m1.1.1.1.2.cmml">​</mo><mi id="A1.E10.m1.1.1.1.4" xref="A1.E10.m1.1.1.1.4.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E10.m1.1.1.1.2a" xref="A1.E10.m1.1.1.1.2.cmml">​</mo><mrow id="A1.E10.m1.1.1.1.5.2" xref="A1.E10.m1.1.1.1.cmml"><mo stretchy="false" id="A1.E10.m1.1.1.1.5.2.1" xref="A1.E10.m1.1.1.1.cmml">(</mo><mi id="A1.E10.m1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="A1.E10.m1.1.1.1.5.2.2" xref="A1.E10.m1.1.1.1.cmml">)</mo></mrow></mrow><mi id="A1.E10.m1.2.3.6.2.3.2.3" xref="A1.E10.m1.2.3.6.2.3.2.3.cmml">q</mi></msubsup></mrow></mrow><mo id="A1.E10.m1.2.3.7" xref="A1.E10.m1.2.3.7.cmml">=</mo><mrow id="A1.E10.m1.2.3.8" xref="A1.E10.m1.2.3.8.cmml"><msub id="A1.E10.m1.2.3.8.2" xref="A1.E10.m1.2.3.8.2.cmml"><mi id="A1.E10.m1.2.3.8.2.2" xref="A1.E10.m1.2.3.8.2.2.cmml">x</mi><mi id="A1.E10.m1.2.3.8.2.3" xref="A1.E10.m1.2.3.8.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E10.m1.2.3.8.1" xref="A1.E10.m1.2.3.8.1.cmml">⋅</mo><msubsup id="A1.E10.m1.2.3.8.3" xref="A1.E10.m1.2.3.8.3.cmml"><mover accent="true" id="A1.E10.m1.2.3.8.3.2.2" xref="A1.E10.m1.2.3.8.3.2.2.cmml"><mi id="A1.E10.m1.2.3.8.3.2.2.2" xref="A1.E10.m1.2.3.8.3.2.2.2.cmml">w</mi><mo stretchy="false" id="A1.E10.m1.2.3.8.3.2.2.1" xref="A1.E10.m1.2.3.8.3.2.2.1.cmml">→</mo></mover><mrow id="A1.E10.m1.2.2.1" xref="A1.E10.m1.2.2.1.cmml"><mi id="A1.E10.m1.2.2.1.3" xref="A1.E10.m1.2.2.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E10.m1.2.2.1.2" xref="A1.E10.m1.2.2.1.2.cmml">​</mo><mrow id="A1.E10.m1.2.2.1.4.2" xref="A1.E10.m1.2.2.1.cmml"><mo stretchy="false" id="A1.E10.m1.2.2.1.4.2.1" xref="A1.E10.m1.2.2.1.cmml">(</mo><mi id="A1.E10.m1.2.2.1.1" xref="A1.E10.m1.2.2.1.1.cmml">j</mi><mo stretchy="false" id="A1.E10.m1.2.2.1.4.2.2" xref="A1.E10.m1.2.2.1.cmml">)</mo></mrow></mrow><mi id="A1.E10.m1.2.3.8.3.2.3" xref="A1.E10.m1.2.3.8.3.2.3.cmml">q</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.2b"><apply id="A1.E10.m1.2.3.cmml" xref="A1.E10.m1.2.3"><and id="A1.E10.m1.2.3a.cmml" xref="A1.E10.m1.2.3"></and><apply id="A1.E10.m1.2.3b.cmml" xref="A1.E10.m1.2.3"><eq id="A1.E10.m1.2.3.3.cmml" xref="A1.E10.m1.2.3.3"></eq><apply id="A1.E10.m1.2.3.2.cmml" xref="A1.E10.m1.2.3.2"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.2.1.cmml" xref="A1.E10.m1.2.3.2">subscript</csymbol><apply id="A1.E10.m1.2.3.2.2.cmml" xref="A1.E10.m1.2.3.2"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.2.2.1.cmml" xref="A1.E10.m1.2.3.2">superscript</csymbol><ci id="A1.E10.m1.2.3.2.2.2.cmml" xref="A1.E10.m1.2.3.2.2.2">𝑄</ci><ci id="A1.E10.m1.2.3.2.2.3.cmml" xref="A1.E10.m1.2.3.2.2.3">′</ci></apply><apply id="A1.E10.m1.2.3.2.3.cmml" xref="A1.E10.m1.2.3.2.3"><times id="A1.E10.m1.2.3.2.3.1.cmml" xref="A1.E10.m1.2.3.2.3.1"></times><ci id="A1.E10.m1.2.3.2.3.2.cmml" xref="A1.E10.m1.2.3.2.3.2">𝑖</ci><ci id="A1.E10.m1.2.3.2.3.3.cmml" xref="A1.E10.m1.2.3.2.3.3">𝑗</ci></apply></apply><apply id="A1.E10.m1.2.3.4.cmml" xref="A1.E10.m1.2.3.4"><apply id="A1.E10.m1.2.3.4.1.cmml" xref="A1.E10.m1.2.3.4.1"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.4.1.1.cmml" xref="A1.E10.m1.2.3.4.1">superscript</csymbol><apply id="A1.E10.m1.2.3.4.1.2.cmml" xref="A1.E10.m1.2.3.4.1"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.4.1.2.1.cmml" xref="A1.E10.m1.2.3.4.1">subscript</csymbol><sum id="A1.E10.m1.2.3.4.1.2.2.cmml" xref="A1.E10.m1.2.3.4.1.2.2"></sum><apply id="A1.E10.m1.2.3.4.1.2.3.cmml" xref="A1.E10.m1.2.3.4.1.2.3"><eq id="A1.E10.m1.2.3.4.1.2.3.1.cmml" xref="A1.E10.m1.2.3.4.1.2.3.1"></eq><ci id="A1.E10.m1.2.3.4.1.2.3.2.cmml" xref="A1.E10.m1.2.3.4.1.2.3.2">𝑐</ci><cn type="integer" id="A1.E10.m1.2.3.4.1.2.3.3.cmml" xref="A1.E10.m1.2.3.4.1.2.3.3">1</cn></apply></apply><ci id="A1.E10.m1.2.3.4.1.3.cmml" xref="A1.E10.m1.2.3.4.1.3">𝑑</ci></apply><apply id="A1.E10.m1.2.3.4.2.cmml" xref="A1.E10.m1.2.3.4.2"><times id="A1.E10.m1.2.3.4.2.1.cmml" xref="A1.E10.m1.2.3.4.2.1"></times><apply id="A1.E10.m1.2.3.4.2.2.cmml" xref="A1.E10.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.4.2.2.1.cmml" xref="A1.E10.m1.2.3.4.2.2">subscript</csymbol><ci id="A1.E10.m1.2.3.4.2.2.2.cmml" xref="A1.E10.m1.2.3.4.2.2.2">𝑥</ci><apply id="A1.E10.m1.2.3.4.2.2.3.cmml" xref="A1.E10.m1.2.3.4.2.2.3"><times id="A1.E10.m1.2.3.4.2.2.3.1.cmml" xref="A1.E10.m1.2.3.4.2.2.3.1"></times><ci id="A1.E10.m1.2.3.4.2.2.3.2.cmml" xref="A1.E10.m1.2.3.4.2.2.3.2">𝑖</ci><ci id="A1.E10.m1.2.3.4.2.2.3.3.cmml" xref="A1.E10.m1.2.3.4.2.2.3.3">𝑐</ci></apply></apply><apply id="A1.E10.m1.2.3.4.2.3.cmml" xref="A1.E10.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.4.2.3.1.cmml" xref="A1.E10.m1.2.3.4.2.3">subscript</csymbol><apply id="A1.E10.m1.2.3.4.2.3.2.cmml" xref="A1.E10.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.4.2.3.2.1.cmml" xref="A1.E10.m1.2.3.4.2.3">superscript</csymbol><ci id="A1.E10.m1.2.3.4.2.3.2.2.cmml" xref="A1.E10.m1.2.3.4.2.3.2.2">𝑊</ci><apply id="A1.E10.m1.2.3.4.2.3.2.3.cmml" xref="A1.E10.m1.2.3.4.2.3.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.4.2.3.2.3.1.cmml" xref="A1.E10.m1.2.3.4.2.3.2.3">superscript</csymbol><ci id="A1.E10.m1.2.3.4.2.3.2.3.2.cmml" xref="A1.E10.m1.2.3.4.2.3.2.3.2">𝑞</ci><ci id="A1.E10.m1.2.3.4.2.3.2.3.3.cmml" xref="A1.E10.m1.2.3.4.2.3.2.3.3">′</ci></apply></apply><apply id="A1.E10.m1.2.3.4.2.3.3.cmml" xref="A1.E10.m1.2.3.4.2.3.3"><times id="A1.E10.m1.2.3.4.2.3.3.1.cmml" xref="A1.E10.m1.2.3.4.2.3.3.1"></times><ci id="A1.E10.m1.2.3.4.2.3.3.2.cmml" xref="A1.E10.m1.2.3.4.2.3.3.2">𝑐</ci><ci id="A1.E10.m1.2.3.4.2.3.3.3.cmml" xref="A1.E10.m1.2.3.4.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A1.E10.m1.2.3c.cmml" xref="A1.E10.m1.2.3"><eq id="A1.E10.m1.2.3.5.cmml" xref="A1.E10.m1.2.3.5"></eq><share href="#A1.E10.m1.2.3.4.cmml" id="A1.E10.m1.2.3d.cmml" xref="A1.E10.m1.2.3"></share><apply id="A1.E10.m1.2.3.6.cmml" xref="A1.E10.m1.2.3.6"><apply id="A1.E10.m1.2.3.6.1.cmml" xref="A1.E10.m1.2.3.6.1"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.6.1.1.cmml" xref="A1.E10.m1.2.3.6.1">superscript</csymbol><apply id="A1.E10.m1.2.3.6.1.2.cmml" xref="A1.E10.m1.2.3.6.1"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.6.1.2.1.cmml" xref="A1.E10.m1.2.3.6.1">subscript</csymbol><sum id="A1.E10.m1.2.3.6.1.2.2.cmml" xref="A1.E10.m1.2.3.6.1.2.2"></sum><apply id="A1.E10.m1.2.3.6.1.2.3.cmml" xref="A1.E10.m1.2.3.6.1.2.3"><eq id="A1.E10.m1.2.3.6.1.2.3.1.cmml" xref="A1.E10.m1.2.3.6.1.2.3.1"></eq><ci id="A1.E10.m1.2.3.6.1.2.3.2.cmml" xref="A1.E10.m1.2.3.6.1.2.3.2">𝑐</ci><cn type="integer" id="A1.E10.m1.2.3.6.1.2.3.3.cmml" xref="A1.E10.m1.2.3.6.1.2.3.3">1</cn></apply></apply><ci id="A1.E10.m1.2.3.6.1.3.cmml" xref="A1.E10.m1.2.3.6.1.3">𝑑</ci></apply><apply id="A1.E10.m1.2.3.6.2.cmml" xref="A1.E10.m1.2.3.6.2"><times id="A1.E10.m1.2.3.6.2.1.cmml" xref="A1.E10.m1.2.3.6.2.1"></times><apply id="A1.E10.m1.2.3.6.2.2.cmml" xref="A1.E10.m1.2.3.6.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.6.2.2.1.cmml" xref="A1.E10.m1.2.3.6.2.2">subscript</csymbol><ci id="A1.E10.m1.2.3.6.2.2.2.cmml" xref="A1.E10.m1.2.3.6.2.2.2">𝑥</ci><apply id="A1.E10.m1.2.3.6.2.2.3.cmml" xref="A1.E10.m1.2.3.6.2.2.3"><times id="A1.E10.m1.2.3.6.2.2.3.1.cmml" xref="A1.E10.m1.2.3.6.2.2.3.1"></times><ci id="A1.E10.m1.2.3.6.2.2.3.2.cmml" xref="A1.E10.m1.2.3.6.2.2.3.2">𝑖</ci><ci id="A1.E10.m1.2.3.6.2.2.3.3.cmml" xref="A1.E10.m1.2.3.6.2.2.3.3">𝑐</ci></apply></apply><apply id="A1.E10.m1.2.3.6.2.3.cmml" xref="A1.E10.m1.2.3.6.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.6.2.3.1.cmml" xref="A1.E10.m1.2.3.6.2.3">subscript</csymbol><apply id="A1.E10.m1.2.3.6.2.3.2.cmml" xref="A1.E10.m1.2.3.6.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.6.2.3.2.1.cmml" xref="A1.E10.m1.2.3.6.2.3">superscript</csymbol><ci id="A1.E10.m1.2.3.6.2.3.2.2.cmml" xref="A1.E10.m1.2.3.6.2.3.2.2">𝑊</ci><ci id="A1.E10.m1.2.3.6.2.3.2.3.cmml" xref="A1.E10.m1.2.3.6.2.3.2.3">𝑞</ci></apply><apply id="A1.E10.m1.1.1.1.cmml" xref="A1.E10.m1.1.1.1"><times id="A1.E10.m1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.2"></times><ci id="A1.E10.m1.1.1.1.3.cmml" xref="A1.E10.m1.1.1.1.3">𝑐</ci><ci id="A1.E10.m1.1.1.1.4.cmml" xref="A1.E10.m1.1.1.1.4">𝜋</ci><ci id="A1.E10.m1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1">𝑗</ci></apply></apply></apply></apply></apply><apply id="A1.E10.m1.2.3e.cmml" xref="A1.E10.m1.2.3"><eq id="A1.E10.m1.2.3.7.cmml" xref="A1.E10.m1.2.3.7"></eq><share href="#A1.E10.m1.2.3.6.cmml" id="A1.E10.m1.2.3f.cmml" xref="A1.E10.m1.2.3"></share><apply id="A1.E10.m1.2.3.8.cmml" xref="A1.E10.m1.2.3.8"><ci id="A1.E10.m1.2.3.8.1.cmml" xref="A1.E10.m1.2.3.8.1">⋅</ci><apply id="A1.E10.m1.2.3.8.2.cmml" xref="A1.E10.m1.2.3.8.2"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.8.2.1.cmml" xref="A1.E10.m1.2.3.8.2">subscript</csymbol><ci id="A1.E10.m1.2.3.8.2.2.cmml" xref="A1.E10.m1.2.3.8.2.2">𝑥</ci><ci id="A1.E10.m1.2.3.8.2.3.cmml" xref="A1.E10.m1.2.3.8.2.3">𝑖</ci></apply><apply id="A1.E10.m1.2.3.8.3.cmml" xref="A1.E10.m1.2.3.8.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.8.3.1.cmml" xref="A1.E10.m1.2.3.8.3">subscript</csymbol><apply id="A1.E10.m1.2.3.8.3.2.cmml" xref="A1.E10.m1.2.3.8.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.3.8.3.2.1.cmml" xref="A1.E10.m1.2.3.8.3">superscript</csymbol><apply id="A1.E10.m1.2.3.8.3.2.2.cmml" xref="A1.E10.m1.2.3.8.3.2.2"><ci id="A1.E10.m1.2.3.8.3.2.2.1.cmml" xref="A1.E10.m1.2.3.8.3.2.2.1">→</ci><ci id="A1.E10.m1.2.3.8.3.2.2.2.cmml" xref="A1.E10.m1.2.3.8.3.2.2.2">𝑤</ci></apply><ci id="A1.E10.m1.2.3.8.3.2.3.cmml" xref="A1.E10.m1.2.3.8.3.2.3">𝑞</ci></apply><apply id="A1.E10.m1.2.2.1.cmml" xref="A1.E10.m1.2.2.1"><times id="A1.E10.m1.2.2.1.2.cmml" xref="A1.E10.m1.2.2.1.2"></times><ci id="A1.E10.m1.2.2.1.3.cmml" xref="A1.E10.m1.2.2.1.3">𝜋</ci><ci id="A1.E10.m1.2.2.1.1.cmml" xref="A1.E10.m1.2.2.1.1">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.2c">Q^{\prime}_{ij}=\sum_{c=1}^{d}x_{ic}W^{q^{\prime}}_{cj}=\sum_{c=1}^{d}x_{ic}W^{q}_{c\pi(j)}=x_{i}\cdot\vec{w}^{q}_{\pi(j)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<table id="A1.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E11.m1.2" class="ltx_Math" alttext="K^{\prime}_{ij}=\sum_{c=1}^{d}x_{ic}W^{k^{\prime}}_{cj}=\sum_{c=1}^{d}x_{ic}W^{k}_{c\pi(j)}=x_{i}\cdot\vec{w}^{k}_{\pi(j)}" display="block"><semantics id="A1.E11.m1.2a"><mrow id="A1.E11.m1.2.3" xref="A1.E11.m1.2.3.cmml"><msubsup id="A1.E11.m1.2.3.2" xref="A1.E11.m1.2.3.2.cmml"><mi id="A1.E11.m1.2.3.2.2.2" xref="A1.E11.m1.2.3.2.2.2.cmml">K</mi><mrow id="A1.E11.m1.2.3.2.3" xref="A1.E11.m1.2.3.2.3.cmml"><mi id="A1.E11.m1.2.3.2.3.2" xref="A1.E11.m1.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.2.3.2.3.1" xref="A1.E11.m1.2.3.2.3.1.cmml">​</mo><mi id="A1.E11.m1.2.3.2.3.3" xref="A1.E11.m1.2.3.2.3.3.cmml">j</mi></mrow><mo id="A1.E11.m1.2.3.2.2.3" xref="A1.E11.m1.2.3.2.2.3.cmml">′</mo></msubsup><mo rspace="0.111em" id="A1.E11.m1.2.3.3" xref="A1.E11.m1.2.3.3.cmml">=</mo><mrow id="A1.E11.m1.2.3.4" xref="A1.E11.m1.2.3.4.cmml"><munderover id="A1.E11.m1.2.3.4.1" xref="A1.E11.m1.2.3.4.1.cmml"><mo movablelimits="false" id="A1.E11.m1.2.3.4.1.2.2" xref="A1.E11.m1.2.3.4.1.2.2.cmml">∑</mo><mrow id="A1.E11.m1.2.3.4.1.2.3" xref="A1.E11.m1.2.3.4.1.2.3.cmml"><mi id="A1.E11.m1.2.3.4.1.2.3.2" xref="A1.E11.m1.2.3.4.1.2.3.2.cmml">c</mi><mo id="A1.E11.m1.2.3.4.1.2.3.1" xref="A1.E11.m1.2.3.4.1.2.3.1.cmml">=</mo><mn id="A1.E11.m1.2.3.4.1.2.3.3" xref="A1.E11.m1.2.3.4.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E11.m1.2.3.4.1.3" xref="A1.E11.m1.2.3.4.1.3.cmml">d</mi></munderover><mrow id="A1.E11.m1.2.3.4.2" xref="A1.E11.m1.2.3.4.2.cmml"><msub id="A1.E11.m1.2.3.4.2.2" xref="A1.E11.m1.2.3.4.2.2.cmml"><mi id="A1.E11.m1.2.3.4.2.2.2" xref="A1.E11.m1.2.3.4.2.2.2.cmml">x</mi><mrow id="A1.E11.m1.2.3.4.2.2.3" xref="A1.E11.m1.2.3.4.2.2.3.cmml"><mi id="A1.E11.m1.2.3.4.2.2.3.2" xref="A1.E11.m1.2.3.4.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.2.3.4.2.2.3.1" xref="A1.E11.m1.2.3.4.2.2.3.1.cmml">​</mo><mi id="A1.E11.m1.2.3.4.2.2.3.3" xref="A1.E11.m1.2.3.4.2.2.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E11.m1.2.3.4.2.1" xref="A1.E11.m1.2.3.4.2.1.cmml">​</mo><msubsup id="A1.E11.m1.2.3.4.2.3" xref="A1.E11.m1.2.3.4.2.3.cmml"><mi id="A1.E11.m1.2.3.4.2.3.2.2" xref="A1.E11.m1.2.3.4.2.3.2.2.cmml">W</mi><mrow id="A1.E11.m1.2.3.4.2.3.3" xref="A1.E11.m1.2.3.4.2.3.3.cmml"><mi id="A1.E11.m1.2.3.4.2.3.3.2" xref="A1.E11.m1.2.3.4.2.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.2.3.4.2.3.3.1" xref="A1.E11.m1.2.3.4.2.3.3.1.cmml">​</mo><mi id="A1.E11.m1.2.3.4.2.3.3.3" xref="A1.E11.m1.2.3.4.2.3.3.3.cmml">j</mi></mrow><msup id="A1.E11.m1.2.3.4.2.3.2.3" xref="A1.E11.m1.2.3.4.2.3.2.3.cmml"><mi id="A1.E11.m1.2.3.4.2.3.2.3.2" xref="A1.E11.m1.2.3.4.2.3.2.3.2.cmml">k</mi><mo id="A1.E11.m1.2.3.4.2.3.2.3.3" xref="A1.E11.m1.2.3.4.2.3.2.3.3.cmml">′</mo></msup></msubsup></mrow></mrow><mo rspace="0.111em" id="A1.E11.m1.2.3.5" xref="A1.E11.m1.2.3.5.cmml">=</mo><mrow id="A1.E11.m1.2.3.6" xref="A1.E11.m1.2.3.6.cmml"><munderover id="A1.E11.m1.2.3.6.1" xref="A1.E11.m1.2.3.6.1.cmml"><mo movablelimits="false" id="A1.E11.m1.2.3.6.1.2.2" xref="A1.E11.m1.2.3.6.1.2.2.cmml">∑</mo><mrow id="A1.E11.m1.2.3.6.1.2.3" xref="A1.E11.m1.2.3.6.1.2.3.cmml"><mi id="A1.E11.m1.2.3.6.1.2.3.2" xref="A1.E11.m1.2.3.6.1.2.3.2.cmml">c</mi><mo id="A1.E11.m1.2.3.6.1.2.3.1" xref="A1.E11.m1.2.3.6.1.2.3.1.cmml">=</mo><mn id="A1.E11.m1.2.3.6.1.2.3.3" xref="A1.E11.m1.2.3.6.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E11.m1.2.3.6.1.3" xref="A1.E11.m1.2.3.6.1.3.cmml">d</mi></munderover><mrow id="A1.E11.m1.2.3.6.2" xref="A1.E11.m1.2.3.6.2.cmml"><msub id="A1.E11.m1.2.3.6.2.2" xref="A1.E11.m1.2.3.6.2.2.cmml"><mi id="A1.E11.m1.2.3.6.2.2.2" xref="A1.E11.m1.2.3.6.2.2.2.cmml">x</mi><mrow id="A1.E11.m1.2.3.6.2.2.3" xref="A1.E11.m1.2.3.6.2.2.3.cmml"><mi id="A1.E11.m1.2.3.6.2.2.3.2" xref="A1.E11.m1.2.3.6.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.2.3.6.2.2.3.1" xref="A1.E11.m1.2.3.6.2.2.3.1.cmml">​</mo><mi id="A1.E11.m1.2.3.6.2.2.3.3" xref="A1.E11.m1.2.3.6.2.2.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E11.m1.2.3.6.2.1" xref="A1.E11.m1.2.3.6.2.1.cmml">​</mo><msubsup id="A1.E11.m1.2.3.6.2.3" xref="A1.E11.m1.2.3.6.2.3.cmml"><mi id="A1.E11.m1.2.3.6.2.3.2.2" xref="A1.E11.m1.2.3.6.2.3.2.2.cmml">W</mi><mrow id="A1.E11.m1.1.1.1" xref="A1.E11.m1.1.1.1.cmml"><mi id="A1.E11.m1.1.1.1.3" xref="A1.E11.m1.1.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.1.1.1.2" xref="A1.E11.m1.1.1.1.2.cmml">​</mo><mi id="A1.E11.m1.1.1.1.4" xref="A1.E11.m1.1.1.1.4.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.1.1.1.2a" xref="A1.E11.m1.1.1.1.2.cmml">​</mo><mrow id="A1.E11.m1.1.1.1.5.2" xref="A1.E11.m1.1.1.1.cmml"><mo stretchy="false" id="A1.E11.m1.1.1.1.5.2.1" xref="A1.E11.m1.1.1.1.cmml">(</mo><mi id="A1.E11.m1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="A1.E11.m1.1.1.1.5.2.2" xref="A1.E11.m1.1.1.1.cmml">)</mo></mrow></mrow><mi id="A1.E11.m1.2.3.6.2.3.2.3" xref="A1.E11.m1.2.3.6.2.3.2.3.cmml">k</mi></msubsup></mrow></mrow><mo id="A1.E11.m1.2.3.7" xref="A1.E11.m1.2.3.7.cmml">=</mo><mrow id="A1.E11.m1.2.3.8" xref="A1.E11.m1.2.3.8.cmml"><msub id="A1.E11.m1.2.3.8.2" xref="A1.E11.m1.2.3.8.2.cmml"><mi id="A1.E11.m1.2.3.8.2.2" xref="A1.E11.m1.2.3.8.2.2.cmml">x</mi><mi id="A1.E11.m1.2.3.8.2.3" xref="A1.E11.m1.2.3.8.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E11.m1.2.3.8.1" xref="A1.E11.m1.2.3.8.1.cmml">⋅</mo><msubsup id="A1.E11.m1.2.3.8.3" xref="A1.E11.m1.2.3.8.3.cmml"><mover accent="true" id="A1.E11.m1.2.3.8.3.2.2" xref="A1.E11.m1.2.3.8.3.2.2.cmml"><mi id="A1.E11.m1.2.3.8.3.2.2.2" xref="A1.E11.m1.2.3.8.3.2.2.2.cmml">w</mi><mo stretchy="false" id="A1.E11.m1.2.3.8.3.2.2.1" xref="A1.E11.m1.2.3.8.3.2.2.1.cmml">→</mo></mover><mrow id="A1.E11.m1.2.2.1" xref="A1.E11.m1.2.2.1.cmml"><mi id="A1.E11.m1.2.2.1.3" xref="A1.E11.m1.2.2.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.2.2.1.2" xref="A1.E11.m1.2.2.1.2.cmml">​</mo><mrow id="A1.E11.m1.2.2.1.4.2" xref="A1.E11.m1.2.2.1.cmml"><mo stretchy="false" id="A1.E11.m1.2.2.1.4.2.1" xref="A1.E11.m1.2.2.1.cmml">(</mo><mi id="A1.E11.m1.2.2.1.1" xref="A1.E11.m1.2.2.1.1.cmml">j</mi><mo stretchy="false" id="A1.E11.m1.2.2.1.4.2.2" xref="A1.E11.m1.2.2.1.cmml">)</mo></mrow></mrow><mi id="A1.E11.m1.2.3.8.3.2.3" xref="A1.E11.m1.2.3.8.3.2.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.2b"><apply id="A1.E11.m1.2.3.cmml" xref="A1.E11.m1.2.3"><and id="A1.E11.m1.2.3a.cmml" xref="A1.E11.m1.2.3"></and><apply id="A1.E11.m1.2.3b.cmml" xref="A1.E11.m1.2.3"><eq id="A1.E11.m1.2.3.3.cmml" xref="A1.E11.m1.2.3.3"></eq><apply id="A1.E11.m1.2.3.2.cmml" xref="A1.E11.m1.2.3.2"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.2.1.cmml" xref="A1.E11.m1.2.3.2">subscript</csymbol><apply id="A1.E11.m1.2.3.2.2.cmml" xref="A1.E11.m1.2.3.2"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.2.2.1.cmml" xref="A1.E11.m1.2.3.2">superscript</csymbol><ci id="A1.E11.m1.2.3.2.2.2.cmml" xref="A1.E11.m1.2.3.2.2.2">𝐾</ci><ci id="A1.E11.m1.2.3.2.2.3.cmml" xref="A1.E11.m1.2.3.2.2.3">′</ci></apply><apply id="A1.E11.m1.2.3.2.3.cmml" xref="A1.E11.m1.2.3.2.3"><times id="A1.E11.m1.2.3.2.3.1.cmml" xref="A1.E11.m1.2.3.2.3.1"></times><ci id="A1.E11.m1.2.3.2.3.2.cmml" xref="A1.E11.m1.2.3.2.3.2">𝑖</ci><ci id="A1.E11.m1.2.3.2.3.3.cmml" xref="A1.E11.m1.2.3.2.3.3">𝑗</ci></apply></apply><apply id="A1.E11.m1.2.3.4.cmml" xref="A1.E11.m1.2.3.4"><apply id="A1.E11.m1.2.3.4.1.cmml" xref="A1.E11.m1.2.3.4.1"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.4.1.1.cmml" xref="A1.E11.m1.2.3.4.1">superscript</csymbol><apply id="A1.E11.m1.2.3.4.1.2.cmml" xref="A1.E11.m1.2.3.4.1"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.4.1.2.1.cmml" xref="A1.E11.m1.2.3.4.1">subscript</csymbol><sum id="A1.E11.m1.2.3.4.1.2.2.cmml" xref="A1.E11.m1.2.3.4.1.2.2"></sum><apply id="A1.E11.m1.2.3.4.1.2.3.cmml" xref="A1.E11.m1.2.3.4.1.2.3"><eq id="A1.E11.m1.2.3.4.1.2.3.1.cmml" xref="A1.E11.m1.2.3.4.1.2.3.1"></eq><ci id="A1.E11.m1.2.3.4.1.2.3.2.cmml" xref="A1.E11.m1.2.3.4.1.2.3.2">𝑐</ci><cn type="integer" id="A1.E11.m1.2.3.4.1.2.3.3.cmml" xref="A1.E11.m1.2.3.4.1.2.3.3">1</cn></apply></apply><ci id="A1.E11.m1.2.3.4.1.3.cmml" xref="A1.E11.m1.2.3.4.1.3">𝑑</ci></apply><apply id="A1.E11.m1.2.3.4.2.cmml" xref="A1.E11.m1.2.3.4.2"><times id="A1.E11.m1.2.3.4.2.1.cmml" xref="A1.E11.m1.2.3.4.2.1"></times><apply id="A1.E11.m1.2.3.4.2.2.cmml" xref="A1.E11.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.4.2.2.1.cmml" xref="A1.E11.m1.2.3.4.2.2">subscript</csymbol><ci id="A1.E11.m1.2.3.4.2.2.2.cmml" xref="A1.E11.m1.2.3.4.2.2.2">𝑥</ci><apply id="A1.E11.m1.2.3.4.2.2.3.cmml" xref="A1.E11.m1.2.3.4.2.2.3"><times id="A1.E11.m1.2.3.4.2.2.3.1.cmml" xref="A1.E11.m1.2.3.4.2.2.3.1"></times><ci id="A1.E11.m1.2.3.4.2.2.3.2.cmml" xref="A1.E11.m1.2.3.4.2.2.3.2">𝑖</ci><ci id="A1.E11.m1.2.3.4.2.2.3.3.cmml" xref="A1.E11.m1.2.3.4.2.2.3.3">𝑐</ci></apply></apply><apply id="A1.E11.m1.2.3.4.2.3.cmml" xref="A1.E11.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.4.2.3.1.cmml" xref="A1.E11.m1.2.3.4.2.3">subscript</csymbol><apply id="A1.E11.m1.2.3.4.2.3.2.cmml" xref="A1.E11.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.4.2.3.2.1.cmml" xref="A1.E11.m1.2.3.4.2.3">superscript</csymbol><ci id="A1.E11.m1.2.3.4.2.3.2.2.cmml" xref="A1.E11.m1.2.3.4.2.3.2.2">𝑊</ci><apply id="A1.E11.m1.2.3.4.2.3.2.3.cmml" xref="A1.E11.m1.2.3.4.2.3.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.4.2.3.2.3.1.cmml" xref="A1.E11.m1.2.3.4.2.3.2.3">superscript</csymbol><ci id="A1.E11.m1.2.3.4.2.3.2.3.2.cmml" xref="A1.E11.m1.2.3.4.2.3.2.3.2">𝑘</ci><ci id="A1.E11.m1.2.3.4.2.3.2.3.3.cmml" xref="A1.E11.m1.2.3.4.2.3.2.3.3">′</ci></apply></apply><apply id="A1.E11.m1.2.3.4.2.3.3.cmml" xref="A1.E11.m1.2.3.4.2.3.3"><times id="A1.E11.m1.2.3.4.2.3.3.1.cmml" xref="A1.E11.m1.2.3.4.2.3.3.1"></times><ci id="A1.E11.m1.2.3.4.2.3.3.2.cmml" xref="A1.E11.m1.2.3.4.2.3.3.2">𝑐</ci><ci id="A1.E11.m1.2.3.4.2.3.3.3.cmml" xref="A1.E11.m1.2.3.4.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A1.E11.m1.2.3c.cmml" xref="A1.E11.m1.2.3"><eq id="A1.E11.m1.2.3.5.cmml" xref="A1.E11.m1.2.3.5"></eq><share href="#A1.E11.m1.2.3.4.cmml" id="A1.E11.m1.2.3d.cmml" xref="A1.E11.m1.2.3"></share><apply id="A1.E11.m1.2.3.6.cmml" xref="A1.E11.m1.2.3.6"><apply id="A1.E11.m1.2.3.6.1.cmml" xref="A1.E11.m1.2.3.6.1"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.6.1.1.cmml" xref="A1.E11.m1.2.3.6.1">superscript</csymbol><apply id="A1.E11.m1.2.3.6.1.2.cmml" xref="A1.E11.m1.2.3.6.1"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.6.1.2.1.cmml" xref="A1.E11.m1.2.3.6.1">subscript</csymbol><sum id="A1.E11.m1.2.3.6.1.2.2.cmml" xref="A1.E11.m1.2.3.6.1.2.2"></sum><apply id="A1.E11.m1.2.3.6.1.2.3.cmml" xref="A1.E11.m1.2.3.6.1.2.3"><eq id="A1.E11.m1.2.3.6.1.2.3.1.cmml" xref="A1.E11.m1.2.3.6.1.2.3.1"></eq><ci id="A1.E11.m1.2.3.6.1.2.3.2.cmml" xref="A1.E11.m1.2.3.6.1.2.3.2">𝑐</ci><cn type="integer" id="A1.E11.m1.2.3.6.1.2.3.3.cmml" xref="A1.E11.m1.2.3.6.1.2.3.3">1</cn></apply></apply><ci id="A1.E11.m1.2.3.6.1.3.cmml" xref="A1.E11.m1.2.3.6.1.3">𝑑</ci></apply><apply id="A1.E11.m1.2.3.6.2.cmml" xref="A1.E11.m1.2.3.6.2"><times id="A1.E11.m1.2.3.6.2.1.cmml" xref="A1.E11.m1.2.3.6.2.1"></times><apply id="A1.E11.m1.2.3.6.2.2.cmml" xref="A1.E11.m1.2.3.6.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.6.2.2.1.cmml" xref="A1.E11.m1.2.3.6.2.2">subscript</csymbol><ci id="A1.E11.m1.2.3.6.2.2.2.cmml" xref="A1.E11.m1.2.3.6.2.2.2">𝑥</ci><apply id="A1.E11.m1.2.3.6.2.2.3.cmml" xref="A1.E11.m1.2.3.6.2.2.3"><times id="A1.E11.m1.2.3.6.2.2.3.1.cmml" xref="A1.E11.m1.2.3.6.2.2.3.1"></times><ci id="A1.E11.m1.2.3.6.2.2.3.2.cmml" xref="A1.E11.m1.2.3.6.2.2.3.2">𝑖</ci><ci id="A1.E11.m1.2.3.6.2.2.3.3.cmml" xref="A1.E11.m1.2.3.6.2.2.3.3">𝑐</ci></apply></apply><apply id="A1.E11.m1.2.3.6.2.3.cmml" xref="A1.E11.m1.2.3.6.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.6.2.3.1.cmml" xref="A1.E11.m1.2.3.6.2.3">subscript</csymbol><apply id="A1.E11.m1.2.3.6.2.3.2.cmml" xref="A1.E11.m1.2.3.6.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.6.2.3.2.1.cmml" xref="A1.E11.m1.2.3.6.2.3">superscript</csymbol><ci id="A1.E11.m1.2.3.6.2.3.2.2.cmml" xref="A1.E11.m1.2.3.6.2.3.2.2">𝑊</ci><ci id="A1.E11.m1.2.3.6.2.3.2.3.cmml" xref="A1.E11.m1.2.3.6.2.3.2.3">𝑘</ci></apply><apply id="A1.E11.m1.1.1.1.cmml" xref="A1.E11.m1.1.1.1"><times id="A1.E11.m1.1.1.1.2.cmml" xref="A1.E11.m1.1.1.1.2"></times><ci id="A1.E11.m1.1.1.1.3.cmml" xref="A1.E11.m1.1.1.1.3">𝑐</ci><ci id="A1.E11.m1.1.1.1.4.cmml" xref="A1.E11.m1.1.1.1.4">𝜋</ci><ci id="A1.E11.m1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1">𝑗</ci></apply></apply></apply></apply></apply><apply id="A1.E11.m1.2.3e.cmml" xref="A1.E11.m1.2.3"><eq id="A1.E11.m1.2.3.7.cmml" xref="A1.E11.m1.2.3.7"></eq><share href="#A1.E11.m1.2.3.6.cmml" id="A1.E11.m1.2.3f.cmml" xref="A1.E11.m1.2.3"></share><apply id="A1.E11.m1.2.3.8.cmml" xref="A1.E11.m1.2.3.8"><ci id="A1.E11.m1.2.3.8.1.cmml" xref="A1.E11.m1.2.3.8.1">⋅</ci><apply id="A1.E11.m1.2.3.8.2.cmml" xref="A1.E11.m1.2.3.8.2"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.8.2.1.cmml" xref="A1.E11.m1.2.3.8.2">subscript</csymbol><ci id="A1.E11.m1.2.3.8.2.2.cmml" xref="A1.E11.m1.2.3.8.2.2">𝑥</ci><ci id="A1.E11.m1.2.3.8.2.3.cmml" xref="A1.E11.m1.2.3.8.2.3">𝑖</ci></apply><apply id="A1.E11.m1.2.3.8.3.cmml" xref="A1.E11.m1.2.3.8.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.8.3.1.cmml" xref="A1.E11.m1.2.3.8.3">subscript</csymbol><apply id="A1.E11.m1.2.3.8.3.2.cmml" xref="A1.E11.m1.2.3.8.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.3.8.3.2.1.cmml" xref="A1.E11.m1.2.3.8.3">superscript</csymbol><apply id="A1.E11.m1.2.3.8.3.2.2.cmml" xref="A1.E11.m1.2.3.8.3.2.2"><ci id="A1.E11.m1.2.3.8.3.2.2.1.cmml" xref="A1.E11.m1.2.3.8.3.2.2.1">→</ci><ci id="A1.E11.m1.2.3.8.3.2.2.2.cmml" xref="A1.E11.m1.2.3.8.3.2.2.2">𝑤</ci></apply><ci id="A1.E11.m1.2.3.8.3.2.3.cmml" xref="A1.E11.m1.2.3.8.3.2.3">𝑘</ci></apply><apply id="A1.E11.m1.2.2.1.cmml" xref="A1.E11.m1.2.2.1"><times id="A1.E11.m1.2.2.1.2.cmml" xref="A1.E11.m1.2.2.1.2"></times><ci id="A1.E11.m1.2.2.1.3.cmml" xref="A1.E11.m1.2.2.1.3">𝜋</ci><ci id="A1.E11.m1.2.2.1.1.cmml" xref="A1.E11.m1.2.2.1.1">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.2c">K^{\prime}_{ij}=\sum_{c=1}^{d}x_{ic}W^{k^{\prime}}_{cj}=\sum_{c=1}^{d}x_{ic}W^{k}_{c\pi(j)}=x_{i}\cdot\vec{w}^{k}_{\pi(j)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.p9" class="ltx_para ltx_noindent">
<p id="A1.SS1.p9.2" class="ltx_p">Now, consider the dot-product of rows from <math id="A1.SS1.p9.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A1.SS1.p9.1.m1.1a"><mi id="A1.SS1.p9.1.m1.1.1" xref="A1.SS1.p9.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p9.1.m1.1b"><ci id="A1.SS1.p9.1.m1.1.1.cmml" xref="A1.SS1.p9.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p9.1.m1.1c">Q</annotation></semantics></math> and <math id="A1.SS1.p9.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A1.SS1.p9.2.m2.1a"><mi id="A1.SS1.p9.2.m2.1.1" xref="A1.SS1.p9.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p9.2.m2.1b"><ci id="A1.SS1.p9.2.m2.1.1.cmml" xref="A1.SS1.p9.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p9.2.m2.1c">K</annotation></semantics></math>:</p>
<table id="A1.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E12.m1.1" class="ltx_Math" alttext="(QK^{T})_{ij}=\sum_{c=1}^{d_{k}}Q_{ic}K_{jc}" display="block"><semantics id="A1.E12.m1.1a"><mrow id="A1.E12.m1.1.1" xref="A1.E12.m1.1.1.cmml"><msub id="A1.E12.m1.1.1.1" xref="A1.E12.m1.1.1.1.cmml"><mrow id="A1.E12.m1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E12.m1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.cmml">​</mo><msup id="A1.E12.m1.1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.1.1.1.1.1.1.3.2.cmml">K</mi><mi id="A1.E12.m1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.1.1.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo stretchy="false" id="A1.E12.m1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A1.E12.m1.1.1.1.3" xref="A1.E12.m1.1.1.1.3.cmml"><mi id="A1.E12.m1.1.1.1.3.2" xref="A1.E12.m1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.1.1.1.3.1" xref="A1.E12.m1.1.1.1.3.1.cmml">​</mo><mi id="A1.E12.m1.1.1.1.3.3" xref="A1.E12.m1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo rspace="0.111em" id="A1.E12.m1.1.1.2" xref="A1.E12.m1.1.1.2.cmml">=</mo><mrow id="A1.E12.m1.1.1.3" xref="A1.E12.m1.1.1.3.cmml"><munderover id="A1.E12.m1.1.1.3.1" xref="A1.E12.m1.1.1.3.1.cmml"><mo movablelimits="false" id="A1.E12.m1.1.1.3.1.2.2" xref="A1.E12.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.E12.m1.1.1.3.1.2.3" xref="A1.E12.m1.1.1.3.1.2.3.cmml"><mi id="A1.E12.m1.1.1.3.1.2.3.2" xref="A1.E12.m1.1.1.3.1.2.3.2.cmml">c</mi><mo id="A1.E12.m1.1.1.3.1.2.3.1" xref="A1.E12.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.E12.m1.1.1.3.1.2.3.3" xref="A1.E12.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="A1.E12.m1.1.1.3.1.3" xref="A1.E12.m1.1.1.3.1.3.cmml"><mi id="A1.E12.m1.1.1.3.1.3.2" xref="A1.E12.m1.1.1.3.1.3.2.cmml">d</mi><mi id="A1.E12.m1.1.1.3.1.3.3" xref="A1.E12.m1.1.1.3.1.3.3.cmml">k</mi></msub></munderover><mrow id="A1.E12.m1.1.1.3.2" xref="A1.E12.m1.1.1.3.2.cmml"><msub id="A1.E12.m1.1.1.3.2.2" xref="A1.E12.m1.1.1.3.2.2.cmml"><mi id="A1.E12.m1.1.1.3.2.2.2" xref="A1.E12.m1.1.1.3.2.2.2.cmml">Q</mi><mrow id="A1.E12.m1.1.1.3.2.2.3" xref="A1.E12.m1.1.1.3.2.2.3.cmml"><mi id="A1.E12.m1.1.1.3.2.2.3.2" xref="A1.E12.m1.1.1.3.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.1.1.3.2.2.3.1" xref="A1.E12.m1.1.1.3.2.2.3.1.cmml">​</mo><mi id="A1.E12.m1.1.1.3.2.2.3.3" xref="A1.E12.m1.1.1.3.2.2.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E12.m1.1.1.3.2.1" xref="A1.E12.m1.1.1.3.2.1.cmml">​</mo><msub id="A1.E12.m1.1.1.3.2.3" xref="A1.E12.m1.1.1.3.2.3.cmml"><mi id="A1.E12.m1.1.1.3.2.3.2" xref="A1.E12.m1.1.1.3.2.3.2.cmml">K</mi><mrow id="A1.E12.m1.1.1.3.2.3.3" xref="A1.E12.m1.1.1.3.2.3.3.cmml"><mi id="A1.E12.m1.1.1.3.2.3.3.2" xref="A1.E12.m1.1.1.3.2.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.1.1.3.2.3.3.1" xref="A1.E12.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="A1.E12.m1.1.1.3.2.3.3.3" xref="A1.E12.m1.1.1.3.2.3.3.3.cmml">c</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.1b"><apply id="A1.E12.m1.1.1.cmml" xref="A1.E12.m1.1.1"><eq id="A1.E12.m1.1.1.2.cmml" xref="A1.E12.m1.1.1.2"></eq><apply id="A1.E12.m1.1.1.1.cmml" xref="A1.E12.m1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1">subscript</csymbol><apply id="A1.E12.m1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1"><times id="A1.E12.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1"></times><ci id="A1.E12.m1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2">𝑄</ci><apply id="A1.E12.m1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.E12.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3.2">𝐾</ci><ci id="A1.E12.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="A1.E12.m1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.3"><times id="A1.E12.m1.1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.1.3.1"></times><ci id="A1.E12.m1.1.1.1.3.2.cmml" xref="A1.E12.m1.1.1.1.3.2">𝑖</ci><ci id="A1.E12.m1.1.1.1.3.3.cmml" xref="A1.E12.m1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="A1.E12.m1.1.1.3.cmml" xref="A1.E12.m1.1.1.3"><apply id="A1.E12.m1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.3.1.1.cmml" xref="A1.E12.m1.1.1.3.1">superscript</csymbol><apply id="A1.E12.m1.1.1.3.1.2.cmml" xref="A1.E12.m1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.3.1.2.1.cmml" xref="A1.E12.m1.1.1.3.1">subscript</csymbol><sum id="A1.E12.m1.1.1.3.1.2.2.cmml" xref="A1.E12.m1.1.1.3.1.2.2"></sum><apply id="A1.E12.m1.1.1.3.1.2.3.cmml" xref="A1.E12.m1.1.1.3.1.2.3"><eq id="A1.E12.m1.1.1.3.1.2.3.1.cmml" xref="A1.E12.m1.1.1.3.1.2.3.1"></eq><ci id="A1.E12.m1.1.1.3.1.2.3.2.cmml" xref="A1.E12.m1.1.1.3.1.2.3.2">𝑐</ci><cn type="integer" id="A1.E12.m1.1.1.3.1.2.3.3.cmml" xref="A1.E12.m1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="A1.E12.m1.1.1.3.1.3.cmml" xref="A1.E12.m1.1.1.3.1.3"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.3.1.3.1.cmml" xref="A1.E12.m1.1.1.3.1.3">subscript</csymbol><ci id="A1.E12.m1.1.1.3.1.3.2.cmml" xref="A1.E12.m1.1.1.3.1.3.2">𝑑</ci><ci id="A1.E12.m1.1.1.3.1.3.3.cmml" xref="A1.E12.m1.1.1.3.1.3.3">𝑘</ci></apply></apply><apply id="A1.E12.m1.1.1.3.2.cmml" xref="A1.E12.m1.1.1.3.2"><times id="A1.E12.m1.1.1.3.2.1.cmml" xref="A1.E12.m1.1.1.3.2.1"></times><apply id="A1.E12.m1.1.1.3.2.2.cmml" xref="A1.E12.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.3.2.2.1.cmml" xref="A1.E12.m1.1.1.3.2.2">subscript</csymbol><ci id="A1.E12.m1.1.1.3.2.2.2.cmml" xref="A1.E12.m1.1.1.3.2.2.2">𝑄</ci><apply id="A1.E12.m1.1.1.3.2.2.3.cmml" xref="A1.E12.m1.1.1.3.2.2.3"><times id="A1.E12.m1.1.1.3.2.2.3.1.cmml" xref="A1.E12.m1.1.1.3.2.2.3.1"></times><ci id="A1.E12.m1.1.1.3.2.2.3.2.cmml" xref="A1.E12.m1.1.1.3.2.2.3.2">𝑖</ci><ci id="A1.E12.m1.1.1.3.2.2.3.3.cmml" xref="A1.E12.m1.1.1.3.2.2.3.3">𝑐</ci></apply></apply><apply id="A1.E12.m1.1.1.3.2.3.cmml" xref="A1.E12.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.3.2.3.1.cmml" xref="A1.E12.m1.1.1.3.2.3">subscript</csymbol><ci id="A1.E12.m1.1.1.3.2.3.2.cmml" xref="A1.E12.m1.1.1.3.2.3.2">𝐾</ci><apply id="A1.E12.m1.1.1.3.2.3.3.cmml" xref="A1.E12.m1.1.1.3.2.3.3"><times id="A1.E12.m1.1.1.3.2.3.3.1.cmml" xref="A1.E12.m1.1.1.3.2.3.3.1"></times><ci id="A1.E12.m1.1.1.3.2.3.3.2.cmml" xref="A1.E12.m1.1.1.3.2.3.3.2">𝑗</ci><ci id="A1.E12.m1.1.1.3.2.3.3.3.cmml" xref="A1.E12.m1.1.1.3.2.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.1c">(QK^{T})_{ij}=\sum_{c=1}^{d_{k}}Q_{ic}K_{jc}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.p10" class="ltx_para ltx_noindent">
<p id="A1.SS1.p10.2" class="ltx_p">Similarly, for <math id="A1.SS1.p10.1.m1.1" class="ltx_Math" alttext="Q^{\prime}" display="inline"><semantics id="A1.SS1.p10.1.m1.1a"><msup id="A1.SS1.p10.1.m1.1.1" xref="A1.SS1.p10.1.m1.1.1.cmml"><mi id="A1.SS1.p10.1.m1.1.1.2" xref="A1.SS1.p10.1.m1.1.1.2.cmml">Q</mi><mo id="A1.SS1.p10.1.m1.1.1.3" xref="A1.SS1.p10.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p10.1.m1.1b"><apply id="A1.SS1.p10.1.m1.1.1.cmml" xref="A1.SS1.p10.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p10.1.m1.1.1.1.cmml" xref="A1.SS1.p10.1.m1.1.1">superscript</csymbol><ci id="A1.SS1.p10.1.m1.1.1.2.cmml" xref="A1.SS1.p10.1.m1.1.1.2">𝑄</ci><ci id="A1.SS1.p10.1.m1.1.1.3.cmml" xref="A1.SS1.p10.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p10.1.m1.1c">Q^{\prime}</annotation></semantics></math> and <math id="A1.SS1.p10.2.m2.1" class="ltx_Math" alttext="K^{\prime}" display="inline"><semantics id="A1.SS1.p10.2.m2.1a"><msup id="A1.SS1.p10.2.m2.1.1" xref="A1.SS1.p10.2.m2.1.1.cmml"><mi id="A1.SS1.p10.2.m2.1.1.2" xref="A1.SS1.p10.2.m2.1.1.2.cmml">K</mi><mo id="A1.SS1.p10.2.m2.1.1.3" xref="A1.SS1.p10.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p10.2.m2.1b"><apply id="A1.SS1.p10.2.m2.1.1.cmml" xref="A1.SS1.p10.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p10.2.m2.1.1.1.cmml" xref="A1.SS1.p10.2.m2.1.1">superscript</csymbol><ci id="A1.SS1.p10.2.m2.1.1.2.cmml" xref="A1.SS1.p10.2.m2.1.1.2">𝐾</ci><ci id="A1.SS1.p10.2.m2.1.1.3.cmml" xref="A1.SS1.p10.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p10.2.m2.1c">K^{\prime}</annotation></semantics></math>:</p>
<table id="A1.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E13.m1.3" class="ltx_Math" alttext="(Q^{\prime}K^{\prime T})_{ij}=\sum_{c=1}^{d_{k}}Q^{\prime}_{ic}K^{\prime}_{jc}" display="block"><semantics id="A1.E13.m1.3a"><mrow id="A1.E13.m1.3.3" xref="A1.E13.m1.3.3.cmml"><msub id="A1.E13.m1.3.3.1" xref="A1.E13.m1.3.3.1.cmml"><mrow id="A1.E13.m1.3.3.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="A1.E13.m1.3.3.1.1.1.2" xref="A1.E13.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.E13.m1.3.3.1.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.cmml"><msup id="A1.E13.m1.3.3.1.1.1.1.2" xref="A1.E13.m1.3.3.1.1.1.1.2.cmml"><mi id="A1.E13.m1.3.3.1.1.1.1.2.2" xref="A1.E13.m1.3.3.1.1.1.1.2.2.cmml">Q</mi><mo id="A1.E13.m1.3.3.1.1.1.1.2.3" xref="A1.E13.m1.3.3.1.1.1.1.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.E13.m1.3.3.1.1.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.1.cmml">​</mo><msup id="A1.E13.m1.3.3.1.1.1.1.3" xref="A1.E13.m1.3.3.1.1.1.1.3.cmml"><mi id="A1.E13.m1.3.3.1.1.1.1.3.2" xref="A1.E13.m1.3.3.1.1.1.1.3.2.cmml">K</mi><mrow id="A1.E13.m1.2.2.2.2" xref="A1.E13.m1.2.2.2.3.cmml"><mo mathsize="142%" id="A1.E13.m1.2.2.2.2.1" xref="A1.E13.m1.2.2.2.2.1.cmml">′</mo><mo lspace="0em" id="A1.E13.m1.2.2.2.2.2" xref="A1.E13.m1.2.2.2.3.cmml">⁣</mo><mi id="A1.E13.m1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.cmml">T</mi></mrow></msup></mrow><mo stretchy="false" id="A1.E13.m1.3.3.1.1.1.3" xref="A1.E13.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mrow id="A1.E13.m1.3.3.1.3" xref="A1.E13.m1.3.3.1.3.cmml"><mi id="A1.E13.m1.3.3.1.3.2" xref="A1.E13.m1.3.3.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E13.m1.3.3.1.3.1" xref="A1.E13.m1.3.3.1.3.1.cmml">​</mo><mi id="A1.E13.m1.3.3.1.3.3" xref="A1.E13.m1.3.3.1.3.3.cmml">j</mi></mrow></msub><mo rspace="0.111em" id="A1.E13.m1.3.3.2" xref="A1.E13.m1.3.3.2.cmml">=</mo><mrow id="A1.E13.m1.3.3.3" xref="A1.E13.m1.3.3.3.cmml"><munderover id="A1.E13.m1.3.3.3.1" xref="A1.E13.m1.3.3.3.1.cmml"><mo movablelimits="false" id="A1.E13.m1.3.3.3.1.2.2" xref="A1.E13.m1.3.3.3.1.2.2.cmml">∑</mo><mrow id="A1.E13.m1.3.3.3.1.2.3" xref="A1.E13.m1.3.3.3.1.2.3.cmml"><mi id="A1.E13.m1.3.3.3.1.2.3.2" xref="A1.E13.m1.3.3.3.1.2.3.2.cmml">c</mi><mo id="A1.E13.m1.3.3.3.1.2.3.1" xref="A1.E13.m1.3.3.3.1.2.3.1.cmml">=</mo><mn id="A1.E13.m1.3.3.3.1.2.3.3" xref="A1.E13.m1.3.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="A1.E13.m1.3.3.3.1.3" xref="A1.E13.m1.3.3.3.1.3.cmml"><mi id="A1.E13.m1.3.3.3.1.3.2" xref="A1.E13.m1.3.3.3.1.3.2.cmml">d</mi><mi id="A1.E13.m1.3.3.3.1.3.3" xref="A1.E13.m1.3.3.3.1.3.3.cmml">k</mi></msub></munderover><mrow id="A1.E13.m1.3.3.3.2" xref="A1.E13.m1.3.3.3.2.cmml"><msubsup id="A1.E13.m1.3.3.3.2.2" xref="A1.E13.m1.3.3.3.2.2.cmml"><mi id="A1.E13.m1.3.3.3.2.2.2.2" xref="A1.E13.m1.3.3.3.2.2.2.2.cmml">Q</mi><mrow id="A1.E13.m1.3.3.3.2.2.3" xref="A1.E13.m1.3.3.3.2.2.3.cmml"><mi id="A1.E13.m1.3.3.3.2.2.3.2" xref="A1.E13.m1.3.3.3.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E13.m1.3.3.3.2.2.3.1" xref="A1.E13.m1.3.3.3.2.2.3.1.cmml">​</mo><mi id="A1.E13.m1.3.3.3.2.2.3.3" xref="A1.E13.m1.3.3.3.2.2.3.3.cmml">c</mi></mrow><mo id="A1.E13.m1.3.3.3.2.2.2.3" xref="A1.E13.m1.3.3.3.2.2.2.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E13.m1.3.3.3.2.1" xref="A1.E13.m1.3.3.3.2.1.cmml">​</mo><msubsup id="A1.E13.m1.3.3.3.2.3" xref="A1.E13.m1.3.3.3.2.3.cmml"><mi id="A1.E13.m1.3.3.3.2.3.2.2" xref="A1.E13.m1.3.3.3.2.3.2.2.cmml">K</mi><mrow id="A1.E13.m1.3.3.3.2.3.3" xref="A1.E13.m1.3.3.3.2.3.3.cmml"><mi id="A1.E13.m1.3.3.3.2.3.3.2" xref="A1.E13.m1.3.3.3.2.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="A1.E13.m1.3.3.3.2.3.3.1" xref="A1.E13.m1.3.3.3.2.3.3.1.cmml">​</mo><mi id="A1.E13.m1.3.3.3.2.3.3.3" xref="A1.E13.m1.3.3.3.2.3.3.3.cmml">c</mi></mrow><mo id="A1.E13.m1.3.3.3.2.3.2.3" xref="A1.E13.m1.3.3.3.2.3.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.3b"><apply id="A1.E13.m1.3.3.cmml" xref="A1.E13.m1.3.3"><eq id="A1.E13.m1.3.3.2.cmml" xref="A1.E13.m1.3.3.2"></eq><apply id="A1.E13.m1.3.3.1.cmml" xref="A1.E13.m1.3.3.1"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.1.2.cmml" xref="A1.E13.m1.3.3.1">subscript</csymbol><apply id="A1.E13.m1.3.3.1.1.1.1.cmml" xref="A1.E13.m1.3.3.1.1.1"><times id="A1.E13.m1.3.3.1.1.1.1.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1"></times><apply id="A1.E13.m1.3.3.1.1.1.1.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.1.1.1.1.2.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.2">superscript</csymbol><ci id="A1.E13.m1.3.3.1.1.1.1.2.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.2.2">𝑄</ci><ci id="A1.E13.m1.3.3.1.1.1.1.2.3.cmml" xref="A1.E13.m1.3.3.1.1.1.1.2.3">′</ci></apply><apply id="A1.E13.m1.3.3.1.1.1.1.3.cmml" xref="A1.E13.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.1.1.1.1.3.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.3">superscript</csymbol><ci id="A1.E13.m1.3.3.1.1.1.1.3.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.3.2">𝐾</ci><list id="A1.E13.m1.2.2.2.3.cmml" xref="A1.E13.m1.2.2.2.2"><ci id="A1.E13.m1.2.2.2.2.1.cmml" xref="A1.E13.m1.2.2.2.2.1">′</ci><ci id="A1.E13.m1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1">𝑇</ci></list></apply></apply><apply id="A1.E13.m1.3.3.1.3.cmml" xref="A1.E13.m1.3.3.1.3"><times id="A1.E13.m1.3.3.1.3.1.cmml" xref="A1.E13.m1.3.3.1.3.1"></times><ci id="A1.E13.m1.3.3.1.3.2.cmml" xref="A1.E13.m1.3.3.1.3.2">𝑖</ci><ci id="A1.E13.m1.3.3.1.3.3.cmml" xref="A1.E13.m1.3.3.1.3.3">𝑗</ci></apply></apply><apply id="A1.E13.m1.3.3.3.cmml" xref="A1.E13.m1.3.3.3"><apply id="A1.E13.m1.3.3.3.1.cmml" xref="A1.E13.m1.3.3.3.1"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.1.1.cmml" xref="A1.E13.m1.3.3.3.1">superscript</csymbol><apply id="A1.E13.m1.3.3.3.1.2.cmml" xref="A1.E13.m1.3.3.3.1"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.1.2.1.cmml" xref="A1.E13.m1.3.3.3.1">subscript</csymbol><sum id="A1.E13.m1.3.3.3.1.2.2.cmml" xref="A1.E13.m1.3.3.3.1.2.2"></sum><apply id="A1.E13.m1.3.3.3.1.2.3.cmml" xref="A1.E13.m1.3.3.3.1.2.3"><eq id="A1.E13.m1.3.3.3.1.2.3.1.cmml" xref="A1.E13.m1.3.3.3.1.2.3.1"></eq><ci id="A1.E13.m1.3.3.3.1.2.3.2.cmml" xref="A1.E13.m1.3.3.3.1.2.3.2">𝑐</ci><cn type="integer" id="A1.E13.m1.3.3.3.1.2.3.3.cmml" xref="A1.E13.m1.3.3.3.1.2.3.3">1</cn></apply></apply><apply id="A1.E13.m1.3.3.3.1.3.cmml" xref="A1.E13.m1.3.3.3.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.1.3.1.cmml" xref="A1.E13.m1.3.3.3.1.3">subscript</csymbol><ci id="A1.E13.m1.3.3.3.1.3.2.cmml" xref="A1.E13.m1.3.3.3.1.3.2">𝑑</ci><ci id="A1.E13.m1.3.3.3.1.3.3.cmml" xref="A1.E13.m1.3.3.3.1.3.3">𝑘</ci></apply></apply><apply id="A1.E13.m1.3.3.3.2.cmml" xref="A1.E13.m1.3.3.3.2"><times id="A1.E13.m1.3.3.3.2.1.cmml" xref="A1.E13.m1.3.3.3.2.1"></times><apply id="A1.E13.m1.3.3.3.2.2.cmml" xref="A1.E13.m1.3.3.3.2.2"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.2.2.1.cmml" xref="A1.E13.m1.3.3.3.2.2">subscript</csymbol><apply id="A1.E13.m1.3.3.3.2.2.2.cmml" xref="A1.E13.m1.3.3.3.2.2"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.2.2.2.1.cmml" xref="A1.E13.m1.3.3.3.2.2">superscript</csymbol><ci id="A1.E13.m1.3.3.3.2.2.2.2.cmml" xref="A1.E13.m1.3.3.3.2.2.2.2">𝑄</ci><ci id="A1.E13.m1.3.3.3.2.2.2.3.cmml" xref="A1.E13.m1.3.3.3.2.2.2.3">′</ci></apply><apply id="A1.E13.m1.3.3.3.2.2.3.cmml" xref="A1.E13.m1.3.3.3.2.2.3"><times id="A1.E13.m1.3.3.3.2.2.3.1.cmml" xref="A1.E13.m1.3.3.3.2.2.3.1"></times><ci id="A1.E13.m1.3.3.3.2.2.3.2.cmml" xref="A1.E13.m1.3.3.3.2.2.3.2">𝑖</ci><ci id="A1.E13.m1.3.3.3.2.2.3.3.cmml" xref="A1.E13.m1.3.3.3.2.2.3.3">𝑐</ci></apply></apply><apply id="A1.E13.m1.3.3.3.2.3.cmml" xref="A1.E13.m1.3.3.3.2.3"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.2.3.1.cmml" xref="A1.E13.m1.3.3.3.2.3">subscript</csymbol><apply id="A1.E13.m1.3.3.3.2.3.2.cmml" xref="A1.E13.m1.3.3.3.2.3"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.2.3.2.1.cmml" xref="A1.E13.m1.3.3.3.2.3">superscript</csymbol><ci id="A1.E13.m1.3.3.3.2.3.2.2.cmml" xref="A1.E13.m1.3.3.3.2.3.2.2">𝐾</ci><ci id="A1.E13.m1.3.3.3.2.3.2.3.cmml" xref="A1.E13.m1.3.3.3.2.3.2.3">′</ci></apply><apply id="A1.E13.m1.3.3.3.2.3.3.cmml" xref="A1.E13.m1.3.3.3.2.3.3"><times id="A1.E13.m1.3.3.3.2.3.3.1.cmml" xref="A1.E13.m1.3.3.3.2.3.3.1"></times><ci id="A1.E13.m1.3.3.3.2.3.3.2.cmml" xref="A1.E13.m1.3.3.3.2.3.3.2">𝑗</ci><ci id="A1.E13.m1.3.3.3.2.3.3.3.cmml" xref="A1.E13.m1.3.3.3.2.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.3c">(Q^{\prime}K^{\prime T})_{ij}=\sum_{c=1}^{d_{k}}Q^{\prime}_{ic}K^{\prime}_{jc}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.p11" class="ltx_para ltx_noindent">
<p id="A1.SS1.p11.2" class="ltx_p">Using the previous definitions of <math id="A1.SS1.p11.1.m1.1" class="ltx_Math" alttext="Q^{\prime}" display="inline"><semantics id="A1.SS1.p11.1.m1.1a"><msup id="A1.SS1.p11.1.m1.1.1" xref="A1.SS1.p11.1.m1.1.1.cmml"><mi id="A1.SS1.p11.1.m1.1.1.2" xref="A1.SS1.p11.1.m1.1.1.2.cmml">Q</mi><mo id="A1.SS1.p11.1.m1.1.1.3" xref="A1.SS1.p11.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p11.1.m1.1b"><apply id="A1.SS1.p11.1.m1.1.1.cmml" xref="A1.SS1.p11.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p11.1.m1.1.1.1.cmml" xref="A1.SS1.p11.1.m1.1.1">superscript</csymbol><ci id="A1.SS1.p11.1.m1.1.1.2.cmml" xref="A1.SS1.p11.1.m1.1.1.2">𝑄</ci><ci id="A1.SS1.p11.1.m1.1.1.3.cmml" xref="A1.SS1.p11.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p11.1.m1.1c">Q^{\prime}</annotation></semantics></math> and <math id="A1.SS1.p11.2.m2.1" class="ltx_Math" alttext="K^{\prime}" display="inline"><semantics id="A1.SS1.p11.2.m2.1a"><msup id="A1.SS1.p11.2.m2.1.1" xref="A1.SS1.p11.2.m2.1.1.cmml"><mi id="A1.SS1.p11.2.m2.1.1.2" xref="A1.SS1.p11.2.m2.1.1.2.cmml">K</mi><mo id="A1.SS1.p11.2.m2.1.1.3" xref="A1.SS1.p11.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p11.2.m2.1b"><apply id="A1.SS1.p11.2.m2.1.1.cmml" xref="A1.SS1.p11.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p11.2.m2.1.1.1.cmml" xref="A1.SS1.p11.2.m2.1.1">superscript</csymbol><ci id="A1.SS1.p11.2.m2.1.1.2.cmml" xref="A1.SS1.p11.2.m2.1.1.2">𝐾</ci><ci id="A1.SS1.p11.2.m2.1.1.3.cmml" xref="A1.SS1.p11.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p11.2.m2.1c">K^{\prime}</annotation></semantics></math>, and plugging them into the above equation, we see:</p>
<table id="A1.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E14.m1.37" class="ltx_Math" alttext="\begin{split}(Q^{\prime}K^{\prime T})_{ij}&amp;=\sum_{p=1}^{d_{k}}\left(\sum_{c=1}^{d}x_{ic}W^{q^{\prime}}_{cp}\right)\left(\sum_{r=1}^{d}x_{jr}W^{k^{\prime}}_{rp}\right)\end{split}" display="block"><semantics id="A1.E14.m1.37a"><mtable columnspacing="0pt" displaystyle="true" id="A1.E14.m1.37.37.6" xref="A1.E14.m1.34.34.3.cmml"><mtr id="A1.E14.m1.37.37.6a" xref="A1.E14.m1.34.34.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E14.m1.37.37.6b" xref="A1.E14.m1.34.34.3.cmml"><msub id="A1.E14.m1.35.35.4.32.32.8" xref="A1.E14.m1.34.34.3.cmml"><mrow id="A1.E14.m1.35.35.4.32.32.8.8.1" xref="A1.E14.m1.34.34.3.cmml"><mo stretchy="false" id="A1.E14.m1.1.1.1.1.1.1" xref="A1.E14.m1.34.34.3.cmml">(</mo><mrow id="A1.E14.m1.35.35.4.32.32.8.8.1.1" xref="A1.E14.m1.34.34.3.cmml"><msup id="A1.E14.m1.35.35.4.32.32.8.8.1.1.2" xref="A1.E14.m1.34.34.3.cmml"><mi id="A1.E14.m1.2.2.2.2.2.2" xref="A1.E14.m1.2.2.2.2.2.2.cmml">Q</mi><mo id="A1.E14.m1.3.3.3.3.3.3.1" xref="A1.E14.m1.3.3.3.3.3.3.1.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.E14.m1.35.35.4.32.32.8.8.1.1.1" xref="A1.E14.m1.34.34.3.cmml">​</mo><msup id="A1.E14.m1.35.35.4.32.32.8.8.1.1.3" xref="A1.E14.m1.34.34.3.cmml"><mi id="A1.E14.m1.4.4.4.4.4.4" xref="A1.E14.m1.4.4.4.4.4.4.cmml">K</mi><mrow id="A1.E14.m1.5.5.5.5.5.5.1.2" xref="A1.E14.m1.5.5.5.5.5.5.1.3.cmml"><mo mathsize="142%" id="A1.E14.m1.5.5.5.5.5.5.1.2.1" xref="A1.E14.m1.5.5.5.5.5.5.1.2.1.cmml">′</mo><mo lspace="0em" id="A1.E14.m1.5.5.5.5.5.5.1.2.2" xref="A1.E14.m1.5.5.5.5.5.5.1.3.cmml">⁣</mo><mi id="A1.E14.m1.5.5.5.5.5.5.1.1" xref="A1.E14.m1.5.5.5.5.5.5.1.1.cmml">T</mi></mrow></msup></mrow><mo stretchy="false" id="A1.E14.m1.6.6.6.6.6.6" xref="A1.E14.m1.34.34.3.cmml">)</mo></mrow><mrow id="A1.E14.m1.7.7.7.7.7.7.1" xref="A1.E14.m1.7.7.7.7.7.7.1.cmml"><mi id="A1.E14.m1.7.7.7.7.7.7.1.2" xref="A1.E14.m1.7.7.7.7.7.7.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E14.m1.7.7.7.7.7.7.1.1" xref="A1.E14.m1.7.7.7.7.7.7.1.1.cmml">​</mo><mi id="A1.E14.m1.7.7.7.7.7.7.1.3" xref="A1.E14.m1.7.7.7.7.7.7.1.3.cmml">j</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E14.m1.37.37.6c" xref="A1.E14.m1.34.34.3.cmml"><mrow id="A1.E14.m1.37.37.6.34.34.26" xref="A1.E14.m1.34.34.3.cmml"><mi id="A1.E14.m1.37.37.6.34.34.26.27" xref="A1.E14.m1.34.34.3.cmml"></mi><mo rspace="0.111em" id="A1.E14.m1.8.8.8.8.1.1" xref="A1.E14.m1.8.8.8.8.1.1.cmml">=</mo><mrow id="A1.E14.m1.37.37.6.34.34.26.26" xref="A1.E14.m1.34.34.3.cmml"><munderover id="A1.E14.m1.37.37.6.34.34.26.26.3" xref="A1.E14.m1.34.34.3.cmml"><mo movablelimits="false" rspace="0em" id="A1.E14.m1.9.9.9.9.2.2" xref="A1.E14.m1.9.9.9.9.2.2.cmml">∑</mo><mrow id="A1.E14.m1.10.10.10.10.3.3.1" xref="A1.E14.m1.10.10.10.10.3.3.1.cmml"><mi id="A1.E14.m1.10.10.10.10.3.3.1.2" xref="A1.E14.m1.10.10.10.10.3.3.1.2.cmml">p</mi><mo id="A1.E14.m1.10.10.10.10.3.3.1.1" xref="A1.E14.m1.10.10.10.10.3.3.1.1.cmml">=</mo><mn id="A1.E14.m1.10.10.10.10.3.3.1.3" xref="A1.E14.m1.10.10.10.10.3.3.1.3.cmml">1</mn></mrow><msub id="A1.E14.m1.11.11.11.11.4.4.1" xref="A1.E14.m1.11.11.11.11.4.4.1.cmml"><mi id="A1.E14.m1.11.11.11.11.4.4.1.2" xref="A1.E14.m1.11.11.11.11.4.4.1.2.cmml">d</mi><mi id="A1.E14.m1.11.11.11.11.4.4.1.3" xref="A1.E14.m1.11.11.11.11.4.4.1.3.cmml">k</mi></msub></munderover><mrow id="A1.E14.m1.37.37.6.34.34.26.26.2" xref="A1.E14.m1.34.34.3.cmml"><mrow id="A1.E14.m1.36.36.5.33.33.25.25.1.1.1" xref="A1.E14.m1.34.34.3.cmml"><mo id="A1.E14.m1.12.12.12.12.5.5" xref="A1.E14.m1.34.34.3.cmml">(</mo><mrow id="A1.E14.m1.36.36.5.33.33.25.25.1.1.1.1" xref="A1.E14.m1.34.34.3.cmml"><munderover id="A1.E14.m1.36.36.5.33.33.25.25.1.1.1.1.1" xref="A1.E14.m1.34.34.3.cmml"><mo lspace="0em" movablelimits="false" id="A1.E14.m1.13.13.13.13.6.6" xref="A1.E14.m1.13.13.13.13.6.6.cmml">∑</mo><mrow id="A1.E14.m1.14.14.14.14.7.7.1" xref="A1.E14.m1.14.14.14.14.7.7.1.cmml"><mi id="A1.E14.m1.14.14.14.14.7.7.1.2" xref="A1.E14.m1.14.14.14.14.7.7.1.2.cmml">c</mi><mo id="A1.E14.m1.14.14.14.14.7.7.1.1" xref="A1.E14.m1.14.14.14.14.7.7.1.1.cmml">=</mo><mn id="A1.E14.m1.14.14.14.14.7.7.1.3" xref="A1.E14.m1.14.14.14.14.7.7.1.3.cmml">1</mn></mrow><mi id="A1.E14.m1.15.15.15.15.8.8.1" xref="A1.E14.m1.15.15.15.15.8.8.1.cmml">d</mi></munderover><mrow id="A1.E14.m1.36.36.5.33.33.25.25.1.1.1.1.2" xref="A1.E14.m1.34.34.3.cmml"><msub id="A1.E14.m1.36.36.5.33.33.25.25.1.1.1.1.2.2" xref="A1.E14.m1.34.34.3.cmml"><mi id="A1.E14.m1.16.16.16.16.9.9" xref="A1.E14.m1.16.16.16.16.9.9.cmml">x</mi><mrow id="A1.E14.m1.17.17.17.17.10.10.1" xref="A1.E14.m1.17.17.17.17.10.10.1.cmml"><mi id="A1.E14.m1.17.17.17.17.10.10.1.2" xref="A1.E14.m1.17.17.17.17.10.10.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E14.m1.17.17.17.17.10.10.1.1" xref="A1.E14.m1.17.17.17.17.10.10.1.1.cmml">​</mo><mi id="A1.E14.m1.17.17.17.17.10.10.1.3" xref="A1.E14.m1.17.17.17.17.10.10.1.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E14.m1.36.36.5.33.33.25.25.1.1.1.1.2.1" xref="A1.E14.m1.34.34.3.cmml">​</mo><msubsup id="A1.E14.m1.36.36.5.33.33.25.25.1.1.1.1.2.3" xref="A1.E14.m1.34.34.3.cmml"><mi id="A1.E14.m1.18.18.18.18.11.11" xref="A1.E14.m1.18.18.18.18.11.11.cmml">W</mi><mrow id="A1.E14.m1.20.20.20.20.13.13.1" xref="A1.E14.m1.20.20.20.20.13.13.1.cmml"><mi id="A1.E14.m1.20.20.20.20.13.13.1.2" xref="A1.E14.m1.20.20.20.20.13.13.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A1.E14.m1.20.20.20.20.13.13.1.1" xref="A1.E14.m1.20.20.20.20.13.13.1.1.cmml">​</mo><mi id="A1.E14.m1.20.20.20.20.13.13.1.3" xref="A1.E14.m1.20.20.20.20.13.13.1.3.cmml">p</mi></mrow><msup id="A1.E14.m1.19.19.19.19.12.12.1" xref="A1.E14.m1.19.19.19.19.12.12.1.cmml"><mi id="A1.E14.m1.19.19.19.19.12.12.1.2" xref="A1.E14.m1.19.19.19.19.12.12.1.2.cmml">q</mi><mo id="A1.E14.m1.19.19.19.19.12.12.1.3" xref="A1.E14.m1.19.19.19.19.12.12.1.3.cmml">′</mo></msup></msubsup></mrow></mrow><mo id="A1.E14.m1.21.21.21.21.14.14" xref="A1.E14.m1.34.34.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.E14.m1.37.37.6.34.34.26.26.2.3" xref="A1.E14.m1.34.34.3.cmml">​</mo><mrow id="A1.E14.m1.37.37.6.34.34.26.26.2.2.1" xref="A1.E14.m1.34.34.3.cmml"><mo id="A1.E14.m1.22.22.22.22.15.15" xref="A1.E14.m1.34.34.3.cmml">(</mo><mrow id="A1.E14.m1.37.37.6.34.34.26.26.2.2.1.1" xref="A1.E14.m1.34.34.3.cmml"><munderover id="A1.E14.m1.37.37.6.34.34.26.26.2.2.1.1.1" xref="A1.E14.m1.34.34.3.cmml"><mo lspace="0em" movablelimits="false" id="A1.E14.m1.23.23.23.23.16.16" xref="A1.E14.m1.23.23.23.23.16.16.cmml">∑</mo><mrow id="A1.E14.m1.24.24.24.24.17.17.1" xref="A1.E14.m1.24.24.24.24.17.17.1.cmml"><mi id="A1.E14.m1.24.24.24.24.17.17.1.2" xref="A1.E14.m1.24.24.24.24.17.17.1.2.cmml">r</mi><mo id="A1.E14.m1.24.24.24.24.17.17.1.1" xref="A1.E14.m1.24.24.24.24.17.17.1.1.cmml">=</mo><mn id="A1.E14.m1.24.24.24.24.17.17.1.3" xref="A1.E14.m1.24.24.24.24.17.17.1.3.cmml">1</mn></mrow><mi id="A1.E14.m1.25.25.25.25.18.18.1" xref="A1.E14.m1.25.25.25.25.18.18.1.cmml">d</mi></munderover><mrow id="A1.E14.m1.37.37.6.34.34.26.26.2.2.1.1.2" xref="A1.E14.m1.34.34.3.cmml"><msub id="A1.E14.m1.37.37.6.34.34.26.26.2.2.1.1.2.2" xref="A1.E14.m1.34.34.3.cmml"><mi id="A1.E14.m1.26.26.26.26.19.19" xref="A1.E14.m1.26.26.26.26.19.19.cmml">x</mi><mrow id="A1.E14.m1.27.27.27.27.20.20.1" xref="A1.E14.m1.27.27.27.27.20.20.1.cmml"><mi id="A1.E14.m1.27.27.27.27.20.20.1.2" xref="A1.E14.m1.27.27.27.27.20.20.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="A1.E14.m1.27.27.27.27.20.20.1.1" xref="A1.E14.m1.27.27.27.27.20.20.1.1.cmml">​</mo><mi id="A1.E14.m1.27.27.27.27.20.20.1.3" xref="A1.E14.m1.27.27.27.27.20.20.1.3.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E14.m1.37.37.6.34.34.26.26.2.2.1.1.2.1" xref="A1.E14.m1.34.34.3.cmml">​</mo><msubsup id="A1.E14.m1.37.37.6.34.34.26.26.2.2.1.1.2.3" xref="A1.E14.m1.34.34.3.cmml"><mi id="A1.E14.m1.28.28.28.28.21.21" xref="A1.E14.m1.28.28.28.28.21.21.cmml">W</mi><mrow id="A1.E14.m1.30.30.30.30.23.23.1" xref="A1.E14.m1.30.30.30.30.23.23.1.cmml"><mi id="A1.E14.m1.30.30.30.30.23.23.1.2" xref="A1.E14.m1.30.30.30.30.23.23.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.E14.m1.30.30.30.30.23.23.1.1" xref="A1.E14.m1.30.30.30.30.23.23.1.1.cmml">​</mo><mi id="A1.E14.m1.30.30.30.30.23.23.1.3" xref="A1.E14.m1.30.30.30.30.23.23.1.3.cmml">p</mi></mrow><msup id="A1.E14.m1.29.29.29.29.22.22.1" xref="A1.E14.m1.29.29.29.29.22.22.1.cmml"><mi id="A1.E14.m1.29.29.29.29.22.22.1.2" xref="A1.E14.m1.29.29.29.29.22.22.1.2.cmml">k</mi><mo id="A1.E14.m1.29.29.29.29.22.22.1.3" xref="A1.E14.m1.29.29.29.29.22.22.1.3.cmml">′</mo></msup></msubsup></mrow></mrow><mo id="A1.E14.m1.31.31.31.31.24.24" xref="A1.E14.m1.34.34.3.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E14.m1.37b"><apply id="A1.E14.m1.34.34.3.cmml" xref="A1.E14.m1.37.37.6"><eq id="A1.E14.m1.8.8.8.8.1.1.cmml" xref="A1.E14.m1.8.8.8.8.1.1"></eq><apply id="A1.E14.m1.32.32.1.1.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.32.32.1.1.2.cmml" xref="A1.E14.m1.37.37.6">subscript</csymbol><apply id="A1.E14.m1.32.32.1.1.1.1.1.cmml" xref="A1.E14.m1.37.37.6"><times id="A1.E14.m1.32.32.1.1.1.1.1.1.cmml" xref="A1.E14.m1.37.37.6"></times><apply id="A1.E14.m1.32.32.1.1.1.1.1.2.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.32.32.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.37.37.6">superscript</csymbol><ci id="A1.E14.m1.2.2.2.2.2.2.cmml" xref="A1.E14.m1.2.2.2.2.2.2">𝑄</ci><ci id="A1.E14.m1.3.3.3.3.3.3.1.cmml" xref="A1.E14.m1.3.3.3.3.3.3.1">′</ci></apply><apply id="A1.E14.m1.32.32.1.1.1.1.1.3.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.32.32.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.37.37.6">superscript</csymbol><ci id="A1.E14.m1.4.4.4.4.4.4.cmml" xref="A1.E14.m1.4.4.4.4.4.4">𝐾</ci><list id="A1.E14.m1.5.5.5.5.5.5.1.3.cmml" xref="A1.E14.m1.5.5.5.5.5.5.1.2"><ci id="A1.E14.m1.5.5.5.5.5.5.1.2.1.cmml" xref="A1.E14.m1.5.5.5.5.5.5.1.2.1">′</ci><ci id="A1.E14.m1.5.5.5.5.5.5.1.1.cmml" xref="A1.E14.m1.5.5.5.5.5.5.1.1">𝑇</ci></list></apply></apply><apply id="A1.E14.m1.7.7.7.7.7.7.1.cmml" xref="A1.E14.m1.7.7.7.7.7.7.1"><times id="A1.E14.m1.7.7.7.7.7.7.1.1.cmml" xref="A1.E14.m1.7.7.7.7.7.7.1.1"></times><ci id="A1.E14.m1.7.7.7.7.7.7.1.2.cmml" xref="A1.E14.m1.7.7.7.7.7.7.1.2">𝑖</ci><ci id="A1.E14.m1.7.7.7.7.7.7.1.3.cmml" xref="A1.E14.m1.7.7.7.7.7.7.1.3">𝑗</ci></apply></apply><apply id="A1.E14.m1.34.34.3.3.cmml" xref="A1.E14.m1.37.37.6"><apply id="A1.E14.m1.34.34.3.3.3.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.34.34.3.3.3.1.cmml" xref="A1.E14.m1.37.37.6">superscript</csymbol><apply id="A1.E14.m1.34.34.3.3.3.2.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.34.34.3.3.3.2.1.cmml" xref="A1.E14.m1.37.37.6">subscript</csymbol><sum id="A1.E14.m1.9.9.9.9.2.2.cmml" xref="A1.E14.m1.9.9.9.9.2.2"></sum><apply id="A1.E14.m1.10.10.10.10.3.3.1.cmml" xref="A1.E14.m1.10.10.10.10.3.3.1"><eq id="A1.E14.m1.10.10.10.10.3.3.1.1.cmml" xref="A1.E14.m1.10.10.10.10.3.3.1.1"></eq><ci id="A1.E14.m1.10.10.10.10.3.3.1.2.cmml" xref="A1.E14.m1.10.10.10.10.3.3.1.2">𝑝</ci><cn type="integer" id="A1.E14.m1.10.10.10.10.3.3.1.3.cmml" xref="A1.E14.m1.10.10.10.10.3.3.1.3">1</cn></apply></apply><apply id="A1.E14.m1.11.11.11.11.4.4.1.cmml" xref="A1.E14.m1.11.11.11.11.4.4.1"><csymbol cd="ambiguous" id="A1.E14.m1.11.11.11.11.4.4.1.1.cmml" xref="A1.E14.m1.11.11.11.11.4.4.1">subscript</csymbol><ci id="A1.E14.m1.11.11.11.11.4.4.1.2.cmml" xref="A1.E14.m1.11.11.11.11.4.4.1.2">𝑑</ci><ci id="A1.E14.m1.11.11.11.11.4.4.1.3.cmml" xref="A1.E14.m1.11.11.11.11.4.4.1.3">𝑘</ci></apply></apply><apply id="A1.E14.m1.34.34.3.3.2.cmml" xref="A1.E14.m1.37.37.6"><times id="A1.E14.m1.34.34.3.3.2.3.cmml" xref="A1.E14.m1.37.37.6"></times><apply id="A1.E14.m1.33.33.2.2.1.1.1.1.cmml" xref="A1.E14.m1.37.37.6"><apply id="A1.E14.m1.33.33.2.2.1.1.1.1.1.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.33.33.2.2.1.1.1.1.1.1.cmml" xref="A1.E14.m1.37.37.6">superscript</csymbol><apply id="A1.E14.m1.33.33.2.2.1.1.1.1.1.2.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.33.33.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.37.37.6">subscript</csymbol><sum id="A1.E14.m1.13.13.13.13.6.6.cmml" xref="A1.E14.m1.13.13.13.13.6.6"></sum><apply id="A1.E14.m1.14.14.14.14.7.7.1.cmml" xref="A1.E14.m1.14.14.14.14.7.7.1"><eq id="A1.E14.m1.14.14.14.14.7.7.1.1.cmml" xref="A1.E14.m1.14.14.14.14.7.7.1.1"></eq><ci id="A1.E14.m1.14.14.14.14.7.7.1.2.cmml" xref="A1.E14.m1.14.14.14.14.7.7.1.2">𝑐</ci><cn type="integer" id="A1.E14.m1.14.14.14.14.7.7.1.3.cmml" xref="A1.E14.m1.14.14.14.14.7.7.1.3">1</cn></apply></apply><ci id="A1.E14.m1.15.15.15.15.8.8.1.cmml" xref="A1.E14.m1.15.15.15.15.8.8.1">𝑑</ci></apply><apply id="A1.E14.m1.33.33.2.2.1.1.1.1.2.cmml" xref="A1.E14.m1.37.37.6"><times id="A1.E14.m1.33.33.2.2.1.1.1.1.2.1.cmml" xref="A1.E14.m1.37.37.6"></times><apply id="A1.E14.m1.33.33.2.2.1.1.1.1.2.2.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.33.33.2.2.1.1.1.1.2.2.1.cmml" xref="A1.E14.m1.37.37.6">subscript</csymbol><ci id="A1.E14.m1.16.16.16.16.9.9.cmml" xref="A1.E14.m1.16.16.16.16.9.9">𝑥</ci><apply id="A1.E14.m1.17.17.17.17.10.10.1.cmml" xref="A1.E14.m1.17.17.17.17.10.10.1"><times id="A1.E14.m1.17.17.17.17.10.10.1.1.cmml" xref="A1.E14.m1.17.17.17.17.10.10.1.1"></times><ci id="A1.E14.m1.17.17.17.17.10.10.1.2.cmml" xref="A1.E14.m1.17.17.17.17.10.10.1.2">𝑖</ci><ci id="A1.E14.m1.17.17.17.17.10.10.1.3.cmml" xref="A1.E14.m1.17.17.17.17.10.10.1.3">𝑐</ci></apply></apply><apply id="A1.E14.m1.33.33.2.2.1.1.1.1.2.3.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.33.33.2.2.1.1.1.1.2.3.1.cmml" xref="A1.E14.m1.37.37.6">subscript</csymbol><apply id="A1.E14.m1.33.33.2.2.1.1.1.1.2.3.2.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.33.33.2.2.1.1.1.1.2.3.2.1.cmml" xref="A1.E14.m1.37.37.6">superscript</csymbol><ci id="A1.E14.m1.18.18.18.18.11.11.cmml" xref="A1.E14.m1.18.18.18.18.11.11">𝑊</ci><apply id="A1.E14.m1.19.19.19.19.12.12.1.cmml" xref="A1.E14.m1.19.19.19.19.12.12.1"><csymbol cd="ambiguous" id="A1.E14.m1.19.19.19.19.12.12.1.1.cmml" xref="A1.E14.m1.19.19.19.19.12.12.1">superscript</csymbol><ci id="A1.E14.m1.19.19.19.19.12.12.1.2.cmml" xref="A1.E14.m1.19.19.19.19.12.12.1.2">𝑞</ci><ci id="A1.E14.m1.19.19.19.19.12.12.1.3.cmml" xref="A1.E14.m1.19.19.19.19.12.12.1.3">′</ci></apply></apply><apply id="A1.E14.m1.20.20.20.20.13.13.1.cmml" xref="A1.E14.m1.20.20.20.20.13.13.1"><times id="A1.E14.m1.20.20.20.20.13.13.1.1.cmml" xref="A1.E14.m1.20.20.20.20.13.13.1.1"></times><ci id="A1.E14.m1.20.20.20.20.13.13.1.2.cmml" xref="A1.E14.m1.20.20.20.20.13.13.1.2">𝑐</ci><ci id="A1.E14.m1.20.20.20.20.13.13.1.3.cmml" xref="A1.E14.m1.20.20.20.20.13.13.1.3">𝑝</ci></apply></apply></apply></apply><apply id="A1.E14.m1.34.34.3.3.2.2.1.1.cmml" xref="A1.E14.m1.37.37.6"><apply id="A1.E14.m1.34.34.3.3.2.2.1.1.1.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.34.34.3.3.2.2.1.1.1.1.cmml" xref="A1.E14.m1.37.37.6">superscript</csymbol><apply id="A1.E14.m1.34.34.3.3.2.2.1.1.1.2.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.34.34.3.3.2.2.1.1.1.2.1.cmml" xref="A1.E14.m1.37.37.6">subscript</csymbol><sum id="A1.E14.m1.23.23.23.23.16.16.cmml" xref="A1.E14.m1.23.23.23.23.16.16"></sum><apply id="A1.E14.m1.24.24.24.24.17.17.1.cmml" xref="A1.E14.m1.24.24.24.24.17.17.1"><eq id="A1.E14.m1.24.24.24.24.17.17.1.1.cmml" xref="A1.E14.m1.24.24.24.24.17.17.1.1"></eq><ci id="A1.E14.m1.24.24.24.24.17.17.1.2.cmml" xref="A1.E14.m1.24.24.24.24.17.17.1.2">𝑟</ci><cn type="integer" id="A1.E14.m1.24.24.24.24.17.17.1.3.cmml" xref="A1.E14.m1.24.24.24.24.17.17.1.3">1</cn></apply></apply><ci id="A1.E14.m1.25.25.25.25.18.18.1.cmml" xref="A1.E14.m1.25.25.25.25.18.18.1">𝑑</ci></apply><apply id="A1.E14.m1.34.34.3.3.2.2.1.1.2.cmml" xref="A1.E14.m1.37.37.6"><times id="A1.E14.m1.34.34.3.3.2.2.1.1.2.1.cmml" xref="A1.E14.m1.37.37.6"></times><apply id="A1.E14.m1.34.34.3.3.2.2.1.1.2.2.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.34.34.3.3.2.2.1.1.2.2.1.cmml" xref="A1.E14.m1.37.37.6">subscript</csymbol><ci id="A1.E14.m1.26.26.26.26.19.19.cmml" xref="A1.E14.m1.26.26.26.26.19.19">𝑥</ci><apply id="A1.E14.m1.27.27.27.27.20.20.1.cmml" xref="A1.E14.m1.27.27.27.27.20.20.1"><times id="A1.E14.m1.27.27.27.27.20.20.1.1.cmml" xref="A1.E14.m1.27.27.27.27.20.20.1.1"></times><ci id="A1.E14.m1.27.27.27.27.20.20.1.2.cmml" xref="A1.E14.m1.27.27.27.27.20.20.1.2">𝑗</ci><ci id="A1.E14.m1.27.27.27.27.20.20.1.3.cmml" xref="A1.E14.m1.27.27.27.27.20.20.1.3">𝑟</ci></apply></apply><apply id="A1.E14.m1.34.34.3.3.2.2.1.1.2.3.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.34.34.3.3.2.2.1.1.2.3.1.cmml" xref="A1.E14.m1.37.37.6">subscript</csymbol><apply id="A1.E14.m1.34.34.3.3.2.2.1.1.2.3.2.cmml" xref="A1.E14.m1.37.37.6"><csymbol cd="ambiguous" id="A1.E14.m1.34.34.3.3.2.2.1.1.2.3.2.1.cmml" xref="A1.E14.m1.37.37.6">superscript</csymbol><ci id="A1.E14.m1.28.28.28.28.21.21.cmml" xref="A1.E14.m1.28.28.28.28.21.21">𝑊</ci><apply id="A1.E14.m1.29.29.29.29.22.22.1.cmml" xref="A1.E14.m1.29.29.29.29.22.22.1"><csymbol cd="ambiguous" id="A1.E14.m1.29.29.29.29.22.22.1.1.cmml" xref="A1.E14.m1.29.29.29.29.22.22.1">superscript</csymbol><ci id="A1.E14.m1.29.29.29.29.22.22.1.2.cmml" xref="A1.E14.m1.29.29.29.29.22.22.1.2">𝑘</ci><ci id="A1.E14.m1.29.29.29.29.22.22.1.3.cmml" xref="A1.E14.m1.29.29.29.29.22.22.1.3">′</ci></apply></apply><apply id="A1.E14.m1.30.30.30.30.23.23.1.cmml" xref="A1.E14.m1.30.30.30.30.23.23.1"><times id="A1.E14.m1.30.30.30.30.23.23.1.1.cmml" xref="A1.E14.m1.30.30.30.30.23.23.1.1"></times><ci id="A1.E14.m1.30.30.30.30.23.23.1.2.cmml" xref="A1.E14.m1.30.30.30.30.23.23.1.2">𝑟</ci><ci id="A1.E14.m1.30.30.30.30.23.23.1.3.cmml" xref="A1.E14.m1.30.30.30.30.23.23.1.3">𝑝</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.37c">\begin{split}(Q^{\prime}K^{\prime T})_{ij}&amp;=\sum_{p=1}^{d_{k}}\left(\sum_{c=1}^{d}x_{ic}W^{q^{\prime}}_{cp}\right)\left(\sum_{r=1}^{d}x_{jr}W^{k^{\prime}}_{rp}\right)\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.p12" class="ltx_para ltx_noindent">
<p id="A1.SS1.p12.1" class="ltx_p">We take the Equation <a href="#A1.E10" title="In A.1 Proof for Theorem 1 ‣ Appendix A Appendix ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> <a href="#A1.E11" title="In A.1 Proof for Theorem 1 ‣ Appendix A Appendix ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> into Equation <a href="#A1.E14" title="In A.1 Proof for Theorem 1 ‣ Appendix A Appendix ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a> and we have:</p>
<table id="A1.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E15.m1.57" class="ltx_Math" alttext="\begin{split}(Q^{\prime}K^{\prime T})_{ij}&amp;=\sum_{p=1}^{d_{k}}\left(x_{i}\cdot\vec{w}^{q}_{\pi(p)}\right)\left(x_{j}\cdot\vec{w}^{k}_{\pi(p)}\right)\\
&amp;=\sum_{p=1}^{d_{k}}\left(x_{i}\cdot\vec{w}^{q}_{p}\right)\left(x_{j}\cdot\vec{w}^{k}_{p}\right)\end{split}" display="block"><semantics id="A1.E15.m1.57a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="A1.E15.m1.57.57.10" xref="A1.E15.m1.52.52.5.cmml"><mtr id="A1.E15.m1.57.57.10a" xref="A1.E15.m1.52.52.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E15.m1.57.57.10b" xref="A1.E15.m1.52.52.5.cmml"><msub id="A1.E15.m1.53.53.6.48.28.8" xref="A1.E15.m1.52.52.5.cmml"><mrow id="A1.E15.m1.53.53.6.48.28.8.8.1" xref="A1.E15.m1.52.52.5.cmml"><mo stretchy="false" id="A1.E15.m1.1.1.1.1.1.1" xref="A1.E15.m1.52.52.5a.cmml">(</mo><mrow id="A1.E15.m1.53.53.6.48.28.8.8.1.1" xref="A1.E15.m1.52.52.5.cmml"><msup id="A1.E15.m1.53.53.6.48.28.8.8.1.1.2" xref="A1.E15.m1.52.52.5.cmml"><mi id="A1.E15.m1.2.2.2.2.2.2" xref="A1.E15.m1.2.2.2.2.2.2.cmml">Q</mi><mo id="A1.E15.m1.3.3.3.3.3.3.1" xref="A1.E15.m1.3.3.3.3.3.3.1.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.E15.m1.53.53.6.48.28.8.8.1.1.1" xref="A1.E15.m1.52.52.5a.cmml">​</mo><msup id="A1.E15.m1.53.53.6.48.28.8.8.1.1.3" xref="A1.E15.m1.52.52.5.cmml"><mi id="A1.E15.m1.4.4.4.4.4.4" xref="A1.E15.m1.4.4.4.4.4.4.cmml">K</mi><mrow id="A1.E15.m1.5.5.5.5.5.5.1.2" xref="A1.E15.m1.5.5.5.5.5.5.1.3.cmml"><mo mathsize="142%" id="A1.E15.m1.5.5.5.5.5.5.1.2.1" xref="A1.E15.m1.5.5.5.5.5.5.1.2.1.cmml">′</mo><mo lspace="0em" id="A1.E15.m1.5.5.5.5.5.5.1.2.2" xref="A1.E15.m1.5.5.5.5.5.5.1.3.cmml">⁣</mo><mi id="A1.E15.m1.5.5.5.5.5.5.1.1" xref="A1.E15.m1.5.5.5.5.5.5.1.1.cmml">T</mi></mrow></msup></mrow><mo stretchy="false" id="A1.E15.m1.6.6.6.6.6.6" xref="A1.E15.m1.52.52.5a.cmml">)</mo></mrow><mrow id="A1.E15.m1.7.7.7.7.7.7.1" xref="A1.E15.m1.7.7.7.7.7.7.1.cmml"><mi id="A1.E15.m1.7.7.7.7.7.7.1.2" xref="A1.E15.m1.7.7.7.7.7.7.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.7.7.7.7.7.7.1.1" xref="A1.E15.m1.7.7.7.7.7.7.1.1.cmml">​</mo><mi id="A1.E15.m1.7.7.7.7.7.7.1.3" xref="A1.E15.m1.7.7.7.7.7.7.1.3.cmml">j</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E15.m1.57.57.10c" xref="A1.E15.m1.52.52.5.cmml"><mrow id="A1.E15.m1.55.55.8.50.30.22" xref="A1.E15.m1.52.52.5.cmml"><mi id="A1.E15.m1.55.55.8.50.30.22.23" xref="A1.E15.m1.52.52.5a.cmml"></mi><mo rspace="0.111em" id="A1.E15.m1.8.8.8.8.1.1" xref="A1.E15.m1.8.8.8.8.1.1.cmml">=</mo><mrow id="A1.E15.m1.55.55.8.50.30.22.22" xref="A1.E15.m1.52.52.5.cmml"><munderover id="A1.E15.m1.55.55.8.50.30.22.22.3" xref="A1.E15.m1.52.52.5.cmml"><mo movablelimits="false" rspace="0em" id="A1.E15.m1.9.9.9.9.2.2" xref="A1.E15.m1.9.9.9.9.2.2.cmml">∑</mo><mrow id="A1.E15.m1.10.10.10.10.3.3.1" xref="A1.E15.m1.10.10.10.10.3.3.1.cmml"><mi id="A1.E15.m1.10.10.10.10.3.3.1.2" xref="A1.E15.m1.10.10.10.10.3.3.1.2.cmml">p</mi><mo id="A1.E15.m1.10.10.10.10.3.3.1.1" xref="A1.E15.m1.10.10.10.10.3.3.1.1.cmml">=</mo><mn id="A1.E15.m1.10.10.10.10.3.3.1.3" xref="A1.E15.m1.10.10.10.10.3.3.1.3.cmml">1</mn></mrow><msub id="A1.E15.m1.11.11.11.11.4.4.1" xref="A1.E15.m1.11.11.11.11.4.4.1.cmml"><mi id="A1.E15.m1.11.11.11.11.4.4.1.2" xref="A1.E15.m1.11.11.11.11.4.4.1.2.cmml">d</mi><mi id="A1.E15.m1.11.11.11.11.4.4.1.3" xref="A1.E15.m1.11.11.11.11.4.4.1.3.cmml">k</mi></msub></munderover><mrow id="A1.E15.m1.55.55.8.50.30.22.22.2" xref="A1.E15.m1.52.52.5.cmml"><mrow id="A1.E15.m1.54.54.7.49.29.21.21.1.1.1" xref="A1.E15.m1.52.52.5.cmml"><mo id="A1.E15.m1.12.12.12.12.5.5" xref="A1.E15.m1.52.52.5a.cmml">(</mo><mrow id="A1.E15.m1.54.54.7.49.29.21.21.1.1.1.1" xref="A1.E15.m1.52.52.5.cmml"><msub id="A1.E15.m1.54.54.7.49.29.21.21.1.1.1.1.1" xref="A1.E15.m1.52.52.5.cmml"><mi id="A1.E15.m1.13.13.13.13.6.6" xref="A1.E15.m1.13.13.13.13.6.6.cmml">x</mi><mi id="A1.E15.m1.14.14.14.14.7.7.1" xref="A1.E15.m1.14.14.14.14.7.7.1.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E15.m1.15.15.15.15.8.8" xref="A1.E15.m1.15.15.15.15.8.8.cmml">⋅</mo><msubsup id="A1.E15.m1.54.54.7.49.29.21.21.1.1.1.1.2" xref="A1.E15.m1.52.52.5.cmml"><mover accent="true" id="A1.E15.m1.16.16.16.16.9.9" xref="A1.E15.m1.16.16.16.16.9.9.cmml"><mi id="A1.E15.m1.16.16.16.16.9.9.2" xref="A1.E15.m1.16.16.16.16.9.9.2.cmml">w</mi><mo stretchy="false" id="A1.E15.m1.16.16.16.16.9.9.1" xref="A1.E15.m1.16.16.16.16.9.9.1.cmml">→</mo></mover><mrow id="A1.E15.m1.18.18.18.18.11.11.1" xref="A1.E15.m1.18.18.18.18.11.11.1.cmml"><mi id="A1.E15.m1.18.18.18.18.11.11.1.3" xref="A1.E15.m1.18.18.18.18.11.11.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.18.18.18.18.11.11.1.2" xref="A1.E15.m1.18.18.18.18.11.11.1.2.cmml">​</mo><mrow id="A1.E15.m1.18.18.18.18.11.11.1.4.2" xref="A1.E15.m1.18.18.18.18.11.11.1.cmml"><mo stretchy="false" id="A1.E15.m1.18.18.18.18.11.11.1.4.2.1" xref="A1.E15.m1.18.18.18.18.11.11.1.cmml">(</mo><mi id="A1.E15.m1.18.18.18.18.11.11.1.1" xref="A1.E15.m1.18.18.18.18.11.11.1.1.cmml">p</mi><mo stretchy="false" id="A1.E15.m1.18.18.18.18.11.11.1.4.2.2" xref="A1.E15.m1.18.18.18.18.11.11.1.cmml">)</mo></mrow></mrow><mi id="A1.E15.m1.17.17.17.17.10.10.1" xref="A1.E15.m1.17.17.17.17.10.10.1.cmml">q</mi></msubsup></mrow><mo id="A1.E15.m1.19.19.19.19.12.12" xref="A1.E15.m1.52.52.5a.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.E15.m1.55.55.8.50.30.22.22.2.3" xref="A1.E15.m1.52.52.5a.cmml">​</mo><mrow id="A1.E15.m1.55.55.8.50.30.22.22.2.2.1" xref="A1.E15.m1.52.52.5.cmml"><mo id="A1.E15.m1.20.20.20.20.13.13" xref="A1.E15.m1.52.52.5a.cmml">(</mo><mrow id="A1.E15.m1.55.55.8.50.30.22.22.2.2.1.1" xref="A1.E15.m1.52.52.5.cmml"><msub id="A1.E15.m1.55.55.8.50.30.22.22.2.2.1.1.1" xref="A1.E15.m1.52.52.5.cmml"><mi id="A1.E15.m1.21.21.21.21.14.14" xref="A1.E15.m1.21.21.21.21.14.14.cmml">x</mi><mi id="A1.E15.m1.22.22.22.22.15.15.1" xref="A1.E15.m1.22.22.22.22.15.15.1.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E15.m1.23.23.23.23.16.16" xref="A1.E15.m1.23.23.23.23.16.16.cmml">⋅</mo><msubsup id="A1.E15.m1.55.55.8.50.30.22.22.2.2.1.1.2" xref="A1.E15.m1.52.52.5.cmml"><mover accent="true" id="A1.E15.m1.24.24.24.24.17.17" xref="A1.E15.m1.24.24.24.24.17.17.cmml"><mi id="A1.E15.m1.24.24.24.24.17.17.2" xref="A1.E15.m1.24.24.24.24.17.17.2.cmml">w</mi><mo stretchy="false" id="A1.E15.m1.24.24.24.24.17.17.1" xref="A1.E15.m1.24.24.24.24.17.17.1.cmml">→</mo></mover><mrow id="A1.E15.m1.26.26.26.26.19.19.1" xref="A1.E15.m1.26.26.26.26.19.19.1.cmml"><mi id="A1.E15.m1.26.26.26.26.19.19.1.3" xref="A1.E15.m1.26.26.26.26.19.19.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.E15.m1.26.26.26.26.19.19.1.2" xref="A1.E15.m1.26.26.26.26.19.19.1.2.cmml">​</mo><mrow id="A1.E15.m1.26.26.26.26.19.19.1.4.2" xref="A1.E15.m1.26.26.26.26.19.19.1.cmml"><mo stretchy="false" id="A1.E15.m1.26.26.26.26.19.19.1.4.2.1" xref="A1.E15.m1.26.26.26.26.19.19.1.cmml">(</mo><mi id="A1.E15.m1.26.26.26.26.19.19.1.1" xref="A1.E15.m1.26.26.26.26.19.19.1.1.cmml">p</mi><mo stretchy="false" id="A1.E15.m1.26.26.26.26.19.19.1.4.2.2" xref="A1.E15.m1.26.26.26.26.19.19.1.cmml">)</mo></mrow></mrow><mi id="A1.E15.m1.25.25.25.25.18.18.1" xref="A1.E15.m1.25.25.25.25.18.18.1.cmml">k</mi></msubsup></mrow><mo id="A1.E15.m1.27.27.27.27.20.20" xref="A1.E15.m1.52.52.5a.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E15.m1.57.57.10d" xref="A1.E15.m1.52.52.5.cmml"><mtd id="A1.E15.m1.57.57.10e" xref="A1.E15.m1.52.52.5a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E15.m1.57.57.10f" xref="A1.E15.m1.52.52.5.cmml"><mrow id="A1.E15.m1.57.57.10.52.22.22" xref="A1.E15.m1.52.52.5.cmml"><mi id="A1.E15.m1.57.57.10.52.22.22.23" xref="A1.E15.m1.52.52.5a.cmml"></mi><mo rspace="0.111em" id="A1.E15.m1.28.28.28.1.1.1" xref="A1.E15.m1.28.28.28.1.1.1.cmml">=</mo><mrow id="A1.E15.m1.57.57.10.52.22.22.22" xref="A1.E15.m1.52.52.5.cmml"><munderover id="A1.E15.m1.57.57.10.52.22.22.22.3" xref="A1.E15.m1.52.52.5.cmml"><mo movablelimits="false" rspace="0em" id="A1.E15.m1.29.29.29.2.2.2" xref="A1.E15.m1.29.29.29.2.2.2.cmml">∑</mo><mrow id="A1.E15.m1.30.30.30.3.3.3.1" xref="A1.E15.m1.30.30.30.3.3.3.1.cmml"><mi id="A1.E15.m1.30.30.30.3.3.3.1.2" xref="A1.E15.m1.30.30.30.3.3.3.1.2.cmml">p</mi><mo id="A1.E15.m1.30.30.30.3.3.3.1.1" xref="A1.E15.m1.30.30.30.3.3.3.1.1.cmml">=</mo><mn id="A1.E15.m1.30.30.30.3.3.3.1.3" xref="A1.E15.m1.30.30.30.3.3.3.1.3.cmml">1</mn></mrow><msub id="A1.E15.m1.31.31.31.4.4.4.1" xref="A1.E15.m1.31.31.31.4.4.4.1.cmml"><mi id="A1.E15.m1.31.31.31.4.4.4.1.2" xref="A1.E15.m1.31.31.31.4.4.4.1.2.cmml">d</mi><mi id="A1.E15.m1.31.31.31.4.4.4.1.3" xref="A1.E15.m1.31.31.31.4.4.4.1.3.cmml">k</mi></msub></munderover><mrow id="A1.E15.m1.57.57.10.52.22.22.22.2" xref="A1.E15.m1.52.52.5.cmml"><mrow id="A1.E15.m1.56.56.9.51.21.21.21.1.1.1" xref="A1.E15.m1.52.52.5.cmml"><mo id="A1.E15.m1.32.32.32.5.5.5" xref="A1.E15.m1.52.52.5a.cmml">(</mo><mrow id="A1.E15.m1.56.56.9.51.21.21.21.1.1.1.1" xref="A1.E15.m1.52.52.5.cmml"><msub id="A1.E15.m1.56.56.9.51.21.21.21.1.1.1.1.1" xref="A1.E15.m1.52.52.5.cmml"><mi id="A1.E15.m1.33.33.33.6.6.6" xref="A1.E15.m1.33.33.33.6.6.6.cmml">x</mi><mi id="A1.E15.m1.34.34.34.7.7.7.1" xref="A1.E15.m1.34.34.34.7.7.7.1.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E15.m1.35.35.35.8.8.8" xref="A1.E15.m1.35.35.35.8.8.8.cmml">⋅</mo><msubsup id="A1.E15.m1.56.56.9.51.21.21.21.1.1.1.1.2" xref="A1.E15.m1.52.52.5.cmml"><mover accent="true" id="A1.E15.m1.36.36.36.9.9.9" xref="A1.E15.m1.36.36.36.9.9.9.cmml"><mi id="A1.E15.m1.36.36.36.9.9.9.2" xref="A1.E15.m1.36.36.36.9.9.9.2.cmml">w</mi><mo stretchy="false" id="A1.E15.m1.36.36.36.9.9.9.1" xref="A1.E15.m1.36.36.36.9.9.9.1.cmml">→</mo></mover><mi id="A1.E15.m1.38.38.38.11.11.11.1" xref="A1.E15.m1.38.38.38.11.11.11.1.cmml">p</mi><mi id="A1.E15.m1.37.37.37.10.10.10.1" xref="A1.E15.m1.37.37.37.10.10.10.1.cmml">q</mi></msubsup></mrow><mo id="A1.E15.m1.39.39.39.12.12.12" xref="A1.E15.m1.52.52.5a.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.E15.m1.57.57.10.52.22.22.22.2.3" xref="A1.E15.m1.52.52.5a.cmml">​</mo><mrow id="A1.E15.m1.57.57.10.52.22.22.22.2.2.1" xref="A1.E15.m1.52.52.5.cmml"><mo id="A1.E15.m1.40.40.40.13.13.13" xref="A1.E15.m1.52.52.5a.cmml">(</mo><mrow id="A1.E15.m1.57.57.10.52.22.22.22.2.2.1.1" xref="A1.E15.m1.52.52.5.cmml"><msub id="A1.E15.m1.57.57.10.52.22.22.22.2.2.1.1.1" xref="A1.E15.m1.52.52.5.cmml"><mi id="A1.E15.m1.41.41.41.14.14.14" xref="A1.E15.m1.41.41.41.14.14.14.cmml">x</mi><mi id="A1.E15.m1.42.42.42.15.15.15.1" xref="A1.E15.m1.42.42.42.15.15.15.1.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E15.m1.43.43.43.16.16.16" xref="A1.E15.m1.43.43.43.16.16.16.cmml">⋅</mo><msubsup id="A1.E15.m1.57.57.10.52.22.22.22.2.2.1.1.2" xref="A1.E15.m1.52.52.5.cmml"><mover accent="true" id="A1.E15.m1.44.44.44.17.17.17" xref="A1.E15.m1.44.44.44.17.17.17.cmml"><mi id="A1.E15.m1.44.44.44.17.17.17.2" xref="A1.E15.m1.44.44.44.17.17.17.2.cmml">w</mi><mo stretchy="false" id="A1.E15.m1.44.44.44.17.17.17.1" xref="A1.E15.m1.44.44.44.17.17.17.1.cmml">→</mo></mover><mi id="A1.E15.m1.46.46.46.19.19.19.1" xref="A1.E15.m1.46.46.46.19.19.19.1.cmml">p</mi><mi id="A1.E15.m1.45.45.45.18.18.18.1" xref="A1.E15.m1.45.45.45.18.18.18.1.cmml">k</mi></msubsup></mrow><mo id="A1.E15.m1.47.47.47.20.20.20" xref="A1.E15.m1.52.52.5a.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E15.m1.57b"><apply id="A1.E15.m1.52.52.5.cmml" xref="A1.E15.m1.57.57.10"><and id="A1.E15.m1.52.52.5a.cmml" xref="A1.E15.m1.1.1.1.1.1.1"></and><apply id="A1.E15.m1.52.52.5b.cmml" xref="A1.E15.m1.57.57.10"><eq id="A1.E15.m1.8.8.8.8.1.1.cmml" xref="A1.E15.m1.8.8.8.8.1.1"></eq><apply id="A1.E15.m1.48.48.1.1.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.48.48.1.1.2.cmml" xref="A1.E15.m1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E15.m1.48.48.1.1.1.1.1.cmml" xref="A1.E15.m1.57.57.10"><times id="A1.E15.m1.48.48.1.1.1.1.1.1.cmml" xref="A1.E15.m1.57.57.10"></times><apply id="A1.E15.m1.48.48.1.1.1.1.1.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.48.48.1.1.1.1.1.2.1.cmml" xref="A1.E15.m1.57.57.10">superscript</csymbol><ci id="A1.E15.m1.2.2.2.2.2.2.cmml" xref="A1.E15.m1.2.2.2.2.2.2">𝑄</ci><ci id="A1.E15.m1.3.3.3.3.3.3.1.cmml" xref="A1.E15.m1.3.3.3.3.3.3.1">′</ci></apply><apply id="A1.E15.m1.48.48.1.1.1.1.1.3.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.48.48.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.57.57.10">superscript</csymbol><ci id="A1.E15.m1.4.4.4.4.4.4.cmml" xref="A1.E15.m1.4.4.4.4.4.4">𝐾</ci><list id="A1.E15.m1.5.5.5.5.5.5.1.3.cmml" xref="A1.E15.m1.5.5.5.5.5.5.1.2"><ci id="A1.E15.m1.5.5.5.5.5.5.1.2.1.cmml" xref="A1.E15.m1.5.5.5.5.5.5.1.2.1">′</ci><ci id="A1.E15.m1.5.5.5.5.5.5.1.1.cmml" xref="A1.E15.m1.5.5.5.5.5.5.1.1">𝑇</ci></list></apply></apply><apply id="A1.E15.m1.7.7.7.7.7.7.1.cmml" xref="A1.E15.m1.7.7.7.7.7.7.1"><times id="A1.E15.m1.7.7.7.7.7.7.1.1.cmml" xref="A1.E15.m1.7.7.7.7.7.7.1.1"></times><ci id="A1.E15.m1.7.7.7.7.7.7.1.2.cmml" xref="A1.E15.m1.7.7.7.7.7.7.1.2">𝑖</ci><ci id="A1.E15.m1.7.7.7.7.7.7.1.3.cmml" xref="A1.E15.m1.7.7.7.7.7.7.1.3">𝑗</ci></apply></apply><apply id="A1.E15.m1.50.50.3.3.cmml" xref="A1.E15.m1.57.57.10"><apply id="A1.E15.m1.50.50.3.3.3.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.50.50.3.3.3.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E15.m1.50.50.3.3.3.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.50.50.3.3.3.2.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E15.m1.9.9.9.9.2.2.cmml" xref="A1.E15.m1.9.9.9.9.2.2"></sum><apply id="A1.E15.m1.10.10.10.10.3.3.1.cmml" xref="A1.E15.m1.10.10.10.10.3.3.1"><eq id="A1.E15.m1.10.10.10.10.3.3.1.1.cmml" xref="A1.E15.m1.10.10.10.10.3.3.1.1"></eq><ci id="A1.E15.m1.10.10.10.10.3.3.1.2.cmml" xref="A1.E15.m1.10.10.10.10.3.3.1.2">𝑝</ci><cn type="integer" id="A1.E15.m1.10.10.10.10.3.3.1.3.cmml" xref="A1.E15.m1.10.10.10.10.3.3.1.3">1</cn></apply></apply><apply id="A1.E15.m1.11.11.11.11.4.4.1.cmml" xref="A1.E15.m1.11.11.11.11.4.4.1"><csymbol cd="ambiguous" id="A1.E15.m1.11.11.11.11.4.4.1.1.cmml" xref="A1.E15.m1.11.11.11.11.4.4.1">subscript</csymbol><ci id="A1.E15.m1.11.11.11.11.4.4.1.2.cmml" xref="A1.E15.m1.11.11.11.11.4.4.1.2">𝑑</ci><ci id="A1.E15.m1.11.11.11.11.4.4.1.3.cmml" xref="A1.E15.m1.11.11.11.11.4.4.1.3">𝑘</ci></apply></apply><apply id="A1.E15.m1.50.50.3.3.2.cmml" xref="A1.E15.m1.57.57.10"><times id="A1.E15.m1.50.50.3.3.2.3.cmml" xref="A1.E15.m1.1.1.1.1.1.1"></times><apply id="A1.E15.m1.49.49.2.2.1.1.1.1.cmml" xref="A1.E15.m1.57.57.10"><ci id="A1.E15.m1.15.15.15.15.8.8.cmml" xref="A1.E15.m1.15.15.15.15.8.8">⋅</ci><apply id="A1.E15.m1.49.49.2.2.1.1.1.1.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.49.49.2.2.1.1.1.1.2.1.cmml" xref="A1.E15.m1.57.57.10">subscript</csymbol><ci id="A1.E15.m1.13.13.13.13.6.6.cmml" xref="A1.E15.m1.13.13.13.13.6.6">𝑥</ci><ci id="A1.E15.m1.14.14.14.14.7.7.1.cmml" xref="A1.E15.m1.14.14.14.14.7.7.1">𝑖</ci></apply><apply id="A1.E15.m1.49.49.2.2.1.1.1.1.3.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.49.49.2.2.1.1.1.1.3.1.cmml" xref="A1.E15.m1.57.57.10">subscript</csymbol><apply id="A1.E15.m1.49.49.2.2.1.1.1.1.3.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.49.49.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E15.m1.57.57.10">superscript</csymbol><apply id="A1.E15.m1.16.16.16.16.9.9.cmml" xref="A1.E15.m1.16.16.16.16.9.9"><ci id="A1.E15.m1.16.16.16.16.9.9.1.cmml" xref="A1.E15.m1.16.16.16.16.9.9.1">→</ci><ci id="A1.E15.m1.16.16.16.16.9.9.2.cmml" xref="A1.E15.m1.16.16.16.16.9.9.2">𝑤</ci></apply><ci id="A1.E15.m1.17.17.17.17.10.10.1.cmml" xref="A1.E15.m1.17.17.17.17.10.10.1">𝑞</ci></apply><apply id="A1.E15.m1.18.18.18.18.11.11.1.cmml" xref="A1.E15.m1.18.18.18.18.11.11.1"><times id="A1.E15.m1.18.18.18.18.11.11.1.2.cmml" xref="A1.E15.m1.18.18.18.18.11.11.1.2"></times><ci id="A1.E15.m1.18.18.18.18.11.11.1.3.cmml" xref="A1.E15.m1.18.18.18.18.11.11.1.3">𝜋</ci><ci id="A1.E15.m1.18.18.18.18.11.11.1.1.cmml" xref="A1.E15.m1.18.18.18.18.11.11.1.1">𝑝</ci></apply></apply></apply><apply id="A1.E15.m1.50.50.3.3.2.2.1.1.cmml" xref="A1.E15.m1.57.57.10"><ci id="A1.E15.m1.23.23.23.23.16.16.cmml" xref="A1.E15.m1.23.23.23.23.16.16">⋅</ci><apply id="A1.E15.m1.50.50.3.3.2.2.1.1.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.50.50.3.3.2.2.1.1.2.1.cmml" xref="A1.E15.m1.57.57.10">subscript</csymbol><ci id="A1.E15.m1.21.21.21.21.14.14.cmml" xref="A1.E15.m1.21.21.21.21.14.14">𝑥</ci><ci id="A1.E15.m1.22.22.22.22.15.15.1.cmml" xref="A1.E15.m1.22.22.22.22.15.15.1">𝑗</ci></apply><apply id="A1.E15.m1.50.50.3.3.2.2.1.1.3.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.50.50.3.3.2.2.1.1.3.1.cmml" xref="A1.E15.m1.57.57.10">subscript</csymbol><apply id="A1.E15.m1.50.50.3.3.2.2.1.1.3.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.50.50.3.3.2.2.1.1.3.2.1.cmml" xref="A1.E15.m1.57.57.10">superscript</csymbol><apply id="A1.E15.m1.24.24.24.24.17.17.cmml" xref="A1.E15.m1.24.24.24.24.17.17"><ci id="A1.E15.m1.24.24.24.24.17.17.1.cmml" xref="A1.E15.m1.24.24.24.24.17.17.1">→</ci><ci id="A1.E15.m1.24.24.24.24.17.17.2.cmml" xref="A1.E15.m1.24.24.24.24.17.17.2">𝑤</ci></apply><ci id="A1.E15.m1.25.25.25.25.18.18.1.cmml" xref="A1.E15.m1.25.25.25.25.18.18.1">𝑘</ci></apply><apply id="A1.E15.m1.26.26.26.26.19.19.1.cmml" xref="A1.E15.m1.26.26.26.26.19.19.1"><times id="A1.E15.m1.26.26.26.26.19.19.1.2.cmml" xref="A1.E15.m1.26.26.26.26.19.19.1.2"></times><ci id="A1.E15.m1.26.26.26.26.19.19.1.3.cmml" xref="A1.E15.m1.26.26.26.26.19.19.1.3">𝜋</ci><ci id="A1.E15.m1.26.26.26.26.19.19.1.1.cmml" xref="A1.E15.m1.26.26.26.26.19.19.1.1">𝑝</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E15.m1.52.52.5c.cmml" xref="A1.E15.m1.57.57.10"><eq id="A1.E15.m1.28.28.28.1.1.1.cmml" xref="A1.E15.m1.28.28.28.1.1.1"></eq><share href="#A1.E15.m1.50.50.3.3.cmml" id="A1.E15.m1.52.52.5d.cmml" xref="A1.E15.m1.1.1.1.1.1.1"></share><apply id="A1.E15.m1.52.52.5.5.cmml" xref="A1.E15.m1.57.57.10"><apply id="A1.E15.m1.52.52.5.5.3.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.52.52.5.5.3.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E15.m1.52.52.5.5.3.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.52.52.5.5.3.2.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E15.m1.29.29.29.2.2.2.cmml" xref="A1.E15.m1.29.29.29.2.2.2"></sum><apply id="A1.E15.m1.30.30.30.3.3.3.1.cmml" xref="A1.E15.m1.30.30.30.3.3.3.1"><eq id="A1.E15.m1.30.30.30.3.3.3.1.1.cmml" xref="A1.E15.m1.30.30.30.3.3.3.1.1"></eq><ci id="A1.E15.m1.30.30.30.3.3.3.1.2.cmml" xref="A1.E15.m1.30.30.30.3.3.3.1.2">𝑝</ci><cn type="integer" id="A1.E15.m1.30.30.30.3.3.3.1.3.cmml" xref="A1.E15.m1.30.30.30.3.3.3.1.3">1</cn></apply></apply><apply id="A1.E15.m1.31.31.31.4.4.4.1.cmml" xref="A1.E15.m1.31.31.31.4.4.4.1"><csymbol cd="ambiguous" id="A1.E15.m1.31.31.31.4.4.4.1.1.cmml" xref="A1.E15.m1.31.31.31.4.4.4.1">subscript</csymbol><ci id="A1.E15.m1.31.31.31.4.4.4.1.2.cmml" xref="A1.E15.m1.31.31.31.4.4.4.1.2">𝑑</ci><ci id="A1.E15.m1.31.31.31.4.4.4.1.3.cmml" xref="A1.E15.m1.31.31.31.4.4.4.1.3">𝑘</ci></apply></apply><apply id="A1.E15.m1.52.52.5.5.2.cmml" xref="A1.E15.m1.57.57.10"><times id="A1.E15.m1.52.52.5.5.2.3.cmml" xref="A1.E15.m1.1.1.1.1.1.1"></times><apply id="A1.E15.m1.51.51.4.4.1.1.1.1.cmml" xref="A1.E15.m1.57.57.10"><ci id="A1.E15.m1.35.35.35.8.8.8.cmml" xref="A1.E15.m1.35.35.35.8.8.8">⋅</ci><apply id="A1.E15.m1.51.51.4.4.1.1.1.1.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.51.51.4.4.1.1.1.1.2.1.cmml" xref="A1.E15.m1.57.57.10">subscript</csymbol><ci id="A1.E15.m1.33.33.33.6.6.6.cmml" xref="A1.E15.m1.33.33.33.6.6.6">𝑥</ci><ci id="A1.E15.m1.34.34.34.7.7.7.1.cmml" xref="A1.E15.m1.34.34.34.7.7.7.1">𝑖</ci></apply><apply id="A1.E15.m1.51.51.4.4.1.1.1.1.3.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.51.51.4.4.1.1.1.1.3.1.cmml" xref="A1.E15.m1.57.57.10">subscript</csymbol><apply id="A1.E15.m1.51.51.4.4.1.1.1.1.3.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.51.51.4.4.1.1.1.1.3.2.1.cmml" xref="A1.E15.m1.57.57.10">superscript</csymbol><apply id="A1.E15.m1.36.36.36.9.9.9.cmml" xref="A1.E15.m1.36.36.36.9.9.9"><ci id="A1.E15.m1.36.36.36.9.9.9.1.cmml" xref="A1.E15.m1.36.36.36.9.9.9.1">→</ci><ci id="A1.E15.m1.36.36.36.9.9.9.2.cmml" xref="A1.E15.m1.36.36.36.9.9.9.2">𝑤</ci></apply><ci id="A1.E15.m1.37.37.37.10.10.10.1.cmml" xref="A1.E15.m1.37.37.37.10.10.10.1">𝑞</ci></apply><ci id="A1.E15.m1.38.38.38.11.11.11.1.cmml" xref="A1.E15.m1.38.38.38.11.11.11.1">𝑝</ci></apply></apply><apply id="A1.E15.m1.52.52.5.5.2.2.1.1.cmml" xref="A1.E15.m1.57.57.10"><ci id="A1.E15.m1.43.43.43.16.16.16.cmml" xref="A1.E15.m1.43.43.43.16.16.16">⋅</ci><apply id="A1.E15.m1.52.52.5.5.2.2.1.1.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.52.52.5.5.2.2.1.1.2.1.cmml" xref="A1.E15.m1.57.57.10">subscript</csymbol><ci id="A1.E15.m1.41.41.41.14.14.14.cmml" xref="A1.E15.m1.41.41.41.14.14.14">𝑥</ci><ci id="A1.E15.m1.42.42.42.15.15.15.1.cmml" xref="A1.E15.m1.42.42.42.15.15.15.1">𝑗</ci></apply><apply id="A1.E15.m1.52.52.5.5.2.2.1.1.3.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.52.52.5.5.2.2.1.1.3.1.cmml" xref="A1.E15.m1.57.57.10">subscript</csymbol><apply id="A1.E15.m1.52.52.5.5.2.2.1.1.3.2.cmml" xref="A1.E15.m1.57.57.10"><csymbol cd="ambiguous" id="A1.E15.m1.52.52.5.5.2.2.1.1.3.2.1.cmml" xref="A1.E15.m1.57.57.10">superscript</csymbol><apply id="A1.E15.m1.44.44.44.17.17.17.cmml" xref="A1.E15.m1.44.44.44.17.17.17"><ci id="A1.E15.m1.44.44.44.17.17.17.1.cmml" xref="A1.E15.m1.44.44.44.17.17.17.1">→</ci><ci id="A1.E15.m1.44.44.44.17.17.17.2.cmml" xref="A1.E15.m1.44.44.44.17.17.17.2">𝑤</ci></apply><ci id="A1.E15.m1.45.45.45.18.18.18.1.cmml" xref="A1.E15.m1.45.45.45.18.18.18.1">𝑘</ci></apply><ci id="A1.E15.m1.46.46.46.19.19.19.1.cmml" xref="A1.E15.m1.46.46.46.19.19.19.1">𝑝</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.57c">\begin{split}(Q^{\prime}K^{\prime T})_{ij}&amp;=\sum_{p=1}^{d_{k}}\left(x_{i}\cdot\vec{w}^{q}_{\pi(p)}\right)\left(x_{j}\cdot\vec{w}^{k}_{\pi(p)}\right)\\
&amp;=\sum_{p=1}^{d_{k}}\left(x_{i}\cdot\vec{w}^{q}_{p}\right)\left(x_{j}\cdot\vec{w}^{k}_{p}\right)\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.p13" class="ltx_para ltx_noindent">
<p id="A1.SS1.p13.6" class="ltx_p">Because the permutation <math id="A1.SS1.p13.1.m1.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="A1.SS1.p13.1.m1.1a"><mi id="A1.SS1.p13.1.m1.1.1" xref="A1.SS1.p13.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p13.1.m1.1b"><ci id="A1.SS1.p13.1.m1.1.1.cmml" xref="A1.SS1.p13.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p13.1.m1.1c">\pi</annotation></semantics></math> is applied consistently to both <math id="A1.SS1.p13.2.m2.1" class="ltx_Math" alttext="W^{q}" display="inline"><semantics id="A1.SS1.p13.2.m2.1a"><msup id="A1.SS1.p13.2.m2.1.1" xref="A1.SS1.p13.2.m2.1.1.cmml"><mi id="A1.SS1.p13.2.m2.1.1.2" xref="A1.SS1.p13.2.m2.1.1.2.cmml">W</mi><mi id="A1.SS1.p13.2.m2.1.1.3" xref="A1.SS1.p13.2.m2.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p13.2.m2.1b"><apply id="A1.SS1.p13.2.m2.1.1.cmml" xref="A1.SS1.p13.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p13.2.m2.1.1.1.cmml" xref="A1.SS1.p13.2.m2.1.1">superscript</csymbol><ci id="A1.SS1.p13.2.m2.1.1.2.cmml" xref="A1.SS1.p13.2.m2.1.1.2">𝑊</ci><ci id="A1.SS1.p13.2.m2.1.1.3.cmml" xref="A1.SS1.p13.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p13.2.m2.1c">W^{q}</annotation></semantics></math> and <math id="A1.SS1.p13.3.m3.1" class="ltx_Math" alttext="W^{k}" display="inline"><semantics id="A1.SS1.p13.3.m3.1a"><msup id="A1.SS1.p13.3.m3.1.1" xref="A1.SS1.p13.3.m3.1.1.cmml"><mi id="A1.SS1.p13.3.m3.1.1.2" xref="A1.SS1.p13.3.m3.1.1.2.cmml">W</mi><mi id="A1.SS1.p13.3.m3.1.1.3" xref="A1.SS1.p13.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p13.3.m3.1b"><apply id="A1.SS1.p13.3.m3.1.1.cmml" xref="A1.SS1.p13.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p13.3.m3.1.1.1.cmml" xref="A1.SS1.p13.3.m3.1.1">superscript</csymbol><ci id="A1.SS1.p13.3.m3.1.1.2.cmml" xref="A1.SS1.p13.3.m3.1.1.2">𝑊</ci><ci id="A1.SS1.p13.3.m3.1.1.3.cmml" xref="A1.SS1.p13.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p13.3.m3.1c">W^{k}</annotation></semantics></math>, and the dot product operation is commutative, each term of the form <math id="A1.SS1.p13.4.m4.1" class="ltx_Math" alttext="x_{i}\cdot W^{q^{\prime}}_{\pi(p)}" display="inline"><semantics id="A1.SS1.p13.4.m4.1a"><mrow id="A1.SS1.p13.4.m4.1.2" xref="A1.SS1.p13.4.m4.1.2.cmml"><msub id="A1.SS1.p13.4.m4.1.2.2" xref="A1.SS1.p13.4.m4.1.2.2.cmml"><mi id="A1.SS1.p13.4.m4.1.2.2.2" xref="A1.SS1.p13.4.m4.1.2.2.2.cmml">x</mi><mi id="A1.SS1.p13.4.m4.1.2.2.3" xref="A1.SS1.p13.4.m4.1.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p13.4.m4.1.2.1" xref="A1.SS1.p13.4.m4.1.2.1.cmml">⋅</mo><msubsup id="A1.SS1.p13.4.m4.1.2.3" xref="A1.SS1.p13.4.m4.1.2.3.cmml"><mi id="A1.SS1.p13.4.m4.1.2.3.2.2" xref="A1.SS1.p13.4.m4.1.2.3.2.2.cmml">W</mi><mrow id="A1.SS1.p13.4.m4.1.1.1" xref="A1.SS1.p13.4.m4.1.1.1.cmml"><mi id="A1.SS1.p13.4.m4.1.1.1.3" xref="A1.SS1.p13.4.m4.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p13.4.m4.1.1.1.2" xref="A1.SS1.p13.4.m4.1.1.1.2.cmml">​</mo><mrow id="A1.SS1.p13.4.m4.1.1.1.4.2" xref="A1.SS1.p13.4.m4.1.1.1.cmml"><mo stretchy="false" id="A1.SS1.p13.4.m4.1.1.1.4.2.1" xref="A1.SS1.p13.4.m4.1.1.1.cmml">(</mo><mi id="A1.SS1.p13.4.m4.1.1.1.1" xref="A1.SS1.p13.4.m4.1.1.1.1.cmml">p</mi><mo stretchy="false" id="A1.SS1.p13.4.m4.1.1.1.4.2.2" xref="A1.SS1.p13.4.m4.1.1.1.cmml">)</mo></mrow></mrow><msup id="A1.SS1.p13.4.m4.1.2.3.2.3" xref="A1.SS1.p13.4.m4.1.2.3.2.3.cmml"><mi id="A1.SS1.p13.4.m4.1.2.3.2.3.2" xref="A1.SS1.p13.4.m4.1.2.3.2.3.2.cmml">q</mi><mo id="A1.SS1.p13.4.m4.1.2.3.2.3.3" xref="A1.SS1.p13.4.m4.1.2.3.2.3.3.cmml">′</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p13.4.m4.1b"><apply id="A1.SS1.p13.4.m4.1.2.cmml" xref="A1.SS1.p13.4.m4.1.2"><ci id="A1.SS1.p13.4.m4.1.2.1.cmml" xref="A1.SS1.p13.4.m4.1.2.1">⋅</ci><apply id="A1.SS1.p13.4.m4.1.2.2.cmml" xref="A1.SS1.p13.4.m4.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p13.4.m4.1.2.2.1.cmml" xref="A1.SS1.p13.4.m4.1.2.2">subscript</csymbol><ci id="A1.SS1.p13.4.m4.1.2.2.2.cmml" xref="A1.SS1.p13.4.m4.1.2.2.2">𝑥</ci><ci id="A1.SS1.p13.4.m4.1.2.2.3.cmml" xref="A1.SS1.p13.4.m4.1.2.2.3">𝑖</ci></apply><apply id="A1.SS1.p13.4.m4.1.2.3.cmml" xref="A1.SS1.p13.4.m4.1.2.3"><csymbol cd="ambiguous" id="A1.SS1.p13.4.m4.1.2.3.1.cmml" xref="A1.SS1.p13.4.m4.1.2.3">subscript</csymbol><apply id="A1.SS1.p13.4.m4.1.2.3.2.cmml" xref="A1.SS1.p13.4.m4.1.2.3"><csymbol cd="ambiguous" id="A1.SS1.p13.4.m4.1.2.3.2.1.cmml" xref="A1.SS1.p13.4.m4.1.2.3">superscript</csymbol><ci id="A1.SS1.p13.4.m4.1.2.3.2.2.cmml" xref="A1.SS1.p13.4.m4.1.2.3.2.2">𝑊</ci><apply id="A1.SS1.p13.4.m4.1.2.3.2.3.cmml" xref="A1.SS1.p13.4.m4.1.2.3.2.3"><csymbol cd="ambiguous" id="A1.SS1.p13.4.m4.1.2.3.2.3.1.cmml" xref="A1.SS1.p13.4.m4.1.2.3.2.3">superscript</csymbol><ci id="A1.SS1.p13.4.m4.1.2.3.2.3.2.cmml" xref="A1.SS1.p13.4.m4.1.2.3.2.3.2">𝑞</ci><ci id="A1.SS1.p13.4.m4.1.2.3.2.3.3.cmml" xref="A1.SS1.p13.4.m4.1.2.3.2.3.3">′</ci></apply></apply><apply id="A1.SS1.p13.4.m4.1.1.1.cmml" xref="A1.SS1.p13.4.m4.1.1.1"><times id="A1.SS1.p13.4.m4.1.1.1.2.cmml" xref="A1.SS1.p13.4.m4.1.1.1.2"></times><ci id="A1.SS1.p13.4.m4.1.1.1.3.cmml" xref="A1.SS1.p13.4.m4.1.1.1.3">𝜋</ci><ci id="A1.SS1.p13.4.m4.1.1.1.1.cmml" xref="A1.SS1.p13.4.m4.1.1.1.1">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p13.4.m4.1c">x_{i}\cdot W^{q^{\prime}}_{\pi(p)}</annotation></semantics></math> will correspond to a term of the form <math id="A1.SS1.p13.5.m5.1" class="ltx_Math" alttext="x_{j}\cdot W^{k^{\prime}}_{\pi(p)}" display="inline"><semantics id="A1.SS1.p13.5.m5.1a"><mrow id="A1.SS1.p13.5.m5.1.2" xref="A1.SS1.p13.5.m5.1.2.cmml"><msub id="A1.SS1.p13.5.m5.1.2.2" xref="A1.SS1.p13.5.m5.1.2.2.cmml"><mi id="A1.SS1.p13.5.m5.1.2.2.2" xref="A1.SS1.p13.5.m5.1.2.2.2.cmml">x</mi><mi id="A1.SS1.p13.5.m5.1.2.2.3" xref="A1.SS1.p13.5.m5.1.2.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p13.5.m5.1.2.1" xref="A1.SS1.p13.5.m5.1.2.1.cmml">⋅</mo><msubsup id="A1.SS1.p13.5.m5.1.2.3" xref="A1.SS1.p13.5.m5.1.2.3.cmml"><mi id="A1.SS1.p13.5.m5.1.2.3.2.2" xref="A1.SS1.p13.5.m5.1.2.3.2.2.cmml">W</mi><mrow id="A1.SS1.p13.5.m5.1.1.1" xref="A1.SS1.p13.5.m5.1.1.1.cmml"><mi id="A1.SS1.p13.5.m5.1.1.1.3" xref="A1.SS1.p13.5.m5.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p13.5.m5.1.1.1.2" xref="A1.SS1.p13.5.m5.1.1.1.2.cmml">​</mo><mrow id="A1.SS1.p13.5.m5.1.1.1.4.2" xref="A1.SS1.p13.5.m5.1.1.1.cmml"><mo stretchy="false" id="A1.SS1.p13.5.m5.1.1.1.4.2.1" xref="A1.SS1.p13.5.m5.1.1.1.cmml">(</mo><mi id="A1.SS1.p13.5.m5.1.1.1.1" xref="A1.SS1.p13.5.m5.1.1.1.1.cmml">p</mi><mo stretchy="false" id="A1.SS1.p13.5.m5.1.1.1.4.2.2" xref="A1.SS1.p13.5.m5.1.1.1.cmml">)</mo></mrow></mrow><msup id="A1.SS1.p13.5.m5.1.2.3.2.3" xref="A1.SS1.p13.5.m5.1.2.3.2.3.cmml"><mi id="A1.SS1.p13.5.m5.1.2.3.2.3.2" xref="A1.SS1.p13.5.m5.1.2.3.2.3.2.cmml">k</mi><mo id="A1.SS1.p13.5.m5.1.2.3.2.3.3" xref="A1.SS1.p13.5.m5.1.2.3.2.3.3.cmml">′</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p13.5.m5.1b"><apply id="A1.SS1.p13.5.m5.1.2.cmml" xref="A1.SS1.p13.5.m5.1.2"><ci id="A1.SS1.p13.5.m5.1.2.1.cmml" xref="A1.SS1.p13.5.m5.1.2.1">⋅</ci><apply id="A1.SS1.p13.5.m5.1.2.2.cmml" xref="A1.SS1.p13.5.m5.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p13.5.m5.1.2.2.1.cmml" xref="A1.SS1.p13.5.m5.1.2.2">subscript</csymbol><ci id="A1.SS1.p13.5.m5.1.2.2.2.cmml" xref="A1.SS1.p13.5.m5.1.2.2.2">𝑥</ci><ci id="A1.SS1.p13.5.m5.1.2.2.3.cmml" xref="A1.SS1.p13.5.m5.1.2.2.3">𝑗</ci></apply><apply id="A1.SS1.p13.5.m5.1.2.3.cmml" xref="A1.SS1.p13.5.m5.1.2.3"><csymbol cd="ambiguous" id="A1.SS1.p13.5.m5.1.2.3.1.cmml" xref="A1.SS1.p13.5.m5.1.2.3">subscript</csymbol><apply id="A1.SS1.p13.5.m5.1.2.3.2.cmml" xref="A1.SS1.p13.5.m5.1.2.3"><csymbol cd="ambiguous" id="A1.SS1.p13.5.m5.1.2.3.2.1.cmml" xref="A1.SS1.p13.5.m5.1.2.3">superscript</csymbol><ci id="A1.SS1.p13.5.m5.1.2.3.2.2.cmml" xref="A1.SS1.p13.5.m5.1.2.3.2.2">𝑊</ci><apply id="A1.SS1.p13.5.m5.1.2.3.2.3.cmml" xref="A1.SS1.p13.5.m5.1.2.3.2.3"><csymbol cd="ambiguous" id="A1.SS1.p13.5.m5.1.2.3.2.3.1.cmml" xref="A1.SS1.p13.5.m5.1.2.3.2.3">superscript</csymbol><ci id="A1.SS1.p13.5.m5.1.2.3.2.3.2.cmml" xref="A1.SS1.p13.5.m5.1.2.3.2.3.2">𝑘</ci><ci id="A1.SS1.p13.5.m5.1.2.3.2.3.3.cmml" xref="A1.SS1.p13.5.m5.1.2.3.2.3.3">′</ci></apply></apply><apply id="A1.SS1.p13.5.m5.1.1.1.cmml" xref="A1.SS1.p13.5.m5.1.1.1"><times id="A1.SS1.p13.5.m5.1.1.1.2.cmml" xref="A1.SS1.p13.5.m5.1.1.1.2"></times><ci id="A1.SS1.p13.5.m5.1.1.1.3.cmml" xref="A1.SS1.p13.5.m5.1.1.1.3">𝜋</ci><ci id="A1.SS1.p13.5.m5.1.1.1.1.cmml" xref="A1.SS1.p13.5.m5.1.1.1.1">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p13.5.m5.1c">x_{j}\cdot W^{k^{\prime}}_{\pi(p)}</annotation></semantics></math>, yielding identical products as in the original <math id="A1.SS1.p13.6.m6.1" class="ltx_Math" alttext="QK^{T}" display="inline"><semantics id="A1.SS1.p13.6.m6.1a"><mrow id="A1.SS1.p13.6.m6.1.1" xref="A1.SS1.p13.6.m6.1.1.cmml"><mi id="A1.SS1.p13.6.m6.1.1.2" xref="A1.SS1.p13.6.m6.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p13.6.m6.1.1.1" xref="A1.SS1.p13.6.m6.1.1.1.cmml">​</mo><msup id="A1.SS1.p13.6.m6.1.1.3" xref="A1.SS1.p13.6.m6.1.1.3.cmml"><mi id="A1.SS1.p13.6.m6.1.1.3.2" xref="A1.SS1.p13.6.m6.1.1.3.2.cmml">K</mi><mi id="A1.SS1.p13.6.m6.1.1.3.3" xref="A1.SS1.p13.6.m6.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p13.6.m6.1b"><apply id="A1.SS1.p13.6.m6.1.1.cmml" xref="A1.SS1.p13.6.m6.1.1"><times id="A1.SS1.p13.6.m6.1.1.1.cmml" xref="A1.SS1.p13.6.m6.1.1.1"></times><ci id="A1.SS1.p13.6.m6.1.1.2.cmml" xref="A1.SS1.p13.6.m6.1.1.2">𝑄</ci><apply id="A1.SS1.p13.6.m6.1.1.3.cmml" xref="A1.SS1.p13.6.m6.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p13.6.m6.1.1.3.1.cmml" xref="A1.SS1.p13.6.m6.1.1.3">superscript</csymbol><ci id="A1.SS1.p13.6.m6.1.1.3.2.cmml" xref="A1.SS1.p13.6.m6.1.1.3.2">𝐾</ci><ci id="A1.SS1.p13.6.m6.1.1.3.3.cmml" xref="A1.SS1.p13.6.m6.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p13.6.m6.1c">QK^{T}</annotation></semantics></math> computation.</p>
</div>
<div id="A1.SS1.p14" class="ltx_para ltx_noindent">
<p id="A1.SS1.p14.1" class="ltx_p">Therefore, we can conclude that:</p>
<table id="A1.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex3.m1.2" class="ltx_Math" alttext="QK^{T}=Q^{\prime}K^{\prime T}" display="block"><semantics id="A1.Ex3.m1.2a"><mrow id="A1.Ex3.m1.2.3" xref="A1.Ex3.m1.2.3.cmml"><mrow id="A1.Ex3.m1.2.3.2" xref="A1.Ex3.m1.2.3.2.cmml"><mi id="A1.Ex3.m1.2.3.2.2" xref="A1.Ex3.m1.2.3.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.2.3.2.1" xref="A1.Ex3.m1.2.3.2.1.cmml">​</mo><msup id="A1.Ex3.m1.2.3.2.3" xref="A1.Ex3.m1.2.3.2.3.cmml"><mi id="A1.Ex3.m1.2.3.2.3.2" xref="A1.Ex3.m1.2.3.2.3.2.cmml">K</mi><mi id="A1.Ex3.m1.2.3.2.3.3" xref="A1.Ex3.m1.2.3.2.3.3.cmml">T</mi></msup></mrow><mo id="A1.Ex3.m1.2.3.1" xref="A1.Ex3.m1.2.3.1.cmml">=</mo><mrow id="A1.Ex3.m1.2.3.3" xref="A1.Ex3.m1.2.3.3.cmml"><msup id="A1.Ex3.m1.2.3.3.2" xref="A1.Ex3.m1.2.3.3.2.cmml"><mi id="A1.Ex3.m1.2.3.3.2.2" xref="A1.Ex3.m1.2.3.3.2.2.cmml">Q</mi><mo id="A1.Ex3.m1.2.3.3.2.3" xref="A1.Ex3.m1.2.3.3.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.2.3.3.1" xref="A1.Ex3.m1.2.3.3.1.cmml">​</mo><msup id="A1.Ex3.m1.2.3.3.3" xref="A1.Ex3.m1.2.3.3.3.cmml"><mi id="A1.Ex3.m1.2.3.3.3.2" xref="A1.Ex3.m1.2.3.3.3.2.cmml">K</mi><mrow id="A1.Ex3.m1.2.2.2.2" xref="A1.Ex3.m1.2.2.2.3.cmml"><mo mathsize="142%" id="A1.Ex3.m1.2.2.2.2.1" xref="A1.Ex3.m1.2.2.2.2.1.cmml">′</mo><mo lspace="0em" id="A1.Ex3.m1.2.2.2.2.2" xref="A1.Ex3.m1.2.2.2.3.cmml">⁣</mo><mi id="A1.Ex3.m1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.cmml">T</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex3.m1.2b"><apply id="A1.Ex3.m1.2.3.cmml" xref="A1.Ex3.m1.2.3"><eq id="A1.Ex3.m1.2.3.1.cmml" xref="A1.Ex3.m1.2.3.1"></eq><apply id="A1.Ex3.m1.2.3.2.cmml" xref="A1.Ex3.m1.2.3.2"><times id="A1.Ex3.m1.2.3.2.1.cmml" xref="A1.Ex3.m1.2.3.2.1"></times><ci id="A1.Ex3.m1.2.3.2.2.cmml" xref="A1.Ex3.m1.2.3.2.2">𝑄</ci><apply id="A1.Ex3.m1.2.3.2.3.cmml" xref="A1.Ex3.m1.2.3.2.3"><csymbol cd="ambiguous" id="A1.Ex3.m1.2.3.2.3.1.cmml" xref="A1.Ex3.m1.2.3.2.3">superscript</csymbol><ci id="A1.Ex3.m1.2.3.2.3.2.cmml" xref="A1.Ex3.m1.2.3.2.3.2">𝐾</ci><ci id="A1.Ex3.m1.2.3.2.3.3.cmml" xref="A1.Ex3.m1.2.3.2.3.3">𝑇</ci></apply></apply><apply id="A1.Ex3.m1.2.3.3.cmml" xref="A1.Ex3.m1.2.3.3"><times id="A1.Ex3.m1.2.3.3.1.cmml" xref="A1.Ex3.m1.2.3.3.1"></times><apply id="A1.Ex3.m1.2.3.3.2.cmml" xref="A1.Ex3.m1.2.3.3.2"><csymbol cd="ambiguous" id="A1.Ex3.m1.2.3.3.2.1.cmml" xref="A1.Ex3.m1.2.3.3.2">superscript</csymbol><ci id="A1.Ex3.m1.2.3.3.2.2.cmml" xref="A1.Ex3.m1.2.3.3.2.2">𝑄</ci><ci id="A1.Ex3.m1.2.3.3.2.3.cmml" xref="A1.Ex3.m1.2.3.3.2.3">′</ci></apply><apply id="A1.Ex3.m1.2.3.3.3.cmml" xref="A1.Ex3.m1.2.3.3.3"><csymbol cd="ambiguous" id="A1.Ex3.m1.2.3.3.3.1.cmml" xref="A1.Ex3.m1.2.3.3.3">superscript</csymbol><ci id="A1.Ex3.m1.2.3.3.3.2.cmml" xref="A1.Ex3.m1.2.3.3.3.2">𝐾</ci><list id="A1.Ex3.m1.2.2.2.3.cmml" xref="A1.Ex3.m1.2.2.2.2"><ci id="A1.Ex3.m1.2.2.2.2.1.cmml" xref="A1.Ex3.m1.2.2.2.2.1">′</ci><ci id="A1.Ex3.m1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1">𝑇</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex3.m1.2c">QK^{T}=Q^{\prime}K^{\prime T}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.p15" class="ltx_para ltx_noindent">
<p id="A1.SS1.p15.1" class="ltx_p">Hence, the attention scores remain unchanged after the permutation.</p>
</div>
<figure id="A1.F5" class="ltx_figure">
<div id="A1.F5.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:216.8pt;height:108.1pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-109.3pt,54.3pt) scale(0.497832503026213,0.497832503026213) ;"><img src="/html/2310.00247/assets/x12.png" id="A1.F5.1.g1" class="ltx_graphics ltx_img_square" width="230" height="230" alt="Refer to caption"><img src="/html/2310.00247/assets/x13.png" id="A1.F5.2.g2" class="ltx_graphics ltx_img_square" width="230" height="230" alt="Refer to caption">
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Local model performance salient parameter prioritization vs no salient parameter prioritization.</figcaption>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Ablation Study</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.1" class="ltx_p">RaFFM leverages the salient parameter prioritization (SPP) component to identify impactful weights in FMs. Hence, it’s critical to evaluate the effect of salient parameter prioritization. The experiment is conducted on BERT-Large with SST-2 <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib34" title="" class="ltx_ref">2018</a>)</cite>
Figure <a href="#A1.F5" title="Figure 5 ‣ A.1 Proof for Theorem 1 ‣ Appendix A Appendix ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the comparison of SPP and without SPP. Figure <a href="#A1.F5" title="Figure 5 ‣ A.1 Proof for Theorem 1 ‣ Appendix A Appendix ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (a) box plot shows the local sub-model performance range for randomly sampled 100 clients from supernet with the same resource constraints. It’s evident that SPP produces subnetworks with higher performance.
Figure <a href="#A1.F5" title="Figure 5 ‣ A.1 Proof for Theorem 1 ‣ Appendix A Appendix ‣ Bridging the Gap Between Foundation Models and Heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (b) shows the communication rounds vs global model (super-network) accuracy. RaFFM equipped with SPP, produced higher model performance and a more stable learning trend.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Resource-aware Federated Learning</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> Foundation model <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathcal{F(W}_{g})" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">​</mo><mrow id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l1.m1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l1.m1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.2.cmml">𝒲</mi><mi id="alg1.l1.m1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="alg1.l1.m1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><times id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2"></times><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">ℱ</ci><apply id="alg1.l1.m1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.2">𝒲</ci><ci id="alg1.l1.m1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{F(W}_{g})</annotation></semantics></math>, clients set <math id="alg1.l1.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">S</annotation></semantics></math>, communication rounds <math id="alg1.l1.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">T</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.4" class="ltx_Math" alttext="t=1,2,\ldots,T" display="inline"><semantics id="alg1.l2.m1.4a"><mrow id="alg1.l2.m1.4.5" xref="alg1.l2.m1.4.5.cmml"><mi id="alg1.l2.m1.4.5.2" xref="alg1.l2.m1.4.5.2.cmml">t</mi><mo id="alg1.l2.m1.4.5.1" xref="alg1.l2.m1.4.5.1.cmml">=</mo><mrow id="alg1.l2.m1.4.5.3.2" xref="alg1.l2.m1.4.5.3.1.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.4.5.3.2.1" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">2</mn><mo id="alg1.l2.m1.4.5.3.2.2" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">…</mi><mo id="alg1.l2.m1.4.5.3.2.3" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l2.m1.4.4" xref="alg1.l2.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.4b"><apply id="alg1.l2.m1.4.5.cmml" xref="alg1.l2.m1.4.5"><eq id="alg1.l2.m1.4.5.1.cmml" xref="alg1.l2.m1.4.5.1"></eq><ci id="alg1.l2.m1.4.5.2.cmml" xref="alg1.l2.m1.4.5.2">𝑡</ci><list id="alg1.l2.m1.4.5.3.1.cmml" xref="alg1.l2.m1.4.5.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><cn type="integer" id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">2</cn><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">…</ci><ci id="alg1.l2.m1.4.4.cmml" xref="alg1.l2.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.4c">t=1,2,\ldots,T</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3" class="ltx_listingline">     Salient Parameter Prioritization on <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\mathcal{W}_{g}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝒲</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝒲</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{W}_{g}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">     Server establishes communication with participate clients <math id="alg1.l4.m1.1" class="ltx_Math" alttext="S^{t}" display="inline"><semantics id="alg1.l4.m1.1a"><msup id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">S</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">superscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑆</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">S^{t}</annotation></semantics></math> <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\subseteq S" display="inline"><semantics id="alg1.l4.m2.1a"><mrow id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml"></mi><mo id="alg1.l4.m2.1.1.1" xref="alg1.l4.m2.1.1.1.cmml">⊆</mo><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><subset id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1.1"></subset><csymbol cd="latexml" id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2">absent</csymbol><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\subseteq S</annotation></semantics></math>.

</div>
<div id="alg1.l5" class="ltx_listingline">     <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\tau^{t}\leftarrow" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msup id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">τ</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">t</mi></msup><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝜏</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\tau^{t}\leftarrow</annotation></semantics></math> clients resource constraints sets.

</div>
<div id="alg1.l6" class="ltx_listingline">     <math id="alg1.l6.m1.1" class="ltx_Math" alttext="C^{t}\leftarrow" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msup id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">C</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">t</mi></msup><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">superscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝐶</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">C^{t}\leftarrow</annotation></semantics></math> sampled sub-network configuration satisfying <math id="alg1.l6.m2.1" class="ltx_Math" alttext="\tau^{t}" display="inline"><semantics id="alg1.l6.m2.1a"><msup id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">τ</mi><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">superscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝜏</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\tau^{t}</annotation></semantics></math>.

</div>
<div id="alg1.l7" class="ltx_listingline">     <span id="alg1.l7.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l7.m1.1" class="ltx_Math" alttext="s_{\tau}\in S^{t}" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">s</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">τ</mi></msub><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">∈</mo><msup id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">S</mi><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><in id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></in><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑠</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝜏</ci></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">superscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝑆</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">s_{\tau}\in S^{t}</annotation></semantics></math> and <math id="alg1.l7.m2.1" class="ltx_Math" alttext="c_{\tau}\in C^{t}" display="inline"><semantics id="alg1.l7.m2.1a"><mrow id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><msub id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2.cmml"><mi id="alg1.l7.m2.1.1.2.2" xref="alg1.l7.m2.1.1.2.2.cmml">c</mi><mi id="alg1.l7.m2.1.1.2.3" xref="alg1.l7.m2.1.1.2.3.cmml">τ</mi></msub><mo id="alg1.l7.m2.1.1.1" xref="alg1.l7.m2.1.1.1.cmml">∈</mo><msup id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml"><mi id="alg1.l7.m2.1.1.3.2" xref="alg1.l7.m2.1.1.3.2.cmml">C</mi><mi id="alg1.l7.m2.1.1.3.3" xref="alg1.l7.m2.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><in id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1.1"></in><apply id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.2.1.cmml" xref="alg1.l7.m2.1.1.2">subscript</csymbol><ci id="alg1.l7.m2.1.1.2.2.cmml" xref="alg1.l7.m2.1.1.2.2">𝑐</ci><ci id="alg1.l7.m2.1.1.2.3.cmml" xref="alg1.l7.m2.1.1.2.3">𝜏</ci></apply><apply id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.3.1.cmml" xref="alg1.l7.m2.1.1.3">superscript</csymbol><ci id="alg1.l7.m2.1.1.3.2.cmml" xref="alg1.l7.m2.1.1.3.2">𝐶</ci><ci id="alg1.l7.m2.1.1.3.3.cmml" xref="alg1.l7.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">c_{\tau}\in C^{t}</annotation></semantics></math> <span id="alg1.l7.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">         <math id="alg1.l8.m1.1" class="ltx_math_unparsed" alttext="\mathcal{F}(\mathcal{W}_{c_{\tau}})\leftarrow\mathcal{F}(\mathcal{W}_{g}[:{c_{\tau}}])" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1b"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1">ℱ</mi><mrow id="alg1.l8.m1.1.2"><mo stretchy="false" id="alg1.l8.m1.1.2.1">(</mo><msub id="alg1.l8.m1.1.2.2"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.2.2.2">𝒲</mi><msub id="alg1.l8.m1.1.2.2.3"><mi id="alg1.l8.m1.1.2.2.3.2">c</mi><mi id="alg1.l8.m1.1.2.2.3.3">τ</mi></msub></msub><mo stretchy="false" id="alg1.l8.m1.1.2.3">)</mo></mrow><mo stretchy="false" id="alg1.l8.m1.1.3">←</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.4">ℱ</mi><mrow id="alg1.l8.m1.1.5"><mo stretchy="false" id="alg1.l8.m1.1.5.1">(</mo><msub id="alg1.l8.m1.1.5.2"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.5.2.2">𝒲</mi><mi id="alg1.l8.m1.1.5.2.3">g</mi></msub><mrow id="alg1.l8.m1.1.5.3"><mo stretchy="false" id="alg1.l8.m1.1.5.3.1">[</mo><mo rspace="0.278em" id="alg1.l8.m1.1.5.3.2">:</mo><msub id="alg1.l8.m1.1.5.3.3"><mi id="alg1.l8.m1.1.5.3.3.2">c</mi><mi id="alg1.l8.m1.1.5.3.3.3">τ</mi></msub><mo stretchy="false" id="alg1.l8.m1.1.5.3.4">]</mo></mrow><mo stretchy="false" id="alg1.l8.m1.1.5.4">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\mathcal{F}(\mathcal{W}_{c_{\tau}})\leftarrow\mathcal{F}(\mathcal{W}_{g}[:{c_{\tau}}])</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">         Communicate submodel <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\mathcal{F}(\mathcal{W}_{c_{\tau}})" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">​</mo><mrow id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.2.cmml">𝒲</mi><msub id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.1.3.2.cmml">c</mi><mi id="alg1.l9.m1.1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.1.3.3.cmml">τ</mi></msub></msub><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><times id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"></times><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">ℱ</ci><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2">𝒲</ci><apply id="alg1.l9.m1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.2">𝑐</ci><ci id="alg1.l9.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\mathcal{F}(\mathcal{W}_{c_{\tau}})</annotation></semantics></math> to client <math id="alg1.l9.m2.1" class="ltx_Math" alttext="s_{\tau}" display="inline"><semantics id="alg1.l9.m2.1a"><msub id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">s</mi><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑠</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">s_{\tau}</annotation></semantics></math>.

</div>
<div id="alg1.l10" class="ltx_listingline">     <span id="alg1.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">     Clients perform local updates on private data.

</div>
<div id="alg1.l12" class="ltx_listingline">     Clients communicate local optimized resource-aware submodels back to the server.

</div>
<div id="alg1.l13" class="ltx_listingline">     Server aggregates local updates and computes the new global model:

<table id="A1.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex4.m1.1" class="ltx_math_unparsed" alttext="\mathcal{W}_{g}=\sum_{{c_{\tau}}\in C_{t}}(\mathcal{W}_{g}[:c_{\tau}]+\eta_{c_{\tau}}\nabla\mathcal{W}_{c_{\tau}})" display="block"><semantics id="A1.Ex4.m1.1a"><mrow id="A1.Ex4.m1.1b"><msub id="A1.Ex4.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="A1.Ex4.m1.1.1.2">𝒲</mi><mi id="A1.Ex4.m1.1.1.3">g</mi></msub><mo rspace="0.111em" id="A1.Ex4.m1.1.2">=</mo><munder id="A1.Ex4.m1.1.3"><mo movablelimits="false" rspace="0em" id="A1.Ex4.m1.1.3.2">∑</mo><mrow id="A1.Ex4.m1.1.3.3"><msub id="A1.Ex4.m1.1.3.3.2"><mi id="A1.Ex4.m1.1.3.3.2.2">c</mi><mi id="A1.Ex4.m1.1.3.3.2.3">τ</mi></msub><mo id="A1.Ex4.m1.1.3.3.1">∈</mo><msub id="A1.Ex4.m1.1.3.3.3"><mi id="A1.Ex4.m1.1.3.3.3.2">C</mi><mi id="A1.Ex4.m1.1.3.3.3.3">t</mi></msub></mrow></munder><mrow id="A1.Ex4.m1.1.4"><mo stretchy="false" id="A1.Ex4.m1.1.4.1">(</mo><msub id="A1.Ex4.m1.1.4.2"><mi class="ltx_font_mathcaligraphic" id="A1.Ex4.m1.1.4.2.2">𝒲</mi><mi id="A1.Ex4.m1.1.4.2.3">g</mi></msub><mrow id="A1.Ex4.m1.1.4.3"><mo stretchy="false" id="A1.Ex4.m1.1.4.3.1">[</mo><mo rspace="0.278em" id="A1.Ex4.m1.1.4.3.2">:</mo><msub id="A1.Ex4.m1.1.4.3.3"><mi id="A1.Ex4.m1.1.4.3.3.2">c</mi><mi id="A1.Ex4.m1.1.4.3.3.3">τ</mi></msub><mo stretchy="false" id="A1.Ex4.m1.1.4.3.4">]</mo></mrow><mo id="A1.Ex4.m1.1.4.4">+</mo><msub id="A1.Ex4.m1.1.4.5"><mi id="A1.Ex4.m1.1.4.5.2">η</mi><msub id="A1.Ex4.m1.1.4.5.3"><mi id="A1.Ex4.m1.1.4.5.3.2">c</mi><mi id="A1.Ex4.m1.1.4.5.3.3">τ</mi></msub></msub><mo lspace="0.167em" rspace="0.167em" id="A1.Ex4.m1.1.4.6">∇</mo><msub id="A1.Ex4.m1.1.4.7"><mi class="ltx_font_mathcaligraphic" id="A1.Ex4.m1.1.4.7.2">𝒲</mi><msub id="A1.Ex4.m1.1.4.7.3"><mi id="A1.Ex4.m1.1.4.7.3.2">c</mi><mi id="A1.Ex4.m1.1.4.7.3.3">τ</mi></msub></msub><mo stretchy="false" id="A1.Ex4.m1.1.4.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex4.m1.1c">\mathcal{W}_{g}=\sum_{{c_{\tau}}\in C_{t}}(\mathcal{W}_{g}[:c_{\tau}]+\eta_{c_{\tau}}\nabla\mathcal{W}_{c_{\tau}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span id="alg1.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.00246" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.00247" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.00247">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.00247" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.00248" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 03:07:40 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
