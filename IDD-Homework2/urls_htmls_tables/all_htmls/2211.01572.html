<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2211.01572] FedTP: Federated Learning by Transformer Personalization</title><meta property="og:description" content="Federated learning is an emerging learning paradigm where multiple clients collaboratively train a machine learning model in a privacy-preserving manner. Personalized federated learning extends this paradigm to overcom…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedTP: Federated Learning by Transformer Personalization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedTP: Federated Learning by Transformer Personalization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2211.01572">

<!--Generated on Thu Mar 14 06:01:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Personalized federated learning,  Transformer,  hypernetworks,  learn to personalize,  self-attention.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedTP: Federated Learning by Transformer Personalization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hongxia Li, Zhongyi Cai, Jingya Wang, Jiangnan Tang, Weiping Ding, Chin-Teng Lin, and Ye Shi
</span><span class="ltx_author_notes">This work was supported by the Shanghai Sailing Program
(22YF1428800, 21YF1429400), Shanghai Local college
capacity building program (23010503100), and Shanghai Frontiers Science Center of Humancentered Artificial Intelligence (ShangHAI). This work was also supported in part by the National Natural Science Foundation of China under Grant 61976120, in part by the Natural Science Key Foundation of Jiangsu Education Department under Grant 21KJA510004, in part by the
Australian Research Council (ARC) under Discovery Grant DP210101093
and Discovery Grant DP220100803. (Corresponding authors: Ye Shi)Hongxia Li and Zhongyi Cai contributed equally to this work. Hongxia Li, Zhongyi Cai, Jingya Wang, Jiangnan Tang and Ye Shi are with the School of Information Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:lihx2@shanghaitech.edu.cn, caizhy@shanghaitech.edu.cn, wangjingya@shanghaitech.edu.cn, tangjn2022@shanghaitech.edu.cn, shiye@shanghaitech.edu.cn).Weiping Ding is with School of Information Science and Technology, Nantong University, Nantong 226019, China (e-mail: dwp9988@163.com)Chin-Teng Lin is with the School of Computer Science, University of Technology Sydney, Broadway, NSW 2007, Australia (e-mail: chin-teng.lin@uts.edu.au).</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning is an emerging learning paradigm where multiple clients collaboratively train a machine learning model in a privacy-preserving manner. Personalized federated learning extends this paradigm to overcome heterogeneity across clients by learning personalized models. Recently, there have been some initial attempts to apply Transformers to federated learning. However, the impacts of federated learning algorithms on self-attention have not yet been studied. In this paper, we investigate this relationship and reveals that federated averaging algorithms actually have a negative impact on self-attention in cases of data heterogeneity, which limits the capabilities of the Transformer model in federated learning settings. To address this issue, we propose FedTP, a novel Transformer-based federated learning framework that learns personalized self-attention for each client while aggregating the other parameters among the clients. Instead of using a vanilla personalization mechanism that maintains personalized self-attention layers of each client locally, we develop a <em id="id1.id1.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism to further encourage the cooperation among clients and to increase the scalability and generalization of FedTP. Specifically, we achieve this by learning a hypernetwork on the server that outputs the personalized projection matrices of self-attention layers to generate client-wise queries, keys and values. Furthermore, we present the generalization bound for FedTP with the <em id="id1.id1.2" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism.
Extensive experiments verify that FedTP with the <em id="id1.id1.3" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism yields state-of-the-art performance in non-IID scenarios. Our code is available online<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/zhyczy/FedTP</span></span></span></span>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Personalized federated learning, Transformer, hypernetworks, learn to personalize, self-attention.

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> is a framework that learns a shared global model from multiple disjointed clients without sharing their own data. In federated learning, each client trains a model using its own local data and only sends model updates back to the server. In this way, federated learning overcomes a range of problems with both data privacy and communications overheads. However, in situations where there is data heterogeneity and system heterogeneity across the clients, learning a single global model may fail. Accordingly, personalized federated learning has emerged as an extension to federated learning to overcome these challenges. The paradigm works by learning personalized models instead of a single global model, while still benefiting from joint training.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2211.01572/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="452" height="275" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example showing the attention maps of Local-T, FedAvg-T and Vanilla Personalized-T over 5 clients with different local datasets. These results show that self-attention either trained locally or by a Vanilla personalized-T model can focus on task-specific information well. However, FedAvg-T disturbs these information.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Data heterogeneity is a common problem in the real world, since the training data collected from different clients varies heavily both in size and distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.
Numerous methods have been developed for federated learning to tackle the challenge of non-IID data distribution across clients.
Yet most federated learning frameworks are based on convolutional neural networks (CNNs), which generally focus on high-frequency local patterns that might be particularly sensitive to data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, however, use self-attention to learn the global interactions between inputs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> and, therefore, they tend to be more robust to distribution shifts and data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Motivated by this, a very recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> proposed the idea of using Transformers as a federated network architecture coupled with the basic federated averaging (FedAvg) algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Although the study showed some very promising experimental results, the impacts that federated learning algorithms may have on self-attention has not yet been studied. It is our fear that such algorithms may limit the capabilities of Transformers in federated learning. Given the promise of Transformer-based federated learning, this is a topic worthy of further investigation.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To sum up, the main issues of current personalized federated learning are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1)</span> 
<div id="S1.I1.ix1.p1" class="ltx_para">
<p id="S1.I1.ix1.p1.1" class="ltx_p">Many existing CNNs-based federated models might be particularly sensitive to data heterogeneity since CNNs generally focus on high-frequency local patterns.</p>
</div>
</li>
<li id="S1.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2)</span> 
<div id="S1.I1.ix2.p1" class="ltx_para">
<p id="S1.I1.ix2.p1.1" class="ltx_p">Existing Transformer-based Federated learning methods do not investigate the effects of the federated aggregation operations on the self-attention.</p>
</div>
</li>
<li id="S1.I1.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3)</span> 
<div id="S1.I1.ix3.p1" class="ltx_para">
<p id="S1.I1.ix3.p1.1" class="ltx_p">There is a lack of a personalized federated learning framework that is more appropriate for Transformer structures.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Recently, it has been demonstrated that the self-attention layers in Transformers play a more important role than the other layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Inspired by this, we devised a simple experiment to explore the contribution of self-attention to federated learning and to study the effects of federated learning methods on self-attention mechanisms. In our experiment, we compared the attention maps of three different Vision Transformer (ViT) models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, these being: 1) Local-T, which trains a unique ViT in each client locally; 2) FedAvg-T, which applies the FedAvg algorithm to train a global ViT; and 3) Vanilla Personalized-T, which retains the self-attention locally and uses FedAvg to aggregate the other parameters in the server. The experiment itself involved sampling a set of images from different classes in CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> with five clients and using the Attention Rollout method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> to produce attention maps. The original images and corresponding attention maps of these methods are shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We can see that both Local-T and Vanilla Personalized-T can discover critical information in the images (the red area in the images), but FedAvg-T failed to generate a meaningful attention map. This indicates that aggregating the self-attention of clients with heterogeneous data may ruin the client-specific representations, potentially degrading the model’s performance.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Unlike applying simple FedAvg operations on the whole model, the above vanilla personalization mechanism can depict client-specific self-attention layers by local training. However, since these personalized self-attention layers are learned independently without considering the potential inherent relationships between clients, the obtained personalized self-attention may be sub-optimal. Moreover, the personalized self-attention layers are not scalable as they increase linearly with the increase of client numbers. Furthermore, the generalization of personalized self-attention to novel clients is limited since the whole self-attention layers must be re-trained.
Based on this, we designed a novel Transformer-based federated learning framework called Federated Transformer Personalization (FedTP) that uses a
<em id="S1.p5.1.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism instead of the above vanilla personalization. Specifically, a hypernetwork is learned on the server that generates projection matrices in self-attention layers to produce client-wise queries, keys, and values, while the other model parameters are aggregated and shared.
The <em id="S1.p5.1.2" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism for self-attention layers through hypernetwork allows us to effectively share parameters across clients and generate personalized self-attention layers by learning a unique embedding vector for each client. In addition to high accuracy, FedTP is also scalable to the increase of client number and enjoys good generalization capability to novel clients. Our main contributions are summarized as follows:</p>
<ul id="S1.I2" class="ltx_itemize">
<li id="S1.I2.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1)</span> 
<div id="S1.I2.ix1.p1" class="ltx_para">
<p id="S1.I2.ix1.p1.1" class="ltx_p">We explore the effects of self-attention mechanism in personalized federated learning and we are the first to reveal that FedAvg may have negative impacts on self-attention where data heterogeneity is present. Based on this, we propose a novel Transformer-based federated learning framework, namely FedTP, that learns personalized self-attention for each client.</p>
</div>
</li>
<li id="S1.I2.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2)</span> 
<div id="S1.I2.ix2.p1" class="ltx_para">
<p id="S1.I2.ix2.p1.1" class="ltx_p">We propose a <em id="S1.I2.ix2.p1.1.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism to better exploit clients’ cooperations in the personalized layers and improve the scalability and generalization of FedTP. In addition, we derive the generalization bounds for FedTP with the <em id="S1.I2.ix2.p1.1.2" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism.</p>
</div>
</li>
<li id="S1.I2.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3)</span> 
<div id="S1.I2.ix3.p1" class="ltx_para">
<p id="S1.I2.ix3.p1.1" class="ltx_p">We conducted extensive experiments on three benchmark datasets under different non-IID data settings. The experimental results demonstrate that FedTP yields state-of-the-art performance over a wide range of personalized federated learning benchmark methods on both image and language tasks.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The rest of this paper is organized as follows. Section II briefly reviews the related work of personalized federated learning, Transformers and Hypernetworks. Section III presents the formulation of Transformer-based personalized federated learning; the details of two types of personalization, including vanilla personalization and <em id="S1.p6.1.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em>; and the update of model parameters. Experimental results and discussions are provided in Section IV. Section IV analyzes the limitations of FedTP and section V concludes the whole paper. The proof of Theorem 1 in Section III is given in the Appendix.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Personalized Federated Learning</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Multiple approaches to personalized federated learning have been proposed as a way of overcoming heterogeneity across clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Currently, these methods can be divided into two main categories: global model personalization and learning personalized models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Global model personalization aims to improve the performance of a single shared global model given heterogeneous data. An intuitive method is fine-tuning the global model on the clients’ local datasets to produce personalized parameters <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. Another strategy is to add a proximal regularization term to handle client drift problems resulting from statistical heterogeneity. Examples include FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and Ditto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. Instead, FedAlign <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> studied the data heterogeneity challenge of FL from the perspective of local learning generality rather than proximal restriction.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Instead of training a single global model, learning personalized models is more suitable for heterogeneous clients. One such approach is to seek an explicit trade-off between the global model and the local models. Some researchers have considered interpolating the two models, e.g., L2GD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and LG-FEDAVG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. Similarly, Knn-Per <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> is also an interpolation of the two models, but the local model is built through a k-nearest neighbors method, which requires storing all the features of the samples. To increase the flexibility of this personalized model architecture for clients, some methods distill knowledge from a global teacher model into student models on the client devices. In this way, the clients learn a stronger personalized model. FedMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and FedGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> are two examples of this approach. When there are inherent partitions or differences in the data distribution between clients, it can be more appropriate to train a federated learning model for each homogeneous group of clients through a clustering approach, like CFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, PFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, or FedAMP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, noting, though, that this may lead to high computation and communication overheads. FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> and FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> learn personalized classifier heads locally while sharing the base layers. FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> updates the client batch normalization layers locally, and pFedGP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> learns a shared kernel function for all clients and a personalized Gaussian process classifier for each client. In addition, some studies focus on specific fields and propose corresponding PFL methods. FEDGS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> is proposed to solve the heterogeneity caused by the rapidly changing streaming data and clustering nature of factory devices in the Industrial Internet of Things. FedStack <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> supports ensembling heterogeneous architectural client models in the area of healthcare. Furthermore, a horizontal federated reinforcement learning (HFRL)-based method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> develops optimal electric vehicles charging/discharging control strategies for different EVs users to maximise their benefits. Unlike these works, our FedTP employs a <em id="S2.SS1.p2.1.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism to learn personalized self-attention layer in Transformer to better handle data heterogeneity among clients.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Transformers</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">The Transformer model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> was originally designed to improve the efficiency of machine translation tasks. It is a deep learning model basefeaturesself-attention mechanism that has achieved state-of-the-art performance in many NLP tasks. Since it first emerged, many researchers have explored its applicability to vision tasks, with one of the most successful attempts being ViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. As the first attempt to use Transformer in federated learning, Park et al. proposed a federated ViT for COVID-19 chest X-ray diagnosis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>. This framework leverages robust representations from multiple related tasks to improve the performance of individual tasks. Very recently, Qu et al. conducted rigorous empirical experiments and showed that, in federated learning settings, Transformers are more suitable for situations with heterogeneous data distributions than CNNs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. However, although Transformer models have shown very promising performance in federated learning, most are only trained with the basic FedAvg algorithm, which may limit their true capabilities, especially in non-IID scenarios. To see this architecture perform to its fullest potential, our FedTP learns a personalized Transformer for each client. The self-attention mechanism captures data heterogeneity through a hypernetwork located on the server, which generates projection parameters in the self-attention layers.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Hypernetworks</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Hypernetworks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> are neural networks that can generate weights for a large target network with a learnable embedding vector as its input. pFedHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> was the first method to apply a hypernetwork to personalized federated learning, where a hypernetwork is learned on the server that generates personalized weights for the local CNNs on each client. Instead of generating all the model’s parameters, pFedLA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> employs a hypernetwork on the server that outputs aggregated weights for each layer of the local model on each different client. Different from these two studies, Fed-RoD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> learns a hypernetwork locally, which outputs personalized predictors for clients with the extra inputs of the clients’ class distributions. Notably, all these methods with hypernetworks are based on CNN architectures. In contrast, the hypernetwork in FedTP generates projection matrices in the self-attention layers of a Transformer to produce client-wised queries, keys, and values.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Federated learning by Transformer Personalization</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we present the design of our FedTP framework. Aiming to mitigate heterogeneity and build a high-quality personalized model for each client, FedTP learns personalized self-attention layers for each client.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2211.01572/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="201" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An overview of FedTP. On the left, the self-attention layers are retained locally while the other parameters are aggregated on the server and shared among clients.
The right shows the workflow of <span id="S3.F2.4.1" class="ltx_text ltx_font_italic">learn-to-personalize</span> that generates the projection matrices in the self-attention layers of <math id="S3.F2.2.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.F2.2.m1.1b"><mi id="S3.F2.2.m1.1.1" xref="S3.F2.2.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.F2.2.m1.1c"><ci id="S3.F2.2.m1.1.1.cmml" xref="S3.F2.2.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.2.m1.1d">L</annotation></semantics></math> Transformer blocks. This is performed by a hypernetwork located on the server, which consists of simple MLP layers with the last layer being unique for each Transformer block.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Problem Formulation</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.13" class="ltx_p">The FedTP framework uses a traditional ViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> for image tasks, and Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> for language tasks. The input sequence <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">X</annotation></semantics></math> is with a predetermined length of <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">m</annotation></semantics></math>, noting that images are partitioned into a sequence in the image pre-pocessing layer of ViT. This sequence is then transformed into a corresponding embedding matrix <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">H</annotation></semantics></math> with a dimension of <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathbb{R}^{m\times d}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.4.m4.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">×</mo><mi id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">ℝ</ci><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><times id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3.1"></times><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝑚</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathbb{R}^{m\times d}</annotation></semantics></math>. The queries, keys and values of the self-attention mechanism are respectively denoted as <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="Q=HW^{Q}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">Q</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><msup id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.3.2" xref="S3.SS1.p1.5.m5.1.1.3.3.2.cmml">W</mi><mi id="S3.SS1.p1.5.m5.1.1.3.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.3.cmml">Q</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><eq id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></eq><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑄</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><times id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝐻</ci><apply id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3.2">𝑊</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">Q=HW^{Q}</annotation></semantics></math>, <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="K=HW^{K}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">K</mi><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">​</mo><msup id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.3.2" xref="S3.SS1.p1.6.m6.1.1.3.3.2.cmml">W</mi><mi id="S3.SS1.p1.6.m6.1.1.3.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.3.cmml">K</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><eq id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></eq><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐾</ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><times id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝐻</ci><apply id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.2">𝑊</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">K=HW^{K}</annotation></semantics></math> and <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="V=HW^{V}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">V</mi><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.1.1.3.1" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">​</mo><msup id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.3.2" xref="S3.SS1.p1.7.m7.1.1.3.3.2.cmml">W</mi><mi id="S3.SS1.p1.7.m7.1.1.3.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.3.cmml">V</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><eq id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></eq><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑉</ci><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><times id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.1"></times><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">𝐻</ci><apply id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3.2">𝑊</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">V=HW^{V}</annotation></semantics></math>. For convenience, we concatenated these projection parameters as <math id="S3.SS1.p1.8.m8.3" class="ltx_Math" alttext="W=[W^{Q},W^{K},W^{V}]" display="inline"><semantics id="S3.SS1.p1.8.m8.3a"><mrow id="S3.SS1.p1.8.m8.3.3" xref="S3.SS1.p1.8.m8.3.3.cmml"><mi id="S3.SS1.p1.8.m8.3.3.5" xref="S3.SS1.p1.8.m8.3.3.5.cmml">W</mi><mo id="S3.SS1.p1.8.m8.3.3.4" xref="S3.SS1.p1.8.m8.3.3.4.cmml">=</mo><mrow id="S3.SS1.p1.8.m8.3.3.3.3" xref="S3.SS1.p1.8.m8.3.3.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.3.3.3.3.4" xref="S3.SS1.p1.8.m8.3.3.3.4.cmml">[</mo><msup id="S3.SS1.p1.8.m8.1.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml">Q</mi></msup><mo id="S3.SS1.p1.8.m8.3.3.3.3.5" xref="S3.SS1.p1.8.m8.3.3.3.4.cmml">,</mo><msup id="S3.SS1.p1.8.m8.2.2.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.8.m8.2.2.2.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS1.p1.8.m8.2.2.2.2.2.3" xref="S3.SS1.p1.8.m8.2.2.2.2.2.3.cmml">K</mi></msup><mo id="S3.SS1.p1.8.m8.3.3.3.3.6" xref="S3.SS1.p1.8.m8.3.3.3.4.cmml">,</mo><msup id="S3.SS1.p1.8.m8.3.3.3.3.3" xref="S3.SS1.p1.8.m8.3.3.3.3.3.cmml"><mi id="S3.SS1.p1.8.m8.3.3.3.3.3.2" xref="S3.SS1.p1.8.m8.3.3.3.3.3.2.cmml">W</mi><mi id="S3.SS1.p1.8.m8.3.3.3.3.3.3" xref="S3.SS1.p1.8.m8.3.3.3.3.3.3.cmml">V</mi></msup><mo stretchy="false" id="S3.SS1.p1.8.m8.3.3.3.3.7" xref="S3.SS1.p1.8.m8.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.3b"><apply id="S3.SS1.p1.8.m8.3.3.cmml" xref="S3.SS1.p1.8.m8.3.3"><eq id="S3.SS1.p1.8.m8.3.3.4.cmml" xref="S3.SS1.p1.8.m8.3.3.4"></eq><ci id="S3.SS1.p1.8.m8.3.3.5.cmml" xref="S3.SS1.p1.8.m8.3.3.5">𝑊</ci><list id="S3.SS1.p1.8.m8.3.3.3.4.cmml" xref="S3.SS1.p1.8.m8.3.3.3.3"><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS1.p1.8.m8.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS1.p1.8.m8.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS1.p1.8.m8.3.3.3.3.3.cmml" xref="S3.SS1.p1.8.m8.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.3.3.3.1.cmml" xref="S3.SS1.p1.8.m8.3.3.3.3.3">superscript</csymbol><ci id="S3.SS1.p1.8.m8.3.3.3.3.3.2.cmml" xref="S3.SS1.p1.8.m8.3.3.3.3.3.2">𝑊</ci><ci id="S3.SS1.p1.8.m8.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.8.m8.3.3.3.3.3.3">𝑉</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.3c">W=[W^{Q},W^{K},W^{V}]</annotation></semantics></math>. Next, self-attention is applied through <math id="S3.SS1.p1.9.m9.4" class="ltx_Math" alttext="Attention(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{d}})V" display="inline"><semantics id="S3.SS1.p1.9.m9.4a"><mrow id="S3.SS1.p1.9.m9.4.5" xref="S3.SS1.p1.9.m9.4.5.cmml"><mrow id="S3.SS1.p1.9.m9.4.5.2" xref="S3.SS1.p1.9.m9.4.5.2.cmml"><mi id="S3.SS1.p1.9.m9.4.5.2.2" xref="S3.SS1.p1.9.m9.4.5.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.2.3" xref="S3.SS1.p1.9.m9.4.5.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1a" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.2.4" xref="S3.SS1.p1.9.m9.4.5.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1b" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.2.5" xref="S3.SS1.p1.9.m9.4.5.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1c" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.2.6" xref="S3.SS1.p1.9.m9.4.5.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1d" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.2.7" xref="S3.SS1.p1.9.m9.4.5.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1e" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.2.8" xref="S3.SS1.p1.9.m9.4.5.2.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1f" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.2.9" xref="S3.SS1.p1.9.m9.4.5.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1g" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.2.10" xref="S3.SS1.p1.9.m9.4.5.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.2.1h" xref="S3.SS1.p1.9.m9.4.5.2.1.cmml">​</mo><mrow id="S3.SS1.p1.9.m9.4.5.2.11.2" xref="S3.SS1.p1.9.m9.4.5.2.11.1.cmml"><mo stretchy="false" id="S3.SS1.p1.9.m9.4.5.2.11.2.1" xref="S3.SS1.p1.9.m9.4.5.2.11.1.cmml">(</mo><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">Q</mi><mo id="S3.SS1.p1.9.m9.4.5.2.11.2.2" xref="S3.SS1.p1.9.m9.4.5.2.11.1.cmml">,</mo><mi id="S3.SS1.p1.9.m9.2.2" xref="S3.SS1.p1.9.m9.2.2.cmml">K</mi><mo id="S3.SS1.p1.9.m9.4.5.2.11.2.3" xref="S3.SS1.p1.9.m9.4.5.2.11.1.cmml">,</mo><mi id="S3.SS1.p1.9.m9.3.3" xref="S3.SS1.p1.9.m9.3.3.cmml">V</mi><mo stretchy="false" id="S3.SS1.p1.9.m9.4.5.2.11.2.4" xref="S3.SS1.p1.9.m9.4.5.2.11.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.9.m9.4.5.1" xref="S3.SS1.p1.9.m9.4.5.1.cmml">=</mo><mrow id="S3.SS1.p1.9.m9.4.5.3" xref="S3.SS1.p1.9.m9.4.5.3.cmml"><mi id="S3.SS1.p1.9.m9.4.5.3.2" xref="S3.SS1.p1.9.m9.4.5.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.3.1" xref="S3.SS1.p1.9.m9.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.3.3" xref="S3.SS1.p1.9.m9.4.5.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.3.1a" xref="S3.SS1.p1.9.m9.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.3.4" xref="S3.SS1.p1.9.m9.4.5.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.3.1b" xref="S3.SS1.p1.9.m9.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.3.5" xref="S3.SS1.p1.9.m9.4.5.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.3.1c" xref="S3.SS1.p1.9.m9.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.3.6" xref="S3.SS1.p1.9.m9.4.5.3.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.3.1d" xref="S3.SS1.p1.9.m9.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.3.7" xref="S3.SS1.p1.9.m9.4.5.3.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.3.1e" xref="S3.SS1.p1.9.m9.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.3.8" xref="S3.SS1.p1.9.m9.4.5.3.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.3.1f" xref="S3.SS1.p1.9.m9.4.5.3.1.cmml">​</mo><mrow id="S3.SS1.p1.9.m9.4.5.3.9.2" xref="S3.SS1.p1.9.m9.4.4.cmml"><mo stretchy="false" id="S3.SS1.p1.9.m9.4.5.3.9.2.1" xref="S3.SS1.p1.9.m9.4.4.cmml">(</mo><mfrac id="S3.SS1.p1.9.m9.4.4" xref="S3.SS1.p1.9.m9.4.4.cmml"><mrow id="S3.SS1.p1.9.m9.4.4.2" xref="S3.SS1.p1.9.m9.4.4.2.cmml"><mi id="S3.SS1.p1.9.m9.4.4.2.2" xref="S3.SS1.p1.9.m9.4.4.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.4.2.1" xref="S3.SS1.p1.9.m9.4.4.2.1.cmml">​</mo><msup id="S3.SS1.p1.9.m9.4.4.2.3" xref="S3.SS1.p1.9.m9.4.4.2.3.cmml"><mi id="S3.SS1.p1.9.m9.4.4.2.3.2" xref="S3.SS1.p1.9.m9.4.4.2.3.2.cmml">K</mi><mi id="S3.SS1.p1.9.m9.4.4.2.3.3" xref="S3.SS1.p1.9.m9.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.SS1.p1.9.m9.4.4.3" xref="S3.SS1.p1.9.m9.4.4.3.cmml"><mi id="S3.SS1.p1.9.m9.4.4.3.2" xref="S3.SS1.p1.9.m9.4.4.3.2.cmml">d</mi></msqrt></mfrac><mo stretchy="false" id="S3.SS1.p1.9.m9.4.5.3.9.2.2" xref="S3.SS1.p1.9.m9.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.4.5.3.1g" xref="S3.SS1.p1.9.m9.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.4.5.3.10" xref="S3.SS1.p1.9.m9.4.5.3.10.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.4b"><apply id="S3.SS1.p1.9.m9.4.5.cmml" xref="S3.SS1.p1.9.m9.4.5"><eq id="S3.SS1.p1.9.m9.4.5.1.cmml" xref="S3.SS1.p1.9.m9.4.5.1"></eq><apply id="S3.SS1.p1.9.m9.4.5.2.cmml" xref="S3.SS1.p1.9.m9.4.5.2"><times id="S3.SS1.p1.9.m9.4.5.2.1.cmml" xref="S3.SS1.p1.9.m9.4.5.2.1"></times><ci id="S3.SS1.p1.9.m9.4.5.2.2.cmml" xref="S3.SS1.p1.9.m9.4.5.2.2">𝐴</ci><ci id="S3.SS1.p1.9.m9.4.5.2.3.cmml" xref="S3.SS1.p1.9.m9.4.5.2.3">𝑡</ci><ci id="S3.SS1.p1.9.m9.4.5.2.4.cmml" xref="S3.SS1.p1.9.m9.4.5.2.4">𝑡</ci><ci id="S3.SS1.p1.9.m9.4.5.2.5.cmml" xref="S3.SS1.p1.9.m9.4.5.2.5">𝑒</ci><ci id="S3.SS1.p1.9.m9.4.5.2.6.cmml" xref="S3.SS1.p1.9.m9.4.5.2.6">𝑛</ci><ci id="S3.SS1.p1.9.m9.4.5.2.7.cmml" xref="S3.SS1.p1.9.m9.4.5.2.7">𝑡</ci><ci id="S3.SS1.p1.9.m9.4.5.2.8.cmml" xref="S3.SS1.p1.9.m9.4.5.2.8">𝑖</ci><ci id="S3.SS1.p1.9.m9.4.5.2.9.cmml" xref="S3.SS1.p1.9.m9.4.5.2.9">𝑜</ci><ci id="S3.SS1.p1.9.m9.4.5.2.10.cmml" xref="S3.SS1.p1.9.m9.4.5.2.10">𝑛</ci><vector id="S3.SS1.p1.9.m9.4.5.2.11.1.cmml" xref="S3.SS1.p1.9.m9.4.5.2.11.2"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑄</ci><ci id="S3.SS1.p1.9.m9.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2">𝐾</ci><ci id="S3.SS1.p1.9.m9.3.3.cmml" xref="S3.SS1.p1.9.m9.3.3">𝑉</ci></vector></apply><apply id="S3.SS1.p1.9.m9.4.5.3.cmml" xref="S3.SS1.p1.9.m9.4.5.3"><times id="S3.SS1.p1.9.m9.4.5.3.1.cmml" xref="S3.SS1.p1.9.m9.4.5.3.1"></times><ci id="S3.SS1.p1.9.m9.4.5.3.2.cmml" xref="S3.SS1.p1.9.m9.4.5.3.2">𝑠</ci><ci id="S3.SS1.p1.9.m9.4.5.3.3.cmml" xref="S3.SS1.p1.9.m9.4.5.3.3">𝑜</ci><ci id="S3.SS1.p1.9.m9.4.5.3.4.cmml" xref="S3.SS1.p1.9.m9.4.5.3.4">𝑓</ci><ci id="S3.SS1.p1.9.m9.4.5.3.5.cmml" xref="S3.SS1.p1.9.m9.4.5.3.5">𝑡</ci><ci id="S3.SS1.p1.9.m9.4.5.3.6.cmml" xref="S3.SS1.p1.9.m9.4.5.3.6">𝑚</ci><ci id="S3.SS1.p1.9.m9.4.5.3.7.cmml" xref="S3.SS1.p1.9.m9.4.5.3.7">𝑎</ci><ci id="S3.SS1.p1.9.m9.4.5.3.8.cmml" xref="S3.SS1.p1.9.m9.4.5.3.8">𝑥</ci><apply id="S3.SS1.p1.9.m9.4.4.cmml" xref="S3.SS1.p1.9.m9.4.5.3.9.2"><divide id="S3.SS1.p1.9.m9.4.4.1.cmml" xref="S3.SS1.p1.9.m9.4.5.3.9.2"></divide><apply id="S3.SS1.p1.9.m9.4.4.2.cmml" xref="S3.SS1.p1.9.m9.4.4.2"><times id="S3.SS1.p1.9.m9.4.4.2.1.cmml" xref="S3.SS1.p1.9.m9.4.4.2.1"></times><ci id="S3.SS1.p1.9.m9.4.4.2.2.cmml" xref="S3.SS1.p1.9.m9.4.4.2.2">𝑄</ci><apply id="S3.SS1.p1.9.m9.4.4.2.3.cmml" xref="S3.SS1.p1.9.m9.4.4.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.4.4.2.3.1.cmml" xref="S3.SS1.p1.9.m9.4.4.2.3">superscript</csymbol><ci id="S3.SS1.p1.9.m9.4.4.2.3.2.cmml" xref="S3.SS1.p1.9.m9.4.4.2.3.2">𝐾</ci><ci id="S3.SS1.p1.9.m9.4.4.2.3.3.cmml" xref="S3.SS1.p1.9.m9.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S3.SS1.p1.9.m9.4.4.3.cmml" xref="S3.SS1.p1.9.m9.4.4.3"><root id="S3.SS1.p1.9.m9.4.4.3a.cmml" xref="S3.SS1.p1.9.m9.4.4.3"></root><ci id="S3.SS1.p1.9.m9.4.4.3.2.cmml" xref="S3.SS1.p1.9.m9.4.4.3.2">𝑑</ci></apply></apply><ci id="S3.SS1.p1.9.m9.4.5.3.10.cmml" xref="S3.SS1.p1.9.m9.4.5.3.10">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.4c">Attention(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{d}})V</annotation></semantics></math>, where <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">d</annotation></semantics></math> is the number of columns of <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">Q</annotation></semantics></math>, <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">K</annotation></semantics></math> and <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">V</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.11" class="ltx_p">To simulate a federated scenario, we assume there are <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">N</annotation></semantics></math> clients indexed by <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="[N]" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.2.2" xref="S3.SS1.p2.2.m2.1.2.1.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.2.2.1" xref="S3.SS1.p2.2.m2.1.2.1.1.cmml">[</mo><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">N</mi><mo stretchy="false" id="S3.SS1.p2.2.m2.1.2.2.2" xref="S3.SS1.p2.2.m2.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2.2"><csymbol cd="latexml" id="S3.SS1.p2.2.m2.1.2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">[N]</annotation></semantics></math> and each client <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">i</annotation></semantics></math> has a local dataset <math id="S3.SS1.p2.4.m4.4" class="ltx_Math" alttext="{D}_{i}=\{(x_{i}^{(j)},y_{i}^{(j)})\}_{j=1}^{m_{i}}(1\leq i\leq N)" display="inline"><semantics id="S3.SS1.p2.4.m4.4a"><mrow id="S3.SS1.p2.4.m4.4.4" xref="S3.SS1.p2.4.m4.4.4.cmml"><msub id="S3.SS1.p2.4.m4.4.4.4" xref="S3.SS1.p2.4.m4.4.4.4.cmml"><mi id="S3.SS1.p2.4.m4.4.4.4.2" xref="S3.SS1.p2.4.m4.4.4.4.2.cmml">D</mi><mi id="S3.SS1.p2.4.m4.4.4.4.3" xref="S3.SS1.p2.4.m4.4.4.4.3.cmml">i</mi></msub><mo id="S3.SS1.p2.4.m4.4.4.3" xref="S3.SS1.p2.4.m4.4.4.3.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.4.4.2" xref="S3.SS1.p2.4.m4.4.4.2.cmml"><msubsup id="S3.SS1.p2.4.m4.3.3.1.1" xref="S3.SS1.p2.4.m4.3.3.1.1.cmml"><mrow id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.SS1.p2.4.m4.1.1.1.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.3.1" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p2.4.m4.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.3.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.4" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mrow id="S3.SS1.p2.4.m4.2.2.1.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.2.2.1.3.1" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="S3.SS1.p2.4.m4.2.2.1.1" xref="S3.SS1.p2.4.m4.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS1.p2.4.m4.2.2.1.3.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.5" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.4.m4.3.3.1.1.1.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.3.3.1.1.1.3.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.3.2.cmml">j</mi><mo id="S3.SS1.p2.4.m4.3.3.1.1.1.3.1" xref="S3.SS1.p2.4.m4.3.3.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.4.m4.3.3.1.1.1.3.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p2.4.m4.3.3.1.1.3" xref="S3.SS1.p2.4.m4.3.3.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.3.3.1.1.3.2" xref="S3.SS1.p2.4.m4.3.3.1.1.3.2.cmml">m</mi><mi id="S3.SS1.p2.4.m4.3.3.1.1.3.3" xref="S3.SS1.p2.4.m4.3.3.1.1.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.4.4.2.3" xref="S3.SS1.p2.4.m4.4.4.2.3.cmml">​</mo><mrow id="S3.SS1.p2.4.m4.4.4.2.2.1" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.4.4.2.2.1.2" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.cmml">(</mo><mrow id="S3.SS1.p2.4.m4.4.4.2.2.1.1" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.cmml"><mn id="S3.SS1.p2.4.m4.4.4.2.2.1.1.2" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.2.cmml">1</mn><mo id="S3.SS1.p2.4.m4.4.4.2.2.1.1.3" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.3.cmml">≤</mo><mi id="S3.SS1.p2.4.m4.4.4.2.2.1.1.4" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.4.cmml">i</mi><mo id="S3.SS1.p2.4.m4.4.4.2.2.1.1.5" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.5.cmml">≤</mo><mi id="S3.SS1.p2.4.m4.4.4.2.2.1.1.6" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.6.cmml">N</mi></mrow><mo stretchy="false" id="S3.SS1.p2.4.m4.4.4.2.2.1.3" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.4b"><apply id="S3.SS1.p2.4.m4.4.4.cmml" xref="S3.SS1.p2.4.m4.4.4"><eq id="S3.SS1.p2.4.m4.4.4.3.cmml" xref="S3.SS1.p2.4.m4.4.4.3"></eq><apply id="S3.SS1.p2.4.m4.4.4.4.cmml" xref="S3.SS1.p2.4.m4.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.4.4.4.1.cmml" xref="S3.SS1.p2.4.m4.4.4.4">subscript</csymbol><ci id="S3.SS1.p2.4.m4.4.4.4.2.cmml" xref="S3.SS1.p2.4.m4.4.4.4.2">𝐷</ci><ci id="S3.SS1.p2.4.m4.4.4.4.3.cmml" xref="S3.SS1.p2.4.m4.4.4.4.3">𝑖</ci></apply><apply id="S3.SS1.p2.4.m4.4.4.2.cmml" xref="S3.SS1.p2.4.m4.4.4.2"><times id="S3.SS1.p2.4.m4.4.4.2.3.cmml" xref="S3.SS1.p2.4.m4.4.4.2.3"></times><apply id="S3.SS1.p2.4.m4.3.3.1.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.3.1.1.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1">superscript</csymbol><apply id="S3.SS1.p2.4.m4.3.3.1.1.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1">subscript</csymbol><set id="S3.SS1.p2.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1"><interval closure="open" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2"><apply id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1">𝑗</ci></apply><apply id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.4.m4.2.2.1.1.cmml" xref="S3.SS1.p2.4.m4.2.2.1.1">𝑗</ci></apply></interval></set><apply id="S3.SS1.p2.4.m4.3.3.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.3"><eq id="S3.SS1.p2.4.m4.3.3.1.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.3.1"></eq><ci id="S3.SS1.p2.4.m4.3.3.1.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS1.p2.4.m4.3.3.1.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.4.m4.3.3.1.1.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.3.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.3.3.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.3.2">𝑚</ci><ci id="S3.SS1.p2.4.m4.3.3.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.p2.4.m4.4.4.2.2.1.1.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1"><and id="S3.SS1.p2.4.m4.4.4.2.2.1.1a.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1"></and><apply id="S3.SS1.p2.4.m4.4.4.2.2.1.1b.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1"><leq id="S3.SS1.p2.4.m4.4.4.2.2.1.1.3.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.3"></leq><cn type="integer" id="S3.SS1.p2.4.m4.4.4.2.2.1.1.2.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.2">1</cn><ci id="S3.SS1.p2.4.m4.4.4.2.2.1.1.4.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.4">𝑖</ci></apply><apply id="S3.SS1.p2.4.m4.4.4.2.2.1.1c.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1"><leq id="S3.SS1.p2.4.m4.4.4.2.2.1.1.5.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.5"></leq><share href="#S3.SS1.p2.4.m4.4.4.2.2.1.1.4.cmml" id="S3.SS1.p2.4.m4.4.4.2.2.1.1d.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1"></share><ci id="S3.SS1.p2.4.m4.4.4.2.2.1.1.6.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2.1.1.6">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.4c">{D}_{i}=\{(x_{i}^{(j)},y_{i}^{(j)})\}_{j=1}^{m_{i}}(1\leq i\leq N)</annotation></semantics></math> with <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">m</mi><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝑚</ci><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">m_{i}</annotation></semantics></math> samples drawn from a distinct data distribution <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{P}_{i}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">𝒫</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝒫</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathcal{P}_{i}</annotation></semantics></math>. Let <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="{D}=\bigcup_{i\in[N]}{D}_{i}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mrow id="S3.SS1.p2.7.m7.1.2" xref="S3.SS1.p2.7.m7.1.2.cmml"><mi id="S3.SS1.p2.7.m7.1.2.2" xref="S3.SS1.p2.7.m7.1.2.2.cmml">D</mi><mo rspace="0.111em" id="S3.SS1.p2.7.m7.1.2.1" xref="S3.SS1.p2.7.m7.1.2.1.cmml">=</mo><mrow id="S3.SS1.p2.7.m7.1.2.3" xref="S3.SS1.p2.7.m7.1.2.3.cmml"><msub id="S3.SS1.p2.7.m7.1.2.3.1" xref="S3.SS1.p2.7.m7.1.2.3.1.cmml"><mo id="S3.SS1.p2.7.m7.1.2.3.1.2" xref="S3.SS1.p2.7.m7.1.2.3.1.2.cmml">⋃</mo><mrow id="S3.SS1.p2.7.m7.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.1.3" xref="S3.SS1.p2.7.m7.1.1.1.3.cmml">i</mi><mo id="S3.SS1.p2.7.m7.1.1.1.2" xref="S3.SS1.p2.7.m7.1.1.1.2.cmml">∈</mo><mrow id="S3.SS1.p2.7.m7.1.1.1.4.2" xref="S3.SS1.p2.7.m7.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.1.1.1.4.2.1" xref="S3.SS1.p2.7.m7.1.1.1.4.1.1.cmml">[</mo><mi id="S3.SS1.p2.7.m7.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.1.cmml">N</mi><mo stretchy="false" id="S3.SS1.p2.7.m7.1.1.1.4.2.2" xref="S3.SS1.p2.7.m7.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="S3.SS1.p2.7.m7.1.2.3.2" xref="S3.SS1.p2.7.m7.1.2.3.2.cmml"><mi id="S3.SS1.p2.7.m7.1.2.3.2.2" xref="S3.SS1.p2.7.m7.1.2.3.2.2.cmml">D</mi><mi id="S3.SS1.p2.7.m7.1.2.3.2.3" xref="S3.SS1.p2.7.m7.1.2.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.2.cmml" xref="S3.SS1.p2.7.m7.1.2"><eq id="S3.SS1.p2.7.m7.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.1"></eq><ci id="S3.SS1.p2.7.m7.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2">𝐷</ci><apply id="S3.SS1.p2.7.m7.1.2.3.cmml" xref="S3.SS1.p2.7.m7.1.2.3"><apply id="S3.SS1.p2.7.m7.1.2.3.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.3.1.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1">subscript</csymbol><union id="S3.SS1.p2.7.m7.1.2.3.1.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.2"></union><apply id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1"><in id="S3.SS1.p2.7.m7.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.1.2"></in><ci id="S3.SS1.p2.7.m7.1.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.1.3">𝑖</ci><apply id="S3.SS1.p2.7.m7.1.1.1.4.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.4.2"><csymbol cd="latexml" id="S3.SS1.p2.7.m7.1.1.1.4.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS1.p2.7.m7.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1">𝑁</ci></apply></apply></apply><apply id="S3.SS1.p2.7.m7.1.2.3.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.3.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.2.3.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2">𝐷</ci><ci id="S3.SS1.p2.7.m7.1.2.3.2.3.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">{D}=\bigcup_{i\in[N]}{D}_{i}</annotation></semantics></math> denote the total datasets with the size of <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="M=\sum_{i=1}^{N}m_{i}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">M</mi><mo rspace="0.111em" id="S3.SS1.p2.8.m8.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml"><msubsup id="S3.SS1.p2.8.m8.1.1.3.1" xref="S3.SS1.p2.8.m8.1.1.3.1.cmml"><mo id="S3.SS1.p2.8.m8.1.1.3.1.2.2" xref="S3.SS1.p2.8.m8.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p2.8.m8.1.1.3.1.2.3" xref="S3.SS1.p2.8.m8.1.1.3.1.2.3.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.1.2.3.2" xref="S3.SS1.p2.8.m8.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p2.8.m8.1.1.3.1.2.3.1" xref="S3.SS1.p2.8.m8.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p2.8.m8.1.1.3.1.2.3.3" xref="S3.SS1.p2.8.m8.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.8.m8.1.1.3.1.3" xref="S3.SS1.p2.8.m8.1.1.3.1.3.cmml">N</mi></msubsup><msub id="S3.SS1.p2.8.m8.1.1.3.2" xref="S3.SS1.p2.8.m8.1.1.3.2.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.2.2" xref="S3.SS1.p2.8.m8.1.1.3.2.2.cmml">m</mi><mi id="S3.SS1.p2.8.m8.1.1.3.2.3" xref="S3.SS1.p2.8.m8.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><eq id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1"></eq><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝑀</ci><apply id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3"><apply id="S3.SS1.p2.8.m8.1.1.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1">superscript</csymbol><apply id="S3.SS1.p2.8.m8.1.1.3.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p2.8.m8.1.1.3.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1.2.2"></sum><apply id="S3.SS1.p2.8.m8.1.1.3.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1.2.3"><eq id="S3.SS1.p2.8.m8.1.1.3.1.2.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1.2.3.1"></eq><ci id="S3.SS1.p2.8.m8.1.1.3.1.2.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p2.8.m8.1.1.3.1.2.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.8.m8.1.1.3.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1.3">𝑁</ci></apply><apply id="S3.SS1.p2.8.m8.1.1.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.3.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2.2">𝑚</ci><ci id="S3.SS1.p2.8.m8.1.1.3.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">M=\sum_{i=1}^{N}m_{i}</annotation></semantics></math>, and let <math id="S3.SS1.p2.9.m9.2" class="ltx_Math" alttext="f(\theta_{i};\cdot)" display="inline"><semantics id="S3.SS1.p2.9.m9.2a"><mrow id="S3.SS1.p2.9.m9.2.2" xref="S3.SS1.p2.9.m9.2.2.cmml"><mi id="S3.SS1.p2.9.m9.2.2.3" xref="S3.SS1.p2.9.m9.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.9.m9.2.2.2" xref="S3.SS1.p2.9.m9.2.2.2.cmml">​</mo><mrow id="S3.SS1.p2.9.m9.2.2.1.1" xref="S3.SS1.p2.9.m9.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.9.m9.2.2.1.1.2" xref="S3.SS1.p2.9.m9.2.2.1.2.cmml">(</mo><msub id="S3.SS1.p2.9.m9.2.2.1.1.1" xref="S3.SS1.p2.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.9.m9.2.2.1.1.1.2" xref="S3.SS1.p2.9.m9.2.2.1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p2.9.m9.2.2.1.1.1.3" xref="S3.SS1.p2.9.m9.2.2.1.1.1.3.cmml">i</mi></msub><mo rspace="0em" id="S3.SS1.p2.9.m9.2.2.1.1.3" xref="S3.SS1.p2.9.m9.2.2.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p2.9.m9.2.2.1.1.4" xref="S3.SS1.p2.9.m9.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.2b"><apply id="S3.SS1.p2.9.m9.2.2.cmml" xref="S3.SS1.p2.9.m9.2.2"><times id="S3.SS1.p2.9.m9.2.2.2.cmml" xref="S3.SS1.p2.9.m9.2.2.2"></times><ci id="S3.SS1.p2.9.m9.2.2.3.cmml" xref="S3.SS1.p2.9.m9.2.2.3">𝑓</ci><list id="S3.SS1.p2.9.m9.2.2.1.2.cmml" xref="S3.SS1.p2.9.m9.2.2.1.1"><apply id="S3.SS1.p2.9.m9.2.2.1.1.1.cmml" xref="S3.SS1.p2.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.9.m9.2.2.1.1.1.2">𝜃</ci><ci id="S3.SS1.p2.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.9.m9.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.2c">f(\theta_{i};\cdot)</annotation></semantics></math> denote a personalized model for client <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><mi id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">i</annotation></semantics></math>, parameterized by <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><msub id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">θ</mi><mi id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2">𝜃</ci><ci id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">\theta_{i}</annotation></semantics></math>. The optimization objective is:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\centering\mathop{\arg\min}\limits_{\Theta}\sum_{i=1}^{N}\frac{m_{i}}{M}\mathcal{L}_{i}(\theta_{i}),\@add@centering" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><munder id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1" xref="S3.E1.m1.1.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1.m1.1.1.1.1.2.2a" xref="S3.E1.m1.1.1.1.1.2.2.cmml">⁡</mo><mi id="S3.E1.m1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.cmml">min</mi></mrow><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml">Θ</mi></munder><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mfrac id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.cmml">m</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mi id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.1.1.1.4.2.cmml">ℒ</mi><mi id="S3.E1.m1.1.1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.1.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><arg id="S3.E1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1"></arg><min id="S3.E1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2"></min></apply><ci id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3">Θ</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><divide id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"></divide><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2">𝑚</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2">ℒ</ci><ci id="S3.E1.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\centering\mathop{\arg\min}\limits_{\Theta}\sum_{i=1}^{N}\frac{m_{i}}{M}\mathcal{L}_{i}(\theta_{i}),\@add@centering</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.14" class="ltx_p">with
<math id="S3.SS1.p2.12.m1.9" class="ltx_Math" alttext="\mathcal{L}_{i}(\theta_{i})=\mathbb{E}_{(x_{i}^{(j)},y_{i}^{(j)})\in{D}_{i}}l(f(\theta_{i};x_{i}^{(j)}),y_{i}^{(j)})" display="inline"><semantics id="S3.SS1.p2.12.m1.9a"><mrow id="S3.SS1.p2.12.m1.9.9" xref="S3.SS1.p2.12.m1.9.9.cmml"><mrow id="S3.SS1.p2.12.m1.7.7.1" xref="S3.SS1.p2.12.m1.7.7.1.cmml"><msub id="S3.SS1.p2.12.m1.7.7.1.3" xref="S3.SS1.p2.12.m1.7.7.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.12.m1.7.7.1.3.2" xref="S3.SS1.p2.12.m1.7.7.1.3.2.cmml">ℒ</mi><mi id="S3.SS1.p2.12.m1.7.7.1.3.3" xref="S3.SS1.p2.12.m1.7.7.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.12.m1.7.7.1.2" xref="S3.SS1.p2.12.m1.7.7.1.2.cmml">​</mo><mrow id="S3.SS1.p2.12.m1.7.7.1.1.1" xref="S3.SS1.p2.12.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m1.7.7.1.1.1.2" xref="S3.SS1.p2.12.m1.7.7.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.12.m1.7.7.1.1.1.1" xref="S3.SS1.p2.12.m1.7.7.1.1.1.1.cmml"><mi id="S3.SS1.p2.12.m1.7.7.1.1.1.1.2" xref="S3.SS1.p2.12.m1.7.7.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p2.12.m1.7.7.1.1.1.1.3" xref="S3.SS1.p2.12.m1.7.7.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.12.m1.7.7.1.1.1.3" xref="S3.SS1.p2.12.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.12.m1.9.9.4" xref="S3.SS1.p2.12.m1.9.9.4.cmml">=</mo><mrow id="S3.SS1.p2.12.m1.9.9.3" xref="S3.SS1.p2.12.m1.9.9.3.cmml"><msub id="S3.SS1.p2.12.m1.9.9.3.4" xref="S3.SS1.p2.12.m1.9.9.3.4.cmml"><mi id="S3.SS1.p2.12.m1.9.9.3.4.2" xref="S3.SS1.p2.12.m1.9.9.3.4.2.cmml">𝔼</mi><mrow id="S3.SS1.p2.12.m1.4.4.4" xref="S3.SS1.p2.12.m1.4.4.4.cmml"><mrow id="S3.SS1.p2.12.m1.4.4.4.4.2" xref="S3.SS1.p2.12.m1.4.4.4.4.3.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m1.4.4.4.4.2.3" xref="S3.SS1.p2.12.m1.4.4.4.4.3.cmml">(</mo><msubsup id="S3.SS1.p2.12.m1.3.3.3.3.1.1" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1.cmml"><mi id="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.2" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.3" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.3.cmml">i</mi><mrow id="S3.SS1.p2.12.m1.1.1.1.1.1.3" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m1.1.1.1.1.1.3.1" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1.cmml">(</mo><mi id="S3.SS1.p2.12.m1.1.1.1.1.1.1" xref="S3.SS1.p2.12.m1.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS1.p2.12.m1.1.1.1.1.1.3.2" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p2.12.m1.4.4.4.4.2.4" xref="S3.SS1.p2.12.m1.4.4.4.4.3.cmml">,</mo><msubsup id="S3.SS1.p2.12.m1.4.4.4.4.2.2" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2.cmml"><mi id="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.2" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.3" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.3.cmml">i</mi><mrow id="S3.SS1.p2.12.m1.2.2.2.2.1.3" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m1.2.2.2.2.1.3.1" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2.cmml">(</mo><mi id="S3.SS1.p2.12.m1.2.2.2.2.1.1" xref="S3.SS1.p2.12.m1.2.2.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS1.p2.12.m1.2.2.2.2.1.3.2" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS1.p2.12.m1.4.4.4.4.2.5" xref="S3.SS1.p2.12.m1.4.4.4.4.3.cmml">)</mo></mrow><mo id="S3.SS1.p2.12.m1.4.4.4.5" xref="S3.SS1.p2.12.m1.4.4.4.5.cmml">∈</mo><msub id="S3.SS1.p2.12.m1.4.4.4.6" xref="S3.SS1.p2.12.m1.4.4.4.6.cmml"><mi id="S3.SS1.p2.12.m1.4.4.4.6.2" xref="S3.SS1.p2.12.m1.4.4.4.6.2.cmml">D</mi><mi id="S3.SS1.p2.12.m1.4.4.4.6.3" xref="S3.SS1.p2.12.m1.4.4.4.6.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.12.m1.9.9.3.3" xref="S3.SS1.p2.12.m1.9.9.3.3.cmml">​</mo><mi id="S3.SS1.p2.12.m1.9.9.3.5" xref="S3.SS1.p2.12.m1.9.9.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.12.m1.9.9.3.3a" xref="S3.SS1.p2.12.m1.9.9.3.3.cmml">​</mo><mrow id="S3.SS1.p2.12.m1.9.9.3.2.2" xref="S3.SS1.p2.12.m1.9.9.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m1.9.9.3.2.2.3" xref="S3.SS1.p2.12.m1.9.9.3.2.3.cmml">(</mo><mrow id="S3.SS1.p2.12.m1.8.8.2.1.1.1" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.cmml"><mi id="S3.SS1.p2.12.m1.8.8.2.1.1.1.4" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.12.m1.8.8.2.1.1.1.3" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.3.cmml">​</mo><mrow id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.3" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.3.cmml">(</mo><msub id="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.2" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.3" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.4" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.3.cmml">;</mo><msubsup id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.2" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.3" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS1.p2.12.m1.5.5.1.3" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m1.5.5.1.3.1" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.cmml">(</mo><mi id="S3.SS1.p2.12.m1.5.5.1.1" xref="S3.SS1.p2.12.m1.5.5.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS1.p2.12.m1.5.5.1.3.2" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.5" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.12.m1.9.9.3.2.2.4" xref="S3.SS1.p2.12.m1.9.9.3.2.3.cmml">,</mo><msubsup id="S3.SS1.p2.12.m1.9.9.3.2.2.2" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2.cmml"><mi id="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.2" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.3" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS1.p2.12.m1.6.6.1.3" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m1.6.6.1.3.1" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2.cmml">(</mo><mi id="S3.SS1.p2.12.m1.6.6.1.1" xref="S3.SS1.p2.12.m1.6.6.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS1.p2.12.m1.6.6.1.3.2" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS1.p2.12.m1.9.9.3.2.2.5" xref="S3.SS1.p2.12.m1.9.9.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m1.9b"><apply id="S3.SS1.p2.12.m1.9.9.cmml" xref="S3.SS1.p2.12.m1.9.9"><eq id="S3.SS1.p2.12.m1.9.9.4.cmml" xref="S3.SS1.p2.12.m1.9.9.4"></eq><apply id="S3.SS1.p2.12.m1.7.7.1.cmml" xref="S3.SS1.p2.12.m1.7.7.1"><times id="S3.SS1.p2.12.m1.7.7.1.2.cmml" xref="S3.SS1.p2.12.m1.7.7.1.2"></times><apply id="S3.SS1.p2.12.m1.7.7.1.3.cmml" xref="S3.SS1.p2.12.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.7.7.1.3.1.cmml" xref="S3.SS1.p2.12.m1.7.7.1.3">subscript</csymbol><ci id="S3.SS1.p2.12.m1.7.7.1.3.2.cmml" xref="S3.SS1.p2.12.m1.7.7.1.3.2">ℒ</ci><ci id="S3.SS1.p2.12.m1.7.7.1.3.3.cmml" xref="S3.SS1.p2.12.m1.7.7.1.3.3">𝑖</ci></apply><apply id="S3.SS1.p2.12.m1.7.7.1.1.1.1.cmml" xref="S3.SS1.p2.12.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.7.7.1.1.1.1.1.cmml" xref="S3.SS1.p2.12.m1.7.7.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m1.7.7.1.1.1.1.2.cmml" xref="S3.SS1.p2.12.m1.7.7.1.1.1.1.2">𝜃</ci><ci id="S3.SS1.p2.12.m1.7.7.1.1.1.1.3.cmml" xref="S3.SS1.p2.12.m1.7.7.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS1.p2.12.m1.9.9.3.cmml" xref="S3.SS1.p2.12.m1.9.9.3"><times id="S3.SS1.p2.12.m1.9.9.3.3.cmml" xref="S3.SS1.p2.12.m1.9.9.3.3"></times><apply id="S3.SS1.p2.12.m1.9.9.3.4.cmml" xref="S3.SS1.p2.12.m1.9.9.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.9.9.3.4.1.cmml" xref="S3.SS1.p2.12.m1.9.9.3.4">subscript</csymbol><ci id="S3.SS1.p2.12.m1.9.9.3.4.2.cmml" xref="S3.SS1.p2.12.m1.9.9.3.4.2">𝔼</ci><apply id="S3.SS1.p2.12.m1.4.4.4.cmml" xref="S3.SS1.p2.12.m1.4.4.4"><in id="S3.SS1.p2.12.m1.4.4.4.5.cmml" xref="S3.SS1.p2.12.m1.4.4.4.5"></in><interval closure="open" id="S3.SS1.p2.12.m1.4.4.4.4.3.cmml" xref="S3.SS1.p2.12.m1.4.4.4.4.2"><apply id="S3.SS1.p2.12.m1.3.3.3.3.1.1.cmml" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.3.3.3.3.1.1.1.cmml" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1">superscript</csymbol><apply id="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.cmml" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.1.cmml" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.2.cmml" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.2">𝑥</ci><ci id="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.SS1.p2.12.m1.3.3.3.3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.12.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.12.m1.1.1.1.1.1.1">𝑗</ci></apply><apply id="S3.SS1.p2.12.m1.4.4.4.4.2.2.cmml" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.4.4.4.4.2.2.1.cmml" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2">superscript</csymbol><apply id="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.cmml" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2">subscript</csymbol><ci id="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.2">𝑦</ci><ci id="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.SS1.p2.12.m1.4.4.4.4.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.12.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.12.m1.2.2.2.2.1.1">𝑗</ci></apply></interval><apply id="S3.SS1.p2.12.m1.4.4.4.6.cmml" xref="S3.SS1.p2.12.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.4.4.4.6.1.cmml" xref="S3.SS1.p2.12.m1.4.4.4.6">subscript</csymbol><ci id="S3.SS1.p2.12.m1.4.4.4.6.2.cmml" xref="S3.SS1.p2.12.m1.4.4.4.6.2">𝐷</ci><ci id="S3.SS1.p2.12.m1.4.4.4.6.3.cmml" xref="S3.SS1.p2.12.m1.4.4.4.6.3">𝑖</ci></apply></apply></apply><ci id="S3.SS1.p2.12.m1.9.9.3.5.cmml" xref="S3.SS1.p2.12.m1.9.9.3.5">𝑙</ci><interval closure="open" id="S3.SS1.p2.12.m1.9.9.3.2.3.cmml" xref="S3.SS1.p2.12.m1.9.9.3.2.2"><apply id="S3.SS1.p2.12.m1.8.8.2.1.1.1.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1"><times id="S3.SS1.p2.12.m1.8.8.2.1.1.1.3.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.3"></times><ci id="S3.SS1.p2.12.m1.8.8.2.1.1.1.4.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.4">𝑓</ci><list id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.3.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2"><apply id="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2">superscript</csymbol><apply id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.1.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.2.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.3.cmml" xref="S3.SS1.p2.12.m1.8.8.2.1.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.12.m1.5.5.1.1.cmml" xref="S3.SS1.p2.12.m1.5.5.1.1">𝑗</ci></apply></list></apply><apply id="S3.SS1.p2.12.m1.9.9.3.2.2.2.cmml" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.9.9.3.2.2.2.1.cmml" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2">superscript</csymbol><apply id="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.cmml" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.1.cmml" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.2.cmml" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.3.cmml" xref="S3.SS1.p2.12.m1.9.9.3.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.12.m1.6.6.1.1.cmml" xref="S3.SS1.p2.12.m1.6.6.1.1">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m1.9c">\mathcal{L}_{i}(\theta_{i})=\mathbb{E}_{(x_{i}^{(j)},y_{i}^{(j)})\in{D}_{i}}l(f(\theta_{i};x_{i}^{(j)}),y_{i}^{(j)})</annotation></semantics></math>,
where <math id="S3.SS1.p2.13.m2.1" class="ltx_Math" alttext="\Theta=\{\theta_{i}\}_{i=1}^{N}" display="inline"><semantics id="S3.SS1.p2.13.m2.1a"><mrow id="S3.SS1.p2.13.m2.1.1" xref="S3.SS1.p2.13.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.13.m2.1.1.3" xref="S3.SS1.p2.13.m2.1.1.3.cmml">Θ</mi><mo id="S3.SS1.p2.13.m2.1.1.2" xref="S3.SS1.p2.13.m2.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p2.13.m2.1.1.1" xref="S3.SS1.p2.13.m2.1.1.1.cmml"><mrow id="S3.SS1.p2.13.m2.1.1.1.1.1.1" xref="S3.SS1.p2.13.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.13.m2.1.1.1.1.1.1.2" xref="S3.SS1.p2.13.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.13.m2.1.1.1.1.1.1.1" xref="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.13.m2.1.1.1.1.1.1.3" xref="S3.SS1.p2.13.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.13.m2.1.1.1.1.3" xref="S3.SS1.p2.13.m2.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.13.m2.1.1.1.1.3.2" xref="S3.SS1.p2.13.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.13.m2.1.1.1.1.3.1" xref="S3.SS1.p2.13.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.13.m2.1.1.1.1.3.3" xref="S3.SS1.p2.13.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.13.m2.1.1.1.3" xref="S3.SS1.p2.13.m2.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m2.1b"><apply id="S3.SS1.p2.13.m2.1.1.cmml" xref="S3.SS1.p2.13.m2.1.1"><eq id="S3.SS1.p2.13.m2.1.1.2.cmml" xref="S3.SS1.p2.13.m2.1.1.2"></eq><ci id="S3.SS1.p2.13.m2.1.1.3.cmml" xref="S3.SS1.p2.13.m2.1.1.3">Θ</ci><apply id="S3.SS1.p2.13.m2.1.1.1.cmml" xref="S3.SS1.p2.13.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m2.1.1.1.2.cmml" xref="S3.SS1.p2.13.m2.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.13.m2.1.1.1.1.cmml" xref="S3.SS1.p2.13.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m2.1.1.1.1.2.cmml" xref="S3.SS1.p2.13.m2.1.1.1">subscript</csymbol><set id="S3.SS1.p2.13.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.1.1"><apply id="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p2.13.m2.1.1.1.1.3.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.3"><eq id="S3.SS1.p2.13.m2.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.3.1"></eq><ci id="S3.SS1.p2.13.m2.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p2.13.m2.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.13.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.13.m2.1.1.1.3.cmml" xref="S3.SS1.p2.13.m2.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m2.1c">\Theta=\{\theta_{i}\}_{i=1}^{N}</annotation></semantics></math> is the set of personalized parameters, and <math id="S3.SS1.p2.14.m3.2" class="ltx_Math" alttext="l(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.p2.14.m3.2a"><mrow id="S3.SS1.p2.14.m3.2.3" xref="S3.SS1.p2.14.m3.2.3.cmml"><mi id="S3.SS1.p2.14.m3.2.3.2" xref="S3.SS1.p2.14.m3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.14.m3.2.3.1" xref="S3.SS1.p2.14.m3.2.3.1.cmml">​</mo><mrow id="S3.SS1.p2.14.m3.2.3.3.2" xref="S3.SS1.p2.14.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.14.m3.2.3.3.2.1" xref="S3.SS1.p2.14.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p2.14.m3.1.1" xref="S3.SS1.p2.14.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.p2.14.m3.2.3.3.2.2" xref="S3.SS1.p2.14.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p2.14.m3.2.2" xref="S3.SS1.p2.14.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p2.14.m3.2.3.3.2.3" xref="S3.SS1.p2.14.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m3.2b"><apply id="S3.SS1.p2.14.m3.2.3.cmml" xref="S3.SS1.p2.14.m3.2.3"><times id="S3.SS1.p2.14.m3.2.3.1.cmml" xref="S3.SS1.p2.14.m3.2.3.1"></times><ci id="S3.SS1.p2.14.m3.2.3.2.cmml" xref="S3.SS1.p2.14.m3.2.3.2">𝑙</ci><interval closure="open" id="S3.SS1.p2.14.m3.2.3.3.1.cmml" xref="S3.SS1.p2.14.m3.2.3.3.2"><ci id="S3.SS1.p2.14.m3.1.1.cmml" xref="S3.SS1.p2.14.m3.1.1">⋅</ci><ci id="S3.SS1.p2.14.m3.2.2.cmml" xref="S3.SS1.p2.14.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m3.2c">l(\cdot,\cdot)</annotation></semantics></math> denotes the per sample loss function common to all clients. The loss function can be Mean Square Error or Cross Entropy Loss, which is selected according to different tasks.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Vanilla personalization for self-attention</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Transformer-based federated learning has received increasing attention. It is well known that Transformer can capture global interactions between the inputs by the self-attention layers. As we analyzed in Introduction, simply applying the FedAvg operation on the self-attention layers of clients may degrade the model’s performance in data heterogeneity scenarios. Inspired by this, we first develop a personalized self-attention mechanism that maintains the self-attention layers of each client locally so as to personalize the model, while averaging other parameters to learn the common information. The left side of Fig. <a href="#S3.F2" title="Figure 2 ‣ III Federated learning by Transformer Personalization ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the structure of vanilla personalization for self-attention.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.11" class="ltx_p">Similar to FedAvg, these parameters are updated via local training for several epochs and aggregated on the server. Let <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">W</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑊</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">W_{i}</annotation></semantics></math> denote the projection parameters of the self-attention layer, and let <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\xi" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\xi</annotation></semantics></math> denote the parameters of other layers. The personalized parameter <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">θ</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝜃</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\theta_{i}</annotation></semantics></math> is then be split into <math id="S3.SS2.p2.4.m4.2" class="ltx_Math" alttext="\theta_{i}=\{W_{i},\xi\}" display="inline"><semantics id="S3.SS2.p2.4.m4.2a"><mrow id="S3.SS2.p2.4.m4.2.2" xref="S3.SS2.p2.4.m4.2.2.cmml"><msub id="S3.SS2.p2.4.m4.2.2.3" xref="S3.SS2.p2.4.m4.2.2.3.cmml"><mi id="S3.SS2.p2.4.m4.2.2.3.2" xref="S3.SS2.p2.4.m4.2.2.3.2.cmml">θ</mi><mi id="S3.SS2.p2.4.m4.2.2.3.3" xref="S3.SS2.p2.4.m4.2.2.3.3.cmml">i</mi></msub><mo id="S3.SS2.p2.4.m4.2.2.2" xref="S3.SS2.p2.4.m4.2.2.2.cmml">=</mo><mrow id="S3.SS2.p2.4.m4.2.2.1.1" xref="S3.SS2.p2.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m4.2.2.1.1.2" xref="S3.SS2.p2.4.m4.2.2.1.2.cmml">{</mo><msub id="S3.SS2.p2.4.m4.2.2.1.1.1" xref="S3.SS2.p2.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.4.m4.2.2.1.1.1.2" xref="S3.SS2.p2.4.m4.2.2.1.1.1.2.cmml">W</mi><mi id="S3.SS2.p2.4.m4.2.2.1.1.1.3" xref="S3.SS2.p2.4.m4.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.4.m4.2.2.1.1.3" xref="S3.SS2.p2.4.m4.2.2.1.2.cmml">,</mo><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">ξ</mi><mo stretchy="false" id="S3.SS2.p2.4.m4.2.2.1.1.4" xref="S3.SS2.p2.4.m4.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.2b"><apply id="S3.SS2.p2.4.m4.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2"><eq id="S3.SS2.p2.4.m4.2.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2.2"></eq><apply id="S3.SS2.p2.4.m4.2.2.3.cmml" xref="S3.SS2.p2.4.m4.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.2.2.3.1.cmml" xref="S3.SS2.p2.4.m4.2.2.3">subscript</csymbol><ci id="S3.SS2.p2.4.m4.2.2.3.2.cmml" xref="S3.SS2.p2.4.m4.2.2.3.2">𝜃</ci><ci id="S3.SS2.p2.4.m4.2.2.3.3.cmml" xref="S3.SS2.p2.4.m4.2.2.3.3">𝑖</ci></apply><set id="S3.SS2.p2.4.m4.2.2.1.2.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1"><apply id="S3.SS2.p2.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1.1.2">𝑊</ci><ci id="S3.SS2.p2.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝜉</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.2c">\theta_{i}=\{W_{i},\xi\}</annotation></semantics></math>. During the communication round <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">t</annotation></semantics></math>, the personalized model <math id="S3.SS2.p2.6.m6.5" class="ltx_Math" alttext="f(\theta_{i};\cdot)=f(W_{i},\xi;\cdot)" display="inline"><semantics id="S3.SS2.p2.6.m6.5a"><mrow id="S3.SS2.p2.6.m6.5.5" xref="S3.SS2.p2.6.m6.5.5.cmml"><mrow id="S3.SS2.p2.6.m6.4.4.1" xref="S3.SS2.p2.6.m6.4.4.1.cmml"><mi id="S3.SS2.p2.6.m6.4.4.1.3" xref="S3.SS2.p2.6.m6.4.4.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m6.4.4.1.2" xref="S3.SS2.p2.6.m6.4.4.1.2.cmml">​</mo><mrow id="S3.SS2.p2.6.m6.4.4.1.1.1" xref="S3.SS2.p2.6.m6.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m6.4.4.1.1.1.2" xref="S3.SS2.p2.6.m6.4.4.1.1.2.cmml">(</mo><msub id="S3.SS2.p2.6.m6.4.4.1.1.1.1" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.cmml"><mi id="S3.SS2.p2.6.m6.4.4.1.1.1.1.2" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p2.6.m6.4.4.1.1.1.1.3" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0em" id="S3.SS2.p2.6.m6.4.4.1.1.1.3" xref="S3.SS2.p2.6.m6.4.4.1.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p2.6.m6.4.4.1.1.1.4" xref="S3.SS2.p2.6.m6.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.6.m6.5.5.3" xref="S3.SS2.p2.6.m6.5.5.3.cmml">=</mo><mrow id="S3.SS2.p2.6.m6.5.5.2" xref="S3.SS2.p2.6.m6.5.5.2.cmml"><mi id="S3.SS2.p2.6.m6.5.5.2.3" xref="S3.SS2.p2.6.m6.5.5.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m6.5.5.2.2" xref="S3.SS2.p2.6.m6.5.5.2.2.cmml">​</mo><mrow id="S3.SS2.p2.6.m6.5.5.2.1.1" xref="S3.SS2.p2.6.m6.5.5.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m6.5.5.2.1.1.2" xref="S3.SS2.p2.6.m6.5.5.2.1.2.cmml">(</mo><msub id="S3.SS2.p2.6.m6.5.5.2.1.1.1" xref="S3.SS2.p2.6.m6.5.5.2.1.1.1.cmml"><mi id="S3.SS2.p2.6.m6.5.5.2.1.1.1.2" xref="S3.SS2.p2.6.m6.5.5.2.1.1.1.2.cmml">W</mi><mi id="S3.SS2.p2.6.m6.5.5.2.1.1.1.3" xref="S3.SS2.p2.6.m6.5.5.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.6.m6.5.5.2.1.1.3" xref="S3.SS2.p2.6.m6.5.5.2.1.2.cmml">,</mo><mi id="S3.SS2.p2.6.m6.2.2" xref="S3.SS2.p2.6.m6.2.2.cmml">ξ</mi><mo rspace="0em" id="S3.SS2.p2.6.m6.5.5.2.1.1.4" xref="S3.SS2.p2.6.m6.5.5.2.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m6.3.3" xref="S3.SS2.p2.6.m6.3.3.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p2.6.m6.5.5.2.1.1.5" xref="S3.SS2.p2.6.m6.5.5.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.5b"><apply id="S3.SS2.p2.6.m6.5.5.cmml" xref="S3.SS2.p2.6.m6.5.5"><eq id="S3.SS2.p2.6.m6.5.5.3.cmml" xref="S3.SS2.p2.6.m6.5.5.3"></eq><apply id="S3.SS2.p2.6.m6.4.4.1.cmml" xref="S3.SS2.p2.6.m6.4.4.1"><times id="S3.SS2.p2.6.m6.4.4.1.2.cmml" xref="S3.SS2.p2.6.m6.4.4.1.2"></times><ci id="S3.SS2.p2.6.m6.4.4.1.3.cmml" xref="S3.SS2.p2.6.m6.4.4.1.3">𝑓</ci><list id="S3.SS2.p2.6.m6.4.4.1.1.2.cmml" xref="S3.SS2.p2.6.m6.4.4.1.1.1"><apply id="S3.SS2.p2.6.m6.4.4.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.4.4.1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.2">𝜃</ci><ci id="S3.SS2.p2.6.m6.4.4.1.1.1.1.3.cmml" xref="S3.SS2.p2.6.m6.4.4.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">⋅</ci></list></apply><apply id="S3.SS2.p2.6.m6.5.5.2.cmml" xref="S3.SS2.p2.6.m6.5.5.2"><times id="S3.SS2.p2.6.m6.5.5.2.2.cmml" xref="S3.SS2.p2.6.m6.5.5.2.2"></times><ci id="S3.SS2.p2.6.m6.5.5.2.3.cmml" xref="S3.SS2.p2.6.m6.5.5.2.3">𝑓</ci><vector id="S3.SS2.p2.6.m6.5.5.2.1.2.cmml" xref="S3.SS2.p2.6.m6.5.5.2.1.1"><apply id="S3.SS2.p2.6.m6.5.5.2.1.1.1.cmml" xref="S3.SS2.p2.6.m6.5.5.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.5.5.2.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.5.5.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.5.5.2.1.1.1.2.cmml" xref="S3.SS2.p2.6.m6.5.5.2.1.1.1.2">𝑊</ci><ci id="S3.SS2.p2.6.m6.5.5.2.1.1.1.3.cmml" xref="S3.SS2.p2.6.m6.5.5.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p2.6.m6.2.2.cmml" xref="S3.SS2.p2.6.m6.2.2">𝜉</ci><ci id="S3.SS2.p2.6.m6.3.3.cmml" xref="S3.SS2.p2.6.m6.3.3">⋅</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.5c">f(\theta_{i};\cdot)=f(W_{i},\xi;\cdot)</annotation></semantics></math> is trained locally for <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">k</annotation></semantics></math> steps, and the model becomes <math id="S3.SS2.p2.8.m8.7" class="ltx_Math" alttext="f(W_{i}^{t,k},\bar{\xi}_{i}^{t,k};\cdot)" display="inline"><semantics id="S3.SS2.p2.8.m8.7a"><mrow id="S3.SS2.p2.8.m8.7.7" xref="S3.SS2.p2.8.m8.7.7.cmml"><mi id="S3.SS2.p2.8.m8.7.7.4" xref="S3.SS2.p2.8.m8.7.7.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m8.7.7.3" xref="S3.SS2.p2.8.m8.7.7.3.cmml">​</mo><mrow id="S3.SS2.p2.8.m8.7.7.2.2" xref="S3.SS2.p2.8.m8.7.7.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m8.7.7.2.2.3" xref="S3.SS2.p2.8.m8.7.7.2.3.cmml">(</mo><msubsup id="S3.SS2.p2.8.m8.6.6.1.1.1" xref="S3.SS2.p2.8.m8.6.6.1.1.1.cmml"><mi id="S3.SS2.p2.8.m8.6.6.1.1.1.2.2" xref="S3.SS2.p2.8.m8.6.6.1.1.1.2.2.cmml">W</mi><mi id="S3.SS2.p2.8.m8.6.6.1.1.1.2.3" xref="S3.SS2.p2.8.m8.6.6.1.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.p2.8.m8.2.2.2.4" xref="S3.SS2.p2.8.m8.2.2.2.3.cmml"><mi id="S3.SS2.p2.8.m8.1.1.1.1" xref="S3.SS2.p2.8.m8.1.1.1.1.cmml">t</mi><mo id="S3.SS2.p2.8.m8.2.2.2.4.1" xref="S3.SS2.p2.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.8.m8.2.2.2.2" xref="S3.SS2.p2.8.m8.2.2.2.2.cmml">k</mi></mrow></msubsup><mo id="S3.SS2.p2.8.m8.7.7.2.2.4" xref="S3.SS2.p2.8.m8.7.7.2.3.cmml">,</mo><msubsup id="S3.SS2.p2.8.m8.7.7.2.2.2" xref="S3.SS2.p2.8.m8.7.7.2.2.2.cmml"><mover accent="true" id="S3.SS2.p2.8.m8.7.7.2.2.2.2.2" xref="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.2" xref="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.2.cmml">ξ</mi><mo id="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.1" xref="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p2.8.m8.7.7.2.2.2.2.3" xref="S3.SS2.p2.8.m8.7.7.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS2.p2.8.m8.4.4.2.4" xref="S3.SS2.p2.8.m8.4.4.2.3.cmml"><mi id="S3.SS2.p2.8.m8.3.3.1.1" xref="S3.SS2.p2.8.m8.3.3.1.1.cmml">t</mi><mo id="S3.SS2.p2.8.m8.4.4.2.4.1" xref="S3.SS2.p2.8.m8.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p2.8.m8.4.4.2.2" xref="S3.SS2.p2.8.m8.4.4.2.2.cmml">k</mi></mrow></msubsup><mo rspace="0em" id="S3.SS2.p2.8.m8.7.7.2.2.5" xref="S3.SS2.p2.8.m8.7.7.2.3.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m8.5.5" xref="S3.SS2.p2.8.m8.5.5.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p2.8.m8.7.7.2.2.6" xref="S3.SS2.p2.8.m8.7.7.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.7b"><apply id="S3.SS2.p2.8.m8.7.7.cmml" xref="S3.SS2.p2.8.m8.7.7"><times id="S3.SS2.p2.8.m8.7.7.3.cmml" xref="S3.SS2.p2.8.m8.7.7.3"></times><ci id="S3.SS2.p2.8.m8.7.7.4.cmml" xref="S3.SS2.p2.8.m8.7.7.4">𝑓</ci><vector id="S3.SS2.p2.8.m8.7.7.2.3.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2"><apply id="S3.SS2.p2.8.m8.6.6.1.1.1.cmml" xref="S3.SS2.p2.8.m8.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.6.6.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.6.6.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.8.m8.6.6.1.1.1.2.cmml" xref="S3.SS2.p2.8.m8.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.6.6.1.1.1.2.1.cmml" xref="S3.SS2.p2.8.m8.6.6.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.6.6.1.1.1.2.2.cmml" xref="S3.SS2.p2.8.m8.6.6.1.1.1.2.2">𝑊</ci><ci id="S3.SS2.p2.8.m8.6.6.1.1.1.2.3.cmml" xref="S3.SS2.p2.8.m8.6.6.1.1.1.2.3">𝑖</ci></apply><list id="S3.SS2.p2.8.m8.2.2.2.3.cmml" xref="S3.SS2.p2.8.m8.2.2.2.4"><ci id="S3.SS2.p2.8.m8.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1">𝑡</ci><ci id="S3.SS2.p2.8.m8.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.2.2.2.2">𝑘</ci></list></apply><apply id="S3.SS2.p2.8.m8.7.7.2.2.2.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.7.7.2.2.2.1.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2.2">superscript</csymbol><apply id="S3.SS2.p2.8.m8.7.7.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.7.7.2.2.2.2.1.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2.2">subscript</csymbol><apply id="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2.2.2.2"><ci id="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.1">¯</ci><ci id="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2.2.2.2.2">𝜉</ci></apply><ci id="S3.SS2.p2.8.m8.7.7.2.2.2.2.3.cmml" xref="S3.SS2.p2.8.m8.7.7.2.2.2.2.3">𝑖</ci></apply><list id="S3.SS2.p2.8.m8.4.4.2.3.cmml" xref="S3.SS2.p2.8.m8.4.4.2.4"><ci id="S3.SS2.p2.8.m8.3.3.1.1.cmml" xref="S3.SS2.p2.8.m8.3.3.1.1">𝑡</ci><ci id="S3.SS2.p2.8.m8.4.4.2.2.cmml" xref="S3.SS2.p2.8.m8.4.4.2.2">𝑘</ci></list></apply><ci id="S3.SS2.p2.8.m8.5.5.cmml" xref="S3.SS2.p2.8.m8.5.5">⋅</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.7c">f(W_{i}^{t,k},\bar{\xi}_{i}^{t,k};\cdot)</annotation></semantics></math>, where <math id="S3.SS2.p2.9.m9.2" class="ltx_Math" alttext="W_{i}^{t,k}" display="inline"><semantics id="S3.SS2.p2.9.m9.2a"><msubsup id="S3.SS2.p2.9.m9.2.3" xref="S3.SS2.p2.9.m9.2.3.cmml"><mi id="S3.SS2.p2.9.m9.2.3.2.2" xref="S3.SS2.p2.9.m9.2.3.2.2.cmml">W</mi><mi id="S3.SS2.p2.9.m9.2.3.2.3" xref="S3.SS2.p2.9.m9.2.3.2.3.cmml">i</mi><mrow id="S3.SS2.p2.9.m9.2.2.2.4" xref="S3.SS2.p2.9.m9.2.2.2.3.cmml"><mi id="S3.SS2.p2.9.m9.1.1.1.1" xref="S3.SS2.p2.9.m9.1.1.1.1.cmml">t</mi><mo id="S3.SS2.p2.9.m9.2.2.2.4.1" xref="S3.SS2.p2.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.9.m9.2.2.2.2" xref="S3.SS2.p2.9.m9.2.2.2.2.cmml">k</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.2b"><apply id="S3.SS2.p2.9.m9.2.3.cmml" xref="S3.SS2.p2.9.m9.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.2.3.1.cmml" xref="S3.SS2.p2.9.m9.2.3">superscript</csymbol><apply id="S3.SS2.p2.9.m9.2.3.2.cmml" xref="S3.SS2.p2.9.m9.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.2.3.2.1.cmml" xref="S3.SS2.p2.9.m9.2.3">subscript</csymbol><ci id="S3.SS2.p2.9.m9.2.3.2.2.cmml" xref="S3.SS2.p2.9.m9.2.3.2.2">𝑊</ci><ci id="S3.SS2.p2.9.m9.2.3.2.3.cmml" xref="S3.SS2.p2.9.m9.2.3.2.3">𝑖</ci></apply><list id="S3.SS2.p2.9.m9.2.2.2.3.cmml" xref="S3.SS2.p2.9.m9.2.2.2.4"><ci id="S3.SS2.p2.9.m9.1.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1.1.1">𝑡</ci><ci id="S3.SS2.p2.9.m9.2.2.2.2.cmml" xref="S3.SS2.p2.9.m9.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.2c">W_{i}^{t,k}</annotation></semantics></math> is retained locally to store the personalized information of client <math id="S3.SS2.p2.10.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p2.10.m10.1a"><mi id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><ci id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">i</annotation></semantics></math> and <math id="S3.SS2.p2.11.m11.2" class="ltx_Math" alttext="\bar{\xi}_{i}^{t,k}" display="inline"><semantics id="S3.SS2.p2.11.m11.2a"><msubsup id="S3.SS2.p2.11.m11.2.3" xref="S3.SS2.p2.11.m11.2.3.cmml"><mover accent="true" id="S3.SS2.p2.11.m11.2.3.2.2" xref="S3.SS2.p2.11.m11.2.3.2.2.cmml"><mi id="S3.SS2.p2.11.m11.2.3.2.2.2" xref="S3.SS2.p2.11.m11.2.3.2.2.2.cmml">ξ</mi><mo id="S3.SS2.p2.11.m11.2.3.2.2.1" xref="S3.SS2.p2.11.m11.2.3.2.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p2.11.m11.2.3.2.3" xref="S3.SS2.p2.11.m11.2.3.2.3.cmml">i</mi><mrow id="S3.SS2.p2.11.m11.2.2.2.4" xref="S3.SS2.p2.11.m11.2.2.2.3.cmml"><mi id="S3.SS2.p2.11.m11.1.1.1.1" xref="S3.SS2.p2.11.m11.1.1.1.1.cmml">t</mi><mo id="S3.SS2.p2.11.m11.2.2.2.4.1" xref="S3.SS2.p2.11.m11.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.11.m11.2.2.2.2" xref="S3.SS2.p2.11.m11.2.2.2.2.cmml">k</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.2b"><apply id="S3.SS2.p2.11.m11.2.3.cmml" xref="S3.SS2.p2.11.m11.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.2.3.1.cmml" xref="S3.SS2.p2.11.m11.2.3">superscript</csymbol><apply id="S3.SS2.p2.11.m11.2.3.2.cmml" xref="S3.SS2.p2.11.m11.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.2.3.2.1.cmml" xref="S3.SS2.p2.11.m11.2.3">subscript</csymbol><apply id="S3.SS2.p2.11.m11.2.3.2.2.cmml" xref="S3.SS2.p2.11.m11.2.3.2.2"><ci id="S3.SS2.p2.11.m11.2.3.2.2.1.cmml" xref="S3.SS2.p2.11.m11.2.3.2.2.1">¯</ci><ci id="S3.SS2.p2.11.m11.2.3.2.2.2.cmml" xref="S3.SS2.p2.11.m11.2.3.2.2.2">𝜉</ci></apply><ci id="S3.SS2.p2.11.m11.2.3.2.3.cmml" xref="S3.SS2.p2.11.m11.2.3.2.3">𝑖</ci></apply><list id="S3.SS2.p2.11.m11.2.2.2.3.cmml" xref="S3.SS2.p2.11.m11.2.2.2.4"><ci id="S3.SS2.p2.11.m11.1.1.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1.1.1">𝑡</ci><ci id="S3.SS2.p2.11.m11.2.2.2.2.cmml" xref="S3.SS2.p2.11.m11.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.2c">\bar{\xi}_{i}^{t,k}</annotation></semantics></math> is aggregated across the clients via</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="\centering\bar{\xi}^{t}=\sum_{i=1}^{N}\frac{m_{i}}{M}\xi_{i}^{t,k}.\@add@centering" display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><msup id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mover accent="true" id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.cmml">ξ</mi><mo id="S3.E2.m1.3.3.1.1.2.2.1" xref="S3.E2.m1.3.3.1.1.2.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">t</mi></msup><mo rspace="0.111em" id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><munderover id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.3.3.1.1.3.1.2.2" xref="S3.E2.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.2.3" xref="S3.E2.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.1.2.3.2" xref="S3.E2.m1.3.3.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.3.3.1.1.3.1.2.3.1" xref="S3.E2.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.3.3.1.1.3.1.2.3.3" xref="S3.E2.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.3.3.1.1.3.1.3" xref="S3.E2.m1.3.3.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml"><mfrac id="S3.E2.m1.3.3.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.cmml"><msub id="S3.E2.m1.3.3.1.1.3.2.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2.2.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.2.2.cmml">m</mi><mi id="S3.E2.m1.3.3.1.1.3.2.2.2.3" xref="S3.E2.m1.3.3.1.1.3.2.2.2.3.cmml">i</mi></msub><mi id="S3.E2.m1.3.3.1.1.3.2.2.3" xref="S3.E2.m1.3.3.1.1.3.2.2.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.2.1" xref="S3.E2.m1.3.3.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E2.m1.3.3.1.1.3.2.3" xref="S3.E2.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2.3.2.2" xref="S3.E2.m1.3.3.1.1.3.2.3.2.2.cmml">ξ</mi><mi id="S3.E2.m1.3.3.1.1.3.2.3.2.3" xref="S3.E2.m1.3.3.1.1.3.2.3.2.3.cmml">i</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">t</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">k</mi></mrow></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2"><ci id="S3.E2.m1.3.3.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.1">¯</ci><ci id="S3.E2.m1.3.3.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2">𝜉</ci></apply><ci id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3">𝑡</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><apply id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.3.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.3.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.2"></sum><apply id="S3.E2.m1.3.3.1.1.3.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.3"><eq id="S3.E2.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S3.E2.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.3.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.3.3.1.1.3.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2"><times id="S3.E2.m1.3.3.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1"></times><apply id="S3.E2.m1.3.3.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2"><divide id="S3.E2.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2"></divide><apply id="S3.E2.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.2.2">𝑚</ci><ci id="S3.E2.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E2.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.3">𝑀</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3.2.2">𝜉</ci><ci id="S3.E2.m1.3.3.1.1.3.2.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3.2.3">𝑖</ci></apply><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑡</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑘</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\centering\bar{\xi}^{t}=\sum_{i=1}^{N}\frac{m_{i}}{M}\xi_{i}^{t,k}.\@add@centering</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.12" class="ltx_p">Thus, the objective function of FedTP can be derived from Eq. (<a href="#S3.E1" title="In III-A Problem Formulation ‣ III Federated learning by Transformer Personalization ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) to minimize the following loss:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\centering\mathop{\arg\min}\limits_{\Theta}\sum_{i=1}^{N}\frac{m_{i}}{M}\mathcal{L}_{i}(W_{i},\xi),\@add@centering" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><munder id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml"><mrow id="S3.E3.m1.2.2.1.1.2.2" xref="S3.E3.m1.2.2.1.1.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.1" xref="S3.E3.m1.2.2.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E3.m1.2.2.1.1.2.2a" xref="S3.E3.m1.2.2.1.1.2.2.cmml">⁡</mo><mi id="S3.E3.m1.2.2.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.cmml">min</mi></mrow><mi mathvariant="normal" id="S3.E3.m1.2.2.1.1.2.3" xref="S3.E3.m1.2.2.1.1.2.3.cmml">Θ</mi></munder><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><munderover id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E3.m1.2.2.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.2.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.2.2.3.2" xref="S3.E3.m1.2.2.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.1.2.2.3.1" xref="S3.E3.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.2.1.1.1.2.2.3.3" xref="S3.E3.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.2.2.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mfrac id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml"><msub id="S3.E3.m1.2.2.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.3.2.2" xref="S3.E3.m1.2.2.1.1.1.1.3.2.2.cmml">m</mi><mi id="S3.E3.m1.2.2.1.1.1.1.3.2.3" xref="S3.E3.m1.2.2.1.1.1.1.3.2.3.cmml">i</mi></msub><mi id="S3.E3.m1.2.2.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">​</mo><msub id="S3.E3.m1.2.2.1.1.1.1.4" xref="S3.E3.m1.2.2.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.1.1.1.1.4.2" xref="S3.E3.m1.2.2.1.1.1.1.4.2.cmml">ℒ</mi><mi id="S3.E3.m1.2.2.1.1.1.1.4.3" xref="S3.E3.m1.2.2.1.1.1.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.2a" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">ξ</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.1.1.4" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><apply id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2"><arg id="S3.E3.m1.2.2.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1"></arg><min id="S3.E3.m1.2.2.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2"></min></apply><ci id="S3.E3.m1.2.2.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.3">Θ</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><apply id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2.2.2"></sum><apply id="S3.E3.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.2.2.3"><eq id="S3.E3.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.E3.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.2.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2"></times><apply id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3"><divide id="S3.E3.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3"></divide><apply id="S3.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.2.2">𝑚</ci><ci id="S3.E3.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.4.2">ℒ</ci><ci id="S3.E3.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.4.3">𝑖</ci></apply><interval closure="open" id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝜉</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\centering\mathop{\arg\min}\limits_{\Theta}\sum_{i=1}^{N}\frac{m_{i}}{M}\mathcal{L}_{i}(W_{i},\xi),\@add@centering</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.13" class="ltx_p">where</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.9" class="ltx_Math" alttext="\mathcal{L}_{i}(W_{i},\xi)=\sum\limits_{i=1}^{N}\dfrac{m_{i}}{M}\mathbb{E}_{(x_{i}^{(j)},y_{i}^{(j)})\in{D}_{i}}l(f(W_{i},\xi;x_{i}^{(j)}),\\
y_{i}^{(j)})." display="block"><semantics id="S3.E4.m1.9a"><mrow id="S3.E4.m1.9.9.1" xref="S3.E4.m1.9.9.1.1.cmml"><mrow id="S3.E4.m1.9.9.1.1" xref="S3.E4.m1.9.9.1.1.cmml"><mrow id="S3.E4.m1.9.9.1.1.1" xref="S3.E4.m1.9.9.1.1.1.cmml"><msub id="S3.E4.m1.9.9.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.9.9.1.1.1.3.2" xref="S3.E4.m1.9.9.1.1.1.3.2.cmml">ℒ</mi><mi id="S3.E4.m1.9.9.1.1.1.3.3" xref="S3.E4.m1.9.9.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.2.cmml">(</mo><msub id="S3.E4.m1.9.9.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.9.9.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">ξ</mi><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.4" xref="S3.E4.m1.9.9.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E4.m1.9.9.1.1.4" xref="S3.E4.m1.9.9.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.9.9.1.1.3" xref="S3.E4.m1.9.9.1.1.3.cmml"><munderover id="S3.E4.m1.9.9.1.1.3.3" xref="S3.E4.m1.9.9.1.1.3.3.cmml"><mo movablelimits="false" id="S3.E4.m1.9.9.1.1.3.3.2.2" xref="S3.E4.m1.9.9.1.1.3.3.2.2.cmml">∑</mo><mrow id="S3.E4.m1.9.9.1.1.3.3.2.3" xref="S3.E4.m1.9.9.1.1.3.3.2.3.cmml"><mi id="S3.E4.m1.9.9.1.1.3.3.2.3.2" xref="S3.E4.m1.9.9.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.E4.m1.9.9.1.1.3.3.2.3.1" xref="S3.E4.m1.9.9.1.1.3.3.2.3.1.cmml">=</mo><mn id="S3.E4.m1.9.9.1.1.3.3.2.3.3" xref="S3.E4.m1.9.9.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.9.9.1.1.3.3.3" xref="S3.E4.m1.9.9.1.1.3.3.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.9.9.1.1.3.2" xref="S3.E4.m1.9.9.1.1.3.2.cmml"><mfrac id="S3.E4.m1.9.9.1.1.3.2.4" xref="S3.E4.m1.9.9.1.1.3.2.4.cmml"><msub id="S3.E4.m1.9.9.1.1.3.2.4.2" xref="S3.E4.m1.9.9.1.1.3.2.4.2.cmml"><mi id="S3.E4.m1.9.9.1.1.3.2.4.2.2" xref="S3.E4.m1.9.9.1.1.3.2.4.2.2.cmml">m</mi><mi id="S3.E4.m1.9.9.1.1.3.2.4.2.3" xref="S3.E4.m1.9.9.1.1.3.2.4.2.3.cmml">i</mi></msub><mi id="S3.E4.m1.9.9.1.1.3.2.4.3" xref="S3.E4.m1.9.9.1.1.3.2.4.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.3.2.3" xref="S3.E4.m1.9.9.1.1.3.2.3.cmml">​</mo><msub id="S3.E4.m1.9.9.1.1.3.2.5" xref="S3.E4.m1.9.9.1.1.3.2.5.cmml"><mi id="S3.E4.m1.9.9.1.1.3.2.5.2" xref="S3.E4.m1.9.9.1.1.3.2.5.2.cmml">𝔼</mi><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><mrow id="S3.E4.m1.4.4.4.4.2" xref="S3.E4.m1.4.4.4.4.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.4.2.3" xref="S3.E4.m1.4.4.4.4.3.cmml">(</mo><msubsup id="S3.E4.m1.3.3.3.3.1.1" xref="S3.E4.m1.3.3.3.3.1.1.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1.2.2" xref="S3.E4.m1.3.3.3.3.1.1.2.2.cmml">x</mi><mi id="S3.E4.m1.3.3.3.3.1.1.2.3" xref="S3.E4.m1.3.3.3.3.1.1.2.3.cmml">i</mi><mrow id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.3.1" xref="S3.E4.m1.3.3.3.3.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.3.2" xref="S3.E4.m1.3.3.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.4.4.4.4.2.4" xref="S3.E4.m1.4.4.4.4.3.cmml">,</mo><msubsup id="S3.E4.m1.4.4.4.4.2.2" xref="S3.E4.m1.4.4.4.4.2.2.cmml"><mi id="S3.E4.m1.4.4.4.4.2.2.2.2" xref="S3.E4.m1.4.4.4.4.2.2.2.2.cmml">y</mi><mi id="S3.E4.m1.4.4.4.4.2.2.2.3" xref="S3.E4.m1.4.4.4.4.2.2.2.3.cmml">i</mi><mrow id="S3.E4.m1.2.2.2.2.1.3" xref="S3.E4.m1.4.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.2.1.3.1" xref="S3.E4.m1.4.4.4.4.2.2.cmml">(</mo><mi id="S3.E4.m1.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.2.2.2.2.1.3.2" xref="S3.E4.m1.4.4.4.4.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E4.m1.4.4.4.4.2.5" xref="S3.E4.m1.4.4.4.4.3.cmml">)</mo></mrow><mo id="S3.E4.m1.4.4.4.5" xref="S3.E4.m1.4.4.4.5.cmml">∈</mo><msub id="S3.E4.m1.4.4.4.6" xref="S3.E4.m1.4.4.4.6.cmml"><mi id="S3.E4.m1.4.4.4.6.2" xref="S3.E4.m1.4.4.4.6.2.cmml">D</mi><mi id="S3.E4.m1.4.4.4.6.3" xref="S3.E4.m1.4.4.4.6.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.3.2.3a" xref="S3.E4.m1.9.9.1.1.3.2.3.cmml">​</mo><mi id="S3.E4.m1.9.9.1.1.3.2.6" xref="S3.E4.m1.9.9.1.1.3.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.3.2.3b" xref="S3.E4.m1.9.9.1.1.3.2.3.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.3.2.2.2" xref="S3.E4.m1.9.9.1.1.3.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.3.2.2.2.3" xref="S3.E4.m1.9.9.1.1.3.2.2.3.cmml">(</mo><mrow id="S3.E4.m1.9.9.1.1.2.1.1.1.1" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.2.1.1.1.1.4" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.2.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.3" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.4" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml">ξ</mi><mo id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.5" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.3.cmml">;</mo><msubsup id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S3.E4.m1.5.5.1.3" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.1.3.1" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.5.5.1.3.2" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.6" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.9.9.1.1.3.2.2.2.4" xref="S3.E4.m1.9.9.1.1.3.2.2.3.cmml">,</mo><msubsup id="S3.E4.m1.9.9.1.1.3.2.2.2.2" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2.cmml"><mi id="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.2" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.3" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E4.m1.6.6.1.3" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.1.3.1" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2.cmml">(</mo><mi id="S3.E4.m1.6.6.1.1" xref="S3.E4.m1.6.6.1.1.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.6.6.1.3.2" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E4.m1.9.9.1.1.3.2.2.2.5" xref="S3.E4.m1.9.9.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.9.9.1.2" xref="S3.E4.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.9b"><apply id="S3.E4.m1.9.9.1.1.cmml" xref="S3.E4.m1.9.9.1"><eq id="S3.E4.m1.9.9.1.1.4.cmml" xref="S3.E4.m1.9.9.1.1.4"></eq><apply id="S3.E4.m1.9.9.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1"><times id="S3.E4.m1.9.9.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.2"></times><apply id="S3.E4.m1.9.9.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.3.2">ℒ</ci><ci id="S3.E4.m1.9.9.1.1.1.3.3.cmml" xref="S3.E4.m1.9.9.1.1.1.3.3">𝑖</ci></apply><interval closure="open" id="S3.E4.m1.9.9.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1"><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">𝜉</ci></interval></apply><apply id="S3.E4.m1.9.9.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.3"><apply id="S3.E4.m1.9.9.1.1.3.3.cmml" xref="S3.E4.m1.9.9.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.3.3.1.cmml" xref="S3.E4.m1.9.9.1.1.3.3">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.3.3.2.cmml" xref="S3.E4.m1.9.9.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.3.3.2.1.cmml" xref="S3.E4.m1.9.9.1.1.3.3">subscript</csymbol><sum id="S3.E4.m1.9.9.1.1.3.3.2.2.cmml" xref="S3.E4.m1.9.9.1.1.3.3.2.2"></sum><apply id="S3.E4.m1.9.9.1.1.3.3.2.3.cmml" xref="S3.E4.m1.9.9.1.1.3.3.2.3"><eq id="S3.E4.m1.9.9.1.1.3.3.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.3.3.2.3.1"></eq><ci id="S3.E4.m1.9.9.1.1.3.3.2.3.2.cmml" xref="S3.E4.m1.9.9.1.1.3.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.9.9.1.1.3.3.2.3.3.cmml" xref="S3.E4.m1.9.9.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.9.9.1.1.3.3.3.cmml" xref="S3.E4.m1.9.9.1.1.3.3.3">𝑁</ci></apply><apply id="S3.E4.m1.9.9.1.1.3.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2"><times id="S3.E4.m1.9.9.1.1.3.2.3.cmml" xref="S3.E4.m1.9.9.1.1.3.2.3"></times><apply id="S3.E4.m1.9.9.1.1.3.2.4.cmml" xref="S3.E4.m1.9.9.1.1.3.2.4"><divide id="S3.E4.m1.9.9.1.1.3.2.4.1.cmml" xref="S3.E4.m1.9.9.1.1.3.2.4"></divide><apply id="S3.E4.m1.9.9.1.1.3.2.4.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.3.2.4.2.1.cmml" xref="S3.E4.m1.9.9.1.1.3.2.4.2">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.3.2.4.2.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2.4.2.2">𝑚</ci><ci id="S3.E4.m1.9.9.1.1.3.2.4.2.3.cmml" xref="S3.E4.m1.9.9.1.1.3.2.4.2.3">𝑖</ci></apply><ci id="S3.E4.m1.9.9.1.1.3.2.4.3.cmml" xref="S3.E4.m1.9.9.1.1.3.2.4.3">𝑀</ci></apply><apply id="S3.E4.m1.9.9.1.1.3.2.5.cmml" xref="S3.E4.m1.9.9.1.1.3.2.5"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.3.2.5.1.cmml" xref="S3.E4.m1.9.9.1.1.3.2.5">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.3.2.5.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2.5.2">𝔼</ci><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><in id="S3.E4.m1.4.4.4.5.cmml" xref="S3.E4.m1.4.4.4.5"></in><interval closure="open" id="S3.E4.m1.4.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.4.2"><apply id="S3.E4.m1.3.3.3.3.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1">superscript</csymbol><apply id="S3.E4.m1.3.3.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.3.3.1.1.2.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.2.2">𝑥</ci><ci id="S3.E4.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E4.m1.3.3.3.3.1.1.2.3">𝑖</ci></apply><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑗</ci></apply><apply id="S3.E4.m1.4.4.4.4.2.2.cmml" xref="S3.E4.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.2.2.1.cmml" xref="S3.E4.m1.4.4.4.4.2.2">superscript</csymbol><apply id="S3.E4.m1.4.4.4.4.2.2.2.cmml" xref="S3.E4.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.E4.m1.4.4.4.4.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.E4.m1.4.4.4.4.2.2.2.2">𝑦</ci><ci id="S3.E4.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.E4.m1.4.4.4.4.2.2.2.3">𝑖</ci></apply><ci id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1">𝑗</ci></apply></interval><apply id="S3.E4.m1.4.4.4.6.cmml" xref="S3.E4.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.6.1.cmml" xref="S3.E4.m1.4.4.4.6">subscript</csymbol><ci id="S3.E4.m1.4.4.4.6.2.cmml" xref="S3.E4.m1.4.4.4.6.2">𝐷</ci><ci id="S3.E4.m1.4.4.4.6.3.cmml" xref="S3.E4.m1.4.4.4.6.3">𝑖</ci></apply></apply></apply><ci id="S3.E4.m1.9.9.1.1.3.2.6.cmml" xref="S3.E4.m1.9.9.1.1.3.2.6">𝑙</ci><interval closure="open" id="S3.E4.m1.9.9.1.1.3.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.3.2.2.2"><apply id="S3.E4.m1.9.9.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1"><times id="S3.E4.m1.9.9.1.1.2.1.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.3"></times><ci id="S3.E4.m1.9.9.1.1.2.1.1.1.1.4.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.4">𝑓</ci><vector id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2"><apply id="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8">𝜉</ci><apply id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.2.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1">𝑗</ci></apply></vector></apply><apply id="S3.E4.m1.9.9.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.3.2.2.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.2">𝑦</ci><ci id="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.3.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E4.m1.6.6.1.1.cmml" xref="S3.E4.m1.6.6.1.1">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.9c">\mathcal{L}_{i}(W_{i},\xi)=\sum\limits_{i=1}^{N}\dfrac{m_{i}}{M}\mathbb{E}_{(x_{i}^{(j)},y_{i}^{(j)})\in{D}_{i}}l(f(W_{i},\xi;x_{i}^{(j)}),\\
y_{i}^{(j)}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">The above vanilla personalization procedure can generate personalized self-attention for each client by local training. However, since it ignores the potential inherent relationships between clients, the obtained personalized self-attention may be stuck in sub-optimality. In addition, the personalized self-attention layers are not scalable as they increase linearly with the growing client numbers. Moreover, the generalization of personalized self-attention is not good. For example, when novel clients are involved, the model needs re-training to generate the specific self-attention layers for these novel clients.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Learn-to-personalize for self-attention</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p"><span id="S3.SS3.p1.1.1" class="ltx_text" style="color:#000000;">In this section, we develop FedTP that utilizes the <em id="S3.SS3.p1.1.1.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism to improve the vanilla personalization mechanism for self-attention.</span> FedTP learns a hypernetwork<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> at the server to generate projection matrices in the self-attention layers for each client (see the right side of Fig. <a href="#S3.F2" title="Figure 2 ‣ III Federated learning by Transformer Personalization ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). By this way, FedTP can effectively share parameters across clients and maintain the flexibility of personalized Transformers.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.10" class="ltx_p">The hypernetwork on the server is denoted as <math id="S3.SS3.p2.1.m1.2" class="ltx_Math" alttext="h(\varphi;z_{i})" display="inline"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml"><mi id="S3.SS3.p2.1.m1.2.2.3" xref="S3.SS3.p2.1.m1.2.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.2.2.2" xref="S3.SS3.p2.1.m1.2.2.2.cmml">​</mo><mrow id="S3.SS3.p2.1.m1.2.2.1.1" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.2.2.1.1.2" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">φ</mi><mo id="S3.SS3.p2.1.m1.2.2.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">;</mo><msub id="S3.SS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS3.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p2.1.m1.2.2.1.1.4" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><apply id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2"><times id="S3.SS3.p2.1.m1.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2"></times><ci id="S3.SS3.p2.1.m1.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.3">ℎ</ci><list id="S3.SS3.p2.1.m1.2.2.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝜑</ci><apply id="S3.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">h(\varphi;z_{i})</annotation></semantics></math> parameterized by <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\varphi</annotation></semantics></math>, where <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="z_{i}\in\mathbb{R}^{D}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><msub id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">z</mi><mi id="S3.SS3.p2.3.m3.1.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><in id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></in><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝑧</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">z_{i}\in\mathbb{R}^{D}</annotation></semantics></math> can be a learnable embedding vector corresponding to client <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">i</annotation></semantics></math> or fixed. We implement the hypernetwork with simple fully-connected layers and the last layer is unique for each Transformer block. Given the embedding vector <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">z</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑧</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">z_{i}</annotation></semantics></math>, the hypernetwork outputs the partial weights <math id="S3.SS3.p2.6.m6.2" class="ltx_Math" alttext="W_{i}=h(\varphi;z_{i})" display="inline"><semantics id="S3.SS3.p2.6.m6.2a"><mrow id="S3.SS3.p2.6.m6.2.2" xref="S3.SS3.p2.6.m6.2.2.cmml"><msub id="S3.SS3.p2.6.m6.2.2.3" xref="S3.SS3.p2.6.m6.2.2.3.cmml"><mi id="S3.SS3.p2.6.m6.2.2.3.2" xref="S3.SS3.p2.6.m6.2.2.3.2.cmml">W</mi><mi id="S3.SS3.p2.6.m6.2.2.3.3" xref="S3.SS3.p2.6.m6.2.2.3.3.cmml">i</mi></msub><mo id="S3.SS3.p2.6.m6.2.2.2" xref="S3.SS3.p2.6.m6.2.2.2.cmml">=</mo><mrow id="S3.SS3.p2.6.m6.2.2.1" xref="S3.SS3.p2.6.m6.2.2.1.cmml"><mi id="S3.SS3.p2.6.m6.2.2.1.3" xref="S3.SS3.p2.6.m6.2.2.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.2.2.1.2" xref="S3.SS3.p2.6.m6.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.2.2.1.1.1" xref="S3.SS3.p2.6.m6.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.2.2.1.1.1.2" xref="S3.SS3.p2.6.m6.2.2.1.1.2.cmml">(</mo><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">φ</mi><mo id="S3.SS3.p2.6.m6.2.2.1.1.1.3" xref="S3.SS3.p2.6.m6.2.2.1.1.2.cmml">;</mo><msub id="S3.SS3.p2.6.m6.2.2.1.1.1.1" xref="S3.SS3.p2.6.m6.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p2.6.m6.2.2.1.1.1.1.2" xref="S3.SS3.p2.6.m6.2.2.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.p2.6.m6.2.2.1.1.1.1.3" xref="S3.SS3.p2.6.m6.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p2.6.m6.2.2.1.1.1.4" xref="S3.SS3.p2.6.m6.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.2b"><apply id="S3.SS3.p2.6.m6.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2"><eq id="S3.SS3.p2.6.m6.2.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2.2"></eq><apply id="S3.SS3.p2.6.m6.2.2.3.cmml" xref="S3.SS3.p2.6.m6.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.2.2.3.1.cmml" xref="S3.SS3.p2.6.m6.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.6.m6.2.2.3.2.cmml" xref="S3.SS3.p2.6.m6.2.2.3.2">𝑊</ci><ci id="S3.SS3.p2.6.m6.2.2.3.3.cmml" xref="S3.SS3.p2.6.m6.2.2.3.3">𝑖</ci></apply><apply id="S3.SS3.p2.6.m6.2.2.1.cmml" xref="S3.SS3.p2.6.m6.2.2.1"><times id="S3.SS3.p2.6.m6.2.2.1.2.cmml" xref="S3.SS3.p2.6.m6.2.2.1.2"></times><ci id="S3.SS3.p2.6.m6.2.2.1.3.cmml" xref="S3.SS3.p2.6.m6.2.2.1.3">ℎ</ci><list id="S3.SS3.p2.6.m6.2.2.1.1.2.cmml" xref="S3.SS3.p2.6.m6.2.2.1.1.1"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝜑</ci><apply id="S3.SS3.p2.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.2.2.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.p2.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p2.6.m6.2.2.1.1.1.1.3">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.2c">W_{i}=h(\varphi;z_{i})</annotation></semantics></math> for client <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">i</annotation></semantics></math>, which is then decomposed into the projection parameters for the queries, keys and values of the self-attention mechanism <math id="S3.SS3.p2.8.m8.3" class="ltx_Math" alttext="W_{i}=[W_{i}^{Q},W_{i}^{K},W_{i}^{V}]" display="inline"><semantics id="S3.SS3.p2.8.m8.3a"><mrow id="S3.SS3.p2.8.m8.3.3" xref="S3.SS3.p2.8.m8.3.3.cmml"><msub id="S3.SS3.p2.8.m8.3.3.5" xref="S3.SS3.p2.8.m8.3.3.5.cmml"><mi id="S3.SS3.p2.8.m8.3.3.5.2" xref="S3.SS3.p2.8.m8.3.3.5.2.cmml">W</mi><mi id="S3.SS3.p2.8.m8.3.3.5.3" xref="S3.SS3.p2.8.m8.3.3.5.3.cmml">i</mi></msub><mo id="S3.SS3.p2.8.m8.3.3.4" xref="S3.SS3.p2.8.m8.3.3.4.cmml">=</mo><mrow id="S3.SS3.p2.8.m8.3.3.3.3" xref="S3.SS3.p2.8.m8.3.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.p2.8.m8.3.3.3.3.4" xref="S3.SS3.p2.8.m8.3.3.3.4.cmml">[</mo><msubsup id="S3.SS3.p2.8.m8.1.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.1.1.1.2.2" xref="S3.SS3.p2.8.m8.1.1.1.1.1.2.2.cmml">W</mi><mi id="S3.SS3.p2.8.m8.1.1.1.1.1.2.3" xref="S3.SS3.p2.8.m8.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS3.p2.8.m8.1.1.1.1.1.3" xref="S3.SS3.p2.8.m8.1.1.1.1.1.3.cmml">Q</mi></msubsup><mo id="S3.SS3.p2.8.m8.3.3.3.3.5" xref="S3.SS3.p2.8.m8.3.3.3.4.cmml">,</mo><msubsup id="S3.SS3.p2.8.m8.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.2.cmml"><mi id="S3.SS3.p2.8.m8.2.2.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS3.p2.8.m8.2.2.2.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS3.p2.8.m8.2.2.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.2.2.2.3.cmml">K</mi></msubsup><mo id="S3.SS3.p2.8.m8.3.3.3.3.6" xref="S3.SS3.p2.8.m8.3.3.3.4.cmml">,</mo><msubsup id="S3.SS3.p2.8.m8.3.3.3.3.3" xref="S3.SS3.p2.8.m8.3.3.3.3.3.cmml"><mi id="S3.SS3.p2.8.m8.3.3.3.3.3.2.2" xref="S3.SS3.p2.8.m8.3.3.3.3.3.2.2.cmml">W</mi><mi id="S3.SS3.p2.8.m8.3.3.3.3.3.2.3" xref="S3.SS3.p2.8.m8.3.3.3.3.3.2.3.cmml">i</mi><mi id="S3.SS3.p2.8.m8.3.3.3.3.3.3" xref="S3.SS3.p2.8.m8.3.3.3.3.3.3.cmml">V</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.8.m8.3.3.3.3.7" xref="S3.SS3.p2.8.m8.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.3b"><apply id="S3.SS3.p2.8.m8.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3"><eq id="S3.SS3.p2.8.m8.3.3.4.cmml" xref="S3.SS3.p2.8.m8.3.3.4"></eq><apply id="S3.SS3.p2.8.m8.3.3.5.cmml" xref="S3.SS3.p2.8.m8.3.3.5"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.3.3.5.1.cmml" xref="S3.SS3.p2.8.m8.3.3.5">subscript</csymbol><ci id="S3.SS3.p2.8.m8.3.3.5.2.cmml" xref="S3.SS3.p2.8.m8.3.3.5.2">𝑊</ci><ci id="S3.SS3.p2.8.m8.3.3.5.3.cmml" xref="S3.SS3.p2.8.m8.3.3.5.3">𝑖</ci></apply><list id="S3.SS3.p2.8.m8.3.3.3.4.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3"><apply id="S3.SS3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1.2.2">𝑊</ci><ci id="S3.SS3.p2.8.m8.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p2.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS3.p2.8.m8.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2">superscript</csymbol><apply id="S3.SS3.p2.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.8.m8.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS3.p2.8.m8.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS3.p2.8.m8.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS3.p2.8.m8.3.3.3.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.3.3.3.3.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.3">superscript</csymbol><apply id="S3.SS3.p2.8.m8.3.3.3.3.3.2.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.3.3.3.3.3.2.1.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.8.m8.3.3.3.3.3.2.2.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.3.2.2">𝑊</ci><ci id="S3.SS3.p2.8.m8.3.3.3.3.3.2.3.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="S3.SS3.p2.8.m8.3.3.3.3.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.3.3">𝑉</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.3c">W_{i}=[W_{i}^{Q},W_{i}^{K},W_{i}^{V}]</annotation></semantics></math>. By this way, the hypernetwork learns a category of projection parameters <math id="S3.SS3.p2.9.m9.3" class="ltx_Math" alttext="\{W_{i}=h(\varphi;z_{i})|1\leq i\leq N\}" display="inline"><semantics id="S3.SS3.p2.9.m9.3a"><mrow id="S3.SS3.p2.9.m9.3.3.2" xref="S3.SS3.p2.9.m9.3.3.3.cmml"><mo stretchy="false" id="S3.SS3.p2.9.m9.3.3.2.3" xref="S3.SS3.p2.9.m9.3.3.3.1.cmml">{</mo><mrow id="S3.SS3.p2.9.m9.2.2.1.1" xref="S3.SS3.p2.9.m9.2.2.1.1.cmml"><msub id="S3.SS3.p2.9.m9.2.2.1.1.3" xref="S3.SS3.p2.9.m9.2.2.1.1.3.cmml"><mi id="S3.SS3.p2.9.m9.2.2.1.1.3.2" xref="S3.SS3.p2.9.m9.2.2.1.1.3.2.cmml">W</mi><mi id="S3.SS3.p2.9.m9.2.2.1.1.3.3" xref="S3.SS3.p2.9.m9.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS3.p2.9.m9.2.2.1.1.2" xref="S3.SS3.p2.9.m9.2.2.1.1.2.cmml">=</mo><mrow id="S3.SS3.p2.9.m9.2.2.1.1.1" xref="S3.SS3.p2.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.9.m9.2.2.1.1.1.3" xref="S3.SS3.p2.9.m9.2.2.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m9.2.2.1.1.1.2" xref="S3.SS3.p2.9.m9.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.2" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml">φ</mi><mo id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.3" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.2" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.3" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.4" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m9.3.3.2.4" xref="S3.SS3.p2.9.m9.3.3.3.1.cmml">|</mo><mrow id="S3.SS3.p2.9.m9.3.3.2.2" xref="S3.SS3.p2.9.m9.3.3.2.2.cmml"><mn id="S3.SS3.p2.9.m9.3.3.2.2.2" xref="S3.SS3.p2.9.m9.3.3.2.2.2.cmml">1</mn><mo id="S3.SS3.p2.9.m9.3.3.2.2.3" xref="S3.SS3.p2.9.m9.3.3.2.2.3.cmml">≤</mo><mi id="S3.SS3.p2.9.m9.3.3.2.2.4" xref="S3.SS3.p2.9.m9.3.3.2.2.4.cmml">i</mi><mo id="S3.SS3.p2.9.m9.3.3.2.2.5" xref="S3.SS3.p2.9.m9.3.3.2.2.5.cmml">≤</mo><mi id="S3.SS3.p2.9.m9.3.3.2.2.6" xref="S3.SS3.p2.9.m9.3.3.2.2.6.cmml">N</mi></mrow><mo stretchy="false" id="S3.SS3.p2.9.m9.3.3.2.5" xref="S3.SS3.p2.9.m9.3.3.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.3b"><apply id="S3.SS3.p2.9.m9.3.3.3.cmml" xref="S3.SS3.p2.9.m9.3.3.2"><csymbol cd="latexml" id="S3.SS3.p2.9.m9.3.3.3.1.cmml" xref="S3.SS3.p2.9.m9.3.3.2.3">conditional-set</csymbol><apply id="S3.SS3.p2.9.m9.2.2.1.1.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1"><eq id="S3.SS3.p2.9.m9.2.2.1.1.2.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.2"></eq><apply id="S3.SS3.p2.9.m9.2.2.1.1.3.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.2.2.1.1.3.1.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.9.m9.2.2.1.1.3.2.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.3.2">𝑊</ci><ci id="S3.SS3.p2.9.m9.2.2.1.1.3.3.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.p2.9.m9.2.2.1.1.1.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.1"><times id="S3.SS3.p2.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.1.2"></times><ci id="S3.SS3.p2.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.1.3">ℎ</ci><list id="S3.SS3.p2.9.m9.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.1"><ci id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">𝜑</ci><apply id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.9.m9.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply></apply><apply id="S3.SS3.p2.9.m9.3.3.2.2.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2"><and id="S3.SS3.p2.9.m9.3.3.2.2a.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2"></and><apply id="S3.SS3.p2.9.m9.3.3.2.2b.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2"><leq id="S3.SS3.p2.9.m9.3.3.2.2.3.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2.3"></leq><cn type="integer" id="S3.SS3.p2.9.m9.3.3.2.2.2.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2.2">1</cn><ci id="S3.SS3.p2.9.m9.3.3.2.2.4.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2.4">𝑖</ci></apply><apply id="S3.SS3.p2.9.m9.3.3.2.2c.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2"><leq id="S3.SS3.p2.9.m9.3.3.2.2.5.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2.5"></leq><share href="#S3.SS3.p2.9.m9.3.3.2.2.4.cmml" id="S3.SS3.p2.9.m9.3.3.2.2d.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2"></share><ci id="S3.SS3.p2.9.m9.3.3.2.2.6.cmml" xref="S3.SS3.p2.9.m9.3.3.2.2.6">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.3c">\{W_{i}=h(\varphi;z_{i})|1\leq i\leq N\}</annotation></semantics></math> for personalized self-attention. Hence, the personalized model is denoted as <math id="S3.SS3.p2.10.m10.7" class="ltx_Math" alttext="f(W_{i},\xi;\cdot)=f(h(z_{i};\varphi),\xi;\cdot)" display="inline"><semantics id="S3.SS3.p2.10.m10.7a"><mrow id="S3.SS3.p2.10.m10.7.7" xref="S3.SS3.p2.10.m10.7.7.cmml"><mrow id="S3.SS3.p2.10.m10.6.6.1" xref="S3.SS3.p2.10.m10.6.6.1.cmml"><mi id="S3.SS3.p2.10.m10.6.6.1.3" xref="S3.SS3.p2.10.m10.6.6.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.10.m10.6.6.1.2" xref="S3.SS3.p2.10.m10.6.6.1.2.cmml">​</mo><mrow id="S3.SS3.p2.10.m10.6.6.1.1.1" xref="S3.SS3.p2.10.m10.6.6.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.10.m10.6.6.1.1.1.2" xref="S3.SS3.p2.10.m10.6.6.1.1.2.cmml">(</mo><msub id="S3.SS3.p2.10.m10.6.6.1.1.1.1" xref="S3.SS3.p2.10.m10.6.6.1.1.1.1.cmml"><mi id="S3.SS3.p2.10.m10.6.6.1.1.1.1.2" xref="S3.SS3.p2.10.m10.6.6.1.1.1.1.2.cmml">W</mi><mi id="S3.SS3.p2.10.m10.6.6.1.1.1.1.3" xref="S3.SS3.p2.10.m10.6.6.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.10.m10.6.6.1.1.1.3" xref="S3.SS3.p2.10.m10.6.6.1.1.2.cmml">,</mo><mi id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml">ξ</mi><mo rspace="0em" id="S3.SS3.p2.10.m10.6.6.1.1.1.4" xref="S3.SS3.p2.10.m10.6.6.1.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p2.10.m10.2.2" xref="S3.SS3.p2.10.m10.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.p2.10.m10.6.6.1.1.1.5" xref="S3.SS3.p2.10.m10.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.10.m10.7.7.3" xref="S3.SS3.p2.10.m10.7.7.3.cmml">=</mo><mrow id="S3.SS3.p2.10.m10.7.7.2" xref="S3.SS3.p2.10.m10.7.7.2.cmml"><mi id="S3.SS3.p2.10.m10.7.7.2.3" xref="S3.SS3.p2.10.m10.7.7.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.10.m10.7.7.2.2" xref="S3.SS3.p2.10.m10.7.7.2.2.cmml">​</mo><mrow id="S3.SS3.p2.10.m10.7.7.2.1.1" xref="S3.SS3.p2.10.m10.7.7.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.10.m10.7.7.2.1.1.2" xref="S3.SS3.p2.10.m10.7.7.2.1.2.cmml">(</mo><mrow id="S3.SS3.p2.10.m10.7.7.2.1.1.1" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.cmml"><mi id="S3.SS3.p2.10.m10.7.7.2.1.1.1.3" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.10.m10.7.7.2.1.1.1.2" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.2" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.2.cmml">(</mo><msub id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.2" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.3" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.3" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.2.cmml">;</mo><mi id="S3.SS3.p2.10.m10.3.3" xref="S3.SS3.p2.10.m10.3.3.cmml">φ</mi><mo stretchy="false" id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.4" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.10.m10.7.7.2.1.1.3" xref="S3.SS3.p2.10.m10.7.7.2.1.2.cmml">,</mo><mi id="S3.SS3.p2.10.m10.4.4" xref="S3.SS3.p2.10.m10.4.4.cmml">ξ</mi><mo rspace="0em" id="S3.SS3.p2.10.m10.7.7.2.1.1.4" xref="S3.SS3.p2.10.m10.7.7.2.1.2.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p2.10.m10.5.5" xref="S3.SS3.p2.10.m10.5.5.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.p2.10.m10.7.7.2.1.1.5" xref="S3.SS3.p2.10.m10.7.7.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.7b"><apply id="S3.SS3.p2.10.m10.7.7.cmml" xref="S3.SS3.p2.10.m10.7.7"><eq id="S3.SS3.p2.10.m10.7.7.3.cmml" xref="S3.SS3.p2.10.m10.7.7.3"></eq><apply id="S3.SS3.p2.10.m10.6.6.1.cmml" xref="S3.SS3.p2.10.m10.6.6.1"><times id="S3.SS3.p2.10.m10.6.6.1.2.cmml" xref="S3.SS3.p2.10.m10.6.6.1.2"></times><ci id="S3.SS3.p2.10.m10.6.6.1.3.cmml" xref="S3.SS3.p2.10.m10.6.6.1.3">𝑓</ci><vector id="S3.SS3.p2.10.m10.6.6.1.1.2.cmml" xref="S3.SS3.p2.10.m10.6.6.1.1.1"><apply id="S3.SS3.p2.10.m10.6.6.1.1.1.1.cmml" xref="S3.SS3.p2.10.m10.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.6.6.1.1.1.1.1.cmml" xref="S3.SS3.p2.10.m10.6.6.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m10.6.6.1.1.1.1.2.cmml" xref="S3.SS3.p2.10.m10.6.6.1.1.1.1.2">𝑊</ci><ci id="S3.SS3.p2.10.m10.6.6.1.1.1.1.3.cmml" xref="S3.SS3.p2.10.m10.6.6.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">𝜉</ci><ci id="S3.SS3.p2.10.m10.2.2.cmml" xref="S3.SS3.p2.10.m10.2.2">⋅</ci></vector></apply><apply id="S3.SS3.p2.10.m10.7.7.2.cmml" xref="S3.SS3.p2.10.m10.7.7.2"><times id="S3.SS3.p2.10.m10.7.7.2.2.cmml" xref="S3.SS3.p2.10.m10.7.7.2.2"></times><ci id="S3.SS3.p2.10.m10.7.7.2.3.cmml" xref="S3.SS3.p2.10.m10.7.7.2.3">𝑓</ci><vector id="S3.SS3.p2.10.m10.7.7.2.1.2.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1"><apply id="S3.SS3.p2.10.m10.7.7.2.1.1.1.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1"><times id="S3.SS3.p2.10.m10.7.7.2.1.1.1.2.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.2"></times><ci id="S3.SS3.p2.10.m10.7.7.2.1.1.1.3.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.3">ℎ</ci><list id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.2.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1"><apply id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.10.m10.7.7.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p2.10.m10.3.3.cmml" xref="S3.SS3.p2.10.m10.3.3">𝜑</ci></list></apply><ci id="S3.SS3.p2.10.m10.4.4.cmml" xref="S3.SS3.p2.10.m10.4.4">𝜉</ci><ci id="S3.SS3.p2.10.m10.5.5.cmml" xref="S3.SS3.p2.10.m10.5.5">⋅</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.7c">f(W_{i},\xi;\cdot)=f(h(z_{i};\varphi),\xi;\cdot)</annotation></semantics></math> and the training loss in Eq. (<a href="#S3.E3" title="In III-B Vanilla personalization for self-attention ‣ III Federated learning by Transformer Personalization ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) is replaced by</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{i}(W_{i},\xi)=\mathcal{L}_{i}(h(\varphi;z_{i}),\xi)" display="inline"><semantics id="S3.E5X.2.1.1.m1.5a"><mrow id="S3.E5X.2.1.1.m1.5.5" xref="S3.E5X.2.1.1.m1.5.5.cmml"><mrow id="S3.E5X.2.1.1.m1.4.4.1" xref="S3.E5X.2.1.1.m1.4.4.1.cmml"><msub id="S3.E5X.2.1.1.m1.4.4.1.3" xref="S3.E5X.2.1.1.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5X.2.1.1.m1.4.4.1.3.2" xref="S3.E5X.2.1.1.m1.4.4.1.3.2.cmml">ℒ</mi><mi id="S3.E5X.2.1.1.m1.4.4.1.3.3" xref="S3.E5X.2.1.1.m1.4.4.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.4.4.1.2" xref="S3.E5X.2.1.1.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E5X.2.1.1.m1.4.4.1.1.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.E5X.2.1.1.m1.4.4.1.1.1.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.cmml">(</mo><msub id="S3.E5X.2.1.1.m1.4.4.1.1.1.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.2.cmml">W</mi><mi id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5X.2.1.1.m1.4.4.1.1.1.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.cmml">,</mo><mi id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml">ξ</mi><mo stretchy="false" id="S3.E5X.2.1.1.m1.4.4.1.1.1.4" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5X.2.1.1.m1.5.5.3" xref="S3.E5X.2.1.1.m1.5.5.3.cmml">=</mo><mrow id="S3.E5X.2.1.1.m1.5.5.2" xref="S3.E5X.2.1.1.m1.5.5.2.cmml"><msub id="S3.E5X.2.1.1.m1.5.5.2.3" xref="S3.E5X.2.1.1.m1.5.5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5X.2.1.1.m1.5.5.2.3.2" xref="S3.E5X.2.1.1.m1.5.5.2.3.2.cmml">ℒ</mi><mi id="S3.E5X.2.1.1.m1.5.5.2.3.3" xref="S3.E5X.2.1.1.m1.5.5.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.5.5.2.2" xref="S3.E5X.2.1.1.m1.5.5.2.2.cmml">​</mo><mrow id="S3.E5X.2.1.1.m1.5.5.2.1.1" xref="S3.E5X.2.1.1.m1.5.5.2.1.2.cmml"><mo stretchy="false" id="S3.E5X.2.1.1.m1.5.5.2.1.1.2" xref="S3.E5X.2.1.1.m1.5.5.2.1.2.cmml">(</mo><mrow id="S3.E5X.2.1.1.m1.5.5.2.1.1.1" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.3" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.2" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.2.cmml">​</mo><mrow id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E5X.2.1.1.m1.2.2" xref="S3.E5X.2.1.1.m1.2.2.cmml">φ</mi><mo id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.4" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5X.2.1.1.m1.5.5.2.1.1.3" xref="S3.E5X.2.1.1.m1.5.5.2.1.2.cmml">,</mo><mi id="S3.E5X.2.1.1.m1.3.3" xref="S3.E5X.2.1.1.m1.3.3.cmml">ξ</mi><mo stretchy="false" id="S3.E5X.2.1.1.m1.5.5.2.1.1.4" xref="S3.E5X.2.1.1.m1.5.5.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.5b"><apply id="S3.E5X.2.1.1.m1.5.5.cmml" xref="S3.E5X.2.1.1.m1.5.5"><eq id="S3.E5X.2.1.1.m1.5.5.3.cmml" xref="S3.E5X.2.1.1.m1.5.5.3"></eq><apply id="S3.E5X.2.1.1.m1.4.4.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1"><times id="S3.E5X.2.1.1.m1.4.4.1.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.2"></times><apply id="S3.E5X.2.1.1.m1.4.4.1.3.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.4.4.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.3">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.4.4.1.3.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.3.2">ℒ</ci><ci id="S3.E5X.2.1.1.m1.4.4.1.3.3.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.3.3">𝑖</ci></apply><interval closure="open" id="S3.E5X.2.1.1.m1.4.4.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1"><apply id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.2">𝑊</ci><ci id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">𝜉</ci></interval></apply><apply id="S3.E5X.2.1.1.m1.5.5.2.cmml" xref="S3.E5X.2.1.1.m1.5.5.2"><times id="S3.E5X.2.1.1.m1.5.5.2.2.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.2"></times><apply id="S3.E5X.2.1.1.m1.5.5.2.3.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.3"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.5.5.2.3.1.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.3">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.5.5.2.3.2.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.3.2">ℒ</ci><ci id="S3.E5X.2.1.1.m1.5.5.2.3.3.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.3.3">𝑖</ci></apply><interval closure="open" id="S3.E5X.2.1.1.m1.5.5.2.1.2.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1"><apply id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1"><times id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.2"></times><ci id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.3">ℎ</ci><list id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1"><ci id="S3.E5X.2.1.1.m1.2.2.cmml" xref="S3.E5X.2.1.1.m1.2.2">𝜑</ci><apply id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.5.5.2.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="S3.E5X.2.1.1.m1.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3">𝜉</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.5c">\displaystyle\mathcal{L}_{i}(W_{i},\xi)=\mathcal{L}_{i}(h(\varphi;z_{i}),\xi)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.9" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{N}\frac{m_{i}}{M}\mathbb{E}_{(x_{i}^{(j)},y_{i}^{(j)})\in{D}_{i}}l(f(h(\varphi;z_{i}),\xi;x_{i}^{(j)}),y_{i}^{(j)})." display="inline"><semantics id="S3.E5Xa.2.1.1.m1.9a"><mrow id="S3.E5Xa.2.1.1.m1.9.9.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.cmml"><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.4" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.4.cmml"></mi><mo id="S3.E5Xa.2.1.1.m1.9.9.1.1.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.3.cmml">=</mo><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.cmml"><munderover id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3a" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.cmml"><mo movablelimits="false" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.2.cmml">∑</mo><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.2.cmml">i</mi><mo id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.1.cmml">=</mo><mn id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.cmml"><mfrac id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4a" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.cmml"><msub id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.2.cmml">m</mi><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.3.cmml">i</mi></msub><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.3.cmml">M</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.3.cmml">​</mo><msub id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5.2.cmml">𝔼</mi><mrow id="S3.E5Xa.2.1.1.m1.4.4.4" xref="S3.E5Xa.2.1.1.m1.4.4.4.cmml"><mrow id="S3.E5Xa.2.1.1.m1.4.4.4.4.2" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.3.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.3" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.3.cmml">(</mo><msubsup id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.2.cmml">x</mi><mi id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.3" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.3.cmml">i</mi><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.1" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.cmml">(</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.4" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.3.cmml">,</mo><msubsup id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.2" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.2.cmml">y</mi><mi id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.3" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.3.cmml">i</mi><mrow id="S3.E5Xa.2.1.1.m1.2.2.2.2.1.3" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.2.2.2.2.1.3.1" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.cmml">(</mo><mi id="S3.E5Xa.2.1.1.m1.2.2.2.2.1.1" xref="S3.E5Xa.2.1.1.m1.2.2.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.2.2.2.2.1.3.2" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.5" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.3.cmml">)</mo></mrow><mo id="S3.E5Xa.2.1.1.m1.4.4.4.5" xref="S3.E5Xa.2.1.1.m1.4.4.4.5.cmml">∈</mo><msub id="S3.E5Xa.2.1.1.m1.4.4.4.6" xref="S3.E5Xa.2.1.1.m1.4.4.4.6.cmml"><mi id="S3.E5Xa.2.1.1.m1.4.4.4.6.2" xref="S3.E5Xa.2.1.1.m1.4.4.4.6.2.cmml">D</mi><mi id="S3.E5Xa.2.1.1.m1.4.4.4.6.3" xref="S3.E5Xa.2.1.1.m1.4.4.4.6.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.3a" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.3.cmml">​</mo><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.6" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.3b" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.3.cmml">​</mo><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.3.cmml">(</mo><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.4" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5Xa.2.1.1.m1.7.7" xref="S3.E5Xa.2.1.1.m1.7.7.cmml">φ</mi><mo id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.4" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E5Xa.2.1.1.m1.8.8" xref="S3.E5Xa.2.1.1.m1.8.8.cmml">ξ</mi><mo id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.5" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.3.cmml">;</mo><msubsup id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S3.E5Xa.2.1.1.m1.5.5.1.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.5.5.1.3.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E5Xa.2.1.1.m1.5.5.1.1" xref="S3.E5Xa.2.1.1.m1.5.5.1.1.cmml">j</mi><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.5.5.1.3.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.6" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.4" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.3.cmml">,</mo><msubsup id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E5Xa.2.1.1.m1.6.6.1.3" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.6.6.1.3.1" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.cmml">(</mo><mi id="S3.E5Xa.2.1.1.m1.6.6.1.1" xref="S3.E5Xa.2.1.1.m1.6.6.1.1.cmml">j</mi><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.6.6.1.3.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.5" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5Xa.2.1.1.m1.9.9.1.2" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.9b"><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1"><eq id="S3.E5Xa.2.1.1.m1.9.9.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.3"></eq><csymbol cd="latexml" id="S3.E5Xa.2.1.1.m1.9.9.1.1.4.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.4">absent</csymbol><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2"><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3">subscript</csymbol><sum id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.2"></sum><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3"><eq id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.1"></eq><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.3.3">𝑁</ci></apply><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2"><times id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.3"></times><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4"><divide id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4"></divide><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.2">𝑚</ci><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.2.3">𝑖</ci></apply><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.4.3">𝑀</ci></apply><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.5.2">𝔼</ci><apply id="S3.E5Xa.2.1.1.m1.4.4.4.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4"><in id="S3.E5Xa.2.1.1.m1.4.4.4.5.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.5"></in><interval closure="open" id="S3.E5Xa.2.1.1.m1.4.4.4.4.3.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2"><apply id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.2">𝑥</ci><ci id="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.3.3.3.3.1.1.2.3">𝑖</ci></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1">𝑗</ci></apply><apply id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.2">𝑦</ci><ci id="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.4.2.2.2.3">𝑖</ci></apply><ci id="S3.E5Xa.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.2.2.1.1">𝑗</ci></apply></interval><apply id="S3.E5Xa.2.1.1.m1.4.4.4.6.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.4.4.4.6.1.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.6">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.4.4.4.6.2.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.6.2">𝐷</ci><ci id="S3.E5Xa.2.1.1.m1.4.4.4.6.3.cmml" xref="S3.E5Xa.2.1.1.m1.4.4.4.6.3">𝑖</ci></apply></apply></apply><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.6.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.6">𝑙</ci><interval closure="open" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2"><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1"><times id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.3"></times><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.4.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.4">𝑓</ci><vector id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2"><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1"><times id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">ℎ</ci><list id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E5Xa.2.1.1.m1.7.7.cmml" xref="S3.E5Xa.2.1.1.m1.7.7">𝜑</ci><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="S3.E5Xa.2.1.1.m1.8.8.cmml" xref="S3.E5Xa.2.1.1.m1.8.8">𝜉</ci><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E5Xa.2.1.1.m1.5.5.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.5.5.1.1">𝑗</ci></apply></vector></apply><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E5Xa.2.1.1.m1.6.6.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.6.6.1.1">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.9c">\displaystyle=\sum_{i=1}^{N}\frac{m_{i}}{M}\mathbb{E}_{(x_{i}^{(j)},y_{i}^{(j)})\in{D}_{i}}l(f(h(\varphi;z_{i}),\xi;x_{i}^{(j)}),y_{i}^{(j)}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.23" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.4.4" class="ltx_listingline">

<span id="algorithm1.4.4.1" class="ltx_text"><span id="algorithm1.4.4.1.1" class="ltx_text ltx_font_bold">Input:</span> </span><math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="T-" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mrow id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.2" xref="algorithm1.1.1.m1.1.1.2.cmml">T</mi><mo id="algorithm1.1.1.m1.1.1.3" xref="algorithm1.1.1.m1.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1"><csymbol cd="latexml" id="algorithm1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">limit-from</csymbol><ci id="algorithm1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.2">𝑇</ci><minus id="algorithm1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">T-</annotation></semantics></math> number of communication rounds, <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="K-" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mrow id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml"><mi id="algorithm1.2.2.m2.1.1.2" xref="algorithm1.2.2.m2.1.1.2.cmml">K</mi><mo id="algorithm1.2.2.m2.1.1.3" xref="algorithm1.2.2.m2.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><apply id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1"><csymbol cd="latexml" id="algorithm1.2.2.m2.1.1.1.cmml" xref="algorithm1.2.2.m2.1.1">limit-from</csymbol><ci id="algorithm1.2.2.m2.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.2">𝐾</ci><minus id="algorithm1.2.2.m2.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">K-</annotation></semantics></math> number of local epochs, <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="\alpha-" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mrow id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml"><mi id="algorithm1.3.3.m3.1.1.2" xref="algorithm1.3.3.m3.1.1.2.cmml">α</mi><mo id="algorithm1.3.3.m3.1.1.3" xref="algorithm1.3.3.m3.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><apply id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1"><csymbol cd="latexml" id="algorithm1.3.3.m3.1.1.1.cmml" xref="algorithm1.3.3.m3.1.1">limit-from</csymbol><ci id="algorithm1.3.3.m3.1.1.2.cmml" xref="algorithm1.3.3.m3.1.1.2">𝛼</ci><minus id="algorithm1.3.3.m3.1.1.3.cmml" xref="algorithm1.3.3.m3.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">\alpha-</annotation></semantics></math> learning rate of local update, <math id="algorithm1.4.4.m4.1" class="ltx_Math" alttext="\beta-" display="inline"><semantics id="algorithm1.4.4.m4.1a"><mrow id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml"><mi id="algorithm1.4.4.m4.1.1.2" xref="algorithm1.4.4.m4.1.1.2.cmml">β</mi><mo id="algorithm1.4.4.m4.1.1.3" xref="algorithm1.4.4.m4.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><apply id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1"><csymbol cd="latexml" id="algorithm1.4.4.m4.1.1.1.cmml" xref="algorithm1.4.4.m4.1.1">limit-from</csymbol><ci id="algorithm1.4.4.m4.1.1.2.cmml" xref="algorithm1.4.4.m4.1.1.2">𝛽</ci><minus id="algorithm1.4.4.m4.1.1.3.cmml" xref="algorithm1.4.4.m4.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">\beta-</annotation></semantics></math> learning rate for global update. 
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
Initialize parameters <math id="algorithm1.5.5.m1.1" class="ltx_Math" alttext="\xi^{0}" display="inline"><semantics id="algorithm1.5.5.m1.1a"><msup id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml"><mi id="algorithm1.5.5.m1.1.1.2" xref="algorithm1.5.5.m1.1.1.2.cmml">ξ</mi><mn id="algorithm1.5.5.m1.1.1.3" xref="algorithm1.5.5.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.1b"><apply id="algorithm1.5.5.m1.1.1.cmml" xref="algorithm1.5.5.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.5.5.m1.1.1.1.cmml" xref="algorithm1.5.5.m1.1.1">superscript</csymbol><ci id="algorithm1.5.5.m1.1.1.2.cmml" xref="algorithm1.5.5.m1.1.1.2">𝜉</ci><cn type="integer" id="algorithm1.5.5.m1.1.1.3.cmml" xref="algorithm1.5.5.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.1c">\xi^{0}</annotation></semantics></math>, <math id="algorithm1.6.6.m2.1" class="ltx_Math" alttext="z_{i}^{0}" display="inline"><semantics id="algorithm1.6.6.m2.1a"><msubsup id="algorithm1.6.6.m2.1.1" xref="algorithm1.6.6.m2.1.1.cmml"><mi id="algorithm1.6.6.m2.1.1.2.2" xref="algorithm1.6.6.m2.1.1.2.2.cmml">z</mi><mi id="algorithm1.6.6.m2.1.1.2.3" xref="algorithm1.6.6.m2.1.1.2.3.cmml">i</mi><mn id="algorithm1.6.6.m2.1.1.3" xref="algorithm1.6.6.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m2.1b"><apply id="algorithm1.6.6.m2.1.1.cmml" xref="algorithm1.6.6.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m2.1.1.1.cmml" xref="algorithm1.6.6.m2.1.1">superscript</csymbol><apply id="algorithm1.6.6.m2.1.1.2.cmml" xref="algorithm1.6.6.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m2.1.1.2.1.cmml" xref="algorithm1.6.6.m2.1.1">subscript</csymbol><ci id="algorithm1.6.6.m2.1.1.2.2.cmml" xref="algorithm1.6.6.m2.1.1.2.2">𝑧</ci><ci id="algorithm1.6.6.m2.1.1.2.3.cmml" xref="algorithm1.6.6.m2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="algorithm1.6.6.m2.1.1.3.cmml" xref="algorithm1.6.6.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m2.1c">z_{i}^{0}</annotation></semantics></math> and <math id="algorithm1.7.7.m3.1" class="ltx_Math" alttext="\varphi^{0}" display="inline"><semantics id="algorithm1.7.7.m3.1a"><msup id="algorithm1.7.7.m3.1.1" xref="algorithm1.7.7.m3.1.1.cmml"><mi id="algorithm1.7.7.m3.1.1.2" xref="algorithm1.7.7.m3.1.1.2.cmml">φ</mi><mn id="algorithm1.7.7.m3.1.1.3" xref="algorithm1.7.7.m3.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m3.1b"><apply id="algorithm1.7.7.m3.1.1.cmml" xref="algorithm1.7.7.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m3.1.1.1.cmml" xref="algorithm1.7.7.m3.1.1">superscript</csymbol><ci id="algorithm1.7.7.m3.1.1.2.cmml" xref="algorithm1.7.7.m3.1.1.2">𝜑</ci><cn type="integer" id="algorithm1.7.7.m3.1.1.3.cmml" xref="algorithm1.7.7.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m3.1c">\varphi^{0}</annotation></semantics></math>; 
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>
<span id="algorithm1.8.8.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.8.8.1" class="ltx_emph ltx_font_italic">each communication rounds <math id="algorithm1.8.8.1.m1.3" class="ltx_Math" alttext="t\in\{1,...,T\}" display="inline"><semantics id="algorithm1.8.8.1.m1.3a"><mrow id="algorithm1.8.8.1.m1.3.4" xref="algorithm1.8.8.1.m1.3.4.cmml"><mi id="algorithm1.8.8.1.m1.3.4.2" xref="algorithm1.8.8.1.m1.3.4.2.cmml">t</mi><mo id="algorithm1.8.8.1.m1.3.4.1" xref="algorithm1.8.8.1.m1.3.4.1.cmml">∈</mo><mrow id="algorithm1.8.8.1.m1.3.4.3.2" xref="algorithm1.8.8.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="algorithm1.8.8.1.m1.3.4.3.2.1" xref="algorithm1.8.8.1.m1.3.4.3.1.cmml">{</mo><mn id="algorithm1.8.8.1.m1.1.1" xref="algorithm1.8.8.1.m1.1.1.cmml">1</mn><mo id="algorithm1.8.8.1.m1.3.4.3.2.2" xref="algorithm1.8.8.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.8.8.1.m1.2.2" xref="algorithm1.8.8.1.m1.2.2.cmml">…</mi><mo id="algorithm1.8.8.1.m1.3.4.3.2.3" xref="algorithm1.8.8.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm1.8.8.1.m1.3.3" xref="algorithm1.8.8.1.m1.3.3.cmml">T</mi><mo stretchy="false" id="algorithm1.8.8.1.m1.3.4.3.2.4" xref="algorithm1.8.8.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.1.m1.3b"><apply id="algorithm1.8.8.1.m1.3.4.cmml" xref="algorithm1.8.8.1.m1.3.4"><in id="algorithm1.8.8.1.m1.3.4.1.cmml" xref="algorithm1.8.8.1.m1.3.4.1"></in><ci id="algorithm1.8.8.1.m1.3.4.2.cmml" xref="algorithm1.8.8.1.m1.3.4.2">𝑡</ci><set id="algorithm1.8.8.1.m1.3.4.3.1.cmml" xref="algorithm1.8.8.1.m1.3.4.3.2"><cn type="integer" id="algorithm1.8.8.1.m1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1">1</cn><ci id="algorithm1.8.8.1.m1.2.2.cmml" xref="algorithm1.8.8.1.m1.2.2">…</ci><ci id="algorithm1.8.8.1.m1.3.3.cmml" xref="algorithm1.8.8.1.m1.3.3">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.3c">t\in\{1,...,T\}</annotation></semantics></math></em> <span id="algorithm1.8.8.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Sample the set of clients <math id="algorithm1.9.9.m1.3" class="ltx_Math" alttext="C^{t}\subset\{1,...,N\}" display="inline"><semantics id="algorithm1.9.9.m1.3a"><mrow id="algorithm1.9.9.m1.3.4" xref="algorithm1.9.9.m1.3.4.cmml"><msup id="algorithm1.9.9.m1.3.4.2" xref="algorithm1.9.9.m1.3.4.2.cmml"><mi id="algorithm1.9.9.m1.3.4.2.2" xref="algorithm1.9.9.m1.3.4.2.2.cmml">C</mi><mi id="algorithm1.9.9.m1.3.4.2.3" xref="algorithm1.9.9.m1.3.4.2.3.cmml">t</mi></msup><mo id="algorithm1.9.9.m1.3.4.1" xref="algorithm1.9.9.m1.3.4.1.cmml">⊂</mo><mrow id="algorithm1.9.9.m1.3.4.3.2" xref="algorithm1.9.9.m1.3.4.3.1.cmml"><mo stretchy="false" id="algorithm1.9.9.m1.3.4.3.2.1" xref="algorithm1.9.9.m1.3.4.3.1.cmml">{</mo><mn id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml">1</mn><mo id="algorithm1.9.9.m1.3.4.3.2.2" xref="algorithm1.9.9.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.9.9.m1.2.2" xref="algorithm1.9.9.m1.2.2.cmml">…</mi><mo id="algorithm1.9.9.m1.3.4.3.2.3" xref="algorithm1.9.9.m1.3.4.3.1.cmml">,</mo><mi id="algorithm1.9.9.m1.3.3" xref="algorithm1.9.9.m1.3.3.cmml">N</mi><mo stretchy="false" id="algorithm1.9.9.m1.3.4.3.2.4" xref="algorithm1.9.9.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.3b"><apply id="algorithm1.9.9.m1.3.4.cmml" xref="algorithm1.9.9.m1.3.4"><subset id="algorithm1.9.9.m1.3.4.1.cmml" xref="algorithm1.9.9.m1.3.4.1"></subset><apply id="algorithm1.9.9.m1.3.4.2.cmml" xref="algorithm1.9.9.m1.3.4.2"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.3.4.2.1.cmml" xref="algorithm1.9.9.m1.3.4.2">superscript</csymbol><ci id="algorithm1.9.9.m1.3.4.2.2.cmml" xref="algorithm1.9.9.m1.3.4.2.2">𝐶</ci><ci id="algorithm1.9.9.m1.3.4.2.3.cmml" xref="algorithm1.9.9.m1.3.4.2.3">𝑡</ci></apply><set id="algorithm1.9.9.m1.3.4.3.1.cmml" xref="algorithm1.9.9.m1.3.4.3.2"><cn type="integer" id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1">1</cn><ci id="algorithm1.9.9.m1.2.2.cmml" xref="algorithm1.9.9.m1.2.2">…</ci><ci id="algorithm1.9.9.m1.3.3.cmml" xref="algorithm1.9.9.m1.3.3">𝑁</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.3c">C^{t}\subset\{1,...,N\}</annotation></semantics></math>; 
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.10.10.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.10.10.1" class="ltx_emph ltx_font_italic">each client <math id="algorithm1.10.10.1.m1.1" class="ltx_Math" alttext="i\in C^{t}" display="inline"><semantics id="algorithm1.10.10.1.m1.1a"><mrow id="algorithm1.10.10.1.m1.1.1" xref="algorithm1.10.10.1.m1.1.1.cmml"><mi id="algorithm1.10.10.1.m1.1.1.2" xref="algorithm1.10.10.1.m1.1.1.2.cmml">i</mi><mo id="algorithm1.10.10.1.m1.1.1.1" xref="algorithm1.10.10.1.m1.1.1.1.cmml">∈</mo><msup id="algorithm1.10.10.1.m1.1.1.3" xref="algorithm1.10.10.1.m1.1.1.3.cmml"><mi id="algorithm1.10.10.1.m1.1.1.3.2" xref="algorithm1.10.10.1.m1.1.1.3.2.cmml">C</mi><mi id="algorithm1.10.10.1.m1.1.1.3.3" xref="algorithm1.10.10.1.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.1.m1.1b"><apply id="algorithm1.10.10.1.m1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1"><in id="algorithm1.10.10.1.m1.1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1.1"></in><ci id="algorithm1.10.10.1.m1.1.1.2.cmml" xref="algorithm1.10.10.1.m1.1.1.2">𝑖</ci><apply id="algorithm1.10.10.1.m1.1.1.3.cmml" xref="algorithm1.10.10.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.10.10.1.m1.1.1.3.1.cmml" xref="algorithm1.10.10.1.m1.1.1.3">superscript</csymbol><ci id="algorithm1.10.10.1.m1.1.1.3.2.cmml" xref="algorithm1.10.10.1.m1.1.1.3.2">𝐶</ci><ci id="algorithm1.10.10.1.m1.1.1.3.3.cmml" xref="algorithm1.10.10.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.1.m1.1c">i\in C^{t}</annotation></semantics></math></em> <span id="algorithm1.10.10.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.11.11.m1.2" class="ltx_Math" alttext="\xi^{t,0}=\bar{\xi}^{t-1}" display="inline"><semantics id="algorithm1.11.11.m1.2a"><mrow id="algorithm1.11.11.m1.2.3" xref="algorithm1.11.11.m1.2.3.cmml"><msup id="algorithm1.11.11.m1.2.3.2" xref="algorithm1.11.11.m1.2.3.2.cmml"><mi id="algorithm1.11.11.m1.2.3.2.2" xref="algorithm1.11.11.m1.2.3.2.2.cmml">ξ</mi><mrow id="algorithm1.11.11.m1.2.2.2.4" xref="algorithm1.11.11.m1.2.2.2.3.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.cmml">t</mi><mo id="algorithm1.11.11.m1.2.2.2.4.1" xref="algorithm1.11.11.m1.2.2.2.3.cmml">,</mo><mn id="algorithm1.11.11.m1.2.2.2.2" xref="algorithm1.11.11.m1.2.2.2.2.cmml">0</mn></mrow></msup><mo id="algorithm1.11.11.m1.2.3.1" xref="algorithm1.11.11.m1.2.3.1.cmml">=</mo><msup id="algorithm1.11.11.m1.2.3.3" xref="algorithm1.11.11.m1.2.3.3.cmml"><mover accent="true" id="algorithm1.11.11.m1.2.3.3.2" xref="algorithm1.11.11.m1.2.3.3.2.cmml"><mi id="algorithm1.11.11.m1.2.3.3.2.2" xref="algorithm1.11.11.m1.2.3.3.2.2.cmml">ξ</mi><mo id="algorithm1.11.11.m1.2.3.3.2.1" xref="algorithm1.11.11.m1.2.3.3.2.1.cmml">¯</mo></mover><mrow id="algorithm1.11.11.m1.2.3.3.3" xref="algorithm1.11.11.m1.2.3.3.3.cmml"><mi id="algorithm1.11.11.m1.2.3.3.3.2" xref="algorithm1.11.11.m1.2.3.3.3.2.cmml">t</mi><mo id="algorithm1.11.11.m1.2.3.3.3.1" xref="algorithm1.11.11.m1.2.3.3.3.1.cmml">−</mo><mn id="algorithm1.11.11.m1.2.3.3.3.3" xref="algorithm1.11.11.m1.2.3.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.2b"><apply id="algorithm1.11.11.m1.2.3.cmml" xref="algorithm1.11.11.m1.2.3"><eq id="algorithm1.11.11.m1.2.3.1.cmml" xref="algorithm1.11.11.m1.2.3.1"></eq><apply id="algorithm1.11.11.m1.2.3.2.cmml" xref="algorithm1.11.11.m1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.2.3.2.1.cmml" xref="algorithm1.11.11.m1.2.3.2">superscript</csymbol><ci id="algorithm1.11.11.m1.2.3.2.2.cmml" xref="algorithm1.11.11.m1.2.3.2.2">𝜉</ci><list id="algorithm1.11.11.m1.2.2.2.3.cmml" xref="algorithm1.11.11.m1.2.2.2.4"><ci id="algorithm1.11.11.m1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1">𝑡</ci><cn type="integer" id="algorithm1.11.11.m1.2.2.2.2.cmml" xref="algorithm1.11.11.m1.2.2.2.2">0</cn></list></apply><apply id="algorithm1.11.11.m1.2.3.3.cmml" xref="algorithm1.11.11.m1.2.3.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.2.3.3.1.cmml" xref="algorithm1.11.11.m1.2.3.3">superscript</csymbol><apply id="algorithm1.11.11.m1.2.3.3.2.cmml" xref="algorithm1.11.11.m1.2.3.3.2"><ci id="algorithm1.11.11.m1.2.3.3.2.1.cmml" xref="algorithm1.11.11.m1.2.3.3.2.1">¯</ci><ci id="algorithm1.11.11.m1.2.3.3.2.2.cmml" xref="algorithm1.11.11.m1.2.3.3.2.2">𝜉</ci></apply><apply id="algorithm1.11.11.m1.2.3.3.3.cmml" xref="algorithm1.11.11.m1.2.3.3.3"><minus id="algorithm1.11.11.m1.2.3.3.3.1.cmml" xref="algorithm1.11.11.m1.2.3.3.3.1"></minus><ci id="algorithm1.11.11.m1.2.3.3.3.2.cmml" xref="algorithm1.11.11.m1.2.3.3.3.2">𝑡</ci><cn type="integer" id="algorithm1.11.11.m1.2.3.3.3.3.cmml" xref="algorithm1.11.11.m1.2.3.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.2c">\xi^{t,0}=\bar{\xi}^{t-1}</annotation></semantics></math>; 
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.12.12.m1.4" class="ltx_Math" alttext="W_{i}^{t,0}=h(\varphi^{t-1};z_{i}^{t-1})" display="inline"><semantics id="algorithm1.12.12.m1.4a"><mrow id="algorithm1.12.12.m1.4.4" xref="algorithm1.12.12.m1.4.4.cmml"><msubsup id="algorithm1.12.12.m1.4.4.4" xref="algorithm1.12.12.m1.4.4.4.cmml"><mi id="algorithm1.12.12.m1.4.4.4.2.2" xref="algorithm1.12.12.m1.4.4.4.2.2.cmml">W</mi><mi id="algorithm1.12.12.m1.4.4.4.2.3" xref="algorithm1.12.12.m1.4.4.4.2.3.cmml">i</mi><mrow id="algorithm1.12.12.m1.2.2.2.4" xref="algorithm1.12.12.m1.2.2.2.3.cmml"><mi id="algorithm1.12.12.m1.1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.1.cmml">t</mi><mo id="algorithm1.12.12.m1.2.2.2.4.1" xref="algorithm1.12.12.m1.2.2.2.3.cmml">,</mo><mn id="algorithm1.12.12.m1.2.2.2.2" xref="algorithm1.12.12.m1.2.2.2.2.cmml">0</mn></mrow></msubsup><mo id="algorithm1.12.12.m1.4.4.3" xref="algorithm1.12.12.m1.4.4.3.cmml">=</mo><mrow id="algorithm1.12.12.m1.4.4.2" xref="algorithm1.12.12.m1.4.4.2.cmml"><mi id="algorithm1.12.12.m1.4.4.2.4" xref="algorithm1.12.12.m1.4.4.2.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.4.4.2.3" xref="algorithm1.12.12.m1.4.4.2.3.cmml">​</mo><mrow id="algorithm1.12.12.m1.4.4.2.2.2" xref="algorithm1.12.12.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="algorithm1.12.12.m1.4.4.2.2.2.3" xref="algorithm1.12.12.m1.4.4.2.2.3.cmml">(</mo><msup id="algorithm1.12.12.m1.3.3.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml"><mi id="algorithm1.12.12.m1.3.3.1.1.1.1.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.cmml">φ</mi><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3.cmml"><mi id="algorithm1.12.12.m1.3.3.1.1.1.1.3.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3.2.cmml">t</mi><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.3.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3.1.cmml">−</mo><mn id="algorithm1.12.12.m1.3.3.1.1.1.1.3.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="algorithm1.12.12.m1.4.4.2.2.2.4" xref="algorithm1.12.12.m1.4.4.2.2.3.cmml">;</mo><msubsup id="algorithm1.12.12.m1.4.4.2.2.2.2" xref="algorithm1.12.12.m1.4.4.2.2.2.2.cmml"><mi id="algorithm1.12.12.m1.4.4.2.2.2.2.2.2" xref="algorithm1.12.12.m1.4.4.2.2.2.2.2.2.cmml">z</mi><mi id="algorithm1.12.12.m1.4.4.2.2.2.2.2.3" xref="algorithm1.12.12.m1.4.4.2.2.2.2.2.3.cmml">i</mi><mrow id="algorithm1.12.12.m1.4.4.2.2.2.2.3" xref="algorithm1.12.12.m1.4.4.2.2.2.2.3.cmml"><mi id="algorithm1.12.12.m1.4.4.2.2.2.2.3.2" xref="algorithm1.12.12.m1.4.4.2.2.2.2.3.2.cmml">t</mi><mo id="algorithm1.12.12.m1.4.4.2.2.2.2.3.1" xref="algorithm1.12.12.m1.4.4.2.2.2.2.3.1.cmml">−</mo><mn id="algorithm1.12.12.m1.4.4.2.2.2.2.3.3" xref="algorithm1.12.12.m1.4.4.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="algorithm1.12.12.m1.4.4.2.2.2.5" xref="algorithm1.12.12.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.4b"><apply id="algorithm1.12.12.m1.4.4.cmml" xref="algorithm1.12.12.m1.4.4"><eq id="algorithm1.12.12.m1.4.4.3.cmml" xref="algorithm1.12.12.m1.4.4.3"></eq><apply id="algorithm1.12.12.m1.4.4.4.cmml" xref="algorithm1.12.12.m1.4.4.4"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.4.4.4.1.cmml" xref="algorithm1.12.12.m1.4.4.4">superscript</csymbol><apply id="algorithm1.12.12.m1.4.4.4.2.cmml" xref="algorithm1.12.12.m1.4.4.4"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.4.4.4.2.1.cmml" xref="algorithm1.12.12.m1.4.4.4">subscript</csymbol><ci id="algorithm1.12.12.m1.4.4.4.2.2.cmml" xref="algorithm1.12.12.m1.4.4.4.2.2">𝑊</ci><ci id="algorithm1.12.12.m1.4.4.4.2.3.cmml" xref="algorithm1.12.12.m1.4.4.4.2.3">𝑖</ci></apply><list id="algorithm1.12.12.m1.2.2.2.3.cmml" xref="algorithm1.12.12.m1.2.2.2.4"><ci id="algorithm1.12.12.m1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1.1">𝑡</ci><cn type="integer" id="algorithm1.12.12.m1.2.2.2.2.cmml" xref="algorithm1.12.12.m1.2.2.2.2">0</cn></list></apply><apply id="algorithm1.12.12.m1.4.4.2.cmml" xref="algorithm1.12.12.m1.4.4.2"><times id="algorithm1.12.12.m1.4.4.2.3.cmml" xref="algorithm1.12.12.m1.4.4.2.3"></times><ci id="algorithm1.12.12.m1.4.4.2.4.cmml" xref="algorithm1.12.12.m1.4.4.2.4">ℎ</ci><list id="algorithm1.12.12.m1.4.4.2.2.3.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2"><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1">superscript</csymbol><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2">𝜑</ci><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.3.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3"><minus id="algorithm1.12.12.m1.3.3.1.1.1.1.3.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3.1"></minus><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.3.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.12.12.m1.3.3.1.1.1.1.3.3.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3.3">1</cn></apply></apply><apply id="algorithm1.12.12.m1.4.4.2.2.2.2.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.4.4.2.2.2.2.1.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2">superscript</csymbol><apply id="algorithm1.12.12.m1.4.4.2.2.2.2.2.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.4.4.2.2.2.2.2.1.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2">subscript</csymbol><ci id="algorithm1.12.12.m1.4.4.2.2.2.2.2.2.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2.2.2">𝑧</ci><ci id="algorithm1.12.12.m1.4.4.2.2.2.2.2.3.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2.2.3">𝑖</ci></apply><apply id="algorithm1.12.12.m1.4.4.2.2.2.2.3.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2.3"><minus id="algorithm1.12.12.m1.4.4.2.2.2.2.3.1.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2.3.1"></minus><ci id="algorithm1.12.12.m1.4.4.2.2.2.2.3.2.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.12.12.m1.4.4.2.2.2.2.3.3.cmml" xref="algorithm1.12.12.m1.4.4.2.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.4c">W_{i}^{t,0}=h(\varphi^{t-1};z_{i}^{t-1})</annotation></semantics></math>; 
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.13.13.m1.8" class="ltx_Math" alttext="\theta_{i}^{t,0}=\{W_{i}^{t,0},\xi^{t,0}\}" display="inline"><semantics id="algorithm1.13.13.m1.8a"><mrow id="algorithm1.13.13.m1.8.8" xref="algorithm1.13.13.m1.8.8.cmml"><msubsup id="algorithm1.13.13.m1.8.8.4" xref="algorithm1.13.13.m1.8.8.4.cmml"><mi id="algorithm1.13.13.m1.8.8.4.2.2" xref="algorithm1.13.13.m1.8.8.4.2.2.cmml">θ</mi><mi id="algorithm1.13.13.m1.8.8.4.2.3" xref="algorithm1.13.13.m1.8.8.4.2.3.cmml">i</mi><mrow id="algorithm1.13.13.m1.2.2.2.4" xref="algorithm1.13.13.m1.2.2.2.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.cmml">t</mi><mo id="algorithm1.13.13.m1.2.2.2.4.1" xref="algorithm1.13.13.m1.2.2.2.3.cmml">,</mo><mn id="algorithm1.13.13.m1.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.cmml">0</mn></mrow></msubsup><mo id="algorithm1.13.13.m1.8.8.3" xref="algorithm1.13.13.m1.8.8.3.cmml">=</mo><mrow id="algorithm1.13.13.m1.8.8.2.2" xref="algorithm1.13.13.m1.8.8.2.3.cmml"><mo stretchy="false" id="algorithm1.13.13.m1.8.8.2.2.3" xref="algorithm1.13.13.m1.8.8.2.3.cmml">{</mo><msubsup id="algorithm1.13.13.m1.7.7.1.1.1" xref="algorithm1.13.13.m1.7.7.1.1.1.cmml"><mi id="algorithm1.13.13.m1.7.7.1.1.1.2.2" xref="algorithm1.13.13.m1.7.7.1.1.1.2.2.cmml">W</mi><mi id="algorithm1.13.13.m1.7.7.1.1.1.2.3" xref="algorithm1.13.13.m1.7.7.1.1.1.2.3.cmml">i</mi><mrow id="algorithm1.13.13.m1.4.4.2.4" xref="algorithm1.13.13.m1.4.4.2.3.cmml"><mi id="algorithm1.13.13.m1.3.3.1.1" xref="algorithm1.13.13.m1.3.3.1.1.cmml">t</mi><mo id="algorithm1.13.13.m1.4.4.2.4.1" xref="algorithm1.13.13.m1.4.4.2.3.cmml">,</mo><mn id="algorithm1.13.13.m1.4.4.2.2" xref="algorithm1.13.13.m1.4.4.2.2.cmml">0</mn></mrow></msubsup><mo id="algorithm1.13.13.m1.8.8.2.2.4" xref="algorithm1.13.13.m1.8.8.2.3.cmml">,</mo><msup id="algorithm1.13.13.m1.8.8.2.2.2" xref="algorithm1.13.13.m1.8.8.2.2.2.cmml"><mi id="algorithm1.13.13.m1.8.8.2.2.2.2" xref="algorithm1.13.13.m1.8.8.2.2.2.2.cmml">ξ</mi><mrow id="algorithm1.13.13.m1.6.6.2.4" xref="algorithm1.13.13.m1.6.6.2.3.cmml"><mi id="algorithm1.13.13.m1.5.5.1.1" xref="algorithm1.13.13.m1.5.5.1.1.cmml">t</mi><mo id="algorithm1.13.13.m1.6.6.2.4.1" xref="algorithm1.13.13.m1.6.6.2.3.cmml">,</mo><mn id="algorithm1.13.13.m1.6.6.2.2" xref="algorithm1.13.13.m1.6.6.2.2.cmml">0</mn></mrow></msup><mo stretchy="false" id="algorithm1.13.13.m1.8.8.2.2.5" xref="algorithm1.13.13.m1.8.8.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.8b"><apply id="algorithm1.13.13.m1.8.8.cmml" xref="algorithm1.13.13.m1.8.8"><eq id="algorithm1.13.13.m1.8.8.3.cmml" xref="algorithm1.13.13.m1.8.8.3"></eq><apply id="algorithm1.13.13.m1.8.8.4.cmml" xref="algorithm1.13.13.m1.8.8.4"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.8.8.4.1.cmml" xref="algorithm1.13.13.m1.8.8.4">superscript</csymbol><apply id="algorithm1.13.13.m1.8.8.4.2.cmml" xref="algorithm1.13.13.m1.8.8.4"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.8.8.4.2.1.cmml" xref="algorithm1.13.13.m1.8.8.4">subscript</csymbol><ci id="algorithm1.13.13.m1.8.8.4.2.2.cmml" xref="algorithm1.13.13.m1.8.8.4.2.2">𝜃</ci><ci id="algorithm1.13.13.m1.8.8.4.2.3.cmml" xref="algorithm1.13.13.m1.8.8.4.2.3">𝑖</ci></apply><list id="algorithm1.13.13.m1.2.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2.4"><ci id="algorithm1.13.13.m1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1">𝑡</ci><cn type="integer" id="algorithm1.13.13.m1.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2">0</cn></list></apply><set id="algorithm1.13.13.m1.8.8.2.3.cmml" xref="algorithm1.13.13.m1.8.8.2.2"><apply id="algorithm1.13.13.m1.7.7.1.1.1.cmml" xref="algorithm1.13.13.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.7.7.1.1.1.1.cmml" xref="algorithm1.13.13.m1.7.7.1.1.1">superscript</csymbol><apply id="algorithm1.13.13.m1.7.7.1.1.1.2.cmml" xref="algorithm1.13.13.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.7.7.1.1.1.2.1.cmml" xref="algorithm1.13.13.m1.7.7.1.1.1">subscript</csymbol><ci id="algorithm1.13.13.m1.7.7.1.1.1.2.2.cmml" xref="algorithm1.13.13.m1.7.7.1.1.1.2.2">𝑊</ci><ci id="algorithm1.13.13.m1.7.7.1.1.1.2.3.cmml" xref="algorithm1.13.13.m1.7.7.1.1.1.2.3">𝑖</ci></apply><list id="algorithm1.13.13.m1.4.4.2.3.cmml" xref="algorithm1.13.13.m1.4.4.2.4"><ci id="algorithm1.13.13.m1.3.3.1.1.cmml" xref="algorithm1.13.13.m1.3.3.1.1">𝑡</ci><cn type="integer" id="algorithm1.13.13.m1.4.4.2.2.cmml" xref="algorithm1.13.13.m1.4.4.2.2">0</cn></list></apply><apply id="algorithm1.13.13.m1.8.8.2.2.2.cmml" xref="algorithm1.13.13.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.8.8.2.2.2.1.cmml" xref="algorithm1.13.13.m1.8.8.2.2.2">superscript</csymbol><ci id="algorithm1.13.13.m1.8.8.2.2.2.2.cmml" xref="algorithm1.13.13.m1.8.8.2.2.2.2">𝜉</ci><list id="algorithm1.13.13.m1.6.6.2.3.cmml" xref="algorithm1.13.13.m1.6.6.2.4"><ci id="algorithm1.13.13.m1.5.5.1.1.cmml" xref="algorithm1.13.13.m1.5.5.1.1">𝑡</ci><cn type="integer" id="algorithm1.13.13.m1.6.6.2.2.cmml" xref="algorithm1.13.13.m1.6.6.2.2">0</cn></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.8c">\theta_{i}^{t,0}=\{W_{i}^{t,0},\xi^{t,0}\}</annotation></semantics></math>; 
</div>
<div id="algorithm1.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.14.14.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.14.14.1" class="ltx_emph ltx_font_italic">each local epoch <math id="algorithm1.14.14.1.m1.3" class="ltx_Math" alttext="k\in\{1,...,K\}" display="inline"><semantics id="algorithm1.14.14.1.m1.3a"><mrow id="algorithm1.14.14.1.m1.3.4" xref="algorithm1.14.14.1.m1.3.4.cmml"><mi id="algorithm1.14.14.1.m1.3.4.2" xref="algorithm1.14.14.1.m1.3.4.2.cmml">k</mi><mo id="algorithm1.14.14.1.m1.3.4.1" xref="algorithm1.14.14.1.m1.3.4.1.cmml">∈</mo><mrow id="algorithm1.14.14.1.m1.3.4.3.2" xref="algorithm1.14.14.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="algorithm1.14.14.1.m1.3.4.3.2.1" xref="algorithm1.14.14.1.m1.3.4.3.1.cmml">{</mo><mn id="algorithm1.14.14.1.m1.1.1" xref="algorithm1.14.14.1.m1.1.1.cmml">1</mn><mo id="algorithm1.14.14.1.m1.3.4.3.2.2" xref="algorithm1.14.14.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.14.14.1.m1.2.2" xref="algorithm1.14.14.1.m1.2.2.cmml">…</mi><mo id="algorithm1.14.14.1.m1.3.4.3.2.3" xref="algorithm1.14.14.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm1.14.14.1.m1.3.3" xref="algorithm1.14.14.1.m1.3.3.cmml">K</mi><mo stretchy="false" id="algorithm1.14.14.1.m1.3.4.3.2.4" xref="algorithm1.14.14.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.1.m1.3b"><apply id="algorithm1.14.14.1.m1.3.4.cmml" xref="algorithm1.14.14.1.m1.3.4"><in id="algorithm1.14.14.1.m1.3.4.1.cmml" xref="algorithm1.14.14.1.m1.3.4.1"></in><ci id="algorithm1.14.14.1.m1.3.4.2.cmml" xref="algorithm1.14.14.1.m1.3.4.2">𝑘</ci><set id="algorithm1.14.14.1.m1.3.4.3.1.cmml" xref="algorithm1.14.14.1.m1.3.4.3.2"><cn type="integer" id="algorithm1.14.14.1.m1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1">1</cn><ci id="algorithm1.14.14.1.m1.2.2.cmml" xref="algorithm1.14.14.1.m1.2.2">…</ci><ci id="algorithm1.14.14.1.m1.3.3.cmml" xref="algorithm1.14.14.1.m1.3.3">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.1.m1.3c">k\in\{1,...,K\}</annotation></semantics></math></em> <span id="algorithm1.14.14.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Sample mini-batch <math id="algorithm1.15.15.m1.1" class="ltx_Math" alttext="B_{i}\in D_{i}" display="inline"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><msub id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml"><mi id="algorithm1.15.15.m1.1.1.2.2" xref="algorithm1.15.15.m1.1.1.2.2.cmml">B</mi><mi id="algorithm1.15.15.m1.1.1.2.3" xref="algorithm1.15.15.m1.1.1.2.3.cmml">i</mi></msub><mo id="algorithm1.15.15.m1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.cmml">∈</mo><msub id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml"><mi id="algorithm1.15.15.m1.1.1.3.2" xref="algorithm1.15.15.m1.1.1.3.2.cmml">D</mi><mi id="algorithm1.15.15.m1.1.1.3.3" xref="algorithm1.15.15.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><in id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1"></in><apply id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.2.1.cmml" xref="algorithm1.15.15.m1.1.1.2">subscript</csymbol><ci id="algorithm1.15.15.m1.1.1.2.2.cmml" xref="algorithm1.15.15.m1.1.1.2.2">𝐵</ci><ci id="algorithm1.15.15.m1.1.1.2.3.cmml" xref="algorithm1.15.15.m1.1.1.2.3">𝑖</ci></apply><apply id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.3.1.cmml" xref="algorithm1.15.15.m1.1.1.3">subscript</csymbol><ci id="algorithm1.15.15.m1.1.1.3.2.cmml" xref="algorithm1.15.15.m1.1.1.3.2">𝐷</ci><ci id="algorithm1.15.15.m1.1.1.3.3.cmml" xref="algorithm1.15.15.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">B_{i}\in D_{i}</annotation></semantics></math>; 
</div>
<div id="algorithm1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.16.16.m1.8" class="ltx_Math" alttext="\theta_{i}^{t,k+1}\leftarrow\theta_{i}^{t,k}-\alpha\nabla_{\theta_{i}}\mathcal{L}_{i}(\theta_{i}^{t,k};B_{i})" display="inline"><semantics id="algorithm1.16.16.m1.8a"><mrow id="algorithm1.16.16.m1.8.8" xref="algorithm1.16.16.m1.8.8.cmml"><msubsup id="algorithm1.16.16.m1.8.8.4" xref="algorithm1.16.16.m1.8.8.4.cmml"><mi id="algorithm1.16.16.m1.8.8.4.2.2" xref="algorithm1.16.16.m1.8.8.4.2.2.cmml">θ</mi><mi id="algorithm1.16.16.m1.8.8.4.2.3" xref="algorithm1.16.16.m1.8.8.4.2.3.cmml">i</mi><mrow id="algorithm1.16.16.m1.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.3.cmml"><mi id="algorithm1.16.16.m1.1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.1.cmml">t</mi><mo id="algorithm1.16.16.m1.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.3.cmml">,</mo><mrow id="algorithm1.16.16.m1.2.2.2.2.1" xref="algorithm1.16.16.m1.2.2.2.2.1.cmml"><mi id="algorithm1.16.16.m1.2.2.2.2.1.2" xref="algorithm1.16.16.m1.2.2.2.2.1.2.cmml">k</mi><mo id="algorithm1.16.16.m1.2.2.2.2.1.1" xref="algorithm1.16.16.m1.2.2.2.2.1.1.cmml">+</mo><mn id="algorithm1.16.16.m1.2.2.2.2.1.3" xref="algorithm1.16.16.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo stretchy="false" id="algorithm1.16.16.m1.8.8.3" xref="algorithm1.16.16.m1.8.8.3.cmml">←</mo><mrow id="algorithm1.16.16.m1.8.8.2" xref="algorithm1.16.16.m1.8.8.2.cmml"><msubsup id="algorithm1.16.16.m1.8.8.2.4" xref="algorithm1.16.16.m1.8.8.2.4.cmml"><mi id="algorithm1.16.16.m1.8.8.2.4.2.2" xref="algorithm1.16.16.m1.8.8.2.4.2.2.cmml">θ</mi><mi id="algorithm1.16.16.m1.8.8.2.4.2.3" xref="algorithm1.16.16.m1.8.8.2.4.2.3.cmml">i</mi><mrow id="algorithm1.16.16.m1.4.4.2.4" xref="algorithm1.16.16.m1.4.4.2.3.cmml"><mi id="algorithm1.16.16.m1.3.3.1.1" xref="algorithm1.16.16.m1.3.3.1.1.cmml">t</mi><mo id="algorithm1.16.16.m1.4.4.2.4.1" xref="algorithm1.16.16.m1.4.4.2.3.cmml">,</mo><mi id="algorithm1.16.16.m1.4.4.2.2" xref="algorithm1.16.16.m1.4.4.2.2.cmml">k</mi></mrow></msubsup><mo id="algorithm1.16.16.m1.8.8.2.3" xref="algorithm1.16.16.m1.8.8.2.3.cmml">−</mo><mrow id="algorithm1.16.16.m1.8.8.2.2" xref="algorithm1.16.16.m1.8.8.2.2.cmml"><mi id="algorithm1.16.16.m1.8.8.2.2.4" xref="algorithm1.16.16.m1.8.8.2.2.4.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="algorithm1.16.16.m1.8.8.2.2.3" xref="algorithm1.16.16.m1.8.8.2.2.3.cmml">​</mo><mrow id="algorithm1.16.16.m1.8.8.2.2.5" xref="algorithm1.16.16.m1.8.8.2.2.5.cmml"><msub id="algorithm1.16.16.m1.8.8.2.2.5.1" xref="algorithm1.16.16.m1.8.8.2.2.5.1.cmml"><mo rspace="0.167em" id="algorithm1.16.16.m1.8.8.2.2.5.1.2" xref="algorithm1.16.16.m1.8.8.2.2.5.1.2.cmml">∇</mo><msub id="algorithm1.16.16.m1.8.8.2.2.5.1.3" xref="algorithm1.16.16.m1.8.8.2.2.5.1.3.cmml"><mi id="algorithm1.16.16.m1.8.8.2.2.5.1.3.2" xref="algorithm1.16.16.m1.8.8.2.2.5.1.3.2.cmml">θ</mi><mi id="algorithm1.16.16.m1.8.8.2.2.5.1.3.3" xref="algorithm1.16.16.m1.8.8.2.2.5.1.3.3.cmml">i</mi></msub></msub><msub id="algorithm1.16.16.m1.8.8.2.2.5.2" xref="algorithm1.16.16.m1.8.8.2.2.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.16.16.m1.8.8.2.2.5.2.2" xref="algorithm1.16.16.m1.8.8.2.2.5.2.2.cmml">ℒ</mi><mi id="algorithm1.16.16.m1.8.8.2.2.5.2.3" xref="algorithm1.16.16.m1.8.8.2.2.5.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.8.8.2.2.3a" xref="algorithm1.16.16.m1.8.8.2.2.3.cmml">​</mo><mrow id="algorithm1.16.16.m1.8.8.2.2.2.2" xref="algorithm1.16.16.m1.8.8.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.16.16.m1.8.8.2.2.2.2.3" xref="algorithm1.16.16.m1.8.8.2.2.2.3.cmml">(</mo><msubsup id="algorithm1.16.16.m1.7.7.1.1.1.1.1" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1.cmml"><mi id="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.2" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.2.cmml">θ</mi><mi id="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.3" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.3.cmml">i</mi><mrow id="algorithm1.16.16.m1.6.6.2.4" xref="algorithm1.16.16.m1.6.6.2.3.cmml"><mi id="algorithm1.16.16.m1.5.5.1.1" xref="algorithm1.16.16.m1.5.5.1.1.cmml">t</mi><mo id="algorithm1.16.16.m1.6.6.2.4.1" xref="algorithm1.16.16.m1.6.6.2.3.cmml">,</mo><mi id="algorithm1.16.16.m1.6.6.2.2" xref="algorithm1.16.16.m1.6.6.2.2.cmml">k</mi></mrow></msubsup><mo id="algorithm1.16.16.m1.8.8.2.2.2.2.4" xref="algorithm1.16.16.m1.8.8.2.2.2.3.cmml">;</mo><msub id="algorithm1.16.16.m1.8.8.2.2.2.2.2" xref="algorithm1.16.16.m1.8.8.2.2.2.2.2.cmml"><mi id="algorithm1.16.16.m1.8.8.2.2.2.2.2.2" xref="algorithm1.16.16.m1.8.8.2.2.2.2.2.2.cmml">B</mi><mi id="algorithm1.16.16.m1.8.8.2.2.2.2.2.3" xref="algorithm1.16.16.m1.8.8.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm1.16.16.m1.8.8.2.2.2.2.5" xref="algorithm1.16.16.m1.8.8.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.8b"><apply id="algorithm1.16.16.m1.8.8.cmml" xref="algorithm1.16.16.m1.8.8"><ci id="algorithm1.16.16.m1.8.8.3.cmml" xref="algorithm1.16.16.m1.8.8.3">←</ci><apply id="algorithm1.16.16.m1.8.8.4.cmml" xref="algorithm1.16.16.m1.8.8.4"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.8.8.4.1.cmml" xref="algorithm1.16.16.m1.8.8.4">superscript</csymbol><apply id="algorithm1.16.16.m1.8.8.4.2.cmml" xref="algorithm1.16.16.m1.8.8.4"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.8.8.4.2.1.cmml" xref="algorithm1.16.16.m1.8.8.4">subscript</csymbol><ci id="algorithm1.16.16.m1.8.8.4.2.2.cmml" xref="algorithm1.16.16.m1.8.8.4.2.2">𝜃</ci><ci id="algorithm1.16.16.m1.8.8.4.2.3.cmml" xref="algorithm1.16.16.m1.8.8.4.2.3">𝑖</ci></apply><list id="algorithm1.16.16.m1.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2"><ci id="algorithm1.16.16.m1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1">𝑡</ci><apply id="algorithm1.16.16.m1.2.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.1"><plus id="algorithm1.16.16.m1.2.2.2.2.1.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.1.1"></plus><ci id="algorithm1.16.16.m1.2.2.2.2.1.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.1.2">𝑘</ci><cn type="integer" id="algorithm1.16.16.m1.2.2.2.2.1.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="algorithm1.16.16.m1.8.8.2.cmml" xref="algorithm1.16.16.m1.8.8.2"><minus id="algorithm1.16.16.m1.8.8.2.3.cmml" xref="algorithm1.16.16.m1.8.8.2.3"></minus><apply id="algorithm1.16.16.m1.8.8.2.4.cmml" xref="algorithm1.16.16.m1.8.8.2.4"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.8.8.2.4.1.cmml" xref="algorithm1.16.16.m1.8.8.2.4">superscript</csymbol><apply id="algorithm1.16.16.m1.8.8.2.4.2.cmml" xref="algorithm1.16.16.m1.8.8.2.4"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.8.8.2.4.2.1.cmml" xref="algorithm1.16.16.m1.8.8.2.4">subscript</csymbol><ci id="algorithm1.16.16.m1.8.8.2.4.2.2.cmml" xref="algorithm1.16.16.m1.8.8.2.4.2.2">𝜃</ci><ci id="algorithm1.16.16.m1.8.8.2.4.2.3.cmml" xref="algorithm1.16.16.m1.8.8.2.4.2.3">𝑖</ci></apply><list id="algorithm1.16.16.m1.4.4.2.3.cmml" xref="algorithm1.16.16.m1.4.4.2.4"><ci id="algorithm1.16.16.m1.3.3.1.1.cmml" xref="algorithm1.16.16.m1.3.3.1.1">𝑡</ci><ci id="algorithm1.16.16.m1.4.4.2.2.cmml" xref="algorithm1.16.16.m1.4.4.2.2">𝑘</ci></list></apply><apply id="algorithm1.16.16.m1.8.8.2.2.cmml" xref="algorithm1.16.16.m1.8.8.2.2"><times id="algorithm1.16.16.m1.8.8.2.2.3.cmml" xref="algorithm1.16.16.m1.8.8.2.2.3"></times><ci id="algorithm1.16.16.m1.8.8.2.2.4.cmml" xref="algorithm1.16.16.m1.8.8.2.2.4">𝛼</ci><apply id="algorithm1.16.16.m1.8.8.2.2.5.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5"><apply id="algorithm1.16.16.m1.8.8.2.2.5.1.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.8.8.2.2.5.1.1.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.1">subscript</csymbol><ci id="algorithm1.16.16.m1.8.8.2.2.5.1.2.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.1.2">∇</ci><apply id="algorithm1.16.16.m1.8.8.2.2.5.1.3.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.1.3"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.8.8.2.2.5.1.3.1.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.1.3">subscript</csymbol><ci id="algorithm1.16.16.m1.8.8.2.2.5.1.3.2.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.1.3.2">𝜃</ci><ci id="algorithm1.16.16.m1.8.8.2.2.5.1.3.3.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.1.3.3">𝑖</ci></apply></apply><apply id="algorithm1.16.16.m1.8.8.2.2.5.2.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.8.8.2.2.5.2.1.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.2">subscript</csymbol><ci id="algorithm1.16.16.m1.8.8.2.2.5.2.2.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.2.2">ℒ</ci><ci id="algorithm1.16.16.m1.8.8.2.2.5.2.3.cmml" xref="algorithm1.16.16.m1.8.8.2.2.5.2.3">𝑖</ci></apply></apply><list id="algorithm1.16.16.m1.8.8.2.2.2.3.cmml" xref="algorithm1.16.16.m1.8.8.2.2.2.2"><apply id="algorithm1.16.16.m1.7.7.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.7.7.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.1.cmml" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.2.cmml" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.2">𝜃</ci><ci id="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.3.cmml" xref="algorithm1.16.16.m1.7.7.1.1.1.1.1.2.3">𝑖</ci></apply><list id="algorithm1.16.16.m1.6.6.2.3.cmml" xref="algorithm1.16.16.m1.6.6.2.4"><ci id="algorithm1.16.16.m1.5.5.1.1.cmml" xref="algorithm1.16.16.m1.5.5.1.1">𝑡</ci><ci id="algorithm1.16.16.m1.6.6.2.2.cmml" xref="algorithm1.16.16.m1.6.6.2.2">𝑘</ci></list></apply><apply id="algorithm1.16.16.m1.8.8.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.8.8.2.2.2.2.2.1.cmml" xref="algorithm1.16.16.m1.8.8.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.16.16.m1.8.8.2.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.8.8.2.2.2.2.2.2">𝐵</ci><ci id="algorithm1.16.16.m1.8.8.2.2.2.2.2.3.cmml" xref="algorithm1.16.16.m1.8.8.2.2.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.8c">\theta_{i}^{t,k+1}\leftarrow\theta_{i}^{t,k}-\alpha\nabla_{\theta_{i}}\mathcal{L}_{i}(\theta_{i}^{t,k};B_{i})</annotation></semantics></math>;

</div>
<div id="algorithm1.23.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.17.17.m1.4" class="ltx_Math" alttext="\Delta W_{i}=W_{i}^{t,K}-W_{i}^{t,0}" display="inline"><semantics id="algorithm1.17.17.m1.4a"><mrow id="algorithm1.17.17.m1.4.5" xref="algorithm1.17.17.m1.4.5.cmml"><mrow id="algorithm1.17.17.m1.4.5.2" xref="algorithm1.17.17.m1.4.5.2.cmml"><mi mathvariant="normal" id="algorithm1.17.17.m1.4.5.2.2" xref="algorithm1.17.17.m1.4.5.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="algorithm1.17.17.m1.4.5.2.1" xref="algorithm1.17.17.m1.4.5.2.1.cmml">​</mo><msub id="algorithm1.17.17.m1.4.5.2.3" xref="algorithm1.17.17.m1.4.5.2.3.cmml"><mi id="algorithm1.17.17.m1.4.5.2.3.2" xref="algorithm1.17.17.m1.4.5.2.3.2.cmml">W</mi><mi id="algorithm1.17.17.m1.4.5.2.3.3" xref="algorithm1.17.17.m1.4.5.2.3.3.cmml">i</mi></msub></mrow><mo id="algorithm1.17.17.m1.4.5.1" xref="algorithm1.17.17.m1.4.5.1.cmml">=</mo><mrow id="algorithm1.17.17.m1.4.5.3" xref="algorithm1.17.17.m1.4.5.3.cmml"><msubsup id="algorithm1.17.17.m1.4.5.3.2" xref="algorithm1.17.17.m1.4.5.3.2.cmml"><mi id="algorithm1.17.17.m1.4.5.3.2.2.2" xref="algorithm1.17.17.m1.4.5.3.2.2.2.cmml">W</mi><mi id="algorithm1.17.17.m1.4.5.3.2.2.3" xref="algorithm1.17.17.m1.4.5.3.2.2.3.cmml">i</mi><mrow id="algorithm1.17.17.m1.2.2.2.4" xref="algorithm1.17.17.m1.2.2.2.3.cmml"><mi id="algorithm1.17.17.m1.1.1.1.1" xref="algorithm1.17.17.m1.1.1.1.1.cmml">t</mi><mo id="algorithm1.17.17.m1.2.2.2.4.1" xref="algorithm1.17.17.m1.2.2.2.3.cmml">,</mo><mi id="algorithm1.17.17.m1.2.2.2.2" xref="algorithm1.17.17.m1.2.2.2.2.cmml">K</mi></mrow></msubsup><mo id="algorithm1.17.17.m1.4.5.3.1" xref="algorithm1.17.17.m1.4.5.3.1.cmml">−</mo><msubsup id="algorithm1.17.17.m1.4.5.3.3" xref="algorithm1.17.17.m1.4.5.3.3.cmml"><mi id="algorithm1.17.17.m1.4.5.3.3.2.2" xref="algorithm1.17.17.m1.4.5.3.3.2.2.cmml">W</mi><mi id="algorithm1.17.17.m1.4.5.3.3.2.3" xref="algorithm1.17.17.m1.4.5.3.3.2.3.cmml">i</mi><mrow id="algorithm1.17.17.m1.4.4.2.4" xref="algorithm1.17.17.m1.4.4.2.3.cmml"><mi id="algorithm1.17.17.m1.3.3.1.1" xref="algorithm1.17.17.m1.3.3.1.1.cmml">t</mi><mo id="algorithm1.17.17.m1.4.4.2.4.1" xref="algorithm1.17.17.m1.4.4.2.3.cmml">,</mo><mn id="algorithm1.17.17.m1.4.4.2.2" xref="algorithm1.17.17.m1.4.4.2.2.cmml">0</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.4b"><apply id="algorithm1.17.17.m1.4.5.cmml" xref="algorithm1.17.17.m1.4.5"><eq id="algorithm1.17.17.m1.4.5.1.cmml" xref="algorithm1.17.17.m1.4.5.1"></eq><apply id="algorithm1.17.17.m1.4.5.2.cmml" xref="algorithm1.17.17.m1.4.5.2"><times id="algorithm1.17.17.m1.4.5.2.1.cmml" xref="algorithm1.17.17.m1.4.5.2.1"></times><ci id="algorithm1.17.17.m1.4.5.2.2.cmml" xref="algorithm1.17.17.m1.4.5.2.2">Δ</ci><apply id="algorithm1.17.17.m1.4.5.2.3.cmml" xref="algorithm1.17.17.m1.4.5.2.3"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.4.5.2.3.1.cmml" xref="algorithm1.17.17.m1.4.5.2.3">subscript</csymbol><ci id="algorithm1.17.17.m1.4.5.2.3.2.cmml" xref="algorithm1.17.17.m1.4.5.2.3.2">𝑊</ci><ci id="algorithm1.17.17.m1.4.5.2.3.3.cmml" xref="algorithm1.17.17.m1.4.5.2.3.3">𝑖</ci></apply></apply><apply id="algorithm1.17.17.m1.4.5.3.cmml" xref="algorithm1.17.17.m1.4.5.3"><minus id="algorithm1.17.17.m1.4.5.3.1.cmml" xref="algorithm1.17.17.m1.4.5.3.1"></minus><apply id="algorithm1.17.17.m1.4.5.3.2.cmml" xref="algorithm1.17.17.m1.4.5.3.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.4.5.3.2.1.cmml" xref="algorithm1.17.17.m1.4.5.3.2">superscript</csymbol><apply id="algorithm1.17.17.m1.4.5.3.2.2.cmml" xref="algorithm1.17.17.m1.4.5.3.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.4.5.3.2.2.1.cmml" xref="algorithm1.17.17.m1.4.5.3.2">subscript</csymbol><ci id="algorithm1.17.17.m1.4.5.3.2.2.2.cmml" xref="algorithm1.17.17.m1.4.5.3.2.2.2">𝑊</ci><ci id="algorithm1.17.17.m1.4.5.3.2.2.3.cmml" xref="algorithm1.17.17.m1.4.5.3.2.2.3">𝑖</ci></apply><list id="algorithm1.17.17.m1.2.2.2.3.cmml" xref="algorithm1.17.17.m1.2.2.2.4"><ci id="algorithm1.17.17.m1.1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1.1.1">𝑡</ci><ci id="algorithm1.17.17.m1.2.2.2.2.cmml" xref="algorithm1.17.17.m1.2.2.2.2">𝐾</ci></list></apply><apply id="algorithm1.17.17.m1.4.5.3.3.cmml" xref="algorithm1.17.17.m1.4.5.3.3"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.4.5.3.3.1.cmml" xref="algorithm1.17.17.m1.4.5.3.3">superscript</csymbol><apply id="algorithm1.17.17.m1.4.5.3.3.2.cmml" xref="algorithm1.17.17.m1.4.5.3.3"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.4.5.3.3.2.1.cmml" xref="algorithm1.17.17.m1.4.5.3.3">subscript</csymbol><ci id="algorithm1.17.17.m1.4.5.3.3.2.2.cmml" xref="algorithm1.17.17.m1.4.5.3.3.2.2">𝑊</ci><ci id="algorithm1.17.17.m1.4.5.3.3.2.3.cmml" xref="algorithm1.17.17.m1.4.5.3.3.2.3">𝑖</ci></apply><list id="algorithm1.17.17.m1.4.4.2.3.cmml" xref="algorithm1.17.17.m1.4.4.2.4"><ci id="algorithm1.17.17.m1.3.3.1.1.cmml" xref="algorithm1.17.17.m1.3.3.1.1">𝑡</ci><cn type="integer" id="algorithm1.17.17.m1.4.4.2.2.cmml" xref="algorithm1.17.17.m1.4.4.2.2">0</cn></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.4c">\Delta W_{i}=W_{i}^{t,K}-W_{i}^{t,0}</annotation></semantics></math>;

</div>
<div id="algorithm1.23.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.18.18.m1.2" class="ltx_Math" alttext="\bar{\xi}^{t}=\sum_{i\in C^{t}}\frac{m_{i}}{M}\xi^{t,K}" display="inline"><semantics id="algorithm1.18.18.m1.2a"><mrow id="algorithm1.18.18.m1.2.3" xref="algorithm1.18.18.m1.2.3.cmml"><msup id="algorithm1.18.18.m1.2.3.2" xref="algorithm1.18.18.m1.2.3.2.cmml"><mover accent="true" id="algorithm1.18.18.m1.2.3.2.2" xref="algorithm1.18.18.m1.2.3.2.2.cmml"><mi id="algorithm1.18.18.m1.2.3.2.2.2" xref="algorithm1.18.18.m1.2.3.2.2.2.cmml">ξ</mi><mo id="algorithm1.18.18.m1.2.3.2.2.1" xref="algorithm1.18.18.m1.2.3.2.2.1.cmml">¯</mo></mover><mi id="algorithm1.18.18.m1.2.3.2.3" xref="algorithm1.18.18.m1.2.3.2.3.cmml">t</mi></msup><mo rspace="0.111em" id="algorithm1.18.18.m1.2.3.1" xref="algorithm1.18.18.m1.2.3.1.cmml">=</mo><mrow id="algorithm1.18.18.m1.2.3.3" xref="algorithm1.18.18.m1.2.3.3.cmml"><msub id="algorithm1.18.18.m1.2.3.3.1" xref="algorithm1.18.18.m1.2.3.3.1.cmml"><mo id="algorithm1.18.18.m1.2.3.3.1.2" xref="algorithm1.18.18.m1.2.3.3.1.2.cmml">∑</mo><mrow id="algorithm1.18.18.m1.2.3.3.1.3" xref="algorithm1.18.18.m1.2.3.3.1.3.cmml"><mi id="algorithm1.18.18.m1.2.3.3.1.3.2" xref="algorithm1.18.18.m1.2.3.3.1.3.2.cmml">i</mi><mo id="algorithm1.18.18.m1.2.3.3.1.3.1" xref="algorithm1.18.18.m1.2.3.3.1.3.1.cmml">∈</mo><msup id="algorithm1.18.18.m1.2.3.3.1.3.3" xref="algorithm1.18.18.m1.2.3.3.1.3.3.cmml"><mi id="algorithm1.18.18.m1.2.3.3.1.3.3.2" xref="algorithm1.18.18.m1.2.3.3.1.3.3.2.cmml">C</mi><mi id="algorithm1.18.18.m1.2.3.3.1.3.3.3" xref="algorithm1.18.18.m1.2.3.3.1.3.3.3.cmml">t</mi></msup></mrow></msub><mrow id="algorithm1.18.18.m1.2.3.3.2" xref="algorithm1.18.18.m1.2.3.3.2.cmml"><mfrac id="algorithm1.18.18.m1.2.3.3.2.2" xref="algorithm1.18.18.m1.2.3.3.2.2.cmml"><msub id="algorithm1.18.18.m1.2.3.3.2.2.2" xref="algorithm1.18.18.m1.2.3.3.2.2.2.cmml"><mi id="algorithm1.18.18.m1.2.3.3.2.2.2.2" xref="algorithm1.18.18.m1.2.3.3.2.2.2.2.cmml">m</mi><mi id="algorithm1.18.18.m1.2.3.3.2.2.2.3" xref="algorithm1.18.18.m1.2.3.3.2.2.2.3.cmml">i</mi></msub><mi id="algorithm1.18.18.m1.2.3.3.2.2.3" xref="algorithm1.18.18.m1.2.3.3.2.2.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m1.2.3.3.2.1" xref="algorithm1.18.18.m1.2.3.3.2.1.cmml">​</mo><msup id="algorithm1.18.18.m1.2.3.3.2.3" xref="algorithm1.18.18.m1.2.3.3.2.3.cmml"><mi id="algorithm1.18.18.m1.2.3.3.2.3.2" xref="algorithm1.18.18.m1.2.3.3.2.3.2.cmml">ξ</mi><mrow id="algorithm1.18.18.m1.2.2.2.4" xref="algorithm1.18.18.m1.2.2.2.3.cmml"><mi id="algorithm1.18.18.m1.1.1.1.1" xref="algorithm1.18.18.m1.1.1.1.1.cmml">t</mi><mo id="algorithm1.18.18.m1.2.2.2.4.1" xref="algorithm1.18.18.m1.2.2.2.3.cmml">,</mo><mi id="algorithm1.18.18.m1.2.2.2.2" xref="algorithm1.18.18.m1.2.2.2.2.cmml">K</mi></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.2b"><apply id="algorithm1.18.18.m1.2.3.cmml" xref="algorithm1.18.18.m1.2.3"><eq id="algorithm1.18.18.m1.2.3.1.cmml" xref="algorithm1.18.18.m1.2.3.1"></eq><apply id="algorithm1.18.18.m1.2.3.2.cmml" xref="algorithm1.18.18.m1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.2.3.2.1.cmml" xref="algorithm1.18.18.m1.2.3.2">superscript</csymbol><apply id="algorithm1.18.18.m1.2.3.2.2.cmml" xref="algorithm1.18.18.m1.2.3.2.2"><ci id="algorithm1.18.18.m1.2.3.2.2.1.cmml" xref="algorithm1.18.18.m1.2.3.2.2.1">¯</ci><ci id="algorithm1.18.18.m1.2.3.2.2.2.cmml" xref="algorithm1.18.18.m1.2.3.2.2.2">𝜉</ci></apply><ci id="algorithm1.18.18.m1.2.3.2.3.cmml" xref="algorithm1.18.18.m1.2.3.2.3">𝑡</ci></apply><apply id="algorithm1.18.18.m1.2.3.3.cmml" xref="algorithm1.18.18.m1.2.3.3"><apply id="algorithm1.18.18.m1.2.3.3.1.cmml" xref="algorithm1.18.18.m1.2.3.3.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.2.3.3.1.1.cmml" xref="algorithm1.18.18.m1.2.3.3.1">subscript</csymbol><sum id="algorithm1.18.18.m1.2.3.3.1.2.cmml" xref="algorithm1.18.18.m1.2.3.3.1.2"></sum><apply id="algorithm1.18.18.m1.2.3.3.1.3.cmml" xref="algorithm1.18.18.m1.2.3.3.1.3"><in id="algorithm1.18.18.m1.2.3.3.1.3.1.cmml" xref="algorithm1.18.18.m1.2.3.3.1.3.1"></in><ci id="algorithm1.18.18.m1.2.3.3.1.3.2.cmml" xref="algorithm1.18.18.m1.2.3.3.1.3.2">𝑖</ci><apply id="algorithm1.18.18.m1.2.3.3.1.3.3.cmml" xref="algorithm1.18.18.m1.2.3.3.1.3.3"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.2.3.3.1.3.3.1.cmml" xref="algorithm1.18.18.m1.2.3.3.1.3.3">superscript</csymbol><ci id="algorithm1.18.18.m1.2.3.3.1.3.3.2.cmml" xref="algorithm1.18.18.m1.2.3.3.1.3.3.2">𝐶</ci><ci id="algorithm1.18.18.m1.2.3.3.1.3.3.3.cmml" xref="algorithm1.18.18.m1.2.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="algorithm1.18.18.m1.2.3.3.2.cmml" xref="algorithm1.18.18.m1.2.3.3.2"><times id="algorithm1.18.18.m1.2.3.3.2.1.cmml" xref="algorithm1.18.18.m1.2.3.3.2.1"></times><apply id="algorithm1.18.18.m1.2.3.3.2.2.cmml" xref="algorithm1.18.18.m1.2.3.3.2.2"><divide id="algorithm1.18.18.m1.2.3.3.2.2.1.cmml" xref="algorithm1.18.18.m1.2.3.3.2.2"></divide><apply id="algorithm1.18.18.m1.2.3.3.2.2.2.cmml" xref="algorithm1.18.18.m1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.2.3.3.2.2.2.1.cmml" xref="algorithm1.18.18.m1.2.3.3.2.2.2">subscript</csymbol><ci id="algorithm1.18.18.m1.2.3.3.2.2.2.2.cmml" xref="algorithm1.18.18.m1.2.3.3.2.2.2.2">𝑚</ci><ci id="algorithm1.18.18.m1.2.3.3.2.2.2.3.cmml" xref="algorithm1.18.18.m1.2.3.3.2.2.2.3">𝑖</ci></apply><ci id="algorithm1.18.18.m1.2.3.3.2.2.3.cmml" xref="algorithm1.18.18.m1.2.3.3.2.2.3">𝑀</ci></apply><apply id="algorithm1.18.18.m1.2.3.3.2.3.cmml" xref="algorithm1.18.18.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.2.3.3.2.3.1.cmml" xref="algorithm1.18.18.m1.2.3.3.2.3">superscript</csymbol><ci id="algorithm1.18.18.m1.2.3.3.2.3.2.cmml" xref="algorithm1.18.18.m1.2.3.3.2.3.2">𝜉</ci><list id="algorithm1.18.18.m1.2.2.2.3.cmml" xref="algorithm1.18.18.m1.2.2.2.4"><ci id="algorithm1.18.18.m1.1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1.1.1">𝑡</ci><ci id="algorithm1.18.18.m1.2.2.2.2.cmml" xref="algorithm1.18.18.m1.2.2.2.2">𝐾</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.2c">\bar{\xi}^{t}=\sum_{i\in C^{t}}\frac{m_{i}}{M}\xi^{t,K}</annotation></semantics></math>; 
</div>
<div id="algorithm1.19.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.19.19.m1.1" class="ltx_Math" alttext="\varphi^{t}=\varphi^{t-1}-\beta\sum_{i\in C^{t}}\frac{m_{i}}{M}\nabla_{\varphi}W_{i}^{T}\Delta W_{i}" display="inline"><semantics id="algorithm1.19.19.m1.1a"><mrow id="algorithm1.19.19.m1.1.1" xref="algorithm1.19.19.m1.1.1.cmml"><msup id="algorithm1.19.19.m1.1.1.2" xref="algorithm1.19.19.m1.1.1.2.cmml"><mi id="algorithm1.19.19.m1.1.1.2.2" xref="algorithm1.19.19.m1.1.1.2.2.cmml">φ</mi><mi id="algorithm1.19.19.m1.1.1.2.3" xref="algorithm1.19.19.m1.1.1.2.3.cmml">t</mi></msup><mo id="algorithm1.19.19.m1.1.1.1" xref="algorithm1.19.19.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.19.19.m1.1.1.3" xref="algorithm1.19.19.m1.1.1.3.cmml"><msup id="algorithm1.19.19.m1.1.1.3.2" xref="algorithm1.19.19.m1.1.1.3.2.cmml"><mi id="algorithm1.19.19.m1.1.1.3.2.2" xref="algorithm1.19.19.m1.1.1.3.2.2.cmml">φ</mi><mrow id="algorithm1.19.19.m1.1.1.3.2.3" xref="algorithm1.19.19.m1.1.1.3.2.3.cmml"><mi id="algorithm1.19.19.m1.1.1.3.2.3.2" xref="algorithm1.19.19.m1.1.1.3.2.3.2.cmml">t</mi><mo id="algorithm1.19.19.m1.1.1.3.2.3.1" xref="algorithm1.19.19.m1.1.1.3.2.3.1.cmml">−</mo><mn id="algorithm1.19.19.m1.1.1.3.2.3.3" xref="algorithm1.19.19.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msup><mo id="algorithm1.19.19.m1.1.1.3.1" xref="algorithm1.19.19.m1.1.1.3.1.cmml">−</mo><mrow id="algorithm1.19.19.m1.1.1.3.3" xref="algorithm1.19.19.m1.1.1.3.3.cmml"><mi id="algorithm1.19.19.m1.1.1.3.3.2" xref="algorithm1.19.19.m1.1.1.3.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.3.1" xref="algorithm1.19.19.m1.1.1.3.3.1.cmml">​</mo><mrow id="algorithm1.19.19.m1.1.1.3.3.3" xref="algorithm1.19.19.m1.1.1.3.3.3.cmml"><msub id="algorithm1.19.19.m1.1.1.3.3.3.1" xref="algorithm1.19.19.m1.1.1.3.3.3.1.cmml"><mo id="algorithm1.19.19.m1.1.1.3.3.3.1.2" xref="algorithm1.19.19.m1.1.1.3.3.3.1.2.cmml">∑</mo><mrow id="algorithm1.19.19.m1.1.1.3.3.3.1.3" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.cmml"><mi id="algorithm1.19.19.m1.1.1.3.3.3.1.3.2" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.2.cmml">i</mi><mo id="algorithm1.19.19.m1.1.1.3.3.3.1.3.1" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.1.cmml">∈</mo><msup id="algorithm1.19.19.m1.1.1.3.3.3.1.3.3" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.cmml"><mi id="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.2" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.2.cmml">C</mi><mi id="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.3" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.3.cmml">t</mi></msup></mrow></msub><mrow id="algorithm1.19.19.m1.1.1.3.3.3.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.cmml"><mfrac id="algorithm1.19.19.m1.1.1.3.3.3.2.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.cmml"><msub id="algorithm1.19.19.m1.1.1.3.3.3.2.2.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.cmml"><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.2.cmml">m</mi><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.3" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.3.cmml">i</mi></msub><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.2.3" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.3.cmml">M</mi></mfrac><mo lspace="0.167em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.3.3.2.1" xref="algorithm1.19.19.m1.1.1.3.3.3.2.1.cmml">​</mo><mrow id="algorithm1.19.19.m1.1.1.3.3.3.2.3" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.cmml"><msub id="algorithm1.19.19.m1.1.1.3.3.3.2.3.1" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.cmml"><mo rspace="0.167em" id="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.2.cmml">∇</mo><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.3" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.3.cmml">φ</mi></msub><mrow id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.cmml"><msubsup id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.cmml"><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.2.cmml">W</mi><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.3" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.3.cmml">i</mi><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.3" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.1" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.3" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.1a" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.1.cmml">​</mo><msub id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.cmml"><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.2" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.2.cmml">W</mi><mi id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.3" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m1.1b"><apply id="algorithm1.19.19.m1.1.1.cmml" xref="algorithm1.19.19.m1.1.1"><eq id="algorithm1.19.19.m1.1.1.1.cmml" xref="algorithm1.19.19.m1.1.1.1"></eq><apply id="algorithm1.19.19.m1.1.1.2.cmml" xref="algorithm1.19.19.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.2.1.cmml" xref="algorithm1.19.19.m1.1.1.2">superscript</csymbol><ci id="algorithm1.19.19.m1.1.1.2.2.cmml" xref="algorithm1.19.19.m1.1.1.2.2">𝜑</ci><ci id="algorithm1.19.19.m1.1.1.2.3.cmml" xref="algorithm1.19.19.m1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.19.19.m1.1.1.3.cmml" xref="algorithm1.19.19.m1.1.1.3"><minus id="algorithm1.19.19.m1.1.1.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.1"></minus><apply id="algorithm1.19.19.m1.1.1.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.3.2.1.cmml" xref="algorithm1.19.19.m1.1.1.3.2">superscript</csymbol><ci id="algorithm1.19.19.m1.1.1.3.2.2.cmml" xref="algorithm1.19.19.m1.1.1.3.2.2">𝜑</ci><apply id="algorithm1.19.19.m1.1.1.3.2.3.cmml" xref="algorithm1.19.19.m1.1.1.3.2.3"><minus id="algorithm1.19.19.m1.1.1.3.2.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.2.3.1"></minus><ci id="algorithm1.19.19.m1.1.1.3.2.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.19.19.m1.1.1.3.2.3.3.cmml" xref="algorithm1.19.19.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="algorithm1.19.19.m1.1.1.3.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3"><times id="algorithm1.19.19.m1.1.1.3.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.1"></times><ci id="algorithm1.19.19.m1.1.1.3.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.2">𝛽</ci><apply id="algorithm1.19.19.m1.1.1.3.3.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3"><apply id="algorithm1.19.19.m1.1.1.3.3.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.3.3.3.1.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1">subscript</csymbol><sum id="algorithm1.19.19.m1.1.1.3.3.3.1.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1.2"></sum><apply id="algorithm1.19.19.m1.1.1.3.3.3.1.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3"><in id="algorithm1.19.19.m1.1.1.3.3.3.1.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.1"></in><ci id="algorithm1.19.19.m1.1.1.3.3.3.1.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.2">𝑖</ci><apply id="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.3"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.3">superscript</csymbol><ci id="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.2">𝐶</ci><ci id="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2"><times id="algorithm1.19.19.m1.1.1.3.3.3.2.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.1"></times><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2"><divide id="algorithm1.19.19.m1.1.1.3.3.3.2.2.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2"></divide><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.2">subscript</csymbol><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.2">𝑚</ci><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.2.3">𝑖</ci></apply><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.2.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.2.3">𝑀</ci></apply><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3"><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.1">subscript</csymbol><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.2">∇</ci><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.1.3">𝜑</ci></apply><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2"><times id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.1"></times><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2">superscript</csymbol><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2">subscript</csymbol><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.2">𝑊</ci><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.2.3">𝑖</ci></apply><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.2.3">𝑇</ci></apply><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.3">Δ</ci><apply id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.1.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4">subscript</csymbol><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.2.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.2">𝑊</ci><ci id="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3.3.2.3.2.4.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m1.1c">\varphi^{t}=\varphi^{t-1}-\beta\sum_{i\in C^{t}}\frac{m_{i}}{M}\nabla_{\varphi}W_{i}^{T}\Delta W_{i}</annotation></semantics></math>; 
</div>
<div id="algorithm1.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.20.20.m1.1" class="ltx_Math" alttext="z_{i}^{t}=z_{i}^{t-1}-\beta\sum_{i\in C^{t}}\frac{m_{i}}{M}\nabla_{z_{i}}W_{i}^{T}\Delta W_{i}" display="inline"><semantics id="algorithm1.20.20.m1.1a"><mrow id="algorithm1.20.20.m1.1.1" xref="algorithm1.20.20.m1.1.1.cmml"><msubsup id="algorithm1.20.20.m1.1.1.2" xref="algorithm1.20.20.m1.1.1.2.cmml"><mi id="algorithm1.20.20.m1.1.1.2.2.2" xref="algorithm1.20.20.m1.1.1.2.2.2.cmml">z</mi><mi id="algorithm1.20.20.m1.1.1.2.2.3" xref="algorithm1.20.20.m1.1.1.2.2.3.cmml">i</mi><mi id="algorithm1.20.20.m1.1.1.2.3" xref="algorithm1.20.20.m1.1.1.2.3.cmml">t</mi></msubsup><mo id="algorithm1.20.20.m1.1.1.1" xref="algorithm1.20.20.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.20.20.m1.1.1.3" xref="algorithm1.20.20.m1.1.1.3.cmml"><msubsup id="algorithm1.20.20.m1.1.1.3.2" xref="algorithm1.20.20.m1.1.1.3.2.cmml"><mi id="algorithm1.20.20.m1.1.1.3.2.2.2" xref="algorithm1.20.20.m1.1.1.3.2.2.2.cmml">z</mi><mi id="algorithm1.20.20.m1.1.1.3.2.2.3" xref="algorithm1.20.20.m1.1.1.3.2.2.3.cmml">i</mi><mrow id="algorithm1.20.20.m1.1.1.3.2.3" xref="algorithm1.20.20.m1.1.1.3.2.3.cmml"><mi id="algorithm1.20.20.m1.1.1.3.2.3.2" xref="algorithm1.20.20.m1.1.1.3.2.3.2.cmml">t</mi><mo id="algorithm1.20.20.m1.1.1.3.2.3.1" xref="algorithm1.20.20.m1.1.1.3.2.3.1.cmml">−</mo><mn id="algorithm1.20.20.m1.1.1.3.2.3.3" xref="algorithm1.20.20.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="algorithm1.20.20.m1.1.1.3.1" xref="algorithm1.20.20.m1.1.1.3.1.cmml">−</mo><mrow id="algorithm1.20.20.m1.1.1.3.3" xref="algorithm1.20.20.m1.1.1.3.3.cmml"><mi id="algorithm1.20.20.m1.1.1.3.3.2" xref="algorithm1.20.20.m1.1.1.3.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="algorithm1.20.20.m1.1.1.3.3.1" xref="algorithm1.20.20.m1.1.1.3.3.1.cmml">​</mo><mrow id="algorithm1.20.20.m1.1.1.3.3.3" xref="algorithm1.20.20.m1.1.1.3.3.3.cmml"><msub id="algorithm1.20.20.m1.1.1.3.3.3.1" xref="algorithm1.20.20.m1.1.1.3.3.3.1.cmml"><mo id="algorithm1.20.20.m1.1.1.3.3.3.1.2" xref="algorithm1.20.20.m1.1.1.3.3.3.1.2.cmml">∑</mo><mrow id="algorithm1.20.20.m1.1.1.3.3.3.1.3" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.cmml"><mi id="algorithm1.20.20.m1.1.1.3.3.3.1.3.2" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.2.cmml">i</mi><mo id="algorithm1.20.20.m1.1.1.3.3.3.1.3.1" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.1.cmml">∈</mo><msup id="algorithm1.20.20.m1.1.1.3.3.3.1.3.3" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.cmml"><mi id="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.2" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.2.cmml">C</mi><mi id="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.3" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.3.cmml">t</mi></msup></mrow></msub><mrow id="algorithm1.20.20.m1.1.1.3.3.3.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.cmml"><mfrac id="algorithm1.20.20.m1.1.1.3.3.3.2.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.cmml"><msub id="algorithm1.20.20.m1.1.1.3.3.3.2.2.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.cmml"><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.2.cmml">m</mi><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.3.cmml">i</mi></msub><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.2.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.3.cmml">M</mi></mfrac><mo lspace="0.167em" rspace="0em" id="algorithm1.20.20.m1.1.1.3.3.3.2.1" xref="algorithm1.20.20.m1.1.1.3.3.3.2.1.cmml">​</mo><mrow id="algorithm1.20.20.m1.1.1.3.3.3.2.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.cmml"><msub id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.cmml"><mo rspace="0.167em" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.2.cmml">∇</mo><msub id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.cmml"><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.2.cmml">z</mi><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.3.cmml">i</mi></msub></msub><mrow id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.cmml"><msubsup id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.cmml"><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.2.cmml">W</mi><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.3.cmml">i</mi><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.1" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.1a" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.1.cmml">​</mo><msub id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.cmml"><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.2" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.2.cmml">W</mi><mi id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.3" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m1.1b"><apply id="algorithm1.20.20.m1.1.1.cmml" xref="algorithm1.20.20.m1.1.1"><eq id="algorithm1.20.20.m1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1"></eq><apply id="algorithm1.20.20.m1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.2.1.cmml" xref="algorithm1.20.20.m1.1.1.2">superscript</csymbol><apply id="algorithm1.20.20.m1.1.1.2.2.cmml" xref="algorithm1.20.20.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.2.2.1.cmml" xref="algorithm1.20.20.m1.1.1.2">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.2.2.2.cmml" xref="algorithm1.20.20.m1.1.1.2.2.2">𝑧</ci><ci id="algorithm1.20.20.m1.1.1.2.2.3.cmml" xref="algorithm1.20.20.m1.1.1.2.2.3">𝑖</ci></apply><ci id="algorithm1.20.20.m1.1.1.2.3.cmml" xref="algorithm1.20.20.m1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.20.20.m1.1.1.3.cmml" xref="algorithm1.20.20.m1.1.1.3"><minus id="algorithm1.20.20.m1.1.1.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3.1"></minus><apply id="algorithm1.20.20.m1.1.1.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.2.1.cmml" xref="algorithm1.20.20.m1.1.1.3.2">superscript</csymbol><apply id="algorithm1.20.20.m1.1.1.3.2.2.cmml" xref="algorithm1.20.20.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.2.2.1.cmml" xref="algorithm1.20.20.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.3.2.2.2.cmml" xref="algorithm1.20.20.m1.1.1.3.2.2.2">𝑧</ci><ci id="algorithm1.20.20.m1.1.1.3.2.2.3.cmml" xref="algorithm1.20.20.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="algorithm1.20.20.m1.1.1.3.2.3.cmml" xref="algorithm1.20.20.m1.1.1.3.2.3"><minus id="algorithm1.20.20.m1.1.1.3.2.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3.2.3.1"></minus><ci id="algorithm1.20.20.m1.1.1.3.2.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.20.20.m1.1.1.3.2.3.3.cmml" xref="algorithm1.20.20.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="algorithm1.20.20.m1.1.1.3.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3"><times id="algorithm1.20.20.m1.1.1.3.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.1"></times><ci id="algorithm1.20.20.m1.1.1.3.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.2">𝛽</ci><apply id="algorithm1.20.20.m1.1.1.3.3.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3"><apply id="algorithm1.20.20.m1.1.1.3.3.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.3.3.1.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1">subscript</csymbol><sum id="algorithm1.20.20.m1.1.1.3.3.3.1.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1.2"></sum><apply id="algorithm1.20.20.m1.1.1.3.3.3.1.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3"><in id="algorithm1.20.20.m1.1.1.3.3.3.1.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.1"></in><ci id="algorithm1.20.20.m1.1.1.3.3.3.1.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.2">𝑖</ci><apply id="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.3"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.3">superscript</csymbol><ci id="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.2">𝐶</ci><ci id="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2"><times id="algorithm1.20.20.m1.1.1.3.3.3.2.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.1"></times><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2"><divide id="algorithm1.20.20.m1.1.1.3.3.3.2.2.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2"></divide><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.2">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.2">𝑚</ci><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.2.3">𝑖</ci></apply><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.2.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.2.3">𝑀</ci></apply><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3"><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.2">∇</ci><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.2">𝑧</ci><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.1.3.3">𝑖</ci></apply></apply><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2"><times id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.1"></times><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2">superscript</csymbol><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.2">𝑊</ci><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.2.3">𝑖</ci></apply><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.2.3">𝑇</ci></apply><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.3">Δ</ci><apply id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.1.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.2.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.2">𝑊</ci><ci id="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3.3.2.3.2.4.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m1.1c">z_{i}^{t}=z_{i}^{t-1}-\beta\sum_{i\in C^{t}}\frac{m_{i}}{M}\nabla_{z_{i}}W_{i}^{T}\Delta W_{i}</annotation></semantics></math>;

</div>
<div id="algorithm1.23.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span> end for
</div>
<div id="algorithm1.23.23" class="ltx_listingline">
<span id="algorithm1.23.23.1" class="ltx_text ltx_font_bold">return</span> <math id="algorithm1.21.21.m1.1" class="ltx_Math" alttext="\bar{\xi}^{t}" display="inline"><semantics id="algorithm1.21.21.m1.1a"><msup id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml"><mover accent="true" id="algorithm1.21.21.m1.1.1.2" xref="algorithm1.21.21.m1.1.1.2.cmml"><mi id="algorithm1.21.21.m1.1.1.2.2" xref="algorithm1.21.21.m1.1.1.2.2.cmml">ξ</mi><mo id="algorithm1.21.21.m1.1.1.2.1" xref="algorithm1.21.21.m1.1.1.2.1.cmml">¯</mo></mover><mi id="algorithm1.21.21.m1.1.1.3" xref="algorithm1.21.21.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.1b"><apply id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1">superscript</csymbol><apply id="algorithm1.21.21.m1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.2"><ci id="algorithm1.21.21.m1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.1.2.1">¯</ci><ci id="algorithm1.21.21.m1.1.1.2.2.cmml" xref="algorithm1.21.21.m1.1.1.2.2">𝜉</ci></apply><ci id="algorithm1.21.21.m1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.1c">\bar{\xi}^{t}</annotation></semantics></math>, <math id="algorithm1.22.22.m2.1" class="ltx_Math" alttext="\varphi^{t}" display="inline"><semantics id="algorithm1.22.22.m2.1a"><msup id="algorithm1.22.22.m2.1.1" xref="algorithm1.22.22.m2.1.1.cmml"><mi id="algorithm1.22.22.m2.1.1.2" xref="algorithm1.22.22.m2.1.1.2.cmml">φ</mi><mi id="algorithm1.22.22.m2.1.1.3" xref="algorithm1.22.22.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m2.1b"><apply id="algorithm1.22.22.m2.1.1.cmml" xref="algorithm1.22.22.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m2.1.1.1.cmml" xref="algorithm1.22.22.m2.1.1">superscript</csymbol><ci id="algorithm1.22.22.m2.1.1.2.cmml" xref="algorithm1.22.22.m2.1.1.2">𝜑</ci><ci id="algorithm1.22.22.m2.1.1.3.cmml" xref="algorithm1.22.22.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m2.1c">\varphi^{t}</annotation></semantics></math> and <math id="algorithm1.23.23.m3.1" class="ltx_Math" alttext="z_{i}^{t}" display="inline"><semantics id="algorithm1.23.23.m3.1a"><msubsup id="algorithm1.23.23.m3.1.1" xref="algorithm1.23.23.m3.1.1.cmml"><mi id="algorithm1.23.23.m3.1.1.2.2" xref="algorithm1.23.23.m3.1.1.2.2.cmml">z</mi><mi id="algorithm1.23.23.m3.1.1.2.3" xref="algorithm1.23.23.m3.1.1.2.3.cmml">i</mi><mi id="algorithm1.23.23.m3.1.1.3" xref="algorithm1.23.23.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m3.1b"><apply id="algorithm1.23.23.m3.1.1.cmml" xref="algorithm1.23.23.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m3.1.1.1.cmml" xref="algorithm1.23.23.m3.1.1">superscript</csymbol><apply id="algorithm1.23.23.m3.1.1.2.cmml" xref="algorithm1.23.23.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m3.1.1.2.1.cmml" xref="algorithm1.23.23.m3.1.1">subscript</csymbol><ci id="algorithm1.23.23.m3.1.1.2.2.cmml" xref="algorithm1.23.23.m3.1.1.2.2">𝑧</ci><ci id="algorithm1.23.23.m3.1.1.2.3.cmml" xref="algorithm1.23.23.m3.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.23.23.m3.1.1.3.cmml" xref="algorithm1.23.23.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m3.1c">z_{i}^{t}</annotation></semantics></math>

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.25.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Federated Transformer Personalization</figcaption>
</figure>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.2" class="ltx_p">Algorithm <a href="#algorithm1" title="In III-C Learn-to-personalize for self-attention ‣ III Federated learning by Transformer Personalization ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> demonstrates the procedures of FedTP algorithm. We next introduce the update rules for model parameters in FedTP. First, in each local epoch <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">k</annotation></semantics></math> we update local model parameter <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">θ</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝜃</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\theta_{i}</annotation></semantics></math> using stochastic gradient descent (SGD) by</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\theta_{i}^{k}\leftarrow\theta_{i}^{k-1}-\alpha\nabla_{\theta_{i}}\mathcal{L}_{i}(\theta_{i}^{k-1};B_{i})," display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.4.2.2" xref="S3.E6.m1.1.1.1.1.4.2.2.cmml">θ</mi><mi id="S3.E6.m1.1.1.1.1.4.2.3" xref="S3.E6.m1.1.1.1.1.4.2.3.cmml">i</mi><mi id="S3.E6.m1.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.4.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml">←</mo><mrow id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><msubsup id="S3.E6.m1.1.1.1.1.2.4" xref="S3.E6.m1.1.1.1.1.2.4.cmml"><mi id="S3.E6.m1.1.1.1.1.2.4.2.2" xref="S3.E6.m1.1.1.1.1.2.4.2.2.cmml">θ</mi><mi id="S3.E6.m1.1.1.1.1.2.4.2.3" xref="S3.E6.m1.1.1.1.1.2.4.2.3.cmml">i</mi><mrow id="S3.E6.m1.1.1.1.1.2.4.3" xref="S3.E6.m1.1.1.1.1.2.4.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.4.3.2" xref="S3.E6.m1.1.1.1.1.2.4.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.2.4.3.1" xref="S3.E6.m1.1.1.1.1.2.4.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.2.4.3.3" xref="S3.E6.m1.1.1.1.1.2.4.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3.cmml">−</mo><mrow id="S3.E6.m1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.4" xref="S3.E6.m1.1.1.1.1.2.2.4.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.2.2.5" xref="S3.E6.m1.1.1.1.1.2.2.5.cmml"><msub id="S3.E6.m1.1.1.1.1.2.2.5.1" xref="S3.E6.m1.1.1.1.1.2.2.5.1.cmml"><mo rspace="0.167em" id="S3.E6.m1.1.1.1.1.2.2.5.1.2" xref="S3.E6.m1.1.1.1.1.2.2.5.1.2.cmml">∇</mo><msub id="S3.E6.m1.1.1.1.1.2.2.5.1.3" xref="S3.E6.m1.1.1.1.1.2.2.5.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.5.1.3.2" xref="S3.E6.m1.1.1.1.1.2.2.5.1.3.2.cmml">θ</mi><mi id="S3.E6.m1.1.1.1.1.2.2.5.1.3.3" xref="S3.E6.m1.1.1.1.1.2.2.5.1.3.3.cmml">i</mi></msub></msub><msub id="S3.E6.m1.1.1.1.1.2.2.5.2" xref="S3.E6.m1.1.1.1.1.2.2.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.2.2.5.2.2" xref="S3.E6.m1.1.1.1.1.2.2.5.2.2.cmml">ℒ</mi><mi id="S3.E6.m1.1.1.1.1.2.2.5.2.3" xref="S3.E6.m1.1.1.1.1.2.2.5.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.2.2.3a" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.2.2.2.2.4" xref="S3.E6.m1.1.1.1.1.2.2.2.3.cmml">;</mo><msub id="S3.E6.m1.1.1.1.1.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.2.cmml">B</mi><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2.2.2.2.5" xref="S3.E6.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><ci id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3">←</ci><apply id="S3.E6.m1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.1.4">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.2.1.cmml" xref="S3.E6.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2">𝜃</ci><ci id="S3.E6.m1.1.1.1.1.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S3.E6.m1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.4.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><minus id="S3.E6.m1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3"></minus><apply id="S3.E6.m1.1.1.1.1.2.4.cmml" xref="S3.E6.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.4.1.cmml" xref="S3.E6.m1.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.2.4.2.cmml" xref="S3.E6.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.4.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.4.2.2">𝜃</ci><ci id="S3.E6.m1.1.1.1.1.2.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.4.2.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.2.4.3.cmml" xref="S3.E6.m1.1.1.1.1.2.4.3"><minus id="S3.E6.m1.1.1.1.1.2.4.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.4.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.2.4.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.4.3.2">𝑘</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.2.4.3.3.cmml" xref="S3.E6.m1.1.1.1.1.2.4.3.3">1</cn></apply></apply><apply id="S3.E6.m1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2"><times id="S3.E6.m1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.3"></times><ci id="S3.E6.m1.1.1.1.1.2.2.4.cmml" xref="S3.E6.m1.1.1.1.1.2.2.4">𝛼</ci><apply id="S3.E6.m1.1.1.1.1.2.2.5.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5"><apply id="S3.E6.m1.1.1.1.1.2.2.5.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.5.1.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.5.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.1.2">∇</ci><apply id="S3.E6.m1.1.1.1.1.2.2.5.1.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.5.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.5.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.1.3.2">𝜃</ci><ci id="S3.E6.m1.1.1.1.1.2.2.5.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.1.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.2.2.5.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.5.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.5.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.2.2">ℒ</ci><ci id="S3.E6.m1.1.1.1.1.2.2.5.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.5.2.3">𝑖</ci></apply></apply><list id="S3.E6.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.2">𝐵</ci><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\theta_{i}^{k}\leftarrow\theta_{i}^{k-1}-\alpha\nabla_{\theta_{i}}\mathcal{L}_{i}(\theta_{i}^{k-1};B_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.8" class="ltx_p">where <math id="S3.SS3.p3.3.m1.1" class="ltx_Math" alttext="B_{i}" display="inline"><semantics id="S3.SS3.p3.3.m1.1a"><msub id="S3.SS3.p3.3.m1.1.1" xref="S3.SS3.p3.3.m1.1.1.cmml"><mi id="S3.SS3.p3.3.m1.1.1.2" xref="S3.SS3.p3.3.m1.1.1.2.cmml">B</mi><mi id="S3.SS3.p3.3.m1.1.1.3" xref="S3.SS3.p3.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m1.1b"><apply id="S3.SS3.p3.3.m1.1.1.cmml" xref="S3.SS3.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m1.1.1.1.cmml" xref="S3.SS3.p3.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m1.1.1.2.cmml" xref="S3.SS3.p3.3.m1.1.1.2">𝐵</ci><ci id="S3.SS3.p3.3.m1.1.1.3.cmml" xref="S3.SS3.p3.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m1.1c">B_{i}</annotation></semantics></math> is a mini-batch sampled from <math id="S3.SS3.p3.4.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.SS3.p3.4.m2.1a"><msub id="S3.SS3.p3.4.m2.1.1" xref="S3.SS3.p3.4.m2.1.1.cmml"><mi id="S3.SS3.p3.4.m2.1.1.2" xref="S3.SS3.p3.4.m2.1.1.2.cmml">D</mi><mi id="S3.SS3.p3.4.m2.1.1.3" xref="S3.SS3.p3.4.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m2.1b"><apply id="S3.SS3.p3.4.m2.1.1.cmml" xref="S3.SS3.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m2.1.1.1.cmml" xref="S3.SS3.p3.4.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m2.1.1.2.cmml" xref="S3.SS3.p3.4.m2.1.1.2">𝐷</ci><ci id="S3.SS3.p3.4.m2.1.1.3.cmml" xref="S3.SS3.p3.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m2.1c">D_{i}</annotation></semantics></math>. Let <math id="S3.SS3.p3.5.m3.1" class="ltx_Math" alttext="C^{t}" display="inline"><semantics id="S3.SS3.p3.5.m3.1a"><msup id="S3.SS3.p3.5.m3.1.1" xref="S3.SS3.p3.5.m3.1.1.cmml"><mi id="S3.SS3.p3.5.m3.1.1.2" xref="S3.SS3.p3.5.m3.1.1.2.cmml">C</mi><mi id="S3.SS3.p3.5.m3.1.1.3" xref="S3.SS3.p3.5.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m3.1b"><apply id="S3.SS3.p3.5.m3.1.1.cmml" xref="S3.SS3.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m3.1.1.1.cmml" xref="S3.SS3.p3.5.m3.1.1">superscript</csymbol><ci id="S3.SS3.p3.5.m3.1.1.2.cmml" xref="S3.SS3.p3.5.m3.1.1.2">𝐶</ci><ci id="S3.SS3.p3.5.m3.1.1.3.cmml" xref="S3.SS3.p3.5.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m3.1c">C^{t}</annotation></semantics></math> represent the set of sampled clients at each round <math id="S3.SS3.p3.6.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p3.6.m4.1a"><mi id="S3.SS3.p3.6.m4.1.1" xref="S3.SS3.p3.6.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m4.1b"><ci id="S3.SS3.p3.6.m4.1.1.cmml" xref="S3.SS3.p3.6.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m4.1c">t</annotation></semantics></math>. According to the chain rule, we can obtain the gradients of <math id="S3.SS3.p3.7.m5.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS3.p3.7.m5.1a"><mi id="S3.SS3.p3.7.m5.1.1" xref="S3.SS3.p3.7.m5.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m5.1b"><ci id="S3.SS3.p3.7.m5.1.1.cmml" xref="S3.SS3.p3.7.m5.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m5.1c">\varphi</annotation></semantics></math> and <math id="S3.SS3.p3.8.m6.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS3.p3.8.m6.1a"><msub id="S3.SS3.p3.8.m6.1.1" xref="S3.SS3.p3.8.m6.1.1.cmml"><mi id="S3.SS3.p3.8.m6.1.1.2" xref="S3.SS3.p3.8.m6.1.1.2.cmml">z</mi><mi id="S3.SS3.p3.8.m6.1.1.3" xref="S3.SS3.p3.8.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m6.1b"><apply id="S3.SS3.p3.8.m6.1.1.cmml" xref="S3.SS3.p3.8.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m6.1.1.1.cmml" xref="S3.SS3.p3.8.m6.1.1">subscript</csymbol><ci id="S3.SS3.p3.8.m6.1.1.2.cmml" xref="S3.SS3.p3.8.m6.1.1.2">𝑧</ci><ci id="S3.SS3.p3.8.m6.1.1.3.cmml" xref="S3.SS3.p3.8.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m6.1c">z_{i}</annotation></semantics></math> from Eq. (<a href="#S3.E6" title="In III-C Learn-to-personalize for self-attention ‣ III Federated learning by Transformer Personalization ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>):</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\nabla_{\varphi}\mathcal{L}_{i}=\sum_{i\in C^{t}}\frac{m_{i}}{M}\nabla_{\varphi}W_{i}^{T}\Delta W_{i}," display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.1.1.1.1.2.1" xref="S3.E7.m1.1.1.1.1.2.1.cmml"><mo id="S3.E7.m1.1.1.1.1.2.1.2" xref="S3.E7.m1.1.1.1.1.2.1.2.cmml">∇</mo><mi id="S3.E7.m1.1.1.1.1.2.1.3" xref="S3.E7.m1.1.1.1.1.2.1.3.cmml">φ</mi></msub><msub id="S3.E7.m1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.E7.m1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.2.2.3.cmml">i</mi></msub></mrow><mo rspace="0.111em" id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><munder id="S3.E7.m1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E7.m1.1.1.1.1.3.1.2" xref="S3.E7.m1.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E7.m1.1.1.1.1.3.1.3" xref="S3.E7.m1.1.1.1.1.3.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.1.3.2" xref="S3.E7.m1.1.1.1.1.3.1.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.3.1.3.1" xref="S3.E7.m1.1.1.1.1.3.1.3.1.cmml">∈</mo><msup id="S3.E7.m1.1.1.1.1.3.1.3.3" xref="S3.E7.m1.1.1.1.1.3.1.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.1.3.3.2" xref="S3.E7.m1.1.1.1.1.3.1.3.3.2.cmml">C</mi><mi id="S3.E7.m1.1.1.1.1.3.1.3.3.3" xref="S3.E7.m1.1.1.1.1.3.1.3.3.3.cmml">t</mi></msup></mrow></munder><mrow id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mfrac id="S3.E7.m1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.cmml"><msub id="S3.E7.m1.1.1.1.1.3.2.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.2.2.cmml">m</mi><mi id="S3.E7.m1.1.1.1.1.3.2.2.2.3" xref="S3.E7.m1.1.1.1.1.3.2.2.2.3.cmml">i</mi></msub><mi id="S3.E7.m1.1.1.1.1.3.2.2.3" xref="S3.E7.m1.1.1.1.1.3.2.2.3.cmml">M</mi></mfrac><mo lspace="0.167em" rspace="0em" id="S3.E7.m1.1.1.1.1.3.2.1" xref="S3.E7.m1.1.1.1.1.3.2.1.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml"><msub id="S3.E7.m1.1.1.1.1.3.2.3.1" xref="S3.E7.m1.1.1.1.1.3.2.3.1.cmml"><mo rspace="0.167em" id="S3.E7.m1.1.1.1.1.3.2.3.1.2" xref="S3.E7.m1.1.1.1.1.3.2.3.1.2.cmml">∇</mo><mi id="S3.E7.m1.1.1.1.1.3.2.3.1.3" xref="S3.E7.m1.1.1.1.1.3.2.3.1.3.cmml">φ</mi></msub><mrow id="S3.E7.m1.1.1.1.1.3.2.3.2" xref="S3.E7.m1.1.1.1.1.3.2.3.2.cmml"><msubsup id="S3.E7.m1.1.1.1.1.3.2.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.2" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.2.cmml">W</mi><mi id="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.3.cmml">i</mi><mi id="S3.E7.m1.1.1.1.1.3.2.3.2.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.3.2.3.2.1" xref="S3.E7.m1.1.1.1.1.3.2.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E7.m1.1.1.1.1.3.2.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.2.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.3.2.3.2.1a" xref="S3.E7.m1.1.1.1.1.3.2.3.2.1.cmml">​</mo><msub id="S3.E7.m1.1.1.1.1.3.2.3.2.4" xref="S3.E7.m1.1.1.1.1.3.2.3.2.4.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.3.2.4.2" xref="S3.E7.m1.1.1.1.1.3.2.3.2.4.2.cmml">W</mi><mi id="S3.E7.m1.1.1.1.1.3.2.3.2.4.3" xref="S3.E7.m1.1.1.1.1.3.2.3.2.4.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"></eq><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><apply id="S3.E7.m1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.1.1.cmml" xref="S3.E7.m1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2.1.2">∇</ci><ci id="S3.E7.m1.1.1.1.1.2.1.3.cmml" xref="S3.E7.m1.1.1.1.1.2.1.3">𝜑</ci></apply><apply id="S3.E7.m1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2">ℒ</ci><ci id="S3.E7.m1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><apply id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E7.m1.1.1.1.1.3.1.2.cmml" xref="S3.E7.m1.1.1.1.1.3.1.2"></sum><apply id="S3.E7.m1.1.1.1.1.3.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3.1.3"><in id="S3.E7.m1.1.1.1.1.3.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1.3.1"></in><ci id="S3.E7.m1.1.1.1.1.3.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.1.3.2">𝑖</ci><apply id="S3.E7.m1.1.1.1.1.3.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1.3.3">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.1.3.3.2">𝐶</ci><ci id="S3.E7.m1.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><times id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.1"></times><apply id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2"><divide id="S3.E7.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2"></divide><apply id="S3.E7.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.2.2">𝑚</ci><ci id="S3.E7.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E7.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.3">𝑀</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3"><apply id="S3.E7.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.3.1.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.3.1.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.1.2">∇</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.1.3">𝜑</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2"><times id="S3.E7.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.1"></times><apply id="S3.E7.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.3.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.2">𝑊</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E7.m1.1.1.1.1.3.2.3.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.2.3">𝑇</ci></apply><ci id="S3.E7.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.3">Δ</ci><apply id="S3.E7.m1.1.1.1.1.3.2.3.2.4.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.3.2.4.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.4">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.3.2.4.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.4.2">𝑊</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.2.4.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2.4.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\nabla_{\varphi}\mathcal{L}_{i}=\sum_{i\in C^{t}}\frac{m_{i}}{M}\nabla_{\varphi}W_{i}^{T}\Delta W_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\nabla_{z_{i}}\mathcal{L}_{i}=\sum_{i\in C^{t}}\frac{m_{i}}{M}\nabla_{z_{i}}W_{i}^{T}\Delta W_{i}," display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><msub id="S3.E8.m1.1.1.1.1.2.1" xref="S3.E8.m1.1.1.1.1.2.1.cmml"><mo id="S3.E8.m1.1.1.1.1.2.1.2" xref="S3.E8.m1.1.1.1.1.2.1.2.cmml">∇</mo><msub id="S3.E8.m1.1.1.1.1.2.1.3" xref="S3.E8.m1.1.1.1.1.2.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.1.3.2" xref="S3.E8.m1.1.1.1.1.2.1.3.2.cmml">z</mi><mi id="S3.E8.m1.1.1.1.1.2.1.3.3" xref="S3.E8.m1.1.1.1.1.2.1.3.3.cmml">i</mi></msub></msub><msub id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.E8.m1.1.1.1.1.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.3.cmml">i</mi></msub></mrow><mo rspace="0.111em" id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><munder id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E8.m1.1.1.1.1.3.1.2" xref="S3.E8.m1.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E8.m1.1.1.1.1.3.1.3" xref="S3.E8.m1.1.1.1.1.3.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.1.3.2" xref="S3.E8.m1.1.1.1.1.3.1.3.2.cmml">i</mi><mo id="S3.E8.m1.1.1.1.1.3.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.3.1.cmml">∈</mo><msup id="S3.E8.m1.1.1.1.1.3.1.3.3" xref="S3.E8.m1.1.1.1.1.3.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.1.3.3.2" xref="S3.E8.m1.1.1.1.1.3.1.3.3.2.cmml">C</mi><mi id="S3.E8.m1.1.1.1.1.3.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.1.3.3.3.cmml">t</mi></msup></mrow></munder><mrow id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mfrac id="S3.E8.m1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.cmml"><msub id="S3.E8.m1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.2.2.cmml">m</mi><mi id="S3.E8.m1.1.1.1.1.3.2.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.2.3.cmml">i</mi></msub><mi id="S3.E8.m1.1.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3.cmml">M</mi></mfrac><mo lspace="0.167em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.2.1" xref="S3.E8.m1.1.1.1.1.3.2.1.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.cmml"><msub id="S3.E8.m1.1.1.1.1.3.2.3.1" xref="S3.E8.m1.1.1.1.1.3.2.3.1.cmml"><mo rspace="0.167em" id="S3.E8.m1.1.1.1.1.3.2.3.1.2" xref="S3.E8.m1.1.1.1.1.3.2.3.1.2.cmml">∇</mo><msub id="S3.E8.m1.1.1.1.1.3.2.3.1.3" xref="S3.E8.m1.1.1.1.1.3.2.3.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.3.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.3.1.3.2.cmml">z</mi><mi id="S3.E8.m1.1.1.1.1.3.2.3.1.3.3" xref="S3.E8.m1.1.1.1.1.3.2.3.1.3.3.cmml">i</mi></msub></msub><mrow id="S3.E8.m1.1.1.1.1.3.2.3.2" xref="S3.E8.m1.1.1.1.1.3.2.3.2.cmml"><msubsup id="S3.E8.m1.1.1.1.1.3.2.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.3.cmml">i</mi><mi id="S3.E8.m1.1.1.1.1.3.2.3.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.2.3.2.1" xref="S3.E8.m1.1.1.1.1.3.2.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E8.m1.1.1.1.1.3.2.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.2.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.2.3.2.1a" xref="S3.E8.m1.1.1.1.1.3.2.3.2.1.cmml">​</mo><msub id="S3.E8.m1.1.1.1.1.3.2.3.2.4" xref="S3.E8.m1.1.1.1.1.3.2.3.2.4.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.3.2.4.2" xref="S3.E8.m1.1.1.1.1.3.2.3.2.4.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.3.2.3.2.4.3" xref="S3.E8.m1.1.1.1.1.3.2.3.2.4.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><apply id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.1.cmml" xref="S3.E8.m1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2.1.2">∇</ci><apply id="S3.E8.m1.1.1.1.1.2.1.3.cmml" xref="S3.E8.m1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.1.3.2">𝑧</ci><ci id="S3.E8.m1.1.1.1.1.2.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.1.3.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2">ℒ</ci><ci id="S3.E8.m1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><apply id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.1.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E8.m1.1.1.1.1.3.1.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.2"></sum><apply id="S3.E8.m1.1.1.1.1.3.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3.1.3"><in id="S3.E8.m1.1.1.1.1.3.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.3.1"></in><ci id="S3.E8.m1.1.1.1.1.3.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.3.2">𝑖</ci><apply id="S3.E8.m1.1.1.1.1.3.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1.3.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.1.3.3.2">𝐶</ci><ci id="S3.E8.m1.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><times id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1"></times><apply id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2"><divide id="S3.E8.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2"></divide><apply id="S3.E8.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2.2">𝑚</ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3">𝑀</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3"><apply id="S3.E8.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.3.1.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.3.1.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1.2">∇</ci><apply id="S3.E8.m1.1.1.1.1.3.2.3.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.3.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.3.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1.3.2">𝑧</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2"><times id="S3.E8.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.1"></times><apply id="S3.E8.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.2.3">𝑇</ci></apply><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.3">Δ</ci><apply id="S3.E8.m1.1.1.1.1.3.2.3.2.4.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.3.2.4.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.4">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.4.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.4.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.4.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2.4.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\nabla_{z_{i}}\mathcal{L}_{i}=\sum_{i\in C^{t}}\frac{m_{i}}{M}\nabla_{z_{i}}W_{i}^{T}\Delta W_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.14" class="ltx_p">where <math id="S3.SS3.p3.9.m1.1" class="ltx_Math" alttext="\Delta W_{i}=W_{i}^{K}-W_{i}^{0}" display="inline"><semantics id="S3.SS3.p3.9.m1.1a"><mrow id="S3.SS3.p3.9.m1.1.1" xref="S3.SS3.p3.9.m1.1.1.cmml"><mrow id="S3.SS3.p3.9.m1.1.1.2" xref="S3.SS3.p3.9.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS3.p3.9.m1.1.1.2.2" xref="S3.SS3.p3.9.m1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.9.m1.1.1.2.1" xref="S3.SS3.p3.9.m1.1.1.2.1.cmml">​</mo><msub id="S3.SS3.p3.9.m1.1.1.2.3" xref="S3.SS3.p3.9.m1.1.1.2.3.cmml"><mi id="S3.SS3.p3.9.m1.1.1.2.3.2" xref="S3.SS3.p3.9.m1.1.1.2.3.2.cmml">W</mi><mi id="S3.SS3.p3.9.m1.1.1.2.3.3" xref="S3.SS3.p3.9.m1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS3.p3.9.m1.1.1.1" xref="S3.SS3.p3.9.m1.1.1.1.cmml">=</mo><mrow id="S3.SS3.p3.9.m1.1.1.3" xref="S3.SS3.p3.9.m1.1.1.3.cmml"><msubsup id="S3.SS3.p3.9.m1.1.1.3.2" xref="S3.SS3.p3.9.m1.1.1.3.2.cmml"><mi id="S3.SS3.p3.9.m1.1.1.3.2.2.2" xref="S3.SS3.p3.9.m1.1.1.3.2.2.2.cmml">W</mi><mi id="S3.SS3.p3.9.m1.1.1.3.2.2.3" xref="S3.SS3.p3.9.m1.1.1.3.2.2.3.cmml">i</mi><mi id="S3.SS3.p3.9.m1.1.1.3.2.3" xref="S3.SS3.p3.9.m1.1.1.3.2.3.cmml">K</mi></msubsup><mo id="S3.SS3.p3.9.m1.1.1.3.1" xref="S3.SS3.p3.9.m1.1.1.3.1.cmml">−</mo><msubsup id="S3.SS3.p3.9.m1.1.1.3.3" xref="S3.SS3.p3.9.m1.1.1.3.3.cmml"><mi id="S3.SS3.p3.9.m1.1.1.3.3.2.2" xref="S3.SS3.p3.9.m1.1.1.3.3.2.2.cmml">W</mi><mi id="S3.SS3.p3.9.m1.1.1.3.3.2.3" xref="S3.SS3.p3.9.m1.1.1.3.3.2.3.cmml">i</mi><mn id="S3.SS3.p3.9.m1.1.1.3.3.3" xref="S3.SS3.p3.9.m1.1.1.3.3.3.cmml">0</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m1.1b"><apply id="S3.SS3.p3.9.m1.1.1.cmml" xref="S3.SS3.p3.9.m1.1.1"><eq id="S3.SS3.p3.9.m1.1.1.1.cmml" xref="S3.SS3.p3.9.m1.1.1.1"></eq><apply id="S3.SS3.p3.9.m1.1.1.2.cmml" xref="S3.SS3.p3.9.m1.1.1.2"><times id="S3.SS3.p3.9.m1.1.1.2.1.cmml" xref="S3.SS3.p3.9.m1.1.1.2.1"></times><ci id="S3.SS3.p3.9.m1.1.1.2.2.cmml" xref="S3.SS3.p3.9.m1.1.1.2.2">Δ</ci><apply id="S3.SS3.p3.9.m1.1.1.2.3.cmml" xref="S3.SS3.p3.9.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m1.1.1.2.3.1.cmml" xref="S3.SS3.p3.9.m1.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p3.9.m1.1.1.2.3.2.cmml" xref="S3.SS3.p3.9.m1.1.1.2.3.2">𝑊</ci><ci id="S3.SS3.p3.9.m1.1.1.2.3.3.cmml" xref="S3.SS3.p3.9.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.p3.9.m1.1.1.3.cmml" xref="S3.SS3.p3.9.m1.1.1.3"><minus id="S3.SS3.p3.9.m1.1.1.3.1.cmml" xref="S3.SS3.p3.9.m1.1.1.3.1"></minus><apply id="S3.SS3.p3.9.m1.1.1.3.2.cmml" xref="S3.SS3.p3.9.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m1.1.1.3.2.1.cmml" xref="S3.SS3.p3.9.m1.1.1.3.2">superscript</csymbol><apply id="S3.SS3.p3.9.m1.1.1.3.2.2.cmml" xref="S3.SS3.p3.9.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m1.1.1.3.2.2.1.cmml" xref="S3.SS3.p3.9.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p3.9.m1.1.1.3.2.2.2.cmml" xref="S3.SS3.p3.9.m1.1.1.3.2.2.2">𝑊</ci><ci id="S3.SS3.p3.9.m1.1.1.3.2.2.3.cmml" xref="S3.SS3.p3.9.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S3.SS3.p3.9.m1.1.1.3.2.3.cmml" xref="S3.SS3.p3.9.m1.1.1.3.2.3">𝐾</ci></apply><apply id="S3.SS3.p3.9.m1.1.1.3.3.cmml" xref="S3.SS3.p3.9.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m1.1.1.3.3.1.cmml" xref="S3.SS3.p3.9.m1.1.1.3.3">superscript</csymbol><apply id="S3.SS3.p3.9.m1.1.1.3.3.2.cmml" xref="S3.SS3.p3.9.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.p3.9.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p3.9.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.p3.9.m1.1.1.3.3.2.2">𝑊</ci><ci id="S3.SS3.p3.9.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.p3.9.m1.1.1.3.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS3.p3.9.m1.1.1.3.3.3.cmml" xref="S3.SS3.p3.9.m1.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m1.1c">\Delta W_{i}=W_{i}^{K}-W_{i}^{0}</annotation></semantics></math> is the change of projection parameters after <math id="S3.SS3.p3.10.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p3.10.m2.1a"><mi id="S3.SS3.p3.10.m2.1.1" xref="S3.SS3.p3.10.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m2.1b"><ci id="S3.SS3.p3.10.m2.1.1.cmml" xref="S3.SS3.p3.10.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m2.1c">K</annotation></semantics></math> epochs, and <math id="S3.SS3.p3.11.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p3.11.m3.1a"><mi id="S3.SS3.p3.11.m3.1.1" xref="S3.SS3.p3.11.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m3.1b"><ci id="S3.SS3.p3.11.m3.1.1.cmml" xref="S3.SS3.p3.11.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m3.1c">K</annotation></semantics></math> is the local updating epochs. In communication round <math id="S3.SS3.p3.12.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p3.12.m4.1a"><mi id="S3.SS3.p3.12.m4.1.1" xref="S3.SS3.p3.12.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m4.1b"><ci id="S3.SS3.p3.12.m4.1.1.cmml" xref="S3.SS3.p3.12.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m4.1c">t</annotation></semantics></math>, we update hypernetwork parameter <math id="S3.SS3.p3.13.m5.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS3.p3.13.m5.1a"><mi id="S3.SS3.p3.13.m5.1.1" xref="S3.SS3.p3.13.m5.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m5.1b"><ci id="S3.SS3.p3.13.m5.1.1.cmml" xref="S3.SS3.p3.13.m5.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m5.1c">\varphi</annotation></semantics></math> and client embedding <math id="S3.SS3.p3.14.m6.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS3.p3.14.m6.1a"><msub id="S3.SS3.p3.14.m6.1.1" xref="S3.SS3.p3.14.m6.1.1.cmml"><mi id="S3.SS3.p3.14.m6.1.1.2" xref="S3.SS3.p3.14.m6.1.1.2.cmml">z</mi><mi id="S3.SS3.p3.14.m6.1.1.3" xref="S3.SS3.p3.14.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.14.m6.1b"><apply id="S3.SS3.p3.14.m6.1.1.cmml" xref="S3.SS3.p3.14.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.14.m6.1.1.1.cmml" xref="S3.SS3.p3.14.m6.1.1">subscript</csymbol><ci id="S3.SS3.p3.14.m6.1.1.2.cmml" xref="S3.SS3.p3.14.m6.1.1.2">𝑧</ci><ci id="S3.SS3.p3.14.m6.1.1.3.cmml" xref="S3.SS3.p3.14.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.14.m6.1c">z_{i}</annotation></semantics></math> by using the calculated gradients:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\varphi^{t}=\varphi^{t-1}-\beta\nabla_{\varphi}\mathcal{L}_{i}^{t-1}," display="block"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><msup id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.2.2.cmml">φ</mi><mi id="S3.E9.m1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.2.3.cmml">t</mi></msup><mo id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><msup id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.3.2.2.cmml">φ</mi><mrow id="S3.E9.m1.1.1.1.1.3.2.3" xref="S3.E9.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.3.2" xref="S3.E9.m1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S3.E9.m1.1.1.1.1.3.2.3.1" xref="S3.E9.m1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S3.E9.m1.1.1.1.1.3.2.3.3" xref="S3.E9.m1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.E9.m1.1.1.1.1.3.1" xref="S3.E9.m1.1.1.1.1.3.1.cmml">−</mo><mrow id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.3.3.2.cmml">β</mi><mo lspace="0.167em" rspace="0em" id="S3.E9.m1.1.1.1.1.3.3.1" xref="S3.E9.m1.1.1.1.1.3.3.1.cmml">​</mo><mrow id="S3.E9.m1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.3.3.3.cmml"><msub id="S3.E9.m1.1.1.1.1.3.3.3.1" xref="S3.E9.m1.1.1.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.E9.m1.1.1.1.1.3.3.3.1.2" xref="S3.E9.m1.1.1.1.1.3.3.3.1.2.cmml">∇</mo><mi id="S3.E9.m1.1.1.1.1.3.3.3.1.3" xref="S3.E9.m1.1.1.1.1.3.3.3.1.3.cmml">φ</mi></msub><msubsup id="S3.E9.m1.1.1.1.1.3.3.3.2" xref="S3.E9.m1.1.1.1.1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1.3.3.3.2.2.2" xref="S3.E9.m1.1.1.1.1.3.3.3.2.2.2.cmml">ℒ</mi><mi id="S3.E9.m1.1.1.1.1.3.3.3.2.2.3" xref="S3.E9.m1.1.1.1.1.3.3.3.2.2.3.cmml">i</mi><mrow id="S3.E9.m1.1.1.1.1.3.3.3.2.3" xref="S3.E9.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.3.3.2.3.2" xref="S3.E9.m1.1.1.1.1.3.3.3.2.3.2.cmml">t</mi><mo id="S3.E9.m1.1.1.1.1.3.3.3.2.3.1" xref="S3.E9.m1.1.1.1.1.3.3.3.2.3.1.cmml">−</mo><mn id="S3.E9.m1.1.1.1.1.3.3.3.2.3.3" xref="S3.E9.m1.1.1.1.1.3.3.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"></eq><apply id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.2">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.2.2">𝜑</ci><ci id="S3.E9.m1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><minus id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.1"></minus><apply id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2">𝜑</ci><apply id="S3.E9.m1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3"><minus id="S3.E9.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.1"></minus><ci id="S3.E9.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E9.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3"><times id="S3.E9.m1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3.1"></times><ci id="S3.E9.m1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.2">𝛽</ci><apply id="S3.E9.m1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3"><apply id="S3.E9.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.1">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.1.2">∇</ci><ci id="S3.E9.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.1.3">𝜑</ci></apply><apply id="S3.E9.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.3.3.2.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.3.3.2.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2.2.2">ℒ</ci><ci id="S3.E9.m1.1.1.1.1.3.3.3.2.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E9.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2.3"><minus id="S3.E9.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2.3.1"></minus><ci id="S3.E9.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E9.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\varphi^{t}=\varphi^{t-1}-\beta\nabla_{\varphi}\mathcal{L}_{i}^{t-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.1" class="ltx_Math" alttext="z_{i}^{t}=z_{i}^{t-1}-\beta\nabla_{z_{i}}\mathcal{L}_{i}^{t-1}." display="block"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><msubsup id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.1.1.1.1.2.2.2" xref="S3.E10.m1.1.1.1.1.2.2.2.cmml">z</mi><mi id="S3.E10.m1.1.1.1.1.2.2.3" xref="S3.E10.m1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E10.m1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml"><msubsup id="S3.E10.m1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.3.2.cmml"><mi id="S3.E10.m1.1.1.1.1.3.2.2.2" xref="S3.E10.m1.1.1.1.1.3.2.2.2.cmml">z</mi><mi id="S3.E10.m1.1.1.1.1.3.2.2.3" xref="S3.E10.m1.1.1.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.E10.m1.1.1.1.1.3.2.3" xref="S3.E10.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.2.3.2" xref="S3.E10.m1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S3.E10.m1.1.1.1.1.3.2.3.1" xref="S3.E10.m1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S3.E10.m1.1.1.1.1.3.2.3.3" xref="S3.E10.m1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E10.m1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.3.1.cmml">−</mo><mrow id="S3.E10.m1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.3.2" xref="S3.E10.m1.1.1.1.1.3.3.2.cmml">β</mi><mo lspace="0.167em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.3.1" xref="S3.E10.m1.1.1.1.1.3.3.1.cmml">​</mo><mrow id="S3.E10.m1.1.1.1.1.3.3.3" xref="S3.E10.m1.1.1.1.1.3.3.3.cmml"><msub id="S3.E10.m1.1.1.1.1.3.3.3.1" xref="S3.E10.m1.1.1.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.E10.m1.1.1.1.1.3.3.3.1.2" xref="S3.E10.m1.1.1.1.1.3.3.3.1.2.cmml">∇</mo><msub id="S3.E10.m1.1.1.1.1.3.3.3.1.3" xref="S3.E10.m1.1.1.1.1.3.3.3.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.3.3.1.3.2" xref="S3.E10.m1.1.1.1.1.3.3.3.1.3.2.cmml">z</mi><mi id="S3.E10.m1.1.1.1.1.3.3.3.1.3.3" xref="S3.E10.m1.1.1.1.1.3.3.3.1.3.3.cmml">i</mi></msub></msub><msubsup id="S3.E10.m1.1.1.1.1.3.3.3.2" xref="S3.E10.m1.1.1.1.1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.3.3.3.2.2.2" xref="S3.E10.m1.1.1.1.1.3.3.3.2.2.2.cmml">ℒ</mi><mi id="S3.E10.m1.1.1.1.1.3.3.3.2.2.3" xref="S3.E10.m1.1.1.1.1.3.3.3.2.2.3.cmml">i</mi><mrow id="S3.E10.m1.1.1.1.1.3.3.3.2.3" xref="S3.E10.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.3.3.2.3.2" xref="S3.E10.m1.1.1.1.1.3.3.3.2.3.2.cmml">t</mi><mo id="S3.E10.m1.1.1.1.1.3.3.3.2.3.1" xref="S3.E10.m1.1.1.1.1.3.3.3.2.3.1.cmml">−</mo><mn id="S3.E10.m1.1.1.1.1.3.3.3.2.3.3" xref="S3.E10.m1.1.1.1.1.3.3.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"></eq><apply id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2">𝑧</ci><ci id="S3.E10.m1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E10.m1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3"><minus id="S3.E10.m1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.1"></minus><apply id="S3.E10.m1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E10.m1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2.2.2">𝑧</ci><ci id="S3.E10.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3"><minus id="S3.E10.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.1"></minus><ci id="S3.E10.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E10.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.E10.m1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3"><times id="S3.E10.m1.1.1.1.1.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.1"></times><ci id="S3.E10.m1.1.1.1.1.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.2">𝛽</ci><apply id="S3.E10.m1.1.1.1.1.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3"><apply id="S3.E10.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.1.2">∇</ci><apply id="S3.E10.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.3.3.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.3.3.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.1.3.2">𝑧</ci><ci id="S3.E10.m1.1.1.1.1.3.3.3.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.E10.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2">superscript</csymbol><apply id="S3.E10.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.3.3.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.3.3.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2.2.2">ℒ</ci><ci id="S3.E10.m1.1.1.1.1.3.3.3.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2.3"><minus id="S3.E10.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2.3.1"></minus><ci id="S3.E10.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E10.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">z_{i}^{t}=z_{i}^{t-1}-\beta\nabla_{z_{i}}\mathcal{L}_{i}^{t-1}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.6" class="ltx_p">Compared to the vanilla personalization mechanism, <em id="S3.SS3.p4.6.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> for self-attention has several merits: 1) it can effectively share parameters across clients and better exploits the role of self-attention mechanism in federated learning; 2) it offers scalability with the growing number of clients since the self-attention layer is generated by the shared hypernetwork with client-wise embedding vectors; 3) it can be better generalized to novel clients whose data is unseen during training. The first and third points will be validated in Section IV. The
second point can be easily shown by comparing the total number of parameters of <em id="S3.SS3.p4.6.2" class="ltx_emph ltx_font_italic">learn-to-personalize</em> and vanilla personalization. Based on the MLP structure of hypernetwork, its total number of parameters is approximately equal to <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="D_{h}\times D_{s}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><msub id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2.2" xref="S3.SS3.p4.1.m1.1.1.2.2.cmml">D</mi><mi id="S3.SS3.p4.1.m1.1.1.2.3" xref="S3.SS3.p4.1.m1.1.1.2.3.cmml">h</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.cmml">×</mo><msub id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">D</mi><mi id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><times id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1"></times><apply id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2.2">𝐷</ci><ci id="S3.SS3.p4.1.m1.1.1.2.3.cmml" xref="S3.SS3.p4.1.m1.1.1.2.3">ℎ</ci></apply><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">𝐷</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">D_{h}\times D_{s}</annotation></semantics></math>, where <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="D_{h}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">D</mi><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝐷</ci><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">D_{h}</annotation></semantics></math> and <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="D_{s}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><msub id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml">D</mi><mi id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2">𝐷</ci><ci id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">D_{s}</annotation></semantics></math> are the dimensions of the hidden layers in hypernetwork and the projection parameters of self-attention. In contrast, the total projection parameters of vanilla personalization increase linearly with the number of clients, i.e. <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="N\times D_{s}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mrow id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.4.m4.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.cmml">×</mo><msub id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.3.2.cmml">D</mi><mi id="S3.SS3.p4.4.m4.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><times id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1"></times><ci id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2">𝑁</ci><apply id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2">𝐷</ci><ci id="S3.SS3.p4.4.m4.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">N\times D_{s}</annotation></semantics></math>. When the client number <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">N</annotation></semantics></math> is larger than <math id="S3.SS3.p4.6.m6.1" class="ltx_Math" alttext="D_{h}" display="inline"><semantics id="S3.SS3.p4.6.m6.1a"><msub id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mi id="S3.SS3.p4.6.m6.1.1.2" xref="S3.SS3.p4.6.m6.1.1.2.cmml">D</mi><mi id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2">𝐷</ci><ci id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">D_{h}</annotation></semantics></math>, <span id="S3.SS3.p4.6.3" class="ltx_text ltx_font_italic">learn-to-personalize</span> for self-attention consumes less resource consumption.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.4.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.5.2" class="ltx_text ltx_font_italic">Generalization Bound</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">We analyze the generalization bound of FedTP in this section. Before starting the analysis, we first introduce some assumptions as follows.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para ltx_noindent">
<p id="S3.SS4.p2.6" class="ltx_p"><span id="S3.SS4.p2.6.7" class="ltx_text ltx_font_bold">Assmuption 1</span>
<em id="S3.SS4.p2.6.6" class="ltx_emph ltx_font_italic">We assume the embedding vectors <math id="S3.SS4.p2.1.1.m1.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS4.p2.1.1.m1.1a"><msub id="S3.SS4.p2.1.1.m1.1.1" xref="S3.SS4.p2.1.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.1.m1.1.1.2" xref="S3.SS4.p2.1.1.m1.1.1.2.cmml">z</mi><mi id="S3.SS4.p2.1.1.m1.1.1.3" xref="S3.SS4.p2.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.1.m1.1b"><apply id="S3.SS4.p2.1.1.m1.1.1.cmml" xref="S3.SS4.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.1.m1.1.1.2">𝑧</ci><ci id="S3.SS4.p2.1.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.1.m1.1c">z_{i}</annotation></semantics></math> and the weights <math id="S3.SS4.p2.2.2.m2.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS4.p2.2.2.m2.1a"><mi id="S3.SS4.p2.2.2.m2.1.1" xref="S3.SS4.p2.2.2.m2.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.2.m2.1b"><ci id="S3.SS4.p2.2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.2.m2.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.2.m2.1c">\varphi</annotation></semantics></math> of hypernetwork <math id="S3.SS4.p2.3.3.m3.2" class="ltx_Math" alttext="h(\varphi,z_{i})" display="inline"><semantics id="S3.SS4.p2.3.3.m3.2a"><mrow id="S3.SS4.p2.3.3.m3.2.2" xref="S3.SS4.p2.3.3.m3.2.2.cmml"><mi id="S3.SS4.p2.3.3.m3.2.2.3" xref="S3.SS4.p2.3.3.m3.2.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.3.3.m3.2.2.2" xref="S3.SS4.p2.3.3.m3.2.2.2.cmml">​</mo><mrow id="S3.SS4.p2.3.3.m3.2.2.1.1" xref="S3.SS4.p2.3.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS4.p2.3.3.m3.2.2.1.1.2" xref="S3.SS4.p2.3.3.m3.2.2.1.2.cmml">(</mo><mi id="S3.SS4.p2.3.3.m3.1.1" xref="S3.SS4.p2.3.3.m3.1.1.cmml">φ</mi><mo id="S3.SS4.p2.3.3.m3.2.2.1.1.3" xref="S3.SS4.p2.3.3.m3.2.2.1.2.cmml">,</mo><msub id="S3.SS4.p2.3.3.m3.2.2.1.1.1" xref="S3.SS4.p2.3.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS4.p2.3.3.m3.2.2.1.1.1.2" xref="S3.SS4.p2.3.3.m3.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS4.p2.3.3.m3.2.2.1.1.1.3" xref="S3.SS4.p2.3.3.m3.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS4.p2.3.3.m3.2.2.1.1.4" xref="S3.SS4.p2.3.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.3.m3.2b"><apply id="S3.SS4.p2.3.3.m3.2.2.cmml" xref="S3.SS4.p2.3.3.m3.2.2"><times id="S3.SS4.p2.3.3.m3.2.2.2.cmml" xref="S3.SS4.p2.3.3.m3.2.2.2"></times><ci id="S3.SS4.p2.3.3.m3.2.2.3.cmml" xref="S3.SS4.p2.3.3.m3.2.2.3">ℎ</ci><interval closure="open" id="S3.SS4.p2.3.3.m3.2.2.1.2.cmml" xref="S3.SS4.p2.3.3.m3.2.2.1.1"><ci id="S3.SS4.p2.3.3.m3.1.1.cmml" xref="S3.SS4.p2.3.3.m3.1.1">𝜑</ci><apply id="S3.SS4.p2.3.3.m3.2.2.1.1.1.cmml" xref="S3.SS4.p2.3.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS4.p2.3.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS4.p2.3.3.m3.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS4.p2.3.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS4.p2.3.3.m3.2.2.1.1.1.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.3.m3.2c">h(\varphi,z_{i})</annotation></semantics></math> are bounded in a ball of radius <math id="S3.SS4.p2.4.4.m4.1" class="ltx_Math" alttext="R_{h}" display="inline"><semantics id="S3.SS4.p2.4.4.m4.1a"><msub id="S3.SS4.p2.4.4.m4.1.1" xref="S3.SS4.p2.4.4.m4.1.1.cmml"><mi id="S3.SS4.p2.4.4.m4.1.1.2" xref="S3.SS4.p2.4.4.m4.1.1.2.cmml">R</mi><mi id="S3.SS4.p2.4.4.m4.1.1.3" xref="S3.SS4.p2.4.4.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.4.m4.1b"><apply id="S3.SS4.p2.4.4.m4.1.1.cmml" xref="S3.SS4.p2.4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.4.m4.1.1.2">𝑅</ci><ci id="S3.SS4.p2.4.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.4.m4.1c">R_{h}</annotation></semantics></math>, and the parameters of other layers <math id="S3.SS4.p2.5.5.m5.1" class="ltx_Math" alttext="\xi" display="inline"><semantics id="S3.SS4.p2.5.5.m5.1a"><mi id="S3.SS4.p2.5.5.m5.1.1" xref="S3.SS4.p2.5.5.m5.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.5.m5.1b"><ci id="S3.SS4.p2.5.5.m5.1.1.cmml" xref="S3.SS4.p2.5.5.m5.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.5.m5.1c">\xi</annotation></semantics></math> in Transformer are bounded in a ball of radius <math id="S3.SS4.p2.6.6.m6.1" class="ltx_Math" alttext="R_{t}" display="inline"><semantics id="S3.SS4.p2.6.6.m6.1a"><msub id="S3.SS4.p2.6.6.m6.1.1" xref="S3.SS4.p2.6.6.m6.1.1.cmml"><mi id="S3.SS4.p2.6.6.m6.1.1.2" xref="S3.SS4.p2.6.6.m6.1.1.2.cmml">R</mi><mi id="S3.SS4.p2.6.6.m6.1.1.3" xref="S3.SS4.p2.6.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.6.m6.1b"><apply id="S3.SS4.p2.6.6.m6.1.1.cmml" xref="S3.SS4.p2.6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.6.6.m6.1.1.1.cmml" xref="S3.SS4.p2.6.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p2.6.6.m6.1.1.2.cmml" xref="S3.SS4.p2.6.6.m6.1.1.2">𝑅</ci><ci id="S3.SS4.p2.6.6.m6.1.1.3.cmml" xref="S3.SS4.p2.6.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.6.m6.1c">R_{t}</annotation></semantics></math>. These assumptions can be denoted as:</em></p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.1" class="ltx_Math" alttext="\|\varphi-\varphi^{\prime}\|\leq R_{h},\ \|z_{i}-z_{i}^{\prime}\|\leq R_{h},\ \|\xi-\xi^{\prime}\|\leq R_{t}." display="block"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.1.1"><mrow id="S3.E11.m1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.3.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.cmml">φ</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">φ</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo stretchy="false" id="S3.E11.m1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E11.m1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.2.cmml">≤</mo><msub id="S3.E11.m1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.1.1.3.2.cmml">R</mi><mi id="S3.E11.m1.1.1.1.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.1.1.3.3.cmml">h</mi></msub></mrow><mo rspace="0.667em" id="S3.E11.m1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E11.m1.1.1.1.1.2.2.2" xref="S3.E11.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E11.m1.1.1.1.1.2.2.1.1" xref="S3.E11.m1.1.1.1.1.2.2.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.cmml"><msub id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.2" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.2.cmml">z</mi><mi id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.3" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml">′</mo></msubsup></mrow><mo stretchy="false" id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E11.m1.1.1.1.1.2.2.1.1.2" xref="S3.E11.m1.1.1.1.1.2.2.1.1.2.cmml">≤</mo><msub id="S3.E11.m1.1.1.1.1.2.2.1.1.3" xref="S3.E11.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.1.1.3.2" xref="S3.E11.m1.1.1.1.1.2.2.1.1.3.2.cmml">R</mi><mi id="S3.E11.m1.1.1.1.1.2.2.1.1.3.3" xref="S3.E11.m1.1.1.1.1.2.2.1.1.3.3.cmml">h</mi></msub></mrow><mo rspace="0.667em" id="S3.E11.m1.1.1.1.1.2.2.2.3" xref="S3.E11.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E11.m1.1.1.1.1.2.2.2.2" xref="S3.E11.m1.1.1.1.1.2.2.2.2.cmml"><mrow id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.2" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.2.1.cmml">‖</mo><mrow id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.2" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.2.cmml">ξ</mi><mo id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.1" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml">−</mo><msup id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.2.cmml">ξ</mi><mo id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.3.cmml">′</mo></msup></mrow><mo stretchy="false" id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.3" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.2.1.cmml">‖</mo></mrow><mo id="S3.E11.m1.1.1.1.1.2.2.2.2.2" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2.cmml">≤</mo><msub id="S3.E11.m1.1.1.1.1.2.2.2.2.3" xref="S3.E11.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E11.m1.1.1.1.1.2.2.2.2.3.2.cmml">R</mi><mi id="S3.E11.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E11.m1.1.1.1.1.2.2.2.2.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="S3.E11.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.3a.cmml" xref="S3.E11.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1"><leq id="S3.E11.m1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2"></leq><apply id="S3.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1"><minus id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2">𝜑</ci><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.2">𝜑</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply><apply id="S3.E11.m1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.3.2">𝑅</ci><ci id="S3.E11.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.2.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.3a.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E11.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1"><leq id="S3.E11.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.2"></leq><apply id="S3.E11.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E11.m1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.2">norm</csymbol><apply id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1"><minus id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.1"></minus><apply id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.2">𝑧</ci><ci id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.1.1.1.3.3">′</ci></apply></apply></apply><apply id="S3.E11.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.3.2">𝑅</ci><ci id="S3.E11.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.1.1.3.3">ℎ</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2"><leq id="S3.E11.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2"></leq><apply id="S3.E11.m1.1.1.1.1.2.2.2.2.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1"><csymbol cd="latexml" id="S3.E11.m1.1.1.1.1.2.2.2.2.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.2">norm</csymbol><apply id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1"><minus id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.1"></minus><ci id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.2">𝜉</ci><apply id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.2">𝜉</ci><ci id="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.1.1.1.3.3">′</ci></apply></apply></apply><apply id="S3.E11.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.3.2">𝑅</ci><ci id="S3.E11.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\|\varphi-\varphi^{\prime}\|\leq R_{h},\ \|z_{i}-z_{i}^{\prime}\|\leq R_{h},\ \|\xi-\xi^{\prime}\|\leq R_{t}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p3" class="ltx_para ltx_noindent">
<p id="S3.SS4.p3.2" class="ltx_p"><span id="S3.SS4.p3.2.3" class="ltx_text ltx_font_bold">Assmuption 2</span>
<em id="S3.SS4.p3.2.2" class="ltx_emph ltx_font_italic">(Lipschitz conditions) Let <math id="S3.SS4.p3.1.1.m1.4" class="ltx_Math" alttext="\mathcal{D}_{1},\mathcal{D}_{2},\cdots,\mathcal{D}_{N}" display="inline"><semantics id="S3.SS4.p3.1.1.m1.4a"><mrow id="S3.SS4.p3.1.1.m1.4.4.3" xref="S3.SS4.p3.1.1.m1.4.4.4.cmml"><msub id="S3.SS4.p3.1.1.m1.2.2.1.1" xref="S3.SS4.p3.1.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.1.1.m1.2.2.1.1.2" xref="S3.SS4.p3.1.1.m1.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.SS4.p3.1.1.m1.2.2.1.1.3" xref="S3.SS4.p3.1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p3.1.1.m1.4.4.3.4" xref="S3.SS4.p3.1.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS4.p3.1.1.m1.3.3.2.2" xref="S3.SS4.p3.1.1.m1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.1.1.m1.3.3.2.2.2" xref="S3.SS4.p3.1.1.m1.3.3.2.2.2.cmml">𝒟</mi><mn id="S3.SS4.p3.1.1.m1.3.3.2.2.3" xref="S3.SS4.p3.1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.p3.1.1.m1.4.4.3.5" xref="S3.SS4.p3.1.1.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p3.1.1.m1.1.1" xref="S3.SS4.p3.1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS4.p3.1.1.m1.4.4.3.6" xref="S3.SS4.p3.1.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS4.p3.1.1.m1.4.4.3.3" xref="S3.SS4.p3.1.1.m1.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.1.1.m1.4.4.3.3.2" xref="S3.SS4.p3.1.1.m1.4.4.3.3.2.cmml">𝒟</mi><mi id="S3.SS4.p3.1.1.m1.4.4.3.3.3" xref="S3.SS4.p3.1.1.m1.4.4.3.3.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.1.m1.4b"><list id="S3.SS4.p3.1.1.m1.4.4.4.cmml" xref="S3.SS4.p3.1.1.m1.4.4.3"><apply id="S3.SS4.p3.1.1.m1.2.2.1.1.cmml" xref="S3.SS4.p3.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.1.m1.2.2.1.1.1.cmml" xref="S3.SS4.p3.1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.1.m1.2.2.1.1.2.cmml" xref="S3.SS4.p3.1.1.m1.2.2.1.1.2">𝒟</ci><cn type="integer" id="S3.SS4.p3.1.1.m1.2.2.1.1.3.cmml" xref="S3.SS4.p3.1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S3.SS4.p3.1.1.m1.3.3.2.2.cmml" xref="S3.SS4.p3.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.1.1.m1.3.3.2.2.1.cmml" xref="S3.SS4.p3.1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS4.p3.1.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.p3.1.1.m1.3.3.2.2.2">𝒟</ci><cn type="integer" id="S3.SS4.p3.1.1.m1.3.3.2.2.3.cmml" xref="S3.SS4.p3.1.1.m1.3.3.2.2.3">2</cn></apply><ci id="S3.SS4.p3.1.1.m1.1.1.cmml" xref="S3.SS4.p3.1.1.m1.1.1">⋯</ci><apply id="S3.SS4.p3.1.1.m1.4.4.3.3.cmml" xref="S3.SS4.p3.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.1.1.m1.4.4.3.3.1.cmml" xref="S3.SS4.p3.1.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.SS4.p3.1.1.m1.4.4.3.3.2.cmml" xref="S3.SS4.p3.1.1.m1.4.4.3.3.2">𝒟</ci><ci id="S3.SS4.p3.1.1.m1.4.4.3.3.3.cmml" xref="S3.SS4.p3.1.1.m1.4.4.3.3.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.1.m1.4c">\mathcal{D}_{1},\mathcal{D}_{2},\cdots,\mathcal{D}_{N}</annotation></semantics></math> represent the real data distributions, and <math id="S3.SS4.p3.2.2.m2.10" class="ltx_Math" alttext="\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi;z_{i}),\xi)=\mathbb{E}_{(x,y)\in\mathcal{D}_{i}}l(f(h(\varphi;z_{i}),\xi;x),y)" display="inline"><semantics id="S3.SS4.p3.2.2.m2.10a"><mrow id="S3.SS4.p3.2.2.m2.10.10" xref="S3.SS4.p3.2.2.m2.10.10.cmml"><mrow id="S3.SS4.p3.2.2.m2.9.9.1" xref="S3.SS4.p3.2.2.m2.9.9.1.cmml"><msub id="S3.SS4.p3.2.2.m2.9.9.1.3" xref="S3.SS4.p3.2.2.m2.9.9.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.2.2.m2.9.9.1.3.2" xref="S3.SS4.p3.2.2.m2.9.9.1.3.2.cmml">ℒ</mi><msub id="S3.SS4.p3.2.2.m2.9.9.1.3.3" xref="S3.SS4.p3.2.2.m2.9.9.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.2.2.m2.9.9.1.3.3.2" xref="S3.SS4.p3.2.2.m2.9.9.1.3.3.2.cmml">𝒟</mi><mi id="S3.SS4.p3.2.2.m2.9.9.1.3.3.3" xref="S3.SS4.p3.2.2.m2.9.9.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.2.m2.9.9.1.2" xref="S3.SS4.p3.2.2.m2.9.9.1.2.cmml">​</mo><mrow id="S3.SS4.p3.2.2.m2.9.9.1.1.1" xref="S3.SS4.p3.2.2.m2.9.9.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p3.2.2.m2.9.9.1.1.1.2" xref="S3.SS4.p3.2.2.m2.9.9.1.1.2.cmml">(</mo><mrow id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.cmml"><mi id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.3" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.2" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.2" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS4.p3.2.2.m2.3.3" xref="S3.SS4.p3.2.2.m2.3.3.cmml">φ</mi><mo id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.3" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.2.cmml">;</mo><msub id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.2" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.3" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.4" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p3.2.2.m2.9.9.1.1.1.3" xref="S3.SS4.p3.2.2.m2.9.9.1.1.2.cmml">,</mo><mi id="S3.SS4.p3.2.2.m2.4.4" xref="S3.SS4.p3.2.2.m2.4.4.cmml">ξ</mi><mo stretchy="false" id="S3.SS4.p3.2.2.m2.9.9.1.1.1.4" xref="S3.SS4.p3.2.2.m2.9.9.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p3.2.2.m2.10.10.3" xref="S3.SS4.p3.2.2.m2.10.10.3.cmml">=</mo><mrow id="S3.SS4.p3.2.2.m2.10.10.2" xref="S3.SS4.p3.2.2.m2.10.10.2.cmml"><msub id="S3.SS4.p3.2.2.m2.10.10.2.3" xref="S3.SS4.p3.2.2.m2.10.10.2.3.cmml"><mi id="S3.SS4.p3.2.2.m2.10.10.2.3.2" xref="S3.SS4.p3.2.2.m2.10.10.2.3.2.cmml">𝔼</mi><mrow id="S3.SS4.p3.2.2.m2.2.2.2" xref="S3.SS4.p3.2.2.m2.2.2.2.cmml"><mrow id="S3.SS4.p3.2.2.m2.2.2.2.4.2" xref="S3.SS4.p3.2.2.m2.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.SS4.p3.2.2.m2.2.2.2.4.2.1" xref="S3.SS4.p3.2.2.m2.2.2.2.4.1.cmml">(</mo><mi id="S3.SS4.p3.2.2.m2.1.1.1.1" xref="S3.SS4.p3.2.2.m2.1.1.1.1.cmml">x</mi><mo id="S3.SS4.p3.2.2.m2.2.2.2.4.2.2" xref="S3.SS4.p3.2.2.m2.2.2.2.4.1.cmml">,</mo><mi id="S3.SS4.p3.2.2.m2.2.2.2.2" xref="S3.SS4.p3.2.2.m2.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS4.p3.2.2.m2.2.2.2.4.2.3" xref="S3.SS4.p3.2.2.m2.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.SS4.p3.2.2.m2.2.2.2.3" xref="S3.SS4.p3.2.2.m2.2.2.2.3.cmml">∈</mo><msub id="S3.SS4.p3.2.2.m2.2.2.2.5" xref="S3.SS4.p3.2.2.m2.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.2.2.m2.2.2.2.5.2" xref="S3.SS4.p3.2.2.m2.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.SS4.p3.2.2.m2.2.2.2.5.3" xref="S3.SS4.p3.2.2.m2.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.2.m2.10.10.2.2" xref="S3.SS4.p3.2.2.m2.10.10.2.2.cmml">​</mo><mi id="S3.SS4.p3.2.2.m2.10.10.2.4" xref="S3.SS4.p3.2.2.m2.10.10.2.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.2.m2.10.10.2.2a" xref="S3.SS4.p3.2.2.m2.10.10.2.2.cmml">​</mo><mrow id="S3.SS4.p3.2.2.m2.10.10.2.1.1" xref="S3.SS4.p3.2.2.m2.10.10.2.1.2.cmml"><mo stretchy="false" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.2" xref="S3.SS4.p3.2.2.m2.10.10.2.1.2.cmml">(</mo><mrow id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.cmml"><mi id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.3" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.2" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.2" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.3" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.2" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS4.p3.2.2.m2.5.5" xref="S3.SS4.p3.2.2.m2.5.5.cmml">φ</mi><mo id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.4" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.3" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.2.cmml">,</mo><mi id="S3.SS4.p3.2.2.m2.6.6" xref="S3.SS4.p3.2.2.m2.6.6.cmml">ξ</mi><mo id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.4" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.2.cmml">;</mo><mi id="S3.SS4.p3.2.2.m2.7.7" xref="S3.SS4.p3.2.2.m2.7.7.cmml">x</mi><mo stretchy="false" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.5" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p3.2.2.m2.10.10.2.1.1.3" xref="S3.SS4.p3.2.2.m2.10.10.2.1.2.cmml">,</mo><mi id="S3.SS4.p3.2.2.m2.8.8" xref="S3.SS4.p3.2.2.m2.8.8.cmml">y</mi><mo stretchy="false" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.4" xref="S3.SS4.p3.2.2.m2.10.10.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.2.m2.10b"><apply id="S3.SS4.p3.2.2.m2.10.10.cmml" xref="S3.SS4.p3.2.2.m2.10.10"><eq id="S3.SS4.p3.2.2.m2.10.10.3.cmml" xref="S3.SS4.p3.2.2.m2.10.10.3"></eq><apply id="S3.SS4.p3.2.2.m2.9.9.1.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1"><times id="S3.SS4.p3.2.2.m2.9.9.1.2.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.2"></times><apply id="S3.SS4.p3.2.2.m2.9.9.1.3.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.2.2.m2.9.9.1.3.1.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.3">subscript</csymbol><ci id="S3.SS4.p3.2.2.m2.9.9.1.3.2.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.3.2">ℒ</ci><apply id="S3.SS4.p3.2.2.m2.9.9.1.3.3.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.2.2.m2.9.9.1.3.3.1.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.3.3">subscript</csymbol><ci id="S3.SS4.p3.2.2.m2.9.9.1.3.3.2.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.3.3.2">𝒟</ci><ci id="S3.SS4.p3.2.2.m2.9.9.1.3.3.3.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.3.3.3">𝑖</ci></apply></apply><interval closure="open" id="S3.SS4.p3.2.2.m2.9.9.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1"><apply id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1"><times id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.2"></times><ci id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.3.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.3">ℎ</ci><list id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1"><ci id="S3.SS4.p3.2.2.m2.3.3.cmml" xref="S3.SS4.p3.2.2.m2.3.3">𝜑</ci><apply id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.2.2.m2.9.9.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="S3.SS4.p3.2.2.m2.4.4.cmml" xref="S3.SS4.p3.2.2.m2.4.4">𝜉</ci></interval></apply><apply id="S3.SS4.p3.2.2.m2.10.10.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2"><times id="S3.SS4.p3.2.2.m2.10.10.2.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.2"></times><apply id="S3.SS4.p3.2.2.m2.10.10.2.3.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.3"><csymbol cd="ambiguous" id="S3.SS4.p3.2.2.m2.10.10.2.3.1.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.3">subscript</csymbol><ci id="S3.SS4.p3.2.2.m2.10.10.2.3.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.3.2">𝔼</ci><apply id="S3.SS4.p3.2.2.m2.2.2.2.cmml" xref="S3.SS4.p3.2.2.m2.2.2.2"><in id="S3.SS4.p3.2.2.m2.2.2.2.3.cmml" xref="S3.SS4.p3.2.2.m2.2.2.2.3"></in><interval closure="open" id="S3.SS4.p3.2.2.m2.2.2.2.4.1.cmml" xref="S3.SS4.p3.2.2.m2.2.2.2.4.2"><ci id="S3.SS4.p3.2.2.m2.1.1.1.1.cmml" xref="S3.SS4.p3.2.2.m2.1.1.1.1">𝑥</ci><ci id="S3.SS4.p3.2.2.m2.2.2.2.2.cmml" xref="S3.SS4.p3.2.2.m2.2.2.2.2">𝑦</ci></interval><apply id="S3.SS4.p3.2.2.m2.2.2.2.5.cmml" xref="S3.SS4.p3.2.2.m2.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS4.p3.2.2.m2.2.2.2.5.1.cmml" xref="S3.SS4.p3.2.2.m2.2.2.2.5">subscript</csymbol><ci id="S3.SS4.p3.2.2.m2.2.2.2.5.2.cmml" xref="S3.SS4.p3.2.2.m2.2.2.2.5.2">𝒟</ci><ci id="S3.SS4.p3.2.2.m2.2.2.2.5.3.cmml" xref="S3.SS4.p3.2.2.m2.2.2.2.5.3">𝑖</ci></apply></apply></apply><ci id="S3.SS4.p3.2.2.m2.10.10.2.4.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.4">𝑙</ci><interval closure="open" id="S3.SS4.p3.2.2.m2.10.10.2.1.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1"><apply id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1"><times id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.2"></times><ci id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.3.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.3">𝑓</ci><vector id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1"><apply id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1"><times id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.2"></times><ci id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.3">ℎ</ci><list id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1"><ci id="S3.SS4.p3.2.2.m2.5.5.cmml" xref="S3.SS4.p3.2.2.m2.5.5">𝜑</ci><apply id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.2.2.m2.10.10.2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="S3.SS4.p3.2.2.m2.6.6.cmml" xref="S3.SS4.p3.2.2.m2.6.6">𝜉</ci><ci id="S3.SS4.p3.2.2.m2.7.7.cmml" xref="S3.SS4.p3.2.2.m2.7.7">𝑥</ci></vector></apply><ci id="S3.SS4.p3.2.2.m2.8.8.cmml" xref="S3.SS4.p3.2.2.m2.8.8">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.2.m2.10c">\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi;z_{i}),\xi)=\mathbb{E}_{(x,y)\in\mathcal{D}_{i}}l(f(h(\varphi;z_{i}),\xi;x),y)</annotation></semantics></math> be the expected loss. We assume the following Lipschitz conditions hold:
</em></p>
<table id="S3.E12" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E12.1" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center" colspan="2"><math id="S3.E12.1.m1.4" class="ltx_Math" alttext="|\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi;z_{i}),\xi)-\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi;z_{i}),\xi^{\prime})|\leq L_{\xi}\|\xi-\xi^{\prime}\|," display="block"><semantics id="S3.E12.1.m1.4a"><mrow id="S3.E12.1.m1.4.4.1" xref="S3.E12.1.m1.4.4.1.1.cmml"><mrow id="S3.E12.1.m1.4.4.1.1" xref="S3.E12.1.m1.4.4.1.1.cmml"><mrow id="S3.E12.1.m1.4.4.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.2.1.cmml">|</mo><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.cmml"><msub id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.2.cmml">ℒ</mi><msub id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.1.m1.1.1" xref="S3.E12.1.m1.1.1.cmml">φ</mi><mo id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E12.1.m1.2.2" xref="S3.E12.1.m1.2.2.cmml">ξ</mi><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.1.m1.4.4.1.1.1.1.1.4" xref="S3.E12.1.m1.4.4.1.1.1.1.1.4.cmml">−</mo><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.cmml"><msub id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.2.cmml">ℒ</mi><msub id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.2.cmml">𝒟</mi><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.3.cmml">​</mo><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.3.cmml"><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.3.cmml">(</mo><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.1.m1.3.3" xref="S3.E12.1.m1.3.3.cmml">φ</mi><mo id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.4" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.4" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.3.cmml">,</mo><msup id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.2" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.2.cmml">ξ</mi><mo id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.3" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.3.cmml">′</mo></msup><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.5" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E12.1.m1.4.4.1.1.3" xref="S3.E12.1.m1.4.4.1.1.3.cmml">≤</mo><mrow id="S3.E12.1.m1.4.4.1.1.2" xref="S3.E12.1.m1.4.4.1.1.2.cmml"><msub id="S3.E12.1.m1.4.4.1.1.2.3" xref="S3.E12.1.m1.4.4.1.1.2.3.cmml"><mi id="S3.E12.1.m1.4.4.1.1.2.3.2" xref="S3.E12.1.m1.4.4.1.1.2.3.2.cmml">L</mi><mi id="S3.E12.1.m1.4.4.1.1.2.3.3" xref="S3.E12.1.m1.4.4.1.1.2.3.3.cmml">ξ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.1.m1.4.4.1.1.2.2" xref="S3.E12.1.m1.4.4.1.1.2.2.cmml">​</mo><mrow id="S3.E12.1.m1.4.4.1.1.2.1.1" xref="S3.E12.1.m1.4.4.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.2.1.1.2" xref="S3.E12.1.m1.4.4.1.1.2.1.2.1.cmml">‖</mo><mrow id="S3.E12.1.m1.4.4.1.1.2.1.1.1" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.cmml"><mi id="S3.E12.1.m1.4.4.1.1.2.1.1.1.2" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.2.cmml">ξ</mi><mo id="S3.E12.1.m1.4.4.1.1.2.1.1.1.1" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.1.cmml">−</mo><msup id="S3.E12.1.m1.4.4.1.1.2.1.1.1.3" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.cmml"><mi id="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.2" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.2.cmml">ξ</mi><mo id="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.3" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.3.cmml">′</mo></msup></mrow><mo stretchy="false" id="S3.E12.1.m1.4.4.1.1.2.1.1.3" xref="S3.E12.1.m1.4.4.1.1.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="S3.E12.1.m1.4.4.1.2" xref="S3.E12.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.1.m1.4b"><apply id="S3.E12.1.m1.4.4.1.1.cmml" xref="S3.E12.1.m1.4.4.1"><leq id="S3.E12.1.m1.4.4.1.1.3.cmml" xref="S3.E12.1.m1.4.4.1.1.3"></leq><apply id="S3.E12.1.m1.4.4.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1"><abs id="S3.E12.1.m1.4.4.1.1.1.2.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.2"></abs><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1"><minus id="S3.E12.1.m1.4.4.1.1.1.1.1.4.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.4"></minus><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1"><times id="S3.E12.1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.2"></times><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.2">ℒ</ci><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.2">𝒟</ci><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1"><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1"><times id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.3">ℎ</ci><list id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E12.1.m1.1.1.cmml" xref="S3.E12.1.m1.1.1">𝜑</ci><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="S3.E12.1.m1.2.2.cmml" xref="S3.E12.1.m1.2.2">𝜉</ci></interval></apply><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3"><times id="S3.E12.1.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.3"></times><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.2">ℒ</ci><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.2">𝒟</ci><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.4.3.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2"><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1"><times id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.2"></times><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.3">ℎ</ci><list id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1"><ci id="S3.E12.1.m1.3.3.cmml" xref="S3.E12.1.m1.3.3">𝜑</ci><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2">superscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.2">𝜉</ci><ci id="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E12.1.m1.4.4.1.1.1.1.1.3.2.2.2.3">′</ci></apply></interval></apply></apply></apply><apply id="S3.E12.1.m1.4.4.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.2"><times id="S3.E12.1.m1.4.4.1.1.2.2.cmml" xref="S3.E12.1.m1.4.4.1.1.2.2"></times><apply id="S3.E12.1.m1.4.4.1.1.2.3.cmml" xref="S3.E12.1.m1.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.2.3.1.cmml" xref="S3.E12.1.m1.4.4.1.1.2.3">subscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.2.3.2.cmml" xref="S3.E12.1.m1.4.4.1.1.2.3.2">𝐿</ci><ci id="S3.E12.1.m1.4.4.1.1.2.3.3.cmml" xref="S3.E12.1.m1.4.4.1.1.2.3.3">𝜉</ci></apply><apply id="S3.E12.1.m1.4.4.1.1.2.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1"><csymbol cd="latexml" id="S3.E12.1.m1.4.4.1.1.2.1.2.1.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1.2">norm</csymbol><apply id="S3.E12.1.m1.4.4.1.1.2.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1"><minus id="S3.E12.1.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.1"></minus><ci id="S3.E12.1.m1.4.4.1.1.2.1.1.1.2.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.2">𝜉</ci><apply id="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.1.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.3">superscript</csymbol><ci id="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.2.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.2">𝜉</ci><ci id="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.3.cmml" xref="S3.E12.1.m1.4.4.1.1.2.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.1.m1.4c">|\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi;z_{i}),\xi)-\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi;z_{i}),\xi^{\prime})|\leq L_{\xi}\|\xi-\xi^{\prime}\|,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12a)</span></td>
</tr>
<tr id="S3.E12.2" class="ltx_eqn_row"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr id="S3.E12.2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12.2X.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle|\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi;z_{i}),\xi)-\mathcal{L}_{\mathcal{D}_{i}}(h^{\prime}(\varphi;z_{i}),\xi)|" display="inline"><semantics id="S3.E12.2X.2.1.1.m1.5a"><mrow id="S3.E12.2X.2.1.1.m1.5.5.1" xref="S3.E12.2X.2.1.1.m1.5.5.2.cmml"><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.2.1.cmml">|</mo><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.cmml"><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.cmml"><msub id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.2.cmml">ℒ</mi><msub id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.2.cmml">(</mo><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.2X.2.1.1.m1.1.1" xref="S3.E12.2X.2.1.1.m1.1.1.cmml">φ</mi><mo id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.4" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E12.2X.2.1.1.m1.2.2" xref="S3.E12.2X.2.1.1.m1.2.2.cmml">ξ</mi><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.4" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.2X.2.1.1.m1.5.5.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.3.cmml">−</mo><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.cmml"><msub id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.2.cmml">ℒ</mi><msub id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.2.cmml">𝒟</mi><mi id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.2.cmml">​</mo><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.2.cmml">(</mo><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.cmml"><msup id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.cmml"><mi id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.cmml">h</mi><mo id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.2X.2.1.1.m1.3.3" xref="S3.E12.2X.2.1.1.m1.3.3.cmml">φ</mi><mo id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.2" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.4" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.2.cmml">,</mo><mi id="S3.E12.2X.2.1.1.m1.4.4" xref="S3.E12.2X.2.1.1.m1.4.4.cmml">ξ</mi><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.4" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E12.2X.2.1.1.m1.5.5.1.3" xref="S3.E12.2X.2.1.1.m1.5.5.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.2X.2.1.1.m1.5b"><apply id="S3.E12.2X.2.1.1.m1.5.5.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1"><abs id="S3.E12.2X.2.1.1.m1.5.5.2.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.2"></abs><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1"><minus id="S3.E12.2X.2.1.1.m1.5.5.1.1.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.3"></minus><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1"><times id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.2"></times><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.2">ℒ</ci><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3">subscript</csymbol><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.2">𝒟</ci><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.3.3.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1"><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1"><times id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.2"></times><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.3">ℎ</ci><list id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1"><ci id="S3.E12.2X.2.1.1.m1.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.1.1">𝜑</ci><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="S3.E12.2X.2.1.1.m1.2.2.cmml" xref="S3.E12.2X.2.1.1.m1.2.2">𝜉</ci></interval></apply><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2"><times id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.2"></times><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.2">ℒ</ci><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3">subscript</csymbol><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.2">𝒟</ci><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.3.3.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1"><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1"><times id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.2"></times><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3">superscript</csymbol><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2">ℎ</ci><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.3.3">′</ci></apply><list id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1"><ci id="S3.E12.2X.2.1.1.m1.3.3.cmml" xref="S3.E12.2X.2.1.1.m1.3.3">𝜑</ci><apply id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E12.2X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="S3.E12.2X.2.1.1.m1.4.4.cmml" xref="S3.E12.2X.2.1.1.m1.4.4">𝜉</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.2X.2.1.1.m1.5c">\displaystyle|\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi;z_{i}),\xi)-\mathcal{L}_{\mathcal{D}_{i}}(h^{\prime}(\varphi;z_{i}),\xi)|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12b)</span></td>
</tr>
<tr id="S3.E12.2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12.2Xa.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\leq L_{h}\|h(\varphi;z_{i})-h^{\prime}(\varphi;z_{i})\|," display="inline"><semantics id="S3.E12.2Xa.2.1.1.m1.3a"><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.cmml"><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.3.cmml"></mi><mo id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.2.cmml">≤</mo><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.cmml"><msub id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.cmml"><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.2.cmml">L</mi><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.2Xa.2.1.1.m1.1.1" xref="S3.E12.2Xa.2.1.1.m1.1.1.cmml">φ</mi><mo id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><msup id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">h</mi><mo id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.2.cmml">(</mo><mi id="S3.E12.2Xa.2.1.1.m1.2.2" xref="S3.E12.2Xa.2.1.1.m1.2.2.cmml">φ</mi><mo id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.2.cmml">;</mo><msub id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml">z</mi><mi id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.4" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="S3.E12.2Xa.2.1.1.m1.3.3.1.2" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.2Xa.2.1.1.m1.3b"><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1"><leq id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.2"></leq><csymbol cd="latexml" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.3">absent</csymbol><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1"><times id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.2"></times><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.2">𝐿</ci><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.3.3">ℎ</ci></apply><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.2">norm</csymbol><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1"><minus id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3"></minus><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1"><times id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">ℎ</ci><list id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1"><ci id="S3.E12.2Xa.2.1.1.m1.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.1.1">𝜑</ci><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2"><times id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.2"></times><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.2">ℎ</ci><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.3">′</ci></apply><list id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1"><ci id="S3.E12.2Xa.2.1.1.m1.2.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.2.2">𝜑</ci><apply id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.2">𝑧</ci><ci id="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E12.2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.2Xa.2.1.1.m1.3c">\displaystyle\leq L_{h}\|h(\varphi;z_{i})-h^{\prime}(\varphi;z_{i})\|,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E12.3" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center" colspan="2"><math id="S3.E12.3.m1.2" class="ltx_Math" alttext="\|h(\varphi;z_{i})-h(\varphi^{\prime};z_{i})\|\leq L_{\varphi}\|\varphi-\varphi^{\prime}\|," display="block"><semantics id="S3.E12.3.m1.2a"><mrow id="S3.E12.3.m1.2.2.1" xref="S3.E12.3.m1.2.2.1.1.cmml"><mrow id="S3.E12.3.m1.2.2.1.1" xref="S3.E12.3.m1.2.2.1.1.cmml"><mrow id="S3.E12.3.m1.2.2.1.1.1.1" xref="S3.E12.3.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.3.m1.2.2.1.1.1.1.2" xref="S3.E12.3.m1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E12.3.m1.2.2.1.1.1.1.1" xref="S3.E12.3.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E12.3.m1.2.2.1.1.1.1.1.1" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E12.3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E12.3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.3.m1.1.1" xref="S3.E12.3.m1.1.1.cmml">φ</mi><mo id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.3.m1.2.2.1.1.1.1.1.4" xref="S3.E12.3.m1.2.2.1.1.1.1.1.4.cmml">−</mo><mrow id="S3.E12.3.m1.2.2.1.1.1.1.1.3" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E12.3.m1.2.2.1.1.1.1.1.3.4" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E12.3.m1.2.2.1.1.1.1.1.3.3" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.3.cmml">​</mo><mrow id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.3.cmml"><mo stretchy="false" id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.3" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.3.cmml">(</mo><msup id="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1" xref="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.2" xref="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.2.cmml">φ</mi><mo id="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.3" xref="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.3.cmml">′</mo></msup><mo id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.4" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.3.cmml">;</mo><msub id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.2" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.2.cmml">z</mi><mi id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.3" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.5" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E12.3.m1.2.2.1.1.1.1.3" xref="S3.E12.3.m1.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E12.3.m1.2.2.1.1.3" xref="S3.E12.3.m1.2.2.1.1.3.cmml">≤</mo><mrow id="S3.E12.3.m1.2.2.1.1.2" xref="S3.E12.3.m1.2.2.1.1.2.cmml"><msub id="S3.E12.3.m1.2.2.1.1.2.3" xref="S3.E12.3.m1.2.2.1.1.2.3.cmml"><mi id="S3.E12.3.m1.2.2.1.1.2.3.2" xref="S3.E12.3.m1.2.2.1.1.2.3.2.cmml">L</mi><mi id="S3.E12.3.m1.2.2.1.1.2.3.3" xref="S3.E12.3.m1.2.2.1.1.2.3.3.cmml">φ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.3.m1.2.2.1.1.2.2" xref="S3.E12.3.m1.2.2.1.1.2.2.cmml">​</mo><mrow id="S3.E12.3.m1.2.2.1.1.2.1.1" xref="S3.E12.3.m1.2.2.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E12.3.m1.2.2.1.1.2.1.1.2" xref="S3.E12.3.m1.2.2.1.1.2.1.2.1.cmml">‖</mo><mrow id="S3.E12.3.m1.2.2.1.1.2.1.1.1" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S3.E12.3.m1.2.2.1.1.2.1.1.1.2" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.2.cmml">φ</mi><mo id="S3.E12.3.m1.2.2.1.1.2.1.1.1.1" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.1.cmml">−</mo><msup id="S3.E12.3.m1.2.2.1.1.2.1.1.1.3" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.cmml"><mi id="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.2" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.2.cmml">φ</mi><mo id="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.3" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.3.cmml">′</mo></msup></mrow><mo stretchy="false" id="S3.E12.3.m1.2.2.1.1.2.1.1.3" xref="S3.E12.3.m1.2.2.1.1.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="S3.E12.3.m1.2.2.1.2" xref="S3.E12.3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.3.m1.2b"><apply id="S3.E12.3.m1.2.2.1.1.cmml" xref="S3.E12.3.m1.2.2.1"><leq id="S3.E12.3.m1.2.2.1.1.3.cmml" xref="S3.E12.3.m1.2.2.1.1.3"></leq><apply id="S3.E12.3.m1.2.2.1.1.1.2.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E12.3.m1.2.2.1.1.1.2.1.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.2">norm</csymbol><apply id="S3.E12.3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1"><minus id="S3.E12.3.m1.2.2.1.1.1.1.1.4.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.4"></minus><apply id="S3.E12.3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1"><times id="S3.E12.3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S3.E12.3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.3">ℎ</ci><list id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1"><ci id="S3.E12.3.m1.1.1.cmml" xref="S3.E12.3.m1.1.1">𝜑</ci><apply id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S3.E12.3.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3"><times id="S3.E12.3.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.3"></times><ci id="S3.E12.3.m1.2.2.1.1.1.1.1.3.4.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.4">ℎ</ci><list id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2"><apply id="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1">superscript</csymbol><ci id="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.2">𝜑</ci><ci id="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.2.1.1.1.3">′</ci></apply><apply id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.2">𝑧</ci><ci id="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E12.3.m1.2.2.1.1.1.1.1.3.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply><apply id="S3.E12.3.m1.2.2.1.1.2.cmml" xref="S3.E12.3.m1.2.2.1.1.2"><times id="S3.E12.3.m1.2.2.1.1.2.2.cmml" xref="S3.E12.3.m1.2.2.1.1.2.2"></times><apply id="S3.E12.3.m1.2.2.1.1.2.3.cmml" xref="S3.E12.3.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.3.m1.2.2.1.1.2.3.1.cmml" xref="S3.E12.3.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E12.3.m1.2.2.1.1.2.3.2.cmml" xref="S3.E12.3.m1.2.2.1.1.2.3.2">𝐿</ci><ci id="S3.E12.3.m1.2.2.1.1.2.3.3.cmml" xref="S3.E12.3.m1.2.2.1.1.2.3.3">𝜑</ci></apply><apply id="S3.E12.3.m1.2.2.1.1.2.1.2.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1"><csymbol cd="latexml" id="S3.E12.3.m1.2.2.1.1.2.1.2.1.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1.2">norm</csymbol><apply id="S3.E12.3.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1"><minus id="S3.E12.3.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.1"></minus><ci id="S3.E12.3.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.2">𝜑</ci><apply id="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.1.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.3">superscript</csymbol><ci id="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.2.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.2">𝜑</ci><ci id="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.3.cmml" xref="S3.E12.3.m1.2.2.1.1.2.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.3.m1.2c">\|h(\varphi;z_{i})-h(\varphi^{\prime};z_{i})\|\leq L_{\varphi}\|\varphi-\varphi^{\prime}\|,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12c)</span></td>
</tr>
<tr id="S3.E12.4" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center" colspan="2"><math id="S3.E12.4.m1.3" class="ltx_Math" alttext="\|h(\varphi;z_{i})-h(\varphi;z_{i}^{\prime})\|\leq L_{z}\|z_{i}-z_{i}^{\prime}\|." display="block"><semantics id="S3.E12.4.m1.3a"><mrow id="S3.E12.4.m1.3.3.1" xref="S3.E12.4.m1.3.3.1.1.cmml"><mrow id="S3.E12.4.m1.3.3.1.1" xref="S3.E12.4.m1.3.3.1.1.cmml"><mrow id="S3.E12.4.m1.3.3.1.1.1.1" xref="S3.E12.4.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.4.m1.3.3.1.1.1.1.2" xref="S3.E12.4.m1.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E12.4.m1.3.3.1.1.1.1.1" xref="S3.E12.4.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.E12.4.m1.3.3.1.1.1.1.1.1" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E12.4.m1.3.3.1.1.1.1.1.1.3" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E12.4.m1.3.3.1.1.1.1.1.1.2" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.4.m1.1.1" xref="S3.E12.4.m1.1.1.cmml">φ</mi><mo id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.4.m1.3.3.1.1.1.1.1.3" xref="S3.E12.4.m1.3.3.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E12.4.m1.3.3.1.1.1.1.1.2" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E12.4.m1.3.3.1.1.1.1.1.2.3" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E12.4.m1.3.3.1.1.1.1.1.2.2" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.2" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.2.cmml">(</mo><mi id="S3.E12.4.m1.2.2" xref="S3.E12.4.m1.2.2.cmml">φ</mi><mo id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.3" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.2.cmml">;</mo><msubsup id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.2.cmml">z</mi><mi id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.3" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.3.cmml">i</mi><mo id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.3" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.4" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E12.4.m1.3.3.1.1.1.1.3" xref="S3.E12.4.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E12.4.m1.3.3.1.1.3" xref="S3.E12.4.m1.3.3.1.1.3.cmml">≤</mo><mrow id="S3.E12.4.m1.3.3.1.1.2" xref="S3.E12.4.m1.3.3.1.1.2.cmml"><msub id="S3.E12.4.m1.3.3.1.1.2.3" xref="S3.E12.4.m1.3.3.1.1.2.3.cmml"><mi id="S3.E12.4.m1.3.3.1.1.2.3.2" xref="S3.E12.4.m1.3.3.1.1.2.3.2.cmml">L</mi><mi id="S3.E12.4.m1.3.3.1.1.2.3.3" xref="S3.E12.4.m1.3.3.1.1.2.3.3.cmml">z</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.4.m1.3.3.1.1.2.2" xref="S3.E12.4.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S3.E12.4.m1.3.3.1.1.2.1.1" xref="S3.E12.4.m1.3.3.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E12.4.m1.3.3.1.1.2.1.1.2" xref="S3.E12.4.m1.3.3.1.1.2.1.2.1.cmml">‖</mo><mrow id="S3.E12.4.m1.3.3.1.1.2.1.1.1" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.cmml"><msub id="S3.E12.4.m1.3.3.1.1.2.1.1.1.2" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.cmml"><mi id="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.2" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.2.cmml">z</mi><mi id="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.3" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E12.4.m1.3.3.1.1.2.1.1.1.1" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.1.cmml">−</mo><msubsup id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.cmml"><mi id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.2" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.2.cmml">z</mi><mi id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.3" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.3.cmml">i</mi><mo id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.3" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.3.cmml">′</mo></msubsup></mrow><mo stretchy="false" id="S3.E12.4.m1.3.3.1.1.2.1.1.3" xref="S3.E12.4.m1.3.3.1.1.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E12.4.m1.3.3.1.2" xref="S3.E12.4.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.4.m1.3b"><apply id="S3.E12.4.m1.3.3.1.1.cmml" xref="S3.E12.4.m1.3.3.1"><leq id="S3.E12.4.m1.3.3.1.1.3.cmml" xref="S3.E12.4.m1.3.3.1.1.3"></leq><apply id="S3.E12.4.m1.3.3.1.1.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E12.4.m1.3.3.1.1.1.2.1.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="S3.E12.4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1"><minus id="S3.E12.4.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.3"></minus><apply id="S3.E12.4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1"><times id="S3.E12.4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.2"></times><ci id="S3.E12.4.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.3">ℎ</ci><list id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1"><ci id="S3.E12.4.m1.1.1.cmml" xref="S3.E12.4.m1.1.1">𝜑</ci><apply id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S3.E12.4.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2"><times id="S3.E12.4.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.2"></times><ci id="S3.E12.4.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.3">ℎ</ci><list id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1"><ci id="S3.E12.4.m1.2.2.cmml" xref="S3.E12.4.m1.2.2">𝜑</ci><apply id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1">superscript</csymbol><apply id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.2">𝑧</ci><ci id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E12.4.m1.3.3.1.1.1.1.1.2.1.1.1.3">′</ci></apply></list></apply></apply></apply><apply id="S3.E12.4.m1.3.3.1.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.2"><times id="S3.E12.4.m1.3.3.1.1.2.2.cmml" xref="S3.E12.4.m1.3.3.1.1.2.2"></times><apply id="S3.E12.4.m1.3.3.1.1.2.3.cmml" xref="S3.E12.4.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.4.m1.3.3.1.1.2.3.1.cmml" xref="S3.E12.4.m1.3.3.1.1.2.3">subscript</csymbol><ci id="S3.E12.4.m1.3.3.1.1.2.3.2.cmml" xref="S3.E12.4.m1.3.3.1.1.2.3.2">𝐿</ci><ci id="S3.E12.4.m1.3.3.1.1.2.3.3.cmml" xref="S3.E12.4.m1.3.3.1.1.2.3.3">𝑧</ci></apply><apply id="S3.E12.4.m1.3.3.1.1.2.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="S3.E12.4.m1.3.3.1.1.2.1.2.1.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.2">norm</csymbol><apply id="S3.E12.4.m1.3.3.1.1.2.1.1.1.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1"><minus id="S3.E12.4.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.1"></minus><apply id="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.1.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.2">subscript</csymbol><ci id="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.2.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.2">𝑧</ci><ci id="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.3.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.1.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3">superscript</csymbol><apply id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.1.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.2.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.2">𝑧</ci><ci id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.3.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.3.cmml" xref="S3.E12.4.m1.3.3.1.1.2.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.4.m1.3c">\|h(\varphi;z_{i})-h(\varphi;z_{i}^{\prime})\|\leq L_{z}\|z_{i}-z_{i}^{\prime}\|.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12d)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS4.p4" class="ltx_para ltx_noindent">
<p id="S3.SS4.p4.9" class="ltx_p"><span id="S3.SS4.p4.9.10" class="ltx_text ltx_font_bold">Theorem 1</span>
<em id="S3.SS4.p4.9.9" class="ltx_emph ltx_font_italic">Suppose <math id="S3.SS4.p4.1.1.m1.4" class="ltx_Math" alttext="{\mathcal{\hat{D}}}_{1},{\mathcal{\hat{D}}}_{2},\cdots,{\mathcal{\hat{D}}}_{N}" display="inline"><semantics id="S3.SS4.p4.1.1.m1.4a"><mrow id="S3.SS4.p4.1.1.m1.4.4.3" xref="S3.SS4.p4.1.1.m1.4.4.4.cmml"><msub id="S3.SS4.p4.1.1.m1.2.2.1.1" xref="S3.SS4.p4.1.1.m1.2.2.1.1.cmml"><mover accent="true" id="S3.SS4.p4.1.1.m1.2.2.1.1.2" xref="S3.SS4.p4.1.1.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.1.1.m1.2.2.1.1.2.2" xref="S3.SS4.p4.1.1.m1.2.2.1.1.2.2.cmml">𝒟</mi><mo id="S3.SS4.p4.1.1.m1.2.2.1.1.2.1" xref="S3.SS4.p4.1.1.m1.2.2.1.1.2.1.cmml">^</mo></mover><mn id="S3.SS4.p4.1.1.m1.2.2.1.1.3" xref="S3.SS4.p4.1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p4.1.1.m1.4.4.3.4" xref="S3.SS4.p4.1.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS4.p4.1.1.m1.3.3.2.2" xref="S3.SS4.p4.1.1.m1.3.3.2.2.cmml"><mover accent="true" id="S3.SS4.p4.1.1.m1.3.3.2.2.2" xref="S3.SS4.p4.1.1.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.1.1.m1.3.3.2.2.2.2" xref="S3.SS4.p4.1.1.m1.3.3.2.2.2.2.cmml">𝒟</mi><mo id="S3.SS4.p4.1.1.m1.3.3.2.2.2.1" xref="S3.SS4.p4.1.1.m1.3.3.2.2.2.1.cmml">^</mo></mover><mn id="S3.SS4.p4.1.1.m1.3.3.2.2.3" xref="S3.SS4.p4.1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.p4.1.1.m1.4.4.3.5" xref="S3.SS4.p4.1.1.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p4.1.1.m1.1.1" xref="S3.SS4.p4.1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS4.p4.1.1.m1.4.4.3.6" xref="S3.SS4.p4.1.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS4.p4.1.1.m1.4.4.3.3" xref="S3.SS4.p4.1.1.m1.4.4.3.3.cmml"><mover accent="true" id="S3.SS4.p4.1.1.m1.4.4.3.3.2" xref="S3.SS4.p4.1.1.m1.4.4.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.1.1.m1.4.4.3.3.2.2" xref="S3.SS4.p4.1.1.m1.4.4.3.3.2.2.cmml">𝒟</mi><mo id="S3.SS4.p4.1.1.m1.4.4.3.3.2.1" xref="S3.SS4.p4.1.1.m1.4.4.3.3.2.1.cmml">^</mo></mover><mi id="S3.SS4.p4.1.1.m1.4.4.3.3.3" xref="S3.SS4.p4.1.1.m1.4.4.3.3.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.1.m1.4b"><list id="S3.SS4.p4.1.1.m1.4.4.4.cmml" xref="S3.SS4.p4.1.1.m1.4.4.3"><apply id="S3.SS4.p4.1.1.m1.2.2.1.1.cmml" xref="S3.SS4.p4.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.1.m1.2.2.1.1.1.cmml" xref="S3.SS4.p4.1.1.m1.2.2.1.1">subscript</csymbol><apply id="S3.SS4.p4.1.1.m1.2.2.1.1.2.cmml" xref="S3.SS4.p4.1.1.m1.2.2.1.1.2"><ci id="S3.SS4.p4.1.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS4.p4.1.1.m1.2.2.1.1.2.1">^</ci><ci id="S3.SS4.p4.1.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS4.p4.1.1.m1.2.2.1.1.2.2">𝒟</ci></apply><cn type="integer" id="S3.SS4.p4.1.1.m1.2.2.1.1.3.cmml" xref="S3.SS4.p4.1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S3.SS4.p4.1.1.m1.3.3.2.2.cmml" xref="S3.SS4.p4.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.1.1.m1.3.3.2.2.1.cmml" xref="S3.SS4.p4.1.1.m1.3.3.2.2">subscript</csymbol><apply id="S3.SS4.p4.1.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.p4.1.1.m1.3.3.2.2.2"><ci id="S3.SS4.p4.1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS4.p4.1.1.m1.3.3.2.2.2.1">^</ci><ci id="S3.SS4.p4.1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS4.p4.1.1.m1.3.3.2.2.2.2">𝒟</ci></apply><cn type="integer" id="S3.SS4.p4.1.1.m1.3.3.2.2.3.cmml" xref="S3.SS4.p4.1.1.m1.3.3.2.2.3">2</cn></apply><ci id="S3.SS4.p4.1.1.m1.1.1.cmml" xref="S3.SS4.p4.1.1.m1.1.1">⋯</ci><apply id="S3.SS4.p4.1.1.m1.4.4.3.3.cmml" xref="S3.SS4.p4.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.1.m1.4.4.3.3.1.cmml" xref="S3.SS4.p4.1.1.m1.4.4.3.3">subscript</csymbol><apply id="S3.SS4.p4.1.1.m1.4.4.3.3.2.cmml" xref="S3.SS4.p4.1.1.m1.4.4.3.3.2"><ci id="S3.SS4.p4.1.1.m1.4.4.3.3.2.1.cmml" xref="S3.SS4.p4.1.1.m1.4.4.3.3.2.1">^</ci><ci id="S3.SS4.p4.1.1.m1.4.4.3.3.2.2.cmml" xref="S3.SS4.p4.1.1.m1.4.4.3.3.2.2">𝒟</ci></apply><ci id="S3.SS4.p4.1.1.m1.4.4.3.3.3.cmml" xref="S3.SS4.p4.1.1.m1.4.4.3.3.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.1.m1.4c">{\mathcal{\hat{D}}}_{1},{\mathcal{\hat{D}}}_{2},\cdots,{\mathcal{\hat{D}}}_{N}</annotation></semantics></math> denote the empirical data distribution of <math id="S3.SS4.p4.2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS4.p4.2.2.m2.1a"><mi id="S3.SS4.p4.2.2.m2.1.1" xref="S3.SS4.p4.2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.2.m2.1b"><ci id="S3.SS4.p4.2.2.m2.1.1.cmml" xref="S3.SS4.p4.2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.2.m2.1c">N</annotation></semantics></math> clients with <math id="S3.SS4.p4.3.3.m3.1" class="ltx_Math" alttext="\hat{\varphi}" display="inline"><semantics id="S3.SS4.p4.3.3.m3.1a"><mover accent="true" id="S3.SS4.p4.3.3.m3.1.1" xref="S3.SS4.p4.3.3.m3.1.1.cmml"><mi id="S3.SS4.p4.3.3.m3.1.1.2" xref="S3.SS4.p4.3.3.m3.1.1.2.cmml">φ</mi><mo id="S3.SS4.p4.3.3.m3.1.1.1" xref="S3.SS4.p4.3.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.3.m3.1b"><apply id="S3.SS4.p4.3.3.m3.1.1.cmml" xref="S3.SS4.p4.3.3.m3.1.1"><ci id="S3.SS4.p4.3.3.m3.1.1.1.cmml" xref="S3.SS4.p4.3.3.m3.1.1.1">^</ci><ci id="S3.SS4.p4.3.3.m3.1.1.2.cmml" xref="S3.SS4.p4.3.3.m3.1.1.2">𝜑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.3.m3.1c">\hat{\varphi}</annotation></semantics></math>, <math id="S3.SS4.p4.4.4.m4.1" class="ltx_Math" alttext="\hat{z}_{i}" display="inline"><semantics id="S3.SS4.p4.4.4.m4.1a"><msub id="S3.SS4.p4.4.4.m4.1.1" xref="S3.SS4.p4.4.4.m4.1.1.cmml"><mover accent="true" id="S3.SS4.p4.4.4.m4.1.1.2" xref="S3.SS4.p4.4.4.m4.1.1.2.cmml"><mi id="S3.SS4.p4.4.4.m4.1.1.2.2" xref="S3.SS4.p4.4.4.m4.1.1.2.2.cmml">z</mi><mo id="S3.SS4.p4.4.4.m4.1.1.2.1" xref="S3.SS4.p4.4.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p4.4.4.m4.1.1.3" xref="S3.SS4.p4.4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.4.m4.1b"><apply id="S3.SS4.p4.4.4.m4.1.1.cmml" xref="S3.SS4.p4.4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.4.4.m4.1.1.1.cmml" xref="S3.SS4.p4.4.4.m4.1.1">subscript</csymbol><apply id="S3.SS4.p4.4.4.m4.1.1.2.cmml" xref="S3.SS4.p4.4.4.m4.1.1.2"><ci id="S3.SS4.p4.4.4.m4.1.1.2.1.cmml" xref="S3.SS4.p4.4.4.m4.1.1.2.1">^</ci><ci id="S3.SS4.p4.4.4.m4.1.1.2.2.cmml" xref="S3.SS4.p4.4.4.m4.1.1.2.2">𝑧</ci></apply><ci id="S3.SS4.p4.4.4.m4.1.1.3.cmml" xref="S3.SS4.p4.4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.4.m4.1c">\hat{z}_{i}</annotation></semantics></math>, <math id="S3.SS4.p4.5.5.m5.1" class="ltx_Math" alttext="\hat{\xi}" display="inline"><semantics id="S3.SS4.p4.5.5.m5.1a"><mover accent="true" id="S3.SS4.p4.5.5.m5.1.1" xref="S3.SS4.p4.5.5.m5.1.1.cmml"><mi id="S3.SS4.p4.5.5.m5.1.1.2" xref="S3.SS4.p4.5.5.m5.1.1.2.cmml">ξ</mi><mo id="S3.SS4.p4.5.5.m5.1.1.1" xref="S3.SS4.p4.5.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.5.m5.1b"><apply id="S3.SS4.p4.5.5.m5.1.1.cmml" xref="S3.SS4.p4.5.5.m5.1.1"><ci id="S3.SS4.p4.5.5.m5.1.1.1.cmml" xref="S3.SS4.p4.5.5.m5.1.1.1">^</ci><ci id="S3.SS4.p4.5.5.m5.1.1.2.cmml" xref="S3.SS4.p4.5.5.m5.1.1.2">𝜉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.5.m5.1c">\hat{\xi}</annotation></semantics></math> the parameters learnt by the corresponding empirical distributions. Denote <math id="S3.SS4.p4.6.6.m6.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S3.SS4.p4.6.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.6.6.m6.1.1" xref="S3.SS4.p4.6.6.m6.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.6.m6.1b"><ci id="S3.SS4.p4.6.6.m6.1.1.cmml" xref="S3.SS4.p4.6.6.m6.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.6.6.m6.1c">\mathcal{H}</annotation></semantics></math> as the personalized hypothesis and <math id="S3.SS4.p4.7.7.m7.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS4.p4.7.7.m7.1a"><mi id="S3.SS4.p4.7.7.m7.1.1" xref="S3.SS4.p4.7.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.7.7.m7.1b"><ci id="S3.SS4.p4.7.7.m7.1.1.cmml" xref="S3.SS4.p4.7.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.7.7.m7.1c">d</annotation></semantics></math> be the VC-dimension of <math id="S3.SS4.p4.8.8.m8.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S3.SS4.p4.8.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.8.8.m8.1.1" xref="S3.SS4.p4.8.8.m8.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.8.8.m8.1b"><ci id="S3.SS4.p4.8.8.m8.1.1.cmml" xref="S3.SS4.p4.8.8.m8.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.8.8.m8.1c">\mathcal{H}</annotation></semantics></math>. Suppose Assumptions 1 and 2 hold, with probability at least <math id="S3.SS4.p4.9.9.m9.1" class="ltx_Math" alttext="1-\delta" display="inline"><semantics id="S3.SS4.p4.9.9.m9.1a"><mrow id="S3.SS4.p4.9.9.m9.1.1" xref="S3.SS4.p4.9.9.m9.1.1.cmml"><mn id="S3.SS4.p4.9.9.m9.1.1.2" xref="S3.SS4.p4.9.9.m9.1.1.2.cmml">1</mn><mo id="S3.SS4.p4.9.9.m9.1.1.1" xref="S3.SS4.p4.9.9.m9.1.1.1.cmml">−</mo><mi id="S3.SS4.p4.9.9.m9.1.1.3" xref="S3.SS4.p4.9.9.m9.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.9.9.m9.1b"><apply id="S3.SS4.p4.9.9.m9.1.1.cmml" xref="S3.SS4.p4.9.9.m9.1.1"><minus id="S3.SS4.p4.9.9.m9.1.1.1.cmml" xref="S3.SS4.p4.9.9.m9.1.1.1"></minus><cn type="integer" id="S3.SS4.p4.9.9.m9.1.1.2.cmml" xref="S3.SS4.p4.9.9.m9.1.1.2">1</cn><ci id="S3.SS4.p4.9.9.m9.1.1.3.cmml" xref="S3.SS4.p4.9.9.m9.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.9.9.m9.1c">1-\delta</annotation></semantics></math>, we have
</em></p>
<table id="S3.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\left|\sum_{i=1}^{N}\frac{m_{i}}{M}\mathcal{L}_{\hat{\mathcal{D}}_{i}}(h(\hat{\varphi};\hat{z_{i}}),\hat{\xi})-\sum_{i=1}^{N}\frac{m_{i}}{M}\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi^{*};z_{i}^{*}),\xi^{*})\right|" display="inline"><semantics id="S3.E13X.2.1.1.m1.4a"><mrow id="S3.E13X.2.1.1.m1.4.4.1" xref="S3.E13X.2.1.1.m1.4.4.2.cmml"><mo id="S3.E13X.2.1.1.m1.4.4.1.2" xref="S3.E13X.2.1.1.m1.4.4.2.1.cmml">|</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E13X.2.1.1.m1.4.4.1.1.1.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.cmml"><munderover id="S3.E13X.2.1.1.m1.4.4.1.1.1.2a" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.1.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.cmml"><mfrac id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3a" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.cmml"><msub id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.2.cmml">m</mi><mi id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.3.cmml">i</mi></msub><mi id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.3.cmml">M</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.2.cmml">​</mo><msub id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.2.cmml">ℒ</mi><msub id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.cmml"><mover accent="true" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.2.cmml">𝒟</mi><mo id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.1.cmml">^</mo></mover><mi id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.2a" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.2.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">(</mo><mover accent="true" id="S3.E13X.2.1.1.m1.1.1" xref="S3.E13X.2.1.1.m1.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.1.1.2" xref="S3.E13X.2.1.1.m1.1.1.2.cmml">φ</mi><mo id="S3.E13X.2.1.1.m1.1.1.1" xref="S3.E13X.2.1.1.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">;</mo><mover accent="true" id="S3.E13X.2.1.1.m1.2.2" xref="S3.E13X.2.1.1.m1.2.2.cmml"><msub id="S3.E13X.2.1.1.m1.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.cmml"><mi id="S3.E13X.2.1.1.m1.2.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.2.cmml">z</mi><mi id="S3.E13X.2.1.1.m1.2.2.2.3" xref="S3.E13X.2.1.1.m1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E13X.2.1.1.m1.2.2.1" xref="S3.E13X.2.1.1.m1.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.E13X.2.1.1.m1.3.3" xref="S3.E13X.2.1.1.m1.3.3.cmml"><mi id="S3.E13X.2.1.1.m1.3.3.2" xref="S3.E13X.2.1.1.m1.3.3.2.cmml">ξ</mi><mo id="S3.E13X.2.1.1.m1.3.3.1" xref="S3.E13X.2.1.1.m1.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.4" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E13X.2.1.1.m1.4.4.1.1.4" xref="S3.E13X.2.1.1.m1.4.4.1.1.4.cmml">−</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E13X.2.1.1.m1.4.4.1.1.3.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.cmml"><munderover id="S3.E13X.2.1.1.m1.4.4.1.1.3.3a" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.cmml"><mo movablelimits="false" id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.2.cmml">∑</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.1.cmml">=</mo><mn id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.3.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.cmml"><mfrac id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4a" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.cmml"><msub id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.2.cmml">m</mi><mi id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.3.cmml">i</mi></msub><mi id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.3.cmml">M</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.3.cmml">​</mo><msub id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.2.cmml">ℒ</mi><msub id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.2.cmml">𝒟</mi><mi id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.3a" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.3.cmml">​</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.3.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.3.cmml">(</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.4" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.3.cmml">​</mo><mrow id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.3.cmml">(</mo><msup id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml">φ</mi><mo id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.4" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.3.cmml">;</mo><msubsup id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.3.cmml">i</mi><mo id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.5" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.4" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.3.cmml">,</mo><msup id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.2" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.2.cmml">ξ</mi><mo id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.3" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.3.cmml">∗</mo></msup><mo stretchy="false" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.5" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E13X.2.1.1.m1.4.4.1.3" xref="S3.E13X.2.1.1.m1.4.4.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13X.2.1.1.m1.4b"><apply id="S3.E13X.2.1.1.m1.4.4.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1"><abs id="S3.E13X.2.1.1.m1.4.4.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.2"></abs><apply id="S3.E13X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1"><minus id="S3.E13X.2.1.1.m1.4.4.1.1.4.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.4"></minus><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1"><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2">superscript</csymbol><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2">subscript</csymbol><sum id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.2"></sum><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3"><eq id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.1"></eq><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1"><times id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.2"></times><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3"><divide id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3"></divide><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.2">𝑚</ci><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.2">ℒ</ci><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3">subscript</csymbol><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2"><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.1">^</ci><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.2.2">𝒟</ci></apply><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.4.3.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1"><apply id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1"><times id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"></times><ci id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.2">ℎ</ci><list id="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.2"><apply id="S3.E13X.2.1.1.m1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1"><ci id="S3.E13X.2.1.1.m1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1">^</ci><ci id="S3.E13X.2.1.1.m1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.2">𝜑</ci></apply><apply id="S3.E13X.2.1.1.m1.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2"><ci id="S3.E13X.2.1.1.m1.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.1">^</ci><apply id="S3.E13X.2.1.1.m1.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.2.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2">𝑧</ci><ci id="S3.E13X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.3">𝑖</ci></apply></apply></list></apply><apply id="S3.E13X.2.1.1.m1.3.3.cmml" xref="S3.E13X.2.1.1.m1.3.3"><ci id="S3.E13X.2.1.1.m1.3.3.1.cmml" xref="S3.E13X.2.1.1.m1.3.3.1">^</ci><ci id="S3.E13X.2.1.1.m1.3.3.2.cmml" xref="S3.E13X.2.1.1.m1.3.3.2">𝜉</ci></apply></interval></apply></apply><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3"><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3">superscript</csymbol><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3">subscript</csymbol><sum id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.2"></sum><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3"><eq id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.1"></eq><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.3.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.3.3">𝑁</ci></apply><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2"><times id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.3"></times><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4"><divide id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4"></divide><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.2">𝑚</ci><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.2.3">𝑖</ci></apply><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.4.3">𝑀</ci></apply><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.2">ℒ</ci><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.2">𝒟</ci><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.5.3.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2"><apply id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1"><times id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.3"></times><ci id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.4.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.4">ℎ</ci><list id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2"><apply id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.2">𝜑</ci><times id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.1.1.1.3"></times></apply><apply id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><times id="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.2.1.1.1.1.2.2.2.3"></times></apply></list></apply><apply id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2">superscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.2">𝜉</ci><times id="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.1.1.3.2.2.2.2.3"></times></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.2.1.1.m1.4c">\displaystyle\left|\sum_{i=1}^{N}\frac{m_{i}}{M}\mathcal{L}_{\hat{\mathcal{D}}_{i}}(h(\hat{\varphi};\hat{z_{i}}),\hat{\xi})-\sum_{i=1}^{N}\frac{m_{i}}{M}\mathcal{L}_{\mathcal{D}_{i}}(h(\varphi^{*};z_{i}^{*}),\xi^{*})\right|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
<tr id="S3.E13Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\leq\sqrt{\frac{M}{2}log\frac{N}{\delta}}+\sqrt{\frac{dN}{M}log\frac{eM}{d}}+L_{h}R_{h}(L_{\varphi}+L_{z})" display="inline"><semantics id="S3.E13Xa.2.1.1.m1.1a"><mrow id="S3.E13Xa.2.1.1.m1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.3" xref="S3.E13Xa.2.1.1.m1.1.1.3.cmml"></mi><mo id="S3.E13Xa.2.1.1.m1.1.1.2" xref="S3.E13Xa.2.1.1.m1.1.1.2.cmml">≤</mo><mrow id="S3.E13Xa.2.1.1.m1.1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.cmml"><msqrt id="S3.E13Xa.2.1.1.m1.1.1.1.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.cmml"><mrow id="S3.E13Xa.2.1.1.m1.1.1.1.3.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.cmml"><mfrac id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2a" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.2.cmml">M</mi><mn id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1.cmml">​</mo><mi id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1a" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1.cmml">​</mo><mi id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.4" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1b" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1.cmml">​</mo><mi id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.5" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1c" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1.cmml">​</mo><mstyle displaystyle="true" id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.cmml"><mfrac id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6a" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.2.cmml">N</mi><mi id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.3.cmml">δ</mi></mfrac></mstyle></mrow></msqrt><mo id="S3.E13Xa.2.1.1.m1.1.1.1.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.2.cmml">+</mo><msqrt id="S3.E13Xa.2.1.1.m1.1.1.1.4" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.cmml"><mrow id="S3.E13Xa.2.1.1.m1.1.1.1.4.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.cmml"><mstyle displaystyle="true" id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.cmml"><mfrac id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2a" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.cmml"><mrow id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.1.cmml">​</mo><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.3.cmml">N</mi></mrow><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.3.cmml">M</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1.cmml">​</mo><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1a" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1.cmml">​</mo><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.4" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1b" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1.cmml">​</mo><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.5" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1c" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1.cmml">​</mo><mstyle displaystyle="true" id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.cmml"><mfrac id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6a" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.cmml"><mrow id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.1.cmml">​</mo><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.3.cmml">M</mi></mrow><mi id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.3.cmml">d</mi></mfrac></mstyle></mrow></msqrt><mo id="S3.E13Xa.2.1.1.m1.1.1.1.2a" xref="S3.E13Xa.2.1.1.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E13Xa.2.1.1.m1.1.1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E13Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.3.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.3.2.cmml">L</mi><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.3.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.E13Xa.2.1.1.m1.1.1.1.1.4" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.4.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.4.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.4.2.cmml">R</mi><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.4.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.4.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.1.1.1.1.2a" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml">L</mi><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml">φ</mi></msub><mo id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">L</mi><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">z</mi></msub></mrow><mo stretchy="false" id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13Xa.2.1.1.m1.1b"><apply id="S3.E13Xa.2.1.1.m1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1"><leq id="S3.E13Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.2"></leq><csymbol cd="latexml" id="S3.E13Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.3">absent</csymbol><apply id="S3.E13Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1"><plus id="S3.E13Xa.2.1.1.m1.1.1.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.2"></plus><apply id="S3.E13Xa.2.1.1.m1.1.1.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3"><root id="S3.E13Xa.2.1.1.m1.1.1.1.3a.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3"></root><apply id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2"><times id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.1"></times><apply id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2"><divide id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2"></divide><ci id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.2">𝑀</ci><cn type="integer" id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.2.3">2</cn></apply><ci id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.3">𝑙</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.4.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.4">𝑜</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.5.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.5">𝑔</ci><apply id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6"><divide id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6"></divide><ci id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.2">𝑁</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.3.2.6.3">𝛿</ci></apply></apply></apply><apply id="S3.E13Xa.2.1.1.m1.1.1.1.4.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4"><root id="S3.E13Xa.2.1.1.m1.1.1.1.4a.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4"></root><apply id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2"><times id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.1"></times><apply id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2"><divide id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2"></divide><apply id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2"><times id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.1"></times><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.2">𝑑</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.2.3">𝑁</ci></apply><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.2.3">𝑀</ci></apply><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.3">𝑙</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.4.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.4">𝑜</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.5.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.5">𝑔</ci><apply id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6"><divide id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6"></divide><apply id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2"><times id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.1"></times><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.2">𝑒</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.2.3">𝑀</ci></apply><ci id="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.4.2.6.3">𝑑</ci></apply></apply></apply><apply id="S3.E13Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1"><times id="S3.E13Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.2"></times><apply id="S3.E13Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.3.2">𝐿</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.3.3">ℎ</ci></apply><apply id="S3.E13Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.1.1.1.1.4.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.4.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.4.2">𝑅</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.4.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.4.3">ℎ</ci></apply><apply id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1"><plus id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2">𝐿</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3">𝜑</ci></apply><apply id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2">𝐿</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3">𝑧</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13Xa.2.1.1.m1.1c">\displaystyle\leq\sqrt{\frac{M}{2}log\frac{N}{\delta}}+\sqrt{\frac{dN}{M}log\frac{eM}{d}}+L_{h}R_{h}(L_{\varphi}+L_{z})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E13Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle+L_{\xi}R_{t}," display="inline"><semantics id="S3.E13Xb.2.1.1.m1.1a"><mrow id="S3.E13Xb.2.1.1.m1.1.1.1" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E13Xb.2.1.1.m1.1.1.1.1" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.cmml"><mo id="S3.E13Xb.2.1.1.m1.1.1.1.1a" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.cmml">+</mo><mrow id="S3.E13Xb.2.1.1.m1.1.1.1.1.2" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.cmml"><msub id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.cmml"><mi id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.2" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.2.cmml">L</mi><mi id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.3" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.3.cmml">ξ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.1" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.cmml"><mi id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.2" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.2.cmml">R</mi><mi id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.3" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E13Xb.2.1.1.m1.1.1.1.2" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13Xb.2.1.1.m1.1b"><apply id="S3.E13Xb.2.1.1.m1.1.1.1.1.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1"><plus id="S3.E13Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1"></plus><apply id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2"><times id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.1"></times><apply id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.2">𝐿</ci><ci id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.2.3">𝜉</ci></apply><apply id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.1.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.2.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.2">𝑅</ci><ci id="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.3.cmml" xref="S3.E13Xb.2.1.1.m1.1.1.1.1.2.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13Xb.2.1.1.m1.1c">\displaystyle+L_{\xi}R_{t},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS4.p4.15" class="ltx_p"><em id="S3.SS4.p4.15.6" class="ltx_emph ltx_font_italic">where
<math id="S3.SS4.p4.10.1.m1.1" class="ltx_Math" alttext="\varphi^{*}" display="inline"><semantics id="S3.SS4.p4.10.1.m1.1a"><msup id="S3.SS4.p4.10.1.m1.1.1" xref="S3.SS4.p4.10.1.m1.1.1.cmml"><mi id="S3.SS4.p4.10.1.m1.1.1.2" xref="S3.SS4.p4.10.1.m1.1.1.2.cmml">φ</mi><mo id="S3.SS4.p4.10.1.m1.1.1.3" xref="S3.SS4.p4.10.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.10.1.m1.1b"><apply id="S3.SS4.p4.10.1.m1.1.1.cmml" xref="S3.SS4.p4.10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.10.1.m1.1.1.1.cmml" xref="S3.SS4.p4.10.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p4.10.1.m1.1.1.2.cmml" xref="S3.SS4.p4.10.1.m1.1.1.2">𝜑</ci><times id="S3.SS4.p4.10.1.m1.1.1.3.cmml" xref="S3.SS4.p4.10.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.10.1.m1.1c">\varphi^{*}</annotation></semantics></math>, <math id="S3.SS4.p4.11.2.m2.1" class="ltx_Math" alttext="z_{i}^{*}" display="inline"><semantics id="S3.SS4.p4.11.2.m2.1a"><msubsup id="S3.SS4.p4.11.2.m2.1.1" xref="S3.SS4.p4.11.2.m2.1.1.cmml"><mi id="S3.SS4.p4.11.2.m2.1.1.2.2" xref="S3.SS4.p4.11.2.m2.1.1.2.2.cmml">z</mi><mi id="S3.SS4.p4.11.2.m2.1.1.2.3" xref="S3.SS4.p4.11.2.m2.1.1.2.3.cmml">i</mi><mo id="S3.SS4.p4.11.2.m2.1.1.3" xref="S3.SS4.p4.11.2.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.11.2.m2.1b"><apply id="S3.SS4.p4.11.2.m2.1.1.cmml" xref="S3.SS4.p4.11.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.11.2.m2.1.1.1.cmml" xref="S3.SS4.p4.11.2.m2.1.1">superscript</csymbol><apply id="S3.SS4.p4.11.2.m2.1.1.2.cmml" xref="S3.SS4.p4.11.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.11.2.m2.1.1.2.1.cmml" xref="S3.SS4.p4.11.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p4.11.2.m2.1.1.2.2.cmml" xref="S3.SS4.p4.11.2.m2.1.1.2.2">𝑧</ci><ci id="S3.SS4.p4.11.2.m2.1.1.2.3.cmml" xref="S3.SS4.p4.11.2.m2.1.1.2.3">𝑖</ci></apply><times id="S3.SS4.p4.11.2.m2.1.1.3.cmml" xref="S3.SS4.p4.11.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.11.2.m2.1c">z_{i}^{*}</annotation></semantics></math>, and <math id="S3.SS4.p4.12.3.m3.1" class="ltx_Math" alttext="\xi^{*}" display="inline"><semantics id="S3.SS4.p4.12.3.m3.1a"><msup id="S3.SS4.p4.12.3.m3.1.1" xref="S3.SS4.p4.12.3.m3.1.1.cmml"><mi id="S3.SS4.p4.12.3.m3.1.1.2" xref="S3.SS4.p4.12.3.m3.1.1.2.cmml">ξ</mi><mo id="S3.SS4.p4.12.3.m3.1.1.3" xref="S3.SS4.p4.12.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.12.3.m3.1b"><apply id="S3.SS4.p4.12.3.m3.1.1.cmml" xref="S3.SS4.p4.12.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.12.3.m3.1.1.1.cmml" xref="S3.SS4.p4.12.3.m3.1.1">superscript</csymbol><ci id="S3.SS4.p4.12.3.m3.1.1.2.cmml" xref="S3.SS4.p4.12.3.m3.1.1.2">𝜉</ci><times id="S3.SS4.p4.12.3.m3.1.1.3.cmml" xref="S3.SS4.p4.12.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.12.3.m3.1c">\xi^{*}</annotation></semantics></math> represent the optimal parameters corresponding to the real distribution of each client, respectively; the size of the whole dataset is <math id="S3.SS4.p4.13.4.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS4.p4.13.4.m4.1a"><mi id="S3.SS4.p4.13.4.m4.1.1" xref="S3.SS4.p4.13.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.13.4.m4.1b"><ci id="S3.SS4.p4.13.4.m4.1.1.cmml" xref="S3.SS4.p4.13.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.13.4.m4.1c">M</annotation></semantics></math> with the local data size of client <math id="S3.SS4.p4.14.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p4.14.5.m5.1a"><mi id="S3.SS4.p4.14.5.m5.1.1" xref="S3.SS4.p4.14.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.14.5.m5.1b"><ci id="S3.SS4.p4.14.5.m5.1.1.cmml" xref="S3.SS4.p4.14.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.14.5.m5.1c">i</annotation></semantics></math> being <math id="S3.SS4.p4.15.6.m6.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="S3.SS4.p4.15.6.m6.1a"><msub id="S3.SS4.p4.15.6.m6.1.1" xref="S3.SS4.p4.15.6.m6.1.1.cmml"><mi id="S3.SS4.p4.15.6.m6.1.1.2" xref="S3.SS4.p4.15.6.m6.1.1.2.cmml">m</mi><mi id="S3.SS4.p4.15.6.m6.1.1.3" xref="S3.SS4.p4.15.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.15.6.m6.1b"><apply id="S3.SS4.p4.15.6.m6.1.1.cmml" xref="S3.SS4.p4.15.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.15.6.m6.1.1.1.cmml" xref="S3.SS4.p4.15.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p4.15.6.m6.1.1.2.cmml" xref="S3.SS4.p4.15.6.m6.1.1.2">𝑚</ci><ci id="S3.SS4.p4.15.6.m6.1.1.3.cmml" xref="S3.SS4.p4.15.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.15.6.m6.1c">m_{i}</annotation></semantics></math>.
</em></p>
</div>
<div id="S3.SS4.p5" class="ltx_para">
<p id="S3.SS4.p5.9" class="ltx_p">Theorem 1 indicates that the performance of the model trained on the empirical distribution is affected by the complexity of the hypothesis class <math id="S3.SS4.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S3.SS4.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><ci id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">\mathcal{H}</annotation></semantics></math> (expressed by its VC-dimension), the number of clients, the size of the whole datasets, and the Lipschitz constants.
<span id="S3.SS4.p5.9.8" class="ltx_text" style="color:#000000;"> The second part on the right-hand side of (<a href="#S3.E13" title="In III-D Generalization Bound ‣ III Federated learning by Transformer Personalization ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>) can be formulated as <math id="S3.SS4.p5.2.1.m1.1" class="ltx_Math" alttext="\sqrt{\frac{log(eM/d)}{M/dN}}" display="inline"><semantics id="S3.SS4.p5.2.1.m1.1a"><msqrt mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1" xref="S3.SS4.p5.2.1.m1.1.1.cmml"><mfrac mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1" xref="S3.SS4.p5.2.1.m1.1.1.1.cmml"><mrow id="S3.SS4.p5.2.1.m1.1.1.1.1.1" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.3" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.2" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.2.cmml">​</mo><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.4" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.2a" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.2.cmml">​</mo><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.5" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.2b" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.3.cmml">M</mi></mrow><mo mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.1.cmml">/</mo><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.3.cmml">d</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.SS4.p5.2.1.m1.1.1.1.3" xref="S3.SS4.p5.2.1.m1.1.1.1.3.cmml"><mrow id="S3.SS4.p5.2.1.m1.1.1.1.3.2" xref="S3.SS4.p5.2.1.m1.1.1.1.3.2.cmml"><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.3.2.2" xref="S3.SS4.p5.2.1.m1.1.1.1.3.2.2.cmml">M</mi><mo mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.3.2.1" xref="S3.SS4.p5.2.1.m1.1.1.1.3.2.1.cmml">/</mo><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.3.2.3" xref="S3.SS4.p5.2.1.m1.1.1.1.3.2.3.cmml">d</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p5.2.1.m1.1.1.1.3.1" xref="S3.SS4.p5.2.1.m1.1.1.1.3.1.cmml">​</mo><mi mathcolor="#000000" id="S3.SS4.p5.2.1.m1.1.1.1.3.3" xref="S3.SS4.p5.2.1.m1.1.1.1.3.3.cmml">N</mi></mrow></mfrac></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.1.m1.1b"><apply id="S3.SS4.p5.2.1.m1.1.1.cmml" xref="S3.SS4.p5.2.1.m1.1.1"><root id="S3.SS4.p5.2.1.m1.1.1a.cmml" xref="S3.SS4.p5.2.1.m1.1.1"></root><apply id="S3.SS4.p5.2.1.m1.1.1.1.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1"><divide id="S3.SS4.p5.2.1.m1.1.1.1.2.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1"></divide><apply id="S3.SS4.p5.2.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1"><times id="S3.SS4.p5.2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.2"></times><ci id="S3.SS4.p5.2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.3">𝑙</ci><ci id="S3.SS4.p5.2.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.4">𝑜</ci><ci id="S3.SS4.p5.2.1.m1.1.1.1.1.1.5.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.5">𝑔</ci><apply id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1"><divide id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.1"></divide><apply id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2"><times id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.2.3">𝑀</ci></apply><ci id="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.1.1.1.1.1.3">𝑑</ci></apply></apply><apply id="S3.SS4.p5.2.1.m1.1.1.1.3.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.3"><times id="S3.SS4.p5.2.1.m1.1.1.1.3.1.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.3.1"></times><apply id="S3.SS4.p5.2.1.m1.1.1.1.3.2.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.3.2"><divide id="S3.SS4.p5.2.1.m1.1.1.1.3.2.1.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.3.2.1"></divide><ci id="S3.SS4.p5.2.1.m1.1.1.1.3.2.2.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.3.2.2">𝑀</ci><ci id="S3.SS4.p5.2.1.m1.1.1.1.3.2.3.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.3.2.3">𝑑</ci></apply><ci id="S3.SS4.p5.2.1.m1.1.1.1.3.3.cmml" xref="S3.SS4.p5.2.1.m1.1.1.1.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.1.m1.1c">\sqrt{\frac{log(eM/d)}{M/dN}}</annotation></semantics></math>. It means that it is closely related to <math id="S3.SS4.p5.3.2.m2.1" class="ltx_Math" alttext="\frac{M}{d}" display="inline"><semantics id="S3.SS4.p5.3.2.m2.1a"><mfrac mathcolor="#000000" id="S3.SS4.p5.3.2.m2.1.1" xref="S3.SS4.p5.3.2.m2.1.1.cmml"><mi mathcolor="#000000" id="S3.SS4.p5.3.2.m2.1.1.2" xref="S3.SS4.p5.3.2.m2.1.1.2.cmml">M</mi><mi mathcolor="#000000" id="S3.SS4.p5.3.2.m2.1.1.3" xref="S3.SS4.p5.3.2.m2.1.1.3.cmml">d</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.2.m2.1b"><apply id="S3.SS4.p5.3.2.m2.1.1.cmml" xref="S3.SS4.p5.3.2.m2.1.1"><divide id="S3.SS4.p5.3.2.m2.1.1.1.cmml" xref="S3.SS4.p5.3.2.m2.1.1"></divide><ci id="S3.SS4.p5.3.2.m2.1.1.2.cmml" xref="S3.SS4.p5.3.2.m2.1.1.2">𝑀</ci><ci id="S3.SS4.p5.3.2.m2.1.1.3.cmml" xref="S3.SS4.p5.3.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.3.2.m2.1c">\frac{M}{d}</annotation></semantics></math>. We denote the hypothesis class of FedTP with <em id="S3.SS4.p5.9.8.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> and with vanilla personalization by <math id="S3.SS4.p5.4.3.m3.1" class="ltx_Math" alttext="\mathcal{H}_{h}" display="inline"><semantics id="S3.SS4.p5.4.3.m3.1a"><msub id="S3.SS4.p5.4.3.m3.1.1" xref="S3.SS4.p5.4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS4.p5.4.3.m3.1.1.2" xref="S3.SS4.p5.4.3.m3.1.1.2.cmml">ℋ</mi><mi mathcolor="#000000" id="S3.SS4.p5.4.3.m3.1.1.3" xref="S3.SS4.p5.4.3.m3.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.4.3.m3.1b"><apply id="S3.SS4.p5.4.3.m3.1.1.cmml" xref="S3.SS4.p5.4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.4.3.m3.1.1.1.cmml" xref="S3.SS4.p5.4.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p5.4.3.m3.1.1.2.cmml" xref="S3.SS4.p5.4.3.m3.1.1.2">ℋ</ci><ci id="S3.SS4.p5.4.3.m3.1.1.3.cmml" xref="S3.SS4.p5.4.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.4.3.m3.1c">\mathcal{H}_{h}</annotation></semantics></math> and <math id="S3.SS4.p5.5.4.m4.1" class="ltx_Math" alttext="\mathcal{H}_{v}" display="inline"><semantics id="S3.SS4.p5.5.4.m4.1a"><msub id="S3.SS4.p5.5.4.m4.1.1" xref="S3.SS4.p5.5.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS4.p5.5.4.m4.1.1.2" xref="S3.SS4.p5.5.4.m4.1.1.2.cmml">ℋ</mi><mi mathcolor="#000000" id="S3.SS4.p5.5.4.m4.1.1.3" xref="S3.SS4.p5.5.4.m4.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.5.4.m4.1b"><apply id="S3.SS4.p5.5.4.m4.1.1.cmml" xref="S3.SS4.p5.5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.5.4.m4.1.1.1.cmml" xref="S3.SS4.p5.5.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p5.5.4.m4.1.1.2.cmml" xref="S3.SS4.p5.5.4.m4.1.1.2">ℋ</ci><ci id="S3.SS4.p5.5.4.m4.1.1.3.cmml" xref="S3.SS4.p5.5.4.m4.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.5.4.m4.1c">\mathcal{H}_{v}</annotation></semantics></math>, respectively. The VC-dimension of <math id="S3.SS4.p5.6.5.m5.1" class="ltx_Math" alttext="\mathcal{H}_{h}" display="inline"><semantics id="S3.SS4.p5.6.5.m5.1a"><msub id="S3.SS4.p5.6.5.m5.1.1" xref="S3.SS4.p5.6.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS4.p5.6.5.m5.1.1.2" xref="S3.SS4.p5.6.5.m5.1.1.2.cmml">ℋ</mi><mi mathcolor="#000000" id="S3.SS4.p5.6.5.m5.1.1.3" xref="S3.SS4.p5.6.5.m5.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.6.5.m5.1b"><apply id="S3.SS4.p5.6.5.m5.1.1.cmml" xref="S3.SS4.p5.6.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.6.5.m5.1.1.1.cmml" xref="S3.SS4.p5.6.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p5.6.5.m5.1.1.2.cmml" xref="S3.SS4.p5.6.5.m5.1.1.2">ℋ</ci><ci id="S3.SS4.p5.6.5.m5.1.1.3.cmml" xref="S3.SS4.p5.6.5.m5.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.6.5.m5.1c">\mathcal{H}_{h}</annotation></semantics></math> is smaller than the VC-dimension of <math id="S3.SS4.p5.7.6.m6.1" class="ltx_Math" alttext="\mathcal{H}_{v}" display="inline"><semantics id="S3.SS4.p5.7.6.m6.1a"><msub id="S3.SS4.p5.7.6.m6.1.1" xref="S3.SS4.p5.7.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS4.p5.7.6.m6.1.1.2" xref="S3.SS4.p5.7.6.m6.1.1.2.cmml">ℋ</mi><mi mathcolor="#000000" id="S3.SS4.p5.7.6.m6.1.1.3" xref="S3.SS4.p5.7.6.m6.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.7.6.m6.1b"><apply id="S3.SS4.p5.7.6.m6.1.1.cmml" xref="S3.SS4.p5.7.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.7.6.m6.1.1.1.cmml" xref="S3.SS4.p5.7.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p5.7.6.m6.1.1.2.cmml" xref="S3.SS4.p5.7.6.m6.1.1.2">ℋ</ci><ci id="S3.SS4.p5.7.6.m6.1.1.3.cmml" xref="S3.SS4.p5.7.6.m6.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.7.6.m6.1c">\mathcal{H}_{v}</annotation></semantics></math> especially for large number of clients since we use one hypernetwork to generate the self-attention layers for all clients with the <em id="S3.SS4.p5.9.8.2" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism. With the reduction of the VC-dimension <math id="S3.SS4.p5.8.7.m7.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS4.p5.8.7.m7.1a"><mi mathcolor="#000000" id="S3.SS4.p5.8.7.m7.1.1" xref="S3.SS4.p5.8.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.8.7.m7.1b"><ci id="S3.SS4.p5.8.7.m7.1.1.cmml" xref="S3.SS4.p5.8.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.8.7.m7.1c">d</annotation></semantics></math>, <math id="S3.SS4.p5.9.8.m8.1" class="ltx_Math" alttext="\sqrt{\frac{log(eM/d)}{M/dN}}" display="inline"><semantics id="S3.SS4.p5.9.8.m8.1a"><msqrt mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1" xref="S3.SS4.p5.9.8.m8.1.1.cmml"><mfrac mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1" xref="S3.SS4.p5.9.8.m8.1.1.1.cmml"><mrow id="S3.SS4.p5.9.8.m8.1.1.1.1.1" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.3" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.2" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.2.cmml">​</mo><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.4" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.2a" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.2.cmml">​</mo><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.5" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.2b" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.2" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.cmml"><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.2" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.1" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.3" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.3.cmml">M</mi></mrow><mo mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.1.cmml">/</mo><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.3.cmml">d</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.3" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.SS4.p5.9.8.m8.1.1.1.3" xref="S3.SS4.p5.9.8.m8.1.1.1.3.cmml"><mrow id="S3.SS4.p5.9.8.m8.1.1.1.3.2" xref="S3.SS4.p5.9.8.m8.1.1.1.3.2.cmml"><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.3.2.2" xref="S3.SS4.p5.9.8.m8.1.1.1.3.2.2.cmml">M</mi><mo mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.3.2.1" xref="S3.SS4.p5.9.8.m8.1.1.1.3.2.1.cmml">/</mo><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.3.2.3" xref="S3.SS4.p5.9.8.m8.1.1.1.3.2.3.cmml">d</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p5.9.8.m8.1.1.1.3.1" xref="S3.SS4.p5.9.8.m8.1.1.1.3.1.cmml">​</mo><mi mathcolor="#000000" id="S3.SS4.p5.9.8.m8.1.1.1.3.3" xref="S3.SS4.p5.9.8.m8.1.1.1.3.3.cmml">N</mi></mrow></mfrac></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.9.8.m8.1b"><apply id="S3.SS4.p5.9.8.m8.1.1.cmml" xref="S3.SS4.p5.9.8.m8.1.1"><root id="S3.SS4.p5.9.8.m8.1.1a.cmml" xref="S3.SS4.p5.9.8.m8.1.1"></root><apply id="S3.SS4.p5.9.8.m8.1.1.1.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1"><divide id="S3.SS4.p5.9.8.m8.1.1.1.2.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1"></divide><apply id="S3.SS4.p5.9.8.m8.1.1.1.1.1.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1"><times id="S3.SS4.p5.9.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.2"></times><ci id="S3.SS4.p5.9.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.3">𝑙</ci><ci id="S3.SS4.p5.9.8.m8.1.1.1.1.1.4.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.4">𝑜</ci><ci id="S3.SS4.p5.9.8.m8.1.1.1.1.1.5.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.5">𝑔</ci><apply id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1"><divide id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.1"></divide><apply id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2"><times id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.2.3">𝑀</ci></apply><ci id="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.1.1.1.1.1.3">𝑑</ci></apply></apply><apply id="S3.SS4.p5.9.8.m8.1.1.1.3.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.3"><times id="S3.SS4.p5.9.8.m8.1.1.1.3.1.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.3.1"></times><apply id="S3.SS4.p5.9.8.m8.1.1.1.3.2.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.3.2"><divide id="S3.SS4.p5.9.8.m8.1.1.1.3.2.1.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.3.2.1"></divide><ci id="S3.SS4.p5.9.8.m8.1.1.1.3.2.2.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.3.2.2">𝑀</ci><ci id="S3.SS4.p5.9.8.m8.1.1.1.3.2.3.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.3.2.3">𝑑</ci></apply><ci id="S3.SS4.p5.9.8.m8.1.1.1.3.3.cmml" xref="S3.SS4.p5.9.8.m8.1.1.1.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.9.8.m8.1c">\sqrt{\frac{log(eM/d)}{M/dN}}</annotation></semantics></math> will decrease. Thus, FedTP owns better generalization than vanilla personalization for self-attention especially when there are a large number of clients.</span>
The key lemmas and proof of Theorem 1 are given in the Appendix.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we describe the setup of experiments, evaluate the performance of our model and compare it to several baseline methods in various learning setups. In the Experimental Setup Subsection, we introduce benchmarks we compared, Non-IID settings and model architectures we apply, and some implementation details. In the Performance Evaluation part, we mainly analyze the performance of different network backbones and different personalized parts of Transformer, generalization to novel clients, compatibility of FedTP to other methods, and visualization of attention maps. In Ablation Study Subsection, we study the effect of heterogeneity in label distribution and in Noise-based Feature Imbalance, and the impact of different parameters. Fig. <a href="#S4.F3" title="Figure 3 ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the flow chart of our FedTP.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Datasets and models.</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dataset</th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Task</th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Clients</th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Total Samples</th>
<th id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Model</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<td id="S4.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">CIFAR-10</td>
<td id="S4.T1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Image Classification</td>
<td id="S4.T1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50/100</td>
<td id="S4.T1.1.2.1.4" class="ltx_td ltx_align_right ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">60,000</td>
<td id="S4.T1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">ConvNet, ViT</td>
</tr>
<tr id="S4.T1.1.3.2" class="ltx_tr">
<td id="S4.T1.1.3.2.1" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">CIFAR-100</td>
<td id="S4.T1.1.3.2.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">Image Classification</td>
<td id="S4.T1.1.3.2.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">50/100</td>
<td id="S4.T1.1.3.2.4" class="ltx_td ltx_align_right" style="padding-top:1.25pt;padding-bottom:1.25pt;">60,000</td>
<td id="S4.T1.1.3.2.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">ConvNet, ViT</td>
</tr>
<tr id="S4.T1.1.4.3" class="ltx_tr">
<td id="S4.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">Shakespeare</td>
<td id="S4.T1.1.4.3.2" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">Next-character Prediction</td>
<td id="S4.T1.1.4.3.3" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">683</td>
<td id="S4.T1.1.4.3.4" class="ltx_td ltx_align_right ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">2,578,349</td>
<td id="S4.T1.1.4.3.5" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">LSTM, Transformer</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2211.01572/assets/figure/flow_chart.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="431" height="576" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The flow chat of FedTP. The blue part of the flow chart represents the operations that occur on the server side, while the green part indicates the client-side operations.</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Experimental Setup</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><em id="S4.SS1.p1.1.1" class="ltx_emph ltx_font_italic">1) Benchmarks:</em> We compared FedTP with the basic Federated algorithms, such as <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_bold">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_bold">FedProx</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, as well as with several advanced personalization algorithms: <span id="S4.SS1.p1.1.4" class="ltx_text ltx_font_bold">FedPer</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, <span id="S4.SS1.p1.1.5" class="ltx_text ltx_font_bold">pFedMe</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, <span id="S4.SS1.p1.1.6" class="ltx_text ltx_font_bold">FedBN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, <span id="S4.SS1.p1.1.7" class="ltx_text ltx_font_bold">pFedHN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, <span id="S4.SS1.p1.1.8" class="ltx_text ltx_font_bold">pFedGP</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>,
and <span id="S4.SS1.p1.1.9" class="ltx_text ltx_font_bold">FedRoD</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.10" class="ltx_p"><em id="S4.SS1.p2.10.1" class="ltx_emph ltx_font_italic">2) Non-IID Settings of Datasets:</em>
We use three popular benchmark datasets: CIFAR-10, CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, and Shakespeare<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The first two are image datasets and the last one is a language dataset.
For CIFAR-10 and CIFAR-100, we applied two split strategies to simulate non-IID scenarios. The first is a “Pathological” setting, where each client is randomly assigned two/ten classes for CIFAR-10/CIFAR-100 as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. The sample rate on client <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">i</annotation></semantics></math> of selected class <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">c</annotation></semantics></math> is obtained by <math id="S4.SS1.p2.3.m3.4" class="ltx_Math" alttext="{a_{i,c}}/{\sum_{j}a_{j,c}}" display="inline"><semantics id="S4.SS1.p2.3.m3.4a"><mrow id="S4.SS1.p2.3.m3.4.5" xref="S4.SS1.p2.3.m3.4.5.cmml"><msub id="S4.SS1.p2.3.m3.4.5.2" xref="S4.SS1.p2.3.m3.4.5.2.cmml"><mi id="S4.SS1.p2.3.m3.4.5.2.2" xref="S4.SS1.p2.3.m3.4.5.2.2.cmml">a</mi><mrow id="S4.SS1.p2.3.m3.2.2.2.4" xref="S4.SS1.p2.3.m3.2.2.2.3.cmml"><mi id="S4.SS1.p2.3.m3.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p2.3.m3.2.2.2.4.1" xref="S4.SS1.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p2.3.m3.2.2.2.2" xref="S4.SS1.p2.3.m3.2.2.2.2.cmml">c</mi></mrow></msub><mo rspace="0.055em" id="S4.SS1.p2.3.m3.4.5.1" xref="S4.SS1.p2.3.m3.4.5.1.cmml">/</mo><mrow id="S4.SS1.p2.3.m3.4.5.3" xref="S4.SS1.p2.3.m3.4.5.3.cmml"><msub id="S4.SS1.p2.3.m3.4.5.3.1" xref="S4.SS1.p2.3.m3.4.5.3.1.cmml"><mo id="S4.SS1.p2.3.m3.4.5.3.1.2" xref="S4.SS1.p2.3.m3.4.5.3.1.2.cmml">∑</mo><mi id="S4.SS1.p2.3.m3.4.5.3.1.3" xref="S4.SS1.p2.3.m3.4.5.3.1.3.cmml">j</mi></msub><msub id="S4.SS1.p2.3.m3.4.5.3.2" xref="S4.SS1.p2.3.m3.4.5.3.2.cmml"><mi id="S4.SS1.p2.3.m3.4.5.3.2.2" xref="S4.SS1.p2.3.m3.4.5.3.2.2.cmml">a</mi><mrow id="S4.SS1.p2.3.m3.4.4.2.4" xref="S4.SS1.p2.3.m3.4.4.2.3.cmml"><mi id="S4.SS1.p2.3.m3.3.3.1.1" xref="S4.SS1.p2.3.m3.3.3.1.1.cmml">j</mi><mo id="S4.SS1.p2.3.m3.4.4.2.4.1" xref="S4.SS1.p2.3.m3.4.4.2.3.cmml">,</mo><mi id="S4.SS1.p2.3.m3.4.4.2.2" xref="S4.SS1.p2.3.m3.4.4.2.2.cmml">c</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.4b"><apply id="S4.SS1.p2.3.m3.4.5.cmml" xref="S4.SS1.p2.3.m3.4.5"><divide id="S4.SS1.p2.3.m3.4.5.1.cmml" xref="S4.SS1.p2.3.m3.4.5.1"></divide><apply id="S4.SS1.p2.3.m3.4.5.2.cmml" xref="S4.SS1.p2.3.m3.4.5.2"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.4.5.2.1.cmml" xref="S4.SS1.p2.3.m3.4.5.2">subscript</csymbol><ci id="S4.SS1.p2.3.m3.4.5.2.2.cmml" xref="S4.SS1.p2.3.m3.4.5.2.2">𝑎</ci><list id="S4.SS1.p2.3.m3.2.2.2.3.cmml" xref="S4.SS1.p2.3.m3.2.2.2.4"><ci id="S4.SS1.p2.3.m3.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1">𝑖</ci><ci id="S4.SS1.p2.3.m3.2.2.2.2.cmml" xref="S4.SS1.p2.3.m3.2.2.2.2">𝑐</ci></list></apply><apply id="S4.SS1.p2.3.m3.4.5.3.cmml" xref="S4.SS1.p2.3.m3.4.5.3"><apply id="S4.SS1.p2.3.m3.4.5.3.1.cmml" xref="S4.SS1.p2.3.m3.4.5.3.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.4.5.3.1.1.cmml" xref="S4.SS1.p2.3.m3.4.5.3.1">subscript</csymbol><sum id="S4.SS1.p2.3.m3.4.5.3.1.2.cmml" xref="S4.SS1.p2.3.m3.4.5.3.1.2"></sum><ci id="S4.SS1.p2.3.m3.4.5.3.1.3.cmml" xref="S4.SS1.p2.3.m3.4.5.3.1.3">𝑗</ci></apply><apply id="S4.SS1.p2.3.m3.4.5.3.2.cmml" xref="S4.SS1.p2.3.m3.4.5.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.4.5.3.2.1.cmml" xref="S4.SS1.p2.3.m3.4.5.3.2">subscript</csymbol><ci id="S4.SS1.p2.3.m3.4.5.3.2.2.cmml" xref="S4.SS1.p2.3.m3.4.5.3.2.2">𝑎</ci><list id="S4.SS1.p2.3.m3.4.4.2.3.cmml" xref="S4.SS1.p2.3.m3.4.4.2.4"><ci id="S4.SS1.p2.3.m3.3.3.1.1.cmml" xref="S4.SS1.p2.3.m3.3.3.1.1">𝑗</ci><ci id="S4.SS1.p2.3.m3.4.4.2.2.cmml" xref="S4.SS1.p2.3.m3.4.4.2.2">𝑐</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.4c">{a_{i,c}}/{\sum_{j}a_{j,c}}</annotation></semantics></math>, where <math id="S4.SS1.p2.4.m4.4" class="ltx_Math" alttext="a_{i,c}\sim U(.4,.6)" display="inline"><semantics id="S4.SS1.p2.4.m4.4a"><mrow id="S4.SS1.p2.4.m4.4.5" xref="S4.SS1.p2.4.m4.4.5.cmml"><msub id="S4.SS1.p2.4.m4.4.5.2" xref="S4.SS1.p2.4.m4.4.5.2.cmml"><mi id="S4.SS1.p2.4.m4.4.5.2.2" xref="S4.SS1.p2.4.m4.4.5.2.2.cmml">a</mi><mrow id="S4.SS1.p2.4.m4.2.2.2.4" xref="S4.SS1.p2.4.m4.2.2.2.3.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p2.4.m4.2.2.2.4.1" xref="S4.SS1.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p2.4.m4.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.cmml">c</mi></mrow></msub><mo id="S4.SS1.p2.4.m4.4.5.1" xref="S4.SS1.p2.4.m4.4.5.1.cmml">∼</mo><mrow id="S4.SS1.p2.4.m4.4.5.3" xref="S4.SS1.p2.4.m4.4.5.3.cmml"><mi id="S4.SS1.p2.4.m4.4.5.3.2" xref="S4.SS1.p2.4.m4.4.5.3.2.cmml">U</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m4.4.5.3.1" xref="S4.SS1.p2.4.m4.4.5.3.1.cmml">​</mo><mrow id="S4.SS1.p2.4.m4.4.5.3.3.2" xref="S4.SS1.p2.4.m4.4.5.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.4.m4.4.5.3.3.2.1" xref="S4.SS1.p2.4.m4.4.5.3.3.1.cmml">(</mo><mn id="S4.SS1.p2.4.m4.3.3" xref="S4.SS1.p2.4.m4.3.3.cmml">.4</mn><mo id="S4.SS1.p2.4.m4.4.5.3.3.2.2" xref="S4.SS1.p2.4.m4.4.5.3.3.1.cmml">,</mo><mn id="S4.SS1.p2.4.m4.4.4" xref="S4.SS1.p2.4.m4.4.4.cmml">.6</mn><mo stretchy="false" id="S4.SS1.p2.4.m4.4.5.3.3.2.3" xref="S4.SS1.p2.4.m4.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.4b"><apply id="S4.SS1.p2.4.m4.4.5.cmml" xref="S4.SS1.p2.4.m4.4.5"><csymbol cd="latexml" id="S4.SS1.p2.4.m4.4.5.1.cmml" xref="S4.SS1.p2.4.m4.4.5.1">similar-to</csymbol><apply id="S4.SS1.p2.4.m4.4.5.2.cmml" xref="S4.SS1.p2.4.m4.4.5.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.4.5.2.1.cmml" xref="S4.SS1.p2.4.m4.4.5.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.4.5.2.2.cmml" xref="S4.SS1.p2.4.m4.4.5.2.2">𝑎</ci><list id="S4.SS1.p2.4.m4.2.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.4"><ci id="S4.SS1.p2.4.m4.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1">𝑖</ci><ci id="S4.SS1.p2.4.m4.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2">𝑐</ci></list></apply><apply id="S4.SS1.p2.4.m4.4.5.3.cmml" xref="S4.SS1.p2.4.m4.4.5.3"><times id="S4.SS1.p2.4.m4.4.5.3.1.cmml" xref="S4.SS1.p2.4.m4.4.5.3.1"></times><ci id="S4.SS1.p2.4.m4.4.5.3.2.cmml" xref="S4.SS1.p2.4.m4.4.5.3.2">𝑈</ci><interval closure="open" id="S4.SS1.p2.4.m4.4.5.3.3.1.cmml" xref="S4.SS1.p2.4.m4.4.5.3.3.2"><cn type="float" id="S4.SS1.p2.4.m4.3.3.cmml" xref="S4.SS1.p2.4.m4.3.3">.4</cn><cn type="float" id="S4.SS1.p2.4.m4.4.4.cmml" xref="S4.SS1.p2.4.m4.4.4">.6</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.4c">a_{i,c}\sim U(.4,.6)</annotation></semantics></math>.
The second is a federated version created by randomly partitioning the datasets among clients using a symmetric Dirichlet distribution with parameter <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="\alpha=0.3" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">α</mi><mo id="S4.SS1.p2.5.m5.1.1.1" xref="S4.SS1.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><eq id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1"></eq><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝛼</ci><cn type="float" id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\alpha=0.3</annotation></semantics></math>, as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. We create federated versions of CIFAR-10 by randomly partitioning samples with the same label among clients according to a Dirichlet distribution with parameter <math id="S4.SS1.p2.6.m6.1" class="ltx_Math" alttext="\alpha=0.3" display="inline"><semantics id="S4.SS1.p2.6.m6.1a"><mrow id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">α</mi><mo id="S4.SS1.p2.6.m6.1.1.1" xref="S4.SS1.p2.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><eq id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1.1"></eq><ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">𝛼</ci><cn type="float" id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">\alpha=0.3</annotation></semantics></math>. As for CIFAR-100, in order to create more realistic local datasets, we use a two-stage Pachinko allocation method to partition samples over “coarse” and “fine” labels. This method firstly generates a Dirichlet distribution with parameter <math id="S4.SS1.p2.7.m7.1" class="ltx_Math" alttext="\alpha=0.3" display="inline"><semantics id="S4.SS1.p2.7.m7.1a"><mrow id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.p2.7.m7.1.1.2" xref="S4.SS1.p2.7.m7.1.1.2.cmml">α</mi><mo id="S4.SS1.p2.7.m7.1.1.1" xref="S4.SS1.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.7.m7.1.1.3" xref="S4.SS1.p2.7.m7.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><apply id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1"><eq id="S4.SS1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1.1"></eq><ci id="S4.SS1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.p2.7.m7.1.1.2">𝛼</ci><cn type="float" id="S4.SS1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.p2.7.m7.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">\alpha=0.3</annotation></semantics></math> over the coarse labels for each client, and then generates a Dirichlet distribution with parameter <math id="S4.SS1.p2.8.m8.1" class="ltx_Math" alttext="\beta=10" display="inline"><semantics id="S4.SS1.p2.8.m8.1a"><mrow id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml"><mi id="S4.SS1.p2.8.m8.1.1.2" xref="S4.SS1.p2.8.m8.1.1.2.cmml">β</mi><mo id="S4.SS1.p2.8.m8.1.1.1" xref="S4.SS1.p2.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.8.m8.1.1.3" xref="S4.SS1.p2.8.m8.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.1b"><apply id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1"><eq id="S4.SS1.p2.8.m8.1.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1.1"></eq><ci id="S4.SS1.p2.8.m8.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.2">𝛽</ci><cn type="integer" id="S4.SS1.p2.8.m8.1.1.3.cmml" xref="S4.SS1.p2.8.m8.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.1c">\beta=10</annotation></semantics></math> over the coarse corresponding fine labels. For both partitions, the classes and distribution of classes in training and test set of each client are the same.
For Shakespeare, similar to the partitions in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, we maintained the original split between the training and testing data specifically, 80<math id="S4.SS1.p2.9.m9.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.SS1.p2.9.m9.1a"><mo id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m9.1b"><csymbol cd="latexml" id="S4.SS1.p2.9.m9.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m9.1c">\%</annotation></semantics></math> for training and 20<math id="S4.SS1.p2.10.m10.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.SS1.p2.10.m10.1a"><mo id="S4.SS1.p2.10.m10.1.1" xref="S4.SS1.p2.10.m10.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m10.1b"><csymbol cd="latexml" id="S4.SS1.p2.10.m10.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m10.1c">\%</annotation></semantics></math> for testing.
Table <a href="#S4.T1" title="TABLE I ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> summarizes the datasets, corresponding tasks, and the number of clients and models.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><em id="S4.SS1.p3.1.1" class="ltx_emph ltx_font_italic">3) Model Architectures:</em>
Similar to many federated works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, we adopted a ConvNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> with 2 convolutional layers and 3 fully-connected layers as the local neural networks for baseline methods on CIFAR-10 and CIFAR-100. To improve the communication efficiency of large-scale federated scenarios, we chose a tiny ViT with fewer parameters for FedTP, which consisted of 8 blocks with 8 self-attention layers in each block. The corresponding attention head number is 8, and the patch size is 4 and the hidden size is 128.
With regards to Shakespeare, we applied the same stacked two-layer LSTM model as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> for benchmark methods.
For a fair comparison with LSTM, we used a simple Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> with two blocks as an encoder. The depth for both the LSTM and the simple Transformer is 2 and the inner hidden dimension for both is 256.
Since FedTP has a similar backbone for image classification tasks and language prediction tasks, we are able to use the same structure for the hypernetwork <math id="S4.SS1.p3.1.m1.2" class="ltx_Math" alttext="h(\varphi;\cdot)" display="inline"><semantics id="S4.SS1.p3.1.m1.2a"><mrow id="S4.SS1.p3.1.m1.2.3" xref="S4.SS1.p3.1.m1.2.3.cmml"><mi id="S4.SS1.p3.1.m1.2.3.2" xref="S4.SS1.p3.1.m1.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.2.3.1" xref="S4.SS1.p3.1.m1.2.3.1.cmml">​</mo><mrow id="S4.SS1.p3.1.m1.2.3.3.2" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.2.3.3.2.1" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">φ</mi><mo rspace="0em" id="S4.SS1.p3.1.m1.2.3.3.2.2" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">;</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.2.2" xref="S4.SS1.p3.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p3.1.m1.2.3.3.2.3" xref="S4.SS1.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b"><apply id="S4.SS1.p3.1.m1.2.3.cmml" xref="S4.SS1.p3.1.m1.2.3"><times id="S4.SS1.p3.1.m1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.1"></times><ci id="S4.SS1.p3.1.m1.2.3.2.cmml" xref="S4.SS1.p3.1.m1.2.3.2">ℎ</ci><list id="S4.SS1.p3.1.m1.2.3.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.3.2"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝜑</ci><ci id="S4.SS1.p3.1.m1.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">h(\varphi;\cdot)</annotation></semantics></math> except for the last layer.
We implement this hypernetwork similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> with an MLP network and parameter mapping heads. The MLP network consists of four fully-connected layers with 150 neurons and each parameter mapping head is a single FC layer.
For FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, we follow its original design which adds one BN layer after each convolution layer and fully-connected layer (except for the last layer). For FedRoD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, since the reported accuracy between hypernetwork version and the linear version is similar, we adopt the linear version.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Average test accuracy for FedTP and several Transformer-based methods with different non-iid settings.
</figcaption>
<div id="S4.T2.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:108.7pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-144.1pt,35.9pt) scale(0.600788419421678,0.600788419421678) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></th>
<td id="S4.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="4">CIFAR-10</td>
<td id="S4.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="4">CIFAR-100</td>
</tr>
<tr id="S4.T2.1.1.2.2" class="ltx_tr">
<th id="S4.T2.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">#setting</th>
<td id="S4.T2.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Pathological</td>
<td id="S4.T2.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Dirichlet</td>
<td id="S4.T2.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Pathological</td>
<td id="S4.T2.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Dirichlet</td>
</tr>
<tr id="S4.T2.1.1.3.3" class="ltx_tr">
<th id="S4.T2.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">#client</th>
<td id="S4.T2.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50</td>
<td id="S4.T2.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">100</td>
<td id="S4.T2.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50</td>
<td id="S4.T2.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">100</td>
<td id="S4.T2.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50</td>
<td id="S4.T2.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">100</td>
<td id="S4.T2.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50</td>
<td id="S4.T2.1.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">100</td>
</tr>
<tr id="S4.T2.1.1.4.4" class="ltx_tr">
<th id="S4.T2.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Local-T</th>
<td id="S4.T2.1.1.4.4.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">84.55±0.15</td>
<td id="S4.T2.1.1.4.4.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">82.21±0.08</td>
<td id="S4.T2.1.1.4.4.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">69.94±0.13</td>
<td id="S4.T2.1.1.4.4.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">66.68±0.13</td>
<td id="S4.T2.1.1.4.4.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">55.91±0.17</td>
<td id="S4.T2.1.1.4.4.7" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">49.25±0.11</td>
<td id="S4.T2.1.1.4.4.8" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.87±0.12</td>
<td id="S4.T2.1.1.4.4.9" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">23.34±0.10</td>
</tr>
<tr id="S4.T2.1.1.5.5" class="ltx_tr">
<th id="S4.T2.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedAvg-T <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S4.T2.1.1.5.5.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">50.42±4.22</td>
<td id="S4.T2.1.1.5.5.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">46.28±4.23</td>
<td id="S4.T2.1.1.5.5.4" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.85±1.5</td>
<td id="S4.T2.1.1.5.5.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">59.23±1.93</td>
<td id="S4.T2.1.1.5.5.6" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">34.02±0.88</td>
<td id="S4.T2.1.1.5.5.7" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">30.20±0.95</td>
<td id="S4.T2.1.1.5.5.8" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">38.64±0.22</td>
<td id="S4.T2.1.1.5.5.9" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">34.89±0.45</td>
</tr>
<tr id="S4.T2.1.1.6.6" class="ltx_tr">
<th id="S4.T2.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedProx-T <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</th>
<td id="S4.T2.1.1.6.6.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">47.28±5.09</td>
<td id="S4.T2.1.1.6.6.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">44.22±3.81</td>
<td id="S4.T2.1.1.6.6.4" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.00±1.74</td>
<td id="S4.T2.1.1.6.6.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">60.13±1.71</td>
<td id="S4.T2.1.1.6.6.6" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.77±1.67</td>
<td id="S4.T2.1.1.6.6.7" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">28.92±0.83</td>
<td id="S4.T2.1.1.6.6.8" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">37.63±0.35</td>
<td id="S4.T2.1.1.6.6.9" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">32.98±0.43</td>
</tr>
<tr id="S4.T2.1.1.7.7" class="ltx_tr">
<th id="S4.T2.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedPer-T <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>
</th>
<td id="S4.T2.1.1.7.7.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">89.86±0.89</td>
<td id="S4.T2.1.1.7.7.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.7.7.3.1" class="ltx_text ltx_font_bold">89.01±0.12</span></td>
<td id="S4.T2.1.1.7.7.4" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">79.41±0.16</td>
<td id="S4.T2.1.1.7.7.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.70±0.14</td>
<td id="S4.T2.1.1.7.7.6" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">67.23±0.32</td>
<td id="S4.T2.1.1.7.7.7" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.72±0.16</td>
<td id="S4.T2.1.1.7.7.8" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">37.19±0.18</td>
<td id="S4.T2.1.1.7.7.9" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.58±0.14</td>
</tr>
<tr id="S4.T2.1.1.8.8" class="ltx_tr">
<th id="S4.T2.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">pFedMe-T <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</th>
<td id="S4.T2.1.1.8.8.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">82.26±0.61</td>
<td id="S4.T2.1.1.8.8.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.57±0.52</td>
<td id="S4.T2.1.1.8.8.4" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">71.45±0.87</td>
<td id="S4.T2.1.1.8.8.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">68.13±0.67</td>
<td id="S4.T2.1.1.8.8.6" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">53.08±0.72</td>
<td id="S4.T2.1.1.8.8.7" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">39.94±0.91</td>
<td id="S4.T2.1.1.8.8.8" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">33.59±0.52</td>
<td id="S4.T2.1.1.8.8.9" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.95±0.64</td>
</tr>
<tr id="S4.T2.1.1.9.9" class="ltx_tr">
<th id="S4.T2.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Vanilla Personalized-T</th>
<td id="S4.T2.1.1.9.9.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">86.97±0.07</td>
<td id="S4.T2.1.1.9.9.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">84.90±0.11</td>
<td id="S4.T2.1.1.9.9.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">75.14±0.12</td>
<td id="S4.T2.1.1.9.9.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">72.33±0.16</td>
<td id="S4.T2.1.1.9.9.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.98±0.13</td>
<td id="S4.T2.1.1.9.9.7" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">57.60±0.12</td>
<td id="S4.T2.1.1.9.9.8" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">37.21±0.11</td>
<td id="S4.T2.1.1.9.9.9" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">32.81±0.11</td>
</tr>
<tr id="S4.T2.1.1.10.10" class="ltx_tr">
<th id="S4.T2.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedTP</th>
<td id="S4.T2.1.1.10.10.2" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.2.1" class="ltx_text ltx_font_bold">90.31±0.26</span></td>
<td id="S4.T2.1.1.10.10.3" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">88.39±0.14</td>
<td id="S4.T2.1.1.10.10.4" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.4.1" class="ltx_text ltx_font_bold">81.24±0.17</span></td>
<td id="S4.T2.1.1.10.10.5" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.5.1" class="ltx_text ltx_font_bold">80.27±0.28</span></td>
<td id="S4.T2.1.1.10.10.6" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.6.1" class="ltx_text ltx_font_bold">68.05±0.24</span></td>
<td id="S4.T2.1.1.10.10.7" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.7.1" class="ltx_text ltx_font_bold">63.76±0.39</span></td>
<td id="S4.T2.1.1.10.10.8" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.8.1" class="ltx_text ltx_font_bold">46.35±0.29</span></td>
<td id="S4.T2.1.1.10.10.9" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.9.1" class="ltx_text ltx_font_bold">43.74±0.39</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.6" class="ltx_p"><em id="S4.SS1.p4.6.1" class="ltx_emph ltx_font_italic">4) Implementation Details:</em>
Following the experimental setting in pFedHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, we implement FedTP and the benchmark methods with 50 and 100 clients at 10<math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mo id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><csymbol cd="latexml" id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\%</annotation></semantics></math> and 5<math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mo id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><csymbol cd="latexml" id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">\%</annotation></semantics></math> participation for CIFAR-10 and CIFAR-100, respectively. In the Shakespeare scenario, we treated each identity as a client and sampled 10<math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><mo id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><csymbol cd="latexml" id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">\%</annotation></semantics></math> clients in each communication round.
For the image classification task, we trained every algorithm for 1500 communication rounds. To make for an equivalent communication cost, pFedHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> is trained for 5000 global communication rounds.
For the next-character prediction task, we trained the corresponding methods for 300 communication rounds. Both tasks were optimized with a SGD optimizer for 5 local epochs with a default learning rate of <math id="S4.SS1.p4.4.m4.1" class="ltx_Math" alttext="lr=0.01" display="inline"><semantics id="S4.SS1.p4.4.m4.1a"><mrow id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml"><mrow id="S4.SS1.p4.4.m4.1.1.2" xref="S4.SS1.p4.4.m4.1.1.2.cmml"><mi id="S4.SS1.p4.4.m4.1.1.2.2" xref="S4.SS1.p4.4.m4.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.4.m4.1.1.2.1" xref="S4.SS1.p4.4.m4.1.1.2.1.cmml">​</mo><mi id="S4.SS1.p4.4.m4.1.1.2.3" xref="S4.SS1.p4.4.m4.1.1.2.3.cmml">r</mi></mrow><mo id="S4.SS1.p4.4.m4.1.1.1" xref="S4.SS1.p4.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.4.m4.1.1.3" xref="S4.SS1.p4.4.m4.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><apply id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1"><eq id="S4.SS1.p4.4.m4.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1"></eq><apply id="S4.SS1.p4.4.m4.1.1.2.cmml" xref="S4.SS1.p4.4.m4.1.1.2"><times id="S4.SS1.p4.4.m4.1.1.2.1.cmml" xref="S4.SS1.p4.4.m4.1.1.2.1"></times><ci id="S4.SS1.p4.4.m4.1.1.2.2.cmml" xref="S4.SS1.p4.4.m4.1.1.2.2">𝑙</ci><ci id="S4.SS1.p4.4.m4.1.1.2.3.cmml" xref="S4.SS1.p4.4.m4.1.1.2.3">𝑟</ci></apply><cn type="float" id="S4.SS1.p4.4.m4.1.1.3.cmml" xref="S4.SS1.p4.4.m4.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">lr=0.01</annotation></semantics></math> and a batch size of <math id="S4.SS1.p4.5.m5.1" class="ltx_Math" alttext="B=64" display="inline"><semantics id="S4.SS1.p4.5.m5.1a"><mrow id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">B</mi><mo id="S4.SS1.p4.5.m5.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.5.m5.1.1.3" xref="S4.SS1.p4.5.m5.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><apply id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1"><eq id="S4.SS1.p4.5.m5.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1"></eq><ci id="S4.SS1.p4.5.m5.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.2">𝐵</ci><cn type="integer" id="S4.SS1.p4.5.m5.1.1.3.cmml" xref="S4.SS1.p4.5.m5.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">B=64</annotation></semantics></math>.
In FedTP and pFedHN, we optimize the hypernetworks by using the SGD optimizer with a default learning rate <math id="S4.SS1.p4.6.m6.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p4.6.m6.1a"><mi id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><ci id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">\beta</annotation></semantics></math> = 0.01.
The server and all clients are simulated on a cluster with an RTX 2080 Ti GPU, and all algorithms are implemented in PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Performance Evaluation</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p"><em id="S4.SS2.p1.1.1" class="ltx_emph ltx_font_italic">1) Evaluation Protocol:</em>
We tested each algorithm every 5 rounds during its last 200 global communication rounds and computed the mean test accuracy and standard deviation over these evaluation steps to estimate the model performance. The average test accuracy in each evaluation step is defined as the ratio of the sum of each client’s positive predictions over all testing image numbers.</p>
</div>
<figure id="S4.T3" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>The results of FedTP and the benchmark methods on the image datasets with different non-IID settings.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S4.T3.1" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:133.5pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-135.5pt,41.5pt) scale(0.615474606570907,0.615474606570907) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></th>
<th id="S4.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="4">CIFAR-10</th>
<th id="S4.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="4">CIFAR-100</th>
</tr>
<tr id="S4.T3.1.1.2.2" class="ltx_tr">
<th id="S4.T3.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">#setting</th>
<th id="S4.T3.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Pathological</th>
<th id="S4.T3.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Dirichlet</th>
<th id="S4.T3.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Pathological</th>
<th id="S4.T3.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Dirichlet</th>
</tr>
<tr id="S4.T3.1.1.3.3" class="ltx_tr">
<th id="S4.T3.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">#client</th>
<th id="S4.T3.1.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50</th>
<th id="S4.T3.1.1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">100</th>
<th id="S4.T3.1.1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50</th>
<th id="S4.T3.1.1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">100</th>
<th id="S4.T3.1.1.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50</th>
<th id="S4.T3.1.1.3.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">100</th>
<th id="S4.T3.1.1.3.3.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">50</th>
<th id="S4.T3.1.1.3.3.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.4.1" class="ltx_tr">
<th id="S4.T3.1.1.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S4.T3.1.1.4.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">47.79±4.48*</td>
<td id="S4.T3.1.1.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">44.12±3.10*</td>
<td id="S4.T3.1.1.4.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">56.59±0.91</td>
<td id="S4.T3.1.1.4.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">57.52±1.01</td>
<td id="S4.T3.1.1.4.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">15.71±0.35*</td>
<td id="S4.T3.1.1.4.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">14.59±0.40*</td>
<td id="S4.T3.1.1.4.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">18.16±0.58</td>
<td id="S4.T3.1.1.4.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">20.34±1.34</td>
</tr>
<tr id="S4.T3.1.1.5.2" class="ltx_tr">
<th id="S4.T3.1.1.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</th>
<td id="S4.T3.1.1.5.2.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">50.81±2.94*</td>
<td id="S4.T3.1.1.5.2.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">57.38±1.08*</td>
<td id="S4.T3.1.1.5.2.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">58.51±0.65</td>
<td id="S4.T3.1.1.5.2.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">56.46±0.66</td>
<td id="S4.T3.1.1.5.2.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">19.39±0.63*</td>
<td id="S4.T3.1.1.5.2.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">21.32±0.71*</td>
<td id="S4.T3.1.1.5.2.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">19.18±0.30</td>
<td id="S4.T3.1.1.5.2.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">19.40±1.76</td>
</tr>
<tr id="S4.T3.1.1.6.3" class="ltx_tr">
<th id="S4.T3.1.1.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>
</th>
<td id="S4.T3.1.1.6.3.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">83.39±0.47*</td>
<td id="S4.T3.1.1.6.3.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">80.99±0.71*</td>
<td id="S4.T3.1.1.6.3.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.99±0.02</td>
<td id="S4.T3.1.1.6.3.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">74.21±0.07</td>
<td id="S4.T3.1.1.6.3.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">48.32±1.46*</td>
<td id="S4.T3.1.1.6.3.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">42.08±0.18*</td>
<td id="S4.T3.1.1.6.3.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">22.60±0.59</td>
<td id="S4.T3.1.1.6.3.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">20.06±0.26</td>
</tr>
<tr id="S4.T3.1.1.7.4" class="ltx_tr">
<th id="S4.T3.1.1.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</th>
<td id="S4.T3.1.1.7.4.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">86.09±0.32*</td>
<td id="S4.T3.1.1.7.4.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">85.23±0.58*</td>
<td id="S4.T3.1.1.7.4.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">76.29±0.44</td>
<td id="S4.T3.1.1.7.4.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">74.83±0.28</td>
<td id="S4.T3.1.1.7.4.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">49.09±1.10*</td>
<td id="S4.T3.1.1.7.4.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">45.57±1.02*</td>
<td id="S4.T3.1.1.7.4.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">31.60±0.46</td>
<td id="S4.T3.1.1.7.4.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.43±0.52</td>
</tr>
<tr id="S4.T3.1.1.8.5" class="ltx_tr">
<th id="S4.T3.1.1.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>
</th>
<td id="S4.T3.1.1.8.5.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">87.45±0.95</td>
<td id="S4.T3.1.1.8.5.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">86.71±0.56</td>
<td id="S4.T3.1.1.8.5.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">74.63±0.60</td>
<td id="S4.T3.1.1.8.5.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">75.41±0.37</td>
<td id="S4.T3.1.1.8.5.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">50.01±0.59</td>
<td id="S4.T3.1.1.8.5.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">48.37±0.56</td>
<td id="S4.T3.1.1.8.5.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">28.81±0.50</td>
<td id="S4.T3.1.1.8.5.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">28.70±0.46</td>
</tr>
<tr id="S4.T3.1.1.9.6" class="ltx_tr">
<th id="S4.T3.1.1.9.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">pFedHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</th>
<td id="S4.T3.1.1.9.6.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">88.38±0.29*</td>
<td id="S4.T3.1.1.9.6.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">87.97±0.70*</td>
<td id="S4.T3.1.1.9.6.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">71.79±0.57</td>
<td id="S4.T3.1.1.9.6.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">68.36±0.86</td>
<td id="S4.T3.1.1.9.6.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">59.48±0.67*</td>
<td id="S4.T3.1.1.9.6.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">53.24±0.31*</td>
<td id="S4.T3.1.1.9.6.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">34.05±0.41</td>
<td id="S4.T3.1.1.9.6.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.87±0.69</td>
</tr>
<tr id="S4.T3.1.1.10.7" class="ltx_tr">
<th id="S4.T3.1.1.10.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">pFedGP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</th>
<td id="S4.T3.1.1.10.7.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">89.20±0.30*</td>
<td id="S4.T3.1.1.10.7.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">88.80±0.20*</td>
<td id="S4.T3.1.1.10.7.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">—</td>
<td id="S4.T3.1.1.10.7.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">—</td>
<td id="S4.T3.1.1.10.7.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">63.30±0.10*</td>
<td id="S4.T3.1.1.10.7.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.30±0.20*</td>
<td id="S4.T3.1.1.10.7.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">—</td>
<td id="S4.T3.1.1.10.7.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">—</td>
</tr>
<tr id="S4.T3.1.1.11.8" class="ltx_tr">
<th id="S4.T3.1.1.11.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedRoD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>
</th>
<td id="S4.T3.1.1.11.8.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">89.87±0.03</td>
<td id="S4.T3.1.1.11.8.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T3.1.1.11.8.3.1" class="ltx_text ltx_font_bold">89.05±0.04</span></td>
<td id="S4.T3.1.1.11.8.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">75.01±0.09</td>
<td id="S4.T3.1.1.11.8.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">73.99±0.09</td>
<td id="S4.T3.1.1.11.8.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">56.28±0.14</td>
<td id="S4.T3.1.1.11.8.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">54.96±1.30</td>
<td id="S4.T3.1.1.11.8.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.45±0.73</td>
<td id="S4.T3.1.1.11.8.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">28.29±1.53</td>
</tr>
<tr id="S4.T3.1.1.12.9" class="ltx_tr">
<th id="S4.T3.1.1.12.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedTP</th>
<td id="S4.T3.1.1.12.9.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T3.1.1.12.9.2.1" class="ltx_text ltx_font_bold">90.31±0.26</span></td>
<td id="S4.T3.1.1.12.9.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">88.39±0.14</td>
<td id="S4.T3.1.1.12.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T3.1.1.12.9.4.1" class="ltx_text ltx_font_bold">81.24±0.17</span></td>
<td id="S4.T3.1.1.12.9.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T3.1.1.12.9.5.1" class="ltx_text ltx_font_bold">80.27±0.28</span></td>
<td id="S4.T3.1.1.12.9.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T3.1.1.12.9.6.1" class="ltx_text ltx_font_bold">68.05±0.24</span></td>
<td id="S4.T3.1.1.12.9.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T3.1.1.12.9.7.1" class="ltx_text ltx_font_bold">63.76±0.39</span></td>
<td id="S4.T3.1.1.12.9.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T3.1.1.12.9.8.1" class="ltx_text ltx_font_bold">46.35±0.29</span></td>
<td id="S4.T3.1.1.12.9.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T3.1.1.12.9.9.1" class="ltx_text ltx_font_bold">43.74±0.39</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul id="S4.I1" class="ltx_itemize ltx_centering ltx_figure_panel">
<li id="S4.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span> 
<div id="S4.I1.ix1.p1" class="ltx_para">
<p id="S4.I1.ix1.p1.1" class="ltx_p">We use * to represent the results reported in previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> under the same experimental settings.</p>
</div>
</li>
</ul>
</div>
</div>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p"><em id="S4.SS2.p2.1.1" class="ltx_emph ltx_font_italic">2) Performance Analysis:</em>
We compared the performance of FedTP to some well-known federated learning methods. Note that these methods were originally implemented based on CNN backbones. Here we used the same Transformer architecture of FedTP to replace their CNN backbones for a fair comparison. To mark the modification, we added a “-T” after the algorithm name to denote these methods. The average test accuracy of these algorithms is reported in Table <a href="#S4.T2" title="TABLE II ‣ IV-A Experimental Setup ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, which shows that FedTP outperforms all of them by a clear margin. This also validates our prior claims in the Introduction: 1) the FedAvg algorithm may impair the client-specific representations in Transformers as Local-T works even better than FedAvg-T; 2) the personalized self-attention learned by FedTP can handle the data heterogeneity effectively.
As shown in Table <a href="#S4.T2" title="TABLE II ‣ IV-A Experimental Setup ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, FedTP significantly outperforms Vanilla Personalized-T in all settings, which verified that <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_italic">learn-to-personalize</span> leverages the strengths of self-attention in Transformer models to improve their performance in federated learning over heterogeneous data.
Additionally, FedTP is also superior to FedPer-T. This indicates that personalizing the projection matrices in self-attention layers is much more effective than personalizing the last classification head.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">We analyzed the test accuracy vs. global communication rounds curve of FedTP in comparison with other Transformer-based methods in Fig. <a href="#S4.F4" title="Figure 4 ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. FedTP shows a smoother curve and achieves higher accuracy compared with the others. This further proves that the self-attention mechanism is a crucial part to overcome data heterogeneity effectively.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>
Average test accuracy on the language dataset Shakespeare of different methods.
</figcaption>
<div id="S4.T4.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:40.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(24.9pt,-2.3pt) scale(1.12995204833561,1.12995204833561) ;">
<table id="S4.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Method</th>
<th id="S4.T4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FedAvg</th>
<th id="S4.T4.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FedProx</th>
<th id="S4.T4.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FedPer</th>
<th id="S4.T4.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">pFedMe</th>
<th id="S4.T4.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">FedTP</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.2.1" class="ltx_tr">
<th id="S4.T4.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">Test accuracy</th>
<td id="S4.T4.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">21.34±1.04</td>
<td id="S4.T4.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">20.48±1.09</td>
<td id="S4.T4.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">27.56±0.65</td>
<td id="S4.T4.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">21.14±1.12</td>
<td id="S4.T4.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T4.1.1.2.1.6.1" class="ltx_text ltx_font_bold">84.40±0.10</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2211.01572/assets/x3.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="406" height="304" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The test accuracy and convergence behavior of FedTP and other Transformer-based Methods on CIFAR-100 with Dirichlet setting over 50 clients.</figcaption>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p"><em id="S4.SS2.p4.1.1" class="ltx_emph ltx_font_italic">3) Analysis of Network Backbone:</em>
We also implemented experiments to compare the performance of FedTP to many state-of-the-art federated learning methods that are based on CNN/LSTM.
The average test accuracy of these algorithms for the image datasets and language dataset are shown in Table <a href="#S4.T3" title="TABLE III ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> and Table <a href="#S4.T4" title="TABLE IV ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>, respectively. Clearly, FedTP outperforms the baseline methods in terms of the average test accuracy for most cases. It is worth noting that, the hypernetworks in FedTP only produce the parameters of the self-attention layers, which take up around 9.8% parameters of the whole network. Although FedTP uses a much smaller ratio of personalized parameters, it still significantly outperforms pFedHN with an 11.31% improvement on average for CIFAR-100. As shown in Table <a href="#S4.T3" title="TABLE III ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> and Table <a href="#S4.T4" title="TABLE IV ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>, changing the network backbone from a CNN or an LSTM to Transformers will bring a significant improvement in the models’ ability to overcome data heterogeneity.
Through comparing Table <a href="#S4.T2" title="TABLE II ‣ IV-A Experimental Setup ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> and Table <a href="#S4.T3" title="TABLE III ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, the decrease in the accuracy of pFedMe-T and FedProx-T in some settings indicates that the performance of Transformer-based models will be affected when there is a regularization term in these federated learning methods. This is possible because the regularization term may impair the self-attention mechanism, while our FedTP maintains the personalization of the self-attention layers through the <span id="S4.SS2.p4.1.2" class="ltx_text ltx_font_italic">learn-to-personalize</span> mechanism. More details about the effects of <span id="S4.SS2.p4.1.3" class="ltx_text ltx_font_italic">learn-to-personalize</span> will be shown in <span id="S4.SS2.p4.1.4" class="ltx_text ltx_font_italic">5) Visualization of Attention Maps</span>.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p"><em id="S4.SS2.p5.1.1" class="ltx_emph ltx_font_italic">4) Analysis of Different Personalized Parts:</em>
Here we investigate the impacts of personalizing different components in the Transformer: (1) the self-attention layers (our method), (2) the MLP layers, (3) the normalization layers, (4) the whole encoder. In this experiment, we use the same hypernetwork to generate the parameters of these different components, and keep the same structures of ViT as we described in the Subsection of Implementation Details. The results are shown in Table <a href="#S4.T5" title="TABLE V ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>, from which we can see that personalizing self-attention layers achieves the best results compared to personalizing other components. Besides, Table <a href="#S4.T5" title="TABLE V ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> also shows that personalizing the normalization layers works better than personalizing the MLP layers and the whole encoder.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE V: </span>
Test accuracy on average for Transformer-based models with different personalized part over 50 clients.
</figcaption>
<div id="S4.T5.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:126.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(31.5pt,-9.2pt) scale(1.170186477711,1.170186477711) ;">
<table id="S4.T5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.1.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" rowspan="2"><span id="S4.T5.1.1.1.1.1.1" class="ltx_text">
<span id="S4.T5.1.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T5.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T5.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">Personalized part</span></span>
</span></span></th>
<th id="S4.T5.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR-10</th>
<th id="S4.T5.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR-100</th>
</tr>
<tr id="S4.T5.1.1.2.2" class="ltx_tr">
<th id="S4.T5.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T5.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
<th id="S4.T5.1.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T5.1.1.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.1.1.3.1" class="ltx_tr">
<th id="S4.T5.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Self-attention (FedTP)</th>
<td id="S4.T5.1.1.3.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T5.1.1.3.1.2.1" class="ltx_text ltx_font_bold">90.31±0.26</span></td>
<td id="S4.T5.1.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T5.1.1.3.1.3.1" class="ltx_text ltx_font_bold">81.24±0.17</span></td>
<td id="S4.T5.1.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T5.1.1.3.1.4.1" class="ltx_text ltx_font_bold">68.05±0.24</span></td>
<td id="S4.T5.1.1.3.1.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T5.1.1.3.1.5.1" class="ltx_text ltx_font_bold">46.35±0.29</span></td>
</tr>
<tr id="S4.T5.1.1.4.2" class="ltx_tr">
<th id="S4.T5.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">MLP Layers</th>
<td id="S4.T5.1.1.4.2.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">88.45±0.14</td>
<td id="S4.T5.1.1.4.2.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.36±0.17</td>
<td id="S4.T5.1.1.4.2.4" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">59.76±0.14</td>
<td id="S4.T5.1.1.4.2.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">35.65±0.16</td>
</tr>
<tr id="S4.T5.1.1.5.3" class="ltx_tr">
<th id="S4.T5.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">Normalization Layers</th>
<td id="S4.T5.1.1.5.3.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">89.56±0.45</td>
<td id="S4.T5.1.1.5.3.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">78.15±0.27</td>
<td id="S4.T5.1.1.5.3.4" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">64.23±0.37</td>
<td id="S4.T5.1.1.5.3.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">41.22±0.39</td>
</tr>
<tr id="S4.T5.1.1.6.4" class="ltx_tr">
<th id="S4.T5.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">The Whole Encoder</th>
<td id="S4.T5.1.1.6.4.2" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">82.34±0.43</td>
<td id="S4.T5.1.1.6.4.3" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">73.65±0.52</td>
<td id="S4.T5.1.1.6.4.4" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">59.79±0.24</td>
<td id="S4.T5.1.1.6.4.5" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">33.95±0.37</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.1" class="ltx_p"><em id="S4.SS2.p6.1.1" class="ltx_emph ltx_font_italic">5) Visualization of Attention Maps:</em>
We used Attention Rollout <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> to visualize various Transformer-based methods in federated learning. In order to aggregate information across self-attention in each Transformer block, we used the MAX operation instead of the AVG operation proposed in the original paper, and we discarded the least 30<math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><mo id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">\%</annotation></semantics></math> attention values to filter out low-frequency signals. Fig. <a href="#S4.F5" title="Figure 5 ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and Fig. <a href="#S4.F6" title="Figure 6 ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> present visual comparisons of attention maps between FedTP and other Transformer-based variants on CIFAR-10 and CIFAR-100. Both Vanilla Personalized-T and FedTP exhibit client-specific self-attention for good visualization maps. In addition, our FedTP focuses more precisely on the critical parts of testing objects than pFedMe-T and FedAvg-T in many cases. This reflects that FedTP does well in depicting personal attention and again validates our claim.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2211.01572/assets/x4.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="212" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Attention maps of FedTP and other Transformer-based variants implemented on CIFAR-10 over 50 clients.</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2211.01572/assets/x5.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="212" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Attention maps of FedTP and other Transformer-based variants implemented on CIFAR-100 over 50 clients.</figcaption>
</figure>
<div id="S4.SS2.p7" class="ltx_para">
<p id="S4.SS2.p7.1" class="ltx_p"><em id="S4.SS2.p7.1.1" class="ltx_emph ltx_font_italic">6) Extension of FedTP:</em>
In this section, we mainly explore the compatibility of FedTP, and our FedTP is compatible with methods with personalized classifier head including FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, FedRod <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, and methods making use of local memory like KNN-Per <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. We inserted those modules into FedTP and evaluated their performance on the CIFAR-10/CIFAR-100 datasets. In our implementation, FedTP+FedPer retains each client’s own classification head locally based on FedTP.
FedTP+FedRoD computes the sum of the output of the personalized classification head and the global classification head as the prediction logits.
FedTP+KNN establishes and maintains a local repository in a similar way to Knn-Per which relies on FAISS library <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>.
The results are shown in Table <a href="#S4.T6" title="TABLE VI ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>
Test accuracy on average for FedTP and its variants over 100 clients.
</figcaption>
<div id="S4.T6.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:131pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(38.1pt,-11.5pt) scale(1.21339212452161,1.21339212452161) ;">
<table id="S4.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.1.1.1.1" class="ltx_tr">
<th id="S4.T6.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></th>
<th id="S4.T6.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR-10</th>
<th id="S4.T6.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR-100</th>
</tr>
<tr id="S4.T6.1.1.2.2" class="ltx_tr">
<th id="S4.T6.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">#setting</th>
<th id="S4.T6.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T6.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
<th id="S4.T6.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T6.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
</tr>
<tr id="S4.T6.1.1.3.3" class="ltx_tr">
<th id="S4.T6.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedTP (ours)</th>
<th id="S4.T6.1.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">88.30±0.35</th>
<th id="S4.T6.1.1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">79.22±0.29</th>
<th id="S4.T6.1.1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">60.90±0.26</th>
<th id="S4.T6.1.1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">39.74±0.32</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.1.1.4.1" class="ltx_tr">
<th id="S4.T6.1.1.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedTP+FedPer</th>
<td id="S4.T6.1.1.4.1.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">89.42±0.10</td>
<td id="S4.T6.1.1.4.1.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">78.18±0.14</td>
<td id="S4.T6.1.1.4.1.4" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.78±0.14</td>
<td id="S4.T6.1.1.4.1.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">32.86±0.19</td>
</tr>
<tr id="S4.T6.1.1.5.2" class="ltx_tr">
<th id="S4.T6.1.1.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedTP+FedRoD</th>
<td id="S4.T6.1.1.5.2.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">87.66±0.31</td>
<td id="S4.T6.1.1.5.2.3" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">78.67±0.37</td>
<td id="S4.T6.1.1.5.2.4" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">64.62±0.22</td>
<td id="S4.T6.1.1.5.2.5" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;">42.30±0.26</td>
</tr>
<tr id="S4.T6.1.1.6.3" class="ltx_tr">
<th id="S4.T6.1.1.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedTP+KNN</th>
<td id="S4.T6.1.1.6.3.2" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">88.84±0.18</td>
<td id="S4.T6.1.1.6.3.3" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">80.18±0.12</td>
<td id="S4.T6.1.1.6.3.4" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">64.30±0.27</td>
<td id="S4.T6.1.1.6.3.5" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">40.70±0.26</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.p8" class="ltx_para">
<p id="S4.SS2.p8.1" class="ltx_p">Several discoveries can be found based on Fig. <a href="#S4.F7" title="Figure 7 ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. On the one hand, combining local memory to calibrate the classification head can improve the model’s performance, especially when the data quantity of each class is small. On the other hand, simply binding a personalized classification head to FedTP may diminish the accuracy when data complies with a Dirichlet distribution. This means a personal classifier may prevent FedTP from learning personalized self-attention when the data distribution is too diverse. Keeping the global head as FedTP+FedRod does will mitigate such problems and improve model performance. To sum up, FedTP can well incorporate former algorithms to help each client better adapt its model to its data heterogeneity.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2211.01572/assets/figure/FedTP_plus.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="550" height="413" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Visualization of accuracy for FedTP Extension Experiments on CIFAR-10 and CIFAR-100 datasets with 100 clients and 5<math id="S4.F7.2.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.F7.2.m1.1b"><mo id="S4.F7.2.m1.1.1" xref="S4.F7.2.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.F7.2.m1.1c"><csymbol cd="latexml" id="S4.F7.2.m1.1.1.cmml" xref="S4.F7.2.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.2.m1.1d">\%</annotation></semantics></math> sample rate.</figcaption>
</figure>
<div id="S4.SS2.p9" class="ltx_para">
<p id="S4.SS2.p9.1" class="ltx_p"><em id="S4.SS2.p9.1.1" class="ltx_emph ltx_font_italic">7) Generalization to Novel Clients:</em>
Similar to the settings in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, we tested our method’s generalization ability against pFedMe, pFedHN, FedRod and Vanilla Personalized-T on CIFAR-100 with the Dirichlet setting. Here, we sampled <math id="S4.SS2.p9.1.m1.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S4.SS2.p9.1.m1.1a"><mrow id="S4.SS2.p9.1.m1.1.1" xref="S4.SS2.p9.1.m1.1.1.cmml"><mn id="S4.SS2.p9.1.m1.1.1.2" xref="S4.SS2.p9.1.m1.1.1.2.cmml">20</mn><mo id="S4.SS2.p9.1.m1.1.1.1" xref="S4.SS2.p9.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.1.m1.1b"><apply id="S4.SS2.p9.1.m1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p9.1.m1.1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p9.1.m1.1.1.2.cmml" xref="S4.SS2.p9.1.m1.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.1.m1.1c">20\%</annotation></semantics></math> percent of the clients as novel clients whose data is unseen during training, and only the personalized parameters of these models were fine-tuned for novel clients. Specifically, FedRod tuned the personalized parameters in the last classification layer and pFedMe learned all parameters to get each client’s personalized model.
Vanilla Personalized-T tuned clients’ personalized projection matrices of self-attention layer. With regards to pFedHN and FedTP, the personalized parameters can choose between the client-wise embedding vectors with dimension 32 and the whole hypernetwork. The results are shown in Fig. <a href="#S4.F8" title="Figure 8 ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we added “Embedding” and “Hypernetwork” after pFedHN and FedTP to distinguish between the two patterns. We can easily see that FedTP (Hypernetwork) is more robust and well adapts to novel clients in just a few epochs.</p>
</div>
<figure id="S4.F8" class="ltx_figure"><img src="/html/2211.01572/assets/figure/fine_tune.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="550" height="413" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Test accuracy of novel clients after fine-tuning the personalized parts of models trained on CIFAR-100.</figcaption>
</figure>
<div id="S4.SS2.p10" class="ltx_para">
<p id="S4.SS2.p10.4" class="ltx_p"><em id="S4.SS2.p10.4.1" class="ltx_emph ltx_font_italic">8) Analysis of Hypernetworks:</em>
To analyze the effects of hypernetworks, we compared FedTP with Vanilla Personalized-T, which restores each client’s projection parameters <math id="S4.SS2.p10.1.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S4.SS2.p10.1.m1.1a"><msub id="S4.SS2.p10.1.m1.1.1" xref="S4.SS2.p10.1.m1.1.1.cmml"><mi id="S4.SS2.p10.1.m1.1.1.2" xref="S4.SS2.p10.1.m1.1.1.2.cmml">W</mi><mi id="S4.SS2.p10.1.m1.1.1.3" xref="S4.SS2.p10.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.1.m1.1b"><apply id="S4.SS2.p10.1.m1.1.1.cmml" xref="S4.SS2.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p10.1.m1.1.1.1.cmml" xref="S4.SS2.p10.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p10.1.m1.1.1.2.cmml" xref="S4.SS2.p10.1.m1.1.1.2">𝑊</ci><ci id="S4.SS2.p10.1.m1.1.1.3.cmml" xref="S4.SS2.p10.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.1.m1.1c">W_{i}</annotation></semantics></math> locally without using hypernetworks. Table <a href="#S4.T2" title="TABLE II ‣ IV-A Experimental Setup ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> shows that FedTP has a prominent lead over Vanilla Personalized-T, indicating that hypernetworks indeed play an important role in FedTP. We further notice that even if hypernetworks only produce the parameters of the self-attention layer, it is still good at encoding client-specific information into client embeddings <math id="S4.SS2.p10.2.m2.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S4.SS2.p10.2.m2.1a"><msub id="S4.SS2.p10.2.m2.1.1" xref="S4.SS2.p10.2.m2.1.1.cmml"><mi id="S4.SS2.p10.2.m2.1.1.2" xref="S4.SS2.p10.2.m2.1.1.2.cmml">z</mi><mi id="S4.SS2.p10.2.m2.1.1.3" xref="S4.SS2.p10.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.2.m2.1b"><apply id="S4.SS2.p10.2.m2.1.1.cmml" xref="S4.SS2.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p10.2.m2.1.1.1.cmml" xref="S4.SS2.p10.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p10.2.m2.1.1.2.cmml" xref="S4.SS2.p10.2.m2.1.1.2">𝑧</ci><ci id="S4.SS2.p10.2.m2.1.1.3.cmml" xref="S4.SS2.p10.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.2.m2.1c">z_{i}</annotation></semantics></math>. The hypernetworks can simultaneously map the client embeddings <math id="S4.SS2.p10.3.m3.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S4.SS2.p10.3.m3.1a"><msub id="S4.SS2.p10.3.m3.1.1" xref="S4.SS2.p10.3.m3.1.1.cmml"><mi id="S4.SS2.p10.3.m3.1.1.2" xref="S4.SS2.p10.3.m3.1.1.2.cmml">z</mi><mi id="S4.SS2.p10.3.m3.1.1.3" xref="S4.SS2.p10.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.3.m3.1b"><apply id="S4.SS2.p10.3.m3.1.1.cmml" xref="S4.SS2.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p10.3.m3.1.1.1.cmml" xref="S4.SS2.p10.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p10.3.m3.1.1.2.cmml" xref="S4.SS2.p10.3.m3.1.1.2">𝑧</ci><ci id="S4.SS2.p10.3.m3.1.1.3.cmml" xref="S4.SS2.p10.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.3.m3.1c">z_{i}</annotation></semantics></math> into a manifold parameterized by hypernetwork parameters <math id="S4.SS2.p10.4.m4.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S4.SS2.p10.4.m4.1a"><mi id="S4.SS2.p10.4.m4.1.1" xref="S4.SS2.p10.4.m4.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.4.m4.1b"><ci id="S4.SS2.p10.4.m4.1.1.cmml" xref="S4.SS2.p10.4.m4.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.4.m4.1c">\varphi</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p11" class="ltx_para">
<p id="S4.SS2.p11.1" class="ltx_p">Then we visualize the learned client embeddings by projecting them onto a two-dimensional plane using the t-SNE algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. For convenience, we exploited “coarse” and “fine” labels of CIFAR-100 and split data in a special method similar to pFedHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. In detail, we assigned each coarse class to five clients and then split the corresponding fine classes uniformly among those chosen clients. With this extra partition method, we trained FedTP and then visualized client embeddings after training. Fig. <a href="#S4.F9" title="Figure 9 ‣ IV-B Performance Evaluation ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> shows that the learned personal embeddings of those clients with the same coarse labels are clustered together and they are mapped far away from those with different coarse labels. This result supports our claim that the hypernetwork is a highly effective way of encoding personalized information into their client embeddings <math id="S4.SS2.p11.1.m1.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S4.SS2.p11.1.m1.1a"><msub id="S4.SS2.p11.1.m1.1.1" xref="S4.SS2.p11.1.m1.1.1.cmml"><mi id="S4.SS2.p11.1.m1.1.1.2" xref="S4.SS2.p11.1.m1.1.1.2.cmml">z</mi><mi id="S4.SS2.p11.1.m1.1.1.3" xref="S4.SS2.p11.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p11.1.m1.1b"><apply id="S4.SS2.p11.1.m1.1.1.cmml" xref="S4.SS2.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p11.1.m1.1.1.1.cmml" xref="S4.SS2.p11.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p11.1.m1.1.1.2.cmml" xref="S4.SS2.p11.1.m1.1.1.2">𝑧</ci><ci id="S4.SS2.p11.1.m1.1.1.3.cmml" xref="S4.SS2.p11.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p11.1.m1.1c">z_{i}</annotation></semantics></math>.</p>
</div>
<figure id="S4.F9" class="ltx_figure"><img src="/html/2211.01572/assets/x6.png" id="S4.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="425" height="255" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>t-SNE visualization of learned client embedding by FedTP on CIFAR-100 dataset.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.4.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.5.2" class="ltx_text ltx_font_italic">Ablation Study</span>
</h3>

<figure id="S4.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VII: </span>The results of FedTP and the benchmark methods on the image datasets over 100 clients with different <math id="S4.T7.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T7.2.m1.1b"><mi id="S4.T7.2.m1.1.1" xref="S4.T7.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T7.2.m1.1c"><ci id="S4.T7.2.m1.1.1.cmml" xref="S4.T7.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.2.m1.1d">\alpha</annotation></semantics></math> of Dirichlet setting.</figcaption>
<div id="S4.T7.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:424.9pt;height:81.1pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-120.3pt,22.8pt) scale(0.638561201160493,0.638561201160493) ;">
<table id="S4.T7.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T7.3.1.2.1" class="ltx_tr">
<th id="S4.T7.3.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></th>
<th id="S4.T7.3.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="5">CIFAR-10</th>
<th id="S4.T7.3.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="5">CIFAR-100</th>
</tr>
<tr id="S4.T7.3.1.1" class="ltx_tr">
<th id="S4.T7.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;"><math id="S4.T7.3.1.1.1.m1.1" class="ltx_Math" alttext="\#\alpha" display="inline"><semantics id="S4.T7.3.1.1.1.m1.1a"><mrow id="S4.T7.3.1.1.1.m1.1.1" xref="S4.T7.3.1.1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.T7.3.1.1.1.m1.1.1.2" xref="S4.T7.3.1.1.1.m1.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S4.T7.3.1.1.1.m1.1.1.1" xref="S4.T7.3.1.1.1.m1.1.1.1.cmml">​</mo><mi id="S4.T7.3.1.1.1.m1.1.1.3" xref="S4.T7.3.1.1.1.m1.1.1.3.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T7.3.1.1.1.m1.1b"><apply id="S4.T7.3.1.1.1.m1.1.1.cmml" xref="S4.T7.3.1.1.1.m1.1.1"><times id="S4.T7.3.1.1.1.m1.1.1.1.cmml" xref="S4.T7.3.1.1.1.m1.1.1.1"></times><ci id="S4.T7.3.1.1.1.m1.1.1.2.cmml" xref="S4.T7.3.1.1.1.m1.1.1.2">#</ci><ci id="S4.T7.3.1.1.1.m1.1.1.3.cmml" xref="S4.T7.3.1.1.1.m1.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.3.1.1.1.m1.1c">\#\alpha</annotation></semantics></math></th>
<th id="S4.T7.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.1</th>
<th id="S4.T7.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.3</th>
<th id="S4.T7.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.5</th>
<th id="S4.T7.3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.7</th>
<th id="S4.T7.3.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.9</th>
<th id="S4.T7.3.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.1</th>
<th id="S4.T7.3.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.3</th>
<th id="S4.T7.3.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.5</th>
<th id="S4.T7.3.1.1.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.7</th>
<th id="S4.T7.3.1.1.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">0.9</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T7.3.1.3.1" class="ltx_tr">
<th id="S4.T7.3.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedAvg-T</th>
<td id="S4.T7.3.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">40.99±6.20</td>
<td id="S4.T7.3.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">59.23±1.93</td>
<td id="S4.T7.3.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">63.69±1.33</td>
<td id="S4.T7.3.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">65.29±1.12</td>
<td id="S4.T7.3.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">65.82±0.82</td>
<td id="S4.T7.3.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">32.72±0.81</td>
<td id="S4.T7.3.1.3.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">34.89±0.45</td>
<td id="S4.T7.3.1.3.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.25±1.79</td>
<td id="S4.T7.3.1.3.1.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.99±0.44</td>
<td id="S4.T7.3.1.3.1.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">37.51±0.33</td>
</tr>
<tr id="S4.T7.3.1.4.2" class="ltx_tr">
<th id="S4.T7.3.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedPer-T</th>
<td id="S4.T7.3.1.4.2.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">87.45±0.14</td>
<td id="S4.T7.3.1.4.2.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.7±0.14</td>
<td id="S4.T7.3.1.4.2.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">72.44±0.22</td>
<td id="S4.T7.3.1.4.2.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">70.11±0.21</td>
<td id="S4.T7.3.1.4.2.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">71.13±0.14</td>
<td id="S4.T7.3.1.4.2.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">40.92±0.23</td>
<td id="S4.T7.3.1.4.2.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.58±0.14</td>
<td id="S4.T7.3.1.4.2.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.02±0.11</td>
<td id="S4.T7.3.1.4.2.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.12±0.09</td>
<td id="S4.T7.3.1.4.2.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.29±0.13</td>
</tr>
<tr id="S4.T7.3.1.5.3" class="ltx_tr">
<th id="S4.T7.3.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">pFedHN</th>
<td id="S4.T7.3.1.5.3.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">83.07±1.07</td>
<td id="S4.T7.3.1.5.3.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">68.36±0.86</td>
<td id="S4.T7.3.1.5.3.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">71.42±0.62</td>
<td id="S4.T7.3.1.5.3.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">68.19±0.81</td>
<td id="S4.T7.3.1.5.3.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">67.62±0.75</td>
<td id="S4.T7.3.1.5.3.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">41.37±0.50</td>
<td id="S4.T7.3.1.5.3.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.87±0.69</td>
<td id="S4.T7.3.1.5.3.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">34.55±0.72</td>
<td id="S4.T7.3.1.5.3.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">34.17±0.65</td>
<td id="S4.T7.3.1.5.3.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">33.75±0.58</td>
</tr>
<tr id="S4.T7.3.1.6.4" class="ltx_tr">
<th id="S4.T7.3.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedBN</th>
<td id="S4.T7.3.1.6.4.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">84.93±0.53</td>
<td id="S4.T7.3.1.6.4.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">75.41±0.37</td>
<td id="S4.T7.3.1.6.4.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">71.79±0.63</td>
<td id="S4.T7.3.1.6.4.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">69.57±0.56</td>
<td id="S4.T7.3.1.6.4.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">68.70±0.47</td>
<td id="S4.T7.3.1.6.4.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">33.+1±0.04</td>
<td id="S4.T7.3.1.6.4.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">28.70±0.46</td>
<td id="S4.T7.3.1.6.4.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.07±0.45</td>
<td id="S4.T7.3.1.6.4.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.13±0.35</td>
<td id="S4.T7.3.1.6.4.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.08±0.39</td>
</tr>
<tr id="S4.T7.3.1.7.5" class="ltx_tr">
<th id="S4.T7.3.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedTP</th>
<td id="S4.T7.3.1.7.5.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.2.1" class="ltx_text ltx_font_bold">87.67±0.15</span></td>
<td id="S4.T7.3.1.7.5.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.3.1" class="ltx_text ltx_font_bold">80.27±0.28</span></td>
<td id="S4.T7.3.1.7.5.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.4.1" class="ltx_text ltx_font_bold">75.75±0.26</span></td>
<td id="S4.T7.3.1.7.5.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.5.1" class="ltx_text ltx_font_bold">73.16±0.25</span></td>
<td id="S4.T7.3.1.7.5.6" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.6.1" class="ltx_text ltx_font_bold">72.12±0.27</span></td>
<td id="S4.T7.3.1.7.5.7" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.7.1" class="ltx_text ltx_font_bold">48.27±0.26</span></td>
<td id="S4.T7.3.1.7.5.8" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.8.1" class="ltx_text ltx_font_bold">41.98±0.22</span></td>
<td id="S4.T7.3.1.7.5.9" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.9.1" class="ltx_text ltx_font_bold">38.83±0.23</span></td>
<td id="S4.T7.3.1.7.5.10" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.10.1" class="ltx_text ltx_font_bold">38.06±0.31</span></td>
<td id="S4.T7.3.1.7.5.11" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T7.3.1.7.5.11.1" class="ltx_text ltx_font_bold">38.06±0.22</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VIII: </span>The test accuracy of FedTP and FedAvg-T on image datasets over 50 clients with different numbers of self-attention blocks in ViT.</figcaption>
<div id="S4.T8.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:109.6pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-95.2pt,26.6pt) scale(0.6720800562265,0.6720800562265) ;">
<table id="S4.T8.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T8.1.1.1.1" class="ltx_tr">
<th id="S4.T8.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></th>
<th id="S4.T8.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="4">FedAvg-T</th>
<th id="S4.T8.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="4">FedTP</th>
</tr>
<tr id="S4.T8.1.1.2.2" class="ltx_tr">
<th id="S4.T8.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">Block number</th>
<th id="S4.T8.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR-10</th>
<th id="S4.T8.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR-100</th>
<th id="S4.T8.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR-10</th>
<th id="S4.T8.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR-100</th>
</tr>
<tr id="S4.T8.1.1.3.3" class="ltx_tr">
<th id="S4.T8.1.1.3.3.1" class="ltx_td ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;"></th>
<th id="S4.T8.1.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T8.1.1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
<th id="S4.T8.1.1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T8.1.1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
<th id="S4.T8.1.1.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T8.1.1.3.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
<th id="S4.T8.1.1.3.3.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T8.1.1.3.3.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T8.1.1.4.1" class="ltx_tr">
<th id="S4.T8.1.1.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">1</th>
<td id="S4.T8.1.1.4.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.40±5.48</td>
<td id="S4.T8.1.1.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">49.38±2.60</td>
<td id="S4.T8.1.1.4.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">23.05±1.03</td>
<td id="S4.T8.1.1.4.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.02±0.44</td>
<td id="S4.T8.1.1.4.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">85.15±0.17</td>
<td id="S4.T8.1.1.4.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">72.56±0.24</td>
<td id="S4.T8.1.1.4.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">59.02±0.30</td>
<td id="S4.T8.1.1.4.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">34.97±0.23</td>
</tr>
<tr id="S4.T8.1.1.5.2" class="ltx_tr">
<th id="S4.T8.1.1.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">2</th>
<td id="S4.T8.1.1.5.2.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">46.58±4.11</td>
<td id="S4.T8.1.1.5.2.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">55.82±2.31</td>
<td id="S4.T8.1.1.5.2.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.58±1.04</td>
<td id="S4.T8.1.1.5.2.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">32.92±0.51</td>
<td id="S4.T8.1.1.5.2.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">88.42±0.17</td>
<td id="S4.T8.1.1.5.2.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.04±0.23</td>
<td id="S4.T8.1.1.5.2.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">64.40±0.22</td>
<td id="S4.T8.1.1.5.2.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">41.20±0.27</td>
</tr>
<tr id="S4.T8.1.1.6.3" class="ltx_tr">
<th id="S4.T8.1.1.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">4</th>
<td id="S4.T8.1.1.6.3.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">50.21±4.18</td>
<td id="S4.T8.1.1.6.3.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">60.19±1.75</td>
<td id="S4.T8.1.1.6.3.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">31.65±0.85</td>
<td id="S4.T8.1.1.6.3.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.23±0.37</td>
<td id="S4.T8.1.1.6.3.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">89.58±0.12</td>
<td id="S4.T8.1.1.6.3.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">78.86±0.26</td>
<td id="S4.T8.1.1.6.3.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">66.35±0.21</td>
<td id="S4.T8.1.1.6.3.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">43.90±0.26</td>
</tr>
<tr id="S4.T8.1.1.7.4" class="ltx_tr">
<th id="S4.T8.1.1.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">6</th>
<td id="S4.T8.1.1.7.4.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">49.75±4.12</td>
<td id="S4.T8.1.1.7.4.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.34±1.48</td>
<td id="S4.T8.1.1.7.4.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">31.74±0.73</td>
<td id="S4.T8.1.1.7.4.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.15±0.32</td>
<td id="S4.T8.1.1.7.4.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">89.95±0.15</td>
<td id="S4.T8.1.1.7.4.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">80.00±0.34</td>
<td id="S4.T8.1.1.7.4.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">66.51±0.35</td>
<td id="S4.T8.1.1.7.4.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">43.69±0.17</td>
</tr>
<tr id="S4.T8.1.1.8.5" class="ltx_tr">
<th id="S4.T8.1.1.8.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">8</th>
<td id="S4.T8.1.1.8.5.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T8.1.1.8.5.2.1" class="ltx_text ltx_font_bold">50.42±4.22</span></td>
<td id="S4.T8.1.1.8.5.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.85±1.52</td>
<td id="S4.T8.1.1.8.5.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T8.1.1.8.5.4.1" class="ltx_text ltx_font_bold">34.02±0.88</span></td>
<td id="S4.T8.1.1.8.5.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T8.1.1.8.5.5.1" class="ltx_text ltx_font_bold">38.64±0.22</span></td>
<td id="S4.T8.1.1.8.5.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T8.1.1.8.5.6.1" class="ltx_text ltx_font_bold">90.31±0.26</span></td>
<td id="S4.T8.1.1.8.5.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">81.24±0.17</td>
<td id="S4.T8.1.1.8.5.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">68.05±0.24</td>
<td id="S4.T8.1.1.8.5.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T8.1.1.8.5.9.1" class="ltx_text ltx_font_bold">46.35±0.29</span></td>
</tr>
<tr id="S4.T8.1.1.9.6" class="ltx_tr">
<th id="S4.T8.1.1.9.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">10</th>
<td id="S4.T8.1.1.9.6.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">46.73±4.43</td>
<td id="S4.T8.1.1.9.6.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T8.1.1.9.6.3.1" class="ltx_text ltx_font_bold">62.17±1.57</span></td>
<td id="S4.T8.1.1.9.6.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">33.46±0.82</td>
<td id="S4.T8.1.1.9.6.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">37.52±0.21</td>
<td id="S4.T8.1.1.9.6.6" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">89.98±0.26</td>
<td id="S4.T8.1.1.9.6.7" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T8.1.1.9.6.7.1" class="ltx_text ltx_font_bold">82.02±0.21</span></td>
<td id="S4.T8.1.1.9.6.8" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T8.1.1.9.6.8.1" class="ltx_text ltx_font_bold">69.14±0.44</span></td>
<td id="S4.T8.1.1.9.6.9" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">45.42±0.26</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F10" class="ltx_figure"><img src="/html/2211.01572/assets/figure/noise_figure.png" id="S4.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>(a) The test accuracy of FedTP and other benchmark methods on CIFAR-10 with different levels of noise; (b) We use different colors to present the different severity of noise, and the points denote the test accuracy of different clients in those different settings while the dotted line presenting the average test accuracy of all clients.</figcaption>
</figure>
<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.4" class="ltx_p"><em id="S4.SS3.p1.4.1" class="ltx_emph ltx_font_italic">1) Effect of Heterogeneity in Label Distribution:</em>
Data heterogeneity is the key problem that Personalized federated learning aims to solve. We have shown that FedTP outperforms various benchmark methods under several settings. Here, we concentrated on the label distribution heterogeneity. In previous experiments, we tested model performance with this heterogeneity by sampling class in each client following Dirichlet distribution with <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\alpha</annotation></semantics></math>=0.3. Now we explore more complete cases with <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\alpha\in" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><in id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></in><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝛼</ci><csymbol cd="latexml" id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\alpha\in</annotation></semantics></math> <math id="S4.SS3.p1.3.m3.5" class="ltx_Math" alttext="\{0.1,0.3,0.5,0.7,0.9\}" display="inline"><semantics id="S4.SS3.p1.3.m3.5a"><mrow id="S4.SS3.p1.3.m3.5.6.2" xref="S4.SS3.p1.3.m3.5.6.1.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.5.6.2.1" xref="S4.SS3.p1.3.m3.5.6.1.cmml">{</mo><mn id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">0.1</mn><mo id="S4.SS3.p1.3.m3.5.6.2.2" xref="S4.SS3.p1.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.p1.3.m3.2.2" xref="S4.SS3.p1.3.m3.2.2.cmml">0.3</mn><mo id="S4.SS3.p1.3.m3.5.6.2.3" xref="S4.SS3.p1.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.p1.3.m3.3.3" xref="S4.SS3.p1.3.m3.3.3.cmml">0.5</mn><mo id="S4.SS3.p1.3.m3.5.6.2.4" xref="S4.SS3.p1.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.p1.3.m3.4.4" xref="S4.SS3.p1.3.m3.4.4.cmml">0.7</mn><mo id="S4.SS3.p1.3.m3.5.6.2.5" xref="S4.SS3.p1.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.p1.3.m3.5.5" xref="S4.SS3.p1.3.m3.5.5.cmml">0.9</mn><mo stretchy="false" id="S4.SS3.p1.3.m3.5.6.2.6" xref="S4.SS3.p1.3.m3.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.5b"><set id="S4.SS3.p1.3.m3.5.6.1.cmml" xref="S4.SS3.p1.3.m3.5.6.2"><cn type="float" id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">0.1</cn><cn type="float" id="S4.SS3.p1.3.m3.2.2.cmml" xref="S4.SS3.p1.3.m3.2.2">0.3</cn><cn type="float" id="S4.SS3.p1.3.m3.3.3.cmml" xref="S4.SS3.p1.3.m3.3.3">0.5</cn><cn type="float" id="S4.SS3.p1.3.m3.4.4.cmml" xref="S4.SS3.p1.3.m3.4.4">0.7</cn><cn type="float" id="S4.SS3.p1.3.m3.5.5.cmml" xref="S4.SS3.p1.3.m3.5.5">0.9</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.5c">\{0.1,0.3,0.5,0.7,0.9\}</annotation></semantics></math> for CIFAR-10 and CIFAR-100 datasets. The level of data heterogeneity is higher with a smaller <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\alpha</annotation></semantics></math>. We set FedAvg-T as baseline and then compared FedTP with various personalized algorithms including FedPer-T, pFedHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">From the results in Table <a href="#S4.T7" title="TABLE VII ‣ IV-C Ablation Study ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>, it can be easily found that with a higher degree of data heterogeneity, performance for FedAvg-T decreases while performance for methods with personalized modules increases. Among these methods, FedTP outperforms them in every case and is much more robust. Hence, FedTP could well overcome label distribution heterogeneity in a wide range.
As <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\alpha</annotation></semantics></math> increases, some personalized federated learning algorithms may fail to make full use of heterogeneity in each client and even falls behind FedAvg-T in accuracy. FedTP, however, is still able to work well. This indicates that FedTP could better mine and exploit heterogeneity among clients even if heterogeneity is not so prominent.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.6" class="ltx_p"><em id="S4.SS3.p3.6.1" class="ltx_emph ltx_font_italic">2) Effect of Heterogeneity in Noise-based Feature Imbalance:</em>
Generally, noise is another significant factor that may cause data heterogeneity. In the real world, even though each client’s data distribution is similar, they may still suffer from different levels of noise and this will lead to feature imbalance among clients. Therefore, we explored the effect of such imbalance with a new partition method. For each client, we add increasing level of random Gaussian noise with mean <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="\mu=0" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mrow id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">μ</mi><mo id="S4.SS3.p3.1.m1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><eq id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1"></eq><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝜇</ci><cn type="integer" id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\mu=0</annotation></semantics></math> and each client’s standard deviation is derived by <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="\sigma_{i}=\frac{\sigma_{M}}{N-1}*i" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mrow id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><msub id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2.2" xref="S4.SS3.p3.2.m2.1.1.2.2.cmml">σ</mi><mi id="S4.SS3.p3.2.m2.1.1.2.3" xref="S4.SS3.p3.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p3.2.m2.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml"><mfrac id="S4.SS3.p3.2.m2.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.3.2.cmml"><msub id="S4.SS3.p3.2.m2.1.1.3.2.2" xref="S4.SS3.p3.2.m2.1.1.3.2.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.2.2.2" xref="S4.SS3.p3.2.m2.1.1.3.2.2.2.cmml">σ</mi><mi id="S4.SS3.p3.2.m2.1.1.3.2.2.3" xref="S4.SS3.p3.2.m2.1.1.3.2.2.3.cmml">M</mi></msub><mrow id="S4.SS3.p3.2.m2.1.1.3.2.3" xref="S4.SS3.p3.2.m2.1.1.3.2.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.2.3.2" xref="S4.SS3.p3.2.m2.1.1.3.2.3.2.cmml">N</mi><mo id="S4.SS3.p3.2.m2.1.1.3.2.3.1" xref="S4.SS3.p3.2.m2.1.1.3.2.3.1.cmml">−</mo><mn id="S4.SS3.p3.2.m2.1.1.3.2.3.3" xref="S4.SS3.p3.2.m2.1.1.3.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p3.2.m2.1.1.3.1" xref="S4.SS3.p3.2.m2.1.1.3.1.cmml">∗</mo><mi id="S4.SS3.p3.2.m2.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.cmml">i</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><eq id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1"></eq><apply id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2.2">𝜎</ci><ci id="S4.SS3.p3.2.m2.1.1.2.3.cmml" xref="S4.SS3.p3.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3"><times id="S4.SS3.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.1"></times><apply id="S4.SS3.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2"><divide id="S4.SS3.p3.2.m2.1.1.3.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2"></divide><apply id="S4.SS3.p3.2.m2.1.1.3.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.3.2.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.3.2.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2.2.2">𝜎</ci><ci id="S4.SS3.p3.2.m2.1.1.3.2.2.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2.2.3">𝑀</ci></apply><apply id="S4.SS3.p3.2.m2.1.1.3.2.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2.3"><minus id="S4.SS3.p3.2.m2.1.1.3.2.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2.3.1"></minus><ci id="S4.SS3.p3.2.m2.1.1.3.2.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2.3.2">𝑁</ci><cn type="integer" id="S4.SS3.p3.2.m2.1.1.3.2.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.2.m2.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\sigma_{i}=\frac{\sigma_{M}}{N-1}*i</annotation></semantics></math>, where <math id="S4.SS3.p3.3.m3.4" class="ltx_Math" alttext="i\in\{0,1,\cdots,N-1\}" display="inline"><semantics id="S4.SS3.p3.3.m3.4a"><mrow id="S4.SS3.p3.3.m3.4.4" xref="S4.SS3.p3.3.m3.4.4.cmml"><mi id="S4.SS3.p3.3.m3.4.4.3" xref="S4.SS3.p3.3.m3.4.4.3.cmml">i</mi><mo id="S4.SS3.p3.3.m3.4.4.2" xref="S4.SS3.p3.3.m3.4.4.2.cmml">∈</mo><mrow id="S4.SS3.p3.3.m3.4.4.1.1" xref="S4.SS3.p3.3.m3.4.4.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.3.m3.4.4.1.1.2" xref="S4.SS3.p3.3.m3.4.4.1.2.cmml">{</mo><mn id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">0</mn><mo id="S4.SS3.p3.3.m3.4.4.1.1.3" xref="S4.SS3.p3.3.m3.4.4.1.2.cmml">,</mo><mn id="S4.SS3.p3.3.m3.2.2" xref="S4.SS3.p3.3.m3.2.2.cmml">1</mn><mo id="S4.SS3.p3.3.m3.4.4.1.1.4" xref="S4.SS3.p3.3.m3.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="S4.SS3.p3.3.m3.3.3" xref="S4.SS3.p3.3.m3.3.3.cmml">⋯</mi><mo id="S4.SS3.p3.3.m3.4.4.1.1.5" xref="S4.SS3.p3.3.m3.4.4.1.2.cmml">,</mo><mrow id="S4.SS3.p3.3.m3.4.4.1.1.1" xref="S4.SS3.p3.3.m3.4.4.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.4.4.1.1.1.2" xref="S4.SS3.p3.3.m3.4.4.1.1.1.2.cmml">N</mi><mo id="S4.SS3.p3.3.m3.4.4.1.1.1.1" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.cmml">−</mo><mn id="S4.SS3.p3.3.m3.4.4.1.1.1.3" xref="S4.SS3.p3.3.m3.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS3.p3.3.m3.4.4.1.1.6" xref="S4.SS3.p3.3.m3.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.4b"><apply id="S4.SS3.p3.3.m3.4.4.cmml" xref="S4.SS3.p3.3.m3.4.4"><in id="S4.SS3.p3.3.m3.4.4.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2"></in><ci id="S4.SS3.p3.3.m3.4.4.3.cmml" xref="S4.SS3.p3.3.m3.4.4.3">𝑖</ci><set id="S4.SS3.p3.3.m3.4.4.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1"><cn type="integer" id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">0</cn><cn type="integer" id="S4.SS3.p3.3.m3.2.2.cmml" xref="S4.SS3.p3.3.m3.2.2">1</cn><ci id="S4.SS3.p3.3.m3.3.3.cmml" xref="S4.SS3.p3.3.m3.3.3">⋯</ci><apply id="S4.SS3.p3.3.m3.4.4.1.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1"><minus id="S4.SS3.p3.3.m3.4.4.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1"></minus><ci id="S4.SS3.p3.3.m3.4.4.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1.2">𝑁</ci><cn type="integer" id="S4.SS3.p3.3.m3.4.4.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.4c">i\in\{0,1,\cdots,N-1\}</annotation></semantics></math>. In detail, we let the client number <math id="S4.SS3.p3.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p3.4.m4.1a"><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">N</annotation></semantics></math> be 10 with <math id="S4.SS3.p3.5.m5.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S4.SS3.p3.5.m5.1a"><mrow id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mn id="S4.SS3.p3.5.m5.1.1.2" xref="S4.SS3.p3.5.m5.1.1.2.cmml">50</mn><mo id="S4.SS3.p3.5.m5.1.1.1" xref="S4.SS3.p3.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="latexml" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1.1">percent</csymbol><cn type="integer" id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">50\%</annotation></semantics></math> participation rate and conduct a series of experiments with <math id="S4.SS3.p3.6.m6.5" class="ltx_Math" alttext="\sigma_{M}\in\{0,5,10,15,20\}" display="inline"><semantics id="S4.SS3.p3.6.m6.5a"><mrow id="S4.SS3.p3.6.m6.5.6" xref="S4.SS3.p3.6.m6.5.6.cmml"><msub id="S4.SS3.p3.6.m6.5.6.2" xref="S4.SS3.p3.6.m6.5.6.2.cmml"><mi id="S4.SS3.p3.6.m6.5.6.2.2" xref="S4.SS3.p3.6.m6.5.6.2.2.cmml">σ</mi><mi id="S4.SS3.p3.6.m6.5.6.2.3" xref="S4.SS3.p3.6.m6.5.6.2.3.cmml">M</mi></msub><mo id="S4.SS3.p3.6.m6.5.6.1" xref="S4.SS3.p3.6.m6.5.6.1.cmml">∈</mo><mrow id="S4.SS3.p3.6.m6.5.6.3.2" xref="S4.SS3.p3.6.m6.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS3.p3.6.m6.5.6.3.2.1" xref="S4.SS3.p3.6.m6.5.6.3.1.cmml">{</mo><mn id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml">0</mn><mo id="S4.SS3.p3.6.m6.5.6.3.2.2" xref="S4.SS3.p3.6.m6.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p3.6.m6.2.2" xref="S4.SS3.p3.6.m6.2.2.cmml">5</mn><mo id="S4.SS3.p3.6.m6.5.6.3.2.3" xref="S4.SS3.p3.6.m6.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p3.6.m6.3.3" xref="S4.SS3.p3.6.m6.3.3.cmml">10</mn><mo id="S4.SS3.p3.6.m6.5.6.3.2.4" xref="S4.SS3.p3.6.m6.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p3.6.m6.4.4" xref="S4.SS3.p3.6.m6.4.4.cmml">15</mn><mo id="S4.SS3.p3.6.m6.5.6.3.2.5" xref="S4.SS3.p3.6.m6.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p3.6.m6.5.5" xref="S4.SS3.p3.6.m6.5.5.cmml">20</mn><mo stretchy="false" id="S4.SS3.p3.6.m6.5.6.3.2.6" xref="S4.SS3.p3.6.m6.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.5b"><apply id="S4.SS3.p3.6.m6.5.6.cmml" xref="S4.SS3.p3.6.m6.5.6"><in id="S4.SS3.p3.6.m6.5.6.1.cmml" xref="S4.SS3.p3.6.m6.5.6.1"></in><apply id="S4.SS3.p3.6.m6.5.6.2.cmml" xref="S4.SS3.p3.6.m6.5.6.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.5.6.2.1.cmml" xref="S4.SS3.p3.6.m6.5.6.2">subscript</csymbol><ci id="S4.SS3.p3.6.m6.5.6.2.2.cmml" xref="S4.SS3.p3.6.m6.5.6.2.2">𝜎</ci><ci id="S4.SS3.p3.6.m6.5.6.2.3.cmml" xref="S4.SS3.p3.6.m6.5.6.2.3">𝑀</ci></apply><set id="S4.SS3.p3.6.m6.5.6.3.1.cmml" xref="S4.SS3.p3.6.m6.5.6.3.2"><cn type="integer" id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">0</cn><cn type="integer" id="S4.SS3.p3.6.m6.2.2.cmml" xref="S4.SS3.p3.6.m6.2.2">5</cn><cn type="integer" id="S4.SS3.p3.6.m6.3.3.cmml" xref="S4.SS3.p3.6.m6.3.3">10</cn><cn type="integer" id="S4.SS3.p3.6.m6.4.4.cmml" xref="S4.SS3.p3.6.m6.4.4">15</cn><cn type="integer" id="S4.SS3.p3.6.m6.5.5.cmml" xref="S4.SS3.p3.6.m6.5.5">20</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.5c">\sigma_{M}\in\{0,5,10,15,20\}</annotation></semantics></math>. We compared FedTP with various personalized federated methods. Fig. <a href="#S4.F10" title="Figure 10 ‣ IV-C Ablation Study ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>(a) demonstrates that our FedTP leads to other methods in all different cases. This means FedTP could deal with client-specific noise well. Furthermore, Fig. <a href="#S4.F10" title="Figure 10 ‣ IV-C Ablation Study ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>(b) shows the average test accuracy of all clients and the test accuracy of each client in FedTP for different levels of noise.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p"><em id="S4.SS3.p4.1.1" class="ltx_emph ltx_font_italic">3) Impact of the Self-Attention Block Number:</em>
Here we examined the impact of self-attention block number with its value <math id="S4.SS3.p4.1.m1.6" class="ltx_Math" alttext="L\in\{1,2,4,6,8,10\}" display="inline"><semantics id="S4.SS3.p4.1.m1.6a"><mrow id="S4.SS3.p4.1.m1.6.7" xref="S4.SS3.p4.1.m1.6.7.cmml"><mi id="S4.SS3.p4.1.m1.6.7.2" xref="S4.SS3.p4.1.m1.6.7.2.cmml">L</mi><mo id="S4.SS3.p4.1.m1.6.7.1" xref="S4.SS3.p4.1.m1.6.7.1.cmml">∈</mo><mrow id="S4.SS3.p4.1.m1.6.7.3.2" xref="S4.SS3.p4.1.m1.6.7.3.1.cmml"><mo stretchy="false" id="S4.SS3.p4.1.m1.6.7.3.2.1" xref="S4.SS3.p4.1.m1.6.7.3.1.cmml">{</mo><mn id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">1</mn><mo id="S4.SS3.p4.1.m1.6.7.3.2.2" xref="S4.SS3.p4.1.m1.6.7.3.1.cmml">,</mo><mn id="S4.SS3.p4.1.m1.2.2" xref="S4.SS3.p4.1.m1.2.2.cmml">2</mn><mo id="S4.SS3.p4.1.m1.6.7.3.2.3" xref="S4.SS3.p4.1.m1.6.7.3.1.cmml">,</mo><mn id="S4.SS3.p4.1.m1.3.3" xref="S4.SS3.p4.1.m1.3.3.cmml">4</mn><mo id="S4.SS3.p4.1.m1.6.7.3.2.4" xref="S4.SS3.p4.1.m1.6.7.3.1.cmml">,</mo><mn id="S4.SS3.p4.1.m1.4.4" xref="S4.SS3.p4.1.m1.4.4.cmml">6</mn><mo id="S4.SS3.p4.1.m1.6.7.3.2.5" xref="S4.SS3.p4.1.m1.6.7.3.1.cmml">,</mo><mn id="S4.SS3.p4.1.m1.5.5" xref="S4.SS3.p4.1.m1.5.5.cmml">8</mn><mo id="S4.SS3.p4.1.m1.6.7.3.2.6" xref="S4.SS3.p4.1.m1.6.7.3.1.cmml">,</mo><mn id="S4.SS3.p4.1.m1.6.6" xref="S4.SS3.p4.1.m1.6.6.cmml">10</mn><mo stretchy="false" id="S4.SS3.p4.1.m1.6.7.3.2.7" xref="S4.SS3.p4.1.m1.6.7.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.6b"><apply id="S4.SS3.p4.1.m1.6.7.cmml" xref="S4.SS3.p4.1.m1.6.7"><in id="S4.SS3.p4.1.m1.6.7.1.cmml" xref="S4.SS3.p4.1.m1.6.7.1"></in><ci id="S4.SS3.p4.1.m1.6.7.2.cmml" xref="S4.SS3.p4.1.m1.6.7.2">𝐿</ci><set id="S4.SS3.p4.1.m1.6.7.3.1.cmml" xref="S4.SS3.p4.1.m1.6.7.3.2"><cn type="integer" id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">1</cn><cn type="integer" id="S4.SS3.p4.1.m1.2.2.cmml" xref="S4.SS3.p4.1.m1.2.2">2</cn><cn type="integer" id="S4.SS3.p4.1.m1.3.3.cmml" xref="S4.SS3.p4.1.m1.3.3">4</cn><cn type="integer" id="S4.SS3.p4.1.m1.4.4.cmml" xref="S4.SS3.p4.1.m1.4.4">6</cn><cn type="integer" id="S4.SS3.p4.1.m1.5.5.cmml" xref="S4.SS3.p4.1.m1.5.5">8</cn><cn type="integer" id="S4.SS3.p4.1.m1.6.6.cmml" xref="S4.SS3.p4.1.m1.6.6">10</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.6c">L\in\{1,2,4,6,8,10\}</annotation></semantics></math>. Table <a href="#S4.T8" title="TABLE VIII ‣ IV-C Ablation Study ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VIII</span></a> shows results for FedTP with different block numbers. As can be seen, accumulating attention blocks will help the model develop a better ability to catch its data heterogeneity and improve model behavior to a certain extent. According to this table’s results, we choose 8 as our FedTP’s default attention block number for CIFAR-10 and CIFAR-100.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p"><em id="S4.SS3.p5.1.1" class="ltx_emph ltx_font_italic">4) Impact of Client Sample Rate:</em>
To explore how the number of participated client impacts model performance, we implemented experiments with sample rate <math id="S4.SS3.p5.1.m1.5" class="ltx_Math" alttext="s\in\{0.05,0.1,0.15,0.2,0.25\}" display="inline"><semantics id="S4.SS3.p5.1.m1.5a"><mrow id="S4.SS3.p5.1.m1.5.6" xref="S4.SS3.p5.1.m1.5.6.cmml"><mi id="S4.SS3.p5.1.m1.5.6.2" xref="S4.SS3.p5.1.m1.5.6.2.cmml">s</mi><mo id="S4.SS3.p5.1.m1.5.6.1" xref="S4.SS3.p5.1.m1.5.6.1.cmml">∈</mo><mrow id="S4.SS3.p5.1.m1.5.6.3.2" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS3.p5.1.m1.5.6.3.2.1" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">{</mo><mn id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml">0.05</mn><mo id="S4.SS3.p5.1.m1.5.6.3.2.2" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.2.2" xref="S4.SS3.p5.1.m1.2.2.cmml">0.1</mn><mo id="S4.SS3.p5.1.m1.5.6.3.2.3" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.3.3" xref="S4.SS3.p5.1.m1.3.3.cmml">0.15</mn><mo id="S4.SS3.p5.1.m1.5.6.3.2.4" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.4.4" xref="S4.SS3.p5.1.m1.4.4.cmml">0.2</mn><mo id="S4.SS3.p5.1.m1.5.6.3.2.5" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.5.5" xref="S4.SS3.p5.1.m1.5.5.cmml">0.25</mn><mo stretchy="false" id="S4.SS3.p5.1.m1.5.6.3.2.6" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.5b"><apply id="S4.SS3.p5.1.m1.5.6.cmml" xref="S4.SS3.p5.1.m1.5.6"><in id="S4.SS3.p5.1.m1.5.6.1.cmml" xref="S4.SS3.p5.1.m1.5.6.1"></in><ci id="S4.SS3.p5.1.m1.5.6.2.cmml" xref="S4.SS3.p5.1.m1.5.6.2">𝑠</ci><set id="S4.SS3.p5.1.m1.5.6.3.1.cmml" xref="S4.SS3.p5.1.m1.5.6.3.2"><cn type="float" id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">0.05</cn><cn type="float" id="S4.SS3.p5.1.m1.2.2.cmml" xref="S4.SS3.p5.1.m1.2.2">0.1</cn><cn type="float" id="S4.SS3.p5.1.m1.3.3.cmml" xref="S4.SS3.p5.1.m1.3.3">0.15</cn><cn type="float" id="S4.SS3.p5.1.m1.4.4.cmml" xref="S4.SS3.p5.1.m1.4.4">0.2</cn><cn type="float" id="S4.SS3.p5.1.m1.5.5.cmml" xref="S4.SS3.p5.1.m1.5.5">0.25</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.5c">s\in\{0.05,0.1,0.15,0.2,0.25\}</annotation></semantics></math>. Fig. <a href="#S4.F11" title="Figure 11 ‣ IV-C Ablation Study ‣ IV Experiments ‣ FedTP: Federated Learning by Transformer Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> clearly illustrates that the performance of FedAvg-T is obviously affected by the sampling rate while our FedTP is relatively more stable. This phenomenon also reflects the robustness of FedTP.</p>
</div>
<figure id="S4.F11" class="ltx_figure"><img src="/html/2211.01572/assets/x7.png" id="S4.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="406" height="304" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>The test accuracy of FedTP and FedAvg-T of Dirichlet setting on CIFAR-100 over 100 clients with different client sample rates.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusions</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We have investigated the impact of self-attention under the federated learning framework and have revealed that FedAvg actually would degrade the performance of self-attention in non-IID scenarios.
To address this issue, we designed a novel Transformer-based federated learning framework called FedTP that learns personalized self-attention for each client while aggregating the other parameters among the clients. Instead of using the vanilla personalization mechanism that maintains the self-attention layers of each client locally, we proposed the <em id="S5.p1.1.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism to further encourage cooperation among clients and to increase the scalability and generalization of FedTP.
Specifically, the <em id="S5.p1.1.2" class="ltx_emph ltx_font_italic">learn-to-personalize</em> is realized by learning a hypernetwork on the server that outputs the personalized projection matrices of self-attention layers to generate client-wise queries, keys and values. Moreover, we also provided the generalization bound for FedTP with the <em id="S5.p1.1.3" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Comprehensive experiments have verified that FedTP with the <em id="S5.p2.1.1" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism delivers great performance in non-IID scenarios and outperforms state-of-the-art methods in personalized federated learning. Since FedTP learns a central hypernetwork over all clients, the model adapts better to novel clients
, which confirms its better generalization to novel clients with the <em id="S5.p2.1.2" class="ltx_emph ltx_font_italic">learn-to-personalize</em> mechanism. When the local datasets suffer from different levels of noise, the performance of FedTP is better than other benchmarks in all cases, which indicates that FedTP is more robust.
Notably, FedTP enjoys good compatibility with many advanced personalized federated learning methods, i.e., we can simply combine FedTP with these methods, including FedPer, FedRod and KNN-Per, etc to further enhance the model performance. It can be seen that these combined models have achieved better performance according to the experimental results. The primary limitation of FedTP is its slow training speed compared to CNNs-based federated learning models, a common issue of Transformer-based methods. A more computation-efficient and communication-efficient FedTP is under consideration for our future work.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pp. 1273–1282,
PMLR, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
F. Sattler, S. Wiedemann, K.-R. Müller, and W. Samek, “Robust and
communication-efficient federated learning from non-iid data,” <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">IEEE
transactions on neural networks and learning systems</span>, vol. 31, no. 9,
pp. 3400–3413, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
F. Sattler, K.-R. Müller, and W. Samek, “Clustered federated learning:
Model-agnostic distributed multitask optimization under privacy
constraints,” <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">IEEE transactions on neural networks and learning
systems</span>, vol. 32, no. 8, pp. 3710–3722, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Y. Shi, C.-T. Lin, Y.-C. Chang, W. Ding, Y. Shi, and X. Yao, “Consensus
learning for distributed fuzzy neural network in big data environment,” <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Emerging Topics in Computational Intelligence</span>, vol. 5,
no. 1, pp. 29–41, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
L. Zhang, Y. Shi, Y.-C. Chang, and C.-T. Lin, “Hierarchical fuzzy neural
networks with privacy preservation for heterogeneous big data,” <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">IEEE
Transactions on Fuzzy Systems</span>, vol. 29, no. 1, pp. 46–58, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Y. Shi, L. Zhang, Z. Cao, M. Tanveer, and C.-T. Lin, “Distributed
semisupervised fuzzy regression with interpolation consistency
regularization,” <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Fuzzy Systems</span>, vol. 30, no. 8,
pp. 3125–3137, 2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
R. Geirhos, P. Rubisch, C. Michaelis, M. Bethge, F. A. Wichmann, and
W. Brendel, “Imagenet-trained cnns are biased towards texture; increasing
shape bias improves accuracy and robustness,” <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">arXiv preprint
arXiv:1811.12231</span>, 2018.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
Ł. Kaiser, and I. Polosukhin, “Attention is all you need,” <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Advances
in neural information processing systems</span>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
P. Ramachandran, N. Parmar, A. Vaswani, I. Bello, A. Levskaya, and J. Shlens,
“Stand-alone self-attention in vision models,” <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Advances in Neural
Information Processing Systems</span>, vol. 32, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Bhojanapalli, A. Chakrabarti, D. Glasner, D. Li, T. Unterthiner, and
A. Veit, “Understanding robustness of transformers for image
classification,” in <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International
Conference on Computer Vision</span>, pp. 10231–10241, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
L. Qu, Y. Zhou, P. P. Liang, Y. Xia, F. Wang, E. Adeli, L. Fei-Fei, and
D. Rubin, “Rethinking architecture design for tackling data heterogeneity in
federated learning,” in <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition</span>, pp. 10061–10071, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai,
T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">et al.</span>,
“An image is worth 16x16 words: Transformers for image recognition at
scale,” <span id="bib.bib12.2.2" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2010.11929</span>, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
A. Krizhevsky, G. Hinton, <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">et al.</span>, “Learning multiple layers of features
from tiny images,” 2009.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
S. Abnar and W. Zuidema, “Quantifying attention flow in transformers,” <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2005.00928</span>, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
W. Zhang, F. Yu, X. Wang, X. Zeng, H. Zhao, Y. Tian, F.-Y. Wang, L. Li, and
Z. Li, “R<sup id="bib.bib15.2.1" class="ltx_sup">2</sup>fed: Resilient reinforcement federated learning for industrial
applications,” <span id="bib.bib15.3.2" class="ltx_text ltx_font_italic">IEEE Transactions on Industrial Informatics</span>, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
W. Zhang, X. Chen, K. He, L. Chen, L. Xu, X. Wang, and S. Yang,
“Semi-asynchronous personalized federated learning for short-term
photovoltaic power forecasting,” <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Digital Communications and Networks</span>,
2022.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
L. Zhang, Y. Shi, Y.-C. Chang, and C.-T. Lin, “Federated fuzzy neural network
with evolutionary rule learning,” <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Fuzzy Systems</span>,
2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
A. Z. Tan, H. Yu, L. Cui, and Q. Yang, “Towards personalized federated
learning,” <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</span>,
2022.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
K. Wang, R. Mathews, C. Kiddon, H. Eichner, F. Beaufays, and D. Ramage,
“Federated evaluation of on-device personalization,” <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv preprint
arXiv:1910.10252</span>, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Y. Mansour, M. Mohri, J. Ro, and A. T. Suresh, “Three approaches for
personalization with applications to federated learning,” <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">arXiv
preprint arXiv:2002.10619</span>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
A. Fallah, A. Mokhtari, and A. Ozdaglar, “Personalized federated learning with
theoretical guarantees: A model-agnostic meta-learning approach,” <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, vol. 33, pp. 3557–3568,
2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
M. Khodak, M.-F. F. Balcan, and A. S. Talwalkar, “Adaptive gradient-based
meta-learning methods,” <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing
Systems</span>, vol. 32, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated optimization in heterogeneous networks,” <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Proceedings of
Machine Learning and Systems</span>, vol. 2, pp. 429–450, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
C. T Dinh, N. Tran, and J. Nguyen, “Personalized federated learning with
moreau envelopes,” <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
vol. 33, pp. 21394–21405, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
T. Li, S. Hu, A. Beirami, and V. Smith, “Ditto: Fair and robust federated
learning through personalization,” in <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">International Conference on
Machine Learning</span>, pp. 6357–6368, PMLR, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
M. Mendieta, T. Yang, P. Wang, M. Lee, Z. Ding, and C. Chen, “Local learning
matters: Rethinking data heterogeneity in federated learning,” in <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern
Recognition</span>, pp. 8397–8406, 2022.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
F. Hanzely and P. Richtárik, “Federated learning of a mixture of global
and local models,” <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2002.05516</span>, 2020.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
P. P. Liang, T. Liu, L. Ziyin, N. B. Allen, R. P. Auerbach, D. Brent,
R. Salakhutdinov, and L.-P. Morency, “Think locally, act globally: Federated
learning with local and global representations,” <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">arXiv preprint
arXiv:2001.01523</span>, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
O. Marfoq, G. Neglia, R. Vidal, and L. Kameni, “Personalized federated
learning through local memorization,” in <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">International Conference on
Machine Learning</span>, pp. 15070–15092, PMLR, 2022.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
D. Li and J. Wang, “Fedmd: Heterogenous federated learning via model
distillation,” <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1910.03581</span>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Z. Zhu, J. Hong, and J. Zhou, “Data-free knowledge distillation for
heterogeneous federated learning,” in <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">International Conference on
Machine Learning</span>, pp. 12878–12889, PMLR, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
B. Liu, Y. Guo, and X. Chen, “Pfa: Privacy-preserving federated adaptation for
effective model personalization,” in <span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">Proceedings of the Web Conference
2021</span>, pp. 923–934, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. Huang, L. Chu, Z. Zhou, L. Wang, J. Liu, J. Pei, and Y. Zhang,
“Personalized cross-silo federated learning on non-iid data.,” in <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">AAAI</span>, pp. 7865–7873, 2021.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
M. G. Arivazhagan, V. Aggarwal, A. K. Singh, and S. Choudhary, “Federated
learning with personalization layers,” <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">arXiv preprint
arXiv:1912.00818</span>, 2019.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
L. Collins, H. Hassani, A. Mokhtari, and S. Shakkottai, “Exploiting shared
representations for personalized federated learning,” in <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">International
Conference on Machine Learning</span>, pp. 2089–2099, PMLR, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
X. Li, M. JIANG, X. Zhang, M. Kamp, and Q. Dou, “Fedbn: Federated learning on
non-iid features via local batch normalization,” in <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">International
Conference on Learning Representations</span>, 2020.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
I. Achituve, A. Shamsian, A. Navon, G. Chechik, and E. Fetaya, “Personalized
federated learning with gaussian processes,” <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">Advances in Neural
Information Processing Systems</span>, vol. 34, pp. 8392–8406, 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Z. Li, Y. He, H. Yu, J. Kang, X. Li, Z. Xu, and D. Niyato, “Data
heterogeneity-robust federated learning via group client selection in
industrial iot,” <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">IEEE Internet of Things Journal</span>, 2022.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
T. Shaik, X. Tao, N. Higgins, R. Gururajan, Y. Li, X. Zhou, and U. R. Acharya,
“Fedstack: Personalized activity monitoring using stacked federated
learning,” <span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">Knowledge-Based Systems</span>, vol. 257, p. 109929, 2022.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Z. Zhang, Y. Jiang, Y. Shi, Y. Shi, and W. Chen, “Federated reinforcement
learning for real-time electric vehicle charging and discharging control,”
in <span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">2022 IEEE Globecom Workshops (GC Wkshps)</span>, pp. 1717–1722, IEEE,
2022.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
S. Park, G. Kim, J. Kim, B. Kim, and J. C. Ye, “Federated split vision
transformer for covid-19cxr diagnosis using task-agnostic training,” <span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2111.01338</span>, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
D. Ha, A. Dai, and Q. V. Le, “Hypernetworks,” <span id="bib.bib42.1.1" class="ltx_text ltx_font_italic">arXiv preprint
arXiv:1609.09106</span>, 2016.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
A. Shamsian, A. Navon, E. Fetaya, and G. Chechik, “Personalized federated
learning using hypernetworks,” in <span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">International Conference on Machine
Learning</span>, pp. 9489–9502, PMLR, 2021.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
X. Ma, J. Zhang, S. Guo, and W. Xu, “Layer-wised model aggregation for
personalized federated learning,” in <span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition</span>, pp. 10092–10101,
2022.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
H.-Y. Chen and W.-L. Chao, “On bridging generic and personalized federated
learning,” <span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2022.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
S. Caldas, S. M. K. Duddu, P. Wu, T. Li, J. Konečnỳ, H. B. McMahan,
V. Smith, and A. Talwalkar, “Leaf: A benchmark for federated settings,”
<span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.01097</span>, 2018.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
S. Reddi, Z. Charles, M. Zaheer, Z. Garrett, K. Rush, J. Konečnỳ,
S. Kumar, and H. B. McMahan, “Adaptive federated optimization,” <span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">arXiv
preprint arXiv:2003.00295</span>, 2020.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner, “Gradient-based learning
applied to document recognition,” <span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, vol. 86,
no. 11, pp. 2278–2324, 1998.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
O. Marfoq, G. Neglia, A. Bellet, L. Kameni, and R. Vidal, “Federated
multi-task learning under a mixture of distributions,” <span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">Advances in
Neural Information Processing Systems</span>, vol. 34, pp. 15434–15447, 2021.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen,
Z. Lin, N. Gimelshein, L. Antiga, <span id="bib.bib50.1.1" class="ltx_text ltx_font_italic">et al.</span>, “Pytorch: An imperative
style, high-performance deep learning library,” <span id="bib.bib50.2.2" class="ltx_text ltx_font_italic">Advances in neural
information processing systems</span>, vol. 32, 2019.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
J. Johnson, M. Douze, and H. Jégou, “Billion-scale similarity search
with gpus,” <span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">CoRR</span>, vol. abs/1702.08734, 2017.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
L. Van der Maaten and G. Hinton, “Visualizing data using t-sne.,” <span id="bib.bib52.1.1" class="ltx_text ltx_font_italic">Journal of machine learning research</span>, vol. 9, no. 11, 2008.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2211.01571" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2211.01572" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2211.01572">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2211.01572" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2211.01573" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 06:01:12 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
