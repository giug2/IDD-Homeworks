<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  Adapting LLM Agents Through Communication
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    <span class="ltx_text ltx_font_bold" id="id1.1.1">
     Kuan Wang
     <sup class="ltx_sup" id="id1.1.1.1">
      <span class="ltx_text ltx_font_medium" id="id1.1.1.1.1">
       1
      </span>
     </sup>
    </span>
    ,
    <span class="ltx_text ltx_font_bold" id="id10.10.id1">
     Yadong Lu
    </span>
    <sup class="ltx_sup" id="id11.11.id2">
     2
    </sup>
    ,
    <span class="ltx_text ltx_font_bold" id="id3.3.2">
     Michael Santacroce
     <sup class="ltx_sup" id="id3.3.2.1">
      <span class="ltx_text ltx_font_medium ltx_font_italic" id="id3.3.2.1.1">
       2
      </span>
     </sup>
    </span>
    ,
    <span class="ltx_text ltx_font_bold" id="id4.4.3">
     Yeyun Gong
     <sup class="ltx_sup" id="id4.4.3.1">
      <span class="ltx_text ltx_font_medium ltx_font_italic" id="id4.4.3.1.1">
       3
      </span>
     </sup>
    </span>
    ,
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_bold" id="id5.5.4">
     Chao Zhang
     <sup class="ltx_sup" id="id5.5.4.1">
      <span class="ltx_text ltx_font_medium ltx_font_italic" id="id5.5.4.1.1">
       1
      </span>
     </sup>
    </span>
    ,
    <span class="ltx_text ltx_font_bold" id="id6.6.5">
     Yelong Shen
     <sup class="ltx_sup" id="id6.6.5.1">
      <span class="ltx_text ltx_font_medium ltx_font_italic" id="id6.6.5.1.1">
       2
      </span>
     </sup>
    </span>
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id12.12.id3">
     1
    </sup>
    Georgia Institute of Technology
    <sup class="ltx_sup" id="id13.13.id4">
     2
    </sup>
    Microsoft Azure AI
    <sup class="ltx_sup" id="id14.14.id5">
     3
    </sup>
    Microsoft Research
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id15.15.id6">
     {kuanwang, chaozhang}@gatech.edu
    </span>
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id16.16.id7">
     {yadonglu, misantac, yegong, yeshe}@microsoft.com
    </span>
   </span>
   <span class="ltx_author_notes">
    Work done during an internship at Microsoft
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id17.id1">
   Recent advancements in large language models (LLMs) have shown potential for human-like agents.
To help these agents adapt to new tasks without extensive human supervision, we propose the Learning through Communication (LTC) paradigm, a novel training approach enabling LLM agents to improve continuously through interactions with their environments and other agents.
Through iterative exploration and PPO training, LTC empowers the agent to assimilate short-term experiences into long-term memory.
To optimize agent interactions for task-specific learning, we introduce three structured communication patterns:
   <span class="ltx_text ltx_font_bold" id="id17.id1.1">
    Monologue
   </span>
   ,
   <span class="ltx_text ltx_font_bold" id="id17.id1.2">
    Dialogue
   </span>
   , and
   <span class="ltx_text ltx_font_bold" id="id17.id1.3">
    Analogue
   </span>
   —tailored for common tasks such as decision-making, knowledge-intensive reasoning, and numerical reasoning.
We evaluated LTC on three datasets: ALFWorld (decision-making), HotpotQA (knowledge-intensive reasoning), and GSM8k (numerical reasoning).
On
   <span class="ltx_text ltx_font_italic" id="id17.id1.4">
    ALFWorld
   </span>
   , it exceeds the instruction tuning baseline by 12% in success rate. On
   <span class="ltx_text ltx_font_italic" id="id17.id1.5">
    HotpotQA
   </span>
   , LTC surpasses the instruction tuned LLaMA-7B agent by 5.1% in EM score, and it outperforms the instruction tuned 9x larger PaLM-62B agent by 0.6%. On
   <span class="ltx_text ltx_font_italic" id="id17.id1.6">
    GSM8k
   </span>
   , LTC outperforms the CoT-Tuning baseline by 3.6% in accuracy. The results showcase the versatility and efficiency of the LTC approach across diverse domains. We will open-source our code to promote further development of the community.
  </p>
 </div>
 <section class="ltx_section ltx_indent_first" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para ltx_noindent" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Recent advances in large language models (LLMs) have shed light on human-like LLM agents
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib29" title="">
      29
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib6" title="">
      6
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib60" title="">
      60
     </a>
     ]
    </cite>
    . Previous works have explored how to employ the LLM as the agent’s brain, which is complemented by several key components such as planning, tool use, and memory. For planning, Chain of Thought (CoT
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib61" title="">
      61
     </a>
     ]
    </cite>
    ) prompts the model to think step by step, decomposing complex tasks into smaller and simpler steps. ReAct
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib65" title="">
      65
     </a>
     ]
    </cite>
    integrates reasoning and action within LLM, extending the action space to include both task-specific discrete actions (i.e., retrieval) and language generation. In addition, recent research has shown that LLM agents can be further augmented by using
    <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">
     external tools
    </em>
    to solve problems in interactive environments, which involve using retrieved knowledge
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib43" title="">
      43
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib65" title="">
      65
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib53" title="">
      53
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib17" title="">
      17
     </a>
     ]
    </cite>
    , math tools
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib41" title="">
      41
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib65" title="">
      65
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib23" title="">
      23
     </a>
     ]
    </cite>
    , and code interpreters
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib11" title="">
      11
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib54" title="">
      54
     </a>
     ]
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    However, adapting LLM agents to specific tasks remains challenging.
In order to adapt the generally pre-trained LLMs to task-specific environments, existing methods focus on In-context learning (ICL
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib5" title="">
      5
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib65" title="">
      65
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib44" title="">
      44
     </a>
     ]
    </cite>
    ) and supervised fine-tuning (SFT
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib29" title="">
      29
     </a>
     ]
    </cite>
    ). For example,
ICL utilizes few-shot prompts as a form of short-term memory
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib31" title="">
      31
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib44" title="">
      44
     </a>
     ]
    </cite>
    to adapt agents’ task-specific ability during inference, and
SFT typically requires high quality supervised training data for domain adaptation. However, both of these two approaches don’t leverage the rich feedbacks (i.e., positive/negative rewards, error message, hint etc) during the interaction with environment and external tools for continuously training.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    In this paper, we introduce a new training paradigm Learning through Communication (LTC), allowing the LLM agent to continuously adapt to new environments and tasks with an iterative pipeline.
Each iteration of LTC consists of two distinct phases: (1) the exploration phase where the agent interact with the environments and other agents to collect diverse trajectories and feedbacks, and (2) the training phase that updates the agent model based on these trajectories.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="76" id="S1.F1.g1" src="/html/2310.01444/assets/x1.png" width="302"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 1:
    </span>
    LTC continually adapts agents to new tasks by doing task-specific fine-tuning on the collected iterative interaction trajectories, removing the need for long and handcrafted few-shot examples as the prefix of the prompts in the inference time.
   </figcaption>
  </figure>
  <div class="ltx_para ltx_noindent" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    LTC method is a general learning paradigm that can be applied to diverse tasks, such as decision-making, knowledge-intensive reasoning, and numerical reasoning. To collect communication trajectories and reward signals, we designed three structured communication patterns: (1)
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">
     Monologue
    </span>
    allows a single agent to generate trajectories in a self-talk style and get interactive feedback from environments; (2)
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">
     Dialogue
    </span>
    enables the agent interacts with other agents and external tools, and utilizes feedback provided by the environments; (3)
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">
     Analogue
    </span>
    facilitates the agent to learn through new examples generated by the teacher agent, and also leverages feedback provided by the teacher agent instead of the environments.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    In addition, the training phase is based on reinforcement learning (RL), and our training loss combines the language modeling loss and the PPO loss
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib29" title="">
      29
     </a>
     ]
    </cite>
    to balance the language consistency and reward signals. We also designed a unified replay buffer to store trajectories from diverse environments, where each generated token is treated as an action in the RL formulation. We apply distinct masks to tokens generated by the system, LTC agents, and other agents, respectively. These masks are utilized to apply distinct loss functions to various token types. The replay buffer is updated after each exploration phase and a subset of the buffer is sampled for the training phase. Through this iterative process, the agent continuously adapts to new environments.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p6">
   <p class="ltx_p" id="S1.p6.1">
    We evaluate LTC method on three representative datasets:
    <span class="ltx_text ltx_font_italic" id="S1.p6.1.1">
     ALFWorld
    </span>
    for decision-making,
    <span class="ltx_text ltx_font_italic" id="S1.p6.1.2">
     HotpotQA
    </span>
    for knowledge-intensive reasoning, and
    <span class="ltx_text ltx_font_italic" id="S1.p6.1.3">
     GSM8k
    </span>
    for numerical reasoning. Throughout these experiments, LTC consistently outperforms the baselines.
In
    <span class="ltx_text ltx_font_italic" id="S1.p6.1.4">
     ALFWorld
    </span>
    , LTC outperforms the strong instruction tuning baseline by 12% on success rate, even in the challenging Pick 2 task. This shows that our communication mechanism enables the agent to learn from its experiences for task solving. On
    <span class="ltx_text ltx_font_italic" id="S1.p6.1.5">
     HotpotQA
    </span>
    , LTC outperforms the instruction tuning baseline
by 5.1% on EM score, and our LLaMA-7B based agent even obtains slightly better (0.6%) performance than the ReAct-Tuning baseline which uses 9
    <math alttext="\times" class="ltx_Math" display="inline" id="S1.p6.1.m1.1">
     <semantics id="S1.p6.1.m1.1a">
      <mo id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">
       ×
      </mo>
      <annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b">
       <times id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">
       </times>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">
       \times
      </annotation>
     </semantics>
    </math>
    larger PaLM-62B model. On
    <span class="ltx_text ltx_font_italic" id="S1.p6.1.6">
     GSM8k
    </span>
    , LTC also beats the CoT-Tuning baseline by 3.6% on accuracy. These results highlight the adaptability and effectiveness of LTC approach across varied domains.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p7">
   <p class="ltx_p" id="S1.p7.1">
    Our key contributions are summarized as follows:
   </p>
   <ol class="ltx_enumerate" id="S1.I1">
    <li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      1.
     </span>
     <div class="ltx_para" id="S1.I1.i1.p1">
      <p class="ltx_p" id="S1.I1.i1.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">
        Learning through Communication (LTC)
       </span>
       : We propose a new training paradigm named Learning through Communication (LTC), allowing the LLM agent to automatically adapt to new environments and tasks with an iterative pipeline.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      2.
     </span>
     <div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
      <p class="ltx_p" id="S1.I1.i2.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">
        Task-specific Communication Patterns
       </span>
       : The LTC paradigm allows flexible design of communication patterns for different tasks. Three specific patterns are introduced: Monologue, Dialogue, and Analogue. These patterns are composable to help generate diverse structured interaction and feedback signals for agent training for different types of tasks.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      3.
     </span>
     <div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
      <p class="ltx_p" id="S1.I1.i3.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">
        Empirical Study and Findings
       </span>
       : Through rigorous studies on public benchmark tasks, we demonstrate the effectiveness of LTC, and it could be a superior approach compared with instruction-tuning or prompting baselines.
      </p>
     </div>
    </li>
   </ol>
  </div>
 </section>
 <section class="ltx_section ltx_indent_first" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Work
  </h2>
  <figure class="ltx_figure" id="S2.F2">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="112" id="S2.F2.g1" src="/html/2310.01444/assets/x2.png" width="302"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 2:
    </span>
    LTC has an iterative two-phase framework. During the exploration phase, the agent proactively explores new environments and communicates with other agents, gathering the trails to update the replay buffer. Then the agent is trained for updating the policy in the training phase.
   </figcaption>
  </figure>
  <section class="ltx_subsection ltx_indent_first" id="S2.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.1
    </span>
    Instruction Tuning
   </h3>
   <div class="ltx_para ltx_noindent" id="S2.SS1.p1">
    <p class="ltx_p" id="S2.SS1.p1.1">
     Instruction tuning (IT) is an important technique for improving the capabilities and controllability of LLMs
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib35" title="">
       35
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib5" title="">
       5
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib60" title="">
       60
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib34" title="">
       34
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib28" title="">
       28
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib8" title="">
       8
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib52" title="">
       52
      </a>
      ]
     </cite>
     . Many studies have been dedicated to instruction data generation and selection
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib9" title="">
       9
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib57" title="">
       57
      </a>
      ]
     </cite>
     . For instance, Unnatural Instructions
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib13" title="">
       13
      </a>
      ]
     </cite>
     is created by using the Super-Natural Instructions dataset
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib58" title="">
       58
      </a>
      ]
     </cite>
     as a seed to prompt InstructGPT
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib29" title="">
       29
      </a>
      ]
     </cite>
     . Self-Instruct
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib57" title="">
       57
      </a>
      ]
     </cite>
     employs a recursive pipeline that generates instruction data from hand-crafted seed tasks using ChatGPT
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib27" title="">
       27
      </a>
      ]
     </cite>
     .
Other studies focus on fine-tuning pre-trained LLMs with instruction data. BLOOMZ
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib26" title="">
       26
      </a>
      ]
     </cite>
     is initialized with BLOOM
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib40" title="">
       40
      </a>
      ]
     </cite>
     and then fine-tuned using the xP3 instruction dataset
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib26" title="">
       26
      </a>
      ]
     </cite>
     . Flan-T5 is initialized with T5
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib37" title="">
       37
      </a>
      ]
     </cite>
     and fine-tuned with the FLAN dataset
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib21" title="">
       21
      </a>
      ]
     </cite>
     . Additionally, after the release of LLaMA
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib52" title="">
       52
      </a>
      ]
     </cite>
     , many works have utilized it as the base model for instruction tuning, such as Alpaca
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib51" title="">
       51
      </a>
      ]
     </cite>
     , Vicuna
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib7" title="">
       7
      </a>
      ]
     </cite>
     , and GPT-4-LLM
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib32" title="">
       32
      </a>
      ]
     </cite>
     .
Some papers explore alignment fine-tuning using RLHF
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib29" title="">
       29
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib3" title="">
       3
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib48" title="">
       48
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib18" title="">
       18
      </a>
      ]
     </cite>
     . InstructGPT
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib29" title="">
       29
      </a>
      ]
     </cite>
     employs GPT-3 for supervised fine-tuning on a human-filtered instruction dataset, followed by training a reward model and using PPO
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib42" title="">
       42
      </a>
      ]
     </cite>
     for RLHF. Claude investigates RLHF
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib3" title="">
       3
      </a>
      ]
     </cite>
     and constitutional approaches
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib4" title="">
       4
      </a>
      ]
     </cite>
     for making LLMs both harmless and helpful. DPO
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib36" title="">
       36
      </a>
      ]
     </cite>
     fine-tunes the LLMs to align with human preferences by directly optimizing a classification problem on preference data instead of RLHF. While these prominent research works focus on aligning LLMs for general instruction-following, our objective is to adapt LLM agents for specific tasks or environments.
    </p>
   </div>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="S2.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.2
    </span>
    LLM Agents
   </h3>
   <div class="ltx_para ltx_noindent" id="S2.SS2.p1">
    <p class="ltx_p" id="S2.SS2.p1.1">
     LLMs have demonstrated the potential to act as human-like agents
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib29" title="">
       29
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib6" title="">
       6
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib60" title="">
       60
      </a>
      ]
     </cite>
     , and significant progress has been made in developing versatile LLM agents
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib62" title="">
       62
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib49" title="">
       49
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib30" title="">
       30
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib20" title="">
       20
      </a>
      ]
     </cite>
     .
For planning, Chain-of-Thought (CoT
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib61" title="">
       61
      </a>
      ]
     </cite>
     ) prompts the model to think step by step, by decomposing complex tasks into smaller and simpler steps.
Self Consistency
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib55" title="">
       55
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib56" title="">
       56
      </a>
      ]
     </cite>
     extends CoT by using ensembles of predictions to improve consistency of the LLM.
Inner Monologue
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib16" title="">
       16
      </a>
      ]
     </cite>
     leverages environment feedback to enhance LLMs’ planning and processing capabilities in embodied robotics tasks without extra training.
ReAct
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib65" title="">
       65
      </a>
      ]
     </cite>
     integrates reasoning and action taking, expanding the action space to include both task-specific discrete actions and language.
Reflexion
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib44" title="">
       44
      </a>
      ]
     </cite>
     equips agents with dynamic memory and self-reflection capabilities to improve reasoning by using continuous trials in the same environment as feedback.
Recent research has also shown that LLMs can be augmented as an autonomous agent to use
     <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.1.1">
      external tools
     </em>
     to solve problems in interactive environments.
These techniques include retrieval augmentation
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib43" title="">
       43
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib65" title="">
       65
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib17" title="">
       17
      </a>
      ]
     </cite>
     , math tools
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib41" title="">
       41
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib65" title="">
       65
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib23" title="">
       23
      </a>
      ]
     </cite>
     , and code interpreters
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib11" title="">
       11
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib54" title="">
       54
      </a>
      ]
     </cite>
     .
Prior works also have explored using multiple LLMs in a collaborative setting to solve complex tasks
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib12" title="">
       12
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib33" title="">
       33
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib19" title="">
       19
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib59" title="">
       59
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib50" title="">
       50
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib1" title="">
       1
      </a>
      ]
     </cite>
     .
Open-source projects like AutoGPT
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib47" title="">
       47
      </a>
      ]
     </cite>
     , GPT-Engineer
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib2" title="">
       2
      </a>
      ]
     </cite>
     , and BabyAGI
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib66" title="">
       66
      </a>
      ]
     </cite>
     also showcase the potential of LLM not just in generating content but also as a general problem solver.
Most of the above methods are based on either human-designed few-shot prompting examples, or finetuning with pre-collected instruction datasets.
Our LTC is not a few-shot prompting method and we focus on adapting the agent by collecting training data automatically by exploration.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section ltx_indent_first" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Learning Through Communication
  </h2>
  <div class="ltx_para ltx_noindent" id="S3.p1">
   <p class="ltx_p" id="S3.p1.1">
    We design Learning Through Communication (LTC), an iterative training method for LLM agents to continuously adapt to new environments. As shown in Figure
    <a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Adapting LLM Agents Through Communication">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    , LTC iterates between two phases: (1) An exploration phase where agents can interact with new environments and other agents to collect trial data with feedback, and (2) a training phrase to fine-tune the agent to update the policy.
   </p>
  </div>
  <figure class="ltx_figure" id="S3.F3">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="133" id="S3.F3.g1" src="/html/2310.01444/assets/x3.png" width="296"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 3:
    </span>
    The toy examples to demonstrate communication patterns: 1) the left figure is the Dialogue pattern, where the GPT-4 agent play as a teacher to analyze the situation and give suggestion to the student agent who is responsible for making decisions. We can just assign the student agent to play the teacher agent when testing without GPT-4 agent. 2) the right figure is the Analogue pattern, where the student agent starts with an initial answer to the current question, and then the teacher directly corrects the answer with a reward. To help the student improve ability instead of just memorizing the solution, the teacher will generate another analogous question to ask the student. Eventually, the student gives a new answer for this analogous question and gets a new reward signal from the teacher.
   </figcaption>
  </figure>
  <section class="ltx_subsection ltx_indent_first" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Exploration Phase
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.9">
     At the start of each iteration, the agent explores the environments to get the trajectories and the reward signal data. We denote these data as a tuple:
     <math alttext="\mathcal{S}=(\mathcal{T},\mathcal{M},\mathcal{R})" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.3">
      <semantics id="S3.SS1.p1.1.m1.3a">
       <mrow id="S3.SS1.p1.1.m1.3.4" xref="S3.SS1.p1.1.m1.3.4.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.4.2" xref="S3.SS1.p1.1.m1.3.4.2.cmml">
         𝒮
        </mi>
        <mo id="S3.SS1.p1.1.m1.3.4.1" xref="S3.SS1.p1.1.m1.3.4.1.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p1.1.m1.3.4.3.2" xref="S3.SS1.p1.1.m1.3.4.3.1.cmml">
         <mo id="S3.SS1.p1.1.m1.3.4.3.2.1" stretchy="false" xref="S3.SS1.p1.1.m1.3.4.3.1.cmml">
          (
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">
          𝒯
         </mi>
         <mo id="S3.SS1.p1.1.m1.3.4.3.2.2" xref="S3.SS1.p1.1.m1.3.4.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">
          ℳ
         </mi>
         <mo id="S3.SS1.p1.1.m1.3.4.3.2.3" xref="S3.SS1.p1.1.m1.3.4.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml">
          ℛ
         </mi>
         <mo id="S3.SS1.p1.1.m1.3.4.3.2.4" stretchy="false" xref="S3.SS1.p1.1.m1.3.4.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b">
        <apply id="S3.SS1.p1.1.m1.3.4.cmml" xref="S3.SS1.p1.1.m1.3.4">
         <eq id="S3.SS1.p1.1.m1.3.4.1.cmml" xref="S3.SS1.p1.1.m1.3.4.1">
         </eq>
         <ci id="S3.SS1.p1.1.m1.3.4.2.cmml" xref="S3.SS1.p1.1.m1.3.4.2">
          𝒮
         </ci>
         <vector id="S3.SS1.p1.1.m1.3.4.3.1.cmml" xref="S3.SS1.p1.1.m1.3.4.3.2">
          <ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">
           𝒯
          </ci>
          <ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">
           ℳ
          </ci>
          <ci id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3">
           ℛ
          </ci>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">
        \mathcal{S}=(\mathcal{T},\mathcal{M},\mathcal{R})
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="\mathcal{T}=\{t_{1},t_{2},\dots,t_{n}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.4">
      <semantics id="S3.SS1.p1.2.m2.4a">
       <mrow id="S3.SS1.p1.2.m2.4.4" xref="S3.SS1.p1.2.m2.4.4.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.4.4.5" xref="S3.SS1.p1.2.m2.4.4.5.cmml">
         𝒯
        </mi>
        <mo id="S3.SS1.p1.2.m2.4.4.4" xref="S3.SS1.p1.2.m2.4.4.4.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p1.2.m2.4.4.3.3" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">
         <mo id="S3.SS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">
          {
         </mo>
         <msub id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml">
          <mi id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">
           t
          </mi>
          <mn id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">
           1
          </mn>
         </msub>
         <mo id="S3.SS1.p1.2.m2.4.4.3.3.5" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">
          ,
         </mo>
         <msub id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml">
          <mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml">
           t
          </mi>
          <mn id="S3.SS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">
           2
          </mn>
         </msub>
         <mo id="S3.SS1.p1.2.m2.4.4.3.3.6" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p1.2.m2.1.1.cmml">
          …
         </mi>
         <mo id="S3.SS1.p1.2.m2.4.4.3.3.7" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">
          ,
         </mo>
         <msub id="S3.SS1.p1.2.m2.4.4.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.cmml">
          <mi id="S3.SS1.p1.2.m2.4.4.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml">
           t
          </mi>
          <mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml">
           n
          </mi>
         </msub>
         <mo id="S3.SS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.4b">
        <apply id="S3.SS1.p1.2.m2.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4">
         <eq id="S3.SS1.p1.2.m2.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.4">
         </eq>
         <ci id="S3.SS1.p1.2.m2.4.4.5.cmml" xref="S3.SS1.p1.2.m2.4.4.5">
          𝒯
         </ci>
         <set id="S3.SS1.p1.2.m2.4.4.3.4.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3">
          <apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">
            𝑡
           </ci>
           <cn id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">
            1
           </cn>
          </apply>
          <apply id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2">
            𝑡
           </ci>
           <cn id="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3">
            2
           </cn>
          </apply>
          <ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">
           …
          </ci>
          <apply id="S3.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3">
           <csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2">
            𝑡
           </ci>
           <ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3">
            𝑛
           </ci>
          </apply>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.4c">
        \mathcal{T}=\{t_{1},t_{2},\dots,t_{n}\}
       </annotation>
      </semantics>
     </math>
     represents the text data generated by the communication process during agent exploration,
     <math alttext="\mathcal{M}=\{m_{1},m_{2},\dots,m_{n}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.4">
      <semantics id="S3.SS1.p1.3.m3.4a">
       <mrow id="S3.SS1.p1.3.m3.4.4" xref="S3.SS1.p1.3.m3.4.4.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.4.4.5" xref="S3.SS1.p1.3.m3.4.4.5.cmml">
         ℳ
        </mi>
        <mo id="S3.SS1.p1.3.m3.4.4.4" xref="S3.SS1.p1.3.m3.4.4.4.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p1.3.m3.4.4.3.3" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">
         <mo id="S3.SS1.p1.3.m3.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">
          {
         </mo>
         <msub id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml">
          <mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">
           m
          </mi>
          <mn id="S3.SS1.p1.3.m3.2.2.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml">
           1
          </mn>
         </msub>
         <mo id="S3.SS1.p1.3.m3.4.4.3.3.5" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">
          ,
         </mo>
         <msub id="S3.SS1.p1.3.m3.3.3.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.cmml">
          <mi id="S3.SS1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml">
           m
          </mi>
          <mn id="S3.SS1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml">
           2
          </mn>
         </msub>
         <mo id="S3.SS1.p1.3.m3.4.4.3.3.6" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p1.3.m3.1.1.cmml">
          …
         </mi>
         <mo id="S3.SS1.p1.3.m3.4.4.3.3.7" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">
          ,
         </mo>
         <msub id="S3.SS1.p1.3.m3.4.4.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.cmml">
          <mi id="S3.SS1.p1.3.m3.4.4.3.3.3.2" xref="S3.SS1.p1.3.m3.4.4.3.3.3.2.cmml">
           m
          </mi>
          <mi id="S3.SS1.p1.3.m3.4.4.3.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.3.cmml">
           n
          </mi>
         </msub>
         <mo id="S3.SS1.p1.3.m3.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.4b">
        <apply id="S3.SS1.p1.3.m3.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4">
         <eq id="S3.SS1.p1.3.m3.4.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4.4">
         </eq>
         <ci id="S3.SS1.p1.3.m3.4.4.5.cmml" xref="S3.SS1.p1.3.m3.4.4.5">
          ℳ
         </ci>
         <set id="S3.SS1.p1.3.m3.4.4.3.4.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3">
          <apply id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2">
            𝑚
           </ci>
           <cn id="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3">
            1
           </cn>
          </apply>
          <apply id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2">
            𝑚
           </ci>
           <cn id="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3">
            2
           </cn>
          </apply>
          <ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">
           …
          </ci>
          <apply id="S3.SS1.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3">
           <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.3.m3.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3.2">
            𝑚
           </ci>
           <ci id="S3.SS1.p1.3.m3.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3.3">
            𝑛
           </ci>
          </apply>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.4c">
        \mathcal{M}=\{m_{1},m_{2},\dots,m_{n}\}
       </annotation>
      </semantics>
     </math>
     with
     <math alttext="m_{i}\in\{0,1,2\}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.3">
      <semantics id="S3.SS1.p1.4.m4.3a">
       <mrow id="S3.SS1.p1.4.m4.3.4" xref="S3.SS1.p1.4.m4.3.4.cmml">
        <msub id="S3.SS1.p1.4.m4.3.4.2" xref="S3.SS1.p1.4.m4.3.4.2.cmml">
         <mi id="S3.SS1.p1.4.m4.3.4.2.2" xref="S3.SS1.p1.4.m4.3.4.2.2.cmml">
          m
         </mi>
         <mi id="S3.SS1.p1.4.m4.3.4.2.3" xref="S3.SS1.p1.4.m4.3.4.2.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p1.4.m4.3.4.1" xref="S3.SS1.p1.4.m4.3.4.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS1.p1.4.m4.3.4.3.2" xref="S3.SS1.p1.4.m4.3.4.3.1.cmml">
         <mo id="S3.SS1.p1.4.m4.3.4.3.2.1" stretchy="false" xref="S3.SS1.p1.4.m4.3.4.3.1.cmml">
          {
         </mo>
         <mn id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">
          0
         </mn>
         <mo id="S3.SS1.p1.4.m4.3.4.3.2.2" xref="S3.SS1.p1.4.m4.3.4.3.1.cmml">
          ,
         </mo>
         <mn id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml">
          1
         </mn>
         <mo id="S3.SS1.p1.4.m4.3.4.3.2.3" xref="S3.SS1.p1.4.m4.3.4.3.1.cmml">
          ,
         </mo>
         <mn id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml">
          2
         </mn>
         <mo id="S3.SS1.p1.4.m4.3.4.3.2.4" stretchy="false" xref="S3.SS1.p1.4.m4.3.4.3.1.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b">
        <apply id="S3.SS1.p1.4.m4.3.4.cmml" xref="S3.SS1.p1.4.m4.3.4">
         <in id="S3.SS1.p1.4.m4.3.4.1.cmml" xref="S3.SS1.p1.4.m4.3.4.1">
         </in>
         <apply id="S3.SS1.p1.4.m4.3.4.2.cmml" xref="S3.SS1.p1.4.m4.3.4.2">
          <csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.4.2.1.cmml" xref="S3.SS1.p1.4.m4.3.4.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p1.4.m4.3.4.2.2.cmml" xref="S3.SS1.p1.4.m4.3.4.2.2">
           𝑚
          </ci>
          <ci id="S3.SS1.p1.4.m4.3.4.2.3.cmml" xref="S3.SS1.p1.4.m4.3.4.2.3">
           𝑖
          </ci>
         </apply>
         <set id="S3.SS1.p1.4.m4.3.4.3.1.cmml" xref="S3.SS1.p1.4.m4.3.4.3.2">
          <cn id="S3.SS1.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1">
           0
          </cn>
          <cn id="S3.SS1.p1.4.m4.2.2.cmml" type="integer" xref="S3.SS1.p1.4.m4.2.2">
           1
          </cn>
          <cn id="S3.SS1.p1.4.m4.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.3.3">
           2
          </cn>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">
        m_{i}\in\{0,1,2\}
       </annotation>
      </semantics>
     </math>
     indicates the source of the text data (system or agents),
     <math alttext="\mathcal{R}=\{r_{1},r_{2},\dots,r_{n}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.4">
      <semantics id="S3.SS1.p1.5.m5.4a">
       <mrow id="S3.SS1.p1.5.m5.4.4" xref="S3.SS1.p1.5.m5.4.4.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.4.4.5" xref="S3.SS1.p1.5.m5.4.4.5.cmml">
         ℛ
        </mi>
        <mo id="S3.SS1.p1.5.m5.4.4.4" xref="S3.SS1.p1.5.m5.4.4.4.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p1.5.m5.4.4.3.3" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">
         <mo id="S3.SS1.p1.5.m5.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">
          {
         </mo>
         <msub id="S3.SS1.p1.5.m5.2.2.1.1.1" xref="S3.SS1.p1.5.m5.2.2.1.1.1.cmml">
          <mi id="S3.SS1.p1.5.m5.2.2.1.1.1.2" xref="S3.SS1.p1.5.m5.2.2.1.1.1.2.cmml">
           r
          </mi>
          <mn id="S3.SS1.p1.5.m5.2.2.1.1.1.3" xref="S3.SS1.p1.5.m5.2.2.1.1.1.3.cmml">
           1
          </mn>
         </msub>
         <mo id="S3.SS1.p1.5.m5.4.4.3.3.5" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">
          ,
         </mo>
         <msub id="S3.SS1.p1.5.m5.3.3.2.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.2.cmml">
          <mi id="S3.SS1.p1.5.m5.3.3.2.2.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.2.2.cmml">
           r
          </mi>
          <mn id="S3.SS1.p1.5.m5.3.3.2.2.2.3" xref="S3.SS1.p1.5.m5.3.3.2.2.2.3.cmml">
           2
          </mn>
         </msub>
         <mo id="S3.SS1.p1.5.m5.4.4.3.3.6" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p1.5.m5.1.1" mathvariant="normal" xref="S3.SS1.p1.5.m5.1.1.cmml">
          …
         </mi>
         <mo id="S3.SS1.p1.5.m5.4.4.3.3.7" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">
          ,
         </mo>
         <msub id="S3.SS1.p1.5.m5.4.4.3.3.3" xref="S3.SS1.p1.5.m5.4.4.3.3.3.cmml">
          <mi id="S3.SS1.p1.5.m5.4.4.3.3.3.2" xref="S3.SS1.p1.5.m5.4.4.3.3.3.2.cmml">
           r
          </mi>
          <mi id="S3.SS1.p1.5.m5.4.4.3.3.3.3" xref="S3.SS1.p1.5.m5.4.4.3.3.3.3.cmml">
           n
          </mi>
         </msub>
         <mo id="S3.SS1.p1.5.m5.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.5.m5.4.4.3.4.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.4b">
        <apply id="S3.SS1.p1.5.m5.4.4.cmml" xref="S3.SS1.p1.5.m5.4.4">
         <eq id="S3.SS1.p1.5.m5.4.4.4.cmml" xref="S3.SS1.p1.5.m5.4.4.4">
         </eq>
         <ci id="S3.SS1.p1.5.m5.4.4.5.cmml" xref="S3.SS1.p1.5.m5.4.4.5">
          ℛ
         </ci>
         <set id="S3.SS1.p1.5.m5.4.4.3.4.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3">
          <apply id="S3.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1.2">
            𝑟
           </ci>
           <cn id="S3.SS1.p1.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.2.2.1.1.1.3">
            1
           </cn>
          </apply>
          <apply id="S3.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2.2">
            𝑟
           </ci>
           <cn id="S3.SS1.p1.5.m5.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.3.3.2.2.2.3">
            2
           </cn>
          </apply>
          <ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">
           …
          </ci>
          <apply id="S3.SS1.p1.5.m5.4.4.3.3.3.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3">
           <csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3.2">
            𝑟
           </ci>
           <ci id="S3.SS1.p1.5.m5.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3.3.3">
            𝑛
           </ci>
          </apply>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.4c">
        \mathcal{R}=\{r_{1},r_{2},\dots,r_{n}\}
       </annotation>
      </semantics>
     </math>
     with
     <math alttext="r_{i}\in\{-1,0,1\}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.3">
      <semantics id="S3.SS1.p1.6.m6.3a">
       <mrow id="S3.SS1.p1.6.m6.3.3" xref="S3.SS1.p1.6.m6.3.3.cmml">
        <msub id="S3.SS1.p1.6.m6.3.3.3" xref="S3.SS1.p1.6.m6.3.3.3.cmml">
         <mi id="S3.SS1.p1.6.m6.3.3.3.2" xref="S3.SS1.p1.6.m6.3.3.3.2.cmml">
          r
         </mi>
         <mi id="S3.SS1.p1.6.m6.3.3.3.3" xref="S3.SS1.p1.6.m6.3.3.3.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p1.6.m6.3.3.2" xref="S3.SS1.p1.6.m6.3.3.2.cmml">
         ∈
        </mo>
        <mrow id="S3.SS1.p1.6.m6.3.3.1.1" xref="S3.SS1.p1.6.m6.3.3.1.2.cmml">
         <mo id="S3.SS1.p1.6.m6.3.3.1.1.2" stretchy="false" xref="S3.SS1.p1.6.m6.3.3.1.2.cmml">
          {
         </mo>
         <mrow id="S3.SS1.p1.6.m6.3.3.1.1.1" xref="S3.SS1.p1.6.m6.3.3.1.1.1.cmml">
          <mo id="S3.SS1.p1.6.m6.3.3.1.1.1a" xref="S3.SS1.p1.6.m6.3.3.1.1.1.cmml">
           −
          </mo>
          <mn id="S3.SS1.p1.6.m6.3.3.1.1.1.2" xref="S3.SS1.p1.6.m6.3.3.1.1.1.2.cmml">
           1
          </mn>
         </mrow>
         <mo id="S3.SS1.p1.6.m6.3.3.1.1.3" xref="S3.SS1.p1.6.m6.3.3.1.2.cmml">
          ,
         </mo>
         <mn id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">
          0
         </mn>
         <mo id="S3.SS1.p1.6.m6.3.3.1.1.4" xref="S3.SS1.p1.6.m6.3.3.1.2.cmml">
          ,
         </mo>
         <mn id="S3.SS1.p1.6.m6.2.2" xref="S3.SS1.p1.6.m6.2.2.cmml">
          1
         </mn>
         <mo id="S3.SS1.p1.6.m6.3.3.1.1.5" stretchy="false" xref="S3.SS1.p1.6.m6.3.3.1.2.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.3b">
        <apply id="S3.SS1.p1.6.m6.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3">
         <in id="S3.SS1.p1.6.m6.3.3.2.cmml" xref="S3.SS1.p1.6.m6.3.3.2">
         </in>
         <apply id="S3.SS1.p1.6.m6.3.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3.3">
          <csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.3.3.3.1.cmml" xref="S3.SS1.p1.6.m6.3.3.3">
           subscript
          </csymbol>
          <ci id="S3.SS1.p1.6.m6.3.3.3.2.cmml" xref="S3.SS1.p1.6.m6.3.3.3.2">
           𝑟
          </ci>
          <ci id="S3.SS1.p1.6.m6.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3.3.3">
           𝑖
          </ci>
         </apply>
         <set id="S3.SS1.p1.6.m6.3.3.1.2.cmml" xref="S3.SS1.p1.6.m6.3.3.1.1">
          <apply id="S3.SS1.p1.6.m6.3.3.1.1.1.cmml" xref="S3.SS1.p1.6.m6.3.3.1.1.1">
           <minus id="S3.SS1.p1.6.m6.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.3.3.1.1.1">
           </minus>
           <cn id="S3.SS1.p1.6.m6.3.3.1.1.1.2.cmml" type="integer" xref="S3.SS1.p1.6.m6.3.3.1.1.1.2">
            1
           </cn>
          </apply>
          <cn id="S3.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.1">
           0
          </cn>
          <cn id="S3.SS1.p1.6.m6.2.2.cmml" type="integer" xref="S3.SS1.p1.6.m6.2.2">
           1
          </cn>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.3c">
        r_{i}\in\{-1,0,1\}
       </annotation>
      </semantics>
     </math>
     represents the reward signals provided by either the system or the agents. We demonstrate the the details of this data structure in Figure
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3.1 Exploration Phase ‣ 3 Learning Through Communication ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     ,
     <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1">
      <semantics id="S3.SS1.p1.7.m7.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">
        ℳ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b">
        <ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">
         ℳ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">
        \mathcal{M}
       </annotation>
      </semantics>
     </math>
     is the mask list, and
     <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1">
      <semantics id="S3.SS1.p1.8.m8.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">
        ℛ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b">
        <ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">
         ℛ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">
        \mathcal{R}
       </annotation>
      </semantics>
     </math>
     is the reward list. In PPO training, both the value list and the log-prob list correspond directly to the action list. For brevity, we denote these three lists together as
     <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1">
      <semantics id="S3.SS1.p1.9.m9.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">
        𝒯
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b">
        <ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">
         𝒯
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">
        \mathcal{T}
       </annotation>
      </semantics>
     </math>
     here. Please see Appendix
     <a class="ltx_ref" href="#A1.SS2" title="A.2 Buffer Structure ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       A.2
      </span>
     </a>
     for more detaills.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.1">
     To collect the trajectories data
     <math alttext="\mathcal{S}=(\mathcal{T},\mathcal{M},\mathcal{R})" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.3">
      <semantics id="S3.SS1.p2.1.m1.3a">
       <mrow id="S3.SS1.p2.1.m1.3.4" xref="S3.SS1.p2.1.m1.3.4.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.3.4.2" xref="S3.SS1.p2.1.m1.3.4.2.cmml">
         𝒮
        </mi>
        <mo id="S3.SS1.p2.1.m1.3.4.1" xref="S3.SS1.p2.1.m1.3.4.1.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p2.1.m1.3.4.3.2" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">
         <mo id="S3.SS1.p2.1.m1.3.4.3.2.1" stretchy="false" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">
          (
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">
          𝒯
         </mi>
         <mo id="S3.SS1.p2.1.m1.3.4.3.2.2" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml">
          ℳ
         </mi>
         <mo id="S3.SS1.p2.1.m1.3.4.3.2.3" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.3.3" xref="S3.SS1.p2.1.m1.3.3.cmml">
          ℛ
         </mi>
         <mo id="S3.SS1.p2.1.m1.3.4.3.2.4" stretchy="false" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.3b">
        <apply id="S3.SS1.p2.1.m1.3.4.cmml" xref="S3.SS1.p2.1.m1.3.4">
         <eq id="S3.SS1.p2.1.m1.3.4.1.cmml" xref="S3.SS1.p2.1.m1.3.4.1">
         </eq>
         <ci id="S3.SS1.p2.1.m1.3.4.2.cmml" xref="S3.SS1.p2.1.m1.3.4.2">
          𝒮
         </ci>
         <vector id="S3.SS1.p2.1.m1.3.4.3.1.cmml" xref="S3.SS1.p2.1.m1.3.4.3.2">
          <ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">
           𝒯
          </ci>
          <ci id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2">
           ℳ
          </ci>
          <ci id="S3.SS1.p2.1.m1.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3">
           ℛ
          </ci>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.3c">
        \mathcal{S}=(\mathcal{T},\mathcal{M},\mathcal{R})
       </annotation>
      </semantics>
     </math>
     from different types of tasks, we design the communication patterns for these tasks. Here we provide three communication patterns:
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p3">
    <ul class="ltx_itemize" id="S3.I1">
     <li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S3.I1.i1.p1">
       <p class="ltx_p" id="S3.I1.i1.p1.1">
        <span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">
         Monologue
        </span>
        : Monologue is a single agent self-talk style communication pattern, designed for decision-making tasks (Algorithm
        <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
         <span class="ltx_text ltx_ref_tag">
          1
         </span>
        </a>
        ). Figure
        <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Adapting LLM Agents Through Communication">
         <span class="ltx_text ltx_ref_tag">
          1
         </span>
        </a>
        is a toy example of
        <span class="ltx_text ltx_font_italic" id="S3.I1.i1.p1.1.2">
         ALFWorld
        </span>
        to demonstrate the Monologue pattern between two roles, an actor to take actions and an instructor to give suggestions. In this pattern, two roles are played by the same agent, we can view them as the different types of steps such as think and act in the ReAct formulation
        <cite class="ltx_cite ltx_citemacro_cite">
         [
         <a class="ltx_ref" href="#bib.bib65" title="">
          65
         </a>
         ]
        </cite>
        . When the actor completes the task or achieves a maximum number of interactions, the reward will be returned from the environment and we obtain a new buffer from this pattern.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S3.I1.i2.p1">
       <p class="ltx_p" id="S3.I1.i2.p1.1">
        <span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">
         Dialogue
        </span>
        : Dialogue is a multi-agent collaborating style pattern (Algorithm
        <a class="ltx_ref" href="#alg2" title="Algorithm 2 ‣ A.1 Communication Patterns ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
         <span class="ltx_text ltx_ref_tag">
          2
         </span>
        </a>
        ). It is designed for knowledge-intensive tasks, where multiple knowledge sources are needed for a comprehensive answer. Similar to the Monologue, the Dialogue pattern also has multiple roles, but
        <span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.2">
         the roles are played by different agents
        </span>
        . This pattern also supports communicating with external tools and other agents, which can be easily achieved by changing the roles’ prompts or replacing the agents behind the roles. The left figure of Figure
        <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Learning Through Communication ‣ Adapting LLM Agents Through Communication">
         <span class="ltx_text ltx_ref_tag">
          3
         </span>
        </a>
        is a toy example of
        <span class="ltx_text ltx_font_italic" id="S3.I1.i2.p1.1.3">
         HotpotQA
        </span>
        to illustrate this pattern, where the GPT-4 agent play as a teacher to analyze the situation and give suggestions to the student agent who is responsible for making decisions. We can just assign the student agent to play as the teacher agent when testing for environments without GPT-4. So we can use this pattern to collect the buffer with GPT-4 as teacher agent and train the student to play as a teacher to improve the ability of the student agent to solve problems independently.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S3.I1.i3.p1">
       <p class="ltx_p" id="S3.I1.i3.p1.1">
        <span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">
         Analogue
        </span>
        : Dialogue is a teacher-student style pattern for powerful agents to teach the novice agents (Algorithm
        <a class="ltx_ref" href="#alg3" title="Algorithm 3 ‣ A.1 Communication Patterns ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
         <span class="ltx_text ltx_ref_tag">
          3
         </span>
        </a>
        ). We design the Analogue pattern for complex analytical tasks such as numerical reasoning, which require extensive analytical examples for agents to improve the specific reasoning ability lacking in the pretrained models. Similar to Dialogue, the Analogue pattern also has multiple roles played by different agents, but the teacher roles can
        <span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.2">
         directly provide the reward signal and new analogous examples
        </span>
        , which are all provided by the system (environments) in the previous pattern. The right figure of Figure
        <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Learning Through Communication ‣ Adapting LLM Agents Through Communication">
         <span class="ltx_text ltx_ref_tag">
          3
         </span>
        </a>
        is a toy example with GSM8k to demonstrate how the student agent communicates with the teacher agent in a homework-correcting style. In the math question environment, the student agent starts with an initial answer to the current question, then the teacher directly corrects the answer with a reward. To help the student improve ability instead of just memorizing the solution, the teacher will generate another analogous question to ask the student. Eventually, the student gives a new answer for this analogous question and gets a new reward signal from the teacher.
       </p>
      </div>
     </li>
    </ul>
   </div>
   <figure class="ltx_figure" id="S3.F4">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="74" id="S3.F4.g1" src="/html/2310.01444/assets/figures/buffer.png" width="394"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 4:
     </span>
     The buffer data is a serial of integer/float sequences. They are collected by the agent’s exploration and used for the reinforcement learning phase.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Training phase
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.1">
     In the training phase, the LLM agent model could be optimized through the conversation sessions collected in the exploration stage. Given a example session
     <math alttext="\mathcal{S}=(\mathcal{T},\mathcal{M},\mathcal{R})" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.3">
      <semantics id="S3.SS2.p1.1.m1.3a">
       <mrow id="S3.SS2.p1.1.m1.3.4" xref="S3.SS2.p1.1.m1.3.4.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.3.4.2" xref="S3.SS2.p1.1.m1.3.4.2.cmml">
         𝒮
        </mi>
        <mo id="S3.SS2.p1.1.m1.3.4.1" xref="S3.SS2.p1.1.m1.3.4.1.cmml">
         =
        </mo>
        <mrow id="S3.SS2.p1.1.m1.3.4.3.2" xref="S3.SS2.p1.1.m1.3.4.3.1.cmml">
         <mo id="S3.SS2.p1.1.m1.3.4.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.3.4.3.1.cmml">
          (
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">
          𝒯
         </mi>
         <mo id="S3.SS2.p1.1.m1.3.4.3.2.2" xref="S3.SS2.p1.1.m1.3.4.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">
          ℳ
         </mi>
         <mo id="S3.SS2.p1.1.m1.3.4.3.2.3" xref="S3.SS2.p1.1.m1.3.4.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml">
          ℛ
         </mi>
         <mo id="S3.SS2.p1.1.m1.3.4.3.2.4" stretchy="false" xref="S3.SS2.p1.1.m1.3.4.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.3b">
        <apply id="S3.SS2.p1.1.m1.3.4.cmml" xref="S3.SS2.p1.1.m1.3.4">
         <eq id="S3.SS2.p1.1.m1.3.4.1.cmml" xref="S3.SS2.p1.1.m1.3.4.1">
         </eq>
         <ci id="S3.SS2.p1.1.m1.3.4.2.cmml" xref="S3.SS2.p1.1.m1.3.4.2">
          𝒮
         </ci>
         <vector id="S3.SS2.p1.1.m1.3.4.3.1.cmml" xref="S3.SS2.p1.1.m1.3.4.3.2">
          <ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">
           𝒯
          </ci>
          <ci id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">
           ℳ
          </ci>
          <ci id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3">
           ℛ
          </ci>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.3c">
        \mathcal{S}=(\mathcal{T},\mathcal{M},\mathcal{R})
       </annotation>
      </semantics>
     </math>
     , we mainly utilize two training objects for model training.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p2">
    <ul class="ltx_itemize" id="S3.I2">
     <li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S3.I2.i1.p1">
       <p class="ltx_p" id="S3.I2.i1.p1.2">
        Language model Objective:
        <math alttext="\mathcal{L}_{\text{LM}}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.m1.1">
         <semantics id="S3.I2.i1.p1.1.m1.1a">
          <msub id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I2.i1.p1.1.m1.1.1.2" xref="S3.I2.i1.p1.1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mtext id="S3.I2.i1.p1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.m1.1.1.3a.cmml">
            LM
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b">
           <apply id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="S3.I2.i1.p1.1.m1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="S3.I2.i1.p1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2">
             ℒ
            </ci>
            <ci id="S3.I2.i1.p1.1.m1.1.1.3a.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3">
             <mtext id="S3.I2.i1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i1.p1.1.m1.1.1.3">
              LM
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">
           \mathcal{L}_{\text{LM}}
          </annotation>
         </semantics>
        </math>
        encourages the model to learn from the trajectory
        <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.2.m2.1">
         <semantics id="S3.I2.i1.p1.2.m2.1a">
          <mi class="ltx_font_mathcaligraphic" id="S3.I2.i1.p1.2.m2.1.1" xref="S3.I2.i1.p1.2.m2.1.1.cmml">
           𝒯
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.2.m2.1b">
           <ci id="S3.I2.i1.p1.2.m2.1.1.cmml" xref="S3.I2.i1.p1.2.m2.1.1">
            𝒯
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I2.i1.p1.2.m2.1c">
           \mathcal{T}
          </annotation>
         </semantics>
        </math>
        , serving as an unsupervised learning schema to help model for behavior cloning from other agents’ response or predicting system feedbacks.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S3.I2.i2.p1">
       <p class="ltx_p" id="S3.I2.i2.p1.1">
        Reinforcement Objective:
        <math alttext="\mathcal{L}_{\text{reinforce}}" class="ltx_Math" display="inline" id="S3.I2.i2.p1.1.m1.1">
         <semantics id="S3.I2.i2.p1.1.m1.1a">
          <msub id="S3.I2.i2.p1.1.m1.1.1" xref="S3.I2.i2.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I2.i2.p1.1.m1.1.1.2" xref="S3.I2.i2.p1.1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mtext id="S3.I2.i2.p1.1.m1.1.1.3" xref="S3.I2.i2.p1.1.m1.1.1.3a.cmml">
            reinforce
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.m1.1b">
           <apply id="S3.I2.i2.p1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="S3.I2.i2.p1.1.m1.1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="S3.I2.i2.p1.1.m1.1.1.2.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2">
             ℒ
            </ci>
            <ci id="S3.I2.i2.p1.1.m1.1.1.3a.cmml" xref="S3.I2.i2.p1.1.m1.1.1.3">
             <mtext id="S3.I2.i2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i2.p1.1.m1.1.1.3">
              reinforce
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.m1.1c">
           \mathcal{L}_{\text{reinforce}}
          </annotation>
         </semantics>
        </math>
        optimizes the model by maximizing the expectation reward provided by environment or a teacher agent (i.e., GPT-4
        <cite class="ltx_cite ltx_citemacro_cite">
         [
         <a class="ltx_ref" href="#bib.bib28" title="">
          28
         </a>
         ]
        </cite>
        ). It is an goal-oriented objective, and allows the model to learn through both positive and negative signals in the communication session.
       </p>
      </div>
     </li>
    </ul>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p3">
    <p class="ltx_p" id="S3.SS2.p3.5">
     Thus, the overall training objective for LTC combines the above two terms:
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S3.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\mathcal{L}_{\text{LTC}}(\mathcal{S})=\beta\mathcal{L}_{\text{LM}}(\mathcal{T})+\mathcal{L}_{\text{reinforce}}(\mathcal{S})," class="ltx_Math" display="block" id="S3.E1.m1.4">
         <semantics id="S3.E1.m1.4a">
          <mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.1.cmml">
           <mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml">
            <mrow id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml">
             <msub id="S3.E1.m1.4.4.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.cmml">
               ℒ
              </mi>
              <mtext id="S3.E1.m1.4.4.1.1.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.3a.cmml">
               LTC
              </mtext>
             </msub>
             <mo id="S3.E1.m1.4.4.1.1.2.1" lspace="0em" rspace="0em" xref="S3.E1.m1.4.4.1.1.2.1.cmml">
              ​
             </mo>
             <mrow id="S3.E1.m1.4.4.1.1.2.3.2" xref="S3.E1.m1.4.4.1.1.2.cmml">
              <mo id="S3.E1.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S3.E1.m1.4.4.1.1.2.cmml">
               (
              </mo>
              <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">
               𝒮
              </mi>
              <mo id="S3.E1.m1.4.4.1.1.2.3.2.2" stretchy="false" xref="S3.E1.m1.4.4.1.1.2.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml">
             =
            </mo>
            <mrow id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml">
             <mrow id="S3.E1.m1.4.4.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml">
              <mi id="S3.E1.m1.4.4.1.1.3.2.2" xref="S3.E1.m1.4.4.1.1.3.2.2.cmml">
               β
              </mi>
              <mo id="S3.E1.m1.4.4.1.1.3.2.1" lspace="0em" rspace="0em" xref="S3.E1.m1.4.4.1.1.3.2.1.cmml">
               ​
              </mo>
              <msub id="S3.E1.m1.4.4.1.1.3.2.3" xref="S3.E1.m1.4.4.1.1.3.2.3.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.3.2.3.2" xref="S3.E1.m1.4.4.1.1.3.2.3.2.cmml">
                ℒ
               </mi>
               <mtext id="S3.E1.m1.4.4.1.1.3.2.3.3" xref="S3.E1.m1.4.4.1.1.3.2.3.3a.cmml">
                LM
               </mtext>
              </msub>
              <mo id="S3.E1.m1.4.4.1.1.3.2.1a" lspace="0em" rspace="0em" xref="S3.E1.m1.4.4.1.1.3.2.1.cmml">
               ​
              </mo>
              <mrow id="S3.E1.m1.4.4.1.1.3.2.4.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml">
               <mo id="S3.E1.m1.4.4.1.1.3.2.4.2.1" stretchy="false" xref="S3.E1.m1.4.4.1.1.3.2.cmml">
                (
               </mo>
               <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">
                𝒯
               </mi>
               <mo id="S3.E1.m1.4.4.1.1.3.2.4.2.2" stretchy="false" xref="S3.E1.m1.4.4.1.1.3.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="S3.E1.m1.4.4.1.1.3.1" xref="S3.E1.m1.4.4.1.1.3.1.cmml">
              +
             </mo>
             <mrow id="S3.E1.m1.4.4.1.1.3.3" xref="S3.E1.m1.4.4.1.1.3.3.cmml">
              <msub id="S3.E1.m1.4.4.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.3.3.2.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.3.3.2.2" xref="S3.E1.m1.4.4.1.1.3.3.2.2.cmml">
                ℒ
               </mi>
               <mtext id="S3.E1.m1.4.4.1.1.3.3.2.3" xref="S3.E1.m1.4.4.1.1.3.3.2.3a.cmml">
                reinforce
               </mtext>
              </msub>
              <mo id="S3.E1.m1.4.4.1.1.3.3.1" lspace="0em" rspace="0em" xref="S3.E1.m1.4.4.1.1.3.3.1.cmml">
               ​
              </mo>
              <mrow id="S3.E1.m1.4.4.1.1.3.3.3.2" xref="S3.E1.m1.4.4.1.1.3.3.cmml">
               <mo id="S3.E1.m1.4.4.1.1.3.3.3.2.1" stretchy="false" xref="S3.E1.m1.4.4.1.1.3.3.cmml">
                (
               </mo>
               <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">
                𝒮
               </mi>
               <mo id="S3.E1.m1.4.4.1.1.3.3.3.2.2" stretchy="false" xref="S3.E1.m1.4.4.1.1.3.3.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b">
           <apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1">
            <eq id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1">
            </eq>
            <apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2">
             <times id="S3.E1.m1.4.4.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.1">
             </times>
             <apply id="S3.E1.m1.4.4.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2">
              <csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2">
               subscript
              </csymbol>
              <ci id="S3.E1.m1.4.4.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2">
               ℒ
              </ci>
              <ci id="S3.E1.m1.4.4.1.1.2.2.3a.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3">
               <mtext id="S3.E1.m1.4.4.1.1.2.2.3.cmml" mathsize="70%" xref="S3.E1.m1.4.4.1.1.2.2.3">
                LTC
               </mtext>
              </ci>
             </apply>
             <ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">
              𝒮
             </ci>
            </apply>
            <apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3">
             <plus id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1">
             </plus>
             <apply id="S3.E1.m1.4.4.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2">
              <times id="S3.E1.m1.4.4.1.1.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.2.1">
              </times>
              <ci id="S3.E1.m1.4.4.1.1.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2.2">
               𝛽
              </ci>
              <apply id="S3.E1.m1.4.4.1.1.3.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.2.3">
               <csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.2.3">
                subscript
               </csymbol>
               <ci id="S3.E1.m1.4.4.1.1.3.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2.3.2">
                ℒ
               </ci>
               <ci id="S3.E1.m1.4.4.1.1.3.2.3.3a.cmml" xref="S3.E1.m1.4.4.1.1.3.2.3.3">
                <mtext id="S3.E1.m1.4.4.1.1.3.2.3.3.cmml" mathsize="70%" xref="S3.E1.m1.4.4.1.1.3.2.3.3">
                 LM
                </mtext>
               </ci>
              </apply>
              <ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">
               𝒯
              </ci>
             </apply>
             <apply id="S3.E1.m1.4.4.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3">
              <times id="S3.E1.m1.4.4.1.1.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.1">
              </times>
              <apply id="S3.E1.m1.4.4.1.1.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2">
               <csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2">
                subscript
               </csymbol>
               <ci id="S3.E1.m1.4.4.1.1.3.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2.2">
                ℒ
               </ci>
               <ci id="S3.E1.m1.4.4.1.1.3.3.2.3a.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2.3">
                <mtext id="S3.E1.m1.4.4.1.1.3.3.2.3.cmml" mathsize="70%" xref="S3.E1.m1.4.4.1.1.3.3.2.3">
                 reinforce
                </mtext>
               </ci>
              </apply>
              <ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">
               𝒮
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E1.m1.4c">
           \mathcal{L}_{\text{LTC}}(\mathcal{S})=\beta\mathcal{L}_{\text{LM}}(\mathcal{T})+\mathcal{L}_{\text{reinforce}}(\mathcal{S}),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS2.p3.4">
     where
     <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1">
      <semantics id="S3.SS2.p3.1.m1.1a">
       <mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">
        β
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b">
        <ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">
         𝛽
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">
        \beta
       </annotation>
      </semantics>
     </math>
     is a balancing hyper-parameter. The off-policy PPO algorithm
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib42" title="">
       42
      </a>
      ]
     </cite>
     is utilized for optimizing
     <math alttext="\mathcal{L}_{\text{reinforce}}(\mathcal{S})" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1">
      <semantics id="S3.SS2.p3.2.m2.1a">
       <mrow id="S3.SS2.p3.2.m2.1.2" xref="S3.SS2.p3.2.m2.1.2.cmml">
        <msub id="S3.SS2.p3.2.m2.1.2.2" xref="S3.SS2.p3.2.m2.1.2.2.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.1.2.2.2" xref="S3.SS2.p3.2.m2.1.2.2.2.cmml">
          ℒ
         </mi>
         <mtext id="S3.SS2.p3.2.m2.1.2.2.3" xref="S3.SS2.p3.2.m2.1.2.2.3a.cmml">
          reinforce
         </mtext>
        </msub>
        <mo id="S3.SS2.p3.2.m2.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p3.2.m2.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p3.2.m2.1.2.3.2" xref="S3.SS2.p3.2.m2.1.2.cmml">
         <mo id="S3.SS2.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p3.2.m2.1.2.cmml">
          (
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">
          𝒮
         </mi>
         <mo id="S3.SS2.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p3.2.m2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b">
        <apply id="S3.SS2.p3.2.m2.1.2.cmml" xref="S3.SS2.p3.2.m2.1.2">
         <times id="S3.SS2.p3.2.m2.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.2.1">
         </times>
         <apply id="S3.SS2.p3.2.m2.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.2.2">
          <csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.2.2.1.cmml" xref="S3.SS2.p3.2.m2.1.2.2">
           subscript
          </csymbol>
          <ci id="S3.SS2.p3.2.m2.1.2.2.2.cmml" xref="S3.SS2.p3.2.m2.1.2.2.2">
           ℒ
          </ci>
          <ci id="S3.SS2.p3.2.m2.1.2.2.3a.cmml" xref="S3.SS2.p3.2.m2.1.2.2.3">
           <mtext id="S3.SS2.p3.2.m2.1.2.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.2.m2.1.2.2.3">
            reinforce
           </mtext>
          </ci>
         </apply>
         <ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">
          𝒮
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">
        \mathcal{L}_{\text{reinforce}}(\mathcal{S})
       </annotation>
      </semantics>
     </math>
     , and it can be further breakdown into policy loss, value loss and policy entropy regularization terms in implementation. The vanilla PPO algorithm takes the triplet
     <math alttext="(\text{state},\text{action},\text{rewards})" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.3">
      <semantics id="S3.SS2.p3.3.m3.3a">
       <mrow id="S3.SS2.p3.3.m3.3.4.2" xref="S3.SS2.p3.3.m3.3.4.1.cmml">
        <mo id="S3.SS2.p3.3.m3.3.4.2.1" stretchy="false" xref="S3.SS2.p3.3.m3.3.4.1.cmml">
         (
        </mo>
        <mtext id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1a.cmml">
         state
        </mtext>
        <mo id="S3.SS2.p3.3.m3.3.4.2.2" xref="S3.SS2.p3.3.m3.3.4.1.cmml">
         ,
        </mo>
        <mtext id="S3.SS2.p3.3.m3.2.2" xref="S3.SS2.p3.3.m3.2.2a.cmml">
         action
        </mtext>
        <mo id="S3.SS2.p3.3.m3.3.4.2.3" xref="S3.SS2.p3.3.m3.3.4.1.cmml">
         ,
        </mo>
        <mtext id="S3.SS2.p3.3.m3.3.3" xref="S3.SS2.p3.3.m3.3.3a.cmml">
         rewards
        </mtext>
        <mo id="S3.SS2.p3.3.m3.3.4.2.4" stretchy="false" xref="S3.SS2.p3.3.m3.3.4.1.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.3b">
        <vector id="S3.SS2.p3.3.m3.3.4.1.cmml" xref="S3.SS2.p3.3.m3.3.4.2">
         <ci id="S3.SS2.p3.3.m3.1.1a.cmml" xref="S3.SS2.p3.3.m3.1.1">
          <mtext id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">
           state
          </mtext>
         </ci>
         <ci id="S3.SS2.p3.3.m3.2.2a.cmml" xref="S3.SS2.p3.3.m3.2.2">
          <mtext id="S3.SS2.p3.3.m3.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2">
           action
          </mtext>
         </ci>
         <ci id="S3.SS2.p3.3.m3.3.3a.cmml" xref="S3.SS2.p3.3.m3.3.3">
          <mtext id="S3.SS2.p3.3.m3.3.3.cmml" xref="S3.SS2.p3.3.m3.3.3">
           rewards
          </mtext>
         </ci>
        </vector>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.3c">
        (\text{state},\text{action},\text{rewards})
       </annotation>
      </semantics>
     </math>
     for training. In this case, we sample from the trajectories
     <math alttext="(\mathcal{T}_{&lt;i},t_{i})" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.2">
      <semantics id="S3.SS2.p3.4.m4.2a">
       <mrow id="S3.SS2.p3.4.m4.2.2.2" xref="S3.SS2.p3.4.m4.2.2.3.cmml">
        <mo id="S3.SS2.p3.4.m4.2.2.2.3" stretchy="false" xref="S3.SS2.p3.4.m4.2.2.3.cmml">
         (
        </mo>
        <msub id="S3.SS2.p3.4.m4.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.4.m4.1.1.1.1.2" xref="S3.SS2.p3.4.m4.1.1.1.1.2.cmml">
          𝒯
         </mi>
         <mrow id="S3.SS2.p3.4.m4.1.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.1.3.cmml">
          <mi id="S3.SS2.p3.4.m4.1.1.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.1.1.3.2.cmml">
          </mi>
          <mo id="S3.SS2.p3.4.m4.1.1.1.1.3.1" xref="S3.SS2.p3.4.m4.1.1.1.1.3.1.cmml">
           &lt;
          </mo>
          <mi id="S3.SS2.p3.4.m4.1.1.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.1.1.3.3.cmml">
           i
          </mi>
         </mrow>
        </msub>
        <mo id="S3.SS2.p3.4.m4.2.2.2.4" xref="S3.SS2.p3.4.m4.2.2.3.cmml">
         ,
        </mo>
        <msub id="S3.SS2.p3.4.m4.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.2.cmml">
         <mi id="S3.SS2.p3.4.m4.2.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.2.2.cmml">
          t
         </mi>
         <mi id="S3.SS2.p3.4.m4.2.2.2.2.3" xref="S3.SS2.p3.4.m4.2.2.2.2.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS2.p3.4.m4.2.2.2.5" stretchy="false" xref="S3.SS2.p3.4.m4.2.2.3.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.2b">
        <interval closure="open" id="S3.SS2.p3.4.m4.2.2.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2">
         <apply id="S3.SS2.p3.4.m4.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1">
          <csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS2.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2">
           𝒯
          </ci>
          <apply id="S3.SS2.p3.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3">
           <lt id="S3.SS2.p3.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.1">
           </lt>
           <csymbol cd="latexml" id="S3.SS2.p3.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.2">
            absent
           </csymbol>
           <ci id="S3.SS2.p3.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.3">
            𝑖
           </ci>
          </apply>
         </apply>
         <apply id="S3.SS2.p3.4.m4.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2">
          <csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2">
           subscript
          </csymbol>
          <ci id="S3.SS2.p3.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.2">
           𝑡
          </ci>
          <ci id="S3.SS2.p3.4.m4.2.2.2.2.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.3">
           𝑖
          </ci>
         </apply>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.2c">
        (\mathcal{T}_{&lt;i},t_{i})
       </annotation>
      </semantics>
     </math>
     for simulating the state-action pairs, specifically, we only keep the tokens generated by agent model itself as actions for policy updating.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section ltx_indent_first" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Experiments
  </h2>
  <section class="ltx_subsection ltx_indent_first" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Datasets
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     We conducted experiments on three datasets:
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.1">
      ALFWorld
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib46" title="">
       46
      </a>
      ]
     </cite>
     ,
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.2">
      HotpotQA
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib64" title="">
       64
      </a>
      ]
     </cite>
     , and
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.3">
      GSM8k
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib10" title="">
       10
      </a>
      ]
     </cite>
     .
Each of these datasets represents a different task type, namely decision-making, knowledge-intensive reasoning, and numerical reasoning, respectively. And different communication patterns are used: Monologue for
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.4">
      ALFWorld
     </span>
     , Dialogue for
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.5">
      HotpotQA
     </span>
     , and Analogue for
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.6">
      GSM8k
     </span>
     .
    </p>
   </div>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS1.SSS0.Px1">
    <h4 class="ltx_title ltx_font_italic ltx_title_paragraph">
     ALFWorld
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p1">
     <p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">
      <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.1">
       ALFWorld
      </span>
      (Figure
      <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Adapting LLM Agents Through Communication">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </a>
      ) is a text-based game that follows the ALFRED benchmark
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib45" title="">
        45
       </a>
       ]
      </cite>
      . In this game, agents are presented with six types of tasks that involve navigating a simulated household environment using textual actions. With over 50 locations to explore, these tasks demand strategic planning and thorough exploration. Following
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib46" title="">
        46
       </a>
       ]
      </cite>
      , we utilize the train set that consists of 3553 environments for training our model and the baselines; and we use the unseen test set that comprises 134 environments for evaluatation.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS1.SSS0.Px2">
    <h4 class="ltx_title ltx_font_italic ltx_title_paragraph">
     HotpotQA
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p1">
     <p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">
      <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px2.p1.1.1">
       HotpotQA
      </span>
      is a question-answering dataset that focuses on multi-hop reasoning based supporting facts, with the goal of improving the explainability of QA systems. In this dataset, agents are required to reason across two or more Wikipedia passages to derive answers. We initialize the environments using only the text of the questions, meaning that agents are provided with the question and task description but do not have access to supporting paragraphs. To support their reasoning, agents must either rely on their internal knowledge or interact with an external Wikipedia tool to retrieve the necessary information.
For training, we sample the environments from the training set, which consists of 90,447 QA-pairs. For evaluation, we run 500 random examples from the test set, following
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib65" title="">
        65
       </a>
       ]
      </cite>
      .
     </p>
    </div>
   </section>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS1.SSS0.Px3">
    <h4 class="ltx_title ltx_font_italic ltx_title_paragraph">
     GSM8k
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p1">
     <p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">
      The
      <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px3.p1.1.1">
       GSM8k
      </span>
      dataset is a collection of 8.5K math problems for grade school students. These problems have been crafted by human experts to ensure linguistic diversity. The dataset is divided into two sets: 7.5K problems for training and 1K problems for testing. Each problem in the dataset requires 2 to 8 steps of reasoning to arrive at the solution. The problems primarily focus on fundamental arithmetic operations like addition, subtraction, multiplication, and division.
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Settings
   </h3>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS2.SSS0.Px1">
    <h4 class="ltx_title ltx_title_paragraph">
     Model Architecture
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p1">
     <p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">
      We use a modified version of LLaMA
      <cite class="ltx_cite ltx_citemacro_cite">
       [
       <a class="ltx_ref" href="#bib.bib52" title="">
        52
       </a>
       ]
      </cite>
      as the base model. To generate state values corresponding to the action tokens, we introduce an additional linear layer to serve ast the value head.
This value head acts as an auxiliary output module, and the output values are processed using the
      <math alttext="tanh()" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1">
       <semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a">
        <mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">
         <mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">
          t
         </mi>
         <mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">
          a
         </mi>
         <mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.cmml">
          n
         </mi>
         <mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1b" lspace="0em" rspace="0em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.5" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.5.cmml">
          h
         </mi>
         <mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1c" lspace="0em" rspace="0em" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">
          ​
         </mo>
         <mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.6.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">
          <mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.6.2.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.6.1.cmml">
           (
          </mo>
          <mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.6.2.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.6.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b">
         <apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">
          <times id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1">
          </times>
          <ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2">
           𝑡
          </ci>
          <ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3">
           𝑎
          </ci>
          <ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.4">
           𝑛
          </ci>
          <ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.5.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.5">
           ℎ
          </ci>
          <list id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.6.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.6.2.1">
          </list>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">
         tanh()
        </annotation>
       </semantics>
      </math>
      function to ensure they fall within the range of (-1, 1).
This adaptation for RL has also been discussed in prior studies
      <cite class="ltx_cite ltx_citemacro_cite">
       [
       <a class="ltx_ref" href="#bib.bib39" title="">
        39
       </a>
       ]
      </cite>
      .
     </p>
    </div>
   </section>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS2.SSS0.Px2">
    <h4 class="ltx_title ltx_title_paragraph">
     Agent Pre-training
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p1">
     <p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">
      We use the LLaMA-7B model
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib52" title="">
        52
       </a>
       ]
      </cite>
      for our LLM agent. To enhance the agent’s ability to follow task-specific instructions, we initialize it by instruction fine-tuning (IT). And this initialized agent works as the baseline for a fair comparison. This step is crucial because the original LLaMA-7B model, without prior instruction fine-tuning, struggled to follow task instructions and generation sensible actions in the environments.
To collect data for instruction fine-tuning, we employ GPT3/4 as our agent to explore the environments created from the training set. We then filter out negative examples and retain positive examples to train the initial agent. For both the
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p1.1.1">
       ALFWorld
      </span>
      and
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p1.1.2">
       HotpotQA
      </span>
      datasets, we leverage GPT3 (specifically, text-davinci-003). However, for the
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p1.1.3">
       GSM8k
      </span>
      dataset, we use GPT4 due to GPT3’s inadequate performance in handling mathematical problems, which resulted in a scarcity of positive examples.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS2.SSS0.Px3">
    <h4 class="ltx_title ltx_title_paragraph">
     Training details
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px3.p1">
     <p class="ltx_p" id="S4.SS2.SSS0.Px3.p1.4">
      We utilize the AdamW optimizer
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib22" title="">
        22
       </a>
       ]
      </cite>
      with a batch size of 32. The learning rate is set to 2e-4. In each iteration, the sizes of new environments for agents to explore are: 256 for
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.4.1">
       ALFWorld
      </span>
      , 512 for
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.4.2">
       GSM8k
      </span>
      , and 1024 for
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.4.3">
       HotpotQA
      </span>
      .
For parameter-efficient fine-tuning, we employ LoRA
      <cite class="ltx_cite ltx_citemacro_cite">
       [
       <a class="ltx_ref" href="#bib.bib14" title="">
        14
       </a>
       ]
      </cite>
      with hyperparameters
      <math alttext="R=16" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.1.m1.1">
       <semantics id="S4.SS2.SSS0.Px3.p1.1.m1.1a">
        <mrow id="S4.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.cmml">
         <mi id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml">
          R
         </mi>
         <mo id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml">
          16
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.1.m1.1b">
         <apply id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1">
          <eq id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.1">
          </eq>
          <ci id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.2">
           𝑅
          </ci>
          <cn id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.3">
           16
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.1.m1.1c">
         R=16
        </annotation>
       </semantics>
      </math>
      and
      <math alttext="\alpha=16" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.2.m2.1">
       <semantics id="S4.SS2.SSS0.Px3.p1.2.m2.1a">
        <mrow id="S4.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.cmml">
         <mi id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml">
          α
         </mi>
         <mo id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml">
          =
         </mo>
         <mn id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.3" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.3.cmml">
          16
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.2.m2.1b">
         <apply id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1">
          <eq id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1">
          </eq>
          <ci id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2">
           𝛼
          </ci>
          <cn id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.3">
           16
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.2.m2.1c">
         \alpha=16
        </annotation>
       </semantics>
      </math>
      . For distributed training, we utilize 4 nodes with 8
      <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.3.m3.1">
       <semantics id="S4.SS2.SSS0.Px3.p1.3.m3.1a">
        <mo id="S4.SS2.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px3.p1.3.m3.1.1.cmml">
         ×
        </mo>
        <annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.3.m3.1b">
         <times id="S4.SS2.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.1.1">
         </times>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.3.m3.1c">
         \times
        </annotation>
       </semantics>
      </math>
      A100 GPUs on
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.4.4">
       HotpotQA
      </span>
      and
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.4.5">
       GSM8k
      </span>
      . For the experiments on
      <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.4.6">
       ALFWorld
      </span>
      , we use 1 node with 2
      <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.4.m4.1">
       <semantics id="S4.SS2.SSS0.Px3.p1.4.m4.1a">
        <mo id="S4.SS2.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.cmml">
         ×
        </mo>
        <annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.4.m4.1b">
         <times id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1">
         </times>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.4.m4.1c">
         \times
        </annotation>
       </semantics>
      </math>
      A100 GPUs due to the dataset’s small scale.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS2.SSS0.Px4">
    <h4 class="ltx_title ltx_title_paragraph">
     Baselines
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px4.p1">
     <p class="ltx_p" id="S4.SS2.SSS0.Px4.p1.1">
      We compare the agents trained by LTC with existing prompting and instruction tuning methods, including ReAct
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib65" title="">
        65
       </a>
       ]
      </cite>
      , ReAct-IM
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib16" title="">
        16
       </a>
       ]
      </cite>
      , CoT
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib61" title="">
        61
       </a>
       ]
      </cite>
      , CoT-SC
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib55" title="">
        55
       </a>
       ;
       <a class="ltx_ref" href="#bib.bib56" title="">
        56
       </a>
       ]
      </cite>
      , BUTLER
      <cite class="ltx_cite ltx_citemacro_cite">
       [
       <a class="ltx_ref" href="#bib.bib24" title="">
        24
       </a>
       ]
      </cite>
      . The detailed of these baselines are described in Appendix
      <a class="ltx_ref" href="#A1.SS7" title="A.7 Baselines ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
       <span class="ltx_text ltx_ref_tag">
        A.7
       </span>
      </a>
      . Most of these methods focus on few-shot prompting, and different pre-trained models are used. To ensure a fair comparison, we include the additional baselines named ReAct-Tuning and CoT-Tuning by fine-tuning the LLaMA-7B model using the collected trajectories as fine-tuning data mentioned in
      <a class="ltx_ref" href="#S4.SS2.SSS0.Px2" title="Agent Pre-training ‣ 4.2 Settings ‣ 4 Experiments ‣ Adapting LLM Agents Through Communication">
       <span class="ltx_text ltx_ref_tag">
        4.2
       </span>
      </a>
      . In addition, GPT-4 are not used in the test time, and all the results reported are obtained by the trained agent itself.
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="S4.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.3
    </span>
    Results
   </h3>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS3.SSS0.Px1">
    <h4 class="ltx_title ltx_font_italic ltx_title_paragraph">
     ALFWorld
    </h4>
    <figure class="ltx_table" id="S4.T1">
     <figure class="ltx_figure ltx_minipage ltx_align_center ltx_align_middle" id="S4.T1.1" style="width:424.9pt;">
      <div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.1.1" style="width:433.6pt;height:242.5pt;vertical-align:-0.0pt;">
       <span class="ltx_transformed_inner" style="transform:translate(39.8pt,-22.2pt) scale(1.22452908726913,1.22452908726913) ;">
        <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.1.1.1">
         <thead class="ltx_thead">
          <tr class="ltx_tr" id="S4.T1.1.1.1.2.1">
           <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2.1.1">
            Method \ Task
           </th>
           <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2.1.2">
            Pick
           </th>
           <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2.1.3">
            Clean
           </th>
           <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2.1.4">
            Heat
           </th>
           <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2.1.5">
            Cool
           </th>
           <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2.1.6">
            Look
           </th>
           <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2.1.7">
            Pick 2
           </th>
           <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2.1.8">
            All
           </th>
          </tr>
         </thead>
         <tbody class="ltx_tbody">
          <tr class="ltx_tr" id="S4.T1.1.1.1.3.1">
           <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.1.1.3.1.1">
            ReAct (avg)
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.3.1.2">
            65
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.3.1.3">
            39
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.3.1.4">
            83
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.3.1.5">
            76
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.3.1.6">
            55
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.3.1.7">
            24
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.3.1.8">
            57
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.4.2">
           <td class="ltx_td ltx_align_left" id="S4.T1.1.1.1.4.2.1">
            ReAct (best of 6)
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.4.2.2">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.2.2.1">
             92
            </span>
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.4.2.3">
            58
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.4.2.4">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.2.4.1">
             96
            </span>
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.4.2.5">
            86
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.4.2.6">
            78
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.4.2.7">
            41
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.4.2.8">
            71
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.5.3">
           <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.1.1.5.3.1">
            ReAct-IM (avg)
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.5.3.2">
            55
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.5.3.3">
            59
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.5.3.4">
            60
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.5.3.5">
            55
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.5.3.6">
            23
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.5.3.7">
            24
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.5.3.8">
            48
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.6.4">
           <td class="ltx_td ltx_align_left" id="S4.T1.1.1.1.6.4.1">
            ReAct-IM (best of 6)
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.6.4.2">
            62
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.6.4.3">
            68
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.6.4.4">
            87
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.6.4.5">
            57
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.6.4.6">
            39
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.6.4.7">
            33
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.6.4.8">
            53
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.1">
           <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.1.1.1.1">
            BUTLER
            <sub class="ltx_sub" id="S4.T1.1.1.1.1.1.1">
             <span class="ltx_text ltx_font_italic" id="S4.T1.1.1.1.1.1.1.1">
              g
             </span>
            </sub>
            (best of 8)
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2">
            33
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3">
            26
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4">
            70
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.5">
            76
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.6">
            17
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7">
            12
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8">
            22
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.7.5">
           <td class="ltx_td ltx_align_left" id="S4.T1.1.1.1.7.5.1">
            BUTLER (best of 8)
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.7.5.2">
            46
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.7.5.3">
            39
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.7.5.4">
            74
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.7.5.5">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.7.5.5.1">
             100
            </span>
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.7.5.6">
            22
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.7.5.7">
            24
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.7.5.8">
            37
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.8.6">
           <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T1.1.1.1.8.6.1">
            ReAct-Tuning (avg)
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.8.6.2">
            83
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.8.6.3">
            91
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.8.6.4">
            91
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.8.6.5">
            90
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.8.6.6">
            72
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.8.6.7">
            8
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.8.6.8">
            77
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.9.7">
           <td class="ltx_td ltx_align_left" id="S4.T1.1.1.1.9.7.1">
            ReAct-Tuning (best of 3)
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.9.7.2">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.9.7.2.1">
             92
            </span>
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.9.7.3">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.9.7.3.1">
             97
            </span>
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.9.7.4">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.9.7.4.1">
             96
            </span>
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.9.7.5">
            95
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.9.7.6">
            78
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.9.7.7">
            24
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.9.7.8">
            78
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.10.8">
           <td class="ltx_td ltx_align_left" id="S4.T1.1.1.1.10.8.1">
            LTC (avg)
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.10.8.2">
            89
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.10.8.3">
            91
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.10.8.4">
            93
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.10.8.5">
            97
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.10.8.6">
            96
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.10.8.7">
            67
           </td>
           <td class="ltx_td ltx_align_center" id="S4.T1.1.1.1.10.8.8">
            90
           </td>
          </tr>
          <tr class="ltx_tr" id="S4.T1.1.1.1.11.9">
           <td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.1.1.11.9.1">
            LTC (best of 3)
           </td>
           <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.11.9.2">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.11.9.2.1">
             92
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.11.9.3">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.11.9.3.1">
             97
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.11.9.4">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.11.9.4.1">
             96
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.11.9.5">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.11.9.5.1">
             100
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.11.9.6">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.11.9.6.1">
             100
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.11.9.7">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.11.9.7.1">
             76
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.11.9.8">
            <span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.11.9.8.1">
             91
            </span>
           </td>
          </tr>
         </tbody>
        </table>
       </span>
      </div>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        Table 1:
       </span>
       AlfWorld success rates (%) for 6 tasks. The results of the bottom block are obtained by fine-tuning LLaMA-7B model.
      </figcaption>
     </figure>
    </figure>
    <div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p1">
     <p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">
      As shown in Table
      <a class="ltx_ref" href="#S4.T1" title="Table 1 ‣ ALFWorld ‣ 4.3 Results ‣ 4 Experiments ‣ Adapting LLM Agents Through Communication">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </a>
      , LTC outperforms the previous best methods
      <span class="ltx_note ltx_role_footnote" id="footnote1">
       <sup class="ltx_note_mark">
        *
       </sup>
       <span class="ltx_note_outer">
        <span class="ltx_note_content">
         <sup class="ltx_note_mark">
          *
         </sup>
         <span class="ltx_tag ltx_tag_note">
          *
         </span>
         For
         <span class="ltx_text ltx_font_italic" id="footnote1.1">
          ALFWorld
         </span>
         , ReAct and ReAct-IM results are from Table 3 of
         <cite class="ltx_cite ltx_citemacro_cite">
          [
          <a class="ltx_ref" href="#bib.bib65" title="">
           65
          </a>
          ]
         </cite>
         . BUTLER and BUTLER
         <sub class="ltx_sub" id="footnote1.2">
          <span class="ltx_text ltx_font_italic" id="footnote1.2.1">
           g
          </span>
         </sub>
         results are from Table 4 of
         <cite class="ltx_cite ltx_citemacro_cite">
          [
          <a class="ltx_ref" href="#bib.bib46" title="">
           46
          </a>
          ]
         </cite>
         , and they are trained with DAgger
         <cite class="ltx_cite ltx_citemacro_cite">
          [
          <a class="ltx_ref" href="#bib.bib38" title="">
           38
          </a>
          ]
         </cite>
         .
        </span>
       </span>
      </span>
      on all of tasks of
      <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px1.p1.1.1">
       ALFWorld
      </span>
      . We can see that Instruction Fine-tuning is already a strong baseline outperforming others, yet our LTC achieves a success rate of 91%, remarkably outperforming the best Instruction Tuning baseline (78%).
Notably, on both Cool and Look tasks, LTC obtains a 100% success rate.
Even on the hardest Pick Two &amp; Place task (e.g., “put two pencils in the drawer”), it achieves a decent 76% success rate.
The Pick Two task requires the agent to perform two sequences of ”pick and place” actions in one task, while keeping track of the desired type and the location.
The combined sequences and the need to remember the previous location make this task challenging.
This may be the reason why baselines achieve lower success rates on this task.
In contrast, our LTC agent, which further trains the agent with self-exploration significantly outperforms other agents. This underscores the effectiveness of the communication mechanism in LTC.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS3.SSS0.Px2">
    <h4 class="ltx_title ltx_font_italic ltx_title_paragraph">
     HotpotQA
    </h4>
    <figure class="ltx_table" id="S4.T3">
     <div class="ltx_flex_figure ltx_flex_table">
      <div class="ltx_flex_cell ltx_flex_size_2">
       <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.T3.1" style="width:173.4pt;">
        <div class="ltx_inline-block ltx_transformed_outer" id="S4.T3.1.1" style="width:433.6pt;height:275.8pt;vertical-align:-0.0pt;">
         <span class="ltx_transformed_inner" style="transform:translate(47.0pt,-29.9pt) scale(1.27682404927948,1.27682404927948) ;">
          <table class="ltx_tabular ltx_align_middle" id="S4.T3.1.1.1">
           <tbody class="ltx_tbody">
            <tr class="ltx_tr" id="S4.T3.1.1.1.2.1">
             <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.1.1.1.2.1.1">
              <span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.2.1.1.1">
               Model
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.1.1.1.2.1.2">
              <span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.2.1.2.1">
               Method
              </span>
             </td>
             <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.2.1.3">
              <span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.2.1.3.1">
               EM score
              </span>
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.3.2">
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.3.2.1" rowspan="3">
              <span class="ltx_text" id="S4.T3.1.1.1.3.2.1.1">
               PaLM-540B
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.3.2.2">
              CoT
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib61" title="">
                61
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.3.2.3">
              29.4
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.4.3">
             <td class="ltx_td ltx_align_left" id="S4.T3.1.1.1.4.3.1">
              CoT-SC
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib55" title="">
                55
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center" id="S4.T3.1.1.1.4.3.2">
              33.4
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.5.4">
             <td class="ltx_td ltx_align_left" id="S4.T3.1.1.1.5.4.1">
              ReAct
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib65" title="">
                65
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center" id="S4.T3.1.1.1.5.4.2">
              27.4
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.1">
             <td class="ltx_td" id="S4.T3.1.1.1.1.2">
             </td>
             <td class="ltx_td ltx_align_left" id="S4.T3.1.1.1.1.1">
              ReAct
              <math alttext="\to" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.1.m1.1">
               <semantics id="S4.T3.1.1.1.1.1.m1.1a">
                <mo id="S4.T3.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T3.1.1.1.1.1.m1.1.1.cmml">
                 →
                </mo>
                <annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.1.m1.1b">
                 <ci id="S4.T3.1.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1">
                  →
                 </ci>
                </annotation-xml>
                <annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.1.m1.1c">
                 \to
                </annotation>
               </semantics>
              </math>
              CoT-SC
             </td>
             <td class="ltx_td ltx_align_center" id="S4.T3.1.1.1.1.3">
              35.1
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.6.5">
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.6.5.1">
              GPT3-175B
             </td>
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.6.5.2">
              ReAct
             </td>
             <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.6.5.3">
              30.8
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.7.6">
             <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.1.1.1.7.6.1" rowspan="2">
              <span class="ltx_text" id="S4.T3.1.1.1.7.6.1.1">
               PaLM-62B
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.1.1.1.7.6.2">
              ReAct-Tuning
             </td>
             <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.7.6.3">
              32.6
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.8.7">
             <td class="ltx_td ltx_align_left" id="S4.T3.1.1.1.8.7.1">
              CoT-Tuning
             </td>
             <td class="ltx_td ltx_align_center" id="S4.T3.1.1.1.8.7.2">
              25.2
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.9.8">
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.9.8.1" rowspan="2">
              <span class="ltx_text" id="S4.T3.1.1.1.9.8.1.1">
               PaLM-8B
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.9.8.2">
              ReAct-Tuning
             </td>
             <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.9.8.3">
              25.0
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.10.9">
             <td class="ltx_td ltx_align_left" id="S4.T3.1.1.1.10.9.1">
              CoT-Tuning
             </td>
             <td class="ltx_td ltx_align_center" id="S4.T3.1.1.1.10.9.2">
              14.1
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.11.10">
             <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T3.1.1.1.11.10.1" rowspan="2">
              <span class="ltx_text" id="S4.T3.1.1.1.11.10.1.1">
               LLaMA-7B
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.11.10.2">
              ReAct-Tuning
             </td>
             <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.11.10.3">
              28.1
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.1.1.1.12.11">
             <td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.1.1.1.12.11.1">
              LTC
             </td>
             <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.1.12.11.2">
              <span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.12.11.2.1">
               33.2
              </span>
             </td>
            </tr>
           </tbody>
          </table>
         </span>
        </div>
        <figcaption class="ltx_caption">
         <span class="ltx_tag ltx_tag_figure">
          Table 2:
         </span>
         EM scores on HotpotQA with prompt and tuning methods. Methods that use fine-tuning are marked by “-Tuning”.
        </figcaption>
       </figure>
      </div>
      <div class="ltx_flex_cell ltx_flex_size_2">
       <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.T3.fig1" style="width:182.1pt;">
        <div class="ltx_inline-block ltx_transformed_outer" id="S4.T3.fig1.1" style="width:433.6pt;height:207.1pt;vertical-align:-0.0pt;">
         <span class="ltx_transformed_inner" style="transform:translate(47.2pt,-22.6pt) scale(1.27860184424093,1.27860184424093) ;">
          <table class="ltx_tabular ltx_align_middle" id="S4.T3.fig1.1.1">
           <tbody class="ltx_tbody">
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.1.1">
             <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.fig1.1.1.1.1.1">
              <span class="ltx_text ltx_font_bold" id="S4.T3.fig1.1.1.1.1.1.1">
               Model
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.fig1.1.1.1.1.2">
              <span class="ltx_text ltx_font_bold" id="S4.T3.fig1.1.1.1.1.2.1">
               Method
              </span>
             </td>
             <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.fig1.1.1.1.1.3">
              <span class="ltx_text ltx_font_bold" id="S4.T3.fig1.1.1.1.1.3.1">
               Accuracy
              </span>
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.2.2">
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.fig1.1.1.2.2.1" rowspan="2">
              <span class="ltx_text" id="S4.T3.fig1.1.1.2.2.1.1">
               PaLM-540B
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.fig1.1.1.2.2.2">
              CoT
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib61" title="">
                61
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.fig1.1.1.2.2.3">
              56.5
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.3.3">
             <td class="ltx_td ltx_align_left" id="S4.T3.fig1.1.1.3.3.1">
              CoT-SC
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib55" title="">
                55
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center" id="S4.T3.fig1.1.1.3.3.2">
              74.4
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.4.4">
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.fig1.1.1.4.4.1" rowspan="2">
              <span class="ltx_text" id="S4.T3.fig1.1.1.4.4.1.1">
               GPT3-175B
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.fig1.1.1.4.4.2">
              CoT
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib61" title="">
                61
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.fig1.1.1.4.4.3">
              60.1
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.5.5">
             <td class="ltx_td ltx_align_left" id="S4.T3.fig1.1.1.5.5.1">
              CoT-SC
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib55" title="">
                55
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center" id="S4.T3.fig1.1.1.5.5.2">
              78.0
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.6.6">
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.fig1.1.1.6.6.1" rowspan="2">
              <span class="ltx_text" id="S4.T3.fig1.1.1.6.6.1.1">
               LLaMA-7B
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.fig1.1.1.6.6.2">
              CoT
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib52" title="">
                52
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.fig1.1.1.6.6.3">
              11.0
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.7.7">
             <td class="ltx_td ltx_align_left" id="S4.T3.fig1.1.1.7.7.1">
              CoT-SC
              <cite class="ltx_cite ltx_citemacro_citep">
               [
               <a class="ltx_ref" href="#bib.bib52" title="">
                52
               </a>
               ]
              </cite>
             </td>
             <td class="ltx_td ltx_align_center" id="S4.T3.fig1.1.1.7.7.2">
              18.1
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.8.8">
             <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T3.fig1.1.1.8.8.1" rowspan="2">
              <span class="ltx_text" id="S4.T3.fig1.1.1.8.8.1.1">
               LLaMA-7B
              </span>
             </td>
             <td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.fig1.1.1.8.8.2">
              CoT-Tuning
             </td>
             <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.fig1.1.1.8.8.3">
              37.7
             </td>
            </tr>
            <tr class="ltx_tr" id="S4.T3.fig1.1.1.9.9">
             <td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.fig1.1.1.9.9.1">
              LTC
             </td>
             <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.fig1.1.1.9.9.2">
              <span class="ltx_text ltx_font_bold" id="S4.T3.fig1.1.1.9.9.2.1">
               41.3
              </span>
             </td>
            </tr>
           </tbody>
          </table>
         </span>
        </div>
        <figcaption class="ltx_caption ltx_centering">
         <span class="ltx_tag ltx_tag_figure">
          Table 3:
         </span>
         Accuracy on GSM8k. The results of the bottom block are obtained by fine-tuning LLaMA-7B model, while the others are prompting methods without fine-tuning.
        </figcaption>
       </figure>
      </div>
     </div>
    </figure>
    <div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p1">
     <p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.2">
      As shown in Table
      <a class="ltx_ref" href="#S4.T3" title="Table 3 ‣ HotpotQA ‣ 4.3 Results ‣ 4 Experiments ‣ Adapting LLM Agents Through Communication">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </a>
      , LTC outperforms the instruction tuning baseline
      <span class="ltx_note ltx_role_footnote" id="footnote2">
       <sup class="ltx_note_mark">
        †
       </sup>
       <span class="ltx_note_outer">
        <span class="ltx_note_content">
         <sup class="ltx_note_mark">
          †
         </sup>
         <span class="ltx_tag ltx_tag_note">
          †
         </span>
         For HotPotQA, Prompting method results without fine-tuning are from Table 1&amp;5 of
         <cite class="ltx_cite ltx_citemacro_cite">
          [
          <a class="ltx_ref" href="#bib.bib65" title="">
           65
          </a>
          ]
         </cite>
         . PaLM-8B and PaLM-62B scores are estimates from Figure 3 of
         <cite class="ltx_cite ltx_citemacro_cite">
          [
          <a class="ltx_ref" href="#bib.bib65" title="">
           65
          </a>
          ]
         </cite>
         .
        </span>
       </span>
      </span>
      by 5.1% on Exact Match (EM) score, and it even outperforms ReAct and CoT on their default settings. Note that ReAct and CoT use PaLM-540B and GPT3-175B as the pre-trained LM model, which is 77x and 25x larger than our the LLaMA-7B model we used. By sampling 21 CoT trajectories during inference and adopting the majority answer, CoT-SC is slightly better (0.2%) than LTC, and their combined method ReAct
      <math alttext="\to" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.1.m1.1">
       <semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a">
        <mo id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">
         →
        </mo>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b">
         <ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1">
          →
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">
         \to
        </annotation>
       </semantics>
      </math>
      CoT-SC surpasses LTC by 1.9%. Compared to other models with tuning, our LLaMA-7B based agent even obtains slightly better (0.6%) performance than the ReAct-Tuning baseline with 9
      <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.2.m2.1">
       <semantics id="S4.SS3.SSS0.Px2.p1.2.m2.1a">
        <mo id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">
         ×
        </mo>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.1b">
         <times id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1">
         </times>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.1c">
         \times
        </annotation>
       </semantics>
      </math>
      larger PaLM-62B model.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph ltx_indentfirst" id="S4.SS3.SSS0.Px3">
    <h4 class="ltx_title ltx_font_italic ltx_title_paragraph">
     GSM8k
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px3.p1">
     <p class="ltx_p" id="S4.SS3.SSS0.Px3.p1.1">
      As shown in Table
      <a class="ltx_ref" href="#S4.T3" title="Table 3 ‣ HotpotQA ‣ 4.3 Results ‣ 4 Experiments ‣ Adapting LLM Agents Through Communication">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </a>
      , LTC outperforms the instruction fine-tuning baseline by 3.6% on accuracy.
It also outperforms CoT and CoT-SC baselines with the same LLaMA-7B model.
However, LTC underperforms CoT and CoT-SC with the much larger models (PaLM-540B and GPT3-175B).
This phenomenon is because numerical reasoning requires a larger model size and sufficient pretraining data, as observed in
      <cite class="ltx_cite ltx_citemacro_cite">
       [
       <a class="ltx_ref" href="#bib.bib28" title="">
        28
       </a>
       ]
      </cite>
      .
Unfortunately, due to computational resource limitations, we can only train the relatively small LLaMA-7B model but were unable to train larger-scale models.
Nevertheless, we believe that exploring LTC with larger models is promising for future research.
     </p>
    </div>
   </section>
  </section>
 </section>
 <section class="ltx_section ltx_indent_first" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Discussion
  </h2>
  <section class="ltx_paragraph ltx_indentfirst" id="S5.SS0.SSS0.Px1">
   <h4 class="ltx_title ltx_title_paragraph">
    Efficiency
   </h4>
   <figure class="ltx_table" id="S5.T4">
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S5.T4.1.1.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T4.1.1.1.1" rowspan="2">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.1.1">
         Method
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.2">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.2.1">
         GSM8k
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.3">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.3.1">
         Hotpot-QA
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.4">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.4.1">
         Alfworld
        </span>
       </th>
      </tr>
      <tr class="ltx_tr" id="S5.T4.1.2.2">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.1.2.2.1">
        (CoT)
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.1.2.2.2">
        (ReAct)
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.1.2.2.3">
        (ReAct)
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T4.1.3.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.3.1.1">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.3.1.1.1">
         ICL
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.2">
        836
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.3">
        1937
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.4">
        1744
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T4.1.4.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T4.1.4.2.1">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.4.2.1.1">
         LTC
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.1.4.2.2">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.4.2.2.1">
         107
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.1.4.2.3">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.4.2.3.1">
         167
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.1.4.2.4">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.4.2.4.1">
         189
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 4:
     </span>
     Average number of tokens of the input prompts on test sets. LTC does not use any few shot examples in the prompt, hence uses only a fraction of tokens compared to ICL.
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px1.p1">
    <p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">
     As mentioned above, prompting-based methods such as ReAct
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib65" title="">
       65
      </a>
      ]
     </cite>
     and CoT
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib61" title="">
       61
      </a>
      ]
     </cite>
     use a subset of exemplary trajectories from the given task as few-shot prompts during inference.
However, these few-shot prompts are often long, which leads to increased inference cost and limited context length for user queries.
As shown in Table
     <a class="ltx_ref" href="#S5.T4" title="Table 4 ‣ Efficiency ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , we compare the number of input tokens for each task.
We compute the CoT prompts for
     <span class="ltx_text ltx_font_bold" id="S5.SS0.SSS0.Px1.p1.1.1">
      GSM8k
     </span>
     , and we use ReAct for the other two tasks. All the few-shot prompts are sourced from the original paper. As shown, our LTC agents used only 12.8%, 8.6%, and 10.8% of the input tokens required by the ICL methods on the three tasks, respectively.
    </p>
   </div>
   <figure class="ltx_figure" id="S5.F6">
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_2">
      <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.1" style="width:212.5pt;">
       <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="105" id="S5.F6.1.g1" src="/html/2310.01444/assets/x4.png" width="134"/>
       <figcaption class="ltx_caption ltx_centering">
        <span class="ltx_tag ltx_tag_figure">
         Figure 5:
        </span>
        The accuracy curves of PPO training.
       </figcaption>
      </figure>
     </div>
     <div class="ltx_flex_cell ltx_flex_size_2">
      <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.2" style="width:212.5pt;">
       <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="105" id="S5.F6.2.g1" src="/html/2310.01444/assets/x5.png" width="134"/>
       <figcaption class="ltx_caption ltx_centering">
        <span class="ltx_tag ltx_tag_figure">
         Figure 6:
        </span>
        The loss curves of PPO training.
       </figcaption>
      </figure>
     </div>
    </div>
   </figure>
  </section>
  <section class="ltx_paragraph ltx_indentfirst" id="S5.SS0.SSS0.Px2">
   <h4 class="ltx_title ltx_title_paragraph">
    Shortcuts
   </h4>
   <div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px2.p1">
    <p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.1">
     One interesting observation is that the GPT-4 agent sometimes employs ”shortcuts” to solve problems when serving as a teacher to generate new training data. These shortcuts rely on the internal knowledge acquired during its pretraining process. To illustrate this, we present a case study from
     <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px2.p1.1.1">
      HotpotQA
     </span>
     in Figure
     <a class="ltx_ref" href="#S5.F7" title="Figure 7 ‣ Shortcuts ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     . In this case, the GPT-4 agent quickly retrieves the answer by leveraging its memorized knowledge about the second entry after receiving the Wikipedia page of the first entry. On the other hand, the bottom of Figure
     <a class="ltx_ref" href="#S5.F7" title="Figure 7 ‣ Shortcuts ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     demonstrates a comparison with LLaMA-7B, which was trained using our LTC method with the GPT-4 agent in the loop. LLaMA-7B does not employ shortcuts and instead performs a search for the second entry. This case study demonstrates that communication mechanism in LTC provide additional benefits during learning, compared to soley relying on data generated by GPT-4.
    </p>
   </div>
   <figure class="ltx_figure" id="S5.F7">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="250" id="S5.F7.g1" src="/html/2310.01444/assets/x6.png" width="291"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 7:
     </span>
     GPT-4 can use shortcuts to solve the problem, while the LLaMA-7B agent cannot mimic it.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_paragraph ltx_indentfirst" id="S5.SS0.SSS0.Px3">
   <h4 class="ltx_title ltx_title_paragraph">
    Ablation
   </h4>
   <div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px3.p1">
    <p class="ltx_p" id="S5.SS0.SSS0.Px3.p1.1">
     We conducted ablation studies on the loss design of LTC. Figure
     <a class="ltx_ref" href="#S5.F6" title="Figure 6 ‣ Efficiency ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     illustrates the success rate of agents on the
     <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px3.p1.1.1">
      ALFWorld
     </span>
     dataset under different loss settings. Without using our communication pattern for interactions and merely sampling pre-collected instruction data for training, the improvement was limited. However, when we incorporated our communication pattern to gather data, the model’s performance quickly surpassed 80%.
Furthermore, employing PPO loss to handle positive and negative samples separately resulted in faster and more significant improvement (blue line).
In Figure
     <a class="ltx_ref" href="#S5.F6" title="Figure 6 ‣ Efficiency ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     , we present the separate curves of the three main losses during training. Initially, the LM loss showed a decreasing trend. Interestingly, as training iterations progressed, both the value loss and policy loss gradually decreased, which possibly causes the LM loss to increase temporarily. After the value loss and policy loss reached a certain threshold, the LM loss continued to decrease till convergence.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section ltx_indent_first" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Conclusion
  </h2>
  <div class="ltx_para ltx_noindent" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    We introduced Learning-Through-Communication (LTC), a paradigm that adapts LLM agents to new tasks and environments via communication-based iterative learning.
Within this LTC framework, we have designed three communication modes for common tasks including decision-making, knowledge-intensive reasoning, and numeric reasoning.
These communication modes facilitate interactions between LLM agents and their environments, as well as other agents such as GPT-4 and humans.
The history of these interactions can be autonomously organized into training data for PPO training so that the agent can adapt to the new task.
Our approach represents a closed loop where the agent self-interacts with the environment or other agents, and learning to improve itself with minimal human intervention.
Empirically, we have demonstrated that LTC performs strongly in success rate and efficiency across three different tasks: AlfWorld, HotpotQA, and GSM8k.
It consistently outperforms existing LLM agent and instruction tuning baselines, showing the promise of the LTC paradigm in adapting LLM agents to new tasks and environments with minimal human effort.
As for future work, we plan to explore more diverse communication patterns for different tasks, and involve the communication with human during the iterative learning process.
We will open source our code to facilitate further research in this line.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Akata et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Elif Akata, Lion Schulz, Julian Coda-Forno, Seong Joon Oh, Matthias Bethge, and Eric Schulz.
    </span>
    <span class="ltx_bibblock">
     Playing repeated games with large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">
      arXiv preprint arXiv:2305.16867
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     AntonOsika [2023]
    </span>
    <span class="ltx_bibblock">
     AntonOsika.
    </span>
    <span class="ltx_bibblock">
     gpt-engineer.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/AntonOsika/gpt-engineer" target="_blank" title="">
      https://github.com/AntonOsika/gpt-engineer
     </a>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     GitHub repository.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bai et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Yuntao Bai, Andy Jones, Kamal Ndousse, Amanda Askell, Anna Chen, Nova DasSarma, Dawn Drain, Stanislav Fort, Deep Ganguli, Tom Henighan, et al.
    </span>
    <span class="ltx_bibblock">
     Training a helpful and harmless assistant with reinforcement learning from human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">
      arXiv preprint arXiv:2204.05862
     </em>
     , 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bai et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Yuntao Bai, Saurav Kadavath, Sandipan Kundu, Amanda Askell, Jackson Kernion, Andy Jones, Anna Chen, Anna Goldie, Azalia Mirhoseini, Cameron McKinnon, et al.
    </span>
    <span class="ltx_bibblock">
     Constitutional ai: Harmlessness from ai feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      arXiv preprint arXiv:2212.08073
     </em>
     , 2022b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Brown et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.
    </span>
    <span class="ltx_bibblock">
     Language models are few-shot learners.
    </span>
    <span class="ltx_bibblock">
     In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Balcan, and H. Lin (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , volume 33, pp.  1877–1901. Curran Associates, Inc., 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bubeck et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Sébastien Bubeck, Varun Chandrasekaran, Ronen Eldan, Johannes Gehrke, Eric Horvitz, Ece Kamar, Peter Lee, Yin Tat Lee, Yuanzhi Li, Scott Lundberg, et al.
    </span>
    <span class="ltx_bibblock">
     Sparks of artificial general intelligence: Early experiments with gpt-4.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">
      arXiv preprint arXiv:2303.12712
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chiang et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Wei-Lin Chiang, Zhuohan Li, Zi Lin, Ying Sheng, Zhanghao Wu, Hao Zhang, Lianmin Zheng, Siyuan Zhuang, Yonghao Zhuang, Joseph E Gonzalez, et al.
    </span>
    <span class="ltx_bibblock">
     Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">
      See https://vicuna. lmsys. org (accessed 14 April 2023)
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chowdhery et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, Hyung Won Chung, Charles Sutton, Sebastian Gehrmann, et al.
    </span>
    <span class="ltx_bibblock">
     Palm: Scaling language modeling with pathways.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">
      arXiv preprint arXiv:2204.02311
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chung et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Hyung Won Chung, Le Hou, Shayne Longpre, Barret Zoph, Yi Tay, William Fedus, Eric Li, Xuezhi Wang, Mostafa Dehghani, Siddhartha Brahma, et al.
    </span>
    <span class="ltx_bibblock">
     Scaling instruction-finetuned language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">
      arXiv preprint arXiv:2210.11416
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cobbe et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, Christopher Hesse, and John Schulman.
    </span>
    <span class="ltx_bibblock">
     Training verifiers to solve math word problems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">
      arXiv preprint arXiv:2110.14168
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gao et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Luyu Gao, Aman Madaan, Shuyan Zhou, Uri Alon, Pengfei Liu, Yiming Yang, Jamie Callan, and Graham Neubig.
    </span>
    <span class="ltx_bibblock">
     Pal: Program-aided language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">
      arXiv preprint arXiv:2211.10435
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hong et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Sirui Hong, Xiawu Zheng, Jonathan Chen, Yuheng Cheng, Jinlin Wang, Ceyao Zhang, Zili Wang, Steven Ka Shing Yau, Zijuan Lin, Liyang Zhou, Chenyu Ran, Lingfeng Xiao, and Chenglin Wu.
    </span>
    <span class="ltx_bibblock">
     Metagpt: Meta programming for multi-agent collaborative framework, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Honovich et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Or Honovich, Thomas Scialom, Omer Levy, and Timo Schick.
    </span>
    <span class="ltx_bibblock">
     Unnatural instructions: Tuning language models with (almost) no human labor.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      arXiv preprint arXiv:2212.09689
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hu et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.
    </span>
    <span class="ltx_bibblock">
     Lora: Low-rank adaptation of large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">
      arXiv preprint arXiv:2106.09685
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Huang et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Jiaxin Huang, Shixiang Shane Gu, Le Hou, Yuexin Wu, Xuezhi Wang, Hongkun Yu, and Jiawei Han.
    </span>
    <span class="ltx_bibblock">
     Large language models can self-improve, 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Huang et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Wenlong Huang, Fei Xia, Ted Xiao, Harris Chan, Jacky Liang, Pete Florence, Andy Zeng, Jonathan Tompson, Igor Mordatch, Yevgen Chebotar, Pierre Sermanet, Noah Brown, Tomas Jackson, Linda Luu, Sergey Levine, Karol Hausman, and Brian Ichter.
    </span>
    <span class="ltx_bibblock">
     Inner monologue: Embodied reasoning through planning with language models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">
      arXiv preprint arXiv:2207.05608
     </em>
     , 2022b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Izacard et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Gautier Izacard, Patrick Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane Dwivedi-Yu, Armand Joulin, Sebastian Riedel, and Edouard Grave.
    </span>
    <span class="ltx_bibblock">
     Few-shot learning with retrieval augmented language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      arXiv preprint arXiv:2208.03299
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Leike et al. [2018]
    </span>
    <span class="ltx_bibblock">
     Jan Leike, David Krueger, Tom Everitt, Miljan Martic, Vishal Maini, and Shane Legg.
    </span>
    <span class="ltx_bibblock">
     Scalable agent alignment via reward modeling: a research direction, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Guohao Li, Hasan Abed Al Kader Hammoud, Hani Itani, Dmitrii Khizbullin, and Bernard Ghanem.
    </span>
    <span class="ltx_bibblock">
     Camel: Communicative agents for ”mind” exploration of large scale language model society, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Ruibo Liu, Ruixin Yang, Chenyan Jia, Ge Zhang, Denny Zhou, Andrew M Dai, Diyi Yang, and Soroush Vosoughi.
    </span>
    <span class="ltx_bibblock">
     Training socially aligned language models in simulated human society.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">
      arXiv preprint arXiv:2305.16960
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Longpre et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Shayne Longpre, Le Hou, Tu Vu, Albert Webson, Hyung Won Chung, Yi Tay, Denny Zhou, Quoc V Le, Barret Zoph, Jason Wei, et al.
    </span>
    <span class="ltx_bibblock">
     The flan collection: Designing data and methods for effective instruction tuning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">
      arXiv preprint arXiv:2301.13688
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Loshchilov &amp; Hutter [2017]
    </span>
    <span class="ltx_bibblock">
     Ilya Loshchilov and Frank Hutter.
    </span>
    <span class="ltx_bibblock">
     Decoupled weight decay regularization.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">
      arXiv preprint arXiv:1711.05101
     </em>
     , 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lu et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Pan Lu, Baolin Peng, Hao Cheng, Michel Galley, Kai-Wei Chang, Ying Nian Wu, Song-Chun Zhu, and Jianfeng Gao.
    </span>
    <span class="ltx_bibblock">
     Chameleon: Plug-and-play compositional reasoning with large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">
      arXiv preprint arXiv:2304.09842
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Micheli &amp; Fleuret [2021]
    </span>
    <span class="ltx_bibblock">
     Vincent Micheli and François Fleuret.
    </span>
    <span class="ltx_bibblock">
     Language models are few-shot butlers.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">
      arXiv preprint arXiv:2104.07972
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Mnih et al. [2016]
    </span>
    <span class="ltx_bibblock">
     Volodymyr Mnih, Adria Puigdomenech Badia, Mehdi Mirza, Alex Graves, Timothy Lillicrap, Tim Harley, David Silver, and Koray Kavukcuoglu.
    </span>
    <span class="ltx_bibblock">
     Asynchronous methods for deep reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      International conference on machine learning
     </em>
     , pp.  1928–1937. PMLR, 2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Muennighoff et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Niklas Muennighoff, Thomas Wang, Lintang Sutawika, Adam Roberts, Stella Biderman, Teven Le Scao, M Saiful Bari, Sheng Shen, Zheng-Xin Yong, Hailey Schoelkopf, et al.
    </span>
    <span class="ltx_bibblock">
     Crosslingual generalization through multitask finetuning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">
      arXiv preprint arXiv:2211.01786
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     OpenAI [2022]
    </span>
    <span class="ltx_bibblock">
     OpenAI.
    </span>
    <span class="ltx_bibblock">
     Chatgpt.
    </span>
    <span class="ltx_bibblock">
     Online, 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/blog/chatgpt" target="_blank" title="">
      https://openai.com/blog/chatgpt
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     OpenAI [2023]
    </span>
    <span class="ltx_bibblock">
     OpenAI.
    </span>
    <span class="ltx_bibblock">
     Gpt-4 technical report.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">
      OpenAI blog
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ouyang et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al.
    </span>
    <span class="ltx_bibblock">
     Training language models to follow instructions with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 35:27730–27744, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Park et al. [2023a]
    </span>
    <span class="ltx_bibblock">
     Joon Sung Park, Joseph C. O’Brien, Carrie J. Cai, Meredith Ringel Morris, Percy Liang, and Michael S. Bernstein.
    </span>
    <span class="ltx_bibblock">
     Generative agents: Interactive simulacra of human behavior.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      In the 36th Annual ACM Symposium on User Interface Software and Technology (UIST ’23)
     </em>
     , UIST ’23, New York, NY, USA, 2023a. Association for Computing Machinery.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Park et al. [2023b]
    </span>
    <span class="ltx_bibblock">
     Joon Sung Park, Joseph C. O’Brien, Carrie J. Cai, Meredith Ringel Morris, Percy Liang, and Michael S. Bernstein.
    </span>
    <span class="ltx_bibblock">
     Generative agents: Interactive simulacra of human behavior, 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Peng et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Baolin Peng, Chunyuan Li, Pengcheng He, Michel Galley, and Jianfeng Gao.
    </span>
    <span class="ltx_bibblock">
     Instruction tuning with gpt-4.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">
      arXiv preprint arXiv:2304.03277
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Qian et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Chen Qian, Xin Cong, Cheng Yang, Weize Chen, Yusheng Su, Juyuan Xu, Zhiyuan Liu, and Maosong Sun.
    </span>
    <span class="ltx_bibblock">
     Communicative agents for software development.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">
      arXiv preprint arXiv:2307.07924
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Qin et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Chengwei Qin, Aston Zhang, Zhuosheng Zhang, Jiaao Chen, Michihiro Yasunaga, and Diyi Yang.
    </span>
    <span class="ltx_bibblock">
     Is chatgpt a general-purpose natural language processing task solver?, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Radford et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Alec Radford, Jeff Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever.
    </span>
    <span class="ltx_bibblock">
     Language models are unsupervised multitask learners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">
      OpenAI blog
     </em>
     , 1(8):9, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Rafailov et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Rafael Rafailov, Archit Sharma, Eric Mitchell, Stefano Ermon, Christopher D. Manning, and Chelsea Finn.
    </span>
    <span class="ltx_bibblock">
     Direct preference optimization: Your language model is secretly a reward model, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Raffel et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu.
    </span>
    <span class="ltx_bibblock">
     Exploring the limits of transfer learning with a unified text-to-text transformer.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">
      Journal of Machine Learning Research
     </em>
     , 21(140):1–67, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ross et al. [2011]
    </span>
    <span class="ltx_bibblock">
     Stéphane Ross, Geoffrey Gordon, and Drew Bagnell.
    </span>
    <span class="ltx_bibblock">
     A reduction of imitation learning and structured prediction to no-regret online learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">
      Proceedings of the fourteenth international conference on artificial intelligence and statistics
     </em>
     , pp.  627–635. JMLR Workshop and Conference Proceedings, 2011.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Santacroce et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Michael Santacroce, Yadong Lu, Han Yu, Yuanzhi Li, and Yelong Shen.
    </span>
    <span class="ltx_bibblock">
     Efficient rlhf: Reducing the memory usage of ppo, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Scao et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Teven Le Scao, Angela Fan, Christopher Akiki, Ellie Pavlick, Suzana Ilić, Daniel Hesslow, Roman Castagné, Alexandra Sasha Luccioni, François Yvon, Matthias Gallé, et al.
    </span>
    <span class="ltx_bibblock">
     Bloom: A 176b-parameter open-access multilingual language model.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">
      arXiv preprint arXiv:2211.05100
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schick et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Timo Schick, Jane Dwivedi-Yu, Roberto Dessì, Roberta Raileanu, Maria Lomeli, Luke Zettlemoyer, Nicola Cancedda, and Thomas Scialom.
    </span>
    <span class="ltx_bibblock">
     Toolformer: Language models can teach themselves to use tools.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">
      arXiv preprint arXiv:2302.04761
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schulman et al. [2017]
    </span>
    <span class="ltx_bibblock">
     John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.
    </span>
    <span class="ltx_bibblock">
     Proximal policy optimization algorithms, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shi et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Weijia Shi, Sewon Min, Michihiro Yasunaga, Minjoon Seo, Rich James, Mike Lewis, Luke Zettlemoyer, and Wen-tau Yih.
    </span>
    <span class="ltx_bibblock">
     Replug: Retrieval-augmented black-box language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">
      arXiv preprint arXiv:2301.12652
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shinn et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Noah Shinn, Federico Cassano, Beck Labash, Ashwin Gopinath, Karthik Narasimhan, and Shunyu Yao.
    </span>
    <span class="ltx_bibblock">
     Reflexion: Language agents with verbal reinforcement learning, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shridhar et al. [2020a]
    </span>
    <span class="ltx_bibblock">
     Mohit Shridhar, Jesse Thomason, Daniel Gordon, Yonatan Bisk, Winson Han, Roozbeh Mottaghi, Luke Zettlemoyer, and Dieter Fox.
    </span>
    <span class="ltx_bibblock">
     Alfred: A benchmark for interpreting grounded instructions for everyday tasks.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">
      Proceedings of the IEEE/CVF conference on computer vision and pattern recognition
     </em>
     , pp.  10740–10749, 2020a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shridhar et al. [2020b]
    </span>
    <span class="ltx_bibblock">
     Mohit Shridhar, Xingdi Yuan, Marc-Alexandre Côté, Yonatan Bisk, Adam Trischler, and Matthew Hausknecht.
    </span>
    <span class="ltx_bibblock">
     Alfworld: Aligning text and embodied environments for interactive learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">
      arXiv preprint arXiv:2010.03768
     </em>
     , 2020b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Significant-Gravitas [2023]
    </span>
    <span class="ltx_bibblock">
     Significant-Gravitas.
    </span>
    <span class="ltx_bibblock">
     Autogpt.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Significant-Gravitas/AutoGPT" target="_blank" title="">
      https://github.com/Significant-Gravitas/AutoGPT
     </a>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     GitHub repository.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Stiennon et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Nisan Stiennon, Long Ouyang, Jeffrey Wu, Daniel Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and Paul F Christiano.
    </span>
    <span class="ltx_bibblock">
     Learning to summarize with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 33:3008–3021, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Sumers et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Theodore Sumers, Shunyu Yao, Karthik Narasimhan, and Thomas L Griffiths.
    </span>
    <span class="ltx_bibblock">
     Cognitive architectures for language agents.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">
      arXiv preprint arXiv:2309.02427
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Talebirad &amp; Nadiri [2023]
    </span>
    <span class="ltx_bibblock">
     Yashar Talebirad and Amirhossein Nadiri.
    </span>
    <span class="ltx_bibblock">
     Multi-agent collaboration: Harnessing the power of intelligent llm agents.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">
      arXiv preprint arXiv:2306.03314
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Taori et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B Hashimoto.
    </span>
    <span class="ltx_bibblock">
     Alpaca: A strong, replicable instruction-following model.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">
      Stanford Center for Research on Foundation Models. https://crfm. stanford. edu/2023/03/13/alpaca. html
     </em>
     , 3(6):7, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Touvron et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.
    </span>
    <span class="ltx_bibblock">
     Llama: Open and efficient foundation language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">
      arXiv preprint arXiv:2302.13971
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Kuan Wang, Yuyu Zhang, Diyi Yang, Le Song, and Tao Qin.
    </span>
    <span class="ltx_bibblock">
     Gnn is a counter? revisiting gnn for question answering.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">
      arXiv preprint arXiv:2110.03192
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Xingyao Wang, Sha Li, and Heng Ji.
    </span>
    <span class="ltx_bibblock">
     Code4struct: Code generation for few-shot structured prediction from natural language.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">
      arXiv preprint arXiv:2210.12810
     </em>
     , 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Xuezhi Wang, Jason Wei, Dale Schuurmans, Quoc Le, Ed Chi, Sharan Narang, Aakanksha Chowdhery, and Denny Zhou.
    </span>
    <span class="ltx_bibblock">
     Self-consistency improves chain of thought reasoning in language models, 2022b.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2203.11171" target="_blank" title="">
      https://arxiv.org/abs/2203.11171
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib56">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022c]
    </span>
    <span class="ltx_bibblock">
     Xuezhi Wang, Jason Wei, Dale Schuurmans, Quoc Le, Ed Chi, and Denny Zhou.
    </span>
    <span class="ltx_bibblock">
     Rationale-augmented ensembles in language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">
      arXiv preprint arXiv:2207.00747
     </em>
     , 2022c.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib57">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022d]
    </span>
    <span class="ltx_bibblock">
     Yizhong Wang, Yeganeh Kordi, Swaroop Mishra, Alisa Liu, Noah A Smith, Daniel Khashabi, and Hannaneh Hajishirzi.
    </span>
    <span class="ltx_bibblock">
     Self-instruct: Aligning language model with self generated instructions.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">
      arXiv preprint arXiv:2212.10560
     </em>
     , 2022d.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib58">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022e]
    </span>
    <span class="ltx_bibblock">
     Yizhong Wang, Swaroop Mishra, Pegah Alipoormolabashi, Yeganeh Kordi, Amirreza Mirzaei, Anjana Arunkumar, Arjun Ashok, Arut Selvan Dhanasekaran, Atharva Naik, David Stap, et al.
    </span>
    <span class="ltx_bibblock">
     Super-naturalinstructions: Generalization via declarative instructions on 1600+ nlp tasks.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">
      arXiv preprint arXiv:2204.07705
     </em>
     , 2022e.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib59">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Zhenhailong Wang, Shaoguang Mao, Wenshan Wu, Tao Ge, Furu Wei, and Heng Ji.
    </span>
    <span class="ltx_bibblock">
     Unleashing cognitive synergy in large language models: A task-solving agent through multi-persona self-collaboration.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">
      arXiv preprint arXiv:2307.05300
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib60">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wei et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Jason Wei, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, Maarten Bosma, Denny Zhou, Donald Metzler, Ed H. Chi, Tatsunori Hashimoto, Oriol Vinyals, Percy Liang, Jeff Dean, and William Fedus.
    </span>
    <span class="ltx_bibblock">
     Emergent abilities of large language models, 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib61">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wei et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Ed Chi, Quoc Le, and Denny Zhou.
    </span>
    <span class="ltx_bibblock">
     Chain of thought prompting elicits reasoning in large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">
      arXiv preprint arXiv:2201.11903
     </em>
     , 2022b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib62">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Weng [2023]
    </span>
    <span class="ltx_bibblock">
     Lilian Weng.
    </span>
    <span class="ltx_bibblock">
     Llm-powered autonomous agents.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">
      lilianweng.github.io
     </em>
     , Jun 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://lilianweng.github.io/posts/2023-06-23-agent/" target="_blank" title="">
      https://lilianweng.github.io/posts/2023-06-23-agent/
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib63">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Williams [1992]
    </span>
    <span class="ltx_bibblock">
     Ronald J Williams.
    </span>
    <span class="ltx_bibblock">
     Simple statistical gradient-following algorithms for connectionist reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">
      Machine learning
     </em>
     , 8:229–256, 1992.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib64">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yang et al. [2018]
    </span>
    <span class="ltx_bibblock">
     Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William W. Cohen, Ruslan Salakhutdinov, and Christopher D. Manning.
    </span>
    <span class="ltx_bibblock">
     HotpotQA: A dataset for diverse, explainable multi-hop question answering.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">
      Conference on Empirical Methods in Natural Language Processing (EMNLP)
     </em>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib65">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yao et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik R Narasimhan, and Yuan Cao.
    </span>
    <span class="ltx_bibblock">
     React: Synergizing reasoning and acting in language models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">
      The Eleventh International Conference on Learning Representations
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=WE_vluYUL-X" target="_blank" title="">
      https://openreview.net/forum?id=WE_vluYUL-X
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib66">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     yoheinakajima [2023]
    </span>
    <span class="ltx_bibblock">
     yoheinakajima.
    </span>
    <span class="ltx_bibblock">
     Babyagi.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/yoheinakajima/babyagi" target="_blank" title="">
      https://github.com/yoheinakajima/babyagi
     </a>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     GitHub repository.
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <section class="ltx_appendix ltx_indent_first" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Appendix
  </h2>
  <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_1">
     <div class="ltx_listing ltx_figure_panel ltx_lst_language_python ltx_lstlisting ltx_listing" id="alg1.2" style="background-color:#FFFFFF;">
      <div class="ltx_listing_data">
       <a download="" href="data:text/plain;base64,IyBhZ2VudDogTExhTUEgYWdlbnQKIyBpbnB1dDogIFRhc2sgZGVzY3JpcHRpb24KIyBvdXRwdXQ6IFMgID0gKFQsIE0sIFIpCgojIGluaXRpYWxpemF0aW9uClQsIE0sIFIgPSBbaW5wdXRdLCBbMF0sIFswXQoKaSA9IDAKd2hpbGUgaSA8IG1heF9zdGVwczoKICAgIFQgKz0gWyJ0aGluazoiXQogICAgdGhvdWdodCA9IGFnZW50LmFwaShUKQogICAgVC5hcHBlbmQodGhvdWdodCkKICAgIE0uYXBwZW5kKDEpICMgYWdlbnQgbWVzc2FnZSBtYXNrCiAgICBSLmFwcGVuZCgwKQoKCiAgICBUICs9IFsiYWN0OiJdCiAgICBhY3Rpb24gPSBhZ2VudC5hcGkoVCkKICAgIFQuYXBwZW5kKGFjdGlvbikKICAgIE0uYXBwZW5kKDEpICMgYWdlbnQgbWVzc2FnZSBtYXNrCiAgICBSLmFwcGVuZCgwKQoKICAgIHJlc3BvbnNlID0gZW52LmV4Y3V0ZShhY3Rpb24pCiAgICByZXdhcmQgPSBwYXJzZShyZXNwb25zZSkKICAgIFQuYXBwZW5kKHJlc3BvbnNlKQogICAgTS5hcHBlbmQoMCkgIyBzeXN0ZW0gbWVzc2FnZSBtYXNrCiAgICBSLmFwcGVuZChyZXdhcmQpCgogICAgaSArPSAxCiAgICBpZiByZXdhcmQgIT0gMDoKICAgICAgICBicmVhawpTICA9IChULCBNLCBSKQpyZXR1cm4gUw==">
        ⬇
       </a>
      </div>
      <div class="ltx_listingline" id="lstnumberx1">
       <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx1.1" style="color:#408080;">
        #
        <span class="ltx_text ltx_lst_space" id="lstnumberx1.1.1">
        </span>
        agent:
        <span class="ltx_text ltx_lst_space" id="lstnumberx1.1.2">
        </span>
        LLaMA
        <span class="ltx_text ltx_lst_space" id="lstnumberx1.1.3">
        </span>
        agent
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx2">
       <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx2.1" style="color:#408080;">
        #
        <span class="ltx_text ltx_lst_space" id="lstnumberx2.1.1">
        </span>
        input:
        <span class="ltx_text ltx_lst_space" id="lstnumberx2.1.2">
        </span>
        Task
        <span class="ltx_text ltx_lst_space" id="lstnumberx2.1.3">
        </span>
        description
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx3">
       <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx3.1" style="color:#408080;">
        #
        <span class="ltx_text ltx_lst_space" id="lstnumberx3.1.1">
        </span>
        output:
        <span class="ltx_text ltx_lst_space" id="lstnumberx3.1.2">
        </span>
        S
        <span class="ltx_text ltx_lst_space" id="lstnumberx3.1.3">
        </span>
        =
        <span class="ltx_text ltx_lst_space" id="lstnumberx3.1.4">
        </span>
        (T,
        <span class="ltx_text ltx_lst_space" id="lstnumberx3.1.5">
        </span>
        M,
        <span class="ltx_text ltx_lst_space" id="lstnumberx3.1.6">
        </span>
        R)
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx4">
      </div>
      <div class="ltx_listingline" id="lstnumberx5">
       <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx5.1" style="color:#408080;">
        #
        <span class="ltx_text ltx_lst_space" id="lstnumberx5.1.1">
        </span>
        initialization
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx6">
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.1">
        T
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.2">
        ,
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.3">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.4">
        M
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.5">
        ,
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.6">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.7">
        R
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.8">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.9">
        =
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.10">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.11">
        [
       </span>
       <span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx6.12">
        input
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.13">
        ],
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.14">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.15">
        [0],
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.16">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.17">
        [0]
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx7">
      </div>
      <div class="ltx_listingline" id="lstnumberx8">
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.1">
        i
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.2">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx8.3">
        =
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.4">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx8.5">
        0
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx9">
       <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx9.1">
        while
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.2">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.3">
        i
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.4">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx9.5">
        &lt;
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.6">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.7">
        max_steps
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx9.8">
        :
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx10">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.2">
        T
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.3">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx10.4">
        +=
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.5">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx10.6">
        [
       </span>
       <span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx10.7">
        "think:"
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx10.8">
        ]
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx11">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.2">
        thought
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.3">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx11.4">
        =
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.5">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.6">
        agent
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx11.7">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.8">
        api
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx11.9">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.10">
        T
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx11.11">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx12">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.2">
        T
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx12.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx12.5">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.6">
        thought
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx12.7">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx13">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.2">
        M
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx13.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx13.5">
        (1)
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.6">
       </span>
       <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx13.7" style="color:#408080;">
        #
        <span class="ltx_text ltx_lst_space" id="lstnumberx13.7.1">
        </span>
        agent
        <span class="ltx_text ltx_lst_space" id="lstnumberx13.7.2">
        </span>
        message
        <span class="ltx_text ltx_lst_space" id="lstnumberx13.7.3">
        </span>
        mask
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx14">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.2">
        R
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx14.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx14.5">
        (0)
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx15">
      </div>
      <div class="ltx_listingline" id="lstnumberx16">
      </div>
      <div class="ltx_listingline" id="lstnumberx17">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.2">
        T
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.3">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx17.4">
        +=
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.5">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx17.6">
        [
       </span>
       <span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx17.7">
        "act:"
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx17.8">
        ]
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx18">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.2">
        action
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.3">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx18.4">
        =
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.5">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.6">
        agent
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx18.7">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.8">
        api
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx18.9">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.10">
        T
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx18.11">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx19">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.2">
        T
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx19.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx19.5">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.6">
        action
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx19.7">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx20">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.2">
        M
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx20.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx20.5">
        (1)
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.6">
       </span>
       <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx20.7" style="color:#408080;">
        #
        <span class="ltx_text ltx_lst_space" id="lstnumberx20.7.1">
        </span>
        agent
        <span class="ltx_text ltx_lst_space" id="lstnumberx20.7.2">
        </span>
        message
        <span class="ltx_text ltx_lst_space" id="lstnumberx20.7.3">
        </span>
        mask
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx21">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.2">
        R
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx21.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx21.5">
        (0)
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx22">
      </div>
      <div class="ltx_listingline" id="lstnumberx23">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.2">
        response
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.3">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx23.4">
        =
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.5">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.6">
        env
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx23.7">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.8">
        excute
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx23.9">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.10">
        action
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx23.11">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx24">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.2">
        reward
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.3">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx24.4">
        =
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.5">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.6">
        parse
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx24.7">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.8">
        response
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx24.9">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx25">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.2">
        T
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx25.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx25.5">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.6">
        response
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx25.7">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx26">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.2">
        M
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx26.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx26.5">
        (0)
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.6">
       </span>
       <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx26.7" style="color:#408080;">
        #
        <span class="ltx_text ltx_lst_space" id="lstnumberx26.7.1">
        </span>
        system
        <span class="ltx_text ltx_lst_space" id="lstnumberx26.7.2">
        </span>
        message
        <span class="ltx_text ltx_lst_space" id="lstnumberx26.7.3">
        </span>
        mask
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx27">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.2">
        R
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx27.3">
        .
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.4">
        append
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx27.5">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.6">
        reward
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx27.7">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx28">
      </div>
      <div class="ltx_listingline" id="lstnumberx29">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.1">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.2">
        i
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.3">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx29.4">
        +=
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.5">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx29.6">
        1
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx30">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.1">
       </span>
       <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx30.2">
        if
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.3">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.4">
        reward
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.5">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx30.6">
        !=
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.7">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx30.8">
        0:
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx31">
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.1">
       </span>
       <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx31.2">
        break
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx32">
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.1">
        S
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.2">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx32.3">
        =
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.4">
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx32.5">
        (
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.6">
        T
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx32.7">
        ,
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.8">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.9">
        M
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx32.10">
        ,
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.11">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.12">
        R
       </span>
       <span class="ltx_text ltx_font_typewriter" id="lstnumberx32.13">
        )
       </span>
      </div>
      <div class="ltx_listingline" id="lstnumberx33">
       <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx33.1">
        return
       </span>
       <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.2">
       </span>
       <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.3">
        S
       </span>
      </div>
     </div>
    </div>
   </div>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_float">
     <span class="ltx_text ltx_font_bold" id="alg1.3.1.1">
      Algorithm 1
     </span>
    </span>
    The Python-style algorithm to demonstrate Monologue pattern
   </figcaption>
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_1">
     <p class="ltx_p ltx_figure_panel" id="alg1.4">
      <span class="ltx_rule" style="width:100%;height:1px;background:black;display:inline-block;">
      </span>
     </p>
    </div>
   </div>
  </figure>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.1
    </span>
    Communication Patterns
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS1.p1">
    <p class="ltx_p" id="A1.SS1.p1.1">
     To collect the trajectories and the reward signal data from different types of tasks, we design the communication patterns for these tasks and unified the data format as described in Figure
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3.1 Exploration Phase ‣ 3 Learning Through Communication ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     . Here we use three python-sytle algorithms (Algorithm
     <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     Algorithm
     <a class="ltx_ref" href="#alg2" title="Algorithm 2 ‣ A.1 Communication Patterns ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     Algorithm
     <a class="ltx_ref" href="#alg3" title="Algorithm 3 ‣ A.1 Communication Patterns ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ) to demonstrate how three types of communication patterns help the agent collect exploration data.
    </p>
   </div>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_1">
      <div class="ltx_listing ltx_figure_panel ltx_lst_language_python ltx_lstlisting ltx_listing" id="alg2.2" style="background-color:#FFFFFF;">
       <div class="ltx_listing_data">
        <a download="" href="data:text/plain;base64,IyBhZ2VudDE6IExMYU1BIGFnZW50CiMgYWdlbnQyOiBHUFQtNCBhZ2VudAojIGlucHV0OiAgVGFzayBkZXNjcmlwdGlvbgojIG91dHB1dDogUyAgPSAoVCwgTSwgUikKCiMgaW5pdGlhbGl6YXRpb24KVCwgTSwgUiA9IFtpbnB1dF0sIFswXSwgWzBdCgppID0gMAp3aGlsZSBpIDwgbWF4X3N0ZXBzOgogICAgVCArPSBbInRoaW5rOiJdCiAgICB0aG91Z2h0ID0gYWdlbnQyLmFwaShUKQogICAgVC5hcHBlbmQodGhvdWdodCkKICAgIE0uYXBwZW5kKDIpICMgdGVhY2hlciBhZ2VudCBtZXNzYWdlIG1hc2sKICAgIFIuYXBwZW5kKDApCgoKICAgIFQgKz0gWyJhY3Q6Il0KICAgIGFjdGlvbiA9IGFnZW50MS5hcGkoVCkKICAgIFQuYXBwZW5kKGFjdGlvbikKICAgIE0uYXBwZW5kKDEpICMgc3R1ZGVudCBhZ2VudCBtZXNzYWdlIG1hc2sKICAgIFIuYXBwZW5kKDApCgogICAgcmVzcG9uc2UgPSBlbnYuZXhjdXRlKGFjdGlvbikKICAgIHJld2FyZCA9IHBhcnNlKHJlc3BvbnNlKQogICAgVC5hcHBlbmQocmVzcG9uc2UpCiAgICBNLmFwcGVuZCgwKSAjIHN5c3RlbSBtZXNzYWdlIG1hc2sKICAgIFIuYXBwZW5kKHJld2FyZCkKCiAgICBpICs9IDEKICAgIGlmIHJld2FyZCAhPSAwOgogICAgICAgIGJyZWFrClMgID0gKFQsIE0sIFIpCnJldHVybiBT">
         ⬇
        </a>
       </div>
       <div class="ltx_listingline" id="lstnumberx34">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx34.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx34.1.1">
         </span>
         agent1:
         <span class="ltx_text ltx_lst_space" id="lstnumberx34.1.2">
         </span>
         LLaMA
         <span class="ltx_text ltx_lst_space" id="lstnumberx34.1.3">
         </span>
         agent
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx35">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx35.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx35.1.1">
         </span>
         agent2:
         <span class="ltx_text ltx_lst_space" id="lstnumberx35.1.2">
         </span>
         GPT-4
         <span class="ltx_text ltx_lst_space" id="lstnumberx35.1.3">
         </span>
         agent
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx36">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx36.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx36.1.1">
         </span>
         input:
         <span class="ltx_text ltx_lst_space" id="lstnumberx36.1.2">
         </span>
         Task
         <span class="ltx_text ltx_lst_space" id="lstnumberx36.1.3">
         </span>
         description
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx37">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx37.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx37.1.1">
         </span>
         output:
         <span class="ltx_text ltx_lst_space" id="lstnumberx37.1.2">
         </span>
         S
         <span class="ltx_text ltx_lst_space" id="lstnumberx37.1.3">
         </span>
         =
         <span class="ltx_text ltx_lst_space" id="lstnumberx37.1.4">
         </span>
         (T,
         <span class="ltx_text ltx_lst_space" id="lstnumberx37.1.5">
         </span>
         M,
         <span class="ltx_text ltx_lst_space" id="lstnumberx37.1.6">
         </span>
         R)
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx38">
       </div>
       <div class="ltx_listingline" id="lstnumberx39">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx39.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx39.1.1">
         </span>
         initialization
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx40">
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.1">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx40.2">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.3">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.4">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx40.5">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.6">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.7">
         R
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.8">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx40.9">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.10">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx40.11">
         [
        </span>
        <span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx40.12">
         input
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx40.13">
         ],
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.14">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx40.15">
         [0],
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.16">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx40.17">
         [0]
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx41">
       </div>
       <div class="ltx_listingline" id="lstnumberx42">
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.1">
         i
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.2">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx42.3">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.4">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx42.5">
         0
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx43">
        <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx43.1">
         while
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.2">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.3">
         i
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.4">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx43.5">
         &lt;
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.6">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.7">
         max_steps
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx43.8">
         :
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx44">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.2">
         T
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx44.4">
         +=
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.5">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx44.6">
         [
        </span>
        <span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx44.7">
         "think:"
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx44.8">
         ]
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx45">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.2">
         thought
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx45.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.6">
         agent2
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx45.7">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.8">
         api
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx45.9">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.10">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx45.11">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx46">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.2">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx46.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx46.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx46.6">
         thought
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx46.7">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx47">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.2">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx47.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx47.5">
         (2)
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.6">
        </span>
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx47.7" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx47.7.1">
         </span>
         teacher
         <span class="ltx_text ltx_lst_space" id="lstnumberx47.7.2">
         </span>
         agent
         <span class="ltx_text ltx_lst_space" id="lstnumberx47.7.3">
         </span>
         message
         <span class="ltx_text ltx_lst_space" id="lstnumberx47.7.4">
         </span>
         mask
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx48">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx48.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.2">
         R
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx48.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx48.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx48.5">
         (0)
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx49">
       </div>
       <div class="ltx_listingline" id="lstnumberx50">
       </div>
       <div class="ltx_listingline" id="lstnumberx51">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.2">
         T
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx51.4">
         +=
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.5">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx51.6">
         [
        </span>
        <span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx51.7">
         "act:"
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx51.8">
         ]
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx52">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.2">
         action
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx52.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.6">
         agent1
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx52.7">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.8">
         api
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx52.9">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.10">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx52.11">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx53">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx53.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.2">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx53.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx53.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx53.6">
         action
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx53.7">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx54">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.2">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx54.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx54.5">
         (1)
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.6">
        </span>
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx54.7" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx54.7.1">
         </span>
         student
         <span class="ltx_text ltx_lst_space" id="lstnumberx54.7.2">
         </span>
         agent
         <span class="ltx_text ltx_lst_space" id="lstnumberx54.7.3">
         </span>
         message
         <span class="ltx_text ltx_lst_space" id="lstnumberx54.7.4">
         </span>
         mask
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx55">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.2">
         R
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx55.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx55.5">
         (0)
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx56">
       </div>
       <div class="ltx_listingline" id="lstnumberx57">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx57.2">
         response
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx57.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx57.6">
         env
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx57.7">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx57.8">
         excute
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx57.9">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx57.10">
         action
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx57.11">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx58">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx58.2">
         reward
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx58.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx58.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx58.6">
         parse
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx58.7">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx58.8">
         response
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx58.9">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx59">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx59.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx59.2">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx59.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx59.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx59.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx59.6">
         response
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx59.7">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx60">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.2">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx60.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx60.5">
         (0)
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.6">
        </span>
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx60.7" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx60.7.1">
         </span>
         system
         <span class="ltx_text ltx_lst_space" id="lstnumberx60.7.2">
         </span>
         message
         <span class="ltx_text ltx_lst_space" id="lstnumberx60.7.3">
         </span>
         mask
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx61">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx61.2">
         R
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx61.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx61.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx61.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx61.6">
         reward
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx61.7">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx62">
       </div>
       <div class="ltx_listingline" id="lstnumberx63">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx63.2">
         i
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx63.4">
         +=
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx63.5">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx63.6">
         1
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx64">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.1">
        </span>
        <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx64.2">
         if
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.3">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.4">
         reward
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.5">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx64.6">
         !=
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.7">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx64.8">
         0:
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx65">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.1">
        </span>
        <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx65.2">
         break
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx66">
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.1">
         S
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.2">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx66.3">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.4">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx66.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.6">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx66.7">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.8">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.9">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx66.10">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.11">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.12">
         R
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx66.13">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx67">
        <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx67.1">
         return
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.2">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx67.3">
         S
        </span>
       </div>
      </div>
     </div>
    </div>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg2.3.1.1">
       Algorithm 2
      </span>
     </span>
     The Python-style algorithm to demonstrate Dialogue pattern
    </figcaption>
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_1">
      <p class="ltx_p ltx_figure_panel" id="alg2.4">
       <span class="ltx_rule" style="width:100%;height:1px;background:black;display:inline-block;">
       </span>
      </p>
     </div>
    </div>
   </figure>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg3">
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_1">
      <div class="ltx_listing ltx_figure_panel ltx_lst_language_python ltx_lstlisting ltx_listing" id="alg3.2" style="background-color:#FFFFFF;">
       <div class="ltx_listing_data">
        <a download="" href="data:text/plain;base64,IyBhZ2VudDE6IExMYU1BIGFnZW50CiMgYWdlbnQyOiBHUFQtNCBhZ2VudAojIGlucHV0OiAgUXVlc3Rpb24gZGVzY3JpcHRpb24KIyBvdXRwdXQ6IFMgID0gKFQsIE0sIFIpCgojIGluaXRpYWxpemF0aW9uClQsIE0sIFIgPSBbaW5wdXRdLCBbMF0sIFswXQoKaSA9IDAKd2hpbGUgaSA8IG1heF9zdGVwczoKICAgIFQgKz0gWyJhbnN3ZXIgdGhlIHF1ZXN0aW9uIHN0ZXAgYnkgc3RlcDoiXQogICAgYW5zd2VyMSA9IGFnZW50MS5hcGkoVCkKICAgIHF1ZXJ5ID0gVCArIGFuc3dlcjEgKyBbInRoZSBhbnN3ZXIgaXMgY29ycmVjdCwgeWVzIG9yIG5vPyBhbHNvIGdpdmVzIGEgYmV0dGVyIGFuc3dlciJdCiAgICByZXNwb25zZSA9IGFnZW50Mi5hcGkocXVlcnkpCiAgICByZXdhcmQsIGFuc3dlcjIgPSBwYXJzZShyZXNwb25zZSkKICAgIFQuYXBwZW5kKGFuc3dlcjEpCiAgICBULmFwcGVuZChhbnN3ZXIyKQogICAgTS5hcHBlbmQoMSkgIyBzdHVkZW50IGFnZW50IG1lc3NhZ2UgbWFzawogICAgTS5hcHBlbmQoMikgIyB0ZWFjaGVyIGFnZW50IG1lc3NhZ2UgbWFzawogICAgUi5hcHBlbmQocmV3YXJkKQogICAgUi5hcHBlbmQoKzEpICMgYXNzdW1lIHRlYWNoZXIgaXMgY29ycmVjdAoKCiAgICBxdWVyeSA9IHF1ZXJ5ICsgcmVzcG9uc2UgKyBbInBsZWFzZSBnZW5lcmF0ZSBhIHNpbWlsYXIgcWEgcGFpciB0byB0ZWFjaCB0aGUgc3R1ZGVudDoiXQogICAgcmVzcG9uc2UgPSBhZ2VudDIuYXBpKHF1ZXJ5KQogICAgbmV3X3F1ZXN0aW9uLCB0ZWFjaGVyX2Fuc3dlciA9IHBhcnNlKHJlc3BvbnNlKQogICAgbmV3X3F1ZXN0aW9uICs9ICJhbnN3ZXIgdGhlIHF1ZXN0aW9uIHN0ZXAgYnkgc3RlcDoiCiAgICBzdHVkZW50X2Fuc3dlciA9IGFnZW50MS5hcGkobmV3X3F1ZXN0aW9uKQogICAgcmV3YXJkID0gcGFyc2Uoc3R1ZGVudF9hbnN3ZXIsIHRlYWNoZXJfYW5zd2VyKQogICAgVC5hcHBlbmQobmV3X3F1ZXN0aW9uICsgc3R1ZGVudF9hbnN3ZXIpCiAgICBNLmFwcGVuZCgxKSAjIHN0dWRlbnQgYWdlbnQgbWVzc2FnZSBtYXNrCiAgICBSLmFwcGVuZChyZXdhcmQpCgogICAgaSArPSAxCgpTICA9IChULCBNLCBSKQpyZXR1cm4gUw==">
         ⬇
        </a>
       </div>
       <div class="ltx_listingline" id="lstnumberx68">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx68.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx68.1.1">
         </span>
         agent1:
         <span class="ltx_text ltx_lst_space" id="lstnumberx68.1.2">
         </span>
         LLaMA
         <span class="ltx_text ltx_lst_space" id="lstnumberx68.1.3">
         </span>
         agent
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx69">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx69.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx69.1.1">
         </span>
         agent2:
         <span class="ltx_text ltx_lst_space" id="lstnumberx69.1.2">
         </span>
         GPT-4
         <span class="ltx_text ltx_lst_space" id="lstnumberx69.1.3">
         </span>
         agent
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx70">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx70.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx70.1.1">
         </span>
         input:
         <span class="ltx_text ltx_lst_space" id="lstnumberx70.1.2">
         </span>
         Question
         <span class="ltx_text ltx_lst_space" id="lstnumberx70.1.3">
         </span>
         description
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx71">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx71.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx71.1.1">
         </span>
         output:
         <span class="ltx_text ltx_lst_space" id="lstnumberx71.1.2">
         </span>
         S
         <span class="ltx_text ltx_lst_space" id="lstnumberx71.1.3">
         </span>
         =
         <span class="ltx_text ltx_lst_space" id="lstnumberx71.1.4">
         </span>
         (T,
         <span class="ltx_text ltx_lst_space" id="lstnumberx71.1.5">
         </span>
         M,
         <span class="ltx_text ltx_lst_space" id="lstnumberx71.1.6">
         </span>
         R)
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx72">
       </div>
       <div class="ltx_listingline" id="lstnumberx73">
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx73.1" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx73.1.1">
         </span>
         initialization
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx74">
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx74.1">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx74.2">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.3">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx74.4">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx74.5">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.6">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx74.7">
         R
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.8">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx74.9">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.10">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx74.11">
         [
        </span>
        <span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx74.12">
         input
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx74.13">
         ],
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.14">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx74.15">
         [0],
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx74.16">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx74.17">
         [0]
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx75">
       </div>
       <div class="ltx_listingline" id="lstnumberx76">
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx76.1">
         i
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.2">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx76.3">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx76.4">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx76.5">
         0
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx77">
        <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx77.1">
         while
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.2">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx77.3">
         i
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.4">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx77.5">
         &lt;
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.6">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx77.7">
         max_steps
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx77.8">
         :
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx78">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx78.2">
         T
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx78.4">
         +=
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx78.5">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx78.6">
         [
        </span>
        <span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx78.7">
         "answer
         <span class="ltx_text ltx_lst_space" id="lstnumberx78.7.1">
          ␣
         </span>
         the
         <span class="ltx_text ltx_lst_space" id="lstnumberx78.7.2">
          ␣
         </span>
         question
         <span class="ltx_text ltx_lst_space" id="lstnumberx78.7.3">
          ␣
         </span>
         step
         <span class="ltx_text ltx_lst_space" id="lstnumberx78.7.4">
          ␣
         </span>
         by
         <span class="ltx_text ltx_lst_space" id="lstnumberx78.7.5">
          ␣
         </span>
         step:"
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx78.8">
         ]
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx79">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.2">
         answer1
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx79.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.6">
         agent1
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx79.7">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.8">
         api
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx79.9">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.10">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx79.11">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx80">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.2">
         query
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx80.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.6">
         T
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.7">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx80.8">
         +
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.9">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.10">
         answer1
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.11">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx80.12">
         +
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.13">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx80.14">
         [
        </span>
        <span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx80.15">
         "the
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.1">
          ␣
         </span>
         answer
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.2">
          ␣
         </span>
         is
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.3">
          ␣
         </span>
         correct,
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.4">
          ␣
         </span>
         yes
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.5">
          ␣
         </span>
         or
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.6">
          ␣
         </span>
         no?
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.7">
          ␣
         </span>
         also
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.8">
          ␣
         </span>
         gives
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.9">
          ␣
         </span>
         a
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.10">
          ␣
         </span>
         better
         <span class="ltx_text ltx_lst_space" id="lstnumberx80.15.11">
          ␣
         </span>
         answer"
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx80.16">
         ]
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx81">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx81.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx81.2">
         response
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx81.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx81.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx81.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx81.6">
         agent2
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx81.7">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx81.8">
         api
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx81.9">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx81.10">
         query
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx81.11">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx82">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.2">
         reward
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx82.3">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.4">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.5">
         answer2
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.6">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx82.7">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.8">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.9">
         parse
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx82.10">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.11">
         response
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx82.12">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx83">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.2">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx83.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx83.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.6">
         answer1
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx83.7">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx84">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx84.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx84.2">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx84.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx84.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx84.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx84.6">
         answer2
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx84.7">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx85">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx85.2">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx85.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx85.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx85.5">
         (1)
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx85.6">
        </span>
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx85.7" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx85.7.1">
         </span>
         student
         <span class="ltx_text ltx_lst_space" id="lstnumberx85.7.2">
         </span>
         agent
         <span class="ltx_text ltx_lst_space" id="lstnumberx85.7.3">
         </span>
         message
         <span class="ltx_text ltx_lst_space" id="lstnumberx85.7.4">
         </span>
         mask
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx86">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.2">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx86.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx86.5">
         (2)
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.6">
        </span>
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx86.7" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx86.7.1">
         </span>
         teacher
         <span class="ltx_text ltx_lst_space" id="lstnumberx86.7.2">
         </span>
         agent
         <span class="ltx_text ltx_lst_space" id="lstnumberx86.7.3">
         </span>
         message
         <span class="ltx_text ltx_lst_space" id="lstnumberx86.7.4">
         </span>
         mask
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx87">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx87.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx87.2">
         R
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx87.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx87.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx87.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx87.6">
         reward
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx87.7">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx88">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.2">
         R
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx88.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx88.5">
         (+1)
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.6">
        </span>
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx88.7" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx88.7.1">
         </span>
         assume
         <span class="ltx_text ltx_lst_space" id="lstnumberx88.7.2">
         </span>
         teacher
         <span class="ltx_text ltx_lst_space" id="lstnumberx88.7.3">
         </span>
         is
         <span class="ltx_text ltx_lst_space" id="lstnumberx88.7.4">
         </span>
         correct
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx89">
       </div>
       <div class="ltx_listingline" id="lstnumberx90">
       </div>
       <div class="ltx_listingline" id="lstnumberx91">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx91.2">
         query
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx91.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx91.6">
         query
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.7">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx91.8">
         +
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.9">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx91.10">
         response
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.11">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx91.12">
         +
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx91.13">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx91.14">
         [
        </span>
        <span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx91.15">
         "please
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.1">
          ␣
         </span>
         generate
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.2">
          ␣
         </span>
         a
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.3">
          ␣
         </span>
         similar
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.4">
          ␣
         </span>
         qa
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.5">
          ␣
         </span>
         pair
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.6">
          ␣
         </span>
         to
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.7">
          ␣
         </span>
         teach
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.8">
          ␣
         </span>
         the
         <span class="ltx_text ltx_lst_space" id="lstnumberx91.15.9">
          ␣
         </span>
         student:"
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx91.16">
         ]
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx92">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.2">
         response
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx92.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.6">
         agent2
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx92.7">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.8">
         api
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx92.9">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.10">
         query
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx92.11">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx93">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.2">
         new_question
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx93.3">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.4">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.5">
         teacher_answer
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.6">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx93.7">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx93.8">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.9">
         parse
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx93.10">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx93.11">
         response
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx93.12">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx94">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.2">
         new_question
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx94.4">
         +=
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.5">
        </span>
        <span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx94.6">
         "answer
         <span class="ltx_text ltx_lst_space" id="lstnumberx94.6.1">
          ␣
         </span>
         the
         <span class="ltx_text ltx_lst_space" id="lstnumberx94.6.2">
          ␣
         </span>
         question
         <span class="ltx_text ltx_lst_space" id="lstnumberx94.6.3">
          ␣
         </span>
         step
         <span class="ltx_text ltx_lst_space" id="lstnumberx94.6.4">
          ␣
         </span>
         by
         <span class="ltx_text ltx_lst_space" id="lstnumberx94.6.5">
          ␣
         </span>
         step:"
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx95">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.2">
         student_answer
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx95.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx95.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.6">
         agent1
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx95.7">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.8">
         api
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx95.9">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx95.10">
         new_question
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx95.11">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx96">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.2">
         reward
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx96.4">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.5">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.6">
         parse
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx96.7">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.8">
         student_answer
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx96.9">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.10">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.11">
         teacher_answer
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx96.12">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx97">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.2">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx97.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx97.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.6">
         new_question
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.7">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx97.8">
         +
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx97.9">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx97.10">
         student_answer
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx97.11">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx98">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.2">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx98.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx98.5">
         (1)
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.6">
        </span>
        <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx98.7" style="color:#408080;">
         #
         <span class="ltx_text ltx_lst_space" id="lstnumberx98.7.1">
         </span>
         student
         <span class="ltx_text ltx_lst_space" id="lstnumberx98.7.2">
         </span>
         agent
         <span class="ltx_text ltx_lst_space" id="lstnumberx98.7.3">
         </span>
         message
         <span class="ltx_text ltx_lst_space" id="lstnumberx98.7.4">
         </span>
         mask
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx99">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.2">
         R
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx99.3">
         .
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.4">
         append
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx99.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.6">
         reward
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx99.7">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx100">
       </div>
       <div class="ltx_listingline" id="lstnumberx101">
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.1">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.2">
         i
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.3">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx101.4">
         +=
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.5">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx101.6">
         1
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx102">
       </div>
       <div class="ltx_listingline" id="lstnumberx103">
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.1">
         S
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.2">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx103.3">
         =
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.4">
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx103.5">
         (
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.6">
         T
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx103.7">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.8">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.9">
         M
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx103.10">
         ,
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.11">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.12">
         R
        </span>
        <span class="ltx_text ltx_font_typewriter" id="lstnumberx103.13">
         )
        </span>
       </div>
       <div class="ltx_listingline" id="lstnumberx104">
        <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx104.1">
         return
        </span>
        <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx104.2">
        </span>
        <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx104.3">
         S
        </span>
       </div>
      </div>
     </div>
    </div>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg3.3.1.1">
       Algorithm 3
      </span>
     </span>
     The Python-style algorithm to demonstrate Analogue pattern
    </figcaption>
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_1">
      <p class="ltx_p ltx_figure_panel" id="alg3.4">
       <span class="ltx_rule" style="width:100%;height:1px;background:black;display:inline-block;">
       </span>
      </p>
     </div>
    </div>
   </figure>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.2
    </span>
    Buffer Structure
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS2.p1">
    <p class="ltx_p" id="A1.SS2.p1.1">
     The communication data will be saved as replay buffers for the training phase, and the buffer data format is a serial of tokens sequences demonstrated in Figure
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3.1 Exploration Phase ‣ 3 Learning Through Communication ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     . We treat each token as the action unit in our reinforcement learning formula, and each exploration trail is processed into 5 data sequences
     <math alttext="[\textbf{S}_{\textbf{a}},\textbf{S}_{\textbf{m}},\textbf{S}_{\textbf{v}},\textbf{S}_{\textbf{l}},\textbf{S}_{\textbf{r}}]" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.5">
      <semantics id="A1.SS2.p1.1.m1.5a">
       <mrow id="A1.SS2.p1.1.m1.5.5.5" xref="A1.SS2.p1.1.m1.5.5.6.cmml">
        <mo id="A1.SS2.p1.1.m1.5.5.5.6" stretchy="false" xref="A1.SS2.p1.1.m1.5.5.6.cmml">
         [
        </mo>
        <msub id="A1.SS2.p1.1.m1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.cmml">
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.1.1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.1.1.2a.cmml">
          S
         </mtext>
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.1.1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.1.1.3a.cmml">
          a
         </mtext>
        </msub>
        <mo id="A1.SS2.p1.1.m1.5.5.5.7" xref="A1.SS2.p1.1.m1.5.5.6.cmml">
         ,
        </mo>
        <msub id="A1.SS2.p1.1.m1.2.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.2.cmml">
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.2.2.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.2.2a.cmml">
          S
         </mtext>
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.2.2.2.2.3" xref="A1.SS2.p1.1.m1.2.2.2.2.3a.cmml">
          m
         </mtext>
        </msub>
        <mo id="A1.SS2.p1.1.m1.5.5.5.8" xref="A1.SS2.p1.1.m1.5.5.6.cmml">
         ,
        </mo>
        <msub id="A1.SS2.p1.1.m1.3.3.3.3" xref="A1.SS2.p1.1.m1.3.3.3.3.cmml">
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.3.3.3.3.2" xref="A1.SS2.p1.1.m1.3.3.3.3.2a.cmml">
          S
         </mtext>
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.3.3.3.3.3" xref="A1.SS2.p1.1.m1.3.3.3.3.3a.cmml">
          v
         </mtext>
        </msub>
        <mo id="A1.SS2.p1.1.m1.5.5.5.9" xref="A1.SS2.p1.1.m1.5.5.6.cmml">
         ,
        </mo>
        <msub id="A1.SS2.p1.1.m1.4.4.4.4" xref="A1.SS2.p1.1.m1.4.4.4.4.cmml">
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.4.4.4.4.2" xref="A1.SS2.p1.1.m1.4.4.4.4.2a.cmml">
          S
         </mtext>
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.4.4.4.4.3" xref="A1.SS2.p1.1.m1.4.4.4.4.3a.cmml">
          l
         </mtext>
        </msub>
        <mo id="A1.SS2.p1.1.m1.5.5.5.10" xref="A1.SS2.p1.1.m1.5.5.6.cmml">
         ,
        </mo>
        <msub id="A1.SS2.p1.1.m1.5.5.5.5" xref="A1.SS2.p1.1.m1.5.5.5.5.cmml">
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.5.5.5.5.2" xref="A1.SS2.p1.1.m1.5.5.5.5.2a.cmml">
          S
         </mtext>
         <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.5.5.5.5.3" xref="A1.SS2.p1.1.m1.5.5.5.5.3a.cmml">
          r
         </mtext>
        </msub>
        <mo id="A1.SS2.p1.1.m1.5.5.5.11" stretchy="false" xref="A1.SS2.p1.1.m1.5.5.6.cmml">
         ]
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.5b">
        <list id="A1.SS2.p1.1.m1.5.5.6.cmml" xref="A1.SS2.p1.1.m1.5.5.5">
         <apply id="A1.SS2.p1.1.m1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1">
          <csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1">
           subscript
          </csymbol>
          <ci id="A1.SS2.p1.1.m1.1.1.1.1.2a.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.2">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.2">
            S
           </mtext>
          </ci>
          <ci id="A1.SS2.p1.1.m1.1.1.1.1.3a.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.3">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.1.1.1.1.3.cmml" mathsize="70%" xref="A1.SS2.p1.1.m1.1.1.1.1.3">
            a
           </mtext>
          </ci>
         </apply>
         <apply id="A1.SS2.p1.1.m1.2.2.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2">
          <csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.2.2.2.2.1.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2">
           subscript
          </csymbol>
          <ci id="A1.SS2.p1.1.m1.2.2.2.2.2a.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.2">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.2.2.2.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.2">
            S
           </mtext>
          </ci>
          <ci id="A1.SS2.p1.1.m1.2.2.2.2.3a.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.3">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.2.2.2.2.3.cmml" mathsize="70%" xref="A1.SS2.p1.1.m1.2.2.2.2.3">
            m
           </mtext>
          </ci>
         </apply>
         <apply id="A1.SS2.p1.1.m1.3.3.3.3.cmml" xref="A1.SS2.p1.1.m1.3.3.3.3">
          <csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.3.3.3.3.1.cmml" xref="A1.SS2.p1.1.m1.3.3.3.3">
           subscript
          </csymbol>
          <ci id="A1.SS2.p1.1.m1.3.3.3.3.2a.cmml" xref="A1.SS2.p1.1.m1.3.3.3.3.2">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.3.3.3.3.2.cmml" xref="A1.SS2.p1.1.m1.3.3.3.3.2">
            S
           </mtext>
          </ci>
          <ci id="A1.SS2.p1.1.m1.3.3.3.3.3a.cmml" xref="A1.SS2.p1.1.m1.3.3.3.3.3">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.3.3.3.3.3.cmml" mathsize="70%" xref="A1.SS2.p1.1.m1.3.3.3.3.3">
            v
           </mtext>
          </ci>
         </apply>
         <apply id="A1.SS2.p1.1.m1.4.4.4.4.cmml" xref="A1.SS2.p1.1.m1.4.4.4.4">
          <csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.4.4.4.4.1.cmml" xref="A1.SS2.p1.1.m1.4.4.4.4">
           subscript
          </csymbol>
          <ci id="A1.SS2.p1.1.m1.4.4.4.4.2a.cmml" xref="A1.SS2.p1.1.m1.4.4.4.4.2">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.4.4.4.4.2.cmml" xref="A1.SS2.p1.1.m1.4.4.4.4.2">
            S
           </mtext>
          </ci>
          <ci id="A1.SS2.p1.1.m1.4.4.4.4.3a.cmml" xref="A1.SS2.p1.1.m1.4.4.4.4.3">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.4.4.4.4.3.cmml" mathsize="70%" xref="A1.SS2.p1.1.m1.4.4.4.4.3">
            l
           </mtext>
          </ci>
         </apply>
         <apply id="A1.SS2.p1.1.m1.5.5.5.5.cmml" xref="A1.SS2.p1.1.m1.5.5.5.5">
          <csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.5.5.5.5.1.cmml" xref="A1.SS2.p1.1.m1.5.5.5.5">
           subscript
          </csymbol>
          <ci id="A1.SS2.p1.1.m1.5.5.5.5.2a.cmml" xref="A1.SS2.p1.1.m1.5.5.5.5.2">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.5.5.5.5.2.cmml" xref="A1.SS2.p1.1.m1.5.5.5.5.2">
            S
           </mtext>
          </ci>
          <ci id="A1.SS2.p1.1.m1.5.5.5.5.3a.cmml" xref="A1.SS2.p1.1.m1.5.5.5.5.3">
           <mtext class="ltx_mathvariant_bold" id="A1.SS2.p1.1.m1.5.5.5.5.3.cmml" mathsize="70%" xref="A1.SS2.p1.1.m1.5.5.5.5.3">
            r
           </mtext>
          </ci>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.5c">
        [\textbf{S}_{\textbf{a}},\textbf{S}_{\textbf{m}},\textbf{S}_{\textbf{v}},\textbf{S}_{\textbf{l}},\textbf{S}_{\textbf{r}}]
       </annotation>
      </semantics>
     </math>
     :
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS2.p2">
    <ul class="ltx_itemize" id="A1.I1">
     <li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="A1.I1.i1.p1">
       <p class="ltx_p" id="A1.I1.i1.p1.1">
        <math alttext="\textbf{S}_{\textbf{a}}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.1.m1.1">
         <semantics id="A1.I1.i1.p1.1.m1.1a">
          <msub id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">
           <mtext class="ltx_mathvariant_bold" id="A1.I1.i1.p1.1.m1.1.1.2" xref="A1.I1.i1.p1.1.m1.1.1.2a.cmml">
            S
           </mtext>
           <mtext class="ltx_mathvariant_bold" id="A1.I1.i1.p1.1.m1.1.1.3" xref="A1.I1.i1.p1.1.m1.1.1.3a.cmml">
            a
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b">
           <apply id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.I1.i1.p1.1.m1.1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.I1.i1.p1.1.m1.1.1.2a.cmml" xref="A1.I1.i1.p1.1.m1.1.1.2">
             <mtext class="ltx_mathvariant_bold" id="A1.I1.i1.p1.1.m1.1.1.2.cmml" xref="A1.I1.i1.p1.1.m1.1.1.2">
              S
             </mtext>
            </ci>
            <ci id="A1.I1.i1.p1.1.m1.1.1.3a.cmml" xref="A1.I1.i1.p1.1.m1.1.1.3">
             <mtext class="ltx_mathvariant_bold" id="A1.I1.i1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I1.i1.p1.1.m1.1.1.3">
              a
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">
           \textbf{S}_{\textbf{a}}
          </annotation>
         </semantics>
        </math>
        : A list of integers representing the generated token ids encoded by the tokenizer. All the valid text trajectories are recorded as a queue, including system texts like environment descriptions, feedback, and agent texts like parsed actions, thinking processes, and hints from other agents. While the invalid generated text of the agent will be skipped, such as nonsense string and action text can not be parsed. These tokens are treated equally as the input for the LLM, but they have different masks to apply different losses.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="A1.I1.i2.p1">
       <p class="ltx_p" id="A1.I1.i2.p1.1">
        <math alttext="\textbf{S}_{\textbf{m}}" class="ltx_Math" display="inline" id="A1.I1.i2.p1.1.m1.1">
         <semantics id="A1.I1.i2.p1.1.m1.1a">
          <msub id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml">
           <mtext class="ltx_mathvariant_bold" id="A1.I1.i2.p1.1.m1.1.1.2" xref="A1.I1.i2.p1.1.m1.1.1.2a.cmml">
            S
           </mtext>
           <mtext class="ltx_mathvariant_bold" id="A1.I1.i2.p1.1.m1.1.1.3" xref="A1.I1.i2.p1.1.m1.1.1.3a.cmml">
            m
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b">
           <apply id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.I1.i2.p1.1.m1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.I1.i2.p1.1.m1.1.1.2a.cmml" xref="A1.I1.i2.p1.1.m1.1.1.2">
             <mtext class="ltx_mathvariant_bold" id="A1.I1.i2.p1.1.m1.1.1.2.cmml" xref="A1.I1.i2.p1.1.m1.1.1.2">
              S
             </mtext>
            </ci>
            <ci id="A1.I1.i2.p1.1.m1.1.1.3a.cmml" xref="A1.I1.i2.p1.1.m1.1.1.3">
             <mtext class="ltx_mathvariant_bold" id="A1.I1.i2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I1.i2.p1.1.m1.1.1.3">
              m
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">
           \textbf{S}_{\textbf{m}}
          </annotation>
         </semantics>
        </math>
        : The system mask to mask different types of input tokens to control the training loss. We set 0 as the default mask for system texts like environment descriptions, system feedback, and system prompts, the actions encoded from these kinds of texts are not actions we want the agent to learn, so they will be masked out both policy loss and value loss in the PPO algorithm. We set 1 as the mask for agents-generated tokens like the keywords of decisions and the thinking process, which are the main supervising objects of our reinforcement learning pipeline, so they will be assigned full policy loss and value loss. We set 2 as the mask for hints or feedback from other agents, which are the actions we also want our own agent to learn but without instant state values since they are not generated by our agent. So the tokens with mask 2 will be mask out only the value loss and supervised by the policy loss.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="A1.I1.i3.p1">
       <p class="ltx_p" id="A1.I1.i3.p1.3">
        <math alttext="\textbf{S}_{\textbf{v}}" class="ltx_Math" display="inline" id="A1.I1.i3.p1.1.m1.1">
         <semantics id="A1.I1.i3.p1.1.m1.1a">
          <msub id="A1.I1.i3.p1.1.m1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.cmml">
           <mtext class="ltx_mathvariant_bold" id="A1.I1.i3.p1.1.m1.1.1.2" xref="A1.I1.i3.p1.1.m1.1.1.2a.cmml">
            S
           </mtext>
           <mtext class="ltx_mathvariant_bold" id="A1.I1.i3.p1.1.m1.1.1.3" xref="A1.I1.i3.p1.1.m1.1.1.3a.cmml">
            v
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.1b">
           <apply id="A1.I1.i3.p1.1.m1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.I1.i3.p1.1.m1.1.1.2a.cmml" xref="A1.I1.i3.p1.1.m1.1.1.2">
             <mtext class="ltx_mathvariant_bold" id="A1.I1.i3.p1.1.m1.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.1.1.2">
              S
             </mtext>
            </ci>
            <ci id="A1.I1.i3.p1.1.m1.1.1.3a.cmml" xref="A1.I1.i3.p1.1.m1.1.1.3">
             <mtext class="ltx_mathvariant_bold" id="A1.I1.i3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I1.i3.p1.1.m1.1.1.3">
              v
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.1c">
           \textbf{S}_{\textbf{v}}
          </annotation>
         </semantics>
        </math>
        : The state values corresponding to the actions obtained by the value head our the agent model. The value head is an addition layer inserted to the original pre-trained LLM architecture, we implement it by inserting a linear layer after the second-to-last LlamaDecoderLayer as the auxiliary output module and the output values are processed by a
        <math alttext="tanh()" class="ltx_Math" display="inline" id="A1.I1.i3.p1.2.m2.1">
         <semantics id="A1.I1.i3.p1.2.m2.1a">
          <mrow id="A1.I1.i3.p1.2.m2.1.1" xref="A1.I1.i3.p1.2.m2.1.1.cmml">
           <mi id="A1.I1.i3.p1.2.m2.1.1.2" xref="A1.I1.i3.p1.2.m2.1.1.2.cmml">
            t
           </mi>
           <mo id="A1.I1.i3.p1.2.m2.1.1.1" lspace="0em" rspace="0em" xref="A1.I1.i3.p1.2.m2.1.1.1.cmml">
            ​
           </mo>
           <mi id="A1.I1.i3.p1.2.m2.1.1.3" xref="A1.I1.i3.p1.2.m2.1.1.3.cmml">
            a
           </mi>
           <mo id="A1.I1.i3.p1.2.m2.1.1.1a" lspace="0em" rspace="0em" xref="A1.I1.i3.p1.2.m2.1.1.1.cmml">
            ​
           </mo>
           <mi id="A1.I1.i3.p1.2.m2.1.1.4" xref="A1.I1.i3.p1.2.m2.1.1.4.cmml">
            n
           </mi>
           <mo id="A1.I1.i3.p1.2.m2.1.1.1b" lspace="0em" rspace="0em" xref="A1.I1.i3.p1.2.m2.1.1.1.cmml">
            ​
           </mo>
           <mi id="A1.I1.i3.p1.2.m2.1.1.5" xref="A1.I1.i3.p1.2.m2.1.1.5.cmml">
            h
           </mi>
           <mo id="A1.I1.i3.p1.2.m2.1.1.1c" lspace="0em" rspace="0em" xref="A1.I1.i3.p1.2.m2.1.1.1.cmml">
            ​
           </mo>
           <mrow id="A1.I1.i3.p1.2.m2.1.1.6.2" xref="A1.I1.i3.p1.2.m2.1.1.cmml">
            <mo id="A1.I1.i3.p1.2.m2.1.1.6.2.1" stretchy="false" xref="A1.I1.i3.p1.2.m2.1.1.6.1.cmml">
             (
            </mo>
            <mo id="A1.I1.i3.p1.2.m2.1.1.6.2.2" stretchy="false" xref="A1.I1.i3.p1.2.m2.1.1.6.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.2.m2.1b">
           <apply id="A1.I1.i3.p1.2.m2.1.1.cmml" xref="A1.I1.i3.p1.2.m2.1.1">
            <times id="A1.I1.i3.p1.2.m2.1.1.1.cmml" xref="A1.I1.i3.p1.2.m2.1.1.1">
            </times>
            <ci id="A1.I1.i3.p1.2.m2.1.1.2.cmml" xref="A1.I1.i3.p1.2.m2.1.1.2">
             𝑡
            </ci>
            <ci id="A1.I1.i3.p1.2.m2.1.1.3.cmml" xref="A1.I1.i3.p1.2.m2.1.1.3">
             𝑎
            </ci>
            <ci id="A1.I1.i3.p1.2.m2.1.1.4.cmml" xref="A1.I1.i3.p1.2.m2.1.1.4">
             𝑛
            </ci>
            <ci id="A1.I1.i3.p1.2.m2.1.1.5.cmml" xref="A1.I1.i3.p1.2.m2.1.1.5">
             ℎ
            </ci>
            <list id="A1.I1.i3.p1.2.m2.1.1.6.1.cmml" xref="A1.I1.i3.p1.2.m2.1.1.6.2.1">
            </list>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I1.i3.p1.2.m2.1c">
           tanh()
          </annotation>
         </semantics>
        </math>
        function to keep it range inside
        <math alttext="(-1,1)" class="ltx_Math" display="inline" id="A1.I1.i3.p1.3.m3.2">
         <semantics id="A1.I1.i3.p1.3.m3.2a">
          <mrow id="A1.I1.i3.p1.3.m3.2.2.1" xref="A1.I1.i3.p1.3.m3.2.2.2.cmml">
           <mo id="A1.I1.i3.p1.3.m3.2.2.1.2" stretchy="false" xref="A1.I1.i3.p1.3.m3.2.2.2.cmml">
            (
           </mo>
           <mrow id="A1.I1.i3.p1.3.m3.2.2.1.1" xref="A1.I1.i3.p1.3.m3.2.2.1.1.cmml">
            <mo id="A1.I1.i3.p1.3.m3.2.2.1.1a" xref="A1.I1.i3.p1.3.m3.2.2.1.1.cmml">
             −
            </mo>
            <mn id="A1.I1.i3.p1.3.m3.2.2.1.1.2" xref="A1.I1.i3.p1.3.m3.2.2.1.1.2.cmml">
             1
            </mn>
           </mrow>
           <mo id="A1.I1.i3.p1.3.m3.2.2.1.3" xref="A1.I1.i3.p1.3.m3.2.2.2.cmml">
            ,
           </mo>
           <mn id="A1.I1.i3.p1.3.m3.1.1" xref="A1.I1.i3.p1.3.m3.1.1.cmml">
            1
           </mn>
           <mo id="A1.I1.i3.p1.3.m3.2.2.1.4" stretchy="false" xref="A1.I1.i3.p1.3.m3.2.2.2.cmml">
            )
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.3.m3.2b">
           <interval closure="open" id="A1.I1.i3.p1.3.m3.2.2.2.cmml" xref="A1.I1.i3.p1.3.m3.2.2.1">
            <apply id="A1.I1.i3.p1.3.m3.2.2.1.1.cmml" xref="A1.I1.i3.p1.3.m3.2.2.1.1">
             <minus id="A1.I1.i3.p1.3.m3.2.2.1.1.1.cmml" xref="A1.I1.i3.p1.3.m3.2.2.1.1">
             </minus>
             <cn id="A1.I1.i3.p1.3.m3.2.2.1.1.2.cmml" type="integer" xref="A1.I1.i3.p1.3.m3.2.2.1.1.2">
              1
             </cn>
            </apply>
            <cn id="A1.I1.i3.p1.3.m3.1.1.cmml" type="integer" xref="A1.I1.i3.p1.3.m3.1.1">
             1
            </cn>
           </interval>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I1.i3.p1.3.m3.2c">
           (-1,1)
          </annotation>
         </semantics>
        </math>
        .
       </p>
      </div>
     </li>
     <li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="A1.I1.i4.p1">
       <p class="ltx_p" id="A1.I1.i4.p1.1">
        <math alttext="\textbf{S}_{\textbf{r}}" class="ltx_Math" display="inline" id="A1.I1.i4.p1.1.m1.1">
         <semantics id="A1.I1.i4.p1.1.m1.1a">
          <msub id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml">
           <mtext class="ltx_mathvariant_bold" id="A1.I1.i4.p1.1.m1.1.1.2" xref="A1.I1.i4.p1.1.m1.1.1.2a.cmml">
            S
           </mtext>
           <mtext class="ltx_mathvariant_bold" id="A1.I1.i4.p1.1.m1.1.1.3" xref="A1.I1.i4.p1.1.m1.1.1.3a.cmml">
            r
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.1b">
           <apply id="A1.I1.i4.p1.1.m1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.I1.i4.p1.1.m1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.I1.i4.p1.1.m1.1.1.2a.cmml" xref="A1.I1.i4.p1.1.m1.1.1.2">
             <mtext class="ltx_mathvariant_bold" id="A1.I1.i4.p1.1.m1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.2">
              S
             </mtext>
            </ci>
            <ci id="A1.I1.i4.p1.1.m1.1.1.3a.cmml" xref="A1.I1.i4.p1.1.m1.1.1.3">
             <mtext class="ltx_mathvariant_bold" id="A1.I1.i4.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I1.i4.p1.1.m1.1.1.3">
              r
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.1c">
           \textbf{S}_{\textbf{r}}
          </annotation>
         </semantics>
        </math>
        : The rewards corresponding to the actions. The rewards are very sparse, most of the actions are zero-reward, and only when the current task is finished or the token length of the current buffer has just overflowed it will be non-zero value: +1 for positive, -1 for negative.
       </p>
      </div>
     </li>
    </ul>
   </div>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.3
    </span>
    Algorithm of LTC
   </h3>
   <figure class="ltx_figure" id="A1.SS3.fig1">
    <figure class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" id="alg4" style="width:198.7pt;">
     <div class="ltx_flex_figure">
      <div class="ltx_flex_cell ltx_flex_size_1">
       <div class="ltx_listing ltx_figure_panel ltx_lst_language_python ltx_lstlisting ltx_listing" id="alg4.2" style="background-color:#FFFFFF;">
        <div class="ltx_listing_data">
         <a download="" href="data:text/plain;base64,IyBhZ2VudDogUHJlLXRyYWluZWQgTExNIGFnZW50CiMgbl9ncHU6IHRvdGFsIG51bWJlciBvZiBHUFVzCiMgZW52X2NsczogdGhlIGNsYXNzIG9mIGVudmlyb25tZW50cwojIG5fZ2VuOiB0aGUgZ2VuZXJhdGlvbiBzaXplIGZvciBvbmUgaXRlcmF0aW9uCiMgbl90cmFpbjogdGhlIHRyYWluIHNpemUgZm9yIG9uZSBpdGVyYXRpb24KCiMgaW5pdGlhbGl6YXRpb24KYWdlbnQgPSBpbnN0cnVjdGlvbl9maW5ldHVuZShhZ2VudCkKcmVwbGF5X2J1ZmZlciA9IFtdCmkgPSAwCndoaWxlIGkgPCBtYXhfaXRlcmF0aW9uOgogIGkgKz0gMQogICMgRXhwbG9yYXRpb24gUGhhc2UKICBlbnZzID0gZW52X2NscyhzYW1wbGUoZGF0YSwgbl9nZW4vL25fZ3B1KSkKICAjIGFzeW5jaHJvbm91c2x5IGdlbmVyYXRlCiAgbmV3X2J1ZmZlciA9IGdlbmVyYXRlX3RyaWFscyhhZ2VudCwgZW52cykKICAjIGRpc3QuZ2F0aGVyIGFuZCBkaXN0LmJyb2FkY2FzdAogIG5ld19idWZmZXIgPSBzeW5jX2FsbF9ncHVzKG5ld19idWZmZXIpCiAgcmVwbGF5X2J1ZmZlci5hcHBlbmQobmV3X2J1ZmZlcikKCiAgIyBUcmFpbmluZyBQaGFzZQogIHJvbGxvdXRzID0gc2FtcGxlKHJlcGxheV9idWZmZXIsIG5fdHJhaW4pKQogICMgZGlzdHJpYnV0ZWQgdHJhaW5pbmcgd2l0aCBwcG8KICBhZ2VudCA9IHBwb19kZHBfdHJhaW4oYWdlbnQsIHJvbGxvdXRzKQ==">
          ⬇
         </a>
        </div>
        <div class="ltx_listingline" id="lstnumberx105">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx105.1" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx105.1.1">
          </span>
          agent:
          <span class="ltx_text ltx_lst_space" id="lstnumberx105.1.2">
          </span>
          Pre-trained
          <span class="ltx_text ltx_lst_space" id="lstnumberx105.1.3">
          </span>
          LLM
          <span class="ltx_text ltx_lst_space" id="lstnumberx105.1.4">
          </span>
          agent
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx106">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx106.1" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx106.1.1">
          </span>
          n_gpu:
          <span class="ltx_text ltx_lst_space" id="lstnumberx106.1.2">
          </span>
          total
          <span class="ltx_text ltx_lst_space" id="lstnumberx106.1.3">
          </span>
          number
          <span class="ltx_text ltx_lst_space" id="lstnumberx106.1.4">
          </span>
          of
          <span class="ltx_text ltx_lst_space" id="lstnumberx106.1.5">
          </span>
          GPUs
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx107">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx107.1" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx107.1.1">
          </span>
          env_cls:
          <span class="ltx_text ltx_lst_space" id="lstnumberx107.1.2">
          </span>
          the
          <span class="ltx_text ltx_lst_space" id="lstnumberx107.1.3">
          </span>
          class
          <span class="ltx_text ltx_lst_space" id="lstnumberx107.1.4">
          </span>
          of
          <span class="ltx_text ltx_lst_space" id="lstnumberx107.1.5">
          </span>
          environments
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx108">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx108.1" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx108.1.1">
          </span>
          n_gen:
          <span class="ltx_text ltx_lst_space" id="lstnumberx108.1.2">
          </span>
          the
          <span class="ltx_text ltx_lst_space" id="lstnumberx108.1.3">
          </span>
          generation
          <span class="ltx_text ltx_lst_space" id="lstnumberx108.1.4">
          </span>
          size
          <span class="ltx_text ltx_lst_space" id="lstnumberx108.1.5">
          </span>
          for
          <span class="ltx_text ltx_lst_space" id="lstnumberx108.1.6">
          </span>
          one
          <span class="ltx_text ltx_lst_space" id="lstnumberx108.1.7">
          </span>
          iteration
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx109">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx109.1" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx109.1.1">
          </span>
          n_train:
          <span class="ltx_text ltx_lst_space" id="lstnumberx109.1.2">
          </span>
          the
          <span class="ltx_text ltx_lst_space" id="lstnumberx109.1.3">
          </span>
          train
          <span class="ltx_text ltx_lst_space" id="lstnumberx109.1.4">
          </span>
          size
          <span class="ltx_text ltx_lst_space" id="lstnumberx109.1.5">
          </span>
          for
          <span class="ltx_text ltx_lst_space" id="lstnumberx109.1.6">
          </span>
          one
          <span class="ltx_text ltx_lst_space" id="lstnumberx109.1.7">
          </span>
          iteration
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx110">
        </div>
        <div class="ltx_listingline" id="lstnumberx111">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx111.1" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx111.1.1">
          </span>
          initialization
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx112">
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.1">
          agent
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.2">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx112.3">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx112.4">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.5">
          instruction_finetune
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx112.6">
          (
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx112.7">
          agent
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx112.8">
          )
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx113">
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx113.1">
          replay_buffer
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.2">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx113.3">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx113.4">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx113.5">
          []
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx114">
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx114.1">
          i
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx114.2">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx114.3">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx114.4">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx114.5">
          0
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx115">
         <span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx115.1">
          while
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx115.2">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx115.3">
          i
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx115.4">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx115.5">
          &lt;
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx115.6">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx115.7">
          max_iteration
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx115.8">
          :
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx116">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx116.1">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx116.2">
          i
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx116.3">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx116.4">
          +=
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx116.5">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx116.6">
          1
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx117">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx117.1">
         </span>
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx117.2" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx117.2.1">
          </span>
          Exploration
          <span class="ltx_text ltx_lst_space" id="lstnumberx117.2.2">
          </span>
          Phase
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx118">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.1">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.2">
          envs
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.3">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx118.4">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.5">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.6">
          env_cls
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx118.7">
          (
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.8">
          sample
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx118.9">
          (
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.10">
          data
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx118.11">
          ,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx118.12">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.13">
          n_gen
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx118.14">
          //
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx118.15">
          n_gpu
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx118.16">
          ))
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx119">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx119.1">
         </span>
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx119.2" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx119.2.1">
          </span>
          asynchronously
          <span class="ltx_text ltx_lst_space" id="lstnumberx119.2.2">
          </span>
          generate
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx120">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.1">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.2">
          new_buffer
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.3">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx120.4">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.5">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.6">
          generate_trials
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx120.7">
          (
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.8">
          agent
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx120.9">
          ,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx120.10">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx120.11">
          envs
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx120.12">
          )
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx121">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx121.1">
         </span>
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx121.2" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx121.2.1">
          </span>
          dist.gather
          <span class="ltx_text ltx_lst_space" id="lstnumberx121.2.2">
          </span>
          and
          <span class="ltx_text ltx_lst_space" id="lstnumberx121.2.3">
          </span>
          dist.broadcast
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx122">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.1">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx122.2">
          new_buffer
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.3">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx122.4">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx122.5">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx122.6">
          sync_all_gpus
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx122.7">
          (
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx122.8">
          new_buffer
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx122.9">
          )
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx123">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx123.1">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.2">
          replay_buffer
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx123.3">
          .
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.4">
          append
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx123.5">
          (
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx123.6">
          new_buffer
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx123.7">
          )
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx124">
        </div>
        <div class="ltx_listingline" id="lstnumberx125">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx125.1">
         </span>
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx125.2" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx125.2.1">
          </span>
          Training
          <span class="ltx_text ltx_lst_space" id="lstnumberx125.2.2">
          </span>
          Phase
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx126">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx126.1">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx126.2">
          rollouts
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx126.3">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx126.4">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx126.5">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx126.6">
          sample
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx126.7">
          (
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx126.8">
          replay_buffer
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx126.9">
          ,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx126.10">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx126.11">
          n_train
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx126.12">
          ))
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx127">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx127.1">
         </span>
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx127.2" style="color:#408080;">
          #
          <span class="ltx_text ltx_lst_space" id="lstnumberx127.2.1">
          </span>
          distributed
          <span class="ltx_text ltx_lst_space" id="lstnumberx127.2.2">
          </span>
          training
          <span class="ltx_text ltx_lst_space" id="lstnumberx127.2.3">
          </span>
          with
          <span class="ltx_text ltx_lst_space" id="lstnumberx127.2.4">
          </span>
          ppo
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx128">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.1">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.2">
          agent
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.3">
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx128.4">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.5">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.6">
          ppo_ddp_train
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx128.7">
          (
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.8">
          agent
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx128.9">
          ,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx128.10">
         </span>
         <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx128.11">
          rollouts
         </span>
         <span class="ltx_text ltx_font_typewriter" id="lstnumberx128.12">
          )
         </span>
        </div>
       </div>
      </div>
     </div>
     <figcaption class="ltx_caption">
      <span class="ltx_tag ltx_tag_float">
       <span class="ltx_text ltx_font_bold" id="alg4.3.1.1">
        Algorithm 4
       </span>
      </span>
      Python-style code of LTC
     </figcaption>
     <div class="ltx_flex_figure">
      <div class="ltx_flex_cell ltx_flex_size_1">
       <p class="ltx_p ltx_figure_panel" id="alg4.4">
        <span class="ltx_rule" style="width:100%;height:1px;background:black;display:inline-block;">
        </span>
       </p>
      </div>
     </div>
    </figure>
   </figure>
   <div class="ltx_para ltx_noindent" id="A1.SS3.p1">
    <p class="ltx_p" id="A1.SS3.p1.1">
     The implementation of LTC can be summarized as Algorithm
     <a class="ltx_ref" href="#alg4" title="Algorithm 4 ‣ A.3 Algorithm of LTC ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , we unveil the structural framework that embodies the Learning Through Communication (LTC) paradigm, meticulously crafted to facilitate autonomous and progressive learning through iterative cycles. At the outset, the pre-trained Large Language Model (LLM) agent undergoes a fine-tuning phase to align its initial configuration with the intended learning tasks. Following this, an exploration phase is initiated where a batch of training environments is sampled and subsequently engaged by the agent to generate trial data asynchronously, leveraging the power of parallel computing across multiple GPUs to enhance efficiency. This newly generated data is synchronized across all GPUs to foster a cohesive learning base, which is stored in a replay buffer for further utilization. As the agent iterates through this process, it continually samples from this replay buffer during the training phase, employing the Proximal Policy Optimization (PPO) algorithm in a distributed data parallel (DDP) setting to refine its strategies and adapt dynamically. This code snippet, therefore, encapsulates the innovative asynchronous and distributed nature of the LTC paradigm, marking a significant stride in fostering intelligent, adaptive, and collaborative artificial intelligence agents.
    </p>
   </div>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.4
    </span>
    Training Loss
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS4.p1">
    <p class="ltx_p" id="A1.SS4.p1.5">
     After exploration in each iteration, we update the replay buffer by incorporating the newly collected trajectories and then sample the most recent trajectories to
train the parameters
     <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="A1.SS4.p1.1.m1.1">
      <semantics id="A1.SS4.p1.1.m1.1a">
       <msub id="A1.SS4.p1.1.m1.1.1" xref="A1.SS4.p1.1.m1.1.1.cmml">
        <mi id="A1.SS4.p1.1.m1.1.1.2" xref="A1.SS4.p1.1.m1.1.1.2.cmml">
         π
        </mi>
        <mi id="A1.SS4.p1.1.m1.1.1.3" xref="A1.SS4.p1.1.m1.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.1.m1.1b">
        <apply id="A1.SS4.p1.1.m1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="A1.SS4.p1.1.m1.1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS4.p1.1.m1.1.1.2.cmml" xref="A1.SS4.p1.1.m1.1.1.2">
          𝜋
         </ci>
         <ci id="A1.SS4.p1.1.m1.1.1.3.cmml" xref="A1.SS4.p1.1.m1.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.1.m1.1c">
        \pi_{\theta}
       </annotation>
      </semantics>
     </math>
     of the LLM agent. We design our training objective to combine: 1)
the standard language modeling loss
     <math alttext="\mathcal{L}_{\text{LM}}" class="ltx_Math" display="inline" id="A1.SS4.p1.2.m2.1">
      <semantics id="A1.SS4.p1.2.m2.1a">
       <msub id="A1.SS4.p1.2.m2.1.1" xref="A1.SS4.p1.2.m2.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="A1.SS4.p1.2.m2.1.1.2" xref="A1.SS4.p1.2.m2.1.1.2.cmml">
         ℒ
        </mi>
        <mtext id="A1.SS4.p1.2.m2.1.1.3" xref="A1.SS4.p1.2.m2.1.1.3a.cmml">
         LM
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.2.m2.1b">
        <apply id="A1.SS4.p1.2.m2.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="A1.SS4.p1.2.m2.1.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS4.p1.2.m2.1.1.2.cmml" xref="A1.SS4.p1.2.m2.1.1.2">
          ℒ
         </ci>
         <ci id="A1.SS4.p1.2.m2.1.1.3a.cmml" xref="A1.SS4.p1.2.m2.1.1.3">
          <mtext id="A1.SS4.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS4.p1.2.m2.1.1.3">
           LM
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.2.m2.1c">
        \mathcal{L}_{\text{LM}}
       </annotation>
      </semantics>
     </math>
     , 2) the policy loss
     <math alttext="\mathcal{L}_{\text{policy}}" class="ltx_Math" display="inline" id="A1.SS4.p1.3.m3.1">
      <semantics id="A1.SS4.p1.3.m3.1a">
       <msub id="A1.SS4.p1.3.m3.1.1" xref="A1.SS4.p1.3.m3.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="A1.SS4.p1.3.m3.1.1.2" xref="A1.SS4.p1.3.m3.1.1.2.cmml">
         ℒ
        </mi>
        <mtext id="A1.SS4.p1.3.m3.1.1.3" xref="A1.SS4.p1.3.m3.1.1.3a.cmml">
         policy
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.3.m3.1b">
        <apply id="A1.SS4.p1.3.m3.1.1.cmml" xref="A1.SS4.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="A1.SS4.p1.3.m3.1.1.1.cmml" xref="A1.SS4.p1.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS4.p1.3.m3.1.1.2.cmml" xref="A1.SS4.p1.3.m3.1.1.2">
          ℒ
         </ci>
         <ci id="A1.SS4.p1.3.m3.1.1.3a.cmml" xref="A1.SS4.p1.3.m3.1.1.3">
          <mtext id="A1.SS4.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="A1.SS4.p1.3.m3.1.1.3">
           policy
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.3.m3.1c">
        \mathcal{L}_{\text{policy}}
       </annotation>
      </semantics>
     </math>
     , 3) the value loss
     <math alttext="\mathcal{L}_{\text{value}}" class="ltx_Math" display="inline" id="A1.SS4.p1.4.m4.1">
      <semantics id="A1.SS4.p1.4.m4.1a">
       <msub id="A1.SS4.p1.4.m4.1.1" xref="A1.SS4.p1.4.m4.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="A1.SS4.p1.4.m4.1.1.2" xref="A1.SS4.p1.4.m4.1.1.2.cmml">
         ℒ
        </mi>
        <mtext id="A1.SS4.p1.4.m4.1.1.3" xref="A1.SS4.p1.4.m4.1.1.3a.cmml">
         value
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.4.m4.1b">
        <apply id="A1.SS4.p1.4.m4.1.1.cmml" xref="A1.SS4.p1.4.m4.1.1">
         <csymbol cd="ambiguous" id="A1.SS4.p1.4.m4.1.1.1.cmml" xref="A1.SS4.p1.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS4.p1.4.m4.1.1.2.cmml" xref="A1.SS4.p1.4.m4.1.1.2">
          ℒ
         </ci>
         <ci id="A1.SS4.p1.4.m4.1.1.3a.cmml" xref="A1.SS4.p1.4.m4.1.1.3">
          <mtext id="A1.SS4.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="A1.SS4.p1.4.m4.1.1.3">
           value
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.4.m4.1c">
        \mathcal{L}_{\text{value}}
       </annotation>
      </semantics>
     </math>
     , and 4) the entropy loss
     <math alttext="\mathcal{L}_{\text{entropy}}" class="ltx_Math" display="inline" id="A1.SS4.p1.5.m5.1">
      <semantics id="A1.SS4.p1.5.m5.1a">
       <msub id="A1.SS4.p1.5.m5.1.1" xref="A1.SS4.p1.5.m5.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="A1.SS4.p1.5.m5.1.1.2" xref="A1.SS4.p1.5.m5.1.1.2.cmml">
         ℒ
        </mi>
        <mtext id="A1.SS4.p1.5.m5.1.1.3" xref="A1.SS4.p1.5.m5.1.1.3a.cmml">
         entropy
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.5.m5.1b">
        <apply id="A1.SS4.p1.5.m5.1.1.cmml" xref="A1.SS4.p1.5.m5.1.1">
         <csymbol cd="ambiguous" id="A1.SS4.p1.5.m5.1.1.1.cmml" xref="A1.SS4.p1.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS4.p1.5.m5.1.1.2.cmml" xref="A1.SS4.p1.5.m5.1.1.2">
          ℒ
         </ci>
         <ci id="A1.SS4.p1.5.m5.1.1.3a.cmml" xref="A1.SS4.p1.5.m5.1.1.3">
          <mtext id="A1.SS4.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="A1.SS4.p1.5.m5.1.1.3">
           entropy
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.5.m5.1c">
        \mathcal{L}_{\text{entropy}}
       </annotation>
      </semantics>
     </math>
     .
The overall training objective is formulated as:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
     <tbody id="A1.Ex1">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{\text{total}}" class="ltx_Math" display="inline" id="A1.Ex1.m1.1">
         <semantics id="A1.Ex1.m1.1a">
          <msub id="A1.Ex1.m1.1.1" xref="A1.Ex1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m1.1.1.2" xref="A1.Ex1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mtext id="A1.Ex1.m1.1.1.3" xref="A1.Ex1.m1.1.1.3a.cmml">
            total
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.1b">
           <apply id="A1.Ex1.m1.1.1.cmml" xref="A1.Ex1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.cmml" xref="A1.Ex1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.Ex1.m1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.2">
             ℒ
            </ci>
            <ci id="A1.Ex1.m1.1.1.3a.cmml" xref="A1.Ex1.m1.1.1.3">
             <mtext id="A1.Ex1.m1.1.1.3.cmml" mathsize="70%" xref="A1.Ex1.m1.1.1.3">
              total
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.Ex1.m1.1c">
           \displaystyle\mathcal{L}_{\text{total}}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\mathcal{L}_{\text{LM}}+\beta(\mathcal{L}_{\text{policy}}+\lambda\mathcal{L}_{\text{value}}+\mathcal{L}_{\text{entropy}})" class="ltx_Math" display="inline" id="A1.Ex1.m2.1">
         <semantics id="A1.Ex1.m2.1a">
          <mrow id="A1.Ex1.m2.1.1" xref="A1.Ex1.m2.1.1.cmml">
           <mi id="A1.Ex1.m2.1.1.3" xref="A1.Ex1.m2.1.1.3.cmml">
           </mi>
           <mo id="A1.Ex1.m2.1.1.2" xref="A1.Ex1.m2.1.1.2.cmml">
            =
           </mo>
           <mrow id="A1.Ex1.m2.1.1.1" xref="A1.Ex1.m2.1.1.1.cmml">
            <msub id="A1.Ex1.m2.1.1.1.3" xref="A1.Ex1.m2.1.1.1.3.cmml">
             <mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m2.1.1.1.3.2" xref="A1.Ex1.m2.1.1.1.3.2.cmml">
              ℒ
             </mi>
             <mtext id="A1.Ex1.m2.1.1.1.3.3" xref="A1.Ex1.m2.1.1.1.3.3a.cmml">
              LM
             </mtext>
            </msub>
            <mo id="A1.Ex1.m2.1.1.1.2" xref="A1.Ex1.m2.1.1.1.2.cmml">
             +
            </mo>
            <mrow id="A1.Ex1.m2.1.1.1.1" xref="A1.Ex1.m2.1.1.1.1.cmml">
             <mi id="A1.Ex1.m2.1.1.1.1.3" xref="A1.Ex1.m2.1.1.1.1.3.cmml">
              β
             </mi>
             <mo id="A1.Ex1.m2.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex1.m2.1.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="A1.Ex1.m2.1.1.1.1.1.1" xref="A1.Ex1.m2.1.1.1.1.1.1.1.cmml">
              <mo id="A1.Ex1.m2.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex1.m2.1.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="A1.Ex1.m2.1.1.1.1.1.1.1" xref="A1.Ex1.m2.1.1.1.1.1.1.1.cmml">
               <msub id="A1.Ex1.m2.1.1.1.1.1.1.1.2" xref="A1.Ex1.m2.1.1.1.1.1.1.1.2.cmml">
                <mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m2.1.1.1.1.1.1.1.2.2" xref="A1.Ex1.m2.1.1.1.1.1.1.1.2.2.cmml">
                 ℒ
                </mi>
                <mtext id="A1.Ex1.m2.1.1.1.1.1.1.1.2.3" xref="A1.Ex1.m2.1.1.1.1.1.1.1.2.3a.cmml">
                 policy
                </mtext>
               </msub>
               <mo id="A1.Ex1.m2.1.1.1.1.1.1.1.1" xref="A1.Ex1.m2.1.1.1.1.1.1.1.1.cmml">
                +
               </mo>
               <mrow id="A1.Ex1.m2.1.1.1.1.1.1.1.3" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.cmml">
                <mi id="A1.Ex1.m2.1.1.1.1.1.1.1.3.2" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.2.cmml">
                 λ
                </mi>
                <mo id="A1.Ex1.m2.1.1.1.1.1.1.1.3.1" lspace="0em" rspace="0em" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.1.cmml">
                 ​
                </mo>
                <msub id="A1.Ex1.m2.1.1.1.1.1.1.1.3.3" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.cmml">
                 <mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.2.cmml">
                  ℒ
                 </mi>
                 <mtext id="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.3" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.3a.cmml">
                  value
                 </mtext>
                </msub>
               </mrow>
               <mo id="A1.Ex1.m2.1.1.1.1.1.1.1.1a" xref="A1.Ex1.m2.1.1.1.1.1.1.1.1.cmml">
                +
               </mo>
               <msub id="A1.Ex1.m2.1.1.1.1.1.1.1.4" xref="A1.Ex1.m2.1.1.1.1.1.1.1.4.cmml">
                <mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m2.1.1.1.1.1.1.1.4.2" xref="A1.Ex1.m2.1.1.1.1.1.1.1.4.2.cmml">
                 ℒ
                </mi>
                <mtext id="A1.Ex1.m2.1.1.1.1.1.1.1.4.3" xref="A1.Ex1.m2.1.1.1.1.1.1.1.4.3a.cmml">
                 entropy
                </mtext>
               </msub>
              </mrow>
              <mo id="A1.Ex1.m2.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex1.m2.1.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.Ex1.m2.1b">
           <apply id="A1.Ex1.m2.1.1.cmml" xref="A1.Ex1.m2.1.1">
            <eq id="A1.Ex1.m2.1.1.2.cmml" xref="A1.Ex1.m2.1.1.2">
            </eq>
            <csymbol cd="latexml" id="A1.Ex1.m2.1.1.3.cmml" xref="A1.Ex1.m2.1.1.3">
             absent
            </csymbol>
            <apply id="A1.Ex1.m2.1.1.1.cmml" xref="A1.Ex1.m2.1.1.1">
             <plus id="A1.Ex1.m2.1.1.1.2.cmml" xref="A1.Ex1.m2.1.1.1.2">
             </plus>
             <apply id="A1.Ex1.m2.1.1.1.3.cmml" xref="A1.Ex1.m2.1.1.1.3">
              <csymbol cd="ambiguous" id="A1.Ex1.m2.1.1.1.3.1.cmml" xref="A1.Ex1.m2.1.1.1.3">
               subscript
              </csymbol>
              <ci id="A1.Ex1.m2.1.1.1.3.2.cmml" xref="A1.Ex1.m2.1.1.1.3.2">
               ℒ
              </ci>
              <ci id="A1.Ex1.m2.1.1.1.3.3a.cmml" xref="A1.Ex1.m2.1.1.1.3.3">
               <mtext id="A1.Ex1.m2.1.1.1.3.3.cmml" mathsize="70%" xref="A1.Ex1.m2.1.1.1.3.3">
                LM
               </mtext>
              </ci>
             </apply>
             <apply id="A1.Ex1.m2.1.1.1.1.cmml" xref="A1.Ex1.m2.1.1.1.1">
              <times id="A1.Ex1.m2.1.1.1.1.2.cmml" xref="A1.Ex1.m2.1.1.1.1.2">
              </times>
              <ci id="A1.Ex1.m2.1.1.1.1.3.cmml" xref="A1.Ex1.m2.1.1.1.1.3">
               𝛽
              </ci>
              <apply id="A1.Ex1.m2.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1">
               <plus id="A1.Ex1.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.1">
               </plus>
               <apply id="A1.Ex1.m2.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.2">
                <csymbol cd="ambiguous" id="A1.Ex1.m2.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.2">
                 subscript
                </csymbol>
                <ci id="A1.Ex1.m2.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.2.2">
                 ℒ
                </ci>
                <ci id="A1.Ex1.m2.1.1.1.1.1.1.1.2.3a.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.2.3">
                 <mtext id="A1.Ex1.m2.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="A1.Ex1.m2.1.1.1.1.1.1.1.2.3">
                  policy
                 </mtext>
                </ci>
               </apply>
               <apply id="A1.Ex1.m2.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3">
                <times id="A1.Ex1.m2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.1">
                </times>
                <ci id="A1.Ex1.m2.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.2">
                 𝜆
                </ci>
                <apply id="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.3">
                 <csymbol cd="ambiguous" id="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.3">
                  subscript
                 </csymbol>
                 <ci id="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.2">
                  ℒ
                 </ci>
                 <ci id="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.3a.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.3">
                  <mtext id="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="A1.Ex1.m2.1.1.1.1.1.1.1.3.3.3">
                   value
                  </mtext>
                 </ci>
                </apply>
               </apply>
               <apply id="A1.Ex1.m2.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.4">
                <csymbol cd="ambiguous" id="A1.Ex1.m2.1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.4">
                 subscript
                </csymbol>
                <ci id="A1.Ex1.m2.1.1.1.1.1.1.1.4.2.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.4.2">
                 ℒ
                </ci>
                <ci id="A1.Ex1.m2.1.1.1.1.1.1.1.4.3a.cmml" xref="A1.Ex1.m2.1.1.1.1.1.1.1.4.3">
                 <mtext id="A1.Ex1.m2.1.1.1.1.1.1.1.4.3.cmml" mathsize="70%" xref="A1.Ex1.m2.1.1.1.1.1.1.1.4.3">
                  entropy
                 </mtext>
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.Ex1.m2.1c">
           \displaystyle=\mathcal{L}_{\text{LM}}+\beta(\mathcal{L}_{\text{policy}}+\lambda\mathcal{L}_{\text{value}}+\mathcal{L}_{\text{entropy}})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="A1.SS4.p1.7">
     where
     <math alttext="\beta" class="ltx_Math" display="inline" id="A1.SS4.p1.6.m1.1">
      <semantics id="A1.SS4.p1.6.m1.1a">
       <mi id="A1.SS4.p1.6.m1.1.1" xref="A1.SS4.p1.6.m1.1.1.cmml">
        β
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.6.m1.1b">
        <ci id="A1.SS4.p1.6.m1.1.1.cmml" xref="A1.SS4.p1.6.m1.1.1">
         𝛽
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.6.m1.1c">
        \beta
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\lambda" class="ltx_Math" display="inline" id="A1.SS4.p1.7.m2.1">
      <semantics id="A1.SS4.p1.7.m2.1a">
       <mi id="A1.SS4.p1.7.m2.1.1" xref="A1.SS4.p1.7.m2.1.1.cmml">
        λ
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.7.m2.1b">
        <ci id="A1.SS4.p1.7.m2.1.1.cmml" xref="A1.SS4.p1.7.m2.1.1">
         𝜆
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.7.m2.1c">
        \lambda
       </annotation>
      </semantics>
     </math>
     are weighting hyperparameters.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS4.p2">
    <p class="ltx_p" id="A1.SS4.p2.1">
     The different losses in the above are described as follows:
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS4.p3">
    <ul class="ltx_itemize" id="A1.I2">
     <li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="A1.I2.i1.p1">
       <p class="ltx_p" id="A1.I2.i1.p1.1">
        The LM loss
        <math alttext="\mathcal{L}_{\text{LM}}" class="ltx_Math" display="inline" id="A1.I2.i1.p1.1.m1.1">
         <semantics id="A1.I2.i1.p1.1.m1.1a">
          <msub id="A1.I2.i1.p1.1.m1.1.1" xref="A1.I2.i1.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A1.I2.i1.p1.1.m1.1.1.2" xref="A1.I2.i1.p1.1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mtext id="A1.I2.i1.p1.1.m1.1.1.3" xref="A1.I2.i1.p1.1.m1.1.1.3a.cmml">
            LM
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i1.p1.1.m1.1b">
           <apply id="A1.I2.i1.p1.1.m1.1.1.cmml" xref="A1.I2.i1.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i1.p1.1.m1.1.1.1.cmml" xref="A1.I2.i1.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i1.p1.1.m1.1.1.2.cmml" xref="A1.I2.i1.p1.1.m1.1.1.2">
             ℒ
            </ci>
            <ci id="A1.I2.i1.p1.1.m1.1.1.3a.cmml" xref="A1.I2.i1.p1.1.m1.1.1.3">
             <mtext id="A1.I2.i1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I2.i1.p1.1.m1.1.1.3">
              LM
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i1.p1.1.m1.1c">
           \mathcal{L}_{\text{LM}}
          </annotation>
         </semantics>
        </math>
        is defined as the cross entropy between the agent and its generations which have a positive reward, akin to self-improving model schemes
        <cite class="ltx_cite ltx_citemacro_cite">
         [
         <a class="ltx_ref" href="#bib.bib15" title="">
          15
         </a>
         ;
         <a class="ltx_ref" href="#bib.bib36" title="">
          36
         </a>
         ]
        </cite>
        . By training on these generations, the agent is further encouraged to give generations which yield positive rewards.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="A1.I2.i2.p1">
       <p class="ltx_p" id="A1.I2.i2.p1.3">
        The policy loss
        <math alttext="\mathcal{L}_{\text{policy}}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.1.m1.1">
         <semantics id="A1.I2.i2.p1.1.m1.1a">
          <msub id="A1.I2.i2.p1.1.m1.1.1" xref="A1.I2.i2.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A1.I2.i2.p1.1.m1.1.1.2" xref="A1.I2.i2.p1.1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mtext id="A1.I2.i2.p1.1.m1.1.1.3" xref="A1.I2.i2.p1.1.m1.1.1.3a.cmml">
            policy
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.1.m1.1b">
           <apply id="A1.I2.i2.p1.1.m1.1.1.cmml" xref="A1.I2.i2.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i2.p1.1.m1.1.1.1.cmml" xref="A1.I2.i2.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i2.p1.1.m1.1.1.2.cmml" xref="A1.I2.i2.p1.1.m1.1.1.2">
             ℒ
            </ci>
            <ci id="A1.I2.i2.p1.1.m1.1.1.3a.cmml" xref="A1.I2.i2.p1.1.m1.1.1.3">
             <mtext id="A1.I2.i2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I2.i2.p1.1.m1.1.1.3">
              policy
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.1.m1.1c">
           \mathcal{L}_{\text{policy}}
          </annotation>
         </semantics>
        </math>
        is introduced to supervise the agent’s actions. The policy loss
        <math alttext="\mathcal{L}_{\text{policy}}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.2.m2.1">
         <semantics id="A1.I2.i2.p1.2.m2.1a">
          <msub id="A1.I2.i2.p1.2.m2.1.1" xref="A1.I2.i2.p1.2.m2.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A1.I2.i2.p1.2.m2.1.1.2" xref="A1.I2.i2.p1.2.m2.1.1.2.cmml">
            ℒ
           </mi>
           <mtext id="A1.I2.i2.p1.2.m2.1.1.3" xref="A1.I2.i2.p1.2.m2.1.1.3a.cmml">
            policy
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.2.m2.1b">
           <apply id="A1.I2.i2.p1.2.m2.1.1.cmml" xref="A1.I2.i2.p1.2.m2.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i2.p1.2.m2.1.1.1.cmml" xref="A1.I2.i2.p1.2.m2.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i2.p1.2.m2.1.1.2.cmml" xref="A1.I2.i2.p1.2.m2.1.1.2">
             ℒ
            </ci>
            <ci id="A1.I2.i2.p1.2.m2.1.1.3a.cmml" xref="A1.I2.i2.p1.2.m2.1.1.3">
             <mtext id="A1.I2.i2.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.I2.i2.p1.2.m2.1.1.3">
              policy
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.2.m2.1c">
           \mathcal{L}_{\text{policy}}
          </annotation>
         </semantics>
        </math>
        is calculated using a masked version of the surrogate objective defined in
        <cite class="ltx_cite ltx_citemacro_cite">
         [
         <a class="ltx_ref" href="#bib.bib42" title="">
          42
         </a>
         ]
        </cite>
        with advantage estimates
        <math alttext="\hat{A}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.3.m3.1">
         <semantics id="A1.I2.i2.p1.3.m3.1a">
          <mover accent="true" id="A1.I2.i2.p1.3.m3.1.1" xref="A1.I2.i2.p1.3.m3.1.1.cmml">
           <mi id="A1.I2.i2.p1.3.m3.1.1.2" xref="A1.I2.i2.p1.3.m3.1.1.2.cmml">
            A
           </mi>
           <mo id="A1.I2.i2.p1.3.m3.1.1.1" xref="A1.I2.i2.p1.3.m3.1.1.1.cmml">
            ^
           </mo>
          </mover>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.3.m3.1b">
           <apply id="A1.I2.i2.p1.3.m3.1.1.cmml" xref="A1.I2.i2.p1.3.m3.1.1">
            <ci id="A1.I2.i2.p1.3.m3.1.1.1.cmml" xref="A1.I2.i2.p1.3.m3.1.1.1">
             ^
            </ci>
            <ci id="A1.I2.i2.p1.3.m3.1.1.2.cmml" xref="A1.I2.i2.p1.3.m3.1.1.2">
             𝐴
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.3.m3.1c">
           \hat{A}
          </annotation>
         </semantics>
        </math>
        ,
       </p>
       <table class="ltx_equation ltx_eqn_table" id="A1.Ex2">
        <tbody>
         <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
          <td class="ltx_eqn_cell ltx_eqn_center_padleft">
          </td>
          <td class="ltx_eqn_cell ltx_align_center">
           <math alttext="\mathcal{L}_{\text{policy}}(\theta)=-\mathbb{E}[m_{\text{policy}}*\text{min}(r(\theta)\hat{A},\text{clip}(r(\theta),1-\epsilon,1+\epsilon)\hat{A}]," class="ltx_math_unparsed" display="block" id="A1.Ex2.m1.3">
            <semantics id="A1.Ex2.m1.3a">
             <mrow id="A1.Ex2.m1.3b">
              <msub id="A1.Ex2.m1.3.4">
               <mi class="ltx_font_mathcaligraphic" id="A1.Ex2.m1.3.4.2">
                ℒ
               </mi>
               <mtext id="A1.Ex2.m1.3.4.3">
                policy
               </mtext>
              </msub>
              <mrow id="A1.Ex2.m1.3.5">
               <mo id="A1.Ex2.m1.3.5.1" stretchy="false">
                (
               </mo>
               <mi id="A1.Ex2.m1.1.1">
                θ
               </mi>
               <mo id="A1.Ex2.m1.3.5.2" stretchy="false">
                )
               </mo>
              </mrow>
              <mo id="A1.Ex2.m1.3.6" rspace="0em">
               =
              </mo>
              <mo id="A1.Ex2.m1.3.7" lspace="0em">
               −
              </mo>
              <mi id="A1.Ex2.m1.3.8">
               𝔼
              </mi>
              <mrow id="A1.Ex2.m1.3.9">
               <mo id="A1.Ex2.m1.3.9.1" stretchy="false">
                [
               </mo>
               <msub id="A1.Ex2.m1.3.9.2">
                <mi id="A1.Ex2.m1.3.9.2.2">
                 m
                </mi>
                <mtext id="A1.Ex2.m1.3.9.2.3">
                 policy
                </mtext>
               </msub>
               <mo id="A1.Ex2.m1.3.9.3" lspace="0.222em" rspace="0.222em">
                ∗
               </mo>
               <mtext id="A1.Ex2.m1.3.9.4">
                min
               </mtext>
               <mrow id="A1.Ex2.m1.3.9.5">
                <mo id="A1.Ex2.m1.3.9.5.1" stretchy="false">
                 (
                </mo>
                <mi id="A1.Ex2.m1.3.9.5.2">
                 r
                </mi>
                <mrow id="A1.Ex2.m1.3.9.5.3">
                 <mo id="A1.Ex2.m1.3.9.5.3.1" stretchy="false">
                  (
                 </mo>
                 <mi id="A1.Ex2.m1.2.2">
                  θ
                 </mi>
                 <mo id="A1.Ex2.m1.3.9.5.3.2" stretchy="false">
                  )
                 </mo>
                </mrow>
                <mover accent="true" id="A1.Ex2.m1.3.9.5.4">
                 <mi id="A1.Ex2.m1.3.9.5.4.2">
                  A
                 </mi>
                 <mo id="A1.Ex2.m1.3.9.5.4.1">
                  ^
                 </mo>
                </mover>
                <mo id="A1.Ex2.m1.3.9.5.5">
                 ,
                </mo>
                <mtext id="A1.Ex2.m1.3.9.5.6">
                 clip
                </mtext>
                <mrow id="A1.Ex2.m1.3.9.5.7">
                 <mo id="A1.Ex2.m1.3.9.5.7.1" stretchy="false">
                  (
                 </mo>
                 <mi id="A1.Ex2.m1.3.9.5.7.2">
                  r
                 </mi>
                 <mrow id="A1.Ex2.m1.3.9.5.7.3">
                  <mo id="A1.Ex2.m1.3.9.5.7.3.1" stretchy="false">
                   (
                  </mo>
                  <mi id="A1.Ex2.m1.3.3">
                   θ
                  </mi>
                  <mo id="A1.Ex2.m1.3.9.5.7.3.2" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="A1.Ex2.m1.3.9.5.7.4">
                  ,
                 </mo>
                 <mn id="A1.Ex2.m1.3.9.5.7.5">
                  1
                 </mn>
                 <mo id="A1.Ex2.m1.3.9.5.7.6">
                  −
                 </mo>
                 <mi id="A1.Ex2.m1.3.9.5.7.7">
                  ϵ
                 </mi>
                 <mo id="A1.Ex2.m1.3.9.5.7.8">
                  ,
                 </mo>
                 <mn id="A1.Ex2.m1.3.9.5.7.9">
                  1
                 </mn>
                 <mo id="A1.Ex2.m1.3.9.5.7.10">
                  +
                 </mo>
                 <mi id="A1.Ex2.m1.3.9.5.7.11">
                  ϵ
                 </mi>
                 <mo id="A1.Ex2.m1.3.9.5.7.12" stretchy="false">
                  )
                 </mo>
                </mrow>
                <mover accent="true" id="A1.Ex2.m1.3.9.5.8">
                 <mi id="A1.Ex2.m1.3.9.5.8.2">
                  A
                 </mi>
                 <mo id="A1.Ex2.m1.3.9.5.8.1">
                  ^
                 </mo>
                </mover>
                <mo id="A1.Ex2.m1.3.9.5.9" stretchy="false">
                 ]
                </mo>
               </mrow>
               <mo id="A1.Ex2.m1.3.9.6">
                ,
               </mo>
              </mrow>
             </mrow>
             <annotation encoding="application/x-tex" id="A1.Ex2.m1.3c">
              \mathcal{L}_{\text{policy}}(\theta)=-\mathbb{E}[m_{\text{policy}}*\text{min}(r(\theta)\hat{A},\text{clip}(r(\theta),1-\epsilon,1+\epsilon)\hat{A}],
             </annotation>
            </semantics>
           </math>
          </td>
          <td class="ltx_eqn_cell ltx_eqn_center_padright">
          </td>
         </tr>
        </tbody>
       </table>
       <p class="ltx_p" id="A1.I2.i2.p1.13">
        where
        <math alttext="r(\theta)" class="ltx_Math" display="inline" id="A1.I2.i2.p1.4.m1.1">
         <semantics id="A1.I2.i2.p1.4.m1.1a">
          <mrow id="A1.I2.i2.p1.4.m1.1.2" xref="A1.I2.i2.p1.4.m1.1.2.cmml">
           <mi id="A1.I2.i2.p1.4.m1.1.2.2" xref="A1.I2.i2.p1.4.m1.1.2.2.cmml">
            r
           </mi>
           <mo id="A1.I2.i2.p1.4.m1.1.2.1" lspace="0em" rspace="0em" xref="A1.I2.i2.p1.4.m1.1.2.1.cmml">
            ​
           </mo>
           <mrow id="A1.I2.i2.p1.4.m1.1.2.3.2" xref="A1.I2.i2.p1.4.m1.1.2.cmml">
            <mo id="A1.I2.i2.p1.4.m1.1.2.3.2.1" stretchy="false" xref="A1.I2.i2.p1.4.m1.1.2.cmml">
             (
            </mo>
            <mi id="A1.I2.i2.p1.4.m1.1.1" xref="A1.I2.i2.p1.4.m1.1.1.cmml">
             θ
            </mi>
            <mo id="A1.I2.i2.p1.4.m1.1.2.3.2.2" stretchy="false" xref="A1.I2.i2.p1.4.m1.1.2.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.4.m1.1b">
           <apply id="A1.I2.i2.p1.4.m1.1.2.cmml" xref="A1.I2.i2.p1.4.m1.1.2">
            <times id="A1.I2.i2.p1.4.m1.1.2.1.cmml" xref="A1.I2.i2.p1.4.m1.1.2.1">
            </times>
            <ci id="A1.I2.i2.p1.4.m1.1.2.2.cmml" xref="A1.I2.i2.p1.4.m1.1.2.2">
             𝑟
            </ci>
            <ci id="A1.I2.i2.p1.4.m1.1.1.cmml" xref="A1.I2.i2.p1.4.m1.1.1">
             𝜃
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.4.m1.1c">
           r(\theta)
          </annotation>
         </semantics>
        </math>
        is the output probability ratio
        <math alttext="r(\theta)=\frac{\pi_{\theta}(a\&gt;|\&gt;s)}{\pi_{\text{old}}(a\&gt;|\&gt;s)}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.5.m2.3">
         <semantics id="A1.I2.i2.p1.5.m2.3a">
          <mrow id="A1.I2.i2.p1.5.m2.3.4" xref="A1.I2.i2.p1.5.m2.3.4.cmml">
           <mrow id="A1.I2.i2.p1.5.m2.3.4.2" xref="A1.I2.i2.p1.5.m2.3.4.2.cmml">
            <mi id="A1.I2.i2.p1.5.m2.3.4.2.2" xref="A1.I2.i2.p1.5.m2.3.4.2.2.cmml">
             r
            </mi>
            <mo id="A1.I2.i2.p1.5.m2.3.4.2.1" lspace="0em" rspace="0em" xref="A1.I2.i2.p1.5.m2.3.4.2.1.cmml">
             ​
            </mo>
            <mrow id="A1.I2.i2.p1.5.m2.3.4.2.3.2" xref="A1.I2.i2.p1.5.m2.3.4.2.cmml">
             <mo id="A1.I2.i2.p1.5.m2.3.4.2.3.2.1" stretchy="false" xref="A1.I2.i2.p1.5.m2.3.4.2.cmml">
              (
             </mo>
             <mi id="A1.I2.i2.p1.5.m2.3.3" xref="A1.I2.i2.p1.5.m2.3.3.cmml">
              θ
             </mi>
             <mo id="A1.I2.i2.p1.5.m2.3.4.2.3.2.2" stretchy="false" xref="A1.I2.i2.p1.5.m2.3.4.2.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="A1.I2.i2.p1.5.m2.3.4.1" xref="A1.I2.i2.p1.5.m2.3.4.1.cmml">
            =
           </mo>
           <mfrac id="A1.I2.i2.p1.5.m2.2.2" xref="A1.I2.i2.p1.5.m2.2.2.cmml">
            <mrow id="A1.I2.i2.p1.5.m2.1.1.1" xref="A1.I2.i2.p1.5.m2.1.1.1.cmml">
             <msub id="A1.I2.i2.p1.5.m2.1.1.1.3" xref="A1.I2.i2.p1.5.m2.1.1.1.3.cmml">
              <mi id="A1.I2.i2.p1.5.m2.1.1.1.3.2" xref="A1.I2.i2.p1.5.m2.1.1.1.3.2.cmml">
               π
              </mi>
              <mi id="A1.I2.i2.p1.5.m2.1.1.1.3.3" xref="A1.I2.i2.p1.5.m2.1.1.1.3.3.cmml">
               θ
              </mi>
             </msub>
             <mo id="A1.I2.i2.p1.5.m2.1.1.1.2" lspace="0em" rspace="0em" xref="A1.I2.i2.p1.5.m2.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="A1.I2.i2.p1.5.m2.1.1.1.1.1" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.cmml">
              <mo id="A1.I2.i2.p1.5.m2.1.1.1.1.1.2" stretchy="false" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="A1.I2.i2.p1.5.m2.1.1.1.1.1.1" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.cmml">
               <mi id="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.2" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.2.cmml">
                a
               </mi>
               <mo fence="false" id="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.1" lspace="0.498em" rspace="0.498em" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.1.cmml">
                |
               </mo>
               <mi id="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.3" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.3.cmml">
                s
               </mi>
              </mrow>
              <mo id="A1.I2.i2.p1.5.m2.1.1.1.1.1.3" stretchy="false" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mrow id="A1.I2.i2.p1.5.m2.2.2.2" xref="A1.I2.i2.p1.5.m2.2.2.2.cmml">
             <msub id="A1.I2.i2.p1.5.m2.2.2.2.3" xref="A1.I2.i2.p1.5.m2.2.2.2.3.cmml">
              <mi id="A1.I2.i2.p1.5.m2.2.2.2.3.2" xref="A1.I2.i2.p1.5.m2.2.2.2.3.2.cmml">
               π
              </mi>
              <mtext id="A1.I2.i2.p1.5.m2.2.2.2.3.3" xref="A1.I2.i2.p1.5.m2.2.2.2.3.3a.cmml">
               old
              </mtext>
             </msub>
             <mo id="A1.I2.i2.p1.5.m2.2.2.2.2" lspace="0em" rspace="0em" xref="A1.I2.i2.p1.5.m2.2.2.2.2.cmml">
              ​
             </mo>
             <mrow id="A1.I2.i2.p1.5.m2.2.2.2.1.1" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.cmml">
              <mo id="A1.I2.i2.p1.5.m2.2.2.2.1.1.2" stretchy="false" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.cmml">
               (
              </mo>
              <mrow id="A1.I2.i2.p1.5.m2.2.2.2.1.1.1" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.cmml">
               <mi id="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.2" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.2.cmml">
                a
               </mi>
               <mo fence="false" id="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.1" lspace="0.498em" rspace="0.498em" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.1.cmml">
                |
               </mo>
               <mi id="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.3" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.3.cmml">
                s
               </mi>
              </mrow>
              <mo id="A1.I2.i2.p1.5.m2.2.2.2.1.1.3" stretchy="false" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mfrac>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.5.m2.3b">
           <apply id="A1.I2.i2.p1.5.m2.3.4.cmml" xref="A1.I2.i2.p1.5.m2.3.4">
            <eq id="A1.I2.i2.p1.5.m2.3.4.1.cmml" xref="A1.I2.i2.p1.5.m2.3.4.1">
            </eq>
            <apply id="A1.I2.i2.p1.5.m2.3.4.2.cmml" xref="A1.I2.i2.p1.5.m2.3.4.2">
             <times id="A1.I2.i2.p1.5.m2.3.4.2.1.cmml" xref="A1.I2.i2.p1.5.m2.3.4.2.1">
             </times>
             <ci id="A1.I2.i2.p1.5.m2.3.4.2.2.cmml" xref="A1.I2.i2.p1.5.m2.3.4.2.2">
              𝑟
             </ci>
             <ci id="A1.I2.i2.p1.5.m2.3.3.cmml" xref="A1.I2.i2.p1.5.m2.3.3">
              𝜃
             </ci>
            </apply>
            <apply id="A1.I2.i2.p1.5.m2.2.2.cmml" xref="A1.I2.i2.p1.5.m2.2.2">
             <divide id="A1.I2.i2.p1.5.m2.2.2.3.cmml" xref="A1.I2.i2.p1.5.m2.2.2">
             </divide>
             <apply id="A1.I2.i2.p1.5.m2.1.1.1.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1">
              <times id="A1.I2.i2.p1.5.m2.1.1.1.2.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.2">
              </times>
              <apply id="A1.I2.i2.p1.5.m2.1.1.1.3.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.3">
               <csymbol cd="ambiguous" id="A1.I2.i2.p1.5.m2.1.1.1.3.1.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.3">
                subscript
               </csymbol>
               <ci id="A1.I2.i2.p1.5.m2.1.1.1.3.2.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.3.2">
                𝜋
               </ci>
               <ci id="A1.I2.i2.p1.5.m2.1.1.1.3.3.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.3.3">
                𝜃
               </ci>
              </apply>
              <apply id="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1">
               <csymbol cd="latexml" id="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.1.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.1">
                conditional
               </csymbol>
               <ci id="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.2.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.2">
                𝑎
               </ci>
               <ci id="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.3.cmml" xref="A1.I2.i2.p1.5.m2.1.1.1.1.1.1.3">
                𝑠
               </ci>
              </apply>
             </apply>
             <apply id="A1.I2.i2.p1.5.m2.2.2.2.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2">
              <times id="A1.I2.i2.p1.5.m2.2.2.2.2.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.2">
              </times>
              <apply id="A1.I2.i2.p1.5.m2.2.2.2.3.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.3">
               <csymbol cd="ambiguous" id="A1.I2.i2.p1.5.m2.2.2.2.3.1.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.3">
                subscript
               </csymbol>
               <ci id="A1.I2.i2.p1.5.m2.2.2.2.3.2.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.3.2">
                𝜋
               </ci>
               <ci id="A1.I2.i2.p1.5.m2.2.2.2.3.3a.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.3.3">
                <mtext id="A1.I2.i2.p1.5.m2.2.2.2.3.3.cmml" mathsize="50%" xref="A1.I2.i2.p1.5.m2.2.2.2.3.3">
                 old
                </mtext>
               </ci>
              </apply>
              <apply id="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1">
               <csymbol cd="latexml" id="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.1.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.1">
                conditional
               </csymbol>
               <ci id="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.2.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.2">
                𝑎
               </ci>
               <ci id="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.3.cmml" xref="A1.I2.i2.p1.5.m2.2.2.2.1.1.1.3">
                𝑠
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.5.m2.3c">
           r(\theta)=\frac{\pi_{\theta}(a\&gt;|\&gt;s)}{\pi_{\text{old}}(a\&gt;|\&gt;s)}
          </annotation>
         </semantics>
        </math>
        of the agent with its previous version
        <math alttext="\pi_{\text{old}}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.6.m3.1">
         <semantics id="A1.I2.i2.p1.6.m3.1a">
          <msub id="A1.I2.i2.p1.6.m3.1.1" xref="A1.I2.i2.p1.6.m3.1.1.cmml">
           <mi id="A1.I2.i2.p1.6.m3.1.1.2" xref="A1.I2.i2.p1.6.m3.1.1.2.cmml">
            π
           </mi>
           <mtext id="A1.I2.i2.p1.6.m3.1.1.3" xref="A1.I2.i2.p1.6.m3.1.1.3a.cmml">
            old
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.6.m3.1b">
           <apply id="A1.I2.i2.p1.6.m3.1.1.cmml" xref="A1.I2.i2.p1.6.m3.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i2.p1.6.m3.1.1.1.cmml" xref="A1.I2.i2.p1.6.m3.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i2.p1.6.m3.1.1.2.cmml" xref="A1.I2.i2.p1.6.m3.1.1.2">
             𝜋
            </ci>
            <ci id="A1.I2.i2.p1.6.m3.1.1.3a.cmml" xref="A1.I2.i2.p1.6.m3.1.1.3">
             <mtext id="A1.I2.i2.p1.6.m3.1.1.3.cmml" mathsize="70%" xref="A1.I2.i2.p1.6.m3.1.1.3">
              old
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.6.m3.1c">
           \pi_{\text{old}}
          </annotation>
         </semantics>
        </math>
        . We define binary mask
        <math alttext="m_{\text{policy}}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.7.m4.1">
         <semantics id="A1.I2.i2.p1.7.m4.1a">
          <msub id="A1.I2.i2.p1.7.m4.1.1" xref="A1.I2.i2.p1.7.m4.1.1.cmml">
           <mi id="A1.I2.i2.p1.7.m4.1.1.2" xref="A1.I2.i2.p1.7.m4.1.1.2.cmml">
            m
           </mi>
           <mtext id="A1.I2.i2.p1.7.m4.1.1.3" xref="A1.I2.i2.p1.7.m4.1.1.3a.cmml">
            policy
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.7.m4.1b">
           <apply id="A1.I2.i2.p1.7.m4.1.1.cmml" xref="A1.I2.i2.p1.7.m4.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i2.p1.7.m4.1.1.1.cmml" xref="A1.I2.i2.p1.7.m4.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i2.p1.7.m4.1.1.2.cmml" xref="A1.I2.i2.p1.7.m4.1.1.2">
             𝑚
            </ci>
            <ci id="A1.I2.i2.p1.7.m4.1.1.3a.cmml" xref="A1.I2.i2.p1.7.m4.1.1.3">
             <mtext id="A1.I2.i2.p1.7.m4.1.1.3.cmml" mathsize="70%" xref="A1.I2.i2.p1.7.m4.1.1.3">
              policy
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.7.m4.1c">
           m_{\text{policy}}
          </annotation>
         </semantics>
        </math>
        to mask out the encoded system message in PPO loss (marked by
        <math alttext="S_{m}=0" class="ltx_Math" display="inline" id="A1.I2.i2.p1.8.m5.1">
         <semantics id="A1.I2.i2.p1.8.m5.1a">
          <mrow id="A1.I2.i2.p1.8.m5.1.1" xref="A1.I2.i2.p1.8.m5.1.1.cmml">
           <msub id="A1.I2.i2.p1.8.m5.1.1.2" xref="A1.I2.i2.p1.8.m5.1.1.2.cmml">
            <mi id="A1.I2.i2.p1.8.m5.1.1.2.2" xref="A1.I2.i2.p1.8.m5.1.1.2.2.cmml">
             S
            </mi>
            <mi id="A1.I2.i2.p1.8.m5.1.1.2.3" xref="A1.I2.i2.p1.8.m5.1.1.2.3.cmml">
             m
            </mi>
           </msub>
           <mo id="A1.I2.i2.p1.8.m5.1.1.1" xref="A1.I2.i2.p1.8.m5.1.1.1.cmml">
            =
           </mo>
           <mn id="A1.I2.i2.p1.8.m5.1.1.3" xref="A1.I2.i2.p1.8.m5.1.1.3.cmml">
            0
           </mn>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.8.m5.1b">
           <apply id="A1.I2.i2.p1.8.m5.1.1.cmml" xref="A1.I2.i2.p1.8.m5.1.1">
            <eq id="A1.I2.i2.p1.8.m5.1.1.1.cmml" xref="A1.I2.i2.p1.8.m5.1.1.1">
            </eq>
            <apply id="A1.I2.i2.p1.8.m5.1.1.2.cmml" xref="A1.I2.i2.p1.8.m5.1.1.2">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.8.m5.1.1.2.1.cmml" xref="A1.I2.i2.p1.8.m5.1.1.2">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.8.m5.1.1.2.2.cmml" xref="A1.I2.i2.p1.8.m5.1.1.2.2">
              𝑆
             </ci>
             <ci id="A1.I2.i2.p1.8.m5.1.1.2.3.cmml" xref="A1.I2.i2.p1.8.m5.1.1.2.3">
              𝑚
             </ci>
            </apply>
            <cn id="A1.I2.i2.p1.8.m5.1.1.3.cmml" type="integer" xref="A1.I2.i2.p1.8.m5.1.1.3">
             0
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.8.m5.1c">
           S_{m}=0
          </annotation>
         </semantics>
        </math>
        in buffers
        <a class="ltx_ref" href="#A1.SS2" title="A.2 Buffer Structure ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
         <span class="ltx_text ltx_ref_tag">
          A.2
         </span>
        </a>
        ). For example, let
        <math alttext="\{x_{1},y_{1},x_{2},y_{2},\dots x_{n},y_{n}\}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.9.m6.6">
         <semantics id="A1.I2.i2.p1.9.m6.6a">
          <mrow id="A1.I2.i2.p1.9.m6.6.6.6" xref="A1.I2.i2.p1.9.m6.6.6.7.cmml">
           <mo id="A1.I2.i2.p1.9.m6.6.6.6.7" stretchy="false" xref="A1.I2.i2.p1.9.m6.6.6.7.cmml">
            {
           </mo>
           <msub id="A1.I2.i2.p1.9.m6.1.1.1.1" xref="A1.I2.i2.p1.9.m6.1.1.1.1.cmml">
            <mi id="A1.I2.i2.p1.9.m6.1.1.1.1.2" xref="A1.I2.i2.p1.9.m6.1.1.1.1.2.cmml">
             x
            </mi>
            <mn id="A1.I2.i2.p1.9.m6.1.1.1.1.3" xref="A1.I2.i2.p1.9.m6.1.1.1.1.3.cmml">
             1
            </mn>
           </msub>
           <mo id="A1.I2.i2.p1.9.m6.6.6.6.8" xref="A1.I2.i2.p1.9.m6.6.6.7.cmml">
            ,
           </mo>
           <msub id="A1.I2.i2.p1.9.m6.2.2.2.2" xref="A1.I2.i2.p1.9.m6.2.2.2.2.cmml">
            <mi id="A1.I2.i2.p1.9.m6.2.2.2.2.2" xref="A1.I2.i2.p1.9.m6.2.2.2.2.2.cmml">
             y
            </mi>
            <mn id="A1.I2.i2.p1.9.m6.2.2.2.2.3" xref="A1.I2.i2.p1.9.m6.2.2.2.2.3.cmml">
             1
            </mn>
           </msub>
           <mo id="A1.I2.i2.p1.9.m6.6.6.6.9" xref="A1.I2.i2.p1.9.m6.6.6.7.cmml">
            ,
           </mo>
           <msub id="A1.I2.i2.p1.9.m6.3.3.3.3" xref="A1.I2.i2.p1.9.m6.3.3.3.3.cmml">
            <mi id="A1.I2.i2.p1.9.m6.3.3.3.3.2" xref="A1.I2.i2.p1.9.m6.3.3.3.3.2.cmml">
             x
            </mi>
            <mn id="A1.I2.i2.p1.9.m6.3.3.3.3.3" xref="A1.I2.i2.p1.9.m6.3.3.3.3.3.cmml">
             2
            </mn>
           </msub>
           <mo id="A1.I2.i2.p1.9.m6.6.6.6.10" xref="A1.I2.i2.p1.9.m6.6.6.7.cmml">
            ,
           </mo>
           <msub id="A1.I2.i2.p1.9.m6.4.4.4.4" xref="A1.I2.i2.p1.9.m6.4.4.4.4.cmml">
            <mi id="A1.I2.i2.p1.9.m6.4.4.4.4.2" xref="A1.I2.i2.p1.9.m6.4.4.4.4.2.cmml">
             y
            </mi>
            <mn id="A1.I2.i2.p1.9.m6.4.4.4.4.3" xref="A1.I2.i2.p1.9.m6.4.4.4.4.3.cmml">
             2
            </mn>
           </msub>
           <mo id="A1.I2.i2.p1.9.m6.6.6.6.11" xref="A1.I2.i2.p1.9.m6.6.6.7.cmml">
            ,
           </mo>
           <mrow id="A1.I2.i2.p1.9.m6.5.5.5.5" xref="A1.I2.i2.p1.9.m6.5.5.5.5.cmml">
            <mi id="A1.I2.i2.p1.9.m6.5.5.5.5.2" mathvariant="normal" xref="A1.I2.i2.p1.9.m6.5.5.5.5.2.cmml">
             …
            </mi>
            <mo id="A1.I2.i2.p1.9.m6.5.5.5.5.1" lspace="0em" rspace="0em" xref="A1.I2.i2.p1.9.m6.5.5.5.5.1.cmml">
             ​
            </mo>
            <msub id="A1.I2.i2.p1.9.m6.5.5.5.5.3" xref="A1.I2.i2.p1.9.m6.5.5.5.5.3.cmml">
             <mi id="A1.I2.i2.p1.9.m6.5.5.5.5.3.2" xref="A1.I2.i2.p1.9.m6.5.5.5.5.3.2.cmml">
              x
             </mi>
             <mi id="A1.I2.i2.p1.9.m6.5.5.5.5.3.3" xref="A1.I2.i2.p1.9.m6.5.5.5.5.3.3.cmml">
              n
             </mi>
            </msub>
           </mrow>
           <mo id="A1.I2.i2.p1.9.m6.6.6.6.12" xref="A1.I2.i2.p1.9.m6.6.6.7.cmml">
            ,
           </mo>
           <msub id="A1.I2.i2.p1.9.m6.6.6.6.6" xref="A1.I2.i2.p1.9.m6.6.6.6.6.cmml">
            <mi id="A1.I2.i2.p1.9.m6.6.6.6.6.2" xref="A1.I2.i2.p1.9.m6.6.6.6.6.2.cmml">
             y
            </mi>
            <mi id="A1.I2.i2.p1.9.m6.6.6.6.6.3" xref="A1.I2.i2.p1.9.m6.6.6.6.6.3.cmml">
             n
            </mi>
           </msub>
           <mo id="A1.I2.i2.p1.9.m6.6.6.6.13" stretchy="false" xref="A1.I2.i2.p1.9.m6.6.6.7.cmml">
            }
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.9.m6.6b">
           <set id="A1.I2.i2.p1.9.m6.6.6.7.cmml" xref="A1.I2.i2.p1.9.m6.6.6.6">
            <apply id="A1.I2.i2.p1.9.m6.1.1.1.1.cmml" xref="A1.I2.i2.p1.9.m6.1.1.1.1">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.9.m6.1.1.1.1.1.cmml" xref="A1.I2.i2.p1.9.m6.1.1.1.1">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.9.m6.1.1.1.1.2.cmml" xref="A1.I2.i2.p1.9.m6.1.1.1.1.2">
              𝑥
             </ci>
             <cn id="A1.I2.i2.p1.9.m6.1.1.1.1.3.cmml" type="integer" xref="A1.I2.i2.p1.9.m6.1.1.1.1.3">
              1
             </cn>
            </apply>
            <apply id="A1.I2.i2.p1.9.m6.2.2.2.2.cmml" xref="A1.I2.i2.p1.9.m6.2.2.2.2">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.9.m6.2.2.2.2.1.cmml" xref="A1.I2.i2.p1.9.m6.2.2.2.2">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.9.m6.2.2.2.2.2.cmml" xref="A1.I2.i2.p1.9.m6.2.2.2.2.2">
              𝑦
             </ci>
             <cn id="A1.I2.i2.p1.9.m6.2.2.2.2.3.cmml" type="integer" xref="A1.I2.i2.p1.9.m6.2.2.2.2.3">
              1
             </cn>
            </apply>
            <apply id="A1.I2.i2.p1.9.m6.3.3.3.3.cmml" xref="A1.I2.i2.p1.9.m6.3.3.3.3">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.9.m6.3.3.3.3.1.cmml" xref="A1.I2.i2.p1.9.m6.3.3.3.3">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.9.m6.3.3.3.3.2.cmml" xref="A1.I2.i2.p1.9.m6.3.3.3.3.2">
              𝑥
             </ci>
             <cn id="A1.I2.i2.p1.9.m6.3.3.3.3.3.cmml" type="integer" xref="A1.I2.i2.p1.9.m6.3.3.3.3.3">
              2
             </cn>
            </apply>
            <apply id="A1.I2.i2.p1.9.m6.4.4.4.4.cmml" xref="A1.I2.i2.p1.9.m6.4.4.4.4">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.9.m6.4.4.4.4.1.cmml" xref="A1.I2.i2.p1.9.m6.4.4.4.4">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.9.m6.4.4.4.4.2.cmml" xref="A1.I2.i2.p1.9.m6.4.4.4.4.2">
              𝑦
             </ci>
             <cn id="A1.I2.i2.p1.9.m6.4.4.4.4.3.cmml" type="integer" xref="A1.I2.i2.p1.9.m6.4.4.4.4.3">
              2
             </cn>
            </apply>
            <apply id="A1.I2.i2.p1.9.m6.5.5.5.5.cmml" xref="A1.I2.i2.p1.9.m6.5.5.5.5">
             <times id="A1.I2.i2.p1.9.m6.5.5.5.5.1.cmml" xref="A1.I2.i2.p1.9.m6.5.5.5.5.1">
             </times>
             <ci id="A1.I2.i2.p1.9.m6.5.5.5.5.2.cmml" xref="A1.I2.i2.p1.9.m6.5.5.5.5.2">
              …
             </ci>
             <apply id="A1.I2.i2.p1.9.m6.5.5.5.5.3.cmml" xref="A1.I2.i2.p1.9.m6.5.5.5.5.3">
              <csymbol cd="ambiguous" id="A1.I2.i2.p1.9.m6.5.5.5.5.3.1.cmml" xref="A1.I2.i2.p1.9.m6.5.5.5.5.3">
               subscript
              </csymbol>
              <ci id="A1.I2.i2.p1.9.m6.5.5.5.5.3.2.cmml" xref="A1.I2.i2.p1.9.m6.5.5.5.5.3.2">
               𝑥
              </ci>
              <ci id="A1.I2.i2.p1.9.m6.5.5.5.5.3.3.cmml" xref="A1.I2.i2.p1.9.m6.5.5.5.5.3.3">
               𝑛
              </ci>
             </apply>
            </apply>
            <apply id="A1.I2.i2.p1.9.m6.6.6.6.6.cmml" xref="A1.I2.i2.p1.9.m6.6.6.6.6">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.9.m6.6.6.6.6.1.cmml" xref="A1.I2.i2.p1.9.m6.6.6.6.6">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.9.m6.6.6.6.6.2.cmml" xref="A1.I2.i2.p1.9.m6.6.6.6.6.2">
              𝑦
             </ci>
             <ci id="A1.I2.i2.p1.9.m6.6.6.6.6.3.cmml" xref="A1.I2.i2.p1.9.m6.6.6.6.6.3">
              𝑛
             </ci>
            </apply>
           </set>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.9.m6.6c">
           \{x_{1},y_{1},x_{2},y_{2},\dots x_{n},y_{n}\}
          </annotation>
         </semantics>
        </math>
        be a token buffer consisting of system messages
        <math alttext="x_{n}\in X" class="ltx_Math" display="inline" id="A1.I2.i2.p1.10.m7.1">
         <semantics id="A1.I2.i2.p1.10.m7.1a">
          <mrow id="A1.I2.i2.p1.10.m7.1.1" xref="A1.I2.i2.p1.10.m7.1.1.cmml">
           <msub id="A1.I2.i2.p1.10.m7.1.1.2" xref="A1.I2.i2.p1.10.m7.1.1.2.cmml">
            <mi id="A1.I2.i2.p1.10.m7.1.1.2.2" xref="A1.I2.i2.p1.10.m7.1.1.2.2.cmml">
             x
            </mi>
            <mi id="A1.I2.i2.p1.10.m7.1.1.2.3" xref="A1.I2.i2.p1.10.m7.1.1.2.3.cmml">
             n
            </mi>
           </msub>
           <mo id="A1.I2.i2.p1.10.m7.1.1.1" xref="A1.I2.i2.p1.10.m7.1.1.1.cmml">
            ∈
           </mo>
           <mi id="A1.I2.i2.p1.10.m7.1.1.3" xref="A1.I2.i2.p1.10.m7.1.1.3.cmml">
            X
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.10.m7.1b">
           <apply id="A1.I2.i2.p1.10.m7.1.1.cmml" xref="A1.I2.i2.p1.10.m7.1.1">
            <in id="A1.I2.i2.p1.10.m7.1.1.1.cmml" xref="A1.I2.i2.p1.10.m7.1.1.1">
            </in>
            <apply id="A1.I2.i2.p1.10.m7.1.1.2.cmml" xref="A1.I2.i2.p1.10.m7.1.1.2">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.10.m7.1.1.2.1.cmml" xref="A1.I2.i2.p1.10.m7.1.1.2">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.10.m7.1.1.2.2.cmml" xref="A1.I2.i2.p1.10.m7.1.1.2.2">
              𝑥
             </ci>
             <ci id="A1.I2.i2.p1.10.m7.1.1.2.3.cmml" xref="A1.I2.i2.p1.10.m7.1.1.2.3">
              𝑛
             </ci>
            </apply>
            <ci id="A1.I2.i2.p1.10.m7.1.1.3.cmml" xref="A1.I2.i2.p1.10.m7.1.1.3">
             𝑋
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.10.m7.1c">
           x_{n}\in X
          </annotation>
         </semantics>
        </math>
        and agents’ messages (include the target trained agent and the other teacher agents)
        <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.11.m8.1">
         <semantics id="A1.I2.i2.p1.11.m8.1a">
          <msub id="A1.I2.i2.p1.11.m8.1.1" xref="A1.I2.i2.p1.11.m8.1.1.cmml">
           <mi id="A1.I2.i2.p1.11.m8.1.1.2" xref="A1.I2.i2.p1.11.m8.1.1.2.cmml">
            π
           </mi>
           <mi id="A1.I2.i2.p1.11.m8.1.1.3" xref="A1.I2.i2.p1.11.m8.1.1.3.cmml">
            θ
           </mi>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.11.m8.1b">
           <apply id="A1.I2.i2.p1.11.m8.1.1.cmml" xref="A1.I2.i2.p1.11.m8.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i2.p1.11.m8.1.1.1.cmml" xref="A1.I2.i2.p1.11.m8.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i2.p1.11.m8.1.1.2.cmml" xref="A1.I2.i2.p1.11.m8.1.1.2">
             𝜋
            </ci>
            <ci id="A1.I2.i2.p1.11.m8.1.1.3.cmml" xref="A1.I2.i2.p1.11.m8.1.1.3">
             𝜃
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.11.m8.1c">
           \pi_{\theta}
          </annotation>
         </semantics>
        </math>
        output
        <math alttext="y_{n}\in Y" class="ltx_Math" display="inline" id="A1.I2.i2.p1.12.m9.1">
         <semantics id="A1.I2.i2.p1.12.m9.1a">
          <mrow id="A1.I2.i2.p1.12.m9.1.1" xref="A1.I2.i2.p1.12.m9.1.1.cmml">
           <msub id="A1.I2.i2.p1.12.m9.1.1.2" xref="A1.I2.i2.p1.12.m9.1.1.2.cmml">
            <mi id="A1.I2.i2.p1.12.m9.1.1.2.2" xref="A1.I2.i2.p1.12.m9.1.1.2.2.cmml">
             y
            </mi>
            <mi id="A1.I2.i2.p1.12.m9.1.1.2.3" xref="A1.I2.i2.p1.12.m9.1.1.2.3.cmml">
             n
            </mi>
           </msub>
           <mo id="A1.I2.i2.p1.12.m9.1.1.1" xref="A1.I2.i2.p1.12.m9.1.1.1.cmml">
            ∈
           </mo>
           <mi id="A1.I2.i2.p1.12.m9.1.1.3" xref="A1.I2.i2.p1.12.m9.1.1.3.cmml">
            Y
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.12.m9.1b">
           <apply id="A1.I2.i2.p1.12.m9.1.1.cmml" xref="A1.I2.i2.p1.12.m9.1.1">
            <in id="A1.I2.i2.p1.12.m9.1.1.1.cmml" xref="A1.I2.i2.p1.12.m9.1.1.1">
            </in>
            <apply id="A1.I2.i2.p1.12.m9.1.1.2.cmml" xref="A1.I2.i2.p1.12.m9.1.1.2">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.12.m9.1.1.2.1.cmml" xref="A1.I2.i2.p1.12.m9.1.1.2">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.12.m9.1.1.2.2.cmml" xref="A1.I2.i2.p1.12.m9.1.1.2.2">
              𝑦
             </ci>
             <ci id="A1.I2.i2.p1.12.m9.1.1.2.3.cmml" xref="A1.I2.i2.p1.12.m9.1.1.2.3">
              𝑛
             </ci>
            </apply>
            <ci id="A1.I2.i2.p1.12.m9.1.1.3.cmml" xref="A1.I2.i2.p1.12.m9.1.1.3">
             𝑌
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.12.m9.1c">
           y_{n}\in Y
          </annotation>
         </semantics>
        </math>
        , then the binary mask
        <math alttext="m_{\text{policy}}=\{0,1,0,1,\dots 0,1\}" class="ltx_Math" display="inline" id="A1.I2.i2.p1.13.m10.6">
         <semantics id="A1.I2.i2.p1.13.m10.6a">
          <mrow id="A1.I2.i2.p1.13.m10.6.6" xref="A1.I2.i2.p1.13.m10.6.6.cmml">
           <msub id="A1.I2.i2.p1.13.m10.6.6.3" xref="A1.I2.i2.p1.13.m10.6.6.3.cmml">
            <mi id="A1.I2.i2.p1.13.m10.6.6.3.2" xref="A1.I2.i2.p1.13.m10.6.6.3.2.cmml">
             m
            </mi>
            <mtext id="A1.I2.i2.p1.13.m10.6.6.3.3" xref="A1.I2.i2.p1.13.m10.6.6.3.3a.cmml">
             policy
            </mtext>
           </msub>
           <mo id="A1.I2.i2.p1.13.m10.6.6.2" xref="A1.I2.i2.p1.13.m10.6.6.2.cmml">
            =
           </mo>
           <mrow id="A1.I2.i2.p1.13.m10.6.6.1.1" xref="A1.I2.i2.p1.13.m10.6.6.1.2.cmml">
            <mo id="A1.I2.i2.p1.13.m10.6.6.1.1.2" stretchy="false" xref="A1.I2.i2.p1.13.m10.6.6.1.2.cmml">
             {
            </mo>
            <mn id="A1.I2.i2.p1.13.m10.1.1" xref="A1.I2.i2.p1.13.m10.1.1.cmml">
             0
            </mn>
            <mo id="A1.I2.i2.p1.13.m10.6.6.1.1.3" xref="A1.I2.i2.p1.13.m10.6.6.1.2.cmml">
             ,
            </mo>
            <mn id="A1.I2.i2.p1.13.m10.2.2" xref="A1.I2.i2.p1.13.m10.2.2.cmml">
             1
            </mn>
            <mo id="A1.I2.i2.p1.13.m10.6.6.1.1.4" xref="A1.I2.i2.p1.13.m10.6.6.1.2.cmml">
             ,
            </mo>
            <mn id="A1.I2.i2.p1.13.m10.3.3" xref="A1.I2.i2.p1.13.m10.3.3.cmml">
             0
            </mn>
            <mo id="A1.I2.i2.p1.13.m10.6.6.1.1.5" xref="A1.I2.i2.p1.13.m10.6.6.1.2.cmml">
             ,
            </mo>
            <mn id="A1.I2.i2.p1.13.m10.4.4" xref="A1.I2.i2.p1.13.m10.4.4.cmml">
             1
            </mn>
            <mo id="A1.I2.i2.p1.13.m10.6.6.1.1.6" xref="A1.I2.i2.p1.13.m10.6.6.1.2.cmml">
             ,
            </mo>
            <mrow id="A1.I2.i2.p1.13.m10.6.6.1.1.1" xref="A1.I2.i2.p1.13.m10.6.6.1.1.1.cmml">
             <mi id="A1.I2.i2.p1.13.m10.6.6.1.1.1.2" mathvariant="normal" xref="A1.I2.i2.p1.13.m10.6.6.1.1.1.2.cmml">
              …
             </mi>
             <mo id="A1.I2.i2.p1.13.m10.6.6.1.1.1.1" lspace="0em" rspace="0em" xref="A1.I2.i2.p1.13.m10.6.6.1.1.1.1.cmml">
              ​
             </mo>
             <mn id="A1.I2.i2.p1.13.m10.6.6.1.1.1.3" xref="A1.I2.i2.p1.13.m10.6.6.1.1.1.3.cmml">
              0
             </mn>
            </mrow>
            <mo id="A1.I2.i2.p1.13.m10.6.6.1.1.7" xref="A1.I2.i2.p1.13.m10.6.6.1.2.cmml">
             ,
            </mo>
            <mn id="A1.I2.i2.p1.13.m10.5.5" xref="A1.I2.i2.p1.13.m10.5.5.cmml">
             1
            </mn>
            <mo id="A1.I2.i2.p1.13.m10.6.6.1.1.8" stretchy="false" xref="A1.I2.i2.p1.13.m10.6.6.1.2.cmml">
             }
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i2.p1.13.m10.6b">
           <apply id="A1.I2.i2.p1.13.m10.6.6.cmml" xref="A1.I2.i2.p1.13.m10.6.6">
            <eq id="A1.I2.i2.p1.13.m10.6.6.2.cmml" xref="A1.I2.i2.p1.13.m10.6.6.2">
            </eq>
            <apply id="A1.I2.i2.p1.13.m10.6.6.3.cmml" xref="A1.I2.i2.p1.13.m10.6.6.3">
             <csymbol cd="ambiguous" id="A1.I2.i2.p1.13.m10.6.6.3.1.cmml" xref="A1.I2.i2.p1.13.m10.6.6.3">
              subscript
             </csymbol>
             <ci id="A1.I2.i2.p1.13.m10.6.6.3.2.cmml" xref="A1.I2.i2.p1.13.m10.6.6.3.2">
              𝑚
             </ci>
             <ci id="A1.I2.i2.p1.13.m10.6.6.3.3a.cmml" xref="A1.I2.i2.p1.13.m10.6.6.3.3">
              <mtext id="A1.I2.i2.p1.13.m10.6.6.3.3.cmml" mathsize="70%" xref="A1.I2.i2.p1.13.m10.6.6.3.3">
               policy
              </mtext>
             </ci>
            </apply>
            <set id="A1.I2.i2.p1.13.m10.6.6.1.2.cmml" xref="A1.I2.i2.p1.13.m10.6.6.1.1">
             <cn id="A1.I2.i2.p1.13.m10.1.1.cmml" type="integer" xref="A1.I2.i2.p1.13.m10.1.1">
              0
             </cn>
             <cn id="A1.I2.i2.p1.13.m10.2.2.cmml" type="integer" xref="A1.I2.i2.p1.13.m10.2.2">
              1
             </cn>
             <cn id="A1.I2.i2.p1.13.m10.3.3.cmml" type="integer" xref="A1.I2.i2.p1.13.m10.3.3">
              0
             </cn>
             <cn id="A1.I2.i2.p1.13.m10.4.4.cmml" type="integer" xref="A1.I2.i2.p1.13.m10.4.4">
              1
             </cn>
             <apply id="A1.I2.i2.p1.13.m10.6.6.1.1.1.cmml" xref="A1.I2.i2.p1.13.m10.6.6.1.1.1">
              <times id="A1.I2.i2.p1.13.m10.6.6.1.1.1.1.cmml" xref="A1.I2.i2.p1.13.m10.6.6.1.1.1.1">
              </times>
              <ci id="A1.I2.i2.p1.13.m10.6.6.1.1.1.2.cmml" xref="A1.I2.i2.p1.13.m10.6.6.1.1.1.2">
               …
              </ci>
              <cn id="A1.I2.i2.p1.13.m10.6.6.1.1.1.3.cmml" type="integer" xref="A1.I2.i2.p1.13.m10.6.6.1.1.1.3">
               0
              </cn>
             </apply>
             <cn id="A1.I2.i2.p1.13.m10.5.5.cmml" type="integer" xref="A1.I2.i2.p1.13.m10.5.5">
              1
             </cn>
            </set>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i2.p1.13.m10.6c">
           m_{\text{policy}}=\{0,1,0,1,\dots 0,1\}
          </annotation>
         </semantics>
        </math>
        .
       </p>
      </div>
     </li>
     <li class="ltx_item" id="A1.I2.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="A1.I2.i3.p1">
       <p class="ltx_p" id="A1.I2.i3.p1.7">
        The value loss is defined in
        <cite class="ltx_cite ltx_citemacro_cite">
         [
         <a class="ltx_ref" href="#bib.bib42" title="">
          42
         </a>
         ]
        </cite>
        as the mean squared error between calculated value and estimated advantages masked by another binary mask
        <math alttext="m_{\text{value}}" class="ltx_Math" display="inline" id="A1.I2.i3.p1.1.m1.1">
         <semantics id="A1.I2.i3.p1.1.m1.1a">
          <msub id="A1.I2.i3.p1.1.m1.1.1" xref="A1.I2.i3.p1.1.m1.1.1.cmml">
           <mi id="A1.I2.i3.p1.1.m1.1.1.2" xref="A1.I2.i3.p1.1.m1.1.1.2.cmml">
            m
           </mi>
           <mtext id="A1.I2.i3.p1.1.m1.1.1.3" xref="A1.I2.i3.p1.1.m1.1.1.3a.cmml">
            value
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i3.p1.1.m1.1b">
           <apply id="A1.I2.i3.p1.1.m1.1.1.cmml" xref="A1.I2.i3.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i3.p1.1.m1.1.1.1.cmml" xref="A1.I2.i3.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i3.p1.1.m1.1.1.2.cmml" xref="A1.I2.i3.p1.1.m1.1.1.2">
             𝑚
            </ci>
            <ci id="A1.I2.i3.p1.1.m1.1.1.3a.cmml" xref="A1.I2.i3.p1.1.m1.1.1.3">
             <mtext id="A1.I2.i3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I2.i3.p1.1.m1.1.1.3">
              value
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i3.p1.1.m1.1c">
           m_{\text{value}}
          </annotation>
         </semantics>
        </math>
        (marked by
        <math alttext="S_{m}=1" class="ltx_Math" display="inline" id="A1.I2.i3.p1.2.m2.1">
         <semantics id="A1.I2.i3.p1.2.m2.1a">
          <mrow id="A1.I2.i3.p1.2.m2.1.1" xref="A1.I2.i3.p1.2.m2.1.1.cmml">
           <msub id="A1.I2.i3.p1.2.m2.1.1.2" xref="A1.I2.i3.p1.2.m2.1.1.2.cmml">
            <mi id="A1.I2.i3.p1.2.m2.1.1.2.2" xref="A1.I2.i3.p1.2.m2.1.1.2.2.cmml">
             S
            </mi>
            <mi id="A1.I2.i3.p1.2.m2.1.1.2.3" xref="A1.I2.i3.p1.2.m2.1.1.2.3.cmml">
             m
            </mi>
           </msub>
           <mo id="A1.I2.i3.p1.2.m2.1.1.1" xref="A1.I2.i3.p1.2.m2.1.1.1.cmml">
            =
           </mo>
           <mn id="A1.I2.i3.p1.2.m2.1.1.3" xref="A1.I2.i3.p1.2.m2.1.1.3.cmml">
            1
           </mn>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i3.p1.2.m2.1b">
           <apply id="A1.I2.i3.p1.2.m2.1.1.cmml" xref="A1.I2.i3.p1.2.m2.1.1">
            <eq id="A1.I2.i3.p1.2.m2.1.1.1.cmml" xref="A1.I2.i3.p1.2.m2.1.1.1">
            </eq>
            <apply id="A1.I2.i3.p1.2.m2.1.1.2.cmml" xref="A1.I2.i3.p1.2.m2.1.1.2">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.2.m2.1.1.2.1.cmml" xref="A1.I2.i3.p1.2.m2.1.1.2">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.2.m2.1.1.2.2.cmml" xref="A1.I2.i3.p1.2.m2.1.1.2.2">
              𝑆
             </ci>
             <ci id="A1.I2.i3.p1.2.m2.1.1.2.3.cmml" xref="A1.I2.i3.p1.2.m2.1.1.2.3">
              𝑚
             </ci>
            </apply>
            <cn id="A1.I2.i3.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.I2.i3.p1.2.m2.1.1.3">
             1
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i3.p1.2.m2.1c">
           S_{m}=1
          </annotation>
         </semantics>
        </math>
        in buffers
        <a class="ltx_ref" href="#A1.SS2" title="A.2 Buffer Structure ‣ Appendix A Appendix ‣ Adapting LLM Agents Through Communication">
         <span class="ltx_text ltx_ref_tag">
          A.2
         </span>
        </a>
        ). For example, let
        <math alttext="\{z_{1},y_{1},z_{2},y_{2},\dots z_{n},y_{n}\}" class="ltx_Math" display="inline" id="A1.I2.i3.p1.3.m3.6">
         <semantics id="A1.I2.i3.p1.3.m3.6a">
          <mrow id="A1.I2.i3.p1.3.m3.6.6.6" xref="A1.I2.i3.p1.3.m3.6.6.7.cmml">
           <mo id="A1.I2.i3.p1.3.m3.6.6.6.7" stretchy="false" xref="A1.I2.i3.p1.3.m3.6.6.7.cmml">
            {
           </mo>
           <msub id="A1.I2.i3.p1.3.m3.1.1.1.1" xref="A1.I2.i3.p1.3.m3.1.1.1.1.cmml">
            <mi id="A1.I2.i3.p1.3.m3.1.1.1.1.2" xref="A1.I2.i3.p1.3.m3.1.1.1.1.2.cmml">
             z
            </mi>
            <mn id="A1.I2.i3.p1.3.m3.1.1.1.1.3" xref="A1.I2.i3.p1.3.m3.1.1.1.1.3.cmml">
             1
            </mn>
           </msub>
           <mo id="A1.I2.i3.p1.3.m3.6.6.6.8" xref="A1.I2.i3.p1.3.m3.6.6.7.cmml">
            ,
           </mo>
           <msub id="A1.I2.i3.p1.3.m3.2.2.2.2" xref="A1.I2.i3.p1.3.m3.2.2.2.2.cmml">
            <mi id="A1.I2.i3.p1.3.m3.2.2.2.2.2" xref="A1.I2.i3.p1.3.m3.2.2.2.2.2.cmml">
             y
            </mi>
            <mn id="A1.I2.i3.p1.3.m3.2.2.2.2.3" xref="A1.I2.i3.p1.3.m3.2.2.2.2.3.cmml">
             1
            </mn>
           </msub>
           <mo id="A1.I2.i3.p1.3.m3.6.6.6.9" xref="A1.I2.i3.p1.3.m3.6.6.7.cmml">
            ,
           </mo>
           <msub id="A1.I2.i3.p1.3.m3.3.3.3.3" xref="A1.I2.i3.p1.3.m3.3.3.3.3.cmml">
            <mi id="A1.I2.i3.p1.3.m3.3.3.3.3.2" xref="A1.I2.i3.p1.3.m3.3.3.3.3.2.cmml">
             z
            </mi>
            <mn id="A1.I2.i3.p1.3.m3.3.3.3.3.3" xref="A1.I2.i3.p1.3.m3.3.3.3.3.3.cmml">
             2
            </mn>
           </msub>
           <mo id="A1.I2.i3.p1.3.m3.6.6.6.10" xref="A1.I2.i3.p1.3.m3.6.6.7.cmml">
            ,
           </mo>
           <msub id="A1.I2.i3.p1.3.m3.4.4.4.4" xref="A1.I2.i3.p1.3.m3.4.4.4.4.cmml">
            <mi id="A1.I2.i3.p1.3.m3.4.4.4.4.2" xref="A1.I2.i3.p1.3.m3.4.4.4.4.2.cmml">
             y
            </mi>
            <mn id="A1.I2.i3.p1.3.m3.4.4.4.4.3" xref="A1.I2.i3.p1.3.m3.4.4.4.4.3.cmml">
             2
            </mn>
           </msub>
           <mo id="A1.I2.i3.p1.3.m3.6.6.6.11" xref="A1.I2.i3.p1.3.m3.6.6.7.cmml">
            ,
           </mo>
           <mrow id="A1.I2.i3.p1.3.m3.5.5.5.5" xref="A1.I2.i3.p1.3.m3.5.5.5.5.cmml">
            <mi id="A1.I2.i3.p1.3.m3.5.5.5.5.2" mathvariant="normal" xref="A1.I2.i3.p1.3.m3.5.5.5.5.2.cmml">
             …
            </mi>
            <mo id="A1.I2.i3.p1.3.m3.5.5.5.5.1" lspace="0em" rspace="0em" xref="A1.I2.i3.p1.3.m3.5.5.5.5.1.cmml">
             ​
            </mo>
            <msub id="A1.I2.i3.p1.3.m3.5.5.5.5.3" xref="A1.I2.i3.p1.3.m3.5.5.5.5.3.cmml">
             <mi id="A1.I2.i3.p1.3.m3.5.5.5.5.3.2" xref="A1.I2.i3.p1.3.m3.5.5.5.5.3.2.cmml">
              z
             </mi>
             <mi id="A1.I2.i3.p1.3.m3.5.5.5.5.3.3" xref="A1.I2.i3.p1.3.m3.5.5.5.5.3.3.cmml">
              n
             </mi>
            </msub>
           </mrow>
           <mo id="A1.I2.i3.p1.3.m3.6.6.6.12" xref="A1.I2.i3.p1.3.m3.6.6.7.cmml">
            ,
           </mo>
           <msub id="A1.I2.i3.p1.3.m3.6.6.6.6" xref="A1.I2.i3.p1.3.m3.6.6.6.6.cmml">
            <mi id="A1.I2.i3.p1.3.m3.6.6.6.6.2" xref="A1.I2.i3.p1.3.m3.6.6.6.6.2.cmml">
             y
            </mi>
            <mi id="A1.I2.i3.p1.3.m3.6.6.6.6.3" xref="A1.I2.i3.p1.3.m3.6.6.6.6.3.cmml">
             n
            </mi>
           </msub>
           <mo id="A1.I2.i3.p1.3.m3.6.6.6.13" stretchy="false" xref="A1.I2.i3.p1.3.m3.6.6.7.cmml">
            }
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i3.p1.3.m3.6b">
           <set id="A1.I2.i3.p1.3.m3.6.6.7.cmml" xref="A1.I2.i3.p1.3.m3.6.6.6">
            <apply id="A1.I2.i3.p1.3.m3.1.1.1.1.cmml" xref="A1.I2.i3.p1.3.m3.1.1.1.1">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.3.m3.1.1.1.1.1.cmml" xref="A1.I2.i3.p1.3.m3.1.1.1.1">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.3.m3.1.1.1.1.2.cmml" xref="A1.I2.i3.p1.3.m3.1.1.1.1.2">
              𝑧
             </ci>
             <cn id="A1.I2.i3.p1.3.m3.1.1.1.1.3.cmml" type="integer" xref="A1.I2.i3.p1.3.m3.1.1.1.1.3">
              1
             </cn>
            </apply>
            <apply id="A1.I2.i3.p1.3.m3.2.2.2.2.cmml" xref="A1.I2.i3.p1.3.m3.2.2.2.2">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.3.m3.2.2.2.2.1.cmml" xref="A1.I2.i3.p1.3.m3.2.2.2.2">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.3.m3.2.2.2.2.2.cmml" xref="A1.I2.i3.p1.3.m3.2.2.2.2.2">
              𝑦
             </ci>
             <cn id="A1.I2.i3.p1.3.m3.2.2.2.2.3.cmml" type="integer" xref="A1.I2.i3.p1.3.m3.2.2.2.2.3">
              1
             </cn>
            </apply>
            <apply id="A1.I2.i3.p1.3.m3.3.3.3.3.cmml" xref="A1.I2.i3.p1.3.m3.3.3.3.3">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.3.m3.3.3.3.3.1.cmml" xref="A1.I2.i3.p1.3.m3.3.3.3.3">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.3.m3.3.3.3.3.2.cmml" xref="A1.I2.i3.p1.3.m3.3.3.3.3.2">
              𝑧
             </ci>
             <cn id="A1.I2.i3.p1.3.m3.3.3.3.3.3.cmml" type="integer" xref="A1.I2.i3.p1.3.m3.3.3.3.3.3">
              2
             </cn>
            </apply>
            <apply id="A1.I2.i3.p1.3.m3.4.4.4.4.cmml" xref="A1.I2.i3.p1.3.m3.4.4.4.4">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.3.m3.4.4.4.4.1.cmml" xref="A1.I2.i3.p1.3.m3.4.4.4.4">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.3.m3.4.4.4.4.2.cmml" xref="A1.I2.i3.p1.3.m3.4.4.4.4.2">
              𝑦
             </ci>
             <cn id="A1.I2.i3.p1.3.m3.4.4.4.4.3.cmml" type="integer" xref="A1.I2.i3.p1.3.m3.4.4.4.4.3">
              2
             </cn>
            </apply>
            <apply id="A1.I2.i3.p1.3.m3.5.5.5.5.cmml" xref="A1.I2.i3.p1.3.m3.5.5.5.5">
             <times id="A1.I2.i3.p1.3.m3.5.5.5.5.1.cmml" xref="A1.I2.i3.p1.3.m3.5.5.5.5.1">
             </times>
             <ci id="A1.I2.i3.p1.3.m3.5.5.5.5.2.cmml" xref="A1.I2.i3.p1.3.m3.5.5.5.5.2">
              …
             </ci>
             <apply id="A1.I2.i3.p1.3.m3.5.5.5.5.3.cmml" xref="A1.I2.i3.p1.3.m3.5.5.5.5.3">
              <csymbol cd="ambiguous" id="A1.I2.i3.p1.3.m3.5.5.5.5.3.1.cmml" xref="A1.I2.i3.p1.3.m3.5.5.5.5.3">
               subscript
              </csymbol>
              <ci id="A1.I2.i3.p1.3.m3.5.5.5.5.3.2.cmml" xref="A1.I2.i3.p1.3.m3.5.5.5.5.3.2">
               𝑧
              </ci>
              <ci id="A1.I2.i3.p1.3.m3.5.5.5.5.3.3.cmml" xref="A1.I2.i3.p1.3.m3.5.5.5.5.3.3">
               𝑛
              </ci>
             </apply>
            </apply>
            <apply id="A1.I2.i3.p1.3.m3.6.6.6.6.cmml" xref="A1.I2.i3.p1.3.m3.6.6.6.6">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.3.m3.6.6.6.6.1.cmml" xref="A1.I2.i3.p1.3.m3.6.6.6.6">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.3.m3.6.6.6.6.2.cmml" xref="A1.I2.i3.p1.3.m3.6.6.6.6.2">
              𝑦
             </ci>
             <ci id="A1.I2.i3.p1.3.m3.6.6.6.6.3.cmml" xref="A1.I2.i3.p1.3.m3.6.6.6.6.3">
              𝑛
             </ci>
            </apply>
           </set>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i3.p1.3.m3.6c">
           \{z_{1},y_{1},z_{2},y_{2},\dots z_{n},y_{n}\}
          </annotation>
         </semantics>
        </math>
        be a token buffer consisting of all other messages (except the agent-generated messages)
        <math alttext="z_{n}\in X" class="ltx_Math" display="inline" id="A1.I2.i3.p1.4.m4.1">
         <semantics id="A1.I2.i3.p1.4.m4.1a">
          <mrow id="A1.I2.i3.p1.4.m4.1.1" xref="A1.I2.i3.p1.4.m4.1.1.cmml">
           <msub id="A1.I2.i3.p1.4.m4.1.1.2" xref="A1.I2.i3.p1.4.m4.1.1.2.cmml">
            <mi id="A1.I2.i3.p1.4.m4.1.1.2.2" xref="A1.I2.i3.p1.4.m4.1.1.2.2.cmml">
             z
            </mi>
            <mi id="A1.I2.i3.p1.4.m4.1.1.2.3" xref="A1.I2.i3.p1.4.m4.1.1.2.3.cmml">
             n
            </mi>
           </msub>
           <mo id="A1.I2.i3.p1.4.m4.1.1.1" xref="A1.I2.i3.p1.4.m4.1.1.1.cmml">
            ∈
           </mo>
           <mi id="A1.I2.i3.p1.4.m4.1.1.3" xref="A1.I2.i3.p1.4.m4.1.1.3.cmml">
            X
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i3.p1.4.m4.1b">
           <apply id="A1.I2.i3.p1.4.m4.1.1.cmml" xref="A1.I2.i3.p1.4.m4.1.1">
            <in id="A1.I2.i3.p1.4.m4.1.1.1.cmml" xref="A1.I2.i3.p1.4.m4.1.1.1">
            </in>
            <apply id="A1.I2.i3.p1.4.m4.1.1.2.cmml" xref="A1.I2.i3.p1.4.m4.1.1.2">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.4.m4.1.1.2.1.cmml" xref="A1.I2.i3.p1.4.m4.1.1.2">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.4.m4.1.1.2.2.cmml" xref="A1.I2.i3.p1.4.m4.1.1.2.2">
              𝑧
             </ci>
             <ci id="A1.I2.i3.p1.4.m4.1.1.2.3.cmml" xref="A1.I2.i3.p1.4.m4.1.1.2.3">
              𝑛
             </ci>
            </apply>
            <ci id="A1.I2.i3.p1.4.m4.1.1.3.cmml" xref="A1.I2.i3.p1.4.m4.1.1.3">
             𝑋
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i3.p1.4.m4.1c">
           z_{n}\in X
          </annotation>
         </semantics>
        </math>
        and trained agent-generated messages
        <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="A1.I2.i3.p1.5.m5.1">
         <semantics id="A1.I2.i3.p1.5.m5.1a">
          <msub id="A1.I2.i3.p1.5.m5.1.1" xref="A1.I2.i3.p1.5.m5.1.1.cmml">
           <mi id="A1.I2.i3.p1.5.m5.1.1.2" xref="A1.I2.i3.p1.5.m5.1.1.2.cmml">
            π
           </mi>
           <mi id="A1.I2.i3.p1.5.m5.1.1.3" xref="A1.I2.i3.p1.5.m5.1.1.3.cmml">
            θ
           </mi>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i3.p1.5.m5.1b">
           <apply id="A1.I2.i3.p1.5.m5.1.1.cmml" xref="A1.I2.i3.p1.5.m5.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i3.p1.5.m5.1.1.1.cmml" xref="A1.I2.i3.p1.5.m5.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i3.p1.5.m5.1.1.2.cmml" xref="A1.I2.i3.p1.5.m5.1.1.2">
             𝜋
            </ci>
            <ci id="A1.I2.i3.p1.5.m5.1.1.3.cmml" xref="A1.I2.i3.p1.5.m5.1.1.3">
             𝜃
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i3.p1.5.m5.1c">
           \pi_{\theta}
          </annotation>
         </semantics>
        </math>
        output
        <math alttext="y_{n}\in Y" class="ltx_Math" display="inline" id="A1.I2.i3.p1.6.m6.1">
         <semantics id="A1.I2.i3.p1.6.m6.1a">
          <mrow id="A1.I2.i3.p1.6.m6.1.1" xref="A1.I2.i3.p1.6.m6.1.1.cmml">
           <msub id="A1.I2.i3.p1.6.m6.1.1.2" xref="A1.I2.i3.p1.6.m6.1.1.2.cmml">
            <mi id="A1.I2.i3.p1.6.m6.1.1.2.2" xref="A1.I2.i3.p1.6.m6.1.1.2.2.cmml">
             y
            </mi>
            <mi id="A1.I2.i3.p1.6.m6.1.1.2.3" xref="A1.I2.i3.p1.6.m6.1.1.2.3.cmml">
             n
            </mi>
           </msub>
           <mo id="A1.I2.i3.p1.6.m6.1.1.1" xref="A1.I2.i3.p1.6.m6.1.1.1.cmml">
            ∈
           </mo>
           <mi id="A1.I2.i3.p1.6.m6.1.1.3" xref="A1.I2.i3.p1.6.m6.1.1.3.cmml">
            Y
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i3.p1.6.m6.1b">
           <apply id="A1.I2.i3.p1.6.m6.1.1.cmml" xref="A1.I2.i3.p1.6.m6.1.1">
            <in id="A1.I2.i3.p1.6.m6.1.1.1.cmml" xref="A1.I2.i3.p1.6.m6.1.1.1">
            </in>
            <apply id="A1.I2.i3.p1.6.m6.1.1.2.cmml" xref="A1.I2.i3.p1.6.m6.1.1.2">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.6.m6.1.1.2.1.cmml" xref="A1.I2.i3.p1.6.m6.1.1.2">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.6.m6.1.1.2.2.cmml" xref="A1.I2.i3.p1.6.m6.1.1.2.2">
              𝑦
             </ci>
             <ci id="A1.I2.i3.p1.6.m6.1.1.2.3.cmml" xref="A1.I2.i3.p1.6.m6.1.1.2.3">
              𝑛
             </ci>
            </apply>
            <ci id="A1.I2.i3.p1.6.m6.1.1.3.cmml" xref="A1.I2.i3.p1.6.m6.1.1.3">
             𝑌
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i3.p1.6.m6.1c">
           y_{n}\in Y
          </annotation>
         </semantics>
        </math>
        , then the binary mask
        <math alttext="m_{\text{policy}}=\{0,1,0,1,\dots 0,1\}" class="ltx_Math" display="inline" id="A1.I2.i3.p1.7.m7.6">
         <semantics id="A1.I2.i3.p1.7.m7.6a">
          <mrow id="A1.I2.i3.p1.7.m7.6.6" xref="A1.I2.i3.p1.7.m7.6.6.cmml">
           <msub id="A1.I2.i3.p1.7.m7.6.6.3" xref="A1.I2.i3.p1.7.m7.6.6.3.cmml">
            <mi id="A1.I2.i3.p1.7.m7.6.6.3.2" xref="A1.I2.i3.p1.7.m7.6.6.3.2.cmml">
             m
            </mi>
            <mtext id="A1.I2.i3.p1.7.m7.6.6.3.3" xref="A1.I2.i3.p1.7.m7.6.6.3.3a.cmml">
             policy
            </mtext>
           </msub>
           <mo id="A1.I2.i3.p1.7.m7.6.6.2" xref="A1.I2.i3.p1.7.m7.6.6.2.cmml">
            =
           </mo>
           <mrow id="A1.I2.i3.p1.7.m7.6.6.1.1" xref="A1.I2.i3.p1.7.m7.6.6.1.2.cmml">
            <mo id="A1.I2.i3.p1.7.m7.6.6.1.1.2" stretchy="false" xref="A1.I2.i3.p1.7.m7.6.6.1.2.cmml">
             {
            </mo>
            <mn id="A1.I2.i3.p1.7.m7.1.1" xref="A1.I2.i3.p1.7.m7.1.1.cmml">
             0
            </mn>
            <mo id="A1.I2.i3.p1.7.m7.6.6.1.1.3" xref="A1.I2.i3.p1.7.m7.6.6.1.2.cmml">
             ,
            </mo>
            <mn id="A1.I2.i3.p1.7.m7.2.2" xref="A1.I2.i3.p1.7.m7.2.2.cmml">
             1
            </mn>
            <mo id="A1.I2.i3.p1.7.m7.6.6.1.1.4" xref="A1.I2.i3.p1.7.m7.6.6.1.2.cmml">
             ,
            </mo>
            <mn id="A1.I2.i3.p1.7.m7.3.3" xref="A1.I2.i3.p1.7.m7.3.3.cmml">
             0
            </mn>
            <mo id="A1.I2.i3.p1.7.m7.6.6.1.1.5" xref="A1.I2.i3.p1.7.m7.6.6.1.2.cmml">
             ,
            </mo>
            <mn id="A1.I2.i3.p1.7.m7.4.4" xref="A1.I2.i3.p1.7.m7.4.4.cmml">
             1
            </mn>
            <mo id="A1.I2.i3.p1.7.m7.6.6.1.1.6" xref="A1.I2.i3.p1.7.m7.6.6.1.2.cmml">
             ,
            </mo>
            <mrow id="A1.I2.i3.p1.7.m7.6.6.1.1.1" xref="A1.I2.i3.p1.7.m7.6.6.1.1.1.cmml">
             <mi id="A1.I2.i3.p1.7.m7.6.6.1.1.1.2" mathvariant="normal" xref="A1.I2.i3.p1.7.m7.6.6.1.1.1.2.cmml">
              …
             </mi>
             <mo id="A1.I2.i3.p1.7.m7.6.6.1.1.1.1" lspace="0em" rspace="0em" xref="A1.I2.i3.p1.7.m7.6.6.1.1.1.1.cmml">
              ​
             </mo>
             <mn id="A1.I2.i3.p1.7.m7.6.6.1.1.1.3" xref="A1.I2.i3.p1.7.m7.6.6.1.1.1.3.cmml">
              0
             </mn>
            </mrow>
            <mo id="A1.I2.i3.p1.7.m7.6.6.1.1.7" xref="A1.I2.i3.p1.7.m7.6.6.1.2.cmml">
             ,
            </mo>
            <mn id="A1.I2.i3.p1.7.m7.5.5" xref="A1.I2.i3.p1.7.m7.5.5.cmml">
             1
            </mn>
            <mo id="A1.I2.i3.p1.7.m7.6.6.1.1.8" stretchy="false" xref="A1.I2.i3.p1.7.m7.6.6.1.2.cmml">
             }
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i3.p1.7.m7.6b">
           <apply id="A1.I2.i3.p1.7.m7.6.6.cmml" xref="A1.I2.i3.p1.7.m7.6.6">
            <eq id="A1.I2.i3.p1.7.m7.6.6.2.cmml" xref="A1.I2.i3.p1.7.m7.6.6.2">
            </eq>
            <apply id="A1.I2.i3.p1.7.m7.6.6.3.cmml" xref="A1.I2.i3.p1.7.m7.6.6.3">
             <csymbol cd="ambiguous" id="A1.I2.i3.p1.7.m7.6.6.3.1.cmml" xref="A1.I2.i3.p1.7.m7.6.6.3">
              subscript
             </csymbol>
             <ci id="A1.I2.i3.p1.7.m7.6.6.3.2.cmml" xref="A1.I2.i3.p1.7.m7.6.6.3.2">
              𝑚
             </ci>
             <ci id="A1.I2.i3.p1.7.m7.6.6.3.3a.cmml" xref="A1.I2.i3.p1.7.m7.6.6.3.3">
              <mtext id="A1.I2.i3.p1.7.m7.6.6.3.3.cmml" mathsize="70%" xref="A1.I2.i3.p1.7.m7.6.6.3.3">
               policy
              </mtext>
             </ci>
            </apply>
            <set id="A1.I2.i3.p1.7.m7.6.6.1.2.cmml" xref="A1.I2.i3.p1.7.m7.6.6.1.1">
             <cn id="A1.I2.i3.p1.7.m7.1.1.cmml" type="integer" xref="A1.I2.i3.p1.7.m7.1.1">
              0
             </cn>
             <cn id="A1.I2.i3.p1.7.m7.2.2.cmml" type="integer" xref="A1.I2.i3.p1.7.m7.2.2">
              1
             </cn>
             <cn id="A1.I2.i3.p1.7.m7.3.3.cmml" type="integer" xref="A1.I2.i3.p1.7.m7.3.3">
              0
             </cn>
             <cn id="A1.I2.i3.p1.7.m7.4.4.cmml" type="integer" xref="A1.I2.i3.p1.7.m7.4.4">
              1
             </cn>
             <apply id="A1.I2.i3.p1.7.m7.6.6.1.1.1.cmml" xref="A1.I2.i3.p1.7.m7.6.6.1.1.1">
              <times id="A1.I2.i3.p1.7.m7.6.6.1.1.1.1.cmml" xref="A1.I2.i3.p1.7.m7.6.6.1.1.1.1">
              </times>
              <ci id="A1.I2.i3.p1.7.m7.6.6.1.1.1.2.cmml" xref="A1.I2.i3.p1.7.m7.6.6.1.1.1.2">
               …
              </ci>
              <cn id="A1.I2.i3.p1.7.m7.6.6.1.1.1.3.cmml" type="integer" xref="A1.I2.i3.p1.7.m7.6.6.1.1.1.3">
               0
              </cn>
             </apply>
             <cn id="A1.I2.i3.p1.7.m7.5.5.cmml" type="integer" xref="A1.I2.i3.p1.7.m7.5.5">
              1
             </cn>
            </set>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i3.p1.7.m7.6c">
           m_{\text{policy}}=\{0,1,0,1,\dots 0,1\}
          </annotation>
         </semantics>
        </math>
        .
       </p>
      </div>
     </li>
     <li class="ltx_item" id="A1.I2.i4" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="A1.I2.i4.p1">
       <p class="ltx_p" id="A1.I2.i4.p1.2">
        <math alttext="\mathcal{L}_{\text{entropy}}" class="ltx_Math" display="inline" id="A1.I2.i4.p1.1.m1.1">
         <semantics id="A1.I2.i4.p1.1.m1.1a">
          <msub id="A1.I2.i4.p1.1.m1.1.1" xref="A1.I2.i4.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A1.I2.i4.p1.1.m1.1.1.2" xref="A1.I2.i4.p1.1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mtext id="A1.I2.i4.p1.1.m1.1.1.3" xref="A1.I2.i4.p1.1.m1.1.1.3a.cmml">
            entropy
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i4.p1.1.m1.1b">
           <apply id="A1.I2.i4.p1.1.m1.1.1.cmml" xref="A1.I2.i4.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A1.I2.i4.p1.1.m1.1.1.1.cmml" xref="A1.I2.i4.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A1.I2.i4.p1.1.m1.1.1.2.cmml" xref="A1.I2.i4.p1.1.m1.1.1.2">
             ℒ
            </ci>
            <ci id="A1.I2.i4.p1.1.m1.1.1.3a.cmml" xref="A1.I2.i4.p1.1.m1.1.1.3">
             <mtext id="A1.I2.i4.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.I2.i4.p1.1.m1.1.1.3">
              entropy
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i4.p1.1.m1.1c">
           \mathcal{L}_{\text{entropy}}
          </annotation>
         </semantics>
        </math>
        is an entropy bonus to ensure sufficient exploration, as suggested in past work
        <cite class="ltx_cite ltx_citemacro_citep">
         [
         <a class="ltx_ref" href="#bib.bib63" title="">
          63
         </a>
         ;
         <a class="ltx_ref" href="#bib.bib25" title="">
          25
         </a>
         ]
        </cite>
        . This entropy is computed as a small negative factor times the entropy of the policy distribution :
        <math alttext="\mathcal{L}_{\text{entropy}}=0.01\times\sum_{a}\pi_{\theta}(a|s)\log\pi_{\theta}(a|s)" class="ltx_Math" display="inline" id="A1.I2.i4.p1.2.m2.2">
         <semantics id="A1.I2.i4.p1.2.m2.2a">
          <mrow id="A1.I2.i4.p1.2.m2.2.2" xref="A1.I2.i4.p1.2.m2.2.2.cmml">
           <msub id="A1.I2.i4.p1.2.m2.2.2.4" xref="A1.I2.i4.p1.2.m2.2.2.4.cmml">
            <mi class="ltx_font_mathcaligraphic" id="A1.I2.i4.p1.2.m2.2.2.4.2" xref="A1.I2.i4.p1.2.m2.2.2.4.2.cmml">
             ℒ
            </mi>
            <mtext id="A1.I2.i4.p1.2.m2.2.2.4.3" xref="A1.I2.i4.p1.2.m2.2.2.4.3a.cmml">
             entropy
            </mtext>
           </msub>
           <mo id="A1.I2.i4.p1.2.m2.2.2.3" xref="A1.I2.i4.p1.2.m2.2.2.3.cmml">
            =
           </mo>
           <mrow id="A1.I2.i4.p1.2.m2.2.2.2" xref="A1.I2.i4.p1.2.m2.2.2.2.cmml">
            <mn id="A1.I2.i4.p1.2.m2.2.2.2.4" xref="A1.I2.i4.p1.2.m2.2.2.2.4.cmml">
             0.01
            </mn>
            <mo id="A1.I2.i4.p1.2.m2.2.2.2.3" lspace="0.222em" rspace="0.055em" xref="A1.I2.i4.p1.2.m2.2.2.2.3.cmml">
             ×
            </mo>
            <mrow id="A1.I2.i4.p1.2.m2.2.2.2.2" xref="A1.I2.i4.p1.2.m2.2.2.2.2.cmml">
             <msub id="A1.I2.i4.p1.2.m2.2.2.2.2.3" xref="A1.I2.i4.p1.2.m2.2.2.2.2.3.cmml">
              <mo id="A1.I2.i4.p1.2.m2.2.2.2.2.3.2" xref="A1.I2.i4.p1.2.m2.2.2.2.2.3.2.cmml">
               ∑
              </mo>
              <mi id="A1.I2.i4.p1.2.m2.2.2.2.2.3.3" xref="A1.I2.i4.p1.2.m2.2.2.2.2.3.3.cmml">
               a
              </mi>
             </msub>
             <mrow id="A1.I2.i4.p1.2.m2.2.2.2.2.2" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.cmml">
              <msub id="A1.I2.i4.p1.2.m2.2.2.2.2.2.4" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.cmml">
               <mi id="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.2" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.2.cmml">
                π
               </mi>
               <mi id="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.3" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.3.cmml">
                θ
               </mi>
              </msub>
              <mo id="A1.I2.i4.p1.2.m2.2.2.2.2.2.3" lspace="0em" rspace="0em" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.cmml">
               <mo id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.cmml">
                <mi id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.2" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml">
                 a
                </mi>
                <mo fence="false" id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.1" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml">
                 |
                </mo>
                <mi id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.3" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml">
                 s
                </mi>
               </mrow>
               <mo id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
              <mo id="A1.I2.i4.p1.2.m2.2.2.2.2.2.3a" lspace="0.167em" rspace="0em" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.cmml">
               <mi id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.1" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.1.cmml">
                log
               </mi>
               <mo id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5a" lspace="0.167em" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.cmml">
                ⁡
               </mo>
               <msub id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.cmml">
                <mi id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.2" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.2.cmml">
                 π
                </mi>
                <mi id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.3" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.3.cmml">
                 θ
                </mi>
               </msub>
              </mrow>
              <mo id="A1.I2.i4.p1.2.m2.2.2.2.2.2.3b" lspace="0em" rspace="0em" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.cmml">
               <mo id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.2" stretchy="false" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.cmml">
                (
               </mo>
               <mrow id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.cmml">
                <mi id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.2" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.2.cmml">
                 a
                </mi>
                <mo fence="false" id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.1" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.1.cmml">
                 |
                </mo>
                <mi id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.3" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.3.cmml">
                 s
                </mi>
               </mrow>
               <mo id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.3" stretchy="false" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.I2.i4.p1.2.m2.2b">
           <apply id="A1.I2.i4.p1.2.m2.2.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2">
            <eq id="A1.I2.i4.p1.2.m2.2.2.3.cmml" xref="A1.I2.i4.p1.2.m2.2.2.3">
            </eq>
            <apply id="A1.I2.i4.p1.2.m2.2.2.4.cmml" xref="A1.I2.i4.p1.2.m2.2.2.4">
             <csymbol cd="ambiguous" id="A1.I2.i4.p1.2.m2.2.2.4.1.cmml" xref="A1.I2.i4.p1.2.m2.2.2.4">
              subscript
             </csymbol>
             <ci id="A1.I2.i4.p1.2.m2.2.2.4.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.4.2">
              ℒ
             </ci>
             <ci id="A1.I2.i4.p1.2.m2.2.2.4.3a.cmml" xref="A1.I2.i4.p1.2.m2.2.2.4.3">
              <mtext id="A1.I2.i4.p1.2.m2.2.2.4.3.cmml" mathsize="70%" xref="A1.I2.i4.p1.2.m2.2.2.4.3">
               entropy
              </mtext>
             </ci>
            </apply>
            <apply id="A1.I2.i4.p1.2.m2.2.2.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2">
             <times id="A1.I2.i4.p1.2.m2.2.2.2.3.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.3">
             </times>
             <cn id="A1.I2.i4.p1.2.m2.2.2.2.4.cmml" type="float" xref="A1.I2.i4.p1.2.m2.2.2.2.4">
              0.01
             </cn>
             <apply id="A1.I2.i4.p1.2.m2.2.2.2.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2">
              <apply id="A1.I2.i4.p1.2.m2.2.2.2.2.3.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.3">
               <csymbol cd="ambiguous" id="A1.I2.i4.p1.2.m2.2.2.2.2.3.1.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.3">
                subscript
               </csymbol>
               <sum id="A1.I2.i4.p1.2.m2.2.2.2.2.3.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.3.2">
               </sum>
               <ci id="A1.I2.i4.p1.2.m2.2.2.2.2.3.3.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.3.3">
                𝑎
               </ci>
              </apply>
              <apply id="A1.I2.i4.p1.2.m2.2.2.2.2.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2">
               <times id="A1.I2.i4.p1.2.m2.2.2.2.2.2.3.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.3">
               </times>
               <apply id="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.4">
                <csymbol cd="ambiguous" id="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.1.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.4">
                 subscript
                </csymbol>
                <ci id="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.2">
                 𝜋
                </ci>
                <ci id="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.3.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.4.3">
                 𝜃
                </ci>
               </apply>
               <apply id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1">
                <csymbol cd="latexml" id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.1">
                 conditional
                </csymbol>
                <ci id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.2">
                 𝑎
                </ci>
                <ci id="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.I2.i4.p1.2.m2.1.1.1.1.1.1.1.1.3">
                 𝑠
                </ci>
               </apply>
               <apply id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5">
                <log id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.1.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.1">
                </log>
                <apply id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2">
                 <csymbol cd="ambiguous" id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.1.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2">
                  subscript
                 </csymbol>
                 <ci id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.2">
                  𝜋
                 </ci>
                 <ci id="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.3.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.5.2.3">
                  𝜃
                 </ci>
                </apply>
               </apply>
               <apply id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1">
                <csymbol cd="latexml" id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.1.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.1">
                 conditional
                </csymbol>
                <ci id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.2.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.2">
                 𝑎
                </ci>
                <ci id="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.3.cmml" xref="A1.I2.i4.p1.2.m2.2.2.2.2.2.2.1.1.3">
                 𝑠
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.I2.i4.p1.2.m2.2c">
           \mathcal{L}_{\text{entropy}}=0.01\times\sum_{a}\pi_{\theta}(a|s)\log\pi_{\theta}(a|s)
          </annotation>
         </semantics>
        </math>
        .
       </p>
      </div>
     </li>
    </ul>
   </div>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.5
    </span>
    Implementation detail
   </h3>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS6">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.6
    </span>
    Asynchronously Distributed Generating
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS6.p1">
    <p class="ltx_p" id="A1.SS6.p1.1">
     The exploration data is generated in an asynchronous style, so that the agent can handle the environments with open-end exploration space. The training data are pre-processed into interactive environments which are capable for agents to observe the states, take actions, and get immediate feedback. According to the number of GPU threads, these environments are divided into corresponding portions and then distributed to each GPU. Subsequently, these GPUs begin to explore these environments asynchronously in parallel with the same agent trained by the latest data. Since the lengths of the generated contents are varied and the interactions inside the environments are generally open-ended, the time cost for the agent to explore each environment is also varied, some GPU threads may process the data faster than others. A barrier is set for all the GPU threads so that the early finished GPU threads can wait for the others until the total accumulated buffers generated by the environments achieve a preset number
     <math alttext="S_{g}" class="ltx_Math" display="inline" id="A1.SS6.p1.1.m1.1">
      <semantics id="A1.SS6.p1.1.m1.1a">
       <msub id="A1.SS6.p1.1.m1.1.1" xref="A1.SS6.p1.1.m1.1.1.cmml">
        <mi id="A1.SS6.p1.1.m1.1.1.2" xref="A1.SS6.p1.1.m1.1.1.2.cmml">
         S
        </mi>
        <mi id="A1.SS6.p1.1.m1.1.1.3" xref="A1.SS6.p1.1.m1.1.1.3.cmml">
         g
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS6.p1.1.m1.1b">
        <apply id="A1.SS6.p1.1.m1.1.1.cmml" xref="A1.SS6.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="A1.SS6.p1.1.m1.1.1.1.cmml" xref="A1.SS6.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS6.p1.1.m1.1.1.2.cmml" xref="A1.SS6.p1.1.m1.1.1.2">
          𝑆
         </ci>
         <ci id="A1.SS6.p1.1.m1.1.1.3.cmml" xref="A1.SS6.p1.1.m1.1.1.3">
          𝑔
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS6.p1.1.m1.1c">
        S_{g}
       </annotation>
      </semantics>
     </math>
     , which is the quantity of the new training buffers we want to add to the replay buffers in one iteration. After all the GPU threads reach the barrier, we get enough buffers then gather the buffers from each GPU thread and merge them together, and broadcast the new buffers to each GPU thread to update their local replay buffers. The updated replay buffers will be used in the training phase for training the agents of the next iteration.
    </p>
   </div>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS7">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.7
    </span>
    Baselines
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS7.p1">
    <p class="ltx_p" id="A1.SS7.p1.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS7.p1.1.1">
      ReAct
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib65" title="">
       65
      </a>
      ]
     </cite>
     uses a subset of training cases as prompts for different tasks, in the format of thought-action-observation sequences. For knowledge-intensive reasoning tasks like
     <span class="ltx_text ltx_font_italic" id="A1.SS7.p1.1.2">
      HotpotQA
     </span>
     , ReAct designs an action space that includes search, lookup, and finish actions, enabling the agent to interact with Wikipedia to retrieve necessary information.
On the other hand,
     <span class="ltx_text ltx_font_bold" id="A1.SS7.p1.1.3">
      ReAct-IM
     </span>
     adopts Inner Monologue (IM)
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib16" title="">
       16
      </a>
      ]
     </cite>
     style prompting. Chain-of-thought prompting (
     <span class="ltx_text ltx_font_bold" id="A1.SS7.p1.1.4">
      CoT
     </span>
     )
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib61" title="">
       61
      </a>
      ]
     </cite>
     , enhances the reasoning capabilities of Language and Vision models (LLMs) by generating a sequence of intermediate reasoning steps. This can be considered as a reasoning-only baseline of ReAct, excluding actions and observations. Additionally,
     <span class="ltx_text ltx_font_bold" id="A1.SS7.p1.1.5">
      CoT-SC
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib55" title="">
       55
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib56" title="">
       56
      </a>
      ]
     </cite>
     is a follow-up work of CoT, serving as a self-consistency baseline. It is worth noting that most of these methods employ greedy decoding, except for BUTLER
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib24" title="">
       24
      </a>
      ]
     </cite>
     , which utilizes beam search. Most of these methods focus on few-shot prompting, and different pre-trained models are used. To ensure a fair comparison, we include the additional baselines named ReAct-Tuning and CoT-Tuning by fine-tuning the LLaMA-7B model using the collected trajectories as fine-tuning data mentioned in
     <a class="ltx_ref" href="#S4.SS2.SSS0.Px2" title="Agent Pre-training ‣ 4.2 Settings ‣ 4 Experiments ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       4.2
      </span>
     </a>
     . In addition, GPT-4 are not used in the test time, and all the results reported are obtained by the trained agent itself.
    </p>
   </div>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS8">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.8
    </span>
    Losses
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS8.p1">
    <p class="ltx_p" id="A1.SS8.p1.1">
     We conducted ablation studies on the loss design of LTC. Figure Figure
     <a class="ltx_ref" href="#S5.F6" title="Figure 6 ‣ Efficiency ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     illustrates the success rate of agents on the
     <span class="ltx_text ltx_font_italic" id="A1.SS8.p1.1.1">
      ALFWorld
     </span>
     dataset under different loss settings. Without using our communication pattern for interactions and merely sampling pre-collected instruction data for training, the improvement was limited. However, when we incorporated our communication pattern to gather data, the model’s performance quickly surpassed 80%.
Furthermore, employing PPO loss to handle positive and negative samples separately resulted in faster and more significant improvement (blue line).
In Figure Figure
     <a class="ltx_ref" href="#S5.F6" title="Figure 6 ‣ Efficiency ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     , we present the separate curves of the three main losses during training. Initially, the LM loss showed a decreasing trend. Interestingly, as training iterations progressed, both the value loss and policy loss gradually decreased, which possibly causes the LM loss to increase temporarily. After the value loss and policy loss reached a certain threshold, the LM loss continued to decrease till convergence.
    </p>
   </div>
   <figure class="ltx_figure" id="A1.F8">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="431" id="A1.F8.g1" src="/html/2310.01444/assets/figures/teaser_text.png" width="764"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 8:
     </span>
     The text version of the toy example in  Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     for Monologue pattern of ALFWorld.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection ltx_indent_first" id="A1.SS9">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.9
    </span>
    Cases study
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS9.p1">
    <p class="ltx_p" id="A1.SS9.p1.1">
     One interesting observations is that the GPT-4 agent sometimes employs ”shortcuts” to solve problems when serving as a teacher to generate new training data. These shortcuts rely on the internal knowledge acquired during its pretraining process. To illustrate this, we present a case study from
     <span class="ltx_text ltx_font_italic" id="A1.SS9.p1.1.1">
      HotpotQA
     </span>
     in Figure Figure
     <a class="ltx_ref" href="#S5.F7" title="Figure 7 ‣ Shortcuts ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     . In this case, the GPT-4 agent quickly retrieves the answer by leveraging its memorized knowledge about the second entry after receiving the Wikipedia page of the first entry. On the other hand, the bottom of Figure Figure
     <a class="ltx_ref" href="#S5.F7" title="Figure 7 ‣ Shortcuts ‣ 5 Discussion ‣ Adapting LLM Agents Through Communication">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     demonstrates a comparison with LLaMA-7B, which was trained using our LTC method with the GPT-4 agent in the loop. LLaMA-7B does not employ shortcuts and instead performs a search for the second entry. This case study demonstrates that communication mechanism in LTC provide additional benefits during learning, compared to soley relying on data generated by GPT-4.
    </p>
   </div>
   <div class="ltx_pagination ltx_role_newpage">
   </div>
  </section>
 </section>
</article>
