<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2302.07450] FedABC: Targeting Fair Competition in Personalized Federated Learning</title><meta property="og:description" content="Federated learning aims to collaboratively train models without accessing their client’s local private data. The data may be Non-IID for different clients and thus resulting in poor performance. Recently, personalized …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedABC: Targeting Fair Competition in Personalized Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedABC: Targeting Fair Competition in Personalized Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2302.07450">

<!--Generated on Fri Mar  1 00:46:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedABC: Targeting Fair Competition in Personalized Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Dui Wang<sup id="id1.1.id1" class="ltx_sup">1,2,3</sup><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>This work was done when Dui Wang was a research intern at JD Explore Academy.</span></span></span>,
Li Shen <sup id="id2.2.id2" class="ltx_sup">3</sup>,
Yong Luo<sup id="id3.3.id3" class="ltx_sup">1,2</sup>,
Han Hu <sup id="id4.4.id4" class="ltx_sup">4</sup>,
Kehua Su<sup id="id5.5.id5" class="ltx_sup">1</sup><span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Corrsponding Author.</span></span></span>,
Yonggang Wen<sup id="id6.6.id6" class="ltx_sup">5</sup>,
Dacheng Tao <sup id="id7.7.id7" class="ltx_sup">3</sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p">Federated learning aims to collaboratively train models without accessing their client’s local private data. The data may be Non-IID for different clients and thus resulting in poor performance. Recently, personalized federated learning (PFL) has achieved great success in handling Non-IID data by enforcing regularization in local optimization or improving the model aggregation scheme on the server. However, most of the PFL approaches do not take into account the unfair competition issue caused by the imbalanced data distribution and lack of positive samples for some classes in each client. To address this issue, we propose a novel and generic PFL framework termed Federated Averaging via Binary Classification, dubbed FedABC. In particular, we adopt the “one-vs-all” training strategy in each client to alleviate the unfair competition between classes by constructing a personalized binary classification problem for each class. This may aggravate the class imbalance challenge and thus a novel personalized binary classification loss that incorporates both the under-sampling and hard sample mining strategies is designed. Extensive experiments are conducted on two popular datasets under different settings, and the results demonstrate that our FedABC can significantly outperform the existing counterparts.</p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Federated learning (FL) is an emerging machine learning paradigm that trains an algorithm across multiple decentralized clients (such as edge devices) or servers without exchanging local data samples <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite>. In this big data era, large-scale data are becoming increasingly popular, but also suffer the risk of data leakage. FL aims at addressing this issue by letting the clients update models using private data and the server periodically aggregate these models for multiple communication rounds. Such decentralized learning has shown its great potential to facilitate real-world applications, including healthcare <cite class="ltx_cite ltx_citemacro_citep">(Xu et al. <a href="#bib.bib49" title="" class="ltx_ref">2021</a>)</cite>, user verification <cite class="ltx_cite ltx_citemacro_citep">(Hosseini et al. <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite> and the Internet of Things (IoT) <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al. <a href="#bib.bib54" title="" class="ltx_ref">2022</a>; Huang et al. <a href="#bib.bib19" title="" class="ltx_ref">2022a</a>)</cite>.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">A key challenge in federated learning is the training given non-independent and identically distributed (non-i.i.d.) data <cite class="ltx_cite ltx_citemacro_citep">(Hsieh et al. <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. Due to the varied data distributions among different clients, the single global model (GM) obtained by simple averaging is hard to cater for all heterogeneous clients. Besides, clients update the global model on their local dataset, making local model misaligned and leading to weight divergence <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al. <a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite>. These issues have been found to result in unstable and slow convergence <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite> and even extremely poor performance <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib30" title="" class="ltx_ref">2021a</a>)</cite>.</p>
</div>
<figure id="Sx1.F1" class="ltx_figure"><img src="/html/2302.07450/assets/x1.png" id="Sx1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="307" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An illustration of different situations of data distributions in FL: (a) ideal i.i.d; (b) long-tail; (c) and (d) lack of positive samples for some classes.</figcaption>
</figure>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">To deal with heterogeneity in FL, numerous solutions have been proposed, such as the ones that constrain the direction of local model update to align the local and global optimization objectives <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib32" title="" class="ltx_ref">2020</a>; Karimireddy et al. <a href="#bib.bib24" title="" class="ltx_ref">2020</a>; Acar et al. <a href="#bib.bib1" title="" class="ltx_ref">2021</a>; Zhang et al. <a href="#bib.bib52" title="" class="ltx_ref">2022</a>; Liu et al. <a href="#bib.bib35" title="" class="ltx_ref">2022</a>)</cite>. Personalized federated learning (PFL) <cite class="ltx_cite ltx_citemacro_citep">(Smith et al. <a href="#bib.bib41" title="" class="ltx_ref">2017</a>; Huang et al. <a href="#bib.bib20" title="" class="ltx_ref">2022b</a>; Dai et al. <a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite> is a promising solution to addresses this challenge by jointly learning multiple personalized models (PMs), one for each client. For instance, references <cite class="ltx_cite ltx_citemacro_citep">(Collins et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>; Liang et al. <a href="#bib.bib33" title="" class="ltx_ref">2020</a>; Sun et al. <a href="#bib.bib42" title="" class="ltx_ref">2021</a>)</cite> exploit flexible parameter sharing strategies that only transmit partial model parameters, and the local models are regularized using a learnable global model <cite class="ltx_cite ltx_citemacro_citep">(T Dinh, Tran, and Nguyen <a href="#bib.bib43" title="" class="ltx_ref">2020</a>; Hanzely et al. <a href="#bib.bib12" title="" class="ltx_ref">2020</a>; Li et al. <a href="#bib.bib31" title="" class="ltx_ref">2021b</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citet">Dai et al. (<a href="#bib.bib8" title="" class="ltx_ref">2022</a>); Huang et al. (<a href="#bib.bib20" title="" class="ltx_ref">2022b</a>)</cite> adopt sparse training to achieve personalization.</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">However, all these approaches merely conduct an extra regularization or improve the aggregation strategy, which ignore some extraordinary situations of data distribution (see Figure <a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) that often exist in FL clients. The situations can be divided into two categories: 1) imbalanced class distribution <cite class="ltx_cite ltx_citemacro_citep">(He and Garcia <a href="#bib.bib14" title="" class="ltx_ref">2009</a>)</cite>, where some classes have much more/less samples than others; 2) lacking positive samples for some classes,
and the probability of occurrence increases with the degree of heterogeneity.
In these extreme cases, if the ubiquitous Softmax function (together with cross-entropy loss) <cite class="ltx_cite ltx_citemacro_citep">(Jang, Gu, and Poole <a href="#bib.bib21" title="" class="ltx_ref">2016</a>)</cite> is adopted, the normalization would enforce all the class logits summed to one, and thus induce competition among different classes. That is, increasing the confidence of one class will necessarily decrease the confidence of some other classes.
This can easily lead to over-confident predictions <cite class="ltx_cite ltx_citemacro_citep">(Guo et al. <a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite> for dominated classes, sub-optimal performance for minority classes and extremely poor performance for classes that lack positive samples (see Figure <a href="#Sx1.F2" title="Figure 2 ‣ Introduction ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). Although communicating with the server can alleviate this issue to some extent, the neural weights of each model can be randomly permuted and thus hard to fully assemble knowledge of all clients. Besides, the classes that have poor performance in local models are hard to achieve promising global performance by indiscriminately point-wise-averaging.</p>
</div>
<figure id="Sx1.F2" class="ltx_figure"><img src="/html/2302.07450/assets/x2.png" id="Sx1.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="259" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An illustration of the poor performance for some classes that have few or no positive samples. The middle and last columns are results after <math id="Sx1.F2.4.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="Sx1.F2.4.m1.1b"><mn id="Sx1.F2.4.m1.1.1" xref="Sx1.F2.4.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="Sx1.F2.4.m1.1c"><cn type="integer" id="Sx1.F2.4.m1.1.1.cmml" xref="Sx1.F2.4.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F2.4.m1.1d">10</annotation></semantics></math> and <math id="Sx1.F2.5.m2.1" class="ltx_Math" alttext="50" display="inline"><semantics id="Sx1.F2.5.m2.1b"><mn id="Sx1.F2.5.m2.1.1" xref="Sx1.F2.5.m2.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="Sx1.F2.5.m2.1c"><cn type="integer" id="Sx1.F2.5.m2.1.1.cmml" xref="Sx1.F2.5.m2.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F2.5.m2.1d">50</annotation></semantics></math> rounds of global aggregation and local updating, respectively.</figcaption>
</figure>
<div id="Sx1.p5" class="ltx_para">
<p id="Sx1.p5.2" class="ltx_p">To address the unfair competition between classes in FL clients,
we propose a novel method that boosts the performance of standard PFL termed <span id="Sx1.p5.2.1" class="ltx_text ltx_font_bold">Fed</span>erated <span id="Sx1.p5.2.2" class="ltx_text ltx_font_bold">A</span>veraging via <span id="Sx1.p5.2.3" class="ltx_text ltx_font_bold">B</span>inary <span id="Sx1.p5.2.4" class="ltx_text ltx_font_bold">C</span>lassification (FedABC), which adopts the well-known “one-vs-all” strategy <cite class="ltx_cite ltx_citemacro_citep">(Rifkin and Klautau <a href="#bib.bib38" title="" class="ltx_ref">2004</a>; Wen et al. <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite> to reduce the unfair competition among classes and focus more on personalized classes. Different from the traditional multi-class classification training based on Softmax, our FedABC performs binary classification for each category, where the feature extractors are shared for different classes.
In particular, given <math id="Sx1.p5.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx1.p5.1.m1.1a"><mi id="Sx1.p5.1.m1.1.1" xref="Sx1.p5.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx1.p5.1.m1.1b"><ci id="Sx1.p5.1.m1.1.1.cmml" xref="Sx1.p5.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p5.1.m1.1c">K</annotation></semantics></math> classes in the training set, FedABC constructs <math id="Sx1.p5.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx1.p5.2.m2.1a"><mi id="Sx1.p5.2.m2.1.1" xref="Sx1.p5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx1.p5.2.m2.1b"><ci id="Sx1.p5.2.m2.1.1.cmml" xref="Sx1.p5.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p5.2.m2.1c">K</annotation></semantics></math> binary classification problems, where data from the target class are treated as positive samples and data from the remaining classes are treated as negative samples. By employing this strategy, the classes that have few or even no positive samples will not be suppressed by the majority categories in the prediction, and thus can be liberated from unfair competition.
This enables us to focus on each class and personally deal with its issue of either data imbalancing or lacking of positive samples,
which is tackled by designing a novel and effective binary loss function that incorporates both the under-sampling <cite class="ltx_cite ltx_citemacro_citep">(Yen and Lee <a href="#bib.bib50" title="" class="ltx_ref">2009</a>)</cite> and hard-sample mining <cite class="ltx_cite ltx_citemacro_citep">(Schroff, Kalenichenko, and Philbin <a href="#bib.bib39" title="" class="ltx_ref">2015</a>; Wu et al. <a href="#bib.bib48" title="" class="ltx_ref">2017</a>)</cite> strategies. These strategies focus on the learning of hard samples and reducing the impact of easy samples.</p>
</div>
<div id="Sx1.p6" class="ltx_para">
<p id="Sx1.p6.1" class="ltx_p">To summarize, the main contributions of this paper are:</p>
<ul id="Sx1.I1" class="ltx_itemize">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">We propose a novel FL method termed FedABC that adopts a binary classification strategy to increase personality of the learning for each class and liberate the different classes from unfair competition for the heterogeneous clients;</p>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">We design an effective binary loss function to alleviate the imbalanced data and insufficient positive sample issues by incorporating both the hard-sample mining and under-sampling strategies.</p>
</div>
</li>
</ul>
<p id="Sx1.p6.2" class="ltx_p">We conduct extensive experiments on two popular visual datasets (CIFAR-10 and MNIST) under four heterogeneity settings. The results demonstrate the effectiveness of the proposed FedABC over the competitive baselines.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related work</h2>

<section id="Sx2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Federated learning</h4>

<div id="Sx2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="Sx2.SS0.SSS0.Px1.p1.1" class="ltx_p">is a machine learning paradigm that aims to collaboratively learn a model via
coordinated communication with multiple clients, which do not access to the client’s local data. FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite>, a well-known FL algorithm, learns a global model by simple averaging the local models. A variety of recent works have proposed for FL and achieved promising results. For example,  <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib32" title="" class="ltx_ref">2020</a>; Karimireddy et al. <a href="#bib.bib24" title="" class="ltx_ref">2020</a>; Acar et al. <a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite> add regularization term to restrain the client’s training process from moving too far and thus alleviate client drift. Personalized Federated Learning (PFL) <cite class="ltx_cite ltx_citemacro_citep">(Smith et al. <a href="#bib.bib41" title="" class="ltx_ref">2017</a>)</cite> addresses this challenge by jointly learning multiple personalized models, one for each client. For example,  <cite class="ltx_cite ltx_citemacro_citep">(Collins et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>; Liang et al. <a href="#bib.bib33" title="" class="ltx_ref">2020</a>; Sun et al. <a href="#bib.bib42" title="" class="ltx_ref">2021</a>)</cite> exploit flexible parameter sharing strategies that only transmitting partial model parameters between clients and server. Besides, local fine-tuning <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib46" title="" class="ltx_ref">2019</a>)</cite>,meta-learning <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib5" title="" class="ltx_ref">2018</a>; Khodak, Balcan, and Talwalkar <a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite> and multi-task learning <cite class="ltx_cite ltx_citemacro_citep">(Smith et al. <a href="#bib.bib41" title="" class="ltx_ref">2017</a>)</cite> are also introduced in PFL.</p>
</div>
<figure id="Sx2.F3" class="ltx_figure"><img src="/html/2302.07450/assets/x3.png" id="Sx2.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="922" height="269" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="Sx2.F3.3.1" class="ltx_text ltx_font_bold">Overview of the proposed federated averaging via binary classification (FedABC) framework</span>, which is based on the vanilla federated learning paradigm, where the server orchestrates the learning amongst clients and is responsible for aggregating the client personalized model parameters. In the local training process, FedABC adopts the “one-vs-all” training strategy that learns an independent binary classifier for each category, while the feature extractor is shared. This may lead to severe class imbalancing problem, and some classes may have no positive samples, and therefore a novel personalized binary classification loss is designed.</figcaption>
</figure>
</section>
<section id="Sx2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Imbalanced classification</h4>

<div id="Sx2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="Sx2.SS0.SSS0.Px2.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citep">(Huang et al. <a href="#bib.bib18" title="" class="ltx_ref">2016</a>)</cite> aims to train a model on the dataset where a few class occupy most instances and remaining classes have few instances. In such case, typical models perform biasedly toward the majority classes and poorly on the minority classes <cite class="ltx_cite ltx_citemacro_citep">(Japkowicz and Stephen <a href="#bib.bib22" title="" class="ltx_ref">2002</a>; He and Garcia <a href="#bib.bib14" title="" class="ltx_ref">2009</a>; Van Horn and Perona <a href="#bib.bib44" title="" class="ltx_ref">2017</a>; Buda, Maki, and Mazurowski <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite>. To address this challenge, a numerous works have been proposed and can be divided into two categories in general: 1) re-sampling <cite class="ltx_cite ltx_citemacro_citep">(Shen, Lin, and Huang <a href="#bib.bib40" title="" class="ltx_ref">2016</a>; Geifman and El-Yaniv <a href="#bib.bib10" title="" class="ltx_ref">2017</a>; Zou et al. <a href="#bib.bib56" title="" class="ltx_ref">2018</a>)</cite>, which usually employs over-sampling <cite class="ltx_cite ltx_citemacro_citep">(Kang et al. <a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite> for the minority class or under-sample <cite class="ltx_cite ltx_citemacro_citep">(Drummond, Holte et al. <a href="#bib.bib9" title="" class="ltx_ref">2003</a>)</cite> for the majority class to re-balance data distribution. Over-sampling adds repeated samples for the minority class and sometimes causes over-fitting. A recently work  <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos and Fleuret <a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite> shows that most samples of the majority class contribute less for later model training, such as the easy-samples; 2) cost-sensitive re-weighting  <cite class="ltx_cite ltx_citemacro_citep">(Aurelio et al. <a href="#bib.bib3" title="" class="ltx_ref">2019</a>; Hong et al. <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Ren et al. <a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite>, which assigns important-weight for samples to increase the occupy of minority class and reduce the occupy of majority class. For example, some methods assign weight by using the inverse square root of class frequency or its smooth version. Besides, the Focal loss <cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite> is a classic solution for the imbalanced classification problem, and the main idea is to focus on learning the hard sample and reduce the impact of easy sample.</p>
</div>
</section>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Federated Averaging via Binary Classification</h2>

<div id="Sx3.p1" class="ltx_para">
<p id="Sx3.p1.1" class="ltx_p">In this section, we present the proposed FedABC, which is based on the vanilla federated by averaging framework, where a central server exchange averaging model parameter with clients as
depicted in the left part of Figure <a href="#Sx2.F3" title="Figure 3 ‣ Federated learning ‣ Related work ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. In the client training process, different from the traditional training approaches that directly adopt the softmax function for multi-class classification, our FedABC adopts the “one-vs-all” training strategy as illustrated in the right part of Figure <a href="#Sx2.F3" title="Figure 3 ‣ Federated learning ‣ Related work ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. This not only alleviates the unfair competition between classes, but also enables us to focus on each category to design personalized loss function for each client. This facilitates the tackling of the severe class imbalance issue. More details are depicted as follows.</p>
</div>
<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Problem formulation</h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.30" class="ltx_p">In this work, we consider a typical PFL setting for supervised learning, i.e., the multi-class classification. We suppose that there are <math id="Sx3.SSx1.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="Sx3.SSx1.p1.1.m1.1a"><mi id="Sx3.SSx1.p1.1.m1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.1b"><ci id="Sx3.SSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.1c">m</annotation></semantics></math> clients and <math id="Sx3.SSx1.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="Sx3.SSx1.p1.2.m2.1a"><mi id="Sx3.SSx1.p1.2.m2.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.1b"><ci id="Sx3.SSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.1c">C</annotation></semantics></math> classes in total. For <math id="Sx3.SSx1.p1.3.m3.1" class="ltx_Math" alttext="i\in[m]" display="inline"><semantics id="Sx3.SSx1.p1.3.m3.1a"><mrow id="Sx3.SSx1.p1.3.m3.1.2" xref="Sx3.SSx1.p1.3.m3.1.2.cmml"><mi id="Sx3.SSx1.p1.3.m3.1.2.2" xref="Sx3.SSx1.p1.3.m3.1.2.2.cmml">i</mi><mo id="Sx3.SSx1.p1.3.m3.1.2.1" xref="Sx3.SSx1.p1.3.m3.1.2.1.cmml">∈</mo><mrow id="Sx3.SSx1.p1.3.m3.1.2.3.2" xref="Sx3.SSx1.p1.3.m3.1.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.1.2.3.2.1" xref="Sx3.SSx1.p1.3.m3.1.2.3.1.1.cmml">[</mo><mi id="Sx3.SSx1.p1.3.m3.1.1" xref="Sx3.SSx1.p1.3.m3.1.1.cmml">m</mi><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.1.2.3.2.2" xref="Sx3.SSx1.p1.3.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.3.m3.1b"><apply id="Sx3.SSx1.p1.3.m3.1.2.cmml" xref="Sx3.SSx1.p1.3.m3.1.2"><in id="Sx3.SSx1.p1.3.m3.1.2.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.2.1"></in><ci id="Sx3.SSx1.p1.3.m3.1.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.1.2.2">𝑖</ci><apply id="Sx3.SSx1.p1.3.m3.1.2.3.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.2.3.2"><csymbol cd="latexml" id="Sx3.SSx1.p1.3.m3.1.2.3.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="Sx3.SSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.3.m3.1c">i\in[m]</annotation></semantics></math>, the <math id="Sx3.SSx1.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx1.p1.4.m4.1a"><mi id="Sx3.SSx1.p1.4.m4.1.1" xref="Sx3.SSx1.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.4.m4.1b"><ci id="Sx3.SSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.4.m4.1c">i</annotation></semantics></math>-th client has individual data distribution <math id="Sx3.SSx1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="Sx3.SSx1.p1.5.m5.1a"><msub id="Sx3.SSx1.p1.5.m5.1.1" xref="Sx3.SSx1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.5.m5.1.1.2" xref="Sx3.SSx1.p1.5.m5.1.1.2.cmml">𝒟</mi><mi id="Sx3.SSx1.p1.5.m5.1.1.3" xref="Sx3.SSx1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.5.m5.1b"><apply id="Sx3.SSx1.p1.5.m5.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.2">𝒟</ci><ci id="Sx3.SSx1.p1.5.m5.1.1.3.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.5.m5.1c">\mathcal{D}_{i}</annotation></semantics></math>, where some classes have many samples and the remaining classes have much fewer. The classes that have positive samples are denoted as <math id="Sx3.SSx1.p1.6.m6.1" class="ltx_Math" alttext="C_{i}^{p}" display="inline"><semantics id="Sx3.SSx1.p1.6.m6.1a"><msubsup id="Sx3.SSx1.p1.6.m6.1.1" xref="Sx3.SSx1.p1.6.m6.1.1.cmml"><mi id="Sx3.SSx1.p1.6.m6.1.1.2.2" xref="Sx3.SSx1.p1.6.m6.1.1.2.2.cmml">C</mi><mi id="Sx3.SSx1.p1.6.m6.1.1.2.3" xref="Sx3.SSx1.p1.6.m6.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx1.p1.6.m6.1.1.3" xref="Sx3.SSx1.p1.6.m6.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.6.m6.1b"><apply id="Sx3.SSx1.p1.6.m6.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.6.m6.1.1.2.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.6.m6.1.1.2.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.2.2">𝐶</ci><ci id="Sx3.SSx1.p1.6.m6.1.1.2.3.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p1.6.m6.1.1.3.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.6.m6.1c">C_{i}^{p}</annotation></semantics></math>, and some classes that have no positive samples are denoted as <math id="Sx3.SSx1.p1.7.m7.1" class="ltx_Math" alttext="C_{i}^{n}" display="inline"><semantics id="Sx3.SSx1.p1.7.m7.1a"><msubsup id="Sx3.SSx1.p1.7.m7.1.1" xref="Sx3.SSx1.p1.7.m7.1.1.cmml"><mi id="Sx3.SSx1.p1.7.m7.1.1.2.2" xref="Sx3.SSx1.p1.7.m7.1.1.2.2.cmml">C</mi><mi id="Sx3.SSx1.p1.7.m7.1.1.2.3" xref="Sx3.SSx1.p1.7.m7.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx1.p1.7.m7.1.1.3" xref="Sx3.SSx1.p1.7.m7.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.7.m7.1b"><apply id="Sx3.SSx1.p1.7.m7.1.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.7.m7.1.1.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.7.m7.1.1.2.cmml" xref="Sx3.SSx1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.7.m7.1.1.2.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.7.m7.1.1.2.2.cmml" xref="Sx3.SSx1.p1.7.m7.1.1.2.2">𝐶</ci><ci id="Sx3.SSx1.p1.7.m7.1.1.2.3.cmml" xref="Sx3.SSx1.p1.7.m7.1.1.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p1.7.m7.1.1.3.cmml" xref="Sx3.SSx1.p1.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.7.m7.1c">C_{i}^{n}</annotation></semantics></math>. The <math id="Sx3.SSx1.p1.8.m8.1" class="ltx_Math" alttext="{i}" display="inline"><semantics id="Sx3.SSx1.p1.8.m8.1a"><mi id="Sx3.SSx1.p1.8.m8.1.1" xref="Sx3.SSx1.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.8.m8.1b"><ci id="Sx3.SSx1.p1.8.m8.1.1.cmml" xref="Sx3.SSx1.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.8.m8.1c">{i}</annotation></semantics></math>-th client has access to the local dataset <math id="Sx3.SSx1.p1.9.m9.4" class="ltx_Math" alttext="\mathcal{S}^{i}=\{({x}_{i}^{1},y_{i}^{1}),({x}_{i}^{2},y_{i}^{2}),\cdots,({x}^{n_{i}}_{i},y_{i}^{n_{i}})\}" display="inline"><semantics id="Sx3.SSx1.p1.9.m9.4a"><mrow id="Sx3.SSx1.p1.9.m9.4.4" xref="Sx3.SSx1.p1.9.m9.4.4.cmml"><msup id="Sx3.SSx1.p1.9.m9.4.4.5" xref="Sx3.SSx1.p1.9.m9.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.9.m9.4.4.5.2" xref="Sx3.SSx1.p1.9.m9.4.4.5.2.cmml">𝒮</mi><mi id="Sx3.SSx1.p1.9.m9.4.4.5.3" xref="Sx3.SSx1.p1.9.m9.4.4.5.3.cmml">i</mi></msup><mo id="Sx3.SSx1.p1.9.m9.4.4.4" xref="Sx3.SSx1.p1.9.m9.4.4.4.cmml">=</mo><mrow id="Sx3.SSx1.p1.9.m9.4.4.3.3" xref="Sx3.SSx1.p1.9.m9.4.4.3.4.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.9.m9.4.4.3.3.4" xref="Sx3.SSx1.p1.9.m9.4.4.3.4.cmml">{</mo><mrow id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.3" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.3.cmml">(</mo><msubsup id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.2" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.3" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.3.cmml">i</mi><mn id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.3" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.4" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.3.cmml">,</mo><msubsup id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.cmml"><mi id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.2" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.2.cmml">y</mi><mi id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.3" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.3.cmml">i</mi><mn id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.3" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.3.cmml">1</mn></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.5" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.3.cmml">)</mo></mrow><mo id="Sx3.SSx1.p1.9.m9.4.4.3.3.5" xref="Sx3.SSx1.p1.9.m9.4.4.3.4.cmml">,</mo><mrow id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.3" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.3.cmml">(</mo><msubsup id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.cmml"><mi id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.2" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.3" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.3.cmml">i</mi><mn id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.3" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.3.cmml">2</mn></msubsup><mo id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.4" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.3.cmml">,</mo><msubsup id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.cmml"><mi id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.2" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.2.cmml">y</mi><mi id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.3" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.3.cmml">i</mi><mn id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.3" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.3.cmml">2</mn></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.5" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.3.cmml">)</mo></mrow><mo id="Sx3.SSx1.p1.9.m9.4.4.3.3.6" xref="Sx3.SSx1.p1.9.m9.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx1.p1.9.m9.1.1" xref="Sx3.SSx1.p1.9.m9.1.1.cmml">⋯</mi><mo id="Sx3.SSx1.p1.9.m9.4.4.3.3.7" xref="Sx3.SSx1.p1.9.m9.4.4.3.4.cmml">,</mo><mrow id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.3" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.3.cmml">(</mo><msubsup id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.cmml"><mi id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.2" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.3" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.3.cmml">i</mi><msub id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.cmml"><mi id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.2" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.2.cmml">n</mi><mi id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.3" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.3.cmml">i</mi></msub></msubsup><mo id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.4" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.3.cmml">,</mo><msubsup id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.cmml"><mi id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.2" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.2.cmml">y</mi><mi id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.3" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.3.cmml">i</mi><msub id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.cmml"><mi id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.2" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.2.cmml">n</mi><mi id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.3" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.3.cmml">i</mi></msub></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.5" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.3.cmml">)</mo></mrow><mo stretchy="false" id="Sx3.SSx1.p1.9.m9.4.4.3.3.8" xref="Sx3.SSx1.p1.9.m9.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.9.m9.4b"><apply id="Sx3.SSx1.p1.9.m9.4.4.cmml" xref="Sx3.SSx1.p1.9.m9.4.4"><eq id="Sx3.SSx1.p1.9.m9.4.4.4.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.4"></eq><apply id="Sx3.SSx1.p1.9.m9.4.4.5.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.5"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.4.4.5.1.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.5">superscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.4.4.5.2.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.5.2">𝒮</ci><ci id="Sx3.SSx1.p1.9.m9.4.4.5.3.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.5.3">𝑖</ci></apply><set id="Sx3.SSx1.p1.9.m9.4.4.3.4.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3"><interval closure="open" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.3.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2"><apply id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.2">𝑥</ci><ci id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.1.1.3">1</cn></apply><apply id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2">superscript</csymbol><apply id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.2">𝑦</ci><ci id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.2.3">𝑖</ci></apply><cn type="integer" id="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.2.2.1.1.1.2.2.3">1</cn></apply></interval><interval closure="open" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2"><apply id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.2">𝑥</ci><ci id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.3.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.1.1.3">2</cn></apply><apply id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2">superscript</csymbol><apply id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.2">𝑦</ci><ci id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.2.3">𝑖</ci></apply><cn type="integer" id="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.3.3.2.2.2.2.2.3">2</cn></apply></interval><ci id="Sx3.SSx1.p1.9.m9.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1">⋯</ci><interval closure="open" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.3.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2"><apply id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1">subscript</csymbol><apply id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.2">𝑥</ci><apply id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.1.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.2.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.2">𝑛</ci><ci id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.3.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.2.3.3">𝑖</ci></apply></apply><ci id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.3.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.1.1.3">𝑖</ci></apply><apply id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2">superscript</csymbol><apply id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.2">𝑦</ci><ci id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.2.3">𝑖</ci></apply><apply id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.1.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.2.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.2">𝑛</ci><ci id="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.3.cmml" xref="Sx3.SSx1.p1.9.m9.4.4.3.3.3.2.2.3.3">𝑖</ci></apply></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.9.m9.4c">\mathcal{S}^{i}=\{({x}_{i}^{1},y_{i}^{1}),({x}_{i}^{2},y_{i}^{2}),\cdots,({x}^{n_{i}}_{i},y_{i}^{n_{i}})\}</annotation></semantics></math>. The neural network parameter <math id="Sx3.SSx1.p1.10.m10.1" class="ltx_Math" alttext="\bm{\theta}_{i}" display="inline"><semantics id="Sx3.SSx1.p1.10.m10.1a"><msub id="Sx3.SSx1.p1.10.m10.1.1" xref="Sx3.SSx1.p1.10.m10.1.1.cmml"><mi id="Sx3.SSx1.p1.10.m10.1.1.2" xref="Sx3.SSx1.p1.10.m10.1.1.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.10.m10.1.1.3" xref="Sx3.SSx1.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.10.m10.1b"><apply id="Sx3.SSx1.p1.10.m10.1.1.cmml" xref="Sx3.SSx1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.10.m10.1.1.1.cmml" xref="Sx3.SSx1.p1.10.m10.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.10.m10.1.1.2.cmml" xref="Sx3.SSx1.p1.10.m10.1.1.2">𝜽</ci><ci id="Sx3.SSx1.p1.10.m10.1.1.3.cmml" xref="Sx3.SSx1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.10.m10.1c">\bm{\theta}_{i}</annotation></semantics></math> of the <math id="Sx3.SSx1.p1.11.m11.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx1.p1.11.m11.1a"><mi id="Sx3.SSx1.p1.11.m11.1.1" xref="Sx3.SSx1.p1.11.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.11.m11.1b"><ci id="Sx3.SSx1.p1.11.m11.1.1.cmml" xref="Sx3.SSx1.p1.11.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.11.m11.1c">i</annotation></semantics></math>-th client consists of two parts: an embedding network <math id="Sx3.SSx1.p1.12.m12.1" class="ltx_Math" alttext="f:\mathcal{X}\rightarrow\mathcal{Z}" display="inline"><semantics id="Sx3.SSx1.p1.12.m12.1a"><mrow id="Sx3.SSx1.p1.12.m12.1.1" xref="Sx3.SSx1.p1.12.m12.1.1.cmml"><mi id="Sx3.SSx1.p1.12.m12.1.1.2" xref="Sx3.SSx1.p1.12.m12.1.1.2.cmml">f</mi><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p1.12.m12.1.1.1" xref="Sx3.SSx1.p1.12.m12.1.1.1.cmml">:</mo><mrow id="Sx3.SSx1.p1.12.m12.1.1.3" xref="Sx3.SSx1.p1.12.m12.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.12.m12.1.1.3.2" xref="Sx3.SSx1.p1.12.m12.1.1.3.2.cmml">𝒳</mi><mo stretchy="false" id="Sx3.SSx1.p1.12.m12.1.1.3.1" xref="Sx3.SSx1.p1.12.m12.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.12.m12.1.1.3.3" xref="Sx3.SSx1.p1.12.m12.1.1.3.3.cmml">𝒵</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.12.m12.1b"><apply id="Sx3.SSx1.p1.12.m12.1.1.cmml" xref="Sx3.SSx1.p1.12.m12.1.1"><ci id="Sx3.SSx1.p1.12.m12.1.1.1.cmml" xref="Sx3.SSx1.p1.12.m12.1.1.1">:</ci><ci id="Sx3.SSx1.p1.12.m12.1.1.2.cmml" xref="Sx3.SSx1.p1.12.m12.1.1.2">𝑓</ci><apply id="Sx3.SSx1.p1.12.m12.1.1.3.cmml" xref="Sx3.SSx1.p1.12.m12.1.1.3"><ci id="Sx3.SSx1.p1.12.m12.1.1.3.1.cmml" xref="Sx3.SSx1.p1.12.m12.1.1.3.1">→</ci><ci id="Sx3.SSx1.p1.12.m12.1.1.3.2.cmml" xref="Sx3.SSx1.p1.12.m12.1.1.3.2">𝒳</ci><ci id="Sx3.SSx1.p1.12.m12.1.1.3.3.cmml" xref="Sx3.SSx1.p1.12.m12.1.1.3.3">𝒵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.12.m12.1c">f:\mathcal{X}\rightarrow\mathcal{Z}</annotation></semantics></math> parameterized by <math id="Sx3.SSx1.p1.13.m13.1" class="ltx_Math" alttext="\bm{\theta}^{f}_{i}" display="inline"><semantics id="Sx3.SSx1.p1.13.m13.1a"><msubsup id="Sx3.SSx1.p1.13.m13.1.1" xref="Sx3.SSx1.p1.13.m13.1.1.cmml"><mi id="Sx3.SSx1.p1.13.m13.1.1.2.2" xref="Sx3.SSx1.p1.13.m13.1.1.2.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.13.m13.1.1.3" xref="Sx3.SSx1.p1.13.m13.1.1.3.cmml">i</mi><mi id="Sx3.SSx1.p1.13.m13.1.1.2.3" xref="Sx3.SSx1.p1.13.m13.1.1.2.3.cmml">f</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.13.m13.1b"><apply id="Sx3.SSx1.p1.13.m13.1.1.cmml" xref="Sx3.SSx1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.13.m13.1.1.1.cmml" xref="Sx3.SSx1.p1.13.m13.1.1">subscript</csymbol><apply id="Sx3.SSx1.p1.13.m13.1.1.2.cmml" xref="Sx3.SSx1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.13.m13.1.1.2.1.cmml" xref="Sx3.SSx1.p1.13.m13.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.13.m13.1.1.2.2.cmml" xref="Sx3.SSx1.p1.13.m13.1.1.2.2">𝜽</ci><ci id="Sx3.SSx1.p1.13.m13.1.1.2.3.cmml" xref="Sx3.SSx1.p1.13.m13.1.1.2.3">𝑓</ci></apply><ci id="Sx3.SSx1.p1.13.m13.1.1.3.cmml" xref="Sx3.SSx1.p1.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.13.m13.1c">\bm{\theta}^{f}_{i}</annotation></semantics></math> maps the input <math id="Sx3.SSx1.p1.14.m14.1" class="ltx_Math" alttext="{x}" display="inline"><semantics id="Sx3.SSx1.p1.14.m14.1a"><mi id="Sx3.SSx1.p1.14.m14.1.1" xref="Sx3.SSx1.p1.14.m14.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.14.m14.1b"><ci id="Sx3.SSx1.p1.14.m14.1.1.cmml" xref="Sx3.SSx1.p1.14.m14.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.14.m14.1c">{x}</annotation></semantics></math> to the latent feature, i.e., <math id="Sx3.SSx1.p1.15.m15.2" class="ltx_Math" alttext="{z}:=f({x};\bm{\theta}_{i}^{f})" display="inline"><semantics id="Sx3.SSx1.p1.15.m15.2a"><mrow id="Sx3.SSx1.p1.15.m15.2.2" xref="Sx3.SSx1.p1.15.m15.2.2.cmml"><mi id="Sx3.SSx1.p1.15.m15.2.2.3" xref="Sx3.SSx1.p1.15.m15.2.2.3.cmml">z</mi><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p1.15.m15.2.2.2" xref="Sx3.SSx1.p1.15.m15.2.2.2.cmml">:=</mo><mrow id="Sx3.SSx1.p1.15.m15.2.2.1" xref="Sx3.SSx1.p1.15.m15.2.2.1.cmml"><mi id="Sx3.SSx1.p1.15.m15.2.2.1.3" xref="Sx3.SSx1.p1.15.m15.2.2.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.15.m15.2.2.1.2" xref="Sx3.SSx1.p1.15.m15.2.2.1.2.cmml">​</mo><mrow id="Sx3.SSx1.p1.15.m15.2.2.1.1.1" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.2" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.2.cmml">(</mo><mi id="Sx3.SSx1.p1.15.m15.1.1" xref="Sx3.SSx1.p1.15.m15.1.1.cmml">x</mi><mo id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.3" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.2.cmml">;</mo><msubsup id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.cmml"><mi id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.2" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.3" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.3" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.3.cmml">f</mi></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.4" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.15.m15.2b"><apply id="Sx3.SSx1.p1.15.m15.2.2.cmml" xref="Sx3.SSx1.p1.15.m15.2.2"><csymbol cd="latexml" id="Sx3.SSx1.p1.15.m15.2.2.2.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.2">assign</csymbol><ci id="Sx3.SSx1.p1.15.m15.2.2.3.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.3">𝑧</ci><apply id="Sx3.SSx1.p1.15.m15.2.2.1.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1"><times id="Sx3.SSx1.p1.15.m15.2.2.1.2.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.2"></times><ci id="Sx3.SSx1.p1.15.m15.2.2.1.3.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.3">𝑓</ci><list id="Sx3.SSx1.p1.15.m15.2.2.1.1.2.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1"><ci id="Sx3.SSx1.p1.15.m15.1.1.cmml" xref="Sx3.SSx1.p1.15.m15.1.1">𝑥</ci><apply id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.2">𝜽</ci><ci id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.15.m15.2.2.1.1.1.1.3">𝑓</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.15.m15.2c">{z}:=f({x};\bm{\theta}_{i}^{f})</annotation></semantics></math>, and a predictor <math id="Sx3.SSx1.p1.16.m16.1" class="ltx_Math" alttext="h:\mathcal{Z}\rightarrow\mathcal{Y}" display="inline"><semantics id="Sx3.SSx1.p1.16.m16.1a"><mrow id="Sx3.SSx1.p1.16.m16.1.1" xref="Sx3.SSx1.p1.16.m16.1.1.cmml"><mi id="Sx3.SSx1.p1.16.m16.1.1.2" xref="Sx3.SSx1.p1.16.m16.1.1.2.cmml">h</mi><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p1.16.m16.1.1.1" xref="Sx3.SSx1.p1.16.m16.1.1.1.cmml">:</mo><mrow id="Sx3.SSx1.p1.16.m16.1.1.3" xref="Sx3.SSx1.p1.16.m16.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.16.m16.1.1.3.2" xref="Sx3.SSx1.p1.16.m16.1.1.3.2.cmml">𝒵</mi><mo stretchy="false" id="Sx3.SSx1.p1.16.m16.1.1.3.1" xref="Sx3.SSx1.p1.16.m16.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.16.m16.1.1.3.3" xref="Sx3.SSx1.p1.16.m16.1.1.3.3.cmml">𝒴</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.16.m16.1b"><apply id="Sx3.SSx1.p1.16.m16.1.1.cmml" xref="Sx3.SSx1.p1.16.m16.1.1"><ci id="Sx3.SSx1.p1.16.m16.1.1.1.cmml" xref="Sx3.SSx1.p1.16.m16.1.1.1">:</ci><ci id="Sx3.SSx1.p1.16.m16.1.1.2.cmml" xref="Sx3.SSx1.p1.16.m16.1.1.2">ℎ</ci><apply id="Sx3.SSx1.p1.16.m16.1.1.3.cmml" xref="Sx3.SSx1.p1.16.m16.1.1.3"><ci id="Sx3.SSx1.p1.16.m16.1.1.3.1.cmml" xref="Sx3.SSx1.p1.16.m16.1.1.3.1">→</ci><ci id="Sx3.SSx1.p1.16.m16.1.1.3.2.cmml" xref="Sx3.SSx1.p1.16.m16.1.1.3.2">𝒵</ci><ci id="Sx3.SSx1.p1.16.m16.1.1.3.3.cmml" xref="Sx3.SSx1.p1.16.m16.1.1.3.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.16.m16.1c">h:\mathcal{Z}\rightarrow\mathcal{Y}</annotation></semantics></math> parameterized by <math id="Sx3.SSx1.p1.17.m17.1" class="ltx_Math" alttext="\bm{\theta}^{h}_{i}" display="inline"><semantics id="Sx3.SSx1.p1.17.m17.1a"><msubsup id="Sx3.SSx1.p1.17.m17.1.1" xref="Sx3.SSx1.p1.17.m17.1.1.cmml"><mi id="Sx3.SSx1.p1.17.m17.1.1.2.2" xref="Sx3.SSx1.p1.17.m17.1.1.2.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.17.m17.1.1.3" xref="Sx3.SSx1.p1.17.m17.1.1.3.cmml">i</mi><mi id="Sx3.SSx1.p1.17.m17.1.1.2.3" xref="Sx3.SSx1.p1.17.m17.1.1.2.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.17.m17.1b"><apply id="Sx3.SSx1.p1.17.m17.1.1.cmml" xref="Sx3.SSx1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.17.m17.1.1.1.cmml" xref="Sx3.SSx1.p1.17.m17.1.1">subscript</csymbol><apply id="Sx3.SSx1.p1.17.m17.1.1.2.cmml" xref="Sx3.SSx1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.17.m17.1.1.2.1.cmml" xref="Sx3.SSx1.p1.17.m17.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.17.m17.1.1.2.2.cmml" xref="Sx3.SSx1.p1.17.m17.1.1.2.2">𝜽</ci><ci id="Sx3.SSx1.p1.17.m17.1.1.2.3.cmml" xref="Sx3.SSx1.p1.17.m17.1.1.2.3">ℎ</ci></apply><ci id="Sx3.SSx1.p1.17.m17.1.1.3.cmml" xref="Sx3.SSx1.p1.17.m17.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.17.m17.1c">\bm{\theta}^{h}_{i}</annotation></semantics></math> maps latent feature to the logits <math id="Sx3.SSx1.p1.18.m18.1" class="ltx_Math" alttext="{y}" display="inline"><semantics id="Sx3.SSx1.p1.18.m18.1a"><mi id="Sx3.SSx1.p1.18.m18.1.1" xref="Sx3.SSx1.p1.18.m18.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.18.m18.1b"><ci id="Sx3.SSx1.p1.18.m18.1.1.cmml" xref="Sx3.SSx1.p1.18.m18.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.18.m18.1c">{y}</annotation></semantics></math> , i.e., <math id="Sx3.SSx1.p1.19.m19.3" class="ltx_Math" alttext="y:=h(f({x};\bm{\theta}_{i}^{f});\bm{\theta}_{i}^{h})" display="inline"><semantics id="Sx3.SSx1.p1.19.m19.3a"><mrow id="Sx3.SSx1.p1.19.m19.3.3" xref="Sx3.SSx1.p1.19.m19.3.3.cmml"><mi id="Sx3.SSx1.p1.19.m19.3.3.4" xref="Sx3.SSx1.p1.19.m19.3.3.4.cmml">y</mi><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p1.19.m19.3.3.3" xref="Sx3.SSx1.p1.19.m19.3.3.3.cmml">:=</mo><mrow id="Sx3.SSx1.p1.19.m19.3.3.2" xref="Sx3.SSx1.p1.19.m19.3.3.2.cmml"><mi id="Sx3.SSx1.p1.19.m19.3.3.2.4" xref="Sx3.SSx1.p1.19.m19.3.3.2.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.19.m19.3.3.2.3" xref="Sx3.SSx1.p1.19.m19.3.3.2.3.cmml">​</mo><mrow id="Sx3.SSx1.p1.19.m19.3.3.2.2.2" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.3" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.3.cmml">(</mo><mrow id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.cmml"><mi id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.3" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.2" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.2" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.2.cmml">(</mo><mi id="Sx3.SSx1.p1.19.m19.1.1" xref="Sx3.SSx1.p1.19.m19.1.1.cmml">x</mi><mo id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.3" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.2.cmml">;</mo><msubsup id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.2" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.3" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.3" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.3.cmml">f</mi></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.4" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.4" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.3.cmml">;</mo><msubsup id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.cmml"><mi id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.2" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.3" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.3.cmml">i</mi><mi id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.3" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.3.cmml">h</mi></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.5" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.19.m19.3b"><apply id="Sx3.SSx1.p1.19.m19.3.3.cmml" xref="Sx3.SSx1.p1.19.m19.3.3"><csymbol cd="latexml" id="Sx3.SSx1.p1.19.m19.3.3.3.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.3">assign</csymbol><ci id="Sx3.SSx1.p1.19.m19.3.3.4.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.4">𝑦</ci><apply id="Sx3.SSx1.p1.19.m19.3.3.2.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2"><times id="Sx3.SSx1.p1.19.m19.3.3.2.3.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.3"></times><ci id="Sx3.SSx1.p1.19.m19.3.3.2.4.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.4">ℎ</ci><list id="Sx3.SSx1.p1.19.m19.3.3.2.2.3.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2"><apply id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1"><times id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.2"></times><ci id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.3">𝑓</ci><list id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1"><ci id="Sx3.SSx1.p1.19.m19.1.1.cmml" xref="Sx3.SSx1.p1.19.m19.1.1">𝑥</ci><apply id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.2">𝜽</ci><ci id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.19.m19.2.2.1.1.1.1.1.1.1.3">𝑓</ci></apply></list></apply><apply id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.1.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2">superscript</csymbol><apply id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.1.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.2.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.2">𝜽</ci><ci id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.3.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.3.cmml" xref="Sx3.SSx1.p1.19.m19.3.3.2.2.2.2.3">ℎ</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.19.m19.3c">y:=h(f({x};\bm{\theta}_{i}^{f});\bm{\theta}_{i}^{h})</annotation></semantics></math>.
The corresponding feature extractor part and predictor part of the global model <math id="Sx3.SSx1.p1.20.m20.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.SSx1.p1.20.m20.1a"><mi id="Sx3.SSx1.p1.20.m20.1.1" xref="Sx3.SSx1.p1.20.m20.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.20.m20.1b"><ci id="Sx3.SSx1.p1.20.m20.1.1.cmml" xref="Sx3.SSx1.p1.20.m20.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.20.m20.1c">\theta</annotation></semantics></math> achieved by averaging are defined as <math id="Sx3.SSx1.p1.21.m21.1" class="ltx_Math" alttext="\bm{\theta}^{f}" display="inline"><semantics id="Sx3.SSx1.p1.21.m21.1a"><msup id="Sx3.SSx1.p1.21.m21.1.1" xref="Sx3.SSx1.p1.21.m21.1.1.cmml"><mi id="Sx3.SSx1.p1.21.m21.1.1.2" xref="Sx3.SSx1.p1.21.m21.1.1.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.21.m21.1.1.3" xref="Sx3.SSx1.p1.21.m21.1.1.3.cmml">f</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.21.m21.1b"><apply id="Sx3.SSx1.p1.21.m21.1.1.cmml" xref="Sx3.SSx1.p1.21.m21.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.21.m21.1.1.1.cmml" xref="Sx3.SSx1.p1.21.m21.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.21.m21.1.1.2.cmml" xref="Sx3.SSx1.p1.21.m21.1.1.2">𝜽</ci><ci id="Sx3.SSx1.p1.21.m21.1.1.3.cmml" xref="Sx3.SSx1.p1.21.m21.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.21.m21.1c">\bm{\theta}^{f}</annotation></semantics></math> and <math id="Sx3.SSx1.p1.22.m22.1" class="ltx_Math" alttext="\bm{\theta}^{h}" display="inline"><semantics id="Sx3.SSx1.p1.22.m22.1a"><msup id="Sx3.SSx1.p1.22.m22.1.1" xref="Sx3.SSx1.p1.22.m22.1.1.cmml"><mi id="Sx3.SSx1.p1.22.m22.1.1.2" xref="Sx3.SSx1.p1.22.m22.1.1.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.22.m22.1.1.3" xref="Sx3.SSx1.p1.22.m22.1.1.3.cmml">h</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.22.m22.1b"><apply id="Sx3.SSx1.p1.22.m22.1.1.cmml" xref="Sx3.SSx1.p1.22.m22.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.22.m22.1.1.1.cmml" xref="Sx3.SSx1.p1.22.m22.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.22.m22.1.1.2.cmml" xref="Sx3.SSx1.p1.22.m22.1.1.2">𝜽</ci><ci id="Sx3.SSx1.p1.22.m22.1.1.3.cmml" xref="Sx3.SSx1.p1.22.m22.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.22.m22.1c">\bm{\theta}^{h}</annotation></semantics></math>, respectively. A non-linear activation <math id="Sx3.SSx1.p1.23.m23.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="Sx3.SSx1.p1.23.m23.1a"><mrow id="Sx3.SSx1.p1.23.m23.1.2" xref="Sx3.SSx1.p1.23.m23.1.2.cmml"><mi id="Sx3.SSx1.p1.23.m23.1.2.2" xref="Sx3.SSx1.p1.23.m23.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.23.m23.1.2.1" xref="Sx3.SSx1.p1.23.m23.1.2.1.cmml">​</mo><mrow id="Sx3.SSx1.p1.23.m23.1.2.3.2" xref="Sx3.SSx1.p1.23.m23.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.23.m23.1.2.3.2.1" xref="Sx3.SSx1.p1.23.m23.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.23.m23.1.1" xref="Sx3.SSx1.p1.23.m23.1.1.cmml">⋅</mo><mo stretchy="false" id="Sx3.SSx1.p1.23.m23.1.2.3.2.2" xref="Sx3.SSx1.p1.23.m23.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.23.m23.1b"><apply id="Sx3.SSx1.p1.23.m23.1.2.cmml" xref="Sx3.SSx1.p1.23.m23.1.2"><times id="Sx3.SSx1.p1.23.m23.1.2.1.cmml" xref="Sx3.SSx1.p1.23.m23.1.2.1"></times><ci id="Sx3.SSx1.p1.23.m23.1.2.2.cmml" xref="Sx3.SSx1.p1.23.m23.1.2.2">𝜎</ci><ci id="Sx3.SSx1.p1.23.m23.1.1.cmml" xref="Sx3.SSx1.p1.23.m23.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.23.m23.1c">\sigma(\cdot)</annotation></semantics></math> is applied to <math id="Sx3.SSx1.p1.24.m24.1" class="ltx_Math" alttext="y" display="inline"><semantics id="Sx3.SSx1.p1.24.m24.1a"><mi id="Sx3.SSx1.p1.24.m24.1.1" xref="Sx3.SSx1.p1.24.m24.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.24.m24.1b"><ci id="Sx3.SSx1.p1.24.m24.1.1.cmml" xref="Sx3.SSx1.p1.24.m24.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.24.m24.1c">y</annotation></semantics></math>, so the output of the neural network can be defined as <math id="Sx3.SSx1.p1.25.m25.2" class="ltx_Math" alttext="\sigma(h(f({x};\bm{\theta}^{f}),\bm{\theta}^{h}))" display="inline"><semantics id="Sx3.SSx1.p1.25.m25.2a"><mrow id="Sx3.SSx1.p1.25.m25.2.2" xref="Sx3.SSx1.p1.25.m25.2.2.cmml"><mi id="Sx3.SSx1.p1.25.m25.2.2.3" xref="Sx3.SSx1.p1.25.m25.2.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.25.m25.2.2.2" xref="Sx3.SSx1.p1.25.m25.2.2.2.cmml">​</mo><mrow id="Sx3.SSx1.p1.25.m25.2.2.1.1" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.25.m25.2.2.1.1.2" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.cmml">(</mo><mrow id="Sx3.SSx1.p1.25.m25.2.2.1.1.1" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.cmml"><mi id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.4" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.3" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.3.cmml">​</mo><mrow id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.3" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.3.cmml">(</mo><mrow id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.3" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.2" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.2" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="Sx3.SSx1.p1.25.m25.1.1" xref="Sx3.SSx1.p1.25.m25.1.1.cmml">x</mi><mo id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.3" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.2.cmml">;</mo><msup id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.2" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.3" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.3.cmml">f</mi></msup><mo stretchy="false" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.4" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.4" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.3.cmml">,</mo><msup id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.cmml"><mi id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.2" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.3" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.3.cmml">h</mi></msup><mo stretchy="false" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.5" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.SSx1.p1.25.m25.2.2.1.1.3" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.25.m25.2b"><apply id="Sx3.SSx1.p1.25.m25.2.2.cmml" xref="Sx3.SSx1.p1.25.m25.2.2"><times id="Sx3.SSx1.p1.25.m25.2.2.2.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.2"></times><ci id="Sx3.SSx1.p1.25.m25.2.2.3.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.3">𝜎</ci><apply id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1"><times id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.3.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.3"></times><ci id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.4.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.4">ℎ</ci><interval closure="open" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2"><apply id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1"><times id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.2"></times><ci id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.3">𝑓</ci><list id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1"><ci id="Sx3.SSx1.p1.25.m25.1.1.cmml" xref="Sx3.SSx1.p1.25.m25.1.1">𝑥</ci><apply id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.1.1.1.1.1.1.3">𝑓</ci></apply></list></apply><apply id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.1.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2">superscript</csymbol><ci id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.2.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.2">𝜽</ci><ci id="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.3.cmml" xref="Sx3.SSx1.p1.25.m25.2.2.1.1.1.2.2.2.3">ℎ</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.25.m25.2c">\sigma(h(f({x};\bm{\theta}^{f}),\bm{\theta}^{h}))</annotation></semantics></math>, and we rewrite it as <math id="Sx3.SSx1.p1.26.m26.2" class="ltx_Math" alttext="q:=\sigma({g}({x};\bm{\theta}^{f};\bm{\theta}^{h}))" display="inline"><semantics id="Sx3.SSx1.p1.26.m26.2a"><mrow id="Sx3.SSx1.p1.26.m26.2.2" xref="Sx3.SSx1.p1.26.m26.2.2.cmml"><mi id="Sx3.SSx1.p1.26.m26.2.2.3" xref="Sx3.SSx1.p1.26.m26.2.2.3.cmml">q</mi><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p1.26.m26.2.2.2" xref="Sx3.SSx1.p1.26.m26.2.2.2.cmml">:=</mo><mrow id="Sx3.SSx1.p1.26.m26.2.2.1" xref="Sx3.SSx1.p1.26.m26.2.2.1.cmml"><mi id="Sx3.SSx1.p1.26.m26.2.2.1.3" xref="Sx3.SSx1.p1.26.m26.2.2.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.26.m26.2.2.1.2" xref="Sx3.SSx1.p1.26.m26.2.2.1.2.cmml">​</mo><mrow id="Sx3.SSx1.p1.26.m26.2.2.1.1.1" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.2" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.cmml"><mi id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.4" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.3" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.3.cmml">​</mo><mrow id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.3" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.3.cmml">(</mo><mi id="Sx3.SSx1.p1.26.m26.1.1" xref="Sx3.SSx1.p1.26.m26.1.1.cmml">x</mi><mo id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.4" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.3.cmml">;</mo><msup id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.2" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.3" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.3.cmml">f</mi></msup><mo id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.5" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.3.cmml">;</mo><msup id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.cmml"><mi id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.2" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.3" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.3.cmml">h</mi></msup><mo stretchy="false" id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.6" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.3" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.26.m26.2b"><apply id="Sx3.SSx1.p1.26.m26.2.2.cmml" xref="Sx3.SSx1.p1.26.m26.2.2"><csymbol cd="latexml" id="Sx3.SSx1.p1.26.m26.2.2.2.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.2">assign</csymbol><ci id="Sx3.SSx1.p1.26.m26.2.2.3.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.3">𝑞</ci><apply id="Sx3.SSx1.p1.26.m26.2.2.1.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1"><times id="Sx3.SSx1.p1.26.m26.2.2.1.2.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.2"></times><ci id="Sx3.SSx1.p1.26.m26.2.2.1.3.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.3">𝜎</ci><apply id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1"><times id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.3"></times><ci id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.4.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.4">𝑔</ci><list id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2"><ci id="Sx3.SSx1.p1.26.m26.1.1.cmml" xref="Sx3.SSx1.p1.26.m26.1.1">𝑥</ci><apply id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.2">𝜽</ci><ci id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.1.1.1.3">𝑓</ci></apply><apply id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.1.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.2.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.2">𝜽</ci><ci id="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.3.cmml" xref="Sx3.SSx1.p1.26.m26.2.2.1.1.1.1.2.2.2.3">ℎ</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.26.m26.2c">q:=\sigma({g}({x};\bm{\theta}^{f};\bm{\theta}^{h}))</annotation></semantics></math>. Since the binary classification is employed, we adopt the <span id="Sx3.SSx1.p1.30.1" class="ltx_text ltx_markedasmath ltx_font_bold">sigmoid</span> function for activation, which maps the input into <math id="Sx3.SSx1.p1.28.m28.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="Sx3.SSx1.p1.28.m28.2a"><mrow id="Sx3.SSx1.p1.28.m28.2.3.2" xref="Sx3.SSx1.p1.28.m28.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.28.m28.2.3.2.1" xref="Sx3.SSx1.p1.28.m28.2.3.1.cmml">[</mo><mn id="Sx3.SSx1.p1.28.m28.1.1" xref="Sx3.SSx1.p1.28.m28.1.1.cmml">0</mn><mo id="Sx3.SSx1.p1.28.m28.2.3.2.2" xref="Sx3.SSx1.p1.28.m28.2.3.1.cmml">,</mo><mn id="Sx3.SSx1.p1.28.m28.2.2" xref="Sx3.SSx1.p1.28.m28.2.2.cmml">1</mn><mo stretchy="false" id="Sx3.SSx1.p1.28.m28.2.3.2.3" xref="Sx3.SSx1.p1.28.m28.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.28.m28.2b"><interval closure="closed" id="Sx3.SSx1.p1.28.m28.2.3.1.cmml" xref="Sx3.SSx1.p1.28.m28.2.3.2"><cn type="integer" id="Sx3.SSx1.p1.28.m28.1.1.cmml" xref="Sx3.SSx1.p1.28.m28.1.1">0</cn><cn type="integer" id="Sx3.SSx1.p1.28.m28.2.2.cmml" xref="Sx3.SSx1.p1.28.m28.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.28.m28.2c">[0,1]</annotation></semantics></math>. For <math id="Sx3.SSx1.p1.29.m29.4" class="ltx_Math" alttext="i\in[m],j\in[C]" display="inline"><semantics id="Sx3.SSx1.p1.29.m29.4a"><mrow id="Sx3.SSx1.p1.29.m29.4.4.2" xref="Sx3.SSx1.p1.29.m29.4.4.3.cmml"><mrow id="Sx3.SSx1.p1.29.m29.3.3.1.1" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.cmml"><mi id="Sx3.SSx1.p1.29.m29.3.3.1.1.2" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.2.cmml">i</mi><mo id="Sx3.SSx1.p1.29.m29.3.3.1.1.1" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.1.cmml">∈</mo><mrow id="Sx3.SSx1.p1.29.m29.3.3.1.1.3.2" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.3.1.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.29.m29.3.3.1.1.3.2.1" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.3.1.1.cmml">[</mo><mi id="Sx3.SSx1.p1.29.m29.1.1" xref="Sx3.SSx1.p1.29.m29.1.1.cmml">m</mi><mo stretchy="false" id="Sx3.SSx1.p1.29.m29.3.3.1.1.3.2.2" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="Sx3.SSx1.p1.29.m29.4.4.2.3" xref="Sx3.SSx1.p1.29.m29.4.4.3a.cmml">,</mo><mrow id="Sx3.SSx1.p1.29.m29.4.4.2.2" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.cmml"><mi id="Sx3.SSx1.p1.29.m29.4.4.2.2.2" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.2.cmml">j</mi><mo id="Sx3.SSx1.p1.29.m29.4.4.2.2.1" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.1.cmml">∈</mo><mrow id="Sx3.SSx1.p1.29.m29.4.4.2.2.3.2" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.29.m29.4.4.2.2.3.2.1" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.3.1.1.cmml">[</mo><mi id="Sx3.SSx1.p1.29.m29.2.2" xref="Sx3.SSx1.p1.29.m29.2.2.cmml">C</mi><mo stretchy="false" id="Sx3.SSx1.p1.29.m29.4.4.2.2.3.2.2" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.29.m29.4b"><apply id="Sx3.SSx1.p1.29.m29.4.4.3.cmml" xref="Sx3.SSx1.p1.29.m29.4.4.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.29.m29.4.4.3a.cmml" xref="Sx3.SSx1.p1.29.m29.4.4.2.3">formulae-sequence</csymbol><apply id="Sx3.SSx1.p1.29.m29.3.3.1.1.cmml" xref="Sx3.SSx1.p1.29.m29.3.3.1.1"><in id="Sx3.SSx1.p1.29.m29.3.3.1.1.1.cmml" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.1"></in><ci id="Sx3.SSx1.p1.29.m29.3.3.1.1.2.cmml" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.2">𝑖</ci><apply id="Sx3.SSx1.p1.29.m29.3.3.1.1.3.1.cmml" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.3.2"><csymbol cd="latexml" id="Sx3.SSx1.p1.29.m29.3.3.1.1.3.1.1.cmml" xref="Sx3.SSx1.p1.29.m29.3.3.1.1.3.2.1">delimited-[]</csymbol><ci id="Sx3.SSx1.p1.29.m29.1.1.cmml" xref="Sx3.SSx1.p1.29.m29.1.1">𝑚</ci></apply></apply><apply id="Sx3.SSx1.p1.29.m29.4.4.2.2.cmml" xref="Sx3.SSx1.p1.29.m29.4.4.2.2"><in id="Sx3.SSx1.p1.29.m29.4.4.2.2.1.cmml" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.1"></in><ci id="Sx3.SSx1.p1.29.m29.4.4.2.2.2.cmml" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.2">𝑗</ci><apply id="Sx3.SSx1.p1.29.m29.4.4.2.2.3.1.cmml" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.3.2"><csymbol cd="latexml" id="Sx3.SSx1.p1.29.m29.4.4.2.2.3.1.1.cmml" xref="Sx3.SSx1.p1.29.m29.4.4.2.2.3.2.1">delimited-[]</csymbol><ci id="Sx3.SSx1.p1.29.m29.2.2.cmml" xref="Sx3.SSx1.p1.29.m29.2.2">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.29.m29.4c">i\in[m],j\in[C]</annotation></semantics></math>, the binary loss for the corresponding class can be defined as <math id="Sx3.SSx1.p1.30.m30.3" class="ltx_Math" alttext="\ell_{i}^{j}(x_{i},y_{i};\bm{\theta})" display="inline"><semantics id="Sx3.SSx1.p1.30.m30.3a"><mrow id="Sx3.SSx1.p1.30.m30.3.3" xref="Sx3.SSx1.p1.30.m30.3.3.cmml"><msubsup id="Sx3.SSx1.p1.30.m30.3.3.4" xref="Sx3.SSx1.p1.30.m30.3.3.4.cmml"><mi mathvariant="normal" id="Sx3.SSx1.p1.30.m30.3.3.4.2.2" xref="Sx3.SSx1.p1.30.m30.3.3.4.2.2.cmml">ℓ</mi><mi id="Sx3.SSx1.p1.30.m30.3.3.4.2.3" xref="Sx3.SSx1.p1.30.m30.3.3.4.2.3.cmml">i</mi><mi id="Sx3.SSx1.p1.30.m30.3.3.4.3" xref="Sx3.SSx1.p1.30.m30.3.3.4.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.30.m30.3.3.3" xref="Sx3.SSx1.p1.30.m30.3.3.3.cmml">​</mo><mrow id="Sx3.SSx1.p1.30.m30.3.3.2.2" xref="Sx3.SSx1.p1.30.m30.3.3.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.30.m30.3.3.2.2.3" xref="Sx3.SSx1.p1.30.m30.3.3.2.3.cmml">(</mo><msub id="Sx3.SSx1.p1.30.m30.2.2.1.1.1" xref="Sx3.SSx1.p1.30.m30.2.2.1.1.1.cmml"><mi id="Sx3.SSx1.p1.30.m30.2.2.1.1.1.2" xref="Sx3.SSx1.p1.30.m30.2.2.1.1.1.2.cmml">x</mi><mi id="Sx3.SSx1.p1.30.m30.2.2.1.1.1.3" xref="Sx3.SSx1.p1.30.m30.2.2.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.SSx1.p1.30.m30.3.3.2.2.4" xref="Sx3.SSx1.p1.30.m30.3.3.2.3.cmml">,</mo><msub id="Sx3.SSx1.p1.30.m30.3.3.2.2.2" xref="Sx3.SSx1.p1.30.m30.3.3.2.2.2.cmml"><mi id="Sx3.SSx1.p1.30.m30.3.3.2.2.2.2" xref="Sx3.SSx1.p1.30.m30.3.3.2.2.2.2.cmml">y</mi><mi id="Sx3.SSx1.p1.30.m30.3.3.2.2.2.3" xref="Sx3.SSx1.p1.30.m30.3.3.2.2.2.3.cmml">i</mi></msub><mo id="Sx3.SSx1.p1.30.m30.3.3.2.2.5" xref="Sx3.SSx1.p1.30.m30.3.3.2.3.cmml">;</mo><mi id="Sx3.SSx1.p1.30.m30.1.1" xref="Sx3.SSx1.p1.30.m30.1.1.cmml">𝜽</mi><mo stretchy="false" id="Sx3.SSx1.p1.30.m30.3.3.2.2.6" xref="Sx3.SSx1.p1.30.m30.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.30.m30.3b"><apply id="Sx3.SSx1.p1.30.m30.3.3.cmml" xref="Sx3.SSx1.p1.30.m30.3.3"><times id="Sx3.SSx1.p1.30.m30.3.3.3.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.3"></times><apply id="Sx3.SSx1.p1.30.m30.3.3.4.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.4"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.30.m30.3.3.4.1.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.4">superscript</csymbol><apply id="Sx3.SSx1.p1.30.m30.3.3.4.2.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.4"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.30.m30.3.3.4.2.1.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.4">subscript</csymbol><ci id="Sx3.SSx1.p1.30.m30.3.3.4.2.2.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.4.2.2">ℓ</ci><ci id="Sx3.SSx1.p1.30.m30.3.3.4.2.3.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.4.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p1.30.m30.3.3.4.3.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.4.3">𝑗</ci></apply><vector id="Sx3.SSx1.p1.30.m30.3.3.2.3.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.2.2"><apply id="Sx3.SSx1.p1.30.m30.2.2.1.1.1.cmml" xref="Sx3.SSx1.p1.30.m30.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.30.m30.2.2.1.1.1.1.cmml" xref="Sx3.SSx1.p1.30.m30.2.2.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.30.m30.2.2.1.1.1.2.cmml" xref="Sx3.SSx1.p1.30.m30.2.2.1.1.1.2">𝑥</ci><ci id="Sx3.SSx1.p1.30.m30.2.2.1.1.1.3.cmml" xref="Sx3.SSx1.p1.30.m30.2.2.1.1.1.3">𝑖</ci></apply><apply id="Sx3.SSx1.p1.30.m30.3.3.2.2.2.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.30.m30.3.3.2.2.2.1.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.30.m30.3.3.2.2.2.2.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.2.2.2.2">𝑦</ci><ci id="Sx3.SSx1.p1.30.m30.3.3.2.2.2.3.cmml" xref="Sx3.SSx1.p1.30.m30.3.3.2.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p1.30.m30.1.1.cmml" xref="Sx3.SSx1.p1.30.m30.1.1">𝜽</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.30.m30.3c">\ell_{i}^{j}(x_{i},y_{i};\bm{\theta})</annotation></semantics></math>. We formulate PFL problem according to <cite class="ltx_cite ltx_citemacro_citep">(Hanzely, Zhao, and Kolar <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> into the following optimization problem:</p>
<table id="Sx3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E1.m1.47" class="ltx_Math" alttext="\begin{gathered}\min_{\left\{\bm{\theta}_{1},\cdots,\bm{\theta}_{m}\right\}}f\left(\bm{\theta}_{1},\cdots,\bm{\theta}_{m}\right)=\frac{1}{m}\sum_{i=1}^{m}F_{i}\left(\bm{\theta}_{i}\right),\\
F_{i}\left(\bm{\theta}_{i}\right):=\mathbb{E}\left[\mathcal{L}_{({x},y)\sim\mathcal{D}_{i}}\left(\mathcal{S}^{i};\bm{\theta}_{i}\right)\right].\end{gathered}" display="block"><semantics id="Sx3.E1.m1.47a"><mtable displaystyle="true" rowspacing="0pt" id="Sx3.E1.m1.47.47.3"><mtr id="Sx3.E1.m1.47.47.3a"><mtd id="Sx3.E1.m1.47.47.3b"><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25"><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25.1"><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25.1.2"><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25.1.2.4"><munder id="Sx3.E1.m1.46.46.2.45.25.25.25.1.2.4.1"><mi id="Sx3.E1.m1.1.1.1.1.1.1" xref="Sx3.E1.m1.1.1.1.1.1.1.cmml">min</mi><mrow id="Sx3.E1.m1.2.2.2.2.2.2.1.3" xref="Sx3.E1.m1.2.2.2.2.2.2.1.4.cmml"><mo id="Sx3.E1.m1.2.2.2.2.2.2.1.3.3" xref="Sx3.E1.m1.2.2.2.2.2.2.1.4.cmml">{</mo><msub id="Sx3.E1.m1.2.2.2.2.2.2.1.2.1" xref="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.cmml"><mi id="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.2" xref="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.2.cmml">𝜽</mi><mn id="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.3" xref="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.3.cmml">1</mn></msub><mo id="Sx3.E1.m1.2.2.2.2.2.2.1.3.4" xref="Sx3.E1.m1.2.2.2.2.2.2.1.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.E1.m1.2.2.2.2.2.2.1.1" xref="Sx3.E1.m1.2.2.2.2.2.2.1.1.cmml">⋯</mi><mo id="Sx3.E1.m1.2.2.2.2.2.2.1.3.5" xref="Sx3.E1.m1.2.2.2.2.2.2.1.4.cmml">,</mo><msub id="Sx3.E1.m1.2.2.2.2.2.2.1.3.2" xref="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.cmml"><mi id="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.2" xref="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.2.cmml">𝜽</mi><mi id="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.3" xref="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.3.cmml">m</mi></msub><mo id="Sx3.E1.m1.2.2.2.2.2.2.1.3.6" xref="Sx3.E1.m1.2.2.2.2.2.2.1.4.cmml">}</mo></mrow></munder><mo lspace="0.167em" id="Sx3.E1.m1.46.46.2.45.25.25.25.1.2.4a">⁡</mo><mi id="Sx3.E1.m1.3.3.3.3.3.3" xref="Sx3.E1.m1.3.3.3.3.3.3.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.46.46.2.45.25.25.25.1.2.3">​</mo><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25.1.2.2.2"><mo id="Sx3.E1.m1.4.4.4.4.4.4">(</mo><msub id="Sx3.E1.m1.46.46.2.45.25.25.25.1.1.1.1.1"><mi id="Sx3.E1.m1.5.5.5.5.5.5" xref="Sx3.E1.m1.5.5.5.5.5.5.cmml">𝜽</mi><mn id="Sx3.E1.m1.6.6.6.6.6.6.1" xref="Sx3.E1.m1.6.6.6.6.6.6.1.cmml">1</mn></msub><mo id="Sx3.E1.m1.7.7.7.7.7.7">,</mo><mi mathvariant="normal" id="Sx3.E1.m1.8.8.8.8.8.8" xref="Sx3.E1.m1.8.8.8.8.8.8.cmml">⋯</mi><mo id="Sx3.E1.m1.9.9.9.9.9.9">,</mo><msub id="Sx3.E1.m1.46.46.2.45.25.25.25.1.2.2.2.2"><mi id="Sx3.E1.m1.10.10.10.10.10.10" xref="Sx3.E1.m1.10.10.10.10.10.10.cmml">𝜽</mi><mi id="Sx3.E1.m1.11.11.11.11.11.11.1" xref="Sx3.E1.m1.11.11.11.11.11.11.1.cmml">m</mi></msub><mo id="Sx3.E1.m1.12.12.12.12.12.12">)</mo></mrow></mrow><mo id="Sx3.E1.m1.13.13.13.13.13.13" xref="Sx3.E1.m1.13.13.13.13.13.13.cmml">=</mo><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3"><mfrac id="Sx3.E1.m1.14.14.14.14.14.14" xref="Sx3.E1.m1.14.14.14.14.14.14.cmml"><mn id="Sx3.E1.m1.14.14.14.14.14.14.2" xref="Sx3.E1.m1.14.14.14.14.14.14.2.cmml">1</mn><mi id="Sx3.E1.m1.14.14.14.14.14.14.3" xref="Sx3.E1.m1.14.14.14.14.14.14.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3.2">​</mo><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3.1"><munderover id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3.1.2"><mo movablelimits="false" id="Sx3.E1.m1.15.15.15.15.15.15" xref="Sx3.E1.m1.15.15.15.15.15.15.cmml">∑</mo><mrow id="Sx3.E1.m1.16.16.16.16.16.16.1" xref="Sx3.E1.m1.16.16.16.16.16.16.1.cmml"><mi id="Sx3.E1.m1.16.16.16.16.16.16.1.2" xref="Sx3.E1.m1.16.16.16.16.16.16.1.2.cmml">i</mi><mo id="Sx3.E1.m1.16.16.16.16.16.16.1.1" xref="Sx3.E1.m1.16.16.16.16.16.16.1.1.cmml">=</mo><mn id="Sx3.E1.m1.16.16.16.16.16.16.1.3" xref="Sx3.E1.m1.16.16.16.16.16.16.1.3.cmml">1</mn></mrow><mi id="Sx3.E1.m1.17.17.17.17.17.17.1" xref="Sx3.E1.m1.17.17.17.17.17.17.1.cmml">m</mi></munderover><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3.1.1"><msub id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3.1.1.3"><mi id="Sx3.E1.m1.18.18.18.18.18.18" xref="Sx3.E1.m1.18.18.18.18.18.18.cmml">F</mi><mi id="Sx3.E1.m1.19.19.19.19.19.19.1" xref="Sx3.E1.m1.19.19.19.19.19.19.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3.1.1.2">​</mo><mrow id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3.1.1.1.1"><mo id="Sx3.E1.m1.20.20.20.20.20.20">(</mo><msub id="Sx3.E1.m1.46.46.2.45.25.25.25.1.3.1.1.1.1.1"><mi id="Sx3.E1.m1.21.21.21.21.21.21" xref="Sx3.E1.m1.21.21.21.21.21.21.cmml">𝜽</mi><mi id="Sx3.E1.m1.22.22.22.22.22.22.1" xref="Sx3.E1.m1.22.22.22.22.22.22.1.cmml">i</mi></msub><mo id="Sx3.E1.m1.23.23.23.23.23.23">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="Sx3.E1.m1.24.24.24.24.24.24">,</mo></mrow></mtd></mtr><mtr id="Sx3.E1.m1.47.47.3c"><mtd id="Sx3.E1.m1.47.47.3d"><mrow id="Sx3.E1.m1.47.47.3.46.21.21.21"><mrow id="Sx3.E1.m1.47.47.3.46.21.21.21.1"><mrow id="Sx3.E1.m1.47.47.3.46.21.21.21.1.1"><msub id="Sx3.E1.m1.47.47.3.46.21.21.21.1.1.3"><mi id="Sx3.E1.m1.25.25.25.1.1.1" xref="Sx3.E1.m1.25.25.25.1.1.1.cmml">F</mi><mi id="Sx3.E1.m1.26.26.26.2.2.2.1" xref="Sx3.E1.m1.26.26.26.2.2.2.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.47.47.3.46.21.21.21.1.1.2">​</mo><mrow id="Sx3.E1.m1.47.47.3.46.21.21.21.1.1.1.1"><mo id="Sx3.E1.m1.27.27.27.3.3.3">(</mo><msub id="Sx3.E1.m1.47.47.3.46.21.21.21.1.1.1.1.1"><mi id="Sx3.E1.m1.28.28.28.4.4.4" xref="Sx3.E1.m1.28.28.28.4.4.4.cmml">𝜽</mi><mi id="Sx3.E1.m1.29.29.29.5.5.5.1" xref="Sx3.E1.m1.29.29.29.5.5.5.1.cmml">i</mi></msub><mo rspace="0.278em" id="Sx3.E1.m1.30.30.30.6.6.6">)</mo></mrow></mrow><mo rspace="0.278em" id="Sx3.E1.m1.31.31.31.7.7.7" xref="Sx3.E1.m1.31.31.31.7.7.7.cmml">:=</mo><mrow id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2"><mi id="Sx3.E1.m1.32.32.32.8.8.8" xref="Sx3.E1.m1.32.32.32.8.8.8.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2.2">​</mo><mrow id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2.1.1"><mo id="Sx3.E1.m1.33.33.33.9.9.9">[</mo><mrow id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2.1.1.1"><msub id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2.1.1.1.4"><mi class="ltx_font_mathcaligraphic" id="Sx3.E1.m1.34.34.34.10.10.10" xref="Sx3.E1.m1.34.34.34.10.10.10.cmml">ℒ</mi><mrow id="Sx3.E1.m1.35.35.35.11.11.11.1" xref="Sx3.E1.m1.35.35.35.11.11.11.1.cmml"><mrow id="Sx3.E1.m1.35.35.35.11.11.11.1.4.2" xref="Sx3.E1.m1.35.35.35.11.11.11.1.4.1.cmml"><mo stretchy="false" id="Sx3.E1.m1.35.35.35.11.11.11.1.4.2.1" xref="Sx3.E1.m1.35.35.35.11.11.11.1.4.1.cmml">(</mo><mi id="Sx3.E1.m1.35.35.35.11.11.11.1.1" xref="Sx3.E1.m1.35.35.35.11.11.11.1.1.cmml">x</mi><mo id="Sx3.E1.m1.35.35.35.11.11.11.1.4.2.2" xref="Sx3.E1.m1.35.35.35.11.11.11.1.4.1.cmml">,</mo><mi id="Sx3.E1.m1.35.35.35.11.11.11.1.2" xref="Sx3.E1.m1.35.35.35.11.11.11.1.2.cmml">y</mi><mo stretchy="false" id="Sx3.E1.m1.35.35.35.11.11.11.1.4.2.3" xref="Sx3.E1.m1.35.35.35.11.11.11.1.4.1.cmml">)</mo></mrow><mo id="Sx3.E1.m1.35.35.35.11.11.11.1.3" xref="Sx3.E1.m1.35.35.35.11.11.11.1.3.cmml">∼</mo><msub id="Sx3.E1.m1.35.35.35.11.11.11.1.5" xref="Sx3.E1.m1.35.35.35.11.11.11.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E1.m1.35.35.35.11.11.11.1.5.2" xref="Sx3.E1.m1.35.35.35.11.11.11.1.5.2.cmml">𝒟</mi><mi id="Sx3.E1.m1.35.35.35.11.11.11.1.5.3" xref="Sx3.E1.m1.35.35.35.11.11.11.1.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2.1.1.1.3">​</mo><mrow id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2.1.1.1.2.2"><mo id="Sx3.E1.m1.36.36.36.12.12.12">(</mo><msup id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2.1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="Sx3.E1.m1.37.37.37.13.13.13" xref="Sx3.E1.m1.37.37.37.13.13.13.cmml">𝒮</mi><mi id="Sx3.E1.m1.38.38.38.14.14.14.1" xref="Sx3.E1.m1.38.38.38.14.14.14.1.cmml">i</mi></msup><mo id="Sx3.E1.m1.39.39.39.15.15.15">;</mo><msub id="Sx3.E1.m1.47.47.3.46.21.21.21.1.2.1.1.1.2.2.2"><mi id="Sx3.E1.m1.40.40.40.16.16.16" xref="Sx3.E1.m1.40.40.40.16.16.16.cmml">𝜽</mi><mi id="Sx3.E1.m1.41.41.41.17.17.17.1" xref="Sx3.E1.m1.41.41.41.17.17.17.1.cmml">i</mi></msub><mo id="Sx3.E1.m1.42.42.42.18.18.18">)</mo></mrow></mrow><mo id="Sx3.E1.m1.43.43.43.19.19.19">]</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E1.m1.44.44.44.20.20.20">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx3.E1.m1.47b"><apply id="Sx3.E1.m1.45.45.1.1.1.3.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.cmml"><eq id="Sx3.E1.m1.13.13.13.13.13.13.cmml" xref="Sx3.E1.m1.13.13.13.13.13.13"></eq><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.2.cmml"><times id="Sx3.E1.m1.45.45.1.1.1.1.1.2.3.cmml"></times><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.2.4.cmml"><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.2.4.1.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.1.1.2.4.1.1.cmml">subscript</csymbol><min id="Sx3.E1.m1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.1.1.1.1.1.1"></min><set id="Sx3.E1.m1.2.2.2.2.2.2.1.4.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.3"><apply id="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.2.1"><csymbol cd="ambiguous" id="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.1.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.2.1">subscript</csymbol><ci id="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.2.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.2">𝜽</ci><cn type="integer" id="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.3.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.2.1.3">1</cn></apply><ci id="Sx3.E1.m1.2.2.2.2.2.2.1.1.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.1">⋯</ci><apply id="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.3.2"><csymbol cd="ambiguous" id="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.1.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.3.2">subscript</csymbol><ci id="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.2.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.2">𝜽</ci><ci id="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.3.cmml" xref="Sx3.E1.m1.2.2.2.2.2.2.1.3.2.3">𝑚</ci></apply></set></apply><ci id="Sx3.E1.m1.3.3.3.3.3.3.cmml" xref="Sx3.E1.m1.3.3.3.3.3.3">𝑓</ci></apply><vector id="Sx3.E1.m1.45.45.1.1.1.1.1.2.2.3.cmml"><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="Sx3.E1.m1.5.5.5.5.5.5.cmml" xref="Sx3.E1.m1.5.5.5.5.5.5">𝜽</ci><cn type="integer" id="Sx3.E1.m1.6.6.6.6.6.6.1.cmml" xref="Sx3.E1.m1.6.6.6.6.6.6.1">1</cn></apply><ci id="Sx3.E1.m1.8.8.8.8.8.8.cmml" xref="Sx3.E1.m1.8.8.8.8.8.8">⋯</ci><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.1.1.2.2.2.2.1.cmml">subscript</csymbol><ci id="Sx3.E1.m1.10.10.10.10.10.10.cmml" xref="Sx3.E1.m1.10.10.10.10.10.10">𝜽</ci><ci id="Sx3.E1.m1.11.11.11.11.11.11.1.cmml" xref="Sx3.E1.m1.11.11.11.11.11.11.1">𝑚</ci></apply></vector></apply><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.3.cmml"><times id="Sx3.E1.m1.45.45.1.1.1.1.1.3.2.cmml"></times><apply id="Sx3.E1.m1.14.14.14.14.14.14.cmml" xref="Sx3.E1.m1.14.14.14.14.14.14"><divide id="Sx3.E1.m1.14.14.14.14.14.14.1.cmml" xref="Sx3.E1.m1.14.14.14.14.14.14"></divide><cn type="integer" id="Sx3.E1.m1.14.14.14.14.14.14.2.cmml" xref="Sx3.E1.m1.14.14.14.14.14.14.2">1</cn><ci id="Sx3.E1.m1.14.14.14.14.14.14.3.cmml" xref="Sx3.E1.m1.14.14.14.14.14.14.3">𝑚</ci></apply><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.cmml"><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.2.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.2.1.cmml">superscript</csymbol><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.2.2.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.2.2.1.cmml">subscript</csymbol><sum id="Sx3.E1.m1.15.15.15.15.15.15.cmml" xref="Sx3.E1.m1.15.15.15.15.15.15"></sum><apply id="Sx3.E1.m1.16.16.16.16.16.16.1.cmml" xref="Sx3.E1.m1.16.16.16.16.16.16.1"><eq id="Sx3.E1.m1.16.16.16.16.16.16.1.1.cmml" xref="Sx3.E1.m1.16.16.16.16.16.16.1.1"></eq><ci id="Sx3.E1.m1.16.16.16.16.16.16.1.2.cmml" xref="Sx3.E1.m1.16.16.16.16.16.16.1.2">𝑖</ci><cn type="integer" id="Sx3.E1.m1.16.16.16.16.16.16.1.3.cmml" xref="Sx3.E1.m1.16.16.16.16.16.16.1.3">1</cn></apply></apply><ci id="Sx3.E1.m1.17.17.17.17.17.17.1.cmml" xref="Sx3.E1.m1.17.17.17.17.17.17.1">𝑚</ci></apply><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.1.cmml"><times id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.1.2.cmml"></times><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.1.3.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.1.3.1.cmml">subscript</csymbol><ci id="Sx3.E1.m1.18.18.18.18.18.18.cmml" xref="Sx3.E1.m1.18.18.18.18.18.18">𝐹</ci><ci id="Sx3.E1.m1.19.19.19.19.19.19.1.cmml" xref="Sx3.E1.m1.19.19.19.19.19.19.1">𝑖</ci></apply><apply id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.1.1.3.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="Sx3.E1.m1.21.21.21.21.21.21.cmml" xref="Sx3.E1.m1.21.21.21.21.21.21">𝜽</ci><ci id="Sx3.E1.m1.22.22.22.22.22.22.1.cmml" xref="Sx3.E1.m1.22.22.22.22.22.22.1">𝑖</ci></apply></apply></apply></apply></apply><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.cmml"><csymbol cd="latexml" id="Sx3.E1.m1.31.31.31.7.7.7.cmml" xref="Sx3.E1.m1.31.31.31.7.7.7">assign</csymbol><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.1.cmml"><times id="Sx3.E1.m1.45.45.1.1.1.2.2.1.2.cmml"></times><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.1.3.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.2.2.1.3.1.cmml">subscript</csymbol><ci id="Sx3.E1.m1.25.25.25.1.1.1.cmml" xref="Sx3.E1.m1.25.25.25.1.1.1">𝐹</ci><ci id="Sx3.E1.m1.26.26.26.2.2.2.1.cmml" xref="Sx3.E1.m1.26.26.26.2.2.2.1">𝑖</ci></apply><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.2.2.1.1.1.1.1.cmml">subscript</csymbol><ci id="Sx3.E1.m1.28.28.28.4.4.4.cmml" xref="Sx3.E1.m1.28.28.28.4.4.4">𝜽</ci><ci id="Sx3.E1.m1.29.29.29.5.5.5.1.cmml" xref="Sx3.E1.m1.29.29.29.5.5.5.1">𝑖</ci></apply></apply><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.2.cmml"><times id="Sx3.E1.m1.45.45.1.1.1.2.2.2.2.cmml"></times><ci id="Sx3.E1.m1.32.32.32.8.8.8.cmml" xref="Sx3.E1.m1.32.32.32.8.8.8">𝔼</ci><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.2.cmml"><csymbol cd="latexml" id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.2.1.cmml">delimited-[]</csymbol><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.cmml"><times id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.3.cmml"></times><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.4.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.4.1.cmml">subscript</csymbol><ci id="Sx3.E1.m1.34.34.34.10.10.10.cmml" xref="Sx3.E1.m1.34.34.34.10.10.10">ℒ</ci><apply id="Sx3.E1.m1.35.35.35.11.11.11.1.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1"><csymbol cd="latexml" id="Sx3.E1.m1.35.35.35.11.11.11.1.3.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1.3">similar-to</csymbol><interval closure="open" id="Sx3.E1.m1.35.35.35.11.11.11.1.4.1.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1.4.2"><ci id="Sx3.E1.m1.35.35.35.11.11.11.1.1.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1.1">𝑥</ci><ci id="Sx3.E1.m1.35.35.35.11.11.11.1.2.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1.2">𝑦</ci></interval><apply id="Sx3.E1.m1.35.35.35.11.11.11.1.5.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1.5"><csymbol cd="ambiguous" id="Sx3.E1.m1.35.35.35.11.11.11.1.5.1.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1.5">subscript</csymbol><ci id="Sx3.E1.m1.35.35.35.11.11.11.1.5.2.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1.5.2">𝒟</ci><ci id="Sx3.E1.m1.35.35.35.11.11.11.1.5.3.cmml" xref="Sx3.E1.m1.35.35.35.11.11.11.1.5.3">𝑖</ci></apply></apply></apply><list id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.2.3.cmml"><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="Sx3.E1.m1.37.37.37.13.13.13.cmml" xref="Sx3.E1.m1.37.37.37.13.13.13">𝒮</ci><ci id="Sx3.E1.m1.38.38.38.14.14.14.1.cmml" xref="Sx3.E1.m1.38.38.38.14.14.14.1">𝑖</ci></apply><apply id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.2.2.2.cmml"><csymbol cd="ambiguous" id="Sx3.E1.m1.45.45.1.1.1.2.2.2.1.1.1.2.2.2.1.cmml">subscript</csymbol><ci id="Sx3.E1.m1.40.40.40.16.16.16.cmml" xref="Sx3.E1.m1.40.40.40.16.16.16">𝜽</ci><ci id="Sx3.E1.m1.41.41.41.17.17.17.1.cmml" xref="Sx3.E1.m1.41.41.41.17.17.17.1">𝑖</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1.m1.47c">\begin{gathered}\min_{\left\{\bm{\theta}_{1},\cdots,\bm{\theta}_{m}\right\}}f\left(\bm{\theta}_{1},\cdots,\bm{\theta}_{m}\right)=\frac{1}{m}\sum_{i=1}^{m}F_{i}\left(\bm{\theta}_{i}\right),\\
F_{i}\left(\bm{\theta}_{i}\right):=\mathbb{E}\left[\mathcal{L}_{({x},y)\sim\mathcal{D}_{i}}\left(\mathcal{S}^{i};\bm{\theta}_{i}\right)\right].\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx1.p1.35" class="ltx_p">PFL learns a model <math id="Sx3.SSx1.p1.31.m1.1" class="ltx_Math" alttext="\bm{\theta_{i}}" display="inline"><semantics id="Sx3.SSx1.p1.31.m1.1a"><msub id="Sx3.SSx1.p1.31.m1.1.1" xref="Sx3.SSx1.p1.31.m1.1.1.cmml"><mi id="Sx3.SSx1.p1.31.m1.1.1.2" xref="Sx3.SSx1.p1.31.m1.1.1.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.31.m1.1.1.3" xref="Sx3.SSx1.p1.31.m1.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.31.m1.1b"><apply id="Sx3.SSx1.p1.31.m1.1.1.cmml" xref="Sx3.SSx1.p1.31.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.31.m1.1.1.1.cmml" xref="Sx3.SSx1.p1.31.m1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.31.m1.1.1.2.cmml" xref="Sx3.SSx1.p1.31.m1.1.1.2">𝜽</ci><ci id="Sx3.SSx1.p1.31.m1.1.1.3.cmml" xref="Sx3.SSx1.p1.31.m1.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.31.m1.1c">\bm{\theta_{i}}</annotation></semantics></math> for the <math id="Sx3.SSx1.p1.32.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx1.p1.32.m2.1a"><mi id="Sx3.SSx1.p1.32.m2.1.1" xref="Sx3.SSx1.p1.32.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.32.m2.1b"><ci id="Sx3.SSx1.p1.32.m2.1.1.cmml" xref="Sx3.SSx1.p1.32.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.32.m2.1c">i</annotation></semantics></math>-th client, the goal of which is to perform well on the local dataset <math id="Sx3.SSx1.p1.33.m3.1" class="ltx_Math" alttext="\mathcal{S}_{i}" display="inline"><semantics id="Sx3.SSx1.p1.33.m3.1a"><msub id="Sx3.SSx1.p1.33.m3.1.1" xref="Sx3.SSx1.p1.33.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.33.m3.1.1.2" xref="Sx3.SSx1.p1.33.m3.1.1.2.cmml">𝒮</mi><mi id="Sx3.SSx1.p1.33.m3.1.1.3" xref="Sx3.SSx1.p1.33.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.33.m3.1b"><apply id="Sx3.SSx1.p1.33.m3.1.1.cmml" xref="Sx3.SSx1.p1.33.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.33.m3.1.1.1.cmml" xref="Sx3.SSx1.p1.33.m3.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.33.m3.1.1.2.cmml" xref="Sx3.SSx1.p1.33.m3.1.1.2">𝒮</ci><ci id="Sx3.SSx1.p1.33.m3.1.1.3.cmml" xref="Sx3.SSx1.p1.33.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.33.m3.1c">\mathcal{S}_{i}</annotation></semantics></math>, and the local model parameters <math id="Sx3.SSx1.p1.34.m4.1" class="ltx_Math" alttext="\bm{\theta_{i}}" display="inline"><semantics id="Sx3.SSx1.p1.34.m4.1a"><msub id="Sx3.SSx1.p1.34.m4.1.1" xref="Sx3.SSx1.p1.34.m4.1.1.cmml"><mi id="Sx3.SSx1.p1.34.m4.1.1.2" xref="Sx3.SSx1.p1.34.m4.1.1.2.cmml">𝜽</mi><mi id="Sx3.SSx1.p1.34.m4.1.1.3" xref="Sx3.SSx1.p1.34.m4.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.34.m4.1b"><apply id="Sx3.SSx1.p1.34.m4.1.1.cmml" xref="Sx3.SSx1.p1.34.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.34.m4.1.1.1.cmml" xref="Sx3.SSx1.p1.34.m4.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.34.m4.1.1.2.cmml" xref="Sx3.SSx1.p1.34.m4.1.1.2">𝜽</ci><ci id="Sx3.SSx1.p1.34.m4.1.1.3.cmml" xref="Sx3.SSx1.p1.34.m4.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.34.m4.1c">\bm{\theta_{i}}</annotation></semantics></math> are often initialized with the global model <math id="Sx3.SSx1.p1.35.m5.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="Sx3.SSx1.p1.35.m5.1a"><mi id="Sx3.SSx1.p1.35.m5.1.1" xref="Sx3.SSx1.p1.35.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.35.m5.1b"><ci id="Sx3.SSx1.p1.35.m5.1.1.cmml" xref="Sx3.SSx1.p1.35.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.35.m5.1c">\bm{\theta}</annotation></semantics></math>. In PFL, many existing works add a regularizer either on the server-side to improve the aggregation scheme or on the client-side to improve the local optimization, but there is no agreed objective function so far. Most of the existing generic FL works can be easily adopted in PFL without extra processing. This is achieved by utilizing the locally trained model as its personalized model.
In our work, we propose a novel method that adopts binary training strategy to tackle the imbalanced problem and boost the generalization of client model. We do not need any extra information or other proxy data, and the objective can be formulated by Eq. (<a href="#Sx3.E1" title="In Problem formulation ‣ Federated Averaging via Binary Classification ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">FL binary loss function</h3>

<div id="Sx3.SSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.p1.1" class="ltx_p">The goal of our method is to train a efficient binary classifier for each class, a naive binary loss formulation of class <math id="Sx3.SSx2.p1.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="Sx3.SSx2.p1.1.m1.1a"><mi id="Sx3.SSx2.p1.1.m1.1.1" xref="Sx3.SSx2.p1.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.1.m1.1b"><ci id="Sx3.SSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.1.m1.1c">c</annotation></semantics></math> from the cross entropy (CE) loss is given by following:</p>
<table id="Sx3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E2.m1.7" class="ltx_Math" alttext="L_{\textit{BCE}}(c,q,y)=-[y{\log}(q)+(1-y){\log}(1-q)]," display="block"><semantics id="Sx3.E2.m1.7a"><mrow id="Sx3.E2.m1.7.7.1" xref="Sx3.E2.m1.7.7.1.1.cmml"><mrow id="Sx3.E2.m1.7.7.1.1" xref="Sx3.E2.m1.7.7.1.1.cmml"><mrow id="Sx3.E2.m1.7.7.1.1.3" xref="Sx3.E2.m1.7.7.1.1.3.cmml"><msub id="Sx3.E2.m1.7.7.1.1.3.2" xref="Sx3.E2.m1.7.7.1.1.3.2.cmml"><mi id="Sx3.E2.m1.7.7.1.1.3.2.2" xref="Sx3.E2.m1.7.7.1.1.3.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.E2.m1.7.7.1.1.3.2.3" xref="Sx3.E2.m1.7.7.1.1.3.2.3a.cmml">BCE</mtext></msub><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.7.7.1.1.3.1" xref="Sx3.E2.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="Sx3.E2.m1.7.7.1.1.3.3.2" xref="Sx3.E2.m1.7.7.1.1.3.3.1.cmml"><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.3.3.2.1" xref="Sx3.E2.m1.7.7.1.1.3.3.1.cmml">(</mo><mi id="Sx3.E2.m1.1.1" xref="Sx3.E2.m1.1.1.cmml">c</mi><mo id="Sx3.E2.m1.7.7.1.1.3.3.2.2" xref="Sx3.E2.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="Sx3.E2.m1.2.2" xref="Sx3.E2.m1.2.2.cmml">q</mi><mo id="Sx3.E2.m1.7.7.1.1.3.3.2.3" xref="Sx3.E2.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="Sx3.E2.m1.3.3" xref="Sx3.E2.m1.3.3.cmml">y</mi><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.3.3.2.4" xref="Sx3.E2.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E2.m1.7.7.1.1.2" xref="Sx3.E2.m1.7.7.1.1.2.cmml">=</mo><mrow id="Sx3.E2.m1.7.7.1.1.1" xref="Sx3.E2.m1.7.7.1.1.1.cmml"><mo id="Sx3.E2.m1.7.7.1.1.1a" xref="Sx3.E2.m1.7.7.1.1.1.cmml">−</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.1.1.1.2" xref="Sx3.E2.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.cmml"><mi id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.2" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.2.cmml">y</mi><mo lspace="0.167em" rspace="0em" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.1.cmml">​</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.2" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.1.cmml"><mi id="Sx3.E2.m1.4.4" xref="Sx3.E2.m1.4.4.cmml">log</mi><mo id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.2a" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">⁡</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.2.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.1.cmml"><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.2.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">(</mo><mi id="Sx3.E2.m1.5.5" xref="Sx3.E2.m1.5.5.cmml">q</mi><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.2.1.2" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E2.m1.7.7.1.1.1.1.1.1.3" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.3.cmml">+</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.cmml"><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.3" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.E2.m1.6.6" xref="Sx3.E2.m1.6.6.cmml">log</mi><mo id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1a" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml">⁡</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.2" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml">(</mo><mrow id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.cmml"><mn id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.2" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.1" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><mi id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.3" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.3" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E2.m1.7.7.1.1.1.1.1.3" xref="Sx3.E2.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="Sx3.E2.m1.7.7.1.2" xref="Sx3.E2.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2.m1.7b"><apply id="Sx3.E2.m1.7.7.1.1.cmml" xref="Sx3.E2.m1.7.7.1"><eq id="Sx3.E2.m1.7.7.1.1.2.cmml" xref="Sx3.E2.m1.7.7.1.1.2"></eq><apply id="Sx3.E2.m1.7.7.1.1.3.cmml" xref="Sx3.E2.m1.7.7.1.1.3"><times id="Sx3.E2.m1.7.7.1.1.3.1.cmml" xref="Sx3.E2.m1.7.7.1.1.3.1"></times><apply id="Sx3.E2.m1.7.7.1.1.3.2.cmml" xref="Sx3.E2.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.E2.m1.7.7.1.1.3.2.1.cmml" xref="Sx3.E2.m1.7.7.1.1.3.2">subscript</csymbol><ci id="Sx3.E2.m1.7.7.1.1.3.2.2.cmml" xref="Sx3.E2.m1.7.7.1.1.3.2.2">𝐿</ci><ci id="Sx3.E2.m1.7.7.1.1.3.2.3a.cmml" xref="Sx3.E2.m1.7.7.1.1.3.2.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="Sx3.E2.m1.7.7.1.1.3.2.3.cmml" xref="Sx3.E2.m1.7.7.1.1.3.2.3">BCE</mtext></ci></apply><vector id="Sx3.E2.m1.7.7.1.1.3.3.1.cmml" xref="Sx3.E2.m1.7.7.1.1.3.3.2"><ci id="Sx3.E2.m1.1.1.cmml" xref="Sx3.E2.m1.1.1">𝑐</ci><ci id="Sx3.E2.m1.2.2.cmml" xref="Sx3.E2.m1.2.2">𝑞</ci><ci id="Sx3.E2.m1.3.3.cmml" xref="Sx3.E2.m1.3.3">𝑦</ci></vector></apply><apply id="Sx3.E2.m1.7.7.1.1.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1"><minus id="Sx3.E2.m1.7.7.1.1.1.2.cmml" xref="Sx3.E2.m1.7.7.1.1.1"></minus><apply id="Sx3.E2.m1.7.7.1.1.1.1.2.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E2.m1.7.7.1.1.1.1.2.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1"><plus id="Sx3.E2.m1.7.7.1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.3"></plus><apply id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4"><times id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.1"></times><ci id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.2.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.2">𝑦</ci><apply id="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.4.3.2"><log id="Sx3.E2.m1.4.4.cmml" xref="Sx3.E2.m1.4.4"></log><ci id="Sx3.E2.m1.5.5.cmml" xref="Sx3.E2.m1.5.5">𝑞</ci></apply></apply><apply id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2"><times id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.3"></times><apply id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1"><minus id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">𝑦</ci></apply><apply id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1"><log id="Sx3.E2.m1.6.6.cmml" xref="Sx3.E2.m1.6.6"></log><apply id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1"><minus id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.1"></minus><cn type="integer" id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.2">1</cn><ci id="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="Sx3.E2.m1.7.7.1.1.1.1.1.1.2.2.1.1.1.3">𝑞</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2.m1.7c">L_{\textit{BCE}}(c,q,y)=-[y{\log}(q)+(1-y){\log}(1-q)],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.p1.4" class="ltx_p">where probability <math id="Sx3.SSx2.p1.2.m1.1" class="ltx_math_unparsed" alttext="q:=\sigma({g}(x;\bm{\theta}^{f};\bm{\theta}^{h})" display="inline"><semantics id="Sx3.SSx2.p1.2.m1.1a"><mrow id="Sx3.SSx2.p1.2.m1.1b"><mi id="Sx3.SSx2.p1.2.m1.1.2">q</mi><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx2.p1.2.m1.1.3">:=</mo><mi id="Sx3.SSx2.p1.2.m1.1.4">σ</mi><mrow id="Sx3.SSx2.p1.2.m1.1.5"><mo stretchy="false" id="Sx3.SSx2.p1.2.m1.1.5.1">(</mo><mi id="Sx3.SSx2.p1.2.m1.1.5.2">g</mi><mrow id="Sx3.SSx2.p1.2.m1.1.5.3"><mo stretchy="false" id="Sx3.SSx2.p1.2.m1.1.5.3.1">(</mo><mi id="Sx3.SSx2.p1.2.m1.1.1">x</mi><mo id="Sx3.SSx2.p1.2.m1.1.5.3.2">;</mo><msup id="Sx3.SSx2.p1.2.m1.1.5.3.3"><mi id="Sx3.SSx2.p1.2.m1.1.5.3.3.2">𝜽</mi><mi id="Sx3.SSx2.p1.2.m1.1.5.3.3.3">f</mi></msup><mo id="Sx3.SSx2.p1.2.m1.1.5.3.4">;</mo><msup id="Sx3.SSx2.p1.2.m1.1.5.3.5"><mi id="Sx3.SSx2.p1.2.m1.1.5.3.5.2">𝜽</mi><mi id="Sx3.SSx2.p1.2.m1.1.5.3.5.3">h</mi></msup><mo stretchy="false" id="Sx3.SSx2.p1.2.m1.1.5.3.6">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.2.m1.1c">q:=\sigma({g}(x;\bm{\theta}^{f};\bm{\theta}^{h})</annotation></semantics></math>, and <math id="Sx3.SSx2.p1.3.m2.2" class="ltx_Math" alttext="q\in[0,1]" display="inline"><semantics id="Sx3.SSx2.p1.3.m2.2a"><mrow id="Sx3.SSx2.p1.3.m2.2.3" xref="Sx3.SSx2.p1.3.m2.2.3.cmml"><mi id="Sx3.SSx2.p1.3.m2.2.3.2" xref="Sx3.SSx2.p1.3.m2.2.3.2.cmml">q</mi><mo id="Sx3.SSx2.p1.3.m2.2.3.1" xref="Sx3.SSx2.p1.3.m2.2.3.1.cmml">∈</mo><mrow id="Sx3.SSx2.p1.3.m2.2.3.3.2" xref="Sx3.SSx2.p1.3.m2.2.3.3.1.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.3.m2.2.3.3.2.1" xref="Sx3.SSx2.p1.3.m2.2.3.3.1.cmml">[</mo><mn id="Sx3.SSx2.p1.3.m2.1.1" xref="Sx3.SSx2.p1.3.m2.1.1.cmml">0</mn><mo id="Sx3.SSx2.p1.3.m2.2.3.3.2.2" xref="Sx3.SSx2.p1.3.m2.2.3.3.1.cmml">,</mo><mn id="Sx3.SSx2.p1.3.m2.2.2" xref="Sx3.SSx2.p1.3.m2.2.2.cmml">1</mn><mo stretchy="false" id="Sx3.SSx2.p1.3.m2.2.3.3.2.3" xref="Sx3.SSx2.p1.3.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.3.m2.2b"><apply id="Sx3.SSx2.p1.3.m2.2.3.cmml" xref="Sx3.SSx2.p1.3.m2.2.3"><in id="Sx3.SSx2.p1.3.m2.2.3.1.cmml" xref="Sx3.SSx2.p1.3.m2.2.3.1"></in><ci id="Sx3.SSx2.p1.3.m2.2.3.2.cmml" xref="Sx3.SSx2.p1.3.m2.2.3.2">𝑞</ci><interval closure="closed" id="Sx3.SSx2.p1.3.m2.2.3.3.1.cmml" xref="Sx3.SSx2.p1.3.m2.2.3.3.2"><cn type="integer" id="Sx3.SSx2.p1.3.m2.1.1.cmml" xref="Sx3.SSx2.p1.3.m2.1.1">0</cn><cn type="integer" id="Sx3.SSx2.p1.3.m2.2.2.cmml" xref="Sx3.SSx2.p1.3.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.3.m2.2c">q\in[0,1]</annotation></semantics></math> is the output after the operation of sigmoid activation, and <math id="Sx3.SSx2.p1.4.m3.2" class="ltx_Math" alttext="y=0,1" display="inline"><semantics id="Sx3.SSx2.p1.4.m3.2a"><mrow id="Sx3.SSx2.p1.4.m3.2.3" xref="Sx3.SSx2.p1.4.m3.2.3.cmml"><mi id="Sx3.SSx2.p1.4.m3.2.3.2" xref="Sx3.SSx2.p1.4.m3.2.3.2.cmml">y</mi><mo id="Sx3.SSx2.p1.4.m3.2.3.1" xref="Sx3.SSx2.p1.4.m3.2.3.1.cmml">=</mo><mrow id="Sx3.SSx2.p1.4.m3.2.3.3.2" xref="Sx3.SSx2.p1.4.m3.2.3.3.1.cmml"><mn id="Sx3.SSx2.p1.4.m3.1.1" xref="Sx3.SSx2.p1.4.m3.1.1.cmml">0</mn><mo id="Sx3.SSx2.p1.4.m3.2.3.3.2.1" xref="Sx3.SSx2.p1.4.m3.2.3.3.1.cmml">,</mo><mn id="Sx3.SSx2.p1.4.m3.2.2" xref="Sx3.SSx2.p1.4.m3.2.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.4.m3.2b"><apply id="Sx3.SSx2.p1.4.m3.2.3.cmml" xref="Sx3.SSx2.p1.4.m3.2.3"><eq id="Sx3.SSx2.p1.4.m3.2.3.1.cmml" xref="Sx3.SSx2.p1.4.m3.2.3.1"></eq><ci id="Sx3.SSx2.p1.4.m3.2.3.2.cmml" xref="Sx3.SSx2.p1.4.m3.2.3.2">𝑦</ci><list id="Sx3.SSx2.p1.4.m3.2.3.3.1.cmml" xref="Sx3.SSx2.p1.4.m3.2.3.3.2"><cn type="integer" id="Sx3.SSx2.p1.4.m3.1.1.cmml" xref="Sx3.SSx2.p1.4.m3.1.1">0</cn><cn type="integer" id="Sx3.SSx2.p1.4.m3.2.2.cmml" xref="Sx3.SSx2.p1.4.m3.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.4.m3.2c">y=0,1</annotation></semantics></math> is the samples true label. According to the class situation mentioned above, we rewrite the binary loss function (<a href="#Sx3.E2" title="In FL binary loss function ‣ Federated Averaging via Binary Classification ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) into the following formulation:</p>
<table id="Sx3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E3.m1.9" class="ltx_math_unparsed" alttext="L_{\textit{BCE}}(c,q,y)=\left\{\begin{aligned} &amp;-[y{\log}(q)+(1-y){\log}(1-q)],&amp;c\in C^{p}\\
&amp;-{\log}(1-q).&amp;c\in C^{n}\\
\end{aligned}\right." display="block"><semantics id="Sx3.E3.m1.9a"><mrow id="Sx3.E3.m1.9b"><msub id="Sx3.E3.m1.9.10"><mi id="Sx3.E3.m1.9.10.2">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.E3.m1.9.10.3">BCE</mtext></msub><mrow id="Sx3.E3.m1.9.11"><mo stretchy="false" id="Sx3.E3.m1.9.11.1">(</mo><mi id="Sx3.E3.m1.7.7">c</mi><mo id="Sx3.E3.m1.9.11.2">,</mo><mi id="Sx3.E3.m1.8.8">q</mi><mo id="Sx3.E3.m1.9.11.3">,</mo><mi id="Sx3.E3.m1.9.9">y</mi><mo stretchy="false" id="Sx3.E3.m1.9.11.4">)</mo></mrow><mo id="Sx3.E3.m1.9.12">=</mo><mrow id="Sx3.E3.m1.9.13"><mo id="Sx3.E3.m1.9.13.1">{</mo><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E3.m1.6.6"><mtr id="Sx3.E3.m1.6.6a"><mtd id="Sx3.E3.m1.6.6b"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E3.m1.6.6c"><mrow id="Sx3.E3.m1.4.4.4.4.4.4"><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1"><mo id="Sx3.E3.m1.4.4.4.4.4.4.1a">−</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1"><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.2">[</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1"><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.4"><mi id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.4.2">y</mi><mo lspace="0.167em" rspace="0em" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.4.1">​</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.4.3.2"><mi id="Sx3.E3.m1.1.1.1.1.1.1">log</mi><mo id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.4.3.2a">⁡</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.4.3.2.1"><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.4.3.2.1.1">(</mo><mi id="Sx3.E3.m1.2.2.2.2.2.2">q</mi><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.4.3.2.1.2">)</mo></mrow></mrow></mrow><mo id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.3">+</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2"><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.1.1.1"><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.1.1.1.2">(</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.1.1.1.1"><mn id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.1.1.1.1.2">1</mn><mo id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1">−</mo><mi id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.1.1.1.1.3">y</mi></mrow><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.1.1.1.3">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.3">​</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1"><mi id="Sx3.E3.m1.3.3.3.3.3.3">log</mi><mo id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1a">⁡</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1.1"><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1.1.2">(</mo><mrow id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1.1.1"><mn id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1.1.1.2">1</mn><mo id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1.1.1.1">−</mo><mi id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1.1.1.3">q</mi></mrow><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.1.2.2.1.1.3">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.1.1.1.3">]</mo></mrow></mrow><mo id="Sx3.E3.m1.4.4.4.4.4.4.2">,</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="Sx3.E3.m1.6.6d"><mrow id="Sx3.E3.m1.4.4.4.6.1"><mi id="Sx3.E3.m1.4.4.4.6.1.2">c</mi><mo id="Sx3.E3.m1.4.4.4.6.1.1">∈</mo><msup id="Sx3.E3.m1.4.4.4.6.1.3"><mi id="Sx3.E3.m1.4.4.4.6.1.3.2">C</mi><mi id="Sx3.E3.m1.4.4.4.6.1.3.3">p</mi></msup></mrow></mtd></mtr><mtr id="Sx3.E3.m1.6.6e"><mtd id="Sx3.E3.m1.6.6f"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E3.m1.6.6g"><mrow id="Sx3.E3.m1.6.6.6.2.2.2"><mrow id="Sx3.E3.m1.6.6.6.2.2.2.1"><mo rspace="0.167em" id="Sx3.E3.m1.6.6.6.2.2.2.1a">−</mo><mrow id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1"><mi id="Sx3.E3.m1.5.5.5.1.1.1">log</mi><mo id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1a">⁡</mo><mrow id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1.1"><mo stretchy="false" id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1.1.2">(</mo><mrow id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1.1.1"><mn id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1.1.1.2">1</mn><mo id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1.1.1.1">−</mo><mi id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1.1.1.3">q</mi></mrow><mo stretchy="false" id="Sx3.E3.m1.6.6.6.2.2.2.1.1.1.1.3">)</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E3.m1.6.6.6.2.2.2.2">.</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="Sx3.E3.m1.6.6h"><mrow id="Sx3.E3.m1.6.6.6.4.1"><mi id="Sx3.E3.m1.6.6.6.4.1.2">c</mi><mo id="Sx3.E3.m1.6.6.6.4.1.1">∈</mo><msup id="Sx3.E3.m1.6.6.6.4.1.3"><mi id="Sx3.E3.m1.6.6.6.4.1.3.2">C</mi><mi id="Sx3.E3.m1.6.6.6.4.1.3.3">n</mi></msup></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="Sx3.E3.m1.9c">L_{\textit{BCE}}(c,q,y)=\left\{\begin{aligned} &amp;-[y{\log}(q)+(1-y){\log}(1-q)],&amp;c\in C^{p}\\
&amp;-{\log}(1-q).&amp;c\in C^{n}\\
\end{aligned}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.p1.5" class="ltx_p">Here, we neglect the positive part loss item for <math id="Sx3.SSx2.p1.5.m1.1" class="ltx_Math" alttext="C^{n}" display="inline"><semantics id="Sx3.SSx2.p1.5.m1.1a"><msup id="Sx3.SSx2.p1.5.m1.1.1" xref="Sx3.SSx2.p1.5.m1.1.1.cmml"><mi id="Sx3.SSx2.p1.5.m1.1.1.2" xref="Sx3.SSx2.p1.5.m1.1.1.2.cmml">C</mi><mi id="Sx3.SSx2.p1.5.m1.1.1.3" xref="Sx3.SSx2.p1.5.m1.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.5.m1.1b"><apply id="Sx3.SSx2.p1.5.m1.1.1.cmml" xref="Sx3.SSx2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.5.m1.1.1.1.cmml" xref="Sx3.SSx2.p1.5.m1.1.1">superscript</csymbol><ci id="Sx3.SSx2.p1.5.m1.1.1.2.cmml" xref="Sx3.SSx2.p1.5.m1.1.1.2">𝐶</ci><ci id="Sx3.SSx2.p1.5.m1.1.1.3.cmml" xref="Sx3.SSx2.p1.5.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.5.m1.1c">C^{n}</annotation></semantics></math> due to the lack of positive samples. By employing this binary training framework, classes can avoid the enforced and competitive normalization induced by the “softmax” operation, and thus the unfair competition can be liberated to a certain extent. However, the imbalance problem within each binary classifier may become more serve due to the large amounts of negative samples and few or even no positive samples for the corresponding category in most cases. To address this problem, we propose to incorporate the under-sampling and hard sample mining strategies into the loss function.</p>
</div>
<section id="Sx3.SSx2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Incorporating under-sampling.</h4>

<div id="Sx3.SSx2.SSS0.Px1.p1" class="ltx_para">
<p id="Sx3.SSx2.SSS0.Px1.p1.1" class="ltx_p">The under-sampling strategy aimed to abandon low-value samples and re-balance data distribution to alleviate the imbalancing issue. In particular, we quantity the significance of different samples according to the output probability <math id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1a"><mi id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1.1" xref="Sx3.SSx2.SSS0.Px1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1b"><ci id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1c">q</annotation></semantics></math>. That is, the model will add samples, whose importance values are larger than the pre-defined threshold, into the current training batch, and the remained ones will be abandoned directly. This process is dynamic for each training epoch. The formulation of binary loss function that incorporates the under-sampling strategy is defined as:</p>
<table id="Sx3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E4.m1.36" class="ltx_math_unparsed" alttext="\begin{split}L_{\textit{BCE}}^{p}(q,y)&amp;=\left\{\begin{aligned} &amp;-{\log}(q),&amp;y=1,q&lt;m^{p}\\
&amp;-{\log}(1-q),&amp;y=0,q&gt;m^{n}\\
\end{aligned}\right.\\
L_{\textit{BCE}}^{n}(q,y)&amp;=-{\log}(1-q).\quad\quad y=0,q&gt;m^{nn}\end{split}" display="block"><semantics id="Sx3.E4.m1.36a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E4.m1.36.36"><mtr id="Sx3.E4.m1.36.36a"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E4.m1.36.36b"><mrow id="Sx3.E4.m1.8.8.8.8.8"><msubsup id="Sx3.E4.m1.8.8.8.8.8.10"><mi id="Sx3.E4.m1.1.1.1.1.1.1">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.E4.m1.2.2.2.2.2.2.1">BCE</mtext><mi id="Sx3.E4.m1.3.3.3.3.3.3.1">p</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.8.8.8.8.8.9">​</mo><mrow id="Sx3.E4.m1.8.8.8.8.8.11"><mo stretchy="false" id="Sx3.E4.m1.4.4.4.4.4.4">(</mo><mi id="Sx3.E4.m1.5.5.5.5.5.5">q</mi><mo id="Sx3.E4.m1.6.6.6.6.6.6">,</mo><mi id="Sx3.E4.m1.7.7.7.7.7.7">y</mi><mo stretchy="false" id="Sx3.E4.m1.8.8.8.8.8.8">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E4.m1.36.36c"><mrow id="Sx3.E4.m1.11.11.11.11.3"><mo id="Sx3.E4.m1.9.9.9.9.1.1">=</mo><mrow id="Sx3.E4.m1.11.11.11.11.3.4"><mo id="Sx3.E4.m1.10.10.10.10.2.2">{</mo><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E4.m1.11.11.11.11.3.3"><mtr id="Sx3.E4.m1.11.11.11.11.3.3a"><mtd id="Sx3.E4.m1.11.11.11.11.3.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E4.m1.11.11.11.11.3.3c"><mrow id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3"><mrow id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3.1"><mo rspace="0.167em" id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3.1a">−</mo><mrow id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3.1.2.2"><mi id="Sx3.E4.m1.11.11.11.11.3.3.1.1.1.1">log</mi><mo id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3.1.2.2a">⁡</mo><mrow id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3.1.2.2.1"><mo stretchy="false" id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3.1.2.2.1.1">(</mo><mi id="Sx3.E4.m1.11.11.11.11.3.3.2.2.2.2">q</mi><mo stretchy="false" id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3.1.2.2.1.2">)</mo></mrow></mrow></mrow><mo id="Sx3.E4.m1.11.11.11.11.3.3.3.3.3.3.2">,</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="Sx3.E4.m1.11.11.11.11.3.3d"><mrow id="Sx3.E4.m1.11.11.11.11.3.3.5.5.2.2"><mrow id="Sx3.E4.m1.11.11.11.11.3.3.4.4.1.1.1"><mi id="Sx3.E4.m1.11.11.11.11.3.3.4.4.1.1.1.2">y</mi><mo id="Sx3.E4.m1.11.11.11.11.3.3.4.4.1.1.1.1">=</mo><mn id="Sx3.E4.m1.11.11.11.11.3.3.4.4.1.1.1.3">1</mn></mrow><mo id="Sx3.E4.m1.11.11.11.11.3.3.5.5.2.2.3">,</mo><mrow id="Sx3.E4.m1.11.11.11.11.3.3.5.5.2.2.2"><mi id="Sx3.E4.m1.11.11.11.11.3.3.5.5.2.2.2.2">q</mi><mo id="Sx3.E4.m1.11.11.11.11.3.3.5.5.2.2.2.1">&lt;</mo><msup id="Sx3.E4.m1.11.11.11.11.3.3.5.5.2.2.2.3"><mi id="Sx3.E4.m1.11.11.11.11.3.3.5.5.2.2.2.3.2">m</mi><mi id="Sx3.E4.m1.11.11.11.11.3.3.5.5.2.2.2.3.3">p</mi></msup></mrow></mrow></mtd></mtr><mtr id="Sx3.E4.m1.11.11.11.11.3.3e"><mtd id="Sx3.E4.m1.11.11.11.11.3.3f"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E4.m1.11.11.11.11.3.3g"><mrow id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2"><mrow id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1"><mo rspace="0.167em" id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1a">−</mo><mrow id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1"><mi id="Sx3.E4.m1.11.11.11.11.3.3.6.1.1.1">log</mi><mo id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1a">⁡</mo><mrow id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1"><mo stretchy="false" id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.2">(</mo><mrow id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1"><mn id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.2">1</mn><mo id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.1">−</mo><mi id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.3">q</mi></mrow><mo stretchy="false" id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.3">)</mo></mrow></mrow></mrow><mo id="Sx3.E4.m1.11.11.11.11.3.3.7.2.2.2.2">,</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="Sx3.E4.m1.11.11.11.11.3.3h"><mrow id="Sx3.E4.m1.11.11.11.11.3.3.9.4.2.2"><mrow id="Sx3.E4.m1.11.11.11.11.3.3.8.3.1.1.1"><mi id="Sx3.E4.m1.11.11.11.11.3.3.8.3.1.1.1.2">y</mi><mo id="Sx3.E4.m1.11.11.11.11.3.3.8.3.1.1.1.1">=</mo><mn id="Sx3.E4.m1.11.11.11.11.3.3.8.3.1.1.1.3">0</mn></mrow><mo id="Sx3.E4.m1.11.11.11.11.3.3.9.4.2.2.3">,</mo><mrow id="Sx3.E4.m1.11.11.11.11.3.3.9.4.2.2.2"><mi id="Sx3.E4.m1.11.11.11.11.3.3.9.4.2.2.2.2">q</mi><mo id="Sx3.E4.m1.11.11.11.11.3.3.9.4.2.2.2.1">&gt;</mo><msup id="Sx3.E4.m1.11.11.11.11.3.3.9.4.2.2.2.3"><mi id="Sx3.E4.m1.11.11.11.11.3.3.9.4.2.2.2.3.2">m</mi><mi id="Sx3.E4.m1.11.11.11.11.3.3.9.4.2.2.2.3.3">n</mi></msup></mrow></mrow></mtd></mtr></mtable></mrow></mrow></mtd></mtr><mtr id="Sx3.E4.m1.36.36d"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E4.m1.36.36e"><mrow id="Sx3.E4.m1.19.19.19.8.8"><msubsup id="Sx3.E4.m1.19.19.19.8.8.10"><mi id="Sx3.E4.m1.12.12.12.1.1.1">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.E4.m1.13.13.13.2.2.2.1">BCE</mtext><mi id="Sx3.E4.m1.14.14.14.3.3.3.1">n</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.19.19.19.8.8.9">​</mo><mrow id="Sx3.E4.m1.19.19.19.8.8.11"><mo stretchy="false" id="Sx3.E4.m1.15.15.15.4.4.4">(</mo><mi id="Sx3.E4.m1.16.16.16.5.5.5">q</mi><mo id="Sx3.E4.m1.17.17.17.6.6.6">,</mo><mi id="Sx3.E4.m1.18.18.18.7.7.7">y</mi><mo stretchy="false" id="Sx3.E4.m1.19.19.19.8.8.8">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E4.m1.36.36f"><mrow id="Sx3.E4.m1.36.36.36.25.17"><mo rspace="0em" id="Sx3.E4.m1.20.20.20.9.1.1">=</mo><mo lspace="0em" id="Sx3.E4.m1.21.21.21.10.2.2">−</mo><mi id="Sx3.E4.m1.22.22.22.11.3.3">log</mi><mrow id="Sx3.E4.m1.36.36.36.25.17.18"><mo stretchy="false" id="Sx3.E4.m1.23.23.23.12.4.4">(</mo><mn id="Sx3.E4.m1.24.24.24.13.5.5">1</mn><mo id="Sx3.E4.m1.25.25.25.14.6.6">−</mo><mi id="Sx3.E4.m1.26.26.26.15.7.7">q</mi><mo stretchy="false" id="Sx3.E4.m1.27.27.27.16.8.8">)</mo></mrow><mo lspace="0em" id="Sx3.E4.m1.28.28.28.17.9.9">.</mo><mspace width="2.167em" id="Sx3.E4.m1.36.36.36.25.17.19"></mspace><mi id="Sx3.E4.m1.29.29.29.18.10.10">y</mi><mo id="Sx3.E4.m1.30.30.30.19.11.11">=</mo><mn id="Sx3.E4.m1.31.31.31.20.12.12">0</mn><mo id="Sx3.E4.m1.32.32.32.21.13.13">,</mo><mi id="Sx3.E4.m1.33.33.33.22.14.14">q</mi><mo id="Sx3.E4.m1.34.34.34.23.15.15">&gt;</mo><msup id="Sx3.E4.m1.36.36.36.25.17.20"><mi id="Sx3.E4.m1.35.35.35.24.16.16">m</mi><mrow id="Sx3.E4.m1.36.36.36.25.17.17.1"><mi id="Sx3.E4.m1.36.36.36.25.17.17.1.2">n</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.36.36.36.25.17.17.1.1">​</mo><mi id="Sx3.E4.m1.36.36.36.25.17.17.1.3">n</mi></mrow></msup></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="Sx3.E4.m1.36b">\begin{split}L_{\textit{BCE}}^{p}(q,y)&amp;=\left\{\begin{aligned} &amp;-{\log}(q),&amp;y=1,q&lt;m^{p}\\
&amp;-{\log}(1-q),&amp;y=0,q&gt;m^{n}\\
\end{aligned}\right.\\
L_{\textit{BCE}}^{n}(q,y)&amp;=-{\log}(1-q).\quad\quad y=0,q&gt;m^{nn}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx3.SSx2.SSS0.Px1.p2" class="ltx_para">
<p id="Sx3.SSx2.SSS0.Px1.p2.8" class="ltx_p">The binary loss function for <math id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="C^{p}" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1a"><msup id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1" xref="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.2" xref="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.2.cmml">C</mi><mi id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.3" xref="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1b"><apply id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.2">𝐶</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p2.1.m1.1c">C^{p}</annotation></semantics></math> is denoted as <math id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3" class="ltx_Math" alttext="L_{\textit{BCE}}^{p}(c,p,y)" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3a"><mrow id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.cmml"><msubsup id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.cmml"><mi id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.2" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.3" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.3a.cmml">BCE</mtext><mi id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.3" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.3.cmml">p</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.1" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.1.cmml">​</mo><mrow id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.2" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.2.1" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.1.cmml">(</mo><mi id="Sx3.SSx2.SSS0.Px1.p2.2.m2.1.1" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.1.1.cmml">c</mi><mo id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.2.2" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSS0.Px1.p2.2.m2.2.2" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.2.2.cmml">p</mi><mo id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.2.3" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.3" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.3.cmml">y</mi><mo stretchy="false" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.2.4" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3b"><apply id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4"><times id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.1"></times><apply id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2">superscript</csymbol><apply id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2">subscript</csymbol><ci id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.2">𝐿</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.3a.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.2.3">BCE</mtext></ci></apply><ci id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.2.3">𝑝</ci></apply><vector id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.4.3.2"><ci id="Sx3.SSx2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.1.1">𝑐</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.2.m2.2.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.2.2">𝑝</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.2.m2.3.3">𝑦</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p2.2.m2.3c">L_{\textit{BCE}}^{p}(c,p,y)</annotation></semantics></math>, while <math id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3" class="ltx_Math" alttext="L_{\textit{BCE}}^{n}(c,p,y)" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3a"><mrow id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.cmml"><msubsup id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.cmml"><mi id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.2" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.3" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.3a.cmml">BCE</mtext><mi id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.3" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.1" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.1.cmml">​</mo><mrow id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.2" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.2.1" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.1.cmml">(</mo><mi id="Sx3.SSx2.SSS0.Px1.p2.3.m3.1.1" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.1.1.cmml">c</mi><mo id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.2.2" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSS0.Px1.p2.3.m3.2.2" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.2.2.cmml">p</mi><mo id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.2.3" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.3" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.3.cmml">y</mi><mo stretchy="false" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.2.4" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3b"><apply id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4"><times id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.1"></times><apply id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2">superscript</csymbol><apply id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2">subscript</csymbol><ci id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.2">𝐿</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.3a.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.2.3">BCE</mtext></ci></apply><ci id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.2.3">𝑛</ci></apply><vector id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.4.3.2"><ci id="Sx3.SSx2.SSS0.Px1.p2.3.m3.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.1.1">𝑐</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.3.m3.2.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.2.2">𝑝</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.3.m3.3.3">𝑦</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p2.3.m3.3c">L_{\textit{BCE}}^{n}(c,p,y)</annotation></semantics></math> signifies the loss for <math id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="C^{n}" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1a"><msup id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1" xref="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.2" xref="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.2.cmml">C</mi><mi id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.3" xref="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1b"><apply id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.2">𝐶</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p2.4.m4.1c">C^{n}</annotation></semantics></math>, which only has negative samples. Some positive samples may have already been predicted correctly with probability near to one, and thus contribute little in the future training. The positive samples with low probability are more valuable and need to be better trained in this epoch. Conversely, we maintain the negative samples whose <math id="Sx3.SSx2.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p2.5.m5.1a"><mi id="Sx3.SSx2.SSS0.Px1.p2.5.m5.1.1" xref="Sx3.SSx2.SSS0.Px1.p2.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p2.5.m5.1b"><ci id="Sx3.SSx2.SSS0.Px1.p2.5.m5.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p2.5.m5.1c">q</annotation></semantics></math> is larger than a certain threshold. Three hyper-parameters <math id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="m^{p}" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1a"><msup id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1" xref="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.2" xref="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.2.cmml">m</mi><mi id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.3" xref="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1b"><apply id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.2">𝑚</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p2.6.m6.1c">m^{p}</annotation></semantics></math>, <math id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1" class="ltx_Math" alttext="m^{n}" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1a"><msup id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1" xref="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.cmml"><mi id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.2" xref="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.2.cmml">m</mi><mi id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.3" xref="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1b"><apply id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.2">𝑚</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p2.7.m7.1c">m^{n}</annotation></semantics></math>, and <math id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1" class="ltx_Math" alttext="m^{nn}" display="inline"><semantics id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1a"><msup id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.cmml"><mi id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.2" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.2.cmml">m</mi><mrow id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.cmml"><mi id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.2" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.1" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.3" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.3.cmml">n</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1b"><apply id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1">superscript</csymbol><ci id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.2">𝑚</ci><apply id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3"><times id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.1"></times><ci id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.2.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.2">𝑛</ci><ci id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.3.cmml" xref="Sx3.SSx2.SSS0.Px1.p2.8.m8.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p2.8.m8.1c">m^{nn}</annotation></semantics></math> should be determined for each class, and the same hyper-parameters are adopted for different clients for simplicity.</p>
</div>
</section>
<section id="Sx3.SSx2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Incorporating hard sample mining.</h4>

<div id="Sx3.SSx2.SSS0.Px2.p1" class="ltx_para">
<p id="Sx3.SSx2.SSS0.Px2.p1.2" class="ltx_p">To further alleviate the imbalancing issue, we incorporate the strategy for mining hard samples into the loss. The well-known Focal Loss <cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite> is widely-used loss that utilizes the hard sample mining strategy to re-balance the loss contribution of easy samples and hard samples. We follow this hard sample mining strategy to alleviate the imbalancing problem by focusing more on hard samples and lowering the significance of easy samples. This leads to the following final formulation for our final binary loss function:</p>
<table id="Sx3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E5.m1.40" class="ltx_math_unparsed" alttext="\begin{split}L_{\textit{BCE}}^{p}(q,y)&amp;=\left\{\begin{aligned} &amp;-(1-q)^{\sigma}{\log}(q),&amp;y=1,q&lt;m^{p}\\
&amp;-q^{\sigma}{\log}(1-q),&amp;y=0,q&gt;m^{n}\\
\end{aligned}\right.\\
L_{\textit{BCE}}^{n}(q,y)&amp;=-q^{\sigma}{\log}(1-q),\quad\quad\quad y=0,q&gt;m^{nn}\!\!\!\end{split}" display="block"><semantics id="Sx3.E5.m1.40a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E5.m1.40.40.2"><mtr id="Sx3.E5.m1.40.40.2a"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E5.m1.40.40.2b"><mrow id="Sx3.E5.m1.8.8.8.8.8"><msubsup id="Sx3.E5.m1.8.8.8.8.8.10"><mi id="Sx3.E5.m1.1.1.1.1.1.1">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.E5.m1.2.2.2.2.2.2.1">BCE</mtext><mi id="Sx3.E5.m1.3.3.3.3.3.3.1">p</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.8.8.8.8.8.9">​</mo><mrow id="Sx3.E5.m1.8.8.8.8.8.11"><mo stretchy="false" id="Sx3.E5.m1.4.4.4.4.4.4">(</mo><mi id="Sx3.E5.m1.5.5.5.5.5.5">q</mi><mo id="Sx3.E5.m1.6.6.6.6.6.6">,</mo><mi id="Sx3.E5.m1.7.7.7.7.7.7">y</mi><mo stretchy="false" id="Sx3.E5.m1.8.8.8.8.8.8">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E5.m1.40.40.2c"><mrow id="Sx3.E5.m1.11.11.11.11.3"><mo id="Sx3.E5.m1.9.9.9.9.1.1">=</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.4"><mo id="Sx3.E5.m1.10.10.10.10.2.2">{</mo><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E5.m1.11.11.11.11.3.3"><mtr id="Sx3.E5.m1.11.11.11.11.3.3a"><mtd id="Sx3.E5.m1.11.11.11.11.3.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E5.m1.11.11.11.11.3.3c"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1"><mo id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1a">−</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1"><msup id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1.1.1"><mo stretchy="false" id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1.1.1.2">(</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1.1.1.1"><mn id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1.1.1.1.2">1</mn><mo id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1.1.1.1.1">−</mo><mi id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1.1.1.1.3">q</mi></mrow><mo stretchy="false" id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1.1.1.3">)</mo></mrow><mi id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.1.3">σ</mi></msup><mo lspace="0.167em" rspace="0em" id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.2">​</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.3.2"><mi id="Sx3.E5.m1.11.11.11.11.3.3.1.1.1.1">log</mi><mo id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.3.2a">⁡</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.3.2.1"><mo stretchy="false" id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.3.2.1.1">(</mo><mi id="Sx3.E5.m1.11.11.11.11.3.3.2.2.2.2">q</mi><mo stretchy="false" id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.1.1.3.2.1.2">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E5.m1.11.11.11.11.3.3.3.3.3.3.2">,</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="Sx3.E5.m1.11.11.11.11.3.3d"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.5.5.2.2"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.4.4.1.1.1"><mi id="Sx3.E5.m1.11.11.11.11.3.3.4.4.1.1.1.2">y</mi><mo id="Sx3.E5.m1.11.11.11.11.3.3.4.4.1.1.1.1">=</mo><mn id="Sx3.E5.m1.11.11.11.11.3.3.4.4.1.1.1.3">1</mn></mrow><mo id="Sx3.E5.m1.11.11.11.11.3.3.5.5.2.2.3">,</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.5.5.2.2.2"><mi id="Sx3.E5.m1.11.11.11.11.3.3.5.5.2.2.2.2">q</mi><mo id="Sx3.E5.m1.11.11.11.11.3.3.5.5.2.2.2.1">&lt;</mo><msup id="Sx3.E5.m1.11.11.11.11.3.3.5.5.2.2.2.3"><mi id="Sx3.E5.m1.11.11.11.11.3.3.5.5.2.2.2.3.2">m</mi><mi id="Sx3.E5.m1.11.11.11.11.3.3.5.5.2.2.2.3.3">p</mi></msup></mrow></mrow></mtd></mtr><mtr id="Sx3.E5.m1.11.11.11.11.3.3e"><mtd id="Sx3.E5.m1.11.11.11.11.3.3f"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E5.m1.11.11.11.11.3.3g"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1"><mo id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1a">−</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1"><msup id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.3"><mi id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.3.2">q</mi><mi id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.3.3">σ</mi></msup><mo lspace="0.167em" rspace="0em" id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.2">​</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1"><mi id="Sx3.E5.m1.11.11.11.11.3.3.6.1.1.1">log</mi><mo id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1a">⁡</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1"><mo stretchy="false" id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.2">(</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.1"><mn id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.1.2">1</mn><mo id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.1.1">−</mo><mi id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.1.3">q</mi></mrow><mo stretchy="false" id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.1.1.1.1.1.3">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E5.m1.11.11.11.11.3.3.7.2.2.2.2">,</mo></mrow></mtd><mtd class="ltx_align_right" columnalign="right" id="Sx3.E5.m1.11.11.11.11.3.3h"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.9.4.2.2"><mrow id="Sx3.E5.m1.11.11.11.11.3.3.8.3.1.1.1"><mi id="Sx3.E5.m1.11.11.11.11.3.3.8.3.1.1.1.2">y</mi><mo id="Sx3.E5.m1.11.11.11.11.3.3.8.3.1.1.1.1">=</mo><mn id="Sx3.E5.m1.11.11.11.11.3.3.8.3.1.1.1.3">0</mn></mrow><mo id="Sx3.E5.m1.11.11.11.11.3.3.9.4.2.2.3">,</mo><mrow id="Sx3.E5.m1.11.11.11.11.3.3.9.4.2.2.2"><mi id="Sx3.E5.m1.11.11.11.11.3.3.9.4.2.2.2.2">q</mi><mo id="Sx3.E5.m1.11.11.11.11.3.3.9.4.2.2.2.1">&gt;</mo><msup id="Sx3.E5.m1.11.11.11.11.3.3.9.4.2.2.2.3"><mi id="Sx3.E5.m1.11.11.11.11.3.3.9.4.2.2.2.3.2">m</mi><mi id="Sx3.E5.m1.11.11.11.11.3.3.9.4.2.2.2.3.3">n</mi></msup></mrow></mrow></mtd></mtr></mtable></mrow></mrow></mtd></mtr><mtr id="Sx3.E5.m1.40.40.2d"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E5.m1.40.40.2e"><mrow id="Sx3.E5.m1.19.19.19.8.8"><msubsup id="Sx3.E5.m1.19.19.19.8.8.10"><mi id="Sx3.E5.m1.12.12.12.1.1.1">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.E5.m1.13.13.13.2.2.2.1">BCE</mtext><mi id="Sx3.E5.m1.14.14.14.3.3.3.1">n</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.19.19.19.8.8.9">​</mo><mrow id="Sx3.E5.m1.19.19.19.8.8.11"><mo stretchy="false" id="Sx3.E5.m1.15.15.15.4.4.4">(</mo><mi id="Sx3.E5.m1.16.16.16.5.5.5">q</mi><mo id="Sx3.E5.m1.17.17.17.6.6.6">,</mo><mi id="Sx3.E5.m1.18.18.18.7.7.7">y</mi><mo stretchy="false" id="Sx3.E5.m1.19.19.19.8.8.8">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E5.m1.40.40.2f"><mrow id="Sx3.E5.m1.40.40.2.40.29.21.21"><mrow id="Sx3.E5.m1.39.39.1.39.28.20.20.1"><mi id="Sx3.E5.m1.39.39.1.39.28.20.20.1.2"></mi><mo id="Sx3.E5.m1.20.20.20.9.1.1">=</mo><mrow id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1"><mo id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1a">−</mo><mrow id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1.1"><msup id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1.1.3"><mi id="Sx3.E5.m1.22.22.22.11.3.3">q</mi><mi id="Sx3.E5.m1.23.23.23.12.4.4.1">σ</mi></msup><mo lspace="0.167em" rspace="0em" id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1.1.2">​</mo><mrow id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1.1.1.1"><mi id="Sx3.E5.m1.24.24.24.13.5.5">log</mi><mo id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1.1.1.1a">⁡</mo><mrow id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1.1.1.1.1"><mo stretchy="false" id="Sx3.E5.m1.25.25.25.14.6.6">(</mo><mrow id="Sx3.E5.m1.39.39.1.39.28.20.20.1.1.1.1.1.1.1"><mn id="Sx3.E5.m1.26.26.26.15.7.7">1</mn><mo id="Sx3.E5.m1.27.27.27.16.8.8">−</mo><mi id="Sx3.E5.m1.28.28.28.17.9.9">q</mi></mrow><mo stretchy="false" id="Sx3.E5.m1.29.29.29.18.10.10">)</mo></mrow></mrow></mrow></mrow></mrow><mo rspace="3.167em" id="Sx3.E5.m1.30.30.30.19.11.11">,</mo><mrow id="Sx3.E5.m1.40.40.2.40.29.21.21.2"><mrow id="Sx3.E5.m1.40.40.2.40.29.21.21.2.1.1"><mi id="Sx3.E5.m1.31.31.31.20.12.12">y</mi><mo id="Sx3.E5.m1.32.32.32.21.13.13">=</mo><mn id="Sx3.E5.m1.33.33.33.22.14.14">0</mn></mrow><mo id="Sx3.E5.m1.34.34.34.23.15.15">,</mo><mrow id="Sx3.E5.m1.40.40.2.40.29.21.21.2.2.2"><mi id="Sx3.E5.m1.35.35.35.24.16.16">q</mi><mo id="Sx3.E5.m1.36.36.36.25.17.17">&gt;</mo><msup id="Sx3.E5.m1.40.40.2.40.29.21.21.2.2.2.1"><mi id="Sx3.E5.m1.37.37.37.26.18.18">m</mi><mrow id="Sx3.E5.m1.38.38.38.27.19.19.1"><mi id="Sx3.E5.m1.38.38.38.27.19.19.1.2">n</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.38.38.38.27.19.19.1.1">​</mo><mi id="Sx3.E5.m1.38.38.38.27.19.19.1.3">n</mi></mrow></msup></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="Sx3.E5.m1.40b">\begin{split}L_{\textit{BCE}}^{p}(q,y)&amp;=\left\{\begin{aligned} &amp;-(1-q)^{\sigma}{\log}(q),&amp;y=1,q&lt;m^{p}\\
&amp;-q^{\sigma}{\log}(1-q),&amp;y=0,q&gt;m^{n}\\
\end{aligned}\right.\\
L_{\textit{BCE}}^{n}(q,y)&amp;=-q^{\sigma}{\log}(1-q),\quad\quad\quad y=0,q&gt;m^{nn}\!\!\!\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx2.SSS0.Px2.p1.1" class="ltx_p">where <math id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1a"><mi id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1b"><ci id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1c">\sigma</annotation></semantics></math> is a hyper-parameter to control the degree of hard sample mining.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated Averaging via Binary classification</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">m</annotation></semantics></math> clients, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\mathcal{S}^{i}" display="inline"><semantics id="alg1.l1.m2.1a"><msup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">𝒮</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝒮</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathcal{S}^{i}</annotation></semantics></math> at the <math id="alg1.l1.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">i</annotation></semantics></math>-th client.

</div>
<div id="alg1.l2" class="ltx_listingline">  Server initializes parameters <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\bm{\theta}^{0}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝜽</mi><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝜽</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\bm{\theta}^{0}</annotation></semantics></math>.

</div>
<div id="alg1.l3" class="ltx_listingline">  Server sends the initialization to clients.

</div>
<div id="alg1.l4" class="ltx_listingline">  <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> t=0,1,2,…,T-1 <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg1.l5" class="ltx_listingline">   Server sends <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\theta^{t}" display="inline"><semantics id="alg1.l5.m1.1a"><msup id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">θ</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝜃</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\theta^{t}</annotation></semantics></math> to the <math id="alg1.l5.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l5.m2.1a"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">i</annotation></semantics></math>-th client

</div>
<div id="alg1.l6" class="ltx_listingline">   <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> i=1,2,…,C <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">    <math id="alg1.l7.m1.2" class="ltx_Math" alttext="\theta^{t}_{i}\leftarrow\bm{\theta^{t}}_{i},-\eta\nabla_{\bm{\theta^{t}}}\hat{\mathcal{R}}\left(\mathcal{S}^{i},\bm{\theta}_{i}\right)" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><msubsup id="alg1.l7.m1.2.2.4" xref="alg1.l7.m1.2.2.4.cmml"><mi id="alg1.l7.m1.2.2.4.2.2" xref="alg1.l7.m1.2.2.4.2.2.cmml">θ</mi><mi id="alg1.l7.m1.2.2.4.3" xref="alg1.l7.m1.2.2.4.3.cmml">i</mi><mi id="alg1.l7.m1.2.2.4.2.3" xref="alg1.l7.m1.2.2.4.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">←</mo><mrow id="alg1.l7.m1.2.2.2.2" xref="alg1.l7.m1.2.2.2.3.cmml"><mmultiscripts id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.2.2.cmml">𝜽</mi><mrow id="alg1.l7.m1.1.1.1.1.1a" xref="alg1.l7.m1.1.1.1.1.1.cmml"></mrow><mi id="alg1.l7.m1.1.1.1.1.1.2.3" xref="alg1.l7.m1.1.1.1.1.1.2.3.cmml">𝒕</mi><mi id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.3.cmml">i</mi><mrow id="alg1.l7.m1.1.1.1.1.1b" xref="alg1.l7.m1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="alg1.l7.m1.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.cmml"><mo id="alg1.l7.m1.2.2.2.2.2a" xref="alg1.l7.m1.2.2.2.2.2.cmml">−</mo><mrow id="alg1.l7.m1.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2.4" xref="alg1.l7.m1.2.2.2.2.2.2.4.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l7.m1.2.2.2.2.2.2.5" xref="alg1.l7.m1.2.2.2.2.2.2.5.cmml"><msub id="alg1.l7.m1.2.2.2.2.2.2.5.1" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.cmml"><mo rspace="0.167em" id="alg1.l7.m1.2.2.2.2.2.2.5.1.2" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.2.cmml">∇</mo><msup id="alg1.l7.m1.2.2.2.2.2.2.5.1.3" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.3.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2.5.1.3.2" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.3.2.cmml">𝜽</mi><mi id="alg1.l7.m1.2.2.2.2.2.2.5.1.3.3" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.3.3.cmml">𝒕</mi></msup></msub><mover accent="true" id="alg1.l7.m1.2.2.2.2.2.2.5.2" xref="alg1.l7.m1.2.2.2.2.2.2.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.2.2.2.2.2.2.5.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.5.2.2.cmml">ℛ</mi><mo id="alg1.l7.m1.2.2.2.2.2.2.5.2.1" xref="alg1.l7.m1.2.2.2.2.2.2.5.2.1.cmml">^</mo></mover></mrow><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.2.3a" xref="alg1.l7.m1.2.2.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l7.m1.2.2.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.2.3.cmml"><mo id="alg1.l7.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.2.2.3.cmml">(</mo><msup id="alg1.l7.m1.2.2.2.2.2.1.1.1.1" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.2.2.2.2.2.1.1.1.1.2" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1.2.cmml">𝒮</mi><mi id="alg1.l7.m1.2.2.2.2.2.1.1.1.1.3" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1.3.cmml">i</mi></msup><mo id="alg1.l7.m1.2.2.2.2.2.2.2.2.4" xref="alg1.l7.m1.2.2.2.2.2.2.2.3.cmml">,</mo><msub id="alg1.l7.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.2.2.2.2.cmml">𝜽</mi><mi id="alg1.l7.m1.2.2.2.2.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l7.m1.2.2.2.2.2.2.2.2.5" xref="alg1.l7.m1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3">←</ci><apply id="alg1.l7.m1.2.2.4.cmml" xref="alg1.l7.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.4.1.cmml" xref="alg1.l7.m1.2.2.4">subscript</csymbol><apply id="alg1.l7.m1.2.2.4.2.cmml" xref="alg1.l7.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.4.2.1.cmml" xref="alg1.l7.m1.2.2.4">superscript</csymbol><ci id="alg1.l7.m1.2.2.4.2.2.cmml" xref="alg1.l7.m1.2.2.4.2.2">𝜃</ci><ci id="alg1.l7.m1.2.2.4.2.3.cmml" xref="alg1.l7.m1.2.2.4.2.3">𝑡</ci></apply><ci id="alg1.l7.m1.2.2.4.3.cmml" xref="alg1.l7.m1.2.2.4.3">𝑖</ci></apply><list id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2"><apply id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l7.m1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.2.2">𝜽</ci><ci id="alg1.l7.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.2.3">𝒕</ci></apply><ci id="alg1.l7.m1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2"><minus id="alg1.l7.m1.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2"></minus><apply id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2"><times id="alg1.l7.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3"></times><ci id="alg1.l7.m1.2.2.2.2.2.2.4.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.4">𝜂</ci><apply id="alg1.l7.m1.2.2.2.2.2.2.5.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5"><apply id="alg1.l7.m1.2.2.2.2.2.2.5.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.2.5.1.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.1">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.5.1.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.2">∇</ci><apply id="alg1.l7.m1.2.2.2.2.2.2.5.1.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.2.5.1.3.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.3">superscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.5.1.3.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.3.2">𝜽</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.5.1.3.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.1.3.3">𝒕</ci></apply></apply><apply id="alg1.l7.m1.2.2.2.2.2.2.5.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.2"><ci id="alg1.l7.m1.2.2.2.2.2.2.5.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.2.1">^</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.5.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.5.2.2">ℛ</ci></apply></apply><interval closure="open" id="alg1.l7.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2.2"><apply id="alg1.l7.m1.2.2.2.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1.2">𝒮</ci><ci id="alg1.l7.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2.2.2.2">𝜽</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">\theta^{t}_{i}\leftarrow\bm{\theta^{t}}_{i},-\eta\nabla_{\bm{\theta^{t}}}\hat{\mathcal{R}}\left(\mathcal{S}^{i},\bm{\theta}_{i}\right)</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">    <math id="alg1.l8.m1.5" class="ltx_Math" alttext="\text{where }\hat{\mathcal{R}}\left(\mathcal{S}^{i},\bm{\theta}_{i}\right)=\mathbb{E}\left[\mathcal{L}^{\textit{BCE}}_{({x},y)\sim\mathcal{D}_{i}}\left(\mathcal{S}^{i};\bm{\theta}_{i}\right)\right]" display="inline"><semantics id="alg1.l8.m1.5a"><mrow id="alg1.l8.m1.5.5" xref="alg1.l8.m1.5.5.cmml"><mrow id="alg1.l8.m1.4.4.2" xref="alg1.l8.m1.4.4.2.cmml"><mtext id="alg1.l8.m1.4.4.2.4" xref="alg1.l8.m1.4.4.2.4a.cmml">where </mtext><mo lspace="0em" rspace="0em" id="alg1.l8.m1.4.4.2.3" xref="alg1.l8.m1.4.4.2.3.cmml">​</mo><mover accent="true" id="alg1.l8.m1.4.4.2.5" xref="alg1.l8.m1.4.4.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.4.4.2.5.2" xref="alg1.l8.m1.4.4.2.5.2.cmml">ℛ</mi><mo id="alg1.l8.m1.4.4.2.5.1" xref="alg1.l8.m1.4.4.2.5.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="alg1.l8.m1.4.4.2.3a" xref="alg1.l8.m1.4.4.2.3.cmml">​</mo><mrow id="alg1.l8.m1.4.4.2.2.2" xref="alg1.l8.m1.4.4.2.2.3.cmml"><mo id="alg1.l8.m1.4.4.2.2.2.3" xref="alg1.l8.m1.4.4.2.2.3.cmml">(</mo><msup id="alg1.l8.m1.3.3.1.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.3.3.1.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.1.1.2.cmml">𝒮</mi><mi id="alg1.l8.m1.3.3.1.1.1.1.3" xref="alg1.l8.m1.3.3.1.1.1.1.3.cmml">i</mi></msup><mo id="alg1.l8.m1.4.4.2.2.2.4" xref="alg1.l8.m1.4.4.2.2.3.cmml">,</mo><msub id="alg1.l8.m1.4.4.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.cmml">𝜽</mi><mi id="alg1.l8.m1.4.4.2.2.2.2.3" xref="alg1.l8.m1.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l8.m1.4.4.2.2.2.5" xref="alg1.l8.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l8.m1.5.5.4" xref="alg1.l8.m1.5.5.4.cmml">=</mo><mrow id="alg1.l8.m1.5.5.3" xref="alg1.l8.m1.5.5.3.cmml"><mi id="alg1.l8.m1.5.5.3.3" xref="alg1.l8.m1.5.5.3.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.5.5.3.2" xref="alg1.l8.m1.5.5.3.2.cmml">​</mo><mrow id="alg1.l8.m1.5.5.3.1.1" xref="alg1.l8.m1.5.5.3.1.2.cmml"><mo id="alg1.l8.m1.5.5.3.1.1.2" xref="alg1.l8.m1.5.5.3.1.2.1.cmml">[</mo><mrow id="alg1.l8.m1.5.5.3.1.1.1" xref="alg1.l8.m1.5.5.3.1.1.1.cmml"><msubsup id="alg1.l8.m1.5.5.3.1.1.1.4" xref="alg1.l8.m1.5.5.3.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.5.5.3.1.1.1.4.2.2" xref="alg1.l8.m1.5.5.3.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml"><mrow id="alg1.l8.m1.2.2.2.4.2" xref="alg1.l8.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.2.4.2.1" xref="alg1.l8.m1.2.2.2.4.1.cmml">(</mo><mi id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml">x</mi><mo id="alg1.l8.m1.2.2.2.4.2.2" xref="alg1.l8.m1.2.2.2.4.1.cmml">,</mo><mi id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l8.m1.2.2.2.4.2.3" xref="alg1.l8.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="alg1.l8.m1.2.2.2.3" xref="alg1.l8.m1.2.2.2.3.cmml">∼</mo><msub id="alg1.l8.m1.2.2.2.5" xref="alg1.l8.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.2.2.2.5.2" xref="alg1.l8.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="alg1.l8.m1.2.2.2.5.3" xref="alg1.l8.m1.2.2.2.5.3.cmml">i</mi></msub></mrow><mtext class="ltx_mathvariant_italic" id="alg1.l8.m1.5.5.3.1.1.1.4.2.3" xref="alg1.l8.m1.5.5.3.1.1.1.4.2.3a.cmml">BCE</mtext></msubsup><mo lspace="0em" rspace="0em" id="alg1.l8.m1.5.5.3.1.1.1.3" xref="alg1.l8.m1.5.5.3.1.1.1.3.cmml">​</mo><mrow id="alg1.l8.m1.5.5.3.1.1.1.2.2" xref="alg1.l8.m1.5.5.3.1.1.1.2.3.cmml"><mo id="alg1.l8.m1.5.5.3.1.1.1.2.2.3" xref="alg1.l8.m1.5.5.3.1.1.1.2.3.cmml">(</mo><msup id="alg1.l8.m1.5.5.3.1.1.1.1.1.1" xref="alg1.l8.m1.5.5.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.5.5.3.1.1.1.1.1.1.2" xref="alg1.l8.m1.5.5.3.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="alg1.l8.m1.5.5.3.1.1.1.1.1.1.3" xref="alg1.l8.m1.5.5.3.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="alg1.l8.m1.5.5.3.1.1.1.2.2.4" xref="alg1.l8.m1.5.5.3.1.1.1.2.3.cmml">;</mo><msub id="alg1.l8.m1.5.5.3.1.1.1.2.2.2" xref="alg1.l8.m1.5.5.3.1.1.1.2.2.2.cmml"><mi id="alg1.l8.m1.5.5.3.1.1.1.2.2.2.2" xref="alg1.l8.m1.5.5.3.1.1.1.2.2.2.2.cmml">𝜽</mi><mi id="alg1.l8.m1.5.5.3.1.1.1.2.2.2.3" xref="alg1.l8.m1.5.5.3.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l8.m1.5.5.3.1.1.1.2.2.5" xref="alg1.l8.m1.5.5.3.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l8.m1.5.5.3.1.1.3" xref="alg1.l8.m1.5.5.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.5b"><apply id="alg1.l8.m1.5.5.cmml" xref="alg1.l8.m1.5.5"><eq id="alg1.l8.m1.5.5.4.cmml" xref="alg1.l8.m1.5.5.4"></eq><apply id="alg1.l8.m1.4.4.2.cmml" xref="alg1.l8.m1.4.4.2"><times id="alg1.l8.m1.4.4.2.3.cmml" xref="alg1.l8.m1.4.4.2.3"></times><ci id="alg1.l8.m1.4.4.2.4a.cmml" xref="alg1.l8.m1.4.4.2.4"><mtext id="alg1.l8.m1.4.4.2.4.cmml" xref="alg1.l8.m1.4.4.2.4">where </mtext></ci><apply id="alg1.l8.m1.4.4.2.5.cmml" xref="alg1.l8.m1.4.4.2.5"><ci id="alg1.l8.m1.4.4.2.5.1.cmml" xref="alg1.l8.m1.4.4.2.5.1">^</ci><ci id="alg1.l8.m1.4.4.2.5.2.cmml" xref="alg1.l8.m1.4.4.2.5.2">ℛ</ci></apply><interval closure="open" id="alg1.l8.m1.4.4.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2"><apply id="alg1.l8.m1.3.3.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1">superscript</csymbol><ci id="alg1.l8.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.2">𝒮</ci><ci id="alg1.l8.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l8.m1.4.4.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2">𝜽</ci><ci id="alg1.l8.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="alg1.l8.m1.5.5.3.cmml" xref="alg1.l8.m1.5.5.3"><times id="alg1.l8.m1.5.5.3.2.cmml" xref="alg1.l8.m1.5.5.3.2"></times><ci id="alg1.l8.m1.5.5.3.3.cmml" xref="alg1.l8.m1.5.5.3.3">𝔼</ci><apply id="alg1.l8.m1.5.5.3.1.2.cmml" xref="alg1.l8.m1.5.5.3.1.1"><csymbol cd="latexml" id="alg1.l8.m1.5.5.3.1.2.1.cmml" xref="alg1.l8.m1.5.5.3.1.1.2">delimited-[]</csymbol><apply id="alg1.l8.m1.5.5.3.1.1.1.cmml" xref="alg1.l8.m1.5.5.3.1.1.1"><times id="alg1.l8.m1.5.5.3.1.1.1.3.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.3"></times><apply id="alg1.l8.m1.5.5.3.1.1.1.4.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.3.1.1.1.4.1.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.4">subscript</csymbol><apply id="alg1.l8.m1.5.5.3.1.1.1.4.2.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.3.1.1.1.4.2.1.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.4">superscript</csymbol><ci id="alg1.l8.m1.5.5.3.1.1.1.4.2.2.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.4.2.2">ℒ</ci><ci id="alg1.l8.m1.5.5.3.1.1.1.4.2.3a.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.4.2.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="alg1.l8.m1.5.5.3.1.1.1.4.2.3.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.4.2.3">BCE</mtext></ci></apply><apply id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2"><csymbol cd="latexml" id="alg1.l8.m1.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="alg1.l8.m1.2.2.2.4.1.cmml" xref="alg1.l8.m1.2.2.2.4.2"><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">𝑥</ci><ci id="alg1.l8.m1.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2">𝑦</ci></interval><apply id="alg1.l8.m1.2.2.2.5.cmml" xref="alg1.l8.m1.2.2.2.5"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.5.1.cmml" xref="alg1.l8.m1.2.2.2.5">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.5.2.cmml" xref="alg1.l8.m1.2.2.2.5.2">𝒟</ci><ci id="alg1.l8.m1.2.2.2.5.3.cmml" xref="alg1.l8.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><list id="alg1.l8.m1.5.5.3.1.1.1.2.3.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.2.2"><apply id="alg1.l8.m1.5.5.3.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.3.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l8.m1.5.5.3.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.1.1.1.2">𝒮</ci><ci id="alg1.l8.m1.5.5.3.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l8.m1.5.5.3.1.1.1.2.2.2.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.3.1.1.1.2.2.2.1.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.5.5.3.1.1.1.2.2.2.2.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.2.2.2.2">𝜽</ci><ci id="alg1.l8.m1.5.5.3.1.1.1.2.2.2.3.cmml" xref="alg1.l8.m1.5.5.3.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.5c">\text{where }\hat{\mathcal{R}}\left(\mathcal{S}^{i},\bm{\theta}_{i}\right)=\mathbb{E}\left[\mathcal{L}^{\textit{BCE}}_{({x},y)\sim\mathcal{D}_{i}}\left(\mathcal{S}^{i};\bm{\theta}_{i}\right)\right]</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">    The <math id="alg1.l9.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l9.m1.1a"><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">i</annotation></semantics></math>-th client maintain <math id="alg1.l9.m2.1" class="ltx_Math" alttext="\bm{\theta}_{i}^{t}" display="inline"><semantics id="alg1.l9.m2.1a"><msubsup id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2.2" xref="alg1.l9.m2.1.1.2.2.cmml">𝜽</mi><mi id="alg1.l9.m2.1.1.2.3" xref="alg1.l9.m2.1.1.2.3.cmml">i</mi><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">superscript</csymbol><apply id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.2.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.2.cmml" xref="alg1.l9.m2.1.1.2.2">𝜽</ci><ci id="alg1.l9.m2.1.1.2.3.cmml" xref="alg1.l9.m2.1.1.2.3">𝑖</ci></apply><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\bm{\theta}_{i}^{t}</annotation></semantics></math> as the current PM.

</div>
<div id="alg1.l10" class="ltx_listingline">    The <math id="alg1.l10.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l10.m1.1a"><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">i</annotation></semantics></math>-th client sends <math id="alg1.l10.m2.1" class="ltx_Math" alttext="\bm{\theta}^{t}_{i}" display="inline"><semantics id="alg1.l10.m2.1a"><msubsup id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi id="alg1.l10.m2.1.1.2.2" xref="alg1.l10.m2.1.1.2.2.cmml">𝜽</mi><mi id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">i</mi><mi id="alg1.l10.m2.1.1.2.3" xref="alg1.l10.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1">subscript</csymbol><apply id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.2.1.cmml" xref="alg1.l10.m2.1.1">superscript</csymbol><ci id="alg1.l10.m2.1.1.2.2.cmml" xref="alg1.l10.m2.1.1.2.2">𝜽</ci><ci id="alg1.l10.m2.1.1.2.3.cmml" xref="alg1.l10.m2.1.1.2.3">𝑡</ci></apply><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\bm{\theta}^{t}_{i}</annotation></semantics></math> to the server.

</div>
<div id="alg1.l11" class="ltx_listingline">   <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg1.l12" class="ltx_listingline">   Server updates the model parameters by averaging: <math id="alg1.l12.m1.3" class="ltx_Math" alttext="\bm{\theta}^{t+1}=\sum\limits_{i\in[C]}\frac{|\mathcal{S}^{i}|}{|\mathcal{S}|}\bm{\theta}^{t}_{i}" display="inline"><semantics id="alg1.l12.m1.3a"><mrow id="alg1.l12.m1.3.4" xref="alg1.l12.m1.3.4.cmml"><msup id="alg1.l12.m1.3.4.2" xref="alg1.l12.m1.3.4.2.cmml"><mi id="alg1.l12.m1.3.4.2.2" xref="alg1.l12.m1.3.4.2.2.cmml">𝜽</mi><mrow id="alg1.l12.m1.3.4.2.3" xref="alg1.l12.m1.3.4.2.3.cmml"><mi id="alg1.l12.m1.3.4.2.3.2" xref="alg1.l12.m1.3.4.2.3.2.cmml">t</mi><mo id="alg1.l12.m1.3.4.2.3.1" xref="alg1.l12.m1.3.4.2.3.1.cmml">+</mo><mn id="alg1.l12.m1.3.4.2.3.3" xref="alg1.l12.m1.3.4.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" id="alg1.l12.m1.3.4.1" xref="alg1.l12.m1.3.4.1.cmml">=</mo><mrow id="alg1.l12.m1.3.4.3" xref="alg1.l12.m1.3.4.3.cmml"><munder id="alg1.l12.m1.3.4.3.1" xref="alg1.l12.m1.3.4.3.1.cmml"><mo movablelimits="false" id="alg1.l12.m1.3.4.3.1.2" xref="alg1.l12.m1.3.4.3.1.2.cmml">∑</mo><mrow id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.3" xref="alg1.l12.m1.1.1.1.3.cmml">i</mi><mo id="alg1.l12.m1.1.1.1.2" xref="alg1.l12.m1.1.1.1.2.cmml">∈</mo><mrow id="alg1.l12.m1.1.1.1.4.2" xref="alg1.l12.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="alg1.l12.m1.1.1.1.4.2.1" xref="alg1.l12.m1.1.1.1.4.1.1.cmml">[</mo><mi id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml">C</mi><mo stretchy="false" id="alg1.l12.m1.1.1.1.4.2.2" xref="alg1.l12.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder><mrow id="alg1.l12.m1.3.4.3.2" xref="alg1.l12.m1.3.4.3.2.cmml"><mfrac id="alg1.l12.m1.3.3" xref="alg1.l12.m1.3.3.cmml"><mrow id="alg1.l12.m1.2.2.1.1" xref="alg1.l12.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.2" xref="alg1.l12.m1.2.2.1.2.1.cmml">|</mo><msup id="alg1.l12.m1.2.2.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.2.2.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.2.cmml">𝒮</mi><mi id="alg1.l12.m1.2.2.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.3" xref="alg1.l12.m1.2.2.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l12.m1.3.3.2.3" xref="alg1.l12.m1.3.3.2.2.cmml"><mo stretchy="false" id="alg1.l12.m1.3.3.2.3.1" xref="alg1.l12.m1.3.3.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.3.3.2.1" xref="alg1.l12.m1.3.3.2.1.cmml">𝒮</mi><mo stretchy="false" id="alg1.l12.m1.3.3.2.3.2" xref="alg1.l12.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l12.m1.3.4.3.2.1" xref="alg1.l12.m1.3.4.3.2.1.cmml">​</mo><msubsup id="alg1.l12.m1.3.4.3.2.2" xref="alg1.l12.m1.3.4.3.2.2.cmml"><mi id="alg1.l12.m1.3.4.3.2.2.2.2" xref="alg1.l12.m1.3.4.3.2.2.2.2.cmml">𝜽</mi><mi id="alg1.l12.m1.3.4.3.2.2.3" xref="alg1.l12.m1.3.4.3.2.2.3.cmml">i</mi><mi id="alg1.l12.m1.3.4.3.2.2.2.3" xref="alg1.l12.m1.3.4.3.2.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.3b"><apply id="alg1.l12.m1.3.4.cmml" xref="alg1.l12.m1.3.4"><eq id="alg1.l12.m1.3.4.1.cmml" xref="alg1.l12.m1.3.4.1"></eq><apply id="alg1.l12.m1.3.4.2.cmml" xref="alg1.l12.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.4.2.1.cmml" xref="alg1.l12.m1.3.4.2">superscript</csymbol><ci id="alg1.l12.m1.3.4.2.2.cmml" xref="alg1.l12.m1.3.4.2.2">𝜽</ci><apply id="alg1.l12.m1.3.4.2.3.cmml" xref="alg1.l12.m1.3.4.2.3"><plus id="alg1.l12.m1.3.4.2.3.1.cmml" xref="alg1.l12.m1.3.4.2.3.1"></plus><ci id="alg1.l12.m1.3.4.2.3.2.cmml" xref="alg1.l12.m1.3.4.2.3.2">𝑡</ci><cn type="integer" id="alg1.l12.m1.3.4.2.3.3.cmml" xref="alg1.l12.m1.3.4.2.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.3.4.3.cmml" xref="alg1.l12.m1.3.4.3"><apply id="alg1.l12.m1.3.4.3.1.cmml" xref="alg1.l12.m1.3.4.3.1"><csymbol cd="ambiguous" id="alg1.l12.m1.3.4.3.1.1.cmml" xref="alg1.l12.m1.3.4.3.1">subscript</csymbol><sum id="alg1.l12.m1.3.4.3.1.2.cmml" xref="alg1.l12.m1.3.4.3.1.2"></sum><apply id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"><in id="alg1.l12.m1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.2"></in><ci id="alg1.l12.m1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.3">𝑖</ci><apply id="alg1.l12.m1.1.1.1.4.1.cmml" xref="alg1.l12.m1.1.1.1.4.2"><csymbol cd="latexml" id="alg1.l12.m1.1.1.1.4.1.1.cmml" xref="alg1.l12.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">𝐶</ci></apply></apply></apply><apply id="alg1.l12.m1.3.4.3.2.cmml" xref="alg1.l12.m1.3.4.3.2"><times id="alg1.l12.m1.3.4.3.2.1.cmml" xref="alg1.l12.m1.3.4.3.2.1"></times><apply id="alg1.l12.m1.3.3.cmml" xref="alg1.l12.m1.3.3"><divide id="alg1.l12.m1.3.3.3.cmml" xref="alg1.l12.m1.3.3"></divide><apply id="alg1.l12.m1.2.2.1.2.cmml" xref="alg1.l12.m1.2.2.1.1"><abs id="alg1.l12.m1.2.2.1.2.1.cmml" xref="alg1.l12.m1.2.2.1.1.2"></abs><apply id="alg1.l12.m1.2.2.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1">superscript</csymbol><ci id="alg1.l12.m1.2.2.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.2">𝒮</ci><ci id="alg1.l12.m1.2.2.1.1.1.3.cmml" xref="alg1.l12.m1.2.2.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l12.m1.3.3.2.2.cmml" xref="alg1.l12.m1.3.3.2.3"><abs id="alg1.l12.m1.3.3.2.2.1.cmml" xref="alg1.l12.m1.3.3.2.3.1"></abs><ci id="alg1.l12.m1.3.3.2.1.cmml" xref="alg1.l12.m1.3.3.2.1">𝒮</ci></apply></apply><apply id="alg1.l12.m1.3.4.3.2.2.cmml" xref="alg1.l12.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.4.3.2.2.1.cmml" xref="alg1.l12.m1.3.4.3.2.2">subscript</csymbol><apply id="alg1.l12.m1.3.4.3.2.2.2.cmml" xref="alg1.l12.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.4.3.2.2.2.1.cmml" xref="alg1.l12.m1.3.4.3.2.2">superscript</csymbol><ci id="alg1.l12.m1.3.4.3.2.2.2.2.cmml" xref="alg1.l12.m1.3.4.3.2.2.2.2">𝜽</ci><ci id="alg1.l12.m1.3.4.3.2.2.2.3.cmml" xref="alg1.l12.m1.3.4.3.2.2.2.3">𝑡</ci></apply><ci id="alg1.l12.m1.3.4.3.2.2.3.cmml" xref="alg1.l12.m1.3.4.3.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.3c">\bm{\theta}^{t+1}=\sum\limits_{i\in[C]}\frac{|\mathcal{S}^{i}|}{|\mathcal{S}|}\bm{\theta}^{t}_{i}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">  <span id="alg1.l13.1" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg1.l14" class="ltx_listingline">  <span id="alg1.l14.1" class="ltx_text ltx_font_bold">Output:</span> PM<math id="alg1.l14.m1.1" class="ltx_Math" alttext=":\{\sum_{i}^{m}\bm{\theta_{i}}^{\mathrm{T}}\}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">:</mo><mrow id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.cmml">{</mo><mrow id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.cmml"><msubsup id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mo lspace="0em" id="alg1.l14.m1.1.1.1.1.1.1.2.2" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.2.3" xref="alg1.l14.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml">m</mi></msubsup><mmultiscripts id="alg1.l14.m1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.2.2.2" xref="alg1.l14.m1.1.1.1.1.1.2.2.2.cmml">𝜽</mi><mi id="alg1.l14.m1.1.1.1.1.1.2.2.3" xref="alg1.l14.m1.1.1.1.1.1.2.2.3.cmml">𝒊</mi><mrow id="alg1.l14.m1.1.1.1.1.1.2a" xref="alg1.l14.m1.1.1.1.1.1.2.cmml"></mrow><mrow id="alg1.l14.m1.1.1.1.1.1.2b" xref="alg1.l14.m1.1.1.1.1.1.2.cmml"></mrow><mi mathvariant="normal" id="alg1.l14.m1.1.1.1.1.1.2.3" xref="alg1.l14.m1.1.1.1.1.1.2.3.cmml">T</mi></mmultiscripts></mrow><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">:</ci><csymbol cd="latexml" id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">absent</csymbol><set id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1"><apply id="alg1.l14.m1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1"><apply id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1">subscript</csymbol><sum id="alg1.l14.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2.2"></sum><ci id="alg1.l14.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="alg1.l14.m1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.2.2">𝜽</ci><ci id="alg1.l14.m1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.2.3">𝒊</ci></apply><ci id="alg1.l14.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.3">T</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">:\{\sum_{i}^{m}\bm{\theta_{i}}^{\mathrm{T}}\}</annotation></semantics></math>, GM<math id="alg1.l14.m2.1" class="ltx_Math" alttext=":\{\bm{\theta}^{\mathrm{T}}\}" display="inline"><semantics id="alg1.l14.m2.1a"><mrow id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><mi id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml">:</mo><mrow id="alg1.l14.m2.1.1.1.1" xref="alg1.l14.m2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l14.m2.1.1.1.1.2" xref="alg1.l14.m2.1.1.1.2.cmml">{</mo><msup id="alg1.l14.m2.1.1.1.1.1" xref="alg1.l14.m2.1.1.1.1.1.cmml"><mi id="alg1.l14.m2.1.1.1.1.1.2" xref="alg1.l14.m2.1.1.1.1.1.2.cmml">𝜽</mi><mi mathvariant="normal" id="alg1.l14.m2.1.1.1.1.1.3" xref="alg1.l14.m2.1.1.1.1.1.3.cmml">T</mi></msup><mo stretchy="false" id="alg1.l14.m2.1.1.1.1.3" xref="alg1.l14.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><ci id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">:</ci><csymbol cd="latexml" id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3">absent</csymbol><set id="alg1.l14.m2.1.1.1.2.cmml" xref="alg1.l14.m2.1.1.1.1"><apply id="alg1.l14.m2.1.1.1.1.1.cmml" xref="alg1.l14.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.1.1.1.1.cmml" xref="alg1.l14.m2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l14.m2.1.1.1.1.1.2.cmml" xref="alg1.l14.m2.1.1.1.1.1.2">𝜽</ci><ci id="alg1.l14.m2.1.1.1.1.1.3.cmml" xref="alg1.l14.m2.1.1.1.1.1.3">T</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">:\{\bm{\theta}^{\mathrm{T}}\}</annotation></semantics></math>

</div>
</div>
</figure>
</section>
</section>
<section id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Training strategy</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p id="Sx3.SSx3.p1.3" class="ltx_p">Our method adopts the binary training strategy in the local learning process. Firstly, an encoder including an embedding network and a classifier maps the input data into the low-dimensional representation. Then the <span id="Sx3.SSx3.p1.3.1" class="ltx_text ltx_font_bold">sigmoid</span> activation is applied to get the final logit, which lies in the interval <math id="Sx3.SSx3.p1.1.m1.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="Sx3.SSx3.p1.1.m1.2a"><mrow id="Sx3.SSx3.p1.1.m1.2.3.2" xref="Sx3.SSx3.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.1.m1.2.3.2.1" xref="Sx3.SSx3.p1.1.m1.2.3.1.cmml">[</mo><mn id="Sx3.SSx3.p1.1.m1.1.1" xref="Sx3.SSx3.p1.1.m1.1.1.cmml">0</mn><mo id="Sx3.SSx3.p1.1.m1.2.3.2.2" xref="Sx3.SSx3.p1.1.m1.2.3.1.cmml">,</mo><mn id="Sx3.SSx3.p1.1.m1.2.2" xref="Sx3.SSx3.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="Sx3.SSx3.p1.1.m1.2.3.2.3" xref="Sx3.SSx3.p1.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.1.m1.2b"><interval closure="closed" id="Sx3.SSx3.p1.1.m1.2.3.1.cmml" xref="Sx3.SSx3.p1.1.m1.2.3.2"><cn type="integer" id="Sx3.SSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1">0</cn><cn type="integer" id="Sx3.SSx3.p1.1.m1.2.2.cmml" xref="Sx3.SSx3.p1.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.1.m1.2c">[0,1]</annotation></semantics></math>. Our method trains an independent classifier for each category to complete the binary classification task and the feature extractor is shared, more details are depicted in Figure <a href="#Sx2.F3" title="Figure 3 ‣ Federated learning ‣ Related work ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. In practice, the classifier can be any neural network, and the output is just a scalar logit for the corresponding class. Our method does not need any extra modifications on the structure of the neural network or other auxiliary information, and we only need to apply sigmoid activation and adopt our proposed binary loss function presented in Eq. (<a href="#Sx3.E5" title="In Incorporating hard sample mining. ‣ FL binary loss function ‣ Federated Averaging via Binary Classification ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).
The empirical loss of the <math id="Sx3.SSx3.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx3.p1.2.m2.1a"><mi id="Sx3.SSx3.p1.2.m2.1.1" xref="Sx3.SSx3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.2.m2.1b"><ci id="Sx3.SSx3.p1.2.m2.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.2.m2.1c">i</annotation></semantics></math>-th client on the local dataset <math id="Sx3.SSx3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{S}^{i}" display="inline"><semantics id="Sx3.SSx3.p1.3.m3.1a"><msup id="Sx3.SSx3.p1.3.m3.1.1" xref="Sx3.SSx3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p1.3.m3.1.1.2" xref="Sx3.SSx3.p1.3.m3.1.1.2.cmml">𝒮</mi><mi id="Sx3.SSx3.p1.3.m3.1.1.3" xref="Sx3.SSx3.p1.3.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.3.m3.1b"><apply id="Sx3.SSx3.p1.3.m3.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1">superscript</csymbol><ci id="Sx3.SSx3.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.2">𝒮</ci><ci id="Sx3.SSx3.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.3.m3.1c">\mathcal{S}^{i}</annotation></semantics></math> can be given by:</p>
<table id="Sx3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E6.m1.47" class="ltx_Math" alttext="\begin{split}\mathbb{E}\left[\mathcal{L}^{\textit{BCE}}_{({x},y)\sim\mathcal{D}_{i}}\left(\mathcal{S}^{i};\bm{\theta_{i}}\right)\right]:=&amp;\frac{1}{|\mathcal{S}^{i}|}\left(\sum_{j}^{C_{i}^{p}}{L}^{p}_{\textit{BCE}}(\mathcal{S}^{i};\bm{\theta}_{i})\right.\\
&amp;\left.+\sum_{j}^{C_{i}^{n}}L_{\textit{BCE}}^{n}(\mathcal{S}^{i};\bm{\theta}_{i})\right).\end{split}" display="block"><semantics id="Sx3.E6.m1.47a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E6.m1.47.47.2"><mtr id="Sx3.E6.m1.47.47.2a"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E6.m1.47.47.2b"><mrow id="Sx3.E6.m1.47.47.2.46.30.15"><mrow id="Sx3.E6.m1.47.47.2.46.30.15.15"><mi id="Sx3.E6.m1.1.1.1.1.1.1" xref="Sx3.E6.m1.1.1.1.1.1.1.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.47.47.2.46.30.15.15.2" xref="Sx3.E6.m1.46.46.1.1.1.cmml">​</mo><mrow id="Sx3.E6.m1.47.47.2.46.30.15.15.1.1"><mo id="Sx3.E6.m1.2.2.2.2.2.2" xref="Sx3.E6.m1.46.46.1.1.1.cmml">[</mo><mrow id="Sx3.E6.m1.47.47.2.46.30.15.15.1.1.1"><msubsup id="Sx3.E6.m1.47.47.2.46.30.15.15.1.1.1.4"><mi class="ltx_font_mathcaligraphic" id="Sx3.E6.m1.3.3.3.3.3.3" xref="Sx3.E6.m1.3.3.3.3.3.3.cmml">ℒ</mi><mrow id="Sx3.E6.m1.5.5.5.5.5.5.1" xref="Sx3.E6.m1.5.5.5.5.5.5.1.cmml"><mrow id="Sx3.E6.m1.5.5.5.5.5.5.1.4.2" xref="Sx3.E6.m1.5.5.5.5.5.5.1.4.1.cmml"><mo stretchy="false" id="Sx3.E6.m1.5.5.5.5.5.5.1.4.2.1" xref="Sx3.E6.m1.5.5.5.5.5.5.1.4.1.cmml">(</mo><mi id="Sx3.E6.m1.5.5.5.5.5.5.1.1" xref="Sx3.E6.m1.5.5.5.5.5.5.1.1.cmml">x</mi><mo id="Sx3.E6.m1.5.5.5.5.5.5.1.4.2.2" xref="Sx3.E6.m1.5.5.5.5.5.5.1.4.1.cmml">,</mo><mi id="Sx3.E6.m1.5.5.5.5.5.5.1.2" xref="Sx3.E6.m1.5.5.5.5.5.5.1.2.cmml">y</mi><mo stretchy="false" id="Sx3.E6.m1.5.5.5.5.5.5.1.4.2.3" xref="Sx3.E6.m1.5.5.5.5.5.5.1.4.1.cmml">)</mo></mrow><mo id="Sx3.E6.m1.5.5.5.5.5.5.1.3" xref="Sx3.E6.m1.5.5.5.5.5.5.1.3.cmml">∼</mo><msub id="Sx3.E6.m1.5.5.5.5.5.5.1.5" xref="Sx3.E6.m1.5.5.5.5.5.5.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E6.m1.5.5.5.5.5.5.1.5.2" xref="Sx3.E6.m1.5.5.5.5.5.5.1.5.2.cmml">𝒟</mi><mi id="Sx3.E6.m1.5.5.5.5.5.5.1.5.3" xref="Sx3.E6.m1.5.5.5.5.5.5.1.5.3.cmml">i</mi></msub></mrow><mtext class="ltx_mathvariant_italic" id="Sx3.E6.m1.4.4.4.4.4.4.1" xref="Sx3.E6.m1.4.4.4.4.4.4.1a.cmml">BCE</mtext></msubsup><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.47.47.2.46.30.15.15.1.1.1.3" xref="Sx3.E6.m1.46.46.1.1.1.cmml">​</mo><mrow id="Sx3.E6.m1.47.47.2.46.30.15.15.1.1.1.2.2"><mo id="Sx3.E6.m1.6.6.6.6.6.6" xref="Sx3.E6.m1.46.46.1.1.1.cmml">(</mo><msup id="Sx3.E6.m1.47.47.2.46.30.15.15.1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="Sx3.E6.m1.7.7.7.7.7.7" xref="Sx3.E6.m1.7.7.7.7.7.7.cmml">𝒮</mi><mi id="Sx3.E6.m1.8.8.8.8.8.8.1" xref="Sx3.E6.m1.8.8.8.8.8.8.1.cmml">i</mi></msup><mo id="Sx3.E6.m1.9.9.9.9.9.9" xref="Sx3.E6.m1.46.46.1.1.1.cmml">;</mo><msub id="Sx3.E6.m1.47.47.2.46.30.15.15.1.1.1.2.2.2"><mi id="Sx3.E6.m1.10.10.10.10.10.10" xref="Sx3.E6.m1.10.10.10.10.10.10.cmml">𝜽</mi><mi id="Sx3.E6.m1.11.11.11.11.11.11.1" xref="Sx3.E6.m1.11.11.11.11.11.11.1.cmml">𝒊</mi></msub><mo id="Sx3.E6.m1.12.12.12.12.12.12" xref="Sx3.E6.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="Sx3.E6.m1.13.13.13.13.13.13" xref="Sx3.E6.m1.46.46.1.1.1.cmml">]</mo></mrow></mrow><mo rspace="0.278em" id="Sx3.E6.m1.14.14.14.14.14.14" xref="Sx3.E6.m1.14.14.14.14.14.14.cmml">:=</mo><mi id="Sx3.E6.m1.47.47.2.46.30.15.16" xref="Sx3.E6.m1.46.46.1.1.1.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E6.m1.47.47.2c"><mrow id="Sx3.E6.m1.29.29.29.29.15"><mfrac id="Sx3.E6.m1.15.15.15.15.1.1" xref="Sx3.E6.m1.15.15.15.15.1.1.cmml"><mn id="Sx3.E6.m1.15.15.15.15.1.1.3" xref="Sx3.E6.m1.15.15.15.15.1.1.3.cmml">1</mn><mrow id="Sx3.E6.m1.15.15.15.15.1.1.1.1" xref="Sx3.E6.m1.15.15.15.15.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E6.m1.15.15.15.15.1.1.1.1.2" xref="Sx3.E6.m1.15.15.15.15.1.1.1.2.1.cmml">|</mo><msup id="Sx3.E6.m1.15.15.15.15.1.1.1.1.1" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.2" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.2.cmml">𝒮</mi><mi id="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.3" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="Sx3.E6.m1.15.15.15.15.1.1.1.1.3" xref="Sx3.E6.m1.15.15.15.15.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mrow id="Sx3.E6.m1.29.29.29.29.15.16"><mo id="Sx3.E6.m1.16.16.16.16.2.2" xref="Sx3.E6.m1.46.46.1.1.1.cmml">(</mo><munderover id="Sx3.E6.m1.29.29.29.29.15.16.1"><mo lspace="0em" movablelimits="false" id="Sx3.E6.m1.17.17.17.17.3.3" xref="Sx3.E6.m1.17.17.17.17.3.3.cmml">∑</mo><mi id="Sx3.E6.m1.18.18.18.18.4.4.1" xref="Sx3.E6.m1.18.18.18.18.4.4.1.cmml">j</mi><msubsup id="Sx3.E6.m1.19.19.19.19.5.5.1" xref="Sx3.E6.m1.19.19.19.19.5.5.1.cmml"><mi id="Sx3.E6.m1.19.19.19.19.5.5.1.2.2" xref="Sx3.E6.m1.19.19.19.19.5.5.1.2.2.cmml">C</mi><mi id="Sx3.E6.m1.19.19.19.19.5.5.1.2.3" xref="Sx3.E6.m1.19.19.19.19.5.5.1.2.3.cmml">i</mi><mi id="Sx3.E6.m1.19.19.19.19.5.5.1.3" xref="Sx3.E6.m1.19.19.19.19.5.5.1.3.cmml">p</mi></msubsup></munderover><msubsup id="Sx3.E6.m1.29.29.29.29.15.16.2"><mi id="Sx3.E6.m1.20.20.20.20.6.6" xref="Sx3.E6.m1.20.20.20.20.6.6.cmml">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.E6.m1.22.22.22.22.8.8.1" xref="Sx3.E6.m1.22.22.22.22.8.8.1a.cmml">BCE</mtext><mi id="Sx3.E6.m1.21.21.21.21.7.7.1" xref="Sx3.E6.m1.21.21.21.21.7.7.1.cmml">p</mi></msubsup><mrow id="Sx3.E6.m1.29.29.29.29.15.16.3"><mo stretchy="false" id="Sx3.E6.m1.23.23.23.23.9.9" xref="Sx3.E6.m1.46.46.1.1.1.cmml">(</mo><msup id="Sx3.E6.m1.29.29.29.29.15.16.3.1"><mi class="ltx_font_mathcaligraphic" id="Sx3.E6.m1.24.24.24.24.10.10" xref="Sx3.E6.m1.24.24.24.24.10.10.cmml">𝒮</mi><mi id="Sx3.E6.m1.25.25.25.25.11.11.1" xref="Sx3.E6.m1.25.25.25.25.11.11.1.cmml">i</mi></msup><mo id="Sx3.E6.m1.26.26.26.26.12.12" xref="Sx3.E6.m1.46.46.1.1.1.cmml">;</mo><msub id="Sx3.E6.m1.29.29.29.29.15.16.3.2"><mi id="Sx3.E6.m1.27.27.27.27.13.13" xref="Sx3.E6.m1.27.27.27.27.13.13.cmml">𝜽</mi><mi id="Sx3.E6.m1.28.28.28.28.14.14.1" xref="Sx3.E6.m1.28.28.28.28.14.14.1.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E6.m1.29.29.29.29.15.15" xref="Sx3.E6.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx3.E6.m1.47.47.2d"><mtd id="Sx3.E6.m1.47.47.2e" xref="Sx3.E6.m1.46.46.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E6.m1.47.47.2f"><mrow id="Sx3.E6.m1.45.45.45.16.16"><mo rspace="0.055em" id="Sx3.E6.m1.30.30.30.1.1.1" xref="Sx3.E6.m1.30.30.30.1.1.1.cmml">+</mo><munderover id="Sx3.E6.m1.45.45.45.16.16.17"><mo movablelimits="false" id="Sx3.E6.m1.31.31.31.2.2.2" xref="Sx3.E6.m1.31.31.31.2.2.2.cmml">∑</mo><mi id="Sx3.E6.m1.32.32.32.3.3.3.1" xref="Sx3.E6.m1.32.32.32.3.3.3.1.cmml">j</mi><msubsup id="Sx3.E6.m1.33.33.33.4.4.4.1" xref="Sx3.E6.m1.33.33.33.4.4.4.1.cmml"><mi id="Sx3.E6.m1.33.33.33.4.4.4.1.2.2" xref="Sx3.E6.m1.33.33.33.4.4.4.1.2.2.cmml">C</mi><mi id="Sx3.E6.m1.33.33.33.4.4.4.1.2.3" xref="Sx3.E6.m1.33.33.33.4.4.4.1.2.3.cmml">i</mi><mi id="Sx3.E6.m1.33.33.33.4.4.4.1.3" xref="Sx3.E6.m1.33.33.33.4.4.4.1.3.cmml">n</mi></msubsup></munderover><msubsup id="Sx3.E6.m1.45.45.45.16.16.18"><mi id="Sx3.E6.m1.34.34.34.5.5.5" xref="Sx3.E6.m1.34.34.34.5.5.5.cmml">L</mi><mtext class="ltx_mathvariant_italic" id="Sx3.E6.m1.35.35.35.6.6.6.1" xref="Sx3.E6.m1.35.35.35.6.6.6.1a.cmml">BCE</mtext><mi id="Sx3.E6.m1.36.36.36.7.7.7.1" xref="Sx3.E6.m1.36.36.36.7.7.7.1.cmml">n</mi></msubsup><mrow id="Sx3.E6.m1.45.45.45.16.16.19"><mo stretchy="false" id="Sx3.E6.m1.37.37.37.8.8.8" xref="Sx3.E6.m1.46.46.1.1.1.cmml">(</mo><msup id="Sx3.E6.m1.45.45.45.16.16.19.1"><mi class="ltx_font_mathcaligraphic" id="Sx3.E6.m1.38.38.38.9.9.9" xref="Sx3.E6.m1.38.38.38.9.9.9.cmml">𝒮</mi><mi id="Sx3.E6.m1.39.39.39.10.10.10.1" xref="Sx3.E6.m1.39.39.39.10.10.10.1.cmml">i</mi></msup><mo id="Sx3.E6.m1.40.40.40.11.11.11" xref="Sx3.E6.m1.46.46.1.1.1.cmml">;</mo><msub id="Sx3.E6.m1.45.45.45.16.16.19.2"><mi id="Sx3.E6.m1.41.41.41.12.12.12" xref="Sx3.E6.m1.41.41.41.12.12.12.cmml">𝜽</mi><mi id="Sx3.E6.m1.42.42.42.13.13.13.1" xref="Sx3.E6.m1.42.42.42.13.13.13.1.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E6.m1.43.43.43.14.14.14" xref="Sx3.E6.m1.46.46.1.1.1.cmml">)</mo></mrow><mo id="Sx3.E6.m1.44.44.44.15.15.15" xref="Sx3.E6.m1.46.46.1.1.1.cmml">)</mo><mo lspace="0em" id="Sx3.E6.m1.45.45.45.16.16.16" xref="Sx3.E6.m1.46.46.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx3.E6.m1.47b"><apply id="Sx3.E6.m1.46.46.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="latexml" id="Sx3.E6.m1.14.14.14.14.14.14.cmml" xref="Sx3.E6.m1.14.14.14.14.14.14">assign</csymbol><apply id="Sx3.E6.m1.46.46.1.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><times id="Sx3.E6.m1.46.46.1.1.1.1.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"></times><ci id="Sx3.E6.m1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.1.1.1.1.1.1">𝔼</ci><apply id="Sx3.E6.m1.46.46.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="latexml" id="Sx3.E6.m1.46.46.1.1.1.1.1.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">delimited-[]</csymbol><apply id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><times id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"></times><apply id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.4.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">subscript</csymbol><apply id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.4.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.4.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">superscript</csymbol><ci id="Sx3.E6.m1.3.3.3.3.3.3.cmml" xref="Sx3.E6.m1.3.3.3.3.3.3">ℒ</ci><ci id="Sx3.E6.m1.4.4.4.4.4.4.1a.cmml" xref="Sx3.E6.m1.4.4.4.4.4.4.1"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="Sx3.E6.m1.4.4.4.4.4.4.1.cmml" xref="Sx3.E6.m1.4.4.4.4.4.4.1">BCE</mtext></ci></apply><apply id="Sx3.E6.m1.5.5.5.5.5.5.1.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1"><csymbol cd="latexml" id="Sx3.E6.m1.5.5.5.5.5.5.1.3.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1.3">similar-to</csymbol><interval closure="open" id="Sx3.E6.m1.5.5.5.5.5.5.1.4.1.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1.4.2"><ci id="Sx3.E6.m1.5.5.5.5.5.5.1.1.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1.1">𝑥</ci><ci id="Sx3.E6.m1.5.5.5.5.5.5.1.2.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1.2">𝑦</ci></interval><apply id="Sx3.E6.m1.5.5.5.5.5.5.1.5.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1.5"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.5.5.1.5.1.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1.5">subscript</csymbol><ci id="Sx3.E6.m1.5.5.5.5.5.5.1.5.2.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1.5.2">𝒟</ci><ci id="Sx3.E6.m1.5.5.5.5.5.5.1.5.3.cmml" xref="Sx3.E6.m1.5.5.5.5.5.5.1.5.3">𝑖</ci></apply></apply></apply><list id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><apply id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">superscript</csymbol><ci id="Sx3.E6.m1.7.7.7.7.7.7.cmml" xref="Sx3.E6.m1.7.7.7.7.7.7">𝒮</ci><ci id="Sx3.E6.m1.8.8.8.8.8.8.1.cmml" xref="Sx3.E6.m1.8.8.8.8.8.8.1">𝑖</ci></apply><apply id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">subscript</csymbol><ci id="Sx3.E6.m1.10.10.10.10.10.10.cmml" xref="Sx3.E6.m1.10.10.10.10.10.10">𝜽</ci><ci id="Sx3.E6.m1.11.11.11.11.11.11.1.cmml" xref="Sx3.E6.m1.11.11.11.11.11.11.1">𝒊</ci></apply></list></apply></apply></apply><apply id="Sx3.E6.m1.46.46.1.1.1.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><times id="Sx3.E6.m1.46.46.1.1.1.2.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"></times><apply id="Sx3.E6.m1.15.15.15.15.1.1.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1"><divide id="Sx3.E6.m1.15.15.15.15.1.1.2.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1"></divide><cn type="integer" id="Sx3.E6.m1.15.15.15.15.1.1.3.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1.3">1</cn><apply id="Sx3.E6.m1.15.15.15.15.1.1.1.2.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1"><abs id="Sx3.E6.m1.15.15.15.15.1.1.1.2.1.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1.2"></abs><apply id="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1.1">superscript</csymbol><ci id="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.2">𝒮</ci><ci id="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.15.15.15.15.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><plus id="Sx3.E6.m1.30.30.30.1.1.1.cmml" xref="Sx3.E6.m1.30.30.30.1.1.1"></plus><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.3.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.3.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">superscript</csymbol><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.3.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.3.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">subscript</csymbol><sum id="Sx3.E6.m1.17.17.17.17.3.3.cmml" xref="Sx3.E6.m1.17.17.17.17.3.3"></sum><ci id="Sx3.E6.m1.18.18.18.18.4.4.1.cmml" xref="Sx3.E6.m1.18.18.18.18.4.4.1">𝑗</ci></apply><apply id="Sx3.E6.m1.19.19.19.19.5.5.1.cmml" xref="Sx3.E6.m1.19.19.19.19.5.5.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.19.19.19.19.5.5.1.1.cmml" xref="Sx3.E6.m1.19.19.19.19.5.5.1">superscript</csymbol><apply id="Sx3.E6.m1.19.19.19.19.5.5.1.2.cmml" xref="Sx3.E6.m1.19.19.19.19.5.5.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.19.19.19.19.5.5.1.2.1.cmml" xref="Sx3.E6.m1.19.19.19.19.5.5.1">subscript</csymbol><ci id="Sx3.E6.m1.19.19.19.19.5.5.1.2.2.cmml" xref="Sx3.E6.m1.19.19.19.19.5.5.1.2.2">𝐶</ci><ci id="Sx3.E6.m1.19.19.19.19.5.5.1.2.3.cmml" xref="Sx3.E6.m1.19.19.19.19.5.5.1.2.3">𝑖</ci></apply><ci id="Sx3.E6.m1.19.19.19.19.5.5.1.3.cmml" xref="Sx3.E6.m1.19.19.19.19.5.5.1.3">𝑝</ci></apply></apply><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><times id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.3.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"></times><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.4.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.4.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">subscript</csymbol><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.4.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.4.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">superscript</csymbol><ci id="Sx3.E6.m1.20.20.20.20.6.6.cmml" xref="Sx3.E6.m1.20.20.20.20.6.6">𝐿</ci><ci id="Sx3.E6.m1.21.21.21.21.7.7.1.cmml" xref="Sx3.E6.m1.21.21.21.21.7.7.1">𝑝</ci></apply><ci id="Sx3.E6.m1.22.22.22.22.8.8.1a.cmml" xref="Sx3.E6.m1.22.22.22.22.8.8.1"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="Sx3.E6.m1.22.22.22.22.8.8.1.cmml" xref="Sx3.E6.m1.22.22.22.22.8.8.1">BCE</mtext></ci></apply><list id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.2.3.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">superscript</csymbol><ci id="Sx3.E6.m1.24.24.24.24.10.10.cmml" xref="Sx3.E6.m1.24.24.24.24.10.10">𝒮</ci><ci id="Sx3.E6.m1.25.25.25.25.11.11.1.cmml" xref="Sx3.E6.m1.25.25.25.25.11.11.1">𝑖</ci></apply><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.2.2.2.2.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">subscript</csymbol><ci id="Sx3.E6.m1.27.27.27.27.13.13.cmml" xref="Sx3.E6.m1.27.27.27.27.13.13">𝜽</ci><ci id="Sx3.E6.m1.28.28.28.28.14.14.1.cmml" xref="Sx3.E6.m1.28.28.28.28.14.14.1">𝑖</ci></apply></list></apply></apply><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.3.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.3.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">superscript</csymbol><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.3.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.3.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">subscript</csymbol><sum id="Sx3.E6.m1.31.31.31.2.2.2.cmml" xref="Sx3.E6.m1.31.31.31.2.2.2"></sum><ci id="Sx3.E6.m1.32.32.32.3.3.3.1.cmml" xref="Sx3.E6.m1.32.32.32.3.3.3.1">𝑗</ci></apply><apply id="Sx3.E6.m1.33.33.33.4.4.4.1.cmml" xref="Sx3.E6.m1.33.33.33.4.4.4.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.33.33.33.4.4.4.1.1.cmml" xref="Sx3.E6.m1.33.33.33.4.4.4.1">superscript</csymbol><apply id="Sx3.E6.m1.33.33.33.4.4.4.1.2.cmml" xref="Sx3.E6.m1.33.33.33.4.4.4.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.33.33.33.4.4.4.1.2.1.cmml" xref="Sx3.E6.m1.33.33.33.4.4.4.1">subscript</csymbol><ci id="Sx3.E6.m1.33.33.33.4.4.4.1.2.2.cmml" xref="Sx3.E6.m1.33.33.33.4.4.4.1.2.2">𝐶</ci><ci id="Sx3.E6.m1.33.33.33.4.4.4.1.2.3.cmml" xref="Sx3.E6.m1.33.33.33.4.4.4.1.2.3">𝑖</ci></apply><ci id="Sx3.E6.m1.33.33.33.4.4.4.1.3.cmml" xref="Sx3.E6.m1.33.33.33.4.4.4.1.3">𝑛</ci></apply></apply><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><times id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.3.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"></times><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.4.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.4.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">superscript</csymbol><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.4.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.4.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">subscript</csymbol><ci id="Sx3.E6.m1.34.34.34.5.5.5.cmml" xref="Sx3.E6.m1.34.34.34.5.5.5">𝐿</ci><ci id="Sx3.E6.m1.35.35.35.6.6.6.1a.cmml" xref="Sx3.E6.m1.35.35.35.6.6.6.1"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="Sx3.E6.m1.35.35.35.6.6.6.1.cmml" xref="Sx3.E6.m1.35.35.35.6.6.6.1">BCE</mtext></ci></apply><ci id="Sx3.E6.m1.36.36.36.7.7.7.1.cmml" xref="Sx3.E6.m1.36.36.36.7.7.7.1">𝑛</ci></apply><list id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.2.3.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.3.1.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.3.1.1.1.1.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">superscript</csymbol><ci id="Sx3.E6.m1.38.38.38.9.9.9.cmml" xref="Sx3.E6.m1.38.38.38.9.9.9">𝒮</ci><ci id="Sx3.E6.m1.39.39.39.10.10.10.1.cmml" xref="Sx3.E6.m1.39.39.39.10.10.10.1">𝑖</ci></apply><apply id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.2.2.2.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.46.46.1.1.1.2.1.1.1.4.2.2.2.2.1.cmml" xref="Sx3.E6.m1.47.47.2.46.30.15.15.2">subscript</csymbol><ci id="Sx3.E6.m1.41.41.41.12.12.12.cmml" xref="Sx3.E6.m1.41.41.41.12.12.12">𝜽</ci><ci id="Sx3.E6.m1.42.42.42.13.13.13.1.cmml" xref="Sx3.E6.m1.42.42.42.13.13.13.1">𝑖</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E6.m1.47c">\begin{split}\mathbb{E}\left[\mathcal{L}^{\textit{BCE}}_{({x},y)\sim\mathcal{D}_{i}}\left(\mathcal{S}^{i};\bm{\theta_{i}}\right)\right]:=&amp;\frac{1}{|\mathcal{S}^{i}|}\left(\sum_{j}^{C_{i}^{p}}{L}^{p}_{\textit{BCE}}(\mathcal{S}^{i};\bm{\theta}_{i})\right.\\
&amp;\left.+\sum_{j}^{C_{i}^{n}}L_{\textit{BCE}}^{n}(\mathcal{S}^{i};\bm{\theta}_{i})\right).\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p1.5" class="ltx_p">Since our binary loss function have different forms w.r.t. <math id="Sx3.SSx3.p1.4.m1.1" class="ltx_Math" alttext="C_{i}^{p}" display="inline"><semantics id="Sx3.SSx3.p1.4.m1.1a"><msubsup id="Sx3.SSx3.p1.4.m1.1.1" xref="Sx3.SSx3.p1.4.m1.1.1.cmml"><mi id="Sx3.SSx3.p1.4.m1.1.1.2.2" xref="Sx3.SSx3.p1.4.m1.1.1.2.2.cmml">C</mi><mi id="Sx3.SSx3.p1.4.m1.1.1.2.3" xref="Sx3.SSx3.p1.4.m1.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx3.p1.4.m1.1.1.3" xref="Sx3.SSx3.p1.4.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.4.m1.1b"><apply id="Sx3.SSx3.p1.4.m1.1.1.cmml" xref="Sx3.SSx3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m1.1.1.1.cmml" xref="Sx3.SSx3.p1.4.m1.1.1">superscript</csymbol><apply id="Sx3.SSx3.p1.4.m1.1.1.2.cmml" xref="Sx3.SSx3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m1.1.1.2.1.cmml" xref="Sx3.SSx3.p1.4.m1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p1.4.m1.1.1.2.2.cmml" xref="Sx3.SSx3.p1.4.m1.1.1.2.2">𝐶</ci><ci id="Sx3.SSx3.p1.4.m1.1.1.2.3.cmml" xref="Sx3.SSx3.p1.4.m1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.SSx3.p1.4.m1.1.1.3.cmml" xref="Sx3.SSx3.p1.4.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.4.m1.1c">C_{i}^{p}</annotation></semantics></math> and <math id="Sx3.SSx3.p1.5.m2.1" class="ltx_Math" alttext="C_{i}^{p}" display="inline"><semantics id="Sx3.SSx3.p1.5.m2.1a"><msubsup id="Sx3.SSx3.p1.5.m2.1.1" xref="Sx3.SSx3.p1.5.m2.1.1.cmml"><mi id="Sx3.SSx3.p1.5.m2.1.1.2.2" xref="Sx3.SSx3.p1.5.m2.1.1.2.2.cmml">C</mi><mi id="Sx3.SSx3.p1.5.m2.1.1.2.3" xref="Sx3.SSx3.p1.5.m2.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx3.p1.5.m2.1.1.3" xref="Sx3.SSx3.p1.5.m2.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.5.m2.1b"><apply id="Sx3.SSx3.p1.5.m2.1.1.cmml" xref="Sx3.SSx3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.5.m2.1.1.1.cmml" xref="Sx3.SSx3.p1.5.m2.1.1">superscript</csymbol><apply id="Sx3.SSx3.p1.5.m2.1.1.2.cmml" xref="Sx3.SSx3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.5.m2.1.1.2.1.cmml" xref="Sx3.SSx3.p1.5.m2.1.1">subscript</csymbol><ci id="Sx3.SSx3.p1.5.m2.1.1.2.2.cmml" xref="Sx3.SSx3.p1.5.m2.1.1.2.2">𝐶</ci><ci id="Sx3.SSx3.p1.5.m2.1.1.2.3.cmml" xref="Sx3.SSx3.p1.5.m2.1.1.2.3">𝑖</ci></apply><ci id="Sx3.SSx3.p1.5.m2.1.1.3.cmml" xref="Sx3.SSx3.p1.5.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.5.m2.1c">C_{i}^{p}</annotation></semantics></math>, we do not merge them together. Employing this training strategy can liberate unfair competition between classes in the classifier and be more focused on personalized classes.
Although there may exist severe problems of data imbalancing and lacking positive samples, we can adopt the customized binary loss function Eq. (<a href="#Sx3.E5" title="In Incorporating hard sample mining. ‣ FL binary loss function ‣ Federated Averaging via Binary Classification ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) to significantly alleviate it. In Algorithm <a href="#alg1" title="Algorithm 1 ‣ Incorporating hard sample mining. ‣ FL binary loss function ‣ Federated Averaging via Binary Classification ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we summarize the learning procedure of our proposed FedABC method.</p>
</div>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experiments</h2>

<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Setup</h3>

<section id="Sx4.SSx1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Datasets.</h4>

<div id="Sx4.SSx1.SSS0.Px1.p1" class="ltx_para">
<p id="Sx4.SSx1.SSS0.Px1.p1.3" class="ltx_p">We use MNIST <cite class="ltx_cite ltx_citemacro_citep">(Lecun and Bottou <a href="#bib.bib28" title="" class="ltx_ref">1998</a>)</cite> and CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky and Hinton <a href="#bib.bib27" title="" class="ltx_ref">2009</a>)</cite> as benchmarks. To simulate the heterogeneous federated learning scenario, we follow the previous works <cite class="ltx_cite ltx_citemacro_citep">(Yurochkin et al. <a href="#bib.bib51" title="" class="ltx_ref">2019</a>; Wang et al. <a href="#bib.bib45" title="" class="ltx_ref">2020</a>)</cite> that utilize
Dirichlet distribution
<math id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="Dir(\alpha)" display="inline"><semantics id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1a"><mrow id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.cmml"><mi id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.2" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.1" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.1.cmml">​</mo><mi id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.3" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.1a" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.1.cmml">​</mo><mi id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.4" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.1b" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.1.cmml">​</mo><mrow id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.5.2" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.5.2.1" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.cmml">(</mo><mi id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.1" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.1.cmml">α</mi><mo stretchy="false" id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.5.2.2" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1b"><apply id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.cmml" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2"><times id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.1.cmml" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.1"></times><ci id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.2.cmml" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.2">𝐷</ci><ci id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.3.cmml" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.3">𝑖</ci><ci id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.4.cmml" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.2.4">𝑟</ci><ci id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.SSS0.Px1.p1.1.m1.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px1.p1.1.m1.1c">Dir(\alpha)</annotation></semantics></math> to partition the training dataset and generate the corresponding test data for each client following the same distribution, in which a smaller <math id="Sx4.SSx1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="Sx4.SSx1.SSS0.Px1.p1.2.m2.1a"><mi id="Sx4.SSx1.SSS0.Px1.p1.2.m2.1.1" xref="Sx4.SSx1.SSS0.Px1.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px1.p1.2.m2.1b"><ci id="Sx4.SSx1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Sx4.SSx1.SSS0.Px1.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px1.p1.2.m2.1c">\alpha</annotation></semantics></math> indicates the higher data heterogeneity. In our experiments, the number of total users is <math id="Sx4.SSx1.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="20" display="inline"><semantics id="Sx4.SSx1.SSS0.Px1.p1.3.m3.1a"><mn id="Sx4.SSx1.SSS0.Px1.p1.3.m3.1.1" xref="Sx4.SSx1.SSS0.Px1.p1.3.m3.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px1.p1.3.m3.1b"><cn type="integer" id="Sx4.SSx1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Sx4.SSx1.SSS0.Px1.p1.3.m3.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px1.p1.3.m3.1c">20</annotation></semantics></math>. We also visualize the statistical heterogeneity of clients by adopting the visualization method in previous work <cite class="ltx_cite ltx_citemacro_citep">(Zhu, Hong, and Zhou <a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite>, the results are shown in Figure <a href="#Sx4.F4" title="Figure 4 ‣ Compared methods. ‣ Setup ‣ Experiments ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section id="Sx4.SSx1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Model.</h4>

<div id="Sx4.SSx1.SSS0.Px2.p1" class="ltx_para">
<p id="Sx4.SSx1.SSS0.Px2.p1.1" class="ltx_p">For MNIST, we use the fully connected network which contains 3 FC layers, the FC layers are with 260, 200 hidden sizes, and 10 neurons for 10 classes as outputs, respectively. Since we adopt the binary training strategy, the activation function <span id="Sx4.SSx1.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_bold">sigmoid</span> used in binary classification is applied and maps outputs into the interval <math id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2a"><mrow id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.2" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.2.1" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.1.cmml">[</mo><mn id="Sx4.SSx1.SSS0.Px2.p1.1.m1.1.1" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.1.1.cmml">0</mn><mo id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.2.2" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.1.cmml">,</mo><mn id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.2" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.2.3" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2b"><interval closure="closed" id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.1.cmml" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.3.2"><cn type="integer" id="Sx4.SSx1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.1.1">0</cn><cn type="integer" id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.2.cmml" xref="Sx4.SSx1.SSS0.Px2.p1.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px2.p1.1.m1.2c">[0,1]</annotation></semantics></math>. We normally apply softmax activation for the compared methods. For CIFAR-10, we use ConvNet <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al. <a href="#bib.bib29" title="" class="ltx_ref">1998</a>)</cite>, which contains 2 Conv layers and 3 FC layers. The Conv layers have 64 and 64 channels, respectively. The FC layers are with 120, 64 hidden sizes, and 10 neurons as outputs, respectively. Similar to the fully connected network used on MNIST, the activation function <span id="Sx4.SSx1.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_bold">sigmoid</span> is also applied.</p>
</div>
</section>
<section id="Sx4.SSx1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Configuration.</h4>

<div id="Sx4.SSx1.SSS0.Px3.p1" class="ltx_para">
<p id="Sx4.SSx1.SSS0.Px3.p1.21" class="ltx_p">Our method has four hyper-parameters: <math id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="m^{p}" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1a"><msup id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.2" xref="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.2.cmml">m</mi><mi id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.3" xref="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1b"><apply id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1">superscript</csymbol><ci id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.2">𝑚</ci><ci id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.1.m1.1c">m^{p}</annotation></semantics></math>,<math id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="{m^{n}}" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1a"><msup id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.2" xref="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.2.cmml">m</mi><mi id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.3" xref="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1b"><apply id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1">superscript</csymbol><ci id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.2">𝑚</ci><ci id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.2.m2.1c">{m^{n}}</annotation></semantics></math>,<math id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="m^{nn}" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1a"><msup id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.2" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.2.cmml">m</mi><mrow id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mi id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.2" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.1" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.3" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.3.cmml">n</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1b"><apply id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1">superscript</csymbol><ci id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.2">𝑚</ci><apply id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3"><times id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.1"></times><ci id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.2">𝑛</ci><ci id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.3.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.3.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.3.m3.1c">m^{nn}</annotation></semantics></math> and <math id="Sx4.SSx1.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.4.m4.1a"><mi id="Sx4.SSx1.SSS0.Px3.p1.4.m4.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.4.m4.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.4.m4.1b"><ci id="Sx4.SSx1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.4.m4.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.4.m4.1c">\sigma</annotation></semantics></math>. These parameters amongst different clients can be varied according to local imbalanced data. If we adopt a flexible parameter setting strategy for each client, the experimented results will be better, but we make them equal for simplicity. For CIFAR-10, we set them as <math id="Sx4.SSx1.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="0.85" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.5.m5.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.5.m5.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.5.m5.1.1.cmml">0.85</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.5.m5.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.5.m5.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.5.m5.1.1">0.85</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.5.m5.1c">0.85</annotation></semantics></math>, <math id="Sx4.SSx1.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.6.m6.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.6.m6.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.6.m6.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.6.m6.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.6.m6.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.6.m6.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.6.m6.1c">0.2</annotation></semantics></math>, <math id="Sx4.SSx1.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.7.m7.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.7.m7.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.7.m7.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.7.m7.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.7.m7.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.7.m7.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.7.m7.1c">0.3</annotation></semantics></math>, and <math id="Sx4.SSx1.SSS0.Px3.p1.8.m8.1" class="ltx_Math" alttext="2" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.8.m8.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.8.m8.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.8.m8.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.8.m8.1b"><cn type="integer" id="Sx4.SSx1.SSS0.Px3.p1.8.m8.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.8.m8.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.8.m8.1c">2</annotation></semantics></math>, respectively. For MNIST, we set them as <math id="Sx4.SSx1.SSS0.Px3.p1.9.m9.1" class="ltx_Math" alttext="0.75" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.9.m9.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.9.m9.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.9.m9.1.1.cmml">0.75</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.9.m9.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.9.m9.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.9.m9.1.1">0.75</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.9.m9.1c">0.75</annotation></semantics></math>, <math id="Sx4.SSx1.SSS0.Px3.p1.10.m10.1" class="ltx_Math" alttext="0.25" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.10.m10.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.10.m10.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.10.m10.1.1.cmml">0.25</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.10.m10.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.10.m10.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.10.m10.1.1">0.25</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.10.m10.1c">0.25</annotation></semantics></math>, <math id="Sx4.SSx1.SSS0.Px3.p1.11.m11.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.11.m11.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.11.m11.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.11.m11.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.11.m11.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.11.m11.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.11.m11.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.11.m11.1c">0.3</annotation></semantics></math>, and <math id="Sx4.SSx1.SSS0.Px3.p1.12.m12.1" class="ltx_Math" alttext="2" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.12.m12.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.12.m12.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.12.m12.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.12.m12.1b"><cn type="integer" id="Sx4.SSx1.SSS0.Px3.p1.12.m12.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.12.m12.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.12.m12.1c">2</annotation></semantics></math>, respectively. Throughout
the experiments, we use the SGD optimizer with weight decay <math id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1" class="ltx_Math" alttext="1e-5" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1a"><mrow id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.cmml"><mrow id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.cmml"><mn id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.2" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.1" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.1.cmml">​</mo><mi id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.3" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.3.cmml">e</mi></mrow><mo id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.1.cmml">−</mo><mn id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.3" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1b"><apply id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1"><minus id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.1"></minus><apply id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2"><times id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.1"></times><cn type="integer" id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.2.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.2">1</cn><ci id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.3.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.2.3">𝑒</ci></apply><cn type="integer" id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.3.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.13.m13.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.13.m13.1c">1e-5</annotation></semantics></math> and a <math id="Sx4.SSx1.SSS0.Px3.p1.14.m14.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.14.m14.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.14.m14.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.14.m14.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.14.m14.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.14.m14.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.14.m14.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.14.m14.1c">0.9</annotation></semantics></math> momentum and the bath size is 64. For MNIST, the learning rate is <math id="Sx4.SSx1.SSS0.Px3.p1.15.m15.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.15.m15.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.15.m15.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.15.m15.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.15.m15.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.15.m15.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.15.m15.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.15.m15.1c">0.01</annotation></semantics></math>. For CIFAR-10, the learning rate is <math id="Sx4.SSx1.SSS0.Px3.p1.16.m16.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.16.m16.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.16.m16.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.16.m16.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.16.m16.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.16.m16.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.16.m16.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.16.m16.1c">0.1</annotation></semantics></math>. We train every method for <math id="Sx4.SSx1.SSS0.Px3.p1.17.m17.1" class="ltx_Math" alttext="100" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.17.m17.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.17.m17.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.17.m17.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.17.m17.1b"><cn type="integer" id="Sx4.SSx1.SSS0.Px3.p1.17.m17.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.17.m17.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.17.m17.1c">100</annotation></semantics></math> rounds and <math id="Sx4.SSx1.SSS0.Px3.p1.18.m18.1" class="ltx_Math" alttext="200" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.18.m18.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.18.m18.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.18.m18.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.18.m18.1b"><cn type="integer" id="Sx4.SSx1.SSS0.Px3.p1.18.m18.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.18.m18.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.18.m18.1c">200</annotation></semantics></math> rounds on MNIST and CIFAR-10, respectively. For the federated framework setting, the participation rate of clients is set as <math id="Sx4.SSx1.SSS0.Px3.p1.19.m19.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.19.m19.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.19.m19.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.19.m19.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.19.m19.1b"><cn type="float" id="Sx4.SSx1.SSS0.Px3.p1.19.m19.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.19.m19.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.19.m19.1c">0.5</annotation></semantics></math>, which means that random <math id="Sx4.SSx1.SSS0.Px3.p1.20.m20.1" class="ltx_Math" alttext="10" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.20.m20.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.20.m20.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.20.m20.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.20.m20.1b"><cn type="integer" id="Sx4.SSx1.SSS0.Px3.p1.20.m20.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.20.m20.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.20.m20.1c">10</annotation></semantics></math> clients will be activated in each communication round. The local training epochs are set as <math id="Sx4.SSx1.SSS0.Px3.p1.21.m21.1" class="ltx_Math" alttext="5" display="inline"><semantics id="Sx4.SSx1.SSS0.Px3.p1.21.m21.1a"><mn id="Sx4.SSx1.SSS0.Px3.p1.21.m21.1.1" xref="Sx4.SSx1.SSS0.Px3.p1.21.m21.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSS0.Px3.p1.21.m21.1b"><cn type="integer" id="Sx4.SSx1.SSS0.Px3.p1.21.m21.1.1.cmml" xref="Sx4.SSx1.SSS0.Px3.p1.21.m21.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSS0.Px3.p1.21.m21.1c">5</annotation></semantics></math> for all the experiments.</p>
</div>
</section>
<section id="Sx4.SSx1.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Compared methods.</h4>

<div id="Sx4.SSx1.SSS0.Px4.p1" class="ltx_para">
<p id="Sx4.SSx1.SSS0.Px4.p1.1" class="ltx_p">We follow the observation <cite class="ltx_cite ltx_citemacro_citep">(Chen and Chao <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite> that if we adopt personalized models in generic FL algorithms, they outperform most of the existing PFL algorithms. Hence, we select some challenging generic FL algorithms including FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite>, and Scaffold <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al. <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>. We evaluate their <span id="Sx4.SSx1.SSS0.Px4.p1.1.1" class="ltx_text ltx_font_bold">personalized models</span> to obtain corresponding PFL accuracy of those generic FL algorithms. For PFL methods, LG_FedAvg <cite class="ltx_cite ltx_citemacro_citep">(Liang et al. <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, FedPer <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al. <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>, FedRep <cite class="ltx_cite ltx_citemacro_citep">(Collins et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> and FedRod <cite class="ltx_cite ltx_citemacro_citep">(Chen and Chao <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite> are selected as challenging PFL baselines. In particular, FedRod has double classifier layers to perform on the global model and personalized model, respectively. In our experiments, FedRod adopts its linear mode where only G-Head is aggregated at the server.</p>
</div>
<figure id="Sx4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="Sx4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="Sx4.F4.sf1.1" class="ltx_p ltx_align_center"><span id="Sx4.F4.sf1.1.1" class="ltx_text"><img src="/html/2302.07450/assets/x4.png" id="Sx4.F4.sf1.1.1.g1" class="ltx_graphics ltx_img_square" width="553" height="553" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>MNIST<math id="Sx4.F4.sf1.3.m1.1" class="ltx_Math" alttext="(\alpha=0.1)" display="inline"><semantics id="Sx4.F4.sf1.3.m1.1b"><mrow id="Sx4.F4.sf1.3.m1.1.1.1" xref="Sx4.F4.sf1.3.m1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.F4.sf1.3.m1.1.1.1.2" xref="Sx4.F4.sf1.3.m1.1.1.1.1.cmml">(</mo><mrow id="Sx4.F4.sf1.3.m1.1.1.1.1" xref="Sx4.F4.sf1.3.m1.1.1.1.1.cmml"><mi id="Sx4.F4.sf1.3.m1.1.1.1.1.2" xref="Sx4.F4.sf1.3.m1.1.1.1.1.2.cmml">α</mi><mo id="Sx4.F4.sf1.3.m1.1.1.1.1.1" xref="Sx4.F4.sf1.3.m1.1.1.1.1.1.cmml">=</mo><mn id="Sx4.F4.sf1.3.m1.1.1.1.1.3" xref="Sx4.F4.sf1.3.m1.1.1.1.1.3.cmml">0.1</mn></mrow><mo stretchy="false" id="Sx4.F4.sf1.3.m1.1.1.1.3" xref="Sx4.F4.sf1.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.F4.sf1.3.m1.1c"><apply id="Sx4.F4.sf1.3.m1.1.1.1.1.cmml" xref="Sx4.F4.sf1.3.m1.1.1.1"><eq id="Sx4.F4.sf1.3.m1.1.1.1.1.1.cmml" xref="Sx4.F4.sf1.3.m1.1.1.1.1.1"></eq><ci id="Sx4.F4.sf1.3.m1.1.1.1.1.2.cmml" xref="Sx4.F4.sf1.3.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="Sx4.F4.sf1.3.m1.1.1.1.1.3.cmml" xref="Sx4.F4.sf1.3.m1.1.1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.sf1.3.m1.1d">(\alpha=0.1)</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="Sx4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="Sx4.F4.sf2.1" class="ltx_p ltx_align_center"><span id="Sx4.F4.sf2.1.1" class="ltx_text"><img src="/html/2302.07450/assets/x5.png" id="Sx4.F4.sf2.1.1.g1" class="ltx_graphics ltx_img_square" width="553" height="553" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MNIST<math id="Sx4.F4.sf2.3.m1.1" class="ltx_Math" alttext="(\alpha=0.3)" display="inline"><semantics id="Sx4.F4.sf2.3.m1.1b"><mrow id="Sx4.F4.sf2.3.m1.1.1.1" xref="Sx4.F4.sf2.3.m1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.F4.sf2.3.m1.1.1.1.2" xref="Sx4.F4.sf2.3.m1.1.1.1.1.cmml">(</mo><mrow id="Sx4.F4.sf2.3.m1.1.1.1.1" xref="Sx4.F4.sf2.3.m1.1.1.1.1.cmml"><mi id="Sx4.F4.sf2.3.m1.1.1.1.1.2" xref="Sx4.F4.sf2.3.m1.1.1.1.1.2.cmml">α</mi><mo id="Sx4.F4.sf2.3.m1.1.1.1.1.1" xref="Sx4.F4.sf2.3.m1.1.1.1.1.1.cmml">=</mo><mn id="Sx4.F4.sf2.3.m1.1.1.1.1.3" xref="Sx4.F4.sf2.3.m1.1.1.1.1.3.cmml">0.3</mn></mrow><mo stretchy="false" id="Sx4.F4.sf2.3.m1.1.1.1.3" xref="Sx4.F4.sf2.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.F4.sf2.3.m1.1c"><apply id="Sx4.F4.sf2.3.m1.1.1.1.1.cmml" xref="Sx4.F4.sf2.3.m1.1.1.1"><eq id="Sx4.F4.sf2.3.m1.1.1.1.1.1.cmml" xref="Sx4.F4.sf2.3.m1.1.1.1.1.1"></eq><ci id="Sx4.F4.sf2.3.m1.1.1.1.1.2.cmml" xref="Sx4.F4.sf2.3.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="Sx4.F4.sf2.3.m1.1.1.1.1.3.cmml" xref="Sx4.F4.sf2.3.m1.1.1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.sf2.3.m1.1d">(\alpha=0.3)</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="Sx4.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="Sx4.F4.sf3.1" class="ltx_p ltx_align_center"><span id="Sx4.F4.sf3.1.1" class="ltx_text"><img src="/html/2302.07450/assets/x6.png" id="Sx4.F4.sf3.1.1.g1" class="ltx_graphics ltx_img_square" width="553" height="553" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>MNIST<math id="Sx4.F4.sf3.3.m1.1" class="ltx_Math" alttext="(\alpha=0.5)" display="inline"><semantics id="Sx4.F4.sf3.3.m1.1b"><mrow id="Sx4.F4.sf3.3.m1.1.1.1" xref="Sx4.F4.sf3.3.m1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.F4.sf3.3.m1.1.1.1.2" xref="Sx4.F4.sf3.3.m1.1.1.1.1.cmml">(</mo><mrow id="Sx4.F4.sf3.3.m1.1.1.1.1" xref="Sx4.F4.sf3.3.m1.1.1.1.1.cmml"><mi id="Sx4.F4.sf3.3.m1.1.1.1.1.2" xref="Sx4.F4.sf3.3.m1.1.1.1.1.2.cmml">α</mi><mo id="Sx4.F4.sf3.3.m1.1.1.1.1.1" xref="Sx4.F4.sf3.3.m1.1.1.1.1.1.cmml">=</mo><mn id="Sx4.F4.sf3.3.m1.1.1.1.1.3" xref="Sx4.F4.sf3.3.m1.1.1.1.1.3.cmml">0.5</mn></mrow><mo stretchy="false" id="Sx4.F4.sf3.3.m1.1.1.1.3" xref="Sx4.F4.sf3.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.F4.sf3.3.m1.1c"><apply id="Sx4.F4.sf3.3.m1.1.1.1.1.cmml" xref="Sx4.F4.sf3.3.m1.1.1.1"><eq id="Sx4.F4.sf3.3.m1.1.1.1.1.1.cmml" xref="Sx4.F4.sf3.3.m1.1.1.1.1.1"></eq><ci id="Sx4.F4.sf3.3.m1.1.1.1.1.2.cmml" xref="Sx4.F4.sf3.3.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="Sx4.F4.sf3.3.m1.1.1.1.1.3.cmml" xref="Sx4.F4.sf3.3.m1.1.1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.sf3.3.m1.1d">(\alpha=0.5)</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="Sx4.F4.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="Sx4.F4.sf4.1" class="ltx_p ltx_align_center"><span id="Sx4.F4.sf4.1.1" class="ltx_text"><img src="/html/2302.07450/assets/x7.png" id="Sx4.F4.sf4.1.1.g1" class="ltx_graphics ltx_img_square" width="553" height="553" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>MNIST<math id="Sx4.F4.sf4.3.m1.1" class="ltx_Math" alttext="(\alpha=1.0)" display="inline"><semantics id="Sx4.F4.sf4.3.m1.1b"><mrow id="Sx4.F4.sf4.3.m1.1.1.1" xref="Sx4.F4.sf4.3.m1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.F4.sf4.3.m1.1.1.1.2" xref="Sx4.F4.sf4.3.m1.1.1.1.1.cmml">(</mo><mrow id="Sx4.F4.sf4.3.m1.1.1.1.1" xref="Sx4.F4.sf4.3.m1.1.1.1.1.cmml"><mi id="Sx4.F4.sf4.3.m1.1.1.1.1.2" xref="Sx4.F4.sf4.3.m1.1.1.1.1.2.cmml">α</mi><mo id="Sx4.F4.sf4.3.m1.1.1.1.1.1" xref="Sx4.F4.sf4.3.m1.1.1.1.1.1.cmml">=</mo><mn id="Sx4.F4.sf4.3.m1.1.1.1.1.3" xref="Sx4.F4.sf4.3.m1.1.1.1.1.3.cmml">1.0</mn></mrow><mo stretchy="false" id="Sx4.F4.sf4.3.m1.1.1.1.3" xref="Sx4.F4.sf4.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.F4.sf4.3.m1.1c"><apply id="Sx4.F4.sf4.3.m1.1.1.1.1.cmml" xref="Sx4.F4.sf4.3.m1.1.1.1"><eq id="Sx4.F4.sf4.3.m1.1.1.1.1.1.cmml" xref="Sx4.F4.sf4.3.m1.1.1.1.1.1"></eq><ci id="Sx4.F4.sf4.3.m1.1.1.1.1.2.cmml" xref="Sx4.F4.sf4.3.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="Sx4.F4.sf4.3.m1.1.1.1.1.3.cmml" xref="Sx4.F4.sf4.3.m1.1.1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.sf4.3.m1.1d">(\alpha=1.0)</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="Sx4.F4.sf5" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="Sx4.F4.sf5.1" class="ltx_p ltx_align_center"><span id="Sx4.F4.sf5.1.1" class="ltx_text"><img src="/html/2302.07450/assets/x8.png" id="Sx4.F4.sf5.1.1.g1" class="ltx_graphics ltx_img_square" width="553" height="553" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>CIFAR-10<math id="Sx4.F4.sf5.3.m1.1" class="ltx_Math" alttext="(\alpha=0.1)" display="inline"><semantics id="Sx4.F4.sf5.3.m1.1b"><mrow id="Sx4.F4.sf5.3.m1.1.1.1" xref="Sx4.F4.sf5.3.m1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.F4.sf5.3.m1.1.1.1.2" xref="Sx4.F4.sf5.3.m1.1.1.1.1.cmml">(</mo><mrow id="Sx4.F4.sf5.3.m1.1.1.1.1" xref="Sx4.F4.sf5.3.m1.1.1.1.1.cmml"><mi id="Sx4.F4.sf5.3.m1.1.1.1.1.2" xref="Sx4.F4.sf5.3.m1.1.1.1.1.2.cmml">α</mi><mo id="Sx4.F4.sf5.3.m1.1.1.1.1.1" xref="Sx4.F4.sf5.3.m1.1.1.1.1.1.cmml">=</mo><mn id="Sx4.F4.sf5.3.m1.1.1.1.1.3" xref="Sx4.F4.sf5.3.m1.1.1.1.1.3.cmml">0.1</mn></mrow><mo stretchy="false" id="Sx4.F4.sf5.3.m1.1.1.1.3" xref="Sx4.F4.sf5.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.F4.sf5.3.m1.1c"><apply id="Sx4.F4.sf5.3.m1.1.1.1.1.cmml" xref="Sx4.F4.sf5.3.m1.1.1.1"><eq id="Sx4.F4.sf5.3.m1.1.1.1.1.1.cmml" xref="Sx4.F4.sf5.3.m1.1.1.1.1.1"></eq><ci id="Sx4.F4.sf5.3.m1.1.1.1.1.2.cmml" xref="Sx4.F4.sf5.3.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="Sx4.F4.sf5.3.m1.1.1.1.1.3.cmml" xref="Sx4.F4.sf5.3.m1.1.1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.sf5.3.m1.1d">(\alpha=0.1)</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="Sx4.F4.sf6" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="Sx4.F4.sf6.1" class="ltx_p ltx_align_center"><span id="Sx4.F4.sf6.1.1" class="ltx_text"><img src="/html/2302.07450/assets/x9.png" id="Sx4.F4.sf6.1.1.g1" class="ltx_graphics ltx_img_square" width="553" height="553" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>CIFAR-10<math id="Sx4.F4.sf6.3.m1.1" class="ltx_Math" alttext="(\alpha=0.3)" display="inline"><semantics id="Sx4.F4.sf6.3.m1.1b"><mrow id="Sx4.F4.sf6.3.m1.1.1.1" xref="Sx4.F4.sf6.3.m1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.F4.sf6.3.m1.1.1.1.2" xref="Sx4.F4.sf6.3.m1.1.1.1.1.cmml">(</mo><mrow id="Sx4.F4.sf6.3.m1.1.1.1.1" xref="Sx4.F4.sf6.3.m1.1.1.1.1.cmml"><mi id="Sx4.F4.sf6.3.m1.1.1.1.1.2" xref="Sx4.F4.sf6.3.m1.1.1.1.1.2.cmml">α</mi><mo id="Sx4.F4.sf6.3.m1.1.1.1.1.1" xref="Sx4.F4.sf6.3.m1.1.1.1.1.1.cmml">=</mo><mn id="Sx4.F4.sf6.3.m1.1.1.1.1.3" xref="Sx4.F4.sf6.3.m1.1.1.1.1.3.cmml">0.3</mn></mrow><mo stretchy="false" id="Sx4.F4.sf6.3.m1.1.1.1.3" xref="Sx4.F4.sf6.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.F4.sf6.3.m1.1c"><apply id="Sx4.F4.sf6.3.m1.1.1.1.1.cmml" xref="Sx4.F4.sf6.3.m1.1.1.1"><eq id="Sx4.F4.sf6.3.m1.1.1.1.1.1.cmml" xref="Sx4.F4.sf6.3.m1.1.1.1.1.1"></eq><ci id="Sx4.F4.sf6.3.m1.1.1.1.1.2.cmml" xref="Sx4.F4.sf6.3.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="Sx4.F4.sf6.3.m1.1.1.1.1.3.cmml" xref="Sx4.F4.sf6.3.m1.1.1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.sf6.3.m1.1d">(\alpha=0.3)</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="Sx4.F4.sf7" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="Sx4.F4.sf7.1" class="ltx_p ltx_align_center"><span id="Sx4.F4.sf7.1.1" class="ltx_text"><img src="/html/2302.07450/assets/x10.png" id="Sx4.F4.sf7.1.1.g1" class="ltx_graphics ltx_img_square" width="553" height="553" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(g) </span>CIFAR-10<math id="Sx4.F4.sf7.3.m1.1" class="ltx_Math" alttext="(\alpha=0.5)" display="inline"><semantics id="Sx4.F4.sf7.3.m1.1b"><mrow id="Sx4.F4.sf7.3.m1.1.1.1" xref="Sx4.F4.sf7.3.m1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.F4.sf7.3.m1.1.1.1.2" xref="Sx4.F4.sf7.3.m1.1.1.1.1.cmml">(</mo><mrow id="Sx4.F4.sf7.3.m1.1.1.1.1" xref="Sx4.F4.sf7.3.m1.1.1.1.1.cmml"><mi id="Sx4.F4.sf7.3.m1.1.1.1.1.2" xref="Sx4.F4.sf7.3.m1.1.1.1.1.2.cmml">α</mi><mo id="Sx4.F4.sf7.3.m1.1.1.1.1.1" xref="Sx4.F4.sf7.3.m1.1.1.1.1.1.cmml">=</mo><mn id="Sx4.F4.sf7.3.m1.1.1.1.1.3" xref="Sx4.F4.sf7.3.m1.1.1.1.1.3.cmml">0.5</mn></mrow><mo stretchy="false" id="Sx4.F4.sf7.3.m1.1.1.1.3" xref="Sx4.F4.sf7.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.F4.sf7.3.m1.1c"><apply id="Sx4.F4.sf7.3.m1.1.1.1.1.cmml" xref="Sx4.F4.sf7.3.m1.1.1.1"><eq id="Sx4.F4.sf7.3.m1.1.1.1.1.1.cmml" xref="Sx4.F4.sf7.3.m1.1.1.1.1.1"></eq><ci id="Sx4.F4.sf7.3.m1.1.1.1.1.2.cmml" xref="Sx4.F4.sf7.3.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="Sx4.F4.sf7.3.m1.1.1.1.1.3.cmml" xref="Sx4.F4.sf7.3.m1.1.1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.sf7.3.m1.1d">(\alpha=0.5)</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="Sx4.F4.sf8" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="Sx4.F4.sf8.1" class="ltx_p ltx_align_center"><span id="Sx4.F4.sf8.1.1" class="ltx_text"><img src="/html/2302.07450/assets/x11.png" id="Sx4.F4.sf8.1.1.g1" class="ltx_graphics ltx_img_square" width="553" height="553" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(h) </span>CIFAR-10<math id="Sx4.F4.sf8.3.m1.1" class="ltx_Math" alttext="(\alpha=1.0)" display="inline"><semantics id="Sx4.F4.sf8.3.m1.1b"><mrow id="Sx4.F4.sf8.3.m1.1.1.1" xref="Sx4.F4.sf8.3.m1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.F4.sf8.3.m1.1.1.1.2" xref="Sx4.F4.sf8.3.m1.1.1.1.1.cmml">(</mo><mrow id="Sx4.F4.sf8.3.m1.1.1.1.1" xref="Sx4.F4.sf8.3.m1.1.1.1.1.cmml"><mi id="Sx4.F4.sf8.3.m1.1.1.1.1.2" xref="Sx4.F4.sf8.3.m1.1.1.1.1.2.cmml">α</mi><mo id="Sx4.F4.sf8.3.m1.1.1.1.1.1" xref="Sx4.F4.sf8.3.m1.1.1.1.1.1.cmml">=</mo><mn id="Sx4.F4.sf8.3.m1.1.1.1.1.3" xref="Sx4.F4.sf8.3.m1.1.1.1.1.3.cmml">1.0</mn></mrow><mo stretchy="false" id="Sx4.F4.sf8.3.m1.1.1.1.3" xref="Sx4.F4.sf8.3.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.F4.sf8.3.m1.1c"><apply id="Sx4.F4.sf8.3.m1.1.1.1.1.cmml" xref="Sx4.F4.sf8.3.m1.1.1.1"><eq id="Sx4.F4.sf8.3.m1.1.1.1.1.1.cmml" xref="Sx4.F4.sf8.3.m1.1.1.1.1.1"></eq><ci id="Sx4.F4.sf8.3.m1.1.1.1.1.2.cmml" xref="Sx4.F4.sf8.3.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="Sx4.F4.sf8.3.m1.1.1.1.1.3.cmml" xref="Sx4.F4.sf8.3.m1.1.1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.sf8.3.m1.1d">(\alpha=1.0)</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Visualization of statistical heterogeneity among clients, where the <math id="Sx4.F4.3.3.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="Sx4.F4.3.3.m1.1b"><mi id="Sx4.F4.3.3.m1.1.1" xref="Sx4.F4.3.3.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="Sx4.F4.3.3.m1.1c"><ci id="Sx4.F4.3.3.m1.1.1.cmml" xref="Sx4.F4.3.3.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.3.3.m1.1d">x</annotation></semantics></math>-axis indicates user IDs, the <math id="Sx4.F4.4.4.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="Sx4.F4.4.4.m2.1b"><mi id="Sx4.F4.4.4.m2.1.1" xref="Sx4.F4.4.4.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="Sx4.F4.4.4.m2.1c"><ci id="Sx4.F4.4.4.m2.1.1.cmml" xref="Sx4.F4.4.4.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F4.4.4.m2.1d">y</annotation></semantics></math>-axis indicates class labels, and the size of scattered points indicates the number of training samples.</figcaption>
</figure>
<figure id="Sx4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span> PFL accuracy(%) on MNIST and CIFAR-10 under different degrees of heterogeneity (0.1, 0.3, 0.5, 1.0). The underline highlight the best-performing compared approach.</figcaption>
<div id="Sx4.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:505.9pt;height:147.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-24.5pt,7.1pt) scale(0.911854337667395,0.911854337667395) ;">
<table id="Sx4.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T1.1.1.1.1" class="ltx_tr">
<th id="Sx4.T1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Dataset</th>
<th id="Sx4.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Non-iid</th>
<th id="Sx4.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local only</th>
<th id="Sx4.T1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="Sx4.T1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedProx</th>
<th id="Sx4.T1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Scaffold</th>
<th id="Sx4.T1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">LG_FedAvg</th>
<th id="Sx4.T1.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedPer</th>
<th id="Sx4.T1.1.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedRep</th>
<th id="Sx4.T1.1.1.1.1.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedRod</th>
<th id="Sx4.T1.1.1.1.1.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedABC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T1.1.1.2.1" class="ltx_tr">
<td id="Sx4.T1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="Sx4.T1.1.1.2.1.1.1" class="ltx_text">MNIST</span></td>
<td id="Sx4.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Dir(0.1)</td>
<td id="Sx4.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">97.1</td>
<td id="Sx4.T1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">99.1</td>
<td id="Sx4.T1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">98.4</td>
<td id="Sx4.T1.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">99.3</td>
<td id="Sx4.T1.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">99.2</td>
<td id="Sx4.T1.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">99.1</td>
<td id="Sx4.T1.1.1.2.1.9" class="ltx_td ltx_align_center ltx_border_t">98.9</td>
<td id="Sx4.T1.1.1.2.1.10" class="ltx_td ltx_align_center ltx_border_t">
<span id="Sx4.T1.1.1.2.1.10.1" class="ltx_text ltx_ulem_uline">99.3</span>
</td>
<td id="Sx4.T1.1.1.2.1.11" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx4.T1.1.1.2.1.11.1" class="ltx_text ltx_font_bold">99.3</span></td>
</tr>
<tr id="Sx4.T1.1.1.3.2" class="ltx_tr">
<td id="Sx4.T1.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r">Dir(0.3)</td>
<td id="Sx4.T1.1.1.3.2.2" class="ltx_td ltx_align_center">93.3</td>
<td id="Sx4.T1.1.1.3.2.3" class="ltx_td ltx_align_center">98.3</td>
<td id="Sx4.T1.1.1.3.2.4" class="ltx_td ltx_align_center">97.1</td>
<td id="Sx4.T1.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r">98.6</td>
<td id="Sx4.T1.1.1.3.2.6" class="ltx_td ltx_align_center">98.2</td>
<td id="Sx4.T1.1.1.3.2.7" class="ltx_td ltx_align_center">98.2</td>
<td id="Sx4.T1.1.1.3.2.8" class="ltx_td ltx_align_center">97.8</td>
<td id="Sx4.T1.1.1.3.2.9" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.3.2.9.1" class="ltx_text ltx_ulem_uline">98.7</span></td>
<td id="Sx4.T1.1.1.3.2.10" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.3.2.10.1" class="ltx_text ltx_font_bold">98.7</span></td>
</tr>
<tr id="Sx4.T1.1.1.4.3" class="ltx_tr">
<td id="Sx4.T1.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r">Dir(0.5)</td>
<td id="Sx4.T1.1.1.4.3.2" class="ltx_td ltx_align_center">92.1</td>
<td id="Sx4.T1.1.1.4.3.3" class="ltx_td ltx_align_center">98.1</td>
<td id="Sx4.T1.1.1.4.3.4" class="ltx_td ltx_align_center">96.9</td>
<td id="Sx4.T1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r">98.5</td>
<td id="Sx4.T1.1.1.4.3.6" class="ltx_td ltx_align_center">98.1</td>
<td id="Sx4.T1.1.1.4.3.7" class="ltx_td ltx_align_center">98.0</td>
<td id="Sx4.T1.1.1.4.3.8" class="ltx_td ltx_align_center">97.6</td>
<td id="Sx4.T1.1.1.4.3.9" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.4.3.9.1" class="ltx_text ltx_ulem_uline">98.6</span></td>
<td id="Sx4.T1.1.1.4.3.10" class="ltx_td ltx_align_center">98.5</td>
</tr>
<tr id="Sx4.T1.1.1.5.4" class="ltx_tr">
<td id="Sx4.T1.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r">Dir(1.0)</td>
<td id="Sx4.T1.1.1.5.4.2" class="ltx_td ltx_align_center">90.6</td>
<td id="Sx4.T1.1.1.5.4.3" class="ltx_td ltx_align_center">98.0</td>
<td id="Sx4.T1.1.1.5.4.4" class="ltx_td ltx_align_center">96.9</td>
<td id="Sx4.T1.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r">98.4</td>
<td id="Sx4.T1.1.1.5.4.6" class="ltx_td ltx_align_center">98.1</td>
<td id="Sx4.T1.1.1.5.4.7" class="ltx_td ltx_align_center">98.1</td>
<td id="Sx4.T1.1.1.5.4.8" class="ltx_td ltx_align_center">97.4</td>
<td id="Sx4.T1.1.1.5.4.9" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.5.4.9.1" class="ltx_text ltx_ulem_uline">98.5</span></td>
<td id="Sx4.T1.1.1.5.4.10" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.5.4.10.1" class="ltx_text ltx_font_bold">98.7</span></td>
</tr>
<tr id="Sx4.T1.1.1.6.5" class="ltx_tr">
<td id="Sx4.T1.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="Sx4.T1.1.1.6.5.1.1" class="ltx_text">CIFAR-10</span></td>
<td id="Sx4.T1.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Dir(0.1)</td>
<td id="Sx4.T1.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t">86.0</td>
<td id="Sx4.T1.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t">91.0</td>
<td id="Sx4.T1.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t">91.1</td>
<td id="Sx4.T1.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="Sx4.T1.1.1.6.5.6.1" class="ltx_text ltx_ulem_uline">91.2</span></td>
<td id="Sx4.T1.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_t">88.7</td>
<td id="Sx4.T1.1.1.6.5.8" class="ltx_td ltx_align_center ltx_border_t">90.2</td>
<td id="Sx4.T1.1.1.6.5.9" class="ltx_td ltx_align_center ltx_border_t">90.4</td>
<td id="Sx4.T1.1.1.6.5.10" class="ltx_td ltx_align_center ltx_border_t">90.5</td>
<td id="Sx4.T1.1.1.6.5.11" class="ltx_td ltx_align_center ltx_border_t">91.0</td>
</tr>
<tr id="Sx4.T1.1.1.7.6" class="ltx_tr">
<td id="Sx4.T1.1.1.7.6.1" class="ltx_td ltx_align_center ltx_border_r">Dir(0.3)</td>
<td id="Sx4.T1.1.1.7.6.2" class="ltx_td ltx_align_center">72.4</td>
<td id="Sx4.T1.1.1.7.6.3" class="ltx_td ltx_align_center">82.1</td>
<td id="Sx4.T1.1.1.7.6.4" class="ltx_td ltx_align_center">82.2</td>
<td id="Sx4.T1.1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_r">81.9</td>
<td id="Sx4.T1.1.1.7.6.6" class="ltx_td ltx_align_center">76.6</td>
<td id="Sx4.T1.1.1.7.6.7" class="ltx_td ltx_align_center">81.2</td>
<td id="Sx4.T1.1.1.7.6.8" class="ltx_td ltx_align_center">81.4</td>
<td id="Sx4.T1.1.1.7.6.9" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.7.6.9.1" class="ltx_text ltx_ulem_uline">82.2</span></td>
<td id="Sx4.T1.1.1.7.6.10" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.7.6.10.1" class="ltx_text ltx_font_bold">83.3</span></td>
</tr>
<tr id="Sx4.T1.1.1.8.7" class="ltx_tr">
<td id="Sx4.T1.1.1.8.7.1" class="ltx_td ltx_align_center ltx_border_r">Dir(0.5)</td>
<td id="Sx4.T1.1.1.8.7.2" class="ltx_td ltx_align_center">67.8</td>
<td id="Sx4.T1.1.1.8.7.3" class="ltx_td ltx_align_center">79.8</td>
<td id="Sx4.T1.1.1.8.7.4" class="ltx_td ltx_align_center">79.3</td>
<td id="Sx4.T1.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_r">79.5</td>
<td id="Sx4.T1.1.1.8.7.6" class="ltx_td ltx_align_center">72.8</td>
<td id="Sx4.T1.1.1.8.7.7" class="ltx_td ltx_align_center">78.8</td>
<td id="Sx4.T1.1.1.8.7.8" class="ltx_td ltx_align_center">79.1</td>
<td id="Sx4.T1.1.1.8.7.9" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.8.7.9.1" class="ltx_text ltx_ulem_uline">79.8</span></td>
<td id="Sx4.T1.1.1.8.7.10" class="ltx_td ltx_align_center"><span id="Sx4.T1.1.1.8.7.10.1" class="ltx_text ltx_font_bold">81.1</span></td>
</tr>
<tr id="Sx4.T1.1.1.9.8" class="ltx_tr">
<td id="Sx4.T1.1.1.9.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">Dir(1.0)</td>
<td id="Sx4.T1.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_bb">83.7</td>
<td id="Sx4.T1.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_bb">74.1</td>
<td id="Sx4.T1.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_bb">73.8</td>
<td id="Sx4.T1.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">74.0</td>
<td id="Sx4.T1.1.1.9.8.6" class="ltx_td ltx_align_center ltx_border_bb">63.7</td>
<td id="Sx4.T1.1.1.9.8.7" class="ltx_td ltx_align_center ltx_border_bb">72.5</td>
<td id="Sx4.T1.1.1.9.8.8" class="ltx_td ltx_align_center ltx_border_bb">73.4</td>
<td id="Sx4.T1.1.1.9.8.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="Sx4.T1.1.1.9.8.9.1" class="ltx_text ltx_ulem_uline">74.1</span></td>
<td id="Sx4.T1.1.1.9.8.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="Sx4.T1.1.1.9.8.10.1" class="ltx_text ltx_font_bold">76.1</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Evaluation criteria</h3>

<section id="Sx4.SSx2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Evaluation of personalized model.</h4>

<div id="Sx4.SSx2.SSS0.Px1.p1" class="ltx_para">
<p id="Sx4.SSx2.SSS0.Px1.p1.5" class="ltx_p">To simulate the Non-iid scenario in FL, each client has the local train set and the corresponding test set with the same Dirichlet distribution. For the evaluation of PFL, we use the accuracy of the local Non-iid test set and the formulation can be given by the following:</p>
<table id="Sx4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx4.E7.m1.3" class="ltx_Math" alttext="\textbf{PFL-accuracy: }T_{\text{PFL}}=\frac{\sum_{i}{I(y_{j}=\hat{y_{j}};D_{\text{ Non\_iid\_test}}^{i};\bm{\theta}^{i})}}{\sum_{i}|D^{i}_{\text{ Non\_iid\_test}}|}" display="block"><semantics id="Sx4.E7.m1.3a"><mrow id="Sx4.E7.m1.3.4" xref="Sx4.E7.m1.3.4.cmml"><mrow id="Sx4.E7.m1.3.4.2" xref="Sx4.E7.m1.3.4.2.cmml"><mtext class="ltx_mathvariant_bold" id="Sx4.E7.m1.3.4.2.2" xref="Sx4.E7.m1.3.4.2.2a.cmml">PFL-accuracy: </mtext><mo lspace="0em" rspace="0em" id="Sx4.E7.m1.3.4.2.1" xref="Sx4.E7.m1.3.4.2.1.cmml">​</mo><msub id="Sx4.E7.m1.3.4.2.3" xref="Sx4.E7.m1.3.4.2.3.cmml"><mi id="Sx4.E7.m1.3.4.2.3.2" xref="Sx4.E7.m1.3.4.2.3.2.cmml">T</mi><mtext id="Sx4.E7.m1.3.4.2.3.3" xref="Sx4.E7.m1.3.4.2.3.3a.cmml">PFL</mtext></msub></mrow><mo id="Sx4.E7.m1.3.4.1" xref="Sx4.E7.m1.3.4.1.cmml">=</mo><mfrac id="Sx4.E7.m1.3.3" xref="Sx4.E7.m1.3.3.cmml"><mrow id="Sx4.E7.m1.2.2.2" xref="Sx4.E7.m1.2.2.2.cmml"><msub id="Sx4.E7.m1.2.2.2.3" xref="Sx4.E7.m1.2.2.2.3.cmml"><mo id="Sx4.E7.m1.2.2.2.3.2" xref="Sx4.E7.m1.2.2.2.3.2.cmml">∑</mo><mi id="Sx4.E7.m1.2.2.2.3.3" xref="Sx4.E7.m1.2.2.2.3.3.cmml">i</mi></msub><mrow id="Sx4.E7.m1.2.2.2.2" xref="Sx4.E7.m1.2.2.2.2.cmml"><mi id="Sx4.E7.m1.2.2.2.2.3" xref="Sx4.E7.m1.2.2.2.2.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="Sx4.E7.m1.2.2.2.2.2" xref="Sx4.E7.m1.2.2.2.2.2.cmml">​</mo><mrow id="Sx4.E7.m1.2.2.2.2.1.1" xref="Sx4.E7.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx4.E7.m1.2.2.2.2.1.1.2" xref="Sx4.E7.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="Sx4.E7.m1.2.2.2.2.1.1.1" xref="Sx4.E7.m1.2.2.2.2.1.1.1.cmml"><msub id="Sx4.E7.m1.2.2.2.2.1.1.1.4" xref="Sx4.E7.m1.2.2.2.2.1.1.1.4.cmml"><mi id="Sx4.E7.m1.2.2.2.2.1.1.1.4.2" xref="Sx4.E7.m1.2.2.2.2.1.1.1.4.2.cmml">y</mi><mi id="Sx4.E7.m1.2.2.2.2.1.1.1.4.3" xref="Sx4.E7.m1.2.2.2.2.1.1.1.4.3.cmml">j</mi></msub><mo id="Sx4.E7.m1.2.2.2.2.1.1.1.3" xref="Sx4.E7.m1.2.2.2.2.1.1.1.3.cmml">=</mo><mrow id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.3.cmml"><mover accent="true" id="Sx4.E7.m1.1.1.1.1" xref="Sx4.E7.m1.1.1.1.1.cmml"><msub id="Sx4.E7.m1.1.1.1.1.2" xref="Sx4.E7.m1.1.1.1.1.2.cmml"><mi id="Sx4.E7.m1.1.1.1.1.2.2" xref="Sx4.E7.m1.1.1.1.1.2.2.cmml">y</mi><mi id="Sx4.E7.m1.1.1.1.1.2.3" xref="Sx4.E7.m1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="Sx4.E7.m1.1.1.1.1.1" xref="Sx4.E7.m1.1.1.1.1.1.cmml">^</mo></mover><mo id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.3" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.3.cmml">;</mo><msubsup id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.2" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">D</mi><mtext id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3a.cmml"> Non_iid_test</mtext><mi id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.3" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.4" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.3.cmml">;</mo><msup id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.cmml"><mi id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.2" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.2.cmml">𝜽</mi><mi id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.3" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.3.cmml">i</mi></msup></mrow></mrow><mo stretchy="false" id="Sx4.E7.m1.2.2.2.2.1.1.3" xref="Sx4.E7.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="Sx4.E7.m1.3.3.3" xref="Sx4.E7.m1.3.3.3.cmml"><msub id="Sx4.E7.m1.3.3.3.2" xref="Sx4.E7.m1.3.3.3.2.cmml"><mo id="Sx4.E7.m1.3.3.3.2.2" xref="Sx4.E7.m1.3.3.3.2.2.cmml">∑</mo><mi id="Sx4.E7.m1.3.3.3.2.3" xref="Sx4.E7.m1.3.3.3.2.3.cmml">i</mi></msub><mrow id="Sx4.E7.m1.3.3.3.1.1" xref="Sx4.E7.m1.3.3.3.1.2.cmml"><mo lspace="0em" stretchy="false" id="Sx4.E7.m1.3.3.3.1.1.2" xref="Sx4.E7.m1.3.3.3.1.2.1.cmml">|</mo><msubsup id="Sx4.E7.m1.3.3.3.1.1.1" xref="Sx4.E7.m1.3.3.3.1.1.1.cmml"><mi id="Sx4.E7.m1.3.3.3.1.1.1.2.2" xref="Sx4.E7.m1.3.3.3.1.1.1.2.2.cmml">D</mi><mtext id="Sx4.E7.m1.3.3.3.1.1.1.3" xref="Sx4.E7.m1.3.3.3.1.1.1.3a.cmml"> Non_iid_test</mtext><mi id="Sx4.E7.m1.3.3.3.1.1.1.2.3" xref="Sx4.E7.m1.3.3.3.1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="Sx4.E7.m1.3.3.3.1.1.3" xref="Sx4.E7.m1.3.3.3.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E7.m1.3b"><apply id="Sx4.E7.m1.3.4.cmml" xref="Sx4.E7.m1.3.4"><eq id="Sx4.E7.m1.3.4.1.cmml" xref="Sx4.E7.m1.3.4.1"></eq><apply id="Sx4.E7.m1.3.4.2.cmml" xref="Sx4.E7.m1.3.4.2"><times id="Sx4.E7.m1.3.4.2.1.cmml" xref="Sx4.E7.m1.3.4.2.1"></times><ci id="Sx4.E7.m1.3.4.2.2a.cmml" xref="Sx4.E7.m1.3.4.2.2"><mtext class="ltx_mathvariant_bold" id="Sx4.E7.m1.3.4.2.2.cmml" xref="Sx4.E7.m1.3.4.2.2">PFL-accuracy: </mtext></ci><apply id="Sx4.E7.m1.3.4.2.3.cmml" xref="Sx4.E7.m1.3.4.2.3"><csymbol cd="ambiguous" id="Sx4.E7.m1.3.4.2.3.1.cmml" xref="Sx4.E7.m1.3.4.2.3">subscript</csymbol><ci id="Sx4.E7.m1.3.4.2.3.2.cmml" xref="Sx4.E7.m1.3.4.2.3.2">𝑇</ci><ci id="Sx4.E7.m1.3.4.2.3.3a.cmml" xref="Sx4.E7.m1.3.4.2.3.3"><mtext mathsize="70%" id="Sx4.E7.m1.3.4.2.3.3.cmml" xref="Sx4.E7.m1.3.4.2.3.3">PFL</mtext></ci></apply></apply><apply id="Sx4.E7.m1.3.3.cmml" xref="Sx4.E7.m1.3.3"><divide id="Sx4.E7.m1.3.3.4.cmml" xref="Sx4.E7.m1.3.3"></divide><apply id="Sx4.E7.m1.2.2.2.cmml" xref="Sx4.E7.m1.2.2.2"><apply id="Sx4.E7.m1.2.2.2.3.cmml" xref="Sx4.E7.m1.2.2.2.3"><csymbol cd="ambiguous" id="Sx4.E7.m1.2.2.2.3.1.cmml" xref="Sx4.E7.m1.2.2.2.3">subscript</csymbol><sum id="Sx4.E7.m1.2.2.2.3.2.cmml" xref="Sx4.E7.m1.2.2.2.3.2"></sum><ci id="Sx4.E7.m1.2.2.2.3.3.cmml" xref="Sx4.E7.m1.2.2.2.3.3">𝑖</ci></apply><apply id="Sx4.E7.m1.2.2.2.2.cmml" xref="Sx4.E7.m1.2.2.2.2"><times id="Sx4.E7.m1.2.2.2.2.2.cmml" xref="Sx4.E7.m1.2.2.2.2.2"></times><ci id="Sx4.E7.m1.2.2.2.2.3.cmml" xref="Sx4.E7.m1.2.2.2.2.3">𝐼</ci><apply id="Sx4.E7.m1.2.2.2.2.1.1.1.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1"><eq id="Sx4.E7.m1.2.2.2.2.1.1.1.3.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.3"></eq><apply id="Sx4.E7.m1.2.2.2.2.1.1.1.4.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="Sx4.E7.m1.2.2.2.2.1.1.1.4.1.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.4">subscript</csymbol><ci id="Sx4.E7.m1.2.2.2.2.1.1.1.4.2.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.4.2">𝑦</ci><ci id="Sx4.E7.m1.2.2.2.2.1.1.1.4.3.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.4.3">𝑗</ci></apply><list id="Sx4.E7.m1.2.2.2.2.1.1.1.2.3.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.2"><apply id="Sx4.E7.m1.1.1.1.1.cmml" xref="Sx4.E7.m1.1.1.1.1"><ci id="Sx4.E7.m1.1.1.1.1.1.cmml" xref="Sx4.E7.m1.1.1.1.1.1">^</ci><apply id="Sx4.E7.m1.1.1.1.1.2.cmml" xref="Sx4.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E7.m1.1.1.1.1.2.1.cmml" xref="Sx4.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="Sx4.E7.m1.1.1.1.1.2.2.cmml" xref="Sx4.E7.m1.1.1.1.1.2.2">𝑦</ci><ci id="Sx4.E7.m1.1.1.1.1.2.3.cmml" xref="Sx4.E7.m1.1.1.1.1.2.3">𝑗</ci></apply></apply><apply id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐷</ci><ci id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3a.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3"> Non_iid_test</mtext></ci></apply><ci id="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2">superscript</csymbol><ci id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.2">𝜽</ci><ci id="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="Sx4.E7.m1.2.2.2.2.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply><apply id="Sx4.E7.m1.3.3.3.cmml" xref="Sx4.E7.m1.3.3.3"><apply id="Sx4.E7.m1.3.3.3.2.cmml" xref="Sx4.E7.m1.3.3.3.2"><csymbol cd="ambiguous" id="Sx4.E7.m1.3.3.3.2.1.cmml" xref="Sx4.E7.m1.3.3.3.2">subscript</csymbol><sum id="Sx4.E7.m1.3.3.3.2.2.cmml" xref="Sx4.E7.m1.3.3.3.2.2"></sum><ci id="Sx4.E7.m1.3.3.3.2.3.cmml" xref="Sx4.E7.m1.3.3.3.2.3">𝑖</ci></apply><apply id="Sx4.E7.m1.3.3.3.1.2.cmml" xref="Sx4.E7.m1.3.3.3.1.1"><abs id="Sx4.E7.m1.3.3.3.1.2.1.cmml" xref="Sx4.E7.m1.3.3.3.1.1.2"></abs><apply id="Sx4.E7.m1.3.3.3.1.1.1.cmml" xref="Sx4.E7.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx4.E7.m1.3.3.3.1.1.1.1.cmml" xref="Sx4.E7.m1.3.3.3.1.1.1">subscript</csymbol><apply id="Sx4.E7.m1.3.3.3.1.1.1.2.cmml" xref="Sx4.E7.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx4.E7.m1.3.3.3.1.1.1.2.1.cmml" xref="Sx4.E7.m1.3.3.3.1.1.1">superscript</csymbol><ci id="Sx4.E7.m1.3.3.3.1.1.1.2.2.cmml" xref="Sx4.E7.m1.3.3.3.1.1.1.2.2">𝐷</ci><ci id="Sx4.E7.m1.3.3.3.1.1.1.2.3.cmml" xref="Sx4.E7.m1.3.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.E7.m1.3.3.3.1.1.1.3a.cmml" xref="Sx4.E7.m1.3.3.3.1.1.1.3"><mtext mathsize="70%" id="Sx4.E7.m1.3.3.3.1.1.1.3.cmml" xref="Sx4.E7.m1.3.3.3.1.1.1.3"> Non_iid_test</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E7.m1.3c">\textbf{PFL-accuracy: }T_{\text{PFL}}=\frac{\sum_{i}{I(y_{j}=\hat{y_{j}};D_{\text{ Non\_iid\_test}}^{i};\bm{\theta}^{i})}}{\sum_{i}|D^{i}_{\text{ Non\_iid\_test}}|}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx2.SSS0.Px1.p1.4" class="ltx_p">where <math id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="I(\cdot)" display="inline"><semantics id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1a"><mrow id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.cmml"><mi id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.2" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.1" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.1.cmml">​</mo><mrow id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.3.2" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.3.2.1" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.1" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.3.2.2" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1b"><apply id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2"><times id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.1.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.1"></times><ci id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.2.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.2.2">𝐼</ci><ci id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.SSS0.Px1.p1.1.m1.1c">I(\cdot)</annotation></semantics></math> is an indicator function (<math id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="I(E)=1" display="inline"><semantics id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1a"><mrow id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.cmml"><mrow id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.cmml"><mi id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.2" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.1" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.1.cmml">​</mo><mrow id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.3.2" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.cmml"><mo stretchy="false" id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.3.2.1" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.cmml">(</mo><mi id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.1" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.1.cmml">E</mi><mo stretchy="false" id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.3.2.2" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.1" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.1.cmml">=</mo><mn id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.3" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1b"><apply id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2"><eq id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.1.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.1"></eq><apply id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2"><times id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.1.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.1"></times><ci id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.2.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.2.2">𝐼</ci><ci id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.1">𝐸</ci></apply><cn type="integer" id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.3.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.2.m2.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.SSS0.Px1.p1.2.m2.1c">I(E)=1</annotation></semantics></math> if event <math id="Sx4.SSx2.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="Sx4.SSx2.SSS0.Px1.p1.3.m3.1a"><mi id="Sx4.SSx2.SSS0.Px1.p1.3.m3.1.1" xref="Sx4.SSx2.SSS0.Px1.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.SSS0.Px1.p1.3.m3.1b"><ci id="Sx4.SSx2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.SSS0.Px1.p1.3.m3.1c">E</annotation></semantics></math> is true, and <math id="Sx4.SSx2.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="0" display="inline"><semantics id="Sx4.SSx2.SSS0.Px1.p1.4.m4.1a"><mn id="Sx4.SSx2.SSS0.Px1.p1.4.m4.1.1" xref="Sx4.SSx2.SSS0.Px1.p1.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.SSS0.Px1.p1.4.m4.1b"><cn type="integer" id="Sx4.SSx2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="Sx4.SSx2.SSS0.Px1.p1.4.m4.1.1">0</cn></annotation-xml></semantics></math> otherwise). The test accuracy of PFL is obtained by the sum of all the local true predictions number divided by the sum of the number of all test sets. It is worth emphasizing that the local testing process utilizes the personalized model instead of the global model.</p>
</div>
</section>
<section id="Sx4.SSx2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Evaluation of client drift.</h4>

<div id="Sx4.SSx2.SSS0.Px2.p1" class="ltx_para">
<p id="Sx4.SSx2.SSS0.Px2.p1.1" class="ltx_p">We also propose an evaluation method to quantify the degree of client drift. Since the varied data distributions, the local training performs with biases towards the local classes and easily forgets other knowledge, including other classes’ features or different features of the same class. Aiming at quantifying the degree of client drift, we can evaluate the personalized model on the local iid test set, which has all categories and each one has the same number of samples. This iid test set can guarantee the generalization and thus we can treat the resulted accuracy as the metric of client drift. In this evaluation, the low value indicates a high degree of drift while the great value indicates that local training does not completely forget other knowledge and has a low degree of client drift. The formulation can be given by the following:</p>
<table id="Sx4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx4.E8.m1.3" class="ltx_Math" alttext="\textbf{PFL-accuracy: }T_{\text{PFL}}=\frac{\sum_{i}{I(y_{j}=\hat{y_{j}};D^{i}_{\textbf{iid\_test}};\bm{\theta}^{i})}}{\sum_{i}|D^{i}_{\textbf{iid\_test}}|}" display="block"><semantics id="Sx4.E8.m1.3a"><mrow id="Sx4.E8.m1.3.4" xref="Sx4.E8.m1.3.4.cmml"><mrow id="Sx4.E8.m1.3.4.2" xref="Sx4.E8.m1.3.4.2.cmml"><mtext class="ltx_mathvariant_bold" id="Sx4.E8.m1.3.4.2.2" xref="Sx4.E8.m1.3.4.2.2a.cmml">PFL-accuracy: </mtext><mo lspace="0em" rspace="0em" id="Sx4.E8.m1.3.4.2.1" xref="Sx4.E8.m1.3.4.2.1.cmml">​</mo><msub id="Sx4.E8.m1.3.4.2.3" xref="Sx4.E8.m1.3.4.2.3.cmml"><mi id="Sx4.E8.m1.3.4.2.3.2" xref="Sx4.E8.m1.3.4.2.3.2.cmml">T</mi><mtext id="Sx4.E8.m1.3.4.2.3.3" xref="Sx4.E8.m1.3.4.2.3.3a.cmml">PFL</mtext></msub></mrow><mo id="Sx4.E8.m1.3.4.1" xref="Sx4.E8.m1.3.4.1.cmml">=</mo><mfrac id="Sx4.E8.m1.3.3" xref="Sx4.E8.m1.3.3.cmml"><mrow id="Sx4.E8.m1.2.2.2" xref="Sx4.E8.m1.2.2.2.cmml"><msub id="Sx4.E8.m1.2.2.2.3" xref="Sx4.E8.m1.2.2.2.3.cmml"><mo id="Sx4.E8.m1.2.2.2.3.2" xref="Sx4.E8.m1.2.2.2.3.2.cmml">∑</mo><mi id="Sx4.E8.m1.2.2.2.3.3" xref="Sx4.E8.m1.2.2.2.3.3.cmml">i</mi></msub><mrow id="Sx4.E8.m1.2.2.2.2" xref="Sx4.E8.m1.2.2.2.2.cmml"><mi id="Sx4.E8.m1.2.2.2.2.3" xref="Sx4.E8.m1.2.2.2.2.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="Sx4.E8.m1.2.2.2.2.2" xref="Sx4.E8.m1.2.2.2.2.2.cmml">​</mo><mrow id="Sx4.E8.m1.2.2.2.2.1.1" xref="Sx4.E8.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx4.E8.m1.2.2.2.2.1.1.2" xref="Sx4.E8.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="Sx4.E8.m1.2.2.2.2.1.1.1" xref="Sx4.E8.m1.2.2.2.2.1.1.1.cmml"><msub id="Sx4.E8.m1.2.2.2.2.1.1.1.4" xref="Sx4.E8.m1.2.2.2.2.1.1.1.4.cmml"><mi id="Sx4.E8.m1.2.2.2.2.1.1.1.4.2" xref="Sx4.E8.m1.2.2.2.2.1.1.1.4.2.cmml">y</mi><mi id="Sx4.E8.m1.2.2.2.2.1.1.1.4.3" xref="Sx4.E8.m1.2.2.2.2.1.1.1.4.3.cmml">j</mi></msub><mo id="Sx4.E8.m1.2.2.2.2.1.1.1.3" xref="Sx4.E8.m1.2.2.2.2.1.1.1.3.cmml">=</mo><mrow id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.3.cmml"><mover accent="true" id="Sx4.E8.m1.1.1.1.1" xref="Sx4.E8.m1.1.1.1.1.cmml"><msub id="Sx4.E8.m1.1.1.1.1.2" xref="Sx4.E8.m1.1.1.1.1.2.cmml"><mi id="Sx4.E8.m1.1.1.1.1.2.2" xref="Sx4.E8.m1.1.1.1.1.2.2.cmml">y</mi><mi id="Sx4.E8.m1.1.1.1.1.2.3" xref="Sx4.E8.m1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="Sx4.E8.m1.1.1.1.1.1" xref="Sx4.E8.m1.1.1.1.1.1.cmml">^</mo></mover><mo id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.3" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.3.cmml">;</mo><msubsup id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.2" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">D</mi><mtext class="ltx_mathvariant_bold" id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.3" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.3a.cmml">iid_test</mtext><mi id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.3" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.4" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.3.cmml">;</mo><msup id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.cmml"><mi id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.2" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.2.cmml">𝜽</mi><mi id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.3" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.3.cmml">i</mi></msup></mrow></mrow><mo stretchy="false" id="Sx4.E8.m1.2.2.2.2.1.1.3" xref="Sx4.E8.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="Sx4.E8.m1.3.3.3" xref="Sx4.E8.m1.3.3.3.cmml"><msub id="Sx4.E8.m1.3.3.3.2" xref="Sx4.E8.m1.3.3.3.2.cmml"><mo id="Sx4.E8.m1.3.3.3.2.2" xref="Sx4.E8.m1.3.3.3.2.2.cmml">∑</mo><mi id="Sx4.E8.m1.3.3.3.2.3" xref="Sx4.E8.m1.3.3.3.2.3.cmml">i</mi></msub><mrow id="Sx4.E8.m1.3.3.3.1.1" xref="Sx4.E8.m1.3.3.3.1.2.cmml"><mo lspace="0em" stretchy="false" id="Sx4.E8.m1.3.3.3.1.1.2" xref="Sx4.E8.m1.3.3.3.1.2.1.cmml">|</mo><msubsup id="Sx4.E8.m1.3.3.3.1.1.1" xref="Sx4.E8.m1.3.3.3.1.1.1.cmml"><mi id="Sx4.E8.m1.3.3.3.1.1.1.2.2" xref="Sx4.E8.m1.3.3.3.1.1.1.2.2.cmml">D</mi><mtext class="ltx_mathvariant_bold" id="Sx4.E8.m1.3.3.3.1.1.1.3" xref="Sx4.E8.m1.3.3.3.1.1.1.3a.cmml">iid_test</mtext><mi id="Sx4.E8.m1.3.3.3.1.1.1.2.3" xref="Sx4.E8.m1.3.3.3.1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="Sx4.E8.m1.3.3.3.1.1.3" xref="Sx4.E8.m1.3.3.3.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E8.m1.3b"><apply id="Sx4.E8.m1.3.4.cmml" xref="Sx4.E8.m1.3.4"><eq id="Sx4.E8.m1.3.4.1.cmml" xref="Sx4.E8.m1.3.4.1"></eq><apply id="Sx4.E8.m1.3.4.2.cmml" xref="Sx4.E8.m1.3.4.2"><times id="Sx4.E8.m1.3.4.2.1.cmml" xref="Sx4.E8.m1.3.4.2.1"></times><ci id="Sx4.E8.m1.3.4.2.2a.cmml" xref="Sx4.E8.m1.3.4.2.2"><mtext class="ltx_mathvariant_bold" id="Sx4.E8.m1.3.4.2.2.cmml" xref="Sx4.E8.m1.3.4.2.2">PFL-accuracy: </mtext></ci><apply id="Sx4.E8.m1.3.4.2.3.cmml" xref="Sx4.E8.m1.3.4.2.3"><csymbol cd="ambiguous" id="Sx4.E8.m1.3.4.2.3.1.cmml" xref="Sx4.E8.m1.3.4.2.3">subscript</csymbol><ci id="Sx4.E8.m1.3.4.2.3.2.cmml" xref="Sx4.E8.m1.3.4.2.3.2">𝑇</ci><ci id="Sx4.E8.m1.3.4.2.3.3a.cmml" xref="Sx4.E8.m1.3.4.2.3.3"><mtext mathsize="70%" id="Sx4.E8.m1.3.4.2.3.3.cmml" xref="Sx4.E8.m1.3.4.2.3.3">PFL</mtext></ci></apply></apply><apply id="Sx4.E8.m1.3.3.cmml" xref="Sx4.E8.m1.3.3"><divide id="Sx4.E8.m1.3.3.4.cmml" xref="Sx4.E8.m1.3.3"></divide><apply id="Sx4.E8.m1.2.2.2.cmml" xref="Sx4.E8.m1.2.2.2"><apply id="Sx4.E8.m1.2.2.2.3.cmml" xref="Sx4.E8.m1.2.2.2.3"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.2.3.1.cmml" xref="Sx4.E8.m1.2.2.2.3">subscript</csymbol><sum id="Sx4.E8.m1.2.2.2.3.2.cmml" xref="Sx4.E8.m1.2.2.2.3.2"></sum><ci id="Sx4.E8.m1.2.2.2.3.3.cmml" xref="Sx4.E8.m1.2.2.2.3.3">𝑖</ci></apply><apply id="Sx4.E8.m1.2.2.2.2.cmml" xref="Sx4.E8.m1.2.2.2.2"><times id="Sx4.E8.m1.2.2.2.2.2.cmml" xref="Sx4.E8.m1.2.2.2.2.2"></times><ci id="Sx4.E8.m1.2.2.2.2.3.cmml" xref="Sx4.E8.m1.2.2.2.2.3">𝐼</ci><apply id="Sx4.E8.m1.2.2.2.2.1.1.1.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1"><eq id="Sx4.E8.m1.2.2.2.2.1.1.1.3.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.3"></eq><apply id="Sx4.E8.m1.2.2.2.2.1.1.1.4.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.2.2.1.1.1.4.1.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.4">subscript</csymbol><ci id="Sx4.E8.m1.2.2.2.2.1.1.1.4.2.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.4.2">𝑦</ci><ci id="Sx4.E8.m1.2.2.2.2.1.1.1.4.3.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.4.3">𝑗</ci></apply><list id="Sx4.E8.m1.2.2.2.2.1.1.1.2.3.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.2"><apply id="Sx4.E8.m1.1.1.1.1.cmml" xref="Sx4.E8.m1.1.1.1.1"><ci id="Sx4.E8.m1.1.1.1.1.1.cmml" xref="Sx4.E8.m1.1.1.1.1.1">^</ci><apply id="Sx4.E8.m1.1.1.1.1.2.cmml" xref="Sx4.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E8.m1.1.1.1.1.2.1.cmml" xref="Sx4.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="Sx4.E8.m1.1.1.1.1.2.2.cmml" xref="Sx4.E8.m1.1.1.1.1.2.2">𝑦</ci><ci id="Sx4.E8.m1.1.1.1.1.2.3.cmml" xref="Sx4.E8.m1.1.1.1.1.2.3">𝑗</ci></apply></apply><apply id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐷</ci><ci id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.3a.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.1.1.1.3">iid_test</mtext></ci></apply><apply id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2">superscript</csymbol><ci id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.2">𝜽</ci><ci id="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="Sx4.E8.m1.2.2.2.2.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply><apply id="Sx4.E8.m1.3.3.3.cmml" xref="Sx4.E8.m1.3.3.3"><apply id="Sx4.E8.m1.3.3.3.2.cmml" xref="Sx4.E8.m1.3.3.3.2"><csymbol cd="ambiguous" id="Sx4.E8.m1.3.3.3.2.1.cmml" xref="Sx4.E8.m1.3.3.3.2">subscript</csymbol><sum id="Sx4.E8.m1.3.3.3.2.2.cmml" xref="Sx4.E8.m1.3.3.3.2.2"></sum><ci id="Sx4.E8.m1.3.3.3.2.3.cmml" xref="Sx4.E8.m1.3.3.3.2.3">𝑖</ci></apply><apply id="Sx4.E8.m1.3.3.3.1.2.cmml" xref="Sx4.E8.m1.3.3.3.1.1"><abs id="Sx4.E8.m1.3.3.3.1.2.1.cmml" xref="Sx4.E8.m1.3.3.3.1.1.2"></abs><apply id="Sx4.E8.m1.3.3.3.1.1.1.cmml" xref="Sx4.E8.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.3.3.3.1.1.1.1.cmml" xref="Sx4.E8.m1.3.3.3.1.1.1">subscript</csymbol><apply id="Sx4.E8.m1.3.3.3.1.1.1.2.cmml" xref="Sx4.E8.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.3.3.3.1.1.1.2.1.cmml" xref="Sx4.E8.m1.3.3.3.1.1.1">superscript</csymbol><ci id="Sx4.E8.m1.3.3.3.1.1.1.2.2.cmml" xref="Sx4.E8.m1.3.3.3.1.1.1.2.2">𝐷</ci><ci id="Sx4.E8.m1.3.3.3.1.1.1.2.3.cmml" xref="Sx4.E8.m1.3.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.E8.m1.3.3.3.1.1.1.3a.cmml" xref="Sx4.E8.m1.3.3.3.1.1.1.3"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="Sx4.E8.m1.3.3.3.1.1.1.3.cmml" xref="Sx4.E8.m1.3.3.3.1.1.1.3">iid_test</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E8.m1.3c">\textbf{PFL-accuracy: }T_{\text{PFL}}=\frac{\sum_{i}{I(y_{j}=\hat{y_{j}};D^{i}_{\textbf{iid\_test}};\bm{\theta}^{i})}}{\sum_{i}|D^{i}_{\textbf{iid\_test}}|}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<figure id="Sx4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Drift degree of different methods. Client drift is quantified by the accuracy of applying the personalized model on iid test set. A lower value indicates a larger degree of drift. The underline highlight the best-performing compared approach.</figcaption>
<div id="Sx4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:505.9pt;height:147.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-24.5pt,7.1pt) scale(0.911854337667395,0.911854337667395) ;">
<table id="Sx4.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T2.1.1.1.1" class="ltx_tr">
<th id="Sx4.T2.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Dataset</th>
<th id="Sx4.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Non-iid</th>
<th id="Sx4.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local only</th>
<th id="Sx4.T2.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="Sx4.T2.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedProx</th>
<th id="Sx4.T2.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Scaffold</th>
<th id="Sx4.T2.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">LG_FedAvg</th>
<th id="Sx4.T2.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedPer</th>
<th id="Sx4.T2.1.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedRep</th>
<th id="Sx4.T2.1.1.1.1.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedRod</th>
<th id="Sx4.T2.1.1.1.1.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedABC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T2.1.1.2.1" class="ltx_tr">
<td id="Sx4.T2.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="Sx4.T2.1.1.2.1.1.1" class="ltx_text">MNIST</span></td>
<td id="Sx4.T2.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Dir(0.1)</td>
<td id="Sx4.T2.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">29.2</td>
<td id="Sx4.T2.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">43.7</td>
<td id="Sx4.T2.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">39.4</td>
<td id="Sx4.T2.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="Sx4.T2.1.1.2.1.6.1" class="ltx_text ltx_ulem_uline">76.8</span></td>
<td id="Sx4.T2.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">43.9</td>
<td id="Sx4.T2.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">43.7</td>
<td id="Sx4.T2.1.1.2.1.9" class="ltx_td ltx_align_center ltx_border_t">42.9</td>
<td id="Sx4.T2.1.1.2.1.10" class="ltx_td ltx_align_center ltx_border_t">66.9</td>
<td id="Sx4.T2.1.1.2.1.11" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx4.T2.1.1.2.1.11.1" class="ltx_text ltx_font_bold">76.5</span></td>
</tr>
<tr id="Sx4.T2.1.1.3.2" class="ltx_tr">
<td id="Sx4.T2.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r">Dir(0.3)</td>
<td id="Sx4.T2.1.1.3.2.2" class="ltx_td ltx_align_center">44.2</td>
<td id="Sx4.T2.1.1.3.2.3" class="ltx_td ltx_align_center">68.2</td>
<td id="Sx4.T2.1.1.3.2.4" class="ltx_td ltx_align_center">62.2</td>
<td id="Sx4.T2.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r"><span id="Sx4.T2.1.1.3.2.5.1" class="ltx_text ltx_ulem_uline">90.2</span></td>
<td id="Sx4.T2.1.1.3.2.6" class="ltx_td ltx_align_center">68.1</td>
<td id="Sx4.T2.1.1.3.2.7" class="ltx_td ltx_align_center">68.2</td>
<td id="Sx4.T2.1.1.3.2.8" class="ltx_td ltx_align_center">66.3</td>
<td id="Sx4.T2.1.1.3.2.9" class="ltx_td ltx_align_center">85.4</td>
<td id="Sx4.T2.1.1.3.2.10" class="ltx_td ltx_align_center"><span id="Sx4.T2.1.1.3.2.10.1" class="ltx_text ltx_font_bold">91.1</span></td>
</tr>
<tr id="Sx4.T2.1.1.4.3" class="ltx_tr">
<td id="Sx4.T2.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r">Dir(0.5)</td>
<td id="Sx4.T2.1.1.4.3.2" class="ltx_td ltx_align_center">58.0</td>
<td id="Sx4.T2.1.1.4.3.3" class="ltx_td ltx_align_center">78.7</td>
<td id="Sx4.T2.1.1.4.3.4" class="ltx_td ltx_align_center">74.0</td>
<td id="Sx4.T2.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r"><span id="Sx4.T2.1.1.4.3.5.1" class="ltx_text ltx_ulem_uline">94.0</span></td>
<td id="Sx4.T2.1.1.4.3.6" class="ltx_td ltx_align_center">78.7</td>
<td id="Sx4.T2.1.1.4.3.7" class="ltx_td ltx_align_center">78.8</td>
<td id="Sx4.T2.1.1.4.3.8" class="ltx_td ltx_align_center">77.1</td>
<td id="Sx4.T2.1.1.4.3.9" class="ltx_td ltx_align_center">90.8</td>
<td id="Sx4.T2.1.1.4.3.10" class="ltx_td ltx_align_center"><span id="Sx4.T2.1.1.4.3.10.1" class="ltx_text ltx_font_bold">95.1</span></td>
</tr>
<tr id="Sx4.T2.1.1.5.4" class="ltx_tr">
<td id="Sx4.T2.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r">Dir(1.0)</td>
<td id="Sx4.T2.1.1.5.4.2" class="ltx_td ltx_align_center">69.5</td>
<td id="Sx4.T2.1.1.5.4.3" class="ltx_td ltx_align_center">87.6</td>
<td id="Sx4.T2.1.1.5.4.4" class="ltx_td ltx_align_center">84.9</td>
<td id="Sx4.T2.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="Sx4.T2.1.1.5.4.5.1" class="ltx_text ltx_ulem_uline">97.0</span></td>
<td id="Sx4.T2.1.1.5.4.6" class="ltx_td ltx_align_center">87.6</td>
<td id="Sx4.T2.1.1.5.4.7" class="ltx_td ltx_align_center">87.6</td>
<td id="Sx4.T2.1.1.5.4.8" class="ltx_td ltx_align_center">86.4</td>
<td id="Sx4.T2.1.1.5.4.9" class="ltx_td ltx_align_center">95.3</td>
<td id="Sx4.T2.1.1.5.4.10" class="ltx_td ltx_align_center"><span id="Sx4.T2.1.1.5.4.10.1" class="ltx_text ltx_font_bold">97.2</span></td>
</tr>
<tr id="Sx4.T2.1.1.6.5" class="ltx_tr">
<td id="Sx4.T2.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="Sx4.T2.1.1.6.5.1.1" class="ltx_text">CIFAR-10</span></td>
<td id="Sx4.T2.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Dir(0.1)</td>
<td id="Sx4.T2.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t">16.7</td>
<td id="Sx4.T2.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t">37.0</td>
<td id="Sx4.T2.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t">37.8</td>
<td id="Sx4.T2.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="Sx4.T2.1.1.6.5.6.1" class="ltx_text ltx_ulem_uline">39.6</span></td>
<td id="Sx4.T2.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_t">20.6</td>
<td id="Sx4.T2.1.1.6.5.8" class="ltx_td ltx_align_center ltx_border_t">38.6</td>
<td id="Sx4.T2.1.1.6.5.9" class="ltx_td ltx_align_center ltx_border_t">23.5</td>
<td id="Sx4.T2.1.1.6.5.10" class="ltx_td ltx_align_center ltx_border_t">31.5</td>
<td id="Sx4.T2.1.1.6.5.11" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx4.T2.1.1.6.5.11.1" class="ltx_text ltx_font_bold">34.5</span></td>
</tr>
<tr id="Sx4.T2.1.1.7.6" class="ltx_tr">
<td id="Sx4.T2.1.1.7.6.1" class="ltx_td ltx_align_center ltx_border_r">Dir(0.3)</td>
<td id="Sx4.T2.1.1.7.6.2" class="ltx_td ltx_align_center">23.3</td>
<td id="Sx4.T2.1.1.7.6.3" class="ltx_td ltx_align_center">56.4</td>
<td id="Sx4.T2.1.1.7.6.4" class="ltx_td ltx_align_center">56.3</td>
<td id="Sx4.T2.1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_r"><span id="Sx4.T2.1.1.7.6.5.1" class="ltx_text ltx_ulem_uline">56.1</span></td>
<td id="Sx4.T2.1.1.7.6.6" class="ltx_td ltx_align_center">32.1</td>
<td id="Sx4.T2.1.1.7.6.7" class="ltx_td ltx_align_center">42.0</td>
<td id="Sx4.T2.1.1.7.6.8" class="ltx_td ltx_align_center">41.6</td>
<td id="Sx4.T2.1.1.7.6.9" class="ltx_td ltx_align_center">51.4</td>
<td id="Sx4.T2.1.1.7.6.10" class="ltx_td ltx_align_center"><span id="Sx4.T2.1.1.7.6.10.1" class="ltx_text ltx_font_bold">54.7</span></td>
</tr>
<tr id="Sx4.T2.1.1.8.7" class="ltx_tr">
<td id="Sx4.T2.1.1.8.7.1" class="ltx_td ltx_align_center ltx_border_r">Dir(0.5)</td>
<td id="Sx4.T2.1.1.8.7.2" class="ltx_td ltx_align_center">25.6</td>
<td id="Sx4.T2.1.1.8.7.3" class="ltx_td ltx_align_center">60.0</td>
<td id="Sx4.T2.1.1.8.7.4" class="ltx_td ltx_align_center">59.9</td>
<td id="Sx4.T2.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="Sx4.T2.1.1.8.7.5.1" class="ltx_text ltx_ulem_uline">60.0</span></td>
<td id="Sx4.T2.1.1.8.7.6" class="ltx_td ltx_align_center">35.4</td>
<td id="Sx4.T2.1.1.8.7.7" class="ltx_td ltx_align_center">47.0</td>
<td id="Sx4.T2.1.1.8.7.8" class="ltx_td ltx_align_center">46.5</td>
<td id="Sx4.T2.1.1.8.7.9" class="ltx_td ltx_align_center">55.5</td>
<td id="Sx4.T2.1.1.8.7.10" class="ltx_td ltx_align_center"><span id="Sx4.T2.1.1.8.7.10.1" class="ltx_text ltx_font_bold">59.0</span></td>
</tr>
<tr id="Sx4.T2.1.1.9.8" class="ltx_tr">
<td id="Sx4.T2.1.1.9.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">Dir(1.0)</td>
<td id="Sx4.T2.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_bb">14.4</td>
<td id="Sx4.T2.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_bb">64.8</td>
<td id="Sx4.T2.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_bb">64.2</td>
<td id="Sx4.T2.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="Sx4.T2.1.1.9.8.5.1" class="ltx_text ltx_ulem_uline">65.2</span></td>
<td id="Sx4.T2.1.1.9.8.6" class="ltx_td ltx_align_center ltx_border_bb">39.7</td>
<td id="Sx4.T2.1.1.9.8.7" class="ltx_td ltx_align_center ltx_border_bb">52.7</td>
<td id="Sx4.T2.1.1.9.8.8" class="ltx_td ltx_align_center ltx_border_bb">53.8</td>
<td id="Sx4.T2.1.1.9.8.9" class="ltx_td ltx_align_center ltx_border_bb">61.5</td>
<td id="Sx4.T2.1.1.9.8.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="Sx4.T2.1.1.9.8.10.1" class="ltx_text ltx_font_bold">64.0</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="Sx4.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Results and analysis</h3>

<div id="Sx4.SSx3.p1" class="ltx_para">
<p id="Sx4.SSx3.p1.1" class="ltx_p">We present the results in Tables <a href="#Sx4.T1" title="Table 1 ‣ Compared methods. ‣ Setup ‣ Experiments ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> &amp;<a href="#Sx4.T2" title="Table 2 ‣ Evaluation of client drift. ‣ Evaluation criteria ‣ Experiments ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, underline and bold fonts highlight the best baseline/our approach. From the experimented results, we observe that: 1) the advanced local training of generic FL can achieve promising PFL accuracy and even outperforms other existing PFL algorithms, especially in the huge heterogeneity setting(i.e.,0.1). The reason behind this is that the data distribution of test data is the same as the training data. To understand it better, we can assume that each client only accesses a single class, the PFL accuracy in this situation will close to <math id="Sx4.SSx3.p1.1.m1.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="Sx4.SSx3.p1.1.m1.1a"><mrow id="Sx4.SSx3.p1.1.m1.1.1" xref="Sx4.SSx3.p1.1.m1.1.1.cmml"><mn id="Sx4.SSx3.p1.1.m1.1.1.2" xref="Sx4.SSx3.p1.1.m1.1.1.2.cmml">100</mn><mo id="Sx4.SSx3.p1.1.m1.1.1.1" xref="Sx4.SSx3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.1.m1.1b"><apply id="Sx4.SSx3.p1.1.m1.1.1.cmml" xref="Sx4.SSx3.p1.1.m1.1.1"><csymbol cd="latexml" id="Sx4.SSx3.p1.1.m1.1.1.1.cmml" xref="Sx4.SSx3.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="Sx4.SSx3.p1.1.m1.1.1.2.cmml" xref="Sx4.SSx3.p1.1.m1.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.1.m1.1c">100\%</annotation></semantics></math>; 2) the accuracy of PFL decrease with the level of heterogeneity decrease because the local training is hard to cater for all classes inside clients; 3) FedRod achieves the best performance in baselines. FedRod has double classifiers for global paradigm and personalized paradigm and thus is more robust. 4) Regard to the PFL accuracy, our FedABC achieves promising performance and outperforms other baselines. 4) Regard to the client drift, Scaffold uses control variates to correct for the ‘client-drift’ in its local updates and thus achieves the best performance. Our FedABC also achieves nice performance compared with other methods, especially in PFL baselines.</p>
</div>
<section id="Sx4.SSx3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Ablation study</h4>

<figure id="Sx4.F5" class="ltx_figure"><img src="/html/2302.07450/assets/x12.png" id="Sx4.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="276" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>An ablation study of the proposed FedABC method, where the orange bars (FedABC<math id="Sx4.F5.3.m1.1" class="ltx_Math" alttext="\_" display="inline"><semantics id="Sx4.F5.3.m1.1b"><mi mathvariant="normal" id="Sx4.F5.3.m1.1.1" xref="Sx4.F5.3.m1.1.1.cmml">_</mi><annotation-xml encoding="MathML-Content" id="Sx4.F5.3.m1.1c"><ci id="Sx4.F5.3.m1.1.1.cmml" xref="Sx4.F5.3.m1.1.1">_</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F5.3.m1.1d">\_</annotation></semantics></math>wi) are the performance of our method without adopting the designed binary classification loss that incorporates the under-sampling and hard sample mining strategies.</figcaption>
</figure>
<div id="Sx4.SSx3.SSS0.Px1.p1" class="ltx_para">
<p id="Sx4.SSx3.SSS0.Px1.p1.9" class="ltx_p">We study the necessity of the component for solving the imbalanced problem in our binary classification. We conduct new experiments on CIFAR-10. We train <math id="Sx4.SSx3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="200" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.1.m1.1a"><mn id="Sx4.SSx3.SSS0.Px1.p1.1.m1.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.1.m1.1b"><cn type="integer" id="Sx4.SSx3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.1.m1.1c">200</annotation></semantics></math> epochs for the compared method FedABC_wi without adopting our imbalanced training technique(under-sampling and hard sample mining), the experimented results are shown in Figure <a href="#Sx4.F5" title="Figure 5 ‣ Ablation study ‣ Results and analysis ‣ Experiments ‣ FedABC: Targeting Fair Competition in Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. From the figure, we can find that: 1) Adopting our imbalanced training technique can effectively improve PFL performance. The specific accuracy improvement is <math id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="0.3\%" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1a"><mrow id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.2" xref="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.2.cmml">0.3</mn><mo id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1b"><apply id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="latexml" id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.2.m2.1.1.2">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.2.m2.1c">0.3\%</annotation></semantics></math>, <math id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="1.0\%" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1a"><mrow id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.cmml"><mn id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.2" xref="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.2.cmml">1.0</mn><mo id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1b"><apply id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="latexml" id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.3.m3.1.1.2">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.3.m3.1c">1.0\%</annotation></semantics></math>, <math id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="1.4\%" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1a"><mrow id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.cmml"><mn id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.2" xref="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.2.cmml">1.4</mn><mo id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1b"><apply id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="latexml" id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.1">percent</csymbol><cn type="float" id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.4.m4.1.1.2">1.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.4.m4.1c">1.4\%</annotation></semantics></math>, <math id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="1.6\%" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1a"><mrow id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.cmml"><mn id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.2" xref="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.2.cmml">1.6</mn><mo id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1b"><apply id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="latexml" id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.1">percent</csymbol><cn type="float" id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.5.m5.1.1.2">1.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.5.m5.1c">1.6\%</annotation></semantics></math> for the heterogeneity setting <math id="Sx4.SSx3.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.6.m6.1a"><mn id="Sx4.SSx3.SSS0.Px1.p1.6.m6.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.6.m6.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.6.m6.1b"><cn type="float" id="Sx4.SSx3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.6.m6.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.6.m6.1c">0.1</annotation></semantics></math>, <math id="Sx4.SSx3.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.7.m7.1a"><mn id="Sx4.SSx3.SSS0.Px1.p1.7.m7.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.7.m7.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.7.m7.1b"><cn type="float" id="Sx4.SSx3.SSS0.Px1.p1.7.m7.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.7.m7.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.7.m7.1c">0.3</annotation></semantics></math>, <math id="Sx4.SSx3.SSS0.Px1.p1.8.m8.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.8.m8.1a"><mn id="Sx4.SSx3.SSS0.Px1.p1.8.m8.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.8.m8.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.8.m8.1b"><cn type="float" id="Sx4.SSx3.SSS0.Px1.p1.8.m8.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.8.m8.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.8.m8.1c">0.5</annotation></semantics></math>, <math id="Sx4.SSx3.SSS0.Px1.p1.9.m9.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="Sx4.SSx3.SSS0.Px1.p1.9.m9.1a"><mn id="Sx4.SSx3.SSS0.Px1.p1.9.m9.1.1" xref="Sx4.SSx3.SSS0.Px1.p1.9.m9.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.SSS0.Px1.p1.9.m9.1b"><cn type="float" id="Sx4.SSx3.SSS0.Px1.p1.9.m9.1.1.cmml" xref="Sx4.SSx3.SSS0.Px1.p1.9.m9.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.SSS0.Px1.p1.9.m9.1c">1.0</annotation></semantics></math>, respectively. The positive samples and negative samples sometimes are seriously imbalanced in our binary classification and the efficient imbalanced training technique can alleviate this problem and thus generate improvement; 2) The improvement decreases with the degree of heterogeneity increases. In the huge heterogeneity setting(e.g. Dir(0.1)), the improvement is slight but significant for other settings(e.g. Dir(1.0)). The reason behind it is that re-balancing local data distribution may generate a trade-off problem between the local personality and the imbalanced problem. Since the data distribution of the test set is the same as the train set, excessive re-balancing may inevitably hurt the local personality. Meanwhile, training with a serious imbalanced problem can also impact the classifier decision on minority classes, especially in our binary training strategy.</p>
</div>
</section>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx5.p1" class="ltx_para">
<p id="Sx5.p1.1" class="ltx_p">In this paper, we investigate some extraordinary Non-IID situations in federated learning, where the data distributions among clients are imbalanced and some classes even have no positive samples. These issues are alleviated by constructing a binary classification problem for each category instead of adopting the popular Softmax function. This training strategy may aggravate the class imbalance problem and thus a novel loss function that incorporates the under-sampling and hard sample mining are further designed. Extensive experiments are conducted on two popular datasets, and the results show that our FedABC can significantly improve the PFL performance in diverse heterogeneity settings. The limitation of our FedABC may be the possible conflictions given hundreds and thousands of categories. In the future, we intend to integrate with the communication strategies to further improve the performance and conduct experiments on more large-scale datasets.</p>
</div>
</section>
<section id="Sx6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx6.p1" class="ltx_para">
<p id="Sx6.p1.1" class="ltx_p">This work was supported by the National Key Research and Development Program of China under Grant 2021YFC3300200, the Special Fund of Hubei Luojia Laboratory under Grant 220100014, the National Natural Science Foundation of China (Grant No. 62276195 and 62272354), and the Nation Research Foundation, Prime Minister’s Office, Singapore under its Energy Programme (EP Award No. NRF2017EWT-EP003-023) administrated by the Energy Market Authority of Singapore.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Acar et al. (2021)</span>
<span class="ltx_bibblock">
Acar, D. A. E.; Zhao, Y.; Navarro, R. M.; Mattina, M.; Whatmough, P. N.; and
Saligrama, V. 2021.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2111.04263</em>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Arivazhagan, M. G.; Aggarwal, V.; Singh, A. K.; and Choudhary, S. 2019.

</span>
<span class="ltx_bibblock">Federated Learning with Personalization Layers.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aurelio et al. (2019)</span>
<span class="ltx_bibblock">
Aurelio, Y. S.; de Almeida, G. M.; de Castro, C. L.; and Braga, A. P. 2019.

</span>
<span class="ltx_bibblock">Learning from imbalanced data sets with weighted cross-entropy
function.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Neural processing letters</em>, 50(2): 1937–1949.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Buda, Maki, and Mazurowski (2018)</span>
<span class="ltx_bibblock">
Buda, M.; Maki, A.; and Mazurowski, M. A. 2018.

</span>
<span class="ltx_bibblock">A systematic study of the class imbalance problem in convolutional
neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Neural networks</em>, 106: 249–259.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2018)</span>
<span class="ltx_bibblock">
Chen, F.; Luo, M.; Dong, Z.; Li, Z.; and He, X. 2018.

</span>
<span class="ltx_bibblock">Federated meta-learning with fast convergence and efficient
communication.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1802.07876</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Chao (2021)</span>
<span class="ltx_bibblock">
Chen, H.-Y.; and Chao, W.-L. 2021.

</span>
<span class="ltx_bibblock">On bridging generic and personalized federated learning for image
classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collins et al. (2021)</span>
<span class="ltx_bibblock">
Collins, L.; Hassani, H.; Mokhtari, A.; and Shakkottai, S. 2021.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2089–2099.
PMLR.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2022)</span>
<span class="ltx_bibblock">
Dai, R.; Shen, L.; He, F.; Tian, X.; and Tao, D. 2022.

</span>
<span class="ltx_bibblock">DisPFL: Towards Communication-Efficient Personalized Federated
Learning via Decentralized Sparse Training.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.00187</em>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Drummond, Holte et al. (2003)</span>
<span class="ltx_bibblock">
Drummond, C.; Holte, R. C.; et al. 2003.

</span>
<span class="ltx_bibblock">C4. 5, class imbalance, and cost sensitivity: why under-sampling
beats over-sampling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Workshop on learning from imbalanced datasets II</em>,
volume 11, 1–8. Citeseer.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geifman and El-Yaniv (2017)</span>
<span class="ltx_bibblock">
Geifman, Y.; and El-Yaniv, R. 2017.

</span>
<span class="ltx_bibblock">Deep active learning over the long tail.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1711.00941</em>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2017)</span>
<span class="ltx_bibblock">
Guo, C.; Pleiss, G.; Sun, Y.; and Weinberger, K. Q. 2017.

</span>
<span class="ltx_bibblock">On calibration of modern neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, 1321–1330.
PMLR.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely et al. (2020)</span>
<span class="ltx_bibblock">
Hanzely, F.; Hanzely, S.; Horváth, S.; and Richtárik, P. 2020.

</span>
<span class="ltx_bibblock">Lower bounds and optimal algorithms for personalized federated
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:
2304–2315.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely, Zhao, and Kolar (2021)</span>
<span class="ltx_bibblock">
Hanzely, F.; Zhao, B.; and Kolar, M. 2021.

</span>
<span class="ltx_bibblock">Personalized federated learning: A unified framework and universal
optimization techniques.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.09743</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and Garcia (2009)</span>
<span class="ltx_bibblock">
He, H.; and Garcia, E. A. 2009.

</span>
<span class="ltx_bibblock">Learning from imbalanced data.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on knowledge and data engineering</em>, 21(9):
1263–1284.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et al. (2021)</span>
<span class="ltx_bibblock">
Hong, Y.; Han, S.; Choi, K.; Seo, S.; Kim, B.; and Chang, B. 2021.

</span>
<span class="ltx_bibblock">Disentangling label distribution for long-tailed visual recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, 6626–6636.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hosseini et al. (2021)</span>
<span class="ltx_bibblock">
Hosseini, H.; Park, H.; Yun, S.; Louizos, C.; Soriaga, J.; and Welling, M.
2021.

</span>
<span class="ltx_bibblock">Federated Learning of User Verification Models Without Sharing
Embeddings.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.08776</em>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsieh et al. (2020)</span>
<span class="ltx_bibblock">
Hsieh, K.; Phanishayee, A.; Mutlu, O.; and Gibbons, P. 2020.

</span>
<span class="ltx_bibblock">The non-iid data quagmire of decentralized machine learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 4387–4398.
PMLR.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2016)</span>
<span class="ltx_bibblock">
Huang, C.; Li, Y.; Loy, C. C.; and Tang, X. 2016.

</span>
<span class="ltx_bibblock">Learning deep representation for imbalanced classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 5375–5384.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2022a)</span>
<span class="ltx_bibblock">
Huang, T.; Lin, W.; Shen, L.; Li, K.; and Zomaya, A. Y. 2022a.

</span>
<span class="ltx_bibblock">Stochastic client selection for federated learning with volatile
clients.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2022b)</span>
<span class="ltx_bibblock">
Huang, T.; Liu, S.; Shen, L.; He, F.; Lin, W.; and Tao, D. 2022b.

</span>
<span class="ltx_bibblock">Achieving Personalized Federated Learning with Sparse Local Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2201.11380</em>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jang, Gu, and Poole (2016)</span>
<span class="ltx_bibblock">
Jang, E.; Gu, S.; and Poole, B. 2016.

</span>
<span class="ltx_bibblock">Categorical reparameterization with gumbel-softmax.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1611.01144</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Japkowicz and Stephen (2002)</span>
<span class="ltx_bibblock">
Japkowicz, N.; and Stephen, S. 2002.

</span>
<span class="ltx_bibblock">The class imbalance problem: A systematic study.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Intelligent data analysis</em>, 6(5): 429–449.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang et al. (2019)</span>
<span class="ltx_bibblock">
Kang, B.; Xie, S.; Rohrbach, M.; Yan, Z.; Gordo, A.; Feng, J.; and Kalantidis,
Y. 2019.

</span>
<span class="ltx_bibblock">Decoupling representation and classifier for long-tailed recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.09217</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P.; Kale, S.; Mohri, M.; Reddi, S.; Stich, S.; and Suresh,
A. T. 2020.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 5132–5143.
PMLR.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katharopoulos and Fleuret (2018)</span>
<span class="ltx_bibblock">
Katharopoulos, A.; and Fleuret, F. 2018.

</span>
<span class="ltx_bibblock">Not all samples are created equal: Deep learning with importance
sampling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, 2525–2534.
PMLR.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khodak, Balcan, and Talwalkar (2019)</span>
<span class="ltx_bibblock">
Khodak, M.; Balcan, M.-F. F.; and Talwalkar, A. S. 2019.

</span>
<span class="ltx_bibblock">Adaptive gradient-based meta-learning methods.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 32.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky and Hinton (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A.; and Hinton, G. 2009.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Handbook of Systemic Autoimmune Diseases</em>, 1(4).

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lecun and Bottou (1998)</span>
<span class="ltx_bibblock">
Lecun, Y.; and Bottou, L. 1998.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 86(11): 2278–2324.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (1998)</span>
<span class="ltx_bibblock">
LeCun, Y.; Bottou, L.; Bengio, Y.; and Haffner, P. 1998.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 86(11): 2278–2324.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021a)</span>
<span class="ltx_bibblock">
Li, Q.; Diao, Y.; Chen, Q.; and He, B. 2021a.

</span>
<span class="ltx_bibblock">Federated learning on non-iid data silos: An experimental study.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.02079</em>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021b)</span>
<span class="ltx_bibblock">
Li, T.; Hu, S.; Beirami, A.; and Smith, V. 2021b.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through personalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 6357–6368.
PMLR.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Talwalkar, A.; and Smith, V. 2020.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, 37(3): 50–60.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2020)</span>
<span class="ltx_bibblock">
Liang, P. P.; Liu, T.; Ziyin, L.; Allen, N. B.; Auerbach, R. P.; Brent, D.;
Salakhutdinov, R.; and Morency, L.-P. 2020.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning with local and global
representations.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.01523</em>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2017)</span>
<span class="ltx_bibblock">
Lin, T.-Y.; Goyal, P.; Girshick, R.; He, K.; and Dollár, P. 2017.

</span>
<span class="ltx_bibblock">Focal loss for dense object detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</em>, 2980–2988.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022)</span>
<span class="ltx_bibblock">
Liu, C.; Lou, C.; Wang, R.; Xi, A. Y.; Shen, L.; and Yan, J. 2022.

</span>
<span class="ltx_bibblock">Deep neural network fusion via graph matching with applications to
model ensemble and federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 13857–13869.
PMLR.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B.; Moore, E.; Ramage, D.; Hampson, S.; and y Arcas, B. A. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, 1273–1282. PMLR.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2020)</span>
<span class="ltx_bibblock">
Ren, J.; Yu, C.; Ma, X.; Zhao, H.; Yi, S.; et al. 2020.

</span>
<span class="ltx_bibblock">Balanced meta-softmax for long-tailed visual recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:
4175–4186.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rifkin and Klautau (2004)</span>
<span class="ltx_bibblock">
Rifkin, R.; and Klautau, A. 2004.

</span>
<span class="ltx_bibblock">In defense of one-vs-all classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, 5: 101–141.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schroff, Kalenichenko, and Philbin (2015)</span>
<span class="ltx_bibblock">
Schroff, F.; Kalenichenko, D.; and Philbin, J. 2015.

</span>
<span class="ltx_bibblock">Facenet: A unified embedding for face recognition and clustering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 815–823.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen, Lin, and Huang (2016)</span>
<span class="ltx_bibblock">
Shen, L.; Lin, Z.; and Huang, Q. 2016.

</span>
<span class="ltx_bibblock">Relay backpropagation for effective learning of deep convolutional
neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>, 467–482. Springer.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al. (2017)</span>
<span class="ltx_bibblock">
Smith, V.; Chiang, C.-K.; Sanjabi, M.; and Talwalkar, A. S. 2017.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
Sun, B.; Huo, H.; Yang, Y.; and Bai, B. 2021.

</span>
<span class="ltx_bibblock">Partialfed: Cross-domain personalized federated learning via partial
initialization.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34:
23309–23320.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">T Dinh, Tran, and Nguyen (2020)</span>
<span class="ltx_bibblock">
T Dinh, C.; Tran, N.; and Nguyen, J. 2020.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:
21394–21405.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van Horn and Perona (2017)</span>
<span class="ltx_bibblock">
Van Horn, G.; and Perona, P. 2017.

</span>
<span class="ltx_bibblock">The devil is in the tails: Fine-grained classification in the wild.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1709.01450</em>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Wang, H.; Yurochkin, M.; Sun, Y.; Papailiopoulos, D.; and Khazaeni, Y. 2020.

</span>
<span class="ltx_bibblock">Federated learning with matched averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.06440</em>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, K.; Mathews, R.; Kiddon, C.; Eichner, H.; Beaufays, F.; and Ramage, D.
2019.

</span>
<span class="ltx_bibblock">Federated evaluation of on-device personalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.10252</em>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen et al. (2021)</span>
<span class="ltx_bibblock">
Wen, Y.; Liu, W.; Weller, A.; Raj, B.; and Singh, R. 2021.

</span>
<span class="ltx_bibblock">Sphereface2: Binary classification is all you need for deep face
recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.01513</em>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2017)</span>
<span class="ltx_bibblock">
Wu, C.-Y.; Manmatha, R.; Smola, A. J.; and Krahenbuhl, P. 2017.

</span>
<span class="ltx_bibblock">Sampling matters in deep embedding learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</em>, 2840–2848.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2021)</span>
<span class="ltx_bibblock">
Xu, J.; Glicksberg, B. S.; Su, C.; Walker, P.; Bian, J.; and Wang, F. 2021.

</span>
<span class="ltx_bibblock">Federated learning for healthcare informatics.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Journal of Healthcare Informatics Research</em>, 5(1): 1–19.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yen and Lee (2009)</span>
<span class="ltx_bibblock">
Yen, S.-J.; and Lee, Y.-S. 2009.

</span>
<span class="ltx_bibblock">Cluster-based under-sampling approaches for imbalanced data
distributions.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Expert Systems with Applications</em>, 36(3): 5718–5727.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yurochkin et al. (2019)</span>
<span class="ltx_bibblock">
Yurochkin, M.; Agarwal, M.; Ghosh, S.; Greenewald, K.; Hoang, N.; and Khazaeni,
Y. 2019.

</span>
<span class="ltx_bibblock">Bayesian nonparametric federated learning of neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 7252–7261.
PMLR.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Zhang, L.; Shen, L.; Ding, L.; Tao, D.; and Duan, L.-Y. 2022.

</span>
<span class="ltx_bibblock">Fine-tuning global model via data-free knowledge distillation for
non-iid federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 10174–10183.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Zhao, Y.; Li, M.; Lai, L.; Suda, N.; Civin, D.; and Chandra, V. 2018.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2022)</span>
<span class="ltx_bibblock">
Zheng, Z.; Zhou, Y.; Sun, Y.; Wang, Z.; Liu, B.; and Li, K. 2022.

</span>
<span class="ltx_bibblock">Applications of federated learning in smart cities: recent advances,
taxonomy, and open challenges.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Connection Science</em>, 34(1): 1–28.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu, Hong, and Zhou (2021)</span>
<span class="ltx_bibblock">
Zhu, Z.; Hong, J.; and Zhou, J. 2021.

</span>
<span class="ltx_bibblock">Data-free knowledge distillation for heterogeneous federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 12878–12889.
PMLR.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al. (2018)</span>
<span class="ltx_bibblock">
Zou, Y.; Yu, Z.; Kumar, B.; and Wang, J. 2018.

</span>
<span class="ltx_bibblock">Unsupervised domain adaptation for semantic segmentation via
class-balanced self-training.

</span>
<span class="ltx_bibblock">In <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European conference on computer vision
(ECCV)</em>, 289–305.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2302.07449" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2302.07450" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2302.07450">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2302.07450" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2302.07451" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 00:46:25 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
