<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations</title>
<!--Generated on Wed Sep 11 02:13:56 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2408.09410v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S1" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S2" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S3" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Problem Formulation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S3.SS1" title="In 3 Problem Formulation ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Recommendation System Based on EHR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S3.SS2" title="In 3 Problem Formulation ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>EHR as a Sample from the Population</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4.SS1" title="In 4 Methodology ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Patient-Event Graph Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4.SS2" title="In 4 Methodology ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Patient-to-Event Graph Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4.SS3" title="In 4 Methodology ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Medication Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.SS1" title="In 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Databases</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.SS2" title="In 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.SS3" title="In 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6.SS1" title="In 6 Results ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Comparison Against Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6.SS2" title="In 6 Results ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6.SS3" title="In 6 Results ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Visualization of Recommendations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S7" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Preprocessing</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS1" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Data Profile</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS2" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Medication Data Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS3" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Diagnosis Data Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS4" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Procedure Data Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS5" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Data Integration</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A2" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Model Parameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A3" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A4" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Implementation Details</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\theorembodyfont</span><span class="ltx_ERROR undefined" id="p1.2">\theoremheaderfont</span><span class="ltx_ERROR undefined" id="p1.3">\theorempostheader</span>
<p class="ltx_p" id="p1.4">:
<span class="ltx_ERROR undefined" id="p1.4.1">\theoremsep</span>
<br class="ltx_break"/>
<span class="ltx_ERROR undefined" id="p1.4.2">\theoremsep</span>
<br class="ltx_break"/>
<span class="ltx_ERROR undefined" id="p1.4.3">\jmlrvolume</span>LEAVE UNSET
<span class="ltx_ERROR undefined" id="p1.4.4">\jmlryear</span>2024
<span class="ltx_ERROR undefined" id="p1.4.5">\jmlrsubmitted</span>LEAVE UNSET
<span class="ltx_ERROR undefined" id="p1.4.6">\jmlrpublished</span>LEAVE UNSET
<span class="ltx_ERROR undefined" id="p1.4.7">\jmlrworkshop</span>Machine Learning for Health (ML4H) 2024</p>
</div>
<h1 class="ltx_title ltx_title_document">
BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id3.1.id1">\Name</span>Xihao Piao <span class="ltx_ERROR undefined" id="id4.2.id2">\Email</span>xihao.piao@sanken.osaka-u.ac.jp
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id5.3.id3">\addr</span>SANKEN
</span><span class="ltx_author_notes">Equal contribution</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Osaka University
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Japan
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id6.1.id1">\Name</span>Pei Gao<span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span> <span class="ltx_ERROR undefined" id="id7.2.id2">\Email</span>pei.gao@naist.jp
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id8.3.id3">\addr</span>Nara Institute of Science and Technology
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Japan
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id9.1.id1">\Name</span>Zheng Chen <span class="ltx_ERROR undefined" id="id10.2.id2">\Email</span>zheng.chen@sanken.osaka-u.ac.jp
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id11.3.id3">\addr</span>SANKEN
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Osaka University
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Japan
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id12.1.id1">\Name</span>Lingwei Zhu <span class="ltx_ERROR undefined" id="id13.2.id2">\Email</span>lingwei.zhu@ualberta.ca
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id14.3.id3">\addr</span>University of Alberta
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Canada
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id15.1.id1">\Name</span>Yasuko Matsubara <span class="ltx_ERROR undefined" id="id16.2.id2">\Email</span>yasuko.matsubara@sanken.osaka-u.ac.jp
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id17.3.id3">\addr</span>SANKEN
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Osaka University
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Japan
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id18.1.id1">\Name</span>Yasushi Sakurai <span class="ltx_ERROR undefined" id="id19.2.id2">\Email</span>yasushi.sakurai@sanken.osaka-u.ac.jp
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id20.3.id3">\addr</span>SANKEN
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Osaka University
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Japan
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id21.1.id1">\Name</span>Jimeng Sun <span class="ltx_ERROR undefined" id="id22.2.id2">\Email</span>jimeng@illinois.edu
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id23.3.id3">\addr</span>University of Illinois Urbana-Champaign
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> USA
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id24.id1">Electronic Health Records (EHRs) frequently contain binary event sequences, such as diagnosis, procedure, and medication histories. These sequences, however, are characterized by a large percentage of zero values, presenting significant challenges for model learning due to the scarcity of gradient updates during processing.
We propose a novel approach that reframes EHR data from a statistical perspective, treating it as a sample drawn from patient cohorts and transforming binary events into continuous Bernoulli probabilities. This transformation not only models deterministic binary events as distributions but also captures event-event relationships through conditional probabilities.
Building upon this probabilistic foundation, we implement a graph neural network that learns to capture complex event-event correlations while emphasizing patient-specific features. Our framework is evaluated on the task of medication recommendation, demonstrating state-of-the-art performance on large-scale databases.
Extensive experimental results show that our proposed <span class="ltx_text ltx_font_bold" id="id24.id1.1">BernGraph</span> <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The source code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://anonymous.4open.science/r/BEHRMecom-031C" title="">https://anonymous.4open.science/r/BEHRMecom-031C</a></span></span></span> achieves 0.589, 0.846, and 0.844 of Jaccard, F1 score, and PRAUC, respectively, on the MIMIC-III dataset, with improvements of 4.6%, 6.7%, and 6.3% compared to baselines, including those using secondary information.
This work presents a promising direction for handling sparse binary sequences in EHRs, potentially improving various healthcare prediction tasks.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Medication errors are one of the most serious medical errors that could threaten patients’ lives.
Studies indicate that over 42% of these errors stem from physicians or doctors with insufficient experience or knowledge concerning specific drugs and diseases <cite class="ltx_cite ltx_citemacro_citep">(Tran et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib28" title="">2021</a>)</cite>.
This challenge becomes even more pronounced with more new drugs and treatment guidelines.
On the other hand, many patients are concurrently diagnosed with multiple diseases, complicating the decision-making process for doctors when determining more appropriate remedies for patients <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite>.
To this end, the medical community will benefit from an automated medication recommendation system that can assist doctors in decision-making.
In the past decades, a vast amount of clinical data representing patient health status (e.g., medical reports, radiology images, and allergies) has been collected.
This has remarkably increased digital information, known as electronic health records (EHR), available for patient-oriented decision-making.
In this context, mining EHR data for medication recommendation has attracted growing research interests <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite>, as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">1</span></a>(a).</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Successful methods typically rely on modeling outcomes of various medical events and diagnoses by observing longitudinal patient histories, i.e., tracking state variations across hospital visits <cite class="ltx_cite ltx_citemacro_citep">(Choi et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib3" title="">2016a</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib38" title="">2017</a>; Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib36" title="">2021b</a>; Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite>.
They often employ sequential neural networks, such as RNNs or Transformers.
They construct a feature space centered around visits, each characterized by the current state of various medical events.
Their objective is to discern long-range temporal dependencies that reflect the historical progression of diseases.
These methods, however, suffer from a number of drawbacks.
From a data viewpoint, different EHR databases adopt distinct visit recording methodologies <cite class="ltx_cite ltx_citemacro_citep">(Singh et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib24" title="">2015</a>)</cite>.
For example, the AMR-URI database <cite class="ltx_cite ltx_citemacro_citep">(Michael et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib14" title="">2020</a>)</cite> employs a regular visit record, while visits in the MIMIC database <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib10" title="">2016</a>)</cite> are patient-specific.
Even within the same database, the time intervals between visits can differ greatly between patients.
From a model perspective, a common obstacle is the "cold-start" issue, where medication recommendation systems struggle due to insufficient patient-specific historical data <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib37" title="">2021</a>)</cite>.
In practice, this issue becomes particularly pronounced when the system encounters newly onboarded patients with scarce or even absent historical data (i.e., visits) about their medical backgrounds.
While many researchers treat irregular time intervals as input variables <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib18" title="">2016</a>; Miotto et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib15" title="">2016</a>; Xiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib34" title="">2019</a>)</cite> or apply the carry-forward imputation method <cite class="ltx_cite ltx_citemacro_citep">(Luo, <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib13" title="">2022</a>)</cite>, these approaches may introduce biases to temporal dependencies.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="368" id="S1.F1.g1" src="x1.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">
(a) Medication recommendations based on historical medical events. (b) The vast majority of event data are zero values.
For example, the proportion of non-zero values exceeding 10% is lower than 0.9% in MIMIC-III.
(c) Those zero values do not propagate learning signals.
</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Some studies focus solely on current diagnoses of patients and medical event records, modeling event-event correlations for recommendation purposes without considering historical visits <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib38" title="">2017</a>; Su et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib25" title="">2020</a>)</cite>.
However, a performance gap remains when compared to visit-based methods.
A typical medical event has a binary value indicating its outcome: 1 for occurrence and 0 for non-occurrence, which leads to a sparsity issue in EHR data.
The sparsity, characterized by a high proportion of zero entries in event sequences, can significantly impact the performance of recommendations (seen in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">1</span></a>(b)).
Zero values provide no tangible information for deep learning models, preventing the activation of weight propagation.
This often leads to a vanishing gradient problem and results in collapsed representations for medication recommendations (as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">1</span></a>(c)).
Previous studies employ secondary information, e.g., Drug-Drug Interaction Knowledge Graph (DDI-KG), to complement information to medical events <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite>.
Yet, sparsity remains a persistent issue.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Therefore, this paper presents <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">BernGraph</span>, a binary EHR data-oriented drug recommendation system.
Our method is built upon a graph neural network (GNN) and solely utilizes the EHR binary medical events for recommendation.
To tackle the sparsity in binary event sequences, we take a statistical perspective that allows us to transform the <math alttext="(0,1)" class="ltx_Math" display="inline" id="S1.p4.1.m1.2"><semantics id="S1.p4.1.m1.2a"><mrow id="S1.p4.1.m1.2.3.2" xref="S1.p4.1.m1.2.3.1.cmml"><mo id="S1.p4.1.m1.2.3.2.1" stretchy="false" xref="S1.p4.1.m1.2.3.1.cmml">(</mo><mn id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">0</mn><mo id="S1.p4.1.m1.2.3.2.2" xref="S1.p4.1.m1.2.3.1.cmml">,</mo><mn id="S1.p4.1.m1.2.2" xref="S1.p4.1.m1.2.2.cmml">1</mn><mo id="S1.p4.1.m1.2.3.2.3" stretchy="false" xref="S1.p4.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.2b"><interval closure="open" id="S1.p4.1.m1.2.3.1.cmml" xref="S1.p4.1.m1.2.3.2"><cn id="S1.p4.1.m1.1.1.cmml" type="integer" xref="S1.p4.1.m1.1.1">0</cn><cn id="S1.p4.1.m1.2.2.cmml" type="integer" xref="S1.p4.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.2c">(0,1)</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.2d">( 0 , 1 )</annotation></semantics></math> values into continuous probabilistic representations and estimate them from patient cohorts.
This strategy has demonstrated substantial efficacy in modeling graphical structures and correlations within binary EHR data.
Architecturally, diverse events are incorporated as node attributes within the GNN.
When two events co-occur, we model their relationship as conditional Bernoulli probabilities to initialize the edge between them.
This allows GNN to learn the correlations between events across different patients for medication recommendations.
Our results demonstrate that our method outperforms several benchmarks, including the latest state-of-the-art (SOTA) visit-based methods.
Specifically, our method shows an improvement on the MIMIC III dataset of approximately 4.8%, 6.7%, 6.3%, and 4% in terms of Jaccard, F1-score, PRAUC, and AUROC, respectively.
Moreover, <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">BernGraph</span> is a simple and effective model that complements existing research in which the EHR data is often exploited in conjunction with secondary data but without transformations.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">- EHR-based Medication Recommendation.</span>
<em class="ltx_emph ltx_font_italic" id="S2.p1.1.2">Historical Visit-based Methods:</em>
Many studies leverage deep learning to extract features from EHR visit variations <cite class="ltx_cite ltx_citemacro_citep">(Choi et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib5" title="">2016b</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib31" title="">2018</a>; W et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib30" title="">2019</a>; Bhave and Perotte, <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib2" title="">2021</a>; Su et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib25" title="">2020</a>)</cite>.
For example, DoctorAI <cite class="ltx_cite ltx_citemacro_citep">(Choi et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib5" title="">2016b</a>)</cite> employs RNNs to capture dependencies between patient histories and doctor recommendations. MICRON <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib35" title="">2021a</a>)</cite> focuses on medication changes and combinations from the last visit.
Some works <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib36" title="">2021b</a>; Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite> further incorporate additional information like Drug-Drug Interactions (DDI) to aid the model predictions.
<br class="ltx_break"/><em class="ltx_emph ltx_font_italic" id="S2.p1.1.3">Current Medical Event-based Methods:</em>
On the other hand, some works aim to analyze the patient’s current health status: recommendations are made based on the EHR records from each patient visit <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib38" title="">2017</a>; Gong et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib9" title="">2021</a>; Shu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib23" title="">2023</a>)</cite>.
LEAP <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib38" title="">2017</a>)</cite> encodes patient information in a one-hot encoding and then learns the relationship between patient features and drugs.
SMR <cite class="ltx_cite ltx_citemacro_citep">(Gong et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib9" title="">2021</a>)</cite> combines EHR data with an external medical knowledge graph to leverage external medical expertise in decision-making.
MT-GIN <cite class="ltx_cite ltx_citemacro_citep">(Shu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib23" title="">2023</a>)</cite> models event-event correlations in EHR data using a graph-based approach, with a focus on events that co-occur.
This approach overlooks the information that 0 values in EHR binary data can potentially provide.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">- Graph Modeling for Medication Recommendation.</span>
Recent works leverage graph structures to model event correlations <cite class="ltx_cite ltx_citemacro_citep">(Choi et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib5" title="">2016b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib4" title="">2020</a>; Su et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib25" title="">2020</a>; Wharrie et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib32" title="">2023</a>; Shang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib22" title="">2019</a>; Gong et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib9" title="">2021</a>; Tan et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib27" title="">2022</a>; Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>; Shu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib23" title="">2023</a>)</cite>. Gamenet <cite class="ltx_cite ltx_citemacro_citep">(Shang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib22" title="">2019</a>)</cite> and Cognet <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite> use GNNs to capture correlations, integrating DDI data for representation learning. GATE <cite class="ltx_cite ltx_citemacro_citep">(Su et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib25" title="">2020</a>)</cite> proposes a GNN-based approach using events from a single visit. COGNet <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite> further integrates both EHR and DDI graphs into a generative model. However, these approaches are designed based on binary medical event data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">- Binary Data Representation.</span>
Mining binary data is challenging due to the varied interpretations of 0s and 1s across contexts <cite class="ltx_cite ltx_citemacro_citep">(D and Stepniewska, <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib7" title="">1999</a>; Verstrepen et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib29" title="">2017</a>)</cite>. Additionally, 0s often contribute little to deep learning. In the EHR context, medGAN and POPCORN transform binary events into continuous probabilities <cite class="ltx_cite ltx_citemacro_citep">(Choi et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib6" title="">2017</a>; Bhave and Perotte, <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib2" title="">2021</a>)</cite>, but these focus on historical data or overall distributions. Developing an effective method to represent binary events directly in EHR data remains challenging.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="270" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.6.3.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S2.F2.4.2" style="font-size:90%;">
(a) We transform <math alttext="\{0,1\}" class="ltx_Math" display="inline" id="S2.F2.3.1.m1.2"><semantics id="S2.F2.3.1.m1.2b"><mrow id="S2.F2.3.1.m1.2.3.2" xref="S2.F2.3.1.m1.2.3.1.cmml"><mo id="S2.F2.3.1.m1.2.3.2.1" stretchy="false" xref="S2.F2.3.1.m1.2.3.1.cmml">{</mo><mn id="S2.F2.3.1.m1.1.1" xref="S2.F2.3.1.m1.1.1.cmml">0</mn><mo id="S2.F2.3.1.m1.2.3.2.2" xref="S2.F2.3.1.m1.2.3.1.cmml">,</mo><mn id="S2.F2.3.1.m1.2.2" xref="S2.F2.3.1.m1.2.2.cmml">1</mn><mo id="S2.F2.3.1.m1.2.3.2.3" stretchy="false" xref="S2.F2.3.1.m1.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.3.1.m1.2c"><set id="S2.F2.3.1.m1.2.3.1.cmml" xref="S2.F2.3.1.m1.2.3.2"><cn id="S2.F2.3.1.m1.1.1.cmml" type="integer" xref="S2.F2.3.1.m1.1.1">0</cn><cn id="S2.F2.3.1.m1.2.2.cmml" type="integer" xref="S2.F2.3.1.m1.2.2">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.3.1.m1.2d">\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.3.1.m1.2e">{ 0 , 1 }</annotation></semantics></math> EHR entries into Bernoulli means. (b) Learning directly from <math alttext="\{0,1\}" class="ltx_Math" display="inline" id="S2.F2.4.2.m2.2"><semantics id="S2.F2.4.2.m2.2b"><mrow id="S2.F2.4.2.m2.2.3.2" xref="S2.F2.4.2.m2.2.3.1.cmml"><mo id="S2.F2.4.2.m2.2.3.2.1" stretchy="false" xref="S2.F2.4.2.m2.2.3.1.cmml">{</mo><mn id="S2.F2.4.2.m2.1.1" xref="S2.F2.4.2.m2.1.1.cmml">0</mn><mo id="S2.F2.4.2.m2.2.3.2.2" xref="S2.F2.4.2.m2.2.3.1.cmml">,</mo><mn id="S2.F2.4.2.m2.2.2" xref="S2.F2.4.2.m2.2.2.cmml">1</mn><mo id="S2.F2.4.2.m2.2.3.2.3" stretchy="false" xref="S2.F2.4.2.m2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.4.2.m2.2c"><set id="S2.F2.4.2.m2.2.3.1.cmml" xref="S2.F2.4.2.m2.2.3.2"><cn id="S2.F2.4.2.m2.1.1.cmml" type="integer" xref="S2.F2.4.2.m2.1.1">0</cn><cn id="S2.F2.4.2.m2.2.2.cmml" type="integer" xref="S2.F2.4.2.m2.2.2">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.4.2.m2.2d">\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.4.2.m2.2e">{ 0 , 1 }</annotation></semantics></math> data hinders signal propagation.
(c) Our method learns from continuous entries, with edges constructed from Bernoulli means and nodes from conditional Bernoulli probabilities (see Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#alg1" title="Algorithm 1 ‣ 4.2 Patient-to-Event Graph Learning ‣ 4 Methodology ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">1</span></a>).</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Formulation</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Recommendation System Based on EHR</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.9">EHR data consists of various medical events, such as multiple symptoms, recorded chronically from patients.
Each data sample contains binary outcomes of these events.
Let <math alttext="\boldsymbol{x}\in\{0,1\}^{M}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.2"><semantics id="S3.SS1.p1.1.m1.2a"><mrow id="S3.SS1.p1.1.m1.2.3" xref="S3.SS1.p1.1.m1.2.3.cmml"><mi id="S3.SS1.p1.1.m1.2.3.2" xref="S3.SS1.p1.1.m1.2.3.2.cmml">𝒙</mi><mo id="S3.SS1.p1.1.m1.2.3.1" xref="S3.SS1.p1.1.m1.2.3.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.2.3.3" xref="S3.SS1.p1.1.m1.2.3.3.cmml"><mrow id="S3.SS1.p1.1.m1.2.3.3.2.2" xref="S3.SS1.p1.1.m1.2.3.3.2.1.cmml"><mo id="S3.SS1.p1.1.m1.2.3.3.2.2.1" stretchy="false" xref="S3.SS1.p1.1.m1.2.3.3.2.1.cmml">{</mo><mn id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">0</mn><mo id="S3.SS1.p1.1.m1.2.3.3.2.2.2" xref="S3.SS1.p1.1.m1.2.3.3.2.1.cmml">,</mo><mn id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">1</mn><mo id="S3.SS1.p1.1.m1.2.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.1.m1.2.3.3.2.1.cmml">}</mo></mrow><mi id="S3.SS1.p1.1.m1.2.3.3.3" xref="S3.SS1.p1.1.m1.2.3.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><apply id="S3.SS1.p1.1.m1.2.3.cmml" xref="S3.SS1.p1.1.m1.2.3"><in id="S3.SS1.p1.1.m1.2.3.1.cmml" xref="S3.SS1.p1.1.m1.2.3.1"></in><ci id="S3.SS1.p1.1.m1.2.3.2.cmml" xref="S3.SS1.p1.1.m1.2.3.2">𝒙</ci><apply id="S3.SS1.p1.1.m1.2.3.3.cmml" xref="S3.SS1.p1.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.3.3.1.cmml" xref="S3.SS1.p1.1.m1.2.3.3">superscript</csymbol><set id="S3.SS1.p1.1.m1.2.3.3.2.1.cmml" xref="S3.SS1.p1.1.m1.2.3.3.2.2"><cn id="S3.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1">0</cn><cn id="S3.SS1.p1.1.m1.2.2.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2">1</cn></set><ci id="S3.SS1.p1.1.m1.2.3.3.3.cmml" xref="S3.SS1.p1.1.m1.2.3.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">\boldsymbol{x}\in\{0,1\}^{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.2d">bold_italic_x ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> denote a patient EHR sample, where <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_M</annotation></semantics></math> represents the total number of medical events, <math alttext="1" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mn id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><cn id="S3.SS1.p1.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">1</annotation></semantics></math> stands for the occurrence of the corresponding event, and <math alttext="0" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mn id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><cn id="S3.SS1.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1">0</cn></annotation-xml></semantics></math> for the absence.
The collection of EHRs is a matrix <math alttext="\mathbf{X}\in\{0,1\}^{N\times M}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.2"><semantics id="S3.SS1.p1.5.m5.2a"><mrow id="S3.SS1.p1.5.m5.2.3" xref="S3.SS1.p1.5.m5.2.3.cmml"><mi id="S3.SS1.p1.5.m5.2.3.2" xref="S3.SS1.p1.5.m5.2.3.2.cmml">𝐗</mi><mo id="S3.SS1.p1.5.m5.2.3.1" xref="S3.SS1.p1.5.m5.2.3.1.cmml">∈</mo><msup id="S3.SS1.p1.5.m5.2.3.3" xref="S3.SS1.p1.5.m5.2.3.3.cmml"><mrow id="S3.SS1.p1.5.m5.2.3.3.2.2" xref="S3.SS1.p1.5.m5.2.3.3.2.1.cmml"><mo id="S3.SS1.p1.5.m5.2.3.3.2.2.1" stretchy="false" xref="S3.SS1.p1.5.m5.2.3.3.2.1.cmml">{</mo><mn id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">0</mn><mo id="S3.SS1.p1.5.m5.2.3.3.2.2.2" xref="S3.SS1.p1.5.m5.2.3.3.2.1.cmml">,</mo><mn id="S3.SS1.p1.5.m5.2.2" xref="S3.SS1.p1.5.m5.2.2.cmml">1</mn><mo id="S3.SS1.p1.5.m5.2.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.5.m5.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS1.p1.5.m5.2.3.3.3" xref="S3.SS1.p1.5.m5.2.3.3.3.cmml"><mi id="S3.SS1.p1.5.m5.2.3.3.3.2" xref="S3.SS1.p1.5.m5.2.3.3.3.2.cmml">N</mi><mo id="S3.SS1.p1.5.m5.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.5.m5.2.3.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.5.m5.2.3.3.3.3" xref="S3.SS1.p1.5.m5.2.3.3.3.3.cmml">M</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.2b"><apply id="S3.SS1.p1.5.m5.2.3.cmml" xref="S3.SS1.p1.5.m5.2.3"><in id="S3.SS1.p1.5.m5.2.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.1"></in><ci id="S3.SS1.p1.5.m5.2.3.2.cmml" xref="S3.SS1.p1.5.m5.2.3.2">𝐗</ci><apply id="S3.SS1.p1.5.m5.2.3.3.cmml" xref="S3.SS1.p1.5.m5.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.3.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.3">superscript</csymbol><set id="S3.SS1.p1.5.m5.2.3.3.2.1.cmml" xref="S3.SS1.p1.5.m5.2.3.3.2.2"><cn id="S3.SS1.p1.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p1.5.m5.1.1">0</cn><cn id="S3.SS1.p1.5.m5.2.2.cmml" type="integer" xref="S3.SS1.p1.5.m5.2.2">1</cn></set><apply id="S3.SS1.p1.5.m5.2.3.3.3.cmml" xref="S3.SS1.p1.5.m5.2.3.3.3"><times id="S3.SS1.p1.5.m5.2.3.3.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.3.3.1"></times><ci id="S3.SS1.p1.5.m5.2.3.3.3.2.cmml" xref="S3.SS1.p1.5.m5.2.3.3.3.2">𝑁</ci><ci id="S3.SS1.p1.5.m5.2.3.3.3.3.cmml" xref="S3.SS1.p1.5.m5.2.3.3.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.2c">\mathbf{X}\in\{0,1\}^{N\times M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.2d">bold_X ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_N × italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> composed by stacking <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_N</annotation></semantics></math> patient vectors <math alttext="\{\boldsymbol{x}\}_{1:N}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.2" xref="S3.SS1.p1.7.m7.1.2.cmml"><mrow id="S3.SS1.p1.7.m7.1.2.2.2" xref="S3.SS1.p1.7.m7.1.2.2.1.cmml"><mo id="S3.SS1.p1.7.m7.1.2.2.2.1" stretchy="false" xref="S3.SS1.p1.7.m7.1.2.2.1.cmml">{</mo><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝒙</mi><mo id="S3.SS1.p1.7.m7.1.2.2.2.2" stretchy="false" xref="S3.SS1.p1.7.m7.1.2.2.1.cmml">}</mo></mrow><mrow id="S3.SS1.p1.7.m7.1.2.3" xref="S3.SS1.p1.7.m7.1.2.3.cmml"><mn id="S3.SS1.p1.7.m7.1.2.3.2" xref="S3.SS1.p1.7.m7.1.2.3.2.cmml">1</mn><mo id="S3.SS1.p1.7.m7.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.7.m7.1.2.3.1.cmml">:</mo><mi id="S3.SS1.p1.7.m7.1.2.3.3" xref="S3.SS1.p1.7.m7.1.2.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.2.cmml" xref="S3.SS1.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.2">subscript</csymbol><set id="S3.SS1.p1.7.m7.1.2.2.1.cmml" xref="S3.SS1.p1.7.m7.1.2.2.2"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝒙</ci></set><apply id="S3.SS1.p1.7.m7.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3"><ci id="S3.SS1.p1.7.m7.1.2.3.1.cmml" xref="S3.SS1.p1.7.m7.1.2.3.1">:</ci><cn id="S3.SS1.p1.7.m7.1.2.3.2.cmml" type="integer" xref="S3.SS1.p1.7.m7.1.2.3.2">1</cn><ci id="S3.SS1.p1.7.m7.1.2.3.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\{\boldsymbol{x}\}_{1:N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">{ bold_italic_x } start_POSTSUBSCRIPT 1 : italic_N end_POSTSUBSCRIPT</annotation></semantics></math>.
It is challenging to build effective recommendation systems using solely the EHR data, mainly due to the following reasons:
(1) binary data poses a challenge to effective machine learning: while both 0 and 1 play an equally important role in identifying a proper recommendation, in practice, 0 entries generally do not propagate learning signals;
(2) medical events differ across platforms, and as a result, two binary matrices may share the same shape but have entirely different underlying meanings.
Our goal is to mine the complete information hidden in binary EHR data effectively, based on which an effective, general-purpose recommendation system can be built.
Formally, <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.9.1">BernGraph</span> can be described by
<math alttext="F(\cdot):\{0,1\}^{M}\rightarrow\{0,1\}^{C}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.5"><semantics id="S3.SS1.p1.8.m8.5a"><mrow id="S3.SS1.p1.8.m8.5.6" xref="S3.SS1.p1.8.m8.5.6.cmml"><mrow id="S3.SS1.p1.8.m8.5.6.2" xref="S3.SS1.p1.8.m8.5.6.2.cmml"><mi id="S3.SS1.p1.8.m8.5.6.2.2" xref="S3.SS1.p1.8.m8.5.6.2.2.cmml">F</mi><mo id="S3.SS1.p1.8.m8.5.6.2.1" xref="S3.SS1.p1.8.m8.5.6.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.8.m8.5.6.2.3.2" xref="S3.SS1.p1.8.m8.5.6.2.cmml"><mo id="S3.SS1.p1.8.m8.5.6.2.3.2.1" stretchy="false" xref="S3.SS1.p1.8.m8.5.6.2.cmml">(</mo><mo id="S3.SS1.p1.8.m8.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.8.m8.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.8.m8.5.6.2.3.2.2" rspace="0.278em" stretchy="false" xref="S3.SS1.p1.8.m8.5.6.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.8.m8.5.6.1" rspace="0.278em" xref="S3.SS1.p1.8.m8.5.6.1.cmml">:</mo><mrow id="S3.SS1.p1.8.m8.5.6.3" xref="S3.SS1.p1.8.m8.5.6.3.cmml"><msup id="S3.SS1.p1.8.m8.5.6.3.2" xref="S3.SS1.p1.8.m8.5.6.3.2.cmml"><mrow id="S3.SS1.p1.8.m8.5.6.3.2.2.2" xref="S3.SS1.p1.8.m8.5.6.3.2.2.1.cmml"><mo id="S3.SS1.p1.8.m8.5.6.3.2.2.2.1" stretchy="false" xref="S3.SS1.p1.8.m8.5.6.3.2.2.1.cmml">{</mo><mn id="S3.SS1.p1.8.m8.2.2" xref="S3.SS1.p1.8.m8.2.2.cmml">0</mn><mo id="S3.SS1.p1.8.m8.5.6.3.2.2.2.2" xref="S3.SS1.p1.8.m8.5.6.3.2.2.1.cmml">,</mo><mn id="S3.SS1.p1.8.m8.3.3" xref="S3.SS1.p1.8.m8.3.3.cmml">1</mn><mo id="S3.SS1.p1.8.m8.5.6.3.2.2.2.3" stretchy="false" xref="S3.SS1.p1.8.m8.5.6.3.2.2.1.cmml">}</mo></mrow><mi id="S3.SS1.p1.8.m8.5.6.3.2.3" xref="S3.SS1.p1.8.m8.5.6.3.2.3.cmml">M</mi></msup><mo id="S3.SS1.p1.8.m8.5.6.3.1" stretchy="false" xref="S3.SS1.p1.8.m8.5.6.3.1.cmml">→</mo><msup id="S3.SS1.p1.8.m8.5.6.3.3" xref="S3.SS1.p1.8.m8.5.6.3.3.cmml"><mrow id="S3.SS1.p1.8.m8.5.6.3.3.2.2" xref="S3.SS1.p1.8.m8.5.6.3.3.2.1.cmml"><mo id="S3.SS1.p1.8.m8.5.6.3.3.2.2.1" stretchy="false" xref="S3.SS1.p1.8.m8.5.6.3.3.2.1.cmml">{</mo><mn id="S3.SS1.p1.8.m8.4.4" xref="S3.SS1.p1.8.m8.4.4.cmml">0</mn><mo id="S3.SS1.p1.8.m8.5.6.3.3.2.2.2" xref="S3.SS1.p1.8.m8.5.6.3.3.2.1.cmml">,</mo><mn id="S3.SS1.p1.8.m8.5.5" xref="S3.SS1.p1.8.m8.5.5.cmml">1</mn><mo id="S3.SS1.p1.8.m8.5.6.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.8.m8.5.6.3.3.2.1.cmml">}</mo></mrow><mi id="S3.SS1.p1.8.m8.5.6.3.3.3" xref="S3.SS1.p1.8.m8.5.6.3.3.3.cmml">C</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.5b"><apply id="S3.SS1.p1.8.m8.5.6.cmml" xref="S3.SS1.p1.8.m8.5.6"><ci id="S3.SS1.p1.8.m8.5.6.1.cmml" xref="S3.SS1.p1.8.m8.5.6.1">:</ci><apply id="S3.SS1.p1.8.m8.5.6.2.cmml" xref="S3.SS1.p1.8.m8.5.6.2"><times id="S3.SS1.p1.8.m8.5.6.2.1.cmml" xref="S3.SS1.p1.8.m8.5.6.2.1"></times><ci id="S3.SS1.p1.8.m8.5.6.2.2.cmml" xref="S3.SS1.p1.8.m8.5.6.2.2">𝐹</ci><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">⋅</ci></apply><apply id="S3.SS1.p1.8.m8.5.6.3.cmml" xref="S3.SS1.p1.8.m8.5.6.3"><ci id="S3.SS1.p1.8.m8.5.6.3.1.cmml" xref="S3.SS1.p1.8.m8.5.6.3.1">→</ci><apply id="S3.SS1.p1.8.m8.5.6.3.2.cmml" xref="S3.SS1.p1.8.m8.5.6.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.5.6.3.2.1.cmml" xref="S3.SS1.p1.8.m8.5.6.3.2">superscript</csymbol><set id="S3.SS1.p1.8.m8.5.6.3.2.2.1.cmml" xref="S3.SS1.p1.8.m8.5.6.3.2.2.2"><cn id="S3.SS1.p1.8.m8.2.2.cmml" type="integer" xref="S3.SS1.p1.8.m8.2.2">0</cn><cn id="S3.SS1.p1.8.m8.3.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.3.3">1</cn></set><ci id="S3.SS1.p1.8.m8.5.6.3.2.3.cmml" xref="S3.SS1.p1.8.m8.5.6.3.2.3">𝑀</ci></apply><apply id="S3.SS1.p1.8.m8.5.6.3.3.cmml" xref="S3.SS1.p1.8.m8.5.6.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.5.6.3.3.1.cmml" xref="S3.SS1.p1.8.m8.5.6.3.3">superscript</csymbol><set id="S3.SS1.p1.8.m8.5.6.3.3.2.1.cmml" xref="S3.SS1.p1.8.m8.5.6.3.3.2.2"><cn id="S3.SS1.p1.8.m8.4.4.cmml" type="integer" xref="S3.SS1.p1.8.m8.4.4">0</cn><cn id="S3.SS1.p1.8.m8.5.5.cmml" type="integer" xref="S3.SS1.p1.8.m8.5.5">1</cn></set><ci id="S3.SS1.p1.8.m8.5.6.3.3.3.cmml" xref="S3.SS1.p1.8.m8.5.6.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.5c">F(\cdot):\{0,1\}^{M}\rightarrow\{0,1\}^{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.5d">italic_F ( ⋅ ) : { 0 , 1 } start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT → { 0 , 1 } start_POSTSUPERSCRIPT italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>,
which accepts an EHR sample as input, and outputs <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_C</annotation></semantics></math> binary indicators indicating whether or not recommend drug.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>EHR as a Sample from the Population</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">This paper introduces a statistical method to address binary data.
Several studies suggest prevalent diseases and medical conditions often share commonalities across populations due to factors like environment and behavior <cite class="ltx_cite ltx_citemacro_citep">(Bache et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib1" title="">2013</a>)</cite>.
In terms of epidemiology, temporal and spatial specificity lead to closer medical relatedness within sub-cohorts <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib26" title="">2012</a>; Bache et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib1" title="">2013</a>; Poulakis et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib19" title="">2022</a>)</cite>.
Based on this, we assume that <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.1">(i)</span>the outcome of a medical event <math alttext="E_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">E</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐸</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> follows a Bernoulli distribution for the population, and <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.2">(ii)</span>the EHR dataset is an i.i.d. sample from this population.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">To address the issue of signal-stopping 0 entries, we represent them using the Bernoulli mean <math alttext="1-P(E_{i}=1)" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mn id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">1</mn><mo id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">−</mo><mrow id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.3.cmml">P</mi><mo id="S3.SS2.p2.1.m1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><minus id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"></minus><cn id="S3.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1.3">1</cn><apply id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"><times id="S3.SS2.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.2"></times><ci id="S3.SS2.p2.1.m1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.3">𝑃</ci><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1"><eq id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1"></eq><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S3.SS2.p2.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">1-P(E_{i}=1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">1 - italic_P ( italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 )</annotation></semantics></math>, empirically estimated from the EHR dataset, which assumes the same distribution as the population. This transforms binary 0-1 events into continuous representations, helping mitigate the problem of data sparsity. In deep learning models, a value of 0 prevents activation of connection weights, and in graph-based models, zeros do not contribute to node attributes or message passing.
The Bernoulli mean, ranging from 0 to 1, provides more effective representations of patient-event and event-event relationships, leading to more accurate medication recommendations than binary signals <cite class="ltx_cite ltx_citemacro_citep">(M.M. et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib16" title="">2015</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Patient-Event Graph Construction</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.6">We propose using GNNs to learn the relationships between medical events within each patient and across the patient population. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S2.F2" title="Figure 2 ‣ 2 Related Works ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">2</span></a> provides a system overview. For each patient, we construct a graph <math alttext="\mathcal{G}_{n}=(\mathcal{V}_{n},\mathcal{E}_{n})" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.2"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml"><msub id="S4.SS1.p1.1.m1.2.2.4" xref="S4.SS1.p1.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.2.2.4.2" xref="S4.SS1.p1.1.m1.2.2.4.2.cmml">𝒢</mi><mi id="S4.SS1.p1.1.m1.2.2.4.3" xref="S4.SS1.p1.1.m1.2.2.4.3.cmml">n</mi></msub><mo id="S4.SS1.p1.1.m1.2.2.3" xref="S4.SS1.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS1.p1.1.m1.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.3.cmml"><mo id="S4.SS1.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S4.SS1.p1.1.m1.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p1.1.m1.1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.cmml">𝒱</mi><mi id="S4.SS1.p1.1.m1.1.1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.SS1.p1.1.m1.2.2.2.2.4" xref="S4.SS1.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.1.m1.2.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.2.2.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.2.2.2.cmml">ℰ</mi><mi id="S4.SS1.p1.1.m1.2.2.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.2.2.2.3.cmml">n</mi></msub><mo id="S4.SS1.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S4.SS1.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><apply id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2"><eq id="S4.SS1.p1.1.m1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.3"></eq><apply id="S4.SS1.p1.1.m1.2.2.4.cmml" xref="S4.SS1.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.4.1.cmml" xref="S4.SS1.p1.1.m1.2.2.4">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.4.2.cmml" xref="S4.SS1.p1.1.m1.2.2.4.2">𝒢</ci><ci id="S4.SS1.p1.1.m1.2.2.4.3.cmml" xref="S4.SS1.p1.1.m1.2.2.4.3">𝑛</ci></apply><interval closure="open" id="S4.SS1.p1.1.m1.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2"><apply id="S4.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2">𝒱</ci><ci id="S4.SS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S4.SS1.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2.2">ℰ</ci><ci id="S4.SS1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2.3">𝑛</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">\mathcal{G}_{n}=(\mathcal{V}_{n},\mathcal{E}_{n})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.2d">caligraphic_G start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = ( caligraphic_V start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , caligraphic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\mathcal{V}_{n}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">𝒱</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝒱</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathcal{V}_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">caligraphic_V start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> represents patient-event relationships and <math alttext="\mathcal{E}_{n}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">ℰ</mi><mi id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">ℰ</ci><ci id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\mathcal{E}_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">caligraphic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> captures event-event connections. Naïvely initializing <math alttext="\mathcal{V}_{n}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">𝒱</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝒱</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\mathcal{V}_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">caligraphic_V start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{E}_{n}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><msub id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">ℰ</mi><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">ℰ</ci><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\mathcal{E}_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">caligraphic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">bold_X</annotation></semantics></math> could lead to information loss from zero entries, as they hinder signal propagation.
To this end, we propose an alternative initialization method for graph construction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.7"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.7.1">Patient-to-patient correlation embedding. </span>
By assumption<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.7.2">(i)</span> in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S3.SS2" title="3.2 EHR as a Sample from the Population ‣ 3 Problem Formulation ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">3.2</span></a>, the occurrence of an event is subject to a Bernoulli distribution <math alttext="P(E_{j}=k)=\rho^{k}(1-\rho)^{k}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.2"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.2" xref="S4.SS1.p2.1.m1.2.2.cmml"><mrow id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.3.cmml">P</mi><mo id="S4.SS1.p2.1.m1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p2.1.m1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS1.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.1.m1.1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml"><msub id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.2" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.3" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S4.SS1.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p2.1.m1.2.2.3" xref="S4.SS1.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS1.p2.1.m1.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.cmml"><msup id="S4.SS1.p2.1.m1.2.2.2.3" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.p2.1.m1.2.2.2.3.2" xref="S4.SS1.p2.1.m1.2.2.2.3.2.cmml">ρ</mi><mi id="S4.SS1.p2.1.m1.2.2.2.3.3" xref="S4.SS1.p2.1.m1.2.2.2.3.3.cmml">k</mi></msup><mo id="S4.SS1.p2.1.m1.2.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.2.cmml">⁢</mo><msup id="S4.SS1.p2.1.m1.2.2.2.1" xref="S4.SS1.p2.1.m1.2.2.2.1.cmml"><mrow id="S4.SS1.p2.1.m1.2.2.2.1.1.1" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.cmml"><mo id="S4.SS1.p2.1.m1.2.2.2.1.1.1.2" stretchy="false" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.1.m1.2.2.2.1.1.1.1" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.cmml"><mn id="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.2" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.2.cmml">1</mn><mo id="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.1" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.1.cmml">−</mo><mi id="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.3" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.3.cmml">ρ</mi></mrow><mo id="S4.SS1.p2.1.m1.2.2.2.1.1.1.3" stretchy="false" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow><mi id="S4.SS1.p2.1.m1.2.2.2.1.3" xref="S4.SS1.p2.1.m1.2.2.2.1.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><apply id="S4.SS1.p2.1.m1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2"><eq id="S4.SS1.p2.1.m1.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.3"></eq><apply id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"><times id="S4.SS1.p2.1.m1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.2"></times><ci id="S4.SS1.p2.1.m1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.3">𝑃</ci><apply id="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1"></eq><apply id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S4.SS1.p2.1.m1.2.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2"><times id="S4.SS1.p2.1.m1.2.2.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2"></times><apply id="S4.SS1.p2.1.m1.2.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.2.3.1.cmml" xref="S4.SS1.p2.1.m1.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.1.m1.2.2.2.3.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2.3.2">𝜌</ci><ci id="S4.SS1.p2.1.m1.2.2.2.3.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.3.3">𝑘</ci></apply><apply id="S4.SS1.p2.1.m1.2.2.2.1.cmml" xref="S4.SS1.p2.1.m1.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.2.1.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2.1">superscript</csymbol><apply id="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1"><minus id="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.1"></minus><cn id="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.2.cmml" type="integer" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.2">1</cn><ci id="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.1.1.1.1.3">𝜌</ci></apply><ci id="S4.SS1.p2.1.m1.2.2.2.1.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">P(E_{j}=k)=\rho^{k}(1-\rho)^{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.2d">italic_P ( italic_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_k ) = italic_ρ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( 1 - italic_ρ ) start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="k\in\{0,1\}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.2"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2.3" xref="S4.SS1.p2.2.m2.2.3.cmml"><mi id="S4.SS1.p2.2.m2.2.3.2" xref="S4.SS1.p2.2.m2.2.3.2.cmml">k</mi><mo id="S4.SS1.p2.2.m2.2.3.1" xref="S4.SS1.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p2.2.m2.2.3.3.2" xref="S4.SS1.p2.2.m2.2.3.3.1.cmml"><mo id="S4.SS1.p2.2.m2.2.3.3.2.1" stretchy="false" xref="S4.SS1.p2.2.m2.2.3.3.1.cmml">{</mo><mn id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">0</mn><mo id="S4.SS1.p2.2.m2.2.3.3.2.2" xref="S4.SS1.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p2.2.m2.2.2" xref="S4.SS1.p2.2.m2.2.2.cmml">1</mn><mo id="S4.SS1.p2.2.m2.2.3.3.2.3" stretchy="false" xref="S4.SS1.p2.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.2b"><apply id="S4.SS1.p2.2.m2.2.3.cmml" xref="S4.SS1.p2.2.m2.2.3"><in id="S4.SS1.p2.2.m2.2.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.1"></in><ci id="S4.SS1.p2.2.m2.2.3.2.cmml" xref="S4.SS1.p2.2.m2.2.3.2">𝑘</ci><set id="S4.SS1.p2.2.m2.2.3.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.3.2"><cn id="S4.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1">0</cn><cn id="S4.SS1.p2.2.m2.2.2.cmml" type="integer" xref="S4.SS1.p2.2.m2.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">k\in\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.2d">italic_k ∈ { 0 , 1 }</annotation></semantics></math>, and <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_ρ</annotation></semantics></math> denotes the mean of the distribution.
By assumption<span class="ltx_text ltx_font_bold" id="S4.SS1.p2.7.3">(ii)</span>, the event in the EHR data sample is subject to the same distribution <math alttext="P(\mathbf{X}_{\cdot j}=k)=\rho^{k}(1-\rho)^{k}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.2"><semantics id="S4.SS1.p2.4.m4.2a"><mrow id="S4.SS1.p2.4.m4.2.2" xref="S4.SS1.p2.4.m4.2.2.cmml"><mrow id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.1.3.cmml">P</mi><mo id="S4.SS1.p2.4.m4.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p2.4.m4.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.cmml"><mo id="S4.SS1.p2.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.4.m4.1.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.cmml"><msub id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.2" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.2" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.2.cmml"></mi><mo id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.1.cmml">⋅</mo><mi id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.3" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S4.SS1.p2.4.m4.1.1.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.SS1.p2.4.m4.1.1.1.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S4.SS1.p2.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p2.4.m4.2.2.3" xref="S4.SS1.p2.4.m4.2.2.3.cmml">=</mo><mrow id="S4.SS1.p2.4.m4.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.cmml"><msup id="S4.SS1.p2.4.m4.2.2.2.3" xref="S4.SS1.p2.4.m4.2.2.2.3.cmml"><mi id="S4.SS1.p2.4.m4.2.2.2.3.2" xref="S4.SS1.p2.4.m4.2.2.2.3.2.cmml">ρ</mi><mi id="S4.SS1.p2.4.m4.2.2.2.3.3" xref="S4.SS1.p2.4.m4.2.2.2.3.3.cmml">k</mi></msup><mo id="S4.SS1.p2.4.m4.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.cmml">⁢</mo><msup id="S4.SS1.p2.4.m4.2.2.2.1" xref="S4.SS1.p2.4.m4.2.2.2.1.cmml"><mrow id="S4.SS1.p2.4.m4.2.2.2.1.1.1" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.cmml"><mo id="S4.SS1.p2.4.m4.2.2.2.1.1.1.2" stretchy="false" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.4.m4.2.2.2.1.1.1.1" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.cmml"><mn id="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.2" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.2.cmml">1</mn><mo id="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.1" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.1.cmml">−</mo><mi id="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.3" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.3.cmml">ρ</mi></mrow><mo id="S4.SS1.p2.4.m4.2.2.2.1.1.1.3" stretchy="false" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.cmml">)</mo></mrow><mi id="S4.SS1.p2.4.m4.2.2.2.1.3" xref="S4.SS1.p2.4.m4.2.2.2.1.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.2b"><apply id="S4.SS1.p2.4.m4.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2"><eq id="S4.SS1.p2.4.m4.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.3"></eq><apply id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1"><times id="S4.SS1.p2.4.m4.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.2"></times><ci id="S4.SS1.p2.4.m4.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.3">𝑃</ci><apply id="S4.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1"><eq id="S4.SS1.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.1"></eq><apply id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.2">𝐗</ci><apply id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3"><ci id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.1">⋅</ci><csymbol cd="latexml" id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.2">absent</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><ci id="S4.SS1.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S4.SS1.p2.4.m4.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2"><times id="S4.SS1.p2.4.m4.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2"></times><apply id="S4.SS1.p2.4.m4.2.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.3.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.2.3.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.3.2">𝜌</ci><ci id="S4.SS1.p2.4.m4.2.2.2.3.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.3.3">𝑘</ci></apply><apply id="S4.SS1.p2.4.m4.2.2.2.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.1.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.1">superscript</csymbol><apply id="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1"><minus id="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.1"></minus><cn id="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.2.cmml" type="integer" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.2">1</cn><ci id="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.1.1.1.1.3">𝜌</ci></apply><ci id="S4.SS1.p2.4.m4.2.2.2.1.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.2c">P(\mathbf{X}_{\cdot j}=k)=\rho^{k}(1-\rho)^{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.2d">italic_P ( bold_X start_POSTSUBSCRIPT ⋅ italic_j end_POSTSUBSCRIPT = italic_k ) = italic_ρ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( 1 - italic_ρ ) start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, where we denote the <math alttext="\mathbf{X}_{\cdot j}" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><msub id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">𝐗</mi><mrow id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml"><mi id="S4.SS1.p2.5.m5.1.1.3.2" xref="S4.SS1.p2.5.m5.1.1.3.2.cmml"></mi><mo id="S4.SS1.p2.5.m5.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.5.m5.1.1.3.1.cmml">⋅</mo><mi id="S4.SS1.p2.5.m5.1.1.3.3" xref="S4.SS1.p2.5.m5.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝐗</ci><apply id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3"><ci id="S4.SS1.p2.5.m5.1.1.3.1.cmml" xref="S4.SS1.p2.5.m5.1.1.3.1">⋅</ci><csymbol cd="latexml" id="S4.SS1.p2.5.m5.1.1.3.2.cmml" xref="S4.SS1.p2.5.m5.1.1.3.2">absent</csymbol><ci id="S4.SS1.p2.5.m5.1.1.3.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\mathbf{X}_{\cdot j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">bold_X start_POSTSUBSCRIPT ⋅ italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denote the event <math alttext="E_{j}" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><msub id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">E</mi><mi id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">𝐸</ci><ci id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">E_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">italic_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> for all patient samples.
Therefore, we propose initializing the vertices by the Bernoulli mean <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m7.1"><semantics id="S4.SS1.p2.7.m7.1a"><mi id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><ci id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m7.1d">italic_ρ</annotation></semantics></math>.
While this quantity is not known, we can replace it with a sample estimate:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\rho}:=\tilde{P}(X_{\cdot j}=1)=\frac{\sum_{i=1}^{N}\mathbf{X}_{ij}}{N}%
,\,\,\tilde{P}(X_{\cdot j}=0)=1-\tilde{\rho}" class="ltx_Math" display="block" id="S4.E1.m1.2"><semantics id="S4.E1.m1.2a"><mrow id="S4.E1.m1.2.2.2" xref="S4.E1.m1.2.2.3.cmml"><mrow id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml"><mover accent="true" id="S4.E1.m1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.3.2.cmml">ρ</mi><mo id="S4.E1.m1.1.1.1.1.3.1" xref="S4.E1.m1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="S4.E1.m1.1.1.1.1.4" lspace="0.278em" rspace="0.278em" xref="S4.E1.m1.1.1.1.1.4.cmml">:=</mo><mrow id="S4.E1.m1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E1.m1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.1.3.2.cmml">P</mi><mo id="S4.E1.m1.1.1.1.1.1.3.1" xref="S4.E1.m1.1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="S4.E1.m1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml">X</mi><mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml"></mi><mo id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⋅</mo><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.1.1.1.1.5" xref="S4.E1.m1.1.1.1.1.5.cmml">=</mo><mfrac id="S4.E1.m1.1.1.1.1.6" xref="S4.E1.m1.1.1.1.1.6.cmml"><mrow id="S4.E1.m1.1.1.1.1.6.2" xref="S4.E1.m1.1.1.1.1.6.2.cmml"><msubsup id="S4.E1.m1.1.1.1.1.6.2.1" xref="S4.E1.m1.1.1.1.1.6.2.1.cmml"><mo id="S4.E1.m1.1.1.1.1.6.2.1.2.2" xref="S4.E1.m1.1.1.1.1.6.2.1.2.2.cmml">∑</mo><mrow id="S4.E1.m1.1.1.1.1.6.2.1.2.3" xref="S4.E1.m1.1.1.1.1.6.2.1.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.6.2.1.2.3.2" xref="S4.E1.m1.1.1.1.1.6.2.1.2.3.2.cmml">i</mi><mo id="S4.E1.m1.1.1.1.1.6.2.1.2.3.1" xref="S4.E1.m1.1.1.1.1.6.2.1.2.3.1.cmml">=</mo><mn id="S4.E1.m1.1.1.1.1.6.2.1.2.3.3" xref="S4.E1.m1.1.1.1.1.6.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E1.m1.1.1.1.1.6.2.1.3" xref="S4.E1.m1.1.1.1.1.6.2.1.3.cmml">N</mi></msubsup><msub id="S4.E1.m1.1.1.1.1.6.2.2" xref="S4.E1.m1.1.1.1.1.6.2.2.cmml"><mi id="S4.E1.m1.1.1.1.1.6.2.2.2" xref="S4.E1.m1.1.1.1.1.6.2.2.2.cmml">𝐗</mi><mrow id="S4.E1.m1.1.1.1.1.6.2.2.3" xref="S4.E1.m1.1.1.1.1.6.2.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.6.2.2.3.2" xref="S4.E1.m1.1.1.1.1.6.2.2.3.2.cmml">i</mi><mo id="S4.E1.m1.1.1.1.1.6.2.2.3.1" xref="S4.E1.m1.1.1.1.1.6.2.2.3.1.cmml">⁢</mo><mi id="S4.E1.m1.1.1.1.1.6.2.2.3.3" xref="S4.E1.m1.1.1.1.1.6.2.2.3.3.cmml">j</mi></mrow></msub></mrow><mi id="S4.E1.m1.1.1.1.1.6.3" xref="S4.E1.m1.1.1.1.1.6.3.cmml">N</mi></mfrac></mrow><mo id="S4.E1.m1.2.2.2.3" rspace="0.497em" xref="S4.E1.m1.2.2.3a.cmml">,</mo><mrow id="S4.E1.m1.2.2.2.2" xref="S4.E1.m1.2.2.2.2.cmml"><mrow id="S4.E1.m1.2.2.2.2.1" xref="S4.E1.m1.2.2.2.2.1.cmml"><mover accent="true" id="S4.E1.m1.2.2.2.2.1.3" xref="S4.E1.m1.2.2.2.2.1.3.cmml"><mi id="S4.E1.m1.2.2.2.2.1.3.2" xref="S4.E1.m1.2.2.2.2.1.3.2.cmml">P</mi><mo id="S4.E1.m1.2.2.2.2.1.3.1" xref="S4.E1.m1.2.2.2.2.1.3.1.cmml">~</mo></mover><mo id="S4.E1.m1.2.2.2.2.1.2" xref="S4.E1.m1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.2.2.2.2.1.1.1" xref="S4.E1.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S4.E1.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="S4.E1.m1.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.2.2.2.2.1.1.1.1" xref="S4.E1.m1.2.2.2.2.1.1.1.1.cmml"><msub id="S4.E1.m1.2.2.2.2.1.1.1.1.2" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.cmml"><mi id="S4.E1.m1.2.2.2.2.1.1.1.1.2.2" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.2.cmml">X</mi><mrow id="S4.E1.m1.2.2.2.2.1.1.1.1.2.3" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.cmml"><mi id="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.2" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.2.cmml"></mi><mo id="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.1.cmml">⋅</mo><mi id="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.3" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S4.E1.m1.2.2.2.2.1.1.1.1.1" xref="S4.E1.m1.2.2.2.2.1.1.1.1.1.cmml">=</mo><mn id="S4.E1.m1.2.2.2.2.1.1.1.1.3" xref="S4.E1.m1.2.2.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo id="S4.E1.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="S4.E1.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.2.2.2.2.2" xref="S4.E1.m1.2.2.2.2.2.cmml">=</mo><mrow id="S4.E1.m1.2.2.2.2.3" xref="S4.E1.m1.2.2.2.2.3.cmml"><mn id="S4.E1.m1.2.2.2.2.3.2" xref="S4.E1.m1.2.2.2.2.3.2.cmml">1</mn><mo id="S4.E1.m1.2.2.2.2.3.1" xref="S4.E1.m1.2.2.2.2.3.1.cmml">−</mo><mover accent="true" id="S4.E1.m1.2.2.2.2.3.3" xref="S4.E1.m1.2.2.2.2.3.3.cmml"><mi id="S4.E1.m1.2.2.2.2.3.3.2" xref="S4.E1.m1.2.2.2.2.3.3.2.cmml">ρ</mi><mo id="S4.E1.m1.2.2.2.2.3.3.1" xref="S4.E1.m1.2.2.2.2.3.3.1.cmml">~</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.2b"><apply id="S4.E1.m1.2.2.3.cmml" xref="S4.E1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.3a.cmml" xref="S4.E1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1"><and id="S4.E1.m1.1.1.1.1a.cmml" xref="S4.E1.m1.1.1.1.1"></and><apply id="S4.E1.m1.1.1.1.1b.cmml" xref="S4.E1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.1.1.1.1.4.cmml" xref="S4.E1.m1.1.1.1.1.4">assign</csymbol><apply id="S4.E1.m1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.3"><ci id="S4.E1.m1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.3.1">~</ci><ci id="S4.E1.m1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.3.2">𝜌</ci></apply><apply id="S4.E1.m1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1"><times id="S4.E1.m1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.2"></times><apply id="S4.E1.m1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.3"><ci id="S4.E1.m1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.3.1">~</ci><ci id="S4.E1.m1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1"><eq id="S4.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.2">𝑋</ci><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3"><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.1">⋅</ci><csymbol cd="latexml" id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.2">absent</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><cn id="S4.E1.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="S4.E1.m1.1.1.1.1c.cmml" xref="S4.E1.m1.1.1.1.1"><eq id="S4.E1.m1.1.1.1.1.5.cmml" xref="S4.E1.m1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2408.09410v3#S4.E1.m1.1.1.1.1.1.cmml" id="S4.E1.m1.1.1.1.1d.cmml" xref="S4.E1.m1.1.1.1.1"></share><apply id="S4.E1.m1.1.1.1.1.6.cmml" xref="S4.E1.m1.1.1.1.1.6"><divide id="S4.E1.m1.1.1.1.1.6.1.cmml" xref="S4.E1.m1.1.1.1.1.6"></divide><apply id="S4.E1.m1.1.1.1.1.6.2.cmml" xref="S4.E1.m1.1.1.1.1.6.2"><apply id="S4.E1.m1.1.1.1.1.6.2.1.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.6.2.1.1.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1">superscript</csymbol><apply id="S4.E1.m1.1.1.1.1.6.2.1.2.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.6.2.1.2.1.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1">subscript</csymbol><sum id="S4.E1.m1.1.1.1.1.6.2.1.2.2.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1.2.2"></sum><apply id="S4.E1.m1.1.1.1.1.6.2.1.2.3.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1.2.3"><eq id="S4.E1.m1.1.1.1.1.6.2.1.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1.2.3.1"></eq><ci id="S4.E1.m1.1.1.1.1.6.2.1.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1.2.3.2">𝑖</ci><cn id="S4.E1.m1.1.1.1.1.6.2.1.2.3.3.cmml" type="integer" xref="S4.E1.m1.1.1.1.1.6.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E1.m1.1.1.1.1.6.2.1.3.cmml" xref="S4.E1.m1.1.1.1.1.6.2.1.3">𝑁</ci></apply><apply id="S4.E1.m1.1.1.1.1.6.2.2.cmml" xref="S4.E1.m1.1.1.1.1.6.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.6.2.2.1.cmml" xref="S4.E1.m1.1.1.1.1.6.2.2">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.6.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.6.2.2.2">𝐗</ci><apply id="S4.E1.m1.1.1.1.1.6.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.6.2.2.3"><times id="S4.E1.m1.1.1.1.1.6.2.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.6.2.2.3.1"></times><ci id="S4.E1.m1.1.1.1.1.6.2.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.6.2.2.3.2">𝑖</ci><ci id="S4.E1.m1.1.1.1.1.6.2.2.3.3.cmml" xref="S4.E1.m1.1.1.1.1.6.2.2.3.3">𝑗</ci></apply></apply></apply><ci id="S4.E1.m1.1.1.1.1.6.3.cmml" xref="S4.E1.m1.1.1.1.1.6.3">𝑁</ci></apply></apply></apply><apply id="S4.E1.m1.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2"><eq id="S4.E1.m1.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2"></eq><apply id="S4.E1.m1.2.2.2.2.1.cmml" xref="S4.E1.m1.2.2.2.2.1"><times id="S4.E1.m1.2.2.2.2.1.2.cmml" xref="S4.E1.m1.2.2.2.2.1.2"></times><apply id="S4.E1.m1.2.2.2.2.1.3.cmml" xref="S4.E1.m1.2.2.2.2.1.3"><ci id="S4.E1.m1.2.2.2.2.1.3.1.cmml" xref="S4.E1.m1.2.2.2.2.1.3.1">~</ci><ci id="S4.E1.m1.2.2.2.2.1.3.2.cmml" xref="S4.E1.m1.2.2.2.2.1.3.2">𝑃</ci></apply><apply id="S4.E1.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1"><eq id="S4.E1.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1.1.1"></eq><apply id="S4.E1.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E1.m1.2.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.2">𝑋</ci><apply id="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.3"><ci id="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.1.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.1">⋅</ci><csymbol cd="latexml" id="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.2.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.2">absent</csymbol><ci id="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.3.cmml" xref="S4.E1.m1.2.2.2.2.1.1.1.1.2.3.3">𝑗</ci></apply></apply><cn id="S4.E1.m1.2.2.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E1.m1.2.2.2.2.1.1.1.1.3">0</cn></apply></apply><apply id="S4.E1.m1.2.2.2.2.3.cmml" xref="S4.E1.m1.2.2.2.2.3"><minus id="S4.E1.m1.2.2.2.2.3.1.cmml" xref="S4.E1.m1.2.2.2.2.3.1"></minus><cn id="S4.E1.m1.2.2.2.2.3.2.cmml" type="integer" xref="S4.E1.m1.2.2.2.2.3.2">1</cn><apply id="S4.E1.m1.2.2.2.2.3.3.cmml" xref="S4.E1.m1.2.2.2.2.3.3"><ci id="S4.E1.m1.2.2.2.2.3.3.1.cmml" xref="S4.E1.m1.2.2.2.2.3.3.1">~</ci><ci id="S4.E1.m1.2.2.2.2.3.3.2.cmml" xref="S4.E1.m1.2.2.2.2.3.3.2">𝜌</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.2c">\tilde{\rho}:=\tilde{P}(X_{\cdot j}=1)=\frac{\sum_{i=1}^{N}\mathbf{X}_{ij}}{N}%
,\,\,\tilde{P}(X_{\cdot j}=0)=1-\tilde{\rho}</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.2d">over~ start_ARG italic_ρ end_ARG := over~ start_ARG italic_P end_ARG ( italic_X start_POSTSUBSCRIPT ⋅ italic_j end_POSTSUBSCRIPT = 1 ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT bold_X start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG , over~ start_ARG italic_P end_ARG ( italic_X start_POSTSUBSCRIPT ⋅ italic_j end_POSTSUBSCRIPT = 0 ) = 1 - over~ start_ARG italic_ρ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.6"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.6.1">Event-to-event correlation embedding. </span>
Then, we propose to initialize the edges representing the event-to-event relationship using conditional Bernoulli probability.
Intuitively, an edge from event <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_j</annotation></semantics></math> to event <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_i</annotation></semantics></math> encodes some information <em class="ltx_emph ltx_font_italic" id="S4.SS1.p3.6.2">conditional on</em> the observation of <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_i</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Choi et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib4" title="">2020</a>; Murphy, <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib17" title="">2023</a>)</cite>.
From this consideration, we initialize the edge <math alttext="e_{ij}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><msub id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">e</mi><mrow id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml"><mi id="S4.SS1.p3.4.m4.1.1.3.2" xref="S4.SS1.p3.4.m4.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p3.4.m4.1.1.3.1" xref="S4.SS1.p3.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.4.m4.1.1.3.3" xref="S4.SS1.p3.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝑒</ci><apply id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3"><times id="S4.SS1.p3.4.m4.1.1.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.3.1"></times><ci id="S4.SS1.p3.4.m4.1.1.3.2.cmml" xref="S4.SS1.p3.4.m4.1.1.3.2">𝑖</ci><ci id="S4.SS1.p3.4.m4.1.1.3.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">e_{ij}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> from event <math alttext="E_{j}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><msub id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">E</mi><mi id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">𝐸</ci><ci id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">E_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">italic_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to event <math alttext="E_{i}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><msub id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">E</mi><mi id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝐸</ci><ci id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="e_{ij}:=P(E_{i}=1|E_{j}=1)=\frac{{P}(E_{i}=1\text{ and }E_{j}=1)}{{P}(E_{j}=1)}" class="ltx_Math" display="block" id="S4.E2.m1.3"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.3" xref="S4.E2.m1.3.3.cmml"><msub id="S4.E2.m1.3.3.3" xref="S4.E2.m1.3.3.3.cmml"><mi id="S4.E2.m1.3.3.3.2" xref="S4.E2.m1.3.3.3.2.cmml">e</mi><mrow id="S4.E2.m1.3.3.3.3" xref="S4.E2.m1.3.3.3.3.cmml"><mi id="S4.E2.m1.3.3.3.3.2" xref="S4.E2.m1.3.3.3.3.2.cmml">i</mi><mo id="S4.E2.m1.3.3.3.3.1" xref="S4.E2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E2.m1.3.3.3.3.3" xref="S4.E2.m1.3.3.3.3.3.cmml">j</mi></mrow></msub><mo id="S4.E2.m1.3.3.4" lspace="0.278em" rspace="0.278em" xref="S4.E2.m1.3.3.4.cmml">:=</mo><mrow id="S4.E2.m1.3.3.1" xref="S4.E2.m1.3.3.1.cmml"><mi id="S4.E2.m1.3.3.1.3" xref="S4.E2.m1.3.3.1.3.cmml">P</mi><mo id="S4.E2.m1.3.3.1.2" xref="S4.E2.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.3.3.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.cmml"><mo id="S4.E2.m1.3.3.1.1.1.2" stretchy="false" xref="S4.E2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.3.3.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.cmml"><msub id="S4.E2.m1.3.3.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.2.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.2.2" xref="S4.E2.m1.3.3.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E2.m1.3.3.1.1.1.1.2.3" xref="S4.E2.m1.3.3.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E2.m1.3.3.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.3.cmml">=</mo><mrow id="S4.E2.m1.3.3.1.1.1.1.4" xref="S4.E2.m1.3.3.1.1.1.1.4.cmml"><mn id="S4.E2.m1.3.3.1.1.1.1.4.2" xref="S4.E2.m1.3.3.1.1.1.1.4.2.cmml">1</mn><mo fence="false" id="S4.E2.m1.3.3.1.1.1.1.4.1" xref="S4.E2.m1.3.3.1.1.1.1.4.1.cmml">|</mo><msub id="S4.E2.m1.3.3.1.1.1.1.4.3" xref="S4.E2.m1.3.3.1.1.1.1.4.3.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.4.3.2" xref="S4.E2.m1.3.3.1.1.1.1.4.3.2.cmml">E</mi><mi id="S4.E2.m1.3.3.1.1.1.1.4.3.3" xref="S4.E2.m1.3.3.1.1.1.1.4.3.3.cmml">j</mi></msub></mrow><mo id="S4.E2.m1.3.3.1.1.1.1.5" xref="S4.E2.m1.3.3.1.1.1.1.5.cmml">=</mo><mn id="S4.E2.m1.3.3.1.1.1.1.6" xref="S4.E2.m1.3.3.1.1.1.1.6.cmml">1</mn></mrow><mo id="S4.E2.m1.3.3.1.1.1.3" stretchy="false" xref="S4.E2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.3.5" xref="S4.E2.m1.3.3.5.cmml">=</mo><mfrac id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.1.1.1.3.cmml">P</mi><mo id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E2.m1.1.1.1.1.1.1.2.3" xref="S4.E2.m1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E2.m1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.4" xref="S4.E2.m1.1.1.1.1.1.1.4.cmml"><mn id="S4.E2.m1.1.1.1.1.1.1.4.2" xref="S4.E2.m1.1.1.1.1.1.1.4.2.cmml">1</mn><mo id="S4.E2.m1.1.1.1.1.1.1.4.1" xref="S4.E2.m1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mtext id="S4.E2.m1.1.1.1.1.1.1.4.3" xref="S4.E2.m1.1.1.1.1.1.1.4.3a.cmml"> and </mtext><mo id="S4.E2.m1.1.1.1.1.1.1.4.1a" xref="S4.E2.m1.1.1.1.1.1.1.4.1.cmml">⁢</mo><msub id="S4.E2.m1.1.1.1.1.1.1.4.4" xref="S4.E2.m1.1.1.1.1.1.1.4.4.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.4.4.2" xref="S4.E2.m1.1.1.1.1.1.1.4.4.2.cmml">E</mi><mi id="S4.E2.m1.1.1.1.1.1.1.4.4.3" xref="S4.E2.m1.1.1.1.1.1.1.4.4.3.cmml">j</mi></msub></mrow><mo id="S4.E2.m1.1.1.1.1.1.1.5" xref="S4.E2.m1.1.1.1.1.1.1.5.cmml">=</mo><mn id="S4.E2.m1.1.1.1.1.1.1.6" xref="S4.E2.m1.1.1.1.1.1.1.6.cmml">1</mn></mrow><mo id="S4.E2.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><mi id="S4.E2.m1.2.2.2.3" xref="S4.E2.m1.2.2.2.3.cmml">P</mi><mo id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">⁢</mo><mrow id="S4.E2.m1.2.2.2.1.1" xref="S4.E2.m1.2.2.2.1.1.1.cmml"><mo id="S4.E2.m1.2.2.2.1.1.2" stretchy="false" xref="S4.E2.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.2.2.2.1.1.1" xref="S4.E2.m1.2.2.2.1.1.1.cmml"><msub id="S4.E2.m1.2.2.2.1.1.1.2" xref="S4.E2.m1.2.2.2.1.1.1.2.cmml"><mi id="S4.E2.m1.2.2.2.1.1.1.2.2" xref="S4.E2.m1.2.2.2.1.1.1.2.2.cmml">E</mi><mi id="S4.E2.m1.2.2.2.1.1.1.2.3" xref="S4.E2.m1.2.2.2.1.1.1.2.3.cmml">j</mi></msub><mo id="S4.E2.m1.2.2.2.1.1.1.1" xref="S4.E2.m1.2.2.2.1.1.1.1.cmml">=</mo><mn id="S4.E2.m1.2.2.2.1.1.1.3" xref="S4.E2.m1.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E2.m1.2.2.2.1.1.3" stretchy="false" xref="S4.E2.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3"><and id="S4.E2.m1.3.3a.cmml" xref="S4.E2.m1.3.3"></and><apply id="S4.E2.m1.3.3b.cmml" xref="S4.E2.m1.3.3"><csymbol cd="latexml" id="S4.E2.m1.3.3.4.cmml" xref="S4.E2.m1.3.3.4">assign</csymbol><apply id="S4.E2.m1.3.3.3.cmml" xref="S4.E2.m1.3.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.3.1.cmml" xref="S4.E2.m1.3.3.3">subscript</csymbol><ci id="S4.E2.m1.3.3.3.2.cmml" xref="S4.E2.m1.3.3.3.2">𝑒</ci><apply id="S4.E2.m1.3.3.3.3.cmml" xref="S4.E2.m1.3.3.3.3"><times id="S4.E2.m1.3.3.3.3.1.cmml" xref="S4.E2.m1.3.3.3.3.1"></times><ci id="S4.E2.m1.3.3.3.3.2.cmml" xref="S4.E2.m1.3.3.3.3.2">𝑖</ci><ci id="S4.E2.m1.3.3.3.3.3.cmml" xref="S4.E2.m1.3.3.3.3.3">𝑗</ci></apply></apply><apply id="S4.E2.m1.3.3.1.cmml" xref="S4.E2.m1.3.3.1"><times id="S4.E2.m1.3.3.1.2.cmml" xref="S4.E2.m1.3.3.1.2"></times><ci id="S4.E2.m1.3.3.1.3.cmml" xref="S4.E2.m1.3.3.1.3">𝑃</ci><apply id="S4.E2.m1.3.3.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1"><and id="S4.E2.m1.3.3.1.1.1.1a.cmml" xref="S4.E2.m1.3.3.1.1.1"></and><apply id="S4.E2.m1.3.3.1.1.1.1b.cmml" xref="S4.E2.m1.3.3.1.1.1"><eq id="S4.E2.m1.3.3.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.3"></eq><apply id="S4.E2.m1.3.3.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.2.2">𝐸</ci><ci id="S4.E2.m1.3.3.1.1.1.1.2.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E2.m1.3.3.1.1.1.1.4.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4"><csymbol cd="latexml" id="S4.E2.m1.3.3.1.1.1.1.4.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4.1">conditional</csymbol><cn id="S4.E2.m1.3.3.1.1.1.1.4.2.cmml" type="integer" xref="S4.E2.m1.3.3.1.1.1.1.4.2">1</cn><apply id="S4.E2.m1.3.3.1.1.1.1.4.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.4.3.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4.3">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.4.3.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4.3.2">𝐸</ci><ci id="S4.E2.m1.3.3.1.1.1.1.4.3.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4.3.3">𝑗</ci></apply></apply></apply><apply id="S4.E2.m1.3.3.1.1.1.1c.cmml" xref="S4.E2.m1.3.3.1.1.1"><eq id="S4.E2.m1.3.3.1.1.1.1.5.cmml" xref="S4.E2.m1.3.3.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2408.09410v3#S4.E2.m1.3.3.1.1.1.1.4.cmml" id="S4.E2.m1.3.3.1.1.1.1d.cmml" xref="S4.E2.m1.3.3.1.1.1"></share><cn id="S4.E2.m1.3.3.1.1.1.1.6.cmml" type="integer" xref="S4.E2.m1.3.3.1.1.1.1.6">1</cn></apply></apply></apply></apply><apply id="S4.E2.m1.3.3c.cmml" xref="S4.E2.m1.3.3"><eq id="S4.E2.m1.3.3.5.cmml" xref="S4.E2.m1.3.3.5"></eq><share href="https://arxiv.org/html/2408.09410v3#S4.E2.m1.3.3.1.cmml" id="S4.E2.m1.3.3d.cmml" xref="S4.E2.m1.3.3"></share><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2"><divide id="S4.E2.m1.2.2.3.cmml" xref="S4.E2.m1.2.2"></divide><apply id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><times id="S4.E2.m1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.2"></times><ci id="S4.E2.m1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.3">𝑃</ci><apply id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><and id="S4.E2.m1.1.1.1.1.1.1a.cmml" xref="S4.E2.m1.1.1.1.1.1"></and><apply id="S4.E2.m1.1.1.1.1.1.1b.cmml" xref="S4.E2.m1.1.1.1.1.1"><eq id="S4.E2.m1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3"></eq><apply id="S4.E2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="S4.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4"><times id="S4.E2.m1.1.1.1.1.1.1.4.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4.1"></times><cn id="S4.E2.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="S4.E2.m1.1.1.1.1.1.1.4.2">1</cn><ci id="S4.E2.m1.1.1.1.1.1.1.4.3a.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4.3"><mtext id="S4.E2.m1.1.1.1.1.1.1.4.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4.3"> and </mtext></ci><apply id="S4.E2.m1.1.1.1.1.1.1.4.4.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.4.4.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.4.4.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4.4.2">𝐸</ci><ci id="S4.E2.m1.1.1.1.1.1.1.4.4.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.4.4.3">𝑗</ci></apply></apply></apply><apply id="S4.E2.m1.1.1.1.1.1.1c.cmml" xref="S4.E2.m1.1.1.1.1.1"><eq id="S4.E2.m1.1.1.1.1.1.1.5.cmml" xref="S4.E2.m1.1.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2408.09410v3#S4.E2.m1.1.1.1.1.1.1.4.cmml" id="S4.E2.m1.1.1.1.1.1.1d.cmml" xref="S4.E2.m1.1.1.1.1.1"></share><cn id="S4.E2.m1.1.1.1.1.1.1.6.cmml" type="integer" xref="S4.E2.m1.1.1.1.1.1.1.6">1</cn></apply></apply></apply><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><times id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2"></times><ci id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3">𝑃</ci><apply id="S4.E2.m1.2.2.2.1.1.1.cmml" xref="S4.E2.m1.2.2.2.1.1"><eq id="S4.E2.m1.2.2.2.1.1.1.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1"></eq><apply id="S4.E2.m1.2.2.2.1.1.1.2.cmml" xref="S4.E2.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.1.1.1.2.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E2.m1.2.2.2.1.1.1.2.2.cmml" xref="S4.E2.m1.2.2.2.1.1.1.2.2">𝐸</ci><ci id="S4.E2.m1.2.2.2.1.1.1.2.3.cmml" xref="S4.E2.m1.2.2.2.1.1.1.2.3">𝑗</ci></apply><cn id="S4.E2.m1.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.E2.m1.2.2.2.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">e_{ij}:=P(E_{i}=1|E_{j}=1)=\frac{{P}(E_{i}=1\text{ and }E_{j}=1)}{{P}(E_{j}=1)}</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.3d">italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT := italic_P ( italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 | italic_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 1 ) = divide start_ARG italic_P ( italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 and italic_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 1 ) end_ARG start_ARG italic_P ( italic_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 1 ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.6">Since the exact distribution is not known, we hence replace it with a sample estimate.
That is, the conditional probability is instead estimated by
<math alttext="\frac{P(\mathbf{X}_{\cdot i}=1\text{ and }\mathbf{X}_{\cdot j}=1)}{P(\mathbf{X%
}_{\cdot j}=1)}" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.2"><semantics id="S4.SS1.p4.1.m1.2a"><mfrac id="S4.SS1.p4.1.m1.2.2" xref="S4.SS1.p4.1.m1.2.2.cmml"><mrow id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.3.cmml">P</mi><mo id="S4.SS1.p4.1.m1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p4.1.m1.1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p4.1.m1.1.1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><msub id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.2.cmml"></mi><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.1.cmml">⋅</mo><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml">=</mo><mrow id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.cmml"><mn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.2.cmml">1</mn><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mtext id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.3a.cmml"> and </mtext><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.1a" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.1.cmml">⁢</mo><msub id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.2.cmml">𝐗</mi><mrow id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.2.cmml"></mi><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.1.cmml">⋅</mo><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.1.5" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.5.cmml">=</mo><mn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.6" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.6.cmml">1</mn></mrow><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.SS1.p4.1.m1.2.2.2" xref="S4.SS1.p4.1.m1.2.2.2.cmml"><mi id="S4.SS1.p4.1.m1.2.2.2.3" xref="S4.SS1.p4.1.m1.2.2.2.3.cmml">P</mi><mo id="S4.SS1.p4.1.m1.2.2.2.2" xref="S4.SS1.p4.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p4.1.m1.2.2.2.1.1" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.cmml"><mo id="S4.SS1.p4.1.m1.2.2.2.1.1.2" stretchy="false" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.p4.1.m1.2.2.2.1.1.1" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.cmml"><msub id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.cmml"><mi id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.2" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.2.cmml">𝐗</mi><mrow id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.cmml"><mi id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.2" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.2.cmml"></mi><mo id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.1.cmml">⋅</mo><mi id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.3" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S4.SS1.p4.1.m1.2.2.2.1.1.1.1" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.1.m1.2.2.2.1.1.1.3" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p4.1.m1.2.2.2.1.1.3" stretchy="false" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.2b"><apply id="S4.SS1.p4.1.m1.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2"><divide id="S4.SS1.p4.1.m1.2.2.3.cmml" xref="S4.SS1.p4.1.m1.2.2"></divide><apply id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"><times id="S4.SS1.p4.1.m1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.2"></times><ci id="S4.SS1.p4.1.m1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.3">𝑃</ci><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1"><and id="S4.SS1.p4.1.m1.1.1.1.1.1.1a.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1"></and><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1b.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3"></eq><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.2">𝐗</ci><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3"><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.1">⋅</ci><csymbol cd="latexml" id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.2">absent</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4"><times id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.1"></times><cn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.2">1</cn><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.3a.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.3"><mtext id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.3"> and </mtext></ci><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.2">𝐗</ci><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3"><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.1">⋅</ci><csymbol cd="latexml" id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.2">absent</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.4.4.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1c.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.1.1.1.5.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2408.09410v3#S4.SS1.p4.1.m1.1.1.1.1.1.1.4.cmml" id="S4.SS1.p4.1.m1.1.1.1.1.1.1d.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1"></share><cn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.6.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.6">1</cn></apply></apply></apply><apply id="S4.SS1.p4.1.m1.2.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2.2"><times id="S4.SS1.p4.1.m1.2.2.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2.2.2"></times><ci id="S4.SS1.p4.1.m1.2.2.2.3.cmml" xref="S4.SS1.p4.1.m1.2.2.2.3">𝑃</ci><apply id="S4.SS1.p4.1.m1.2.2.2.1.1.1.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1"><eq id="S4.SS1.p4.1.m1.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.1"></eq><apply id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.1.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.2">𝐗</ci><apply id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3"><ci id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.1.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.1">⋅</ci><csymbol cd="latexml" id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.2.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.2">absent</csymbol><ci id="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.3.cmml" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.2.3.3">𝑗</ci></apply></apply><cn id="S4.SS1.p4.1.m1.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p4.1.m1.2.2.2.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.2c">\frac{P(\mathbf{X}_{\cdot i}=1\text{ and }\mathbf{X}_{\cdot j}=1)}{P(\mathbf{X%
}_{\cdot j}=1)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.2d">divide start_ARG italic_P ( bold_X start_POSTSUBSCRIPT ⋅ italic_i end_POSTSUBSCRIPT = 1 and bold_X start_POSTSUBSCRIPT ⋅ italic_j end_POSTSUBSCRIPT = 1 ) end_ARG start_ARG italic_P ( bold_X start_POSTSUBSCRIPT ⋅ italic_j end_POSTSUBSCRIPT = 1 ) end_ARG</annotation></semantics></math>
where <math alttext="P(\mathbf{X}_{\cdot i}=1\text{ and }\mathbf{X}_{\cdot j}=1)" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mrow id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">P</mi><mo id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p4.2.m2.1.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS1.p4.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS1.p4.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p4.2.m2.1.1.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.1.1.cmml"><msub id="S4.SS1.p4.2.m2.1.1.1.1.1.2" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.2.2" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.cmml"><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.2" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.2.cmml"></mi><mo id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.1.cmml">⋅</mo><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.3" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S4.SS1.p4.2.m2.1.1.1.1.1.3" xref="S4.SS1.p4.2.m2.1.1.1.1.1.3.cmml">=</mo><mrow id="S4.SS1.p4.2.m2.1.1.1.1.1.4" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.cmml"><mn id="S4.SS1.p4.2.m2.1.1.1.1.1.4.2" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.2.cmml">1</mn><mo id="S4.SS1.p4.2.m2.1.1.1.1.1.4.1" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.1.cmml">⁢</mo><mtext id="S4.SS1.p4.2.m2.1.1.1.1.1.4.3" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.3a.cmml"> and </mtext><mo id="S4.SS1.p4.2.m2.1.1.1.1.1.4.1a" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.1.cmml">⁢</mo><msub id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.cmml"><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.2" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.2.cmml">𝐗</mi><mrow id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.cmml"><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.2" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.2.cmml"></mi><mo id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.1.cmml">⋅</mo><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.3" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S4.SS1.p4.2.m2.1.1.1.1.1.5" xref="S4.SS1.p4.2.m2.1.1.1.1.1.5.cmml">=</mo><mn id="S4.SS1.p4.2.m2.1.1.1.1.1.6" xref="S4.SS1.p4.2.m2.1.1.1.1.1.6.cmml">1</mn></mrow><mo id="S4.SS1.p4.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS1.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><times id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2"></times><ci id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3">𝑃</ci><apply id="S4.SS1.p4.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1"><and id="S4.SS1.p4.2.m2.1.1.1.1.1a.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1"></and><apply id="S4.SS1.p4.2.m2.1.1.1.1.1b.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1"><eq id="S4.SS1.p4.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.3"></eq><apply id="S4.SS1.p4.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.2">𝐗</ci><apply id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3"><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.1">⋅</ci><csymbol cd="latexml" id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.2.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.2">absent</csymbol><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.3.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS1.p4.2.m2.1.1.1.1.1.4.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4"><times id="S4.SS1.p4.2.m2.1.1.1.1.1.4.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.1"></times><cn id="S4.SS1.p4.2.m2.1.1.1.1.1.4.2.cmml" type="integer" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.2">1</cn><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.4.3a.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.3"><mtext id="S4.SS1.p4.2.m2.1.1.1.1.1.4.3.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.3"> and </mtext></ci><apply id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.2.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.2">𝐗</ci><apply id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3"><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.1">⋅</ci><csymbol cd="latexml" id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.2.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.2">absent</csymbol><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.3.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.4.4.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.SS1.p4.2.m2.1.1.1.1.1c.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1"><eq id="S4.SS1.p4.2.m2.1.1.1.1.1.5.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2408.09410v3#S4.SS1.p4.2.m2.1.1.1.1.1.4.cmml" id="S4.SS1.p4.2.m2.1.1.1.1.1d.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1"></share><cn id="S4.SS1.p4.2.m2.1.1.1.1.1.6.cmml" type="integer" xref="S4.SS1.p4.2.m2.1.1.1.1.1.6">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">P(\mathbf{X}_{\cdot i}=1\text{ and }\mathbf{X}_{\cdot j}=1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">italic_P ( bold_X start_POSTSUBSCRIPT ⋅ italic_i end_POSTSUBSCRIPT = 1 and bold_X start_POSTSUBSCRIPT ⋅ italic_j end_POSTSUBSCRIPT = 1 )</annotation></semantics></math> is the ratio of patients with both events <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><mi id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><ci id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mi id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><ci id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">italic_j</annotation></semantics></math> being positive, and <math alttext="P(\mathbf{X}_{\cdot j}=1)" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.1"><semantics id="S4.SS1.p4.5.m5.1a"><mrow id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.3" xref="S4.SS1.p4.5.m5.1.1.3.cmml">P</mi><mo id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p4.5.m5.1.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.1.1.cmml"><mo id="S4.SS1.p4.5.m5.1.1.1.1.2" stretchy="false" xref="S4.SS1.p4.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p4.5.m5.1.1.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.1.1.cmml"><msub id="S4.SS1.p4.5.m5.1.1.1.1.1.2" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p4.5.m5.1.1.1.1.1.2.2" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S4.SS1.p4.5.m5.1.1.1.1.1.2.3" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.cmml"><mi id="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.2" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.2.cmml"></mi><mo id="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.1.cmml">⋅</mo><mi id="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.3" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S4.SS1.p4.5.m5.1.1.1.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.5.m5.1.1.1.1.1.3" xref="S4.SS1.p4.5.m5.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p4.5.m5.1.1.1.1.3" stretchy="false" xref="S4.SS1.p4.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><apply id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1"><times id="S4.SS1.p4.5.m5.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.2"></times><ci id="S4.SS1.p4.5.m5.1.1.3.cmml" xref="S4.SS1.p4.5.m5.1.1.3">𝑃</ci><apply id="S4.SS1.p4.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1"><eq id="S4.SS1.p4.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.1.1"></eq><apply id="S4.SS1.p4.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m5.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p4.5.m5.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.2">𝐗</ci><apply id="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.3"><ci id="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.1">⋅</ci><csymbol cd="latexml" id="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.2.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.2">absent</csymbol><ci id="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.3.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><cn id="S4.SS1.p4.5.m5.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p4.5.m5.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">P(\mathbf{X}_{\cdot j}=1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m5.1d">italic_P ( bold_X start_POSTSUBSCRIPT ⋅ italic_j end_POSTSUBSCRIPT = 1 )</annotation></semantics></math> is the ratio of patients with event <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p4.6.m6.1"><semantics id="S4.SS1.p4.6.m6.1a"><mi id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><ci id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.6.m6.1d">italic_j</annotation></semantics></math> being positive.
It is worth noting that the proposed initialization can be seen as a transformation from binary data to continuous values.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Patient-to-Event Graph Learning</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.10">In Section <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4.SS1" title="4.1 Patient-Event Graph Construction ‣ 4 Methodology ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">4.1</span></a>, we mapped each patient sample <math alttext="\mathbf{X}_{i\cdot}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.2"><semantics id="S4.SS2.p1.1.m1.2a"><msub id="S4.SS2.p1.1.m1.2.3" xref="S4.SS2.p1.1.m1.2.3.cmml"><mi id="S4.SS2.p1.1.m1.2.3.2" xref="S4.SS2.p1.1.m1.2.3.2.cmml">𝐗</mi><mrow id="S4.SS2.p1.1.m1.2.2.2.4" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p1.1.m1.2.2.2.4.1" lspace="0.222em" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml">⁣</mo><mo id="S4.SS2.p1.1.m1.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.cmml">⋅</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><apply id="S4.SS2.p1.1.m1.2.3.cmml" xref="S4.SS2.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.3.1.cmml" xref="S4.SS2.p1.1.m1.2.3">subscript</csymbol><ci id="S4.SS2.p1.1.m1.2.3.2.cmml" xref="S4.SS2.p1.1.m1.2.3.2">𝐗</ci><list id="S4.SS2.p1.1.m1.2.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.4"><ci id="S4.SS2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS2.p1.1.m1.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">\mathbf{X}_{i\cdot}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.2d">bold_X start_POSTSUBSCRIPT italic_i ⋅ end_POSTSUBSCRIPT</annotation></semantics></math> to a graph <math alttext="\mathcal{G}_{i}=(\mathcal{V}_{i},\mathcal{E}_{i})" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.2"><semantics id="S4.SS2.p1.2.m2.2a"><mrow id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml"><msub id="S4.SS2.p1.2.m2.2.2.4" xref="S4.SS2.p1.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.2.2.4.2" xref="S4.SS2.p1.2.m2.2.2.4.2.cmml">𝒢</mi><mi id="S4.SS2.p1.2.m2.2.2.4.3" xref="S4.SS2.p1.2.m2.2.2.4.3.cmml">i</mi></msub><mo id="S4.SS2.p1.2.m2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S4.SS2.p1.2.m2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.3.cmml"><mo id="S4.SS2.p1.2.m2.2.2.2.2.3" stretchy="false" xref="S4.SS2.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="S4.SS2.p1.2.m2.1.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.1.1.1.1.1.2" xref="S4.SS2.p1.2.m2.1.1.1.1.1.2.cmml">𝒱</mi><mi id="S4.SS2.p1.2.m2.1.1.1.1.1.3" xref="S4.SS2.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p1.2.m2.2.2.2.2.4" xref="S4.SS2.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S4.SS2.p1.2.m2.2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.2.2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2.cmml">ℰ</mi><mi id="S4.SS2.p1.2.m2.2.2.2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.p1.2.m2.2.2.2.2.5" stretchy="false" xref="S4.SS2.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.2b"><apply id="S4.SS2.p1.2.m2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2"><eq id="S4.SS2.p1.2.m2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.3"></eq><apply id="S4.SS2.p1.2.m2.2.2.4.cmml" xref="S4.SS2.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.4.1.cmml" xref="S4.SS2.p1.2.m2.2.2.4">subscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.4.2.cmml" xref="S4.SS2.p1.2.m2.2.2.4.2">𝒢</ci><ci id="S4.SS2.p1.2.m2.2.2.4.3.cmml" xref="S4.SS2.p1.2.m2.2.2.4.3">𝑖</ci></apply><interval closure="open" id="S4.SS2.p1.2.m2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2"><apply id="S4.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1.2">𝒱</ci><ci id="S4.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p1.2.m2.2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.2">ℰ</ci><ci id="S4.SS2.p1.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.2c">\mathcal{G}_{i}=(\mathcal{V}_{i},\mathcal{E}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.2d">caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( caligraphic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, with empirical Bernoulli mean initialization.
This transformation converts the original drug recommendation binary classification problem into a graph classification problem.
Specifically, we first map the EHR data into a set of vertices and edges <math alttext="\{0,1\}^{M}\stackrel{{\scriptstyle\text{B.I.}}}{{\rightarrow}}\mathcal{V}_{i},%
\mathcal{E}_{i}\in[0,1]^{M}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.6"><semantics id="S4.SS2.p1.3.m3.6a"><mrow id="S4.SS2.p1.3.m3.6.6.2" xref="S4.SS2.p1.3.m3.6.6.3.cmml"><mrow id="S4.SS2.p1.3.m3.5.5.1.1" xref="S4.SS2.p1.3.m3.5.5.1.1.cmml"><msup id="S4.SS2.p1.3.m3.5.5.1.1.2" xref="S4.SS2.p1.3.m3.5.5.1.1.2.cmml"><mrow id="S4.SS2.p1.3.m3.5.5.1.1.2.2.2" xref="S4.SS2.p1.3.m3.5.5.1.1.2.2.1.cmml"><mo id="S4.SS2.p1.3.m3.5.5.1.1.2.2.2.1" stretchy="false" xref="S4.SS2.p1.3.m3.5.5.1.1.2.2.1.cmml">{</mo><mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">0</mn><mo id="S4.SS2.p1.3.m3.5.5.1.1.2.2.2.2" xref="S4.SS2.p1.3.m3.5.5.1.1.2.2.1.cmml">,</mo><mn id="S4.SS2.p1.3.m3.2.2" xref="S4.SS2.p1.3.m3.2.2.cmml">1</mn><mo id="S4.SS2.p1.3.m3.5.5.1.1.2.2.2.3" stretchy="false" xref="S4.SS2.p1.3.m3.5.5.1.1.2.2.1.cmml">}</mo></mrow><mi id="S4.SS2.p1.3.m3.5.5.1.1.2.3" xref="S4.SS2.p1.3.m3.5.5.1.1.2.3.cmml">M</mi></msup><mover id="S4.SS2.p1.3.m3.5.5.1.1.1" xref="S4.SS2.p1.3.m3.5.5.1.1.1.cmml"><mo id="S4.SS2.p1.3.m3.5.5.1.1.1.2" stretchy="false" xref="S4.SS2.p1.3.m3.5.5.1.1.1.2.cmml">→</mo><mtext id="S4.SS2.p1.3.m3.5.5.1.1.1.3" xref="S4.SS2.p1.3.m3.5.5.1.1.1.3a.cmml">B.I.</mtext></mover><msub id="S4.SS2.p1.3.m3.5.5.1.1.3" xref="S4.SS2.p1.3.m3.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.5.5.1.1.3.2" xref="S4.SS2.p1.3.m3.5.5.1.1.3.2.cmml">𝒱</mi><mi id="S4.SS2.p1.3.m3.5.5.1.1.3.3" xref="S4.SS2.p1.3.m3.5.5.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.SS2.p1.3.m3.6.6.2.3" xref="S4.SS2.p1.3.m3.6.6.3a.cmml">,</mo><mrow id="S4.SS2.p1.3.m3.6.6.2.2" xref="S4.SS2.p1.3.m3.6.6.2.2.cmml"><msub id="S4.SS2.p1.3.m3.6.6.2.2.2" xref="S4.SS2.p1.3.m3.6.6.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.6.6.2.2.2.2" xref="S4.SS2.p1.3.m3.6.6.2.2.2.2.cmml">ℰ</mi><mi id="S4.SS2.p1.3.m3.6.6.2.2.2.3" xref="S4.SS2.p1.3.m3.6.6.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.p1.3.m3.6.6.2.2.1" xref="S4.SS2.p1.3.m3.6.6.2.2.1.cmml">∈</mo><msup id="S4.SS2.p1.3.m3.6.6.2.2.3" xref="S4.SS2.p1.3.m3.6.6.2.2.3.cmml"><mrow id="S4.SS2.p1.3.m3.6.6.2.2.3.2.2" xref="S4.SS2.p1.3.m3.6.6.2.2.3.2.1.cmml"><mo id="S4.SS2.p1.3.m3.6.6.2.2.3.2.2.1" stretchy="false" xref="S4.SS2.p1.3.m3.6.6.2.2.3.2.1.cmml">[</mo><mn id="S4.SS2.p1.3.m3.3.3" xref="S4.SS2.p1.3.m3.3.3.cmml">0</mn><mo id="S4.SS2.p1.3.m3.6.6.2.2.3.2.2.2" xref="S4.SS2.p1.3.m3.6.6.2.2.3.2.1.cmml">,</mo><mn id="S4.SS2.p1.3.m3.4.4" xref="S4.SS2.p1.3.m3.4.4.cmml">1</mn><mo id="S4.SS2.p1.3.m3.6.6.2.2.3.2.2.3" stretchy="false" xref="S4.SS2.p1.3.m3.6.6.2.2.3.2.1.cmml">]</mo></mrow><mi id="S4.SS2.p1.3.m3.6.6.2.2.3.3" xref="S4.SS2.p1.3.m3.6.6.2.2.3.3.cmml">M</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.6b"><apply id="S4.SS2.p1.3.m3.6.6.3.cmml" xref="S4.SS2.p1.3.m3.6.6.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.6.6.3a.cmml" xref="S4.SS2.p1.3.m3.6.6.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.3.m3.5.5.1.1.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1"><apply id="S4.SS2.p1.3.m3.5.5.1.1.1.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.5.5.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.3.m3.5.5.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.1.2">→</ci><ci id="S4.SS2.p1.3.m3.5.5.1.1.1.3a.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.1.3"><mtext id="S4.SS2.p1.3.m3.5.5.1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.3.m3.5.5.1.1.1.3">B.I.</mtext></ci></apply><apply id="S4.SS2.p1.3.m3.5.5.1.1.2.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.5.5.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.2">superscript</csymbol><set id="S4.SS2.p1.3.m3.5.5.1.1.2.2.1.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.2.2.2"><cn id="S4.SS2.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1">0</cn><cn id="S4.SS2.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS2.p1.3.m3.2.2">1</cn></set><ci id="S4.SS2.p1.3.m3.5.5.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.2.3">𝑀</ci></apply><apply id="S4.SS2.p1.3.m3.5.5.1.1.3.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.5.5.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.5.5.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.3.2">𝒱</ci><ci id="S4.SS2.p1.3.m3.5.5.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.5.5.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.SS2.p1.3.m3.6.6.2.2.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2"><in id="S4.SS2.p1.3.m3.6.6.2.2.1.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.1"></in><apply id="S4.SS2.p1.3.m3.6.6.2.2.2.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.6.6.2.2.2.1.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.6.6.2.2.2.2.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.2.2">ℰ</ci><ci id="S4.SS2.p1.3.m3.6.6.2.2.2.3.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.2.3">𝑖</ci></apply><apply id="S4.SS2.p1.3.m3.6.6.2.2.3.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.6.6.2.2.3.1.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.3">superscript</csymbol><interval closure="closed" id="S4.SS2.p1.3.m3.6.6.2.2.3.2.1.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.3.2.2"><cn id="S4.SS2.p1.3.m3.3.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.3.3">0</cn><cn id="S4.SS2.p1.3.m3.4.4.cmml" type="integer" xref="S4.SS2.p1.3.m3.4.4">1</cn></interval><ci id="S4.SS2.p1.3.m3.6.6.2.2.3.3.cmml" xref="S4.SS2.p1.3.m3.6.6.2.2.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.6c">\{0,1\}^{M}\stackrel{{\scriptstyle\text{B.I.}}}{{\rightarrow}}\mathcal{V}_{i},%
\mathcal{E}_{i}\in[0,1]^{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.6d">{ 0 , 1 } start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT start_RELOP SUPERSCRIPTOP start_ARG → end_ARG start_ARG B.I. end_ARG end_RELOP caligraphic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ [ 0 , 1 ] start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, where B.I. denote Bernoulli Initialization.
A graph learning function is then applied to gain drug recommendation outputs <math alttext="F(\cdot):\mathcal{V}_{i},\mathcal{E}_{i}\rightarrow\{0,1\}^{C}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.5"><semantics id="S4.SS2.p1.4.m4.5a"><mrow id="S4.SS2.p1.4.m4.5.5" xref="S4.SS2.p1.4.m4.5.5.cmml"><mrow id="S4.SS2.p1.4.m4.5.5.4" xref="S4.SS2.p1.4.m4.5.5.4.cmml"><mi id="S4.SS2.p1.4.m4.5.5.4.2" xref="S4.SS2.p1.4.m4.5.5.4.2.cmml">F</mi><mo id="S4.SS2.p1.4.m4.5.5.4.1" xref="S4.SS2.p1.4.m4.5.5.4.1.cmml">⁢</mo><mrow id="S4.SS2.p1.4.m4.5.5.4.3.2" xref="S4.SS2.p1.4.m4.5.5.4.cmml"><mo id="S4.SS2.p1.4.m4.5.5.4.3.2.1" stretchy="false" xref="S4.SS2.p1.4.m4.5.5.4.cmml">(</mo><mo id="S4.SS2.p1.4.m4.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p1.4.m4.1.1.cmml">⋅</mo><mo id="S4.SS2.p1.4.m4.5.5.4.3.2.2" rspace="0.278em" stretchy="false" xref="S4.SS2.p1.4.m4.5.5.4.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.4.m4.5.5.3" rspace="0.278em" xref="S4.SS2.p1.4.m4.5.5.3.cmml">:</mo><mrow id="S4.SS2.p1.4.m4.5.5.2" xref="S4.SS2.p1.4.m4.5.5.2.cmml"><mrow id="S4.SS2.p1.4.m4.5.5.2.2.2" xref="S4.SS2.p1.4.m4.5.5.2.2.3.cmml"><msub id="S4.SS2.p1.4.m4.4.4.1.1.1.1" xref="S4.SS2.p1.4.m4.4.4.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.4.m4.4.4.1.1.1.1.2" xref="S4.SS2.p1.4.m4.4.4.1.1.1.1.2.cmml">𝒱</mi><mi id="S4.SS2.p1.4.m4.4.4.1.1.1.1.3" xref="S4.SS2.p1.4.m4.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p1.4.m4.5.5.2.2.2.3" xref="S4.SS2.p1.4.m4.5.5.2.2.3.cmml">,</mo><msub id="S4.SS2.p1.4.m4.5.5.2.2.2.2" xref="S4.SS2.p1.4.m4.5.5.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.4.m4.5.5.2.2.2.2.2" xref="S4.SS2.p1.4.m4.5.5.2.2.2.2.2.cmml">ℰ</mi><mi id="S4.SS2.p1.4.m4.5.5.2.2.2.2.3" xref="S4.SS2.p1.4.m4.5.5.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="S4.SS2.p1.4.m4.5.5.2.3" stretchy="false" xref="S4.SS2.p1.4.m4.5.5.2.3.cmml">→</mo><msup id="S4.SS2.p1.4.m4.5.5.2.4" xref="S4.SS2.p1.4.m4.5.5.2.4.cmml"><mrow id="S4.SS2.p1.4.m4.5.5.2.4.2.2" xref="S4.SS2.p1.4.m4.5.5.2.4.2.1.cmml"><mo id="S4.SS2.p1.4.m4.5.5.2.4.2.2.1" stretchy="false" xref="S4.SS2.p1.4.m4.5.5.2.4.2.1.cmml">{</mo><mn id="S4.SS2.p1.4.m4.2.2" xref="S4.SS2.p1.4.m4.2.2.cmml">0</mn><mo id="S4.SS2.p1.4.m4.5.5.2.4.2.2.2" xref="S4.SS2.p1.4.m4.5.5.2.4.2.1.cmml">,</mo><mn id="S4.SS2.p1.4.m4.3.3" xref="S4.SS2.p1.4.m4.3.3.cmml">1</mn><mo id="S4.SS2.p1.4.m4.5.5.2.4.2.2.3" stretchy="false" xref="S4.SS2.p1.4.m4.5.5.2.4.2.1.cmml">}</mo></mrow><mi id="S4.SS2.p1.4.m4.5.5.2.4.3" xref="S4.SS2.p1.4.m4.5.5.2.4.3.cmml">C</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.5b"><apply id="S4.SS2.p1.4.m4.5.5.cmml" xref="S4.SS2.p1.4.m4.5.5"><ci id="S4.SS2.p1.4.m4.5.5.3.cmml" xref="S4.SS2.p1.4.m4.5.5.3">:</ci><apply id="S4.SS2.p1.4.m4.5.5.4.cmml" xref="S4.SS2.p1.4.m4.5.5.4"><times id="S4.SS2.p1.4.m4.5.5.4.1.cmml" xref="S4.SS2.p1.4.m4.5.5.4.1"></times><ci id="S4.SS2.p1.4.m4.5.5.4.2.cmml" xref="S4.SS2.p1.4.m4.5.5.4.2">𝐹</ci><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">⋅</ci></apply><apply id="S4.SS2.p1.4.m4.5.5.2.cmml" xref="S4.SS2.p1.4.m4.5.5.2"><ci id="S4.SS2.p1.4.m4.5.5.2.3.cmml" xref="S4.SS2.p1.4.m4.5.5.2.3">→</ci><list id="S4.SS2.p1.4.m4.5.5.2.2.3.cmml" xref="S4.SS2.p1.4.m4.5.5.2.2.2"><apply id="S4.SS2.p1.4.m4.4.4.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.4.4.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.4.4.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.4.4.1.1.1.1.2">𝒱</ci><ci id="S4.SS2.p1.4.m4.4.4.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.4.4.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p1.4.m4.5.5.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.5.5.2.2.2.2.1.cmml" xref="S4.SS2.p1.4.m4.5.5.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.5.5.2.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.5.5.2.2.2.2.2">ℰ</ci><ci id="S4.SS2.p1.4.m4.5.5.2.2.2.2.3.cmml" xref="S4.SS2.p1.4.m4.5.5.2.2.2.2.3">𝑖</ci></apply></list><apply id="S4.SS2.p1.4.m4.5.5.2.4.cmml" xref="S4.SS2.p1.4.m4.5.5.2.4"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.5.5.2.4.1.cmml" xref="S4.SS2.p1.4.m4.5.5.2.4">superscript</csymbol><set id="S4.SS2.p1.4.m4.5.5.2.4.2.1.cmml" xref="S4.SS2.p1.4.m4.5.5.2.4.2.2"><cn id="S4.SS2.p1.4.m4.2.2.cmml" type="integer" xref="S4.SS2.p1.4.m4.2.2">0</cn><cn id="S4.SS2.p1.4.m4.3.3.cmml" type="integer" xref="S4.SS2.p1.4.m4.3.3">1</cn></set><ci id="S4.SS2.p1.4.m4.5.5.2.4.3.cmml" xref="S4.SS2.p1.4.m4.5.5.2.4.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.5c">F(\cdot):\mathcal{V}_{i},\mathcal{E}_{i}\rightarrow\{0,1\}^{C}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.5d">italic_F ( ⋅ ) : caligraphic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT → { 0 , 1 } start_POSTSUPERSCRIPT italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>.
Notably, we employ EGraphSage <cite class="ltx_cite ltx_citemacro_citep">(Lo et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib12" title="">2022</a>)</cite> as our <math alttext="F" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_F</annotation></semantics></math>, where the GNN learns the node and edge embeddings <math alttext="h_{\nu},h_{e}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.2"><semantics id="S4.SS2.p1.6.m6.2a"><mrow id="S4.SS2.p1.6.m6.2.2.2" xref="S4.SS2.p1.6.m6.2.2.3.cmml"><msub id="S4.SS2.p1.6.m6.1.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.1.1.2" xref="S4.SS2.p1.6.m6.1.1.1.1.2.cmml">h</mi><mi id="S4.SS2.p1.6.m6.1.1.1.1.3" xref="S4.SS2.p1.6.m6.1.1.1.1.3.cmml">ν</mi></msub><mo id="S4.SS2.p1.6.m6.2.2.2.3" xref="S4.SS2.p1.6.m6.2.2.3.cmml">,</mo><msub id="S4.SS2.p1.6.m6.2.2.2.2" xref="S4.SS2.p1.6.m6.2.2.2.2.cmml"><mi id="S4.SS2.p1.6.m6.2.2.2.2.2" xref="S4.SS2.p1.6.m6.2.2.2.2.2.cmml">h</mi><mi id="S4.SS2.p1.6.m6.2.2.2.2.3" xref="S4.SS2.p1.6.m6.2.2.2.2.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.2b"><list id="S4.SS2.p1.6.m6.2.2.3.cmml" xref="S4.SS2.p1.6.m6.2.2.2"><apply id="S4.SS2.p1.6.m6.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.2">ℎ</ci><ci id="S4.SS2.p1.6.m6.1.1.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.3">𝜈</ci></apply><apply id="S4.SS2.p1.6.m6.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.2.2.2.1.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.2.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.2">ℎ</ci><ci id="S4.SS2.p1.6.m6.2.2.2.2.3.cmml" xref="S4.SS2.p1.6.m6.2.2.2.2.3">𝑒</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.2c">h_{\nu},h_{e}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.2d">italic_h start_POSTSUBSCRIPT italic_ν end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> by an MLP.
The first layer has an interpretation of nonlinearly transforming the Bernoulli statistics residing on the graph we initialized.
Graph learning aims to discern correlations between events through message aggregation and learn the event (node) attributes.
The message <math alttext="m_{j}" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><msub id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">m</mi><mi id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝑚</ci><ci id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">m_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> on each edge <math alttext="e_{ij}" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m8.1"><semantics id="S4.SS2.p1.8.m8.1a"><msub id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">e</mi><mrow id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml"><mi id="S4.SS2.p1.8.m8.1.1.3.2" xref="S4.SS2.p1.8.m8.1.1.3.2.cmml">i</mi><mo id="S4.SS2.p1.8.m8.1.1.3.1" xref="S4.SS2.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.8.m8.1.1.3.3" xref="S4.SS2.p1.8.m8.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2">𝑒</ci><apply id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3"><times id="S4.SS2.p1.8.m8.1.1.3.1.cmml" xref="S4.SS2.p1.8.m8.1.1.3.1"></times><ci id="S4.SS2.p1.8.m8.1.1.3.2.cmml" xref="S4.SS2.p1.8.m8.1.1.3.2">𝑖</ci><ci id="S4.SS2.p1.8.m8.1.1.3.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">e_{ij}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.8.m8.1d">italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> from node <math alttext="i" class="ltx_Math" display="inline" id="S4.SS2.p1.9.m9.1"><semantics id="S4.SS2.p1.9.m9.1a"><mi id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><ci id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.9.m9.1d">italic_i</annotation></semantics></math> to node <math alttext="j" class="ltx_Math" display="inline" id="S4.SS2.p1.10.m10.1"><semantics id="S4.SS2.p1.10.m10.1a"><mi id="S4.SS2.p1.10.m10.1.1" xref="S4.SS2.p1.10.m10.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b"><ci id="S4.SS2.p1.10.m10.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.10.m10.1d">italic_j</annotation></semantics></math> is:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="m_{j}=\text{relu}\left(\mathbf{W}_{m}\times\left(h_{\nu_{j}}\oplus h_{e_{ij}}%
\right)\right)" class="ltx_Math" display="block" id="S4.E3.m1.1"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><msub id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.3.2" xref="S4.E3.m1.1.1.3.2.cmml">m</mi><mi id="S4.E3.m1.1.1.3.3" xref="S4.E3.m1.1.1.3.3.cmml">j</mi></msub><mo id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml"><mtext id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.1.1.3a.cmml">relu</mtext><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><msub id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mi id="S4.E3.m1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.3.3.cmml">m</mi></msub><mo id="S4.E3.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E3.m1.1.1.1.1.1.1.2.cmml">×</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">ν</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></msub><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">⊕</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">e</mi><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">j</mi></mrow></msub></msub></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><eq id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2"></eq><apply id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.3.2">𝑚</ci><ci id="S4.E3.m1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.3.3">𝑗</ci></apply><apply id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><times id="S4.E3.m1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.2"></times><ci id="S4.E3.m1.1.1.1.3a.cmml" xref="S4.E3.m1.1.1.1.3"><mtext id="S4.E3.m1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.3">relu</mtext></ci><apply id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2"></times><apply id="S4.E3.m1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3.2">𝐖</ci><ci id="S4.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝜈</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑒</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.1"></times><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">m_{j}=\text{relu}\left(\mathbf{W}_{m}\times\left(h_{\nu_{j}}\oplus h_{e_{ij}}%
\right)\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.1d">italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = relu ( bold_W start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT × ( italic_h start_POSTSUBSCRIPT italic_ν start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⊕ italic_h start_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.13">where <math alttext="\oplus" class="ltx_Math" display="inline" id="S4.SS2.p1.11.m1.1"><semantics id="S4.SS2.p1.11.m1.1a"><mo id="S4.SS2.p1.11.m1.1.1" xref="S4.SS2.p1.11.m1.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m1.1b"><csymbol cd="latexml" id="S4.SS2.p1.11.m1.1.1.cmml" xref="S4.SS2.p1.11.m1.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m1.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.11.m1.1d">⊕</annotation></semantics></math> represents concatenation. <math alttext="\mathbf{W}_{m}" class="ltx_Math" display="inline" id="S4.SS2.p1.12.m2.1"><semantics id="S4.SS2.p1.12.m2.1a"><msub id="S4.SS2.p1.12.m2.1.1" xref="S4.SS2.p1.12.m2.1.1.cmml"><mi id="S4.SS2.p1.12.m2.1.1.2" xref="S4.SS2.p1.12.m2.1.1.2.cmml">𝐖</mi><mi id="S4.SS2.p1.12.m2.1.1.3" xref="S4.SS2.p1.12.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m2.1b"><apply id="S4.SS2.p1.12.m2.1.1.cmml" xref="S4.SS2.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m2.1.1.1.cmml" xref="S4.SS2.p1.12.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.12.m2.1.1.2.cmml" xref="S4.SS2.p1.12.m2.1.1.2">𝐖</ci><ci id="S4.SS2.p1.12.m2.1.1.3.cmml" xref="S4.SS2.p1.12.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m2.1c">\mathbf{W}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.12.m2.1d">bold_W start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> is a learnable weight matrix for message passing, and <span class="ltx_text ltx_markedasmath" id="S4.SS2.p1.13.1">relu</span> is a non-linear activation function.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Message aggregation:</span>
Afterward, we aggregate messages <math alttext="m_{j}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">m</mi><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑚</ci><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">m_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> across edges for each node:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{AGGREGATE}_{i}=\frac{1}{|\mathcal{N}(i)|}\sum_{j\in\mathcal{N}(i)}m_{j}" class="ltx_Math" display="block" id="S4.E4.m1.3"><semantics id="S4.E4.m1.3a"><mrow id="S4.E4.m1.3.4" xref="S4.E4.m1.3.4.cmml"><msub id="S4.E4.m1.3.4.2" xref="S4.E4.m1.3.4.2.cmml"><mtext id="S4.E4.m1.3.4.2.2" xref="S4.E4.m1.3.4.2.2a.cmml">AGGREGATE</mtext><mi id="S4.E4.m1.3.4.2.3" xref="S4.E4.m1.3.4.2.3.cmml">i</mi></msub><mo id="S4.E4.m1.3.4.1" xref="S4.E4.m1.3.4.1.cmml">=</mo><mrow id="S4.E4.m1.3.4.3" xref="S4.E4.m1.3.4.3.cmml"><mfrac id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml"><mn id="S4.E4.m1.2.2.4" xref="S4.E4.m1.2.2.4.cmml">1</mn><mrow id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.3.cmml"><mo id="S4.E4.m1.2.2.2.2.2" stretchy="false" xref="S4.E4.m1.2.2.2.3.1.cmml">|</mo><mrow id="S4.E4.m1.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.2.2.2.2.1.2" xref="S4.E4.m1.2.2.2.2.1.2.cmml">𝒩</mi><mo id="S4.E4.m1.2.2.2.2.1.1" xref="S4.E4.m1.2.2.2.2.1.1.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.2.2.1.3.2" xref="S4.E4.m1.2.2.2.2.1.cmml"><mo id="S4.E4.m1.2.2.2.2.1.3.2.1" stretchy="false" xref="S4.E4.m1.2.2.2.2.1.cmml">(</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">i</mi><mo id="S4.E4.m1.2.2.2.2.1.3.2.2" stretchy="false" xref="S4.E4.m1.2.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.2.2.3" stretchy="false" xref="S4.E4.m1.2.2.2.3.1.cmml">|</mo></mrow></mfrac><mo id="S4.E4.m1.3.4.3.1" xref="S4.E4.m1.3.4.3.1.cmml">⁢</mo><mrow id="S4.E4.m1.3.4.3.2" xref="S4.E4.m1.3.4.3.2.cmml"><munder id="S4.E4.m1.3.4.3.2.1" xref="S4.E4.m1.3.4.3.2.1.cmml"><mo id="S4.E4.m1.3.4.3.2.1.2" movablelimits="false" xref="S4.E4.m1.3.4.3.2.1.2.cmml">∑</mo><mrow id="S4.E4.m1.3.3.1" xref="S4.E4.m1.3.3.1.cmml"><mi id="S4.E4.m1.3.3.1.3" xref="S4.E4.m1.3.3.1.3.cmml">j</mi><mo id="S4.E4.m1.3.3.1.2" xref="S4.E4.m1.3.3.1.2.cmml">∈</mo><mrow id="S4.E4.m1.3.3.1.4" xref="S4.E4.m1.3.3.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.3.3.1.4.2" xref="S4.E4.m1.3.3.1.4.2.cmml">𝒩</mi><mo id="S4.E4.m1.3.3.1.4.1" xref="S4.E4.m1.3.3.1.4.1.cmml">⁢</mo><mrow id="S4.E4.m1.3.3.1.4.3.2" xref="S4.E4.m1.3.3.1.4.cmml"><mo id="S4.E4.m1.3.3.1.4.3.2.1" stretchy="false" xref="S4.E4.m1.3.3.1.4.cmml">(</mo><mi id="S4.E4.m1.3.3.1.1" xref="S4.E4.m1.3.3.1.1.cmml">i</mi><mo id="S4.E4.m1.3.3.1.4.3.2.2" stretchy="false" xref="S4.E4.m1.3.3.1.4.cmml">)</mo></mrow></mrow></mrow></munder><msub id="S4.E4.m1.3.4.3.2.2" xref="S4.E4.m1.3.4.3.2.2.cmml"><mi id="S4.E4.m1.3.4.3.2.2.2" xref="S4.E4.m1.3.4.3.2.2.2.cmml">m</mi><mi id="S4.E4.m1.3.4.3.2.2.3" xref="S4.E4.m1.3.4.3.2.2.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.3b"><apply id="S4.E4.m1.3.4.cmml" xref="S4.E4.m1.3.4"><eq id="S4.E4.m1.3.4.1.cmml" xref="S4.E4.m1.3.4.1"></eq><apply id="S4.E4.m1.3.4.2.cmml" xref="S4.E4.m1.3.4.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.4.2.1.cmml" xref="S4.E4.m1.3.4.2">subscript</csymbol><ci id="S4.E4.m1.3.4.2.2a.cmml" xref="S4.E4.m1.3.4.2.2"><mtext id="S4.E4.m1.3.4.2.2.cmml" xref="S4.E4.m1.3.4.2.2">AGGREGATE</mtext></ci><ci id="S4.E4.m1.3.4.2.3.cmml" xref="S4.E4.m1.3.4.2.3">𝑖</ci></apply><apply id="S4.E4.m1.3.4.3.cmml" xref="S4.E4.m1.3.4.3"><times id="S4.E4.m1.3.4.3.1.cmml" xref="S4.E4.m1.3.4.3.1"></times><apply id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2"><divide id="S4.E4.m1.2.2.3.cmml" xref="S4.E4.m1.2.2"></divide><cn id="S4.E4.m1.2.2.4.cmml" type="integer" xref="S4.E4.m1.2.2.4">1</cn><apply id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2"><abs id="S4.E4.m1.2.2.2.3.1.cmml" xref="S4.E4.m1.2.2.2.2.2"></abs><apply id="S4.E4.m1.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.1"><times id="S4.E4.m1.2.2.2.2.1.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1"></times><ci id="S4.E4.m1.2.2.2.2.1.2.cmml" xref="S4.E4.m1.2.2.2.2.1.2">𝒩</ci><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="S4.E4.m1.3.4.3.2.cmml" xref="S4.E4.m1.3.4.3.2"><apply id="S4.E4.m1.3.4.3.2.1.cmml" xref="S4.E4.m1.3.4.3.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.3.4.3.2.1.1.cmml" xref="S4.E4.m1.3.4.3.2.1">subscript</csymbol><sum id="S4.E4.m1.3.4.3.2.1.2.cmml" xref="S4.E4.m1.3.4.3.2.1.2"></sum><apply id="S4.E4.m1.3.3.1.cmml" xref="S4.E4.m1.3.3.1"><in id="S4.E4.m1.3.3.1.2.cmml" xref="S4.E4.m1.3.3.1.2"></in><ci id="S4.E4.m1.3.3.1.3.cmml" xref="S4.E4.m1.3.3.1.3">𝑗</ci><apply id="S4.E4.m1.3.3.1.4.cmml" xref="S4.E4.m1.3.3.1.4"><times id="S4.E4.m1.3.3.1.4.1.cmml" xref="S4.E4.m1.3.3.1.4.1"></times><ci id="S4.E4.m1.3.3.1.4.2.cmml" xref="S4.E4.m1.3.3.1.4.2">𝒩</ci><ci id="S4.E4.m1.3.3.1.1.cmml" xref="S4.E4.m1.3.3.1.1">𝑖</ci></apply></apply></apply><apply id="S4.E4.m1.3.4.3.2.2.cmml" xref="S4.E4.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.4.3.2.2.1.cmml" xref="S4.E4.m1.3.4.3.2.2">subscript</csymbol><ci id="S4.E4.m1.3.4.3.2.2.2.cmml" xref="S4.E4.m1.3.4.3.2.2.2">𝑚</ci><ci id="S4.E4.m1.3.4.3.2.2.3.cmml" xref="S4.E4.m1.3.4.3.2.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.3c">\text{AGGREGATE}_{i}=\frac{1}{|\mathcal{N}(i)|}\sum_{j\in\mathcal{N}(i)}m_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.3d">AGGREGATE start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG | caligraphic_N ( italic_i ) | end_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N ( italic_i ) end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.2">where <math alttext="\mathcal{N}(i)" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m1.1"><semantics id="S4.SS2.p2.2.m1.1a"><mrow id="S4.SS2.p2.2.m1.1.2" xref="S4.SS2.p2.2.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.2.m1.1.2.2" xref="S4.SS2.p2.2.m1.1.2.2.cmml">𝒩</mi><mo id="S4.SS2.p2.2.m1.1.2.1" xref="S4.SS2.p2.2.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.2.m1.1.2.3.2" xref="S4.SS2.p2.2.m1.1.2.cmml"><mo id="S4.SS2.p2.2.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.2.m1.1.2.cmml">(</mo><mi id="S4.SS2.p2.2.m1.1.1" xref="S4.SS2.p2.2.m1.1.1.cmml">i</mi><mo id="S4.SS2.p2.2.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m1.1b"><apply id="S4.SS2.p2.2.m1.1.2.cmml" xref="S4.SS2.p2.2.m1.1.2"><times id="S4.SS2.p2.2.m1.1.2.1.cmml" xref="S4.SS2.p2.2.m1.1.2.1"></times><ci id="S4.SS2.p2.2.m1.1.2.2.cmml" xref="S4.SS2.p2.2.m1.1.2.2">𝒩</ci><ci id="S4.SS2.p2.2.m1.1.1.cmml" xref="S4.SS2.p2.2.m1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m1.1c">\mathcal{N}(i)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m1.1d">caligraphic_N ( italic_i )</annotation></semantics></math> represents the set of neighbors.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.2.1">Update node features:</span>
We update and normalize the node feature <math alttext="h_{\nu_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">h</mi><msub id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml"><mi id="S4.SS2.p3.1.m1.1.1.3.2" xref="S4.SS2.p3.1.m1.1.1.3.2.cmml">ν</mi><mi id="S4.SS2.p3.1.m1.1.1.3.3" xref="S4.SS2.p3.1.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">ℎ</ci><apply id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.p3.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.3.2.cmml" xref="S4.SS2.p3.1.m1.1.1.3.2">𝜈</ci><ci id="S4.SS2.p3.1.m1.1.1.3.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">h_{\nu_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_ν start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for each node <math alttext="\nu_{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">ν</mi><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝜈</ci><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\nu_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_ν start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> using:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h_{\nu_{i}}=\text{activation}\left(\mathbf{W}_{u}\times\left(h_{\nu_{i}}\oplus%
\text{AGGREGATE}_{i}\right)\right)" class="ltx_Math" display="block" id="S4.E5.m1.1"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><msub id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.3.2" xref="S4.E5.m1.1.1.3.2.cmml">h</mi><msub id="S4.E5.m1.1.1.3.3" xref="S4.E5.m1.1.1.3.3.cmml"><mi id="S4.E5.m1.1.1.3.3.2" xref="S4.E5.m1.1.1.3.3.2.cmml">ν</mi><mi id="S4.E5.m1.1.1.3.3.3" xref="S4.E5.m1.1.1.3.3.3.cmml">i</mi></msub></msub><mo id="S4.E5.m1.1.1.2" xref="S4.E5.m1.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.cmml"><mtext id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.3a.cmml">activation</mtext><mo id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mi id="S4.E5.m1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.3.3.cmml">u</mi></msub><mo id="S4.E5.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.1.1.1.1.2.cmml">×</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">ν</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></msub><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⊕</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2a.cmml">AGGREGATE</mtext><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><eq id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1.2"></eq><apply id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.3.2">ℎ</ci><apply id="S4.E5.m1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.3.3.1.cmml" xref="S4.E5.m1.1.1.3.3">subscript</csymbol><ci id="S4.E5.m1.1.1.3.3.2.cmml" xref="S4.E5.m1.1.1.3.3.2">𝜈</ci><ci id="S4.E5.m1.1.1.3.3.3.cmml" xref="S4.E5.m1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><times id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.2"></times><ci id="S4.E5.m1.1.1.1.3a.cmml" xref="S4.E5.m1.1.1.1.3"><mtext id="S4.E5.m1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.3">activation</mtext></ci><apply id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.2">𝐖</ci><ci id="S4.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝜈</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2"><mtext id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.2">AGGREGATE</mtext></ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">h_{\nu_{i}}=\text{activation}\left(\mathbf{W}_{u}\times\left(h_{\nu_{i}}\oplus%
\text{AGGREGATE}_{i}\right)\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.1d">italic_h start_POSTSUBSCRIPT italic_ν start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT = activation ( bold_W start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT × ( italic_h start_POSTSUBSCRIPT italic_ν start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⊕ AGGREGATE start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.6">where <math alttext="h_{\nu_{i}}^{\prime}=\frac{h_{\nu_{i}}^{\prime}}{\|h_{\nu_{i}}^{\prime}\|_{2}}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m1.1"><semantics id="S4.SS2.p3.3.m1.1a"><mrow id="S4.SS2.p3.3.m1.1.2" xref="S4.SS2.p3.3.m1.1.2.cmml"><msubsup id="S4.SS2.p3.3.m1.1.2.2" xref="S4.SS2.p3.3.m1.1.2.2.cmml"><mi id="S4.SS2.p3.3.m1.1.2.2.2.2" xref="S4.SS2.p3.3.m1.1.2.2.2.2.cmml">h</mi><msub id="S4.SS2.p3.3.m1.1.2.2.2.3" xref="S4.SS2.p3.3.m1.1.2.2.2.3.cmml"><mi id="S4.SS2.p3.3.m1.1.2.2.2.3.2" xref="S4.SS2.p3.3.m1.1.2.2.2.3.2.cmml">ν</mi><mi id="S4.SS2.p3.3.m1.1.2.2.2.3.3" xref="S4.SS2.p3.3.m1.1.2.2.2.3.3.cmml">i</mi></msub><mo id="S4.SS2.p3.3.m1.1.2.2.3" xref="S4.SS2.p3.3.m1.1.2.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.p3.3.m1.1.2.1" xref="S4.SS2.p3.3.m1.1.2.1.cmml">=</mo><mfrac id="S4.SS2.p3.3.m1.1.1" xref="S4.SS2.p3.3.m1.1.1.cmml"><msubsup id="S4.SS2.p3.3.m1.1.1.3" xref="S4.SS2.p3.3.m1.1.1.3.cmml"><mi id="S4.SS2.p3.3.m1.1.1.3.2.2" xref="S4.SS2.p3.3.m1.1.1.3.2.2.cmml">h</mi><msub id="S4.SS2.p3.3.m1.1.1.3.2.3" xref="S4.SS2.p3.3.m1.1.1.3.2.3.cmml"><mi id="S4.SS2.p3.3.m1.1.1.3.2.3.2" xref="S4.SS2.p3.3.m1.1.1.3.2.3.2.cmml">ν</mi><mi id="S4.SS2.p3.3.m1.1.1.3.2.3.3" xref="S4.SS2.p3.3.m1.1.1.3.2.3.3.cmml">i</mi></msub><mo id="S4.SS2.p3.3.m1.1.1.3.3" xref="S4.SS2.p3.3.m1.1.1.3.3.cmml">′</mo></msubsup><msub id="S4.SS2.p3.3.m1.1.1.1" xref="S4.SS2.p3.3.m1.1.1.1.cmml"><mrow id="S4.SS2.p3.3.m1.1.1.1.1.1" xref="S4.SS2.p3.3.m1.1.1.1.1.2.cmml"><mo id="S4.SS2.p3.3.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p3.3.m1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S4.SS2.p3.3.m1.1.1.1.1.1.1" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.2" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.2.cmml">h</mi><msub id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.2" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.2.cmml">ν</mi><mi id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.3" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mo id="S4.SS2.p3.3.m1.1.1.1.1.1.1.3" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S4.SS2.p3.3.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p3.3.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.p3.3.m1.1.1.1.3" xref="S4.SS2.p3.3.m1.1.1.1.3.cmml">2</mn></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m1.1b"><apply id="S4.SS2.p3.3.m1.1.2.cmml" xref="S4.SS2.p3.3.m1.1.2"><eq id="S4.SS2.p3.3.m1.1.2.1.cmml" xref="S4.SS2.p3.3.m1.1.2.1"></eq><apply id="S4.SS2.p3.3.m1.1.2.2.cmml" xref="S4.SS2.p3.3.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.2.2.1.cmml" xref="S4.SS2.p3.3.m1.1.2.2">superscript</csymbol><apply id="S4.SS2.p3.3.m1.1.2.2.2.cmml" xref="S4.SS2.p3.3.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.2.2.2.1.cmml" xref="S4.SS2.p3.3.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.p3.3.m1.1.2.2.2.2.cmml" xref="S4.SS2.p3.3.m1.1.2.2.2.2">ℎ</ci><apply id="S4.SS2.p3.3.m1.1.2.2.2.3.cmml" xref="S4.SS2.p3.3.m1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.2.2.2.3.1.cmml" xref="S4.SS2.p3.3.m1.1.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p3.3.m1.1.2.2.2.3.2.cmml" xref="S4.SS2.p3.3.m1.1.2.2.2.3.2">𝜈</ci><ci id="S4.SS2.p3.3.m1.1.2.2.2.3.3.cmml" xref="S4.SS2.p3.3.m1.1.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS2.p3.3.m1.1.2.2.3.cmml" xref="S4.SS2.p3.3.m1.1.2.2.3">′</ci></apply><apply id="S4.SS2.p3.3.m1.1.1.cmml" xref="S4.SS2.p3.3.m1.1.1"><divide id="S4.SS2.p3.3.m1.1.1.2.cmml" xref="S4.SS2.p3.3.m1.1.1"></divide><apply id="S4.SS2.p3.3.m1.1.1.3.cmml" xref="S4.SS2.p3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.1.3.1.cmml" xref="S4.SS2.p3.3.m1.1.1.3">superscript</csymbol><apply id="S4.SS2.p3.3.m1.1.1.3.2.cmml" xref="S4.SS2.p3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.1.3.2.1.cmml" xref="S4.SS2.p3.3.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.3.m1.1.1.3.2.2.cmml" xref="S4.SS2.p3.3.m1.1.1.3.2.2">ℎ</ci><apply id="S4.SS2.p3.3.m1.1.1.3.2.3.cmml" xref="S4.SS2.p3.3.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.1.3.2.3.1.cmml" xref="S4.SS2.p3.3.m1.1.1.3.2.3">subscript</csymbol><ci id="S4.SS2.p3.3.m1.1.1.3.2.3.2.cmml" xref="S4.SS2.p3.3.m1.1.1.3.2.3.2">𝜈</ci><ci id="S4.SS2.p3.3.m1.1.1.3.2.3.3.cmml" xref="S4.SS2.p3.3.m1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS2.p3.3.m1.1.1.3.3.cmml" xref="S4.SS2.p3.3.m1.1.1.3.3">′</ci></apply><apply id="S4.SS2.p3.3.m1.1.1.1.cmml" xref="S4.SS2.p3.3.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.1.1.2.cmml" xref="S4.SS2.p3.3.m1.1.1.1">subscript</csymbol><apply id="S4.SS2.p3.3.m1.1.1.1.1.2.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p3.3.m1.1.1.1.1.2.1.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS2.p3.3.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.2">𝜈</ci><ci id="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS2.p3.3.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.3.m1.1.1.1.1.1.1.3">′</ci></apply></apply><cn id="S4.SS2.p3.3.m1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.3.m1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m1.1c">h_{\nu_{i}}^{\prime}=\frac{h_{\nu_{i}}^{\prime}}{\|h_{\nu_{i}}^{\prime}\|_{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m1.1d">italic_h start_POSTSUBSCRIPT italic_ν start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = divide start_ARG italic_h start_POSTSUBSCRIPT italic_ν start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_ARG start_ARG ∥ italic_h start_POSTSUBSCRIPT italic_ν start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> is the updated feature of node <math alttext="i" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m2.1"><semantics id="S4.SS2.p3.4.m2.1a"><mi id="S4.SS2.p3.4.m2.1.1" xref="S4.SS2.p3.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m2.1b"><ci id="S4.SS2.p3.4.m2.1.1.cmml" xref="S4.SS2.p3.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m2.1d">italic_i</annotation></semantics></math>, and <math alttext="\mathbf{W}_{u}" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m3.1"><semantics id="S4.SS2.p3.5.m3.1a"><msub id="S4.SS2.p3.5.m3.1.1" xref="S4.SS2.p3.5.m3.1.1.cmml"><mi id="S4.SS2.p3.5.m3.1.1.2" xref="S4.SS2.p3.5.m3.1.1.2.cmml">𝐖</mi><mi id="S4.SS2.p3.5.m3.1.1.3" xref="S4.SS2.p3.5.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m3.1b"><apply id="S4.SS2.p3.5.m3.1.1.cmml" xref="S4.SS2.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m3.1.1.1.cmml" xref="S4.SS2.p3.5.m3.1.1">subscript</csymbol><ci id="S4.SS2.p3.5.m3.1.1.2.cmml" xref="S4.SS2.p3.5.m3.1.1.2">𝐖</ci><ci id="S4.SS2.p3.5.m3.1.1.3.cmml" xref="S4.SS2.p3.5.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m3.1c">\mathbf{W}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m3.1d">bold_W start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is learnable weight matrix for updating, <math alttext="\|.\|_{2}" class="ltx_math_unparsed" display="inline" id="S4.SS2.p3.6.m4.1"><semantics id="S4.SS2.p3.6.m4.1a"><mrow id="S4.SS2.p3.6.m4.1b"><mo id="S4.SS2.p3.6.m4.1.1" rspace="0.0835em">∥</mo><mo id="S4.SS2.p3.6.m4.1.2" lspace="0.0835em" rspace="0.0835em">.</mo><msub id="S4.SS2.p3.6.m4.1.3"><mo id="S4.SS2.p3.6.m4.1.3.2" lspace="0.0835em">∥</mo><mn id="S4.SS2.p3.6.m4.1.3.3">2</mn></msub></mrow><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m4.1c">\|.\|_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m4.1d">∥ . ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> denotes the L2 norm.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> 
Pseudocode of patient-event graph
</figcaption>
<div class="ltx_listing ltx_lst_language_python ltx_lstlisting ltx_listing" id="alg1.3" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmIGdlbmVyYXRlX3BhdGllbnRfZ3JhcGgoRUhSX01hdHJpeCk6CiAgICAjIEVIUl9NYXRyaXg6IFJvd3MgcmVwcmVzZW50IHBhdGllbnRzLCBhbmQgY29sdW1ucyByZXByZXNlbnQgbWVkaWNhbCBldmVudHMKICAgICMgQ2FsY3VsYXRlIHByb3BvcnRpb25zIG9mIGVhY2ggZXZlbnQgYmFzZWQgb24gYWxsIHBhdGllbnRzCiAgICBldmVudF9wcm9wb3J0aW9ucyA9IG1lYW4oRUhSX01hdHJpeCwgYXhpcz0wKQogICAgIyBDYWxjdWxhdGUgcG9zdGVyaW9yIHByb2JhYmlsaXRpZXMgYmV0d2VlbiBlYWNoIHBhaXIgb2YgZXZlbnRzIGZvciB0aGUgcGFpciBvZiBldmVudCBpIGFuZCBldmVudCBqOgogICAgcG9zdGVyaW9yIHByb2JhYmlsaXR5KGV2ZW50IGksIGV2ZW50IGopID0gJFxmcmFje3tcdGV4dHtQcm9wb3J0aW9ufX0oXHRleHR7ZXZlbnQgaX0gPSAxIFx0ZXh0eyBhbmQgfSAgXHRleHR7ZXZlbnQgan0gPSAxKX17e1x0ZXh0e1Byb3BvcnRpb259fSggXHRleHR7ZXZlbnQgan0gPSAxKX0kID0gJFxmcmFje1x0ZXh0e251bWJlciBvZn0gKFx0ZXh0e2V2ZW50IGl9ID09IDEgXDtcdGV4dHthbmR9XDsgXHRleHR7ZXZlbnQgan0gPT0gMSl9eyBcdGV4dHtudW1iZXIgb2YgYWxsIHBhdGllbnRzfX0gLyBcZnJhY3tcdGV4dHtudW1iZXIgb2Z9IChcdGV4dHtldmVudCBqfSA9PSAxKX17XHRleHR7bnVtYmVyIG9mIGFsbCBwYXRpZW50c319JAogICAgRm9yIGVhY2ggcGF0aWVudCwgZ2VuZXJhdGUgYSBncmFwaDoKICAgICAgICAjIERldGVybWluZSBub2RlIGVtYmVkZGluZ3MgYmFzZWQgb24gdGhlIHBhdGllbnQncyBtZWRpY2FsIGV2ZW50IGRhdGEKICAgICAgICBub2RlX2VtYmVkZGluZ3MgPSBldmVudF9wcm9wb3J0aW9uIGlmIGlucHV0IHZhbHVlID09IDEKICAgICAgICBub2RlX2VtYmVkZGluZ3MgPSAxLWV2ZW50X3Byb3BvcnRpb24gaWYgaW5wdXQgdmFsdWUgPT0gMAogICAgICAgICMgRGV0ZXJtaW5lIGVkZ2Ugd2VpZ2h0cyBieSB0aGUgcG9zdGVyaW9yIHByb2JhYmlsaXRpZXMgYmV0d2VlbiBlYWNoIHBhaXIgb2YgZXZlbnRzCiAgICAgICAgZWRnZV93ZWlnaHRzIG9mIGVkZ2UgZnJvbSBub2RlIGkgdG8gbm9kZSBqID0KICAgICAgICAgICAgcG9zdGVyaW9yIHByb2JhYmlsaXR5IG9mIChpLCBqKQo=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx1.1" style="color:#0080B3;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.2"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.3">generate_patient_graph</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.4">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.5">EHR_Matrix</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.6">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx2.2" style="color:#408080;">#<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.1"> </span>EHR_Matrix:<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.2"> </span>Rows<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.3"> </span>represent<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.4"> </span>patients,<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.5"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.6"> </span>columns<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.7"> </span>represent<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.8"> </span>medical<span class="ltx_text ltx_lst_space" id="lstnumberx2.2.9"> </span>events</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx3.2" style="color:#408080;">#<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.1"> </span>Calculate<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.2"> </span>proportions<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.3"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.4"> </span>each<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.5"> </span>event<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.6"> </span>based<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.7"> </span>on<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.8"> </span>all<span class="ltx_text ltx_lst_space" id="lstnumberx3.2.9"> </span>patients</span>
</div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.2">event_proportions</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.6">mean</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.8">EHR_Matrix</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.9">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.11">axis</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.12">=0)</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx5.2" style="color:#408080;">#<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.1"> </span>Calculate<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.2"> </span>posterior<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.3"> </span>probabilities<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.4"> </span>between<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.5"> </span>each<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.6"> </span>pair<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.7"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.8"> </span>events<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.9"> </span>for<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.10"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.11"> </span>pair<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.12"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.13"> </span>event<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.14"> </span>i<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.15"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.16"> </span>event<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.17"> </span>j:</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.4">posterior</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.6">probability</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.7">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.8">event</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.10">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.11">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.13">event</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.14"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.15">j</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.16">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.17"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.18">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.1"><math alttext="\frac{{\text{Proportion}}(\text{event i}=1\text{ and }\text{event j}=1)}{{%
\text{Proportion}}(\text{event j}=1)}" class="ltx_Math" display="inline" id="lstnumberx6.1.m1.2"><semantics id="lstnumberx6.1.m1.2a"><mfrac id="lstnumberx6.1.m1.2.2" xref="lstnumberx6.1.m1.2.2.cmml"><mrow id="lstnumberx6.1.m1.1.1.1" xref="lstnumberx6.1.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.1.1.1.3" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.1.1.1.3a.cmml">Proportion</mtext><mo id="lstnumberx6.1.m1.1.1.1.2" xref="lstnumberx6.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="lstnumberx6.1.m1.1.1.1.1.1" xref="lstnumberx6.1.m1.1.1.1.1.1.1.cmml"><mo id="lstnumberx6.1.m1.1.1.1.1.1.2" mathbackground="#FFFFFF" stretchy="false" xref="lstnumberx6.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="lstnumberx6.1.m1.1.1.1.1.1.1" xref="lstnumberx6.1.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.1.1.1.1.1.1.2" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.1.1.1.1.1.1.2a.cmml">event i</mtext><mo id="lstnumberx6.1.m1.1.1.1.1.1.1.3" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.1.1.1.1.1.1.3.cmml">=</mo><mrow id="lstnumberx6.1.m1.1.1.1.1.1.1.4" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.cmml"><mn id="lstnumberx6.1.m1.1.1.1.1.1.1.4.2" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.2.cmml">1</mn><mo id="lstnumberx6.1.m1.1.1.1.1.1.1.4.1" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="lstnumberx6.1.m1.1.1.1.1.1.1.4.3" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.3c.cmml"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.1.1.1.1.1.1.4.3a" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.3c.cmml"> and </mtext><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.1.1.1.1.1.1.4.3b" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.3c.cmml">event j</mtext></mrow></mrow><mo id="lstnumberx6.1.m1.1.1.1.1.1.1.5" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.1.1.1.1.1.1.5.cmml">=</mo><mn id="lstnumberx6.1.m1.1.1.1.1.1.1.6" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.1.1.1.1.1.1.6.cmml">1</mn></mrow><mo id="lstnumberx6.1.m1.1.1.1.1.1.3" mathbackground="#FFFFFF" stretchy="false" xref="lstnumberx6.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="lstnumberx6.1.m1.2.2.2" xref="lstnumberx6.1.m1.2.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.2.2.2.3" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.2.2.2.3a.cmml">Proportion</mtext><mo id="lstnumberx6.1.m1.2.2.2.2" xref="lstnumberx6.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="lstnumberx6.1.m1.2.2.2.1.1" xref="lstnumberx6.1.m1.2.2.2.1.1.1.cmml"><mo id="lstnumberx6.1.m1.2.2.2.1.1.2" mathbackground="#FFFFFF" stretchy="false" xref="lstnumberx6.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="lstnumberx6.1.m1.2.2.2.1.1.1" xref="lstnumberx6.1.m1.2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.2.2.2.1.1.1.2" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.2.2.2.1.1.1.2a.cmml">event j</mtext><mo id="lstnumberx6.1.m1.2.2.2.1.1.1.1" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.2.2.2.1.1.1.1.cmml">=</mo><mn id="lstnumberx6.1.m1.2.2.2.1.1.1.3" mathbackground="#FFFFFF" xref="lstnumberx6.1.m1.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="lstnumberx6.1.m1.2.2.2.1.1.3" mathbackground="#FFFFFF" stretchy="false" xref="lstnumberx6.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="lstnumberx6.1.m1.2b"><apply id="lstnumberx6.1.m1.2.2.cmml" xref="lstnumberx6.1.m1.2.2"><divide id="lstnumberx6.1.m1.2.2.3.cmml" xref="lstnumberx6.1.m1.2.2"></divide><apply id="lstnumberx6.1.m1.1.1.1.cmml" xref="lstnumberx6.1.m1.1.1.1"><times id="lstnumberx6.1.m1.1.1.1.2.cmml" xref="lstnumberx6.1.m1.1.1.1.2"></times><ci id="lstnumberx6.1.m1.1.1.1.3a.cmml" xref="lstnumberx6.1.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.1.1.1.3.cmml" mathbackground="#FFFFFF" mathsize="70%" xref="lstnumberx6.1.m1.1.1.1.3">Proportion</mtext></ci><apply id="lstnumberx6.1.m1.1.1.1.1.1.1.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1"><and id="lstnumberx6.1.m1.1.1.1.1.1.1a.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1"></and><apply id="lstnumberx6.1.m1.1.1.1.1.1.1b.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1"><eq id="lstnumberx6.1.m1.1.1.1.1.1.1.3.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1.1.3"></eq><ci id="lstnumberx6.1.m1.1.1.1.1.1.1.2a.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.1.1.1.1.1.1.2.cmml" mathbackground="#FFFFFF" mathsize="70%" xref="lstnumberx6.1.m1.1.1.1.1.1.1.2">event i</mtext></ci><apply id="lstnumberx6.1.m1.1.1.1.1.1.1.4.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4"><times id="lstnumberx6.1.m1.1.1.1.1.1.1.4.1.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.1"></times><cn id="lstnumberx6.1.m1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.2">1</cn><ci id="lstnumberx6.1.m1.1.1.1.1.1.1.4.3c.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.3"><mrow id="lstnumberx6.1.m1.1.1.1.1.1.1.4.3.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.3"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.1.1.1.1.1.1.4.3a.cmml" mathbackground="#FFFFFF" mathsize="70%" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.3"> and </mtext><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.1.1.1.1.1.1.4.3b.cmml" mathbackground="#FFFFFF" mathsize="70%" xref="lstnumberx6.1.m1.1.1.1.1.1.1.4.3">event j</mtext></mrow></ci></apply></apply><apply id="lstnumberx6.1.m1.1.1.1.1.1.1c.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1"><eq id="lstnumberx6.1.m1.1.1.1.1.1.1.5.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2408.09410v3#lstnumberx6.1.m1.1.1.1.1.1.1.4.cmml" id="lstnumberx6.1.m1.1.1.1.1.1.1d.cmml" xref="lstnumberx6.1.m1.1.1.1.1.1"></share><cn id="lstnumberx6.1.m1.1.1.1.1.1.1.6.cmml" type="integer" xref="lstnumberx6.1.m1.1.1.1.1.1.1.6">1</cn></apply></apply></apply><apply id="lstnumberx6.1.m1.2.2.2.cmml" xref="lstnumberx6.1.m1.2.2.2"><times id="lstnumberx6.1.m1.2.2.2.2.cmml" xref="lstnumberx6.1.m1.2.2.2.2"></times><ci id="lstnumberx6.1.m1.2.2.2.3a.cmml" xref="lstnumberx6.1.m1.2.2.2.3"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.2.2.2.3.cmml" mathbackground="#FFFFFF" mathsize="70%" xref="lstnumberx6.1.m1.2.2.2.3">Proportion</mtext></ci><apply id="lstnumberx6.1.m1.2.2.2.1.1.1.cmml" xref="lstnumberx6.1.m1.2.2.2.1.1"><eq id="lstnumberx6.1.m1.2.2.2.1.1.1.1.cmml" xref="lstnumberx6.1.m1.2.2.2.1.1.1.1"></eq><ci id="lstnumberx6.1.m1.2.2.2.1.1.1.2a.cmml" xref="lstnumberx6.1.m1.2.2.2.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.1.m1.2.2.2.1.1.1.2.cmml" mathbackground="#FFFFFF" mathsize="70%" xref="lstnumberx6.1.m1.2.2.2.1.1.1.2">event j</mtext></ci><cn id="lstnumberx6.1.m1.2.2.2.1.1.1.3.cmml" type="integer" xref="lstnumberx6.1.m1.2.2.2.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx6.1.m1.2c">\frac{{\text{Proportion}}(\text{event i}=1\text{ and }\text{event j}=1)}{{%
\text{Proportion}}(\text{event j}=1)}</annotation><annotation encoding="application/x-llamapun" id="lstnumberx6.1.m1.2d">divide start_ARG Proportion ( event i = 1 typewriter_and typewriter_event typewriter_j = 1 ) end_ARG start_ARG Proportion ( event j = 1 ) end_ARG</annotation></semantics></math></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.20"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.21">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.22"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.2"><math alttext="\frac{\text{number of}(\text{event i}==1\;\text{and}\;\text{event j}==1)}{%
\text{number of all patients}}/\frac{\text{number of}(\text{event j}==1)}{%
\text{number of all patients}}" class="ltx_math_unparsed" display="inline" id="lstnumberx6.2.m1.1"><semantics id="lstnumberx6.2.m1.1a"><mrow id="lstnumberx6.2.m1.1.1"><mfrac id="lstnumberx6.2.m1.1.1.2"><mrow id="lstnumberx6.2.m1.1.1.2.2"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.2.m1.1.1.2.2.1" mathbackground="#FFFFFF">number of</mtext><mrow id="lstnumberx6.2.m1.1.1.2.2.2"><mo id="lstnumberx6.2.m1.1.1.2.2.2.1" mathbackground="#FFFFFF" stretchy="false">(</mo><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.2.m1.1.1.2.2.2.2" mathbackground="#FFFFFF">event i</mtext><mo id="lstnumberx6.2.m1.1.1.2.2.2.3" mathbackground="#FFFFFF" rspace="0em">=</mo><mo id="lstnumberx6.2.m1.1.1.2.2.2.4" lspace="0em" mathbackground="#FFFFFF">=</mo><mn id="lstnumberx6.2.m1.1.1.2.2.2.5" mathbackground="#FFFFFF">1</mn><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.2.m1.1.1.2.2.2.6" mathbackground="#FFFFFF">and</mtext><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.2.m1.1.1.2.2.2.7" mathbackground="#FFFFFF">event j</mtext><mo id="lstnumberx6.2.m1.1.1.2.2.2.8" mathbackground="#FFFFFF" rspace="0em">=</mo><mo id="lstnumberx6.2.m1.1.1.2.2.2.9" lspace="0em" mathbackground="#FFFFFF">=</mo><mn id="lstnumberx6.2.m1.1.1.2.2.2.10" mathbackground="#FFFFFF">1</mn><mo id="lstnumberx6.2.m1.1.1.2.2.2.11" mathbackground="#FFFFFF" stretchy="false">)</mo></mrow></mrow><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.2.m1.1.1.2.3" mathbackground="#FFFFFF">number of all patients</mtext></mfrac><mo id="lstnumberx6.2.m1.1.1.1" mathbackground="#FFFFFF">/</mo><mfrac id="lstnumberx6.2.m1.1.1.3"><mrow id="lstnumberx6.2.m1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.2.m1.1.1.3.2.1" mathbackground="#FFFFFF">number of</mtext><mrow id="lstnumberx6.2.m1.1.1.3.2.2"><mo id="lstnumberx6.2.m1.1.1.3.2.2.1" mathbackground="#FFFFFF" stretchy="false">(</mo><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.2.m1.1.1.3.2.2.2" mathbackground="#FFFFFF">event j</mtext><mo id="lstnumberx6.2.m1.1.1.3.2.2.3" mathbackground="#FFFFFF" rspace="0em">=</mo><mo id="lstnumberx6.2.m1.1.1.3.2.2.4" lspace="0em" mathbackground="#FFFFFF">=</mo><mn id="lstnumberx6.2.m1.1.1.3.2.2.5" mathbackground="#FFFFFF">1</mn><mo id="lstnumberx6.2.m1.1.1.3.2.2.6" mathbackground="#FFFFFF" stretchy="false">)</mo></mrow></mrow><mtext class="ltx_mathvariant_monospace" id="lstnumberx6.2.m1.1.1.3.3" mathbackground="#FFFFFF">number of all patients</mtext></mfrac></mrow><annotation encoding="application/x-tex" id="lstnumberx6.2.m1.1b">\frac{\text{number of}(\text{event i}==1\;\text{and}\;\text{event j}==1)}{%
\text{number of all patients}}/\frac{\text{number of}(\text{event j}==1)}{%
\text{number of all patients}}</annotation><annotation encoding="application/x-llamapun" id="lstnumberx6.2.m1.1c">divide start_ARG number of ( event i = = 1 and event j = = 1 ) end_ARG start_ARG number of all patients end_ARG / divide start_ARG number of ( event j = = 1 ) end_ARG start_ARG number of all patients end_ARG</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.2">For</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.4">each</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.6">patient</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.7">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.8"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.9">generate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.10"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.11">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.13">graph</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.14">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx8.2" style="color:#408080;">#<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.1"> </span>Determine<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.2"> </span>node<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.3"> </span>embeddings<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.4"> </span>based<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.5"> </span>on<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.6"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.7"> </span>patient’s<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.8"> </span>medical<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.9"> </span>event<span class="ltx_text ltx_lst_space" id="lstnumberx8.2.10"> </span>data</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.2">node_embeddings</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.6">event_proportion</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.7"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx9.8" style="color:#0080B3;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.9"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx9.10" style="color:#0080B3;">input</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.12">value</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.13"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.14">==</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.15"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.16">1</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.2">node_embeddings</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.3"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.4">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.5"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.6">1-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.7">event_proportion</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.8"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx10.9" style="color:#0080B3;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.10"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx10.11" style="color:#0080B3;">input</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.12"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.13">value</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.14"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.15">==</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.16"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.17">0</span>
</div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx11.2" style="color:#408080;">#<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.1"> </span>Determine<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.2"> </span>edge<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.3"> </span>weights<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.4"> </span>by<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.5"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.6"> </span>posterior<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.7"> </span>probabilities<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.8"> </span>between<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.9"> </span>each<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.10"> </span>pair<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.11"> </span>of<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.12"> </span>events</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.2">edge_weights</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.4">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.6">edge</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.7"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx12.8" style="color:#0080B3;">from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.9"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.10">node</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.12">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.13"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.14">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.15"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.16">node</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.17"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.18">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.19"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.20">=</span>
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.1"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.2">posterior</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.3"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.4">probability</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.5"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.6">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.7"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.8">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.9">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.10">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.11"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.12">j</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.13">)</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Medication Recommendation</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.3">After <math alttext="K" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_K</annotation></semantics></math> iterations, the last layer updated node feature <math alttext="(h^{\prime}_{\nu},\forall{\nu\in\mathcal{V}})" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml"><mo id="S4.SS3.p1.2.m2.1.1.1.2" stretchy="false" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.2.m2.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml"><mrow id="S4.SS3.p1.2.m2.1.1.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.1.1.2.3.cmml"><msubsup id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.3" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.3.cmml">ν</mi><mo id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.3" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.SS3.p1.2.m2.1.1.1.1.2.2.3" xref="S4.SS3.p1.2.m2.1.1.1.1.2.3.cmml">,</mo><mrow id="S4.SS3.p1.2.m2.1.1.1.1.2.2.2" xref="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.cmml"><mo id="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.1" rspace="0.167em" xref="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.1.cmml">∀</mo><mi id="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.2" xref="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.2.cmml">ν</mi></mrow></mrow><mo id="S4.SS3.p1.2.m2.1.1.1.1.3" xref="S4.SS3.p1.2.m2.1.1.1.1.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.2.m2.1.1.1.1.4" xref="S4.SS3.p1.2.m2.1.1.1.1.4.cmml">𝒱</mi></mrow><mo id="S4.SS3.p1.2.m2.1.1.1.3" stretchy="false" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"><in id="S4.SS3.p1.2.m2.1.1.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.3"></in><list id="S4.SS3.p1.2.m2.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.2.2"><apply id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.1.1.3">𝜈</ci></apply><apply id="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.1">for-all</csymbol><ci id="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.2.2.2.2">𝜈</ci></apply></list><ci id="S4.SS3.p1.2.m2.1.1.1.1.4.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.4">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">(h^{\prime}_{\nu},\forall{\nu\in\mathcal{V}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">( italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_ν end_POSTSUBSCRIPT , ∀ italic_ν ∈ caligraphic_V )</annotation></semantics></math> serves as the output of our graph embedding learning part.
After obtaining the node embeddings <math alttext="h^{\prime}_{\nu}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><msubsup id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2.2" xref="S4.SS3.p1.3.m3.1.1.2.2.cmml">h</mi><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">ν</mi><mo id="S4.SS3.p1.3.m3.1.1.2.3" xref="S4.SS3.p1.3.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">subscript</csymbol><apply id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2.2">ℎ</ci><ci id="S4.SS3.p1.3.m3.1.1.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3">′</ci></apply><ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">𝜈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">h^{\prime}_{\nu}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_ν end_POSTSUBSCRIPT</annotation></semantics></math> for each graph, we concatenate these embeddings to form a single feature vector for each graph. This is represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{\mathcal{G}_{i}}=\oplus_{(\nu\in\mathcal{V})}h^{\prime}_{\nu}," class="ltx_Math" display="block" id="S4.E6.m1.2"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.2.1" xref="S4.E6.m1.2.2.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.1.cmml"><msub id="S4.E6.m1.2.2.1.1.2" xref="S4.E6.m1.2.2.1.1.2.cmml"><mi id="S4.E6.m1.2.2.1.1.2.2" xref="S4.E6.m1.2.2.1.1.2.2.cmml">𝐳</mi><msub id="S4.E6.m1.2.2.1.1.2.3" xref="S4.E6.m1.2.2.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.2.2.1.1.2.3.2" xref="S4.E6.m1.2.2.1.1.2.3.2.cmml">𝒢</mi><mi id="S4.E6.m1.2.2.1.1.2.3.3" xref="S4.E6.m1.2.2.1.1.2.3.3.cmml">i</mi></msub></msub><mo id="S4.E6.m1.2.2.1.1.1" rspace="0em" xref="S4.E6.m1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.2.2.1.1.3" xref="S4.E6.m1.2.2.1.1.3.cmml"><msub id="S4.E6.m1.2.2.1.1.3.1" xref="S4.E6.m1.2.2.1.1.3.1.cmml"><mo id="S4.E6.m1.2.2.1.1.3.1.2" lspace="0em" xref="S4.E6.m1.2.2.1.1.3.1.2.cmml">⊕</mo><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.2.cmml">ν</mi><mo id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml">𝒱</mi></mrow><mo id="S4.E6.m1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></msub><msubsup id="S4.E6.m1.2.2.1.1.3.2" xref="S4.E6.m1.2.2.1.1.3.2.cmml"><mi id="S4.E6.m1.2.2.1.1.3.2.2.2" xref="S4.E6.m1.2.2.1.1.3.2.2.2.cmml">h</mi><mi id="S4.E6.m1.2.2.1.1.3.2.3" xref="S4.E6.m1.2.2.1.1.3.2.3.cmml">ν</mi><mo id="S4.E6.m1.2.2.1.1.3.2.2.3" xref="S4.E6.m1.2.2.1.1.3.2.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S4.E6.m1.2.2.1.2" xref="S4.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.2.1.1.cmml" xref="S4.E6.m1.2.2.1"><eq id="S4.E6.m1.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"></eq><apply id="S4.E6.m1.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.2">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.2.2.cmml" xref="S4.E6.m1.2.2.1.1.2.2">𝐳</ci><apply id="S4.E6.m1.2.2.1.1.2.3.cmml" xref="S4.E6.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.2.3.1.cmml" xref="S4.E6.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.2.3.2.cmml" xref="S4.E6.m1.2.2.1.1.2.3.2">𝒢</ci><ci id="S4.E6.m1.2.2.1.1.2.3.3.cmml" xref="S4.E6.m1.2.2.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.3"><apply id="S4.E6.m1.2.2.1.1.3.1.cmml" xref="S4.E6.m1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.3.1.1.cmml" xref="S4.E6.m1.2.2.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.E6.m1.2.2.1.1.3.1.2.cmml" xref="S4.E6.m1.2.2.1.1.3.1.2">direct-sum</csymbol><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1"><in id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1"></in><ci id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2">𝜈</ci><ci id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3">𝒱</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.3.2.cmml" xref="S4.E6.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.3.2.1.cmml" xref="S4.E6.m1.2.2.1.1.3.2">subscript</csymbol><apply id="S4.E6.m1.2.2.1.1.3.2.2.cmml" xref="S4.E6.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.3.2.2.1.cmml" xref="S4.E6.m1.2.2.1.1.3.2">superscript</csymbol><ci id="S4.E6.m1.2.2.1.1.3.2.2.2.cmml" xref="S4.E6.m1.2.2.1.1.3.2.2.2">ℎ</ci><ci id="S4.E6.m1.2.2.1.1.3.2.2.3.cmml" xref="S4.E6.m1.2.2.1.1.3.2.2.3">′</ci></apply><ci id="S4.E6.m1.2.2.1.1.3.2.3.cmml" xref="S4.E6.m1.2.2.1.1.3.2.3">𝜈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">\mathbf{z}_{\mathcal{G}_{i}}=\oplus_{(\nu\in\mathcal{V})}h^{\prime}_{\nu},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.2d">bold_z start_POSTSUBSCRIPT caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT = ⊕ start_POSTSUBSCRIPT ( italic_ν ∈ caligraphic_V ) end_POSTSUBSCRIPT italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_ν end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p1.9">where <math alttext="\mathbf{z}_{\mathcal{G}_{i}}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m1.1"><semantics id="S4.SS3.p1.4.m1.1a"><msub id="S4.SS3.p1.4.m1.1.1" xref="S4.SS3.p1.4.m1.1.1.cmml"><mi id="S4.SS3.p1.4.m1.1.1.2" xref="S4.SS3.p1.4.m1.1.1.2.cmml">𝐳</mi><msub id="S4.SS3.p1.4.m1.1.1.3" xref="S4.SS3.p1.4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.4.m1.1.1.3.2" xref="S4.SS3.p1.4.m1.1.1.3.2.cmml">𝒢</mi><mi id="S4.SS3.p1.4.m1.1.1.3.3" xref="S4.SS3.p1.4.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m1.1b"><apply id="S4.SS3.p1.4.m1.1.1.cmml" xref="S4.SS3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m1.1.1.1.cmml" xref="S4.SS3.p1.4.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m1.1.1.2.cmml" xref="S4.SS3.p1.4.m1.1.1.2">𝐳</ci><apply id="S4.SS3.p1.4.m1.1.1.3.cmml" xref="S4.SS3.p1.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m1.1.1.3.1.cmml" xref="S4.SS3.p1.4.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.4.m1.1.1.3.2.cmml" xref="S4.SS3.p1.4.m1.1.1.3.2">𝒢</ci><ci id="S4.SS3.p1.4.m1.1.1.3.3.cmml" xref="S4.SS3.p1.4.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m1.1c">\mathbf{z}_{\mathcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m1.1d">bold_z start_POSTSUBSCRIPT caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is the concatenated feature vector for graph <math alttext="\mathcal{G}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m2.1"><semantics id="S4.SS3.p1.5.m2.1a"><msub id="S4.SS3.p1.5.m2.1.1" xref="S4.SS3.p1.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.5.m2.1.1.2" xref="S4.SS3.p1.5.m2.1.1.2.cmml">𝒢</mi><mi id="S4.SS3.p1.5.m2.1.1.3" xref="S4.SS3.p1.5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m2.1b"><apply id="S4.SS3.p1.5.m2.1.1.cmml" xref="S4.SS3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.1.1.1.cmml" xref="S4.SS3.p1.5.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m2.1.1.2.cmml" xref="S4.SS3.p1.5.m2.1.1.2">𝒢</ci><ci id="S4.SS3.p1.5.m2.1.1.3.cmml" xref="S4.SS3.p1.5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m2.1c">\mathcal{G}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m2.1d">caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\oplus" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m3.1"><semantics id="S4.SS3.p1.6.m3.1a"><mo id="S4.SS3.p1.6.m3.1.1" xref="S4.SS3.p1.6.m3.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m3.1b"><csymbol cd="latexml" id="S4.SS3.p1.6.m3.1.1.cmml" xref="S4.SS3.p1.6.m3.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m3.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m3.1d">⊕</annotation></semantics></math> denotes the concatenation operation over all nodes (i.e., medical events).
The concatenated feature vectors <math alttext="\mathbf{z}_{\mathcal{G}_{i}}" class="ltx_Math" display="inline" id="S4.SS3.p1.7.m4.1"><semantics id="S4.SS3.p1.7.m4.1a"><msub id="S4.SS3.p1.7.m4.1.1" xref="S4.SS3.p1.7.m4.1.1.cmml"><mi id="S4.SS3.p1.7.m4.1.1.2" xref="S4.SS3.p1.7.m4.1.1.2.cmml">𝐳</mi><msub id="S4.SS3.p1.7.m4.1.1.3" xref="S4.SS3.p1.7.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.7.m4.1.1.3.2" xref="S4.SS3.p1.7.m4.1.1.3.2.cmml">𝒢</mi><mi id="S4.SS3.p1.7.m4.1.1.3.3" xref="S4.SS3.p1.7.m4.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m4.1b"><apply id="S4.SS3.p1.7.m4.1.1.cmml" xref="S4.SS3.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m4.1.1.1.cmml" xref="S4.SS3.p1.7.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.7.m4.1.1.2.cmml" xref="S4.SS3.p1.7.m4.1.1.2">𝐳</ci><apply id="S4.SS3.p1.7.m4.1.1.3.cmml" xref="S4.SS3.p1.7.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m4.1.1.3.1.cmml" xref="S4.SS3.p1.7.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.7.m4.1.1.3.2.cmml" xref="S4.SS3.p1.7.m4.1.1.3.2">𝒢</ci><ci id="S4.SS3.p1.7.m4.1.1.3.3.cmml" xref="S4.SS3.p1.7.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m4.1c">\mathbf{z}_{\mathcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.7.m4.1d">bold_z start_POSTSUBSCRIPT caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for each graph are then passed through a linear projection for classification. The linear layer has <math alttext="Y" class="ltx_Math" display="inline" id="S4.SS3.p1.8.m5.1"><semantics id="S4.SS3.p1.8.m5.1a"><mi id="S4.SS3.p1.8.m5.1.1" xref="S4.SS3.p1.8.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m5.1b"><ci id="S4.SS3.p1.8.m5.1.1.cmml" xref="S4.SS3.p1.8.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m5.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.8.m5.1d">italic_Y</annotation></semantics></math> independent output dimensions, each corresponding to a binary classification task. Formally, for each output dimension <math alttext="y" class="ltx_Math" display="inline" id="S4.SS3.p1.9.m6.1"><semantics id="S4.SS3.p1.9.m6.1a"><mi id="S4.SS3.p1.9.m6.1.1" xref="S4.SS3.p1.9.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m6.1b"><ci id="S4.SS3.p1.9.m6.1.1.cmml" xref="S4.SS3.p1.9.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.9.m6.1d">italic_y</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{o}_{y}=\text{sigmoid}\left(\text{Linear}\left(\mathbf{z}_{\mathcal{G}_%
{i}}\right)\right)" class="ltx_Math" display="block" id="S4.E7.m1.1"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><msub id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.3.2" xref="S4.E7.m1.1.1.3.2.cmml">𝐨</mi><mi id="S4.E7.m1.1.1.3.3" xref="S4.E7.m1.1.1.3.3.cmml">y</mi></msub><mo id="S4.E7.m1.1.1.2" xref="S4.E7.m1.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml"><mtext id="S4.E7.m1.1.1.1.3" xref="S4.E7.m1.1.1.1.3a.cmml">sigmoid</mtext><mo id="S4.E7.m1.1.1.1.2" xref="S4.E7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mtext id="S4.E7.m1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.3a.cmml">Linear</mtext><mo id="S4.E7.m1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E7.m1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><msub id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒢</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><eq id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1.2"></eq><apply id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.3.2">𝐨</ci><ci id="S4.E7.m1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.3.3">𝑦</ci></apply><apply id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><times id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.2"></times><ci id="S4.E7.m1.1.1.1.3a.cmml" xref="S4.E7.m1.1.1.1.3"><mtext id="S4.E7.m1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.3">sigmoid</mtext></ci><apply id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><times id="S4.E7.m1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.2"></times><ci id="S4.E7.m1.1.1.1.1.1.1.3a.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3"><mtext id="S4.E7.m1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3">Linear</mtext></ci><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.2">𝒢</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">\mathbf{o}_{y}=\text{sigmoid}\left(\text{Linear}\left(\mathbf{z}_{\mathcal{G}_%
{i}}\right)\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.1d">bold_o start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT = sigmoid ( Linear ( bold_z start_POSTSUBSCRIPT caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{r}_{y}=\begin{cases}1&amp;\text{if }\mathbf{o}_{y}&gt;0.5\\
0&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="block" id="S4.E8.m1.4"><semantics id="S4.E8.m1.4a"><mrow id="S4.E8.m1.4.5" xref="S4.E8.m1.4.5.cmml"><msub id="S4.E8.m1.4.5.2" xref="S4.E8.m1.4.5.2.cmml"><mi id="S4.E8.m1.4.5.2.2" xref="S4.E8.m1.4.5.2.2.cmml">𝐫</mi><mi id="S4.E8.m1.4.5.2.3" xref="S4.E8.m1.4.5.2.3.cmml">y</mi></msub><mo id="S4.E8.m1.4.5.1" xref="S4.E8.m1.4.5.1.cmml">=</mo><mrow id="S4.E8.m1.4.4" xref="S4.E8.m1.4.5.3.1.cmml"><mo id="S4.E8.m1.4.4.5" xref="S4.E8.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E8.m1.4.4.4" rowspacing="0pt" xref="S4.E8.m1.4.5.3.1.cmml"><mtr id="S4.E8.m1.4.4.4a" xref="S4.E8.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.4.4.4b" xref="S4.E8.m1.4.5.3.1.cmml"><mn id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.4.4.4c" xref="S4.E8.m1.4.5.3.1.cmml"><mrow id="S4.E8.m1.2.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.2.1.cmml"><mrow id="S4.E8.m1.2.2.2.2.2.1.2" xref="S4.E8.m1.2.2.2.2.2.1.2.cmml"><mtext id="S4.E8.m1.2.2.2.2.2.1.2.2" xref="S4.E8.m1.2.2.2.2.2.1.2.2a.cmml">if </mtext><mo id="S4.E8.m1.2.2.2.2.2.1.2.1" xref="S4.E8.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><msub id="S4.E8.m1.2.2.2.2.2.1.2.3" xref="S4.E8.m1.2.2.2.2.2.1.2.3.cmml"><mi id="S4.E8.m1.2.2.2.2.2.1.2.3.2" xref="S4.E8.m1.2.2.2.2.2.1.2.3.2.cmml">𝐨</mi><mi id="S4.E8.m1.2.2.2.2.2.1.2.3.3" xref="S4.E8.m1.2.2.2.2.2.1.2.3.3.cmml">y</mi></msub></mrow><mo id="S4.E8.m1.2.2.2.2.2.1.1" xref="S4.E8.m1.2.2.2.2.2.1.1.cmml">&gt;</mo><mn id="S4.E8.m1.2.2.2.2.2.1.3" xref="S4.E8.m1.2.2.2.2.2.1.3.cmml">0.5</mn></mrow></mtd></mtr><mtr id="S4.E8.m1.4.4.4d" xref="S4.E8.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.4.4.4e" xref="S4.E8.m1.4.5.3.1.cmml"><mn id="S4.E8.m1.3.3.3.3.1.1" xref="S4.E8.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.4.4.4f" xref="S4.E8.m1.4.5.3.1.cmml"><mtext id="S4.E8.m1.4.4.4.4.2.1" xref="S4.E8.m1.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.4b"><apply id="S4.E8.m1.4.5.cmml" xref="S4.E8.m1.4.5"><eq id="S4.E8.m1.4.5.1.cmml" xref="S4.E8.m1.4.5.1"></eq><apply id="S4.E8.m1.4.5.2.cmml" xref="S4.E8.m1.4.5.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.5.2.1.cmml" xref="S4.E8.m1.4.5.2">subscript</csymbol><ci id="S4.E8.m1.4.5.2.2.cmml" xref="S4.E8.m1.4.5.2.2">𝐫</ci><ci id="S4.E8.m1.4.5.2.3.cmml" xref="S4.E8.m1.4.5.2.3">𝑦</ci></apply><apply id="S4.E8.m1.4.5.3.1.cmml" xref="S4.E8.m1.4.4"><csymbol cd="latexml" id="S4.E8.m1.4.5.3.1.1.cmml" xref="S4.E8.m1.4.4.5">cases</csymbol><cn id="S4.E8.m1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E8.m1.1.1.1.1.1.1">1</cn><apply id="S4.E8.m1.2.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.2.1"><gt id="S4.E8.m1.2.2.2.2.2.1.1.cmml" xref="S4.E8.m1.2.2.2.2.2.1.1"></gt><apply id="S4.E8.m1.2.2.2.2.2.1.2.cmml" xref="S4.E8.m1.2.2.2.2.2.1.2"><times id="S4.E8.m1.2.2.2.2.2.1.2.1.cmml" xref="S4.E8.m1.2.2.2.2.2.1.2.1"></times><ci id="S4.E8.m1.2.2.2.2.2.1.2.2a.cmml" xref="S4.E8.m1.2.2.2.2.2.1.2.2"><mtext id="S4.E8.m1.2.2.2.2.2.1.2.2.cmml" xref="S4.E8.m1.2.2.2.2.2.1.2.2">if </mtext></ci><apply id="S4.E8.m1.2.2.2.2.2.1.2.3.cmml" xref="S4.E8.m1.2.2.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.2.1.2.3.1.cmml" xref="S4.E8.m1.2.2.2.2.2.1.2.3">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.2.1.2.3.2.cmml" xref="S4.E8.m1.2.2.2.2.2.1.2.3.2">𝐨</ci><ci id="S4.E8.m1.2.2.2.2.2.1.2.3.3.cmml" xref="S4.E8.m1.2.2.2.2.2.1.2.3.3">𝑦</ci></apply></apply><cn id="S4.E8.m1.2.2.2.2.2.1.3.cmml" type="float" xref="S4.E8.m1.2.2.2.2.2.1.3">0.5</cn></apply><cn id="S4.E8.m1.3.3.3.3.1.1.cmml" type="integer" xref="S4.E8.m1.3.3.3.3.1.1">0</cn><ci id="S4.E8.m1.4.4.4.4.2.1a.cmml" xref="S4.E8.m1.4.4.4.4.2.1"><mtext id="S4.E8.m1.4.4.4.4.2.1.cmml" xref="S4.E8.m1.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.4c">\mathbf{r}_{y}=\begin{cases}1&amp;\text{if }\mathbf{o}_{y}&gt;0.5\\
0&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.4d">bold_r start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT = { start_ROW start_CELL 1 end_CELL start_CELL if bold_o start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT &gt; 0.5 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.2">Upon processing graph feature vectors <math alttext="\mathbf{z}_{\mathcal{G}_{i}}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">𝐳</mi><msub id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">𝒢</mi><mi id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝐳</ci><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">𝒢</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\mathbf{z}_{\mathcal{G}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">bold_z start_POSTSUBSCRIPT caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, the system yields <math alttext="Y" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_Y</annotation></semantics></math> independent outputs. Each of these outputs corresponds explicitly to the decision to recommend drugs.
The decision is binary: either the medication is recommended (represented by a value of 1) or not (denoted by 0).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Databases</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We evaluated <span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">BernGraph</span> on two large-scale datasets: the Medical Information Mart for Intensive Care (MIMIC-III) dataset and the Antimicrobial Resistance in Urinary Tract Infections (AMR-UTI).
Both databases have been extensively utilized for benchmarking and are available on PhysioNet.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">- <span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">MIMIC-III</span> represents a vast repository of de-identified health data from intensive care unit (ICU) patients at the Beth Israel Deaconess Medical Center in Boston, Massachusetts <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib10" title="">2016</a>)</cite>.
It contains a total of 46520 patients from 2001 to 2012.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">- <span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">AMR-UTI</span> dataset contains EHR information collected from 51878 patients from 2007 to 2016, with urinary tract infections (UTI) treated at Massachusetts General Hospital and Brigham &amp; Women’s Hospital in Boston, MA, USA <cite class="ltx_cite ltx_citemacro_citep">(Michael et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib14" title="">2020</a>)</cite>.
This dataset provided a series of binary indicators for whether a patient was undergoing a specific medical event.
There are four common antibiotics (medication labels): nitrofurantoin (NIT), TMP-SMX (SXT), ciprofloxacin (CIP), or levofloxacin (LVX).
</p>
</div>
<div class="ltx_para" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.T1" title="Table 1 ‣ 5.1 Databases ‣ 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">1</span></a> shows some statistics on two databases.
The sparsity of a matrix can be calculated using the formula: <math alttext="Sparsity=1-\frac{\text{Number of Non-Zero Elements}}{\text{Total Number of %
Elements}}" class="ltx_Math" display="inline" id="S5.SS1.p4.1.m1.1"><semantics id="S5.SS1.p4.1.m1.1a"><mrow id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml"><mrow id="S5.SS1.p4.1.m1.1.1.2" xref="S5.SS1.p4.1.m1.1.1.2.cmml"><mi id="S5.SS1.p4.1.m1.1.1.2.2" xref="S5.SS1.p4.1.m1.1.1.2.2.cmml">S</mi><mo id="S5.SS1.p4.1.m1.1.1.2.1" xref="S5.SS1.p4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.p4.1.m1.1.1.2.3" xref="S5.SS1.p4.1.m1.1.1.2.3.cmml">p</mi><mo id="S5.SS1.p4.1.m1.1.1.2.1a" xref="S5.SS1.p4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.p4.1.m1.1.1.2.4" xref="S5.SS1.p4.1.m1.1.1.2.4.cmml">a</mi><mo id="S5.SS1.p4.1.m1.1.1.2.1b" xref="S5.SS1.p4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.p4.1.m1.1.1.2.5" xref="S5.SS1.p4.1.m1.1.1.2.5.cmml">r</mi><mo id="S5.SS1.p4.1.m1.1.1.2.1c" xref="S5.SS1.p4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.p4.1.m1.1.1.2.6" xref="S5.SS1.p4.1.m1.1.1.2.6.cmml">s</mi><mo id="S5.SS1.p4.1.m1.1.1.2.1d" xref="S5.SS1.p4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.p4.1.m1.1.1.2.7" xref="S5.SS1.p4.1.m1.1.1.2.7.cmml">i</mi><mo id="S5.SS1.p4.1.m1.1.1.2.1e" xref="S5.SS1.p4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.p4.1.m1.1.1.2.8" xref="S5.SS1.p4.1.m1.1.1.2.8.cmml">t</mi><mo id="S5.SS1.p4.1.m1.1.1.2.1f" xref="S5.SS1.p4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.p4.1.m1.1.1.2.9" xref="S5.SS1.p4.1.m1.1.1.2.9.cmml">y</mi></mrow><mo id="S5.SS1.p4.1.m1.1.1.1" xref="S5.SS1.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S5.SS1.p4.1.m1.1.1.3" xref="S5.SS1.p4.1.m1.1.1.3.cmml"><mn id="S5.SS1.p4.1.m1.1.1.3.2" xref="S5.SS1.p4.1.m1.1.1.3.2.cmml">1</mn><mo id="S5.SS1.p4.1.m1.1.1.3.1" xref="S5.SS1.p4.1.m1.1.1.3.1.cmml">−</mo><mfrac id="S5.SS1.p4.1.m1.1.1.3.3" xref="S5.SS1.p4.1.m1.1.1.3.3.cmml"><mtext id="S5.SS1.p4.1.m1.1.1.3.3.2" xref="S5.SS1.p4.1.m1.1.1.3.3.2a.cmml">Number of Non-Zero Elements</mtext><mtext id="S5.SS1.p4.1.m1.1.1.3.3.3" xref="S5.SS1.p4.1.m1.1.1.3.3.3a.cmml">Total Number of Elements</mtext></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><apply id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1"><eq id="S5.SS1.p4.1.m1.1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1.1"></eq><apply id="S5.SS1.p4.1.m1.1.1.2.cmml" xref="S5.SS1.p4.1.m1.1.1.2"><times id="S5.SS1.p4.1.m1.1.1.2.1.cmml" xref="S5.SS1.p4.1.m1.1.1.2.1"></times><ci id="S5.SS1.p4.1.m1.1.1.2.2.cmml" xref="S5.SS1.p4.1.m1.1.1.2.2">𝑆</ci><ci id="S5.SS1.p4.1.m1.1.1.2.3.cmml" xref="S5.SS1.p4.1.m1.1.1.2.3">𝑝</ci><ci id="S5.SS1.p4.1.m1.1.1.2.4.cmml" xref="S5.SS1.p4.1.m1.1.1.2.4">𝑎</ci><ci id="S5.SS1.p4.1.m1.1.1.2.5.cmml" xref="S5.SS1.p4.1.m1.1.1.2.5">𝑟</ci><ci id="S5.SS1.p4.1.m1.1.1.2.6.cmml" xref="S5.SS1.p4.1.m1.1.1.2.6">𝑠</ci><ci id="S5.SS1.p4.1.m1.1.1.2.7.cmml" xref="S5.SS1.p4.1.m1.1.1.2.7">𝑖</ci><ci id="S5.SS1.p4.1.m1.1.1.2.8.cmml" xref="S5.SS1.p4.1.m1.1.1.2.8">𝑡</ci><ci id="S5.SS1.p4.1.m1.1.1.2.9.cmml" xref="S5.SS1.p4.1.m1.1.1.2.9">𝑦</ci></apply><apply id="S5.SS1.p4.1.m1.1.1.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3"><minus id="S5.SS1.p4.1.m1.1.1.3.1.cmml" xref="S5.SS1.p4.1.m1.1.1.3.1"></minus><cn id="S5.SS1.p4.1.m1.1.1.3.2.cmml" type="integer" xref="S5.SS1.p4.1.m1.1.1.3.2">1</cn><apply id="S5.SS1.p4.1.m1.1.1.3.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3.3"><divide id="S5.SS1.p4.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p4.1.m1.1.1.3.3"></divide><ci id="S5.SS1.p4.1.m1.1.1.3.3.2a.cmml" xref="S5.SS1.p4.1.m1.1.1.3.3.2"><mtext id="S5.SS1.p4.1.m1.1.1.3.3.2.cmml" mathsize="70%" xref="S5.SS1.p4.1.m1.1.1.3.3.2">Number of Non-Zero Elements</mtext></ci><ci id="S5.SS1.p4.1.m1.1.1.3.3.3a.cmml" xref="S5.SS1.p4.1.m1.1.1.3.3.3"><mtext id="S5.SS1.p4.1.m1.1.1.3.3.3.cmml" mathsize="70%" xref="S5.SS1.p4.1.m1.1.1.3.3.3">Total Number of Elements</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">Sparsity=1-\frac{\text{Number of Non-Zero Elements}}{\text{Total Number of %
Elements}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.1.m1.1d">italic_S italic_p italic_a italic_r italic_s italic_i italic_t italic_y = 1 - divide start_ARG Number of Non-Zero Elements end_ARG start_ARG Total Number of Elements end_ARG</annotation></semantics></math>.
The high degree of sparsity observed in the feature dimensions for both the MIMIC-III and AMR-URI datasets may constitute a significant impediment to the efficacy of the machine learning models.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S5.T1.3.2" style="font-size:90%;">Datasets description</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T1.4.1.1.1">Dataset</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.4.1.1.2">MIMIC</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.4.1.1.3">AMR-URI</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.4.2.2.1">#Patients</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.2.2.2">46250</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.2.2.3">51878</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.4.3.3.1">Avg. event sequence length</th>
<td class="ltx_td ltx_align_center" id="S5.T1.4.3.3.2">3388</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.3.3.3">692</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.4.4.4.1">#Drug candidate</th>
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.4.2">131</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.4.3">4</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.4.5.5.1">The Sparsity of event seq.</th>
<td class="ltx_td ltx_align_center" id="S5.T1.4.5.5.2">0.9946</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.5.5.3">0.9309</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T1.4.6.6.1">Sparsity of label</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.4.6.6.2">0.8534</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.4.6.6.3">0.5423</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p5.1.1">Data preprocessing.</span>
For MIMIC-III, we referred to the data processing released by <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib36" title="">2021b</a>; Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite> for fairness.
Only the patients with at least 2 visits are incorporated.
The medications were selected and retained based on their frequency of occurrence (the top 300).
For AMR-URI, we first excluded the basic demographic information including age and ethnicity.
The observations that do not have any health event or drug recommendation were removed.
For each observation, a feature was constructed from its EHR as a binary indicator for whether the patient is undergoing a particular medical event within a specified time window.
After the above preprocessing, we divided both datasets into training, validation and testing by the ratio of 3/5, 1/5, and 1/5.
More detailed description of data processing can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1" title="Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.4.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.5.2" style="font-size:90%;">Performance Comparison on MIMIC-III and AMR-UTI.
Best results are highlighted in <span class="ltx_text ltx_font_bold" id="S5.T2.5.2.1">bold fonts</span>, second-best results are <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.2.2">underscored</span>.
The results (-) denote models that do not converge.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.6" style="width:424.9pt;height:160.5pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.7pt,28.1pt) scale(0.739910711474679,0.739910711474679) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T2.6.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6" id="S5.T2.6.1.1.1.2">MIMIC</th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S5.T2.6.1.1.1.3"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S5.T2.6.1.1.1.4">AMR-UTI</th>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" id="S5.T2.6.1.2.2.1">Baseline</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T2.6.1.2.2.2">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.1.2.2.3">Jaccard</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.1.2.2.4">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.1.2.2.5">PRAUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.1.2.2.6">AUROC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T2.6.1.2.2.7">#Drug</th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T2.6.1.2.2.8"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.1.2.2.9">Jaccard</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.1.2.2.10">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.1.2.2.11">PRAUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.1.2.2.12">AUROC</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T2.6.1.2.2.13">#Drug</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.6.1.3.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.6.1.3.1.1">LR</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.6.1.3.1.2">Stat</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.1.3">0.4865</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.1.4">0.6434</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.1.5">0.7509</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.1.6">0.9180</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.1.7">16.1773</td>
<td class="ltx_td ltx_border_t" id="S5.T2.6.1.3.1.8"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.1.9">0.3803</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.1.10">0.5018</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.1.11">0.4624</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.1.12">0.5057</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.6.1.3.1.13">1.4869</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.4.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.6.1.4.2.1">ECC</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.4.2.2">Stat</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.4.2.3">0.4996</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.4.2.4">0.6569</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.4.2.5">0.6844</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.4.2.6">0.9098</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.4.2.7">18.0722</td>
<td class="ltx_td" id="S5.T2.6.1.4.2.8"></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.4.2.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.6.1.4.2.9.1">0.6080</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.4.2.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.6.1.4.2.10.1">0.6665</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.4.2.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.6.1.4.2.11.1">0.6914</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.4.2.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.6.1.4.2.12.1">0.7273</span></td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.4.2.13">1.7040</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.5.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.6.1.5.3.1">RETAIN</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.5.3.2">RNN</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.3.3">0.4877</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.3.4">0.6481</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.3.5">0.7556</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.3.6">0.9234</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.3.7">20.4051</td>
<td class="ltx_td" id="S5.T2.6.1.5.3.8"></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.3.9">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.3.10">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.3.11">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.3.12">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.5.3.13">-</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.6.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.6.1.6.4.1">LEAP</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.6.4.2">RNN</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.4.3">0.4521</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.4.4">0.6138</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.4.5">0.6549</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.4.6">0.8927</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.4.7">18.7138</td>
<td class="ltx_td" id="S5.T2.6.1.6.4.8"></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.4.9">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.4.10">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.4.11">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.4.12">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.6.4.13">-</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.7.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.6.1.7.5.1">DMNC</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.7.5.2">RNN</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.5.3">0.4864</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.5.4">0.6529</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.5.5">0.7580</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.5.6">0.9157</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.5.7">20.0000</td>
<td class="ltx_td" id="S5.T2.6.1.7.5.8"></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.5.9">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.5.10">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.5.11">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.5.12">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.7.5.13">-</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.8.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.6.1.8.6.1">SafeDrug</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.8.6.2">RNN</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.8.6.3">0.5213</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.8.6.4">0.6768</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.8.6.5">0.7647</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.8.6.6">0.9219</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.8.6.7">19.9178</td>
<td class="ltx_td" id="S5.T2.6.1.8.6.8"></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.8.6.9">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.8.6.10">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.8.6.11">-</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.8.6.12">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.8.6.13">-</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.9.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.6.1.9.7.1">GAMENet</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.9.7.2">Graph</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.7.3">0.5067</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.7.4">0.6626</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.7.5">0.7631</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.7.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.6.1.9.7.6.1">0.9237</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.7.7">27.2145</td>
<td class="ltx_td" id="S5.T2.6.1.9.7.8"></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.7.9">0.6024</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.7.10">0.6433</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.7.11">0.6913</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.7.12">0.7174</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.9.7.13">1.7106</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.10.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.6.1.10.8.1">COGNet</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.10.8.2">Graph</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.8.3">0.5336</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.8.4">0.6869</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.8.5">0.7739</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.8.6">0.9218</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.8.7">28.0903</td>
<td class="ltx_td" id="S5.T2.6.1.10.8.8"></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.8.9">0.5287</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.8.10">0.6359</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.8.11">0.5717</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.8.12">0.6281</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.10.8.13">1.6331</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.11.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.6.1.11.9.1">MT-GIN</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.11.9.2">Graph</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.9.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.6.1.11.9.3.1">0.5401</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.9.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.6.1.11.9.4.1">0.7781</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.9.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.6.1.11.9.5.1">0.7812</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.9.6">0.9115</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.9.7">16.1233</td>
<td class="ltx_td" id="S5.T2.6.1.11.9.8"></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.9.9">0.5137</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.9.10">0.6124</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.9.11">0.6779</td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.9.12">0.6428</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.1.11.9.13">1.4991</td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.12.10">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.6.1.12.10.1"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.1.1">BernGraph</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.2">Graph</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.3"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.3.1">0.5887</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.4"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.4.1">0.8459</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.5"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.5.1">0.8442</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.6"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.6.1">0.9632</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.6.1.12.10.7">15.7129</td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.8"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.9"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.9.1">0.6116</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.10"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.10.1">0.6753</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.11"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.11.1">0.7071</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.12"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.12.10.12.1">0.7401</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T2.6.1.12.10.13">1.5973</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Baselines</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">- <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">Statistics-based methods:</span> We use standard Logistic Regression (LR) and Ensemble Classifier Chain (ECC) <cite class="ltx_cite ltx_citemacro_citep">(Read et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib20" title="">2009</a>)</cite> as baselines.
- <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.2">RNN-based methods:</span> RETAIN <cite class="ltx_cite ltx_citemacro_citep">(Choi et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib3" title="">2016a</a>)</cite> applies two-level attention with gating for key clinical variables. LEAP <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib38" title="">2017</a>)</cite> uses an LSTM-based model with reinforcement learning to avoid adverse drug combinations. DMNC <cite class="ltx_cite ltx_citemacro_citep">(Le et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib11" title="">2018</a>)</cite> introduces a memory-augmented network to enhance patient encoding.
- <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.3">GNN-based methods:</span> GAMENet <cite class="ltx_cite ltx_citemacro_citep">(Shang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib22" title="">2019</a>)</cite> incorporates Drug-Drug Interaction (DDI) knowledge using graph convolutional networks. SafeDrug <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib36" title="">2021b</a>)</cite> combines the drug molecular graph with DDI to predict safe medication combinations. Using a Conditional Generation Net, COGNet <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib33" title="">2022</a>)</cite> mines relationships between historical and current diagnoses. MI-GIN <cite class="ltx_cite ltx_citemacro_citep">(Shu et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib23" title="">2023</a>)</cite> directly models EHR data using a graph isomorphism neural network for medication recommendation.
- <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.4">Evaluation:</span> We evaluated models using the Jaccard Similarity Score, Average F1, AUROC, Precision-Recall AUC, and average predicted number of drugs (#Drug), averaging results overall for patients. Precision and Recall were also used to assess recommendation performance. Parameter settings are detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A2" title="Appendix B Model Parameters ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="181" id="S5.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.3.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S5.F3.4.2" style="font-size:90%;">
Comparison between <span class="ltx_text ltx_font_bold" id="S5.F3.4.2.1">BernGraph</span> and baselines using four widely adopted metrics (Jaccard, Avg of Drug, Recall, Precision) on MIMIC III for medication recommendation analysis.
</span></figcaption>
</figure>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.13.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.14.2" style="font-size:90%;">
An ablation study on embeddings is conducted to validate the contributions of the proposed embedding approach.
The best-performings are highlighted in <span class="ltx_text ltx_font_bold" id="S5.T3.14.2.1">bold</span>, while the second-best results are <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.14.2.2">underscored</span>.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T3.9" style="width:433.6pt;height:191.4pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-69.8pt,30.7pt) scale(0.756422762773391,0.756422762773391) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T3.9.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.9.9.10.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T3.9.9.10.1.1">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S5.T3.9.9.10.1.2">MIMIC</td>
<td class="ltx_td ltx_border_tt" id="S5.T3.9.9.10.1.3"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S5.T3.9.9.10.1.4">AMR-UTI</td>
</tr>
<tr class="ltx_tr" id="S5.T3.9.9.11.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.9.9.11.2.1">Metrics</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.11.2.2">Jaccard</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.11.2.3">F1</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.11.2.4">PRAUC</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.11.2.5">AUROC</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.9.9.11.2.6">#Drug</td>
<td class="ltx_td" id="S5.T3.9.9.11.2.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.11.2.8">Jaccard</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.11.2.9">F1</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.11.2.10">PRAUC</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.11.2.11">AUROC</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.11.2.12">#Drug</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T3.1.1.1.1">BM <math alttext="w/o" class="ltx_Math" display="inline" id="S5.T3.1.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.1.m1.1a"><mrow id="S5.T3.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.cmml"><mi id="S5.T3.1.1.1.1.m1.1.1.2" xref="S5.T3.1.1.1.1.m1.1.1.2.cmml">w</mi><mo id="S5.T3.1.1.1.1.m1.1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.1.cmml">/</mo><mi id="S5.T3.1.1.1.1.m1.1.1.3" xref="S5.T3.1.1.1.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><apply id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1"><divide id="S5.T3.1.1.1.1.m1.1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1.1"></divide><ci id="S5.T3.1.1.1.1.m1.1.1.2.cmml" xref="S5.T3.1.1.1.1.m1.1.1.2">𝑤</ci><ci id="S5.T3.1.1.1.1.m1.1.1.3.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.1.m1.1d">italic_w / italic_o</annotation></semantics></math> Post</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.2">0.5482</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.1.1.1.3.1">0.8275</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.4">0.151</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.1.1.1.5.1">0.9542</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.1.1.6">15.1754</td>
<td class="ltx_td ltx_border_t" id="S5.T3.1.1.1.7"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.1.1.1.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.1.1.1.8.1">0.6109</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.1.1.1.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.1.1.1.9.1">0.6750</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.1.1.1.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.1.1.1.10.1">0.7066</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.1.1.1.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.1.1.1.11.1">0.7378</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.1.1.1.12">1.5966</td>
</tr>
<tr class="ltx_tr" id="S5.T3.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.2.2.2.1">LLR <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.T3.2.2.2.1.m1.1"><semantics id="S5.T3.2.2.2.1.m1.1a"><mrow id="S5.T3.2.2.2.1.m1.1b"><mi id="S5.T3.2.2.2.1.m1.1.1">w</mi><mo id="S5.T3.2.2.2.1.m1.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.T3.2.2.2.1.m1.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.2.2.1.m1.1d">italic_w /</annotation></semantics></math> Post</td>
<td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.2">0.5398</td>
<td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.3">0.8234</td>
<td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.2.2.2.4.1">0.8104</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.5">0.9527</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.2.2.6">14.8922</td>
<td class="ltx_td" id="S5.T3.2.2.2.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.2.2.2.8">0.6091</td>
<td class="ltx_td ltx_align_left" id="S5.T3.2.2.2.9">0.6748</td>
<td class="ltx_td ltx_align_left" id="S5.T3.2.2.2.10">0.7052</td>
<td class="ltx_td ltx_align_left" id="S5.T3.2.2.2.11">0.7322</td>
<td class="ltx_td ltx_align_left" id="S5.T3.2.2.2.12">1.5990</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.3.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.3.3.3.1">LLR <math alttext="w/o" class="ltx_Math" display="inline" id="S5.T3.3.3.3.1.m1.1"><semantics id="S5.T3.3.3.3.1.m1.1a"><mrow id="S5.T3.3.3.3.1.m1.1.1" xref="S5.T3.3.3.3.1.m1.1.1.cmml"><mi id="S5.T3.3.3.3.1.m1.1.1.2" xref="S5.T3.3.3.3.1.m1.1.1.2.cmml">w</mi><mo id="S5.T3.3.3.3.1.m1.1.1.1" xref="S5.T3.3.3.3.1.m1.1.1.1.cmml">/</mo><mi id="S5.T3.3.3.3.1.m1.1.1.3" xref="S5.T3.3.3.3.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.1.m1.1b"><apply id="S5.T3.3.3.3.1.m1.1.1.cmml" xref="S5.T3.3.3.3.1.m1.1.1"><divide id="S5.T3.3.3.3.1.m1.1.1.1.cmml" xref="S5.T3.3.3.3.1.m1.1.1.1"></divide><ci id="S5.T3.3.3.3.1.m1.1.1.2.cmml" xref="S5.T3.3.3.3.1.m1.1.1.2">𝑤</ci><ci id="S5.T3.3.3.3.1.m1.1.1.3.cmml" xref="S5.T3.3.3.3.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.3.3.1.m1.1d">italic_w / italic_o</annotation></semantics></math> Post</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.2">0.4367</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.3">0.7717</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.4">0.7265</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.5">0.242</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.3.3.6">12.7554</td>
<td class="ltx_td" id="S5.T3.3.3.3.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.3.3.3.8">0.6089</td>
<td class="ltx_td ltx_align_left" id="S5.T3.3.3.3.9">0.6732</td>
<td class="ltx_td ltx_align_left" id="S5.T3.3.3.3.10">0.7048</td>
<td class="ltx_td ltx_align_left" id="S5.T3.3.3.3.11">0.7318</td>
<td class="ltx_td ltx_align_left" id="S5.T3.3.3.3.12">1.5964</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.4.4.4.1">TE <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.T3.4.4.4.1.m1.1"><semantics id="S5.T3.4.4.4.1.m1.1a"><mrow id="S5.T3.4.4.4.1.m1.1b"><mi id="S5.T3.4.4.4.1.m1.1.1">w</mi><mo id="S5.T3.4.4.4.1.m1.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.T3.4.4.4.1.m1.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.T3.4.4.4.1.m1.1d">italic_w /</annotation></semantics></math> Post</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.2">0.3904</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.3">0.7475</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.4">0.6947</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.5">0.9116</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.4.4.6">11.7528</td>
<td class="ltx_td" id="S5.T3.4.4.4.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.4.4.4.8">0.0186</td>
<td class="ltx_td ltx_align_left" id="S5.T3.4.4.4.9">0.3580</td>
<td class="ltx_td ltx_align_left" id="S5.T3.4.4.4.10">0.4961</td>
<td class="ltx_td ltx_align_left" id="S5.T3.4.4.4.11">0.5387</td>
<td class="ltx_td ltx_align_left" id="S5.T3.4.4.4.12">0.0172</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.5.5.5.1">TE <math alttext="w/o" class="ltx_Math" display="inline" id="S5.T3.5.5.5.1.m1.1"><semantics id="S5.T3.5.5.5.1.m1.1a"><mrow id="S5.T3.5.5.5.1.m1.1.1" xref="S5.T3.5.5.5.1.m1.1.1.cmml"><mi id="S5.T3.5.5.5.1.m1.1.1.2" xref="S5.T3.5.5.5.1.m1.1.1.2.cmml">w</mi><mo id="S5.T3.5.5.5.1.m1.1.1.1" xref="S5.T3.5.5.5.1.m1.1.1.1.cmml">/</mo><mi id="S5.T3.5.5.5.1.m1.1.1.3" xref="S5.T3.5.5.5.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.1.m1.1b"><apply id="S5.T3.5.5.5.1.m1.1.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1"><divide id="S5.T3.5.5.5.1.m1.1.1.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1.1"></divide><ci id="S5.T3.5.5.5.1.m1.1.1.2.cmml" xref="S5.T3.5.5.5.1.m1.1.1.2">𝑤</ci><ci id="S5.T3.5.5.5.1.m1.1.1.3.cmml" xref="S5.T3.5.5.5.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.T3.5.5.5.1.m1.1d">italic_w / italic_o</annotation></semantics></math> Post</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.5.5.2">0.3904</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.5.5.3">0.7475</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.5.5.4">0.6947</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.5.5.5">0.9116</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.5.5.6">11.7528</td>
<td class="ltx_td" id="S5.T3.5.5.5.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.5.5.5.8">0.0001</td>
<td class="ltx_td ltx_align_left" id="S5.T3.5.5.5.9">0.3507</td>
<td class="ltx_td ltx_align_left" id="S5.T3.5.5.5.10">0.4595</td>
<td class="ltx_td ltx_align_left" id="S5.T3.5.5.5.11">0.5000</td>
<td class="ltx_td ltx_align_left" id="S5.T3.5.5.5.12">0.0001</td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.6.6.6.1">BM <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.T3.6.6.6.1.m1.1"><semantics id="S5.T3.6.6.6.1.m1.1a"><mrow id="S5.T3.6.6.6.1.m1.1b"><mi id="S5.T3.6.6.6.1.m1.1.1">w</mi><mo id="S5.T3.6.6.6.1.m1.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.T3.6.6.6.1.m1.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.T3.6.6.6.1.m1.1d">italic_w /</annotation></semantics></math> RE</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.6.6.6.2.1">0.5692</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.3">0.8261</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.4">0.8230</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.5">0.9428</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.6.6.6.6">15.8093</td>
<td class="ltx_td" id="S5.T3.6.6.6.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.6.6.8">0.6019</td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.6.6.9">0.6579</td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.6.6.10">0.6881</td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.6.6.11">0.7218</td>
<td class="ltx_td ltx_align_left" id="S5.T3.6.6.6.12">1.6220</td>
</tr>
<tr class="ltx_tr" id="S5.T3.7.7.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.7.7.7.1">RN <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.T3.7.7.7.1.m1.1"><semantics id="S5.T3.7.7.7.1.m1.1a"><mrow id="S5.T3.7.7.7.1.m1.1b"><mi id="S5.T3.7.7.7.1.m1.1.1">w</mi><mo id="S5.T3.7.7.7.1.m1.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.T3.7.7.7.1.m1.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.T3.7.7.7.1.m1.1d">italic_w /</annotation></semantics></math> Post</td>
<td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.2">0.2941</td>
<td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.3">0.6674</td>
<td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.4">0.4902</td>
<td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.5">0.8174</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.7.7.7.6">24.8895</td>
<td class="ltx_td" id="S5.T3.7.7.7.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.7.7.7.8">0.5974</td>
<td class="ltx_td ltx_align_left" id="S5.T3.7.7.7.9">0.3554</td>
<td class="ltx_td ltx_align_left" id="S5.T3.7.7.7.10">0.4685</td>
<td class="ltx_td ltx_align_left" id="S5.T3.7.7.7.11">0.4776</td>
<td class="ltx_td ltx_align_left" id="S5.T3.7.7.7.12">2.9293</td>
</tr>
<tr class="ltx_tr" id="S5.T3.8.8.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.8.8.8.1">RN <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.T3.8.8.8.1.m1.1"><semantics id="S5.T3.8.8.8.1.m1.1a"><mrow id="S5.T3.8.8.8.1.m1.1b"><mi id="S5.T3.8.8.8.1.m1.1.1">w</mi><mo id="S5.T3.8.8.8.1.m1.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.T3.8.8.8.1.m1.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.T3.8.8.8.1.m1.1d">italic_w /</annotation></semantics></math> RE</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.8.8.2">0.2932</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.8.8.3">0.6640</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.8.8.4">0.4899</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.8.8.5">0.8075</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.8.8.8.6">24.8788</td>
<td class="ltx_td" id="S5.T3.8.8.8.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.8.8.8.8">0.5963</td>
<td class="ltx_td ltx_align_left" id="S5.T3.8.8.8.9">0.3530</td>
<td class="ltx_td ltx_align_left" id="S5.T3.8.8.8.10">0.4601</td>
<td class="ltx_td ltx_align_left" id="S5.T3.8.8.8.11">0.4744</td>
<td class="ltx_td ltx_align_left" id="S5.T3.8.8.8.12">2.9275</td>
</tr>
<tr class="ltx_tr" id="S5.T3.9.9.12.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T3.9.9.12.3.1">MLP backbone</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.9.12.3.2">0.3926</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.9.12.3.3">0.7484</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.9.12.3.4">0.6871</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.9.12.3.5">0.8948</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.9.9.12.3.6">12.0562</td>
<td class="ltx_td ltx_border_t" id="S5.T3.9.9.12.3.7"></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.9.9.12.3.8">0.5667</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.9.9.12.3.9">0.6685</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.9.9.12.3.10">0.6945</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.9.9.12.3.11">0.7137</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.9.9.12.3.12">1.4853</td>
</tr>
<tr class="ltx_tr" id="S5.T3.9.9.13.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.9.9.13.4.1">LSTM backbone</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.13.4.2">0.3868</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.13.4.3">0.7454</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.13.4.4">0.6940</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.13.4.5">0.9102</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.9.9.13.4.6">11.4403</td>
<td class="ltx_td" id="S5.T3.9.9.13.4.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.13.4.8">0.5352</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.13.4.9">0.6491</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.13.4.10">0.6810</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.13.4.11">0.7217</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.13.4.12">1.3640</td>
</tr>
<tr class="ltx_tr" id="S5.T3.9.9.14.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T3.9.9.14.5.1">Transformer backbone</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.14.5.2">0.3907</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.14.5.3">0.7475</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.14.5.4">0.6867</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.9.14.5.5">0.8996</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.9.9.14.5.6">11.9148</td>
<td class="ltx_td" id="S5.T3.9.9.14.5.7"></td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.14.5.8">0.5100</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.14.5.9">0.3512</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.14.5.10">0.4662</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.14.5.11">0.5088</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.9.14.5.12">1.3470</td>
</tr>
<tr class="ltx_tr" id="S5.T3.9.9.9">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S5.T3.9.9.9.1">
<span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.1.2">Ours</span> (<span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.1.1">BM <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.T3.9.9.9.1.1.m1.1"><semantics id="S5.T3.9.9.9.1.1.m1.1a"><mrow id="S5.T3.9.9.9.1.1.m1.1b"><mi id="S5.T3.9.9.9.1.1.m1.1.1">w</mi><mo id="S5.T3.9.9.9.1.1.m1.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.T3.9.9.9.1.1.m1.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.T3.9.9.9.1.1.m1.1d">italic_w /</annotation></semantics></math> Post</span>)</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.2"><span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.2.1">0.5887</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.3"><span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.3.1">0.8459</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.4"><span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.4.1">0.8442</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.5"><span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.5.1">0.9632</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T3.9.9.9.6">15.7129</td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.7"></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.8"><span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.8.1">0.6116</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.9"><span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.9.1">0.6753</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.10"><span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.10.1">0.7071</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.11"><span class="ltx_text ltx_font_bold" id="S5.T3.9.9.9.11.1">0.7401</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T3.9.9.9.12">1.5973</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Ablation Study</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.9">We evaluated different node/edge modeling methods, with our key contribution being the transformation of binary medical events into continuous Bernoulli means. We compared <span class="ltx_text ltx_font_bold" id="S5.SS3.p1.9.1">BernGraph</span> with two classic encoding methods, Log Likelihood Ratio (LLR) and Target Encoding (TE) <cite class="ltx_cite ltx_citemacro_citep">(Rodríguez et al., <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib21" title="">2018</a>)</cite> (details in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A3" title="Appendix C Metrics ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">C</span></a>). Additionally, we performed ablation studies using random node/edge initialization and assessed <span class="ltx_text ltx_font_bold" id="S5.SS3.p1.9.2">BernGraph</span> without node or edge construction.
We evaluated several variations of our method. BM <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1b"><mi id="S5.SS3.p1.1.m1.1.1">w</mi><mo id="S5.SS3.p1.1.m1.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_w /</annotation></semantics></math> Post is our proposed approach. BM <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">w</mi><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">/</mo><mi id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><divide id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></divide><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝑤</ci><ci id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_w / italic_o</annotation></semantics></math> Post uses simple co-occurrence for edge embeddings. LLR <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.SS3.p1.3.m3.1"><semantics id="S5.SS3.p1.3.m3.1a"><mrow id="S5.SS3.p1.3.m3.1b"><mi id="S5.SS3.p1.3.m3.1.1">w</mi><mo id="S5.SS3.p1.3.m3.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.3.m3.1d">italic_w /</annotation></semantics></math> Post replaces Bernoulli means with LLR for node embeddings, while LLR <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p1.4.m4.1"><semantics id="S5.SS3.p1.4.m4.1a"><mrow id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml"><mi id="S5.SS3.p1.4.m4.1.1.2" xref="S5.SS3.p1.4.m4.1.1.2.cmml">w</mi><mo id="S5.SS3.p1.4.m4.1.1.1" xref="S5.SS3.p1.4.m4.1.1.1.cmml">/</mo><mi id="S5.SS3.p1.4.m4.1.1.3" xref="S5.SS3.p1.4.m4.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><apply id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1"><divide id="S5.SS3.p1.4.m4.1.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1.1"></divide><ci id="S5.SS3.p1.4.m4.1.1.2.cmml" xref="S5.SS3.p1.4.m4.1.1.2">𝑤</ci><ci id="S5.SS3.p1.4.m4.1.1.3.cmml" xref="S5.SS3.p1.4.m4.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.4.m4.1d">italic_w / italic_o</annotation></semantics></math> Post uses LLR for both. TE <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.SS3.p1.5.m5.1"><semantics id="S5.SS3.p1.5.m5.1a"><mrow id="S5.SS3.p1.5.m5.1b"><mi id="S5.SS3.p1.5.m5.1.1">w</mi><mo id="S5.SS3.p1.5.m5.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.5.m5.1d">italic_w /</annotation></semantics></math> Post and TE <math alttext="w/o" class="ltx_Math" display="inline" id="S5.SS3.p1.6.m6.1"><semantics id="S5.SS3.p1.6.m6.1a"><mrow id="S5.SS3.p1.6.m6.1.1" xref="S5.SS3.p1.6.m6.1.1.cmml"><mi id="S5.SS3.p1.6.m6.1.1.2" xref="S5.SS3.p1.6.m6.1.1.2.cmml">w</mi><mo id="S5.SS3.p1.6.m6.1.1.1" xref="S5.SS3.p1.6.m6.1.1.1.cmml">/</mo><mi id="S5.SS3.p1.6.m6.1.1.3" xref="S5.SS3.p1.6.m6.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m6.1b"><apply id="S5.SS3.p1.6.m6.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1"><divide id="S5.SS3.p1.6.m6.1.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1.1"></divide><ci id="S5.SS3.p1.6.m6.1.1.2.cmml" xref="S5.SS3.p1.6.m6.1.1.2">𝑤</ci><ci id="S5.SS3.p1.6.m6.1.1.3.cmml" xref="S5.SS3.p1.6.m6.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m6.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.6.m6.1d">italic_w / italic_o</annotation></semantics></math> Post follow a similar pattern with Target Encoding. BM <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.SS3.p1.7.m7.1"><semantics id="S5.SS3.p1.7.m7.1a"><mrow id="S5.SS3.p1.7.m7.1b"><mi id="S5.SS3.p1.7.m7.1.1">w</mi><mo id="S5.SS3.p1.7.m7.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.p1.7.m7.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.7.m7.1d">italic_w /</annotation></semantics></math> RE uses random edge initialization, and RN <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.SS3.p1.8.m8.1"><semantics id="S5.SS3.p1.8.m8.1a"><mrow id="S5.SS3.p1.8.m8.1b"><mi id="S5.SS3.p1.8.m8.1.1">w</mi><mo id="S5.SS3.p1.8.m8.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.p1.8.m8.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.8.m8.1d">italic_w /</annotation></semantics></math> Post and RN <math alttext="w/" class="ltx_math_unparsed" display="inline" id="S5.SS3.p1.9.m9.1"><semantics id="S5.SS3.p1.9.m9.1a"><mrow id="S5.SS3.p1.9.m9.1b"><mi id="S5.SS3.p1.9.m9.1.1">w</mi><mo id="S5.SS3.p1.9.m9.1.2">/</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.p1.9.m9.1c">w/</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.9.m9.1d">italic_w /</annotation></semantics></math> RE replace node or both node/edge embeddings with random initialization. We also conducted ablation studies comparing GNN event-event modeling with MLP, LSTM, and Transformer. Details are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A4" title="Appendix D Implementation Details ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Results</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Comparison Against Baselines</h3>
<div class="ltx_para ltx_noindent" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p1.1.1">Main Results.</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.T2" title="Table 2 ‣ 5.1 Databases ‣ 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">2</span></a> presents the main results for medication recommendation on two datasets. Our proposed <span class="ltx_text ltx_font_bold" id="S6.SS1.p1.1.2">BernGraph</span> outperforms all baselines across all metrics (Jaccard, F1, PRAUC, AUROC), particularly excelling on the MIMIC-III dataset, even against models using additional data and visit modeling. Statistical models like LR and ECC surpass early RNN-based methods (LEAP, DMNC, RETAIN), highlighting the strong performance of ECC. RNN models struggle with missing or inconsistent historical data, while graph-based methods perform better by modeling event-event correlations, showing the effectiveness of modeling event-event correlations and structure information. <span class="ltx_text ltx_font_bold" id="S6.SS1.p1.1.3">BernGraph</span>, based solely on binary events, could improve by incorporating external EHR data like DDI.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p2.1.1">Visit-Included Results.</span>
The results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.T2" title="Table 2 ‣ 5.1 Databases ‣ 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">2</span></a> exclude information derived from patient visits. To provide a more comprehensive assessment incorporating visit data, we present an average recommendation performance across all patient visits in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6.T4" title="Table 4 ‣ 6.1 Comparison Against Baselines ‣ 6 Results ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">4</span></a>.
Specifically, some of the baseline methods rely on sequential learning.
In these approaches, every medication is allocated a recommendation probability upon generation in each visit.
We first average their performance over visits for each patient and then further average these results across all patients.
In this context, <span class="ltx_text ltx_font_bold" id="S6.SS1.p2.1.2">BernGraph</span> shows an effective and robust performance and outperforms all baselines.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p3.1.1">Medication Recommendation Analysis.</span>
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.F3" title="Figure 3 ‣ 5.2 Baselines ‣ 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">3</span></a> extensively compares Precision and Recall metrics for medication recommendation.
We employ several evaluation metrics to compare <span class="ltx_text ltx_font_bold" id="S6.SS1.p3.1.2">BernGraph</span> against existing methods.
The False Positive (FP) issue arises when the system suggests unnecessary drugs, leading to high recall but low precision.
Conversely, False Negatives (FN) occur when beneficial drugs are missed, resulting in low recall but potentially high precision.
As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.F3" title="Figure 3 ‣ 5.2 Baselines ‣ 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">3</span></a>, we provide 15.7129 recommendations on average, and the ground truth for MIMIC-III is 19.2268.
This reflects that our method can recommend fewer but more precise drugs, maintaining competitive recall.</p>
</div>
<figure class="ltx_table" id="S6.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T4.5.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S6.T4.6.2" style="font-size:90%;">Comparison when visiting information is included on MIMIC-III. Though <span class="ltx_text ltx_font_bold" id="S6.T4.6.2.1">BernGraph</span> is not explicitly designed to incorporate secondary information, it outperforms existing visiting-aware methods when evaluated on the same benchmarks. <span class="ltx_text ltx_font_bold" id="S6.T4.6.2.2">Bold</span>: best; <span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.6.2.3">underscored</span>: second-best.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T4.7" style="width:216.8pt;height:146.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-38.0pt,25.7pt) scale(0.740491323361556,0.740491323361556) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T4.7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T4.7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S6.T4.7.1.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.7.1.1.1.2">Jaccard</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.7.1.1.1.3">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.7.1.1.1.4">PRAUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.7.1.1.1.5">AUROC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.7.1.1.1.6">#Drug</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T4.7.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T4.7.1.2.1.1">LR</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.7.1.2.1.2">0.4844</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.7.1.2.1.3">0.6483</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.7.1.2.1.4">0.7492</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.7.1.2.1.5">0.9029</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.7.1.2.1.6">16.1221</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.7.1.3.2.1">ECC</th>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.3.2.2">0.5003</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.3.2.3">0.6590</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.3.2.4">0.6802</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.3.2.5">0.9214</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.3.2.6">18.4127</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.7.1.4.3.1">RETAIN</th>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.4.3.2">0.4876</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.4.3.3">0.6484</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.4.3.4">0.7594</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.4.3.5">0.9225</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.4.3.6">19.8297</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.7.1.5.4.1">LEAP</th>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.5.4.2">0.4487</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.5.4.3">0.6119</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.5.4.4">0.6480</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.5.4.5">0.8927</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.5.4.6">19.1095</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.7.1.6.5.1">DMNC</th>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.6.5.2">0.4834</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.6.5.3">0.6492</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.6.5.4">0.7569</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.6.5.5">0.9237</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.6.5.6">20.1087</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.7.1.7.6.1">GAMENet</th>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.7.6.2">0.5084</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.7.6.3">0.6648</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.7.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.7.1.7.6.4.1">0.7670</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.7.6.5">0.9235</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.7.6.6">26.1983</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.7.1.8.7.1">SafeDrug</th>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.8.7.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.7.1.8.7.2.1">0.5276</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.8.7.3">0.6692</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.8.7.4">0.7649</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.8.7.5">0.9218</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.8.7.6">19.8847</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.7.1.9.8.1">COGNet</th>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.9.8.2">0.5127</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.9.8.3">0.6850</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.9.8.4">0.7739</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.9.8.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.7.1.9.8.5.1">0.9266</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.9.8.6">27.3277</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T4.7.1.10.9.1">MT-GIN</th>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.10.9.2">0.5273</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.10.9.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.7.1.10.9.3.1">0.7527</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.10.9.4">0.7499</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.10.9.5">0.9188</td>
<td class="ltx_td ltx_align_center" id="S6.T4.7.1.10.9.6">15.1233</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.1.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S6.T4.7.1.11.10.1"><span class="ltx_text ltx_font_bold" id="S6.T4.7.1.11.10.1.1">Proposed</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T4.7.1.11.10.2"><span class="ltx_text ltx_font_bold" id="S6.T4.7.1.11.10.2.1">0.5902</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T4.7.1.11.10.3"><span class="ltx_text ltx_font_bold" id="S6.T4.7.1.11.10.3.1">0.8465</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T4.7.1.11.10.4"><span class="ltx_text ltx_font_bold" id="S6.T4.7.1.11.10.4.1">0.8448</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T4.7.1.11.10.5"><span class="ltx_text ltx_font_bold" id="S6.T4.7.1.11.10.5.1">0.9635</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T4.7.1.11.10.6">15.6944</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Ablation Study</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.T3" title="Table 3 ‣ 5.2 Baselines ‣ 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">3</span></a> shows that combining Bernoulli mean node embedding with posterior probability edge embedding yields the best results.
If we compare the contributions of node (Bernoulli mean) and edge (posterior probability) embeddings to the graph-based drug recommendation results, we find that node embedding has a relatively more substantial impact.
The random node destroys the recommendation performance even when considering posterior probabilities, resulting in a low Jaccard score of 0.29.
However, using the Bernoulli mean for edge initialization yields a much higher Jaccard score of 0.5692.
This could be because node embedding directly represents the original EHR data, while edges are inferred based on the original data to model the relationship between different events.
Therefore, edge embeddings merely aid in GNN computations.
The results show that even without initializing edge embeddings with posterior probabilities, GNN can still capture event-event correlations, though with a performance decrease.
For model ablation, GNN outperforms all baselines.
</p>
</div>
<figure class="ltx_figure" id="S6.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="178" id="S6.F4.g1" src="x4.png" width="374"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S6.F4.3.2" style="font-size:90%;">Feature visualization:
Each node denotes an event, and edges represent event-event correlations.
A thicker edge shows a stronger event-event association, highlighting higher-value nodes.
</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Visualization of Recommendations</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6.F4" title="Figure 4 ‣ 6.2 Ablation Study ‣ 6 Results ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">4</span></a> shows GNN-learned representations for two patients on a subset of EHR events.
We highlight the top nodes with the highest feature values by TOP-K, revealing that GNN captures distinct representations for each patient.
For example, the "Hyperlipidemia" node is more prominent in Patient B than in Patient A, indicating greater relevance.
GNN also learns key feature connections, with certain event series highlighted in Patient B.
This demonstrates the ability of GNN to differentiate between patients and provide valuable insights for downstream tasks.
</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">This paper introduces <span class="ltx_text ltx_font_bold" id="S7.p1.1.1">BernGraph</span>, a novel approach that transforms sparse 0/1 binary event sequences in EHRs into continuous Bernoulli means. Viewing EHR data as samples from a population, we modeled GNN nodes and edges using the Bernoulli distribution.
Our method outperformed all baselines, including those using more extensive data like visit records and drug-drug interactions.
Ablation studies confirmed the importance of Bernoulli transformation, with node-based Bernoulli means contributing significantly to performance, even with random edges.
This work presents a promising direction for handling sparse binary sequences in EHRs, potentially improving various healthcare prediction tasks.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bache et al. (2013)</span>
<span class="ltx_bibblock">
Richard Bache et al.

</span>
<span class="ltx_bibblock">An adaptable architecture for patient cohort identification from diverse data sources.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">JAMIA</em>, pages 327–333, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhave and Perotte (2021)</span>
<span class="ltx_bibblock">
Shreyas Bhave and Adler Perotte.

</span>
<span class="ltx_bibblock">Point processes for competing observations with recurrent networks (popcorn): A generative model of ehr data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">ML4H</em>, pages 770–789, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al. (2016a)</span>
<span class="ltx_bibblock">
Ed Choi et al.

</span>
<span class="ltx_bibblock">RETAIN: an interpretable predictive model for healthcare using reverse time attention mechanism.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">NIPS</em>, pages 3504–3512, 2016a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al. (2020)</span>
<span class="ltx_bibblock">
Ed Choi et al.

</span>
<span class="ltx_bibblock">Learning the graphical structure of electronic health records with graph convolutional transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">AAAI</em>, pages 606–613, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al. (2016b)</span>
<span class="ltx_bibblock">
Edward Choi et al.

</span>
<span class="ltx_bibblock">Doctor ai: Predicting clinical events via recurrent neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">ML4H</em>, pages 301–318, 2016b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al. (2017)</span>
<span class="ltx_bibblock">
Edward Choi et al.

</span>
<span class="ltx_bibblock">Generating multi-label discrete patient records using generative adversarial networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">ML4H</em>, pages 286–305, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">D and Stepniewska (1999)</span>
<span class="ltx_bibblock">
Collett D and K Stepniewska.

</span>
<span class="ltx_bibblock">Some practical issues in binary data analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Statistics in medicine</em>, pages 17–18, 1999.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dunning (1994)</span>
<span class="ltx_bibblock">
Ted Dunning.

</span>
<span class="ltx_bibblock">Accurate methods for the statistics of surprise and coincidence.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Computational linguistics</em>, pages 61–74, 1994.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. (2021)</span>
<span class="ltx_bibblock">
Fan Gong et al.

</span>
<span class="ltx_bibblock">SMR: medical knowledge graph embedding for safe medicine recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Big Data Res</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2016)</span>
<span class="ltx_bibblock">
Alistair E. W. Johnson et al.

</span>
<span class="ltx_bibblock">Mimic-iii, a freely accessible critical care database.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Scientific Data</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le et al. (2018)</span>
<span class="ltx_bibblock">
Hung Le et al.

</span>
<span class="ltx_bibblock">Dual memory neural computer for asynchronous two-view sequential learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">KDD</em>, pages 1637–1645, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lo et al. (2022)</span>
<span class="ltx_bibblock">
Wai Weng Lo et al.

</span>
<span class="ltx_bibblock">E-graphsage: A graph neural network based intrusion detection system for iot.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">NOMS</em>, pages 1–9, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo (2022)</span>
<span class="ltx_bibblock">
Yuan Luo.

</span>
<span class="ltx_bibblock">Evaluating the state of the art in missing data imputation for clinical data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Briefings in Bioinformatics</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Michael et al. (2020)</span>
<span class="ltx_bibblock">
Oberst Michael et al.

</span>
<span class="ltx_bibblock">Amr-uti: Antimicrobial resistance in urinary tract infections (version 1.0.0).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">PhysioNet</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miotto et al. (2016)</span>
<span class="ltx_bibblock">
Riccardo Miotto, Li Li, Brian A Kidd, and Joel T Dudley.

</span>
<span class="ltx_bibblock">Deep patient: an unsupervised representation to predict the future of patients from the electronic health records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Scientific reports</em>, pages 1–10, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">M.M. et al. (2015)</span>
<span class="ltx_bibblock">
Yardley M.M. et al.

</span>
<span class="ltx_bibblock">Pharmacological options for smoking cessation in heavy-drinking smokers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">CNS Drugs</em>, page 833–845, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Murphy (2023)</span>
<span class="ltx_bibblock">
Kevin P Murphy.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Probabilistic machine learning: Advanced topics</em>.

</span>
<span class="ltx_bibblock">MIT press, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al. (2016)</span>
<span class="ltx_bibblock">
Phuoc Nguyen et al.

</span>
<span class="ltx_bibblock">Deepr: a convolutional net for medical records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">IEEE JBHI</em>, pages 22–30, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Poulakis et al. (2022)</span>
<span class="ltx_bibblock">
Konstantinos Poulakis et al.

</span>
<span class="ltx_bibblock">Multi-cohort and longitudinal bayesian clustering study of stage and subtype in alzheimer’s disease.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Nature com</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Read et al. (2009)</span>
<span class="ltx_bibblock">
Jesse Read et al.

</span>
<span class="ltx_bibblock">Classifier chains for multi-label classification.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">ECML-PKDD</em>, pages 254–269, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rodríguez et al. (2018)</span>
<span class="ltx_bibblock">
Pau Rodríguez et al.

</span>
<span class="ltx_bibblock">Beyond one-hot encoding: Lower dimensional target embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Image and Vision Computing</em>, pages 21–31, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang et al. (2019)</span>
<span class="ltx_bibblock">
Junyuan Shang et al.

</span>
<span class="ltx_bibblock">Gamenet: Graph augmented memory networks for recommending medication combination.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">AAAI</em>, pages 1126–1133, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shu et al. (2023)</span>
<span class="ltx_bibblock">
Honglin Shu et al.

</span>
<span class="ltx_bibblock">Drugs resistance analysis from scarce health records via multi-task graph representation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">ADMA</em>, page 103–117, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh et al. (2015)</span>
<span class="ltx_bibblock">
A Singh et al.

</span>
<span class="ltx_bibblock">Incorporating temporal ehr data in predictive models for risk stratification of renal function deterioration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">JBI</em>, pages 220–228, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2020)</span>
<span class="ltx_bibblock">
Chenhao Su, Sheng Gao, and Si Li.

</span>
<span class="ltx_bibblock">Gate: graph-attention augmented temporal neural network for medication recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">IEEE Access</em>, pages 125447–125458, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2012)</span>
<span class="ltx_bibblock">
Jimeng Sun et al.

</span>
<span class="ltx_bibblock">Supervised patient similarity measure of heterogeneous patient records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Acm SIGKDD Explorations Newsletter</em>, pages 16–24, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022)</span>
<span class="ltx_bibblock">
Yanchao Tan et al.

</span>
<span class="ltx_bibblock">4sdrug: Symptom-based set-to-set small and safe drug recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">KDD</em>, pages 3970–3980, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tran et al. (2021)</span>
<span class="ltx_bibblock">
Thi Ngoc Trang Tran et al.

</span>
<span class="ltx_bibblock">Recommender systems in the healthcare domain: state-of-the-art and research issues.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Journal of Intelligent Information Systems</em>, pages 1–31, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verstrepen et al. (2017)</span>
<span class="ltx_bibblock">
Koen Verstrepen et al.

</span>
<span class="ltx_bibblock">Collaborative filtering for binary, positiveonly data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">SIGKDD Explor. Newsl.</em>, page 1–21, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">W et al. (2019)</span>
<span class="ltx_bibblock">
Shanshan W et al.

</span>
<span class="ltx_bibblock">Order-free medicine combination prediction with graph convolutional reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">CIKM</em>, pages 1623–1632, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2018)</span>
<span class="ltx_bibblock">
Lu Wang et al.

</span>
<span class="ltx_bibblock">Supervised reinforcement learning with recurrent neural network for dynamic treatment recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">KDD</em>, pages 2447–2456, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wharrie et al. (2023)</span>
<span class="ltx_bibblock">
Sophie Wharrie, Zhiyu Yang, Andrea Ganna, and Samuel Kaski.

</span>
<span class="ltx_bibblock">Characterizing personalized effects of family information on disease risk using graph representation learning.

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2022)</span>
<span class="ltx_bibblock">
Rui Wu, Zhaopeng Qiu, Jiacheng Jiang, Guilin Qi, , and Xian Wu.

</span>
<span class="ltx_bibblock">Conditional generation net for medication recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">WWW</em>, page 935–945, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiang et al. (2019)</span>
<span class="ltx_bibblock">
Yang Xiang et al.

</span>
<span class="ltx_bibblock">Time-sensitive clinical concept embeddings learned from large electronic health records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">BMC MIDM</em>, pages 139–148, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2021a)</span>
<span class="ltx_bibblock">
Chaoqi Yang et al.

</span>
<span class="ltx_bibblock">Change matters: Medication change prediction with recurrent residual networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">IJCAI</em>, pages 3728–3734, 2021a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2021b)</span>
<span class="ltx_bibblock">
Chaoqi Yang et al.

</span>
<span class="ltx_bibblock">Safedrug: Dual molecular graph encoders for safe drug recommendations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">IJCAI</em>, 2021b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2021)</span>
<span class="ltx_bibblock">
Qing Ye et al.

</span>
<span class="ltx_bibblock">A unified drug–target interaction prediction framework based on knowledge graph and recommendation system.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Nature communications</em>, pages 67–75, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2017)</span>
<span class="ltx_bibblock">
Yutao Zhang et al.

</span>
<span class="ltx_bibblock">LEAP: learning to prescribe effective and safe treatment combinations for multimorbidity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">KDD</em>, pages 1315–1324, 2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">{adjustwidth}</span>
<p class="ltx_p" id="p2.2">1cm1cm</p>
</div>
<div class="ltx_para" id="id1">
<p class="ltx_p ltx_align_center" id="id1.1"><span class="ltx_text ltx_font_bold" id="id1.1.1" style="font-size:173%;">BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations
<br class="ltx_break"/>  
<br class="ltx_break"/>————Appendix————</span></p>
</div>
<nav class="ltx_TOC ltx_centering ltx_list_toc ltx_toc_toc"><h6 class="ltx_title ltx_title_contents">Contents</h6>
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S1" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S2" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S3" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Problem Formulation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S3.SS1" title="In 3 Problem Formulation ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Recommendation System Based on EHR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S3.SS2" title="In 3 Problem Formulation ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>EHR as a Sample from the Population</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4.SS1" title="In 4 Methodology ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Patient-Event Graph Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4.SS2" title="In 4 Methodology ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Patient-to-Event Graph Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S4.SS3" title="In 4 Methodology ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Medication Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.SS1" title="In 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Databases</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.SS2" title="In 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.SS3" title="In 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6.SS1" title="In 6 Results ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Comparison Against Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6.SS2" title="In 6 Results ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S6.SS3" title="In 6 Results ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Visualization of Recommendations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S7" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Preprocessing</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS1" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Data Profile</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS2" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Medication Data Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS3" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Diagnosis Data Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS4" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Procedure Data Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A1.SS5" title="In Appendix A Preprocessing ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Data Integration</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A2" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Model Parameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A3" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A4" title="In BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Implementation Details</span></a></li>
</ol></nav>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Preprocessing</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Data Profile</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p1.1.1">Data Sources</span>:
The data is sourced from the MIMIC dataset, a publicly available dataset developed by the MIT Lab for Computational Physiology, comprising de-identified health data from over 40,000 critical care patients. The primary datasets in focus for preprocessing include:</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.1">Medications (‘PRESCRIPTIONS.csv‘): Contains records of medications prescribed to patients during their ICU stays.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1">Diagnoses (‘DIAGNOSES ICD.csv‘): Lists diagnosis codes associated with each hospital admission.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1">Procedures (‘PROCEDURES ICD.csv‘): Catalog procedures that patients underwent during their hospital visits.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="A1.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p2.1.1">Data Structure</span>:
The data is structured in tabular format. Each table contains unique identifiers for patients (‘SUBJECT ID‘), their specific hospital admissions (‘HADM ID‘), and other clinical details pertinent to the dataset in question.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Medication Data Preprocessing</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p1.1.1">Data Loading and Initial Processing</span>:</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i1.p1">
<p class="ltx_p" id="A1.I2.i1.p1.1">Load the Data: The medication data from ‘PRESCRIPTIONS.csv‘ is loaded into a data frame.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i2.p1">
<p class="ltx_p" id="A1.I2.i2.p1.1">Filter Columns: Only essential columns, namely ‘pid‘, ‘adm id‘, ‘date‘, and ‘NDC‘, are retained.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i3.p1">
<p class="ltx_p" id="A1.I2.i3.p1.1">Data Cleaning: Entries with ’NDC’ equal to ’0’ are dropped, and any missing values are filled using the forward-fill method.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i4.p1">
<p class="ltx_p" id="A1.I2.i4.p1.1">Data Transformation: The ‘STARTDATE‘ field is converted to a DateTime format for easier manipulation and analysis.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i5.p1">
<p class="ltx_p" id="A1.I2.i5.p1.1">Sorting and Deduplication: The dataset is sorted by multiple columns, including ‘SUBJECT ID‘, ‘HADM ID‘, and ‘STARTDATE‘, and any duplicate entries are removed.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p3.1.1">Medication Code Mapping</span>:</p>
</div>
<div class="ltx_para" id="A1.SS2.p4">
<ul class="ltx_itemize" id="A1.I3">
<li class="ltx_item" id="A1.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I3.i1.p1">
<p class="ltx_p" id="A1.I3.i1.p1.1">Mapping NDC to RXCUI: The ‘NDC‘ codes are mapped to the ‘RXCUI‘ identifiers using a separate mapping file.</p>
</div>
</li>
<li class="ltx_item" id="A1.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I3.i2.p1">
<p class="ltx_p" id="A1.I3.i2.p1.1">Mapping RXCUI to ATC4: The ‘RXCUI‘ identifiers are further mapped to the ‘ATC4‘ codes using another mapping file. The ATC classification system is crucial for grouping drugs into different classes based on their therapeutic use.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Diagnosis Data Preprocessing</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">The diagnosis data from ‘DIAGNOSES ICD.csv‘ is processed using the ‘diag process‘ function, which involves:</p>
<ul class="ltx_itemize" id="A1.I4">
<li class="ltx_item" id="A1.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I4.i1.p1">
<p class="ltx_p" id="A1.I4.i1.p1.1">Load the Data: Diagnosis data is loaded into a data frame.</p>
</div>
</li>
<li class="ltx_item" id="A1.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I4.i2.p1">
<p class="ltx_p" id="A1.I4.i2.p1.1">Filter Relevant Columns: Only essential columns, which might include diagnosis codes and patient identifiers, are retained.</p>
</div>
</li>
<li class="ltx_item" id="A1.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I4.i3.p1">
<p class="ltx_p" id="A1.I4.i3.p1.1">Handle Missing or Erroneous Entries: Any missing values or errors in the dataset are addressed, ensuring data integrity.</p>
</div>
</li>
<li class="ltx_item" id="A1.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I4.i4.p1">
<p class="ltx_p" id="A1.I4.i4.p1.1">Sorting and Deduplication: The dataset is sorted based on relevant columns, and duplicate entries are removed to ensure each record is unique.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Procedure Data Preprocessing</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">Similar to the diagnosis data, the procedure data from ‘PROCEDURES ICD.csv‘:</p>
<ul class="ltx_itemize" id="A1.I5">
<li class="ltx_item" id="A1.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I5.i1.p1">
<p class="ltx_p" id="A1.I5.i1.p1.1">Load the Data: Procedure data is loaded into a DataFrame.</p>
</div>
</li>
<li class="ltx_item" id="A1.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I5.i2.p1">
<p class="ltx_p" id="A1.I5.i2.p1.1">Filter and Clean: Only relevant columns are retained, and any erroneous or missing entries are addressed.</p>
</div>
</li>
<li class="ltx_item" id="A1.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I5.i3.p1">
<p class="ltx_p" id="A1.I5.i3.p1.1">Sorting and Deduplication: The data is organized by relevant columns, and any duplicate records are removed.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Data Integration</h3>
<div class="ltx_para" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS5.p1.1.1">Combining Process</span>:
The datasets, once cleaned and preprocessed, need to be integrated for comprehensive analysis:</p>
<ul class="ltx_itemize" id="A1.I6">
<li class="ltx_item" id="A1.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I6.i1.p1">
<p class="ltx_p" id="A1.I6.i1.p1.1">Data Merging: The medication, diagnosis, and procedure data are merged based on common identifiers like ‘SUBJECT ID‘ and ‘HADM ID‘.</p>
</div>
</li>
<li class="ltx_item" id="A1.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I6.i2.p1">
<p class="ltx_p" id="A1.I6.i2.p1.1">Final Cleaning: Any discrepancies resulting from the merge, such as missing values or duplicates, are addressed.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Model Parameters</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">GNN Model (EGraphSage)
The Graph Neural Network model is implemented using the EGraphSage class. The configuration parameters for the model are in the Table <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#A2.T5" title="Table 5 ‣ Appendix B Model Parameters ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">5</span></a></p>
</div>
<figure class="ltx_table" id="A2.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A2.T5.2.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="A2.T5.3.2" style="font-size:90%;">Datasets description</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T5.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T5.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A2.T5.4.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A2.T5.4.1.1.2">GNN</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A2.T5.4.1.1.3">MLP</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T5.4.2.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A2.T5.4.2.1.1">Input Dimension</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T5.4.2.1.2">1</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T5.4.2.1.3">#nodes</td>
</tr>
<tr class="ltx_tr" id="A2.T5.4.3.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T5.4.3.2.1">Hidden Layer Dimension</td>
<td class="ltx_td ltx_align_left" id="A2.T5.4.3.2.2">128</td>
<td class="ltx_td ltx_align_left" id="A2.T5.4.3.2.3">64</td>
</tr>
<tr class="ltx_tr" id="A2.T5.4.4.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T5.4.4.3.1">Output Dimension</td>
<td class="ltx_td ltx_align_left" id="A2.T5.4.4.3.2">1</td>
<td class="ltx_td ltx_align_left" id="A2.T5.4.4.3.3">1</td>
</tr>
<tr class="ltx_tr" id="A2.T5.4.5.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T5.4.5.4.1">Edge Channels</td>
<td class="ltx_td ltx_align_left" id="A2.T5.4.5.4.2">1</td>
<td class="ltx_td ltx_align_left" id="A2.T5.4.5.4.3">NaN</td>
</tr>
<tr class="ltx_tr" id="A2.T5.4.6.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T5.4.6.5.1">Activation Function</td>
<td class="ltx_td ltx_align_left" id="A2.T5.4.6.5.2">ReLU</td>
<td class="ltx_td ltx_align_left" id="A2.T5.4.6.5.3">ReLU</td>
</tr>
<tr class="ltx_tr" id="A2.T5.4.7.6">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A2.T5.4.7.6.1">Aggregation Method</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A2.T5.4.7.6.2">Mean</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A2.T5.4.7.6.3">NaN</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Metrics</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.9">Target encoding is a popular technique in machine learning for encoding categorical features, where each category is replaced with its corresponding mean target value. This can be mathematically expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Target Encoding}(c)=\frac{\sum_{i=1}^{N}y_{i}\cdot\delta(c,c_{i})}{\sum_%
{i=1}^{N}\delta(c,c_{i})}" class="ltx_Math" display="block" id="A3.Ex1.m1.5"><semantics id="A3.Ex1.m1.5a"><mrow id="A3.Ex1.m1.5.6" xref="A3.Ex1.m1.5.6.cmml"><mrow id="A3.Ex1.m1.5.6.2" xref="A3.Ex1.m1.5.6.2.cmml"><mtext id="A3.Ex1.m1.5.6.2.2" xref="A3.Ex1.m1.5.6.2.2a.cmml">Target Encoding</mtext><mo id="A3.Ex1.m1.5.6.2.1" xref="A3.Ex1.m1.5.6.2.1.cmml">⁢</mo><mrow id="A3.Ex1.m1.5.6.2.3.2" xref="A3.Ex1.m1.5.6.2.cmml"><mo id="A3.Ex1.m1.5.6.2.3.2.1" stretchy="false" xref="A3.Ex1.m1.5.6.2.cmml">(</mo><mi id="A3.Ex1.m1.5.5" xref="A3.Ex1.m1.5.5.cmml">c</mi><mo id="A3.Ex1.m1.5.6.2.3.2.2" stretchy="false" xref="A3.Ex1.m1.5.6.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex1.m1.5.6.1" xref="A3.Ex1.m1.5.6.1.cmml">=</mo><mfrac id="A3.Ex1.m1.4.4" xref="A3.Ex1.m1.4.4.cmml"><mrow id="A3.Ex1.m1.2.2.2" xref="A3.Ex1.m1.2.2.2.cmml"><msubsup id="A3.Ex1.m1.2.2.2.3" xref="A3.Ex1.m1.2.2.2.3.cmml"><mo id="A3.Ex1.m1.2.2.2.3.2.2" xref="A3.Ex1.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="A3.Ex1.m1.2.2.2.3.2.3" xref="A3.Ex1.m1.2.2.2.3.2.3.cmml"><mi id="A3.Ex1.m1.2.2.2.3.2.3.2" xref="A3.Ex1.m1.2.2.2.3.2.3.2.cmml">i</mi><mo id="A3.Ex1.m1.2.2.2.3.2.3.1" xref="A3.Ex1.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="A3.Ex1.m1.2.2.2.3.2.3.3" xref="A3.Ex1.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex1.m1.2.2.2.3.3" xref="A3.Ex1.m1.2.2.2.3.3.cmml">N</mi></msubsup><mrow id="A3.Ex1.m1.2.2.2.2" xref="A3.Ex1.m1.2.2.2.2.cmml"><mrow id="A3.Ex1.m1.2.2.2.2.3" xref="A3.Ex1.m1.2.2.2.2.3.cmml"><msub id="A3.Ex1.m1.2.2.2.2.3.2" xref="A3.Ex1.m1.2.2.2.2.3.2.cmml"><mi id="A3.Ex1.m1.2.2.2.2.3.2.2" xref="A3.Ex1.m1.2.2.2.2.3.2.2.cmml">y</mi><mi id="A3.Ex1.m1.2.2.2.2.3.2.3" xref="A3.Ex1.m1.2.2.2.2.3.2.3.cmml">i</mi></msub><mo id="A3.Ex1.m1.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A3.Ex1.m1.2.2.2.2.3.1.cmml">⋅</mo><mi id="A3.Ex1.m1.2.2.2.2.3.3" xref="A3.Ex1.m1.2.2.2.2.3.3.cmml">δ</mi></mrow><mo id="A3.Ex1.m1.2.2.2.2.2" xref="A3.Ex1.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="A3.Ex1.m1.2.2.2.2.1.1" xref="A3.Ex1.m1.2.2.2.2.1.2.cmml"><mo id="A3.Ex1.m1.2.2.2.2.1.1.2" stretchy="false" xref="A3.Ex1.m1.2.2.2.2.1.2.cmml">(</mo><mi id="A3.Ex1.m1.1.1.1.1" xref="A3.Ex1.m1.1.1.1.1.cmml">c</mi><mo id="A3.Ex1.m1.2.2.2.2.1.1.3" xref="A3.Ex1.m1.2.2.2.2.1.2.cmml">,</mo><msub id="A3.Ex1.m1.2.2.2.2.1.1.1" xref="A3.Ex1.m1.2.2.2.2.1.1.1.cmml"><mi id="A3.Ex1.m1.2.2.2.2.1.1.1.2" xref="A3.Ex1.m1.2.2.2.2.1.1.1.2.cmml">c</mi><mi id="A3.Ex1.m1.2.2.2.2.1.1.1.3" xref="A3.Ex1.m1.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A3.Ex1.m1.2.2.2.2.1.1.4" stretchy="false" xref="A3.Ex1.m1.2.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A3.Ex1.m1.4.4.4" xref="A3.Ex1.m1.4.4.4.cmml"><msubsup id="A3.Ex1.m1.4.4.4.3" xref="A3.Ex1.m1.4.4.4.3.cmml"><mo id="A3.Ex1.m1.4.4.4.3.2.2" xref="A3.Ex1.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="A3.Ex1.m1.4.4.4.3.2.3" xref="A3.Ex1.m1.4.4.4.3.2.3.cmml"><mi id="A3.Ex1.m1.4.4.4.3.2.3.2" xref="A3.Ex1.m1.4.4.4.3.2.3.2.cmml">i</mi><mo id="A3.Ex1.m1.4.4.4.3.2.3.1" xref="A3.Ex1.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="A3.Ex1.m1.4.4.4.3.2.3.3" xref="A3.Ex1.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex1.m1.4.4.4.3.3" xref="A3.Ex1.m1.4.4.4.3.3.cmml">N</mi></msubsup><mrow id="A3.Ex1.m1.4.4.4.2" xref="A3.Ex1.m1.4.4.4.2.cmml"><mi id="A3.Ex1.m1.4.4.4.2.3" xref="A3.Ex1.m1.4.4.4.2.3.cmml">δ</mi><mo id="A3.Ex1.m1.4.4.4.2.2" xref="A3.Ex1.m1.4.4.4.2.2.cmml">⁢</mo><mrow id="A3.Ex1.m1.4.4.4.2.1.1" xref="A3.Ex1.m1.4.4.4.2.1.2.cmml"><mo id="A3.Ex1.m1.4.4.4.2.1.1.2" stretchy="false" xref="A3.Ex1.m1.4.4.4.2.1.2.cmml">(</mo><mi id="A3.Ex1.m1.3.3.3.1" xref="A3.Ex1.m1.3.3.3.1.cmml">c</mi><mo id="A3.Ex1.m1.4.4.4.2.1.1.3" xref="A3.Ex1.m1.4.4.4.2.1.2.cmml">,</mo><msub id="A3.Ex1.m1.4.4.4.2.1.1.1" xref="A3.Ex1.m1.4.4.4.2.1.1.1.cmml"><mi id="A3.Ex1.m1.4.4.4.2.1.1.1.2" xref="A3.Ex1.m1.4.4.4.2.1.1.1.2.cmml">c</mi><mi id="A3.Ex1.m1.4.4.4.2.1.1.1.3" xref="A3.Ex1.m1.4.4.4.2.1.1.1.3.cmml">i</mi></msub><mo id="A3.Ex1.m1.4.4.4.2.1.1.4" stretchy="false" xref="A3.Ex1.m1.4.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex1.m1.5b"><apply id="A3.Ex1.m1.5.6.cmml" xref="A3.Ex1.m1.5.6"><eq id="A3.Ex1.m1.5.6.1.cmml" xref="A3.Ex1.m1.5.6.1"></eq><apply id="A3.Ex1.m1.5.6.2.cmml" xref="A3.Ex1.m1.5.6.2"><times id="A3.Ex1.m1.5.6.2.1.cmml" xref="A3.Ex1.m1.5.6.2.1"></times><ci id="A3.Ex1.m1.5.6.2.2a.cmml" xref="A3.Ex1.m1.5.6.2.2"><mtext id="A3.Ex1.m1.5.6.2.2.cmml" xref="A3.Ex1.m1.5.6.2.2">Target Encoding</mtext></ci><ci id="A3.Ex1.m1.5.5.cmml" xref="A3.Ex1.m1.5.5">𝑐</ci></apply><apply id="A3.Ex1.m1.4.4.cmml" xref="A3.Ex1.m1.4.4"><divide id="A3.Ex1.m1.4.4.5.cmml" xref="A3.Ex1.m1.4.4"></divide><apply id="A3.Ex1.m1.2.2.2.cmml" xref="A3.Ex1.m1.2.2.2"><apply id="A3.Ex1.m1.2.2.2.3.cmml" xref="A3.Ex1.m1.2.2.2.3"><csymbol cd="ambiguous" id="A3.Ex1.m1.2.2.2.3.1.cmml" xref="A3.Ex1.m1.2.2.2.3">superscript</csymbol><apply id="A3.Ex1.m1.2.2.2.3.2.cmml" xref="A3.Ex1.m1.2.2.2.3"><csymbol cd="ambiguous" id="A3.Ex1.m1.2.2.2.3.2.1.cmml" xref="A3.Ex1.m1.2.2.2.3">subscript</csymbol><sum id="A3.Ex1.m1.2.2.2.3.2.2.cmml" xref="A3.Ex1.m1.2.2.2.3.2.2"></sum><apply id="A3.Ex1.m1.2.2.2.3.2.3.cmml" xref="A3.Ex1.m1.2.2.2.3.2.3"><eq id="A3.Ex1.m1.2.2.2.3.2.3.1.cmml" xref="A3.Ex1.m1.2.2.2.3.2.3.1"></eq><ci id="A3.Ex1.m1.2.2.2.3.2.3.2.cmml" xref="A3.Ex1.m1.2.2.2.3.2.3.2">𝑖</ci><cn id="A3.Ex1.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="A3.Ex1.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="A3.Ex1.m1.2.2.2.3.3.cmml" xref="A3.Ex1.m1.2.2.2.3.3">𝑁</ci></apply><apply id="A3.Ex1.m1.2.2.2.2.cmml" xref="A3.Ex1.m1.2.2.2.2"><times id="A3.Ex1.m1.2.2.2.2.2.cmml" xref="A3.Ex1.m1.2.2.2.2.2"></times><apply id="A3.Ex1.m1.2.2.2.2.3.cmml" xref="A3.Ex1.m1.2.2.2.2.3"><ci id="A3.Ex1.m1.2.2.2.2.3.1.cmml" xref="A3.Ex1.m1.2.2.2.2.3.1">⋅</ci><apply id="A3.Ex1.m1.2.2.2.2.3.2.cmml" xref="A3.Ex1.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A3.Ex1.m1.2.2.2.2.3.2.1.cmml" xref="A3.Ex1.m1.2.2.2.2.3.2">subscript</csymbol><ci id="A3.Ex1.m1.2.2.2.2.3.2.2.cmml" xref="A3.Ex1.m1.2.2.2.2.3.2.2">𝑦</ci><ci id="A3.Ex1.m1.2.2.2.2.3.2.3.cmml" xref="A3.Ex1.m1.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="A3.Ex1.m1.2.2.2.2.3.3.cmml" xref="A3.Ex1.m1.2.2.2.2.3.3">𝛿</ci></apply><interval closure="open" id="A3.Ex1.m1.2.2.2.2.1.2.cmml" xref="A3.Ex1.m1.2.2.2.2.1.1"><ci id="A3.Ex1.m1.1.1.1.1.cmml" xref="A3.Ex1.m1.1.1.1.1">𝑐</ci><apply id="A3.Ex1.m1.2.2.2.2.1.1.1.cmml" xref="A3.Ex1.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex1.m1.2.2.2.2.1.1.1.1.cmml" xref="A3.Ex1.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="A3.Ex1.m1.2.2.2.2.1.1.1.2.cmml" xref="A3.Ex1.m1.2.2.2.2.1.1.1.2">𝑐</ci><ci id="A3.Ex1.m1.2.2.2.2.1.1.1.3.cmml" xref="A3.Ex1.m1.2.2.2.2.1.1.1.3">𝑖</ci></apply></interval></apply></apply><apply id="A3.Ex1.m1.4.4.4.cmml" xref="A3.Ex1.m1.4.4.4"><apply id="A3.Ex1.m1.4.4.4.3.cmml" xref="A3.Ex1.m1.4.4.4.3"><csymbol cd="ambiguous" id="A3.Ex1.m1.4.4.4.3.1.cmml" xref="A3.Ex1.m1.4.4.4.3">superscript</csymbol><apply id="A3.Ex1.m1.4.4.4.3.2.cmml" xref="A3.Ex1.m1.4.4.4.3"><csymbol cd="ambiguous" id="A3.Ex1.m1.4.4.4.3.2.1.cmml" xref="A3.Ex1.m1.4.4.4.3">subscript</csymbol><sum id="A3.Ex1.m1.4.4.4.3.2.2.cmml" xref="A3.Ex1.m1.4.4.4.3.2.2"></sum><apply id="A3.Ex1.m1.4.4.4.3.2.3.cmml" xref="A3.Ex1.m1.4.4.4.3.2.3"><eq id="A3.Ex1.m1.4.4.4.3.2.3.1.cmml" xref="A3.Ex1.m1.4.4.4.3.2.3.1"></eq><ci id="A3.Ex1.m1.4.4.4.3.2.3.2.cmml" xref="A3.Ex1.m1.4.4.4.3.2.3.2">𝑖</ci><cn id="A3.Ex1.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="A3.Ex1.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="A3.Ex1.m1.4.4.4.3.3.cmml" xref="A3.Ex1.m1.4.4.4.3.3">𝑁</ci></apply><apply id="A3.Ex1.m1.4.4.4.2.cmml" xref="A3.Ex1.m1.4.4.4.2"><times id="A3.Ex1.m1.4.4.4.2.2.cmml" xref="A3.Ex1.m1.4.4.4.2.2"></times><ci id="A3.Ex1.m1.4.4.4.2.3.cmml" xref="A3.Ex1.m1.4.4.4.2.3">𝛿</ci><interval closure="open" id="A3.Ex1.m1.4.4.4.2.1.2.cmml" xref="A3.Ex1.m1.4.4.4.2.1.1"><ci id="A3.Ex1.m1.3.3.3.1.cmml" xref="A3.Ex1.m1.3.3.3.1">𝑐</ci><apply id="A3.Ex1.m1.4.4.4.2.1.1.1.cmml" xref="A3.Ex1.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex1.m1.4.4.4.2.1.1.1.1.cmml" xref="A3.Ex1.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="A3.Ex1.m1.4.4.4.2.1.1.1.2.cmml" xref="A3.Ex1.m1.4.4.4.2.1.1.1.2">𝑐</ci><ci id="A3.Ex1.m1.4.4.4.2.1.1.1.3.cmml" xref="A3.Ex1.m1.4.4.4.2.1.1.1.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex1.m1.5c">\text{Target Encoding}(c)=\frac{\sum_{i=1}^{N}y_{i}\cdot\delta(c,c_{i})}{\sum_%
{i=1}^{N}\delta(c,c_{i})}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex1.m1.5d">Target Encoding ( italic_c ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_δ ( italic_c , italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_δ ( italic_c , italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p1.8">where <math alttext="c" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">italic_c</annotation></semantics></math> represents the category to be encoded, <math alttext="y_{i}" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><msub id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml"><mi id="A3.p1.2.m2.1.1.2" xref="A3.p1.2.m2.1.1.2.cmml">y</mi><mi id="A3.p1.2.m2.1.1.3" xref="A3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><apply id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.1.1.cmml" xref="A3.p1.2.m2.1.1">subscript</csymbol><ci id="A3.p1.2.m2.1.1.2.cmml" xref="A3.p1.2.m2.1.1.2">𝑦</ci><ci id="A3.p1.2.m2.1.1.3.cmml" xref="A3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the target value for the <math alttext="i" class="ltx_Math" display="inline" id="A3.p1.3.m3.1"><semantics id="A3.p1.3.m3.1a"><mi id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><ci id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A3.p1.3.m3.1d">italic_i</annotation></semantics></math>-th sample, <math alttext="c_{i}" class="ltx_Math" display="inline" id="A3.p1.4.m4.1"><semantics id="A3.p1.4.m4.1a"><msub id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml"><mi id="A3.p1.4.m4.1.1.2" xref="A3.p1.4.m4.1.1.2.cmml">c</mi><mi id="A3.p1.4.m4.1.1.3" xref="A3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><apply id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A3.p1.4.m4.1.1.1.cmml" xref="A3.p1.4.m4.1.1">subscript</csymbol><ci id="A3.p1.4.m4.1.1.2.cmml" xref="A3.p1.4.m4.1.1.2">𝑐</ci><ci id="A3.p1.4.m4.1.1.3.cmml" xref="A3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.4.m4.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the category of the <math alttext="i" class="ltx_Math" display="inline" id="A3.p1.5.m5.1"><semantics id="A3.p1.5.m5.1a"><mi id="A3.p1.5.m5.1.1" xref="A3.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.1b"><ci id="A3.p1.5.m5.1.1.cmml" xref="A3.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="A3.p1.5.m5.1d">italic_i</annotation></semantics></math>-th sample, and <math alttext="\delta(c,c_{i})" class="ltx_Math" display="inline" id="A3.p1.6.m6.2"><semantics id="A3.p1.6.m6.2a"><mrow id="A3.p1.6.m6.2.2" xref="A3.p1.6.m6.2.2.cmml"><mi id="A3.p1.6.m6.2.2.3" xref="A3.p1.6.m6.2.2.3.cmml">δ</mi><mo id="A3.p1.6.m6.2.2.2" xref="A3.p1.6.m6.2.2.2.cmml">⁢</mo><mrow id="A3.p1.6.m6.2.2.1.1" xref="A3.p1.6.m6.2.2.1.2.cmml"><mo id="A3.p1.6.m6.2.2.1.1.2" stretchy="false" xref="A3.p1.6.m6.2.2.1.2.cmml">(</mo><mi id="A3.p1.6.m6.1.1" xref="A3.p1.6.m6.1.1.cmml">c</mi><mo id="A3.p1.6.m6.2.2.1.1.3" xref="A3.p1.6.m6.2.2.1.2.cmml">,</mo><msub id="A3.p1.6.m6.2.2.1.1.1" xref="A3.p1.6.m6.2.2.1.1.1.cmml"><mi id="A3.p1.6.m6.2.2.1.1.1.2" xref="A3.p1.6.m6.2.2.1.1.1.2.cmml">c</mi><mi id="A3.p1.6.m6.2.2.1.1.1.3" xref="A3.p1.6.m6.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A3.p1.6.m6.2.2.1.1.4" stretchy="false" xref="A3.p1.6.m6.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.6.m6.2b"><apply id="A3.p1.6.m6.2.2.cmml" xref="A3.p1.6.m6.2.2"><times id="A3.p1.6.m6.2.2.2.cmml" xref="A3.p1.6.m6.2.2.2"></times><ci id="A3.p1.6.m6.2.2.3.cmml" xref="A3.p1.6.m6.2.2.3">𝛿</ci><interval closure="open" id="A3.p1.6.m6.2.2.1.2.cmml" xref="A3.p1.6.m6.2.2.1.1"><ci id="A3.p1.6.m6.1.1.cmml" xref="A3.p1.6.m6.1.1">𝑐</ci><apply id="A3.p1.6.m6.2.2.1.1.1.cmml" xref="A3.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.6.m6.2.2.1.1.1.1.cmml" xref="A3.p1.6.m6.2.2.1.1.1">subscript</csymbol><ci id="A3.p1.6.m6.2.2.1.1.1.2.cmml" xref="A3.p1.6.m6.2.2.1.1.1.2">𝑐</ci><ci id="A3.p1.6.m6.2.2.1.1.1.3.cmml" xref="A3.p1.6.m6.2.2.1.1.1.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m6.2c">\delta(c,c_{i})</annotation><annotation encoding="application/x-llamapun" id="A3.p1.6.m6.2d">italic_δ ( italic_c , italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is the Kronecker delta function that equals 1 when <math alttext="c" class="ltx_Math" display="inline" id="A3.p1.7.m7.1"><semantics id="A3.p1.7.m7.1a"><mi id="A3.p1.7.m7.1.1" xref="A3.p1.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A3.p1.7.m7.1b"><ci id="A3.p1.7.m7.1.1.cmml" xref="A3.p1.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.7.m7.1c">c</annotation><annotation encoding="application/x-llamapun" id="A3.p1.7.m7.1d">italic_c</annotation></semantics></math> equals <math alttext="c_{i}" class="ltx_Math" display="inline" id="A3.p1.8.m8.1"><semantics id="A3.p1.8.m8.1a"><msub id="A3.p1.8.m8.1.1" xref="A3.p1.8.m8.1.1.cmml"><mi id="A3.p1.8.m8.1.1.2" xref="A3.p1.8.m8.1.1.2.cmml">c</mi><mi id="A3.p1.8.m8.1.1.3" xref="A3.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.8.m8.1b"><apply id="A3.p1.8.m8.1.1.cmml" xref="A3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A3.p1.8.m8.1.1.1.cmml" xref="A3.p1.8.m8.1.1">subscript</csymbol><ci id="A3.p1.8.m8.1.1.2.cmml" xref="A3.p1.8.m8.1.1.2">𝑐</ci><ci id="A3.p1.8.m8.1.1.3.cmml" xref="A3.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.8.m8.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.8.m8.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and 0 otherwise.</p>
</div>
<div class="ltx_para" id="A3.p2">
<p class="ltx_p" id="A3.p2.1"><span class="ltx_text ltx_font_italic" id="A3.p2.1.1">Log Likelihood Ratio (LLR)</span>: The likelihood ratio is defined as the ratio of two key values:
The maximum value of the likelihood function is calculated within the subspace defined by the hypothesis.
And the maximum value of the likelihood function, calculated across the entire parameter space <cite class="ltx_cite ltx_citemacro_citep">(Dunning, <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib8" title="">1994</a>)</cite>.</p>
</div>
<div class="ltx_para" id="A3.p3">
<p class="ltx_p" id="A3.p3.4">To compute the score, let <math alttext="k_{11}" class="ltx_Math" display="inline" id="A3.p3.1.m1.1"><semantics id="A3.p3.1.m1.1a"><msub id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml"><mi id="A3.p3.1.m1.1.1.2" xref="A3.p3.1.m1.1.1.2.cmml">k</mi><mn id="A3.p3.1.m1.1.1.3" xref="A3.p3.1.m1.1.1.3.cmml">11</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><apply id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.1.m1.1.1.1.cmml" xref="A3.p3.1.m1.1.1">subscript</csymbol><ci id="A3.p3.1.m1.1.1.2.cmml" xref="A3.p3.1.m1.1.1.2">𝑘</ci><cn id="A3.p3.1.m1.1.1.3.cmml" type="integer" xref="A3.p3.1.m1.1.1.3">11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">k_{11}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.1.m1.1d">italic_k start_POSTSUBSCRIPT 11 end_POSTSUBSCRIPT</annotation></semantics></math> be the number of times the events occurred together, let <math alttext="k_{12}" class="ltx_Math" display="inline" id="A3.p3.2.m2.1"><semantics id="A3.p3.2.m2.1a"><msub id="A3.p3.2.m2.1.1" xref="A3.p3.2.m2.1.1.cmml"><mi id="A3.p3.2.m2.1.1.2" xref="A3.p3.2.m2.1.1.2.cmml">k</mi><mn id="A3.p3.2.m2.1.1.3" xref="A3.p3.2.m2.1.1.3.cmml">12</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p3.2.m2.1b"><apply id="A3.p3.2.m2.1.1.cmml" xref="A3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.1.cmml" xref="A3.p3.2.m2.1.1">subscript</csymbol><ci id="A3.p3.2.m2.1.1.2.cmml" xref="A3.p3.2.m2.1.1.2">𝑘</ci><cn id="A3.p3.2.m2.1.1.3.cmml" type="integer" xref="A3.p3.2.m2.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.2.m2.1c">k_{12}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.2.m2.1d">italic_k start_POSTSUBSCRIPT 12 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="k_{21}" class="ltx_Math" display="inline" id="A3.p3.3.m3.1"><semantics id="A3.p3.3.m3.1a"><msub id="A3.p3.3.m3.1.1" xref="A3.p3.3.m3.1.1.cmml"><mi id="A3.p3.3.m3.1.1.2" xref="A3.p3.3.m3.1.1.2.cmml">k</mi><mn id="A3.p3.3.m3.1.1.3" xref="A3.p3.3.m3.1.1.3.cmml">21</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p3.3.m3.1b"><apply id="A3.p3.3.m3.1.1.cmml" xref="A3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p3.3.m3.1.1.1.cmml" xref="A3.p3.3.m3.1.1">subscript</csymbol><ci id="A3.p3.3.m3.1.1.2.cmml" xref="A3.p3.3.m3.1.1.2">𝑘</ci><cn id="A3.p3.3.m3.1.1.3.cmml" type="integer" xref="A3.p3.3.m3.1.1.3">21</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.3.m3.1c">k_{21}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.3.m3.1d">italic_k start_POSTSUBSCRIPT 21 end_POSTSUBSCRIPT</annotation></semantics></math> be the number of times each has occurred without the other, and <math alttext="k_{22}" class="ltx_Math" display="inline" id="A3.p3.4.m4.1"><semantics id="A3.p3.4.m4.1a"><msub id="A3.p3.4.m4.1.1" xref="A3.p3.4.m4.1.1.cmml"><mi id="A3.p3.4.m4.1.1.2" xref="A3.p3.4.m4.1.1.2.cmml">k</mi><mn id="A3.p3.4.m4.1.1.3" xref="A3.p3.4.m4.1.1.3.cmml">22</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p3.4.m4.1b"><apply id="A3.p3.4.m4.1.1.cmml" xref="A3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A3.p3.4.m4.1.1.1.cmml" xref="A3.p3.4.m4.1.1">subscript</csymbol><ci id="A3.p3.4.m4.1.1.2.cmml" xref="A3.p3.4.m4.1.1.2">𝑘</ci><cn id="A3.p3.4.m4.1.1.3.cmml" type="integer" xref="A3.p3.4.m4.1.1.3">22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.4.m4.1c">k_{22}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.4.m4.1d">italic_k start_POSTSUBSCRIPT 22 end_POSTSUBSCRIPT</annotation></semantics></math> be the number of times something has been observed that was neither of these events. The LLR score is given as the following:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="LLR=2\sum(k)\left(H(k)-H(\text{rowSums}(k))-H(\text{colSums}(k))\right)" class="ltx_Math" display="block" id="A3.Ex2.m1.5"><semantics id="A3.Ex2.m1.5a"><mrow id="A3.Ex2.m1.5.5" xref="A3.Ex2.m1.5.5.cmml"><mrow id="A3.Ex2.m1.5.5.3" xref="A3.Ex2.m1.5.5.3.cmml"><mi id="A3.Ex2.m1.5.5.3.2" xref="A3.Ex2.m1.5.5.3.2.cmml">L</mi><mo id="A3.Ex2.m1.5.5.3.1" xref="A3.Ex2.m1.5.5.3.1.cmml">⁢</mo><mi id="A3.Ex2.m1.5.5.3.3" xref="A3.Ex2.m1.5.5.3.3.cmml">L</mi><mo id="A3.Ex2.m1.5.5.3.1a" xref="A3.Ex2.m1.5.5.3.1.cmml">⁢</mo><mi id="A3.Ex2.m1.5.5.3.4" xref="A3.Ex2.m1.5.5.3.4.cmml">R</mi></mrow><mo id="A3.Ex2.m1.5.5.2" xref="A3.Ex2.m1.5.5.2.cmml">=</mo><mrow id="A3.Ex2.m1.5.5.1" xref="A3.Ex2.m1.5.5.1.cmml"><mn id="A3.Ex2.m1.5.5.1.3" xref="A3.Ex2.m1.5.5.1.3.cmml">2</mn><mo id="A3.Ex2.m1.5.5.1.2" xref="A3.Ex2.m1.5.5.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.5.5.1.1" xref="A3.Ex2.m1.5.5.1.1.cmml"><mo id="A3.Ex2.m1.5.5.1.1.2" movablelimits="false" rspace="0em" xref="A3.Ex2.m1.5.5.1.1.2.cmml">∑</mo><mrow id="A3.Ex2.m1.5.5.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.cmml"><mrow id="A3.Ex2.m1.5.5.1.1.1.3.2" xref="A3.Ex2.m1.5.5.1.1.1.cmml"><mo id="A3.Ex2.m1.5.5.1.1.1.3.2.1" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.cmml">(</mo><mi id="A3.Ex2.m1.1.1" xref="A3.Ex2.m1.1.1.cmml">k</mi><mo id="A3.Ex2.m1.5.5.1.1.1.3.2.2" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex2.m1.5.5.1.1.1.2" xref="A3.Ex2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.cmml"><mi id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.2.cmml">H</mi><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.3.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.cmml"><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.3.2.1" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.cmml">(</mo><mi id="A3.Ex2.m1.2.2" xref="A3.Ex2.m1.2.2.cmml">k</mi><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.3.2.2" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.3" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.3.cmml">H</mi><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2a.cmml">rowSums</mtext><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A3.Ex2.m1.3.3" xref="A3.Ex2.m1.3.3.cmml">k</mi><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.3a" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml">H</mi><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.cmml"><mtext id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.2a.cmml">colSums</mtext><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.1" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><mrow id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.3.2" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.3.2.1" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mi id="A3.Ex2.m1.4.4" xref="A3.Ex2.m1.4.4.cmml">k</mi><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.3.2.2" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex2.m1.5.5.1.1.1.1.1.3" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex2.m1.5b"><apply id="A3.Ex2.m1.5.5.cmml" xref="A3.Ex2.m1.5.5"><eq id="A3.Ex2.m1.5.5.2.cmml" xref="A3.Ex2.m1.5.5.2"></eq><apply id="A3.Ex2.m1.5.5.3.cmml" xref="A3.Ex2.m1.5.5.3"><times id="A3.Ex2.m1.5.5.3.1.cmml" xref="A3.Ex2.m1.5.5.3.1"></times><ci id="A3.Ex2.m1.5.5.3.2.cmml" xref="A3.Ex2.m1.5.5.3.2">𝐿</ci><ci id="A3.Ex2.m1.5.5.3.3.cmml" xref="A3.Ex2.m1.5.5.3.3">𝐿</ci><ci id="A3.Ex2.m1.5.5.3.4.cmml" xref="A3.Ex2.m1.5.5.3.4">𝑅</ci></apply><apply id="A3.Ex2.m1.5.5.1.cmml" xref="A3.Ex2.m1.5.5.1"><times id="A3.Ex2.m1.5.5.1.2.cmml" xref="A3.Ex2.m1.5.5.1.2"></times><cn id="A3.Ex2.m1.5.5.1.3.cmml" type="integer" xref="A3.Ex2.m1.5.5.1.3">2</cn><apply id="A3.Ex2.m1.5.5.1.1.cmml" xref="A3.Ex2.m1.5.5.1.1"><sum id="A3.Ex2.m1.5.5.1.1.2.cmml" xref="A3.Ex2.m1.5.5.1.1.2"></sum><apply id="A3.Ex2.m1.5.5.1.1.1.cmml" xref="A3.Ex2.m1.5.5.1.1.1"><times id="A3.Ex2.m1.5.5.1.1.1.2.cmml" xref="A3.Ex2.m1.5.5.1.1.1.2"></times><ci id="A3.Ex2.m1.1.1.cmml" xref="A3.Ex2.m1.1.1">𝑘</ci><apply id="A3.Ex2.m1.5.5.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1"><minus id="A3.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.3"></minus><apply id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4"><times id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.1.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.1"></times><ci id="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.2.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.4.2">𝐻</ci><ci id="A3.Ex2.m1.2.2.cmml" xref="A3.Ex2.m1.2.2">𝑘</ci></apply><apply id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1"><times id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.2"></times><ci id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.3">𝐻</ci><apply id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1"><times id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"><mtext id="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">rowSums</mtext></ci><ci id="A3.Ex2.m1.3.3.cmml" xref="A3.Ex2.m1.3.3">𝑘</ci></apply></apply><apply id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2"><times id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.2"></times><ci id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.3">𝐻</ci><apply id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1"><times id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.1"></times><ci id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.2a.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.2"><mtext id="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A3.Ex2.m1.5.5.1.1.1.1.1.1.2.1.1.1.2">colSums</mtext></ci><ci id="A3.Ex2.m1.4.4.cmml" xref="A3.Ex2.m1.4.4">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex2.m1.5c">LLR=2\sum(k)\left(H(k)-H(\text{rowSums}(k))-H(\text{colSums}(k))\right)</annotation><annotation encoding="application/x-llamapun" id="A3.Ex2.m1.5d">italic_L italic_L italic_R = 2 ∑ ( italic_k ) ( italic_H ( italic_k ) - italic_H ( rowSums ( italic_k ) ) - italic_H ( colSums ( italic_k ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p3.5">where <math alttext="H" class="ltx_Math" display="inline" id="A3.p3.5.m1.1"><semantics id="A3.p3.5.m1.1a"><mi id="A3.p3.5.m1.1.1" xref="A3.p3.5.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A3.p3.5.m1.1b"><ci id="A3.p3.5.m1.1.1.cmml" xref="A3.p3.5.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.5.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="A3.p3.5.m1.1d">italic_H</annotation></semantics></math> is Shannon’s entropy, computed as the sum of:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H=\frac{k_{ij}}{\sum(k)}\log\left(\frac{k_{ij}}{\sum(k)}\right)." class="ltx_Math" display="block" id="A3.Ex3.m1.4"><semantics id="A3.Ex3.m1.4a"><mrow id="A3.Ex3.m1.4.4.1" xref="A3.Ex3.m1.4.4.1.1.cmml"><mrow id="A3.Ex3.m1.4.4.1.1" xref="A3.Ex3.m1.4.4.1.1.cmml"><mi id="A3.Ex3.m1.4.4.1.1.2" xref="A3.Ex3.m1.4.4.1.1.2.cmml">H</mi><mo id="A3.Ex3.m1.4.4.1.1.1" xref="A3.Ex3.m1.4.4.1.1.1.cmml">=</mo><mrow id="A3.Ex3.m1.4.4.1.1.3" xref="A3.Ex3.m1.4.4.1.1.3.cmml"><mfrac id="A3.Ex3.m1.1.1" xref="A3.Ex3.m1.1.1.cmml"><msub id="A3.Ex3.m1.1.1.3" xref="A3.Ex3.m1.1.1.3.cmml"><mi id="A3.Ex3.m1.1.1.3.2" xref="A3.Ex3.m1.1.1.3.2.cmml">k</mi><mrow id="A3.Ex3.m1.1.1.3.3" xref="A3.Ex3.m1.1.1.3.3.cmml"><mi id="A3.Ex3.m1.1.1.3.3.2" xref="A3.Ex3.m1.1.1.3.3.2.cmml">i</mi><mo id="A3.Ex3.m1.1.1.3.3.1" xref="A3.Ex3.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A3.Ex3.m1.1.1.3.3.3" xref="A3.Ex3.m1.1.1.3.3.3.cmml">j</mi></mrow></msub><mrow id="A3.Ex3.m1.1.1.1" xref="A3.Ex3.m1.1.1.1.cmml"><mo id="A3.Ex3.m1.1.1.1.2" rspace="0em" xref="A3.Ex3.m1.1.1.1.2.cmml">∑</mo><mrow id="A3.Ex3.m1.1.1.1.3.2" xref="A3.Ex3.m1.1.1.1.cmml"><mo id="A3.Ex3.m1.1.1.1.3.2.1" stretchy="false" xref="A3.Ex3.m1.1.1.1.cmml">(</mo><mi id="A3.Ex3.m1.1.1.1.1" xref="A3.Ex3.m1.1.1.1.1.cmml">k</mi><mo id="A3.Ex3.m1.1.1.1.3.2.2" stretchy="false" xref="A3.Ex3.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A3.Ex3.m1.4.4.1.1.3.1" lspace="0.167em" xref="A3.Ex3.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="A3.Ex3.m1.4.4.1.1.3.2.2" xref="A3.Ex3.m1.4.4.1.1.3.2.1.cmml"><mi id="A3.Ex3.m1.3.3" xref="A3.Ex3.m1.3.3.cmml">log</mi><mo id="A3.Ex3.m1.4.4.1.1.3.2.2a" xref="A3.Ex3.m1.4.4.1.1.3.2.1.cmml">⁡</mo><mrow id="A3.Ex3.m1.4.4.1.1.3.2.2.1" xref="A3.Ex3.m1.4.4.1.1.3.2.1.cmml"><mo id="A3.Ex3.m1.4.4.1.1.3.2.2.1.1" xref="A3.Ex3.m1.4.4.1.1.3.2.1.cmml">(</mo><mfrac id="A3.Ex3.m1.2.2" xref="A3.Ex3.m1.2.2.cmml"><msub id="A3.Ex3.m1.2.2.3" xref="A3.Ex3.m1.2.2.3.cmml"><mi id="A3.Ex3.m1.2.2.3.2" xref="A3.Ex3.m1.2.2.3.2.cmml">k</mi><mrow id="A3.Ex3.m1.2.2.3.3" xref="A3.Ex3.m1.2.2.3.3.cmml"><mi id="A3.Ex3.m1.2.2.3.3.2" xref="A3.Ex3.m1.2.2.3.3.2.cmml">i</mi><mo id="A3.Ex3.m1.2.2.3.3.1" xref="A3.Ex3.m1.2.2.3.3.1.cmml">⁢</mo><mi id="A3.Ex3.m1.2.2.3.3.3" xref="A3.Ex3.m1.2.2.3.3.3.cmml">j</mi></mrow></msub><mrow id="A3.Ex3.m1.2.2.1" xref="A3.Ex3.m1.2.2.1.cmml"><mo id="A3.Ex3.m1.2.2.1.2" rspace="0em" xref="A3.Ex3.m1.2.2.1.2.cmml">∑</mo><mrow id="A3.Ex3.m1.2.2.1.3.2" xref="A3.Ex3.m1.2.2.1.cmml"><mo id="A3.Ex3.m1.2.2.1.3.2.1" stretchy="false" xref="A3.Ex3.m1.2.2.1.cmml">(</mo><mi id="A3.Ex3.m1.2.2.1.1" xref="A3.Ex3.m1.2.2.1.1.cmml">k</mi><mo id="A3.Ex3.m1.2.2.1.3.2.2" stretchy="false" xref="A3.Ex3.m1.2.2.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A3.Ex3.m1.4.4.1.1.3.2.2.1.2" xref="A3.Ex3.m1.4.4.1.1.3.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex3.m1.4.4.1.2" lspace="0em" xref="A3.Ex3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex3.m1.4b"><apply id="A3.Ex3.m1.4.4.1.1.cmml" xref="A3.Ex3.m1.4.4.1"><eq id="A3.Ex3.m1.4.4.1.1.1.cmml" xref="A3.Ex3.m1.4.4.1.1.1"></eq><ci id="A3.Ex3.m1.4.4.1.1.2.cmml" xref="A3.Ex3.m1.4.4.1.1.2">𝐻</ci><apply id="A3.Ex3.m1.4.4.1.1.3.cmml" xref="A3.Ex3.m1.4.4.1.1.3"><times id="A3.Ex3.m1.4.4.1.1.3.1.cmml" xref="A3.Ex3.m1.4.4.1.1.3.1"></times><apply id="A3.Ex3.m1.1.1.cmml" xref="A3.Ex3.m1.1.1"><divide id="A3.Ex3.m1.1.1.2.cmml" xref="A3.Ex3.m1.1.1"></divide><apply id="A3.Ex3.m1.1.1.3.cmml" xref="A3.Ex3.m1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.1.1.3.1.cmml" xref="A3.Ex3.m1.1.1.3">subscript</csymbol><ci id="A3.Ex3.m1.1.1.3.2.cmml" xref="A3.Ex3.m1.1.1.3.2">𝑘</ci><apply id="A3.Ex3.m1.1.1.3.3.cmml" xref="A3.Ex3.m1.1.1.3.3"><times id="A3.Ex3.m1.1.1.3.3.1.cmml" xref="A3.Ex3.m1.1.1.3.3.1"></times><ci id="A3.Ex3.m1.1.1.3.3.2.cmml" xref="A3.Ex3.m1.1.1.3.3.2">𝑖</ci><ci id="A3.Ex3.m1.1.1.3.3.3.cmml" xref="A3.Ex3.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="A3.Ex3.m1.1.1.1.cmml" xref="A3.Ex3.m1.1.1.1"><sum id="A3.Ex3.m1.1.1.1.2.cmml" xref="A3.Ex3.m1.1.1.1.2"></sum><ci id="A3.Ex3.m1.1.1.1.1.cmml" xref="A3.Ex3.m1.1.1.1.1">𝑘</ci></apply></apply><apply id="A3.Ex3.m1.4.4.1.1.3.2.1.cmml" xref="A3.Ex3.m1.4.4.1.1.3.2.2"><log id="A3.Ex3.m1.3.3.cmml" xref="A3.Ex3.m1.3.3"></log><apply id="A3.Ex3.m1.2.2.cmml" xref="A3.Ex3.m1.2.2"><divide id="A3.Ex3.m1.2.2.2.cmml" xref="A3.Ex3.m1.2.2"></divide><apply id="A3.Ex3.m1.2.2.3.cmml" xref="A3.Ex3.m1.2.2.3"><csymbol cd="ambiguous" id="A3.Ex3.m1.2.2.3.1.cmml" xref="A3.Ex3.m1.2.2.3">subscript</csymbol><ci id="A3.Ex3.m1.2.2.3.2.cmml" xref="A3.Ex3.m1.2.2.3.2">𝑘</ci><apply id="A3.Ex3.m1.2.2.3.3.cmml" xref="A3.Ex3.m1.2.2.3.3"><times id="A3.Ex3.m1.2.2.3.3.1.cmml" xref="A3.Ex3.m1.2.2.3.3.1"></times><ci id="A3.Ex3.m1.2.2.3.3.2.cmml" xref="A3.Ex3.m1.2.2.3.3.2">𝑖</ci><ci id="A3.Ex3.m1.2.2.3.3.3.cmml" xref="A3.Ex3.m1.2.2.3.3.3">𝑗</ci></apply></apply><apply id="A3.Ex3.m1.2.2.1.cmml" xref="A3.Ex3.m1.2.2.1"><sum id="A3.Ex3.m1.2.2.1.2.cmml" xref="A3.Ex3.m1.2.2.1.2"></sum><ci id="A3.Ex3.m1.2.2.1.1.cmml" xref="A3.Ex3.m1.2.2.1.1">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex3.m1.4c">H=\frac{k_{ij}}{\sum(k)}\log\left(\frac{k_{ij}}{\sum(k)}\right).</annotation><annotation encoding="application/x-llamapun" id="A3.Ex3.m1.4d">italic_H = divide start_ARG italic_k start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∑ ( italic_k ) end_ARG roman_log ( divide start_ARG italic_k start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∑ ( italic_k ) end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A3.p4">
<p class="ltx_p" id="A3.p4.1">In our case, when calculating the similarity measure between a medical event and the recommendation of a specific drug, we calculated the LLR value by the counts that co-occurred between them.
The average LLR for each medical event with all recommended drugs was calculated as the properties of the medical event node
<cite class="ltx_cite ltx_citemacro_citep">(Dunning, <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#bib.bib8" title="">1994</a>)</cite>.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Implementation Details</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">The models mentioned were implemented by PyTorch 2.0.1 based on Python 3.8.8,
All experiments are conducted on an Intel Core i9-10980XE machine with 125G RAM and an NVIDIA GeForce RTX 3090.
For the experiments on both datasets, we chose the optimal hyperparameters based on the validation set.
Models were trained on Adam optimizer with learning rate <math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A4.p1.1.m1.1"><semantics id="A4.p1.1.m1.1a"><mrow id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml"><mn id="A4.p1.1.m1.1.1.2" xref="A4.p1.1.m1.1.1.2.cmml">1</mn><mo id="A4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.p1.1.m1.1.1.1.cmml">×</mo><msup id="A4.p1.1.m1.1.1.3" xref="A4.p1.1.m1.1.1.3.cmml"><mn id="A4.p1.1.m1.1.1.3.2" xref="A4.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="A4.p1.1.m1.1.1.3.3" xref="A4.p1.1.m1.1.1.3.3.cmml"><mo id="A4.p1.1.m1.1.1.3.3a" xref="A4.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="A4.p1.1.m1.1.1.3.3.2" xref="A4.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><apply id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1"><times id="A4.p1.1.m1.1.1.1.cmml" xref="A4.p1.1.m1.1.1.1"></times><cn id="A4.p1.1.m1.1.1.2.cmml" type="integer" xref="A4.p1.1.m1.1.1.2">1</cn><apply id="A4.p1.1.m1.1.1.3.cmml" xref="A4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.1.m1.1.1.3.1.cmml" xref="A4.p1.1.m1.1.1.3">superscript</csymbol><cn id="A4.p1.1.m1.1.1.3.2.cmml" type="integer" xref="A4.p1.1.m1.1.1.3.2">10</cn><apply id="A4.p1.1.m1.1.1.3.3.cmml" xref="A4.p1.1.m1.1.1.3.3"><minus id="A4.p1.1.m1.1.1.3.3.1.cmml" xref="A4.p1.1.m1.1.1.3.3"></minus><cn id="A4.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="A4.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for 200 epochs.
The random seed was fixed as 0 for PyTorch to ensure the reproducibility of the models.</p>
</div>
<div class="ltx_para" id="A4.p2">
<p class="ltx_p" id="A4.p2.1">For a fair comparison, we employed bootstrapping sampling instead of cross-validation in the testing phase.
Specifically, in each evaluation round, we randomly sampled <math alttext="80\%" class="ltx_Math" display="inline" id="A4.p2.1.m1.1"><semantics id="A4.p2.1.m1.1a"><mrow id="A4.p2.1.m1.1.1" xref="A4.p2.1.m1.1.1.cmml"><mn id="A4.p2.1.m1.1.1.2" xref="A4.p2.1.m1.1.1.2.cmml">80</mn><mo id="A4.p2.1.m1.1.1.1" xref="A4.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.1b"><apply id="A4.p2.1.m1.1.1.cmml" xref="A4.p2.1.m1.1.1"><csymbol cd="latexml" id="A4.p2.1.m1.1.1.1.cmml" xref="A4.p2.1.m1.1.1.1">percent</csymbol><cn id="A4.p2.1.m1.1.1.2.cmml" type="integer" xref="A4.p2.1.m1.1.1.2">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">80\%</annotation><annotation encoding="application/x-llamapun" id="A4.p2.1.m1.1d">80 %</annotation></semantics></math> of the data from the test set.
We repeated this process 10 times to obtain the final results.
These results from 10 rounds were then used to calculate both the mean and standard deviation.
The means are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.09410v3#S5.T2" title="Table 2 ‣ 5.1 Databases ‣ 5 Experiments ‣ BernGraph: Probabilistic Graph Neural Networks for EHR-based Medication Recommendations"><span class="ltx_text ltx_ref_tag">2</span></a>.
The standard deviations are all under 0.05.</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 11 02:13:56 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
