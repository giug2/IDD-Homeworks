<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2308.04373] Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning</title><meta property="og:description" content="The main premise of federated learning is that machine learning model updates are computed locally, in particular to preserve user data privacy, as those never leave the perimeter of their device.
This mechanism suppos…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2308.04373">

<!--Generated on Wed Feb 28 13:41:34 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="federated learning,  evasion attacks,  mitigations,  trusted execution environment">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Pelta: Shielding Transformers to Mitigate
<br class="ltx_break">Evasion Attacks in Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Simon Queyrut
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-1354-9604" title="ORCID identifier" class="ltx_ref">0000-0002-1354-9604</a></span>

<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">University of Neuchâtel</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_city">Neuchâtel</span><span id="id3.3.id3" class="ltx_text ltx_affiliation_country">Switzerland</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:simon.queyrut@unine.ch">simon.queyrut@unine.ch</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yérom-David Bromberg
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-3812-3546" title="ORCID identifier" class="ltx_ref">0000-0002-3812-3546</a></span>

<span class="ltx_contact ltx_role_affiliation"><span id="id4.1.id1" class="ltx_text ltx_affiliation_institution">University of Rennes 1 - Inria - IRISA</span><span id="id5.2.id2" class="ltx_text ltx_affiliation_city">Rennes</span><span id="id6.3.id3" class="ltx_text ltx_affiliation_country">France</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:david.bromberg@irisa.fr">david.bromberg@irisa.fr</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Valerio Schiavoni
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0003-1493-6603" title="ORCID identifier" class="ltx_ref">0000-0003-1493-6603</a></span>

<span class="ltx_contact ltx_role_affiliation"><span id="id7.1.id1" class="ltx_text ltx_affiliation_institution">University of Neuchâtel</span><span id="id8.2.id2" class="ltx_text ltx_affiliation_city">Neuchâtel</span><span id="id9.3.id3" class="ltx_text ltx_affiliation_country">Switzerland</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:valerio.schiavoni@unine.ch">valerio.schiavoni@unine.ch</a>
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id10.id1" class="ltx_p">The main premise of federated learning is that machine learning model updates are computed locally, in particular to preserve user data privacy, as those never leave the perimeter of their device.
This mechanism supposes the general model, once aggregated, to be broadcast to collaborating and non malicious nodes.
However, without proper defenses, compromised clients can easily probe the model inside their local memory in search of adversarial examples.
For instance, considering image-based applications, adversarial examples consist of imperceptibly perturbed images (to the human eye) misclassified by the local model, which can be later presented to a victim node’s counterpart model to replicate the attack.
To mitigate such malicious probing, we introduce <span id="id10.id1.1" class="ltx_text ltx_font_smallcaps">Pelta</span>, a novel shielding mechanism leveraging trusted hardware.
By harnessing the capabilities of Trusted Execution Environments (TEEs), <span id="id10.id1.2" class="ltx_text ltx_font_smallcaps">Pelta</span> masks part of the back-propagation chain rule, otherwise typically exploited by attackers for the design of malicious samples.
We evaluate <span id="id10.id1.3" class="ltx_text ltx_font_smallcaps">Pelta</span> on a state of the art ensemble model and demonstrate its effectiveness against the Self Attention Gradient adversarial Attack.</p>
</div>
<div class="ltx_keywords">federated learning, evasion attacks, mitigations, trusted execution environment
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Machine learning</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Security and privacy</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Machine learning</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">With the proliferation of edge devices and small-scale local servers comes an ever increasing trove of data.
Examples include smart homes, medical infrastructures, mobile phones, <span id="S1.p1.1.1" class="ltx_ERROR undefined">\etc</span>.
A common trend is to deploy and execute data-driven machine learning (ML) algorithms directly at edge on such devices for a large diversity of purposes.
However, without proper mechanisms, users are by default set to share their data for the training process.
As an alternative and to protect user privacy when training a ML model, federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(Konečný et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2016</a>; Kairouz et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> lets non-malicious clients send to a trusted server their individual updates of a shared model.
In turn, the trusted server aggregates such updates, before broadcasting the updated model to each clients.
This approach prevents the user-data from ever leaving the user node from a given device.
Also, the updated model is used to compute the next update with a fresh batch of local data, as soon as it is received by each client.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2308.04373/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="156" height="55" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>. </span><span id="S1.F1.5.2" class="ltx_text" style="font-size:90%;">Federated learning under trusted and compromised nodes. <span id="S1.F1.5.2.1" class="ltx_text ltx_font_smallcaps">Pelta</span> shields against evasion attacks.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Transformers <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a href="#bib.bib49" title="" class="ltx_ref">2017</a>)</cite> are popular multi-purpose deep learning (DL) models.
They harness the so-called <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">self-attention mechanism</span>, which weighs the relative positions of tokens inside a single input sequence to compute a representation of that given sequence.
Transformers create a rich and high-performing continuous representation of the whole input text or image <cite class="ltx_cite ltx_citemacro_citep">(Raganato and Tiedemann, <a href="#bib.bib39" title="" class="ltx_ref">2018</a>)</cite>, effectively used across a diverse range of tasks, yielding state of the art results in several areas, <span id="S1.p2.1.2" class="ltx_ERROR undefined">\eg</span>language modeling <cite class="ltx_cite ltx_citemacro_citep">(Shoeybi et al<span class="ltx_text">.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2019</a>; Brown et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>, translation <cite class="ltx_cite ltx_citemacro_citep">(Takase and Kiyono, <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>, audio classification <cite class="ltx_cite ltx_citemacro_citep">(Nagrani et al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2021</a>)</cite>, computer vision tasks such as image classification with Vision Transformer models (ViT) <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>, object detection <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a href="#bib.bib50" title="" class="ltx_ref">2022</a>)</cite>, semantic segmentation <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite>, <span id="S1.p2.1.3" class="ltx_ERROR undefined">\etc</span>.
In the FL training context, both the fine tuning of Transformer-based models pre-trained on large-scale data and the training of their lightweight counterparts have sparked interest in industry and academia <cite class="ltx_cite ltx_citemacro_citep">(Ro et al<span class="ltx_text">.</span>, <a href="#bib.bib41" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, we assume an FL scenario with compromised nodes (see Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Because it is the hardest to defend against, we consider the <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">white-box</em> setting, <span id="S1.p3.1.2" class="ltx_ERROR undefined">\ie</span>the model’s characteristics are completely known, and an attacker can leverage gradient computation inside the model to craft adversarial examples.
For instance, in the case of vision classification, an attacker leverages the model’s gradients to craft images designed to fool a classifier while appearing seemingly unaltered to humans, launching a so-called gradient-based <em id="S1.p3.1.3" class="ltx_emph ltx_font_italic">evasion</em> (or <em id="S1.p3.1.4" class="ltx_emph ltx_font_italic">adversarial</em>) <em id="S1.p3.1.5" class="ltx_emph ltx_font_italic">attack</em> <cite class="ltx_cite ltx_citemacro_citep">(Goodfellow et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2015</a>; Biggio et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2013</a>; Szegedy et al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2014</a>)</cite>.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>While we use Vision Transformers for illustration and description purposes, the mitigation mechanisms presented and implemented later are directly applicable to other classes of models including DNNs or Transformers, such as those for NLP, audio processing, <span id="footnote1.1" class="ltx_ERROR undefined">\etc</span>.</span></span></span>
In a FL context. compromised clients can probe their own device memory to launch an evasion attack against ViT. In a white-box scenario, these attacks exploit the model in clear at inference time, by perturbing the input and having it misclassified. Such perturbations are typically an additive mask crafted by following the collected gradients of the loss w.r.t the input pixels and applying it to the input signal.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose <span id="S1.p4.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span>: it is a defense that mitigates gradient-based evasion attacks on a client node launched during inference by leveraging hardware obfuscation to hide a few in-memory values, <span id="S1.p4.1.2" class="ltx_ERROR undefined">\ie</span>those close to the input and produced by the model during each pass.
This leaves the attackers unable to complete the chain-rule of the back-propagation algorithm and compute the perturbation to update his adversarial sample.
To this end, we rely on hardare-enabled trusted execution environments (TEE), by means of enclaves, secure areas of a processor offering privacy and integrity guarantees.
Notable examples include Intel SGX <cite class="ltx_cite ltx_citemacro_citep">(Costan and Devadas, <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite> or Arm TrustZone <cite class="ltx_cite ltx_citemacro_citep">(Amacher and Schiavoni, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>.
TEEs can lead to a restriced white-box scenario, <span id="S1.p4.1.3" class="ltx_ERROR undefined">\ie</span>, a stricter setting in which the attacker cannot access absolutely everything from the model he seeks to defeat,
hence impairing his white-box attack protocols designed for the looser hypothesis.
In our context, we deal specifically with TrustZone, given its vast adoption, performance <cite class="ltx_cite ltx_citemacro_citep">(Amacher and Schiavoni, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite> and support for attestation <cite class="ltx_cite ltx_citemacro_citep">(Ménétrey et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite>.
However, TrustZone enclaves have limited memory (up to 30 MB in some scenarios), making it challenging to completely shield the state of the art Transformer architectures often larger than 500 MB. This constraint therefore calls for such a hardware defense to be a light, partial obfuscation of the model.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Our main contributions are as follows:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(i)</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We show that it is possible to mitigate evasion attacks during inference in a FL context through hardware shielding.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(ii)</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We describe the operating principles of <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span>, our lightweight gradient masking defense scheme.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(iii)</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We apply <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span> to shield layers of a state of the art ensemble model against the Self-Attention blended Gradient Attack to show the scheme effectively provides high protection in a nigh white-box setting.</p>
</div>
</li>
</ol>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The rest of the paper is as follows.
§<a href="#S2" title="2. Related Work ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> surveys related work.
§<a href="#S3" title="3. Threat Model ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> presents our threat model.
§<a href="#S4" title="4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> describes the principles of the <span id="S1.p6.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span> shielding defense.
We evaluate it on an ensemble model against a gradient-based attack and discuss the results in §<a href="#S5" title="5. Evaluation ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
Finally, we conclude and discuss future work in §<a href="#S6" title="6. Conclusion and Future Work ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">A significant body of work exists towards defending against adversarial attacks in a white-box context <cite class="ltx_cite ltx_citemacro_citep">(Carlini, <a href="#bib.bib12" title="" class="ltx_ref">2019</a>)</cite>. Because of its few-constraints hypothesis, particular endeavour is directed towards refining adversarial training (AT) methods <cite class="ltx_cite ltx_citemacro_citep">(Qian et al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2022</a>; Bai et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2021</a>)</cite>.
However, recent studies show a trade-off between a model’s generalization capabilities (<span id="S2.p1.1.1" class="ltx_ERROR undefined">\ie</span>, its standard test accuracy) and its robust accuracy <cite class="ltx_cite ltx_citemacro_citep">(Raghunathan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2019</a>; Nakkiran, <a href="#bib.bib35" title="" class="ltx_ref">2019</a>; Tsipras et al<span class="ltx_text">.</span>, <a href="#bib.bib48" title="" class="ltx_ref">2019</a>; Chen et al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite>.
AT can also expose the model to new threats <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a href="#bib.bib54" title="" class="ltx_ref">2022</a>)</cite> and, perhaps even more remarkably, increase robust error at times <cite class="ltx_cite ltx_citemacro_citep">(Clarysse et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite>.
It is possible to use AT at training time as a defense in the federated learning context <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> but it creates its own sensitive exposure to a potentially malicious server.
The latter can restore a feature vector that is tightly approximated when the probability assigned to the ground-truth class is low (which is the case for an adversarial example) <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a href="#bib.bib53" title="" class="ltx_ref">2019</a>)</cite>.
Thus, the server may reconstruct adversarial samples of its client nodes, successfully allowing for privacy breach through an <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">inversion attack</em>, <span id="S2.p1.1.3" class="ltx_ERROR undefined">\ie</span>, reconstructing elements of private data in other nodes’ devices.
Surprisingly, <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> also uses randomisation at inference time <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a href="#bib.bib51" title="" class="ltx_ref">2019</a>)</cite> to defend against iterative gradient-based adversarial attacks, even though much earlier work expresses worrying reserves about such practice <cite class="ltx_cite ltx_citemacro_citep">(Athalye et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">In FL, where privacy of the users is paramount, defending against inversion is not on par with the security of the model in itself and attempts at bridging the two are ongoing <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite>.
These attempts focus on defending the model at training time or against <em id="S2.p2.1.1" class="ltx_emph ltx_font_italic">poisoning</em>, <span id="S2.p2.1.2" class="ltx_ERROR undefined">\ie</span>, altering the model’s parameters to have it underperfom in its primary task or overperform in a secondary task unbeknownst to the server or the nodes.
On the other hand, defenses against inversion attacks have seen a surge since the introduction of FL.
DarkneTZ <cite class="ltx_cite ltx_citemacro_citep">(Mo et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite>, PPFL <cite class="ltx_cite ltx_citemacro_citep">(Mo et al<span class="ltx_text">.</span>, <a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite> and GradSec <cite class="ltx_cite ltx_citemacro_citep">(Messaoud et al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2022</a>)</cite> mitigate these attacks with the use of a TEE.
By protecting sensitive parameters, activations and gradients inside the enclave memory, the risk of gradient leakage is alleviated and the white-box setting is effectively limited, thus weakening the threat.
However, <span id="S2.p2.1.3" class="ltx_text ltx_font_smallcaps">Pelta</span> is conceptually different from these methods, as it does not consider the gradient of the loss <em id="S2.p2.1.4" class="ltx_emph ltx_font_italic">w.r.t.</em> the parameters, but <em id="S2.p2.1.5" class="ltx_emph ltx_font_italic">w.r.t.</em> the input image instead.
The former can be revealing private training data samples in the course of an inversion attack, while the latter only ever directs the perturbation applied to an input when conducting an adversarial attack.
Other enclave-based defenses do not focus on adversarial attacks, are based on SGX (meaning looser enclave constraints) and do not deal with ML computational graphs in general <cite class="ltx_cite ltx_citemacro_citep">(Benkraouda and Nahrstedt, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>; Hanzlik et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>, yet present defense architectures of layers that fit our case <cite class="ltx_cite ltx_citemacro_citep">(Gu et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2018</a>)</cite>.
Where those were tested only for CNN-based architectures or simple DNNs, <span id="S2.p2.1.6" class="ltx_text ltx_font_smallcaps">Pelta</span> can protect a larger, more accurate Transformer-based architecture.
The robustness of the two types against adversarial attacks was compared in prior studies <cite class="ltx_cite ltx_citemacro_citep">(Benz et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Mahmood et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2021</a>; Aldahdooh et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">In <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite>, authors mitigate inference time evasion attacks by pairing the distributed model with a node-specific <em id="S2.p3.1.1" class="ltx_emph ltx_font_italic">attractor</em>, which detects adversarial perturbations, before distributing it.
However, <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite> assumes the nodes only have black-box access to their local model.
Given the current limitations on the size of encrypted memory in particular for TrustZone enclaves <cite class="ltx_cite ltx_citemacro_citep">(Amacher and Schiavoni, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>, it is currently unfeasible to completely shield models such as VGG-16 or larger.
This is why <span id="S2.p3.1.2" class="ltx_text ltx_font_smallcaps">Pelta</span> aims at exploring a more reasonable use case of the hardware obfuscation features of TrustZone by shielding only a subset of the total layers, as we detail more later.
It could thus be used as an overlay to the aforementioned study.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Overall, gradient obfuscations as a defense mechanism against evasion attacks have been studied in the past <cite class="ltx_cite ltx_citemacro_citep">(Athalye et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>; Tramèr et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2018</a>)</cite>.
Authors discuss from a theoretical perspective the fragility of relying on masking techniques.
Instead, we show that it fares well protecting a state of the art architecture against inference time gradient-based evasion attacks even by using off-the-shelf hardware with limited resources.
We further elaborate on the strong ties to the Backward Pass Differentiable Approximation (BPDA) attack <cite class="ltx_cite ltx_citemacro_citep">(Athalye et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> in §<a href="#S4" title="4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Threat Model</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.2" class="ltx_p">We assume an honest-but-curious client attacker, which do not tamper with the FL process and message flow.
The normal message exchanges defined by the protocol are not altered. Attackers have full access to the model.
A subset of the layers are <em id="S3.p1.2.1" class="ltx_emph ltx_font_italic">shielded</em>, under a restricted white-box setting.
A layer <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">l</annotation></semantics></math> is shielded (as opposed to its normal <span id="S3.p1.2.2" class="ltx_text ltx_font_italic">clear</span> state) if some variables and operations that directly lead to computing gradient values from this layer are obfuscated, <span id="S3.p1.2.3" class="ltx_ERROR undefined">\ie</span>hidden from an attacker.
In a typical deep neural network (DNN) <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">f</annotation></semantics></math> such that</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="f=\operatorname{softmax}\circ f^{n}\circ f^{n-1}\circ\cdots\circ f^{1}" display="block"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">f</mi><mo id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml">softmax</mi><mo lspace="0em" rspace="0.222em" id="S3.Ex1.m1.1.1.3.1" xref="S3.Ex1.m1.1.1.3.1.cmml">∘</mo><msup id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.3.3.2.cmml">f</mi><mi id="S3.Ex1.m1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.3.3.3.cmml">n</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.Ex1.m1.1.1.3.1a" xref="S3.Ex1.m1.1.1.3.1.cmml">∘</mo><msup id="S3.Ex1.m1.1.1.3.4" xref="S3.Ex1.m1.1.1.3.4.cmml"><mi id="S3.Ex1.m1.1.1.3.4.2" xref="S3.Ex1.m1.1.1.3.4.2.cmml">f</mi><mrow id="S3.Ex1.m1.1.1.3.4.3" xref="S3.Ex1.m1.1.1.3.4.3.cmml"><mi id="S3.Ex1.m1.1.1.3.4.3.2" xref="S3.Ex1.m1.1.1.3.4.3.2.cmml">n</mi><mo id="S3.Ex1.m1.1.1.3.4.3.1" xref="S3.Ex1.m1.1.1.3.4.3.1.cmml">−</mo><mn id="S3.Ex1.m1.1.1.3.4.3.3" xref="S3.Ex1.m1.1.1.3.4.3.3.cmml">1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em" id="S3.Ex1.m1.1.1.3.1b" xref="S3.Ex1.m1.1.1.3.1.cmml">∘</mo><mi mathvariant="normal" id="S3.Ex1.m1.1.1.3.5" xref="S3.Ex1.m1.1.1.3.5.cmml">⋯</mi><mo lspace="0.222em" rspace="0.222em" id="S3.Ex1.m1.1.1.3.1c" xref="S3.Ex1.m1.1.1.3.1.cmml">∘</mo><msup id="S3.Ex1.m1.1.1.3.6" xref="S3.Ex1.m1.1.1.3.6.cmml"><mi id="S3.Ex1.m1.1.1.3.6.2" xref="S3.Ex1.m1.1.1.3.6.2.cmml">f</mi><mn id="S3.Ex1.m1.1.1.3.6.3" xref="S3.Ex1.m1.1.1.3.6.3.cmml">1</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><eq id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"></eq><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">𝑓</ci><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><compose id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3.1"></compose><ci id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2">softmax</ci><apply id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.1.1.3.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.1.1.3.3.2">𝑓</ci><ci id="S3.Ex1.m1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3.3">𝑛</ci></apply><apply id="S3.Ex1.m1.1.1.3.4.cmml" xref="S3.Ex1.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.4.1.cmml" xref="S3.Ex1.m1.1.1.3.4">superscript</csymbol><ci id="S3.Ex1.m1.1.1.3.4.2.cmml" xref="S3.Ex1.m1.1.1.3.4.2">𝑓</ci><apply id="S3.Ex1.m1.1.1.3.4.3.cmml" xref="S3.Ex1.m1.1.1.3.4.3"><minus id="S3.Ex1.m1.1.1.3.4.3.1.cmml" xref="S3.Ex1.m1.1.1.3.4.3.1"></minus><ci id="S3.Ex1.m1.1.1.3.4.3.2.cmml" xref="S3.Ex1.m1.1.1.3.4.3.2">𝑛</ci><cn type="integer" id="S3.Ex1.m1.1.1.3.4.3.3.cmml" xref="S3.Ex1.m1.1.1.3.4.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.1.1.3.5.cmml" xref="S3.Ex1.m1.1.1.3.5">⋯</ci><apply id="S3.Ex1.m1.1.1.3.6.cmml" xref="S3.Ex1.m1.1.1.3.6"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.6.1.cmml" xref="S3.Ex1.m1.1.1.3.6">superscript</csymbol><ci id="S3.Ex1.m1.1.1.3.6.2.cmml" xref="S3.Ex1.m1.1.1.3.6.2">𝑓</ci><cn type="integer" id="S3.Ex1.m1.1.1.3.6.3.cmml" xref="S3.Ex1.m1.1.1.3.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">f=\operatorname{softmax}\circ f^{n}\circ f^{n-1}\circ\cdots\circ f^{1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p1.9" class="ltx_p">with layer <math id="S3.p1.3.m1.1" class="ltx_Math" alttext="f^{i}=\sigma^{i}(W^{i}\cdot x+b^{i})" display="inline"><semantics id="S3.p1.3.m1.1a"><mrow id="S3.p1.3.m1.1.1" xref="S3.p1.3.m1.1.1.cmml"><msup id="S3.p1.3.m1.1.1.3" xref="S3.p1.3.m1.1.1.3.cmml"><mi id="S3.p1.3.m1.1.1.3.2" xref="S3.p1.3.m1.1.1.3.2.cmml">f</mi><mi id="S3.p1.3.m1.1.1.3.3" xref="S3.p1.3.m1.1.1.3.3.cmml">i</mi></msup><mo id="S3.p1.3.m1.1.1.2" xref="S3.p1.3.m1.1.1.2.cmml">=</mo><mrow id="S3.p1.3.m1.1.1.1" xref="S3.p1.3.m1.1.1.1.cmml"><msup id="S3.p1.3.m1.1.1.1.3" xref="S3.p1.3.m1.1.1.1.3.cmml"><mi id="S3.p1.3.m1.1.1.1.3.2" xref="S3.p1.3.m1.1.1.1.3.2.cmml">σ</mi><mi id="S3.p1.3.m1.1.1.1.3.3" xref="S3.p1.3.m1.1.1.1.3.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="S3.p1.3.m1.1.1.1.2" xref="S3.p1.3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.p1.3.m1.1.1.1.1.1" xref="S3.p1.3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.3.m1.1.1.1.1.1.2" xref="S3.p1.3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.3.m1.1.1.1.1.1.1" xref="S3.p1.3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.p1.3.m1.1.1.1.1.1.1.2" xref="S3.p1.3.m1.1.1.1.1.1.1.2.cmml"><msup id="S3.p1.3.m1.1.1.1.1.1.1.2.2" xref="S3.p1.3.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.p1.3.m1.1.1.1.1.1.1.2.2.2" xref="S3.p1.3.m1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.p1.3.m1.1.1.1.1.1.1.2.2.3" xref="S3.p1.3.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.p1.3.m1.1.1.1.1.1.1.2.1" xref="S3.p1.3.m1.1.1.1.1.1.1.2.1.cmml">⋅</mo><mi id="S3.p1.3.m1.1.1.1.1.1.1.2.3" xref="S3.p1.3.m1.1.1.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="S3.p1.3.m1.1.1.1.1.1.1.1" xref="S3.p1.3.m1.1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.p1.3.m1.1.1.1.1.1.1.3" xref="S3.p1.3.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.3.m1.1.1.1.1.1.1.3.2" xref="S3.p1.3.m1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.p1.3.m1.1.1.1.1.1.1.3.3" xref="S3.p1.3.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msup></mrow><mo stretchy="false" id="S3.p1.3.m1.1.1.1.1.1.3" xref="S3.p1.3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m1.1b"><apply id="S3.p1.3.m1.1.1.cmml" xref="S3.p1.3.m1.1.1"><eq id="S3.p1.3.m1.1.1.2.cmml" xref="S3.p1.3.m1.1.1.2"></eq><apply id="S3.p1.3.m1.1.1.3.cmml" xref="S3.p1.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.3.m1.1.1.3.1.cmml" xref="S3.p1.3.m1.1.1.3">superscript</csymbol><ci id="S3.p1.3.m1.1.1.3.2.cmml" xref="S3.p1.3.m1.1.1.3.2">𝑓</ci><ci id="S3.p1.3.m1.1.1.3.3.cmml" xref="S3.p1.3.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.p1.3.m1.1.1.1.cmml" xref="S3.p1.3.m1.1.1.1"><times id="S3.p1.3.m1.1.1.1.2.cmml" xref="S3.p1.3.m1.1.1.1.2"></times><apply id="S3.p1.3.m1.1.1.1.3.cmml" xref="S3.p1.3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.3.m1.1.1.1.3.1.cmml" xref="S3.p1.3.m1.1.1.1.3">superscript</csymbol><ci id="S3.p1.3.m1.1.1.1.3.2.cmml" xref="S3.p1.3.m1.1.1.1.3.2">𝜎</ci><ci id="S3.p1.3.m1.1.1.1.3.3.cmml" xref="S3.p1.3.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.p1.3.m1.1.1.1.1.1.1.cmml" xref="S3.p1.3.m1.1.1.1.1.1"><plus id="S3.p1.3.m1.1.1.1.1.1.1.1.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.1"></plus><apply id="S3.p1.3.m1.1.1.1.1.1.1.2.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.2"><ci id="S3.p1.3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.2.1">⋅</ci><apply id="S3.p1.3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.p1.3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.p1.3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.2.3">𝑥</ci></apply><apply id="S3.p1.3.m1.1.1.1.1.1.1.3.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.p1.3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.p1.3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.3.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m1.1c">f^{i}=\sigma^{i}(W^{i}\cdot x+b^{i})</annotation></semantics></math> (<math id="S3.p1.4.m2.1" class="ltx_Math" alttext="\sigma^{i}" display="inline"><semantics id="S3.p1.4.m2.1a"><msup id="S3.p1.4.m2.1.1" xref="S3.p1.4.m2.1.1.cmml"><mi id="S3.p1.4.m2.1.1.2" xref="S3.p1.4.m2.1.1.2.cmml">σ</mi><mi id="S3.p1.4.m2.1.1.3" xref="S3.p1.4.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.4.m2.1b"><apply id="S3.p1.4.m2.1.1.cmml" xref="S3.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m2.1.1.1.cmml" xref="S3.p1.4.m2.1.1">superscript</csymbol><ci id="S3.p1.4.m2.1.1.2.cmml" xref="S3.p1.4.m2.1.1.2">𝜎</ci><ci id="S3.p1.4.m2.1.1.3.cmml" xref="S3.p1.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m2.1c">\sigma^{i}</annotation></semantics></math> are activation functions), this implies, from left (close to the input) to right (close to loss computation):
the input of the layer <math id="S3.p1.5.m3.1" class="ltx_Math" alttext="a^{l-1}" display="inline"><semantics id="S3.p1.5.m3.1a"><msup id="S3.p1.5.m3.1.1" xref="S3.p1.5.m3.1.1.cmml"><mi id="S3.p1.5.m3.1.1.2" xref="S3.p1.5.m3.1.1.2.cmml">a</mi><mrow id="S3.p1.5.m3.1.1.3" xref="S3.p1.5.m3.1.1.3.cmml"><mi id="S3.p1.5.m3.1.1.3.2" xref="S3.p1.5.m3.1.1.3.2.cmml">l</mi><mo id="S3.p1.5.m3.1.1.3.1" xref="S3.p1.5.m3.1.1.3.1.cmml">−</mo><mn id="S3.p1.5.m3.1.1.3.3" xref="S3.p1.5.m3.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.5.m3.1b"><apply id="S3.p1.5.m3.1.1.cmml" xref="S3.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m3.1.1.1.cmml" xref="S3.p1.5.m3.1.1">superscript</csymbol><ci id="S3.p1.5.m3.1.1.2.cmml" xref="S3.p1.5.m3.1.1.2">𝑎</ci><apply id="S3.p1.5.m3.1.1.3.cmml" xref="S3.p1.5.m3.1.1.3"><minus id="S3.p1.5.m3.1.1.3.1.cmml" xref="S3.p1.5.m3.1.1.3.1"></minus><ci id="S3.p1.5.m3.1.1.3.2.cmml" xref="S3.p1.5.m3.1.1.3.2">𝑙</ci><cn type="integer" id="S3.p1.5.m3.1.1.3.3.cmml" xref="S3.p1.5.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m3.1c">a^{l-1}</annotation></semantics></math>;
its weight <math id="S3.p1.6.m4.1" class="ltx_Math" alttext="W^{l}" display="inline"><semantics id="S3.p1.6.m4.1a"><msup id="S3.p1.6.m4.1.1" xref="S3.p1.6.m4.1.1.cmml"><mi id="S3.p1.6.m4.1.1.2" xref="S3.p1.6.m4.1.1.2.cmml">W</mi><mi id="S3.p1.6.m4.1.1.3" xref="S3.p1.6.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.6.m4.1b"><apply id="S3.p1.6.m4.1.1.cmml" xref="S3.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m4.1.1.1.cmml" xref="S3.p1.6.m4.1.1">superscript</csymbol><ci id="S3.p1.6.m4.1.1.2.cmml" xref="S3.p1.6.m4.1.1.2">𝑊</ci><ci id="S3.p1.6.m4.1.1.3.cmml" xref="S3.p1.6.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m4.1c">W^{l}</annotation></semantics></math> and bias <math id="S3.p1.7.m5.1" class="ltx_Math" alttext="b^{l}" display="inline"><semantics id="S3.p1.7.m5.1a"><msup id="S3.p1.7.m5.1.1" xref="S3.p1.7.m5.1.1.cmml"><mi id="S3.p1.7.m5.1.1.2" xref="S3.p1.7.m5.1.1.2.cmml">b</mi><mi id="S3.p1.7.m5.1.1.3" xref="S3.p1.7.m5.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.7.m5.1b"><apply id="S3.p1.7.m5.1.1.cmml" xref="S3.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m5.1.1.1.cmml" xref="S3.p1.7.m5.1.1">superscript</csymbol><ci id="S3.p1.7.m5.1.1.2.cmml" xref="S3.p1.7.m5.1.1.2">𝑏</ci><ci id="S3.p1.7.m5.1.1.3.cmml" xref="S3.p1.7.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m5.1c">b^{l}</annotation></semantics></math>;
its output <math id="S3.p1.8.m6.1" class="ltx_Math" alttext="z^{l}" display="inline"><semantics id="S3.p1.8.m6.1a"><msup id="S3.p1.8.m6.1.1" xref="S3.p1.8.m6.1.1.cmml"><mi id="S3.p1.8.m6.1.1.2" xref="S3.p1.8.m6.1.1.2.cmml">z</mi><mi id="S3.p1.8.m6.1.1.3" xref="S3.p1.8.m6.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.8.m6.1b"><apply id="S3.p1.8.m6.1.1.cmml" xref="S3.p1.8.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m6.1.1.1.cmml" xref="S3.p1.8.m6.1.1">superscript</csymbol><ci id="S3.p1.8.m6.1.1.2.cmml" xref="S3.p1.8.m6.1.1.2">𝑧</ci><ci id="S3.p1.8.m6.1.1.3.cmml" xref="S3.p1.8.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m6.1c">z^{l}</annotation></semantics></math> and parametric transform <math id="S3.p1.9.m7.1" class="ltx_Math" alttext="a^{l}" display="inline"><semantics id="S3.p1.9.m7.1a"><msup id="S3.p1.9.m7.1.1" xref="S3.p1.9.m7.1.1.cmml"><mi id="S3.p1.9.m7.1.1.2" xref="S3.p1.9.m7.1.1.2.cmml">a</mi><mi id="S3.p1.9.m7.1.1.3" xref="S3.p1.9.m7.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.9.m7.1b"><apply id="S3.p1.9.m7.1.1.cmml" xref="S3.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m7.1.1.1.cmml" xref="S3.p1.9.m7.1.1">superscript</csymbol><ci id="S3.p1.9.m7.1.1.2.cmml" xref="S3.p1.9.m7.1.1.2">𝑎</ci><ci id="S3.p1.9.m7.1.1.3.cmml" xref="S3.p1.9.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m7.1c">a^{l}</annotation></semantics></math>.
In general terms, a layer encompasses at least one or two transformations.
The attacker probes its own local copy of the model to search for adversarial examples, ultimately to present those to victim nodes and replicate the misclassification by their own copy of the model. 
</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Design</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We explain first the design of <span id="S4.p1.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span> shielding of a model, with details on the general mechanisms and the shielding approach in §<a href="#S4.SS2" title="4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.
Then, we confront <span id="S4.p1.1.2" class="ltx_text ltx_font_smallcaps">Pelta</span> to the case of the BPDA <cite class="ltx_cite ltx_citemacro_citep">(Athalye et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> attack in §<a href="#S4.SS3" title="4.3. Relation with BPDA ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Back-Propagation Principles and Limits</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.6" class="ltx_p">Recall the back-propagation mechanism; consider a computational graph node <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">x</annotation></semantics></math>, its immediate (<span id="S4.SS1.p1.6.1" class="ltx_ERROR undefined">\ie</span>, generation <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">1</annotation></semantics></math>) children nodes <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\{u^{1}_{j}\}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.1.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">{</mo><msubsup id="S4.SS1.p1.3.m3.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.1.1.2.2" xref="S4.SS1.p1.3.m3.1.1.1.1.2.2.cmml">u</mi><mi id="S4.SS1.p1.3.m3.1.1.1.1.3" xref="S4.SS1.p1.3.m3.1.1.1.1.3.cmml">j</mi><mn id="S4.SS1.p1.3.m3.1.1.1.1.2.3" xref="S4.SS1.p1.3.m3.1.1.1.1.2.3.cmml">1</mn></msubsup><mo stretchy="false" id="S4.SS1.p1.3.m3.1.1.1.3" xref="S4.SS1.p1.3.m3.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><set id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1"><apply id="S4.SS1.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1">subscript</csymbol><apply id="S4.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.2.2">𝑢</ci><cn type="integer" id="S4.SS1.p1.3.m3.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p1.3.m3.1.1.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.3">𝑗</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\{u^{1}_{j}\}</annotation></semantics></math>, and the gradients of the loss with respect to the children nodes <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="\{{d\mathcal{L}}/{du^{1}_{j}}\}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m4.1.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">{</mo><mrow id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.1.1.2" xref="S4.SS1.p1.4.m4.1.1.1.1.2.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.1.1.2.2" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.1.2.2.2" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.1.1.1.2.2.1" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.1.1.1.1.2.2.3" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2.3.cmml">ℒ</mi></mrow><mo id="S4.SS1.p1.4.m4.1.1.1.1.2.1" xref="S4.SS1.p1.4.m4.1.1.1.1.2.1.cmml">/</mo><mi id="S4.SS1.p1.4.m4.1.1.1.1.2.3" xref="S4.SS1.p1.4.m4.1.1.1.1.2.3.cmml">d</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.1.cmml">​</mo><msubsup id="S4.SS1.p1.4.m4.1.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.1.3.2.2" xref="S4.SS1.p1.4.m4.1.1.1.1.3.2.2.cmml">u</mi><mi id="S4.SS1.p1.4.m4.1.1.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.1.1.3.3.cmml">j</mi><mn id="S4.SS1.p1.4.m4.1.1.1.1.3.2.3" xref="S4.SS1.p1.4.m4.1.1.1.1.3.2.3.cmml">1</mn></msubsup></mrow><mo stretchy="false" id="S4.SS1.p1.4.m4.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><set id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1"><apply id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1"><times id="S4.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1"></times><apply id="S4.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2"><divide id="S4.SS1.p1.4.m4.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2.1"></divide><apply id="S4.SS1.p1.4.m4.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2"><times id="S4.SS1.p1.4.m4.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2.1"></times><ci id="S4.SS1.p1.4.m4.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2.2">𝑑</ci><ci id="S4.SS1.p1.4.m4.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2.3">ℒ</ci></apply><ci id="S4.SS1.p1.4.m4.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2.3">𝑑</ci></apply><apply id="S4.SS1.p1.4.m4.1.1.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3">subscript</csymbol><apply id="S4.SS1.p1.4.m4.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.1.1.3.2.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3.2.2">𝑢</ci><cn type="integer" id="S4.SS1.p1.4.m4.1.1.1.1.3.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3.2.3">1</cn></apply><ci id="S4.SS1.p1.4.m4.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3.3">𝑗</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\{{d\mathcal{L}}/{du^{1}_{j}}\}</annotation></semantics></math>.
The back-propagation algorithm uses the chain rule to calculate the gradient of the loss <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\mathcal{L}</annotation></semantics></math> with respect to <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="{x}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">{x}</annotation></semantics></math> as in</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.1" class="ltx_Math" alttext="\frac{d\mathcal{L}}{d{x}}=\sum_{j}\left(\frac{\partial f^{1}_{j}}{\partial{x}}\right)^{T}\frac{d\mathcal{L}}{du^{1}_{j}}" display="block"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1.2" xref="S4.E1.m1.1.2.cmml"><mfrac id="S4.E1.m1.1.2.2" xref="S4.E1.m1.1.2.2.cmml"><mrow id="S4.E1.m1.1.2.2.2" xref="S4.E1.m1.1.2.2.2.cmml"><mi id="S4.E1.m1.1.2.2.2.2" xref="S4.E1.m1.1.2.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.2.2.1" xref="S4.E1.m1.1.2.2.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.2.2.2.3" xref="S4.E1.m1.1.2.2.2.3.cmml">ℒ</mi></mrow><mrow id="S4.E1.m1.1.2.2.3" xref="S4.E1.m1.1.2.2.3.cmml"><mi id="S4.E1.m1.1.2.2.3.2" xref="S4.E1.m1.1.2.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.2.3.1" xref="S4.E1.m1.1.2.2.3.1.cmml">​</mo><mi id="S4.E1.m1.1.2.2.3.3" xref="S4.E1.m1.1.2.2.3.3.cmml">x</mi></mrow></mfrac><mo rspace="0.111em" id="S4.E1.m1.1.2.1" xref="S4.E1.m1.1.2.1.cmml">=</mo><mrow id="S4.E1.m1.1.2.3" xref="S4.E1.m1.1.2.3.cmml"><munder id="S4.E1.m1.1.2.3.1" xref="S4.E1.m1.1.2.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S4.E1.m1.1.2.3.1.2" xref="S4.E1.m1.1.2.3.1.2.cmml">∑</mo><mi id="S4.E1.m1.1.2.3.1.3" xref="S4.E1.m1.1.2.3.1.3.cmml">j</mi></munder><mrow id="S4.E1.m1.1.2.3.2" xref="S4.E1.m1.1.2.3.2.cmml"><msup id="S4.E1.m1.1.2.3.2.2" xref="S4.E1.m1.1.2.3.2.2.cmml"><mrow id="S4.E1.m1.1.2.3.2.2.2.2" xref="S4.E1.m1.1.1.cmml"><mo id="S4.E1.m1.1.2.3.2.2.2.2.1" xref="S4.E1.m1.1.1.cmml">(</mo><mfrac id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><mrow id="S4.E1.m1.1.1.2" xref="S4.E1.m1.1.1.2.cmml"><mo rspace="0em" id="S4.E1.m1.1.1.2.1" xref="S4.E1.m1.1.1.2.1.cmml">∂</mo><msubsup id="S4.E1.m1.1.1.2.2" xref="S4.E1.m1.1.1.2.2.cmml"><mi id="S4.E1.m1.1.1.2.2.2.2" xref="S4.E1.m1.1.1.2.2.2.2.cmml">f</mi><mi id="S4.E1.m1.1.1.2.2.3" xref="S4.E1.m1.1.1.2.2.3.cmml">j</mi><mn id="S4.E1.m1.1.1.2.2.2.3" xref="S4.E1.m1.1.1.2.2.2.3.cmml">1</mn></msubsup></mrow><mrow id="S4.E1.m1.1.1.3" xref="S4.E1.m1.1.1.3.cmml"><mo rspace="0em" id="S4.E1.m1.1.1.3.1" xref="S4.E1.m1.1.1.3.1.cmml">∂</mo><mi id="S4.E1.m1.1.1.3.2" xref="S4.E1.m1.1.1.3.2.cmml">x</mi></mrow></mfrac><mo id="S4.E1.m1.1.2.3.2.2.2.2.2" xref="S4.E1.m1.1.1.cmml">)</mo></mrow><mi id="S4.E1.m1.1.2.3.2.2.3" xref="S4.E1.m1.1.2.3.2.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.3.2.1" xref="S4.E1.m1.1.2.3.2.1.cmml">​</mo><mfrac id="S4.E1.m1.1.2.3.2.3" xref="S4.E1.m1.1.2.3.2.3.cmml"><mrow id="S4.E1.m1.1.2.3.2.3.2" xref="S4.E1.m1.1.2.3.2.3.2.cmml"><mi id="S4.E1.m1.1.2.3.2.3.2.2" xref="S4.E1.m1.1.2.3.2.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.3.2.3.2.1" xref="S4.E1.m1.1.2.3.2.3.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.2.3.2.3.2.3" xref="S4.E1.m1.1.2.3.2.3.2.3.cmml">ℒ</mi></mrow><mrow id="S4.E1.m1.1.2.3.2.3.3" xref="S4.E1.m1.1.2.3.2.3.3.cmml"><mi id="S4.E1.m1.1.2.3.2.3.3.2" xref="S4.E1.m1.1.2.3.2.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.3.2.3.3.1" xref="S4.E1.m1.1.2.3.2.3.3.1.cmml">​</mo><msubsup id="S4.E1.m1.1.2.3.2.3.3.3" xref="S4.E1.m1.1.2.3.2.3.3.3.cmml"><mi id="S4.E1.m1.1.2.3.2.3.3.3.2.2" xref="S4.E1.m1.1.2.3.2.3.3.3.2.2.cmml">u</mi><mi id="S4.E1.m1.1.2.3.2.3.3.3.3" xref="S4.E1.m1.1.2.3.2.3.3.3.3.cmml">j</mi><mn id="S4.E1.m1.1.2.3.2.3.3.3.2.3" xref="S4.E1.m1.1.2.3.2.3.3.3.2.3.cmml">1</mn></msubsup></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.2.cmml" xref="S4.E1.m1.1.2"><eq id="S4.E1.m1.1.2.1.cmml" xref="S4.E1.m1.1.2.1"></eq><apply id="S4.E1.m1.1.2.2.cmml" xref="S4.E1.m1.1.2.2"><divide id="S4.E1.m1.1.2.2.1.cmml" xref="S4.E1.m1.1.2.2"></divide><apply id="S4.E1.m1.1.2.2.2.cmml" xref="S4.E1.m1.1.2.2.2"><times id="S4.E1.m1.1.2.2.2.1.cmml" xref="S4.E1.m1.1.2.2.2.1"></times><ci id="S4.E1.m1.1.2.2.2.2.cmml" xref="S4.E1.m1.1.2.2.2.2">𝑑</ci><ci id="S4.E1.m1.1.2.2.2.3.cmml" xref="S4.E1.m1.1.2.2.2.3">ℒ</ci></apply><apply id="S4.E1.m1.1.2.2.3.cmml" xref="S4.E1.m1.1.2.2.3"><times id="S4.E1.m1.1.2.2.3.1.cmml" xref="S4.E1.m1.1.2.2.3.1"></times><ci id="S4.E1.m1.1.2.2.3.2.cmml" xref="S4.E1.m1.1.2.2.3.2">𝑑</ci><ci id="S4.E1.m1.1.2.2.3.3.cmml" xref="S4.E1.m1.1.2.2.3.3">𝑥</ci></apply></apply><apply id="S4.E1.m1.1.2.3.cmml" xref="S4.E1.m1.1.2.3"><apply id="S4.E1.m1.1.2.3.1.cmml" xref="S4.E1.m1.1.2.3.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.2.3.1.1.cmml" xref="S4.E1.m1.1.2.3.1">subscript</csymbol><sum id="S4.E1.m1.1.2.3.1.2.cmml" xref="S4.E1.m1.1.2.3.1.2"></sum><ci id="S4.E1.m1.1.2.3.1.3.cmml" xref="S4.E1.m1.1.2.3.1.3">𝑗</ci></apply><apply id="S4.E1.m1.1.2.3.2.cmml" xref="S4.E1.m1.1.2.3.2"><times id="S4.E1.m1.1.2.3.2.1.cmml" xref="S4.E1.m1.1.2.3.2.1"></times><apply id="S4.E1.m1.1.2.3.2.2.cmml" xref="S4.E1.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.2.3.2.2.1.cmml" xref="S4.E1.m1.1.2.3.2.2">superscript</csymbol><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.2.3.2.2.2.2"><divide id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.2.3.2.2.2.2"></divide><apply id="S4.E1.m1.1.1.2.cmml" xref="S4.E1.m1.1.1.2"><partialdiff id="S4.E1.m1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.2.1"></partialdiff><apply id="S4.E1.m1.1.1.2.2.cmml" xref="S4.E1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.2.2.1.cmml" xref="S4.E1.m1.1.1.2.2">subscript</csymbol><apply id="S4.E1.m1.1.1.2.2.2.cmml" xref="S4.E1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.2.2.2.1.cmml" xref="S4.E1.m1.1.1.2.2">superscript</csymbol><ci id="S4.E1.m1.1.1.2.2.2.2.cmml" xref="S4.E1.m1.1.1.2.2.2.2">𝑓</ci><cn type="integer" id="S4.E1.m1.1.1.2.2.2.3.cmml" xref="S4.E1.m1.1.1.2.2.2.3">1</cn></apply><ci id="S4.E1.m1.1.1.2.2.3.cmml" xref="S4.E1.m1.1.1.2.2.3">𝑗</ci></apply></apply><apply id="S4.E1.m1.1.1.3.cmml" xref="S4.E1.m1.1.1.3"><partialdiff id="S4.E1.m1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.3.1"></partialdiff><ci id="S4.E1.m1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.3.2">𝑥</ci></apply></apply><ci id="S4.E1.m1.1.2.3.2.2.3.cmml" xref="S4.E1.m1.1.2.3.2.2.3">𝑇</ci></apply><apply id="S4.E1.m1.1.2.3.2.3.cmml" xref="S4.E1.m1.1.2.3.2.3"><divide id="S4.E1.m1.1.2.3.2.3.1.cmml" xref="S4.E1.m1.1.2.3.2.3"></divide><apply id="S4.E1.m1.1.2.3.2.3.2.cmml" xref="S4.E1.m1.1.2.3.2.3.2"><times id="S4.E1.m1.1.2.3.2.3.2.1.cmml" xref="S4.E1.m1.1.2.3.2.3.2.1"></times><ci id="S4.E1.m1.1.2.3.2.3.2.2.cmml" xref="S4.E1.m1.1.2.3.2.3.2.2">𝑑</ci><ci id="S4.E1.m1.1.2.3.2.3.2.3.cmml" xref="S4.E1.m1.1.2.3.2.3.2.3">ℒ</ci></apply><apply id="S4.E1.m1.1.2.3.2.3.3.cmml" xref="S4.E1.m1.1.2.3.2.3.3"><times id="S4.E1.m1.1.2.3.2.3.3.1.cmml" xref="S4.E1.m1.1.2.3.2.3.3.1"></times><ci id="S4.E1.m1.1.2.3.2.3.3.2.cmml" xref="S4.E1.m1.1.2.3.2.3.3.2">𝑑</ci><apply id="S4.E1.m1.1.2.3.2.3.3.3.cmml" xref="S4.E1.m1.1.2.3.2.3.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.2.3.2.3.3.3.1.cmml" xref="S4.E1.m1.1.2.3.2.3.3.3">subscript</csymbol><apply id="S4.E1.m1.1.2.3.2.3.3.3.2.cmml" xref="S4.E1.m1.1.2.3.2.3.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.2.3.2.3.3.3.2.1.cmml" xref="S4.E1.m1.1.2.3.2.3.3.3">superscript</csymbol><ci id="S4.E1.m1.1.2.3.2.3.3.3.2.2.cmml" xref="S4.E1.m1.1.2.3.2.3.3.3.2.2">𝑢</ci><cn type="integer" id="S4.E1.m1.1.2.3.2.3.3.3.2.3.cmml" xref="S4.E1.m1.1.2.3.2.3.3.3.2.3">1</cn></apply><ci id="S4.E1.m1.1.2.3.2.3.3.3.3.cmml" xref="S4.E1.m1.1.2.3.2.3.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\frac{d\mathcal{L}}{d{x}}=\sum_{j}\left(\frac{\partial f^{1}_{j}}{\partial{x}}\right)^{T}\frac{d\mathcal{L}}{du^{1}_{j}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.13" class="ltx_p">where <math id="S4.SS1.p1.7.m1.1" class="ltx_Math" alttext="f^{1}_{j}" display="inline"><semantics id="S4.SS1.p1.7.m1.1a"><msubsup id="S4.SS1.p1.7.m1.1.1" xref="S4.SS1.p1.7.m1.1.1.cmml"><mi id="S4.SS1.p1.7.m1.1.1.2.2" xref="S4.SS1.p1.7.m1.1.1.2.2.cmml">f</mi><mi id="S4.SS1.p1.7.m1.1.1.3" xref="S4.SS1.p1.7.m1.1.1.3.cmml">j</mi><mn id="S4.SS1.p1.7.m1.1.1.2.3" xref="S4.SS1.p1.7.m1.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m1.1b"><apply id="S4.SS1.p1.7.m1.1.1.cmml" xref="S4.SS1.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m1.1.1.1.cmml" xref="S4.SS1.p1.7.m1.1.1">subscript</csymbol><apply id="S4.SS1.p1.7.m1.1.1.2.cmml" xref="S4.SS1.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m1.1.1.2.1.cmml" xref="S4.SS1.p1.7.m1.1.1">superscript</csymbol><ci id="S4.SS1.p1.7.m1.1.1.2.2.cmml" xref="S4.SS1.p1.7.m1.1.1.2.2">𝑓</ci><cn type="integer" id="S4.SS1.p1.7.m1.1.1.2.3.cmml" xref="S4.SS1.p1.7.m1.1.1.2.3">1</cn></apply><ci id="S4.SS1.p1.7.m1.1.1.3.cmml" xref="S4.SS1.p1.7.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m1.1c">f^{1}_{j}</annotation></semantics></math> denotes the function computing node <math id="S4.SS1.p1.8.m2.1" class="ltx_Math" alttext="u^{1}_{j}" display="inline"><semantics id="S4.SS1.p1.8.m2.1a"><msubsup id="S4.SS1.p1.8.m2.1.1" xref="S4.SS1.p1.8.m2.1.1.cmml"><mi id="S4.SS1.p1.8.m2.1.1.2.2" xref="S4.SS1.p1.8.m2.1.1.2.2.cmml">u</mi><mi id="S4.SS1.p1.8.m2.1.1.3" xref="S4.SS1.p1.8.m2.1.1.3.cmml">j</mi><mn id="S4.SS1.p1.8.m2.1.1.2.3" xref="S4.SS1.p1.8.m2.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m2.1b"><apply id="S4.SS1.p1.8.m2.1.1.cmml" xref="S4.SS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m2.1.1.1.cmml" xref="S4.SS1.p1.8.m2.1.1">subscript</csymbol><apply id="S4.SS1.p1.8.m2.1.1.2.cmml" xref="S4.SS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m2.1.1.2.1.cmml" xref="S4.SS1.p1.8.m2.1.1">superscript</csymbol><ci id="S4.SS1.p1.8.m2.1.1.2.2.cmml" xref="S4.SS1.p1.8.m2.1.1.2.2">𝑢</ci><cn type="integer" id="S4.SS1.p1.8.m2.1.1.2.3.cmml" xref="S4.SS1.p1.8.m2.1.1.2.3">1</cn></apply><ci id="S4.SS1.p1.8.m2.1.1.3.cmml" xref="S4.SS1.p1.8.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m2.1c">u^{1}_{j}</annotation></semantics></math> from its parents <math id="S4.SS1.p1.9.m3.1" class="ltx_Math" alttext="\alpha^{1}" display="inline"><semantics id="S4.SS1.p1.9.m3.1a"><msup id="S4.SS1.p1.9.m3.1.1" xref="S4.SS1.p1.9.m3.1.1.cmml"><mi id="S4.SS1.p1.9.m3.1.1.2" xref="S4.SS1.p1.9.m3.1.1.2.cmml">α</mi><mn id="S4.SS1.p1.9.m3.1.1.3" xref="S4.SS1.p1.9.m3.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m3.1b"><apply id="S4.SS1.p1.9.m3.1.1.cmml" xref="S4.SS1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m3.1.1.1.cmml" xref="S4.SS1.p1.9.m3.1.1">superscript</csymbol><ci id="S4.SS1.p1.9.m3.1.1.2.cmml" xref="S4.SS1.p1.9.m3.1.1.2">𝛼</ci><cn type="integer" id="S4.SS1.p1.9.m3.1.1.3.cmml" xref="S4.SS1.p1.9.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m3.1c">\alpha^{1}</annotation></semantics></math>, <span id="S4.SS1.p1.13.1" class="ltx_ERROR undefined">\ie</span><math id="S4.SS1.p1.10.m4.1" class="ltx_Math" alttext="u^{1}_{j}=f^{1}_{j}\left(\alpha^{1}\right)" display="inline"><semantics id="S4.SS1.p1.10.m4.1a"><mrow id="S4.SS1.p1.10.m4.1.1" xref="S4.SS1.p1.10.m4.1.1.cmml"><msubsup id="S4.SS1.p1.10.m4.1.1.3" xref="S4.SS1.p1.10.m4.1.1.3.cmml"><mi id="S4.SS1.p1.10.m4.1.1.3.2.2" xref="S4.SS1.p1.10.m4.1.1.3.2.2.cmml">u</mi><mi id="S4.SS1.p1.10.m4.1.1.3.3" xref="S4.SS1.p1.10.m4.1.1.3.3.cmml">j</mi><mn id="S4.SS1.p1.10.m4.1.1.3.2.3" xref="S4.SS1.p1.10.m4.1.1.3.2.3.cmml">1</mn></msubsup><mo id="S4.SS1.p1.10.m4.1.1.2" xref="S4.SS1.p1.10.m4.1.1.2.cmml">=</mo><mrow id="S4.SS1.p1.10.m4.1.1.1" xref="S4.SS1.p1.10.m4.1.1.1.cmml"><msubsup id="S4.SS1.p1.10.m4.1.1.1.3" xref="S4.SS1.p1.10.m4.1.1.1.3.cmml"><mi id="S4.SS1.p1.10.m4.1.1.1.3.2.2" xref="S4.SS1.p1.10.m4.1.1.1.3.2.2.cmml">f</mi><mi id="S4.SS1.p1.10.m4.1.1.1.3.3" xref="S4.SS1.p1.10.m4.1.1.1.3.3.cmml">j</mi><mn id="S4.SS1.p1.10.m4.1.1.1.3.2.3" xref="S4.SS1.p1.10.m4.1.1.1.3.2.3.cmml">1</mn></msubsup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.10.m4.1.1.1.2" xref="S4.SS1.p1.10.m4.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p1.10.m4.1.1.1.1.1" xref="S4.SS1.p1.10.m4.1.1.1.1.1.1.cmml"><mo id="S4.SS1.p1.10.m4.1.1.1.1.1.2" xref="S4.SS1.p1.10.m4.1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS1.p1.10.m4.1.1.1.1.1.1" xref="S4.SS1.p1.10.m4.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.10.m4.1.1.1.1.1.1.2" xref="S4.SS1.p1.10.m4.1.1.1.1.1.1.2.cmml">α</mi><mn id="S4.SS1.p1.10.m4.1.1.1.1.1.1.3" xref="S4.SS1.p1.10.m4.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S4.SS1.p1.10.m4.1.1.1.1.1.3" xref="S4.SS1.p1.10.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m4.1b"><apply id="S4.SS1.p1.10.m4.1.1.cmml" xref="S4.SS1.p1.10.m4.1.1"><eq id="S4.SS1.p1.10.m4.1.1.2.cmml" xref="S4.SS1.p1.10.m4.1.1.2"></eq><apply id="S4.SS1.p1.10.m4.1.1.3.cmml" xref="S4.SS1.p1.10.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m4.1.1.3.1.cmml" xref="S4.SS1.p1.10.m4.1.1.3">subscript</csymbol><apply id="S4.SS1.p1.10.m4.1.1.3.2.cmml" xref="S4.SS1.p1.10.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m4.1.1.3.2.1.cmml" xref="S4.SS1.p1.10.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.10.m4.1.1.3.2.2.cmml" xref="S4.SS1.p1.10.m4.1.1.3.2.2">𝑢</ci><cn type="integer" id="S4.SS1.p1.10.m4.1.1.3.2.3.cmml" xref="S4.SS1.p1.10.m4.1.1.3.2.3">1</cn></apply><ci id="S4.SS1.p1.10.m4.1.1.3.3.cmml" xref="S4.SS1.p1.10.m4.1.1.3.3">𝑗</ci></apply><apply id="S4.SS1.p1.10.m4.1.1.1.cmml" xref="S4.SS1.p1.10.m4.1.1.1"><times id="S4.SS1.p1.10.m4.1.1.1.2.cmml" xref="S4.SS1.p1.10.m4.1.1.1.2"></times><apply id="S4.SS1.p1.10.m4.1.1.1.3.cmml" xref="S4.SS1.p1.10.m4.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m4.1.1.1.3.1.cmml" xref="S4.SS1.p1.10.m4.1.1.1.3">subscript</csymbol><apply id="S4.SS1.p1.10.m4.1.1.1.3.2.cmml" xref="S4.SS1.p1.10.m4.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m4.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.10.m4.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.10.m4.1.1.1.3.2.2.cmml" xref="S4.SS1.p1.10.m4.1.1.1.3.2.2">𝑓</ci><cn type="integer" id="S4.SS1.p1.10.m4.1.1.1.3.2.3.cmml" xref="S4.SS1.p1.10.m4.1.1.1.3.2.3">1</cn></apply><ci id="S4.SS1.p1.10.m4.1.1.1.3.3.cmml" xref="S4.SS1.p1.10.m4.1.1.1.3.3">𝑗</ci></apply><apply id="S4.SS1.p1.10.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.10.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.10.m4.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p1.10.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.10.m4.1.1.1.1.1.1.2">𝛼</ci><cn type="integer" id="S4.SS1.p1.10.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.10.m4.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m4.1c">u^{1}_{j}=f^{1}_{j}\left(\alpha^{1}\right)</annotation></semantics></math>.
In the case of Transformer encoders, <math id="S4.SS1.p1.11.m5.1" class="ltx_Math" alttext="f^{i}_{j}" display="inline"><semantics id="S4.SS1.p1.11.m5.1a"><msubsup id="S4.SS1.p1.11.m5.1.1" xref="S4.SS1.p1.11.m5.1.1.cmml"><mi id="S4.SS1.p1.11.m5.1.1.2.2" xref="S4.SS1.p1.11.m5.1.1.2.2.cmml">f</mi><mi id="S4.SS1.p1.11.m5.1.1.3" xref="S4.SS1.p1.11.m5.1.1.3.cmml">j</mi><mi id="S4.SS1.p1.11.m5.1.1.2.3" xref="S4.SS1.p1.11.m5.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m5.1b"><apply id="S4.SS1.p1.11.m5.1.1.cmml" xref="S4.SS1.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m5.1.1.1.cmml" xref="S4.SS1.p1.11.m5.1.1">subscript</csymbol><apply id="S4.SS1.p1.11.m5.1.1.2.cmml" xref="S4.SS1.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m5.1.1.2.1.cmml" xref="S4.SS1.p1.11.m5.1.1">superscript</csymbol><ci id="S4.SS1.p1.11.m5.1.1.2.2.cmml" xref="S4.SS1.p1.11.m5.1.1.2.2">𝑓</ci><ci id="S4.SS1.p1.11.m5.1.1.2.3.cmml" xref="S4.SS1.p1.11.m5.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.p1.11.m5.1.1.3.cmml" xref="S4.SS1.p1.11.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m5.1c">f^{i}_{j}</annotation></semantics></math> can be a convolution, a feedforward layer, an attention layer, a layer-normalization step, <span id="S4.SS1.p1.13.2" class="ltx_ERROR undefined">\etc</span>.
Existing shielded white-box scenarios <cite class="ltx_cite ltx_citemacro_citep">(Messaoud et al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2022</a>)</cite> protect components of the gradient of the loss <em id="S4.SS1.p1.13.3" class="ltx_emph ltx_font_italic">w.r.t.</em> the parameters <math id="S4.SS1.p1.12.m6.1" class="ltx_Math" alttext="\nabla_{\theta}\mathcal{L}" display="inline"><semantics id="S4.SS1.p1.12.m6.1a"><mrow id="S4.SS1.p1.12.m6.1.1" xref="S4.SS1.p1.12.m6.1.1.cmml"><msub id="S4.SS1.p1.12.m6.1.1.1" xref="S4.SS1.p1.12.m6.1.1.1.cmml"><mo id="S4.SS1.p1.12.m6.1.1.1.2" xref="S4.SS1.p1.12.m6.1.1.1.2.cmml">∇</mo><mi id="S4.SS1.p1.12.m6.1.1.1.3" xref="S4.SS1.p1.12.m6.1.1.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.12.m6.1.1.2" xref="S4.SS1.p1.12.m6.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m6.1b"><apply id="S4.SS1.p1.12.m6.1.1.cmml" xref="S4.SS1.p1.12.m6.1.1"><apply id="S4.SS1.p1.12.m6.1.1.1.cmml" xref="S4.SS1.p1.12.m6.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m6.1.1.1.1.cmml" xref="S4.SS1.p1.12.m6.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.12.m6.1.1.1.2.cmml" xref="S4.SS1.p1.12.m6.1.1.1.2">∇</ci><ci id="S4.SS1.p1.12.m6.1.1.1.3.cmml" xref="S4.SS1.p1.12.m6.1.1.1.3">𝜃</ci></apply><ci id="S4.SS1.p1.12.m6.1.1.2.cmml" xref="S4.SS1.p1.12.m6.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m6.1c">\nabla_{\theta}\mathcal{L}</annotation></semantics></math>, to prevent leakage otherwise enabling an attacker to conduct inversion attacks.
Instead, we seek to mask gradients that serve the calculation of the gradient of the loss <em id="S4.SS1.p1.13.4" class="ltx_emph ltx_font_italic">w.r.t.</em> the <em id="S4.SS1.p1.13.5" class="ltx_emph ltx_font_italic">input</em> <math id="S4.SS1.p1.13.m7.1" class="ltx_Math" alttext="\nabla_{x}\mathcal{L}" display="inline"><semantics id="S4.SS1.p1.13.m7.1a"><mrow id="S4.SS1.p1.13.m7.1.1" xref="S4.SS1.p1.13.m7.1.1.cmml"><msub id="S4.SS1.p1.13.m7.1.1.1" xref="S4.SS1.p1.13.m7.1.1.1.cmml"><mo id="S4.SS1.p1.13.m7.1.1.1.2" xref="S4.SS1.p1.13.m7.1.1.1.2.cmml">∇</mo><mi id="S4.SS1.p1.13.m7.1.1.1.3" xref="S4.SS1.p1.13.m7.1.1.1.3.cmml">x</mi></msub><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.13.m7.1.1.2" xref="S4.SS1.p1.13.m7.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m7.1b"><apply id="S4.SS1.p1.13.m7.1.1.cmml" xref="S4.SS1.p1.13.m7.1.1"><apply id="S4.SS1.p1.13.m7.1.1.1.cmml" xref="S4.SS1.p1.13.m7.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m7.1.1.1.1.cmml" xref="S4.SS1.p1.13.m7.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m7.1.1.1.2.cmml" xref="S4.SS1.p1.13.m7.1.1.1.2">∇</ci><ci id="S4.SS1.p1.13.m7.1.1.1.3.cmml" xref="S4.SS1.p1.13.m7.1.1.1.3">𝑥</ci></apply><ci id="S4.SS1.p1.13.m7.1.1.2.cmml" xref="S4.SS1.p1.13.m7.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m7.1c">\nabla_{x}\mathcal{L}</annotation></semantics></math> to prevent leakage enabling gradient-based adversarial attacks, as those exploit the backward pass quantities (<span id="S4.SS1.p1.13.6" class="ltx_ERROR undefined">\ie</span>, the gradients) of the input to maximise the model’s loss.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.4" class="ltx_p">Because the model shared between nodes in the FL group still needs to back-propagate correct gradients at each node of the computational graph, masking only an intermediate layer is useless, since it does not prevent the attacker from accessing the correct in-memory gradients on the clear left-hand side of the shielded layer.
We thus always perform the gradient obfuscation of the first trainable parameters of the model, <span id="S4.SS1.p2.4.1" class="ltx_ERROR undefined">\ie</span>, its leftmost successive layers: it is the lightest way to alter <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\nabla_{x}\mathcal{L}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><msub id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml"><mo id="S4.SS1.p2.1.m1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.2.cmml">∇</mo><mi id="S4.SS1.p2.1.m1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.3.cmml">x</mi></msub><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><apply id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.2">∇</ci><ci id="S4.SS1.p2.1.m1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.3">𝑥</ci></apply><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\nabla_{x}\mathcal{L}</annotation></semantics></math> through physical masking.
Specifically, using Eq. <a href="#S4.E1" title="Equation 1 ‣ 4.1. Back-Propagation Principles and Limits ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">x</annotation></semantics></math> denotes the input image (<span id="S4.SS1.p2.4.2" class="ltx_ERROR undefined">\ie</span>, the adversarial instance <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="x_{adv}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msub id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">x</mi><mrow id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml"><mi id="S4.SS1.p2.3.m3.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.3.m3.1.1.3.1" xref="S4.SS1.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.3.m3.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.3.m3.1.1.3.1a" xref="S4.SS1.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.3.m3.1.1.3.4" xref="S4.SS1.p2.3.m3.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝑥</ci><apply id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3"><times id="S4.SS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3.1"></times><ci id="S4.SS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.p2.3.m3.1.1.3.2">𝑎</ci><ci id="S4.SS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3">𝑑</ci><ci id="S4.SS1.p2.3.m3.1.1.3.4.cmml" xref="S4.SS1.p2.3.m3.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">x_{adv}</annotation></semantics></math>), an attacker could perform any gradient-based evasion attack (a special case where a layer is not differentiable is discussed in §<a href="#S4.SS3" title="4.3. Relation with BPDA ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>).
<span id="S4.SS1.p2.4.3" class="ltx_text ltx_font_smallcaps">Pelta</span> renders the chain rule incomplete, by forcibly and partially masking the left-hand side term inside the sum, <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="\{\partial f_{j}^{1}/\partial{x}\}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mrow id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.4.m4.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">{</mo><mrow id="S4.SS1.p2.4.m4.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m4.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.1.cmml">∂</mo><mrow id="S4.SS1.p2.4.m4.1.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.1.1.2.cmml"><msubsup id="S4.SS1.p2.4.m4.1.1.1.1.2.2" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.2" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.2.cmml">f</mi><mi id="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.3" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.3.cmml">j</mi><mn id="S4.SS1.p2.4.m4.1.1.1.1.2.2.3" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2.3.cmml">1</mn></msubsup><mo id="S4.SS1.p2.4.m4.1.1.1.1.2.1" xref="S4.SS1.p2.4.m4.1.1.1.1.2.1.cmml">/</mo><mrow id="S4.SS1.p2.4.m4.1.1.1.1.2.3" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m4.1.1.1.1.2.3.1" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3.1.cmml">∂</mo><mi id="S4.SS1.p2.4.m4.1.1.1.1.2.3.2" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.p2.4.m4.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><set id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1"><apply id="S4.SS1.p2.4.m4.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1"><partialdiff id="S4.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1"></partialdiff><apply id="S4.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2"><divide id="S4.SS1.p2.4.m4.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.1"></divide><apply id="S4.SS1.p2.4.m4.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2">superscript</csymbol><apply id="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.2">𝑓</ci><ci id="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2.2.3">𝑗</ci></apply><cn type="integer" id="S4.SS1.p2.4.m4.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2.3">1</cn></apply><apply id="S4.SS1.p2.4.m4.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3"><partialdiff id="S4.SS1.p2.4.m4.1.1.1.1.2.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3.1"></partialdiff><ci id="S4.SS1.p2.4.m4.1.1.1.1.2.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3.2">𝑥</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\{\partial f_{j}^{1}/\partial{x}\}</annotation></semantics></math>, hence relying on the lightest possible obfuscation to prevent collecting these gradients and launch the attack.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span><span id="S4.SS2.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span> shielding</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.15" class="ltx_p">We consider the computational graph of an ML model:</p>
<table id="S4.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex2.m1.5" class="ltx_Math" alttext="\mathcal{G}=\left\langle n,l,E,u^{1}\ldots u^{n},f^{l+1}\ldots f^{n}\right\rangle" display="block"><semantics id="S4.Ex2.m1.5a"><mrow id="S4.Ex2.m1.5.5" xref="S4.Ex2.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.5.5.4" xref="S4.Ex2.m1.5.5.4.cmml">𝒢</mi><mo id="S4.Ex2.m1.5.5.3" xref="S4.Ex2.m1.5.5.3.cmml">=</mo><mrow id="S4.Ex2.m1.5.5.2.2" xref="S4.Ex2.m1.5.5.2.3.cmml"><mo id="S4.Ex2.m1.5.5.2.2.3" xref="S4.Ex2.m1.5.5.2.3.cmml">⟨</mo><mi id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml">n</mi><mo id="S4.Ex2.m1.5.5.2.2.4" xref="S4.Ex2.m1.5.5.2.3.cmml">,</mo><mi id="S4.Ex2.m1.2.2" xref="S4.Ex2.m1.2.2.cmml">l</mi><mo id="S4.Ex2.m1.5.5.2.2.5" xref="S4.Ex2.m1.5.5.2.3.cmml">,</mo><mi id="S4.Ex2.m1.3.3" xref="S4.Ex2.m1.3.3.cmml">E</mi><mo id="S4.Ex2.m1.5.5.2.2.6" xref="S4.Ex2.m1.5.5.2.3.cmml">,</mo><mrow id="S4.Ex2.m1.4.4.1.1.1" xref="S4.Ex2.m1.4.4.1.1.1.cmml"><msup id="S4.Ex2.m1.4.4.1.1.1.2" xref="S4.Ex2.m1.4.4.1.1.1.2.cmml"><mi id="S4.Ex2.m1.4.4.1.1.1.2.2" xref="S4.Ex2.m1.4.4.1.1.1.2.2.cmml">u</mi><mn id="S4.Ex2.m1.4.4.1.1.1.2.3" xref="S4.Ex2.m1.4.4.1.1.1.2.3.cmml">1</mn></msup><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.4.4.1.1.1.1" xref="S4.Ex2.m1.4.4.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.Ex2.m1.4.4.1.1.1.3" xref="S4.Ex2.m1.4.4.1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.4.4.1.1.1.1a" xref="S4.Ex2.m1.4.4.1.1.1.1.cmml">​</mo><msup id="S4.Ex2.m1.4.4.1.1.1.4" xref="S4.Ex2.m1.4.4.1.1.1.4.cmml"><mi id="S4.Ex2.m1.4.4.1.1.1.4.2" xref="S4.Ex2.m1.4.4.1.1.1.4.2.cmml">u</mi><mi id="S4.Ex2.m1.4.4.1.1.1.4.3" xref="S4.Ex2.m1.4.4.1.1.1.4.3.cmml">n</mi></msup></mrow><mo id="S4.Ex2.m1.5.5.2.2.7" xref="S4.Ex2.m1.5.5.2.3.cmml">,</mo><mrow id="S4.Ex2.m1.5.5.2.2.2" xref="S4.Ex2.m1.5.5.2.2.2.cmml"><msup id="S4.Ex2.m1.5.5.2.2.2.2" xref="S4.Ex2.m1.5.5.2.2.2.2.cmml"><mi id="S4.Ex2.m1.5.5.2.2.2.2.2" xref="S4.Ex2.m1.5.5.2.2.2.2.2.cmml">f</mi><mrow id="S4.Ex2.m1.5.5.2.2.2.2.3" xref="S4.Ex2.m1.5.5.2.2.2.2.3.cmml"><mi id="S4.Ex2.m1.5.5.2.2.2.2.3.2" xref="S4.Ex2.m1.5.5.2.2.2.2.3.2.cmml">l</mi><mo id="S4.Ex2.m1.5.5.2.2.2.2.3.1" xref="S4.Ex2.m1.5.5.2.2.2.2.3.1.cmml">+</mo><mn id="S4.Ex2.m1.5.5.2.2.2.2.3.3" xref="S4.Ex2.m1.5.5.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.5.5.2.2.2.1" xref="S4.Ex2.m1.5.5.2.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S4.Ex2.m1.5.5.2.2.2.3" xref="S4.Ex2.m1.5.5.2.2.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.5.5.2.2.2.1a" xref="S4.Ex2.m1.5.5.2.2.2.1.cmml">​</mo><msup id="S4.Ex2.m1.5.5.2.2.2.4" xref="S4.Ex2.m1.5.5.2.2.2.4.cmml"><mi id="S4.Ex2.m1.5.5.2.2.2.4.2" xref="S4.Ex2.m1.5.5.2.2.2.4.2.cmml">f</mi><mi id="S4.Ex2.m1.5.5.2.2.2.4.3" xref="S4.Ex2.m1.5.5.2.2.2.4.3.cmml">n</mi></msup></mrow><mo id="S4.Ex2.m1.5.5.2.2.8" xref="S4.Ex2.m1.5.5.2.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.5b"><apply id="S4.Ex2.m1.5.5.cmml" xref="S4.Ex2.m1.5.5"><eq id="S4.Ex2.m1.5.5.3.cmml" xref="S4.Ex2.m1.5.5.3"></eq><ci id="S4.Ex2.m1.5.5.4.cmml" xref="S4.Ex2.m1.5.5.4">𝒢</ci><list id="S4.Ex2.m1.5.5.2.3.cmml" xref="S4.Ex2.m1.5.5.2.2"><ci id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1">𝑛</ci><ci id="S4.Ex2.m1.2.2.cmml" xref="S4.Ex2.m1.2.2">𝑙</ci><ci id="S4.Ex2.m1.3.3.cmml" xref="S4.Ex2.m1.3.3">𝐸</ci><apply id="S4.Ex2.m1.4.4.1.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1"><times id="S4.Ex2.m1.4.4.1.1.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1"></times><apply id="S4.Ex2.m1.4.4.1.1.1.2.cmml" xref="S4.Ex2.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.4.4.1.1.1.2.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1.2">superscript</csymbol><ci id="S4.Ex2.m1.4.4.1.1.1.2.2.cmml" xref="S4.Ex2.m1.4.4.1.1.1.2.2">𝑢</ci><cn type="integer" id="S4.Ex2.m1.4.4.1.1.1.2.3.cmml" xref="S4.Ex2.m1.4.4.1.1.1.2.3">1</cn></apply><ci id="S4.Ex2.m1.4.4.1.1.1.3.cmml" xref="S4.Ex2.m1.4.4.1.1.1.3">…</ci><apply id="S4.Ex2.m1.4.4.1.1.1.4.cmml" xref="S4.Ex2.m1.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex2.m1.4.4.1.1.1.4.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1.4">superscript</csymbol><ci id="S4.Ex2.m1.4.4.1.1.1.4.2.cmml" xref="S4.Ex2.m1.4.4.1.1.1.4.2">𝑢</ci><ci id="S4.Ex2.m1.4.4.1.1.1.4.3.cmml" xref="S4.Ex2.m1.4.4.1.1.1.4.3">𝑛</ci></apply></apply><apply id="S4.Ex2.m1.5.5.2.2.2.cmml" xref="S4.Ex2.m1.5.5.2.2.2"><times id="S4.Ex2.m1.5.5.2.2.2.1.cmml" xref="S4.Ex2.m1.5.5.2.2.2.1"></times><apply id="S4.Ex2.m1.5.5.2.2.2.2.cmml" xref="S4.Ex2.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.2.2.2.2.1.cmml" xref="S4.Ex2.m1.5.5.2.2.2.2">superscript</csymbol><ci id="S4.Ex2.m1.5.5.2.2.2.2.2.cmml" xref="S4.Ex2.m1.5.5.2.2.2.2.2">𝑓</ci><apply id="S4.Ex2.m1.5.5.2.2.2.2.3.cmml" xref="S4.Ex2.m1.5.5.2.2.2.2.3"><plus id="S4.Ex2.m1.5.5.2.2.2.2.3.1.cmml" xref="S4.Ex2.m1.5.5.2.2.2.2.3.1"></plus><ci id="S4.Ex2.m1.5.5.2.2.2.2.3.2.cmml" xref="S4.Ex2.m1.5.5.2.2.2.2.3.2">𝑙</ci><cn type="integer" id="S4.Ex2.m1.5.5.2.2.2.2.3.3.cmml" xref="S4.Ex2.m1.5.5.2.2.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex2.m1.5.5.2.2.2.3.cmml" xref="S4.Ex2.m1.5.5.2.2.2.3">…</ci><apply id="S4.Ex2.m1.5.5.2.2.2.4.cmml" xref="S4.Ex2.m1.5.5.2.2.2.4"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.2.2.2.4.1.cmml" xref="S4.Ex2.m1.5.5.2.2.2.4">superscript</csymbol><ci id="S4.Ex2.m1.5.5.2.2.2.4.2.cmml" xref="S4.Ex2.m1.5.5.2.2.2.4.2">𝑓</ci><ci id="S4.Ex2.m1.5.5.2.2.2.4.3.cmml" xref="S4.Ex2.m1.5.5.2.2.2.4.3">𝑛</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.5c">\mathcal{G}=\left\langle n,l,E,u^{1}\ldots u^{n},f^{l+1}\ldots f^{n}\right\rangle</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.14" class="ltx_p">where <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">n</annotation></semantics></math> and <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">l</annotation></semantics></math> respectively represent the number of nodes, <span id="S4.SS2.p1.14.1" class="ltx_ERROR undefined">\ie</span>, transformations, and the number of leaf nodes (inputs and parameters) <em id="S4.SS2.p1.14.2" class="ltx_emph ltx_font_italic">s.t.</em> <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="1\leq l&lt;n" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">1</mn><mo id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">≤</mo><mi id="S4.SS2.p1.3.m3.1.1.4" xref="S4.SS2.p1.3.m3.1.1.4.cmml">l</mi><mo id="S4.SS2.p1.3.m3.1.1.5" xref="S4.SS2.p1.3.m3.1.1.5.cmml">&lt;</mo><mi id="S4.SS2.p1.3.m3.1.1.6" xref="S4.SS2.p1.3.m3.1.1.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><and id="S4.SS2.p1.3.m3.1.1a.cmml" xref="S4.SS2.p1.3.m3.1.1"></and><apply id="S4.SS2.p1.3.m3.1.1b.cmml" xref="S4.SS2.p1.3.m3.1.1"><leq id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3"></leq><cn type="integer" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">1</cn><ci id="S4.SS2.p1.3.m3.1.1.4.cmml" xref="S4.SS2.p1.3.m3.1.1.4">𝑙</ci></apply><apply id="S4.SS2.p1.3.m3.1.1c.cmml" xref="S4.SS2.p1.3.m3.1.1"><lt id="S4.SS2.p1.3.m3.1.1.5.cmml" xref="S4.SS2.p1.3.m3.1.1.5"></lt><share href="#S4.SS2.p1.3.m3.1.1.4.cmml" id="S4.SS2.p1.3.m3.1.1d.cmml" xref="S4.SS2.p1.3.m3.1.1"></share><ci id="S4.SS2.p1.3.m3.1.1.6.cmml" xref="S4.SS2.p1.3.m3.1.1.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">1\leq l&lt;n</annotation></semantics></math>.
<math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">E</annotation></semantics></math> denotes the set of edges in the graph.
For each <math id="S4.SS2.p1.5.m5.2" class="ltx_Math" alttext="(j,i)" display="inline"><semantics id="S4.SS2.p1.5.m5.2a"><mrow id="S4.SS2.p1.5.m5.2.3.2" xref="S4.SS2.p1.5.m5.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.5.m5.2.3.2.1" xref="S4.SS2.p1.5.m5.2.3.1.cmml">(</mo><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">j</mi><mo id="S4.SS2.p1.5.m5.2.3.2.2" xref="S4.SS2.p1.5.m5.2.3.1.cmml">,</mo><mi id="S4.SS2.p1.5.m5.2.2" xref="S4.SS2.p1.5.m5.2.2.cmml">i</mi><mo stretchy="false" id="S4.SS2.p1.5.m5.2.3.2.3" xref="S4.SS2.p1.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.2b"><interval closure="open" id="S4.SS2.p1.5.m5.2.3.1.cmml" xref="S4.SS2.p1.5.m5.2.3.2"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝑗</ci><ci id="S4.SS2.p1.5.m5.2.2.cmml" xref="S4.SS2.p1.5.m5.2.2">𝑖</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.2c">(j,i)</annotation></semantics></math> of <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">E</annotation></semantics></math>, we have that <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="j&lt;i" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">j</mi><mo id="S4.SS2.p1.7.m7.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.cmml">&lt;</mo><mi id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><lt id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1"></lt><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝑗</ci><ci id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">j&lt;i</annotation></semantics></math> with <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="j\in\{1\makebox[8.00003pt][c]{.\hfil.\hfil.}(n-1)\}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mrow id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml">j</mi><mo id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">∈</mo><mrow id="S4.SS2.p1.8.m8.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.8.m8.1.1.1.1.2" xref="S4.SS2.p1.8.m8.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p1.8.m8.1.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.cmml"><mn id="S4.SS2.p1.8.m8.1.1.1.1.1.3" xref="S4.SS2.p1.8.m8.1.1.1.1.1.3.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1.1.1.1.2" xref="S4.SS2.p1.8.m8.1.1.1.1.1.2.cmml">​</mo><mpadded width="8.0pt" id="S4.SS2.p1.8.m8.1.1.1.1.1.4" xref="S4.SS2.p1.8.m8.1.1.1.1.1.4b.cmml"><mtext id="S4.SS2.p1.8.m8.1.1.1.1.1.4a" xref="S4.SS2.p1.8.m8.1.1.1.1.1.4b.cmml">. . .</mtext></mpadded><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1.1.1.1.2a" xref="S4.SS2.p1.8.m8.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml">n</mi><mo id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.8.m8.1.1.1.1.3" xref="S4.SS2.p1.8.m8.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><in id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2"></in><ci id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3">𝑗</ci><set id="S4.SS2.p1.8.m8.1.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1"><apply id="S4.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1"><times id="S4.SS2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.2"></times><cn type="integer" id="S4.SS2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.3">1</cn><ci id="S4.SS2.p1.8.m8.1.1.1.1.1.4b.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.4"><mpadded width="8.0pt" id="S4.SS2.p1.8.m8.1.1.1.1.1.4.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.4"><mtext id="S4.SS2.p1.8.m8.1.1.1.1.1.4a.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.4">. . .</mtext></mpadded></ci><apply id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1"><minus id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">j\in\{1\makebox[8.00003pt][c]{.\hfil.\hfil.}(n-1)\}</annotation></semantics></math> and <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="i\in\{(l+1)\makebox[8.00003pt][c]{.\hfil.\hfil.}n\}" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mrow id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml"><mi id="S4.SS2.p1.9.m9.1.1.3" xref="S4.SS2.p1.9.m9.1.1.3.cmml">i</mi><mo id="S4.SS2.p1.9.m9.1.1.2" xref="S4.SS2.p1.9.m9.1.1.2.cmml">∈</mo><mrow id="S4.SS2.p1.9.m9.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m9.1.1.1.1.2" xref="S4.SS2.p1.9.m9.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p1.9.m9.1.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.1.1.cmml"><mrow id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m9.1.1.1.1.1.2" xref="S4.SS2.p1.9.m9.1.1.1.1.1.2.cmml">​</mo><mpadded width="8.0pt" id="S4.SS2.p1.9.m9.1.1.1.1.1.3" xref="S4.SS2.p1.9.m9.1.1.1.1.1.3b.cmml"><mtext id="S4.SS2.p1.9.m9.1.1.1.1.1.3a" xref="S4.SS2.p1.9.m9.1.1.1.1.1.3b.cmml">. . .</mtext></mpadded><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m9.1.1.1.1.1.2a" xref="S4.SS2.p1.9.m9.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS2.p1.9.m9.1.1.1.1.1.4" xref="S4.SS2.p1.9.m9.1.1.1.1.1.4.cmml">n</mi></mrow><mo stretchy="false" id="S4.SS2.p1.9.m9.1.1.1.1.3" xref="S4.SS2.p1.9.m9.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><apply id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1"><in id="S4.SS2.p1.9.m9.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.2"></in><ci id="S4.SS2.p1.9.m9.1.1.3.cmml" xref="S4.SS2.p1.9.m9.1.1.3">𝑖</ci><set id="S4.SS2.p1.9.m9.1.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1"><apply id="S4.SS2.p1.9.m9.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1"><times id="S4.SS2.p1.9.m9.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.2"></times><apply id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1"><plus id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.1"></plus><ci id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S4.SS2.p1.9.m9.1.1.1.1.1.3b.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.3"><mpadded width="8.0pt" id="S4.SS2.p1.9.m9.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.3"><mtext id="S4.SS2.p1.9.m9.1.1.1.1.1.3a.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.3">. . .</mtext></mpadded></ci><ci id="S4.SS2.p1.9.m9.1.1.1.1.1.4.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1.1.4">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">i\in\{(l+1)\makebox[8.00003pt][c]{.\hfil.\hfil.}n\}</annotation></semantics></math>. The <math id="S4.SS2.p1.10.m10.1" class="ltx_Math" alttext="u^{i}" display="inline"><semantics id="S4.SS2.p1.10.m10.1a"><msup id="S4.SS2.p1.10.m10.1.1" xref="S4.SS2.p1.10.m10.1.1.cmml"><mi id="S4.SS2.p1.10.m10.1.1.2" xref="S4.SS2.p1.10.m10.1.1.2.cmml">u</mi><mi id="S4.SS2.p1.10.m10.1.1.3" xref="S4.SS2.p1.10.m10.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b"><apply id="S4.SS2.p1.10.m10.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m10.1.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">superscript</csymbol><ci id="S4.SS2.p1.10.m10.1.1.2.cmml" xref="S4.SS2.p1.10.m10.1.1.2">𝑢</ci><ci id="S4.SS2.p1.10.m10.1.1.3.cmml" xref="S4.SS2.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">u^{i}</annotation></semantics></math> are the variables associated with every numbered vertex <math id="S4.SS2.p1.11.m11.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.11.m11.1a"><mi id="S4.SS2.p1.11.m11.1.1" xref="S4.SS2.p1.11.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m11.1b"><ci id="S4.SS2.p1.11.m11.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m11.1c">i</annotation></semantics></math> inside <math id="S4.SS2.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S4.SS2.p1.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.12.m12.1.1" xref="S4.SS2.p1.12.m12.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m12.1b"><ci id="S4.SS2.p1.12.m12.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m12.1c">\mathcal{G}</annotation></semantics></math>. They can be scalars or vector values of any dimension. The <math id="S4.SS2.p1.13.m13.1" class="ltx_Math" alttext="f^{i}" display="inline"><semantics id="S4.SS2.p1.13.m13.1a"><msup id="S4.SS2.p1.13.m13.1.1" xref="S4.SS2.p1.13.m13.1.1.cmml"><mi id="S4.SS2.p1.13.m13.1.1.2" xref="S4.SS2.p1.13.m13.1.1.2.cmml">f</mi><mi id="S4.SS2.p1.13.m13.1.1.3" xref="S4.SS2.p1.13.m13.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m13.1b"><apply id="S4.SS2.p1.13.m13.1.1.cmml" xref="S4.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.13.m13.1.1.1.cmml" xref="S4.SS2.p1.13.m13.1.1">superscript</csymbol><ci id="S4.SS2.p1.13.m13.1.1.2.cmml" xref="S4.SS2.p1.13.m13.1.1.2">𝑓</ci><ci id="S4.SS2.p1.13.m13.1.1.3.cmml" xref="S4.SS2.p1.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m13.1c">f^{i}</annotation></semantics></math> are the differentiable functions associated with each non-leaf vertex.
We also assume a TEE enclave <math id="S4.SS2.p1.14.m14.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S4.SS2.p1.14.m14.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.14.m14.1.1" xref="S4.SS2.p1.14.m14.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m14.1b"><ci id="S4.SS2.p1.14.m14.1.1.cmml" xref="S4.SS2.p1.14.m14.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m14.1c">\mathcal{E}</annotation></semantics></math> that can physically and unequivocally hide quantities stored inside (<span id="S4.SS2.p1.14.3" class="ltx_ERROR undefined">\eg</span>side-channel to TEEs are out of scope).</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.2" class="ltx_p">To mitigate the adversarial attack, the <span id="S4.SS2.p2.2.1" class="ltx_text ltx_font_smallcaps">Pelta</span> shielding scheme presented in Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> stores in the TEE enclave <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mathcal{E}</annotation></semantics></math> all the children jacobian matrices of the first layer, <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\{\partial f_{j}^{1}/\partial{x}\}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.2.m2.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">{</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.cmml">∂</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.1.2.cmml"><msubsup id="S4.SS2.p2.2.m2.1.1.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.2" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.2.cmml">f</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.3" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.3.cmml">j</mi><mn id="S4.SS2.p2.2.m2.1.1.1.1.2.2.3" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2.3.cmml">1</mn></msubsup><mo id="S4.SS2.p2.2.m2.1.1.1.1.2.1" xref="S4.SS2.p2.2.m2.1.1.1.1.2.1.cmml">/</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1.1.2.3.1" xref="S4.SS2.p2.2.m2.1.1.1.1.2.3.1.cmml">∂</mo><mi id="S4.SS2.p2.2.m2.1.1.1.1.2.3.2" xref="S4.SS2.p2.2.m2.1.1.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><mo stretchy="false" id="S4.SS2.p2.2.m2.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><set id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1"><apply id="S4.SS2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1"><partialdiff id="S4.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1"></partialdiff><apply id="S4.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2"><divide id="S4.SS2.p2.2.m2.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.1"></divide><apply id="S4.SS2.p2.2.m2.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2">superscript</csymbol><apply id="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.2">𝑓</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2.2.3">𝑗</ci></apply><cn type="integer" id="S4.SS2.p2.2.m2.1.1.1.1.2.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.2.3">1</cn></apply><apply id="S4.SS2.p2.2.m2.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.3"><partialdiff id="S4.SS2.p2.2.m2.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.3.1"></partialdiff><ci id="S4.SS2.p2.2.m2.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.2.3.2">𝑥</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\{\partial f_{j}^{1}/\partial{x}\}</annotation></semantics></math>.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.17" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.2.2" class="ltx_listingline">


<span id="algorithm1.2.2.1" class="ltx_text"><span id="algorithm1.2.2.1.1" class="ltx_text ltx_font_bold">Data:</span> </span><math id="algorithm1.1.1.m1.5" class="ltx_Math" alttext="\mathcal{G}=\langle n,l,E,u^{1}\ldots u^{n},f^{l+1}\ldots f^{n}\rangle" display="inline"><semantics id="algorithm1.1.1.m1.5a"><mrow id="algorithm1.1.1.m1.5.5" xref="algorithm1.1.1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.1.1.m1.5.5.4" xref="algorithm1.1.1.m1.5.5.4.cmml">𝒢</mi><mo id="algorithm1.1.1.m1.5.5.3" xref="algorithm1.1.1.m1.5.5.3.cmml">=</mo><mrow id="algorithm1.1.1.m1.5.5.2.2" xref="algorithm1.1.1.m1.5.5.2.3.cmml"><mo stretchy="false" id="algorithm1.1.1.m1.5.5.2.2.3" xref="algorithm1.1.1.m1.5.5.2.3.cmml">⟨</mo><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">n</mi><mo id="algorithm1.1.1.m1.5.5.2.2.4" xref="algorithm1.1.1.m1.5.5.2.3.cmml">,</mo><mi id="algorithm1.1.1.m1.2.2" xref="algorithm1.1.1.m1.2.2.cmml">l</mi><mo id="algorithm1.1.1.m1.5.5.2.2.5" xref="algorithm1.1.1.m1.5.5.2.3.cmml">,</mo><mi id="algorithm1.1.1.m1.3.3" xref="algorithm1.1.1.m1.3.3.cmml">E</mi><mo id="algorithm1.1.1.m1.5.5.2.2.6" xref="algorithm1.1.1.m1.5.5.2.3.cmml">,</mo><mrow id="algorithm1.1.1.m1.4.4.1.1.1" xref="algorithm1.1.1.m1.4.4.1.1.1.cmml"><msup id="algorithm1.1.1.m1.4.4.1.1.1.2" xref="algorithm1.1.1.m1.4.4.1.1.1.2.cmml"><mi id="algorithm1.1.1.m1.4.4.1.1.1.2.2" xref="algorithm1.1.1.m1.4.4.1.1.1.2.2.cmml">u</mi><mn id="algorithm1.1.1.m1.4.4.1.1.1.2.3" xref="algorithm1.1.1.m1.4.4.1.1.1.2.3.cmml">1</mn></msup><mo lspace="0em" rspace="0em" id="algorithm1.1.1.m1.4.4.1.1.1.1" xref="algorithm1.1.1.m1.4.4.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.1.1.m1.4.4.1.1.1.3" xref="algorithm1.1.1.m1.4.4.1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="algorithm1.1.1.m1.4.4.1.1.1.1a" xref="algorithm1.1.1.m1.4.4.1.1.1.1.cmml">​</mo><msup id="algorithm1.1.1.m1.4.4.1.1.1.4" xref="algorithm1.1.1.m1.4.4.1.1.1.4.cmml"><mi id="algorithm1.1.1.m1.4.4.1.1.1.4.2" xref="algorithm1.1.1.m1.4.4.1.1.1.4.2.cmml">u</mi><mi id="algorithm1.1.1.m1.4.4.1.1.1.4.3" xref="algorithm1.1.1.m1.4.4.1.1.1.4.3.cmml">n</mi></msup></mrow><mo id="algorithm1.1.1.m1.5.5.2.2.7" xref="algorithm1.1.1.m1.5.5.2.3.cmml">,</mo><mrow id="algorithm1.1.1.m1.5.5.2.2.2" xref="algorithm1.1.1.m1.5.5.2.2.2.cmml"><msup id="algorithm1.1.1.m1.5.5.2.2.2.2" xref="algorithm1.1.1.m1.5.5.2.2.2.2.cmml"><mi id="algorithm1.1.1.m1.5.5.2.2.2.2.2" xref="algorithm1.1.1.m1.5.5.2.2.2.2.2.cmml">f</mi><mrow id="algorithm1.1.1.m1.5.5.2.2.2.2.3" xref="algorithm1.1.1.m1.5.5.2.2.2.2.3.cmml"><mi id="algorithm1.1.1.m1.5.5.2.2.2.2.3.2" xref="algorithm1.1.1.m1.5.5.2.2.2.2.3.2.cmml">l</mi><mo id="algorithm1.1.1.m1.5.5.2.2.2.2.3.1" xref="algorithm1.1.1.m1.5.5.2.2.2.2.3.1.cmml">+</mo><mn id="algorithm1.1.1.m1.5.5.2.2.2.2.3.3" xref="algorithm1.1.1.m1.5.5.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="algorithm1.1.1.m1.5.5.2.2.2.1" xref="algorithm1.1.1.m1.5.5.2.2.2.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.1.1.m1.5.5.2.2.2.3" xref="algorithm1.1.1.m1.5.5.2.2.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="algorithm1.1.1.m1.5.5.2.2.2.1a" xref="algorithm1.1.1.m1.5.5.2.2.2.1.cmml">​</mo><msup id="algorithm1.1.1.m1.5.5.2.2.2.4" xref="algorithm1.1.1.m1.5.5.2.2.2.4.cmml"><mi id="algorithm1.1.1.m1.5.5.2.2.2.4.2" xref="algorithm1.1.1.m1.5.5.2.2.2.4.2.cmml">f</mi><mi id="algorithm1.1.1.m1.5.5.2.2.2.4.3" xref="algorithm1.1.1.m1.5.5.2.2.2.4.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="algorithm1.1.1.m1.5.5.2.2.8" xref="algorithm1.1.1.m1.5.5.2.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.5b"><apply id="algorithm1.1.1.m1.5.5.cmml" xref="algorithm1.1.1.m1.5.5"><eq id="algorithm1.1.1.m1.5.5.3.cmml" xref="algorithm1.1.1.m1.5.5.3"></eq><ci id="algorithm1.1.1.m1.5.5.4.cmml" xref="algorithm1.1.1.m1.5.5.4">𝒢</ci><list id="algorithm1.1.1.m1.5.5.2.3.cmml" xref="algorithm1.1.1.m1.5.5.2.2"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝑛</ci><ci id="algorithm1.1.1.m1.2.2.cmml" xref="algorithm1.1.1.m1.2.2">𝑙</ci><ci id="algorithm1.1.1.m1.3.3.cmml" xref="algorithm1.1.1.m1.3.3">𝐸</ci><apply id="algorithm1.1.1.m1.4.4.1.1.1.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1"><times id="algorithm1.1.1.m1.4.4.1.1.1.1.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.1"></times><apply id="algorithm1.1.1.m1.4.4.1.1.1.2.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.4.4.1.1.1.2.1.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.2">superscript</csymbol><ci id="algorithm1.1.1.m1.4.4.1.1.1.2.2.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.2.2">𝑢</ci><cn type="integer" id="algorithm1.1.1.m1.4.4.1.1.1.2.3.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.2.3">1</cn></apply><ci id="algorithm1.1.1.m1.4.4.1.1.1.3.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.3">…</ci><apply id="algorithm1.1.1.m1.4.4.1.1.1.4.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.4"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.4.4.1.1.1.4.1.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.4">superscript</csymbol><ci id="algorithm1.1.1.m1.4.4.1.1.1.4.2.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.4.2">𝑢</ci><ci id="algorithm1.1.1.m1.4.4.1.1.1.4.3.cmml" xref="algorithm1.1.1.m1.4.4.1.1.1.4.3">𝑛</ci></apply></apply><apply id="algorithm1.1.1.m1.5.5.2.2.2.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2"><times id="algorithm1.1.1.m1.5.5.2.2.2.1.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.1"></times><apply id="algorithm1.1.1.m1.5.5.2.2.2.2.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.5.5.2.2.2.2.1.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.2">superscript</csymbol><ci id="algorithm1.1.1.m1.5.5.2.2.2.2.2.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.2.2">𝑓</ci><apply id="algorithm1.1.1.m1.5.5.2.2.2.2.3.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.2.3"><plus id="algorithm1.1.1.m1.5.5.2.2.2.2.3.1.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.2.3.1"></plus><ci id="algorithm1.1.1.m1.5.5.2.2.2.2.3.2.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.2.3.2">𝑙</ci><cn type="integer" id="algorithm1.1.1.m1.5.5.2.2.2.2.3.3.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.1.1.m1.5.5.2.2.2.3.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.3">…</ci><apply id="algorithm1.1.1.m1.5.5.2.2.2.4.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.4"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.5.5.2.2.2.4.1.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.4">superscript</csymbol><ci id="algorithm1.1.1.m1.5.5.2.2.2.4.2.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.4.2">𝑓</ci><ci id="algorithm1.1.1.m1.5.5.2.2.2.4.3.cmml" xref="algorithm1.1.1.m1.5.5.2.2.2.4.3">𝑛</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.5c">\mathcal{G}=\langle n,l,E,u^{1}\ldots u^{n},f^{l+1}\ldots f^{n}\rangle</annotation></semantics></math>; enclave <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">\mathcal{E}</annotation></semantics></math>
</div>
<div id="algorithm1.3.3" class="ltx_listingline">

<span id="algorithm1.3.3.2" class="ltx_text ltx_font_bold">Algorithm</span> <em id="algorithm1.3.3.1" class="ltx_emph ltx_font_sansserif ltx_font_smallcaps">Pelta<math id="algorithm1.3.3.1.1.m1.1" class="ltx_Math" alttext="(\mathcal{G})" display="inline"><semantics id="algorithm1.3.3.1.1.m1.1a"><mrow id="algorithm1.3.3.1.1.m1.1.2.2"><mo stretchy="false" id="algorithm1.3.3.1.1.m1.1.2.2.1">(</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.3.3.1.1.m1.1.1" xref="algorithm1.3.3.1.1.m1.1.1.cmml">𝒢</mi><mo stretchy="false" id="algorithm1.3.3.1.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.1.1.m1.1b"><ci id="algorithm1.3.3.1.1.m1.1.1.cmml" xref="algorithm1.3.3.1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.1.1.m1.1c">(\mathcal{G})</annotation></semantics></math></em>
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.4.4.m1.1" class="ltx_Math" alttext="S\leftarrow" display="inline"><semantics id="algorithm1.4.4.m1.1a"><mrow id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml"><mi id="algorithm1.4.4.m1.1.1.2" xref="algorithm1.4.4.m1.1.1.2.cmml">S</mi><mo stretchy="false" id="algorithm1.4.4.m1.1.1.1" xref="algorithm1.4.4.m1.1.1.1.cmml">←</mo><mi id="algorithm1.4.4.m1.1.1.3" xref="algorithm1.4.4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.1b"><apply id="algorithm1.4.4.m1.1.1.cmml" xref="algorithm1.4.4.m1.1.1"><ci id="algorithm1.4.4.m1.1.1.1.cmml" xref="algorithm1.4.4.m1.1.1.1">←</ci><ci id="algorithm1.4.4.m1.1.1.2.cmml" xref="algorithm1.4.4.m1.1.1.2">𝑆</ci><csymbol cd="latexml" id="algorithm1.4.4.m1.1.1.3.cmml" xref="algorithm1.4.4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.1c">S\leftarrow</annotation></semantics></math> <span id="algorithm1.5.5.1" class="ltx_text ltx_font_sansserif">Select<math id="algorithm1.5.5.1.m1.1" class="ltx_Math" alttext="(u^{l+1}\ldots u^{n})" display="inline"><semantics id="algorithm1.5.5.1.m1.1a"><mrow id="algorithm1.5.5.1.m1.1.1.1" xref="algorithm1.5.5.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.5.5.1.m1.1.1.1.2" xref="algorithm1.5.5.1.m1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.5.5.1.m1.1.1.1.1" xref="algorithm1.5.5.1.m1.1.1.1.1.cmml"><msup id="algorithm1.5.5.1.m1.1.1.1.1.2" xref="algorithm1.5.5.1.m1.1.1.1.1.2.cmml"><mi id="algorithm1.5.5.1.m1.1.1.1.1.2.2" xref="algorithm1.5.5.1.m1.1.1.1.1.2.2.cmml">u</mi><mrow id="algorithm1.5.5.1.m1.1.1.1.1.2.3" xref="algorithm1.5.5.1.m1.1.1.1.1.2.3.cmml"><mi id="algorithm1.5.5.1.m1.1.1.1.1.2.3.2" xref="algorithm1.5.5.1.m1.1.1.1.1.2.3.2.cmml">l</mi><mo id="algorithm1.5.5.1.m1.1.1.1.1.2.3.1" xref="algorithm1.5.5.1.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="algorithm1.5.5.1.m1.1.1.1.1.2.3.3" xref="algorithm1.5.5.1.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="algorithm1.5.5.1.m1.1.1.1.1.1" xref="algorithm1.5.5.1.m1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.5.5.1.m1.1.1.1.1.3" xref="algorithm1.5.5.1.m1.1.1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="algorithm1.5.5.1.m1.1.1.1.1.1a" xref="algorithm1.5.5.1.m1.1.1.1.1.1.cmml">​</mo><msup id="algorithm1.5.5.1.m1.1.1.1.1.4" xref="algorithm1.5.5.1.m1.1.1.1.1.4.cmml"><mi id="algorithm1.5.5.1.m1.1.1.1.1.4.2" xref="algorithm1.5.5.1.m1.1.1.1.1.4.2.cmml">u</mi><mi id="algorithm1.5.5.1.m1.1.1.1.1.4.3" xref="algorithm1.5.5.1.m1.1.1.1.1.4.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="algorithm1.5.5.1.m1.1.1.1.3" xref="algorithm1.5.5.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.1.m1.1b"><apply id="algorithm1.5.5.1.m1.1.1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1"><times id="algorithm1.5.5.1.m1.1.1.1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.1"></times><apply id="algorithm1.5.5.1.m1.1.1.1.1.2.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.5.5.1.m1.1.1.1.1.2.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.2">superscript</csymbol><ci id="algorithm1.5.5.1.m1.1.1.1.1.2.2.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.2.2">𝑢</ci><apply id="algorithm1.5.5.1.m1.1.1.1.1.2.3.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.2.3"><plus id="algorithm1.5.5.1.m1.1.1.1.1.2.3.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.2.3.1"></plus><ci id="algorithm1.5.5.1.m1.1.1.1.1.2.3.2.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.2.3.2">𝑙</ci><cn type="integer" id="algorithm1.5.5.1.m1.1.1.1.1.2.3.3.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.5.5.1.m1.1.1.1.1.3.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.3">…</ci><apply id="algorithm1.5.5.1.m1.1.1.1.1.4.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="algorithm1.5.5.1.m1.1.1.1.1.4.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.4">superscript</csymbol><ci id="algorithm1.5.5.1.m1.1.1.1.1.4.2.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.4.2">𝑢</ci><ci id="algorithm1.5.5.1.m1.1.1.1.1.4.3.cmml" xref="algorithm1.5.5.1.m1.1.1.1.1.4.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.1.m1.1c">(u^{l+1}\ldots u^{n})</annotation></semantics></math></span> 
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.8.8.4" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.7.7.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.6.6.1.m1.1" class="ltx_Math" alttext="u" display="inline"><semantics id="algorithm1.6.6.1.m1.1a"><mi id="algorithm1.6.6.1.m1.1.1" xref="algorithm1.6.6.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.1.m1.1b"><ci id="algorithm1.6.6.1.m1.1.1.cmml" xref="algorithm1.6.6.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.1.m1.1c">u</annotation></semantics></math> in <math id="algorithm1.7.7.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm1.7.7.2.m2.1a"><mi id="algorithm1.7.7.2.m2.1.1" xref="algorithm1.7.7.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.2.m2.1b"><ci id="algorithm1.7.7.2.m2.1.1.cmml" xref="algorithm1.7.7.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.2.m2.1c">S</annotation></semantics></math></em> <span id="algorithm1.8.8.5" class="ltx_text ltx_font_bold">do</span> <span id="algorithm1.8.8.3" class="ltx_text ltx_font_sansserif">Shield<math id="algorithm1.8.8.3.m1.2" class="ltx_Math" alttext="(u,\mathcal{E})" display="inline"><semantics id="algorithm1.8.8.3.m1.2a"><mrow id="algorithm1.8.8.3.m1.2.3.2" xref="algorithm1.8.8.3.m1.2.3.1.cmml"><mo stretchy="false" id="algorithm1.8.8.3.m1.2.3.2.1" xref="algorithm1.8.8.3.m1.2.3.1.cmml">(</mo><mi id="algorithm1.8.8.3.m1.1.1" xref="algorithm1.8.8.3.m1.1.1.cmml">u</mi><mo id="algorithm1.8.8.3.m1.2.3.2.2" xref="algorithm1.8.8.3.m1.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.8.8.3.m1.2.2" xref="algorithm1.8.8.3.m1.2.2.cmml">ℰ</mi><mo stretchy="false" id="algorithm1.8.8.3.m1.2.3.2.3" xref="algorithm1.8.8.3.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.3.m1.2b"><interval closure="open" id="algorithm1.8.8.3.m1.2.3.1.cmml" xref="algorithm1.8.8.3.m1.2.3.2"><ci id="algorithm1.8.8.3.m1.1.1.cmml" xref="algorithm1.8.8.3.m1.1.1">𝑢</ci><ci id="algorithm1.8.8.3.m1.2.2.cmml" xref="algorithm1.8.8.3.m1.2.2">ℰ</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.3.m1.2c">(u,\mathcal{E})</annotation></semantics></math></span>
</div>
<div id="algorithm1.17.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.17.18.1" class="ltx_text ltx_font_bold">return</span> 
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span id="algorithm1.9.9.2" class="ltx_text ltx_font_bold">Algorithm</span> <em id="algorithm1.9.9.1" class="ltx_emph ltx_font_sansserif">Shield<math id="algorithm1.9.9.1.1.m1.2" class="ltx_Math" alttext="(u^{i},\mathcal{E})" display="inline"><semantics id="algorithm1.9.9.1.1.m1.2a"><mrow id="algorithm1.9.9.1.1.m1.2.2.1" xref="algorithm1.9.9.1.1.m1.2.2.2.cmml"><mo stretchy="false" id="algorithm1.9.9.1.1.m1.2.2.1.2" xref="algorithm1.9.9.1.1.m1.2.2.2.cmml">(</mo><msup id="algorithm1.9.9.1.1.m1.2.2.1.1" xref="algorithm1.9.9.1.1.m1.2.2.1.1.cmml"><mi id="algorithm1.9.9.1.1.m1.2.2.1.1.2" xref="algorithm1.9.9.1.1.m1.2.2.1.1.2.cmml">u</mi><mi id="algorithm1.9.9.1.1.m1.2.2.1.1.3" xref="algorithm1.9.9.1.1.m1.2.2.1.1.3.cmml">i</mi></msup><mo id="algorithm1.9.9.1.1.m1.2.2.1.3" xref="algorithm1.9.9.1.1.m1.2.2.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.9.9.1.1.m1.1.1" xref="algorithm1.9.9.1.1.m1.1.1.cmml">ℰ</mi><mo stretchy="false" id="algorithm1.9.9.1.1.m1.2.2.1.4" xref="algorithm1.9.9.1.1.m1.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.1.1.m1.2b"><interval closure="open" id="algorithm1.9.9.1.1.m1.2.2.2.cmml" xref="algorithm1.9.9.1.1.m1.2.2.1"><apply id="algorithm1.9.9.1.1.m1.2.2.1.1.cmml" xref="algorithm1.9.9.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.1.1.m1.2.2.1.1.1.cmml" xref="algorithm1.9.9.1.1.m1.2.2.1.1">superscript</csymbol><ci id="algorithm1.9.9.1.1.m1.2.2.1.1.2.cmml" xref="algorithm1.9.9.1.1.m1.2.2.1.1.2">𝑢</ci><ci id="algorithm1.9.9.1.1.m1.2.2.1.1.3.cmml" xref="algorithm1.9.9.1.1.m1.2.2.1.1.3">𝑖</ci></apply><ci id="algorithm1.9.9.1.1.m1.1.1.cmml" xref="algorithm1.9.9.1.1.m1.1.1">ℰ</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.1.1.m1.2c">(u^{i},\mathcal{E})</annotation></semantics></math></em>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="\mathcal{E}\leftarrow\mathcal{E}+\{u^{i}\}" display="inline"><semantics id="algorithm1.10.10.m1.1a"><mrow id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml">ℰ</mi><mo stretchy="false" id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.10.10.m1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.10.10.m1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.3.cmml">ℰ</mi><mo id="algorithm1.10.10.m1.1.1.1.2" xref="algorithm1.10.10.m1.1.1.1.2.cmml">+</mo><mrow id="algorithm1.10.10.m1.1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.10.10.m1.1.1.1.1.1.2" xref="algorithm1.10.10.m1.1.1.1.1.2.cmml">{</mo><msup id="algorithm1.10.10.m1.1.1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.10.10.m1.1.1.1.1.1.1.2" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.cmml">u</mi><mi id="algorithm1.10.10.m1.1.1.1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="algorithm1.10.10.m1.1.1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><ci id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2">←</ci><ci id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3">ℰ</ci><apply id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1"><plus id="algorithm1.10.10.m1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.1.2"></plus><ci id="algorithm1.10.10.m1.1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.1.3">ℰ</ci><set id="algorithm1.10.10.m1.1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1"><apply id="algorithm1.10.10.m1.1.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.10.10.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2">𝑢</ci><ci id="algorithm1.10.10.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">\mathcal{E}\leftarrow\mathcal{E}+\{u^{i}\}</annotation></semantics></math> 
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.11.11.m1.4" class="ltx_Math" alttext="\alpha^{i}\leftarrow\langle u^{j}\mid(j,i)\in E\rangle" display="inline"><semantics id="algorithm1.11.11.m1.4a"><mrow id="algorithm1.11.11.m1.4.4" xref="algorithm1.11.11.m1.4.4.cmml"><msup id="algorithm1.11.11.m1.4.4.4" xref="algorithm1.11.11.m1.4.4.4.cmml"><mi id="algorithm1.11.11.m1.4.4.4.2" xref="algorithm1.11.11.m1.4.4.4.2.cmml">α</mi><mi id="algorithm1.11.11.m1.4.4.4.3" xref="algorithm1.11.11.m1.4.4.4.3.cmml">i</mi></msup><mo stretchy="false" id="algorithm1.11.11.m1.4.4.3" xref="algorithm1.11.11.m1.4.4.3.cmml">←</mo><mrow id="algorithm1.11.11.m1.4.4.2.2" xref="algorithm1.11.11.m1.4.4.2.3.cmml"><mo stretchy="false" id="algorithm1.11.11.m1.4.4.2.2.3" xref="algorithm1.11.11.m1.4.4.2.3.1.cmml">⟨</mo><msup id="algorithm1.11.11.m1.3.3.1.1.1" xref="algorithm1.11.11.m1.3.3.1.1.1.cmml"><mi id="algorithm1.11.11.m1.3.3.1.1.1.2" xref="algorithm1.11.11.m1.3.3.1.1.1.2.cmml">u</mi><mi id="algorithm1.11.11.m1.3.3.1.1.1.3" xref="algorithm1.11.11.m1.3.3.1.1.1.3.cmml">j</mi></msup><mo fence="true" lspace="0em" rspace="0em" id="algorithm1.11.11.m1.4.4.2.2.4" xref="algorithm1.11.11.m1.4.4.2.3.1.cmml">∣</mo><mrow id="algorithm1.11.11.m1.4.4.2.2.2" xref="algorithm1.11.11.m1.4.4.2.2.2.cmml"><mrow id="algorithm1.11.11.m1.4.4.2.2.2.2.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.cmml"><mo stretchy="false" id="algorithm1.11.11.m1.4.4.2.2.2.2.2.1" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.cmml">(</mo><mi id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml">j</mi><mo id="algorithm1.11.11.m1.4.4.2.2.2.2.2.2" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.cmml">,</mo><mi id="algorithm1.11.11.m1.2.2" xref="algorithm1.11.11.m1.2.2.cmml">i</mi><mo stretchy="false" id="algorithm1.11.11.m1.4.4.2.2.2.2.2.3" xref="algorithm1.11.11.m1.4.4.2.2.2.2.1.cmml">)</mo></mrow><mo id="algorithm1.11.11.m1.4.4.2.2.2.1" xref="algorithm1.11.11.m1.4.4.2.2.2.1.cmml">∈</mo><mi id="algorithm1.11.11.m1.4.4.2.2.2.3" xref="algorithm1.11.11.m1.4.4.2.2.2.3.cmml">E</mi></mrow><mo stretchy="false" id="algorithm1.11.11.m1.4.4.2.2.5" xref="algorithm1.11.11.m1.4.4.2.3.1.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.4b"><apply id="algorithm1.11.11.m1.4.4.cmml" xref="algorithm1.11.11.m1.4.4"><ci id="algorithm1.11.11.m1.4.4.3.cmml" xref="algorithm1.11.11.m1.4.4.3">←</ci><apply id="algorithm1.11.11.m1.4.4.4.cmml" xref="algorithm1.11.11.m1.4.4.4"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.4.4.4.1.cmml" xref="algorithm1.11.11.m1.4.4.4">superscript</csymbol><ci id="algorithm1.11.11.m1.4.4.4.2.cmml" xref="algorithm1.11.11.m1.4.4.4.2">𝛼</ci><ci id="algorithm1.11.11.m1.4.4.4.3.cmml" xref="algorithm1.11.11.m1.4.4.4.3">𝑖</ci></apply><apply id="algorithm1.11.11.m1.4.4.2.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2"><csymbol cd="latexml" id="algorithm1.11.11.m1.4.4.2.3.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.3">inner-product</csymbol><apply id="algorithm1.11.11.m1.3.3.1.1.1.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.3.3.1.1.1.1.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1">superscript</csymbol><ci id="algorithm1.11.11.m1.3.3.1.1.1.2.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.2">𝑢</ci><ci id="algorithm1.11.11.m1.3.3.1.1.1.3.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.11.11.m1.4.4.2.2.2.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2"><in id="algorithm1.11.11.m1.4.4.2.2.2.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.1"></in><interval closure="open" id="algorithm1.11.11.m1.4.4.2.2.2.2.1.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.2.2"><ci id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1">𝑗</ci><ci id="algorithm1.11.11.m1.2.2.cmml" xref="algorithm1.11.11.m1.2.2">𝑖</ci></interval><ci id="algorithm1.11.11.m1.4.4.2.2.2.3.cmml" xref="algorithm1.11.11.m1.4.4.2.2.2.3">𝐸</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.4c">\alpha^{i}\leftarrow\langle u^{j}\mid(j,i)\in E\rangle</annotation></semantics></math> <span id="algorithm1.11.11.1" class="ltx_text"><span id="algorithm1.11.11.1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;color:#0000FF;">/* </span></span><span id="algorithm1.11.11.2" class="ltx_text ltx_font_typewriter" style="font-size:80%;color:#0000FF;">get parent vertices */</span>
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.13.13.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.13.13.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.12.12.1.m1.1" class="ltx_Math" alttext="u^{j}" display="inline"><semantics id="algorithm1.12.12.1.m1.1a"><msup id="algorithm1.12.12.1.m1.1.1" xref="algorithm1.12.12.1.m1.1.1.cmml"><mi id="algorithm1.12.12.1.m1.1.1.2" xref="algorithm1.12.12.1.m1.1.1.2.cmml">u</mi><mi id="algorithm1.12.12.1.m1.1.1.3" xref="algorithm1.12.12.1.m1.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.1.m1.1b"><apply id="algorithm1.12.12.1.m1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.1.m1.1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1">superscript</csymbol><ci id="algorithm1.12.12.1.m1.1.1.2.cmml" xref="algorithm1.12.12.1.m1.1.1.2">𝑢</ci><ci id="algorithm1.12.12.1.m1.1.1.3.cmml" xref="algorithm1.12.12.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.1.m1.1c">u^{j}</annotation></semantics></math> in <math id="algorithm1.13.13.2.m2.1" class="ltx_Math" alttext="\alpha^{i}" display="inline"><semantics id="algorithm1.13.13.2.m2.1a"><msup id="algorithm1.13.13.2.m2.1.1" xref="algorithm1.13.13.2.m2.1.1.cmml"><mi id="algorithm1.13.13.2.m2.1.1.2" xref="algorithm1.13.13.2.m2.1.1.2.cmml">α</mi><mi id="algorithm1.13.13.2.m2.1.1.3" xref="algorithm1.13.13.2.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.2.m2.1b"><apply id="algorithm1.13.13.2.m2.1.1.cmml" xref="algorithm1.13.13.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.2.m2.1.1.1.cmml" xref="algorithm1.13.13.2.m2.1.1">superscript</csymbol><ci id="algorithm1.13.13.2.m2.1.1.2.cmml" xref="algorithm1.13.13.2.m2.1.1.2">𝛼</ci><ci id="algorithm1.13.13.2.m2.1.1.3.cmml" xref="algorithm1.13.13.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.2.m2.1c">\alpha^{i}</annotation></semantics></math></em> <span id="algorithm1.13.13.4" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.14.14.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.14.14.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.14.14.1.m1.1" class="ltx_Math" alttext="u_{j}" display="inline"><semantics id="algorithm1.14.14.1.m1.1a"><msub id="algorithm1.14.14.1.m1.1.1" xref="algorithm1.14.14.1.m1.1.1.cmml"><mi id="algorithm1.14.14.1.m1.1.1.2" xref="algorithm1.14.14.1.m1.1.1.2.cmml">u</mi><mi id="algorithm1.14.14.1.m1.1.1.3" xref="algorithm1.14.14.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.1.m1.1b"><apply id="algorithm1.14.14.1.m1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.1.m1.1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1">subscript</csymbol><ci id="algorithm1.14.14.1.m1.1.1.2.cmml" xref="algorithm1.14.14.1.m1.1.1.2">𝑢</ci><ci id="algorithm1.14.14.1.m1.1.1.3.cmml" xref="algorithm1.14.14.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.1.m1.1c">u_{j}</annotation></semantics></math> is input </em> <span id="algorithm1.14.14.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.15.15.m1.1" class="ltx_Math" alttext="J^{j\rightarrow i}\leftarrow{\partial f^{i}\left(\alpha^{i}\right)}/{\partial u^{j}}" display="inline"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><msup id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml"><mi id="algorithm1.15.15.m1.1.1.3.2" xref="algorithm1.15.15.m1.1.1.3.2.cmml">J</mi><mrow id="algorithm1.15.15.m1.1.1.3.3" xref="algorithm1.15.15.m1.1.1.3.3.cmml"><mi id="algorithm1.15.15.m1.1.1.3.3.2" xref="algorithm1.15.15.m1.1.1.3.3.2.cmml">j</mi><mo stretchy="false" id="algorithm1.15.15.m1.1.1.3.3.1" xref="algorithm1.15.15.m1.1.1.3.3.1.cmml">→</mo><mi id="algorithm1.15.15.m1.1.1.3.3.3" xref="algorithm1.15.15.m1.1.1.3.3.3.cmml">i</mi></mrow></msup><mo rspace="0.1389em" stretchy="false" id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.15.15.m1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.cmml"><mo lspace="0.1389em" rspace="0em" id="algorithm1.15.15.m1.1.1.1.2" xref="algorithm1.15.15.m1.1.1.1.2.cmml">∂</mo><mrow id="algorithm1.15.15.m1.1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.1.cmml"><mrow id="algorithm1.15.15.m1.1.1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.1.1.cmml"><msup id="algorithm1.15.15.m1.1.1.1.1.1.3" xref="algorithm1.15.15.m1.1.1.1.1.1.3.cmml"><mi id="algorithm1.15.15.m1.1.1.1.1.1.3.2" xref="algorithm1.15.15.m1.1.1.1.1.1.3.2.cmml">f</mi><mi id="algorithm1.15.15.m1.1.1.1.1.1.3.3" xref="algorithm1.15.15.m1.1.1.1.1.1.3.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="algorithm1.15.15.m1.1.1.1.1.1.2" xref="algorithm1.15.15.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.15.15.m1.1.1.1.1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.15.15.m1.1.1.1.1.1.1.1.2" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="algorithm1.15.15.m1.1.1.1.1.1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.2" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.2.cmml">α</mi><mi id="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="algorithm1.15.15.m1.1.1.1.1.1.1.1.3" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.15.15.m1.1.1.1.1.2" xref="algorithm1.15.15.m1.1.1.1.1.2.cmml">/</mo><mrow id="algorithm1.15.15.m1.1.1.1.1.3" xref="algorithm1.15.15.m1.1.1.1.1.3.cmml"><mo lspace="0em" rspace="0em" id="algorithm1.15.15.m1.1.1.1.1.3.1" xref="algorithm1.15.15.m1.1.1.1.1.3.1.cmml">∂</mo><msup id="algorithm1.15.15.m1.1.1.1.1.3.2" xref="algorithm1.15.15.m1.1.1.1.1.3.2.cmml"><mi id="algorithm1.15.15.m1.1.1.1.1.3.2.2" xref="algorithm1.15.15.m1.1.1.1.1.3.2.2.cmml">u</mi><mi id="algorithm1.15.15.m1.1.1.1.1.3.2.3" xref="algorithm1.15.15.m1.1.1.1.1.3.2.3.cmml">j</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><ci id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2">←</ci><apply id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.3.1.cmml" xref="algorithm1.15.15.m1.1.1.3">superscript</csymbol><ci id="algorithm1.15.15.m1.1.1.3.2.cmml" xref="algorithm1.15.15.m1.1.1.3.2">𝐽</ci><apply id="algorithm1.15.15.m1.1.1.3.3.cmml" xref="algorithm1.15.15.m1.1.1.3.3"><ci id="algorithm1.15.15.m1.1.1.3.3.1.cmml" xref="algorithm1.15.15.m1.1.1.3.3.1">→</ci><ci id="algorithm1.15.15.m1.1.1.3.3.2.cmml" xref="algorithm1.15.15.m1.1.1.3.3.2">𝑗</ci><ci id="algorithm1.15.15.m1.1.1.3.3.3.cmml" xref="algorithm1.15.15.m1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1"><partialdiff id="algorithm1.15.15.m1.1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.1.2"></partialdiff><apply id="algorithm1.15.15.m1.1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1"><divide id="algorithm1.15.15.m1.1.1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.1.1.2"></divide><apply id="algorithm1.15.15.m1.1.1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1"><times id="algorithm1.15.15.m1.1.1.1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.2"></times><apply id="algorithm1.15.15.m1.1.1.1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.1.1.1.3.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.3">superscript</csymbol><ci id="algorithm1.15.15.m1.1.1.1.1.1.3.2.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.3.2">𝑓</ci><ci id="algorithm1.15.15.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.2">𝛼</ci><ci id="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="algorithm1.15.15.m1.1.1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.1.1.3"><partialdiff id="algorithm1.15.15.m1.1.1.1.1.3.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1.3.1"></partialdiff><apply id="algorithm1.15.15.m1.1.1.1.1.3.2.cmml" xref="algorithm1.15.15.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.1.1.3.2.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1.3.2">superscript</csymbol><ci id="algorithm1.15.15.m1.1.1.1.1.3.2.2.cmml" xref="algorithm1.15.15.m1.1.1.1.1.3.2.2">𝑢</ci><ci id="algorithm1.15.15.m1.1.1.1.1.3.2.3.cmml" xref="algorithm1.15.15.m1.1.1.1.1.3.2.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">J^{j\rightarrow i}\leftarrow{\partial f^{i}\left(\alpha^{i}\right)}/{\partial u^{j}}</annotation></semantics></math>  <span id="algorithm1.15.15.1" class="ltx_text"><span id="algorithm1.15.15.1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;color:#0000FF;">/* </span></span><span id="algorithm1.15.15.2" class="ltx_text ltx_font_typewriter" style="font-size:80%;color:#0000FF;">local jacobian */</span> 
</div>
<div id="algorithm1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.16.16.m1.1" class="ltx_Math" alttext="\mathcal{E}\leftarrow\mathcal{E}+\{J^{j\rightarrow i}\}" display="inline"><semantics id="algorithm1.16.16.m1.1a"><mrow id="algorithm1.16.16.m1.1.1" xref="algorithm1.16.16.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.16.16.m1.1.1.3" xref="algorithm1.16.16.m1.1.1.3.cmml">ℰ</mi><mo stretchy="false" id="algorithm1.16.16.m1.1.1.2" xref="algorithm1.16.16.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.16.16.m1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.16.16.m1.1.1.1.3" xref="algorithm1.16.16.m1.1.1.1.3.cmml">ℰ</mi><mo id="algorithm1.16.16.m1.1.1.1.2" xref="algorithm1.16.16.m1.1.1.1.2.cmml">+</mo><mrow id="algorithm1.16.16.m1.1.1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.16.16.m1.1.1.1.1.1.2" xref="algorithm1.16.16.m1.1.1.1.1.2.cmml">{</mo><msup id="algorithm1.16.16.m1.1.1.1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.16.16.m1.1.1.1.1.1.1.2" xref="algorithm1.16.16.m1.1.1.1.1.1.1.2.cmml">J</mi><mrow id="algorithm1.16.16.m1.1.1.1.1.1.1.3" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.16.16.m1.1.1.1.1.1.1.3.2" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3.2.cmml">j</mi><mo stretchy="false" id="algorithm1.16.16.m1.1.1.1.1.1.1.3.1" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3.1.cmml">→</mo><mi id="algorithm1.16.16.m1.1.1.1.1.1.1.3.3" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msup><mo stretchy="false" id="algorithm1.16.16.m1.1.1.1.1.1.3" xref="algorithm1.16.16.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.1b"><apply id="algorithm1.16.16.m1.1.1.cmml" xref="algorithm1.16.16.m1.1.1"><ci id="algorithm1.16.16.m1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.2">←</ci><ci id="algorithm1.16.16.m1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.3">ℰ</ci><apply id="algorithm1.16.16.m1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1"><plus id="algorithm1.16.16.m1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.1.2"></plus><ci id="algorithm1.16.16.m1.1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.1.3">ℰ</ci><set id="algorithm1.16.16.m1.1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1"><apply id="algorithm1.16.16.m1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.16.16.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1.2">𝐽</ci><apply id="algorithm1.16.16.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3"><ci id="algorithm1.16.16.m1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3.1">→</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3.2">𝑗</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.1c">\mathcal{E}\leftarrow\mathcal{E}+\{J^{j\rightarrow i}\}</annotation></semantics></math> 
</div>
<div id="algorithm1.17.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.17.17" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.17.17.1" class="ltx_text ltx_font_sansserif">Shield<math id="algorithm1.17.17.1.m1.2" class="ltx_Math" alttext="(u^{j},\mathcal{E})" display="inline"><semantics id="algorithm1.17.17.1.m1.2a"><mrow id="algorithm1.17.17.1.m1.2.2.1" xref="algorithm1.17.17.1.m1.2.2.2.cmml"><mo stretchy="false" id="algorithm1.17.17.1.m1.2.2.1.2" xref="algorithm1.17.17.1.m1.2.2.2.cmml">(</mo><msup id="algorithm1.17.17.1.m1.2.2.1.1" xref="algorithm1.17.17.1.m1.2.2.1.1.cmml"><mi id="algorithm1.17.17.1.m1.2.2.1.1.2" xref="algorithm1.17.17.1.m1.2.2.1.1.2.cmml">u</mi><mi id="algorithm1.17.17.1.m1.2.2.1.1.3" xref="algorithm1.17.17.1.m1.2.2.1.1.3.cmml">j</mi></msup><mo id="algorithm1.17.17.1.m1.2.2.1.3" xref="algorithm1.17.17.1.m1.2.2.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.17.17.1.m1.1.1" xref="algorithm1.17.17.1.m1.1.1.cmml">ℰ</mi><mo stretchy="false" id="algorithm1.17.17.1.m1.2.2.1.4" xref="algorithm1.17.17.1.m1.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.1.m1.2b"><interval closure="open" id="algorithm1.17.17.1.m1.2.2.2.cmml" xref="algorithm1.17.17.1.m1.2.2.1"><apply id="algorithm1.17.17.1.m1.2.2.1.1.cmml" xref="algorithm1.17.17.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.1.m1.2.2.1.1.1.cmml" xref="algorithm1.17.17.1.m1.2.2.1.1">superscript</csymbol><ci id="algorithm1.17.17.1.m1.2.2.1.1.2.cmml" xref="algorithm1.17.17.1.m1.2.2.1.1.2">𝑢</ci><ci id="algorithm1.17.17.1.m1.2.2.1.1.3.cmml" xref="algorithm1.17.17.1.m1.2.2.1.1.3">𝑗</ci></apply><ci id="algorithm1.17.17.1.m1.1.1.cmml" xref="algorithm1.17.17.1.m1.1.1">ℰ</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.1.m1.2c">(u^{j},\mathcal{E})</annotation></semantics></math></span> 
</div>
<div id="algorithm1.17.20" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span id="algorithm1.17.20.1" class="ltx_text"><span id="algorithm1.17.20.1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;color:#0000FF;">/* </span></span><span id="algorithm1.17.20.2" class="ltx_text ltx_font_typewriter" style="font-size:80%;color:#0000FF;">move on to parent */</span>
</div>
<div id="algorithm1.17.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.17.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.17.22.1" class="ltx_text ltx_font_bold">return</span>  
</div>
<div id="algorithm1.17.23" class="ltx_listingline">


</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.20.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span><span id="algorithm1.21.2" class="ltx_text ltx_font_smallcaps">Pelta</span> shielding</figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.7" class="ltx_p">Note that, given the summation in Eq. <a href="#S4.E1" title="Equation 1 ‣ 4.1. Back-Propagation Principles and Limits ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, obfuscating only some of the children jacobians <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\partial f_{1}^{1}/\partial x" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mo rspace="0em" id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">∂</mo><mrow id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml"><msubsup id="S4.SS2.p3.1.m1.1.1.2.2" xref="S4.SS2.p3.1.m1.1.1.2.2.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2.2.2.2" xref="S4.SS2.p3.1.m1.1.1.2.2.2.2.cmml">f</mi><mn id="S4.SS2.p3.1.m1.1.1.2.2.2.3" xref="S4.SS2.p3.1.m1.1.1.2.2.2.3.cmml">1</mn><mn id="S4.SS2.p3.1.m1.1.1.2.2.3" xref="S4.SS2.p3.1.m1.1.1.2.2.3.cmml">1</mn></msubsup><mo id="S4.SS2.p3.1.m1.1.1.2.1" xref="S4.SS2.p3.1.m1.1.1.2.1.cmml">/</mo><mrow id="S4.SS2.p3.1.m1.1.1.2.3" xref="S4.SS2.p3.1.m1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.1.1.2.3.1" xref="S4.SS2.p3.1.m1.1.1.2.3.1.cmml">∂</mo><mi id="S4.SS2.p3.1.m1.1.1.2.3.2" xref="S4.SS2.p3.1.m1.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><partialdiff id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></partialdiff><apply id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2"><divide id="S4.SS2.p3.1.m1.1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.1.2.1"></divide><apply id="S4.SS2.p3.1.m1.1.1.2.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.2.2.1.cmml" xref="S4.SS2.p3.1.m1.1.1.2.2">superscript</csymbol><apply id="S4.SS2.p3.1.m1.1.1.2.2.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.2.2.2.1.cmml" xref="S4.SS2.p3.1.m1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.2.2.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2.2.2.2">𝑓</ci><cn type="integer" id="S4.SS2.p3.1.m1.1.1.2.2.2.3.cmml" xref="S4.SS2.p3.1.m1.1.1.2.2.2.3">1</cn></apply><cn type="integer" id="S4.SS2.p3.1.m1.1.1.2.2.3.cmml" xref="S4.SS2.p3.1.m1.1.1.2.2.3">1</cn></apply><apply id="S4.SS2.p3.1.m1.1.1.2.3.cmml" xref="S4.SS2.p3.1.m1.1.1.2.3"><partialdiff id="S4.SS2.p3.1.m1.1.1.2.3.1.cmml" xref="S4.SS2.p3.1.m1.1.1.2.3.1"></partialdiff><ci id="S4.SS2.p3.1.m1.1.1.2.3.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2.3.2">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\partial f_{1}^{1}/\partial x</annotation></semantics></math>, <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\partial f_{2}^{1}/\partial x\makebox[8.00003pt][c]{.\hfil.\hfil.}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mo rspace="0em" id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">∂</mo><mrow id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml"><msubsup id="S4.SS2.p3.2.m2.1.1.2.2" xref="S4.SS2.p3.2.m2.1.1.2.2.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2.2.2.2" xref="S4.SS2.p3.2.m2.1.1.2.2.2.2.cmml">f</mi><mn id="S4.SS2.p3.2.m2.1.1.2.2.2.3" xref="S4.SS2.p3.2.m2.1.1.2.2.2.3.cmml">2</mn><mn id="S4.SS2.p3.2.m2.1.1.2.2.3" xref="S4.SS2.p3.2.m2.1.1.2.2.3.cmml">1</mn></msubsup><mo id="S4.SS2.p3.2.m2.1.1.2.1" xref="S4.SS2.p3.2.m2.1.1.2.1.cmml">/</mo><mrow id="S4.SS2.p3.2.m2.1.1.2.3" xref="S4.SS2.p3.2.m2.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p3.2.m2.1.1.2.3.1" xref="S4.SS2.p3.2.m2.1.1.2.3.1.cmml">∂</mo><mrow id="S4.SS2.p3.2.m2.1.1.2.3.2" xref="S4.SS2.p3.2.m2.1.1.2.3.2.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2.3.2.2" xref="S4.SS2.p3.2.m2.1.1.2.3.2.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.2.m2.1.1.2.3.2.1" xref="S4.SS2.p3.2.m2.1.1.2.3.2.1.cmml">​</mo><mpadded width="8.0pt" id="S4.SS2.p3.2.m2.1.1.2.3.2.3" xref="S4.SS2.p3.2.m2.1.1.2.3.2.3b.cmml"><mtext id="S4.SS2.p3.2.m2.1.1.2.3.2.3a" xref="S4.SS2.p3.2.m2.1.1.2.3.2.3b.cmml">. . .</mtext></mpadded></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><partialdiff id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></partialdiff><apply id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2"><divide id="S4.SS2.p3.2.m2.1.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.1.2.1"></divide><apply id="S4.SS2.p3.2.m2.1.1.2.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.2.2.1.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2">superscript</csymbol><apply id="S4.SS2.p3.2.m2.1.1.2.2.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.2.2.2.1.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.2.2.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2.2.2">𝑓</ci><cn type="integer" id="S4.SS2.p3.2.m2.1.1.2.2.2.3.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2.2.3">2</cn></apply><cn type="integer" id="S4.SS2.p3.2.m2.1.1.2.2.3.cmml" xref="S4.SS2.p3.2.m2.1.1.2.2.3">1</cn></apply><apply id="S4.SS2.p3.2.m2.1.1.2.3.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3"><partialdiff id="S4.SS2.p3.2.m2.1.1.2.3.1.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3.1"></partialdiff><apply id="S4.SS2.p3.2.m2.1.1.2.3.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3.2"><times id="S4.SS2.p3.2.m2.1.1.2.3.2.1.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3.2.1"></times><ci id="S4.SS2.p3.2.m2.1.1.2.3.2.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3.2.2">𝑥</ci><ci id="S4.SS2.p3.2.m2.1.1.2.3.2.3b.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3.2.3"><mpadded width="8.0pt" id="S4.SS2.p3.2.m2.1.1.2.3.2.3.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3.2.3"><mtext id="S4.SS2.p3.2.m2.1.1.2.3.2.3a.cmml" xref="S4.SS2.p3.2.m2.1.1.2.3.2.3">. . .</mtext></mpadded></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\partial f_{2}^{1}/\partial x\makebox[8.00003pt][c]{.\hfil.\hfil.}</annotation></semantics></math> would already constitute an alteration of <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\nabla_{x}\mathcal{L}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><msub id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml"><mo id="S4.SS2.p3.3.m3.1.1.1.2" xref="S4.SS2.p3.3.m3.1.1.1.2.cmml">∇</mo><mi id="S4.SS2.p3.3.m3.1.1.1.3" xref="S4.SS2.p3.3.m3.1.1.1.3.cmml">x</mi></msub><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><apply id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.1.2">∇</ci><ci id="S4.SS2.p3.3.m3.1.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.1.3">𝑥</ci></apply><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\nabla_{x}\mathcal{L}</annotation></semantics></math>.
We however chose that <span id="S4.SS2.p3.7.1" class="ltx_text ltx_font_smallcaps">Pelta</span> masks all the partial factors of this summation to not take any chances.
This obfuscation implies that intermediate gradients should be masked as well. Indeed, because they lead to <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="\partial f_{j}^{1}/\partial{x}" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mo rspace="0em" id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">∂</mo><mrow id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml"><msubsup id="S4.SS2.p3.4.m4.1.1.2.2" xref="S4.SS2.p3.4.m4.1.1.2.2.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2.2.2.2" xref="S4.SS2.p3.4.m4.1.1.2.2.2.2.cmml">f</mi><mi id="S4.SS2.p3.4.m4.1.1.2.2.2.3" xref="S4.SS2.p3.4.m4.1.1.2.2.2.3.cmml">j</mi><mn id="S4.SS2.p3.4.m4.1.1.2.2.3" xref="S4.SS2.p3.4.m4.1.1.2.2.3.cmml">1</mn></msubsup><mo id="S4.SS2.p3.4.m4.1.1.2.1" xref="S4.SS2.p3.4.m4.1.1.2.1.cmml">/</mo><mrow id="S4.SS2.p3.4.m4.1.1.2.3" xref="S4.SS2.p3.4.m4.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p3.4.m4.1.1.2.3.1" xref="S4.SS2.p3.4.m4.1.1.2.3.1.cmml">∂</mo><mi id="S4.SS2.p3.4.m4.1.1.2.3.2" xref="S4.SS2.p3.4.m4.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><partialdiff id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"></partialdiff><apply id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2"><divide id="S4.SS2.p3.4.m4.1.1.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.1"></divide><apply id="S4.SS2.p3.4.m4.1.1.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2">superscript</csymbol><apply id="S4.SS2.p3.4.m4.1.1.2.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.2.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.2.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2.2.2">𝑓</ci><ci id="S4.SS2.p3.4.m4.1.1.2.2.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2.2.3">𝑗</ci></apply><cn type="integer" id="S4.SS2.p3.4.m4.1.1.2.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2.3">1</cn></apply><apply id="S4.SS2.p3.4.m4.1.1.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3"><partialdiff id="S4.SS2.p3.4.m4.1.1.2.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.1"></partialdiff><ci id="S4.SS2.p3.4.m4.1.1.2.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3.2">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\partial f_{j}^{1}/\partial{x}</annotation></semantics></math> through the chain rule, the intermediate gradients (or <span id="S4.SS2.p3.7.2" class="ltx_text ltx_font_italic">local jacobian</span>) <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="J^{0\rightarrow 1}=\partial f^{1}\left(\alpha^{1}\right)/\partial u^{0}" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><mrow id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><msup id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml"><mi id="S4.SS2.p3.5.m5.1.1.3.2" xref="S4.SS2.p3.5.m5.1.1.3.2.cmml">J</mi><mrow id="S4.SS2.p3.5.m5.1.1.3.3" xref="S4.SS2.p3.5.m5.1.1.3.3.cmml"><mn id="S4.SS2.p3.5.m5.1.1.3.3.2" xref="S4.SS2.p3.5.m5.1.1.3.3.2.cmml">0</mn><mo stretchy="false" id="S4.SS2.p3.5.m5.1.1.3.3.1" xref="S4.SS2.p3.5.m5.1.1.3.3.1.cmml">→</mo><mn id="S4.SS2.p3.5.m5.1.1.3.3.3" xref="S4.SS2.p3.5.m5.1.1.3.3.3.cmml">1</mn></mrow></msup><mo rspace="0.1389em" id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">=</mo><mrow id="S4.SS2.p3.5.m5.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.cmml"><mo lspace="0.1389em" rspace="0em" id="S4.SS2.p3.5.m5.1.1.1.2" xref="S4.SS2.p3.5.m5.1.1.1.2.cmml">∂</mo><mrow id="S4.SS2.p3.5.m5.1.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.1.cmml"><mrow id="S4.SS2.p3.5.m5.1.1.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.1.1.cmml"><msup id="S4.SS2.p3.5.m5.1.1.1.1.1.3" xref="S4.SS2.p3.5.m5.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p3.5.m5.1.1.1.1.1.3.2" xref="S4.SS2.p3.5.m5.1.1.1.1.1.3.2.cmml">f</mi><mn id="S4.SS2.p3.5.m5.1.1.1.1.1.3.3" xref="S4.SS2.p3.5.m5.1.1.1.1.1.3.3.cmml">1</mn></msup><mo lspace="0em" rspace="0em" id="S4.SS2.p3.5.m5.1.1.1.1.1.2" xref="S4.SS2.p3.5.m5.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.2" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.2.cmml">α</mi><mn id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.3" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p3.5.m5.1.1.1.1.2" xref="S4.SS2.p3.5.m5.1.1.1.1.2.cmml">/</mo><mrow id="S4.SS2.p3.5.m5.1.1.1.1.3" xref="S4.SS2.p3.5.m5.1.1.1.1.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p3.5.m5.1.1.1.1.3.1" xref="S4.SS2.p3.5.m5.1.1.1.1.3.1.cmml">∂</mo><msup id="S4.SS2.p3.5.m5.1.1.1.1.3.2" xref="S4.SS2.p3.5.m5.1.1.1.1.3.2.cmml"><mi id="S4.SS2.p3.5.m5.1.1.1.1.3.2.2" xref="S4.SS2.p3.5.m5.1.1.1.1.3.2.2.cmml">u</mi><mn id="S4.SS2.p3.5.m5.1.1.1.1.3.2.3" xref="S4.SS2.p3.5.m5.1.1.1.1.3.2.3.cmml">0</mn></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><eq id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2"></eq><apply id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.3.2">𝐽</ci><apply id="S4.SS2.p3.5.m5.1.1.3.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3"><ci id="S4.SS2.p3.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3.1">→</ci><cn type="integer" id="S4.SS2.p3.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3.2">0</cn><cn type="integer" id="S4.SS2.p3.5.m5.1.1.3.3.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3.3">1</cn></apply></apply><apply id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1"><partialdiff id="S4.SS2.p3.5.m5.1.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.2"></partialdiff><apply id="S4.SS2.p3.5.m5.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1"><divide id="S4.SS2.p3.5.m5.1.1.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.2"></divide><apply id="S4.SS2.p3.5.m5.1.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1"><times id="S4.SS2.p3.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.2"></times><apply id="S4.SS2.p3.5.m5.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.3.2">𝑓</ci><cn type="integer" id="S4.SS2.p3.5.m5.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.3.3">1</cn></apply><apply id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.2">𝛼</ci><cn type="integer" id="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.SS2.p3.5.m5.1.1.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.3"><partialdiff id="S4.SS2.p3.5.m5.1.1.1.1.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.3.1"></partialdiff><apply id="S4.SS2.p3.5.m5.1.1.1.1.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.1.3.2.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.3.2">superscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.1.1.3.2.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.3.2.2">𝑢</ci><cn type="integer" id="S4.SS2.p3.5.m5.1.1.1.1.3.2.3.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1.3.2.3">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">J^{0\rightarrow 1}=\partial f^{1}\left(\alpha^{1}\right)/\partial u^{0}</annotation></semantics></math> between the input <math id="S4.SS2.p3.6.m6.1" class="ltx_Math" alttext="x=u^{0}" display="inline"><semantics id="S4.SS2.p3.6.m6.1a"><mrow id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml"><mi id="S4.SS2.p3.6.m6.1.1.2" xref="S4.SS2.p3.6.m6.1.1.2.cmml">x</mi><mo id="S4.SS2.p3.6.m6.1.1.1" xref="S4.SS2.p3.6.m6.1.1.1.cmml">=</mo><msup id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml"><mi id="S4.SS2.p3.6.m6.1.1.3.2" xref="S4.SS2.p3.6.m6.1.1.3.2.cmml">u</mi><mn id="S4.SS2.p3.6.m6.1.1.3.3" xref="S4.SS2.p3.6.m6.1.1.3.3.cmml">0</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><apply id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1"><eq id="S4.SS2.p3.6.m6.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1"></eq><ci id="S4.SS2.p3.6.m6.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2">𝑥</ci><apply id="S4.SS2.p3.6.m6.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.1.1.3.1.cmml" xref="S4.SS2.p3.6.m6.1.1.3">superscript</csymbol><ci id="S4.SS2.p3.6.m6.1.1.3.2.cmml" xref="S4.SS2.p3.6.m6.1.1.3.2">𝑢</ci><cn type="integer" id="S4.SS2.p3.6.m6.1.1.3.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">x=u^{0}</annotation></semantics></math> of the ML model and its first transformation must be masked (Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-line <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Because one layer may carry several
transforms on its local input (<span id="S4.SS2.p3.7.3" class="ltx_ERROR undefined">\eg</span>linear then <math id="S4.SS2.p3.7.m7.1" class="ltx_Math" alttext="\operatorname{ReLU}" display="inline"><semantics id="S4.SS2.p3.7.m7.1a"><mi id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">ReLU</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><ci id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">ReLU</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">\operatorname{ReLU}</annotation></semantics></math>), local jacobians should be masked for at least as many subsequent generations of children nodes as the numbers of layers to shield.
The number of generations is directly determined at the arbitrary selection step (Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-line <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) where the defender choses how far the model should be shielded, <span id="S4.SS2.p3.7.4" class="ltx_ERROR undefined">\ie</span>, the rightmost masked nodes.
In practice, selecting the first couple of nodes likely induces enough alteration to mitigate the attack and prevent immediate reconstruction of the hidden parameters through either direct calculus (input-output comparison) or inference through repeated queries <cite class="ltx_cite ltx_citemacro_citep">(Oh et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2019</a>)</cite>.
From this right-hand side frontier, the defender may recursively mask the parent jacobians  (Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-line <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.13" class="ltx_p">In adversarial attacks, the malicious user keeps the model intact and treats only the input <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="x_{adv}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">x</mi><mrow id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml"><mi id="S4.SS2.p4.1.m1.1.1.3.2" xref="S4.SS2.p4.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.1.m1.1.1.3.1" xref="S4.SS2.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p4.1.m1.1.1.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.1.m1.1.1.3.1a" xref="S4.SS2.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p4.1.m1.1.1.3.4" xref="S4.SS2.p4.1.m1.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝑥</ci><apply id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><times id="S4.SS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3.1"></times><ci id="S4.SS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2">𝑎</ci><ci id="S4.SS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3">𝑑</ci><ci id="S4.SS2.p4.1.m1.1.1.3.4.cmml" xref="S4.SS2.p4.1.m1.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">x_{adv}</annotation></semantics></math> as a trainable parameter to maximize the prediction error of the sample.
We note that the local jacobians (Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-line <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) between a child node and their non-input parents need not be hidden because the parents are not trainable (they should be input of the model to meet the condition at Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-line <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Such quantities are, in effect, simply not present in the back-propagation graph and could not constitute a leak of the sensitive gradient.
Similarly, notice how <span id="S4.SS2.p4.13.1" class="ltx_text ltx_font_smallcaps">Select</span> supposes the rightmost masked nodes be chosen <em id="S4.SS2.p4.13.2" class="ltx_emph ltx_font_italic">s.t.</em> they come <span id="S4.SS2.p4.13.3" class="ltx_text ltx_font_italic">after</span> every input leaf nodes (<span id="S4.SS2.p4.13.4" class="ltx_ERROR undefined">\ie</span>, from subsequent generations). This condition: <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="u^{i}\in S\Rightarrow i&gt;l" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><msup id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2.2" xref="S4.SS2.p4.2.m2.1.1.2.2.cmml">u</mi><mi id="S4.SS2.p4.2.m2.1.1.2.3" xref="S4.SS2.p4.2.m2.1.1.2.3.cmml">i</mi></msup><mo id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">∈</mo><mi id="S4.SS2.p4.2.m2.1.1.4" xref="S4.SS2.p4.2.m2.1.1.4.cmml">S</mi><mo stretchy="false" id="S4.SS2.p4.2.m2.1.1.5" xref="S4.SS2.p4.2.m2.1.1.5.cmml">⇒</mo><mi id="S4.SS2.p4.2.m2.1.1.6" xref="S4.SS2.p4.2.m2.1.1.6.cmml">i</mi><mo id="S4.SS2.p4.2.m2.1.1.7" xref="S4.SS2.p4.2.m2.1.1.7.cmml">&gt;</mo><mi id="S4.SS2.p4.2.m2.1.1.8" xref="S4.SS2.p4.2.m2.1.1.8.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><and id="S4.SS2.p4.2.m2.1.1a.cmml" xref="S4.SS2.p4.2.m2.1.1"></and><apply id="S4.SS2.p4.2.m2.1.1b.cmml" xref="S4.SS2.p4.2.m2.1.1"><in id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3"></in><apply id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.2.1.cmml" xref="S4.SS2.p4.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.2.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2.2">𝑢</ci><ci id="S4.SS2.p4.2.m2.1.1.2.3.cmml" xref="S4.SS2.p4.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p4.2.m2.1.1.4.cmml" xref="S4.SS2.p4.2.m2.1.1.4">𝑆</ci></apply><apply id="S4.SS2.p4.2.m2.1.1c.cmml" xref="S4.SS2.p4.2.m2.1.1"><ci id="S4.SS2.p4.2.m2.1.1.5.cmml" xref="S4.SS2.p4.2.m2.1.1.5">⇒</ci><share href="#S4.SS2.p4.2.m2.1.1.4.cmml" id="S4.SS2.p4.2.m2.1.1d.cmml" xref="S4.SS2.p4.2.m2.1.1"></share><ci id="S4.SS2.p4.2.m2.1.1.6.cmml" xref="S4.SS2.p4.2.m2.1.1.6">𝑖</ci></apply><apply id="S4.SS2.p4.2.m2.1.1e.cmml" xref="S4.SS2.p4.2.m2.1.1"><gt id="S4.SS2.p4.2.m2.1.1.7.cmml" xref="S4.SS2.p4.2.m2.1.1.7"></gt><share href="#S4.SS2.p4.2.m2.1.1.6.cmml" id="S4.SS2.p4.2.m2.1.1f.cmml" xref="S4.SS2.p4.2.m2.1.1"></share><ci id="S4.SS2.p4.2.m2.1.1.8.cmml" xref="S4.SS2.p4.2.m2.1.1.8">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">u^{i}\in S\Rightarrow i&gt;l</annotation></semantics></math>, insures no information leaks towards trainable input leaf nodes.
After all sensitive partials are masked by Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, such a set of obfuscated gradients is a subset of the total forward partials that would lead to a complete chain rule and is noted <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="\left\{\partial f/\partial{x}\right\}^{L}" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><msup id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mrow id="S4.SS2.p4.3.m3.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.2.cmml"><mo id="S4.SS2.p4.3.m3.1.1.1.1.2" xref="S4.SS2.p4.3.m3.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p4.3.m3.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p4.3.m3.1.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.cmml">∂</mo><mrow id="S4.SS2.p4.3.m3.1.1.1.1.1.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p4.3.m3.1.1.1.1.1.2.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.2.cmml">f</mi><mo id="S4.SS2.p4.3.m3.1.1.1.1.1.2.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.1.cmml">/</mo><mrow id="S4.SS2.p4.3.m3.1.1.1.1.1.2.3" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.1.cmml">∂</mo><mi id="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><mo id="S4.SS2.p4.3.m3.1.1.1.1.3" xref="S4.SS2.p4.3.m3.1.1.1.2.cmml">}</mo></mrow><mi id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1">superscript</csymbol><set id="S4.SS2.p4.3.m3.1.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1"><apply id="S4.SS2.p4.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1"><partialdiff id="S4.SS2.p4.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1"></partialdiff><apply id="S4.SS2.p4.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2"><divide id="S4.SS2.p4.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.1"></divide><ci id="S4.SS2.p4.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.2">𝑓</ci><apply id="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.3"><partialdiff id="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.1"></partialdiff><ci id="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.2.3.2">𝑥</ci></apply></apply></apply></set><ci id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\left\{\partial f/\partial{x}\right\}^{L}</annotation></semantics></math> assuming <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="L\leq n" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">L</mi><mo id="S4.SS2.p4.4.m4.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.cmml">≤</mo><mi id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><leq id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1"></leq><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">𝐿</ci><ci id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">L\leq n</annotation></semantics></math> is the rightmost vertex that denies the attacker information to complete the chain rule.
Since all the forward partials up until <math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><mi id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><ci id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">L</annotation></semantics></math> are masked, then <math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="\partial f^{L}/\partial{x}" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mrow id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml"><mo rspace="0em" id="S4.SS2.p4.6.m6.1.1.1" xref="S4.SS2.p4.6.m6.1.1.1.cmml">∂</mo><mrow id="S4.SS2.p4.6.m6.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2.cmml"><msup id="S4.SS2.p4.6.m6.1.1.2.2" xref="S4.SS2.p4.6.m6.1.1.2.2.cmml"><mi id="S4.SS2.p4.6.m6.1.1.2.2.2" xref="S4.SS2.p4.6.m6.1.1.2.2.2.cmml">f</mi><mi id="S4.SS2.p4.6.m6.1.1.2.2.3" xref="S4.SS2.p4.6.m6.1.1.2.2.3.cmml">L</mi></msup><mo id="S4.SS2.p4.6.m6.1.1.2.1" xref="S4.SS2.p4.6.m6.1.1.2.1.cmml">/</mo><mrow id="S4.SS2.p4.6.m6.1.1.2.3" xref="S4.SS2.p4.6.m6.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p4.6.m6.1.1.2.3.1" xref="S4.SS2.p4.6.m6.1.1.2.3.1.cmml">∂</mo><mi id="S4.SS2.p4.6.m6.1.1.2.3.2" xref="S4.SS2.p4.6.m6.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><apply id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1"><partialdiff id="S4.SS2.p4.6.m6.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1"></partialdiff><apply id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2"><divide id="S4.SS2.p4.6.m6.1.1.2.1.cmml" xref="S4.SS2.p4.6.m6.1.1.2.1"></divide><apply id="S4.SS2.p4.6.m6.1.1.2.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.1.1.2.2.1.cmml" xref="S4.SS2.p4.6.m6.1.1.2.2">superscript</csymbol><ci id="S4.SS2.p4.6.m6.1.1.2.2.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2.2.2">𝑓</ci><ci id="S4.SS2.p4.6.m6.1.1.2.2.3.cmml" xref="S4.SS2.p4.6.m6.1.1.2.2.3">𝐿</ci></apply><apply id="S4.SS2.p4.6.m6.1.1.2.3.cmml" xref="S4.SS2.p4.6.m6.1.1.2.3"><partialdiff id="S4.SS2.p4.6.m6.1.1.2.3.1.cmml" xref="S4.SS2.p4.6.m6.1.1.2.3.1"></partialdiff><ci id="S4.SS2.p4.6.m6.1.1.2.3.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2.3.2">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">\partial f^{L}/\partial{x}</annotation></semantics></math> is protected and the resulting under-factored gradient vector (<span id="S4.SS2.p4.13.5" class="ltx_ERROR undefined">\ie</span>the <span id="S4.SS2.p4.13.6" class="ltx_text ltx_font_italic">adjoint</span> of <math id="S4.SS2.p4.7.m7.1" class="ltx_Math" alttext="f^{L+1}" display="inline"><semantics id="S4.SS2.p4.7.m7.1a"><msup id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml"><mi id="S4.SS2.p4.7.m7.1.1.2" xref="S4.SS2.p4.7.m7.1.1.2.cmml">f</mi><mrow id="S4.SS2.p4.7.m7.1.1.3" xref="S4.SS2.p4.7.m7.1.1.3.cmml"><mi id="S4.SS2.p4.7.m7.1.1.3.2" xref="S4.SS2.p4.7.m7.1.1.3.2.cmml">L</mi><mo id="S4.SS2.p4.7.m7.1.1.3.1" xref="S4.SS2.p4.7.m7.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p4.7.m7.1.1.3.3" xref="S4.SS2.p4.7.m7.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><apply id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">superscript</csymbol><ci id="S4.SS2.p4.7.m7.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1.2">𝑓</ci><apply id="S4.SS2.p4.7.m7.1.1.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3"><plus id="S4.SS2.p4.7.m7.1.1.3.1.cmml" xref="S4.SS2.p4.7.m7.1.1.3.1"></plus><ci id="S4.SS2.p4.7.m7.1.1.3.2.cmml" xref="S4.SS2.p4.7.m7.1.1.3.2">𝐿</ci><cn type="integer" id="S4.SS2.p4.7.m7.1.1.3.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">f^{L+1}</annotation></semantics></math>) is a vector in the shape of the leftmost clear layer <math id="S4.SS2.p4.8.m8.1" class="ltx_Math" alttext="f^{L+1}" display="inline"><semantics id="S4.SS2.p4.8.m8.1a"><msup id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml"><mi id="S4.SS2.p4.8.m8.1.1.2" xref="S4.SS2.p4.8.m8.1.1.2.cmml">f</mi><mrow id="S4.SS2.p4.8.m8.1.1.3" xref="S4.SS2.p4.8.m8.1.1.3.cmml"><mi id="S4.SS2.p4.8.m8.1.1.3.2" xref="S4.SS2.p4.8.m8.1.1.3.2.cmml">L</mi><mo id="S4.SS2.p4.8.m8.1.1.3.1" xref="S4.SS2.p4.8.m8.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p4.8.m8.1.1.3.3" xref="S4.SS2.p4.8.m8.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b"><apply id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1">superscript</csymbol><ci id="S4.SS2.p4.8.m8.1.1.2.cmml" xref="S4.SS2.p4.8.m8.1.1.2">𝑓</ci><apply id="S4.SS2.p4.8.m8.1.1.3.cmml" xref="S4.SS2.p4.8.m8.1.1.3"><plus id="S4.SS2.p4.8.m8.1.1.3.1.cmml" xref="S4.SS2.p4.8.m8.1.1.3.1"></plus><ci id="S4.SS2.p4.8.m8.1.1.3.2.cmml" xref="S4.SS2.p4.8.m8.1.1.3.2">𝐿</ci><cn type="integer" id="S4.SS2.p4.8.m8.1.1.3.3.cmml" xref="S4.SS2.p4.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">f^{L+1}</annotation></semantics></math> and noted <math id="S4.SS2.p4.9.m9.1" class="ltx_Math" alttext="\delta_{L+1}=d\mathcal{L}/d{u^{L+1}}" display="inline"><semantics id="S4.SS2.p4.9.m9.1a"><mrow id="S4.SS2.p4.9.m9.1.1" xref="S4.SS2.p4.9.m9.1.1.cmml"><msub id="S4.SS2.p4.9.m9.1.1.2" xref="S4.SS2.p4.9.m9.1.1.2.cmml"><mi id="S4.SS2.p4.9.m9.1.1.2.2" xref="S4.SS2.p4.9.m9.1.1.2.2.cmml">δ</mi><mrow id="S4.SS2.p4.9.m9.1.1.2.3" xref="S4.SS2.p4.9.m9.1.1.2.3.cmml"><mi id="S4.SS2.p4.9.m9.1.1.2.3.2" xref="S4.SS2.p4.9.m9.1.1.2.3.2.cmml">L</mi><mo id="S4.SS2.p4.9.m9.1.1.2.3.1" xref="S4.SS2.p4.9.m9.1.1.2.3.1.cmml">+</mo><mn id="S4.SS2.p4.9.m9.1.1.2.3.3" xref="S4.SS2.p4.9.m9.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS2.p4.9.m9.1.1.1" xref="S4.SS2.p4.9.m9.1.1.1.cmml">=</mo><mrow id="S4.SS2.p4.9.m9.1.1.3" xref="S4.SS2.p4.9.m9.1.1.3.cmml"><mrow id="S4.SS2.p4.9.m9.1.1.3.2" xref="S4.SS2.p4.9.m9.1.1.3.2.cmml"><mrow id="S4.SS2.p4.9.m9.1.1.3.2.2" xref="S4.SS2.p4.9.m9.1.1.3.2.2.cmml"><mi id="S4.SS2.p4.9.m9.1.1.3.2.2.2" xref="S4.SS2.p4.9.m9.1.1.3.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.9.m9.1.1.3.2.2.1" xref="S4.SS2.p4.9.m9.1.1.3.2.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.9.m9.1.1.3.2.2.3" xref="S4.SS2.p4.9.m9.1.1.3.2.2.3.cmml">ℒ</mi></mrow><mo id="S4.SS2.p4.9.m9.1.1.3.2.1" xref="S4.SS2.p4.9.m9.1.1.3.2.1.cmml">/</mo><mi id="S4.SS2.p4.9.m9.1.1.3.2.3" xref="S4.SS2.p4.9.m9.1.1.3.2.3.cmml">d</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p4.9.m9.1.1.3.1" xref="S4.SS2.p4.9.m9.1.1.3.1.cmml">​</mo><msup id="S4.SS2.p4.9.m9.1.1.3.3" xref="S4.SS2.p4.9.m9.1.1.3.3.cmml"><mi id="S4.SS2.p4.9.m9.1.1.3.3.2" xref="S4.SS2.p4.9.m9.1.1.3.3.2.cmml">u</mi><mrow id="S4.SS2.p4.9.m9.1.1.3.3.3" xref="S4.SS2.p4.9.m9.1.1.3.3.3.cmml"><mi id="S4.SS2.p4.9.m9.1.1.3.3.3.2" xref="S4.SS2.p4.9.m9.1.1.3.3.3.2.cmml">L</mi><mo id="S4.SS2.p4.9.m9.1.1.3.3.3.1" xref="S4.SS2.p4.9.m9.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS2.p4.9.m9.1.1.3.3.3.3" xref="S4.SS2.p4.9.m9.1.1.3.3.3.3.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m9.1b"><apply id="S4.SS2.p4.9.m9.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1"><eq id="S4.SS2.p4.9.m9.1.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1.1"></eq><apply id="S4.SS2.p4.9.m9.1.1.2.cmml" xref="S4.SS2.p4.9.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.9.m9.1.1.2.1.cmml" xref="S4.SS2.p4.9.m9.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.9.m9.1.1.2.2.cmml" xref="S4.SS2.p4.9.m9.1.1.2.2">𝛿</ci><apply id="S4.SS2.p4.9.m9.1.1.2.3.cmml" xref="S4.SS2.p4.9.m9.1.1.2.3"><plus id="S4.SS2.p4.9.m9.1.1.2.3.1.cmml" xref="S4.SS2.p4.9.m9.1.1.2.3.1"></plus><ci id="S4.SS2.p4.9.m9.1.1.2.3.2.cmml" xref="S4.SS2.p4.9.m9.1.1.2.3.2">𝐿</ci><cn type="integer" id="S4.SS2.p4.9.m9.1.1.2.3.3.cmml" xref="S4.SS2.p4.9.m9.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p4.9.m9.1.1.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3"><times id="S4.SS2.p4.9.m9.1.1.3.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3.1"></times><apply id="S4.SS2.p4.9.m9.1.1.3.2.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2"><divide id="S4.SS2.p4.9.m9.1.1.3.2.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.1"></divide><apply id="S4.SS2.p4.9.m9.1.1.3.2.2.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.2"><times id="S4.SS2.p4.9.m9.1.1.3.2.2.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.2.1"></times><ci id="S4.SS2.p4.9.m9.1.1.3.2.2.2.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.2.2">𝑑</ci><ci id="S4.SS2.p4.9.m9.1.1.3.2.2.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.2.3">ℒ</ci></apply><ci id="S4.SS2.p4.9.m9.1.1.3.2.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.3">𝑑</ci></apply><apply id="S4.SS2.p4.9.m9.1.1.3.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p4.9.m9.1.1.3.3.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3">superscript</csymbol><ci id="S4.SS2.p4.9.m9.1.1.3.3.2.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3.2">𝑢</ci><apply id="S4.SS2.p4.9.m9.1.1.3.3.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3.3"><plus id="S4.SS2.p4.9.m9.1.1.3.3.3.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3.3.1"></plus><ci id="S4.SS2.p4.9.m9.1.1.3.3.3.2.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3.3.2">𝐿</ci><cn type="integer" id="S4.SS2.p4.9.m9.1.1.3.3.3.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m9.1c">\delta_{L+1}=d\mathcal{L}/d{u^{L+1}}</annotation></semantics></math>.
A white-box setting assumes an attacker has knowledge of both the subset <math id="S4.SS2.p4.10.m10.1" class="ltx_Math" alttext="\left\{\partial f/\partial{x}\right\}^{L}" display="inline"><semantics id="S4.SS2.p4.10.m10.1a"><msup id="S4.SS2.p4.10.m10.1.1" xref="S4.SS2.p4.10.m10.1.1.cmml"><mrow id="S4.SS2.p4.10.m10.1.1.1.1" xref="S4.SS2.p4.10.m10.1.1.1.2.cmml"><mo id="S4.SS2.p4.10.m10.1.1.1.1.2" xref="S4.SS2.p4.10.m10.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p4.10.m10.1.1.1.1.1" xref="S4.SS2.p4.10.m10.1.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p4.10.m10.1.1.1.1.1.1" xref="S4.SS2.p4.10.m10.1.1.1.1.1.1.cmml">∂</mo><mrow id="S4.SS2.p4.10.m10.1.1.1.1.1.2" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p4.10.m10.1.1.1.1.1.2.2" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.2.cmml">f</mi><mo id="S4.SS2.p4.10.m10.1.1.1.1.1.2.1" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.1.cmml">/</mo><mrow id="S4.SS2.p4.10.m10.1.1.1.1.1.2.3" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.1" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.1.cmml">∂</mo><mi id="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.2" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><mo id="S4.SS2.p4.10.m10.1.1.1.1.3" xref="S4.SS2.p4.10.m10.1.1.1.2.cmml">}</mo></mrow><mi id="S4.SS2.p4.10.m10.1.1.3" xref="S4.SS2.p4.10.m10.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m10.1b"><apply id="S4.SS2.p4.10.m10.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.10.m10.1.1.2.cmml" xref="S4.SS2.p4.10.m10.1.1">superscript</csymbol><set id="S4.SS2.p4.10.m10.1.1.1.2.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1"><apply id="S4.SS2.p4.10.m10.1.1.1.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1.1"><partialdiff id="S4.SS2.p4.10.m10.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1.1.1"></partialdiff><apply id="S4.SS2.p4.10.m10.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2"><divide id="S4.SS2.p4.10.m10.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.1"></divide><ci id="S4.SS2.p4.10.m10.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.2">𝑓</ci><apply id="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.3"><partialdiff id="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.1"></partialdiff><ci id="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p4.10.m10.1.1.1.1.1.2.3.2">𝑥</ci></apply></apply></apply></set><ci id="S4.SS2.p4.10.m10.1.1.3.cmml" xref="S4.SS2.p4.10.m10.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.10.m10.1c">\left\{\partial f/\partial{x}\right\}^{L}</annotation></semantics></math> of all forward partials and <math id="S4.SS2.p4.11.m11.1" class="ltx_Math" alttext="\delta_{L+1}" display="inline"><semantics id="S4.SS2.p4.11.m11.1a"><msub id="S4.SS2.p4.11.m11.1.1" xref="S4.SS2.p4.11.m11.1.1.cmml"><mi id="S4.SS2.p4.11.m11.1.1.2" xref="S4.SS2.p4.11.m11.1.1.2.cmml">δ</mi><mrow id="S4.SS2.p4.11.m11.1.1.3" xref="S4.SS2.p4.11.m11.1.1.3.cmml"><mi id="S4.SS2.p4.11.m11.1.1.3.2" xref="S4.SS2.p4.11.m11.1.1.3.2.cmml">L</mi><mo id="S4.SS2.p4.11.m11.1.1.3.1" xref="S4.SS2.p4.11.m11.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p4.11.m11.1.1.3.3" xref="S4.SS2.p4.11.m11.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.11.m11.1b"><apply id="S4.SS2.p4.11.m11.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m11.1.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1">subscript</csymbol><ci id="S4.SS2.p4.11.m11.1.1.2.cmml" xref="S4.SS2.p4.11.m11.1.1.2">𝛿</ci><apply id="S4.SS2.p4.11.m11.1.1.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3"><plus id="S4.SS2.p4.11.m11.1.1.3.1.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1"></plus><ci id="S4.SS2.p4.11.m11.1.1.3.2.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2">𝐿</ci><cn type="integer" id="S4.SS2.p4.11.m11.1.1.3.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.11.m11.1c">\delta_{L+1}</annotation></semantics></math> to perform a regular gradient-based update on his <math id="S4.SS2.p4.12.m12.1" class="ltx_Math" alttext="x_{adv}" display="inline"><semantics id="S4.SS2.p4.12.m12.1a"><msub id="S4.SS2.p4.12.m12.1.1" xref="S4.SS2.p4.12.m12.1.1.cmml"><mi id="S4.SS2.p4.12.m12.1.1.2" xref="S4.SS2.p4.12.m12.1.1.2.cmml">x</mi><mrow id="S4.SS2.p4.12.m12.1.1.3" xref="S4.SS2.p4.12.m12.1.1.3.cmml"><mi id="S4.SS2.p4.12.m12.1.1.3.2" xref="S4.SS2.p4.12.m12.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.12.m12.1.1.3.1" xref="S4.SS2.p4.12.m12.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p4.12.m12.1.1.3.3" xref="S4.SS2.p4.12.m12.1.1.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.12.m12.1.1.3.1a" xref="S4.SS2.p4.12.m12.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p4.12.m12.1.1.3.4" xref="S4.SS2.p4.12.m12.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.12.m12.1b"><apply id="S4.SS2.p4.12.m12.1.1.cmml" xref="S4.SS2.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.12.m12.1.1.1.cmml" xref="S4.SS2.p4.12.m12.1.1">subscript</csymbol><ci id="S4.SS2.p4.12.m12.1.1.2.cmml" xref="S4.SS2.p4.12.m12.1.1.2">𝑥</ci><apply id="S4.SS2.p4.12.m12.1.1.3.cmml" xref="S4.SS2.p4.12.m12.1.1.3"><times id="S4.SS2.p4.12.m12.1.1.3.1.cmml" xref="S4.SS2.p4.12.m12.1.1.3.1"></times><ci id="S4.SS2.p4.12.m12.1.1.3.2.cmml" xref="S4.SS2.p4.12.m12.1.1.3.2">𝑎</ci><ci id="S4.SS2.p4.12.m12.1.1.3.3.cmml" xref="S4.SS2.p4.12.m12.1.1.3.3">𝑑</ci><ci id="S4.SS2.p4.12.m12.1.1.3.4.cmml" xref="S4.SS2.p4.12.m12.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.12.m12.1c">x_{adv}</annotation></semantics></math>.
However in <span id="S4.SS2.p4.13.7" class="ltx_text ltx_font_smallcaps">Pelta</span>, the attacker is only left with the adjoint <math id="S4.SS2.p4.13.m13.1" class="ltx_Math" alttext="\delta_{L+1}" display="inline"><semantics id="S4.SS2.p4.13.m13.1a"><msub id="S4.SS2.p4.13.m13.1.1" xref="S4.SS2.p4.13.m13.1.1.cmml"><mi id="S4.SS2.p4.13.m13.1.1.2" xref="S4.SS2.p4.13.m13.1.1.2.cmml">δ</mi><mrow id="S4.SS2.p4.13.m13.1.1.3" xref="S4.SS2.p4.13.m13.1.1.3.cmml"><mi id="S4.SS2.p4.13.m13.1.1.3.2" xref="S4.SS2.p4.13.m13.1.1.3.2.cmml">L</mi><mo id="S4.SS2.p4.13.m13.1.1.3.1" xref="S4.SS2.p4.13.m13.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p4.13.m13.1.1.3.3" xref="S4.SS2.p4.13.m13.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.13.m13.1b"><apply id="S4.SS2.p4.13.m13.1.1.cmml" xref="S4.SS2.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.13.m13.1.1.1.cmml" xref="S4.SS2.p4.13.m13.1.1">subscript</csymbol><ci id="S4.SS2.p4.13.m13.1.1.2.cmml" xref="S4.SS2.p4.13.m13.1.1.2">𝛿</ci><apply id="S4.SS2.p4.13.m13.1.1.3.cmml" xref="S4.SS2.p4.13.m13.1.1.3"><plus id="S4.SS2.p4.13.m13.1.1.3.1.cmml" xref="S4.SS2.p4.13.m13.1.1.3.1"></plus><ci id="S4.SS2.p4.13.m13.1.1.3.2.cmml" xref="S4.SS2.p4.13.m13.1.1.3.2">𝐿</ci><cn type="integer" id="S4.SS2.p4.13.m13.1.1.3.3.cmml" xref="S4.SS2.p4.13.m13.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.13.m13.1c">\delta_{L+1}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.10" class="ltx_p">Finally, the forward pass quantities <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="u^{i}" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><msup id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">u</mi><mi id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">𝑢</ci><ci id="S4.SS2.p5.1.m1.1.1.3.cmml" xref="S4.SS2.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">u^{i}</annotation></semantics></math> that may lead to the unambiguous recovery of the hidden set <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="\left\{\partial f/\partial{x}\right\}^{L}" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><msup id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mrow id="S4.SS2.p5.2.m2.1.1.1.1" xref="S4.SS2.p5.2.m2.1.1.1.2.cmml"><mo id="S4.SS2.p5.2.m2.1.1.1.1.2" xref="S4.SS2.p5.2.m2.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p5.2.m2.1.1.1.1.1" xref="S4.SS2.p5.2.m2.1.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p5.2.m2.1.1.1.1.1.1" xref="S4.SS2.p5.2.m2.1.1.1.1.1.1.cmml">∂</mo><mrow id="S4.SS2.p5.2.m2.1.1.1.1.1.2" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p5.2.m2.1.1.1.1.1.2.2" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.2.cmml">f</mi><mo id="S4.SS2.p5.2.m2.1.1.1.1.1.2.1" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.1.cmml">/</mo><mrow id="S4.SS2.p5.2.m2.1.1.1.1.1.2.3" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.1" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.1.cmml">∂</mo><mi id="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.2" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><mo id="S4.SS2.p5.2.m2.1.1.1.1.3" xref="S4.SS2.p5.2.m2.1.1.1.2.cmml">}</mo></mrow><mi id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1">superscript</csymbol><set id="S4.SS2.p5.2.m2.1.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1"><apply id="S4.SS2.p5.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1.1"><partialdiff id="S4.SS2.p5.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1.1.1"></partialdiff><apply id="S4.SS2.p5.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2"><divide id="S4.SS2.p5.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.1"></divide><ci id="S4.SS2.p5.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.2">𝑓</ci><apply id="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.3"><partialdiff id="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.1"></partialdiff><ci id="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p5.2.m2.1.1.1.1.1.2.3.2">𝑥</ci></apply></apply></apply></set><ci id="S4.SS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\left\{\partial f/\partial{x}\right\}^{L}</annotation></semantics></math> are masked (Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
This insures that arguments <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="\alpha^{i}" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><msup id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml"><mi id="S4.SS2.p5.3.m3.1.1.2" xref="S4.SS2.p5.3.m3.1.1.2.cmml">α</mi><mi id="S4.SS2.p5.3.m3.1.1.3" xref="S4.SS2.p5.3.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p5.3.m3.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2">𝛼</ci><ci id="S4.SS2.p5.3.m3.1.1.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">\alpha^{i}</annotation></semantics></math> of the transformations <math id="S4.SS2.p5.4.m4.1" class="ltx_Math" alttext="f^{i}" display="inline"><semantics id="S4.SS2.p5.4.m4.1a"><msup id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><mi id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml">f</mi><mi id="S4.SS2.p5.4.m4.1.1.3" xref="S4.SS2.p5.4.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.4.m4.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1">superscript</csymbol><ci id="S4.SS2.p5.4.m4.1.1.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2">𝑓</ci><ci id="S4.SS2.p5.4.m4.1.1.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">f^{i}</annotation></semantics></math> cannot be further exploited by the attacker.
This could happen when one node is a linear transform of the other as in <math id="S4.SS2.p5.5.m5.2" class="ltx_Math" alttext="u^{i+1}=f^{i+1}((W,u^{i}))=W\times u^{i}" display="inline"><semantics id="S4.SS2.p5.5.m5.2a"><mrow id="S4.SS2.p5.5.m5.2.2" xref="S4.SS2.p5.5.m5.2.2.cmml"><msup id="S4.SS2.p5.5.m5.2.2.3" xref="S4.SS2.p5.5.m5.2.2.3.cmml"><mi id="S4.SS2.p5.5.m5.2.2.3.2" xref="S4.SS2.p5.5.m5.2.2.3.2.cmml">u</mi><mrow id="S4.SS2.p5.5.m5.2.2.3.3" xref="S4.SS2.p5.5.m5.2.2.3.3.cmml"><mi id="S4.SS2.p5.5.m5.2.2.3.3.2" xref="S4.SS2.p5.5.m5.2.2.3.3.2.cmml">i</mi><mo id="S4.SS2.p5.5.m5.2.2.3.3.1" xref="S4.SS2.p5.5.m5.2.2.3.3.1.cmml">+</mo><mn id="S4.SS2.p5.5.m5.2.2.3.3.3" xref="S4.SS2.p5.5.m5.2.2.3.3.3.cmml">1</mn></mrow></msup><mo id="S4.SS2.p5.5.m5.2.2.4" xref="S4.SS2.p5.5.m5.2.2.4.cmml">=</mo><mrow id="S4.SS2.p5.5.m5.2.2.1" xref="S4.SS2.p5.5.m5.2.2.1.cmml"><msup id="S4.SS2.p5.5.m5.2.2.1.3" xref="S4.SS2.p5.5.m5.2.2.1.3.cmml"><mi id="S4.SS2.p5.5.m5.2.2.1.3.2" xref="S4.SS2.p5.5.m5.2.2.1.3.2.cmml">f</mi><mrow id="S4.SS2.p5.5.m5.2.2.1.3.3" xref="S4.SS2.p5.5.m5.2.2.1.3.3.cmml"><mi id="S4.SS2.p5.5.m5.2.2.1.3.3.2" xref="S4.SS2.p5.5.m5.2.2.1.3.3.2.cmml">i</mi><mo id="S4.SS2.p5.5.m5.2.2.1.3.3.1" xref="S4.SS2.p5.5.m5.2.2.1.3.3.1.cmml">+</mo><mn id="S4.SS2.p5.5.m5.2.2.1.3.3.3" xref="S4.SS2.p5.5.m5.2.2.1.3.3.3.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S4.SS2.p5.5.m5.2.2.1.2" xref="S4.SS2.p5.5.m5.2.2.1.2.cmml">​</mo><mrow id="S4.SS2.p5.5.m5.2.2.1.1.1" xref="S4.SS2.p5.5.m5.2.2.1.cmml"><mo stretchy="false" id="S4.SS2.p5.5.m5.2.2.1.1.1.2" xref="S4.SS2.p5.5.m5.2.2.1.cmml">(</mo><mrow id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.2" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.2.cmml">(</mo><mi id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml">W</mi><mo id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.3" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.2.cmml">,</mo><msup id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.2" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.2.cmml">u</mi><mi id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.3" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.4" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="S4.SS2.p5.5.m5.2.2.1.1.1.3" xref="S4.SS2.p5.5.m5.2.2.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p5.5.m5.2.2.5" xref="S4.SS2.p5.5.m5.2.2.5.cmml">=</mo><mrow id="S4.SS2.p5.5.m5.2.2.6" xref="S4.SS2.p5.5.m5.2.2.6.cmml"><mi id="S4.SS2.p5.5.m5.2.2.6.2" xref="S4.SS2.p5.5.m5.2.2.6.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p5.5.m5.2.2.6.1" xref="S4.SS2.p5.5.m5.2.2.6.1.cmml">×</mo><msup id="S4.SS2.p5.5.m5.2.2.6.3" xref="S4.SS2.p5.5.m5.2.2.6.3.cmml"><mi id="S4.SS2.p5.5.m5.2.2.6.3.2" xref="S4.SS2.p5.5.m5.2.2.6.3.2.cmml">u</mi><mi id="S4.SS2.p5.5.m5.2.2.6.3.3" xref="S4.SS2.p5.5.m5.2.2.6.3.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.2b"><apply id="S4.SS2.p5.5.m5.2.2.cmml" xref="S4.SS2.p5.5.m5.2.2"><and id="S4.SS2.p5.5.m5.2.2a.cmml" xref="S4.SS2.p5.5.m5.2.2"></and><apply id="S4.SS2.p5.5.m5.2.2b.cmml" xref="S4.SS2.p5.5.m5.2.2"><eq id="S4.SS2.p5.5.m5.2.2.4.cmml" xref="S4.SS2.p5.5.m5.2.2.4"></eq><apply id="S4.SS2.p5.5.m5.2.2.3.cmml" xref="S4.SS2.p5.5.m5.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.2.2.3.1.cmml" xref="S4.SS2.p5.5.m5.2.2.3">superscript</csymbol><ci id="S4.SS2.p5.5.m5.2.2.3.2.cmml" xref="S4.SS2.p5.5.m5.2.2.3.2">𝑢</ci><apply id="S4.SS2.p5.5.m5.2.2.3.3.cmml" xref="S4.SS2.p5.5.m5.2.2.3.3"><plus id="S4.SS2.p5.5.m5.2.2.3.3.1.cmml" xref="S4.SS2.p5.5.m5.2.2.3.3.1"></plus><ci id="S4.SS2.p5.5.m5.2.2.3.3.2.cmml" xref="S4.SS2.p5.5.m5.2.2.3.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p5.5.m5.2.2.3.3.3.cmml" xref="S4.SS2.p5.5.m5.2.2.3.3.3">1</cn></apply></apply><apply id="S4.SS2.p5.5.m5.2.2.1.cmml" xref="S4.SS2.p5.5.m5.2.2.1"><times id="S4.SS2.p5.5.m5.2.2.1.2.cmml" xref="S4.SS2.p5.5.m5.2.2.1.2"></times><apply id="S4.SS2.p5.5.m5.2.2.1.3.cmml" xref="S4.SS2.p5.5.m5.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.2.2.1.3.1.cmml" xref="S4.SS2.p5.5.m5.2.2.1.3">superscript</csymbol><ci id="S4.SS2.p5.5.m5.2.2.1.3.2.cmml" xref="S4.SS2.p5.5.m5.2.2.1.3.2">𝑓</ci><apply id="S4.SS2.p5.5.m5.2.2.1.3.3.cmml" xref="S4.SS2.p5.5.m5.2.2.1.3.3"><plus id="S4.SS2.p5.5.m5.2.2.1.3.3.1.cmml" xref="S4.SS2.p5.5.m5.2.2.1.3.3.1"></plus><ci id="S4.SS2.p5.5.m5.2.2.1.3.3.2.cmml" xref="S4.SS2.p5.5.m5.2.2.1.3.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p5.5.m5.2.2.1.3.3.3.cmml" xref="S4.SS2.p5.5.m5.2.2.1.3.3.3">1</cn></apply></apply><interval closure="open" id="S4.SS2.p5.5.m5.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.1"><ci id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1">𝑊</ci><apply id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.2">𝑢</ci><ci id="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p5.5.m5.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply></apply><apply id="S4.SS2.p5.5.m5.2.2c.cmml" xref="S4.SS2.p5.5.m5.2.2"><eq id="S4.SS2.p5.5.m5.2.2.5.cmml" xref="S4.SS2.p5.5.m5.2.2.5"></eq><share href="#S4.SS2.p5.5.m5.2.2.1.cmml" id="S4.SS2.p5.5.m5.2.2d.cmml" xref="S4.SS2.p5.5.m5.2.2"></share><apply id="S4.SS2.p5.5.m5.2.2.6.cmml" xref="S4.SS2.p5.5.m5.2.2.6"><times id="S4.SS2.p5.5.m5.2.2.6.1.cmml" xref="S4.SS2.p5.5.m5.2.2.6.1"></times><ci id="S4.SS2.p5.5.m5.2.2.6.2.cmml" xref="S4.SS2.p5.5.m5.2.2.6.2">𝑊</ci><apply id="S4.SS2.p5.5.m5.2.2.6.3.cmml" xref="S4.SS2.p5.5.m5.2.2.6.3"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.2.2.6.3.1.cmml" xref="S4.SS2.p5.5.m5.2.2.6.3">superscript</csymbol><ci id="S4.SS2.p5.5.m5.2.2.6.3.2.cmml" xref="S4.SS2.p5.5.m5.2.2.6.3.2">𝑢</ci><ci id="S4.SS2.p5.5.m5.2.2.6.3.3.cmml" xref="S4.SS2.p5.5.m5.2.2.6.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.2c">u^{i+1}=f^{i+1}((W,u^{i}))=W\times u^{i}</annotation></semantics></math>.
In this case, the local jacobian <math id="S4.SS2.p5.6.m6.1" class="ltx_Math" alttext="J^{i\rightarrow i+1}" display="inline"><semantics id="S4.SS2.p5.6.m6.1a"><msup id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml"><mi id="S4.SS2.p5.6.m6.1.1.2" xref="S4.SS2.p5.6.m6.1.1.2.cmml">J</mi><mrow id="S4.SS2.p5.6.m6.1.1.3" xref="S4.SS2.p5.6.m6.1.1.3.cmml"><mi id="S4.SS2.p5.6.m6.1.1.3.2" xref="S4.SS2.p5.6.m6.1.1.3.2.cmml">i</mi><mo stretchy="false" id="S4.SS2.p5.6.m6.1.1.3.1" xref="S4.SS2.p5.6.m6.1.1.3.1.cmml">→</mo><mrow id="S4.SS2.p5.6.m6.1.1.3.3" xref="S4.SS2.p5.6.m6.1.1.3.3.cmml"><mi id="S4.SS2.p5.6.m6.1.1.3.3.2" xref="S4.SS2.p5.6.m6.1.1.3.3.2.cmml">i</mi><mo id="S4.SS2.p5.6.m6.1.1.3.3.1" xref="S4.SS2.p5.6.m6.1.1.3.3.1.cmml">+</mo><mn id="S4.SS2.p5.6.m6.1.1.3.3.3" xref="S4.SS2.p5.6.m6.1.1.3.3.3.cmml">1</mn></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><apply id="S4.SS2.p5.6.m6.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m6.1.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1">superscript</csymbol><ci id="S4.SS2.p5.6.m6.1.1.2.cmml" xref="S4.SS2.p5.6.m6.1.1.2">𝐽</ci><apply id="S4.SS2.p5.6.m6.1.1.3.cmml" xref="S4.SS2.p5.6.m6.1.1.3"><ci id="S4.SS2.p5.6.m6.1.1.3.1.cmml" xref="S4.SS2.p5.6.m6.1.1.3.1">→</ci><ci id="S4.SS2.p5.6.m6.1.1.3.2.cmml" xref="S4.SS2.p5.6.m6.1.1.3.2">𝑖</ci><apply id="S4.SS2.p5.6.m6.1.1.3.3.cmml" xref="S4.SS2.p5.6.m6.1.1.3.3"><plus id="S4.SS2.p5.6.m6.1.1.3.3.1.cmml" xref="S4.SS2.p5.6.m6.1.1.3.3.1"></plus><ci id="S4.SS2.p5.6.m6.1.1.3.3.2.cmml" xref="S4.SS2.p5.6.m6.1.1.3.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p5.6.m6.1.1.3.3.3.cmml" xref="S4.SS2.p5.6.m6.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">J^{i\rightarrow i+1}</annotation></semantics></math> is known to be exactly equal to <math id="S4.SS2.p5.7.m7.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS2.p5.7.m7.1a"><mi id="S4.SS2.p5.7.m7.1.1" xref="S4.SS2.p5.7.m7.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m7.1b"><ci id="S4.SS2.p5.7.m7.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m7.1c">W</annotation></semantics></math>.
Notice that weights and biases of a DNN would be effectively masked, as they are regarded as leaf vertices of the model’s computational graph for the <math id="S4.SS2.p5.8.m8.1" class="ltx_Math" alttext="f^{i}((u^{i},u^{i-1},u^{i-2}))=u^{i-1}\cdot u^{i}+u^{i-2}=Wx+b" display="inline"><semantics id="S4.SS2.p5.8.m8.1a"><mrow id="S4.SS2.p5.8.m8.1.1" xref="S4.SS2.p5.8.m8.1.1.cmml"><mrow id="S4.SS2.p5.8.m8.1.1.1" xref="S4.SS2.p5.8.m8.1.1.1.cmml"><msup id="S4.SS2.p5.8.m8.1.1.1.3" xref="S4.SS2.p5.8.m8.1.1.1.3.cmml"><mi id="S4.SS2.p5.8.m8.1.1.1.3.2" xref="S4.SS2.p5.8.m8.1.1.1.3.2.cmml">f</mi><mi id="S4.SS2.p5.8.m8.1.1.1.3.3" xref="S4.SS2.p5.8.m8.1.1.1.3.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS2.p5.8.m8.1.1.1.2" xref="S4.SS2.p5.8.m8.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p5.8.m8.1.1.1.1.1" xref="S4.SS2.p5.8.m8.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p5.8.m8.1.1.1.1.1.2" xref="S4.SS2.p5.8.m8.1.1.1.cmml">(</mo><mrow id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.4" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.4.cmml">(</mo><msup id="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.2.cmml">u</mi><mi id="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.5" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.4.cmml">,</mo><msup id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.2" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.2.cmml">u</mi><mrow id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.2" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.1" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.1.cmml">−</mo><mn id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.3" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.6" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.4.cmml">,</mo><msup id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.cmml"><mi id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.2" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.2.cmml">u</mi><mrow id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.2" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.1" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.3" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.3.cmml">2</mn></mrow></msup><mo stretchy="false" id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.7" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo stretchy="false" id="S4.SS2.p5.8.m8.1.1.1.1.1.3" xref="S4.SS2.p5.8.m8.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p5.8.m8.1.1.3" xref="S4.SS2.p5.8.m8.1.1.3.cmml">=</mo><mrow id="S4.SS2.p5.8.m8.1.1.4" xref="S4.SS2.p5.8.m8.1.1.4.cmml"><mrow id="S4.SS2.p5.8.m8.1.1.4.2" xref="S4.SS2.p5.8.m8.1.1.4.2.cmml"><msup id="S4.SS2.p5.8.m8.1.1.4.2.2" xref="S4.SS2.p5.8.m8.1.1.4.2.2.cmml"><mi id="S4.SS2.p5.8.m8.1.1.4.2.2.2" xref="S4.SS2.p5.8.m8.1.1.4.2.2.2.cmml">u</mi><mrow id="S4.SS2.p5.8.m8.1.1.4.2.2.3" xref="S4.SS2.p5.8.m8.1.1.4.2.2.3.cmml"><mi id="S4.SS2.p5.8.m8.1.1.4.2.2.3.2" xref="S4.SS2.p5.8.m8.1.1.4.2.2.3.2.cmml">i</mi><mo id="S4.SS2.p5.8.m8.1.1.4.2.2.3.1" xref="S4.SS2.p5.8.m8.1.1.4.2.2.3.1.cmml">−</mo><mn id="S4.SS2.p5.8.m8.1.1.4.2.2.3.3" xref="S4.SS2.p5.8.m8.1.1.4.2.2.3.3.cmml">1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p5.8.m8.1.1.4.2.1" xref="S4.SS2.p5.8.m8.1.1.4.2.1.cmml">⋅</mo><msup id="S4.SS2.p5.8.m8.1.1.4.2.3" xref="S4.SS2.p5.8.m8.1.1.4.2.3.cmml"><mi id="S4.SS2.p5.8.m8.1.1.4.2.3.2" xref="S4.SS2.p5.8.m8.1.1.4.2.3.2.cmml">u</mi><mi id="S4.SS2.p5.8.m8.1.1.4.2.3.3" xref="S4.SS2.p5.8.m8.1.1.4.2.3.3.cmml">i</mi></msup></mrow><mo id="S4.SS2.p5.8.m8.1.1.4.1" xref="S4.SS2.p5.8.m8.1.1.4.1.cmml">+</mo><msup id="S4.SS2.p5.8.m8.1.1.4.3" xref="S4.SS2.p5.8.m8.1.1.4.3.cmml"><mi id="S4.SS2.p5.8.m8.1.1.4.3.2" xref="S4.SS2.p5.8.m8.1.1.4.3.2.cmml">u</mi><mrow id="S4.SS2.p5.8.m8.1.1.4.3.3" xref="S4.SS2.p5.8.m8.1.1.4.3.3.cmml"><mi id="S4.SS2.p5.8.m8.1.1.4.3.3.2" xref="S4.SS2.p5.8.m8.1.1.4.3.3.2.cmml">i</mi><mo id="S4.SS2.p5.8.m8.1.1.4.3.3.1" xref="S4.SS2.p5.8.m8.1.1.4.3.3.1.cmml">−</mo><mn id="S4.SS2.p5.8.m8.1.1.4.3.3.3" xref="S4.SS2.p5.8.m8.1.1.4.3.3.3.cmml">2</mn></mrow></msup></mrow><mo id="S4.SS2.p5.8.m8.1.1.5" xref="S4.SS2.p5.8.m8.1.1.5.cmml">=</mo><mrow id="S4.SS2.p5.8.m8.1.1.6" xref="S4.SS2.p5.8.m8.1.1.6.cmml"><mrow id="S4.SS2.p5.8.m8.1.1.6.2" xref="S4.SS2.p5.8.m8.1.1.6.2.cmml"><mi id="S4.SS2.p5.8.m8.1.1.6.2.2" xref="S4.SS2.p5.8.m8.1.1.6.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p5.8.m8.1.1.6.2.1" xref="S4.SS2.p5.8.m8.1.1.6.2.1.cmml">​</mo><mi id="S4.SS2.p5.8.m8.1.1.6.2.3" xref="S4.SS2.p5.8.m8.1.1.6.2.3.cmml">x</mi></mrow><mo id="S4.SS2.p5.8.m8.1.1.6.1" xref="S4.SS2.p5.8.m8.1.1.6.1.cmml">+</mo><mi id="S4.SS2.p5.8.m8.1.1.6.3" xref="S4.SS2.p5.8.m8.1.1.6.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.8.m8.1b"><apply id="S4.SS2.p5.8.m8.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1"><and id="S4.SS2.p5.8.m8.1.1a.cmml" xref="S4.SS2.p5.8.m8.1.1"></and><apply id="S4.SS2.p5.8.m8.1.1b.cmml" xref="S4.SS2.p5.8.m8.1.1"><eq id="S4.SS2.p5.8.m8.1.1.3.cmml" xref="S4.SS2.p5.8.m8.1.1.3"></eq><apply id="S4.SS2.p5.8.m8.1.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1"><times id="S4.SS2.p5.8.m8.1.1.1.2.cmml" xref="S4.SS2.p5.8.m8.1.1.1.2"></times><apply id="S4.SS2.p5.8.m8.1.1.1.3.cmml" xref="S4.SS2.p5.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.1.3.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.1.3.2.cmml" xref="S4.SS2.p5.8.m8.1.1.1.3.2">𝑓</ci><ci id="S4.SS2.p5.8.m8.1.1.1.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.1.3.3">𝑖</ci></apply><vector id="S4.SS2.p5.8.m8.1.1.1.1.1.1.4.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3"><apply id="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.2">𝑢</ci><ci id="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.2">𝑢</ci><apply id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3"><minus id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.1"></minus><ci id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.2">𝑢</ci><apply id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3"><minus id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.1.1.1.1.3.3.3.3">2</cn></apply></apply></vector></apply><apply id="S4.SS2.p5.8.m8.1.1.4.cmml" xref="S4.SS2.p5.8.m8.1.1.4"><plus id="S4.SS2.p5.8.m8.1.1.4.1.cmml" xref="S4.SS2.p5.8.m8.1.1.4.1"></plus><apply id="S4.SS2.p5.8.m8.1.1.4.2.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2"><ci id="S4.SS2.p5.8.m8.1.1.4.2.1.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.1">⋅</ci><apply id="S4.SS2.p5.8.m8.1.1.4.2.2.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.2"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.4.2.2.1.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.2">superscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.4.2.2.2.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.2.2">𝑢</ci><apply id="S4.SS2.p5.8.m8.1.1.4.2.2.3.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.2.3"><minus id="S4.SS2.p5.8.m8.1.1.4.2.2.3.1.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.2.3.1"></minus><ci id="S4.SS2.p5.8.m8.1.1.4.2.2.3.2.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.2.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p5.8.m8.1.1.4.2.2.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p5.8.m8.1.1.4.2.3.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.4.2.3.1.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.3">superscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.4.2.3.2.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.3.2">𝑢</ci><ci id="S4.SS2.p5.8.m8.1.1.4.2.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.4.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS2.p5.8.m8.1.1.4.3.cmml" xref="S4.SS2.p5.8.m8.1.1.4.3"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.4.3.1.cmml" xref="S4.SS2.p5.8.m8.1.1.4.3">superscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.4.3.2.cmml" xref="S4.SS2.p5.8.m8.1.1.4.3.2">𝑢</ci><apply id="S4.SS2.p5.8.m8.1.1.4.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.4.3.3"><minus id="S4.SS2.p5.8.m8.1.1.4.3.3.1.cmml" xref="S4.SS2.p5.8.m8.1.1.4.3.3.1"></minus><ci id="S4.SS2.p5.8.m8.1.1.4.3.3.2.cmml" xref="S4.SS2.p5.8.m8.1.1.4.3.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p5.8.m8.1.1.4.3.3.3.cmml" xref="S4.SS2.p5.8.m8.1.1.4.3.3.3">2</cn></apply></apply></apply></apply><apply id="S4.SS2.p5.8.m8.1.1c.cmml" xref="S4.SS2.p5.8.m8.1.1"><eq id="S4.SS2.p5.8.m8.1.1.5.cmml" xref="S4.SS2.p5.8.m8.1.1.5"></eq><share href="#S4.SS2.p5.8.m8.1.1.4.cmml" id="S4.SS2.p5.8.m8.1.1d.cmml" xref="S4.SS2.p5.8.m8.1.1"></share><apply id="S4.SS2.p5.8.m8.1.1.6.cmml" xref="S4.SS2.p5.8.m8.1.1.6"><plus id="S4.SS2.p5.8.m8.1.1.6.1.cmml" xref="S4.SS2.p5.8.m8.1.1.6.1"></plus><apply id="S4.SS2.p5.8.m8.1.1.6.2.cmml" xref="S4.SS2.p5.8.m8.1.1.6.2"><times id="S4.SS2.p5.8.m8.1.1.6.2.1.cmml" xref="S4.SS2.p5.8.m8.1.1.6.2.1"></times><ci id="S4.SS2.p5.8.m8.1.1.6.2.2.cmml" xref="S4.SS2.p5.8.m8.1.1.6.2.2">𝑊</ci><ci id="S4.SS2.p5.8.m8.1.1.6.2.3.cmml" xref="S4.SS2.p5.8.m8.1.1.6.2.3">𝑥</ci></apply><ci id="S4.SS2.p5.8.m8.1.1.6.3.cmml" xref="S4.SS2.p5.8.m8.1.1.6.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.8.m8.1c">f^{i}((u^{i},u^{i-1},u^{i-2}))=u^{i-1}\cdot u^{i}+u^{i-2}=Wx+b</annotation></semantics></math> operation. Similarly, the outputs of the transformations, <math id="S4.SS2.p5.9.m9.1" class="ltx_Math" alttext="u^{i}=f^{i}(\alpha^{i})" display="inline"><semantics id="S4.SS2.p5.9.m9.1a"><mrow id="S4.SS2.p5.9.m9.1.1" xref="S4.SS2.p5.9.m9.1.1.cmml"><msup id="S4.SS2.p5.9.m9.1.1.3" xref="S4.SS2.p5.9.m9.1.1.3.cmml"><mi id="S4.SS2.p5.9.m9.1.1.3.2" xref="S4.SS2.p5.9.m9.1.1.3.2.cmml">u</mi><mi id="S4.SS2.p5.9.m9.1.1.3.3" xref="S4.SS2.p5.9.m9.1.1.3.3.cmml">i</mi></msup><mo id="S4.SS2.p5.9.m9.1.1.2" xref="S4.SS2.p5.9.m9.1.1.2.cmml">=</mo><mrow id="S4.SS2.p5.9.m9.1.1.1" xref="S4.SS2.p5.9.m9.1.1.1.cmml"><msup id="S4.SS2.p5.9.m9.1.1.1.3" xref="S4.SS2.p5.9.m9.1.1.1.3.cmml"><mi id="S4.SS2.p5.9.m9.1.1.1.3.2" xref="S4.SS2.p5.9.m9.1.1.1.3.2.cmml">f</mi><mi id="S4.SS2.p5.9.m9.1.1.1.3.3" xref="S4.SS2.p5.9.m9.1.1.1.3.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS2.p5.9.m9.1.1.1.2" xref="S4.SS2.p5.9.m9.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p5.9.m9.1.1.1.1.1" xref="S4.SS2.p5.9.m9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p5.9.m9.1.1.1.1.1.2" xref="S4.SS2.p5.9.m9.1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS2.p5.9.m9.1.1.1.1.1.1" xref="S4.SS2.p5.9.m9.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p5.9.m9.1.1.1.1.1.1.2" xref="S4.SS2.p5.9.m9.1.1.1.1.1.1.2.cmml">α</mi><mi id="S4.SS2.p5.9.m9.1.1.1.1.1.1.3" xref="S4.SS2.p5.9.m9.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S4.SS2.p5.9.m9.1.1.1.1.1.3" xref="S4.SS2.p5.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.9.m9.1b"><apply id="S4.SS2.p5.9.m9.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1"><eq id="S4.SS2.p5.9.m9.1.1.2.cmml" xref="S4.SS2.p5.9.m9.1.1.2"></eq><apply id="S4.SS2.p5.9.m9.1.1.3.cmml" xref="S4.SS2.p5.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.9.m9.1.1.3.1.cmml" xref="S4.SS2.p5.9.m9.1.1.3">superscript</csymbol><ci id="S4.SS2.p5.9.m9.1.1.3.2.cmml" xref="S4.SS2.p5.9.m9.1.1.3.2">𝑢</ci><ci id="S4.SS2.p5.9.m9.1.1.3.3.cmml" xref="S4.SS2.p5.9.m9.1.1.3.3">𝑖</ci></apply><apply id="S4.SS2.p5.9.m9.1.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1.1"><times id="S4.SS2.p5.9.m9.1.1.1.2.cmml" xref="S4.SS2.p5.9.m9.1.1.1.2"></times><apply id="S4.SS2.p5.9.m9.1.1.1.3.cmml" xref="S4.SS2.p5.9.m9.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.9.m9.1.1.1.3.1.cmml" xref="S4.SS2.p5.9.m9.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p5.9.m9.1.1.1.3.2.cmml" xref="S4.SS2.p5.9.m9.1.1.1.3.2">𝑓</ci><ci id="S4.SS2.p5.9.m9.1.1.1.3.3.cmml" xref="S4.SS2.p5.9.m9.1.1.1.3.3">𝑖</ci></apply><apply id="S4.SS2.p5.9.m9.1.1.1.1.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.9.m9.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p5.9.m9.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p5.9.m9.1.1.1.1.1.1.2">𝛼</ci><ci id="S4.SS2.p5.9.m9.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p5.9.m9.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.9.m9.1c">u^{i}=f^{i}(\alpha^{i})</annotation></semantics></math>, are masked by (Alg. <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-line <a href="#algorithm1" title="Algorithm 1 ‣ 4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Overall, for a DNN, the exact quantities enumerated in §<a href="#S3" title="3. Threat Model ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>
are stored in the enclave <math id="S4.SS2.p5.10.m10.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S4.SS2.p5.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.10.m10.1.1" xref="S4.SS2.p5.10.m10.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.10.m10.1b"><ci id="S4.SS2.p5.10.m10.1.1.cmml" xref="S4.SS2.p5.10.m10.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.10.m10.1c">\mathcal{E}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Relation with BPDA</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.6" class="ltx_p">When training a DL model, a straight-through estimator allows a simple approximation of the gradient of a non-differentiable function (<span id="S4.SS3.p1.6.1" class="ltx_ERROR undefined">\eg</span>a threshold) <cite class="ltx_cite ltx_citemacro_citep">(Bengio et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2018</a>)</cite>.
In a setting discussed in <cite class="ltx_cite ltx_citemacro_citep">(Athalye et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite>, this idea is generalized to a so called Backward Pass Differentiable Approximation (BPDA) to illustrate how preventing a layer from being differentiable in hopes of defeating a gradient-based attack actually constitutes a fragile security measure.
In BPDA, the non-differentiable layer <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="f^{l}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msup id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">f</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝑓</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">f^{l}</annotation></semantics></math> of a neural network <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="f^{1\ldots L}(\cdot)" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.2" xref="S4.SS3.p1.2.m2.1.2.cmml"><msup id="S4.SS3.p1.2.m2.1.2.2" xref="S4.SS3.p1.2.m2.1.2.2.cmml"><mi id="S4.SS3.p1.2.m2.1.2.2.2" xref="S4.SS3.p1.2.m2.1.2.2.2.cmml">f</mi><mrow id="S4.SS3.p1.2.m2.1.2.2.3" xref="S4.SS3.p1.2.m2.1.2.2.3.cmml"><mn id="S4.SS3.p1.2.m2.1.2.2.3.2" xref="S4.SS3.p1.2.m2.1.2.2.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.2.2.3.1" xref="S4.SS3.p1.2.m2.1.2.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p1.2.m2.1.2.2.3.3" xref="S4.SS3.p1.2.m2.1.2.2.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.2.2.3.1a" xref="S4.SS3.p1.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.2.m2.1.2.2.3.4" xref="S4.SS3.p1.2.m2.1.2.2.3.4.cmml">L</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.2.1" xref="S4.SS3.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS3.p1.2.m2.1.2.3.2" xref="S4.SS3.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.1.2.3.2.1" xref="S4.SS3.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p1.2.m2.1.2.3.2.2" xref="S4.SS3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.2.cmml" xref="S4.SS3.p1.2.m2.1.2"><times id="S4.SS3.p1.2.m2.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.2.1"></times><apply id="S4.SS3.p1.2.m2.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.2.2.1.cmml" xref="S4.SS3.p1.2.m2.1.2.2">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.2.2.2.cmml" xref="S4.SS3.p1.2.m2.1.2.2.2">𝑓</ci><apply id="S4.SS3.p1.2.m2.1.2.2.3.cmml" xref="S4.SS3.p1.2.m2.1.2.2.3"><times id="S4.SS3.p1.2.m2.1.2.2.3.1.cmml" xref="S4.SS3.p1.2.m2.1.2.2.3.1"></times><cn type="integer" id="S4.SS3.p1.2.m2.1.2.2.3.2.cmml" xref="S4.SS3.p1.2.m2.1.2.2.3.2">1</cn><ci id="S4.SS3.p1.2.m2.1.2.2.3.3.cmml" xref="S4.SS3.p1.2.m2.1.2.2.3.3">…</ci><ci id="S4.SS3.p1.2.m2.1.2.2.3.4.cmml" xref="S4.SS3.p1.2.m2.1.2.2.3.4">𝐿</ci></apply></apply><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">f^{1\ldots L}(\cdot)</annotation></semantics></math> would be approximated by a neural network <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">g</annotation></semantics></math> <em id="S4.SS3.p1.6.2" class="ltx_emph ltx_font_italic">s.t.</em> <math id="S4.SS3.p1.4.m4.2" class="ltx_Math" alttext="g(x)\approx f^{l}(x)" display="inline"><semantics id="S4.SS3.p1.4.m4.2a"><mrow id="S4.SS3.p1.4.m4.2.3" xref="S4.SS3.p1.4.m4.2.3.cmml"><mrow id="S4.SS3.p1.4.m4.2.3.2" xref="S4.SS3.p1.4.m4.2.3.2.cmml"><mi id="S4.SS3.p1.4.m4.2.3.2.2" xref="S4.SS3.p1.4.m4.2.3.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.2.3.2.1" xref="S4.SS3.p1.4.m4.2.3.2.1.cmml">​</mo><mrow id="S4.SS3.p1.4.m4.2.3.2.3.2" xref="S4.SS3.p1.4.m4.2.3.2.cmml"><mo stretchy="false" id="S4.SS3.p1.4.m4.2.3.2.3.2.1" xref="S4.SS3.p1.4.m4.2.3.2.cmml">(</mo><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS3.p1.4.m4.2.3.2.3.2.2" xref="S4.SS3.p1.4.m4.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p1.4.m4.2.3.1" xref="S4.SS3.p1.4.m4.2.3.1.cmml">≈</mo><mrow id="S4.SS3.p1.4.m4.2.3.3" xref="S4.SS3.p1.4.m4.2.3.3.cmml"><msup id="S4.SS3.p1.4.m4.2.3.3.2" xref="S4.SS3.p1.4.m4.2.3.3.2.cmml"><mi id="S4.SS3.p1.4.m4.2.3.3.2.2" xref="S4.SS3.p1.4.m4.2.3.3.2.2.cmml">f</mi><mi id="S4.SS3.p1.4.m4.2.3.3.2.3" xref="S4.SS3.p1.4.m4.2.3.3.2.3.cmml">l</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.2.3.3.1" xref="S4.SS3.p1.4.m4.2.3.3.1.cmml">​</mo><mrow id="S4.SS3.p1.4.m4.2.3.3.3.2" xref="S4.SS3.p1.4.m4.2.3.3.cmml"><mo stretchy="false" id="S4.SS3.p1.4.m4.2.3.3.3.2.1" xref="S4.SS3.p1.4.m4.2.3.3.cmml">(</mo><mi id="S4.SS3.p1.4.m4.2.2" xref="S4.SS3.p1.4.m4.2.2.cmml">x</mi><mo stretchy="false" id="S4.SS3.p1.4.m4.2.3.3.3.2.2" xref="S4.SS3.p1.4.m4.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.2b"><apply id="S4.SS3.p1.4.m4.2.3.cmml" xref="S4.SS3.p1.4.m4.2.3"><approx id="S4.SS3.p1.4.m4.2.3.1.cmml" xref="S4.SS3.p1.4.m4.2.3.1"></approx><apply id="S4.SS3.p1.4.m4.2.3.2.cmml" xref="S4.SS3.p1.4.m4.2.3.2"><times id="S4.SS3.p1.4.m4.2.3.2.1.cmml" xref="S4.SS3.p1.4.m4.2.3.2.1"></times><ci id="S4.SS3.p1.4.m4.2.3.2.2.cmml" xref="S4.SS3.p1.4.m4.2.3.2.2">𝑔</ci><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝑥</ci></apply><apply id="S4.SS3.p1.4.m4.2.3.3.cmml" xref="S4.SS3.p1.4.m4.2.3.3"><times id="S4.SS3.p1.4.m4.2.3.3.1.cmml" xref="S4.SS3.p1.4.m4.2.3.3.1"></times><apply id="S4.SS3.p1.4.m4.2.3.3.2.cmml" xref="S4.SS3.p1.4.m4.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.2.3.3.2.1.cmml" xref="S4.SS3.p1.4.m4.2.3.3.2">superscript</csymbol><ci id="S4.SS3.p1.4.m4.2.3.3.2.2.cmml" xref="S4.SS3.p1.4.m4.2.3.3.2.2">𝑓</ci><ci id="S4.SS3.p1.4.m4.2.3.3.2.3.cmml" xref="S4.SS3.p1.4.m4.2.3.3.2.3">𝑙</ci></apply><ci id="S4.SS3.p1.4.m4.2.2.cmml" xref="S4.SS3.p1.4.m4.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.2c">g(x)\approx f^{l}(x)</annotation></semantics></math> and be back-propagated through <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">g</annotation></semantics></math> instead of the non-differentiable transform.
This method is what a malicious node adopts against <span id="S4.SS3.p1.6.3" class="ltx_text ltx_font_smallcaps">Pelta</span> by upsampling the adjoint of the last clear layer <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="\delta_{L+1}" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><msub id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2" xref="S4.SS3.p1.6.m6.1.1.2.cmml">δ</mi><mrow id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml"><mi id="S4.SS3.p1.6.m6.1.1.3.2" xref="S4.SS3.p1.6.m6.1.1.3.2.cmml">L</mi><mo id="S4.SS3.p1.6.m6.1.1.3.1" xref="S4.SS3.p1.6.m6.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p1.6.m6.1.1.3.3" xref="S4.SS3.p1.6.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">𝛿</ci><apply id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3"><plus id="S4.SS3.p1.6.m6.1.1.3.1.cmml" xref="S4.SS3.p1.6.m6.1.1.3.1"></plus><ci id="S4.SS3.p1.6.m6.1.1.3.2.cmml" xref="S4.SS3.p1.6.m6.1.1.3.2">𝐿</ci><cn type="integer" id="S4.SS3.p1.6.m6.1.1.3.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">\delta_{L+1}</annotation></semantics></math> to bypass the shielded layers. An illustrative case for a DNN is shown in Fig.<a href="#S4.F2" title="Figure 2 ‣ 4.3. Relation with BPDA ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. However, the attacker operates with two limiting factors: <span id="S4.SS3.p1.6.4" class="ltx_text ltx_font_italic">(i)</span> in a real-world scenario, the attacker possesses limited time and number of passes before the broadcast model becomes obsolete; <span id="S4.SS3.p1.6.5" class="ltx_text ltx_font_italic">(ii)</span> we hypothesize the attacker does not have priors on the parameters of the first layers of the model, therefore the adversary is effectively left without options for computing the gradient-based update other than training a BPDA of the layer.
Although this attack makes a fundamental pitfall of gradient masking techniques, it is worth noting this step becomes increasingly difficult for the attacker as larger parts of the model are hidden from him since it would suppose he has training resources equivalent to that of the FL system. As a side note, we mention that there exist recent defenses against BPDA <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">In §<a href="#S5" title="5. Evaluation ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we investigate to what extent an evasion attack can be mitigated by <span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span> and whether the upsampling of the under-factored gradient (which is merely a linear transformation of the correct gradient in the case of the first transformation in many vision models) as a substitute for the masked backward process constitutes a possible last resort for the malicious node.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2308.04373/assets/x2.png" id="S4.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="176" height="71" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.6.2.1" class="ltx_text" style="font-size:90%;">Figure 2</span>. </span><span id="S4.F2.3.1" class="ltx_text" style="font-size:90%;">Overview of the <span id="S4.F2.3.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span> defense scheme over the first layers of a machine learning model against an iterative gradient-based adversarial attack.
Because the attacker cannot access operations in the first layers, he resorts to upsample his under-factored gradient <math id="S4.F2.3.1.m1.1" class="ltx_Math" alttext="\delta_{L+1}" display="inline"><semantics id="S4.F2.3.1.m1.1b"><msub id="S4.F2.3.1.m1.1.1" xref="S4.F2.3.1.m1.1.1.cmml"><mi id="S4.F2.3.1.m1.1.1.2" xref="S4.F2.3.1.m1.1.1.2.cmml">δ</mi><mrow id="S4.F2.3.1.m1.1.1.3" xref="S4.F2.3.1.m1.1.1.3.cmml"><mi id="S4.F2.3.1.m1.1.1.3.2" xref="S4.F2.3.1.m1.1.1.3.2.cmml">L</mi><mo id="S4.F2.3.1.m1.1.1.3.1" xref="S4.F2.3.1.m1.1.1.3.1.cmml">+</mo><mn id="S4.F2.3.1.m1.1.1.3.3" xref="S4.F2.3.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F2.3.1.m1.1c"><apply id="S4.F2.3.1.m1.1.1.cmml" xref="S4.F2.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F2.3.1.m1.1.1.1.cmml" xref="S4.F2.3.1.m1.1.1">subscript</csymbol><ci id="S4.F2.3.1.m1.1.1.2.cmml" xref="S4.F2.3.1.m1.1.1.2">𝛿</ci><apply id="S4.F2.3.1.m1.1.1.3.cmml" xref="S4.F2.3.1.m1.1.1.3"><plus id="S4.F2.3.1.m1.1.1.3.1.cmml" xref="S4.F2.3.1.m1.1.1.3.1"></plus><ci id="S4.F2.3.1.m1.1.1.3.2.cmml" xref="S4.F2.3.1.m1.1.1.3.2">𝐿</ci><cn type="integer" id="S4.F2.3.1.m1.1.1.3.3.cmml" xref="S4.F2.3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.3.1.m1.1d">\delta_{L+1}</annotation></semantics></math> to compute the gradient-based adversarial update.
The figure depicts activations as transforms for a DNN. </span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Evaluation</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text ltx_font_italic">What is the effect of forcibly removing leftmost factors from the chain-rule of an attacker conducting an adversarial attack?</span>
To answer this question, we conduct attacks on a robust ensemble model with shielded layers.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span> Evaluation Metric and Ensemble Defense Setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">The <span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_italic">clean accuracy</span> of a model refers to its standard test accuracy, to differentiate it from the context of an evasion attack where the goal of the defender is to score high on <span id="S5.SS1.p1.1.2" class="ltx_text ltx_font_italic">astuteness</span> (<span id="S5.SS1.p1.1.3" class="ltx_ERROR undefined">\ie</span><span id="S5.SS1.p1.1.4" class="ltx_text ltx_font_italic">robust accuracy</span>) against a test set with adversarial perturbation.
We chose as target model an ensemble of two state of the art high clean accuracy model trained on CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky and Hinton, <a href="#bib.bib27" title="" class="ltx_ref">2009</a>)</cite>: <em id="S5.SS1.p1.1.5" class="ltx_emph ltx_font_italic">(i)</em> a Vision Transformer ViT-L/16 <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite> and <em id="S5.SS1.p1.1.6" class="ltx_emph ltx_font_italic">(ii)</em> a Big Transfer model BiT-M-R101x3 <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> which stems from the CNN-based ResNet-v2 architecture <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2016</a>)</cite>.
We chose an ensemble because, generally, when dealing with the image classification task, adversarial examples do not <span id="S5.SS1.p1.1.7" class="ltx_text ltx_font_italic">transfer</span> well between Transformer based and CNN based models <cite class="ltx_cite ltx_citemacro_citep">(Mahmood et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>. This means that an example crafted to fool one type of model in particular will rarely defeat the other.
This allows for mitigating attacks that target either one of the two specifically, by exploiting a combination of the model outputs to maximize chances of correct prediction.
In this paper, we use random selection <cite class="ltx_cite ltx_citemacro_citep">(Srisakaokul et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2018</a>)</cite>, where, for each sample, one of the two models is selected at random to evaluate the input at test time.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.4" class="ltx_p"><span id="S5.SS1.p2.4.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">Pelta<span id="S5.SS1.p2.4.1.1" class="ltx_text ltx_font_upright"> Shielding defense of the white-box.</span></span>
To simulate the shielding inside the TEE enclave, we deprive the attacker of the aforementioned quantities (§<a href="#S4.SS2" title="4.2. Pelta shielding ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>) in the two models separately, then jointly.
For the ViT model, all transforms up to the position embedding <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite> are included.
This means that the following steps occur inside the enclave: separation of the input into patches <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="{x}_{p}^{n}" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><msubsup id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><mi id="S5.SS1.p2.1.m1.1.1.2.2" xref="S5.SS1.p2.1.m1.1.1.2.2.cmml">x</mi><mi id="S5.SS1.p2.1.m1.1.1.2.3" xref="S5.SS1.p2.1.m1.1.1.2.3.cmml">p</mi><mi id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">superscript</csymbol><apply id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.2.1.cmml" xref="S5.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p2.1.m1.1.1.2.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2.2">𝑥</ci><ci id="S5.SS1.p2.1.m1.1.1.2.3.cmml" xref="S5.SS1.p2.1.m1.1.1.2.3">𝑝</ci></apply><ci id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">{x}_{p}^{n}</annotation></semantics></math>, projection onto embedding space with embedding matrix <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">E</annotation></semantics></math>, concatenation with learnable token <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="x_{class}" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><msub id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><mi id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml">x</mi><mrow id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml"><mi id="S5.SS1.p2.3.m3.1.1.3.2" xref="S5.SS1.p2.3.m3.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1.3.1" xref="S5.SS1.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p2.3.m3.1.1.3.3" xref="S5.SS1.p2.3.m3.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1.3.1a" xref="S5.SS1.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p2.3.m3.1.1.3.4" xref="S5.SS1.p2.3.m3.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1.3.1b" xref="S5.SS1.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p2.3.m3.1.1.3.5" xref="S5.SS1.p2.3.m3.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1.3.1c" xref="S5.SS1.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p2.3.m3.1.1.3.6" xref="S5.SS1.p2.3.m3.1.1.3.6.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2">𝑥</ci><apply id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3"><times id="S5.SS1.p2.3.m3.1.1.3.1.cmml" xref="S5.SS1.p2.3.m3.1.1.3.1"></times><ci id="S5.SS1.p2.3.m3.1.1.3.2.cmml" xref="S5.SS1.p2.3.m3.1.1.3.2">𝑐</ci><ci id="S5.SS1.p2.3.m3.1.1.3.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3">𝑙</ci><ci id="S5.SS1.p2.3.m3.1.1.3.4.cmml" xref="S5.SS1.p2.3.m3.1.1.3.4">𝑎</ci><ci id="S5.SS1.p2.3.m3.1.1.3.5.cmml" xref="S5.SS1.p2.3.m3.1.1.3.5">𝑠</ci><ci id="S5.SS1.p2.3.m3.1.1.3.6.cmml" xref="S5.SS1.p2.3.m3.1.1.3.6">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">x_{class}</annotation></semantics></math> and summation with position embedding matrix <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="E_{pos}" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><msub id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><mi id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml">E</mi><mrow id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml"><mi id="S5.SS1.p2.4.m4.1.1.3.2" xref="S5.SS1.p2.4.m4.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.4.m4.1.1.3.1" xref="S5.SS1.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p2.4.m4.1.1.3.3" xref="S5.SS1.p2.4.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.4.m4.1.1.3.1a" xref="S5.SS1.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p2.4.m4.1.1.3.4" xref="S5.SS1.p2.4.m4.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2">𝐸</ci><apply id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3"><times id="S5.SS1.p2.4.m4.1.1.3.1.cmml" xref="S5.SS1.p2.4.m4.1.1.3.1"></times><ci id="S5.SS1.p2.4.m4.1.1.3.2.cmml" xref="S5.SS1.p2.4.m4.1.1.3.2">𝑝</ci><ci id="S5.SS1.p2.4.m4.1.1.3.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3.3">𝑜</ci><ci id="S5.SS1.p2.4.m4.1.1.3.4.cmml" xref="S5.SS1.p2.4.m4.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">E_{pos}</annotation></semantics></math>:</p>
<table id="S5.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.Ex3.m1.5" class="ltx_Math" alttext="z_{0}=\left[x_{\text{class }};{x}_{p}^{1}{E};{x}_{p}^{2}{E};\cdots;{x}_{p}^{N}{E}\right]+{E}_{\text{pos}}" display="block"><semantics id="S5.Ex3.m1.5a"><mrow id="S5.Ex3.m1.5.5" xref="S5.Ex3.m1.5.5.cmml"><msub id="S5.Ex3.m1.5.5.6" xref="S5.Ex3.m1.5.5.6.cmml"><mi id="S5.Ex3.m1.5.5.6.2" xref="S5.Ex3.m1.5.5.6.2.cmml">z</mi><mn id="S5.Ex3.m1.5.5.6.3" xref="S5.Ex3.m1.5.5.6.3.cmml">0</mn></msub><mo id="S5.Ex3.m1.5.5.5" xref="S5.Ex3.m1.5.5.5.cmml">=</mo><mrow id="S5.Ex3.m1.5.5.4" xref="S5.Ex3.m1.5.5.4.cmml"><mrow id="S5.Ex3.m1.5.5.4.4.4" xref="S5.Ex3.m1.5.5.4.4.5.cmml"><mo id="S5.Ex3.m1.5.5.4.4.4.5" xref="S5.Ex3.m1.5.5.4.4.5.cmml">[</mo><msub id="S5.Ex3.m1.2.2.1.1.1.1" xref="S5.Ex3.m1.2.2.1.1.1.1.cmml"><mi id="S5.Ex3.m1.2.2.1.1.1.1.2" xref="S5.Ex3.m1.2.2.1.1.1.1.2.cmml">x</mi><mtext id="S5.Ex3.m1.2.2.1.1.1.1.3" xref="S5.Ex3.m1.2.2.1.1.1.1.3a.cmml">class </mtext></msub><mo id="S5.Ex3.m1.5.5.4.4.4.6" xref="S5.Ex3.m1.5.5.4.4.5.cmml">;</mo><mrow id="S5.Ex3.m1.3.3.2.2.2.2" xref="S5.Ex3.m1.3.3.2.2.2.2.cmml"><msubsup id="S5.Ex3.m1.3.3.2.2.2.2.2" xref="S5.Ex3.m1.3.3.2.2.2.2.2.cmml"><mi id="S5.Ex3.m1.3.3.2.2.2.2.2.2.2" xref="S5.Ex3.m1.3.3.2.2.2.2.2.2.2.cmml">x</mi><mi id="S5.Ex3.m1.3.3.2.2.2.2.2.2.3" xref="S5.Ex3.m1.3.3.2.2.2.2.2.2.3.cmml">p</mi><mn id="S5.Ex3.m1.3.3.2.2.2.2.2.3" xref="S5.Ex3.m1.3.3.2.2.2.2.2.3.cmml">1</mn></msubsup><mo lspace="0em" rspace="0em" id="S5.Ex3.m1.3.3.2.2.2.2.1" xref="S5.Ex3.m1.3.3.2.2.2.2.1.cmml">​</mo><mi id="S5.Ex3.m1.3.3.2.2.2.2.3" xref="S5.Ex3.m1.3.3.2.2.2.2.3.cmml">E</mi></mrow><mo id="S5.Ex3.m1.5.5.4.4.4.7" xref="S5.Ex3.m1.5.5.4.4.5.cmml">;</mo><mrow id="S5.Ex3.m1.4.4.3.3.3.3" xref="S5.Ex3.m1.4.4.3.3.3.3.cmml"><msubsup id="S5.Ex3.m1.4.4.3.3.3.3.2" xref="S5.Ex3.m1.4.4.3.3.3.3.2.cmml"><mi id="S5.Ex3.m1.4.4.3.3.3.3.2.2.2" xref="S5.Ex3.m1.4.4.3.3.3.3.2.2.2.cmml">x</mi><mi id="S5.Ex3.m1.4.4.3.3.3.3.2.2.3" xref="S5.Ex3.m1.4.4.3.3.3.3.2.2.3.cmml">p</mi><mn id="S5.Ex3.m1.4.4.3.3.3.3.2.3" xref="S5.Ex3.m1.4.4.3.3.3.3.2.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S5.Ex3.m1.4.4.3.3.3.3.1" xref="S5.Ex3.m1.4.4.3.3.3.3.1.cmml">​</mo><mi id="S5.Ex3.m1.4.4.3.3.3.3.3" xref="S5.Ex3.m1.4.4.3.3.3.3.3.cmml">E</mi></mrow><mo id="S5.Ex3.m1.5.5.4.4.4.8" xref="S5.Ex3.m1.5.5.4.4.5.cmml">;</mo><mi mathvariant="normal" id="S5.Ex3.m1.1.1" xref="S5.Ex3.m1.1.1.cmml">⋯</mi><mo id="S5.Ex3.m1.5.5.4.4.4.9" xref="S5.Ex3.m1.5.5.4.4.5.cmml">;</mo><mrow id="S5.Ex3.m1.5.5.4.4.4.4" xref="S5.Ex3.m1.5.5.4.4.4.4.cmml"><msubsup id="S5.Ex3.m1.5.5.4.4.4.4.2" xref="S5.Ex3.m1.5.5.4.4.4.4.2.cmml"><mi id="S5.Ex3.m1.5.5.4.4.4.4.2.2.2" xref="S5.Ex3.m1.5.5.4.4.4.4.2.2.2.cmml">x</mi><mi id="S5.Ex3.m1.5.5.4.4.4.4.2.2.3" xref="S5.Ex3.m1.5.5.4.4.4.4.2.2.3.cmml">p</mi><mi id="S5.Ex3.m1.5.5.4.4.4.4.2.3" xref="S5.Ex3.m1.5.5.4.4.4.4.2.3.cmml">N</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.Ex3.m1.5.5.4.4.4.4.1" xref="S5.Ex3.m1.5.5.4.4.4.4.1.cmml">​</mo><mi id="S5.Ex3.m1.5.5.4.4.4.4.3" xref="S5.Ex3.m1.5.5.4.4.4.4.3.cmml">E</mi></mrow><mo id="S5.Ex3.m1.5.5.4.4.4.10" xref="S5.Ex3.m1.5.5.4.4.5.cmml">]</mo></mrow><mo id="S5.Ex3.m1.5.5.4.5" xref="S5.Ex3.m1.5.5.4.5.cmml">+</mo><msub id="S5.Ex3.m1.5.5.4.6" xref="S5.Ex3.m1.5.5.4.6.cmml"><mi id="S5.Ex3.m1.5.5.4.6.2" xref="S5.Ex3.m1.5.5.4.6.2.cmml">E</mi><mtext id="S5.Ex3.m1.5.5.4.6.3" xref="S5.Ex3.m1.5.5.4.6.3a.cmml">pos</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex3.m1.5b"><apply id="S5.Ex3.m1.5.5.cmml" xref="S5.Ex3.m1.5.5"><eq id="S5.Ex3.m1.5.5.5.cmml" xref="S5.Ex3.m1.5.5.5"></eq><apply id="S5.Ex3.m1.5.5.6.cmml" xref="S5.Ex3.m1.5.5.6"><csymbol cd="ambiguous" id="S5.Ex3.m1.5.5.6.1.cmml" xref="S5.Ex3.m1.5.5.6">subscript</csymbol><ci id="S5.Ex3.m1.5.5.6.2.cmml" xref="S5.Ex3.m1.5.5.6.2">𝑧</ci><cn type="integer" id="S5.Ex3.m1.5.5.6.3.cmml" xref="S5.Ex3.m1.5.5.6.3">0</cn></apply><apply id="S5.Ex3.m1.5.5.4.cmml" xref="S5.Ex3.m1.5.5.4"><plus id="S5.Ex3.m1.5.5.4.5.cmml" xref="S5.Ex3.m1.5.5.4.5"></plus><list id="S5.Ex3.m1.5.5.4.4.5.cmml" xref="S5.Ex3.m1.5.5.4.4.4"><apply id="S5.Ex3.m1.2.2.1.1.1.1.cmml" xref="S5.Ex3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex3.m1.2.2.1.1.1.1.1.cmml" xref="S5.Ex3.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S5.Ex3.m1.2.2.1.1.1.1.2.cmml" xref="S5.Ex3.m1.2.2.1.1.1.1.2">𝑥</ci><ci id="S5.Ex3.m1.2.2.1.1.1.1.3a.cmml" xref="S5.Ex3.m1.2.2.1.1.1.1.3"><mtext mathsize="70%" id="S5.Ex3.m1.2.2.1.1.1.1.3.cmml" xref="S5.Ex3.m1.2.2.1.1.1.1.3">class </mtext></ci></apply><apply id="S5.Ex3.m1.3.3.2.2.2.2.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2"><times id="S5.Ex3.m1.3.3.2.2.2.2.1.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.1"></times><apply id="S5.Ex3.m1.3.3.2.2.2.2.2.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.3.3.2.2.2.2.2.1.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.2">superscript</csymbol><apply id="S5.Ex3.m1.3.3.2.2.2.2.2.2.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S5.Ex3.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.2.2.2">𝑥</ci><ci id="S5.Ex3.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.2.2.3">𝑝</ci></apply><cn type="integer" id="S5.Ex3.m1.3.3.2.2.2.2.2.3.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.2.3">1</cn></apply><ci id="S5.Ex3.m1.3.3.2.2.2.2.3.cmml" xref="S5.Ex3.m1.3.3.2.2.2.2.3">𝐸</ci></apply><apply id="S5.Ex3.m1.4.4.3.3.3.3.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3"><times id="S5.Ex3.m1.4.4.3.3.3.3.1.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.1"></times><apply id="S5.Ex3.m1.4.4.3.3.3.3.2.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.4.4.3.3.3.3.2.1.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.2">superscript</csymbol><apply id="S5.Ex3.m1.4.4.3.3.3.3.2.2.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.4.4.3.3.3.3.2.2.1.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.2">subscript</csymbol><ci id="S5.Ex3.m1.4.4.3.3.3.3.2.2.2.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.2.2.2">𝑥</ci><ci id="S5.Ex3.m1.4.4.3.3.3.3.2.2.3.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.2.2.3">𝑝</ci></apply><cn type="integer" id="S5.Ex3.m1.4.4.3.3.3.3.2.3.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.2.3">2</cn></apply><ci id="S5.Ex3.m1.4.4.3.3.3.3.3.cmml" xref="S5.Ex3.m1.4.4.3.3.3.3.3">𝐸</ci></apply><ci id="S5.Ex3.m1.1.1.cmml" xref="S5.Ex3.m1.1.1">⋯</ci><apply id="S5.Ex3.m1.5.5.4.4.4.4.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4"><times id="S5.Ex3.m1.5.5.4.4.4.4.1.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.1"></times><apply id="S5.Ex3.m1.5.5.4.4.4.4.2.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.5.5.4.4.4.4.2.1.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.2">superscript</csymbol><apply id="S5.Ex3.m1.5.5.4.4.4.4.2.2.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.5.5.4.4.4.4.2.2.1.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.2">subscript</csymbol><ci id="S5.Ex3.m1.5.5.4.4.4.4.2.2.2.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.2.2.2">𝑥</ci><ci id="S5.Ex3.m1.5.5.4.4.4.4.2.2.3.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.2.2.3">𝑝</ci></apply><ci id="S5.Ex3.m1.5.5.4.4.4.4.2.3.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.2.3">𝑁</ci></apply><ci id="S5.Ex3.m1.5.5.4.4.4.4.3.cmml" xref="S5.Ex3.m1.5.5.4.4.4.4.3">𝐸</ci></apply></list><apply id="S5.Ex3.m1.5.5.4.6.cmml" xref="S5.Ex3.m1.5.5.4.6"><csymbol cd="ambiguous" id="S5.Ex3.m1.5.5.4.6.1.cmml" xref="S5.Ex3.m1.5.5.4.6">subscript</csymbol><ci id="S5.Ex3.m1.5.5.4.6.2.cmml" xref="S5.Ex3.m1.5.5.4.6.2">𝐸</ci><ci id="S5.Ex3.m1.5.5.4.6.3a.cmml" xref="S5.Ex3.m1.5.5.4.6.3"><mtext mathsize="70%" id="S5.Ex3.m1.5.5.4.6.3.cmml" xref="S5.Ex3.m1.5.5.4.6.3">pos</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex3.m1.5c">z_{0}=\left[x_{\text{class }};{x}_{p}^{1}{E};{x}_{p}^{2}{E};\cdots;{x}_{p}^{N}{E}\right]+{E}_{\text{pos}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">For the Big Transfer (BiT) model, the scheme includes the first weight-standardized convolution <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> and its following max-pooling operation.
Notice that, for both models, we obfuscate either two learnable transformations or a non-invertible parametric transformation in the case of MaxPool <cite class="ltx_cite ltx_citemacro_citep">(Zeiler and Fergus, <a href="#bib.bib52" title="" class="ltx_ref">2014</a>)</cite>, so the attacker cannot retrieve the obfuscated quantities without uncertainty.
Table <a href="#S5.T1" title="Table 1 ‣ 5.1. Evaluation Metric and Ensemble Defense Setup ‣ 5. Evaluation ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> reports the estimated overheads of the shield for each setting.
The shielding of the ensemble requires up to 28.96 MB of TEE memory at worst, consistent with what typical TrustZone-enabled devices allow <cite class="ltx_cite ltx_citemacro_citep">(Amacher and Schiavoni, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>.</p>
<div id="S5.SS1.p3.2" class="ltx_logical-block">
<figure id="S5.T1" class="ltx_table ltx_align_center">
<table id="S5.T1.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T1.2.1" class="ltx_tr" style="background-color:#BFBFBF;">
<td id="S5.T1.2.1.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.1.1.1" class="ltx_text ltx_font_bold" style="background-color:#BFBFBF;">Model</span></td>
<td id="S5.T1.2.1.2" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.1.2.1" class="ltx_text ltx_font_bold" style="background-color:#BFBFBF;">Shielded portion</span></td>
<td id="S5.T1.2.1.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.1.3.1" class="ltx_text ltx_font_bold" style="background-color:#BFBFBF;">TEE mem. used</span></td>
</tr>
<tr id="S5.T1.2.2" class="ltx_tr" style="background-color:#FEFEFE;">
<td id="S5.T1.2.2.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.2.1.1" class="ltx_text" style="background-color:#FEFEFE;">ViT-L/16</span></td>
<td id="S5.T1.2.2.2" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.2.2.1" class="ltx_text" style="background-color:#FEFEFE;">0.350%</span></td>
<td id="S5.T1.2.2.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.2.3.1" class="ltx_text" style="background-color:#FEFEFE;">12.01 MB</span></td>
</tr>
<tr id="S5.T1.2.3" class="ltx_tr" style="background-color:#FFFFFF;">
<td id="S5.T1.2.3.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.3.1.1" class="ltx_text" style="background-color:#FFFFFF;">BiT-M-R101x3</span></td>
<td id="S5.T1.2.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.3.2.1" class="ltx_text" style="background-color:#FFFFFF;">0.004%</span></td>
<td id="S5.T1.2.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T1.2.3.3.1" class="ltx_text" style="background-color:#FFFFFF;">16.95 MB</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>. </span><span id="S5.T1.4.2" class="ltx_text" style="font-size:90%;">Estimated enclave memory cost and model portion shielded in each setting.
Values are shown for the worst case where intermediate activations and gradients inside the shield are not flushed after the back-propagation algorithm uses them.
The ensemble value sums both models in the worst case where enclaves are not flushed between evaluation of either of the two models.</span></figcaption>
</figure>
</div>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Attacker Setup</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.14" class="ltx_p">To circumvent the ensemble defense, the attacker uses a non-targeted gradient-sign attack: the Self-Attention Gradient Attack <cite class="ltx_cite ltx_citemacro_citep">(Mahmood et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>.
It iteratively crafts the adversarial example by following the sign of the gradient of the losses as follows:</p>
<table id="S5.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E2.m1.5" class="ltx_Math" alttext="x_{adv}^{(i+1)}=x_{adv}^{(i)}+\epsilon_{s}*\operatorname{sign}\left(G_{blend}\left(x_{adv}^{(i)}\right)\right)" display="block"><semantics id="S5.E2.m1.5a"><mrow id="S5.E2.m1.5.5" xref="S5.E2.m1.5.5.cmml"><msubsup id="S5.E2.m1.5.5.3" xref="S5.E2.m1.5.5.3.cmml"><mi id="S5.E2.m1.5.5.3.2.2" xref="S5.E2.m1.5.5.3.2.2.cmml">x</mi><mrow id="S5.E2.m1.5.5.3.2.3" xref="S5.E2.m1.5.5.3.2.3.cmml"><mi id="S5.E2.m1.5.5.3.2.3.2" xref="S5.E2.m1.5.5.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.3.2.3.1" xref="S5.E2.m1.5.5.3.2.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.3.2.3.3" xref="S5.E2.m1.5.5.3.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.3.2.3.1a" xref="S5.E2.m1.5.5.3.2.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.3.2.3.4" xref="S5.E2.m1.5.5.3.2.3.4.cmml">v</mi></mrow><mrow id="S5.E2.m1.1.1.1.1" xref="S5.E2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E2.m1.1.1.1.1.2" xref="S5.E2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E2.m1.1.1.1.1.1" xref="S5.E2.m1.1.1.1.1.1.cmml"><mi id="S5.E2.m1.1.1.1.1.1.2" xref="S5.E2.m1.1.1.1.1.1.2.cmml">i</mi><mo id="S5.E2.m1.1.1.1.1.1.1" xref="S5.E2.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S5.E2.m1.1.1.1.1.1.3" xref="S5.E2.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S5.E2.m1.1.1.1.1.3" xref="S5.E2.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S5.E2.m1.5.5.2" xref="S5.E2.m1.5.5.2.cmml">=</mo><mrow id="S5.E2.m1.5.5.1" xref="S5.E2.m1.5.5.1.cmml"><msubsup id="S5.E2.m1.5.5.1.3" xref="S5.E2.m1.5.5.1.3.cmml"><mi id="S5.E2.m1.5.5.1.3.2.2" xref="S5.E2.m1.5.5.1.3.2.2.cmml">x</mi><mrow id="S5.E2.m1.5.5.1.3.2.3" xref="S5.E2.m1.5.5.1.3.2.3.cmml"><mi id="S5.E2.m1.5.5.1.3.2.3.2" xref="S5.E2.m1.5.5.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.3.2.3.1" xref="S5.E2.m1.5.5.1.3.2.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.1.3.2.3.3" xref="S5.E2.m1.5.5.1.3.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.3.2.3.1a" xref="S5.E2.m1.5.5.1.3.2.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.1.3.2.3.4" xref="S5.E2.m1.5.5.1.3.2.3.4.cmml">v</mi></mrow><mrow id="S5.E2.m1.2.2.1.3" xref="S5.E2.m1.5.5.1.3.cmml"><mo stretchy="false" id="S5.E2.m1.2.2.1.3.1" xref="S5.E2.m1.5.5.1.3.cmml">(</mo><mi id="S5.E2.m1.2.2.1.1" xref="S5.E2.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S5.E2.m1.2.2.1.3.2" xref="S5.E2.m1.5.5.1.3.cmml">)</mo></mrow></msubsup><mo id="S5.E2.m1.5.5.1.2" xref="S5.E2.m1.5.5.1.2.cmml">+</mo><mrow id="S5.E2.m1.5.5.1.1" xref="S5.E2.m1.5.5.1.1.cmml"><msub id="S5.E2.m1.5.5.1.1.3" xref="S5.E2.m1.5.5.1.1.3.cmml"><mi id="S5.E2.m1.5.5.1.1.3.2" xref="S5.E2.m1.5.5.1.1.3.2.cmml">ϵ</mi><mi id="S5.E2.m1.5.5.1.1.3.3" xref="S5.E2.m1.5.5.1.1.3.3.cmml">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.E2.m1.5.5.1.1.2" xref="S5.E2.m1.5.5.1.1.2.cmml">∗</mo><mrow id="S5.E2.m1.5.5.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.2.cmml"><mi id="S5.E2.m1.4.4" xref="S5.E2.m1.4.4.cmml">sign</mi><mo id="S5.E2.m1.5.5.1.1.1.1a" xref="S5.E2.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S5.E2.m1.5.5.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.2.cmml"><mo id="S5.E2.m1.5.5.1.1.1.1.1.2" xref="S5.E2.m1.5.5.1.1.1.2.cmml">(</mo><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S5.E2.m1.5.5.1.1.1.1.1.1.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.3.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml">G</mi><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.cmml"><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1a" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.4" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1b" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.5" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1c" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.6" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.6.cmml">d</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.1.1.1.1.1.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.4" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.4.cmml">v</mi></mrow><mrow id="S5.E2.m1.3.3.1.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E2.m1.3.3.1.3.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S5.E2.m1.3.3.1.1" xref="S5.E2.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S5.E2.m1.3.3.1.3.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E2.m1.5.5.1.1.1.1.1.3" xref="S5.E2.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E2.m1.5b"><apply id="S5.E2.m1.5.5.cmml" xref="S5.E2.m1.5.5"><eq id="S5.E2.m1.5.5.2.cmml" xref="S5.E2.m1.5.5.2"></eq><apply id="S5.E2.m1.5.5.3.cmml" xref="S5.E2.m1.5.5.3"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.3.1.cmml" xref="S5.E2.m1.5.5.3">superscript</csymbol><apply id="S5.E2.m1.5.5.3.2.cmml" xref="S5.E2.m1.5.5.3"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.3.2.1.cmml" xref="S5.E2.m1.5.5.3">subscript</csymbol><ci id="S5.E2.m1.5.5.3.2.2.cmml" xref="S5.E2.m1.5.5.3.2.2">𝑥</ci><apply id="S5.E2.m1.5.5.3.2.3.cmml" xref="S5.E2.m1.5.5.3.2.3"><times id="S5.E2.m1.5.5.3.2.3.1.cmml" xref="S5.E2.m1.5.5.3.2.3.1"></times><ci id="S5.E2.m1.5.5.3.2.3.2.cmml" xref="S5.E2.m1.5.5.3.2.3.2">𝑎</ci><ci id="S5.E2.m1.5.5.3.2.3.3.cmml" xref="S5.E2.m1.5.5.3.2.3.3">𝑑</ci><ci id="S5.E2.m1.5.5.3.2.3.4.cmml" xref="S5.E2.m1.5.5.3.2.3.4">𝑣</ci></apply></apply><apply id="S5.E2.m1.1.1.1.1.1.cmml" xref="S5.E2.m1.1.1.1.1"><plus id="S5.E2.m1.1.1.1.1.1.1.cmml" xref="S5.E2.m1.1.1.1.1.1.1"></plus><ci id="S5.E2.m1.1.1.1.1.1.2.cmml" xref="S5.E2.m1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S5.E2.m1.1.1.1.1.1.3.cmml" xref="S5.E2.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S5.E2.m1.5.5.1.cmml" xref="S5.E2.m1.5.5.1"><plus id="S5.E2.m1.5.5.1.2.cmml" xref="S5.E2.m1.5.5.1.2"></plus><apply id="S5.E2.m1.5.5.1.3.cmml" xref="S5.E2.m1.5.5.1.3"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.1.3.1.cmml" xref="S5.E2.m1.5.5.1.3">superscript</csymbol><apply id="S5.E2.m1.5.5.1.3.2.cmml" xref="S5.E2.m1.5.5.1.3"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.1.3.2.1.cmml" xref="S5.E2.m1.5.5.1.3">subscript</csymbol><ci id="S5.E2.m1.5.5.1.3.2.2.cmml" xref="S5.E2.m1.5.5.1.3.2.2">𝑥</ci><apply id="S5.E2.m1.5.5.1.3.2.3.cmml" xref="S5.E2.m1.5.5.1.3.2.3"><times id="S5.E2.m1.5.5.1.3.2.3.1.cmml" xref="S5.E2.m1.5.5.1.3.2.3.1"></times><ci id="S5.E2.m1.5.5.1.3.2.3.2.cmml" xref="S5.E2.m1.5.5.1.3.2.3.2">𝑎</ci><ci id="S5.E2.m1.5.5.1.3.2.3.3.cmml" xref="S5.E2.m1.5.5.1.3.2.3.3">𝑑</ci><ci id="S5.E2.m1.5.5.1.3.2.3.4.cmml" xref="S5.E2.m1.5.5.1.3.2.3.4">𝑣</ci></apply></apply><ci id="S5.E2.m1.2.2.1.1.cmml" xref="S5.E2.m1.2.2.1.1">𝑖</ci></apply><apply id="S5.E2.m1.5.5.1.1.cmml" xref="S5.E2.m1.5.5.1.1"><times id="S5.E2.m1.5.5.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.2"></times><apply id="S5.E2.m1.5.5.1.1.3.cmml" xref="S5.E2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.1.1.3.1.cmml" xref="S5.E2.m1.5.5.1.1.3">subscript</csymbol><ci id="S5.E2.m1.5.5.1.1.3.2.cmml" xref="S5.E2.m1.5.5.1.1.3.2">italic-ϵ</ci><ci id="S5.E2.m1.5.5.1.1.3.3.cmml" xref="S5.E2.m1.5.5.1.1.3.3">𝑠</ci></apply><apply id="S5.E2.m1.5.5.1.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1"><ci id="S5.E2.m1.4.4.cmml" xref="S5.E2.m1.4.4">sign</ci><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1"><times id="S5.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.2"></times><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.2">𝐺</ci><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3"><times id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.1"></times><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.2">𝑏</ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.3.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.3">𝑙</ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.4.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.4">𝑒</ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.5.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.5">𝑛</ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.6.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.3.6">𝑑</ci></apply></apply><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3"><times id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2">𝑎</ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3">𝑑</ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.4">𝑣</ci></apply></apply><ci id="S5.E2.m1.3.3.1.1.cmml" xref="S5.E2.m1.3.3.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E2.m1.5c">x_{adv}^{(i+1)}=x_{adv}^{(i)}+\epsilon_{s}*\operatorname{sign}\left(G_{blend}\left(x_{adv}^{(i)}\right)\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S5.SS2.p1.3" class="ltx_p">where we initialize <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="x_{adv}^{(1)}=x" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.2" xref="S5.SS2.p1.1.m1.1.2.cmml"><msubsup id="S5.SS2.p1.1.m1.1.2.2" xref="S5.SS2.p1.1.m1.1.2.2.cmml"><mi id="S5.SS2.p1.1.m1.1.2.2.2.2" xref="S5.SS2.p1.1.m1.1.2.2.2.2.cmml">x</mi><mrow id="S5.SS2.p1.1.m1.1.2.2.2.3" xref="S5.SS2.p1.1.m1.1.2.2.2.3.cmml"><mi id="S5.SS2.p1.1.m1.1.2.2.2.3.2" xref="S5.SS2.p1.1.m1.1.2.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.1.m1.1.2.2.2.3.1" xref="S5.SS2.p1.1.m1.1.2.2.2.3.1.cmml">​</mo><mi id="S5.SS2.p1.1.m1.1.2.2.2.3.3" xref="S5.SS2.p1.1.m1.1.2.2.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.1.m1.1.2.2.2.3.1a" xref="S5.SS2.p1.1.m1.1.2.2.2.3.1.cmml">​</mo><mi id="S5.SS2.p1.1.m1.1.2.2.2.3.4" xref="S5.SS2.p1.1.m1.1.2.2.2.3.4.cmml">v</mi></mrow><mrow id="S5.SS2.p1.1.m1.1.1.1.3" xref="S5.SS2.p1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S5.SS2.p1.1.m1.1.1.1.3.1" xref="S5.SS2.p1.1.m1.1.2.2.cmml">(</mo><mn id="S5.SS2.p1.1.m1.1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.1.cmml">1</mn><mo stretchy="false" id="S5.SS2.p1.1.m1.1.1.1.3.2" xref="S5.SS2.p1.1.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S5.SS2.p1.1.m1.1.2.1" xref="S5.SS2.p1.1.m1.1.2.1.cmml">=</mo><mi id="S5.SS2.p1.1.m1.1.2.3" xref="S5.SS2.p1.1.m1.1.2.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.2"><eq id="S5.SS2.p1.1.m1.1.2.1.cmml" xref="S5.SS2.p1.1.m1.1.2.1"></eq><apply id="S5.SS2.p1.1.m1.1.2.2.cmml" xref="S5.SS2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.2.2.1.cmml" xref="S5.SS2.p1.1.m1.1.2.2">superscript</csymbol><apply id="S5.SS2.p1.1.m1.1.2.2.2.cmml" xref="S5.SS2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.2.2.2.1.cmml" xref="S5.SS2.p1.1.m1.1.2.2">subscript</csymbol><ci id="S5.SS2.p1.1.m1.1.2.2.2.2.cmml" xref="S5.SS2.p1.1.m1.1.2.2.2.2">𝑥</ci><apply id="S5.SS2.p1.1.m1.1.2.2.2.3.cmml" xref="S5.SS2.p1.1.m1.1.2.2.2.3"><times id="S5.SS2.p1.1.m1.1.2.2.2.3.1.cmml" xref="S5.SS2.p1.1.m1.1.2.2.2.3.1"></times><ci id="S5.SS2.p1.1.m1.1.2.2.2.3.2.cmml" xref="S5.SS2.p1.1.m1.1.2.2.2.3.2">𝑎</ci><ci id="S5.SS2.p1.1.m1.1.2.2.2.3.3.cmml" xref="S5.SS2.p1.1.m1.1.2.2.2.3.3">𝑑</ci><ci id="S5.SS2.p1.1.m1.1.2.2.2.3.4.cmml" xref="S5.SS2.p1.1.m1.1.2.2.2.3.4">𝑣</ci></apply></apply><cn type="integer" id="S5.SS2.p1.1.m1.1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1">1</cn></apply><ci id="S5.SS2.p1.1.m1.1.2.3.cmml" xref="S5.SS2.p1.1.m1.1.2.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">x_{adv}^{(1)}=x</annotation></semantics></math> the initial image and <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\epsilon_{{S}}=3.1\mathrm{e}{-3}" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><msub id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2.2" xref="S5.SS2.p1.2.m2.1.1.2.2.cmml">ϵ</mi><mi id="S5.SS2.p1.2.m2.1.1.2.3" xref="S5.SS2.p1.2.m2.1.1.2.3.cmml">S</mi></msub><mo id="S5.SS2.p1.2.m2.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml"><mrow id="S5.SS2.p1.2.m2.1.1.3.2" xref="S5.SS2.p1.2.m2.1.1.3.2.cmml"><mn id="S5.SS2.p1.2.m2.1.1.3.2.2" xref="S5.SS2.p1.2.m2.1.1.3.2.2.cmml">3.1</mn><mo lspace="0em" rspace="0em" id="S5.SS2.p1.2.m2.1.1.3.2.1" xref="S5.SS2.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS2.p1.2.m2.1.1.3.2.3" xref="S5.SS2.p1.2.m2.1.1.3.2.3.cmml">e</mi></mrow><mo id="S5.SS2.p1.2.m2.1.1.3.1" xref="S5.SS2.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S5.SS2.p1.2.m2.1.1.3.3" xref="S5.SS2.p1.2.m2.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><eq id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1"></eq><apply id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.2.1.cmml" xref="S5.SS2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.2.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2.2">italic-ϵ</ci><ci id="S5.SS2.p1.2.m2.1.1.2.3.cmml" xref="S5.SS2.p1.2.m2.1.1.2.3">𝑆</ci></apply><apply id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3"><minus id="S5.SS2.p1.2.m2.1.1.3.1.cmml" xref="S5.SS2.p1.2.m2.1.1.3.1"></minus><apply id="S5.SS2.p1.2.m2.1.1.3.2.cmml" xref="S5.SS2.p1.2.m2.1.1.3.2"><times id="S5.SS2.p1.2.m2.1.1.3.2.1.cmml" xref="S5.SS2.p1.2.m2.1.1.3.2.1"></times><cn type="float" id="S5.SS2.p1.2.m2.1.1.3.2.2.cmml" xref="S5.SS2.p1.2.m2.1.1.3.2.2">3.1</cn><ci id="S5.SS2.p1.2.m2.1.1.3.2.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3.2.3">e</ci></apply><cn type="integer" id="S5.SS2.p1.2.m2.1.1.3.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\epsilon_{{S}}=3.1\mathrm{e}{-3}</annotation></semantics></math> is a given set attack step size (chosen experimentally).
Additionally, <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="G_{blend}" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><msub id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mi id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">G</mi><mrow id="S5.SS2.p1.3.m3.1.1.3" xref="S5.SS2.p1.3.m3.1.1.3.cmml"><mi id="S5.SS2.p1.3.m3.1.1.3.2" xref="S5.SS2.p1.3.m3.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.3.m3.1.1.3.1" xref="S5.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p1.3.m3.1.1.3.3" xref="S5.SS2.p1.3.m3.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.3.m3.1.1.3.1a" xref="S5.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p1.3.m3.1.1.3.4" xref="S5.SS2.p1.3.m3.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.3.m3.1.1.3.1b" xref="S5.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p1.3.m3.1.1.3.5" xref="S5.SS2.p1.3.m3.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.3.m3.1.1.3.1c" xref="S5.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p1.3.m3.1.1.3.6" xref="S5.SS2.p1.3.m3.1.1.3.6.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.p1.3.m3.1.1.2.cmml" xref="S5.SS2.p1.3.m3.1.1.2">𝐺</ci><apply id="S5.SS2.p1.3.m3.1.1.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3"><times id="S5.SS2.p1.3.m3.1.1.3.1.cmml" xref="S5.SS2.p1.3.m3.1.1.3.1"></times><ci id="S5.SS2.p1.3.m3.1.1.3.2.cmml" xref="S5.SS2.p1.3.m3.1.1.3.2">𝑏</ci><ci id="S5.SS2.p1.3.m3.1.1.3.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3.3">𝑙</ci><ci id="S5.SS2.p1.3.m3.1.1.3.4.cmml" xref="S5.SS2.p1.3.m3.1.1.3.4">𝑒</ci><ci id="S5.SS2.p1.3.m3.1.1.3.5.cmml" xref="S5.SS2.p1.3.m3.1.1.3.5">𝑛</ci><ci id="S5.SS2.p1.3.m3.1.1.3.6.cmml" xref="S5.SS2.p1.3.m3.1.1.3.6">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">G_{blend}</annotation></semantics></math> is defined as a weighted sum, each of the two terms working towards computing an adversarial example against either one of the two models:</p>
<table id="S5.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E3.m1.4" class="ltx_Math" alttext="G_{blend}\left(x_{adv}^{(i)}\right)=\alpha_{k}\frac{\partial\mathcal{L}_{k}}{\partial x_{adv}^{(i)}}+\alpha_{v}\phi_{v}\odot\frac{\partial\mathcal{L}_{v}}{\partial x_{adv}^{(i)}}" display="block"><semantics id="S5.E3.m1.4a"><mrow id="S5.E3.m1.4.4" xref="S5.E3.m1.4.4.cmml"><mrow id="S5.E3.m1.4.4.1" xref="S5.E3.m1.4.4.1.cmml"><msub id="S5.E3.m1.4.4.1.3" xref="S5.E3.m1.4.4.1.3.cmml"><mi id="S5.E3.m1.4.4.1.3.2" xref="S5.E3.m1.4.4.1.3.2.cmml">G</mi><mrow id="S5.E3.m1.4.4.1.3.3" xref="S5.E3.m1.4.4.1.3.3.cmml"><mi id="S5.E3.m1.4.4.1.3.3.2" xref="S5.E3.m1.4.4.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.1.3.3.1" xref="S5.E3.m1.4.4.1.3.3.1.cmml">​</mo><mi id="S5.E3.m1.4.4.1.3.3.3" xref="S5.E3.m1.4.4.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.1.3.3.1a" xref="S5.E3.m1.4.4.1.3.3.1.cmml">​</mo><mi id="S5.E3.m1.4.4.1.3.3.4" xref="S5.E3.m1.4.4.1.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.1.3.3.1b" xref="S5.E3.m1.4.4.1.3.3.1.cmml">​</mo><mi id="S5.E3.m1.4.4.1.3.3.5" xref="S5.E3.m1.4.4.1.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.1.3.3.1c" xref="S5.E3.m1.4.4.1.3.3.1.cmml">​</mo><mi id="S5.E3.m1.4.4.1.3.3.6" xref="S5.E3.m1.4.4.1.3.3.6.cmml">d</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.1.2" xref="S5.E3.m1.4.4.1.2.cmml">​</mo><mrow id="S5.E3.m1.4.4.1.1.1" xref="S5.E3.m1.4.4.1.1.1.1.cmml"><mo id="S5.E3.m1.4.4.1.1.1.2" xref="S5.E3.m1.4.4.1.1.1.1.cmml">(</mo><msubsup id="S5.E3.m1.4.4.1.1.1.1" xref="S5.E3.m1.4.4.1.1.1.1.cmml"><mi id="S5.E3.m1.4.4.1.1.1.1.2.2" xref="S5.E3.m1.4.4.1.1.1.1.2.2.cmml">x</mi><mrow id="S5.E3.m1.4.4.1.1.1.1.2.3" xref="S5.E3.m1.4.4.1.1.1.1.2.3.cmml"><mi id="S5.E3.m1.4.4.1.1.1.1.2.3.2" xref="S5.E3.m1.4.4.1.1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.1.1.1.1.2.3.1" xref="S5.E3.m1.4.4.1.1.1.1.2.3.1.cmml">​</mo><mi id="S5.E3.m1.4.4.1.1.1.1.2.3.3" xref="S5.E3.m1.4.4.1.1.1.1.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.1.1.1.1.2.3.1a" xref="S5.E3.m1.4.4.1.1.1.1.2.3.1.cmml">​</mo><mi id="S5.E3.m1.4.4.1.1.1.1.2.3.4" xref="S5.E3.m1.4.4.1.1.1.1.2.3.4.cmml">v</mi></mrow><mrow id="S5.E3.m1.1.1.1.3" xref="S5.E3.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S5.E3.m1.1.1.1.3.1" xref="S5.E3.m1.4.4.1.1.1.1.cmml">(</mo><mi id="S5.E3.m1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S5.E3.m1.1.1.1.3.2" xref="S5.E3.m1.4.4.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S5.E3.m1.4.4.1.1.1.3" xref="S5.E3.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E3.m1.4.4.2" xref="S5.E3.m1.4.4.2.cmml">=</mo><mrow id="S5.E3.m1.4.4.3" xref="S5.E3.m1.4.4.3.cmml"><mrow id="S5.E3.m1.4.4.3.2" xref="S5.E3.m1.4.4.3.2.cmml"><msub id="S5.E3.m1.4.4.3.2.2" xref="S5.E3.m1.4.4.3.2.2.cmml"><mi id="S5.E3.m1.4.4.3.2.2.2" xref="S5.E3.m1.4.4.3.2.2.2.cmml">α</mi><mi id="S5.E3.m1.4.4.3.2.2.3" xref="S5.E3.m1.4.4.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.3.2.1" xref="S5.E3.m1.4.4.3.2.1.cmml">​</mo><mfrac id="S5.E3.m1.2.2" xref="S5.E3.m1.2.2.cmml"><mrow id="S5.E3.m1.2.2.3" xref="S5.E3.m1.2.2.3.cmml"><mo rspace="0em" id="S5.E3.m1.2.2.3.1" xref="S5.E3.m1.2.2.3.1.cmml">∂</mo><msub id="S5.E3.m1.2.2.3.2" xref="S5.E3.m1.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E3.m1.2.2.3.2.2" xref="S5.E3.m1.2.2.3.2.2.cmml">ℒ</mi><mi id="S5.E3.m1.2.2.3.2.3" xref="S5.E3.m1.2.2.3.2.3.cmml">k</mi></msub></mrow><mrow id="S5.E3.m1.2.2.1" xref="S5.E3.m1.2.2.1.cmml"><mo rspace="0em" id="S5.E3.m1.2.2.1.2" xref="S5.E3.m1.2.2.1.2.cmml">∂</mo><msubsup id="S5.E3.m1.2.2.1.3" xref="S5.E3.m1.2.2.1.3.cmml"><mi id="S5.E3.m1.2.2.1.3.2.2" xref="S5.E3.m1.2.2.1.3.2.2.cmml">x</mi><mrow id="S5.E3.m1.2.2.1.3.2.3" xref="S5.E3.m1.2.2.1.3.2.3.cmml"><mi id="S5.E3.m1.2.2.1.3.2.3.2" xref="S5.E3.m1.2.2.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.2.2.1.3.2.3.1" xref="S5.E3.m1.2.2.1.3.2.3.1.cmml">​</mo><mi id="S5.E3.m1.2.2.1.3.2.3.3" xref="S5.E3.m1.2.2.1.3.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.2.2.1.3.2.3.1a" xref="S5.E3.m1.2.2.1.3.2.3.1.cmml">​</mo><mi id="S5.E3.m1.2.2.1.3.2.3.4" xref="S5.E3.m1.2.2.1.3.2.3.4.cmml">v</mi></mrow><mrow id="S5.E3.m1.2.2.1.1.1.3" xref="S5.E3.m1.2.2.1.3.cmml"><mo stretchy="false" id="S5.E3.m1.2.2.1.1.1.3.1" xref="S5.E3.m1.2.2.1.3.cmml">(</mo><mi id="S5.E3.m1.2.2.1.1.1.1" xref="S5.E3.m1.2.2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S5.E3.m1.2.2.1.1.1.3.2" xref="S5.E3.m1.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mrow><mo id="S5.E3.m1.4.4.3.1" xref="S5.E3.m1.4.4.3.1.cmml">+</mo><mrow id="S5.E3.m1.4.4.3.3" xref="S5.E3.m1.4.4.3.3.cmml"><mrow id="S5.E3.m1.4.4.3.3.2" xref="S5.E3.m1.4.4.3.3.2.cmml"><msub id="S5.E3.m1.4.4.3.3.2.2" xref="S5.E3.m1.4.4.3.3.2.2.cmml"><mi id="S5.E3.m1.4.4.3.3.2.2.2" xref="S5.E3.m1.4.4.3.3.2.2.2.cmml">α</mi><mi id="S5.E3.m1.4.4.3.3.2.2.3" xref="S5.E3.m1.4.4.3.3.2.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S5.E3.m1.4.4.3.3.2.1" xref="S5.E3.m1.4.4.3.3.2.1.cmml">​</mo><msub id="S5.E3.m1.4.4.3.3.2.3" xref="S5.E3.m1.4.4.3.3.2.3.cmml"><mi id="S5.E3.m1.4.4.3.3.2.3.2" xref="S5.E3.m1.4.4.3.3.2.3.2.cmml">ϕ</mi><mi id="S5.E3.m1.4.4.3.3.2.3.3" xref="S5.E3.m1.4.4.3.3.2.3.3.cmml">v</mi></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="S5.E3.m1.4.4.3.3.1" xref="S5.E3.m1.4.4.3.3.1.cmml">⊙</mo><mfrac id="S5.E3.m1.3.3" xref="S5.E3.m1.3.3.cmml"><mrow id="S5.E3.m1.3.3.3" xref="S5.E3.m1.3.3.3.cmml"><mo rspace="0em" id="S5.E3.m1.3.3.3.1" xref="S5.E3.m1.3.3.3.1.cmml">∂</mo><msub id="S5.E3.m1.3.3.3.2" xref="S5.E3.m1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E3.m1.3.3.3.2.2" xref="S5.E3.m1.3.3.3.2.2.cmml">ℒ</mi><mi id="S5.E3.m1.3.3.3.2.3" xref="S5.E3.m1.3.3.3.2.3.cmml">v</mi></msub></mrow><mrow id="S5.E3.m1.3.3.1" xref="S5.E3.m1.3.3.1.cmml"><mo rspace="0em" id="S5.E3.m1.3.3.1.2" xref="S5.E3.m1.3.3.1.2.cmml">∂</mo><msubsup id="S5.E3.m1.3.3.1.3" xref="S5.E3.m1.3.3.1.3.cmml"><mi id="S5.E3.m1.3.3.1.3.2.2" xref="S5.E3.m1.3.3.1.3.2.2.cmml">x</mi><mrow id="S5.E3.m1.3.3.1.3.2.3" xref="S5.E3.m1.3.3.1.3.2.3.cmml"><mi id="S5.E3.m1.3.3.1.3.2.3.2" xref="S5.E3.m1.3.3.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.3.3.1.3.2.3.1" xref="S5.E3.m1.3.3.1.3.2.3.1.cmml">​</mo><mi id="S5.E3.m1.3.3.1.3.2.3.3" xref="S5.E3.m1.3.3.1.3.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.3.3.1.3.2.3.1a" xref="S5.E3.m1.3.3.1.3.2.3.1.cmml">​</mo><mi id="S5.E3.m1.3.3.1.3.2.3.4" xref="S5.E3.m1.3.3.1.3.2.3.4.cmml">v</mi></mrow><mrow id="S5.E3.m1.3.3.1.1.1.3" xref="S5.E3.m1.3.3.1.3.cmml"><mo stretchy="false" id="S5.E3.m1.3.3.1.1.1.3.1" xref="S5.E3.m1.3.3.1.3.cmml">(</mo><mi id="S5.E3.m1.3.3.1.1.1.1" xref="S5.E3.m1.3.3.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S5.E3.m1.3.3.1.1.1.3.2" xref="S5.E3.m1.3.3.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E3.m1.4b"><apply id="S5.E3.m1.4.4.cmml" xref="S5.E3.m1.4.4"><eq id="S5.E3.m1.4.4.2.cmml" xref="S5.E3.m1.4.4.2"></eq><apply id="S5.E3.m1.4.4.1.cmml" xref="S5.E3.m1.4.4.1"><times id="S5.E3.m1.4.4.1.2.cmml" xref="S5.E3.m1.4.4.1.2"></times><apply id="S5.E3.m1.4.4.1.3.cmml" xref="S5.E3.m1.4.4.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.4.4.1.3.1.cmml" xref="S5.E3.m1.4.4.1.3">subscript</csymbol><ci id="S5.E3.m1.4.4.1.3.2.cmml" xref="S5.E3.m1.4.4.1.3.2">𝐺</ci><apply id="S5.E3.m1.4.4.1.3.3.cmml" xref="S5.E3.m1.4.4.1.3.3"><times id="S5.E3.m1.4.4.1.3.3.1.cmml" xref="S5.E3.m1.4.4.1.3.3.1"></times><ci id="S5.E3.m1.4.4.1.3.3.2.cmml" xref="S5.E3.m1.4.4.1.3.3.2">𝑏</ci><ci id="S5.E3.m1.4.4.1.3.3.3.cmml" xref="S5.E3.m1.4.4.1.3.3.3">𝑙</ci><ci id="S5.E3.m1.4.4.1.3.3.4.cmml" xref="S5.E3.m1.4.4.1.3.3.4">𝑒</ci><ci id="S5.E3.m1.4.4.1.3.3.5.cmml" xref="S5.E3.m1.4.4.1.3.3.5">𝑛</ci><ci id="S5.E3.m1.4.4.1.3.3.6.cmml" xref="S5.E3.m1.4.4.1.3.3.6">𝑑</ci></apply></apply><apply id="S5.E3.m1.4.4.1.1.1.1.cmml" xref="S5.E3.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S5.E3.m1.4.4.1.1.1.1.1.cmml" xref="S5.E3.m1.4.4.1.1.1">superscript</csymbol><apply id="S5.E3.m1.4.4.1.1.1.1.2.cmml" xref="S5.E3.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S5.E3.m1.4.4.1.1.1.1.2.1.cmml" xref="S5.E3.m1.4.4.1.1.1">subscript</csymbol><ci id="S5.E3.m1.4.4.1.1.1.1.2.2.cmml" xref="S5.E3.m1.4.4.1.1.1.1.2.2">𝑥</ci><apply id="S5.E3.m1.4.4.1.1.1.1.2.3.cmml" xref="S5.E3.m1.4.4.1.1.1.1.2.3"><times id="S5.E3.m1.4.4.1.1.1.1.2.3.1.cmml" xref="S5.E3.m1.4.4.1.1.1.1.2.3.1"></times><ci id="S5.E3.m1.4.4.1.1.1.1.2.3.2.cmml" xref="S5.E3.m1.4.4.1.1.1.1.2.3.2">𝑎</ci><ci id="S5.E3.m1.4.4.1.1.1.1.2.3.3.cmml" xref="S5.E3.m1.4.4.1.1.1.1.2.3.3">𝑑</ci><ci id="S5.E3.m1.4.4.1.1.1.1.2.3.4.cmml" xref="S5.E3.m1.4.4.1.1.1.1.2.3.4">𝑣</ci></apply></apply><ci id="S5.E3.m1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1">𝑖</ci></apply></apply><apply id="S5.E3.m1.4.4.3.cmml" xref="S5.E3.m1.4.4.3"><plus id="S5.E3.m1.4.4.3.1.cmml" xref="S5.E3.m1.4.4.3.1"></plus><apply id="S5.E3.m1.4.4.3.2.cmml" xref="S5.E3.m1.4.4.3.2"><times id="S5.E3.m1.4.4.3.2.1.cmml" xref="S5.E3.m1.4.4.3.2.1"></times><apply id="S5.E3.m1.4.4.3.2.2.cmml" xref="S5.E3.m1.4.4.3.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.4.4.3.2.2.1.cmml" xref="S5.E3.m1.4.4.3.2.2">subscript</csymbol><ci id="S5.E3.m1.4.4.3.2.2.2.cmml" xref="S5.E3.m1.4.4.3.2.2.2">𝛼</ci><ci id="S5.E3.m1.4.4.3.2.2.3.cmml" xref="S5.E3.m1.4.4.3.2.2.3">𝑘</ci></apply><apply id="S5.E3.m1.2.2.cmml" xref="S5.E3.m1.2.2"><divide id="S5.E3.m1.2.2.2.cmml" xref="S5.E3.m1.2.2"></divide><apply id="S5.E3.m1.2.2.3.cmml" xref="S5.E3.m1.2.2.3"><partialdiff id="S5.E3.m1.2.2.3.1.cmml" xref="S5.E3.m1.2.2.3.1"></partialdiff><apply id="S5.E3.m1.2.2.3.2.cmml" xref="S5.E3.m1.2.2.3.2"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.3.2.1.cmml" xref="S5.E3.m1.2.2.3.2">subscript</csymbol><ci id="S5.E3.m1.2.2.3.2.2.cmml" xref="S5.E3.m1.2.2.3.2.2">ℒ</ci><ci id="S5.E3.m1.2.2.3.2.3.cmml" xref="S5.E3.m1.2.2.3.2.3">𝑘</ci></apply></apply><apply id="S5.E3.m1.2.2.1.cmml" xref="S5.E3.m1.2.2.1"><partialdiff id="S5.E3.m1.2.2.1.2.cmml" xref="S5.E3.m1.2.2.1.2"></partialdiff><apply id="S5.E3.m1.2.2.1.3.cmml" xref="S5.E3.m1.2.2.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.1.3.1.cmml" xref="S5.E3.m1.2.2.1.3">superscript</csymbol><apply id="S5.E3.m1.2.2.1.3.2.cmml" xref="S5.E3.m1.2.2.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.1.3.2.1.cmml" xref="S5.E3.m1.2.2.1.3">subscript</csymbol><ci id="S5.E3.m1.2.2.1.3.2.2.cmml" xref="S5.E3.m1.2.2.1.3.2.2">𝑥</ci><apply id="S5.E3.m1.2.2.1.3.2.3.cmml" xref="S5.E3.m1.2.2.1.3.2.3"><times id="S5.E3.m1.2.2.1.3.2.3.1.cmml" xref="S5.E3.m1.2.2.1.3.2.3.1"></times><ci id="S5.E3.m1.2.2.1.3.2.3.2.cmml" xref="S5.E3.m1.2.2.1.3.2.3.2">𝑎</ci><ci id="S5.E3.m1.2.2.1.3.2.3.3.cmml" xref="S5.E3.m1.2.2.1.3.2.3.3">𝑑</ci><ci id="S5.E3.m1.2.2.1.3.2.3.4.cmml" xref="S5.E3.m1.2.2.1.3.2.3.4">𝑣</ci></apply></apply><ci id="S5.E3.m1.2.2.1.1.1.1.cmml" xref="S5.E3.m1.2.2.1.1.1.1">𝑖</ci></apply></apply></apply></apply><apply id="S5.E3.m1.4.4.3.3.cmml" xref="S5.E3.m1.4.4.3.3"><csymbol cd="latexml" id="S5.E3.m1.4.4.3.3.1.cmml" xref="S5.E3.m1.4.4.3.3.1">direct-product</csymbol><apply id="S5.E3.m1.4.4.3.3.2.cmml" xref="S5.E3.m1.4.4.3.3.2"><times id="S5.E3.m1.4.4.3.3.2.1.cmml" xref="S5.E3.m1.4.4.3.3.2.1"></times><apply id="S5.E3.m1.4.4.3.3.2.2.cmml" xref="S5.E3.m1.4.4.3.3.2.2"><csymbol cd="ambiguous" id="S5.E3.m1.4.4.3.3.2.2.1.cmml" xref="S5.E3.m1.4.4.3.3.2.2">subscript</csymbol><ci id="S5.E3.m1.4.4.3.3.2.2.2.cmml" xref="S5.E3.m1.4.4.3.3.2.2.2">𝛼</ci><ci id="S5.E3.m1.4.4.3.3.2.2.3.cmml" xref="S5.E3.m1.4.4.3.3.2.2.3">𝑣</ci></apply><apply id="S5.E3.m1.4.4.3.3.2.3.cmml" xref="S5.E3.m1.4.4.3.3.2.3"><csymbol cd="ambiguous" id="S5.E3.m1.4.4.3.3.2.3.1.cmml" xref="S5.E3.m1.4.4.3.3.2.3">subscript</csymbol><ci id="S5.E3.m1.4.4.3.3.2.3.2.cmml" xref="S5.E3.m1.4.4.3.3.2.3.2">italic-ϕ</ci><ci id="S5.E3.m1.4.4.3.3.2.3.3.cmml" xref="S5.E3.m1.4.4.3.3.2.3.3">𝑣</ci></apply></apply><apply id="S5.E3.m1.3.3.cmml" xref="S5.E3.m1.3.3"><divide id="S5.E3.m1.3.3.2.cmml" xref="S5.E3.m1.3.3"></divide><apply id="S5.E3.m1.3.3.3.cmml" xref="S5.E3.m1.3.3.3"><partialdiff id="S5.E3.m1.3.3.3.1.cmml" xref="S5.E3.m1.3.3.3.1"></partialdiff><apply id="S5.E3.m1.3.3.3.2.cmml" xref="S5.E3.m1.3.3.3.2"><csymbol cd="ambiguous" id="S5.E3.m1.3.3.3.2.1.cmml" xref="S5.E3.m1.3.3.3.2">subscript</csymbol><ci id="S5.E3.m1.3.3.3.2.2.cmml" xref="S5.E3.m1.3.3.3.2.2">ℒ</ci><ci id="S5.E3.m1.3.3.3.2.3.cmml" xref="S5.E3.m1.3.3.3.2.3">𝑣</ci></apply></apply><apply id="S5.E3.m1.3.3.1.cmml" xref="S5.E3.m1.3.3.1"><partialdiff id="S5.E3.m1.3.3.1.2.cmml" xref="S5.E3.m1.3.3.1.2"></partialdiff><apply id="S5.E3.m1.3.3.1.3.cmml" xref="S5.E3.m1.3.3.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.3.3.1.3.1.cmml" xref="S5.E3.m1.3.3.1.3">superscript</csymbol><apply id="S5.E3.m1.3.3.1.3.2.cmml" xref="S5.E3.m1.3.3.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.3.3.1.3.2.1.cmml" xref="S5.E3.m1.3.3.1.3">subscript</csymbol><ci id="S5.E3.m1.3.3.1.3.2.2.cmml" xref="S5.E3.m1.3.3.1.3.2.2">𝑥</ci><apply id="S5.E3.m1.3.3.1.3.2.3.cmml" xref="S5.E3.m1.3.3.1.3.2.3"><times id="S5.E3.m1.3.3.1.3.2.3.1.cmml" xref="S5.E3.m1.3.3.1.3.2.3.1"></times><ci id="S5.E3.m1.3.3.1.3.2.3.2.cmml" xref="S5.E3.m1.3.3.1.3.2.3.2">𝑎</ci><ci id="S5.E3.m1.3.3.1.3.2.3.3.cmml" xref="S5.E3.m1.3.3.1.3.2.3.3">𝑑</ci><ci id="S5.E3.m1.3.3.1.3.2.3.4.cmml" xref="S5.E3.m1.3.3.1.3.2.3.4">𝑣</ci></apply></apply><ci id="S5.E3.m1.3.3.1.1.1.1.cmml" xref="S5.E3.m1.3.3.1.1.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E3.m1.4c">G_{blend}\left(x_{adv}^{(i)}\right)=\alpha_{k}\frac{\partial\mathcal{L}_{k}}{\partial x_{adv}^{(i)}}+\alpha_{v}\phi_{v}\odot\frac{\partial\mathcal{L}_{v}}{\partial x_{adv}^{(i)}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S5.SS2.p1.8" class="ltx_p"><math id="S5.SS2.p1.4.m1.1" class="ltx_Math" alttext="\partial\mathcal{L}_{k}/\partial x_{adv}^{(i)}" display="inline"><semantics id="S5.SS2.p1.4.m1.1a"><mrow id="S5.SS2.p1.4.m1.1.2" xref="S5.SS2.p1.4.m1.1.2.cmml"><mo rspace="0em" id="S5.SS2.p1.4.m1.1.2.1" xref="S5.SS2.p1.4.m1.1.2.1.cmml">∂</mo><mrow id="S5.SS2.p1.4.m1.1.2.2" xref="S5.SS2.p1.4.m1.1.2.2.cmml"><msub id="S5.SS2.p1.4.m1.1.2.2.2" xref="S5.SS2.p1.4.m1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p1.4.m1.1.2.2.2.2" xref="S5.SS2.p1.4.m1.1.2.2.2.2.cmml">ℒ</mi><mi id="S5.SS2.p1.4.m1.1.2.2.2.3" xref="S5.SS2.p1.4.m1.1.2.2.2.3.cmml">k</mi></msub><mo id="S5.SS2.p1.4.m1.1.2.2.1" xref="S5.SS2.p1.4.m1.1.2.2.1.cmml">/</mo><mrow id="S5.SS2.p1.4.m1.1.2.2.3" xref="S5.SS2.p1.4.m1.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S5.SS2.p1.4.m1.1.2.2.3.1" xref="S5.SS2.p1.4.m1.1.2.2.3.1.cmml">∂</mo><msubsup id="S5.SS2.p1.4.m1.1.2.2.3.2" xref="S5.SS2.p1.4.m1.1.2.2.3.2.cmml"><mi id="S5.SS2.p1.4.m1.1.2.2.3.2.2.2" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.2.cmml">x</mi><mrow id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.cmml"><mi id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.2" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.1" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.1.cmml">​</mo><mi id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.3" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.1a" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.1.cmml">​</mo><mi id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.4" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.4.cmml">v</mi></mrow><mrow id="S5.SS2.p1.4.m1.1.1.1.3" xref="S5.SS2.p1.4.m1.1.2.2.3.2.cmml"><mo stretchy="false" id="S5.SS2.p1.4.m1.1.1.1.3.1" xref="S5.SS2.p1.4.m1.1.2.2.3.2.cmml">(</mo><mi id="S5.SS2.p1.4.m1.1.1.1.1" xref="S5.SS2.p1.4.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S5.SS2.p1.4.m1.1.1.1.3.2" xref="S5.SS2.p1.4.m1.1.2.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m1.1b"><apply id="S5.SS2.p1.4.m1.1.2.cmml" xref="S5.SS2.p1.4.m1.1.2"><partialdiff id="S5.SS2.p1.4.m1.1.2.1.cmml" xref="S5.SS2.p1.4.m1.1.2.1"></partialdiff><apply id="S5.SS2.p1.4.m1.1.2.2.cmml" xref="S5.SS2.p1.4.m1.1.2.2"><divide id="S5.SS2.p1.4.m1.1.2.2.1.cmml" xref="S5.SS2.p1.4.m1.1.2.2.1"></divide><apply id="S5.SS2.p1.4.m1.1.2.2.2.cmml" xref="S5.SS2.p1.4.m1.1.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m1.1.2.2.2.1.cmml" xref="S5.SS2.p1.4.m1.1.2.2.2">subscript</csymbol><ci id="S5.SS2.p1.4.m1.1.2.2.2.2.cmml" xref="S5.SS2.p1.4.m1.1.2.2.2.2">ℒ</ci><ci id="S5.SS2.p1.4.m1.1.2.2.2.3.cmml" xref="S5.SS2.p1.4.m1.1.2.2.2.3">𝑘</ci></apply><apply id="S5.SS2.p1.4.m1.1.2.2.3.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3"><partialdiff id="S5.SS2.p1.4.m1.1.2.2.3.1.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.1"></partialdiff><apply id="S5.SS2.p1.4.m1.1.2.2.3.2.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m1.1.2.2.3.2.1.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2">superscript</csymbol><apply id="S5.SS2.p1.4.m1.1.2.2.3.2.2.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m1.1.2.2.3.2.2.1.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2">subscript</csymbol><ci id="S5.SS2.p1.4.m1.1.2.2.3.2.2.2.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.2">𝑥</ci><apply id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3"><times id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.1.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.1"></times><ci id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.2.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.2">𝑎</ci><ci id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.3.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.3">𝑑</ci><ci id="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.4.cmml" xref="S5.SS2.p1.4.m1.1.2.2.3.2.2.3.4">𝑣</ci></apply></apply><ci id="S5.SS2.p1.4.m1.1.1.1.1.cmml" xref="S5.SS2.p1.4.m1.1.1.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m1.1c">\partial\mathcal{L}_{k}/\partial x_{adv}^{(i)}</annotation></semantics></math> is the partial derivative of the loss of the CNN-based architecture BiT-M-R101x3, and <math id="S5.SS2.p1.5.m2.1" class="ltx_Math" alttext="\partial L_{v}/\partial x_{adv}^{(i)}" display="inline"><semantics id="S5.SS2.p1.5.m2.1a"><mrow id="S5.SS2.p1.5.m2.1.2" xref="S5.SS2.p1.5.m2.1.2.cmml"><mo rspace="0em" id="S5.SS2.p1.5.m2.1.2.1" xref="S5.SS2.p1.5.m2.1.2.1.cmml">∂</mo><mrow id="S5.SS2.p1.5.m2.1.2.2" xref="S5.SS2.p1.5.m2.1.2.2.cmml"><msub id="S5.SS2.p1.5.m2.1.2.2.2" xref="S5.SS2.p1.5.m2.1.2.2.2.cmml"><mi id="S5.SS2.p1.5.m2.1.2.2.2.2" xref="S5.SS2.p1.5.m2.1.2.2.2.2.cmml">L</mi><mi id="S5.SS2.p1.5.m2.1.2.2.2.3" xref="S5.SS2.p1.5.m2.1.2.2.2.3.cmml">v</mi></msub><mo id="S5.SS2.p1.5.m2.1.2.2.1" xref="S5.SS2.p1.5.m2.1.2.2.1.cmml">/</mo><mrow id="S5.SS2.p1.5.m2.1.2.2.3" xref="S5.SS2.p1.5.m2.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S5.SS2.p1.5.m2.1.2.2.3.1" xref="S5.SS2.p1.5.m2.1.2.2.3.1.cmml">∂</mo><msubsup id="S5.SS2.p1.5.m2.1.2.2.3.2" xref="S5.SS2.p1.5.m2.1.2.2.3.2.cmml"><mi id="S5.SS2.p1.5.m2.1.2.2.3.2.2.2" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.2.cmml">x</mi><mrow id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.cmml"><mi id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.2" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.1" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.1.cmml">​</mo><mi id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.3" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.1a" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.1.cmml">​</mo><mi id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.4" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.4.cmml">v</mi></mrow><mrow id="S5.SS2.p1.5.m2.1.1.1.3" xref="S5.SS2.p1.5.m2.1.2.2.3.2.cmml"><mo stretchy="false" id="S5.SS2.p1.5.m2.1.1.1.3.1" xref="S5.SS2.p1.5.m2.1.2.2.3.2.cmml">(</mo><mi id="S5.SS2.p1.5.m2.1.1.1.1" xref="S5.SS2.p1.5.m2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S5.SS2.p1.5.m2.1.1.1.3.2" xref="S5.SS2.p1.5.m2.1.2.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m2.1b"><apply id="S5.SS2.p1.5.m2.1.2.cmml" xref="S5.SS2.p1.5.m2.1.2"><partialdiff id="S5.SS2.p1.5.m2.1.2.1.cmml" xref="S5.SS2.p1.5.m2.1.2.1"></partialdiff><apply id="S5.SS2.p1.5.m2.1.2.2.cmml" xref="S5.SS2.p1.5.m2.1.2.2"><divide id="S5.SS2.p1.5.m2.1.2.2.1.cmml" xref="S5.SS2.p1.5.m2.1.2.2.1"></divide><apply id="S5.SS2.p1.5.m2.1.2.2.2.cmml" xref="S5.SS2.p1.5.m2.1.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.p1.5.m2.1.2.2.2.1.cmml" xref="S5.SS2.p1.5.m2.1.2.2.2">subscript</csymbol><ci id="S5.SS2.p1.5.m2.1.2.2.2.2.cmml" xref="S5.SS2.p1.5.m2.1.2.2.2.2">𝐿</ci><ci id="S5.SS2.p1.5.m2.1.2.2.2.3.cmml" xref="S5.SS2.p1.5.m2.1.2.2.2.3">𝑣</ci></apply><apply id="S5.SS2.p1.5.m2.1.2.2.3.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3"><partialdiff id="S5.SS2.p1.5.m2.1.2.2.3.1.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.1"></partialdiff><apply id="S5.SS2.p1.5.m2.1.2.2.3.2.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p1.5.m2.1.2.2.3.2.1.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2">superscript</csymbol><apply id="S5.SS2.p1.5.m2.1.2.2.3.2.2.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p1.5.m2.1.2.2.3.2.2.1.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2">subscript</csymbol><ci id="S5.SS2.p1.5.m2.1.2.2.3.2.2.2.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.2">𝑥</ci><apply id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3"><times id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.1.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.1"></times><ci id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.2.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.2">𝑎</ci><ci id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.3.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.3">𝑑</ci><ci id="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.4.cmml" xref="S5.SS2.p1.5.m2.1.2.2.3.2.2.3.4">𝑣</ci></apply></apply><ci id="S5.SS2.p1.5.m2.1.1.1.1.cmml" xref="S5.SS2.p1.5.m2.1.1.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m2.1c">\partial L_{v}/\partial x_{adv}^{(i)}</annotation></semantics></math> is the partial derivative of the loss of the Transformer-based architecture ViT-L/16.
Their prominence is controlled by the attacker through two manually set weighting factors, <math id="S5.SS2.p1.6.m3.1" class="ltx_Math" alttext="\alpha_{k}=2.0\mathrm{e}{-4}" display="inline"><semantics id="S5.SS2.p1.6.m3.1a"><mrow id="S5.SS2.p1.6.m3.1.1" xref="S5.SS2.p1.6.m3.1.1.cmml"><msub id="S5.SS2.p1.6.m3.1.1.2" xref="S5.SS2.p1.6.m3.1.1.2.cmml"><mi id="S5.SS2.p1.6.m3.1.1.2.2" xref="S5.SS2.p1.6.m3.1.1.2.2.cmml">α</mi><mi id="S5.SS2.p1.6.m3.1.1.2.3" xref="S5.SS2.p1.6.m3.1.1.2.3.cmml">k</mi></msub><mo id="S5.SS2.p1.6.m3.1.1.1" xref="S5.SS2.p1.6.m3.1.1.1.cmml">=</mo><mrow id="S5.SS2.p1.6.m3.1.1.3" xref="S5.SS2.p1.6.m3.1.1.3.cmml"><mrow id="S5.SS2.p1.6.m3.1.1.3.2" xref="S5.SS2.p1.6.m3.1.1.3.2.cmml"><mn id="S5.SS2.p1.6.m3.1.1.3.2.2" xref="S5.SS2.p1.6.m3.1.1.3.2.2.cmml">2.0</mn><mo lspace="0em" rspace="0em" id="S5.SS2.p1.6.m3.1.1.3.2.1" xref="S5.SS2.p1.6.m3.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS2.p1.6.m3.1.1.3.2.3" xref="S5.SS2.p1.6.m3.1.1.3.2.3.cmml">e</mi></mrow><mo id="S5.SS2.p1.6.m3.1.1.3.1" xref="S5.SS2.p1.6.m3.1.1.3.1.cmml">−</mo><mn id="S5.SS2.p1.6.m3.1.1.3.3" xref="S5.SS2.p1.6.m3.1.1.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m3.1b"><apply id="S5.SS2.p1.6.m3.1.1.cmml" xref="S5.SS2.p1.6.m3.1.1"><eq id="S5.SS2.p1.6.m3.1.1.1.cmml" xref="S5.SS2.p1.6.m3.1.1.1"></eq><apply id="S5.SS2.p1.6.m3.1.1.2.cmml" xref="S5.SS2.p1.6.m3.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p1.6.m3.1.1.2.1.cmml" xref="S5.SS2.p1.6.m3.1.1.2">subscript</csymbol><ci id="S5.SS2.p1.6.m3.1.1.2.2.cmml" xref="S5.SS2.p1.6.m3.1.1.2.2">𝛼</ci><ci id="S5.SS2.p1.6.m3.1.1.2.3.cmml" xref="S5.SS2.p1.6.m3.1.1.2.3">𝑘</ci></apply><apply id="S5.SS2.p1.6.m3.1.1.3.cmml" xref="S5.SS2.p1.6.m3.1.1.3"><minus id="S5.SS2.p1.6.m3.1.1.3.1.cmml" xref="S5.SS2.p1.6.m3.1.1.3.1"></minus><apply id="S5.SS2.p1.6.m3.1.1.3.2.cmml" xref="S5.SS2.p1.6.m3.1.1.3.2"><times id="S5.SS2.p1.6.m3.1.1.3.2.1.cmml" xref="S5.SS2.p1.6.m3.1.1.3.2.1"></times><cn type="float" id="S5.SS2.p1.6.m3.1.1.3.2.2.cmml" xref="S5.SS2.p1.6.m3.1.1.3.2.2">2.0</cn><ci id="S5.SS2.p1.6.m3.1.1.3.2.3.cmml" xref="S5.SS2.p1.6.m3.1.1.3.2.3">e</ci></apply><cn type="integer" id="S5.SS2.p1.6.m3.1.1.3.3.cmml" xref="S5.SS2.p1.6.m3.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m3.1c">\alpha_{k}=2.0\mathrm{e}{-4}</annotation></semantics></math> and <math id="S5.SS2.p1.7.m4.1" class="ltx_Math" alttext="\alpha_{v}=1-\alpha_{k}" display="inline"><semantics id="S5.SS2.p1.7.m4.1a"><mrow id="S5.SS2.p1.7.m4.1.1" xref="S5.SS2.p1.7.m4.1.1.cmml"><msub id="S5.SS2.p1.7.m4.1.1.2" xref="S5.SS2.p1.7.m4.1.1.2.cmml"><mi id="S5.SS2.p1.7.m4.1.1.2.2" xref="S5.SS2.p1.7.m4.1.1.2.2.cmml">α</mi><mi id="S5.SS2.p1.7.m4.1.1.2.3" xref="S5.SS2.p1.7.m4.1.1.2.3.cmml">v</mi></msub><mo id="S5.SS2.p1.7.m4.1.1.1" xref="S5.SS2.p1.7.m4.1.1.1.cmml">=</mo><mrow id="S5.SS2.p1.7.m4.1.1.3" xref="S5.SS2.p1.7.m4.1.1.3.cmml"><mn id="S5.SS2.p1.7.m4.1.1.3.2" xref="S5.SS2.p1.7.m4.1.1.3.2.cmml">1</mn><mo id="S5.SS2.p1.7.m4.1.1.3.1" xref="S5.SS2.p1.7.m4.1.1.3.1.cmml">−</mo><msub id="S5.SS2.p1.7.m4.1.1.3.3" xref="S5.SS2.p1.7.m4.1.1.3.3.cmml"><mi id="S5.SS2.p1.7.m4.1.1.3.3.2" xref="S5.SS2.p1.7.m4.1.1.3.3.2.cmml">α</mi><mi id="S5.SS2.p1.7.m4.1.1.3.3.3" xref="S5.SS2.p1.7.m4.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m4.1b"><apply id="S5.SS2.p1.7.m4.1.1.cmml" xref="S5.SS2.p1.7.m4.1.1"><eq id="S5.SS2.p1.7.m4.1.1.1.cmml" xref="S5.SS2.p1.7.m4.1.1.1"></eq><apply id="S5.SS2.p1.7.m4.1.1.2.cmml" xref="S5.SS2.p1.7.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p1.7.m4.1.1.2.1.cmml" xref="S5.SS2.p1.7.m4.1.1.2">subscript</csymbol><ci id="S5.SS2.p1.7.m4.1.1.2.2.cmml" xref="S5.SS2.p1.7.m4.1.1.2.2">𝛼</ci><ci id="S5.SS2.p1.7.m4.1.1.2.3.cmml" xref="S5.SS2.p1.7.m4.1.1.2.3">𝑣</ci></apply><apply id="S5.SS2.p1.7.m4.1.1.3.cmml" xref="S5.SS2.p1.7.m4.1.1.3"><minus id="S5.SS2.p1.7.m4.1.1.3.1.cmml" xref="S5.SS2.p1.7.m4.1.1.3.1"></minus><cn type="integer" id="S5.SS2.p1.7.m4.1.1.3.2.cmml" xref="S5.SS2.p1.7.m4.1.1.3.2">1</cn><apply id="S5.SS2.p1.7.m4.1.1.3.3.cmml" xref="S5.SS2.p1.7.m4.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS2.p1.7.m4.1.1.3.3.1.cmml" xref="S5.SS2.p1.7.m4.1.1.3.3">subscript</csymbol><ci id="S5.SS2.p1.7.m4.1.1.3.3.2.cmml" xref="S5.SS2.p1.7.m4.1.1.3.3.2">𝛼</ci><ci id="S5.SS2.p1.7.m4.1.1.3.3.3.cmml" xref="S5.SS2.p1.7.m4.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m4.1c">\alpha_{v}=1-\alpha_{k}</annotation></semantics></math>.
For the ViT gradient, an additional factor is involved: the self-attention map term <math id="S5.SS2.p1.8.m5.1" class="ltx_Math" alttext="\phi_{v}" display="inline"><semantics id="S5.SS2.p1.8.m5.1a"><msub id="S5.SS2.p1.8.m5.1.1" xref="S5.SS2.p1.8.m5.1.1.cmml"><mi id="S5.SS2.p1.8.m5.1.1.2" xref="S5.SS2.p1.8.m5.1.1.2.cmml">ϕ</mi><mi id="S5.SS2.p1.8.m5.1.1.3" xref="S5.SS2.p1.8.m5.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.8.m5.1b"><apply id="S5.SS2.p1.8.m5.1.1.cmml" xref="S5.SS2.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.8.m5.1.1.1.cmml" xref="S5.SS2.p1.8.m5.1.1">subscript</csymbol><ci id="S5.SS2.p1.8.m5.1.1.2.cmml" xref="S5.SS2.p1.8.m5.1.1.2">italic-ϕ</ci><ci id="S5.SS2.p1.8.m5.1.1.3.cmml" xref="S5.SS2.p1.8.m5.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.8.m5.1c">\phi_{v}</annotation></semantics></math>, defined by a sum-product:</p>
<table id="S5.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E4.m1.5" class="ltx_Math" alttext="\phi_{v}=\left(\prod_{l=1}^{n_{l}}\left[\sum_{i=1}^{n_{h}}\left(0.5W_{l,i}^{(att)}+0.5I\right)\right]\right)\odot x_{adv}^{(i)}" display="block"><semantics id="S5.E4.m1.5a"><mrow id="S5.E4.m1.5.5" xref="S5.E4.m1.5.5.cmml"><msub id="S5.E4.m1.5.5.3" xref="S5.E4.m1.5.5.3.cmml"><mi id="S5.E4.m1.5.5.3.2" xref="S5.E4.m1.5.5.3.2.cmml">ϕ</mi><mi id="S5.E4.m1.5.5.3.3" xref="S5.E4.m1.5.5.3.3.cmml">v</mi></msub><mo id="S5.E4.m1.5.5.2" xref="S5.E4.m1.5.5.2.cmml">=</mo><mrow id="S5.E4.m1.5.5.1" xref="S5.E4.m1.5.5.1.cmml"><mrow id="S5.E4.m1.5.5.1.1.1" xref="S5.E4.m1.5.5.1.1.1.1.cmml"><mo id="S5.E4.m1.5.5.1.1.1.2" xref="S5.E4.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S5.E4.m1.5.5.1.1.1.1" xref="S5.E4.m1.5.5.1.1.1.1.cmml"><munderover id="S5.E4.m1.5.5.1.1.1.1.2" xref="S5.E4.m1.5.5.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S5.E4.m1.5.5.1.1.1.1.2.2.2" xref="S5.E4.m1.5.5.1.1.1.1.2.2.2.cmml">∏</mo><mrow id="S5.E4.m1.5.5.1.1.1.1.2.2.3" xref="S5.E4.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S5.E4.m1.5.5.1.1.1.1.2.2.3.2" xref="S5.E4.m1.5.5.1.1.1.1.2.2.3.2.cmml">l</mi><mo id="S5.E4.m1.5.5.1.1.1.1.2.2.3.1" xref="S5.E4.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S5.E4.m1.5.5.1.1.1.1.2.2.3.3" xref="S5.E4.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S5.E4.m1.5.5.1.1.1.1.2.3" xref="S5.E4.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S5.E4.m1.5.5.1.1.1.1.2.3.2" xref="S5.E4.m1.5.5.1.1.1.1.2.3.2.cmml">n</mi><mi id="S5.E4.m1.5.5.1.1.1.1.2.3.3" xref="S5.E4.m1.5.5.1.1.1.1.2.3.3.cmml">l</mi></msub></munderover><mrow id="S5.E4.m1.5.5.1.1.1.1.1.1" xref="S5.E4.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S5.E4.m1.5.5.1.1.1.1.1.1.2" xref="S5.E4.m1.5.5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S5.E4.m1.5.5.1.1.1.1.1.1.1" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.cmml"><munderover id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.1" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.3" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.cmml"><mi id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mi id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.3" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.3.cmml">h</mi></msub></munderover><mrow id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml"><mn id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml">0.5</mn><mo lspace="0em" rspace="0em" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">W</mi><mrow id="S5.E4.m1.2.2.2.4" xref="S5.E4.m1.2.2.2.3.cmml"><mi id="S5.E4.m1.1.1.1.1" xref="S5.E4.m1.1.1.1.1.cmml">l</mi><mo id="S5.E4.m1.2.2.2.4.1" xref="S5.E4.m1.2.2.2.3.cmml">,</mo><mi id="S5.E4.m1.2.2.2.2" xref="S5.E4.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S5.E4.m1.3.3.1.1" xref="S5.E4.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S5.E4.m1.3.3.1.1.2" xref="S5.E4.m1.3.3.1.1.1.cmml">(</mo><mrow id="S5.E4.m1.3.3.1.1.1" xref="S5.E4.m1.3.3.1.1.1.cmml"><mi id="S5.E4.m1.3.3.1.1.1.2" xref="S5.E4.m1.3.3.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E4.m1.3.3.1.1.1.1" xref="S5.E4.m1.3.3.1.1.1.1.cmml">​</mo><mi id="S5.E4.m1.3.3.1.1.1.3" xref="S5.E4.m1.3.3.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E4.m1.3.3.1.1.1.1a" xref="S5.E4.m1.3.3.1.1.1.1.cmml">​</mo><mi id="S5.E4.m1.3.3.1.1.1.4" xref="S5.E4.m1.3.3.1.1.1.4.cmml">t</mi></mrow><mo stretchy="false" id="S5.E4.m1.3.3.1.1.3" xref="S5.E4.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml">0.5</mn><mo lspace="0em" rspace="0em" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml">I</mi></mrow></mrow><mo id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E4.m1.5.5.1.1.1.1.1.1.3" xref="S5.E4.m1.5.5.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo rspace="0.055em" id="S5.E4.m1.5.5.1.1.1.3" xref="S5.E4.m1.5.5.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S5.E4.m1.5.5.1.2" xref="S5.E4.m1.5.5.1.2.cmml">⊙</mo><msubsup id="S5.E4.m1.5.5.1.3" xref="S5.E4.m1.5.5.1.3.cmml"><mi id="S5.E4.m1.5.5.1.3.2.2" xref="S5.E4.m1.5.5.1.3.2.2.cmml">x</mi><mrow id="S5.E4.m1.5.5.1.3.2.3" xref="S5.E4.m1.5.5.1.3.2.3.cmml"><mi id="S5.E4.m1.5.5.1.3.2.3.2" xref="S5.E4.m1.5.5.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E4.m1.5.5.1.3.2.3.1" xref="S5.E4.m1.5.5.1.3.2.3.1.cmml">​</mo><mi id="S5.E4.m1.5.5.1.3.2.3.3" xref="S5.E4.m1.5.5.1.3.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E4.m1.5.5.1.3.2.3.1a" xref="S5.E4.m1.5.5.1.3.2.3.1.cmml">​</mo><mi id="S5.E4.m1.5.5.1.3.2.3.4" xref="S5.E4.m1.5.5.1.3.2.3.4.cmml">v</mi></mrow><mrow id="S5.E4.m1.4.4.1.3" xref="S5.E4.m1.5.5.1.3.cmml"><mo stretchy="false" id="S5.E4.m1.4.4.1.3.1" xref="S5.E4.m1.5.5.1.3.cmml">(</mo><mi id="S5.E4.m1.4.4.1.1" xref="S5.E4.m1.4.4.1.1.cmml">i</mi><mo stretchy="false" id="S5.E4.m1.4.4.1.3.2" xref="S5.E4.m1.5.5.1.3.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E4.m1.5b"><apply id="S5.E4.m1.5.5.cmml" xref="S5.E4.m1.5.5"><eq id="S5.E4.m1.5.5.2.cmml" xref="S5.E4.m1.5.5.2"></eq><apply id="S5.E4.m1.5.5.3.cmml" xref="S5.E4.m1.5.5.3"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.3.1.cmml" xref="S5.E4.m1.5.5.3">subscript</csymbol><ci id="S5.E4.m1.5.5.3.2.cmml" xref="S5.E4.m1.5.5.3.2">italic-ϕ</ci><ci id="S5.E4.m1.5.5.3.3.cmml" xref="S5.E4.m1.5.5.3.3">𝑣</ci></apply><apply id="S5.E4.m1.5.5.1.cmml" xref="S5.E4.m1.5.5.1"><csymbol cd="latexml" id="S5.E4.m1.5.5.1.2.cmml" xref="S5.E4.m1.5.5.1.2">direct-product</csymbol><apply id="S5.E4.m1.5.5.1.1.1.1.cmml" xref="S5.E4.m1.5.5.1.1.1"><apply id="S5.E4.m1.5.5.1.1.1.1.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.1.1.1.2.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S5.E4.m1.5.5.1.1.1.1.2.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S5.E4.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.2.2">product</csymbol><apply id="S5.E4.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.2.3"><eq id="S5.E4.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="S5.E4.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.2.3.2">𝑙</ci><cn type="integer" id="S5.E4.m1.5.5.1.1.1.1.2.2.3.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S5.E4.m1.5.5.1.1.1.1.2.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.3">subscript</csymbol><ci id="S5.E4.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.3.2">𝑛</ci><ci id="S5.E4.m1.5.5.1.1.1.1.2.3.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.2.3.3">𝑙</ci></apply></apply><apply id="S5.E4.m1.5.5.1.1.1.1.1.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E4.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1"><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3"><eq id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.2.3.3">ℎ</ci></apply></apply><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1"><plus id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"><times id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1"></times><cn type="float" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2">0.5</cn><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.2">𝑊</ci><list id="S5.E4.m1.2.2.2.3.cmml" xref="S5.E4.m1.2.2.2.4"><ci id="S5.E4.m1.1.1.1.1.cmml" xref="S5.E4.m1.1.1.1.1">𝑙</ci><ci id="S5.E4.m1.2.2.2.2.cmml" xref="S5.E4.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S5.E4.m1.3.3.1.1.1.cmml" xref="S5.E4.m1.3.3.1.1"><times id="S5.E4.m1.3.3.1.1.1.1.cmml" xref="S5.E4.m1.3.3.1.1.1.1"></times><ci id="S5.E4.m1.3.3.1.1.1.2.cmml" xref="S5.E4.m1.3.3.1.1.1.2">𝑎</ci><ci id="S5.E4.m1.3.3.1.1.1.3.cmml" xref="S5.E4.m1.3.3.1.1.1.3">𝑡</ci><ci id="S5.E4.m1.3.3.1.1.1.4.cmml" xref="S5.E4.m1.3.3.1.1.1.4">𝑡</ci></apply></apply></apply><apply id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3"><times id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1"></times><cn type="float" id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2">0.5</cn><ci id="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3">𝐼</ci></apply></apply></apply></apply></apply><apply id="S5.E4.m1.5.5.1.3.cmml" xref="S5.E4.m1.5.5.1.3"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.3.1.cmml" xref="S5.E4.m1.5.5.1.3">superscript</csymbol><apply id="S5.E4.m1.5.5.1.3.2.cmml" xref="S5.E4.m1.5.5.1.3"><csymbol cd="ambiguous" id="S5.E4.m1.5.5.1.3.2.1.cmml" xref="S5.E4.m1.5.5.1.3">subscript</csymbol><ci id="S5.E4.m1.5.5.1.3.2.2.cmml" xref="S5.E4.m1.5.5.1.3.2.2">𝑥</ci><apply id="S5.E4.m1.5.5.1.3.2.3.cmml" xref="S5.E4.m1.5.5.1.3.2.3"><times id="S5.E4.m1.5.5.1.3.2.3.1.cmml" xref="S5.E4.m1.5.5.1.3.2.3.1"></times><ci id="S5.E4.m1.5.5.1.3.2.3.2.cmml" xref="S5.E4.m1.5.5.1.3.2.3.2">𝑎</ci><ci id="S5.E4.m1.5.5.1.3.2.3.3.cmml" xref="S5.E4.m1.5.5.1.3.2.3.3">𝑑</ci><ci id="S5.E4.m1.5.5.1.3.2.3.4.cmml" xref="S5.E4.m1.5.5.1.3.2.3.4">𝑣</ci></apply></apply><ci id="S5.E4.m1.4.4.1.1.cmml" xref="S5.E4.m1.4.4.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E4.m1.5c">\phi_{v}=\left(\prod_{l=1}^{n_{l}}\left[\sum_{i=1}^{n_{h}}\left(0.5W_{l,i}^{(att)}+0.5I\right)\right]\right)\odot x_{adv}^{(i)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S5.SS2.p1.13" class="ltx_p">where <math id="S5.SS2.p1.9.m1.1" class="ltx_Math" alttext="n_{h}=16" display="inline"><semantics id="S5.SS2.p1.9.m1.1a"><mrow id="S5.SS2.p1.9.m1.1.1" xref="S5.SS2.p1.9.m1.1.1.cmml"><msub id="S5.SS2.p1.9.m1.1.1.2" xref="S5.SS2.p1.9.m1.1.1.2.cmml"><mi id="S5.SS2.p1.9.m1.1.1.2.2" xref="S5.SS2.p1.9.m1.1.1.2.2.cmml">n</mi><mi id="S5.SS2.p1.9.m1.1.1.2.3" xref="S5.SS2.p1.9.m1.1.1.2.3.cmml">h</mi></msub><mo id="S5.SS2.p1.9.m1.1.1.1" xref="S5.SS2.p1.9.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.p1.9.m1.1.1.3" xref="S5.SS2.p1.9.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.9.m1.1b"><apply id="S5.SS2.p1.9.m1.1.1.cmml" xref="S5.SS2.p1.9.m1.1.1"><eq id="S5.SS2.p1.9.m1.1.1.1.cmml" xref="S5.SS2.p1.9.m1.1.1.1"></eq><apply id="S5.SS2.p1.9.m1.1.1.2.cmml" xref="S5.SS2.p1.9.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p1.9.m1.1.1.2.1.cmml" xref="S5.SS2.p1.9.m1.1.1.2">subscript</csymbol><ci id="S5.SS2.p1.9.m1.1.1.2.2.cmml" xref="S5.SS2.p1.9.m1.1.1.2.2">𝑛</ci><ci id="S5.SS2.p1.9.m1.1.1.2.3.cmml" xref="S5.SS2.p1.9.m1.1.1.2.3">ℎ</ci></apply><cn type="integer" id="S5.SS2.p1.9.m1.1.1.3.cmml" xref="S5.SS2.p1.9.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.9.m1.1c">n_{h}=16</annotation></semantics></math> is the number of attention heads per encoder block of the ViT model, <math id="S5.SS2.p1.10.m2.1" class="ltx_Math" alttext="n_{l}=24" display="inline"><semantics id="S5.SS2.p1.10.m2.1a"><mrow id="S5.SS2.p1.10.m2.1.1" xref="S5.SS2.p1.10.m2.1.1.cmml"><msub id="S5.SS2.p1.10.m2.1.1.2" xref="S5.SS2.p1.10.m2.1.1.2.cmml"><mi id="S5.SS2.p1.10.m2.1.1.2.2" xref="S5.SS2.p1.10.m2.1.1.2.2.cmml">n</mi><mi id="S5.SS2.p1.10.m2.1.1.2.3" xref="S5.SS2.p1.10.m2.1.1.2.3.cmml">l</mi></msub><mo id="S5.SS2.p1.10.m2.1.1.1" xref="S5.SS2.p1.10.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p1.10.m2.1.1.3" xref="S5.SS2.p1.10.m2.1.1.3.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.10.m2.1b"><apply id="S5.SS2.p1.10.m2.1.1.cmml" xref="S5.SS2.p1.10.m2.1.1"><eq id="S5.SS2.p1.10.m2.1.1.1.cmml" xref="S5.SS2.p1.10.m2.1.1.1"></eq><apply id="S5.SS2.p1.10.m2.1.1.2.cmml" xref="S5.SS2.p1.10.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p1.10.m2.1.1.2.1.cmml" xref="S5.SS2.p1.10.m2.1.1.2">subscript</csymbol><ci id="S5.SS2.p1.10.m2.1.1.2.2.cmml" xref="S5.SS2.p1.10.m2.1.1.2.2">𝑛</ci><ci id="S5.SS2.p1.10.m2.1.1.2.3.cmml" xref="S5.SS2.p1.10.m2.1.1.2.3">𝑙</ci></apply><cn type="integer" id="S5.SS2.p1.10.m2.1.1.3.cmml" xref="S5.SS2.p1.10.m2.1.1.3">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.10.m2.1c">n_{l}=24</annotation></semantics></math> the number of encoder blocks in the ViT model, <math id="S5.SS2.p1.11.m3.3" class="ltx_Math" alttext="W_{l,i}^{(att)}" display="inline"><semantics id="S5.SS2.p1.11.m3.3a"><msubsup id="S5.SS2.p1.11.m3.3.4" xref="S5.SS2.p1.11.m3.3.4.cmml"><mi id="S5.SS2.p1.11.m3.3.4.2.2" xref="S5.SS2.p1.11.m3.3.4.2.2.cmml">W</mi><mrow id="S5.SS2.p1.11.m3.2.2.2.4" xref="S5.SS2.p1.11.m3.2.2.2.3.cmml"><mi id="S5.SS2.p1.11.m3.1.1.1.1" xref="S5.SS2.p1.11.m3.1.1.1.1.cmml">l</mi><mo id="S5.SS2.p1.11.m3.2.2.2.4.1" xref="S5.SS2.p1.11.m3.2.2.2.3.cmml">,</mo><mi id="S5.SS2.p1.11.m3.2.2.2.2" xref="S5.SS2.p1.11.m3.2.2.2.2.cmml">i</mi></mrow><mrow id="S5.SS2.p1.11.m3.3.3.1.1" xref="S5.SS2.p1.11.m3.3.3.1.1.1.cmml"><mo stretchy="false" id="S5.SS2.p1.11.m3.3.3.1.1.2" xref="S5.SS2.p1.11.m3.3.3.1.1.1.cmml">(</mo><mrow id="S5.SS2.p1.11.m3.3.3.1.1.1" xref="S5.SS2.p1.11.m3.3.3.1.1.1.cmml"><mi id="S5.SS2.p1.11.m3.3.3.1.1.1.2" xref="S5.SS2.p1.11.m3.3.3.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.11.m3.3.3.1.1.1.1" xref="S5.SS2.p1.11.m3.3.3.1.1.1.1.cmml">​</mo><mi id="S5.SS2.p1.11.m3.3.3.1.1.1.3" xref="S5.SS2.p1.11.m3.3.3.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.11.m3.3.3.1.1.1.1a" xref="S5.SS2.p1.11.m3.3.3.1.1.1.1.cmml">​</mo><mi id="S5.SS2.p1.11.m3.3.3.1.1.1.4" xref="S5.SS2.p1.11.m3.3.3.1.1.1.4.cmml">t</mi></mrow><mo stretchy="false" id="S5.SS2.p1.11.m3.3.3.1.1.3" xref="S5.SS2.p1.11.m3.3.3.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.11.m3.3b"><apply id="S5.SS2.p1.11.m3.3.4.cmml" xref="S5.SS2.p1.11.m3.3.4"><csymbol cd="ambiguous" id="S5.SS2.p1.11.m3.3.4.1.cmml" xref="S5.SS2.p1.11.m3.3.4">superscript</csymbol><apply id="S5.SS2.p1.11.m3.3.4.2.cmml" xref="S5.SS2.p1.11.m3.3.4"><csymbol cd="ambiguous" id="S5.SS2.p1.11.m3.3.4.2.1.cmml" xref="S5.SS2.p1.11.m3.3.4">subscript</csymbol><ci id="S5.SS2.p1.11.m3.3.4.2.2.cmml" xref="S5.SS2.p1.11.m3.3.4.2.2">𝑊</ci><list id="S5.SS2.p1.11.m3.2.2.2.3.cmml" xref="S5.SS2.p1.11.m3.2.2.2.4"><ci id="S5.SS2.p1.11.m3.1.1.1.1.cmml" xref="S5.SS2.p1.11.m3.1.1.1.1">𝑙</ci><ci id="S5.SS2.p1.11.m3.2.2.2.2.cmml" xref="S5.SS2.p1.11.m3.2.2.2.2">𝑖</ci></list></apply><apply id="S5.SS2.p1.11.m3.3.3.1.1.1.cmml" xref="S5.SS2.p1.11.m3.3.3.1.1"><times id="S5.SS2.p1.11.m3.3.3.1.1.1.1.cmml" xref="S5.SS2.p1.11.m3.3.3.1.1.1.1"></times><ci id="S5.SS2.p1.11.m3.3.3.1.1.1.2.cmml" xref="S5.SS2.p1.11.m3.3.3.1.1.1.2">𝑎</ci><ci id="S5.SS2.p1.11.m3.3.3.1.1.1.3.cmml" xref="S5.SS2.p1.11.m3.3.3.1.1.1.3">𝑡</ci><ci id="S5.SS2.p1.11.m3.3.3.1.1.1.4.cmml" xref="S5.SS2.p1.11.m3.3.3.1.1.1.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.11.m3.3c">W_{l,i}^{(att)}</annotation></semantics></math> is the attention weight matrix in each attention head and <math id="S5.SS2.p1.12.m4.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S5.SS2.p1.12.m4.1a"><mi id="S5.SS2.p1.12.m4.1.1" xref="S5.SS2.p1.12.m4.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.12.m4.1b"><ci id="S5.SS2.p1.12.m4.1.1.cmml" xref="S5.SS2.p1.12.m4.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.12.m4.1c">I</annotation></semantics></math> the identity matrix. <math id="S5.SS2.p1.13.m5.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S5.SS2.p1.13.m5.1a"><mo id="S5.SS2.p1.13.m5.1.1" xref="S5.SS2.p1.13.m5.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.13.m5.1b"><csymbol cd="latexml" id="S5.SS2.p1.13.m5.1.1.cmml" xref="S5.SS2.p1.13.m5.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.13.m5.1c">\odot</annotation></semantics></math> is the element wise product.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T2.4.1" class="ltx_tr">
<td id="S5.T2.4.1.1" class="ltx_td" style="padding-left:10.0pt;padding-right:10.0pt;"></td>
<td id="S5.T2.4.1.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="2"><span id="S5.T2.4.1.2.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFFF;">Baseline</span></td>
<td id="S5.T2.4.1.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="4"><span id="S5.T2.4.1.3.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFFF;">Applied Shield</span></td>
</tr>
<tr id="S5.T2.4.2" class="ltx_tr" style="background-color:#DFDFDF;">
<td id="S5.T2.4.2.1" class="ltx_td ltx_align_justify" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S5.T2.4.2.1.1" class="ltx_inline-block ltx_align_top" style="background-color:#DFDFDF;">
<span id="S5.T2.4.2.1.1.1" class="ltx_p"><span id="S5.T2.4.2.1.1.1.1" class="ltx_text ltx_font_bold">Model Acc.</span></span>
</span>
</td>
<td id="S5.T2.4.2.2" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.2.2.1" class="ltx_text ltx_font_bold" style="background-color:#DFDFDF;">Clean</span></td>
<td id="S5.T2.4.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.2.3.1" class="ltx_text ltx_font_bold" style="background-color:#F2F2F2;">Random</span></td>
<td id="S5.T2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.2.4.1" class="ltx_text ltx_font_bold" style="background-color:#DFDFDF;">None</span></td>
<td id="S5.T2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.2.5.1" class="ltx_text ltx_font_bold" style="background-color:#DFDFDF;">ViT-L/16</span></td>
<td id="S5.T2.4.2.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.2.6.1" class="ltx_text ltx_font_bold" style="background-color:#DFDFDF;">BiT-M-R101x3</span></td>
<td id="S5.T2.4.2.7" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.2.7.1" class="ltx_text ltx_font_bold" style="background-color:#DFDFDF;">Ensemble</span></td>
</tr>
<tr id="S5.T2.4.3" class="ltx_tr" style="background-color:#FEFEFE;">
<td id="S5.T2.4.3.1" class="ltx_td ltx_align_justify" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S5.T2.4.3.1.1" class="ltx_inline-block ltx_align_top" style="background-color:#FEFEFE;">
<span id="S5.T2.4.3.1.1.1" class="ltx_p">ViT-L/16</span>
</span>
</td>
<td id="S5.T2.4.3.2" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.3.2.1" class="ltx_text" style="background-color:#FEFEFE;">99.5%</span></td>
<td id="S5.T2.4.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.3.3.1" class="ltx_text" style="background-color:#FFFFFF;">99.5%</span></td>
<td id="S5.T2.4.3.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.3.4.1" class="ltx_text" style="background-color:#FEFEFE;">28.1%</span></td>
<td id="S5.T2.4.3.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.3.5.1" class="ltx_text" style="background-color:#FEFEFE;">99.2%</span></td>
<td id="S5.T2.4.3.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.3.6.1" class="ltx_text" style="background-color:#FEFEFE;">14.1%</span></td>
<td id="S5.T2.4.3.7" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.3.7.1" class="ltx_text" style="background-color:#FEFEFE;">99.5%</span></td>
</tr>
<tr id="S5.T2.4.4" class="ltx_tr" style="background-color:#F2F2F2;">
<td id="S5.T2.4.4.1" class="ltx_td ltx_align_justify" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S5.T2.4.4.1.1" class="ltx_inline-block ltx_align_top" style="background-color:#F2F2F2;">
<span id="S5.T2.4.4.1.1.1" class="ltx_p">BiT-M-R101x3</span>
</span>
</td>
<td id="S5.T2.4.4.2" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.4.2.1" class="ltx_text" style="background-color:#F2F2F2;">99.1%</span></td>
<td id="S5.T2.4.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.4.3.1" class="ltx_text" style="background-color:#F2F2F2;">98.8%</span></td>
<td id="S5.T2.4.4.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.4.4.1" class="ltx_text" style="background-color:#F2F2F2;">25.2%</span></td>
<td id="S5.T2.4.4.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.4.5.1" class="ltx_text" style="background-color:#F2F2F2;">0.3%</span></td>
<td id="S5.T2.4.4.6" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.4.6.1" class="ltx_text" style="background-color:#F2F2F2;">78.9%</span></td>
<td id="S5.T2.4.4.7" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.4.7.1" class="ltx_text" style="background-color:#F2F2F2;">98.5%</span></td>
</tr>
<tr id="S5.T2.4.5" class="ltx_tr" style="background-color:#FFFFFF;">
<td id="S5.T2.4.5.1" class="ltx_td ltx_align_justify ltx_border_b" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S5.T2.4.5.1.1" class="ltx_inline-block ltx_align_top" style="background-color:#FFFFFF;">
<span id="S5.T2.4.5.1.1.1" class="ltx_p">Ensemble</span>
</span>
</td>
<td id="S5.T2.4.5.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.5.2.1" class="ltx_text" style="background-color:#FFFFFF;">99.3%</span></td>
<td id="S5.T2.4.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.5.3.1" class="ltx_text" style="background-color:#FFFFFF;">98.9%</span></td>
<td id="S5.T2.4.5.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.5.4.1" class="ltx_text" style="background-color:#FFFFFF;">27.2%</span></td>
<td id="S5.T2.4.5.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.5.5.1" class="ltx_text" style="background-color:#FFFFFF;">49.7%</span></td>
<td id="S5.T2.4.5.6" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.5.6.1" class="ltx_text" style="background-color:#FFFFFF;">46.4%</span></td>
<td id="S5.T2.4.5.7" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S5.T2.4.5.7.1" class="ltx_text" style="background-color:#FFFFFF;">98.8%</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.5.2.1" class="ltx_text" style="font-size:90%;">Table 2</span>. </span><span id="S5.T2.2.1" class="ltx_text" style="font-size:90%;">Robust accuracy of a shielded ensemble against SAGA on CIFAR-10 (higher values favor the defender). Baseline values show clean accuracy, astuteness against random attack on the <math id="S5.T2.2.1.m1.1" class="ltx_Math" alttext="l_{\infty}" display="inline"><semantics id="S5.T2.2.1.m1.1b"><msub id="S5.T2.2.1.m1.1.1" xref="S5.T2.2.1.m1.1.1.cmml"><mi id="S5.T2.2.1.m1.1.1.2" xref="S5.T2.2.1.m1.1.1.2.cmml">l</mi><mi mathvariant="normal" id="S5.T2.2.1.m1.1.1.3" xref="S5.T2.2.1.m1.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T2.2.1.m1.1c"><apply id="S5.T2.2.1.m1.1.1.cmml" xref="S5.T2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.2.1.m1.1.1.1.cmml" xref="S5.T2.2.1.m1.1.1">subscript</csymbol><ci id="S5.T2.2.1.m1.1.1.2.cmml" xref="S5.T2.2.1.m1.1.1.2">𝑙</ci><infinity id="S5.T2.2.1.m1.1.1.3.cmml" xref="S5.T2.2.1.m1.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.1.m1.1d">l_{\infty}</annotation></semantics></math> ball. Applied Shield values show per-model robust accuracy against different shielding setups.</span></figcaption>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.2" class="ltx_p">Facing the <span id="S5.SS2.p2.2.1" class="ltx_text ltx_font_smallcaps">Pelta</span> shielded setting, the attacker carries out the SAGA without the masked set <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="\left\{\partial f/\partial{x}\right\}^{L}" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><msup id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mrow id="S5.SS2.p2.1.m1.1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.2.cmml"><mo id="S5.SS2.p2.1.m1.1.1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.1.2.cmml">{</mo><mrow id="S5.SS2.p2.1.m1.1.1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S5.SS2.p2.1.m1.1.1.1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.1.1.1.cmml">∂</mo><mrow id="S5.SS2.p2.1.m1.1.1.1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S5.SS2.p2.1.m1.1.1.1.1.1.2.2" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml">f</mi><mo id="S5.SS2.p2.1.m1.1.1.1.1.1.2.1" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.1.cmml">/</mo><mrow id="S5.SS2.p2.1.m1.1.1.1.1.1.2.3" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.1" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.1.cmml">∂</mo><mi id="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.2" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.2.cmml">x</mi></mrow></mrow></mrow><mo id="S5.SS2.p2.1.m1.1.1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.1.2.cmml">}</mo></mrow><mi id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1">superscript</csymbol><set id="S5.SS2.p2.1.m1.1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1"><apply id="S5.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1.1"><partialdiff id="S5.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1.1.1"></partialdiff><apply id="S5.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2"><divide id="S5.SS2.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.1"></divide><ci id="S5.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.2">𝑓</ci><apply id="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.3"><partialdiff id="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.1"></partialdiff><ci id="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1.1.2.3.2">𝑥</ci></apply></apply></apply></set><ci id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\left\{\partial f/\partial{x}\right\}^{L}</annotation></semantics></math> (and the adjacent quantities otherwise enabling its unambiguous reconstruction).
It tries to exploit the adjoint <math id="S5.SS2.p2.2.m2.1" class="ltx_Math" alttext="\delta_{L+1}" display="inline"><semantics id="S5.SS2.p2.2.m2.1a"><msub id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml"><mi id="S5.SS2.p2.2.m2.1.1.2" xref="S5.SS2.p2.2.m2.1.1.2.cmml">δ</mi><mrow id="S5.SS2.p2.2.m2.1.1.3" xref="S5.SS2.p2.2.m2.1.1.3.cmml"><mi id="S5.SS2.p2.2.m2.1.1.3.2" xref="S5.SS2.p2.2.m2.1.1.3.2.cmml">L</mi><mo id="S5.SS2.p2.2.m2.1.1.3.1" xref="S5.SS2.p2.2.m2.1.1.3.1.cmml">+</mo><mn id="S5.SS2.p2.2.m2.1.1.3.3" xref="S5.SS2.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.2.m2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p2.2.m2.1.1.2.cmml" xref="S5.SS2.p2.2.m2.1.1.2">𝛿</ci><apply id="S5.SS2.p2.2.m2.1.1.3.cmml" xref="S5.SS2.p2.2.m2.1.1.3"><plus id="S5.SS2.p2.2.m2.1.1.3.1.cmml" xref="S5.SS2.p2.2.m2.1.1.3.1"></plus><ci id="S5.SS2.p2.2.m2.1.1.3.2.cmml" xref="S5.SS2.p2.2.m2.1.1.3.2">𝐿</ci><cn type="integer" id="S5.SS2.p2.2.m2.1.1.3.3.cmml" xref="S5.SS2.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">\delta_{L+1}</annotation></semantics></math> of the last clear layer by applying to it a random-uniform initialized upsampling kernel.
This process, called <span id="S5.SS2.p2.2.2" class="ltx_text ltx_font_italic">transposed convolution</span> <cite class="ltx_cite ltx_citemacro_citep">(Dumoulin and Visin, <a href="#bib.bib18" title="" class="ltx_ref">2016</a>)</cite>, essentially is a geometrical transformation applied to the vector gradient at the backward pass of a convolutional layer.
Although this method does not offer any guarantee of convergence towards a successful adversarial example, it allows to understand whether the adjoint can still serve as a last resort when no priors on the shielded parts are available under limited resource constraint.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Benchmarks and initial results</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.2" class="ltx_p">We select 1000 random samples from CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky and Hinton, <a href="#bib.bib27" title="" class="ltx_ref">2009</a>)</cite>, and evaluate the average robust accuracy of individual models and their ensemble over 10 attacks in each of the settings involving either BiT model with shield, ViT model with shield, both or none.
For each attack, the attacker makes ten passes (<math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">i</mi><mo id="S5.SS3.p1.1.m1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><eq id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1"></eq><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝑖</ci><cn type="integer" id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">i=1</annotation></semantics></math><span id="S5.SS3.p1.2.1" class="ltx_text ltx_inline-block" style="width:8.0pt;">. . .</span><math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mn id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><cn type="integer" id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">10</annotation></semantics></math> in Eq. <a href="#S5.E2" title="Equation 2 ‣ 5.2. Attacker Setup ‣ 5. Evaluation ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) of his adversarial instance through the ensemble to update it.
Table <a href="#S5.T2" title="Table 2 ‣ 5.2. Attacker Setup ‣ 5. Evaluation ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows our results.
For illustrative purposes, Fig.<a href="#S5.F3" title="Figure 3 ‣ 5.3. Benchmarks and initial results ‣ 5. Evaluation ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the generated perturbation on one sample in the different shielding settings.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.2" class="ltx_p"><span id="S5.SS3.p2.2.1" class="ltx_text ltx_font_italic">Does <span id="S5.SS3.p2.2.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span> mitigate SAGA?</span>
We observe that the shielding greatly preserves the astuteness of individual models and of the ensemble, with <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="98.8\%" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mn id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">98.8</mn><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">98.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">98.8\%</annotation></semantics></math> robust accuracy (<math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="1.2\%" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mn id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">1.2</mn><mo id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">1.2\%</annotation></semantics></math> attack success rate).
However, individual model robust accuracies are not equally protected: ViT benefits more from <span id="S5.SS3.p2.2.2" class="ltx_text ltx_font_smallcaps">Pelta</span> when applied only to it than BiT.
We explain this result as a general advantage in robustness of Transformer-based architectures over CNNs <cite class="ltx_cite ltx_citemacro_citep">(Benz et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite> with BiT being more sensitive to targeted attacks than its counterpart, and also more sensitive to adversarial examples crafted against the ViT. We further note that individual robust accuracies worsen compared to the non-shielded setting when only their counterpart is shielded.
This is due to SAGA only moving the sample towards increasing the non-shielded loss at the expanse of its shielded counterpart, hence crafting adversarial samples that specifically target the non-shielded model.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.1" class="ltx_p"><span id="S5.SS3.p3.1.1" class="ltx_text ltx_font_italic">Does upsampling constitute a last resort for the attacker?</span> Interestingly, the attack success rate of the upsampling against the <span id="S5.SS3.p3.1.2" class="ltx_text ltx_font_smallcaps">Pelta</span> defense scheme surpasses that of the random attack against BiT when the shield is applied only to it.
We explain this behaviour as follows: contrary to the shielded layer in ViT that projects the input onto an embedding space, the last clear layer adjoint <math id="S5.SS3.p3.1.m1.1" class="ltx_Math" alttext="\delta_{L+1}" display="inline"><semantics id="S5.SS3.p3.1.m1.1a"><msub id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml"><mi id="S5.SS3.p3.1.m1.1.1.2" xref="S5.SS3.p3.1.m1.1.1.2.cmml">δ</mi><mrow id="S5.SS3.p3.1.m1.1.1.3" xref="S5.SS3.p3.1.m1.1.1.3.cmml"><mi id="S5.SS3.p3.1.m1.1.1.3.2" xref="S5.SS3.p3.1.m1.1.1.3.2.cmml">L</mi><mo id="S5.SS3.p3.1.m1.1.1.3.1" xref="S5.SS3.p3.1.m1.1.1.3.1.cmml">+</mo><mn id="S5.SS3.p3.1.m1.1.1.3.3" xref="S5.SS3.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><apply id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.1.m1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p3.1.m1.1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2">𝛿</ci><apply id="S5.SS3.p3.1.m1.1.1.3.cmml" xref="S5.SS3.p3.1.m1.1.1.3"><plus id="S5.SS3.p3.1.m1.1.1.3.1.cmml" xref="S5.SS3.p3.1.m1.1.1.3.1"></plus><ci id="S5.SS3.p3.1.m1.1.1.3.2.cmml" xref="S5.SS3.p3.1.m1.1.1.3.2">𝐿</ci><cn type="integer" id="S5.SS3.p3.1.m1.1.1.3.3.cmml" xref="S5.SS3.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">\delta_{L+1}</annotation></semantics></math> in the BiT still carries spatial information that could be recovered <span id="S5.SS3.p3.1.3" class="ltx_ERROR undefined">\eg</span>through average upsampling.
These results suggest shielding both models for optimal security, given sufficient encrypted memory available in a target TEE.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2308.04373/assets/x3.png" id="S5.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="182" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.3.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>. </span><span id="S5.F3.4.2" class="ltx_text" style="font-size:90%;">SAGA adversarial samples in four different shielding settings from an original sample. </span></figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion and Future Work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Adversarial attacks are difficult to defend against at inference time in FL, especially under white-box settings.
We described how to mitigate such attacks by using hardware obfuscation to sidestep the white-box. We introduce a novel defense, <span id="S6.p1.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span>: a lightweight shielding method which relies on TrustZone enclaves to mask few carefully chosen parameters and gradients against iterative gradient-based attacks.
Our evaluation shows promising results, sensibly mitigating the effectiveness of state of the art attacks.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">We intend to extend this work along the following directions.
Because the use of enclaves calls for somewhat costly normal-world to secure-world communication mechanisms, properly evaluating the speed of each collaborating device under our shielding scheme is needed on top of considering the aforementioned memory overheads (Table <a href="#S5.T1" title="Table 1 ‣ 5.1. Evaluation Metric and Ensemble Defense Setup ‣ 5. Evaluation ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) in order to assess the influence of <span id="S6.p2.1.1" class="ltx_text ltx_font_smallcaps">Pelta</span> on the FL training’s practical performance.
Additionally, a natural extension to this work is to apply <span id="S6.p2.1.2" class="ltx_text ltx_font_smallcaps">Pelta</span> against other popular attacks, such as in Carlini &amp; Wagner <cite class="ltx_cite ltx_citemacro_citep">(Carlini and Wagner, <a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite>. <span id="S6.p2.1.3" class="ltx_text ltx_font_smallcaps">Pelta</span> can also be extended to other gradient masking algorithms with backward approximation.
As mentioned in §<a href="#S4.SS3" title="4.3. Relation with BPDA ‣ 4. Design ‣ Pelta: Shielding Transformers to Mitigate Evasion Attacks in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, it should also be explored that an attacker can <em id="S6.p2.1.4" class="ltx_emph ltx_font_italic">(i)</em> exploit commonly used embedding matrices and subsequent parameters across existing models as a prior on the shielded layers (this case being circumvented by the defender if it trains its own first parameters) or <em id="S6.p2.1.5" class="ltx_emph ltx_font_italic">(ii)</em> to train on their own premises the aforementioned <math id="S6.p2.1.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S6.p2.1.m1.1a"><mi id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><ci id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">g</annotation></semantics></math> backward approximation (which needs not be of the same architecture as the shielded layers), although recent work shows limitation for such practice <cite class="ltx_cite ltx_citemacro_citep">(Sitawarin et al<span class="ltx_text">.</span>, <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aldahdooh et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Ahmed Aldahdooh, Wassim
Hamidouche, and Olivier Déforges.
2021.

</span>
<span class="ltx_bibblock">Reveal of Vision Transformers Robustness against
Adversarial Attacks.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2106.03734
(2021).

</span>
<span class="ltx_bibblock">arXiv:2106.03734

<a target="_blank" href="https://arxiv.org/abs/2106.03734" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2106.03734</a>

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amacher and Schiavoni (2019)</span>
<span class="ltx_bibblock">
Julien Amacher and
Valerio Schiavoni. 2019.

</span>
<span class="ltx_bibblock">On the performance of ARM TrustZone. In
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IFIP International Conference on Distributed
Applications and Interoperable Systems</em>. Springer,
133–151.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Athalye et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Anish Athalye, Nicholas
Carlini, and David A. Wagner.
2018.

</span>
<span class="ltx_bibblock">Obfuscated Gradients Give a False Sense of
Security: Circumventing Defenses to Adversarial Examples. In
<em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 35th International Conference on
Machine Learning, ICML 2018, Stockholmsmässan, Stockholm, Sweden, July
10-15, 2018.</em> 274–283.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="http://proceedings.mlr.press/v80/athalye18a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://proceedings.mlr.press/v80/athalye18a.html</a>

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Tao Bai, Jinqi Luo,
Jun Zhao, Bihan Wen, and
Qian Wang. 2021.

</span>
<span class="ltx_bibblock">Recent Advances in Adversarial Training for
Adversarial Robustness. In <em id="bib.bib5.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
Thirtieth International Joint Conference on Artificial Intelligence,
IJCAI-21</em>, Zhi-Hua Zhou (Ed.).
International Joint Conferences on Artificial
Intelligence Organization, 4312–4321.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.24963/ijcai.2021/591" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.24963/ijcai.2021/591</a>

</span>
<span class="ltx_bibblock">Survey Track.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Hangbo Bao, Li Dong,
Songhao Piao, and Furu Wei.
2022.

</span>
<span class="ltx_bibblock">BEiT: BERT Pre-Training of Image Transformers.
In <em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">The Tenth International Conference on Learning
Representations, ICLR 2022, Virtual Event, April 25-29, 2022</em>.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=p-BhZSz59o4" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=p-BhZSz59o4</a>

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Yoshua Bengio, Nicholas
Léonard, and Aaron C. Courville.
2018.

</span>
<span class="ltx_bibblock">Estimating or Propagating Gradients Through
Stochastic Neurons for Conditional Computation.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1308.3432
(Aug. 2018).

</span>
<span class="ltx_bibblock">arXiv:1308.3432

<a target="_blank" href="http://arxiv.org/abs/1308.3432" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1308.3432</a>

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Benkraouda and Nahrstedt (2021)</span>
<span class="ltx_bibblock">
Hadjer Benkraouda and
Klara Nahrstedt. 2021.

</span>
<span class="ltx_bibblock">Image Reconstruction Attacks on Distributed Machine
Learning Models. In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2nd ACM
International Workshop on Distributed Machine Learning</em> (Virtual Event,
Germany) <em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic">(DistributedML ’21)</em>.
Association for Computing Machinery,
New York, NY, USA, 29–35.

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1145/3488659.3493779" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3488659.3493779</a>

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Benz et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Philipp Benz, Chaoning
Zhang, Soomin Ham, Adil Karjauv, and
In So Kweon. 2021.

</span>
<span class="ltx_bibblock">Robustness Comparison of Vision Transformer and
MLP-Mixer to CNNs.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">Workshop on Adversarial Machine Learning in
Real-World Computer Vision Systems and Online Challenges (AML-CV) at CVPR</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biggio et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2013)</span>
<span class="ltx_bibblock">
Battista Biggio, Igino
Corona, Davide Maiorca, Blaine Nelson,
Nedim Šrndić, Pavel Laskov,
Giorgio Giacinto, and Fabio Roli.
2013.

</span>
<span class="ltx_bibblock">Evasion Attacks against Machine Learning at Test
Time. In <em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">Machine Learning and Knowledge Discovery
in Databases</em>, Hendrik Blockeel,
Kristian Kersting, Siegfried Nijssen,
and Filip Železný (Eds.).
Springer Berlin Heidelberg, Berlin,
Heidelberg, 387–402.

</span>
<span class="ltx_bibblock">

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann,
Nick Ryder, Melanie Subbiah,
Jared D Kaplan, Prafulla Dhariwal,
Arvind Neelakantan, Pranav Shyam,
Girish Sastry, Amanda Askell,
Sandhini Agarwal, Ariel Herbert-Voss,
Gretchen Krueger, Tom Henighan,
Rewon Child, Aditya Ramesh,
Daniel Ziegler, Jeffrey Wu,
Clemens Winter, Chris Hesse,
Mark Chen, Eric Sigler,
Mateusz Litwin, Scott Gray,
Benjamin Chess, Jack Clark,
Christopher Berner, Sam McCandlish,
Alec Radford, Ilya Sutskever, and
Dario Amodei. 2020.

</span>
<span class="ltx_bibblock">Language Models are Few-Shot Learners. In
<em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em>, H. Larochelle,
M. Ranzato, R. Hadsell,
M.F. Balcan, and H. Lin (Eds.),
Vol. 33. Curran Associates, Inc.,
1877–1901.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://proceedings.neurips.cc/paper/2020/file/1457c0d6bfcb4967418bfb8ac142f64a-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2020/file/1457c0d6bfcb4967418bfb8ac142f64a-Paper.pdf</a>

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini (2019)</span>
<span class="ltx_bibblock">
Nicholas Carlini.
2019.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">A Complete List of All (arXiv) Adversarial
Example Papers</em>.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://nicholas.carlini.com/writing/2019/all-adversarial-example-papers.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://nicholas.carlini.com/writing/2019/all-adversarial-example-papers.html</a>

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini and Wagner (2017)</span>
<span class="ltx_bibblock">
N. Carlini and D.
Wagner. 2017.

</span>
<span class="ltx_bibblock">Towards Evaluating the Robustness of Neural
Networks. In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">2017 IEEE Symposium on Security and
Privacy (SP)</em>. IEEE Computer Society,
Los Alamitos, CA, USA, 39–57.

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1109/SP.2017.49" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/SP.2017.49</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Yi Chang, Sofiane Laridi,
Zhao Ren, Gregory Palmer,
Björn W. Schuller, and Marco
Fisichella. 2022.

</span>
<span class="ltx_bibblock">Robust Federated Learning Against Adversarial Attacks
for Speech Emotion Recognition.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.48550/ARXIV.2203.04696" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/ARXIV.2203.04696</a>

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span id="bib.bib15.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Lin Chen, Yifei Min,
Mingrui Zhang, and Amin Karbasi.
2020.

</span>
<span class="ltx_bibblock">More Data Can Expand the Generalization Gap Between
Adversarially Robust and Standard Models. In <em id="bib.bib15.3.1" class="ltx_emph ltx_font_italic">8th
International Conference on Learning Representations, ICLR 2020, Addis Ababa,
Ethiopia, April 26-30, 2020</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clarysse et al<span id="bib.bib16.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Jacob Clarysse, Julia
Hörrmann, and Fanny Yang.
2022.

</span>
<span class="ltx_bibblock">Why adversarial training can hurt robust accuracy.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2203.02006
(2022).

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.48550/arXiv.2203.02006" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2203.02006</a>

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Costan and Devadas (2016)</span>
<span class="ltx_bibblock">
Victor Costan and
Srinivas Devadas. 2016.

</span>
<span class="ltx_bibblock">Intel SGX explained.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Cryptology ePrint Archive</em>
(2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dumoulin and Visin (2016)</span>
<span class="ltx_bibblock">
Vincent Dumoulin and
Francesco Visin. 2016.

</span>
<span class="ltx_bibblock">A guide to convolution arithmetic for deep
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ArXiv</em> abs/1603.07285
(March 2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al<span id="bib.bib19.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Ian J. Goodfellow,
Jonathon Shlens, and Christian
Szegedy. 2015.

</span>
<span class="ltx_bibblock">Explaining and Harnessing Adversarial Examples. In
<em id="bib.bib19.3.1" class="ltx_emph ltx_font_italic">3rd International Conference on Learning
Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference
Track Proceedings</em>, Yoshua Bengio and
Yann LeCun (Eds.).

</span>
<span class="ltx_bibblock">
<a target="_blank" href="http://arxiv.org/abs/1412.6572" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1412.6572</a>

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Zhongshu Gu, Heqing
Huang, Jialong Zhang, Dong Su,
Ankita Lamba, Dimitrios Pendarakis, and
Ian M. Molloy. 2018.

</span>
<span class="ltx_bibblock">Securing Input Data of Deep Learning Inference
Systems via Partitioned Enclave Execution.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1807.00969
(2018).

</span>
<span class="ltx_bibblock">arXiv:1807.00969

<a target="_blank" href="http://arxiv.org/abs/1807.00969" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1807.00969</a>

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzlik et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Lucjan Hanzlik, Yang
Zhang, Kathrin Grosse, Ahmed Salem,
Maximilian Augustin, Michael Backes,
and Mario Fritz. 2021.

</span>
<span class="ltx_bibblock">MLCapsule: Guarded Offline Deployment of Machine
Learning as a Service.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.3.1" class="ltx_emph ltx_font_italic">2021 IEEE/CVF Conference on Computer
Vision and Pattern Recognition Workshops (CVPRW)</em>.
IEEE, 3295–3304.

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1109/CVPRW53098.2021.00368" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/CVPRW53098.2021.00368</a>

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span id="bib.bib22.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu
Zhang, Shaoqing Ren, and Jian Sun.
2016.

</span>
<span class="ltx_bibblock">Identity Mappings in Deep Residual Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.3.1" class="ltx_emph ltx_font_italic">Computer Vision – ECCV
2016</em>. Springer, Cham, Switzerland,
630–645.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1007/978-3-319-46493-0_38" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1007/978-3-319-46493-0_38</a>

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan
McMahan, Brendan Avent, Aurélien
Bellet, Mehdi Bennis, Arjun Nitin
Bhagoji, Kallista Bonawitz, Zachary
Charles, Graham Cormode, Rachel
Cummings, et al<span id="bib.bib23.3.1" class="ltx_text">.</span> 2021.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.4.1" class="ltx_emph ltx_font_italic">Foundations and Trends in Machine Learning</em>
14, 1–2 (2021),
1–210.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kolesnikov et al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Alexander Kolesnikov,
Lucas Beyer, Xiaohua Zhai,
Joan Puigcerver, Jessica Yung,
Sylvain Gelly, and Neil Houlsby.
2020.

</span>
<span class="ltx_bibblock">Big Transfer (BiT): General Visual Representation
Learning. In <em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">Computer Vision – ECCV 2020</em>,
Andrea Vedaldi, Horst
Bischof, Thomas Brox, and Jan-Michael
Frahm (Eds.). Springer International Publishing,
Cham, 491–507.

</span>
<span class="ltx_bibblock">

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kolesnikov et al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Alexander Kolesnikov,
Alexey Dosovitskiy, Dirk Weissenborn,
Georg Heigold, Jakob Uszkoreit,
Lucas Beyer, Matthias Minderer,
Mostafa Dehghani, Neil Houlsby,
Sylvain Gelly, Thomas Unterthiner, and
Xiaohua Zhai. 2021.

</span>
<span class="ltx_bibblock">An Image is Worth 16x16 Words: Transformers for
Image Recognition at Scale. In <em id="bib.bib25.3.1" class="ltx_emph ltx_font_italic">9th International
Conference on Learning Representations, ICLR 2021, Virtual Event, Austria,
May 3-7, 2021</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečný et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Jakub Konečný,
H. Brendan McMahan, Felix X. Yu,
Peter Richtarik, Ananda Theertha Suresh,
and Dave Bacon. 2016.

</span>
<span class="ltx_bibblock">Federated Learning: Strategies for Improving
Communication Efficiency. In <em id="bib.bib26.3.1" class="ltx_emph ltx_font_italic">NIPS Workshop on
Private Multi-Party Machine Learning</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky and Hinton (2009)</span>
<span class="ltx_bibblock">
A. Krizhevsky and G.
Hinton. 2009.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny
images.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Master’s thesis, Department of Computer
Science, University of Toronto</em> (2009).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Pengrui Liu, Xiangrui Xu,
and Wei Wang. 2022.

</span>
<span class="ltx_bibblock">Threats, attacks and defenses to federated
learning: issues, taxonomy and perspectives.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.3.1" class="ltx_emph ltx_font_italic">Cybersecurity</em> 5,
1 (2022), 1–19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mahmood et al<span id="bib.bib29.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Kaleel Mahmood, Rigel
Mahmood, and Marten van Dijk.
2021.

</span>
<span class="ltx_bibblock">On the Robustness of Vision Transformers to
Adversarial Examples. In <em id="bib.bib29.3.1" class="ltx_emph ltx_font_italic">2021 IEEE/CVF
International Conference on Computer Vision (ICCV)</em>.
7818–7827.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1109/ICCV48922.2021.00774" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/ICCV48922.2021.00774</a>

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Messaoud et al<span id="bib.bib30.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Aghiles Ait Messaoud,
Sonia Ben Mokhtar, Vlad Nitu, and
Valerio Schiavoni. 2022.

</span>
<span class="ltx_bibblock">Shielding federated learning systems against
inference attacks with ARM TrustZone.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.3.1" class="ltx_emph ltx_font_italic">Middleware’22: Proceedings of the 23rd
ACM/IFIP International Middleware Conference</em>.
Association for Computing Machinery,
New York, NY, USA, 335–348.

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1145/3528535.3565255" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3528535.3565255</a>

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mo et al<span id="bib.bib31.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Fan Mo, Hamed Haddadi,
Kleomenis Katevas, Eduard Marin,
Diego Perino, and Nicolas Kourtellis.
2021.

</span>
<span class="ltx_bibblock">PPFL: Privacy-Preserving Federated Learning with
Trusted Execution Environments. In <em id="bib.bib31.3.1" class="ltx_emph ltx_font_italic">Proceedings of
the 19th Annual International Conference on Mobile Systems, Applications, and
Services</em> (Virtual Event, Wisconsin) <em id="bib.bib31.4.2" class="ltx_emph ltx_font_italic">(MobiSys ’21)</em>.
Association for Computing Machinery,
New York, NY, USA, 94–108.

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1145/3458864.3466628" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3458864.3466628</a>

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mo et al<span id="bib.bib32.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Fan Mo, Ali Shahin
Shamsabadi, Kleomenis Katevas, Soteris
Demetriou, Ilias Leontiadis, Andrea
Cavallaro, and Hamed Haddadi.
2020.

</span>
<span class="ltx_bibblock">DarkneTZ: Towards Model Privacy at the Edge Using
Trusted Execution Environments. In <em id="bib.bib32.3.1" class="ltx_emph ltx_font_italic">Proceedings of
the 18th International Conference on Mobile Systems, Applications, and
Services</em> (Toronto, Ontario, Canada) <em id="bib.bib32.4.2" class="ltx_emph ltx_font_italic">(MobiSys ’20)</em>.
Association for Computing Machinery,
New York, NY, USA, 161–174.

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1145/3386901.3388946" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3386901.3388946</a>

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ménétrey et al<span id="bib.bib33.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Jämes Ménétrey, Marcelo
Pasin, Pascal Felber, and Valerio
Schiavoni. 2022.

</span>
<span class="ltx_bibblock">WaTZ: A Trusted WebAssembly Runtime Environment
with Remote Attestation for TrustZone. In <em id="bib.bib33.3.1" class="ltx_emph ltx_font_italic">2022
IEEE 42nd International Conference on Distributed Computing Systems
(ICDCS)</em>. IEEE.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1109/ICDCS54860.2022.00116" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/ICDCS54860.2022.00116</a>

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nagrani et al<span id="bib.bib34.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Arsha Nagrani, Shan Yang,
Anurag Arnab, Aren Jansen,
Cordelia Schmid, and Chen Sun.
2021.

</span>
<span class="ltx_bibblock">Attention Bottlenecks for Multimodal Fusion. In
<em id="bib.bib34.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em>, M. Ranzato,
A. Beygelzimer, Y. Dauphin,
P.S. Liang, and J. Wortman Vaughan
(Eds.), Vol. 34. Curran Associates,
Inc., 14200–14213.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://proceedings.neurips.cc/paper/2021/file/76ba9f564ebbc35b1014ac498fafadd0-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2021/file/76ba9f564ebbc35b1014ac498fafadd0-Paper.pdf</a>

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nakkiran (2019)</span>
<span class="ltx_bibblock">
Preetum Nakkiran.
2019.

</span>
<span class="ltx_bibblock">Adversarial Robustness May Be at Odds With
Simplicity.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">ArXiv</em> abs/1901.00532
(Jan. 2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al<span id="bib.bib36.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Seong Joon Oh, Bernt
Schiele, and Mario Fritz.
2019.

</span>
<span class="ltx_bibblock">Towards Reverse-Engineering Black-Box Neural
Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.3.1" class="ltx_emph ltx_font_italic">Explainable AI: Interpreting,
Explaining and Visualizing Deep Learning</em>. Springer,
Cham, Switzerland, 121–144.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1007/978-3-030-28954-6_7" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1007/978-3-030-28954-6_7</a>

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al<span id="bib.bib37.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Zhuang Qian, Kaizhu
Huang, Qiu-Feng Wang, and Xu-Yao
Zhang. 2022.

</span>
<span class="ltx_bibblock">A survey of robust adversarial training in pattern
recognition: Fundamental, theory, and methodologies.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.3.1" class="ltx_emph ltx_font_italic">Pattern Recognit.</em> 131
(2022), 108889.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1016/j.patcog.2022.108889" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1016/j.patcog.2022.108889</a>

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al<span id="bib.bib38.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Han Qiu, Yi Zeng,
Qinkai Zheng, Shangwei Guo,
Tianwei Zhang, and Hewu Li.
2021.

</span>
<span class="ltx_bibblock">An Efficient Preprocessing-based Approach to
Mitigate Advanced Adversarial Attacks.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.3.1" class="ltx_emph ltx_font_italic">IEEE Trans. Comput.</em> (2021),
1–1.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1109/TC.2021.3076826" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/TC.2021.3076826</a>

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raganato and Tiedemann (2018)</span>
<span class="ltx_bibblock">
Alessandro Raganato and
Jörg Tiedemann. 2018.

</span>
<span class="ltx_bibblock">An analysis of encoder representations in
transformer-based machine translation. In
<em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2018 EMNLP Workshop BlackboxNLP:
Analyzing and Interpreting Neural Networks for NLP</em>. The Association for
Computational Linguistics.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raghunathan et al<span id="bib.bib40.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Aditi Raghunathan,
Sang Michael Xie, Fanny Yang,
John Duchi, and Percy Liang.
2019.

</span>
<span class="ltx_bibblock">Adversarial Training Can Hurt Generalization. In
<em id="bib.bib40.3.1" class="ltx_emph ltx_font_italic">ICML 2019 Workshop on Identifying and Understanding
Deep Learning Phenomena</em>.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=SyxM3J256E" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=SyxM3J256E</a>

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ro et al<span id="bib.bib41.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Jae Hun Ro, Theresa
Breiner, Lara McConnaughey, Mingqing
Chen, Ananda Theertha Suresh, Shankar
Kumar, and Rajiv Mathews.
2022.

</span>
<span class="ltx_bibblock">Scaling Language Model Size in Cross-Device
Federated Learning. In <em id="bib.bib41.3.1" class="ltx_emph ltx_font_italic">ACL 2022 Workshop on
Federated Learning for Natural Language Processing</em>.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=ShNG29KGF-c" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=ShNG29KGF-c</a>

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shoeybi et al<span id="bib.bib42.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Mohammad Shoeybi, Mostofa
Patwary, Raul Puri, Patrick LeGresley,
Jared Casper, and Bryan Catanzaro.
2019.

</span>
<span class="ltx_bibblock">Megatron-LM: Training Multi-Billion Parameter
Language Models Using Model Parallelism.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.3.1" class="ltx_emph ltx_font_italic">arXiv</em> (Sept.
2019).

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.48550/ARXIV.1909.08053" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/ARXIV.1909.08053</a>

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sitawarin et al<span id="bib.bib43.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Chawin Sitawarin, Zachary
Golan-Strieb, and David Wagner.
2022.

</span>
<span class="ltx_bibblock">Demystifying the Adversarial Robustness of Random
Transformation Defenses. In <em id="bib.bib43.3.1" class="ltx_emph ltx_font_italic">The AAAI-22 Workshop
on Adversarial Machine Learning and Beyond</em>.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=p4SrFydwO5" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=p4SrFydwO5</a>

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srisakaokul et al<span id="bib.bib44.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Siwakorn Srisakaokul,
Yuhao Zhang, Zexuan Zhong,
Wei Yang, Tao Xie, and
Bo Li. 2018.

</span>
<span class="ltx_bibblock">MULDEF: Multi-model-based Defense Against
Adversarial Examples for Neural Networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.3.1" class="ltx_emph ltx_font_italic">arXiv</em> (Aug.
2018).

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.48550/arXiv.1809.00065" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.1809.00065</a>
arXiv:1809.00065

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Szegedy et al<span id="bib.bib45.2.2.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Christian Szegedy,
Wojciech Zaremba, Ilya Sutskever,
Joan Bruna, Dumitru Erhan,
Ian J. Goodfellow, and Rob Fergus.
2014.

</span>
<span class="ltx_bibblock">Intriguing properties of neural networks. In
<em id="bib.bib45.3.1" class="ltx_emph ltx_font_italic">2nd International Conference on Learning
Representations, ICLR 2014, Banff, AB, Canada, April 14-16, 2014,
Conference Track Proceedings</em>, Yoshua
Bengio and Yann LeCun (Eds.).

</span>
<span class="ltx_bibblock">
<a target="_blank" href="http://arxiv.org/abs/1312.6199" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1312.6199</a>

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Takase and Kiyono (2021)</span>
<span class="ltx_bibblock">
Sho Takase and Shun
Kiyono. 2021.

</span>
<span class="ltx_bibblock">Lessons on Parameter Sharing across Layers in
Transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2104.06022
(2021).

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://arxiv.org/abs/2104.06022" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2104.06022</a>

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tramèr et al<span id="bib.bib47.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Florian Tramèr, Alexey
Kurakin, Nicolas Papernot, Ian
Goodfellow, Dan Boneh, and Patrick
McDaniel. 2018.

</span>
<span class="ltx_bibblock">Ensemble Adversarial Training: Attacks and
Defenses. In <em id="bib.bib47.3.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=rkZvSe-RZ" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=rkZvSe-RZ</a>

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tsipras et al<span id="bib.bib48.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Dimitris Tsipras, Shibani
Santurkar, Logan Engstrom, Alexander
Turner, and Aleksander Madry.
2019.

</span>
<span class="ltx_bibblock">Robustness May Be at Odds with Accuracy. In
<em id="bib.bib48.3.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=SyxAb30cY7" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=SyxAb30cY7</a>

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span id="bib.bib49.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam
Shazeer, Niki Parmar, Jakob Uszkoreit,
Llion Jones, Aidan N Gomez,
Łukasz Kaiser, and Illia
Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is All you Need. In
<em id="bib.bib49.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em>, I. Guyon,
U. Von Luxburg, S. Bengio,
H. Wallach, R. Fergus,
S. Vishwanathan, and R. Garnett
(Eds.), Vol. 30. Curran Associates,
Inc.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span id="bib.bib50.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Yixuan Wei, Han Hu,
Zhenda Xie, Zheng Zhang,
Yue Cao, Jianmin Bao,
Dong Chen, and Baining Guo.
2022.

</span>
<span class="ltx_bibblock">Contrastive Learning Rivals Masked Image Modeling
in Fine-tuning via Feature Distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.3.1" class="ltx_emph ltx_font_italic">Tech Report</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span id="bib.bib51.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Tao Yu, Shengyuan Hu,
Chuan Guo, Wei-Lun Chao, and
Kilian Q. Weinberger. 2019.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.3.1" class="ltx_emph ltx_font_italic">A New Defense against Adversarial Images:
Turning a Weakness into a Strength</em>.

</span>
<span class="ltx_bibblock">Curran Associates Inc., Red
Hook, NY, USA.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeiler and Fergus (2014)</span>
<span class="ltx_bibblock">
Matthew D. Zeiler and
Rob Fergus. 2014.

</span>
<span class="ltx_bibblock">Visualizing and Understanding Convolutional
Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Computer Vision – ECCV
2014</em>. Springer, Cham, Switzerland,
818–833.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1007/978-3-319-10590-1_53" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1007/978-3-319-10590-1_53</a>

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span id="bib.bib53.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Huan Zhang, Hongge Chen,
Zhao Song, Duane S. Boning,
Inderjit S. Dhillon, and Cho-Jui
Hsieh. 2019.

</span>
<span class="ltx_bibblock">The Limitations of Adversarial Training and the
Blind-Spot Attack. In <em id="bib.bib53.3.1" class="ltx_emph ltx_font_italic">7th International Conference
on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9,
2019</em>. OpenReview.net.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=HylTBhA5tQ" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=HylTBhA5tQ</a>

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span id="bib.bib54.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Jingyang Zhang, Yiran
Chen, and Hai Li. 2022.

</span>
<span class="ltx_bibblock">Privacy Leakage of Adversarial Training Models in
Federated Learning Systems. In <em id="bib.bib54.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>.
108–114.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span id="bib.bib55.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Jiyi Zhang, Wesley
Joon-Wie Tann, and Ee-Chien Chang.
2021.

</span>
<span class="ltx_bibblock">Mitigating Adversarial Attacks by Distributing
Different Copies to Different Users.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.3.1" class="ltx_emph ltx_font_italic">arXiv</em> (Nov.
2021).

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.48550/arXiv.2111.15160" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2111.15160</a>
arXiv:2111.15160

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2308.04372" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2308.04373" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2308.04373">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2308.04373" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2308.04374" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 13:41:34 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
