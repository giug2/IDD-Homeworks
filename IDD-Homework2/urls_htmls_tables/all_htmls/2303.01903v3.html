<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.01903] Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering</title><meta property="og:description" content="Knowledge-based visual question answering (VQA) requires external knowledge beyond the image to answer the question. Early studies retrieve required knowledge from explicit knowledge bases (KBs), which often introduces…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.01903">

<!--Generated on Thu Feb 29 22:09:29 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Visual Question Answering (VQA),  large language models (LLMs),  knowledge-based VQA,  multimodal learning.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhou Yu , 
Xuecheng Ouyang, 
Zhenwei Shao, 
<br class="ltx_break">Meng Wang , Jun Yu
</span><span class="ltx_author_notes">
This work was supported in part by the Zhejiang Provincial Natural Science Foundation of China under Grant LR22F020001, in part by the National Natural Science Foundation of China under Grants 62125201, 62072147, 62020106007 and 61836002, and in part by the Zhejiang Provincial Natural Science Foundation of China under Grant LDT23F02025F02. (Corresponding author: Jun Yu.)
Z. Yu, Z. Shao, J. Yu are with the Key Laboratory of Complex Systems Modeling and Simulation, the School of Computer Science, Hangzhou Dianzi University, China. (e-mail: yuz@hdu.edu.cn; shaozw@hdu.edu.cn; yujun@hdu.edu.cn)
X. Ouyang is with the HDU-ITMO Joint Institute, Hangzhou Dianzi University, China. (e-mail: ouyangxc@hdu.edu.cn)
M. Wang is with the School of Computer Science and Information Engineering, Hefei University of Technology, China. (e-mail: eric.mengwang@gmail.com)
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Knowledge-based visual question answering (VQA) requires external knowledge beyond the image to answer the question. Early studies retrieve required knowledge from explicit knowledge bases (KBs), which often introduces irrelevant information to the question, hence restricting the performance of their models. Recent works have resorted to using a powerful large language model (LLM) as an implicit knowledge engine to acquire the necessary knowledge for answering. Despite the encouraging results achieved by these methods, we argue that they have not fully activated the capacity of the <em id="id1.id1.1" class="ltx_emph ltx_font_italic">blind</em> LLM as the provided textual input is insufficient to depict the required visual information to answer the question. In this paper, we present Prophet—a conceptually simple, flexible, and general framework designed to <span id="id1.id1.2" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">pro</span>m<span id="id1.id1.3" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">p</span>t LLM with answer <span id="id1.id1.4" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">he</span>uris<span id="id1.id1.5" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">t</span>ics for knowledge-based VQA. Specifically, we first train a vanilla VQA model on a specific knowledge-based VQA dataset without external knowledge. After that, we extract two types of complementary answer heuristics from the VQA model: answer candidates and answer-aware examples. Finally, the two types of answer heuristics are jointly encoded into a formatted prompt to facilitate the LLM’s understanding of both the image and question, thus generating a more accurate answer. By incorporating the state-of-the-art LLM GPT-3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, Prophet significantly outperforms existing state-of-the-art methods on four challenging knowledge-based VQA datasets. To demonstrate the generality of our approach, we instantiate Prophet with the combinations of different VQA models (<em id="id1.id1.6" class="ltx_emph ltx_font_italic">i.e.</em>, both discriminative and generative ones) and different LLMs (<em id="id1.id1.7" class="ltx_emph ltx_font_italic">i.e.</em>, both commercial and open-source ones).</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Visual Question Answering (VQA), large language models (LLMs), knowledge-based VQA, multimodal learning.

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Recent advances in deep learning have enabled substantial progress in visual question answering (VQA) which requires a machine to answer free-form questions by reasoning about given images. Benefiting from large-scale vision-language pretraining, the state-of-the-art methods have even surpassed human level on several representative benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Despite the success of these methods, their reasoning abilities are far from satisfactory, especially when <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">external knowledge</em> is required to answer the questions. In this situation, the task of knowledge-based VQA is introduced to validate models’ abilities to leverage external knowledge. Early knowledge-based VQA benchmarks additionally provide structured knowledge bases (KBs) and annotate required knowledge facts for all the questions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. More recently, benchmarks emphasizing on <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">open-domain</em> knowledge have been established <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, which means KBs are no longer provided and any external knowledge resource can be used for answering. We focus on the task with open-domain knowledge in this paper.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A straightforward solution for knowledge-based VQA is to retrieve knowledge entries from explicit KBs, <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, Wikipedia and ConceptNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Then, a KB-augmented VQA model performs joint reasoning over the retrieved knowledge, image, and question to predict the answer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. However, the performance of these retrieval-based approaches is limited for two reasons: (i) the required knowledge may not be successfully retrieved from the KBs; and (ii) even if the required knowledge is retrieved, plenty of irrelevant knowledge is inevitably introduced, which hampers the learning of VQA models.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><span id="S1.F1.1.pic1" class="ltx_picture ltx_centering" style="width:432.2pt;height:260.2pt;">\begin{overpic}[width=433.62pt]{fig1.pdf}
\put(57.0,46.5){ \footnotesize{PICa \cite[cite]{[\@@bibref{}{pica}{}{}]}}}
\put(47.0,28.0){ \footnotesize{KAT \cite[cite]{[\@@bibref{}{kat}{}{}]} / REVIVE \cite[cite]{[\@@bibref{}{revive}{}{}]}} }
\put(52.0,9.5){ \small{{Prophet (ours)}}}
\end{overpic}</span>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.7.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.8.2" class="ltx_text" style="font-size:90%;">Conceptual comparisons of three knowledge-based VQA frameworks using a frozen LLM model, <em id="S1.F1.8.2.1" class="ltx_emph ltx_font_italic">e.g.</em>, GPT-3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. While PICa <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, KAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, and REVIVE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> directly feed the caption (C) and question (Q) into the LLM as the prompt, we argue that the information they provide for the LLM is insufficient thus cannot fully activate the LLM’s potential. In contrast, our Prophet learns a vanilla VQA model without external knowledge to produce <em id="S1.F1.8.2.2" class="ltx_emph ltx_font_italic">answer heuristics</em>, which endows the LLM with richer and more task-specific information for answer prediction. In contrast to the counterparts that resort to specific VQA models and LLMs, our Prophet is more general that can be instantiated with the combinations of different VQA models (<em id="S1.F1.8.2.3" class="ltx_emph ltx_font_italic">i.e.</em>, discriminative <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> and generative ones <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>) and different LLMs (<em id="S1.F1.8.2.4" class="ltx_emph ltx_font_italic">i.e.</em>, commercial <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and open-source ones <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>).</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Apart from those studies using explicit KBs, another line of research resorts to pretrained large language models (LLMs), <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, GPT-3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, as implicit knowledge engines for knowledge acquisition. A pioneering work by PICa employs the frozen GPT-3 model to answer the question with a formatted prompt as its input <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Given a testing image-question pair, PICa first translates the image into a caption using an off-the-shelf captioning model. The question, caption, and a few in-context examples are then integrated into a textual prompt that can induce GPT-3 to predict the answer directly. Thanks to the powerful knowledge reasoning ability of <span id="S1.p3.1.2" class="ltx_text">GPT-3</span>, PICa achieves significant performance improvements compared to those retrieval-based methods using explicit KBs.
Inspired by PICa, KAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and REVIVE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> learn KB-augmented VQA models to exploit both the implicit knowledge from LLMs and explicit knowledge from KBs for answer prediction. The synergy of the two knowledge resources brings further improvements to their models. Despite the promising results achieved by these methods, they have not fully activated the capability of the LLMs due to the following limitations:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(i)</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">The generated captions cannot cover all the necessary information in the image. Consider the example in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the caption “a group of people walk in a city square” contributes nothing to answering the question “what fruit comes from these trees”. In this situation, the LLM has to make an aimless and biased guess to answer the question.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(ii)</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">LLMs like GPT-3 employ a few-shot learning paradigm that requires a few in-context examples to adapt to new tasks. Therefore, the choice of these examples is critical to model performance. As reported in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, all its example selection strategies achieve far inferior performance to the oracle strategy that uses the similarity of ground-truth answers.</p>
</div>
</li>
</ol>
<p id="S1.p3.2" class="ltx_p">We ask: <em id="S1.p3.2.1" class="ltx_emph ltx_font_italic">Is it possible to endow the LLM with some <span id="S1.p3.2.1.1" class="ltx_text ltx_font_bold">heuristics</span> to enhance its capacity for knowledge-based VQA?</em></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we present <span id="S1.p4.1.1" class="ltx_text ltx_font_bold">Prophet</span>—a conceptually simple yet effective framework designed to <span id="S1.p4.1.2" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">pro</span>m<span id="S1.p4.1.3" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">p</span>t LLMs with answer <span id="S1.p4.1.4" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">he</span>uris<span id="S1.p4.1.5" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">t</span>ics for knowledge-based VQA. By answer <span id="S1.p4.1.6" class="ltx_text">heuristics</span>, we mean some promising answers that are presented in a proper manner in the prompt. Specifically, we introduce two types of complementary answer heuristics, namely <em id="S1.p4.1.7" class="ltx_emph ltx_font_italic">answer candidates</em> and <em id="S1.p4.1.8" class="ltx_emph ltx_font_italic">answer-aware examples</em>, to overcome the limitations in (i) and (ii), respectively. Given a testing input consisting of an image and a question, the answer candidates refer to a list of promising answers to the testing input, where each answer is associated with a confidence score. The answer-aware examples refer to a list of in-context examples, where each example has a similar answer to the testing input. Interestingly, these two types of answer heuristics can be simultaneously obtained from any vanilla VQA model trained on a specific knowledge-based VQA dataset. A schematic of Prophet is illustrated at the bottom of <span id="S1.p4.1.9" class="ltx_text">Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a></span>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Without bells and whistles, Prophet surpasses previous state-of-the-art single-model results on the challenging OK-VQA and A-OKVQA datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, including the heavily-engineered Flamingo-80B model trained on 1.8B image-text pairs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Moreover, Prophet is friendly to most researchers, as our results can be reproduced using a single GPU and a number of GPT-3 invocations.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">A preliminary version of this manuscript was published in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. Based on that version, we have made the following contributions to further improve the performance and validate the generality of Prophet: (i) we investigate diverse types of VQA models, including the classical discriminative models trained from scratch and the latest generative VQA models pretrained on large-scale corpus; (ii) we expand the used LLM from the commercial GPT-3 model to a wide range of open-source models; (iii) apart from OK-VQA and A-OKVQA, we conduct more experiments on two other knowledge-based VQA datasets, namely ScienceQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and TextVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. The source code is made available here<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/MILVLG/prophet</span></span></span></span>. We hope these studies may serve as a new baseline to inspire future research on knowledge-based VQA and universal vision-language learning.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2303.01903/assets/x1.png" id="S1.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="164" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.6.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S1.F2.7.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Our Prophet framework<span id="S1.F2.7.2.1" class="ltx_text ltx_font_medium"> has two stages: answer heuristics generation and heuristics-enhanced prompting. In the answer heuristics generation stage, a vanilla VQA model trained on specific knowledge-based VQA dataset is employed to generate two types of complementary answer heuristics, <em id="S1.F2.7.2.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, answer candidates and answer-aware examples. In the heuristics-enhanced prompting stage, the answer heuristics, question, and caption are integrated into a formatted prompt to instruct a frozen LLM (<em id="S1.F2.7.2.1.2" class="ltx_emph ltx_font_italic">e.g.</em>, GPT-3) to predict an answer. As shown in the example, both answer heuristics contribute to the answer of “helium”.</span></span></figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Visual Question Answering (VQA).</span> VQA has been of growing interest over the last few years. Recent studies in VQA research can be roughly divided into the following categories: better visual features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, more powerful model architectures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, and more effective learning paradigms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. Most current state-of-the-art VQA methods employ the Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. By incorporating vision-language pretraining on large-scale datasets, they have approached or even surpassed human-level performance on several representative benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. Besides these studies on general-purpose VQA, there is also a growing trend towards exploring more granular VQA tasks with specific reasoning skills, <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">e.g.</em>, neural-symbolic reasoning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> and knowledge utilization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.


<br class="ltx_break"><span id="S2.p1.1.3" class="ltx_text ltx_font_bold">Knowledge-based VQA.</span> The core of this task lies in knowledge acquisition and integration. Early explorations parse the inputs into structured queries and retrieve supporting knowledge from fixed knowledge bases (KBs) to obtain the answers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. As the provided knowledge resources are not sufficient to represent general knowledge, subsequent research mainly focuses on acquiring explicit knowledge from multiple open-domain knowledge resources, <em id="S2.p1.1.4" class="ltx_emph ltx_font_italic">e.g.</em>, ConceptNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, Wikipedia <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, and Google Images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. This retrieved knowledge is integrated with the image-question pair for answer prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Motivated by the powerful capacities of LLMs (<em id="S2.p1.1.5" class="ltx_emph ltx_font_italic">e.g.</em>, GPT-3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>) in knowledge reasoning, recent state-of-the-art approaches regard an LLM as an implicit knowledge engine. They either utilize it to predict answers from given questions and extract visual captions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> or to extract answer candidates with evidence to improve answer prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Nevertheless, they have not fully activated the reasoning capability of LLMs, as the necessary visual information to answer the question is not represented exactly.
This motivates us to explore the strategies for prompting LLMs with question-aware information (<em id="S2.p1.1.6" class="ltx_emph ltx_font_italic">i.e.</em>, answer heuristics). Similar to Prophet, a concurrent work PromptCap also aims to enhance the input information for LLMs by learning a question-aware captioning model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. However, PromptCap needs to use LLM in both the training and testing phases, which incurs tremendous computational costs as the training set is usually large. In contrast, Prophet is more economical as it only utilizes LLM in the testing phase.


<br class="ltx_break"><span id="S2.p1.1.7" class="ltx_text ltx_font_bold">In-context learning.</span> Unlike the <em id="S2.p1.1.8" class="ltx_emph ltx_font_italic">pretrain-then-finetune</em> paradigm for language models like BERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, GPT-3 innovatively introduces a <em id="S2.p1.1.9" class="ltx_emph ltx_font_italic">few-shot in-context learning</em> paradigm and has become the de facto standard for subsequent LLMs. To adapt to a new task, GPT-3 only needs to concatenate a few examples of the task with the input as the <em id="S2.p1.1.10" class="ltx_emph ltx_font_italic">prompt</em> at inference time and requires no parameter updates. This appealing property has inspired research on training multimodal few-shot learners <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Empirical studies show that a huge model (<em id="S2.p1.1.11" class="ltx_emph ltx_font_italic">e.g.</em>, 80B parameters in Flamingo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>) is required for effective few-shot learning, which is unaffordable for most people to reproduce their results.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">The Prophet Framework</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.2" class="ltx_p">Our Prophet is a conceptually simple two-stage framework. In the answer heuristics generation stage, a vanilla VQA model is learned to generate two types of answer heuristics, <em id="S3.p1.2.1" class="ltx_emph ltx_font_italic">i.e.</em>, answer candidates and answer-aware examples (detailed in <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\S" display="inline"><semantics id="S3.p1.1.m1.1a"><mi mathvariant="normal" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\S</annotation></semantics></math><a href="#S3.SS2" title="3.2 Stage-1: Answer Heuristics Generation ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>). In the heuristics-enhanced prompting stage, the answer heuristics, question, and caption are integrated into a formatted prompt to instruct a frozen LLM to predict an answer (detailed in <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\S" display="inline"><semantics id="S3.p1.2.m2.1a"><mi mathvariant="normal" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\S</annotation></semantics></math><a href="#S3.SS3" title="3.3 Stage-2: Heuristics-enhanced Prompting ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>).
An overview of the Prophet framework is depicted in Fig. <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span id="S3.SS1.6.1" class="ltx_text ltx_font_italic">Preliminaries</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Before presenting the Prophet, we briefly introduce the in-context learning paradigm developed by GPT-3 and its adaptation to knowledge-based VQA by PICa <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.14" class="ltx_p">GPT-3 is an autoregressive language model pretrained on a tremendous dataset. During inference, in-context few-shot learning formulates a new downstream task as a text sequence generation task on the frozen model. Given a testing input <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\boldsymbol{x}</annotation></semantics></math>, its target <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\boldsymbol{y}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\boldsymbol{y}</annotation></semantics></math> is predicted conditioned on a formatted prompt <math id="S3.SS1.p2.3.m3.3" class="ltx_Math" alttext="\boldsymbol{p}(\boldsymbol{h},\mathcal{E},\boldsymbol{x})" display="inline"><semantics id="S3.SS1.p2.3.m3.3a"><mrow id="S3.SS1.p2.3.m3.3.4" xref="S3.SS1.p2.3.m3.3.4.cmml"><mi id="S3.SS1.p2.3.m3.3.4.2" xref="S3.SS1.p2.3.m3.3.4.2.cmml">𝒑</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.3.4.1" xref="S3.SS1.p2.3.m3.3.4.1.cmml">​</mo><mrow id="S3.SS1.p2.3.m3.3.4.3.2" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.3.4.3.2.1" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml">(</mo><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">𝒉</mi><mo id="S3.SS1.p2.3.m3.3.4.3.2.2" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml">ℰ</mi><mo id="S3.SS1.p2.3.m3.3.4.3.2.3" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p2.3.m3.3.3" xref="S3.SS1.p2.3.m3.3.3.cmml">𝒙</mi><mo stretchy="false" id="S3.SS1.p2.3.m3.3.4.3.2.4" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.3b"><apply id="S3.SS1.p2.3.m3.3.4.cmml" xref="S3.SS1.p2.3.m3.3.4"><times id="S3.SS1.p2.3.m3.3.4.1.cmml" xref="S3.SS1.p2.3.m3.3.4.1"></times><ci id="S3.SS1.p2.3.m3.3.4.2.cmml" xref="S3.SS1.p2.3.m3.3.4.2">𝒑</ci><vector id="S3.SS1.p2.3.m3.3.4.3.1.cmml" xref="S3.SS1.p2.3.m3.3.4.3.2"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝒉</ci><ci id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2">ℰ</ci><ci id="S3.SS1.p2.3.m3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3">𝒙</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.3c">\boldsymbol{p}(\boldsymbol{h},\mathcal{E},\boldsymbol{x})</annotation></semantics></math>, where <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="\boldsymbol{h}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\boldsymbol{h}</annotation></semantics></math> refers to a prompt head, <em id="S3.SS1.p2.14.1" class="ltx_emph ltx_font_italic">aka</em> instruction, that describes the task, <math id="S3.SS1.p2.5.m5.4" class="ltx_Math" alttext="\mathcal{E}=\{\boldsymbol{e}_{1},\boldsymbol{e}_{2},...,\boldsymbol{e}_{n}\}" display="inline"><semantics id="S3.SS1.p2.5.m5.4a"><mrow id="S3.SS1.p2.5.m5.4.4" xref="S3.SS1.p2.5.m5.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.4.4.5" xref="S3.SS1.p2.5.m5.4.4.5.cmml">ℰ</mi><mo id="S3.SS1.p2.5.m5.4.4.4" xref="S3.SS1.p2.5.m5.4.4.4.cmml">=</mo><mrow id="S3.SS1.p2.5.m5.4.4.3.3" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.4.4.3.3.4" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p2.5.m5.2.2.1.1.1" xref="S3.SS1.p2.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.5.m5.2.2.1.1.1.2" xref="S3.SS1.p2.5.m5.2.2.1.1.1.2.cmml">𝒆</mi><mn id="S3.SS1.p2.5.m5.2.2.1.1.1.3" xref="S3.SS1.p2.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.5.m5.4.4.3.3.5" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.5.m5.3.3.2.2.2" xref="S3.SS1.p2.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.5.m5.3.3.2.2.2.2" xref="S3.SS1.p2.5.m5.3.3.2.2.2.2.cmml">𝒆</mi><mn id="S3.SS1.p2.5.m5.3.3.2.2.2.3" xref="S3.SS1.p2.5.m5.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p2.5.m5.4.4.3.3.6" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">…</mi><mo id="S3.SS1.p2.5.m5.4.4.3.3.7" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.5.m5.4.4.3.3.3" xref="S3.SS1.p2.5.m5.4.4.3.3.3.cmml"><mi id="S3.SS1.p2.5.m5.4.4.3.3.3.2" xref="S3.SS1.p2.5.m5.4.4.3.3.3.2.cmml">𝒆</mi><mi id="S3.SS1.p2.5.m5.4.4.3.3.3.3" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p2.5.m5.4.4.3.3.8" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.4b"><apply id="S3.SS1.p2.5.m5.4.4.cmml" xref="S3.SS1.p2.5.m5.4.4"><eq id="S3.SS1.p2.5.m5.4.4.4.cmml" xref="S3.SS1.p2.5.m5.4.4.4"></eq><ci id="S3.SS1.p2.5.m5.4.4.5.cmml" xref="S3.SS1.p2.5.m5.4.4.5">ℰ</ci><set id="S3.SS1.p2.5.m5.4.4.3.4.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3"><apply id="S3.SS1.p2.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1.2">𝒆</ci><cn type="integer" id="S3.SS1.p2.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p2.5.m5.3.3.2.2.2.cmml" xref="S3.SS1.p2.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.5.m5.3.3.2.2.2.2">𝒆</ci><cn type="integer" id="S3.SS1.p2.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">…</ci><apply id="S3.SS1.p2.5.m5.4.4.3.3.3.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3.2">𝒆</ci><ci id="S3.SS1.p2.5.m5.4.4.3.3.3.3.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.4c">\mathcal{E}=\{\boldsymbol{e}_{1},\boldsymbol{e}_{2},...,\boldsymbol{e}_{n}\}</annotation></semantics></math> corresponds to <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">n</annotation></semantics></math> in-context examples. Let the target <math id="S3.SS1.p2.7.m7.4" class="ltx_Math" alttext="\boldsymbol{y}=(y^{1},y^{2},...,y^{L})" display="inline"><semantics id="S3.SS1.p2.7.m7.4a"><mrow id="S3.SS1.p2.7.m7.4.4" xref="S3.SS1.p2.7.m7.4.4.cmml"><mi id="S3.SS1.p2.7.m7.4.4.5" xref="S3.SS1.p2.7.m7.4.4.5.cmml">𝒚</mi><mo id="S3.SS1.p2.7.m7.4.4.4" xref="S3.SS1.p2.7.m7.4.4.4.cmml">=</mo><mrow id="S3.SS1.p2.7.m7.4.4.3.3" xref="S3.SS1.p2.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.4.4.3.3.4" xref="S3.SS1.p2.7.m7.4.4.3.4.cmml">(</mo><msup id="S3.SS1.p2.7.m7.2.2.1.1.1" xref="S3.SS1.p2.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.7.m7.2.2.1.1.1.2" xref="S3.SS1.p2.7.m7.2.2.1.1.1.2.cmml">y</mi><mn id="S3.SS1.p2.7.m7.2.2.1.1.1.3" xref="S3.SS1.p2.7.m7.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S3.SS1.p2.7.m7.4.4.3.3.5" xref="S3.SS1.p2.7.m7.4.4.3.4.cmml">,</mo><msup id="S3.SS1.p2.7.m7.3.3.2.2.2" xref="S3.SS1.p2.7.m7.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.7.m7.3.3.2.2.2.2" xref="S3.SS1.p2.7.m7.3.3.2.2.2.2.cmml">y</mi><mn id="S3.SS1.p2.7.m7.3.3.2.2.2.3" xref="S3.SS1.p2.7.m7.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S3.SS1.p2.7.m7.4.4.3.3.6" xref="S3.SS1.p2.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">…</mi><mo id="S3.SS1.p2.7.m7.4.4.3.3.7" xref="S3.SS1.p2.7.m7.4.4.3.4.cmml">,</mo><msup id="S3.SS1.p2.7.m7.4.4.3.3.3" xref="S3.SS1.p2.7.m7.4.4.3.3.3.cmml"><mi id="S3.SS1.p2.7.m7.4.4.3.3.3.2" xref="S3.SS1.p2.7.m7.4.4.3.3.3.2.cmml">y</mi><mi id="S3.SS1.p2.7.m7.4.4.3.3.3.3" xref="S3.SS1.p2.7.m7.4.4.3.3.3.3.cmml">L</mi></msup><mo stretchy="false" id="S3.SS1.p2.7.m7.4.4.3.3.8" xref="S3.SS1.p2.7.m7.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.4b"><apply id="S3.SS1.p2.7.m7.4.4.cmml" xref="S3.SS1.p2.7.m7.4.4"><eq id="S3.SS1.p2.7.m7.4.4.4.cmml" xref="S3.SS1.p2.7.m7.4.4.4"></eq><ci id="S3.SS1.p2.7.m7.4.4.5.cmml" xref="S3.SS1.p2.7.m7.4.4.5">𝒚</ci><vector id="S3.SS1.p2.7.m7.4.4.3.4.cmml" xref="S3.SS1.p2.7.m7.4.4.3.3"><apply id="S3.SS1.p2.7.m7.2.2.1.1.1.cmml" xref="S3.SS1.p2.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.2.2.1.1.1.2">𝑦</ci><cn type="integer" id="S3.SS1.p2.7.m7.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p2.7.m7.3.3.2.2.2.cmml" xref="S3.SS1.p2.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.p2.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.3.3.2.2.2.2">𝑦</ci><cn type="integer" id="S3.SS1.p2.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">…</ci><apply id="S3.SS1.p2.7.m7.4.4.3.3.3.cmml" xref="S3.SS1.p2.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.3.3.3.1.cmml" xref="S3.SS1.p2.7.m7.4.4.3.3.3">superscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.3.3.3.2.cmml" xref="S3.SS1.p2.7.m7.4.4.3.3.3.2">𝑦</ci><ci id="S3.SS1.p2.7.m7.4.4.3.3.3.3.cmml" xref="S3.SS1.p2.7.m7.4.4.3.3.3.3">𝐿</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.4c">\boldsymbol{y}=(y^{1},y^{2},...,y^{L})</annotation></semantics></math> be a text sequence of <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">L</annotation></semantics></math> tokens. For notational convenience, we denote <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="[l]" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><mrow id="S3.SS1.p2.9.m9.1.2.2" xref="S3.SS1.p2.9.m9.1.2.1.cmml"><mo stretchy="false" id="S3.SS1.p2.9.m9.1.2.2.1" xref="S3.SS1.p2.9.m9.1.2.1.1.cmml">[</mo><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">l</mi><mo stretchy="false" id="S3.SS1.p2.9.m9.1.2.2.2" xref="S3.SS1.p2.9.m9.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.2.1.cmml" xref="S3.SS1.p2.9.m9.1.2.2"><csymbol cd="latexml" id="S3.SS1.p2.9.m9.1.2.1.1.cmml" xref="S3.SS1.p2.9.m9.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">[l]</annotation></semantics></math> as a set of natural numbers from 1 to <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><mi id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">l</annotation></semantics></math> and use <math id="S3.SS1.p2.11.m11.4" class="ltx_Math" alttext="\boldsymbol{y}^{[l]}=(y^{1},...,y^{l})" display="inline"><semantics id="S3.SS1.p2.11.m11.4a"><mrow id="S3.SS1.p2.11.m11.4.4" xref="S3.SS1.p2.11.m11.4.4.cmml"><msup id="S3.SS1.p2.11.m11.4.4.4" xref="S3.SS1.p2.11.m11.4.4.4.cmml"><mi id="S3.SS1.p2.11.m11.4.4.4.2" xref="S3.SS1.p2.11.m11.4.4.4.2.cmml">𝒚</mi><mrow id="S3.SS1.p2.11.m11.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.11.m11.1.1.1.3.1" xref="S3.SS1.p2.11.m11.1.1.1.2.1.cmml">[</mo><mi id="S3.SS1.p2.11.m11.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.SS1.p2.11.m11.1.1.1.3.2" xref="S3.SS1.p2.11.m11.1.1.1.2.1.cmml">]</mo></mrow></msup><mo id="S3.SS1.p2.11.m11.4.4.3" xref="S3.SS1.p2.11.m11.4.4.3.cmml">=</mo><mrow id="S3.SS1.p2.11.m11.4.4.2.2" xref="S3.SS1.p2.11.m11.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.11.m11.4.4.2.2.3" xref="S3.SS1.p2.11.m11.4.4.2.3.cmml">(</mo><msup id="S3.SS1.p2.11.m11.3.3.1.1.1" xref="S3.SS1.p2.11.m11.3.3.1.1.1.cmml"><mi id="S3.SS1.p2.11.m11.3.3.1.1.1.2" xref="S3.SS1.p2.11.m11.3.3.1.1.1.2.cmml">y</mi><mn id="S3.SS1.p2.11.m11.3.3.1.1.1.3" xref="S3.SS1.p2.11.m11.3.3.1.1.1.3.cmml">1</mn></msup><mo id="S3.SS1.p2.11.m11.4.4.2.2.4" xref="S3.SS1.p2.11.m11.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.11.m11.2.2" xref="S3.SS1.p2.11.m11.2.2.cmml">…</mi><mo id="S3.SS1.p2.11.m11.4.4.2.2.5" xref="S3.SS1.p2.11.m11.4.4.2.3.cmml">,</mo><msup id="S3.SS1.p2.11.m11.4.4.2.2.2" xref="S3.SS1.p2.11.m11.4.4.2.2.2.cmml"><mi id="S3.SS1.p2.11.m11.4.4.2.2.2.2" xref="S3.SS1.p2.11.m11.4.4.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p2.11.m11.4.4.2.2.2.3" xref="S3.SS1.p2.11.m11.4.4.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S3.SS1.p2.11.m11.4.4.2.2.6" xref="S3.SS1.p2.11.m11.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.4b"><apply id="S3.SS1.p2.11.m11.4.4.cmml" xref="S3.SS1.p2.11.m11.4.4"><eq id="S3.SS1.p2.11.m11.4.4.3.cmml" xref="S3.SS1.p2.11.m11.4.4.3"></eq><apply id="S3.SS1.p2.11.m11.4.4.4.cmml" xref="S3.SS1.p2.11.m11.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.4.4.4.1.cmml" xref="S3.SS1.p2.11.m11.4.4.4">superscript</csymbol><ci id="S3.SS1.p2.11.m11.4.4.4.2.cmml" xref="S3.SS1.p2.11.m11.4.4.4.2">𝒚</ci><apply id="S3.SS1.p2.11.m11.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p2.11.m11.1.1.1.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS1.p2.11.m11.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1">𝑙</ci></apply></apply><vector id="S3.SS1.p2.11.m11.4.4.2.3.cmml" xref="S3.SS1.p2.11.m11.4.4.2.2"><apply id="S3.SS1.p2.11.m11.3.3.1.1.1.cmml" xref="S3.SS1.p2.11.m11.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.3.3.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.3.3.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.11.m11.3.3.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.3.3.1.1.1.2">𝑦</ci><cn type="integer" id="S3.SS1.p2.11.m11.3.3.1.1.1.3.cmml" xref="S3.SS1.p2.11.m11.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.11.m11.2.2.cmml" xref="S3.SS1.p2.11.m11.2.2">…</ci><apply id="S3.SS1.p2.11.m11.4.4.2.2.2.cmml" xref="S3.SS1.p2.11.m11.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.4.4.2.2.2.1.cmml" xref="S3.SS1.p2.11.m11.4.4.2.2.2">superscript</csymbol><ci id="S3.SS1.p2.11.m11.4.4.2.2.2.2.cmml" xref="S3.SS1.p2.11.m11.4.4.2.2.2.2">𝑦</ci><ci id="S3.SS1.p2.11.m11.4.4.2.2.2.3.cmml" xref="S3.SS1.p2.11.m11.4.4.2.2.2.3">𝑙</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.4c">\boldsymbol{y}^{[l]}=(y^{1},...,y^{l})</annotation></semantics></math> to represent a sub-sequence containing the first <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><mi id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><ci id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">l</annotation></semantics></math> words of <math id="S3.SS1.p2.13.m13.1" class="ltx_Math" alttext="\boldsymbol{y}" display="inline"><semantics id="S3.SS1.p2.13.m13.1a"><mi id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><ci id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">\boldsymbol{y}</annotation></semantics></math>. At each decoding step <math id="S3.SS1.p2.14.m14.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.14.m14.1a"><mi id="S3.SS1.p2.14.m14.1.1" xref="S3.SS1.p2.14.m14.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m14.1b"><ci id="S3.SS1.p2.14.m14.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.1c">l</annotation></semantics></math>, we have:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="y^{l}=\mathop{\text{argmax}}\limits_{\hat{y}^{l}}p_{\textrm{GPT-3}}(\hat{y}^{l}|\boldsymbol{p},\boldsymbol{y}^{[l-1]})" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><msup id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.2" xref="S3.E1.m1.3.3.3.2.cmml">y</mi><mi id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">l</mi></msup><mo id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml"><munder id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.2.cmml"><mtext id="S3.E1.m1.3.3.1.2.2" xref="S3.E1.m1.3.3.1.2.2a.cmml">argmax</mtext><msup id="S3.E1.m1.3.3.1.2.3" xref="S3.E1.m1.3.3.1.2.3.cmml"><mover accent="true" id="S3.E1.m1.3.3.1.2.3.2" xref="S3.E1.m1.3.3.1.2.3.2.cmml"><mi id="S3.E1.m1.3.3.1.2.3.2.2" xref="S3.E1.m1.3.3.1.2.3.2.2.cmml">y</mi><mo id="S3.E1.m1.3.3.1.2.3.2.1" xref="S3.E1.m1.3.3.1.2.3.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.3.3.1.2.3.3" xref="S3.E1.m1.3.3.1.2.3.3.cmml">l</mi></msup></munder><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml">p</mi><mtext id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.3a.cmml">GPT-3</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><msup id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E1.m1.3.3.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.3.3.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.3.cmml">l</mi></msup><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝒑</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">,</mo><msup id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">𝒚</mi><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.1.cmml">]</mo></mrow></msup></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"></eq><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3">superscript</csymbol><ci id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2">𝑦</ci><ci id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3">𝑙</ci></apply><apply id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1"><apply id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.1.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.2.2a.cmml" xref="S3.E1.m1.3.3.1.2.2"><mtext id="S3.E1.m1.3.3.1.2.2.cmml" xref="S3.E1.m1.3.3.1.2.2">argmax</mtext></ci><apply id="S3.E1.m1.3.3.1.2.3.cmml" xref="S3.E1.m1.3.3.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.2.3">superscript</csymbol><apply id="S3.E1.m1.3.3.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.2.3.2"><ci id="S3.E1.m1.3.3.1.2.3.2.1.cmml" xref="S3.E1.m1.3.3.1.2.3.2.1">^</ci><ci id="S3.E1.m1.3.3.1.2.3.2.2.cmml" xref="S3.E1.m1.3.3.1.2.3.2.2">𝑦</ci></apply><ci id="S3.E1.m1.3.3.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.2.3.3">𝑙</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1"><times id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">𝑝</ci><ci id="S3.E1.m1.3.3.1.1.3.3a.cmml" xref="S3.E1.m1.3.3.1.1.3.3"><mtext mathsize="70%" id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3">GPT-3</mtext></ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2"><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.3">𝑙</ci></apply><list id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝒑</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2">𝒚</ci><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">1</cn></apply></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">y^{l}=\mathop{\text{argmax}}\limits_{\hat{y}^{l}}p_{\textrm{GPT-3}}(\hat{y}^{l}|\boldsymbol{p},\boldsymbol{y}^{[l-1]})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.15" class="ltx_p">where each in-context example <math id="S3.SS1.p2.15.m1.2" class="ltx_Math" alttext="\boldsymbol{e}_{i}=(\boldsymbol{x}_{i},\boldsymbol{y}_{i})" display="inline"><semantics id="S3.SS1.p2.15.m1.2a"><mrow id="S3.SS1.p2.15.m1.2.2" xref="S3.SS1.p2.15.m1.2.2.cmml"><msub id="S3.SS1.p2.15.m1.2.2.4" xref="S3.SS1.p2.15.m1.2.2.4.cmml"><mi id="S3.SS1.p2.15.m1.2.2.4.2" xref="S3.SS1.p2.15.m1.2.2.4.2.cmml">𝒆</mi><mi id="S3.SS1.p2.15.m1.2.2.4.3" xref="S3.SS1.p2.15.m1.2.2.4.3.cmml">i</mi></msub><mo id="S3.SS1.p2.15.m1.2.2.3" xref="S3.SS1.p2.15.m1.2.2.3.cmml">=</mo><mrow id="S3.SS1.p2.15.m1.2.2.2.2" xref="S3.SS1.p2.15.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.15.m1.2.2.2.2.3" xref="S3.SS1.p2.15.m1.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p2.15.m1.1.1.1.1.1" xref="S3.SS1.p2.15.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.15.m1.1.1.1.1.1.2" xref="S3.SS1.p2.15.m1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.SS1.p2.15.m1.1.1.1.1.1.3" xref="S3.SS1.p2.15.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p2.15.m1.2.2.2.2.4" xref="S3.SS1.p2.15.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.15.m1.2.2.2.2.2" xref="S3.SS1.p2.15.m1.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.15.m1.2.2.2.2.2.2" xref="S3.SS1.p2.15.m1.2.2.2.2.2.2.cmml">𝒚</mi><mi id="S3.SS1.p2.15.m1.2.2.2.2.2.3" xref="S3.SS1.p2.15.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.15.m1.2.2.2.2.5" xref="S3.SS1.p2.15.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m1.2b"><apply id="S3.SS1.p2.15.m1.2.2.cmml" xref="S3.SS1.p2.15.m1.2.2"><eq id="S3.SS1.p2.15.m1.2.2.3.cmml" xref="S3.SS1.p2.15.m1.2.2.3"></eq><apply id="S3.SS1.p2.15.m1.2.2.4.cmml" xref="S3.SS1.p2.15.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m1.2.2.4.1.cmml" xref="S3.SS1.p2.15.m1.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.15.m1.2.2.4.2.cmml" xref="S3.SS1.p2.15.m1.2.2.4.2">𝒆</ci><ci id="S3.SS1.p2.15.m1.2.2.4.3.cmml" xref="S3.SS1.p2.15.m1.2.2.4.3">𝑖</ci></apply><interval closure="open" id="S3.SS1.p2.15.m1.2.2.2.3.cmml" xref="S3.SS1.p2.15.m1.2.2.2.2"><apply id="S3.SS1.p2.15.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.15.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.15.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.15.m1.1.1.1.1.1.2">𝒙</ci><ci id="S3.SS1.p2.15.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.15.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.15.m1.2.2.2.2.2.cmml" xref="S3.SS1.p2.15.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.15.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.15.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.15.m1.2.2.2.2.2.2">𝒚</ci><ci id="S3.SS1.p2.15.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.15.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m1.2c">\boldsymbol{e}_{i}=(\boldsymbol{x}_{i},\boldsymbol{y}_{i})</annotation></semantics></math> contains an input-target pair of the task, which is constructed manually or sampled from the training set.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.5" class="ltx_p">To adapt LLMs like GPT-3 to address the knowledge-based VQA task, the key is to design proper prompts. Given a question <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">q</annotation></semantics></math> and an image <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">v</annotation></semantics></math> as inputs, the VQA task aims to predict a target answer <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">a</annotation></semantics></math>. Since LLMs do not understand images intrinsically, the image needs to be translated into a caption <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">c</annotation></semantics></math> using an off-the-shelf captioning model. PICa formulates the testing input <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">\boldsymbol{x}</annotation></semantics></math> as the following template:</p>
</div>
<figure id="S3.SS1.2" class="ltx_table">
<table id="S3.SS1.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S3.SS1.2.2.2" class="ltx_tr">
<td id="S3.SS1.2.2.2.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">
<span id="S3.SS1.2.2.2.2.1" class="ltx_text ltx_font_typewriter">Context:</span> <math id="S3.SS1.1.1.1.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.1.1.1.1.m1.1a"><mi mathcolor="#0000FF" id="S3.SS1.1.1.1.1.m1.1.1" xref="S3.SS1.1.1.1.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.1.1.1.1.m1.1b"><ci id="S3.SS1.1.1.1.1.m1.1.1.cmml" xref="S3.SS1.1.1.1.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.1.1.1.1.m1.1c">c</annotation></semantics></math> \<span id="S3.SS1.2.2.2.2.2" class="ltx_text ltx_font_typewriter">n</span>  <span id="S3.SS1.2.2.2.2.3" class="ltx_text ltx_font_typewriter">Question:</span> <math id="S3.SS1.2.2.2.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.2.2.2.2.m2.1a"><mi mathcolor="#0000FF" id="S3.SS1.2.2.2.2.m2.1.1" xref="S3.SS1.2.2.2.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.2.2.2.2.m2.1b"><ci id="S3.SS1.2.2.2.2.m2.1.1.cmml" xref="S3.SS1.2.2.2.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.2.2.2.2.m2.1c">q</annotation></semantics></math> \<span id="S3.SS1.2.2.2.2.4" class="ltx_text ltx_font_typewriter">n</span>  <span id="S3.SS1.2.2.2.2.5" class="ltx_text ltx_font_typewriter">Answer:</span>
</td>
</tr>
</table>
</figure>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.1" class="ltx_p">where the variables marked in <span id="S3.SS1.p4.1.1" class="ltx_text" style="color:#0000FF;">blue</span> will be substituted by specific testing inputs. \<span id="S3.SS1.p4.1.2" class="ltx_text ltx_font_typewriter">n</span> stands for a line break in the template. Accordingly, each in-context example <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\boldsymbol{e_{i}}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">𝒆</mi><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝒆</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\boldsymbol{e_{i}}</annotation></semantics></math> is formulated into a similar template as follows:</p>
</div>
<figure id="S3.SS1.5" class="ltx_table">
<table id="S3.SS1.5.3" class="ltx_tabular ltx_align_middle">
<tr id="S3.SS1.5.3.3" class="ltx_tr">
<td id="S3.SS1.5.3.3.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">
<span id="S3.SS1.5.3.3.3.1" class="ltx_text ltx_font_typewriter">Context:</span> <math id="S3.SS1.3.1.1.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS1.3.1.1.1.m1.1a"><msub id="S3.SS1.3.1.1.1.m1.1.1" xref="S3.SS1.3.1.1.1.m1.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS1.3.1.1.1.m1.1.1.2" xref="S3.SS1.3.1.1.1.m1.1.1.2.cmml">c</mi><mi mathcolor="#0000FF" id="S3.SS1.3.1.1.1.m1.1.1.3" xref="S3.SS1.3.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.3.1.1.1.m1.1b"><apply id="S3.SS1.3.1.1.1.m1.1.1.cmml" xref="S3.SS1.3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.3.1.1.1.m1.1.1.1.cmml" xref="S3.SS1.3.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.3.1.1.1.m1.1.1.2.cmml" xref="S3.SS1.3.1.1.1.m1.1.1.2">𝑐</ci><ci id="S3.SS1.3.1.1.1.m1.1.1.3.cmml" xref="S3.SS1.3.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.3.1.1.1.m1.1c">c_{i}</annotation></semantics></math> \<span id="S3.SS1.5.3.3.3.2" class="ltx_text ltx_font_typewriter">n</span>  <span id="S3.SS1.5.3.3.3.3" class="ltx_text ltx_font_typewriter">Question:</span> <math id="S3.SS1.4.2.2.2.m2.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="S3.SS1.4.2.2.2.m2.1a"><msub id="S3.SS1.4.2.2.2.m2.1.1" xref="S3.SS1.4.2.2.2.m2.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS1.4.2.2.2.m2.1.1.2" xref="S3.SS1.4.2.2.2.m2.1.1.2.cmml">q</mi><mi mathcolor="#0000FF" id="S3.SS1.4.2.2.2.m2.1.1.3" xref="S3.SS1.4.2.2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.4.2.2.2.m2.1b"><apply id="S3.SS1.4.2.2.2.m2.1.1.cmml" xref="S3.SS1.4.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.4.2.2.2.m2.1.1.1.cmml" xref="S3.SS1.4.2.2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.4.2.2.2.m2.1.1.2.cmml" xref="S3.SS1.4.2.2.2.m2.1.1.2">𝑞</ci><ci id="S3.SS1.4.2.2.2.m2.1.1.3.cmml" xref="S3.SS1.4.2.2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.4.2.2.2.m2.1c">q_{i}</annotation></semantics></math> \<span id="S3.SS1.5.3.3.3.4" class="ltx_text ltx_font_typewriter">n</span>  <span id="S3.SS1.5.3.3.3.5" class="ltx_text ltx_font_typewriter">Answer:</span> <math id="S3.SS1.5.3.3.3.m3.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS1.5.3.3.3.m3.1a"><msub id="S3.SS1.5.3.3.3.m3.1.1" xref="S3.SS1.5.3.3.3.m3.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS1.5.3.3.3.m3.1.1.2" xref="S3.SS1.5.3.3.3.m3.1.1.2.cmml">a</mi><mi mathcolor="#0000FF" id="S3.SS1.5.3.3.3.m3.1.1.3" xref="S3.SS1.5.3.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.5.3.3.3.m3.1b"><apply id="S3.SS1.5.3.3.3.m3.1.1.cmml" xref="S3.SS1.5.3.3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.5.3.3.3.m3.1.1.1.cmml" xref="S3.SS1.5.3.3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.5.3.3.3.m3.1.1.2.cmml" xref="S3.SS1.5.3.3.3.m3.1.1.2">𝑎</ci><ci id="S3.SS1.5.3.3.3.m3.1.1.3.cmml" xref="S3.SS1.5.3.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.5.3.3.3.m3.1c">a_{i}</annotation></semantics></math>
</td>
</tr>
</table>
</figure>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.p5.3" class="ltx_p">where <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><msub id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mi id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml">c</mi><mi id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2">𝑐</ci><ci id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">c_{i}</annotation></semantics></math>, <math id="S3.SS1.p5.2.m2.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="S3.SS1.p5.2.m2.1a"><msub id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><mi id="S3.SS1.p5.2.m2.1.1.2" xref="S3.SS1.p5.2.m2.1.1.2.cmml">q</mi><mi id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2">𝑞</ci><ci id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">q_{i}</annotation></semantics></math>, and <math id="S3.SS1.p5.3.m3.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS1.p5.3.m3.1a"><msub id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml"><mi id="S3.SS1.p5.3.m3.1.1.2" xref="S3.SS1.p5.3.m3.1.1.2.cmml">a</mi><mi id="S3.SS1.p5.3.m3.1.1.3" xref="S3.SS1.p5.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><apply id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.2.cmml" xref="S3.SS1.p5.3.m3.1.1.2">𝑎</ci><ci id="S3.SS1.p5.3.m3.1.1.3.cmml" xref="S3.SS1.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">a_{i}</annotation></semantics></math> refer to an image-question-answer triplet collected from the training set. The complete prompt of PICa consists of a fixed prompt head, a few in-context examples, and a testing input. This prompt is fed into a frozen LLM for answer prediction.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.1" class="ltx_p">Our Prophet inherits the pipeline of PICa. In addition, we introduce answer heuristics into the prompt structure to better activate the reasoning capability of the LLM, which leads to more accurate answers.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span id="S3.SS2.1.1" class="ltx_text ltx_font_italic">Stage-1: Answer Heuristics Generation</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We introduce two types of answer heuristics: answer candidates and answer-aware examples. Given a testing input consisting of an image and a question, the answer candidates refer to a list of promising answers to the testing input, where each answer is associated with a confidence score. The answer-aware examples refer to a list of in-context examples, where each example has similar answers to the testing input.
Interestingly, these two types of answer heuristics can be obtained simultaneously from any vanilla VQA model trained on specific knowledge-based VQA task.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">As shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.2 Stage-1: Answer Heuristics Generation ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, existing VQA methods can be categorized into <em id="S3.SS2.p2.1.1" class="ltx_emph ltx_font_italic">discriminative</em> and <em id="S3.SS2.p2.1.2" class="ltx_emph ltx_font_italic">generative</em> ones based on the ways they obtain answers. This discrepancy leads to different strategies for answer heuristics generation. We elaborate the strategy for each of the two classes of VQA models below.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2303.01903/assets/x2.png" id="S3.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.4.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Discriminative <em id="S3.F3.5.2.1" class="ltx_emph ltx_font_italic">vs.</em> generative VQA models.<span id="S3.F3.5.2.2" class="ltx_text ltx_font_medium"> Taking an image (V) and a question (Q) as inputs, a typical discriminative VQA model like MCAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> performs multi-class classification to predict the most relevant answer (may contain multiple words) from a predefined answer vocabulary, while a typical generative VQA model like mPLUG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> iteratively predicts one answer word at a time to constitute the final answer.</span></span></figcaption>
</figure>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Discriminative VQA models</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.14" class="ltx_p">Denote a VQA training dataset as <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}=\{(v_{i},q_{i},a_{i})\}_{i=1}^{M}" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mrow id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml">𝒟</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">=</mo><msubsup id="S3.SS2.SSS1.p1.1.m1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.4" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.4.cmml">(</mo><msub id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.5" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">q</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.6" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml">a</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.7" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><eq id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2"></eq><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3">𝒟</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1">subscript</csymbol><set id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1"><vector id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.2">𝑞</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></vector></set><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3"><eq id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">\mathcal{D}=\{(v_{i},q_{i},a_{i})\}_{i=1}^{M}</annotation></semantics></math>, where <math id="S3.SS2.SSS1.p1.2.m2.3" class="ltx_Math" alttext="v_{i},q_{i},a_{i}" display="inline"><semantics id="S3.SS2.SSS1.p1.2.m2.3a"><mrow id="S3.SS2.SSS1.p1.2.m2.3.3.3" xref="S3.SS2.SSS1.p1.2.m2.3.3.4.cmml"><msub id="S3.SS2.SSS1.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.2.m2.3.3.3.4" xref="S3.SS2.SSS1.p1.2.m2.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS1.p1.2.m2.2.2.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.2.cmml">q</mi><mi id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.3" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.2.m2.3.3.3.5" xref="S3.SS2.SSS1.p1.2.m2.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS1.p1.2.m2.3.3.3.3" xref="S3.SS2.SSS1.p1.2.m2.3.3.3.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.3.3.3.3.2" xref="S3.SS2.SSS1.p1.2.m2.3.3.3.3.2.cmml">a</mi><mi id="S3.SS2.SSS1.p1.2.m2.3.3.3.3.3" xref="S3.SS2.SSS1.p1.2.m2.3.3.3.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.3b"><list id="S3.SS2.SSS1.p1.2.m2.3.3.4.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.3.3"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.2">𝑞</ci><ci id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.2.m2.3.3.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.3.3.3.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.3.3.3.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.3.3.3.2">𝑎</ci><ci id="S3.SS2.SSS1.p1.2.m2.3.3.3.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.3.3.3.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.3c">v_{i},q_{i},a_{i}</annotation></semantics></math> refer to the image, question, and answer, respectively. The most frequent answers in the training set form an answer vocabulary <math id="S3.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{V}=\{\boldsymbol{w}_{j}\}_{j=1}^{S}" display="inline"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mrow id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.3.m3.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml">𝒱</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml">=</mo><msubsup id="S3.SS2.SSS1.p1.3.m3.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.2.cmml">j</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3.cmml">S</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><eq id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2"></eq><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3">𝒱</ci><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1">subscript</csymbol><set id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3"><eq id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">\mathcal{V}=\{\boldsymbol{w}_{j}\}_{j=1}^{S}</annotation></semantics></math>, where <math id="S3.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mi id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">S</annotation></semantics></math> is the answer vocabulary size. A discriminative VQA model <math id="S3.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{M}_{\mathrm{disc}}" display="inline"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><msub id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.5.m5.1.1.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS1.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml">disc</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2">ℳ</ci><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3">disc</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">\mathcal{M}_{\mathrm{disc}}</annotation></semantics></math> is learned from <math id="S3.SS2.SSS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><ci id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">\mathcal{D}</annotation></semantics></math> to perform an <math id="S3.SS2.SSS1.p1.7.m7.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.SSS1.p1.7.m7.1a"><mi id="S3.SS2.SSS1.p1.7.m7.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m7.1b"><ci id="S3.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m7.1c">S</annotation></semantics></math>-way classification over the answers. Generally, the model <math id="S3.SS2.SSS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{M}_{\mathrm{disc}}" display="inline"><semantics id="S3.SS2.SSS1.p1.8.m8.1a"><msub id="S3.SS2.SSS1.p1.8.m8.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.8.m8.1.1.2" xref="S3.SS2.SSS1.p1.8.m8.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS1.p1.8.m8.1.1.3" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.cmml">disc</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m8.1b"><apply id="S3.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.2">ℳ</ci><ci id="S3.SS2.SSS1.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3">disc</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m8.1c">\mathcal{M}_{\mathrm{disc}}</annotation></semantics></math> can be separated into two submodels, <em id="S3.SS2.SSS1.p1.14.1" class="ltx_emph ltx_font_italic">i.e.</em>, a backbone <math id="S3.SS2.SSS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{M}^{B}_{\mathrm{disc}}" display="inline"><semantics id="S3.SS2.SSS1.p1.9.m9.1a"><msubsup id="S3.SS2.SSS1.p1.9.m9.1.1" xref="S3.SS2.SSS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.9.m9.1.1.2.2" xref="S3.SS2.SSS1.p1.9.m9.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS2.SSS1.p1.9.m9.1.1.3" xref="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml">disc</mi><mi id="S3.SS2.SSS1.p1.9.m9.1.1.2.3" xref="S3.SS2.SSS1.p1.9.m9.1.1.2.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.9.m9.1b"><apply id="S3.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.2.2">ℳ</ci><ci id="S3.SS2.SSS1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.2.3">𝐵</ci></apply><ci id="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.3">disc</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m9.1c">\mathcal{M}^{B}_{\mathrm{disc}}</annotation></semantics></math> and a prediction head <math id="S3.SS2.SSS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{M}^{H}_{\mathrm{disc}}" display="inline"><semantics id="S3.SS2.SSS1.p1.10.m10.1a"><msubsup id="S3.SS2.SSS1.p1.10.m10.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.10.m10.1.1.2.2" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS2.SSS1.p1.10.m10.1.1.3" xref="S3.SS2.SSS1.p1.10.m10.1.1.3.cmml">disc</mi><mi id="S3.SS2.SSS1.p1.10.m10.1.1.2.3" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.3.cmml">H</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.10.m10.1b"><apply id="S3.SS2.SSS1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.2">ℳ</ci><ci id="S3.SS2.SSS1.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.3">𝐻</ci></apply><ci id="S3.SS2.SSS1.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.3">disc</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.10.m10.1c">\mathcal{M}^{H}_{\mathrm{disc}}</annotation></semantics></math>. The backbone <math id="S3.SS2.SSS1.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{M}^{B}_{\mathrm{disc}}" display="inline"><semantics id="S3.SS2.SSS1.p1.11.m11.1a"><msubsup id="S3.SS2.SSS1.p1.11.m11.1.1" xref="S3.SS2.SSS1.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.11.m11.1.1.2.2" xref="S3.SS2.SSS1.p1.11.m11.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS2.SSS1.p1.11.m11.1.1.3" xref="S3.SS2.SSS1.p1.11.m11.1.1.3.cmml">disc</mi><mi id="S3.SS2.SSS1.p1.11.m11.1.1.2.3" xref="S3.SS2.SSS1.p1.11.m11.1.1.2.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.11.m11.1b"><apply id="S3.SS2.SSS1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1.2.2">ℳ</ci><ci id="S3.SS2.SSS1.p1.11.m11.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1.2.3">𝐵</ci></apply><ci id="S3.SS2.SSS1.p1.11.m11.1.1.3.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1.3">disc</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.11.m11.1c">\mathcal{M}^{B}_{\mathrm{disc}}</annotation></semantics></math> acts as an encoder to fuse multimodal inputs <math id="S3.SS2.SSS1.p1.12.m12.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS2.SSS1.p1.12.m12.1a"><mi id="S3.SS2.SSS1.p1.12.m12.1.1" xref="S3.SS2.SSS1.p1.12.m12.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.12.m12.1b"><ci id="S3.SS2.SSS1.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.12.m12.1c">v</annotation></semantics></math> and <math id="S3.SS2.SSS1.p1.13.m13.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p1.13.m13.1a"><mi id="S3.SS2.SSS1.p1.13.m13.1.1" xref="S3.SS2.SSS1.p1.13.m13.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.13.m13.1b"><ci id="S3.SS2.SSS1.p1.13.m13.1.1.cmml" xref="S3.SS2.SSS1.p1.13.m13.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.13.m13.1c">q</annotation></semantics></math> and obtain a fused feature <math id="S3.SS2.SSS1.p1.14.m14.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS2.SSS1.p1.14.m14.1a"><mi id="S3.SS2.SSS1.p1.14.m14.1.1" xref="S3.SS2.SSS1.p1.14.m14.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.14.m14.1b"><ci id="S3.SS2.SSS1.p1.14.m14.1.1.cmml" xref="S3.SS2.SSS1.p1.14.m14.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.14.m14.1c">z</annotation></semantics></math>:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="{z}=\mathcal{M}^{B}_{\mathrm{disc}}(v,q)" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.3" xref="S3.E2.m1.2.3.cmml"><mi id="S3.E2.m1.2.3.2" xref="S3.E2.m1.2.3.2.cmml">z</mi><mo id="S3.E2.m1.2.3.1" xref="S3.E2.m1.2.3.1.cmml">=</mo><mrow id="S3.E2.m1.2.3.3" xref="S3.E2.m1.2.3.3.cmml"><msubsup id="S3.E2.m1.2.3.3.2" xref="S3.E2.m1.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.3.3.2.2.2" xref="S3.E2.m1.2.3.3.2.2.2.cmml">ℳ</mi><mi id="S3.E2.m1.2.3.3.2.3" xref="S3.E2.m1.2.3.3.2.3.cmml">disc</mi><mi id="S3.E2.m1.2.3.3.2.2.3" xref="S3.E2.m1.2.3.3.2.2.3.cmml">B</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.3.3.1" xref="S3.E2.m1.2.3.3.1.cmml">​</mo><mrow id="S3.E2.m1.2.3.3.3.2" xref="S3.E2.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.3.3.3.2.1" xref="S3.E2.m1.2.3.3.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">v</mi><mo id="S3.E2.m1.2.3.3.3.2.2" xref="S3.E2.m1.2.3.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">q</mi><mo stretchy="false" id="S3.E2.m1.2.3.3.3.2.3" xref="S3.E2.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.3.cmml" xref="S3.E2.m1.2.3"><eq id="S3.E2.m1.2.3.1.cmml" xref="S3.E2.m1.2.3.1"></eq><ci id="S3.E2.m1.2.3.2.cmml" xref="S3.E2.m1.2.3.2">𝑧</ci><apply id="S3.E2.m1.2.3.3.cmml" xref="S3.E2.m1.2.3.3"><times id="S3.E2.m1.2.3.3.1.cmml" xref="S3.E2.m1.2.3.3.1"></times><apply id="S3.E2.m1.2.3.3.2.cmml" xref="S3.E2.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.1.cmml" xref="S3.E2.m1.2.3.3.2">subscript</csymbol><apply id="S3.E2.m1.2.3.3.2.2.cmml" xref="S3.E2.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.2.1.cmml" xref="S3.E2.m1.2.3.3.2">superscript</csymbol><ci id="S3.E2.m1.2.3.3.2.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2.2">ℳ</ci><ci id="S3.E2.m1.2.3.3.2.2.3.cmml" xref="S3.E2.m1.2.3.3.2.2.3">𝐵</ci></apply><ci id="S3.E2.m1.2.3.3.2.3.cmml" xref="S3.E2.m1.2.3.3.2.3">disc</ci></apply><interval closure="open" id="S3.E2.m1.2.3.3.3.1.cmml" xref="S3.E2.m1.2.3.3.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑣</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑞</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">{z}=\mathcal{M}^{B}_{\mathrm{disc}}(v,q)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p1.17" class="ltx_p">The prediction head <math id="S3.SS2.SSS1.p1.15.m1.1" class="ltx_Math" alttext="\mathcal{M}_{H}" display="inline"><semantics id="S3.SS2.SSS1.p1.15.m1.1a"><msub id="S3.SS2.SSS1.p1.15.m1.1.1" xref="S3.SS2.SSS1.p1.15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.15.m1.1.1.2" xref="S3.SS2.SSS1.p1.15.m1.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS1.p1.15.m1.1.1.3" xref="S3.SS2.SSS1.p1.15.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.15.m1.1b"><apply id="S3.SS2.SSS1.p1.15.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.15.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.15.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.15.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.15.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.15.m1.1.1.2">ℳ</ci><ci id="S3.SS2.SSS1.p1.15.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.15.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.15.m1.1c">\mathcal{M}_{H}</annotation></semantics></math> simply adopts a linear layer followed by a sigmoid function to project the fused feature <math id="S3.SS2.SSS1.p1.16.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS2.SSS1.p1.16.m2.1a"><mi id="S3.SS2.SSS1.p1.16.m2.1.1" xref="S3.SS2.SSS1.p1.16.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.16.m2.1b"><ci id="S3.SS2.SSS1.p1.16.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.16.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.16.m2.1c">z</annotation></semantics></math> into a score vector <math id="S3.SS2.SSS1.p1.17.m3.1" class="ltx_Math" alttext="y\in\mathbb{R}^{S}" display="inline"><semantics id="S3.SS2.SSS1.p1.17.m3.1a"><mrow id="S3.SS2.SSS1.p1.17.m3.1.1" xref="S3.SS2.SSS1.p1.17.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p1.17.m3.1.1.2" xref="S3.SS2.SSS1.p1.17.m3.1.1.2.cmml">y</mi><mo id="S3.SS2.SSS1.p1.17.m3.1.1.1" xref="S3.SS2.SSS1.p1.17.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p1.17.m3.1.1.3" xref="S3.SS2.SSS1.p1.17.m3.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.17.m3.1.1.3.2" xref="S3.SS2.SSS1.p1.17.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS1.p1.17.m3.1.1.3.3" xref="S3.SS2.SSS1.p1.17.m3.1.1.3.3.cmml">S</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.17.m3.1b"><apply id="S3.SS2.SSS1.p1.17.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.17.m3.1.1"><in id="S3.SS2.SSS1.p1.17.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.17.m3.1.1.1"></in><ci id="S3.SS2.SSS1.p1.17.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.17.m3.1.1.2">𝑦</ci><apply id="S3.SS2.SSS1.p1.17.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.17.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.17.m3.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.17.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.17.m3.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.17.m3.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS1.p1.17.m3.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.17.m3.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.17.m3.1c">y\in\mathbb{R}^{S}</annotation></semantics></math> over the answer vocabulary:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="{y}=\mathcal{M}^{H}_{\mathrm{disc}}({z})" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.2" xref="S3.E3.m1.1.2.cmml"><mi id="S3.E3.m1.1.2.2" xref="S3.E3.m1.1.2.2.cmml">y</mi><mo id="S3.E3.m1.1.2.1" xref="S3.E3.m1.1.2.1.cmml">=</mo><mrow id="S3.E3.m1.1.2.3" xref="S3.E3.m1.1.2.3.cmml"><msubsup id="S3.E3.m1.1.2.3.2" xref="S3.E3.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.2.3.2.2.2" xref="S3.E3.m1.1.2.3.2.2.2.cmml">ℳ</mi><mi id="S3.E3.m1.1.2.3.2.3" xref="S3.E3.m1.1.2.3.2.3.cmml">disc</mi><mi id="S3.E3.m1.1.2.3.2.2.3" xref="S3.E3.m1.1.2.3.2.2.3.cmml">H</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.2.3.1" xref="S3.E3.m1.1.2.3.1.cmml">​</mo><mrow id="S3.E3.m1.1.2.3.3.2" xref="S3.E3.m1.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.1.2.3.3.2.1" xref="S3.E3.m1.1.2.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">z</mi><mo stretchy="false" id="S3.E3.m1.1.2.3.3.2.2" xref="S3.E3.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.2.cmml" xref="S3.E3.m1.1.2"><eq id="S3.E3.m1.1.2.1.cmml" xref="S3.E3.m1.1.2.1"></eq><ci id="S3.E3.m1.1.2.2.cmml" xref="S3.E3.m1.1.2.2">𝑦</ci><apply id="S3.E3.m1.1.2.3.cmml" xref="S3.E3.m1.1.2.3"><times id="S3.E3.m1.1.2.3.1.cmml" xref="S3.E3.m1.1.2.3.1"></times><apply id="S3.E3.m1.1.2.3.2.cmml" xref="S3.E3.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.1.cmml" xref="S3.E3.m1.1.2.3.2">subscript</csymbol><apply id="S3.E3.m1.1.2.3.2.2.cmml" xref="S3.E3.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.2.1.cmml" xref="S3.E3.m1.1.2.3.2">superscript</csymbol><ci id="S3.E3.m1.1.2.3.2.2.2.cmml" xref="S3.E3.m1.1.2.3.2.2.2">ℳ</ci><ci id="S3.E3.m1.1.2.3.2.2.3.cmml" xref="S3.E3.m1.1.2.3.2.2.3">𝐻</ci></apply><ci id="S3.E3.m1.1.2.3.2.3.cmml" xref="S3.E3.m1.1.2.3.2.3">disc</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">{y}=\mathcal{M}^{H}_{\mathrm{disc}}({z})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p1.27" class="ltx_p">where the <math id="S3.SS2.SSS1.p1.18.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS1.p1.18.m1.1a"><mi id="S3.SS2.SSS1.p1.18.m1.1.1" xref="S3.SS2.SSS1.p1.18.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.18.m1.1b"><ci id="S3.SS2.SSS1.p1.18.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.18.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.18.m1.1c">i</annotation></semantics></math>-th element of <math id="S3.SS2.SSS1.p1.19.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.SSS1.p1.19.m2.1a"><mi id="S3.SS2.SSS1.p1.19.m2.1.1" xref="S3.SS2.SSS1.p1.19.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.19.m2.1b"><ci id="S3.SS2.SSS1.p1.19.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.19.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.19.m2.1c">y</annotation></semantics></math> represents the confidence score for answer <math id="S3.SS2.SSS1.p1.20.m3.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}" display="inline"><semantics id="S3.SS2.SSS1.p1.20.m3.1a"><msub id="S3.SS2.SSS1.p1.20.m3.1.1" xref="S3.SS2.SSS1.p1.20.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p1.20.m3.1.1.2" xref="S3.SS2.SSS1.p1.20.m3.1.1.2.cmml">𝒘</mi><mi id="S3.SS2.SSS1.p1.20.m3.1.1.3" xref="S3.SS2.SSS1.p1.20.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.20.m3.1b"><apply id="S3.SS2.SSS1.p1.20.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.20.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.20.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.20.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.20.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.20.m3.1.1.2">𝒘</ci><ci id="S3.SS2.SSS1.p1.20.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.20.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.20.m3.1c">\boldsymbol{w}_{i}</annotation></semantics></math>. Based on the above definitions, we explain how to generate the two types of answer heuristics below.
Note that although the learned VQA model <math id="S3.SS2.SSS1.p1.21.m4.1" class="ltx_Math" alttext="\mathcal{M}_{\mathrm{disc}}" display="inline"><semantics id="S3.SS2.SSS1.p1.21.m4.1a"><msub id="S3.SS2.SSS1.p1.21.m4.1.1" xref="S3.SS2.SSS1.p1.21.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.21.m4.1.1.2" xref="S3.SS2.SSS1.p1.21.m4.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS1.p1.21.m4.1.1.3" xref="S3.SS2.SSS1.p1.21.m4.1.1.3.cmml">disc</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.21.m4.1b"><apply id="S3.SS2.SSS1.p1.21.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.21.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.21.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.21.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.21.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.21.m4.1.1.2">ℳ</ci><ci id="S3.SS2.SSS1.p1.21.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.21.m4.1.1.3">disc</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.21.m4.1c">\mathcal{M}_{\mathrm{disc}}</annotation></semantics></math> does not incorporate any external knowledge, it can be used for knowledge-based VQA when trained properly. We regard it as a reference model and compare its performance to Prophet in the experiments to show the effectiveness of LLM for knowledge-based VQA.


<br class="ltx_break"><span id="S3.SS2.SSS1.p1.27.1" class="ltx_text ltx_font_bold">Answer candidates.</span> Given a testing input <math id="S3.SS2.SSS1.p1.22.m5.2" class="ltx_Math" alttext="(v,q)" display="inline"><semantics id="S3.SS2.SSS1.p1.22.m5.2a"><mrow id="S3.SS2.SSS1.p1.22.m5.2.3.2" xref="S3.SS2.SSS1.p1.22.m5.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.22.m5.2.3.2.1" xref="S3.SS2.SSS1.p1.22.m5.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS1.p1.22.m5.1.1" xref="S3.SS2.SSS1.p1.22.m5.1.1.cmml">v</mi><mo id="S3.SS2.SSS1.p1.22.m5.2.3.2.2" xref="S3.SS2.SSS1.p1.22.m5.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p1.22.m5.2.2" xref="S3.SS2.SSS1.p1.22.m5.2.2.cmml">q</mi><mo stretchy="false" id="S3.SS2.SSS1.p1.22.m5.2.3.2.3" xref="S3.SS2.SSS1.p1.22.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.22.m5.2b"><interval closure="open" id="S3.SS2.SSS1.p1.22.m5.2.3.1.cmml" xref="S3.SS2.SSS1.p1.22.m5.2.3.2"><ci id="S3.SS2.SSS1.p1.22.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.22.m5.1.1">𝑣</ci><ci id="S3.SS2.SSS1.p1.22.m5.2.2.cmml" xref="S3.SS2.SSS1.p1.22.m5.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.22.m5.2c">(v,q)</annotation></semantics></math>, we obtain its score vector <math id="S3.SS2.SSS1.p1.23.m6.1" class="ltx_Math" alttext="{y}" display="inline"><semantics id="S3.SS2.SSS1.p1.23.m6.1a"><mi id="S3.SS2.SSS1.p1.23.m6.1.1" xref="S3.SS2.SSS1.p1.23.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.23.m6.1b"><ci id="S3.SS2.SSS1.p1.23.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.23.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.23.m6.1c">{y}</annotation></semantics></math> for all answers using Eq.(<a href="#S3.E3" title="In 3.2.1 Discriminative VQA models ‣ 3.2 Stage-1: Answer Heuristics Generation ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Denoting <math id="S3.SS2.SSS1.p1.24.m7.1" class="ltx_Math" alttext="s_{i}\in\mathbb{R}^{+}" display="inline"><semantics id="S3.SS2.SSS1.p1.24.m7.1a"><mrow id="S3.SS2.SSS1.p1.24.m7.1.1" xref="S3.SS2.SSS1.p1.24.m7.1.1.cmml"><msub id="S3.SS2.SSS1.p1.24.m7.1.1.2" xref="S3.SS2.SSS1.p1.24.m7.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.24.m7.1.1.2.2" xref="S3.SS2.SSS1.p1.24.m7.1.1.2.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.24.m7.1.1.2.3" xref="S3.SS2.SSS1.p1.24.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.24.m7.1.1.1" xref="S3.SS2.SSS1.p1.24.m7.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p1.24.m7.1.1.3" xref="S3.SS2.SSS1.p1.24.m7.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.24.m7.1.1.3.2" xref="S3.SS2.SSS1.p1.24.m7.1.1.3.2.cmml">ℝ</mi><mo id="S3.SS2.SSS1.p1.24.m7.1.1.3.3" xref="S3.SS2.SSS1.p1.24.m7.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.24.m7.1b"><apply id="S3.SS2.SSS1.p1.24.m7.1.1.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1"><in id="S3.SS2.SSS1.p1.24.m7.1.1.1.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.1"></in><apply id="S3.SS2.SSS1.p1.24.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.24.m7.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.24.m7.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.2.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.24.m7.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.24.m7.1.1.3.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.24.m7.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.24.m7.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.3.2">ℝ</ci><plus id="S3.SS2.SSS1.p1.24.m7.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.24.m7.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.24.m7.1c">s_{i}\in\mathbb{R}^{+}</annotation></semantics></math> as the <math id="S3.SS2.SSS1.p1.25.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS1.p1.25.m8.1a"><mi id="S3.SS2.SSS1.p1.25.m8.1.1" xref="S3.SS2.SSS1.p1.25.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.25.m8.1b"><ci id="S3.SS2.SSS1.p1.25.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.25.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.25.m8.1c">i</annotation></semantics></math>-th element of <math id="S3.SS2.SSS1.p1.26.m9.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.SSS1.p1.26.m9.1a"><mi id="S3.SS2.SSS1.p1.26.m9.1.1" xref="S3.SS2.SSS1.p1.26.m9.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.26.m9.1b"><ci id="S3.SS2.SSS1.p1.26.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.26.m9.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.26.m9.1c">y</annotation></semantics></math>, we obtain the top-<math id="S3.SS2.SSS1.p1.27.m10.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS1.p1.27.m10.1a"><mi id="S3.SS2.SSS1.p1.27.m10.1.1" xref="S3.SS2.SSS1.p1.27.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.27.m10.1b"><ci id="S3.SS2.SSS1.p1.27.m10.1.1.cmml" xref="S3.SS2.SSS1.p1.27.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.27.m10.1c">K</annotation></semantics></math> answers with the highest scores as follows:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\mathcal{I}_{\textrm{AC}}=\mathop{\text{argTopK}}\limits_{j\in\{1,2,...,S\}}s_{j}" display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.5" xref="S3.E4.m1.4.5.cmml"><msub id="S3.E4.m1.4.5.2" xref="S3.E4.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.5.2.2" xref="S3.E4.m1.4.5.2.2.cmml">ℐ</mi><mtext id="S3.E4.m1.4.5.2.3" xref="S3.E4.m1.4.5.2.3a.cmml">AC</mtext></msub><mo id="S3.E4.m1.4.5.1" xref="S3.E4.m1.4.5.1.cmml">=</mo><mrow id="S3.E4.m1.4.5.3" xref="S3.E4.m1.4.5.3.cmml"><munder id="S3.E4.m1.4.5.3.1" xref="S3.E4.m1.4.5.3.1.cmml"><mtext id="S3.E4.m1.4.5.3.1.2" xref="S3.E4.m1.4.5.3.1.2a.cmml">argTopK</mtext><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><mi id="S3.E4.m1.4.4.4.6" xref="S3.E4.m1.4.4.4.6.cmml">j</mi><mo id="S3.E4.m1.4.4.4.5" xref="S3.E4.m1.4.4.4.5.cmml">∈</mo><mrow id="S3.E4.m1.4.4.4.7.2" xref="S3.E4.m1.4.4.4.7.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.7.2.1" xref="S3.E4.m1.4.4.4.7.1.cmml">{</mo><mn id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">1</mn><mo id="S3.E4.m1.4.4.4.7.2.2" xref="S3.E4.m1.4.4.4.7.1.cmml">,</mo><mn id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">2</mn><mo id="S3.E4.m1.4.4.4.7.2.3" xref="S3.E4.m1.4.4.4.7.1.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.cmml">…</mi><mo id="S3.E4.m1.4.4.4.7.2.4" xref="S3.E4.m1.4.4.4.7.1.cmml">,</mo><mi id="S3.E4.m1.4.4.4.4" xref="S3.E4.m1.4.4.4.4.cmml">S</mi><mo stretchy="false" id="S3.E4.m1.4.4.4.7.2.5" xref="S3.E4.m1.4.4.4.7.1.cmml">}</mo></mrow></mrow></munder><msub id="S3.E4.m1.4.5.3.2" xref="S3.E4.m1.4.5.3.2.cmml"><mi id="S3.E4.m1.4.5.3.2.2" xref="S3.E4.m1.4.5.3.2.2.cmml">s</mi><mi id="S3.E4.m1.4.5.3.2.3" xref="S3.E4.m1.4.5.3.2.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.5.cmml" xref="S3.E4.m1.4.5"><eq id="S3.E4.m1.4.5.1.cmml" xref="S3.E4.m1.4.5.1"></eq><apply id="S3.E4.m1.4.5.2.cmml" xref="S3.E4.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.5.2.1.cmml" xref="S3.E4.m1.4.5.2">subscript</csymbol><ci id="S3.E4.m1.4.5.2.2.cmml" xref="S3.E4.m1.4.5.2.2">ℐ</ci><ci id="S3.E4.m1.4.5.2.3a.cmml" xref="S3.E4.m1.4.5.2.3"><mtext mathsize="70%" id="S3.E4.m1.4.5.2.3.cmml" xref="S3.E4.m1.4.5.2.3">AC</mtext></ci></apply><apply id="S3.E4.m1.4.5.3.cmml" xref="S3.E4.m1.4.5.3"><apply id="S3.E4.m1.4.5.3.1.cmml" xref="S3.E4.m1.4.5.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.5.3.1.1.cmml" xref="S3.E4.m1.4.5.3.1">subscript</csymbol><ci id="S3.E4.m1.4.5.3.1.2a.cmml" xref="S3.E4.m1.4.5.3.1.2"><mtext id="S3.E4.m1.4.5.3.1.2.cmml" xref="S3.E4.m1.4.5.3.1.2">argTopK</mtext></ci><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><in id="S3.E4.m1.4.4.4.5.cmml" xref="S3.E4.m1.4.4.4.5"></in><ci id="S3.E4.m1.4.4.4.6.cmml" xref="S3.E4.m1.4.4.4.6">𝑗</ci><set id="S3.E4.m1.4.4.4.7.1.cmml" xref="S3.E4.m1.4.4.4.7.2"><cn type="integer" id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">1</cn><cn type="integer" id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">2</cn><ci id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3">…</ci><ci id="S3.E4.m1.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4">𝑆</ci></set></apply></apply><apply id="S3.E4.m1.4.5.3.2.cmml" xref="S3.E4.m1.4.5.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.5.3.2.1.cmml" xref="S3.E4.m1.4.5.3.2">subscript</csymbol><ci id="S3.E4.m1.4.5.3.2.2.cmml" xref="S3.E4.m1.4.5.3.2.2">𝑠</ci><ci id="S3.E4.m1.4.5.3.2.3.cmml" xref="S3.E4.m1.4.5.3.2.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\mathcal{I}_{\textrm{AC}}=\mathop{\text{argTopK}}\limits_{j\in\{1,2,...,S\}}s_{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p1.30" class="ltx_p">where <math id="S3.SS2.SSS1.p1.28.m1.1" class="ltx_Math" alttext="\mathcal{I}_{\textrm{AC}}" display="inline"><semantics id="S3.SS2.SSS1.p1.28.m1.1a"><msub id="S3.SS2.SSS1.p1.28.m1.1.1" xref="S3.SS2.SSS1.p1.28.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.28.m1.1.1.2" xref="S3.SS2.SSS1.p1.28.m1.1.1.2.cmml">ℐ</mi><mtext id="S3.SS2.SSS1.p1.28.m1.1.1.3" xref="S3.SS2.SSS1.p1.28.m1.1.1.3a.cmml">AC</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.28.m1.1b"><apply id="S3.SS2.SSS1.p1.28.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.28.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.28.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.28.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.28.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.28.m1.1.1.2">ℐ</ci><ci id="S3.SS2.SSS1.p1.28.m1.1.1.3a.cmml" xref="S3.SS2.SSS1.p1.28.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS1.p1.28.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.28.m1.1.1.3">AC</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.28.m1.1c">\mathcal{I}_{\textrm{AC}}</annotation></semantics></math> denotes an index set of the top-<math id="S3.SS2.SSS1.p1.29.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS1.p1.29.m2.1a"><mi id="S3.SS2.SSS1.p1.29.m2.1.1" xref="S3.SS2.SSS1.p1.29.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.29.m2.1b"><ci id="S3.SS2.SSS1.p1.29.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.29.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.29.m2.1c">K</annotation></semantics></math> answer candidates. The answer candidates <math id="S3.SS2.SSS1.p1.30.m3.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS2.SSS1.p1.30.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.30.m3.1.1" xref="S3.SS2.SSS1.p1.30.m3.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.30.m3.1b"><ci id="S3.SS2.SSS1.p1.30.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.30.m3.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.30.m3.1c">\mathcal{C}</annotation></semantics></math> are defined as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\mathcal{C}=\{(\boldsymbol{w}_{j},s_{j})\ |\ j\in\mathcal{I}_{\textrm{AC}}\}" display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.4" xref="S3.E5.m1.2.2.4.cmml">𝒞</mi><mo id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml">=</mo><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.3.1.cmml">{</mo><mrow id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.2.4" xref="S3.E5.m1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E5.m1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.1.2.2.2.cmml">s</mi><mi id="S3.E5.m1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo rspace="0.222em" stretchy="false" id="S3.E5.m1.1.1.1.1.1.2.5" xref="S3.E5.m1.1.1.1.1.1.3.cmml">)</mo></mrow><mo rspace="0.500em" id="S3.E5.m1.2.2.2.2.4" xref="S3.E5.m1.2.2.2.3.1.cmml">|</mo><mrow id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml">j</mi><mo id="S3.E5.m1.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.1.cmml">∈</mo><msub id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.2.2.2.3.2" xref="S3.E5.m1.2.2.2.2.2.3.2.cmml">ℐ</mi><mtext id="S3.E5.m1.2.2.2.2.2.3.3" xref="S3.E5.m1.2.2.2.2.2.3.3a.cmml">AC</mtext></msub></mrow><mo stretchy="false" id="S3.E5.m1.2.2.2.2.5" xref="S3.E5.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"></eq><ci id="S3.E5.m1.2.2.4.cmml" xref="S3.E5.m1.2.2.4">𝒞</ci><apply id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2"><apply id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.2">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"><in id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1"></in><ci id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2">𝑗</ci><apply id="S3.E5.m1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.2.3.2">ℐ</ci><ci id="S3.E5.m1.2.2.2.2.2.3.3a.cmml" xref="S3.E5.m1.2.2.2.2.2.3.3"><mtext mathsize="70%" id="S3.E5.m1.2.2.2.2.2.3.3.cmml" xref="S3.E5.m1.2.2.2.2.2.3.3">AC</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\mathcal{C}=\{(\boldsymbol{w}_{j},s_{j})\ |\ j\in\mathcal{I}_{\textrm{AC}}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p1.34" class="ltx_p">where <math id="S3.SS2.SSS1.p1.31.m1.1" class="ltx_Math" alttext="\boldsymbol{w}_{j}" display="inline"><semantics id="S3.SS2.SSS1.p1.31.m1.1a"><msub id="S3.SS2.SSS1.p1.31.m1.1.1" xref="S3.SS2.SSS1.p1.31.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.31.m1.1.1.2" xref="S3.SS2.SSS1.p1.31.m1.1.1.2.cmml">𝒘</mi><mi id="S3.SS2.SSS1.p1.31.m1.1.1.3" xref="S3.SS2.SSS1.p1.31.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.31.m1.1b"><apply id="S3.SS2.SSS1.p1.31.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.31.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.31.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.31.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.31.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.31.m1.1.1.2">𝒘</ci><ci id="S3.SS2.SSS1.p1.31.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.31.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.31.m1.1c">\boldsymbol{w}_{j}</annotation></semantics></math> and <math id="S3.SS2.SSS1.p1.32.m2.1" class="ltx_Math" alttext="s_{j}" display="inline"><semantics id="S3.SS2.SSS1.p1.32.m2.1a"><msub id="S3.SS2.SSS1.p1.32.m2.1.1" xref="S3.SS2.SSS1.p1.32.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.32.m2.1.1.2" xref="S3.SS2.SSS1.p1.32.m2.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.32.m2.1.1.3" xref="S3.SS2.SSS1.p1.32.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.32.m2.1b"><apply id="S3.SS2.SSS1.p1.32.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.32.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.32.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.32.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.32.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.32.m2.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.32.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.32.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.32.m2.1c">s_{j}</annotation></semantics></math> are an answer candidate and its confidence score, respectively. To make the formats of the in-context examples and testing input consistent, for each example <math id="S3.SS2.SSS1.p1.33.m3.1" class="ltx_Math" alttext="\boldsymbol{e_{i}}" display="inline"><semantics id="S3.SS2.SSS1.p1.33.m3.1a"><msub id="S3.SS2.SSS1.p1.33.m3.1.1" xref="S3.SS2.SSS1.p1.33.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p1.33.m3.1.1.2" xref="S3.SS2.SSS1.p1.33.m3.1.1.2.cmml">𝒆</mi><mi id="S3.SS2.SSS1.p1.33.m3.1.1.3" xref="S3.SS2.SSS1.p1.33.m3.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.33.m3.1b"><apply id="S3.SS2.SSS1.p1.33.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.33.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.33.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.33.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.33.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.33.m3.1.1.2">𝒆</ci><ci id="S3.SS2.SSS1.p1.33.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.33.m3.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.33.m3.1c">\boldsymbol{e_{i}}</annotation></semantics></math> we also calculate and provide a set of answer candidates <math id="S3.SS2.SSS1.p1.34.m4.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.SS2.SSS1.p1.34.m4.1a"><msub id="S3.SS2.SSS1.p1.34.m4.1.1" xref="S3.SS2.SSS1.p1.34.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.34.m4.1.1.2" xref="S3.SS2.SSS1.p1.34.m4.1.1.2.cmml">𝒞</mi><mi id="S3.SS2.SSS1.p1.34.m4.1.1.3" xref="S3.SS2.SSS1.p1.34.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.34.m4.1b"><apply id="S3.SS2.SSS1.p1.34.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.34.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.34.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.34.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.34.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.34.m4.1.1.2">𝒞</ci><ci id="S3.SS2.SSS1.p1.34.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.34.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.34.m4.1c">\mathcal{C}_{i}</annotation></semantics></math>.


<br class="ltx_break"><span id="S3.SS2.SSS1.p1.34.1" class="ltx_text ltx_font_bold">Answer-aware examples.</span>
Several previous studies have shown that the choice of in-context examples is crucial for GPT-3’s few-shot learning performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Their results motivate us to devise an <em id="S3.SS2.SSS1.p1.34.2" class="ltx_emph ltx_font_italic">answer-aware</em> example selection strategy.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.6" class="ltx_p">Given a testing input <math id="S3.SS2.SSS1.p2.1.m1.2" class="ltx_Math" alttext="(v,q)" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.2a"><mrow id="S3.SS2.SSS1.p2.1.m1.2.3.2" xref="S3.SS2.SSS1.p2.1.m1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.2.3.2.1" xref="S3.SS2.SSS1.p2.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">v</mi><mo id="S3.SS2.SSS1.p2.1.m1.2.3.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p2.1.m1.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.cmml">q</mi><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.2.3.2.3" xref="S3.SS2.SSS1.p2.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.2b"><interval closure="open" id="S3.SS2.SSS1.p2.1.m1.2.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.3.2"><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">𝑣</ci><ci id="S3.SS2.SSS1.p2.1.m1.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.2c">(v,q)</annotation></semantics></math> and any training input <math id="S3.SS2.SSS1.p2.2.m2.2" class="ltx_Math" alttext="(v_{i},q_{i})" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.2a"><mrow id="S3.SS2.SSS1.p2.2.m2.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.2.m2.2.2.2.3" xref="S3.SS2.SSS1.p2.2.m2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS1.p2.2.m2.1.1.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p2.2.m2.2.2.2.4" xref="S3.SS2.SSS1.p2.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.p2.2.m2.2.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.cmml">q</mi><mi id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p2.2.m2.2.2.2.5" xref="S3.SS2.SSS1.p2.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.2b"><interval closure="open" id="S3.SS2.SSS1.p2.2.m2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2"><apply id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2">𝑞</ci><ci id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.2c">(v_{i},q_{i})</annotation></semantics></math>, we can obtain their corresponding fused features <math id="S3.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mi id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><ci id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">z</annotation></semantics></math> and <math id="S3.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><msub id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml">z</mi><mi id="S3.SS2.SSS1.p2.4.m4.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.2">𝑧</ci><ci id="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">z_{i}</annotation></semantics></math> from Eq.(<a href="#S3.E2" title="In 3.2.1 Discriminative VQA models ‣ 3.2 Stage-1: Answer Heuristics Generation ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) using the trained model. Since the fused features are linearly projected for answer prediction, we conjecture that these fused features lie in a <em id="S3.SS2.SSS1.p2.6.1" class="ltx_emph ltx_font_italic">latent answer space</em> that contains rich semantics of the answers to the given image-question pairs. If <math id="S3.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mi id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><ci id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">z</annotation></semantics></math> and <math id="S3.SS2.SSS1.p2.6.m6.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><msub id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml">z</mi><mi id="S3.SS2.SSS1.p2.6.m6.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><apply id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.2">𝑧</ci><ci id="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">z_{i}</annotation></semantics></math> are close in the latent space, they are more likely to share similar answers and image-question inputs.</p>
</div>
<div id="S3.SS2.SSS1.p3" class="ltx_para">
<p id="S3.SS2.SSS1.p3.1" class="ltx_p">We calculate the cosine similarity of the fused feature between the testing input and each training input, then select top-<math id="S3.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><mi id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><ci id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">N</annotation></semantics></math> nearest neighbors in the latent space as the answer-aware examples:</p>
</div>
<div id="S3.SS2.SSS1.p4" class="ltx_para">
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.6" class="ltx_Math" alttext="\mathcal{I}_{\textrm{AE}}=\mathop{\text{argTopN}}\limits_{i\in\{1,2,...,M\}}\frac{{z}^{T}{z}_{i}}{\|{z}\|_{2}\|{z}_{i}\|_{2}}" display="block"><semantics id="S3.E6.m1.6a"><mrow id="S3.E6.m1.6.7" xref="S3.E6.m1.6.7.cmml"><msub id="S3.E6.m1.6.7.2" xref="S3.E6.m1.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.6.7.2.2" xref="S3.E6.m1.6.7.2.2.cmml">ℐ</mi><mtext id="S3.E6.m1.6.7.2.3" xref="S3.E6.m1.6.7.2.3a.cmml">AE</mtext></msub><mo id="S3.E6.m1.6.7.1" xref="S3.E6.m1.6.7.1.cmml">=</mo><mrow id="S3.E6.m1.6.7.3" xref="S3.E6.m1.6.7.3.cmml"><munder id="S3.E6.m1.6.7.3.1" xref="S3.E6.m1.6.7.3.1.cmml"><mtext id="S3.E6.m1.6.7.3.1.2" xref="S3.E6.m1.6.7.3.1.2a.cmml">argTopN</mtext><mrow id="S3.E6.m1.4.4.4" xref="S3.E6.m1.4.4.4.cmml"><mi id="S3.E6.m1.4.4.4.6" xref="S3.E6.m1.4.4.4.6.cmml">i</mi><mo id="S3.E6.m1.4.4.4.5" xref="S3.E6.m1.4.4.4.5.cmml">∈</mo><mrow id="S3.E6.m1.4.4.4.7.2" xref="S3.E6.m1.4.4.4.7.1.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.4.7.2.1" xref="S3.E6.m1.4.4.4.7.1.cmml">{</mo><mn id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">1</mn><mo id="S3.E6.m1.4.4.4.7.2.2" xref="S3.E6.m1.4.4.4.7.1.cmml">,</mo><mn id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">2</mn><mo id="S3.E6.m1.4.4.4.7.2.3" xref="S3.E6.m1.4.4.4.7.1.cmml">,</mo><mi mathvariant="normal" id="S3.E6.m1.3.3.3.3" xref="S3.E6.m1.3.3.3.3.cmml">…</mi><mo id="S3.E6.m1.4.4.4.7.2.4" xref="S3.E6.m1.4.4.4.7.1.cmml">,</mo><mi id="S3.E6.m1.4.4.4.4" xref="S3.E6.m1.4.4.4.4.cmml">M</mi><mo stretchy="false" id="S3.E6.m1.4.4.4.7.2.5" xref="S3.E6.m1.4.4.4.7.1.cmml">}</mo></mrow></mrow></munder><mfrac id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml"><mrow id="S3.E6.m1.6.6.4" xref="S3.E6.m1.6.6.4.cmml"><msup id="S3.E6.m1.6.6.4.2" xref="S3.E6.m1.6.6.4.2.cmml"><mi id="S3.E6.m1.6.6.4.2.2" xref="S3.E6.m1.6.6.4.2.2.cmml">z</mi><mi id="S3.E6.m1.6.6.4.2.3" xref="S3.E6.m1.6.6.4.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.4.1" xref="S3.E6.m1.6.6.4.1.cmml">​</mo><msub id="S3.E6.m1.6.6.4.3" xref="S3.E6.m1.6.6.4.3.cmml"><mi id="S3.E6.m1.6.6.4.3.2" xref="S3.E6.m1.6.6.4.3.2.cmml">z</mi><mi id="S3.E6.m1.6.6.4.3.3" xref="S3.E6.m1.6.6.4.3.3.cmml">i</mi></msub></mrow><mrow id="S3.E6.m1.6.6.2" xref="S3.E6.m1.6.6.2.cmml"><msub id="S3.E6.m1.6.6.2.4" xref="S3.E6.m1.6.6.2.4.cmml"><mrow id="S3.E6.m1.6.6.2.4.2.2" xref="S3.E6.m1.6.6.2.4.2.1.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.2.4.2.2.1" xref="S3.E6.m1.6.6.2.4.2.1.1.cmml">‖</mo><mi id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml">z</mi><mo stretchy="false" id="S3.E6.m1.6.6.2.4.2.2.2" xref="S3.E6.m1.6.6.2.4.2.1.1.cmml">‖</mo></mrow><mn id="S3.E6.m1.6.6.2.4.3" xref="S3.E6.m1.6.6.2.4.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.2.3" xref="S3.E6.m1.6.6.2.3.cmml">​</mo><msub id="S3.E6.m1.6.6.2.2" xref="S3.E6.m1.6.6.2.2.cmml"><mrow id="S3.E6.m1.6.6.2.2.1.1" xref="S3.E6.m1.6.6.2.2.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.2.2.1.1.2" xref="S3.E6.m1.6.6.2.2.1.2.1.cmml">‖</mo><msub id="S3.E6.m1.6.6.2.2.1.1.1" xref="S3.E6.m1.6.6.2.2.1.1.1.cmml"><mi id="S3.E6.m1.6.6.2.2.1.1.1.2" xref="S3.E6.m1.6.6.2.2.1.1.1.2.cmml">z</mi><mi id="S3.E6.m1.6.6.2.2.1.1.1.3" xref="S3.E6.m1.6.6.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.6.6.2.2.1.1.3" xref="S3.E6.m1.6.6.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E6.m1.6.6.2.2.3" xref="S3.E6.m1.6.6.2.2.3.cmml">2</mn></msub></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.6b"><apply id="S3.E6.m1.6.7.cmml" xref="S3.E6.m1.6.7"><eq id="S3.E6.m1.6.7.1.cmml" xref="S3.E6.m1.6.7.1"></eq><apply id="S3.E6.m1.6.7.2.cmml" xref="S3.E6.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.7.2.1.cmml" xref="S3.E6.m1.6.7.2">subscript</csymbol><ci id="S3.E6.m1.6.7.2.2.cmml" xref="S3.E6.m1.6.7.2.2">ℐ</ci><ci id="S3.E6.m1.6.7.2.3a.cmml" xref="S3.E6.m1.6.7.2.3"><mtext mathsize="70%" id="S3.E6.m1.6.7.2.3.cmml" xref="S3.E6.m1.6.7.2.3">AE</mtext></ci></apply><apply id="S3.E6.m1.6.7.3.cmml" xref="S3.E6.m1.6.7.3"><apply id="S3.E6.m1.6.7.3.1.cmml" xref="S3.E6.m1.6.7.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.7.3.1.1.cmml" xref="S3.E6.m1.6.7.3.1">subscript</csymbol><ci id="S3.E6.m1.6.7.3.1.2a.cmml" xref="S3.E6.m1.6.7.3.1.2"><mtext id="S3.E6.m1.6.7.3.1.2.cmml" xref="S3.E6.m1.6.7.3.1.2">argTopN</mtext></ci><apply id="S3.E6.m1.4.4.4.cmml" xref="S3.E6.m1.4.4.4"><in id="S3.E6.m1.4.4.4.5.cmml" xref="S3.E6.m1.4.4.4.5"></in><ci id="S3.E6.m1.4.4.4.6.cmml" xref="S3.E6.m1.4.4.4.6">𝑖</ci><set id="S3.E6.m1.4.4.4.7.1.cmml" xref="S3.E6.m1.4.4.4.7.2"><cn type="integer" id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">1</cn><cn type="integer" id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">2</cn><ci id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3">…</ci><ci id="S3.E6.m1.4.4.4.4.cmml" xref="S3.E6.m1.4.4.4.4">𝑀</ci></set></apply></apply><apply id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6"><divide id="S3.E6.m1.6.6.3.cmml" xref="S3.E6.m1.6.6"></divide><apply id="S3.E6.m1.6.6.4.cmml" xref="S3.E6.m1.6.6.4"><times id="S3.E6.m1.6.6.4.1.cmml" xref="S3.E6.m1.6.6.4.1"></times><apply id="S3.E6.m1.6.6.4.2.cmml" xref="S3.E6.m1.6.6.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.4.2.1.cmml" xref="S3.E6.m1.6.6.4.2">superscript</csymbol><ci id="S3.E6.m1.6.6.4.2.2.cmml" xref="S3.E6.m1.6.6.4.2.2">𝑧</ci><ci id="S3.E6.m1.6.6.4.2.3.cmml" xref="S3.E6.m1.6.6.4.2.3">𝑇</ci></apply><apply id="S3.E6.m1.6.6.4.3.cmml" xref="S3.E6.m1.6.6.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.4.3.1.cmml" xref="S3.E6.m1.6.6.4.3">subscript</csymbol><ci id="S3.E6.m1.6.6.4.3.2.cmml" xref="S3.E6.m1.6.6.4.3.2">𝑧</ci><ci id="S3.E6.m1.6.6.4.3.3.cmml" xref="S3.E6.m1.6.6.4.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.6.6.2.cmml" xref="S3.E6.m1.6.6.2"><times id="S3.E6.m1.6.6.2.3.cmml" xref="S3.E6.m1.6.6.2.3"></times><apply id="S3.E6.m1.6.6.2.4.cmml" xref="S3.E6.m1.6.6.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.4.1.cmml" xref="S3.E6.m1.6.6.2.4">subscript</csymbol><apply id="S3.E6.m1.6.6.2.4.2.1.cmml" xref="S3.E6.m1.6.6.2.4.2.2"><csymbol cd="latexml" id="S3.E6.m1.6.6.2.4.2.1.1.cmml" xref="S3.E6.m1.6.6.2.4.2.2.1">norm</csymbol><ci id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1">𝑧</ci></apply><cn type="integer" id="S3.E6.m1.6.6.2.4.3.cmml" xref="S3.E6.m1.6.6.2.4.3">2</cn></apply><apply id="S3.E6.m1.6.6.2.2.cmml" xref="S3.E6.m1.6.6.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.2.2.cmml" xref="S3.E6.m1.6.6.2.2">subscript</csymbol><apply id="S3.E6.m1.6.6.2.2.1.2.cmml" xref="S3.E6.m1.6.6.2.2.1.1"><csymbol cd="latexml" id="S3.E6.m1.6.6.2.2.1.2.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.2">norm</csymbol><apply id="S3.E6.m1.6.6.2.2.1.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.2.1.1.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.6.6.2.2.1.1.1.2.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.2">𝑧</ci><ci id="S3.E6.m1.6.6.2.2.1.1.1.3.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S3.E6.m1.6.6.2.2.3.cmml" xref="S3.E6.m1.6.6.2.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.6c">\mathcal{I}_{\textrm{AE}}=\mathop{\text{argTopN}}\limits_{i\in\{1,2,...,M\}}\frac{{z}^{T}{z}_{i}}{\|{z}\|_{2}\|{z}_{i}\|_{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p4.4" class="ltx_p">where <math id="S3.SS2.SSS1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{I}_{\textrm{AE}}" display="inline"><semantics id="S3.SS2.SSS1.p4.1.m1.1a"><msub id="S3.SS2.SSS1.p4.1.m1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.1.m1.1.1.2" xref="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml">ℐ</mi><mtext id="S3.SS2.SSS1.p4.1.m1.1.1.3" xref="S3.SS2.SSS1.p4.1.m1.1.1.3a.cmml">AE</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.1.m1.1b"><apply id="S3.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.2">ℐ</ci><ci id="S3.SS2.SSS1.p4.1.m1.1.1.3a.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS1.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.3">AE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.1.m1.1c">\mathcal{I}_{\textrm{AE}}</annotation></semantics></math> is an index set of the top-<math id="S3.SS2.SSS1.p4.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS1.p4.2.m2.1a"><mi id="S3.SS2.SSS1.p4.2.m2.1.1" xref="S3.SS2.SSS1.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.2.m2.1b"><ci id="S3.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.2.m2.1c">N</annotation></semantics></math> similar samples in <math id="S3.SS2.SSS1.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS2.SSS1.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.3.m3.1.1" xref="S3.SS2.SSS1.p4.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.3.m3.1b"><ci id="S3.SS2.SSS1.p4.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.3.m3.1c">\mathcal{D}</annotation></semantics></math>. The answer-aware examples <math id="S3.SS2.SSS1.p4.4.m4.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS2.SSS1.p4.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p4.4.m4.1.1" xref="S3.SS2.SSS1.p4.4.m4.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.4.m4.1b"><ci id="S3.SS2.SSS1.p4.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.4.m4.1c">\mathcal{E}</annotation></semantics></math> are defined as follows:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.2" class="ltx_Math" alttext="\mathcal{E}=\{(v_{i},q_{i},a_{i})\ |\ i\in\mathcal{I}_{\textrm{AE}}\}" display="block"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.4" xref="S3.E7.m1.2.2.4.cmml">ℰ</mi><mo id="S3.E7.m1.2.2.3" xref="S3.E7.m1.2.2.3.cmml">=</mo><mrow id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.2.2.3" xref="S3.E7.m1.2.2.2.3.1.cmml">{</mo><mrow id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.3.4" xref="S3.E7.m1.1.1.1.1.1.4.cmml">(</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.3.5" xref="S3.E7.m1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.E7.m1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.1.2.2.2.cmml">q</mi><mi id="S3.E7.m1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.3.6" xref="S3.E7.m1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.E7.m1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.1.3.3.2.cmml">a</mi><mi id="S3.E7.m1.1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo rspace="0.222em" stretchy="false" id="S3.E7.m1.1.1.1.1.1.3.7" xref="S3.E7.m1.1.1.1.1.1.4.cmml">)</mo></mrow><mo rspace="0.500em" id="S3.E7.m1.2.2.2.2.4" xref="S3.E7.m1.2.2.2.3.1.cmml">|</mo><mrow id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.cmml">i</mi><mo id="S3.E7.m1.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.1.cmml">∈</mo><msub id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.2.2.2.3.2" xref="S3.E7.m1.2.2.2.2.2.3.2.cmml">ℐ</mi><mtext id="S3.E7.m1.2.2.2.2.2.3.3" xref="S3.E7.m1.2.2.2.2.2.3.3a.cmml">AE</mtext></msub></mrow><mo stretchy="false" id="S3.E7.m1.2.2.2.2.5" xref="S3.E7.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><eq id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2.3"></eq><ci id="S3.E7.m1.2.2.4.cmml" xref="S3.E7.m1.2.2.4">ℰ</ci><apply id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2"><csymbol cd="latexml" id="S3.E7.m1.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.3">conditional-set</csymbol><vector id="S3.E7.m1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.3"><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2.2.2">𝑞</ci><ci id="S3.E7.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S3.E7.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3.3.3">𝑖</ci></apply></vector><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><in id="S3.E7.m1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1"></in><ci id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2">𝑖</ci><apply id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.3.2">ℐ</ci><ci id="S3.E7.m1.2.2.2.2.2.3.3a.cmml" xref="S3.E7.m1.2.2.2.2.2.3.3"><mtext mathsize="70%" id="S3.E7.m1.2.2.2.2.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3.3">AE</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\mathcal{E}=\{(v_{i},q_{i},a_{i})\ |\ i\in\mathcal{I}_{\textrm{AE}}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.SSS1.p5" class="ltx_para">
<p id="S3.SS2.SSS1.p5.1" class="ltx_p">Note that the fused features of the training inputs can be computed and stored beforehand, allowing efficient answer-aware example selection.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Generative VQA models</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">Recent state-of-the-art VQA models tend to use generative model architectures due to their remarkable scalability and generalizability <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.p2.6" class="ltx_p">Given the same VQA training dataset <math id="S3.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}=\{(v_{i},q_{i},a_{i})\}_{i=1}^{M}" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mrow id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p2.1.m1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml">𝒟</mi><mo id="S3.SS2.SSS2.p2.1.m1.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml">=</mo><msubsup id="S3.SS2.SSS2.p2.1.m1.1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml"><mrow id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.4" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.4.cmml">(</mo><msub id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.5" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">q</mi><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.6" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.2.cmml">a</mi><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.7" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><apply id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1"><eq id="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2"></eq><ci id="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3">𝒟</ci><apply id="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1">subscript</csymbol><set id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1"><vector id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3"><apply id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.2">𝑞</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></vector></set><apply id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3"><eq id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">\mathcal{D}=\{(v_{i},q_{i},a_{i})\}_{i=1}^{M}</annotation></semantics></math> as above, a generative VQA model <math id="S3.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{M}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><msub id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p2.2.m2.1.1.2" xref="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p2.2.m2.1.1.3" xref="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml">gen</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><apply id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.2">ℳ</ci><ci id="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">\mathcal{M}_{\mathrm{gen}}</annotation></semantics></math> is learned from <math id="S3.SS2.SSS2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS2.SSS2.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p2.3.m3.1.1" xref="S3.SS2.SSS2.p2.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m3.1b"><ci id="S3.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m3.1c">\mathcal{D}</annotation></semantics></math> to generate answers word-by-word from a pre-defined word vocabulary <math id="S3.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{V}=\{w_{j}\}_{j=1}^{S}" display="inline"><semantics id="S3.SS2.SSS2.p2.4.m4.1a"><mrow id="S3.SS2.SSS2.p2.4.m4.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p2.4.m4.1.1.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.3.cmml">𝒱</mi><mo id="S3.SS2.SSS2.p2.4.m4.1.1.2" xref="S3.SS2.SSS2.p2.4.m4.1.1.2.cmml">=</mo><msubsup id="S3.SS2.SSS2.p2.4.m4.1.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.cmml"><mrow id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.2" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.2.cmml">j</mi><mo id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS2.p2.4.m4.1.1.1.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.3.cmml">S</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m4.1b"><apply id="S3.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1"><eq id="S3.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.2"></eq><ci id="S3.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.3">𝒱</ci><apply id="S3.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m4.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1">subscript</csymbol><set id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1"><apply id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3"><eq id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS2.p2.4.m4.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.1.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m4.1c">\mathcal{V}=\{w_{j}\}_{j=1}^{S}</annotation></semantics></math>, where <math id="S3.SS2.SSS2.p2.5.m5.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.SSS2.p2.5.m5.1a"><mi id="S3.SS2.SSS2.p2.5.m5.1.1" xref="S3.SS2.SSS2.p2.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.5.m5.1b"><ci id="S3.SS2.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.5.m5.1c">S</annotation></semantics></math> is the word vocabulary size. Each answer can be represented as a text sequence with a dynamic length of <math id="S3.SS2.SSS2.p2.6.m6.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.SSS2.p2.6.m6.1a"><mi id="S3.SS2.SSS2.p2.6.m6.1.1" xref="S3.SS2.SSS2.p2.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.6.m6.1b"><ci id="S3.SS2.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p2.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.6.m6.1c">L</annotation></semantics></math> words:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.4" class="ltx_Math" alttext="\boldsymbol{w}=(w^{1},w^{2},...,w^{L})" display="block"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml"><mi id="S3.E8.m1.4.4.5" xref="S3.E8.m1.4.4.5.cmml">𝒘</mi><mo id="S3.E8.m1.4.4.4" xref="S3.E8.m1.4.4.4.cmml">=</mo><mrow id="S3.E8.m1.4.4.3.3" xref="S3.E8.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.E8.m1.4.4.3.3.4" xref="S3.E8.m1.4.4.3.4.cmml">(</mo><msup id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">w</mi><mn id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S3.E8.m1.4.4.3.3.5" xref="S3.E8.m1.4.4.3.4.cmml">,</mo><msup id="S3.E8.m1.3.3.2.2.2" xref="S3.E8.m1.3.3.2.2.2.cmml"><mi id="S3.E8.m1.3.3.2.2.2.2" xref="S3.E8.m1.3.3.2.2.2.2.cmml">w</mi><mn id="S3.E8.m1.3.3.2.2.2.3" xref="S3.E8.m1.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S3.E8.m1.4.4.3.3.6" xref="S3.E8.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">…</mi><mo id="S3.E8.m1.4.4.3.3.7" xref="S3.E8.m1.4.4.3.4.cmml">,</mo><msup id="S3.E8.m1.4.4.3.3.3" xref="S3.E8.m1.4.4.3.3.3.cmml"><mi id="S3.E8.m1.4.4.3.3.3.2" xref="S3.E8.m1.4.4.3.3.3.2.cmml">w</mi><mi id="S3.E8.m1.4.4.3.3.3.3" xref="S3.E8.m1.4.4.3.3.3.3.cmml">L</mi></msup><mo stretchy="false" id="S3.E8.m1.4.4.3.3.8" xref="S3.E8.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.4b"><apply id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4"><eq id="S3.E8.m1.4.4.4.cmml" xref="S3.E8.m1.4.4.4"></eq><ci id="S3.E8.m1.4.4.5.cmml" xref="S3.E8.m1.4.4.5">𝒘</ci><vector id="S3.E8.m1.4.4.3.4.cmml" xref="S3.E8.m1.4.4.3.3"><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2">𝑤</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.E8.m1.3.3.2.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.2.2.2.1.cmml" xref="S3.E8.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.E8.m1.3.3.2.2.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2">𝑤</ci><cn type="integer" id="S3.E8.m1.3.3.2.2.2.3.cmml" xref="S3.E8.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">…</ci><apply id="S3.E8.m1.4.4.3.3.3.cmml" xref="S3.E8.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.3.3.3.1.cmml" xref="S3.E8.m1.4.4.3.3.3">superscript</csymbol><ci id="S3.E8.m1.4.4.3.3.3.2.cmml" xref="S3.E8.m1.4.4.3.3.3.2">𝑤</ci><ci id="S3.E8.m1.4.4.3.3.3.3.cmml" xref="S3.E8.m1.4.4.3.3.3.3">𝐿</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.4c">\boldsymbol{w}=(w^{1},w^{2},...,w^{L})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p2.8" class="ltx_p">where <math id="S3.SS2.SSS2.p2.7.m1.1" class="ltx_Math" alttext="w^{1}=[\mathtt{BOS}]" display="inline"><semantics id="S3.SS2.SSS2.p2.7.m1.1a"><mrow id="S3.SS2.SSS2.p2.7.m1.1.2" xref="S3.SS2.SSS2.p2.7.m1.1.2.cmml"><msup id="S3.SS2.SSS2.p2.7.m1.1.2.2" xref="S3.SS2.SSS2.p2.7.m1.1.2.2.cmml"><mi id="S3.SS2.SSS2.p2.7.m1.1.2.2.2" xref="S3.SS2.SSS2.p2.7.m1.1.2.2.2.cmml">w</mi><mn id="S3.SS2.SSS2.p2.7.m1.1.2.2.3" xref="S3.SS2.SSS2.p2.7.m1.1.2.2.3.cmml">1</mn></msup><mo id="S3.SS2.SSS2.p2.7.m1.1.2.1" xref="S3.SS2.SSS2.p2.7.m1.1.2.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p2.7.m1.1.2.3.2" xref="S3.SS2.SSS2.p2.7.m1.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.7.m1.1.2.3.2.1" xref="S3.SS2.SSS2.p2.7.m1.1.2.3.1.1.cmml">[</mo><mi id="S3.SS2.SSS2.p2.7.m1.1.1" xref="S3.SS2.SSS2.p2.7.m1.1.1.cmml">𝙱𝙾𝚂</mi><mo stretchy="false" id="S3.SS2.SSS2.p2.7.m1.1.2.3.2.2" xref="S3.SS2.SSS2.p2.7.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.7.m1.1b"><apply id="S3.SS2.SSS2.p2.7.m1.1.2.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.2"><eq id="S3.SS2.SSS2.p2.7.m1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.2.1"></eq><apply id="S3.SS2.SSS2.p2.7.m1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.7.m1.1.2.2.1.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.2.2">superscript</csymbol><ci id="S3.SS2.SSS2.p2.7.m1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.2.2.2">𝑤</ci><cn type="integer" id="S3.SS2.SSS2.p2.7.m1.1.2.2.3.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.2.2.3">1</cn></apply><apply id="S3.SS2.SSS2.p2.7.m1.1.2.3.1.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.2.3.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p2.7.m1.1.2.3.1.1.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS2.p2.7.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.7.m1.1.1">𝙱𝙾𝚂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.7.m1.1c">w^{1}=[\mathtt{BOS}]</annotation></semantics></math> refers to a special start-of-sentence token and <math id="S3.SS2.SSS2.p2.8.m2.1" class="ltx_Math" alttext="w^{L}=[\mathtt{EOS}]" display="inline"><semantics id="S3.SS2.SSS2.p2.8.m2.1a"><mrow id="S3.SS2.SSS2.p2.8.m2.1.2" xref="S3.SS2.SSS2.p2.8.m2.1.2.cmml"><msup id="S3.SS2.SSS2.p2.8.m2.1.2.2" xref="S3.SS2.SSS2.p2.8.m2.1.2.2.cmml"><mi id="S3.SS2.SSS2.p2.8.m2.1.2.2.2" xref="S3.SS2.SSS2.p2.8.m2.1.2.2.2.cmml">w</mi><mi id="S3.SS2.SSS2.p2.8.m2.1.2.2.3" xref="S3.SS2.SSS2.p2.8.m2.1.2.2.3.cmml">L</mi></msup><mo id="S3.SS2.SSS2.p2.8.m2.1.2.1" xref="S3.SS2.SSS2.p2.8.m2.1.2.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p2.8.m2.1.2.3.2" xref="S3.SS2.SSS2.p2.8.m2.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.8.m2.1.2.3.2.1" xref="S3.SS2.SSS2.p2.8.m2.1.2.3.1.1.cmml">[</mo><mi id="S3.SS2.SSS2.p2.8.m2.1.1" xref="S3.SS2.SSS2.p2.8.m2.1.1.cmml">𝙴𝙾𝚂</mi><mo stretchy="false" id="S3.SS2.SSS2.p2.8.m2.1.2.3.2.2" xref="S3.SS2.SSS2.p2.8.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.8.m2.1b"><apply id="S3.SS2.SSS2.p2.8.m2.1.2.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.2"><eq id="S3.SS2.SSS2.p2.8.m2.1.2.1.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.2.1"></eq><apply id="S3.SS2.SSS2.p2.8.m2.1.2.2.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.8.m2.1.2.2.1.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.2.2">superscript</csymbol><ci id="S3.SS2.SSS2.p2.8.m2.1.2.2.2.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.2.2.2">𝑤</ci><ci id="S3.SS2.SSS2.p2.8.m2.1.2.2.3.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.2.2.3">𝐿</ci></apply><apply id="S3.SS2.SSS2.p2.8.m2.1.2.3.1.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.2.3.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p2.8.m2.1.2.3.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS2.p2.8.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m2.1.1">𝙴𝙾𝚂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.8.m2.1c">w^{L}=[\mathtt{EOS}]</annotation></semantics></math> refers to an end-of-sentence token.</p>
</div>
<div id="S3.SS2.SSS2.p3" class="ltx_para">
<p id="S3.SS2.SSS2.p3.6" class="ltx_p">Similar to the discriminative model, <math id="S3.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{M}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p3.1.m1.1a"><msub id="S3.SS2.SSS2.p3.1.m1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.1.m1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p3.1.m1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.3.cmml">gen</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.1.m1.1b"><apply id="S3.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.2">ℳ</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.1.m1.1c">\mathcal{M}_{\mathrm{gen}}</annotation></semantics></math> can also be separated into a backbone <math id="S3.SS2.SSS2.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{M}^{B}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p3.2.m2.1a"><msubsup id="S3.SS2.SSS2.p3.2.m2.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.2.m2.1.1.2.2" xref="S3.SS2.SSS2.p3.2.m2.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p3.2.m2.1.1.3" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.cmml">gen</mi><mi id="S3.SS2.SSS2.p3.2.m2.1.1.2.3" xref="S3.SS2.SSS2.p3.2.m2.1.1.2.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.2.m2.1b"><apply id="S3.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.2.2">ℳ</ci><ci id="S3.SS2.SSS2.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.2.3">𝐵</ci></apply><ci id="S3.SS2.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.2.m2.1c">\mathcal{M}^{B}_{\mathrm{gen}}</annotation></semantics></math> and a prediction head <math id="S3.SS2.SSS2.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{M}^{H}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p3.3.m3.1a"><msubsup id="S3.SS2.SSS2.p3.3.m3.1.1" xref="S3.SS2.SSS2.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.3.m3.1.1.2.2" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p3.3.m3.1.1.3" xref="S3.SS2.SSS2.p3.3.m3.1.1.3.cmml">gen</mi><mi id="S3.SS2.SSS2.p3.3.m3.1.1.2.3" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.3.cmml">H</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.3.m3.1b"><apply id="S3.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.SSS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.2">ℳ</ci><ci id="S3.SS2.SSS2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.3">𝐻</ci></apply><ci id="S3.SS2.SSS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.3.m3.1c">\mathcal{M}^{H}_{\mathrm{gen}}</annotation></semantics></math>. The backbone <math id="S3.SS2.SSS2.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{M}^{B}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p3.4.m4.1a"><msubsup id="S3.SS2.SSS2.p3.4.m4.1.1" xref="S3.SS2.SSS2.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.4.m4.1.1.2.2" xref="S3.SS2.SSS2.p3.4.m4.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p3.4.m4.1.1.3" xref="S3.SS2.SSS2.p3.4.m4.1.1.3.cmml">gen</mi><mi id="S3.SS2.SSS2.p3.4.m4.1.1.2.3" xref="S3.SS2.SSS2.p3.4.m4.1.1.2.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.4.m4.1b"><apply id="S3.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.SSS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1.2.2">ℳ</ci><ci id="S3.SS2.SSS2.p3.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1.2.3">𝐵</ci></apply><ci id="S3.SS2.SSS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.4.m4.1c">\mathcal{M}^{B}_{\mathrm{gen}}</annotation></semantics></math> corresponds to an encoder-decoder or a pure decoder architecture that fuses multimodal inputs <math id="S3.SS2.SSS2.p3.5.m5.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS2.SSS2.p3.5.m5.1a"><mi id="S3.SS2.SSS2.p3.5.m5.1.1" xref="S3.SS2.SSS2.p3.5.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.5.m5.1b"><ci id="S3.SS2.SSS2.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.5.m5.1c">v</annotation></semantics></math> and <math id="S3.SS2.SSS2.p3.6.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS2.p3.6.m6.1a"><mi id="S3.SS2.SSS2.p3.6.m6.1.1" xref="S3.SS2.SSS2.p3.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.6.m6.1b"><ci id="S3.SS2.SSS2.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p3.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.6.m6.1c">q</annotation></semantics></math>, and then generates latent feature of each answer word using an autoregressive manner:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.4" class="ltx_Math" alttext="z^{l}=\mathcal{M}^{B}_{\mathrm{gen}}(v,q,\boldsymbol{w}^{[l-1]})" display="block"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml"><msup id="S3.E9.m1.4.4.3" xref="S3.E9.m1.4.4.3.cmml"><mi id="S3.E9.m1.4.4.3.2" xref="S3.E9.m1.4.4.3.2.cmml">z</mi><mi id="S3.E9.m1.4.4.3.3" xref="S3.E9.m1.4.4.3.3.cmml">l</mi></msup><mo id="S3.E9.m1.4.4.2" xref="S3.E9.m1.4.4.2.cmml">=</mo><mrow id="S3.E9.m1.4.4.1" xref="S3.E9.m1.4.4.1.cmml"><msubsup id="S3.E9.m1.4.4.1.3" xref="S3.E9.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.4.4.1.3.2.2" xref="S3.E9.m1.4.4.1.3.2.2.cmml">ℳ</mi><mi id="S3.E9.m1.4.4.1.3.3" xref="S3.E9.m1.4.4.1.3.3.cmml">gen</mi><mi id="S3.E9.m1.4.4.1.3.2.3" xref="S3.E9.m1.4.4.1.3.2.3.cmml">B</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.1.2" xref="S3.E9.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E9.m1.4.4.1.1.1" xref="S3.E9.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.1.1.1.2" xref="S3.E9.m1.4.4.1.1.2.cmml">(</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">v</mi><mo id="S3.E9.m1.4.4.1.1.1.3" xref="S3.E9.m1.4.4.1.1.2.cmml">,</mo><mi id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">q</mi><mo id="S3.E9.m1.4.4.1.1.1.4" xref="S3.E9.m1.4.4.1.1.2.cmml">,</mo><msup id="S3.E9.m1.4.4.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.2.cmml">𝒘</mi><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.2.1.cmml">]</mo></mrow></msup><mo stretchy="false" id="S3.E9.m1.4.4.1.1.1.5" xref="S3.E9.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4"><eq id="S3.E9.m1.4.4.2.cmml" xref="S3.E9.m1.4.4.2"></eq><apply id="S3.E9.m1.4.4.3.cmml" xref="S3.E9.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.3.1.cmml" xref="S3.E9.m1.4.4.3">superscript</csymbol><ci id="S3.E9.m1.4.4.3.2.cmml" xref="S3.E9.m1.4.4.3.2">𝑧</ci><ci id="S3.E9.m1.4.4.3.3.cmml" xref="S3.E9.m1.4.4.3.3">𝑙</ci></apply><apply id="S3.E9.m1.4.4.1.cmml" xref="S3.E9.m1.4.4.1"><times id="S3.E9.m1.4.4.1.2.cmml" xref="S3.E9.m1.4.4.1.2"></times><apply id="S3.E9.m1.4.4.1.3.cmml" xref="S3.E9.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.3.1.cmml" xref="S3.E9.m1.4.4.1.3">subscript</csymbol><apply id="S3.E9.m1.4.4.1.3.2.cmml" xref="S3.E9.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.3.2.1.cmml" xref="S3.E9.m1.4.4.1.3">superscript</csymbol><ci id="S3.E9.m1.4.4.1.3.2.2.cmml" xref="S3.E9.m1.4.4.1.3.2.2">ℳ</ci><ci id="S3.E9.m1.4.4.1.3.2.3.cmml" xref="S3.E9.m1.4.4.1.3.2.3">𝐵</ci></apply><ci id="S3.E9.m1.4.4.1.3.3.cmml" xref="S3.E9.m1.4.4.1.3.3">gen</ci></apply><vector id="S3.E9.m1.4.4.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1"><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝑣</ci><ci id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3">𝑞</ci><apply id="S3.E9.m1.4.4.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1">superscript</csymbol><ci id="S3.E9.m1.4.4.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.2">𝒘</ci><apply id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><minus id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"></minus><ci id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3">1</cn></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">z^{l}=\mathcal{M}^{B}_{\mathrm{gen}}(v,q,\boldsymbol{w}^{[l-1]})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p3.11" class="ltx_p">where <math id="S3.SS2.SSS2.p3.7.m1.1" class="ltx_Math" alttext="z^{l}" display="inline"><semantics id="S3.SS2.SSS2.p3.7.m1.1a"><msup id="S3.SS2.SSS2.p3.7.m1.1.1" xref="S3.SS2.SSS2.p3.7.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.7.m1.1.1.2" xref="S3.SS2.SSS2.p3.7.m1.1.1.2.cmml">z</mi><mi id="S3.SS2.SSS2.p3.7.m1.1.1.3" xref="S3.SS2.SSS2.p3.7.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.7.m1.1b"><apply id="S3.SS2.SSS2.p3.7.m1.1.1.cmml" xref="S3.SS2.SSS2.p3.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.7.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.7.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.7.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.7.m1.1.1.2">𝑧</ci><ci id="S3.SS2.SSS2.p3.7.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.7.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.7.m1.1c">z^{l}</annotation></semantics></math> denotes the latent feature of <math id="S3.SS2.SSS2.p3.8.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSS2.p3.8.m2.1a"><mi id="S3.SS2.SSS2.p3.8.m2.1.1" xref="S3.SS2.SSS2.p3.8.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.8.m2.1b"><ci id="S3.SS2.SSS2.p3.8.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.8.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.8.m2.1c">l</annotation></semantics></math>-th answer word.
On top of the latent feature <math id="S3.SS2.SSS2.p3.9.m3.1" class="ltx_Math" alttext="z^{l}" display="inline"><semantics id="S3.SS2.SSS2.p3.9.m3.1a"><msup id="S3.SS2.SSS2.p3.9.m3.1.1" xref="S3.SS2.SSS2.p3.9.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p3.9.m3.1.1.2" xref="S3.SS2.SSS2.p3.9.m3.1.1.2.cmml">z</mi><mi id="S3.SS2.SSS2.p3.9.m3.1.1.3" xref="S3.SS2.SSS2.p3.9.m3.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.9.m3.1b"><apply id="S3.SS2.SSS2.p3.9.m3.1.1.cmml" xref="S3.SS2.SSS2.p3.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.9.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.9.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p3.9.m3.1.1.2">𝑧</ci><ci id="S3.SS2.SSS2.p3.9.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p3.9.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.9.m3.1c">z^{l}</annotation></semantics></math>, the prediction head <math id="S3.SS2.SSS2.p3.10.m4.1" class="ltx_Math" alttext="\mathcal{M}^{H}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p3.10.m4.1a"><msubsup id="S3.SS2.SSS2.p3.10.m4.1.1" xref="S3.SS2.SSS2.p3.10.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.10.m4.1.1.2.2" xref="S3.SS2.SSS2.p3.10.m4.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p3.10.m4.1.1.3" xref="S3.SS2.SSS2.p3.10.m4.1.1.3.cmml">gen</mi><mi id="S3.SS2.SSS2.p3.10.m4.1.1.2.3" xref="S3.SS2.SSS2.p3.10.m4.1.1.2.3.cmml">H</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.10.m4.1b"><apply id="S3.SS2.SSS2.p3.10.m4.1.1.cmml" xref="S3.SS2.SSS2.p3.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p3.10.m4.1.1">subscript</csymbol><apply id="S3.SS2.SSS2.p3.10.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p3.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.m4.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.10.m4.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.10.m4.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.10.m4.1.1.2.2">ℳ</ci><ci id="S3.SS2.SSS2.p3.10.m4.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.10.m4.1.1.2.3">𝐻</ci></apply><ci id="S3.SS2.SSS2.p3.10.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p3.10.m4.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.10.m4.1c">\mathcal{M}^{H}_{\mathrm{gen}}</annotation></semantics></math> applies a linear projection (or a MLP) followed by a softmax function to decode it into a score distribution <math id="S3.SS2.SSS2.p3.11.m5.1" class="ltx_Math" alttext="y^{l}\in\mathbb{R}^{S}" display="inline"><semantics id="S3.SS2.SSS2.p3.11.m5.1a"><mrow id="S3.SS2.SSS2.p3.11.m5.1.1" xref="S3.SS2.SSS2.p3.11.m5.1.1.cmml"><msup id="S3.SS2.SSS2.p3.11.m5.1.1.2" xref="S3.SS2.SSS2.p3.11.m5.1.1.2.cmml"><mi id="S3.SS2.SSS2.p3.11.m5.1.1.2.2" xref="S3.SS2.SSS2.p3.11.m5.1.1.2.2.cmml">y</mi><mi id="S3.SS2.SSS2.p3.11.m5.1.1.2.3" xref="S3.SS2.SSS2.p3.11.m5.1.1.2.3.cmml">l</mi></msup><mo id="S3.SS2.SSS2.p3.11.m5.1.1.1" xref="S3.SS2.SSS2.p3.11.m5.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p3.11.m5.1.1.3" xref="S3.SS2.SSS2.p3.11.m5.1.1.3.cmml"><mi id="S3.SS2.SSS2.p3.11.m5.1.1.3.2" xref="S3.SS2.SSS2.p3.11.m5.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS2.p3.11.m5.1.1.3.3" xref="S3.SS2.SSS2.p3.11.m5.1.1.3.3.cmml">S</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.11.m5.1b"><apply id="S3.SS2.SSS2.p3.11.m5.1.1.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1"><in id="S3.SS2.SSS2.p3.11.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.1"></in><apply id="S3.SS2.SSS2.p3.11.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.11.m5.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.p3.11.m5.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.2.2">𝑦</ci><ci id="S3.SS2.SSS2.p3.11.m5.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS2.p3.11.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.11.m5.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p3.11.m5.1.1.3.2.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS2.p3.11.m5.1.1.3.3.cmml" xref="S3.SS2.SSS2.p3.11.m5.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.11.m5.1c">y^{l}\in\mathbb{R}^{S}</annotation></semantics></math> over the whole word vocabulary:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.1" class="ltx_Math" alttext="y^{l}=\mathcal{M}^{H}_{\mathrm{gen}}(z^{l})" display="block"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><msup id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.3.2" xref="S3.E10.m1.1.1.3.2.cmml">y</mi><mi id="S3.E10.m1.1.1.3.3" xref="S3.E10.m1.1.1.3.3.cmml">l</mi></msup><mo id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><msubsup id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.3.2.2" xref="S3.E10.m1.1.1.1.3.2.2.cmml">ℳ</mi><mi id="S3.E10.m1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.3.3.cmml">gen</mi><mi id="S3.E10.m1.1.1.1.3.2.3" xref="S3.E10.m1.1.1.1.3.2.3.cmml">H</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><eq id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2"></eq><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3">superscript</csymbol><ci id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2">𝑦</ci><ci id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3">𝑙</ci></apply><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><times id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.2"></times><apply id="S3.E10.m1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.3">subscript</csymbol><apply id="S3.E10.m1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.1.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.1.3.2.2">ℳ</ci><ci id="S3.E10.m1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.1.1.1.3.2.3">𝐻</ci></apply><ci id="S3.E10.m1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.3.3">gen</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E10.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">y^{l}=\mathcal{M}^{H}_{\mathrm{gen}}(z^{l})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p3.21" class="ltx_p">where the <math id="S3.SS2.SSS2.p3.12.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSS2.p3.12.m1.1a"><mi id="S3.SS2.SSS2.p3.12.m1.1.1" xref="S3.SS2.SSS2.p3.12.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.12.m1.1b"><ci id="S3.SS2.SSS2.p3.12.m1.1.1.cmml" xref="S3.SS2.SSS2.p3.12.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.12.m1.1c">l</annotation></semantics></math>-th answer word <math id="S3.SS2.SSS2.p3.13.m2.1" class="ltx_Math" alttext="w^{l}" display="inline"><semantics id="S3.SS2.SSS2.p3.13.m2.1a"><msup id="S3.SS2.SSS2.p3.13.m2.1.1" xref="S3.SS2.SSS2.p3.13.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p3.13.m2.1.1.2" xref="S3.SS2.SSS2.p3.13.m2.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS2.p3.13.m2.1.1.3" xref="S3.SS2.SSS2.p3.13.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.13.m2.1b"><apply id="S3.SS2.SSS2.p3.13.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.13.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p3.13.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.13.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p3.13.m2.1.1.2">𝑤</ci><ci id="S3.SS2.SSS2.p3.13.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p3.13.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.13.m2.1c">w^{l}</annotation></semantics></math> is obtained from <math id="S3.SS2.SSS2.p3.14.m3.1" class="ltx_Math" alttext="y^{l}" display="inline"><semantics id="S3.SS2.SSS2.p3.14.m3.1a"><msup id="S3.SS2.SSS2.p3.14.m3.1.1" xref="S3.SS2.SSS2.p3.14.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p3.14.m3.1.1.2" xref="S3.SS2.SSS2.p3.14.m3.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS2.p3.14.m3.1.1.3" xref="S3.SS2.SSS2.p3.14.m3.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.14.m3.1b"><apply id="S3.SS2.SSS2.p3.14.m3.1.1.cmml" xref="S3.SS2.SSS2.p3.14.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.14.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.14.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.14.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p3.14.m3.1.1.2">𝑦</ci><ci id="S3.SS2.SSS2.p3.14.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p3.14.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.14.m3.1c">y^{l}</annotation></semantics></math> by greedily choosing the word with the highest score. Until an <math id="S3.SS2.SSS2.p3.15.m4.1" class="ltx_Math" alttext="[\mathtt{EOS}]" display="inline"><semantics id="S3.SS2.SSS2.p3.15.m4.1a"><mrow id="S3.SS2.SSS2.p3.15.m4.1.2.2" xref="S3.SS2.SSS2.p3.15.m4.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p3.15.m4.1.2.2.1" xref="S3.SS2.SSS2.p3.15.m4.1.2.1.1.cmml">[</mo><mi id="S3.SS2.SSS2.p3.15.m4.1.1" xref="S3.SS2.SSS2.p3.15.m4.1.1.cmml">𝙴𝙾𝚂</mi><mo stretchy="false" id="S3.SS2.SSS2.p3.15.m4.1.2.2.2" xref="S3.SS2.SSS2.p3.15.m4.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.15.m4.1b"><apply id="S3.SS2.SSS2.p3.15.m4.1.2.1.cmml" xref="S3.SS2.SSS2.p3.15.m4.1.2.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p3.15.m4.1.2.1.1.cmml" xref="S3.SS2.SSS2.p3.15.m4.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS2.p3.15.m4.1.1.cmml" xref="S3.SS2.SSS2.p3.15.m4.1.1">𝙴𝙾𝚂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.15.m4.1c">[\mathtt{EOS}]</annotation></semantics></math> token is generated, <math id="S3.SS2.SSS2.p3.16.m5.1" class="ltx_Math" alttext="w^{l}" display="inline"><semantics id="S3.SS2.SSS2.p3.16.m5.1a"><msup id="S3.SS2.SSS2.p3.16.m5.1.1" xref="S3.SS2.SSS2.p3.16.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p3.16.m5.1.1.2" xref="S3.SS2.SSS2.p3.16.m5.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS2.p3.16.m5.1.1.3" xref="S3.SS2.SSS2.p3.16.m5.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.16.m5.1b"><apply id="S3.SS2.SSS2.p3.16.m5.1.1.cmml" xref="S3.SS2.SSS2.p3.16.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.16.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p3.16.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.16.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p3.16.m5.1.1.2">𝑤</ci><ci id="S3.SS2.SSS2.p3.16.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p3.16.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.16.m5.1c">w^{l}</annotation></semantics></math> is appended to <math id="S3.SS2.SSS2.p3.17.m6.1" class="ltx_Math" alttext="\boldsymbol{w}^{[l-1]}" display="inline"><semantics id="S3.SS2.SSS2.p3.17.m6.1a"><msup id="S3.SS2.SSS2.p3.17.m6.1.2" xref="S3.SS2.SSS2.p3.17.m6.1.2.cmml"><mi id="S3.SS2.SSS2.p3.17.m6.1.2.2" xref="S3.SS2.SSS2.p3.17.m6.1.2.2.cmml">𝒘</mi><mrow id="S3.SS2.SSS2.p3.17.m6.1.1.1.1" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.2" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.3" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.2.1.cmml">]</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.17.m6.1b"><apply id="S3.SS2.SSS2.p3.17.m6.1.2.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.17.m6.1.2.1.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.p3.17.m6.1.2.2.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.2.2">𝒘</ci><apply id="S3.SS2.SSS2.p3.17.m6.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p3.17.m6.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1"><minus id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.1"></minus><ci id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.17.m6.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.17.m6.1c">\boldsymbol{w}^{[l-1]}</annotation></semantics></math> to obtain <math id="S3.SS2.SSS2.p3.18.m7.1" class="ltx_Math" alttext="\boldsymbol{w}^{[l]}" display="inline"><semantics id="S3.SS2.SSS2.p3.18.m7.1a"><msup id="S3.SS2.SSS2.p3.18.m7.1.2" xref="S3.SS2.SSS2.p3.18.m7.1.2.cmml"><mi id="S3.SS2.SSS2.p3.18.m7.1.2.2" xref="S3.SS2.SSS2.p3.18.m7.1.2.2.cmml">𝒘</mi><mrow id="S3.SS2.SSS2.p3.18.m7.1.1.1.3" xref="S3.SS2.SSS2.p3.18.m7.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p3.18.m7.1.1.1.3.1" xref="S3.SS2.SSS2.p3.18.m7.1.1.1.2.1.cmml">[</mo><mi id="S3.SS2.SSS2.p3.18.m7.1.1.1.1" xref="S3.SS2.SSS2.p3.18.m7.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.SS2.SSS2.p3.18.m7.1.1.1.3.2" xref="S3.SS2.SSS2.p3.18.m7.1.1.1.2.1.cmml">]</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.18.m7.1b"><apply id="S3.SS2.SSS2.p3.18.m7.1.2.cmml" xref="S3.SS2.SSS2.p3.18.m7.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.18.m7.1.2.1.cmml" xref="S3.SS2.SSS2.p3.18.m7.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.p3.18.m7.1.2.2.cmml" xref="S3.SS2.SSS2.p3.18.m7.1.2.2">𝒘</ci><apply id="S3.SS2.SSS2.p3.18.m7.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.18.m7.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS2.p3.18.m7.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.18.m7.1.1.1.3.1">delimited-[]</csymbol><ci id="S3.SS2.SSS2.p3.18.m7.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.18.m7.1.1.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.18.m7.1c">\boldsymbol{w}^{[l]}</annotation></semantics></math>, which is iteratively fed into the model <math id="S3.SS2.SSS2.p3.19.m8.1" class="ltx_Math" alttext="\mathcal{M}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p3.19.m8.1a"><msub id="S3.SS2.SSS2.p3.19.m8.1.1" xref="S3.SS2.SSS2.p3.19.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.19.m8.1.1.2" xref="S3.SS2.SSS2.p3.19.m8.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p3.19.m8.1.1.3" xref="S3.SS2.SSS2.p3.19.m8.1.1.3.cmml">gen</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.19.m8.1b"><apply id="S3.SS2.SSS2.p3.19.m8.1.1.cmml" xref="S3.SS2.SSS2.p3.19.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.19.m8.1.1.1.cmml" xref="S3.SS2.SSS2.p3.19.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.19.m8.1.1.2.cmml" xref="S3.SS2.SSS2.p3.19.m8.1.1.2">ℳ</ci><ci id="S3.SS2.SSS2.p3.19.m8.1.1.3.cmml" xref="S3.SS2.SSS2.p3.19.m8.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.19.m8.1c">\mathcal{M}_{\mathrm{gen}}</annotation></semantics></math> to predict the next word.


<br class="ltx_break"><span id="S3.SS2.SSS2.p3.21.1" class="ltx_text ltx_font_bold">Answer candidates.</span> Given a testing input <math id="S3.SS2.SSS2.p3.20.m9.2" class="ltx_Math" alttext="(v,q)" display="inline"><semantics id="S3.SS2.SSS2.p3.20.m9.2a"><mrow id="S3.SS2.SSS2.p3.20.m9.2.3.2" xref="S3.SS2.SSS2.p3.20.m9.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p3.20.m9.2.3.2.1" xref="S3.SS2.SSS2.p3.20.m9.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS2.p3.20.m9.1.1" xref="S3.SS2.SSS2.p3.20.m9.1.1.cmml">v</mi><mo id="S3.SS2.SSS2.p3.20.m9.2.3.2.2" xref="S3.SS2.SSS2.p3.20.m9.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS2.p3.20.m9.2.2" xref="S3.SS2.SSS2.p3.20.m9.2.2.cmml">q</mi><mo stretchy="false" id="S3.SS2.SSS2.p3.20.m9.2.3.2.3" xref="S3.SS2.SSS2.p3.20.m9.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.20.m9.2b"><interval closure="open" id="S3.SS2.SSS2.p3.20.m9.2.3.1.cmml" xref="S3.SS2.SSS2.p3.20.m9.2.3.2"><ci id="S3.SS2.SSS2.p3.20.m9.1.1.cmml" xref="S3.SS2.SSS2.p3.20.m9.1.1">𝑣</ci><ci id="S3.SS2.SSS2.p3.20.m9.2.2.cmml" xref="S3.SS2.SSS2.p3.20.m9.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.20.m9.2c">(v,q)</annotation></semantics></math>, we can obtain its most relevant answer using the greedy decoding strategy above. However, how to obtain the answer candidates consisting of the top-<math id="S3.SS2.SSS2.p3.21.m10.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS2.p3.21.m10.1a"><mi id="S3.SS2.SSS2.p3.21.m10.1.1" xref="S3.SS2.SSS2.p3.21.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.21.m10.1b"><ci id="S3.SS2.SSS2.p3.21.m10.1.1.cmml" xref="S3.SS2.SSS2.p3.21.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.21.m10.1c">K</annotation></semantics></math> answers and their confidence scores is not straightforward. We resort to the <em id="S3.SS2.SSS2.p3.21.2" class="ltx_emph ltx_font_italic">beam search</em> algorithm, which is widely used in neural machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> and visual captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, to address the issue.</p>
</div>
<div id="S3.SS2.SSS2.p4" class="ltx_para">
<p id="S3.SS2.SSS2.p4.1" class="ltx_p">Similar to Eq. (<a href="#S3.E5" title="In 3.2.1 Discriminative VQA models ‣ 3.2 Stage-1: Answer Heuristics Generation ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), we denote the top-<math id="S3.SS2.SSS2.p4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS2.p4.1.m1.1a"><mi id="S3.SS2.SSS2.p4.1.m1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.1.m1.1b"><ci id="S3.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.1.m1.1c">K</annotation></semantics></math> answer candidates as a set of tuples as follows:</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.4" class="ltx_Math" alttext="\mathcal{C}=\{(\boldsymbol{w}_{1},s_{1}),(\boldsymbol{w}_{2},s_{2}),...,(\boldsymbol{w}_{K},s_{K})\}" display="block"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4.4" xref="S3.E11.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.4.4.5" xref="S3.E11.m1.4.4.5.cmml">𝒞</mi><mo id="S3.E11.m1.4.4.4" xref="S3.E11.m1.4.4.4.cmml">=</mo><mrow id="S3.E11.m1.4.4.3.3" xref="S3.E11.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.E11.m1.4.4.3.3.4" xref="S3.E11.m1.4.4.3.4.cmml">{</mo><mrow id="S3.E11.m1.2.2.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S3.E11.m1.2.2.1.1.1.2.3" xref="S3.E11.m1.2.2.1.1.1.3.cmml">(</mo><msub id="S3.E11.m1.2.2.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.2.cmml">𝒘</mi><mn id="S3.E11.m1.2.2.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E11.m1.2.2.1.1.1.2.4" xref="S3.E11.m1.2.2.1.1.1.3.cmml">,</mo><msub id="S3.E11.m1.2.2.1.1.1.2.2" xref="S3.E11.m1.2.2.1.1.1.2.2.cmml"><mi id="S3.E11.m1.2.2.1.1.1.2.2.2" xref="S3.E11.m1.2.2.1.1.1.2.2.2.cmml">s</mi><mn id="S3.E11.m1.2.2.1.1.1.2.2.3" xref="S3.E11.m1.2.2.1.1.1.2.2.3.cmml">1</mn></msub><mo stretchy="false" id="S3.E11.m1.2.2.1.1.1.2.5" xref="S3.E11.m1.2.2.1.1.1.3.cmml">)</mo></mrow><mo id="S3.E11.m1.4.4.3.3.5" xref="S3.E11.m1.4.4.3.4.cmml">,</mo><mrow id="S3.E11.m1.3.3.2.2.2.2" xref="S3.E11.m1.3.3.2.2.2.3.cmml"><mo stretchy="false" id="S3.E11.m1.3.3.2.2.2.2.3" xref="S3.E11.m1.3.3.2.2.2.3.cmml">(</mo><msub id="S3.E11.m1.3.3.2.2.2.1.1" xref="S3.E11.m1.3.3.2.2.2.1.1.cmml"><mi id="S3.E11.m1.3.3.2.2.2.1.1.2" xref="S3.E11.m1.3.3.2.2.2.1.1.2.cmml">𝒘</mi><mn id="S3.E11.m1.3.3.2.2.2.1.1.3" xref="S3.E11.m1.3.3.2.2.2.1.1.3.cmml">2</mn></msub><mo id="S3.E11.m1.3.3.2.2.2.2.4" xref="S3.E11.m1.3.3.2.2.2.3.cmml">,</mo><msub id="S3.E11.m1.3.3.2.2.2.2.2" xref="S3.E11.m1.3.3.2.2.2.2.2.cmml"><mi id="S3.E11.m1.3.3.2.2.2.2.2.2" xref="S3.E11.m1.3.3.2.2.2.2.2.2.cmml">s</mi><mn id="S3.E11.m1.3.3.2.2.2.2.2.3" xref="S3.E11.m1.3.3.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.E11.m1.3.3.2.2.2.2.5" xref="S3.E11.m1.3.3.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E11.m1.4.4.3.3.6" xref="S3.E11.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">…</mi><mo id="S3.E11.m1.4.4.3.3.7" xref="S3.E11.m1.4.4.3.4.cmml">,</mo><mrow id="S3.E11.m1.4.4.3.3.3.2" xref="S3.E11.m1.4.4.3.3.3.3.cmml"><mo stretchy="false" id="S3.E11.m1.4.4.3.3.3.2.3" xref="S3.E11.m1.4.4.3.3.3.3.cmml">(</mo><msub id="S3.E11.m1.4.4.3.3.3.1.1" xref="S3.E11.m1.4.4.3.3.3.1.1.cmml"><mi id="S3.E11.m1.4.4.3.3.3.1.1.2" xref="S3.E11.m1.4.4.3.3.3.1.1.2.cmml">𝒘</mi><mi id="S3.E11.m1.4.4.3.3.3.1.1.3" xref="S3.E11.m1.4.4.3.3.3.1.1.3.cmml">K</mi></msub><mo id="S3.E11.m1.4.4.3.3.3.2.4" xref="S3.E11.m1.4.4.3.3.3.3.cmml">,</mo><msub id="S3.E11.m1.4.4.3.3.3.2.2" xref="S3.E11.m1.4.4.3.3.3.2.2.cmml"><mi id="S3.E11.m1.4.4.3.3.3.2.2.2" xref="S3.E11.m1.4.4.3.3.3.2.2.2.cmml">s</mi><mi id="S3.E11.m1.4.4.3.3.3.2.2.3" xref="S3.E11.m1.4.4.3.3.3.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.E11.m1.4.4.3.3.3.2.5" xref="S3.E11.m1.4.4.3.3.3.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.E11.m1.4.4.3.3.8" xref="S3.E11.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.4b"><apply id="S3.E11.m1.4.4.cmml" xref="S3.E11.m1.4.4"><eq id="S3.E11.m1.4.4.4.cmml" xref="S3.E11.m1.4.4.4"></eq><ci id="S3.E11.m1.4.4.5.cmml" xref="S3.E11.m1.4.4.5">𝒞</ci><set id="S3.E11.m1.4.4.3.4.cmml" xref="S3.E11.m1.4.4.3.3"><interval closure="open" id="S3.E11.m1.2.2.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.2"><apply id="S3.E11.m1.2.2.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.2">𝒘</ci><cn type="integer" id="S3.E11.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S3.E11.m1.2.2.1.1.1.2.2.cmml" xref="S3.E11.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.E11.m1.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E11.m1.2.2.1.1.1.2.2.2">𝑠</ci><cn type="integer" id="S3.E11.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.E11.m1.2.2.1.1.1.2.2.3">1</cn></apply></interval><interval closure="open" id="S3.E11.m1.3.3.2.2.2.3.cmml" xref="S3.E11.m1.3.3.2.2.2.2"><apply id="S3.E11.m1.3.3.2.2.2.1.1.cmml" xref="S3.E11.m1.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.2.2.2.1.1.1.cmml" xref="S3.E11.m1.3.3.2.2.2.1.1">subscript</csymbol><ci id="S3.E11.m1.3.3.2.2.2.1.1.2.cmml" xref="S3.E11.m1.3.3.2.2.2.1.1.2">𝒘</ci><cn type="integer" id="S3.E11.m1.3.3.2.2.2.1.1.3.cmml" xref="S3.E11.m1.3.3.2.2.2.1.1.3">2</cn></apply><apply id="S3.E11.m1.3.3.2.2.2.2.2.cmml" xref="S3.E11.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.E11.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.E11.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E11.m1.3.3.2.2.2.2.2.2">𝑠</ci><cn type="integer" id="S3.E11.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.E11.m1.3.3.2.2.2.2.2.3">2</cn></apply></interval><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">…</ci><interval closure="open" id="S3.E11.m1.4.4.3.3.3.3.cmml" xref="S3.E11.m1.4.4.3.3.3.2"><apply id="S3.E11.m1.4.4.3.3.3.1.1.cmml" xref="S3.E11.m1.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.3.3.1.1.1.cmml" xref="S3.E11.m1.4.4.3.3.3.1.1">subscript</csymbol><ci id="S3.E11.m1.4.4.3.3.3.1.1.2.cmml" xref="S3.E11.m1.4.4.3.3.3.1.1.2">𝒘</ci><ci id="S3.E11.m1.4.4.3.3.3.1.1.3.cmml" xref="S3.E11.m1.4.4.3.3.3.1.1.3">𝐾</ci></apply><apply id="S3.E11.m1.4.4.3.3.3.2.2.cmml" xref="S3.E11.m1.4.4.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.3.3.2.2.1.cmml" xref="S3.E11.m1.4.4.3.3.3.2.2">subscript</csymbol><ci id="S3.E11.m1.4.4.3.3.3.2.2.2.cmml" xref="S3.E11.m1.4.4.3.3.3.2.2.2">𝑠</ci><ci id="S3.E11.m1.4.4.3.3.3.2.2.3.cmml" xref="S3.E11.m1.4.4.3.3.3.2.2.3">𝐾</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.4c">\mathcal{C}=\{(\boldsymbol{w}_{1},s_{1}),(\boldsymbol{w}_{2},s_{2}),...,(\boldsymbol{w}_{K},s_{K})\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p4.21" class="ltx_p">where each <math id="S3.SS2.SSS2.p4.2.m1.1" class="ltx_Math" alttext="\boldsymbol{w}_{j}" display="inline"><semantics id="S3.SS2.SSS2.p4.2.m1.1a"><msub id="S3.SS2.SSS2.p4.2.m1.1.1" xref="S3.SS2.SSS2.p4.2.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p4.2.m1.1.1.2" xref="S3.SS2.SSS2.p4.2.m1.1.1.2.cmml">𝒘</mi><mi id="S3.SS2.SSS2.p4.2.m1.1.1.3" xref="S3.SS2.SSS2.p4.2.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.2.m1.1b"><apply id="S3.SS2.SSS2.p4.2.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.2.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.2.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.2.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.2.m1.1.1.2">𝒘</ci><ci id="S3.SS2.SSS2.p4.2.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p4.2.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.2.m1.1c">\boldsymbol{w}_{j}</annotation></semantics></math> represents an answer consisting of a sequence of answer words and <math id="S3.SS2.SSS2.p4.3.m2.1" class="ltx_Math" alttext="s_{j}\in\mathbb{R}^{+}" display="inline"><semantics id="S3.SS2.SSS2.p4.3.m2.1a"><mrow id="S3.SS2.SSS2.p4.3.m2.1.1" xref="S3.SS2.SSS2.p4.3.m2.1.1.cmml"><msub id="S3.SS2.SSS2.p4.3.m2.1.1.2" xref="S3.SS2.SSS2.p4.3.m2.1.1.2.cmml"><mi id="S3.SS2.SSS2.p4.3.m2.1.1.2.2" xref="S3.SS2.SSS2.p4.3.m2.1.1.2.2.cmml">s</mi><mi id="S3.SS2.SSS2.p4.3.m2.1.1.2.3" xref="S3.SS2.SSS2.p4.3.m2.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.p4.3.m2.1.1.1" xref="S3.SS2.SSS2.p4.3.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p4.3.m2.1.1.3" xref="S3.SS2.SSS2.p4.3.m2.1.1.3.cmml"><mi id="S3.SS2.SSS2.p4.3.m2.1.1.3.2" xref="S3.SS2.SSS2.p4.3.m2.1.1.3.2.cmml">ℝ</mi><mo id="S3.SS2.SSS2.p4.3.m2.1.1.3.3" xref="S3.SS2.SSS2.p4.3.m2.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.3.m2.1b"><apply id="S3.SS2.SSS2.p4.3.m2.1.1.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1"><in id="S3.SS2.SSS2.p4.3.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.1"></in><apply id="S3.SS2.SSS2.p4.3.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.3.m2.1.1.2.1.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p4.3.m2.1.1.2.2.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.2.2">𝑠</ci><ci id="S3.SS2.SSS2.p4.3.m2.1.1.2.3.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.2.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.p4.3.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.3.m2.1.1.3.1.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p4.3.m2.1.1.3.2.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.3.2">ℝ</ci><plus id="S3.SS2.SSS2.p4.3.m2.1.1.3.3.cmml" xref="S3.SS2.SSS2.p4.3.m2.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.3.m2.1c">s_{j}\in\mathbb{R}^{+}</annotation></semantics></math> denotes its corresponding confidence score calculated over all the answer words. The answer candidate set <math id="S3.SS2.SSS2.p4.4.m3.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS2.SSS2.p4.4.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p4.4.m3.1.1" xref="S3.SS2.SSS2.p4.4.m3.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.4.m3.1b"><ci id="S3.SS2.SSS2.p4.4.m3.1.1.cmml" xref="S3.SS2.SSS2.p4.4.m3.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.4.m3.1c">\mathcal{C}</annotation></semantics></math> is obtained from the generative model <math id="S3.SS2.SSS2.p4.5.m4.1" class="ltx_Math" alttext="\mathcal{M}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p4.5.m4.1a"><msub id="S3.SS2.SSS2.p4.5.m4.1.1" xref="S3.SS2.SSS2.p4.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p4.5.m4.1.1.2" xref="S3.SS2.SSS2.p4.5.m4.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p4.5.m4.1.1.3" xref="S3.SS2.SSS2.p4.5.m4.1.1.3.cmml">gen</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.5.m4.1b"><apply id="S3.SS2.SSS2.p4.5.m4.1.1.cmml" xref="S3.SS2.SSS2.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.5.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p4.5.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.5.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p4.5.m4.1.1.2">ℳ</ci><ci id="S3.SS2.SSS2.p4.5.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p4.5.m4.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.5.m4.1c">\mathcal{M}_{\mathrm{gen}}</annotation></semantics></math> equipped with the beam search strategy.
Specifically, we initialize each answer <math id="S3.SS2.SSS2.p4.6.m5.1" class="ltx_Math" alttext="\boldsymbol{w}_{j}" display="inline"><semantics id="S3.SS2.SSS2.p4.6.m5.1a"><msub id="S3.SS2.SSS2.p4.6.m5.1.1" xref="S3.SS2.SSS2.p4.6.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p4.6.m5.1.1.2" xref="S3.SS2.SSS2.p4.6.m5.1.1.2.cmml">𝒘</mi><mi id="S3.SS2.SSS2.p4.6.m5.1.1.3" xref="S3.SS2.SSS2.p4.6.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.6.m5.1b"><apply id="S3.SS2.SSS2.p4.6.m5.1.1.cmml" xref="S3.SS2.SSS2.p4.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.6.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p4.6.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.6.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p4.6.m5.1.1.2">𝒘</ci><ci id="S3.SS2.SSS2.p4.6.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p4.6.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.6.m5.1c">\boldsymbol{w}_{j}</annotation></semantics></math> with the same <math id="S3.SS2.SSS2.p4.7.m6.1" class="ltx_Math" alttext="[\mathtt{BOS}]" display="inline"><semantics id="S3.SS2.SSS2.p4.7.m6.1a"><mrow id="S3.SS2.SSS2.p4.7.m6.1.2.2" xref="S3.SS2.SSS2.p4.7.m6.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p4.7.m6.1.2.2.1" xref="S3.SS2.SSS2.p4.7.m6.1.2.1.1.cmml">[</mo><mi id="S3.SS2.SSS2.p4.7.m6.1.1" xref="S3.SS2.SSS2.p4.7.m6.1.1.cmml">𝙱𝙾𝚂</mi><mo stretchy="false" id="S3.SS2.SSS2.p4.7.m6.1.2.2.2" xref="S3.SS2.SSS2.p4.7.m6.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.7.m6.1b"><apply id="S3.SS2.SSS2.p4.7.m6.1.2.1.cmml" xref="S3.SS2.SSS2.p4.7.m6.1.2.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p4.7.m6.1.2.1.1.cmml" xref="S3.SS2.SSS2.p4.7.m6.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS2.p4.7.m6.1.1.cmml" xref="S3.SS2.SSS2.p4.7.m6.1.1">𝙱𝙾𝚂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.7.m6.1c">[\mathtt{BOS}]</annotation></semantics></math> token. At each decoding step <math id="S3.SS2.SSS2.p4.8.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSS2.p4.8.m7.1a"><mi id="S3.SS2.SSS2.p4.8.m7.1.1" xref="S3.SS2.SSS2.p4.8.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.8.m7.1b"><ci id="S3.SS2.SSS2.p4.8.m7.1.1.cmml" xref="S3.SS2.SSS2.p4.8.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.8.m7.1c">l</annotation></semantics></math>, each <math id="S3.SS2.SSS2.p4.9.m8.1" class="ltx_Math" alttext="\boldsymbol{w}_{j}" display="inline"><semantics id="S3.SS2.SSS2.p4.9.m8.1a"><msub id="S3.SS2.SSS2.p4.9.m8.1.1" xref="S3.SS2.SSS2.p4.9.m8.1.1.cmml"><mi id="S3.SS2.SSS2.p4.9.m8.1.1.2" xref="S3.SS2.SSS2.p4.9.m8.1.1.2.cmml">𝒘</mi><mi id="S3.SS2.SSS2.p4.9.m8.1.1.3" xref="S3.SS2.SSS2.p4.9.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.9.m8.1b"><apply id="S3.SS2.SSS2.p4.9.m8.1.1.cmml" xref="S3.SS2.SSS2.p4.9.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.9.m8.1.1.1.cmml" xref="S3.SS2.SSS2.p4.9.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.9.m8.1.1.2.cmml" xref="S3.SS2.SSS2.p4.9.m8.1.1.2">𝒘</ci><ci id="S3.SS2.SSS2.p4.9.m8.1.1.3.cmml" xref="S3.SS2.SSS2.p4.9.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.9.m8.1c">\boldsymbol{w}_{j}</annotation></semantics></math> of length <math id="S3.SS2.SSS2.p4.10.m9.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSS2.p4.10.m9.1a"><mi id="S3.SS2.SSS2.p4.10.m9.1.1" xref="S3.SS2.SSS2.p4.10.m9.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.10.m9.1b"><ci id="S3.SS2.SSS2.p4.10.m9.1.1.cmml" xref="S3.SS2.SSS2.p4.10.m9.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.10.m9.1c">l</annotation></semantics></math> is first passed through <math id="S3.SS2.SSS2.p4.11.m10.1" class="ltx_Math" alttext="\mathcal{M}_{\mathrm{gen}}" display="inline"><semantics id="S3.SS2.SSS2.p4.11.m10.1a"><msub id="S3.SS2.SSS2.p4.11.m10.1.1" xref="S3.SS2.SSS2.p4.11.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p4.11.m10.1.1.2" xref="S3.SS2.SSS2.p4.11.m10.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.SSS2.p4.11.m10.1.1.3" xref="S3.SS2.SSS2.p4.11.m10.1.1.3.cmml">gen</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.11.m10.1b"><apply id="S3.SS2.SSS2.p4.11.m10.1.1.cmml" xref="S3.SS2.SSS2.p4.11.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.11.m10.1.1.1.cmml" xref="S3.SS2.SSS2.p4.11.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.11.m10.1.1.2.cmml" xref="S3.SS2.SSS2.p4.11.m10.1.1.2">ℳ</ci><ci id="S3.SS2.SSS2.p4.11.m10.1.1.3.cmml" xref="S3.SS2.SSS2.p4.11.m10.1.1.3">gen</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.11.m10.1c">\mathcal{M}_{\mathrm{gen}}</annotation></semantics></math> to obtain its top-<math id="S3.SS2.SSS2.p4.12.m11.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS2.p4.12.m11.1a"><mi id="S3.SS2.SSS2.p4.12.m11.1.1" xref="S3.SS2.SSS2.p4.12.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.12.m11.1b"><ci id="S3.SS2.SSS2.p4.12.m11.1.1.cmml" xref="S3.SS2.SSS2.p4.12.m11.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.12.m11.1c">K</annotation></semantics></math> candidate words with the highest scores. After that, an <em id="S3.SS2.SSS2.p4.21.1" class="ltx_emph ltx_font_italic">expand-then-reduce</em> strategy is performed to update the <math id="S3.SS2.SSS2.p4.13.m12.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS2.p4.13.m12.1a"><mi id="S3.SS2.SSS2.p4.13.m12.1.1" xref="S3.SS2.SSS2.p4.13.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.13.m12.1b"><ci id="S3.SS2.SSS2.p4.13.m12.1.1.cmml" xref="S3.SS2.SSS2.p4.13.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.13.m12.1c">K</annotation></semantics></math> answers: (i) <span id="S3.SS2.SSS2.p4.21.2" class="ltx_text ltx_font_bold">expand step</span>: each <math id="S3.SS2.SSS2.p4.14.m13.1" class="ltx_Math" alttext="\boldsymbol{w}_{j}" display="inline"><semantics id="S3.SS2.SSS2.p4.14.m13.1a"><msub id="S3.SS2.SSS2.p4.14.m13.1.1" xref="S3.SS2.SSS2.p4.14.m13.1.1.cmml"><mi id="S3.SS2.SSS2.p4.14.m13.1.1.2" xref="S3.SS2.SSS2.p4.14.m13.1.1.2.cmml">𝒘</mi><mi id="S3.SS2.SSS2.p4.14.m13.1.1.3" xref="S3.SS2.SSS2.p4.14.m13.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.14.m13.1b"><apply id="S3.SS2.SSS2.p4.14.m13.1.1.cmml" xref="S3.SS2.SSS2.p4.14.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.14.m13.1.1.1.cmml" xref="S3.SS2.SSS2.p4.14.m13.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.14.m13.1.1.2.cmml" xref="S3.SS2.SSS2.p4.14.m13.1.1.2">𝒘</ci><ci id="S3.SS2.SSS2.p4.14.m13.1.1.3.cmml" xref="S3.SS2.SSS2.p4.14.m13.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.14.m13.1c">\boldsymbol{w}_{j}</annotation></semantics></math> is expanded <math id="S3.SS2.SSS2.p4.15.m14.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS2.p4.15.m14.1a"><mi id="S3.SS2.SSS2.p4.15.m14.1.1" xref="S3.SS2.SSS2.p4.15.m14.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.15.m14.1b"><ci id="S3.SS2.SSS2.p4.15.m14.1.1.cmml" xref="S3.SS2.SSS2.p4.15.m14.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.15.m14.1c">K</annotation></semantics></math> times to combine with the <math id="S3.SS2.SSS2.p4.16.m15.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS2.p4.16.m15.1a"><mi id="S3.SS2.SSS2.p4.16.m15.1.1" xref="S3.SS2.SSS2.p4.16.m15.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.16.m15.1b"><ci id="S3.SS2.SSS2.p4.16.m15.1.1.cmml" xref="S3.SS2.SSS2.p4.16.m15.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.16.m15.1c">K</annotation></semantics></math> candidate words, resulting in <math id="S3.SS2.SSS2.p4.17.m16.1" class="ltx_Math" alttext="K*K" display="inline"><semantics id="S3.SS2.SSS2.p4.17.m16.1a"><mrow id="S3.SS2.SSS2.p4.17.m16.1.1" xref="S3.SS2.SSS2.p4.17.m16.1.1.cmml"><mi id="S3.SS2.SSS2.p4.17.m16.1.1.2" xref="S3.SS2.SSS2.p4.17.m16.1.1.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p4.17.m16.1.1.1" xref="S3.SS2.SSS2.p4.17.m16.1.1.1.cmml">∗</mo><mi id="S3.SS2.SSS2.p4.17.m16.1.1.3" xref="S3.SS2.SSS2.p4.17.m16.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.17.m16.1b"><apply id="S3.SS2.SSS2.p4.17.m16.1.1.cmml" xref="S3.SS2.SSS2.p4.17.m16.1.1"><times id="S3.SS2.SSS2.p4.17.m16.1.1.1.cmml" xref="S3.SS2.SSS2.p4.17.m16.1.1.1"></times><ci id="S3.SS2.SSS2.p4.17.m16.1.1.2.cmml" xref="S3.SS2.SSS2.p4.17.m16.1.1.2">𝐾</ci><ci id="S3.SS2.SSS2.p4.17.m16.1.1.3.cmml" xref="S3.SS2.SSS2.p4.17.m16.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.17.m16.1c">K*K</annotation></semantics></math> new candidates answers of length <math id="S3.SS2.SSS2.p4.18.m17.1" class="ltx_Math" alttext="l+1" display="inline"><semantics id="S3.SS2.SSS2.p4.18.m17.1a"><mrow id="S3.SS2.SSS2.p4.18.m17.1.1" xref="S3.SS2.SSS2.p4.18.m17.1.1.cmml"><mi id="S3.SS2.SSS2.p4.18.m17.1.1.2" xref="S3.SS2.SSS2.p4.18.m17.1.1.2.cmml">l</mi><mo id="S3.SS2.SSS2.p4.18.m17.1.1.1" xref="S3.SS2.SSS2.p4.18.m17.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS2.p4.18.m17.1.1.3" xref="S3.SS2.SSS2.p4.18.m17.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.18.m17.1b"><apply id="S3.SS2.SSS2.p4.18.m17.1.1.cmml" xref="S3.SS2.SSS2.p4.18.m17.1.1"><plus id="S3.SS2.SSS2.p4.18.m17.1.1.1.cmml" xref="S3.SS2.SSS2.p4.18.m17.1.1.1"></plus><ci id="S3.SS2.SSS2.p4.18.m17.1.1.2.cmml" xref="S3.SS2.SSS2.p4.18.m17.1.1.2">𝑙</ci><cn type="integer" id="S3.SS2.SSS2.p4.18.m17.1.1.3.cmml" xref="S3.SS2.SSS2.p4.18.m17.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.18.m17.1c">l+1</annotation></semantics></math>; (ii) <span id="S3.SS2.SSS2.p4.21.3" class="ltx_text ltx_font_bold">reduce step</span>: among the <math id="S3.SS2.SSS2.p4.19.m18.1" class="ltx_Math" alttext="K*K" display="inline"><semantics id="S3.SS2.SSS2.p4.19.m18.1a"><mrow id="S3.SS2.SSS2.p4.19.m18.1.1" xref="S3.SS2.SSS2.p4.19.m18.1.1.cmml"><mi id="S3.SS2.SSS2.p4.19.m18.1.1.2" xref="S3.SS2.SSS2.p4.19.m18.1.1.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p4.19.m18.1.1.1" xref="S3.SS2.SSS2.p4.19.m18.1.1.1.cmml">∗</mo><mi id="S3.SS2.SSS2.p4.19.m18.1.1.3" xref="S3.SS2.SSS2.p4.19.m18.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.19.m18.1b"><apply id="S3.SS2.SSS2.p4.19.m18.1.1.cmml" xref="S3.SS2.SSS2.p4.19.m18.1.1"><times id="S3.SS2.SSS2.p4.19.m18.1.1.1.cmml" xref="S3.SS2.SSS2.p4.19.m18.1.1.1"></times><ci id="S3.SS2.SSS2.p4.19.m18.1.1.2.cmml" xref="S3.SS2.SSS2.p4.19.m18.1.1.2">𝐾</ci><ci id="S3.SS2.SSS2.p4.19.m18.1.1.3.cmml" xref="S3.SS2.SSS2.p4.19.m18.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.19.m18.1c">K*K</annotation></semantics></math> candidate answers, only the top-<math id="S3.SS2.SSS2.p4.20.m19.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS2.p4.20.m19.1a"><mi id="S3.SS2.SSS2.p4.20.m19.1.1" xref="S3.SS2.SSS2.p4.20.m19.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.20.m19.1b"><ci id="S3.SS2.SSS2.p4.20.m19.1.1.cmml" xref="S3.SS2.SSS2.p4.20.m19.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.20.m19.1c">K</annotation></semantics></math> ones with the highest accumulated scores <math id="S3.SS2.SSS2.p4.21.m20.1" class="ltx_Math" alttext="s=\sum_{i=1}^{l}\mathrm{log}~{}y^{i}" display="inline"><semantics id="S3.SS2.SSS2.p4.21.m20.1a"><mrow id="S3.SS2.SSS2.p4.21.m20.1.1" xref="S3.SS2.SSS2.p4.21.m20.1.1.cmml"><mi id="S3.SS2.SSS2.p4.21.m20.1.1.2" xref="S3.SS2.SSS2.p4.21.m20.1.1.2.cmml">s</mi><mo rspace="0.111em" id="S3.SS2.SSS2.p4.21.m20.1.1.1" xref="S3.SS2.SSS2.p4.21.m20.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p4.21.m20.1.1.3" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.cmml"><msubsup id="S3.SS2.SSS2.p4.21.m20.1.1.3.1" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.cmml"><mo id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.2" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.cmml"><mi id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.2" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.1" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.3" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.3" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.3.cmml">l</mi></msubsup><mrow id="S3.SS2.SSS2.p4.21.m20.1.1.3.2" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.cmml"><mi id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.2" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.2.cmml">log</mi><mo lspace="0.330em" rspace="0em" id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.1" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.1.cmml">​</mo><msup id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.cmml"><mi id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.2" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.2.cmml">y</mi><mi id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.3" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.3.cmml">i</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.21.m20.1b"><apply id="S3.SS2.SSS2.p4.21.m20.1.1.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1"><eq id="S3.SS2.SSS2.p4.21.m20.1.1.1.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.1"></eq><ci id="S3.SS2.SSS2.p4.21.m20.1.1.2.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.2">𝑠</ci><apply id="S3.SS2.SSS2.p4.21.m20.1.1.3.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3"><apply id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.1.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1">superscript</csymbol><apply id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.1.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1">subscript</csymbol><sum id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.2.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.2"></sum><apply id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3"><eq id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.1.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.1"></eq><ci id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.2.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.3.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS2.p4.21.m20.1.1.3.1.3.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.1.3">𝑙</ci></apply><apply id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2"><times id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.1.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.1"></times><ci id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.2.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.2">log</ci><apply id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.1.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3">superscript</csymbol><ci id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.2.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.2">𝑦</ci><ci id="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.3.cmml" xref="S3.SS2.SSS2.p4.21.m20.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.21.m20.1c">s=\sum_{i=1}^{l}\mathrm{log}~{}y^{i}</annotation></semantics></math> are retained, which are then regarded as the inputs to the next decoding step.


<br class="ltx_break"><span id="S3.SS2.SSS2.p4.21.4" class="ltx_text ltx_font_bold">Answer-aware examples.</span> Similar to the example selection strategy for discriminative models, the answer-aware examples for generative models are also obtained by performing kNN search in a latent answer space.
It is worth noting that the granularity of the latent features is different for the two types of VQA models: each latent feature obtained from a discriminative VQA model refers to an answer entry in the answer vocabulary, while each latent feature obtained from a generative VQA model refers to an answer word.</p>
</div>
<div id="S3.SS2.SSS2.p5" class="ltx_para">
<p id="S3.SS2.SSS2.p5.12" class="ltx_p">Given a testing input <math id="S3.SS2.SSS2.p5.1.m1.2" class="ltx_Math" alttext="(v,q)" display="inline"><semantics id="S3.SS2.SSS2.p5.1.m1.2a"><mrow id="S3.SS2.SSS2.p5.1.m1.2.3.2" xref="S3.SS2.SSS2.p5.1.m1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p5.1.m1.2.3.2.1" xref="S3.SS2.SSS2.p5.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS2.p5.1.m1.1.1" xref="S3.SS2.SSS2.p5.1.m1.1.1.cmml">v</mi><mo id="S3.SS2.SSS2.p5.1.m1.2.3.2.2" xref="S3.SS2.SSS2.p5.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS2.p5.1.m1.2.2" xref="S3.SS2.SSS2.p5.1.m1.2.2.cmml">q</mi><mo stretchy="false" id="S3.SS2.SSS2.p5.1.m1.2.3.2.3" xref="S3.SS2.SSS2.p5.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.1.m1.2b"><interval closure="open" id="S3.SS2.SSS2.p5.1.m1.2.3.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.2.3.2"><ci id="S3.SS2.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.1.1">𝑣</ci><ci id="S3.SS2.SSS2.p5.1.m1.2.2.cmml" xref="S3.SS2.SSS2.p5.1.m1.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.1.m1.2c">(v,q)</annotation></semantics></math> and <math id="S3.SS2.SSS2.p5.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS2.p5.2.m2.1a"><mi id="S3.SS2.SSS2.p5.2.m2.1.1" xref="S3.SS2.SSS2.p5.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.2.m2.1b"><ci id="S3.SS2.SSS2.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p5.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.2.m2.1c">i</annotation></semantics></math>-th training input <math id="S3.SS2.SSS2.p5.3.m3.2" class="ltx_Math" alttext="(v_{i},q_{i})" display="inline"><semantics id="S3.SS2.SSS2.p5.3.m3.2a"><mrow id="S3.SS2.SSS2.p5.3.m3.2.2.2" xref="S3.SS2.SSS2.p5.3.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p5.3.m3.2.2.2.3" xref="S3.SS2.SSS2.p5.3.m3.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS2.p5.3.m3.1.1.1.1" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p5.3.m3.1.1.1.1.2" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.SSS2.p5.3.m3.1.1.1.1.3" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p5.3.m3.2.2.2.4" xref="S3.SS2.SSS2.p5.3.m3.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.p5.3.m3.2.2.2.2" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p5.3.m3.2.2.2.2.2" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2.2.cmml">q</mi><mi id="S3.SS2.SSS2.p5.3.m3.2.2.2.2.3" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.SSS2.p5.3.m3.2.2.2.5" xref="S3.SS2.SSS2.p5.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.3.m3.2b"><interval closure="open" id="S3.SS2.SSS2.p5.3.m3.2.2.3.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.2.2"><apply id="S3.SS2.SSS2.p5.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p5.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.SSS2.p5.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.p5.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p5.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2.2">𝑞</ci><ci id="S3.SS2.SSS2.p5.3.m3.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.3.m3.2c">(v_{i},q_{i})</annotation></semantics></math>, the latent features for their multi-word answers can be respectively represented as feature groups <math id="S3.SS2.SSS2.p5.4.m4.4" class="ltx_Math" alttext="Z=[z^{1},z^{2},...,z^{L}]\in\mathbb{R}^{L\times d}" display="inline"><semantics id="S3.SS2.SSS2.p5.4.m4.4a"><mrow id="S3.SS2.SSS2.p5.4.m4.4.4" xref="S3.SS2.SSS2.p5.4.m4.4.4.cmml"><mi id="S3.SS2.SSS2.p5.4.m4.4.4.5" xref="S3.SS2.SSS2.p5.4.m4.4.4.5.cmml">Z</mi><mo id="S3.SS2.SSS2.p5.4.m4.4.4.6" xref="S3.SS2.SSS2.p5.4.m4.4.4.6.cmml">=</mo><mrow id="S3.SS2.SSS2.p5.4.m4.4.4.3.3" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.4" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.4.cmml">[</mo><msup id="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1" xref="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.2" xref="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.2.cmml">z</mi><mn id="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.3" xref="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.5" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.4.cmml">,</mo><msup id="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2" xref="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.2" xref="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.2.cmml">z</mi><mn id="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.3" xref="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.6" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.p5.4.m4.1.1" xref="S3.SS2.SSS2.p5.4.m4.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.7" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.4.cmml">,</mo><msup id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.2" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.2.cmml">z</mi><mi id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.3" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.3.cmml">L</mi></msup><mo stretchy="false" id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.8" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.4.cmml">]</mo></mrow><mo id="S3.SS2.SSS2.p5.4.m4.4.4.7" xref="S3.SS2.SSS2.p5.4.m4.4.4.7.cmml">∈</mo><msup id="S3.SS2.SSS2.p5.4.m4.4.4.8" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.cmml"><mi id="S3.SS2.SSS2.p5.4.m4.4.4.8.2" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS2.p5.4.m4.4.4.8.3" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.3.cmml"><mi id="S3.SS2.SSS2.p5.4.m4.4.4.8.3.2" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p5.4.m4.4.4.8.3.1" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.3.1.cmml">×</mo><mi id="S3.SS2.SSS2.p5.4.m4.4.4.8.3.3" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.4.m4.4b"><apply id="S3.SS2.SSS2.p5.4.m4.4.4.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4"><and id="S3.SS2.SSS2.p5.4.m4.4.4a.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4"></and><apply id="S3.SS2.SSS2.p5.4.m4.4.4b.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4"><eq id="S3.SS2.SSS2.p5.4.m4.4.4.6.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.6"></eq><ci id="S3.SS2.SSS2.p5.4.m4.4.4.5.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.5">𝑍</ci><list id="S3.SS2.SSS2.p5.4.m4.4.4.3.4.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.3"><apply id="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.2">𝑧</ci><cn type="integer" id="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.2">𝑧</ci><cn type="integer" id="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p5.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.p5.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.1.1">…</ci><apply id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.2">𝑧</ci><ci id="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.3.3.3.3">𝐿</ci></apply></list></apply><apply id="S3.SS2.SSS2.p5.4.m4.4.4c.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4"><in id="S3.SS2.SSS2.p5.4.m4.4.4.7.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.7"></in><share href="#S3.SS2.SSS2.p5.4.m4.4.4.3.cmml" id="S3.SS2.SSS2.p5.4.m4.4.4d.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4"></share><apply id="S3.SS2.SSS2.p5.4.m4.4.4.8.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.8"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.4.m4.4.4.8.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.8">superscript</csymbol><ci id="S3.SS2.SSS2.p5.4.m4.4.4.8.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.2">ℝ</ci><apply id="S3.SS2.SSS2.p5.4.m4.4.4.8.3.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.3"><times id="S3.SS2.SSS2.p5.4.m4.4.4.8.3.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.3.1"></times><ci id="S3.SS2.SSS2.p5.4.m4.4.4.8.3.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.3.2">𝐿</ci><ci id="S3.SS2.SSS2.p5.4.m4.4.4.8.3.3.cmml" xref="S3.SS2.SSS2.p5.4.m4.4.4.8.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.4.m4.4c">Z=[z^{1},z^{2},...,z^{L}]\in\mathbb{R}^{L\times d}</annotation></semantics></math> and <math id="S3.SS2.SSS2.p5.5.m5.4" class="ltx_Math" alttext="Z_{i}=[z_{i}^{1},z_{i}^{2},...,z_{i}^{L_{i}}]\in\mathbb{R}^{L_{i}\times d}" display="inline"><semantics id="S3.SS2.SSS2.p5.5.m5.4a"><mrow id="S3.SS2.SSS2.p5.5.m5.4.4" xref="S3.SS2.SSS2.p5.5.m5.4.4.cmml"><msub id="S3.SS2.SSS2.p5.5.m5.4.4.5" xref="S3.SS2.SSS2.p5.5.m5.4.4.5.cmml"><mi id="S3.SS2.SSS2.p5.5.m5.4.4.5.2" xref="S3.SS2.SSS2.p5.5.m5.4.4.5.2.cmml">Z</mi><mi id="S3.SS2.SSS2.p5.5.m5.4.4.5.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.5.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p5.5.m5.4.4.6" xref="S3.SS2.SSS2.p5.5.m5.4.4.6.cmml">=</mo><mrow id="S3.SS2.SSS2.p5.5.m5.4.4.3.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.4" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.4.cmml">[</mo><msubsup id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.2" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.2.cmml">z</mi><mi id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.3" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.3.cmml">i</mi><mn id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.3" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.5" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.2" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.2.cmml">z</mi><mi id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.3" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.3.cmml">i</mi><mn id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.3" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.6" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.p5.5.m5.1.1" xref="S3.SS2.SSS2.p5.5.m5.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.7" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.2" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.2.cmml">z</mi><mi id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.3.cmml">i</mi><msub id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.cmml"><mi id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.2" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.2.cmml">L</mi><mi id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.3.cmml">i</mi></msub></msubsup><mo stretchy="false" id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.8" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.4.cmml">]</mo></mrow><mo id="S3.SS2.SSS2.p5.5.m5.4.4.7" xref="S3.SS2.SSS2.p5.5.m5.4.4.7.cmml">∈</mo><msup id="S3.SS2.SSS2.p5.5.m5.4.4.8" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.cmml"><mi id="S3.SS2.SSS2.p5.5.m5.4.4.8.2" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS2.p5.5.m5.4.4.8.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.cmml"><msub id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.cmml"><mi id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.2" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.2.cmml">L</mi><mi id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.1" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.1.cmml">×</mo><mi id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.3" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.5.m5.4b"><apply id="S3.SS2.SSS2.p5.5.m5.4.4.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4"><and id="S3.SS2.SSS2.p5.5.m5.4.4a.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4"></and><apply id="S3.SS2.SSS2.p5.5.m5.4.4b.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4"><eq id="S3.SS2.SSS2.p5.5.m5.4.4.6.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.6"></eq><apply id="S3.SS2.SSS2.p5.5.m5.4.4.5.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.4.4.5.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.5">subscript</csymbol><ci id="S3.SS2.SSS2.p5.5.m5.4.4.5.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.5.2">𝑍</ci><ci id="S3.SS2.SSS2.p5.5.m5.4.4.5.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.5.3">𝑖</ci></apply><list id="S3.SS2.SSS2.p5.5.m5.4.4.3.4.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3"><apply id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.2">𝑧</ci><ci id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.2">𝑧</ci><ci id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.p5.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.1.1">…</ci><apply id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.2">𝑧</ci><ci id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.2">𝐿</ci><ci id="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.3.3.3.3.3">𝑖</ci></apply></apply></list></apply><apply id="S3.SS2.SSS2.p5.5.m5.4.4c.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4"><in id="S3.SS2.SSS2.p5.5.m5.4.4.7.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.7"></in><share href="#S3.SS2.SSS2.p5.5.m5.4.4.3.cmml" id="S3.SS2.SSS2.p5.5.m5.4.4d.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4"></share><apply id="S3.SS2.SSS2.p5.5.m5.4.4.8.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.4.4.8.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8">superscript</csymbol><ci id="S3.SS2.SSS2.p5.5.m5.4.4.8.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.2">ℝ</ci><apply id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3"><times id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.1"></times><apply id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.1.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2">subscript</csymbol><ci id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.2.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.2">𝐿</ci><ci id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p5.5.m5.4.4.8.3.3.cmml" xref="S3.SS2.SSS2.p5.5.m5.4.4.8.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.5.m5.4c">Z_{i}=[z_{i}^{1},z_{i}^{2},...,z_{i}^{L_{i}}]\in\mathbb{R}^{L_{i}\times d}</annotation></semantics></math>, where <math id="S3.SS2.SSS2.p5.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.SSS2.p5.6.m6.1a"><mi id="S3.SS2.SSS2.p5.6.m6.1.1" xref="S3.SS2.SSS2.p5.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.6.m6.1b"><ci id="S3.SS2.SSS2.p5.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p5.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.6.m6.1c">d</annotation></semantics></math> is the common dimensionality of the latent answer space, <math id="S3.SS2.SSS2.p5.7.m7.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.SSS2.p5.7.m7.1a"><mi id="S3.SS2.SSS2.p5.7.m7.1.1" xref="S3.SS2.SSS2.p5.7.m7.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.7.m7.1b"><ci id="S3.SS2.SSS2.p5.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p5.7.m7.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.7.m7.1c">L</annotation></semantics></math> and <math id="S3.SS2.SSS2.p5.8.m8.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.SS2.SSS2.p5.8.m8.1a"><msub id="S3.SS2.SSS2.p5.8.m8.1.1" xref="S3.SS2.SSS2.p5.8.m8.1.1.cmml"><mi id="S3.SS2.SSS2.p5.8.m8.1.1.2" xref="S3.SS2.SSS2.p5.8.m8.1.1.2.cmml">L</mi><mi id="S3.SS2.SSS2.p5.8.m8.1.1.3" xref="S3.SS2.SSS2.p5.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.8.m8.1b"><apply id="S3.SS2.SSS2.p5.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.8.m8.1.1.1.cmml" xref="S3.SS2.SSS2.p5.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p5.8.m8.1.1.2.cmml" xref="S3.SS2.SSS2.p5.8.m8.1.1.2">𝐿</ci><ci id="S3.SS2.SSS2.p5.8.m8.1.1.3.cmml" xref="S3.SS2.SSS2.p5.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.8.m8.1c">L_{i}</annotation></semantics></math> refer to the answer lengths of <math id="S3.SS2.SSS2.p5.9.m9.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S3.SS2.SSS2.p5.9.m9.1a"><mi id="S3.SS2.SSS2.p5.9.m9.1.1" xref="S3.SS2.SSS2.p5.9.m9.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.9.m9.1b"><ci id="S3.SS2.SSS2.p5.9.m9.1.1.cmml" xref="S3.SS2.SSS2.p5.9.m9.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.9.m9.1c">Z</annotation></semantics></math> and <math id="S3.SS2.SSS2.p5.10.m10.1" class="ltx_Math" alttext="Z_{i}" display="inline"><semantics id="S3.SS2.SSS2.p5.10.m10.1a"><msub id="S3.SS2.SSS2.p5.10.m10.1.1" xref="S3.SS2.SSS2.p5.10.m10.1.1.cmml"><mi id="S3.SS2.SSS2.p5.10.m10.1.1.2" xref="S3.SS2.SSS2.p5.10.m10.1.1.2.cmml">Z</mi><mi id="S3.SS2.SSS2.p5.10.m10.1.1.3" xref="S3.SS2.SSS2.p5.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.10.m10.1b"><apply id="S3.SS2.SSS2.p5.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.p5.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p5.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.p5.10.m10.1.1.2">𝑍</ci><ci id="S3.SS2.SSS2.p5.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.p5.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.10.m10.1c">Z_{i}</annotation></semantics></math>, respectively. We define a simple score function as follows to average the dot-product similarity of each paired features <math id="S3.SS2.SSS2.p5.11.m11.1" class="ltx_Math" alttext="z_{j}\in Z" display="inline"><semantics id="S3.SS2.SSS2.p5.11.m11.1a"><mrow id="S3.SS2.SSS2.p5.11.m11.1.1" xref="S3.SS2.SSS2.p5.11.m11.1.1.cmml"><msub id="S3.SS2.SSS2.p5.11.m11.1.1.2" xref="S3.SS2.SSS2.p5.11.m11.1.1.2.cmml"><mi id="S3.SS2.SSS2.p5.11.m11.1.1.2.2" xref="S3.SS2.SSS2.p5.11.m11.1.1.2.2.cmml">z</mi><mi id="S3.SS2.SSS2.p5.11.m11.1.1.2.3" xref="S3.SS2.SSS2.p5.11.m11.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.p5.11.m11.1.1.1" xref="S3.SS2.SSS2.p5.11.m11.1.1.1.cmml">∈</mo><mi id="S3.SS2.SSS2.p5.11.m11.1.1.3" xref="S3.SS2.SSS2.p5.11.m11.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.11.m11.1b"><apply id="S3.SS2.SSS2.p5.11.m11.1.1.cmml" xref="S3.SS2.SSS2.p5.11.m11.1.1"><in id="S3.SS2.SSS2.p5.11.m11.1.1.1.cmml" xref="S3.SS2.SSS2.p5.11.m11.1.1.1"></in><apply id="S3.SS2.SSS2.p5.11.m11.1.1.2.cmml" xref="S3.SS2.SSS2.p5.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.11.m11.1.1.2.1.cmml" xref="S3.SS2.SSS2.p5.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p5.11.m11.1.1.2.2.cmml" xref="S3.SS2.SSS2.p5.11.m11.1.1.2.2">𝑧</ci><ci id="S3.SS2.SSS2.p5.11.m11.1.1.2.3.cmml" xref="S3.SS2.SSS2.p5.11.m11.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS2.p5.11.m11.1.1.3.cmml" xref="S3.SS2.SSS2.p5.11.m11.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.11.m11.1c">z_{j}\in Z</annotation></semantics></math> and <math id="S3.SS2.SSS2.p5.12.m12.1" class="ltx_Math" alttext="z_{i}^{k}\in Z_{i}" display="inline"><semantics id="S3.SS2.SSS2.p5.12.m12.1a"><mrow id="S3.SS2.SSS2.p5.12.m12.1.1" xref="S3.SS2.SSS2.p5.12.m12.1.1.cmml"><msubsup id="S3.SS2.SSS2.p5.12.m12.1.1.2" xref="S3.SS2.SSS2.p5.12.m12.1.1.2.cmml"><mi id="S3.SS2.SSS2.p5.12.m12.1.1.2.2.2" xref="S3.SS2.SSS2.p5.12.m12.1.1.2.2.2.cmml">z</mi><mi id="S3.SS2.SSS2.p5.12.m12.1.1.2.2.3" xref="S3.SS2.SSS2.p5.12.m12.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p5.12.m12.1.1.2.3" xref="S3.SS2.SSS2.p5.12.m12.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS2.p5.12.m12.1.1.1" xref="S3.SS2.SSS2.p5.12.m12.1.1.1.cmml">∈</mo><msub id="S3.SS2.SSS2.p5.12.m12.1.1.3" xref="S3.SS2.SSS2.p5.12.m12.1.1.3.cmml"><mi id="S3.SS2.SSS2.p5.12.m12.1.1.3.2" xref="S3.SS2.SSS2.p5.12.m12.1.1.3.2.cmml">Z</mi><mi id="S3.SS2.SSS2.p5.12.m12.1.1.3.3" xref="S3.SS2.SSS2.p5.12.m12.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.12.m12.1b"><apply id="S3.SS2.SSS2.p5.12.m12.1.1.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1"><in id="S3.SS2.SSS2.p5.12.m12.1.1.1.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.1"></in><apply id="S3.SS2.SSS2.p5.12.m12.1.1.2.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.12.m12.1.1.2.1.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS2.p5.12.m12.1.1.2.2.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.12.m12.1.1.2.2.1.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p5.12.m12.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.2.2.2">𝑧</ci><ci id="S3.SS2.SSS2.p5.12.m12.1.1.2.2.3.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p5.12.m12.1.1.2.3.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS2.p5.12.m12.1.1.3.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.12.m12.1.1.3.1.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p5.12.m12.1.1.3.2.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.3.2">𝑍</ci><ci id="S3.SS2.SSS2.p5.12.m12.1.1.3.3.cmml" xref="S3.SS2.SSS2.p5.12.m12.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.12.m12.1c">z_{i}^{k}\in Z_{i}</annotation></semantics></math> :</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.2" class="ltx_Math" alttext="\pi_{i}=\frac{1}{L*L_{i}}\sum\limits_{j=1}^{L}\sum\limits_{k=1}^{L_{i}}\frac{z^{j}z_{i}^{k}}{\|z^{j}\|_{2}\|z_{i}^{k}\|_{2}}" display="block"><semantics id="S3.E12.m1.2a"><mrow id="S3.E12.m1.2.3" xref="S3.E12.m1.2.3.cmml"><msub id="S3.E12.m1.2.3.2" xref="S3.E12.m1.2.3.2.cmml"><mi id="S3.E12.m1.2.3.2.2" xref="S3.E12.m1.2.3.2.2.cmml">π</mi><mi id="S3.E12.m1.2.3.2.3" xref="S3.E12.m1.2.3.2.3.cmml">i</mi></msub><mo id="S3.E12.m1.2.3.1" xref="S3.E12.m1.2.3.1.cmml">=</mo><mrow id="S3.E12.m1.2.3.3" xref="S3.E12.m1.2.3.3.cmml"><mfrac id="S3.E12.m1.2.3.3.2" xref="S3.E12.m1.2.3.3.2.cmml"><mn id="S3.E12.m1.2.3.3.2.2" xref="S3.E12.m1.2.3.3.2.2.cmml">1</mn><mrow id="S3.E12.m1.2.3.3.2.3" xref="S3.E12.m1.2.3.3.2.3.cmml"><mi id="S3.E12.m1.2.3.3.2.3.2" xref="S3.E12.m1.2.3.3.2.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E12.m1.2.3.3.2.3.1" xref="S3.E12.m1.2.3.3.2.3.1.cmml">∗</mo><msub id="S3.E12.m1.2.3.3.2.3.3" xref="S3.E12.m1.2.3.3.2.3.3.cmml"><mi id="S3.E12.m1.2.3.3.2.3.3.2" xref="S3.E12.m1.2.3.3.2.3.3.2.cmml">L</mi><mi id="S3.E12.m1.2.3.3.2.3.3.3" xref="S3.E12.m1.2.3.3.2.3.3.3.cmml">i</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.3.3.1" xref="S3.E12.m1.2.3.3.1.cmml">​</mo><mrow id="S3.E12.m1.2.3.3.3" xref="S3.E12.m1.2.3.3.3.cmml"><munderover id="S3.E12.m1.2.3.3.3.1" xref="S3.E12.m1.2.3.3.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S3.E12.m1.2.3.3.3.1.2.2" xref="S3.E12.m1.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E12.m1.2.3.3.3.1.2.3" xref="S3.E12.m1.2.3.3.3.1.2.3.cmml"><mi id="S3.E12.m1.2.3.3.3.1.2.3.2" xref="S3.E12.m1.2.3.3.3.1.2.3.2.cmml">j</mi><mo id="S3.E12.m1.2.3.3.3.1.2.3.1" xref="S3.E12.m1.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E12.m1.2.3.3.3.1.2.3.3" xref="S3.E12.m1.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E12.m1.2.3.3.3.1.3" xref="S3.E12.m1.2.3.3.3.1.3.cmml">L</mi></munderover><mrow id="S3.E12.m1.2.3.3.3.2" xref="S3.E12.m1.2.3.3.3.2.cmml"><munderover id="S3.E12.m1.2.3.3.3.2.1" xref="S3.E12.m1.2.3.3.3.2.1.cmml"><mo movablelimits="false" id="S3.E12.m1.2.3.3.3.2.1.2.2" xref="S3.E12.m1.2.3.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E12.m1.2.3.3.3.2.1.2.3" xref="S3.E12.m1.2.3.3.3.2.1.2.3.cmml"><mi id="S3.E12.m1.2.3.3.3.2.1.2.3.2" xref="S3.E12.m1.2.3.3.3.2.1.2.3.2.cmml">k</mi><mo id="S3.E12.m1.2.3.3.3.2.1.2.3.1" xref="S3.E12.m1.2.3.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E12.m1.2.3.3.3.2.1.2.3.3" xref="S3.E12.m1.2.3.3.3.2.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E12.m1.2.3.3.3.2.1.3" xref="S3.E12.m1.2.3.3.3.2.1.3.cmml"><mi id="S3.E12.m1.2.3.3.3.2.1.3.2" xref="S3.E12.m1.2.3.3.3.2.1.3.2.cmml">L</mi><mi id="S3.E12.m1.2.3.3.3.2.1.3.3" xref="S3.E12.m1.2.3.3.3.2.1.3.3.cmml">i</mi></msub></munderover><mfrac id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml"><mrow id="S3.E12.m1.2.2.4" xref="S3.E12.m1.2.2.4.cmml"><msup id="S3.E12.m1.2.2.4.2" xref="S3.E12.m1.2.2.4.2.cmml"><mi id="S3.E12.m1.2.2.4.2.2" xref="S3.E12.m1.2.2.4.2.2.cmml">z</mi><mi id="S3.E12.m1.2.2.4.2.3" xref="S3.E12.m1.2.2.4.2.3.cmml">j</mi></msup><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.4.1" xref="S3.E12.m1.2.2.4.1.cmml">​</mo><msubsup id="S3.E12.m1.2.2.4.3" xref="S3.E12.m1.2.2.4.3.cmml"><mi id="S3.E12.m1.2.2.4.3.2.2" xref="S3.E12.m1.2.2.4.3.2.2.cmml">z</mi><mi id="S3.E12.m1.2.2.4.3.2.3" xref="S3.E12.m1.2.2.4.3.2.3.cmml">i</mi><mi id="S3.E12.m1.2.2.4.3.3" xref="S3.E12.m1.2.2.4.3.3.cmml">k</mi></msubsup></mrow><mrow id="S3.E12.m1.2.2.2" xref="S3.E12.m1.2.2.2.cmml"><msub id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml"><mrow id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.2.1.cmml">‖</mo><msup id="S3.E12.m1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.m1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msup><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E12.m1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.2.3" xref="S3.E12.m1.2.2.2.3.cmml">​</mo><msub id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.cmml"><mrow id="S3.E12.m1.2.2.2.2.1.1" xref="S3.E12.m1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.E12.m1.2.2.2.2.1.1.2" xref="S3.E12.m1.2.2.2.2.1.2.1.cmml">‖</mo><msubsup id="S3.E12.m1.2.2.2.2.1.1.1" xref="S3.E12.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.1.2.2" xref="S3.E12.m1.2.2.2.2.1.1.1.2.2.cmml">z</mi><mi id="S3.E12.m1.2.2.2.2.1.1.1.2.3" xref="S3.E12.m1.2.2.2.2.1.1.1.2.3.cmml">i</mi><mi id="S3.E12.m1.2.2.2.2.1.1.1.3" xref="S3.E12.m1.2.2.2.2.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E12.m1.2.2.2.2.1.1.3" xref="S3.E12.m1.2.2.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E12.m1.2.2.2.2.3" xref="S3.E12.m1.2.2.2.2.3.cmml">2</mn></msub></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.2b"><apply id="S3.E12.m1.2.3.cmml" xref="S3.E12.m1.2.3"><eq id="S3.E12.m1.2.3.1.cmml" xref="S3.E12.m1.2.3.1"></eq><apply id="S3.E12.m1.2.3.2.cmml" xref="S3.E12.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.3.2.1.cmml" xref="S3.E12.m1.2.3.2">subscript</csymbol><ci id="S3.E12.m1.2.3.2.2.cmml" xref="S3.E12.m1.2.3.2.2">𝜋</ci><ci id="S3.E12.m1.2.3.2.3.cmml" xref="S3.E12.m1.2.3.2.3">𝑖</ci></apply><apply id="S3.E12.m1.2.3.3.cmml" xref="S3.E12.m1.2.3.3"><times id="S3.E12.m1.2.3.3.1.cmml" xref="S3.E12.m1.2.3.3.1"></times><apply id="S3.E12.m1.2.3.3.2.cmml" xref="S3.E12.m1.2.3.3.2"><divide id="S3.E12.m1.2.3.3.2.1.cmml" xref="S3.E12.m1.2.3.3.2"></divide><cn type="integer" id="S3.E12.m1.2.3.3.2.2.cmml" xref="S3.E12.m1.2.3.3.2.2">1</cn><apply id="S3.E12.m1.2.3.3.2.3.cmml" xref="S3.E12.m1.2.3.3.2.3"><times id="S3.E12.m1.2.3.3.2.3.1.cmml" xref="S3.E12.m1.2.3.3.2.3.1"></times><ci id="S3.E12.m1.2.3.3.2.3.2.cmml" xref="S3.E12.m1.2.3.3.2.3.2">𝐿</ci><apply id="S3.E12.m1.2.3.3.2.3.3.cmml" xref="S3.E12.m1.2.3.3.2.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.3.3.2.3.3.1.cmml" xref="S3.E12.m1.2.3.3.2.3.3">subscript</csymbol><ci id="S3.E12.m1.2.3.3.2.3.3.2.cmml" xref="S3.E12.m1.2.3.3.2.3.3.2">𝐿</ci><ci id="S3.E12.m1.2.3.3.2.3.3.3.cmml" xref="S3.E12.m1.2.3.3.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E12.m1.2.3.3.3.cmml" xref="S3.E12.m1.2.3.3.3"><apply id="S3.E12.m1.2.3.3.3.1.cmml" xref="S3.E12.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.3.3.3.1.1.cmml" xref="S3.E12.m1.2.3.3.3.1">superscript</csymbol><apply id="S3.E12.m1.2.3.3.3.1.2.cmml" xref="S3.E12.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.3.3.3.1.2.1.cmml" xref="S3.E12.m1.2.3.3.3.1">subscript</csymbol><sum id="S3.E12.m1.2.3.3.3.1.2.2.cmml" xref="S3.E12.m1.2.3.3.3.1.2.2"></sum><apply id="S3.E12.m1.2.3.3.3.1.2.3.cmml" xref="S3.E12.m1.2.3.3.3.1.2.3"><eq id="S3.E12.m1.2.3.3.3.1.2.3.1.cmml" xref="S3.E12.m1.2.3.3.3.1.2.3.1"></eq><ci id="S3.E12.m1.2.3.3.3.1.2.3.2.cmml" xref="S3.E12.m1.2.3.3.3.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E12.m1.2.3.3.3.1.2.3.3.cmml" xref="S3.E12.m1.2.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.2.3.3.3.1.3.cmml" xref="S3.E12.m1.2.3.3.3.1.3">𝐿</ci></apply><apply id="S3.E12.m1.2.3.3.3.2.cmml" xref="S3.E12.m1.2.3.3.3.2"><apply id="S3.E12.m1.2.3.3.3.2.1.cmml" xref="S3.E12.m1.2.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.3.3.3.2.1.1.cmml" xref="S3.E12.m1.2.3.3.3.2.1">superscript</csymbol><apply id="S3.E12.m1.2.3.3.3.2.1.2.cmml" xref="S3.E12.m1.2.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.3.3.3.2.1.2.1.cmml" xref="S3.E12.m1.2.3.3.3.2.1">subscript</csymbol><sum id="S3.E12.m1.2.3.3.3.2.1.2.2.cmml" xref="S3.E12.m1.2.3.3.3.2.1.2.2"></sum><apply id="S3.E12.m1.2.3.3.3.2.1.2.3.cmml" xref="S3.E12.m1.2.3.3.3.2.1.2.3"><eq id="S3.E12.m1.2.3.3.3.2.1.2.3.1.cmml" xref="S3.E12.m1.2.3.3.3.2.1.2.3.1"></eq><ci id="S3.E12.m1.2.3.3.3.2.1.2.3.2.cmml" xref="S3.E12.m1.2.3.3.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E12.m1.2.3.3.3.2.1.2.3.3.cmml" xref="S3.E12.m1.2.3.3.3.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E12.m1.2.3.3.3.2.1.3.cmml" xref="S3.E12.m1.2.3.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.3.3.3.2.1.3.1.cmml" xref="S3.E12.m1.2.3.3.3.2.1.3">subscript</csymbol><ci id="S3.E12.m1.2.3.3.3.2.1.3.2.cmml" xref="S3.E12.m1.2.3.3.3.2.1.3.2">𝐿</ci><ci id="S3.E12.m1.2.3.3.3.2.1.3.3.cmml" xref="S3.E12.m1.2.3.3.3.2.1.3.3">𝑖</ci></apply></apply><apply id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2"><divide id="S3.E12.m1.2.2.3.cmml" xref="S3.E12.m1.2.2"></divide><apply id="S3.E12.m1.2.2.4.cmml" xref="S3.E12.m1.2.2.4"><times id="S3.E12.m1.2.2.4.1.cmml" xref="S3.E12.m1.2.2.4.1"></times><apply id="S3.E12.m1.2.2.4.2.cmml" xref="S3.E12.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.4.2.1.cmml" xref="S3.E12.m1.2.2.4.2">superscript</csymbol><ci id="S3.E12.m1.2.2.4.2.2.cmml" xref="S3.E12.m1.2.2.4.2.2">𝑧</ci><ci id="S3.E12.m1.2.2.4.2.3.cmml" xref="S3.E12.m1.2.2.4.2.3">𝑗</ci></apply><apply id="S3.E12.m1.2.2.4.3.cmml" xref="S3.E12.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.4.3.1.cmml" xref="S3.E12.m1.2.2.4.3">superscript</csymbol><apply id="S3.E12.m1.2.2.4.3.2.cmml" xref="S3.E12.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.4.3.2.1.cmml" xref="S3.E12.m1.2.2.4.3">subscript</csymbol><ci id="S3.E12.m1.2.2.4.3.2.2.cmml" xref="S3.E12.m1.2.2.4.3.2.2">𝑧</ci><ci id="S3.E12.m1.2.2.4.3.2.3.cmml" xref="S3.E12.m1.2.2.4.3.2.3">𝑖</ci></apply><ci id="S3.E12.m1.2.2.4.3.3.cmml" xref="S3.E12.m1.2.2.4.3.3">𝑘</ci></apply></apply><apply id="S3.E12.m1.2.2.2.cmml" xref="S3.E12.m1.2.2.2"><times id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.3"></times><apply id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1">subscript</csymbol><apply id="S3.E12.m1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12.m1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E12.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="S3.E12.m1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.3">2</cn></apply><apply id="S3.E12.m1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2">subscript</csymbol><apply id="S3.E12.m1.2.2.2.2.1.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S3.E12.m1.2.2.2.2.1.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2">norm</csymbol><apply id="S3.E12.m1.2.2.2.2.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1">superscript</csymbol><apply id="S3.E12.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E12.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.2.2">𝑧</ci><ci id="S3.E12.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E12.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.3">𝑘</ci></apply></apply><cn type="integer" id="S3.E12.m1.2.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.2c">\pi_{i}=\frac{1}{L*L_{i}}\sum\limits_{j=1}^{L}\sum\limits_{k=1}^{L_{i}}\frac{z^{j}z_{i}^{k}}{\|z^{j}\|_{2}\|z_{i}^{k}\|_{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.SSS2.p6" class="ltx_para">
<p id="S3.SS2.SSS2.p6.2" class="ltx_p">Using the score function above, we obtain the top-<math id="S3.SS2.SSS2.p6.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS2.p6.1.m1.1a"><mi id="S3.SS2.SSS2.p6.1.m1.1.1" xref="S3.SS2.SSS2.p6.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.1.m1.1b"><ci id="S3.SS2.SSS2.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.1.m1.1c">N</annotation></semantics></math> nearest neighbors of the query input in the training set and then format them as the answer-aware examples <math id="S3.SS2.SSS2.p6.2.m2.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS2.SSS2.p6.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p6.2.m2.1.1" xref="S3.SS2.SSS2.p6.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.2.m2.1b"><ci id="S3.SS2.SSS2.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p6.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.2.m2.1c">\mathcal{E}</annotation></semantics></math> as follows:</p>
<table id="S3.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{I}_{\textrm{AE}}" display="inline"><semantics id="S3.E13X.2.1.1.m1.1a"><msub id="S3.E13X.2.1.1.m1.1.1" xref="S3.E13X.2.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13X.2.1.1.m1.1.1.2" xref="S3.E13X.2.1.1.m1.1.1.2.cmml">ℐ</mi><mtext id="S3.E13X.2.1.1.m1.1.1.3" xref="S3.E13X.2.1.1.m1.1.1.3a.cmml">AE</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.E13X.2.1.1.m1.1b"><apply id="S3.E13X.2.1.1.m1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.2">ℐ</ci><ci id="S3.E13X.2.1.1.m1.1.1.3a.cmml" xref="S3.E13X.2.1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.E13X.2.1.1.m1.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.1.1.3">AE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.2.1.1.m1.1c">\displaystyle\mathcal{I}_{\textrm{AE}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle=\mathop{\text{argTopN}}\limits_{i\in\{1,2,...,M\}}\pi_{i}" display="inline"><semantics id="S3.E13X.3.2.2.m1.4a"><mrow id="S3.E13X.3.2.2.m1.4.5" xref="S3.E13X.3.2.2.m1.4.5.cmml"><mi id="S3.E13X.3.2.2.m1.4.5.2" xref="S3.E13X.3.2.2.m1.4.5.2.cmml"></mi><mo id="S3.E13X.3.2.2.m1.4.5.1" xref="S3.E13X.3.2.2.m1.4.5.1.cmml">=</mo><mrow id="S3.E13X.3.2.2.m1.4.5.3" xref="S3.E13X.3.2.2.m1.4.5.3.cmml"><munder id="S3.E13X.3.2.2.m1.4.5.3.1" xref="S3.E13X.3.2.2.m1.4.5.3.1.cmml"><mtext id="S3.E13X.3.2.2.m1.4.5.3.1.2" xref="S3.E13X.3.2.2.m1.4.5.3.1.2a.cmml">argTopN</mtext><mrow id="S3.E13X.3.2.2.m1.4.4.4" xref="S3.E13X.3.2.2.m1.4.4.4.cmml"><mi id="S3.E13X.3.2.2.m1.4.4.4.6" xref="S3.E13X.3.2.2.m1.4.4.4.6.cmml">i</mi><mo id="S3.E13X.3.2.2.m1.4.4.4.5" xref="S3.E13X.3.2.2.m1.4.4.4.5.cmml">∈</mo><mrow id="S3.E13X.3.2.2.m1.4.4.4.7.2" xref="S3.E13X.3.2.2.m1.4.4.4.7.1.cmml"><mo stretchy="false" id="S3.E13X.3.2.2.m1.4.4.4.7.2.1" xref="S3.E13X.3.2.2.m1.4.4.4.7.1.cmml">{</mo><mn id="S3.E13X.3.2.2.m1.1.1.1.1" xref="S3.E13X.3.2.2.m1.1.1.1.1.cmml">1</mn><mo id="S3.E13X.3.2.2.m1.4.4.4.7.2.2" xref="S3.E13X.3.2.2.m1.4.4.4.7.1.cmml">,</mo><mn id="S3.E13X.3.2.2.m1.2.2.2.2" xref="S3.E13X.3.2.2.m1.2.2.2.2.cmml">2</mn><mo id="S3.E13X.3.2.2.m1.4.4.4.7.2.3" xref="S3.E13X.3.2.2.m1.4.4.4.7.1.cmml">,</mo><mi mathvariant="normal" id="S3.E13X.3.2.2.m1.3.3.3.3" xref="S3.E13X.3.2.2.m1.3.3.3.3.cmml">…</mi><mo id="S3.E13X.3.2.2.m1.4.4.4.7.2.4" xref="S3.E13X.3.2.2.m1.4.4.4.7.1.cmml">,</mo><mi id="S3.E13X.3.2.2.m1.4.4.4.4" xref="S3.E13X.3.2.2.m1.4.4.4.4.cmml">M</mi><mo stretchy="false" id="S3.E13X.3.2.2.m1.4.4.4.7.2.5" xref="S3.E13X.3.2.2.m1.4.4.4.7.1.cmml">}</mo></mrow></mrow></munder><msub id="S3.E13X.3.2.2.m1.4.5.3.2" xref="S3.E13X.3.2.2.m1.4.5.3.2.cmml"><mi id="S3.E13X.3.2.2.m1.4.5.3.2.2" xref="S3.E13X.3.2.2.m1.4.5.3.2.2.cmml">π</mi><mi id="S3.E13X.3.2.2.m1.4.5.3.2.3" xref="S3.E13X.3.2.2.m1.4.5.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13X.3.2.2.m1.4b"><apply id="S3.E13X.3.2.2.m1.4.5.cmml" xref="S3.E13X.3.2.2.m1.4.5"><eq id="S3.E13X.3.2.2.m1.4.5.1.cmml" xref="S3.E13X.3.2.2.m1.4.5.1"></eq><csymbol cd="latexml" id="S3.E13X.3.2.2.m1.4.5.2.cmml" xref="S3.E13X.3.2.2.m1.4.5.2">absent</csymbol><apply id="S3.E13X.3.2.2.m1.4.5.3.cmml" xref="S3.E13X.3.2.2.m1.4.5.3"><apply id="S3.E13X.3.2.2.m1.4.5.3.1.cmml" xref="S3.E13X.3.2.2.m1.4.5.3.1"><csymbol cd="ambiguous" id="S3.E13X.3.2.2.m1.4.5.3.1.1.cmml" xref="S3.E13X.3.2.2.m1.4.5.3.1">subscript</csymbol><ci id="S3.E13X.3.2.2.m1.4.5.3.1.2a.cmml" xref="S3.E13X.3.2.2.m1.4.5.3.1.2"><mtext id="S3.E13X.3.2.2.m1.4.5.3.1.2.cmml" xref="S3.E13X.3.2.2.m1.4.5.3.1.2">argTopN</mtext></ci><apply id="S3.E13X.3.2.2.m1.4.4.4.cmml" xref="S3.E13X.3.2.2.m1.4.4.4"><in id="S3.E13X.3.2.2.m1.4.4.4.5.cmml" xref="S3.E13X.3.2.2.m1.4.4.4.5"></in><ci id="S3.E13X.3.2.2.m1.4.4.4.6.cmml" xref="S3.E13X.3.2.2.m1.4.4.4.6">𝑖</ci><set id="S3.E13X.3.2.2.m1.4.4.4.7.1.cmml" xref="S3.E13X.3.2.2.m1.4.4.4.7.2"><cn type="integer" id="S3.E13X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1">1</cn><cn type="integer" id="S3.E13X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2">2</cn><ci id="S3.E13X.3.2.2.m1.3.3.3.3.cmml" xref="S3.E13X.3.2.2.m1.3.3.3.3">…</ci><ci id="S3.E13X.3.2.2.m1.4.4.4.4.cmml" xref="S3.E13X.3.2.2.m1.4.4.4.4">𝑀</ci></set></apply></apply><apply id="S3.E13X.3.2.2.m1.4.5.3.2.cmml" xref="S3.E13X.3.2.2.m1.4.5.3.2"><csymbol cd="ambiguous" id="S3.E13X.3.2.2.m1.4.5.3.2.1.cmml" xref="S3.E13X.3.2.2.m1.4.5.3.2">subscript</csymbol><ci id="S3.E13X.3.2.2.m1.4.5.3.2.2.cmml" xref="S3.E13X.3.2.2.m1.4.5.3.2.2">𝜋</ci><ci id="S3.E13X.3.2.2.m1.4.5.3.2.3.cmml" xref="S3.E13X.3.2.2.m1.4.5.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.3.2.2.m1.4c">\displaystyle=\mathop{\text{argTopN}}\limits_{i\in\{1,2,...,M\}}\pi_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
<tr id="S3.E13Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{E}" display="inline"><semantics id="S3.E13Xa.2.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.E13Xa.2.1.1.m1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.E13Xa.2.1.1.m1.1b"><ci id="S3.E13Xa.2.1.1.m1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E13Xa.2.1.1.m1.1c">\displaystyle\mathcal{E}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13Xa.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\{(v_{i},q_{i},a_{i})\ |\ i\in\mathcal{I}_{\textrm{AE}}\}" display="inline"><semantics id="S3.E13Xa.3.2.2.m1.2a"><mrow id="S3.E13Xa.3.2.2.m1.2.2" xref="S3.E13Xa.3.2.2.m1.2.2.cmml"><mi id="S3.E13Xa.3.2.2.m1.2.2.4" xref="S3.E13Xa.3.2.2.m1.2.2.4.cmml"></mi><mo id="S3.E13Xa.3.2.2.m1.2.2.3" xref="S3.E13Xa.3.2.2.m1.2.2.3.cmml">=</mo><mrow id="S3.E13Xa.3.2.2.m1.2.2.2.2" xref="S3.E13Xa.3.2.2.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E13Xa.3.2.2.m1.2.2.2.2.3" xref="S3.E13Xa.3.2.2.m1.2.2.2.3.1.cmml">{</mo><mrow id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.4" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.4.cmml">(</mo><msub id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.5" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.2" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml">q</mi><mi id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.3" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.6" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.2" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.2.cmml">a</mi><mi id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.3" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo rspace="0.222em" stretchy="false" id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.7" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.4.cmml">)</mo></mrow><mo rspace="0.500em" id="S3.E13Xa.3.2.2.m1.2.2.2.2.4" xref="S3.E13Xa.3.2.2.m1.2.2.2.3.1.cmml">|</mo><mrow id="S3.E13Xa.3.2.2.m1.2.2.2.2.2" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.cmml"><mi id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.2" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.2.cmml">i</mi><mo id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.1" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.1.cmml">∈</mo><msub id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.2" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.2.cmml">ℐ</mi><mtext id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.3" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.3a.cmml">AE</mtext></msub></mrow><mo stretchy="false" id="S3.E13Xa.3.2.2.m1.2.2.2.2.5" xref="S3.E13Xa.3.2.2.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13Xa.3.2.2.m1.2b"><apply id="S3.E13Xa.3.2.2.m1.2.2.cmml" xref="S3.E13Xa.3.2.2.m1.2.2"><eq id="S3.E13Xa.3.2.2.m1.2.2.3.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.3"></eq><csymbol cd="latexml" id="S3.E13Xa.3.2.2.m1.2.2.4.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.4">absent</csymbol><apply id="S3.E13Xa.3.2.2.m1.2.2.2.3.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2"><csymbol cd="latexml" id="S3.E13Xa.3.2.2.m1.2.2.2.3.1.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.3">conditional-set</csymbol><vector id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.4.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3"><apply id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.2">𝑞</ci><ci id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E13Xa.3.2.2.m1.1.1.1.1.1.3.3.3">𝑖</ci></apply></vector><apply id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2"><in id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.1.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.1"></in><ci id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.2">𝑖</ci><apply id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.1.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.2.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.2">ℐ</ci><ci id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.3a.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.3"><mtext mathsize="70%" id="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.3.cmml" xref="S3.E13Xa.3.2.2.m1.2.2.2.2.2.3.3">AE</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13Xa.3.2.2.m1.2c">\displaystyle=\{(v_{i},q_{i},a_{i})\ |\ i\in\mathcal{I}_{\textrm{AE}}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.SSS2.p6.5" class="ltx_p">where <math id="S3.SS2.SSS2.p6.3.m1.1" class="ltx_Math" alttext="\mathcal{I}_{\textrm{AE}}" display="inline"><semantics id="S3.SS2.SSS2.p6.3.m1.1a"><msub id="S3.SS2.SSS2.p6.3.m1.1.1" xref="S3.SS2.SSS2.p6.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p6.3.m1.1.1.2" xref="S3.SS2.SSS2.p6.3.m1.1.1.2.cmml">ℐ</mi><mtext id="S3.SS2.SSS2.p6.3.m1.1.1.3" xref="S3.SS2.SSS2.p6.3.m1.1.1.3a.cmml">AE</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.3.m1.1b"><apply id="S3.SS2.SSS2.p6.3.m1.1.1.cmml" xref="S3.SS2.SSS2.p6.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.3.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p6.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p6.3.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p6.3.m1.1.1.2">ℐ</ci><ci id="S3.SS2.SSS2.p6.3.m1.1.1.3a.cmml" xref="S3.SS2.SSS2.p6.3.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS2.p6.3.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p6.3.m1.1.1.3">AE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.3.m1.1c">\mathcal{I}_{\textrm{AE}}</annotation></semantics></math> is an index set of the top-<math id="S3.SS2.SSS2.p6.4.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS2.p6.4.m2.1a"><mi id="S3.SS2.SSS2.p6.4.m2.1.1" xref="S3.SS2.SSS2.p6.4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.4.m2.1b"><ci id="S3.SS2.SSS2.p6.4.m2.1.1.cmml" xref="S3.SS2.SSS2.p6.4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.4.m2.1c">N</annotation></semantics></math> nearest neighbors in the training set <math id="S3.SS2.SSS2.p6.5.m3.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS2.SSS2.p6.5.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p6.5.m3.1.1" xref="S3.SS2.SSS2.p6.5.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.5.m3.1b"><ci id="S3.SS2.SSS2.p6.5.m3.1.1.cmml" xref="S3.SS2.SSS2.p6.5.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.5.m3.1c">\mathcal{D}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span id="S3.SS3.10.1" class="ltx_text ltx_font_italic">Stage-2: Heuristics-enhanced Prompting</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.2" class="ltx_p">After obtaining the answer heuristics (<em id="S3.SS3.p1.2.1" class="ltx_emph ltx_font_italic">i.e.</em>, answer candidates <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{C}</annotation></semantics></math> and answer-aware examples <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\mathcal{E}</annotation></semantics></math>) from the stage-1, we encode them into a heuristics-enhanced prompt to facilitate the few-shot learning capacity of the LLM for knowledge-based VQA.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">A prompt consists of a prompt head, a set of in-context examples, and a testing input. The prompt head describes the VQA task in natural language. We refer to the prompt head designed in PICa and supplement it with a new description of the answer candidates. Although we encourage LLM to generate answers according to the answer candidates, we also allow it to take broad explorations and generate answers beyond the candidates. The complete format of our prompt head is shown in the yellow box of Fig. <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.5" class="ltx_p">Our in-context examples are derived from the obtained <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">N</annotation></semantics></math> answer-aware examples <math id="S3.SS3.p3.2.m2.4" class="ltx_Math" alttext="\mathcal{E}=\{\boldsymbol{e}_{1},\boldsymbol{e}_{2},...,\boldsymbol{e}_{N}\}" display="inline"><semantics id="S3.SS3.p3.2.m2.4a"><mrow id="S3.SS3.p3.2.m2.4.4" xref="S3.SS3.p3.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.2.m2.4.4.5" xref="S3.SS3.p3.2.m2.4.4.5.cmml">ℰ</mi><mo id="S3.SS3.p3.2.m2.4.4.4" xref="S3.SS3.p3.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.p3.2.m2.4.4.3.3" xref="S3.SS3.p3.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.4.4.3.3.4" xref="S3.SS3.p3.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.SS3.p3.2.m2.2.2.1.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.2.2.1.1.1.2" xref="S3.SS3.p3.2.m2.2.2.1.1.1.2.cmml">𝒆</mi><mn id="S3.SS3.p3.2.m2.2.2.1.1.1.3" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p3.2.m2.4.4.3.3.5" xref="S3.SS3.p3.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p3.2.m2.3.3.2.2.2" xref="S3.SS3.p3.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS3.p3.2.m2.3.3.2.2.2.2" xref="S3.SS3.p3.2.m2.3.3.2.2.2.2.cmml">𝒆</mi><mn id="S3.SS3.p3.2.m2.3.3.2.2.2.3" xref="S3.SS3.p3.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p3.2.m2.4.4.3.3.6" xref="S3.SS3.p3.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.p3.2.m2.4.4.3.3.7" xref="S3.SS3.p3.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p3.2.m2.4.4.3.3.3" xref="S3.SS3.p3.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS3.p3.2.m2.4.4.3.3.3.2" xref="S3.SS3.p3.2.m2.4.4.3.3.3.2.cmml">𝒆</mi><mi id="S3.SS3.p3.2.m2.4.4.3.3.3.3" xref="S3.SS3.p3.2.m2.4.4.3.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS3.p3.2.m2.4.4.3.3.8" xref="S3.SS3.p3.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.4b"><apply id="S3.SS3.p3.2.m2.4.4.cmml" xref="S3.SS3.p3.2.m2.4.4"><eq id="S3.SS3.p3.2.m2.4.4.4.cmml" xref="S3.SS3.p3.2.m2.4.4.4"></eq><ci id="S3.SS3.p3.2.m2.4.4.5.cmml" xref="S3.SS3.p3.2.m2.4.4.5">ℰ</ci><set id="S3.SS3.p3.2.m2.4.4.3.4.cmml" xref="S3.SS3.p3.2.m2.4.4.3.3"><apply id="S3.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.2">𝒆</ci><cn type="integer" id="S3.SS3.p3.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p3.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.2.2">𝒆</ci><cn type="integer" id="S3.SS3.p3.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">…</ci><apply id="S3.SS3.p3.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.p3.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS3.p3.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p3.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS3.p3.2.m2.4.4.3.3.3.2">𝒆</ci><ci id="S3.SS3.p3.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS3.p3.2.m2.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.4c">\mathcal{E}=\{\boldsymbol{e}_{1},\boldsymbol{e}_{2},...,\boldsymbol{e}_{N}\}</annotation></semantics></math>. Based on PICa’s template in <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\S" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mi mathvariant="normal" id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\S</annotation></semantics></math><a href="#S3.SS1" title="3.1 Preliminaries ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>, for example <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\boldsymbol{e}_{i}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">𝒆</mi><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝒆</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\boldsymbol{e}_{i}</annotation></semantics></math>, we introduce its answer candidates <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msub id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">𝒞</mi><mi id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝒞</ci><ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\mathcal{C}_{i}</annotation></semantics></math> by adding <em id="S3.SS3.p3.5.1" class="ltx_emph ltx_font_italic">one</em> line of code as follows:</p>
</div>
<figure id="S3.SS3.9" class="ltx_table">
<table id="S3.SS3.9.9" class="ltx_tabular ltx_align_middle">
<tr id="S3.SS3.2.2.2" class="ltx_tr">
<td id="S3.SS3.2.2.2.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">
<span id="S3.SS3.2.2.2.2.1" class="ltx_text ltx_font_typewriter">Context:</span> <math id="S3.SS3.1.1.1.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS3.1.1.1.1.m1.1a"><msub id="S3.SS3.1.1.1.1.m1.1.1" xref="S3.SS3.1.1.1.1.m1.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.1.1.1.1.m1.1.1.2" xref="S3.SS3.1.1.1.1.m1.1.1.2.cmml">c</mi><mi mathcolor="#0000FF" id="S3.SS3.1.1.1.1.m1.1.1.3" xref="S3.SS3.1.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.1.1.1.1.m1.1b"><apply id="S3.SS3.1.1.1.1.m1.1.1.cmml" xref="S3.SS3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.1.1.1.1.m1.1.1.1.cmml" xref="S3.SS3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.1.1.1.1.m1.1.1.2.cmml" xref="S3.SS3.1.1.1.1.m1.1.1.2">𝑐</ci><ci id="S3.SS3.1.1.1.1.m1.1.1.3.cmml" xref="S3.SS3.1.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.1.1.1.m1.1c">c_{i}</annotation></semantics></math>  \<span id="S3.SS3.2.2.2.2.2" class="ltx_text ltx_font_typewriter">n</span>  <span id="S3.SS3.2.2.2.2.3" class="ltx_text ltx_font_typewriter">Question:</span> <math id="S3.SS3.2.2.2.2.m2.1" class="ltx_Math" alttext="q_{i}" display="inline"><semantics id="S3.SS3.2.2.2.2.m2.1a"><msub id="S3.SS3.2.2.2.2.m2.1.1" xref="S3.SS3.2.2.2.2.m2.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.2.2.2.2.m2.1.1.2" xref="S3.SS3.2.2.2.2.m2.1.1.2.cmml">q</mi><mi mathcolor="#0000FF" id="S3.SS3.2.2.2.2.m2.1.1.3" xref="S3.SS3.2.2.2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.2.2.2.2.m2.1b"><apply id="S3.SS3.2.2.2.2.m2.1.1.cmml" xref="S3.SS3.2.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.2.2.2.2.m2.1.1.1.cmml" xref="S3.SS3.2.2.2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.2.2.2.2.m2.1.1.2.cmml" xref="S3.SS3.2.2.2.2.m2.1.1.2">𝑞</ci><ci id="S3.SS3.2.2.2.2.m2.1.1.3.cmml" xref="S3.SS3.2.2.2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.2.2.2.2.m2.1c">q_{i}</annotation></semantics></math>  \<span id="S3.SS3.2.2.2.2.4" class="ltx_text ltx_font_typewriter">n</span>
</td>
</tr>
<tr id="S3.SS3.8.8.8" class="ltx_tr">
<td id="S3.SS3.8.8.8.6" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">
<span id="S3.SS3.8.8.8.6.1" class="ltx_text ltx_font_typewriter">Candidates:</span> <math id="S3.SS3.3.3.3.1.m1.1" class="ltx_Math" alttext="\boldsymbol{w}_{j_{1}}" display="inline"><semantics id="S3.SS3.3.3.3.1.m1.1a"><msub id="S3.SS3.3.3.3.1.m1.1.1" xref="S3.SS3.3.3.3.1.m1.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.3.3.3.1.m1.1.1.2" xref="S3.SS3.3.3.3.1.m1.1.1.2.cmml">𝒘</mi><msub id="S3.SS3.3.3.3.1.m1.1.1.3" xref="S3.SS3.3.3.3.1.m1.1.1.3.cmml"><mi mathcolor="#0000FF" id="S3.SS3.3.3.3.1.m1.1.1.3.2" xref="S3.SS3.3.3.3.1.m1.1.1.3.2.cmml">j</mi><mn mathcolor="#0000FF" id="S3.SS3.3.3.3.1.m1.1.1.3.3" xref="S3.SS3.3.3.3.1.m1.1.1.3.3.cmml">1</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.3.3.3.1.m1.1b"><apply id="S3.SS3.3.3.3.1.m1.1.1.cmml" xref="S3.SS3.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.3.3.3.1.m1.1.1.1.cmml" xref="S3.SS3.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.3.3.3.1.m1.1.1.2.cmml" xref="S3.SS3.3.3.3.1.m1.1.1.2">𝒘</ci><apply id="S3.SS3.3.3.3.1.m1.1.1.3.cmml" xref="S3.SS3.3.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.3.3.3.1.m1.1.1.3.1.cmml" xref="S3.SS3.3.3.3.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.3.3.3.1.m1.1.1.3.2.cmml" xref="S3.SS3.3.3.3.1.m1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS3.3.3.3.1.m1.1.1.3.3.cmml" xref="S3.SS3.3.3.3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.3.3.3.1.m1.1c">\boldsymbol{w}_{j_{1}}</annotation></semantics></math>(<math id="S3.SS3.4.4.4.2.m2.1" class="ltx_Math" alttext="s_{j_{1}}" display="inline"><semantics id="S3.SS3.4.4.4.2.m2.1a"><msub id="S3.SS3.4.4.4.2.m2.1.1" xref="S3.SS3.4.4.4.2.m2.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.4.4.4.2.m2.1.1.2" xref="S3.SS3.4.4.4.2.m2.1.1.2.cmml">s</mi><msub id="S3.SS3.4.4.4.2.m2.1.1.3" xref="S3.SS3.4.4.4.2.m2.1.1.3.cmml"><mi mathcolor="#0000FF" id="S3.SS3.4.4.4.2.m2.1.1.3.2" xref="S3.SS3.4.4.4.2.m2.1.1.3.2.cmml">j</mi><mn mathcolor="#0000FF" id="S3.SS3.4.4.4.2.m2.1.1.3.3" xref="S3.SS3.4.4.4.2.m2.1.1.3.3.cmml">1</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.4.4.4.2.m2.1b"><apply id="S3.SS3.4.4.4.2.m2.1.1.cmml" xref="S3.SS3.4.4.4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.4.4.4.2.m2.1.1.1.cmml" xref="S3.SS3.4.4.4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.4.4.4.2.m2.1.1.2.cmml" xref="S3.SS3.4.4.4.2.m2.1.1.2">𝑠</ci><apply id="S3.SS3.4.4.4.2.m2.1.1.3.cmml" xref="S3.SS3.4.4.4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.4.4.4.2.m2.1.1.3.1.cmml" xref="S3.SS3.4.4.4.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.4.4.4.2.m2.1.1.3.2.cmml" xref="S3.SS3.4.4.4.2.m2.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS3.4.4.4.2.m2.1.1.3.3.cmml" xref="S3.SS3.4.4.4.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.4.4.4.2.m2.1c">s_{j_{1}}</annotation></semantics></math>), <math id="S3.SS3.5.5.5.3.m3.1" class="ltx_Math" alttext="\boldsymbol{w}_{j_{2}}" display="inline"><semantics id="S3.SS3.5.5.5.3.m3.1a"><msub id="S3.SS3.5.5.5.3.m3.1.1" xref="S3.SS3.5.5.5.3.m3.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.5.5.5.3.m3.1.1.2" xref="S3.SS3.5.5.5.3.m3.1.1.2.cmml">𝒘</mi><msub id="S3.SS3.5.5.5.3.m3.1.1.3" xref="S3.SS3.5.5.5.3.m3.1.1.3.cmml"><mi mathcolor="#0000FF" id="S3.SS3.5.5.5.3.m3.1.1.3.2" xref="S3.SS3.5.5.5.3.m3.1.1.3.2.cmml">j</mi><mn mathcolor="#0000FF" id="S3.SS3.5.5.5.3.m3.1.1.3.3" xref="S3.SS3.5.5.5.3.m3.1.1.3.3.cmml">2</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.5.5.5.3.m3.1b"><apply id="S3.SS3.5.5.5.3.m3.1.1.cmml" xref="S3.SS3.5.5.5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.5.5.5.3.m3.1.1.1.cmml" xref="S3.SS3.5.5.5.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.5.5.5.3.m3.1.1.2.cmml" xref="S3.SS3.5.5.5.3.m3.1.1.2">𝒘</ci><apply id="S3.SS3.5.5.5.3.m3.1.1.3.cmml" xref="S3.SS3.5.5.5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.5.5.5.3.m3.1.1.3.1.cmml" xref="S3.SS3.5.5.5.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.5.5.5.3.m3.1.1.3.2.cmml" xref="S3.SS3.5.5.5.3.m3.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS3.5.5.5.3.m3.1.1.3.3.cmml" xref="S3.SS3.5.5.5.3.m3.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.5.5.5.3.m3.1c">\boldsymbol{w}_{j_{2}}</annotation></semantics></math>(<math id="S3.SS3.6.6.6.4.m4.1" class="ltx_Math" alttext="s_{j_{2}}" display="inline"><semantics id="S3.SS3.6.6.6.4.m4.1a"><msub id="S3.SS3.6.6.6.4.m4.1.1" xref="S3.SS3.6.6.6.4.m4.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.6.6.6.4.m4.1.1.2" xref="S3.SS3.6.6.6.4.m4.1.1.2.cmml">s</mi><msub id="S3.SS3.6.6.6.4.m4.1.1.3" xref="S3.SS3.6.6.6.4.m4.1.1.3.cmml"><mi mathcolor="#0000FF" id="S3.SS3.6.6.6.4.m4.1.1.3.2" xref="S3.SS3.6.6.6.4.m4.1.1.3.2.cmml">j</mi><mn mathcolor="#0000FF" id="S3.SS3.6.6.6.4.m4.1.1.3.3" xref="S3.SS3.6.6.6.4.m4.1.1.3.3.cmml">2</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.6.6.6.4.m4.1b"><apply id="S3.SS3.6.6.6.4.m4.1.1.cmml" xref="S3.SS3.6.6.6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.6.6.6.4.m4.1.1.1.cmml" xref="S3.SS3.6.6.6.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.6.6.6.4.m4.1.1.2.cmml" xref="S3.SS3.6.6.6.4.m4.1.1.2">𝑠</ci><apply id="S3.SS3.6.6.6.4.m4.1.1.3.cmml" xref="S3.SS3.6.6.6.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.6.6.6.4.m4.1.1.3.1.cmml" xref="S3.SS3.6.6.6.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.6.6.6.4.m4.1.1.3.2.cmml" xref="S3.SS3.6.6.6.4.m4.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS3.6.6.6.4.m4.1.1.3.3.cmml" xref="S3.SS3.6.6.6.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.6.6.6.4.m4.1c">s_{j_{2}}</annotation></semantics></math>),…,<math id="S3.SS3.7.7.7.5.m5.1" class="ltx_Math" alttext="\boldsymbol{w}_{j_{K}}" display="inline"><semantics id="S3.SS3.7.7.7.5.m5.1a"><msub id="S3.SS3.7.7.7.5.m5.1.1" xref="S3.SS3.7.7.7.5.m5.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.7.7.7.5.m5.1.1.2" xref="S3.SS3.7.7.7.5.m5.1.1.2.cmml">𝒘</mi><msub id="S3.SS3.7.7.7.5.m5.1.1.3" xref="S3.SS3.7.7.7.5.m5.1.1.3.cmml"><mi mathcolor="#0000FF" id="S3.SS3.7.7.7.5.m5.1.1.3.2" xref="S3.SS3.7.7.7.5.m5.1.1.3.2.cmml">j</mi><mi mathcolor="#0000FF" id="S3.SS3.7.7.7.5.m5.1.1.3.3" xref="S3.SS3.7.7.7.5.m5.1.1.3.3.cmml">K</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.7.7.7.5.m5.1b"><apply id="S3.SS3.7.7.7.5.m5.1.1.cmml" xref="S3.SS3.7.7.7.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.7.7.7.5.m5.1.1.1.cmml" xref="S3.SS3.7.7.7.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.7.7.7.5.m5.1.1.2.cmml" xref="S3.SS3.7.7.7.5.m5.1.1.2">𝒘</ci><apply id="S3.SS3.7.7.7.5.m5.1.1.3.cmml" xref="S3.SS3.7.7.7.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.7.7.7.5.m5.1.1.3.1.cmml" xref="S3.SS3.7.7.7.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS3.7.7.7.5.m5.1.1.3.2.cmml" xref="S3.SS3.7.7.7.5.m5.1.1.3.2">𝑗</ci><ci id="S3.SS3.7.7.7.5.m5.1.1.3.3.cmml" xref="S3.SS3.7.7.7.5.m5.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.7.7.7.5.m5.1c">\boldsymbol{w}_{j_{K}}</annotation></semantics></math>(<math id="S3.SS3.8.8.8.6.m6.1" class="ltx_Math" alttext="s_{j_{K}}" display="inline"><semantics id="S3.SS3.8.8.8.6.m6.1a"><msub id="S3.SS3.8.8.8.6.m6.1.1" xref="S3.SS3.8.8.8.6.m6.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.8.8.8.6.m6.1.1.2" xref="S3.SS3.8.8.8.6.m6.1.1.2.cmml">s</mi><msub id="S3.SS3.8.8.8.6.m6.1.1.3" xref="S3.SS3.8.8.8.6.m6.1.1.3.cmml"><mi mathcolor="#0000FF" id="S3.SS3.8.8.8.6.m6.1.1.3.2" xref="S3.SS3.8.8.8.6.m6.1.1.3.2.cmml">j</mi><mi mathcolor="#0000FF" id="S3.SS3.8.8.8.6.m6.1.1.3.3" xref="S3.SS3.8.8.8.6.m6.1.1.3.3.cmml">K</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.8.8.8.6.m6.1b"><apply id="S3.SS3.8.8.8.6.m6.1.1.cmml" xref="S3.SS3.8.8.8.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.8.8.8.6.m6.1.1.1.cmml" xref="S3.SS3.8.8.8.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.8.8.8.6.m6.1.1.2.cmml" xref="S3.SS3.8.8.8.6.m6.1.1.2">𝑠</ci><apply id="S3.SS3.8.8.8.6.m6.1.1.3.cmml" xref="S3.SS3.8.8.8.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.8.8.8.6.m6.1.1.3.1.cmml" xref="S3.SS3.8.8.8.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS3.8.8.8.6.m6.1.1.3.2.cmml" xref="S3.SS3.8.8.8.6.m6.1.1.3.2">𝑗</ci><ci id="S3.SS3.8.8.8.6.m6.1.1.3.3.cmml" xref="S3.SS3.8.8.8.6.m6.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.8.8.8.6.m6.1c">s_{j_{K}}</annotation></semantics></math>) \<span id="S3.SS3.8.8.8.6.2" class="ltx_text ltx_font_typewriter">n</span>
</td>
</tr>
<tr id="S3.SS3.9.9.9" class="ltx_tr">
<td id="S3.SS3.9.9.9.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r">
<span id="S3.SS3.9.9.9.1.1" class="ltx_text ltx_font_typewriter">Answer:</span> <math id="S3.SS3.9.9.9.1.m1.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS3.9.9.9.1.m1.1a"><msub id="S3.SS3.9.9.9.1.m1.1.1" xref="S3.SS3.9.9.9.1.m1.1.1.cmml"><mi mathcolor="#0000FF" id="S3.SS3.9.9.9.1.m1.1.1.2" xref="S3.SS3.9.9.9.1.m1.1.1.2.cmml">a</mi><mi mathcolor="#0000FF" id="S3.SS3.9.9.9.1.m1.1.1.3" xref="S3.SS3.9.9.9.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.9.9.9.1.m1.1b"><apply id="S3.SS3.9.9.9.1.m1.1.1.cmml" xref="S3.SS3.9.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.9.9.9.1.m1.1.1.1.cmml" xref="S3.SS3.9.9.9.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.9.9.9.1.m1.1.1.2.cmml" xref="S3.SS3.9.9.9.1.m1.1.1.2">𝑎</ci><ci id="S3.SS3.9.9.9.1.m1.1.1.3.cmml" xref="S3.SS3.9.9.9.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.9.9.9.1.m1.1c">a_{i}</annotation></semantics></math>
</td>
</tr>
</table>
</figure>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.4" class="ltx_p">where <math id="S3.SS3.p4.1.m1.4" class="ltx_Math" alttext="j_{1},j_{2},\cdots,j_{K}" display="inline"><semantics id="S3.SS3.p4.1.m1.4a"><mrow id="S3.SS3.p4.1.m1.4.4.3" xref="S3.SS3.p4.1.m1.4.4.4.cmml"><msub id="S3.SS3.p4.1.m1.2.2.1.1" xref="S3.SS3.p4.1.m1.2.2.1.1.cmml"><mi id="S3.SS3.p4.1.m1.2.2.1.1.2" xref="S3.SS3.p4.1.m1.2.2.1.1.2.cmml">j</mi><mn id="S3.SS3.p4.1.m1.2.2.1.1.3" xref="S3.SS3.p4.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p4.1.m1.4.4.3.4" xref="S3.SS3.p4.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS3.p4.1.m1.3.3.2.2" xref="S3.SS3.p4.1.m1.3.3.2.2.cmml"><mi id="S3.SS3.p4.1.m1.3.3.2.2.2" xref="S3.SS3.p4.1.m1.3.3.2.2.2.cmml">j</mi><mn id="S3.SS3.p4.1.m1.3.3.2.2.3" xref="S3.SS3.p4.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p4.1.m1.4.4.3.5" xref="S3.SS3.p4.1.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS3.p4.1.m1.4.4.3.6" xref="S3.SS3.p4.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS3.p4.1.m1.4.4.3.3" xref="S3.SS3.p4.1.m1.4.4.3.3.cmml"><mi id="S3.SS3.p4.1.m1.4.4.3.3.2" xref="S3.SS3.p4.1.m1.4.4.3.3.2.cmml">j</mi><mi id="S3.SS3.p4.1.m1.4.4.3.3.3" xref="S3.SS3.p4.1.m1.4.4.3.3.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.4b"><list id="S3.SS3.p4.1.m1.4.4.4.cmml" xref="S3.SS3.p4.1.m1.4.4.3"><apply id="S3.SS3.p4.1.m1.2.2.1.1.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.2">𝑗</ci><cn type="integer" id="S3.SS3.p4.1.m1.2.2.1.1.3.cmml" xref="S3.SS3.p4.1.m1.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.p4.1.m1.3.3.2.2.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.3.3.2.2.1.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p4.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.2">𝑗</ci><cn type="integer" id="S3.SS3.p4.1.m1.3.3.2.2.3.cmml" xref="S3.SS3.p4.1.m1.3.3.2.2.3">2</cn></apply><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">⋯</ci><apply id="S3.SS3.p4.1.m1.4.4.3.3.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.4.4.3.3.1.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.4.4.3.3.2.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.2">𝑗</ci><ci id="S3.SS3.p4.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.p4.1.m1.4.4.3.3.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.4c">j_{1},j_{2},\cdots,j_{K}</annotation></semantics></math> correspond to the actual indices of the elements in <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">𝒞</mi><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝒞</ci><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\mathcal{C}_{i}</annotation></semantics></math>.
Each answer candidate <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="w_{j_{k}}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><msub id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml">w</mi><msub id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.2" xref="S3.SS3.p4.3.m3.1.1.3.2.cmml">j</mi><mi id="S3.SS3.p4.3.m3.1.1.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2">𝑤</ci><apply id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.2">𝑗</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">w_{j_{k}}</annotation></semantics></math> is paired with its confidence score <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="s_{j_{k}}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><msub id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml">s</mi><msub id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.3.2.cmml">j</mi><mi id="S3.SS3.p4.4.m4.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2">𝑠</ci><apply id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2">𝑗</ci><ci id="S3.SS3.p4.4.m4.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">s_{j_{k}}</annotation></semantics></math> within a bracket. The confidence scores additionally offer the reliability of the corresponding answer candidates, which helps the LLM focus more on the promising candidates and be more tolerant of the less relevant candidates. For the testing input, its template is similar to that for the in-context examples, except that the answer slot is left blank for the LLM to fill with.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.9" class="ltx_p">To better exploit available examples, we use the multi-query ensemble strategy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Specifically, we increase the number of answer-aware examples to <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">N</annotation></semantics></math>*<math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mi id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><ci id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">T</annotation></semantics></math> to obtain <math id="S3.SS3.p5.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p5.3.m3.1a"><mi id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><ci id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">T</annotation></semantics></math> paralleled prompts, where each prompt still contains <math id="S3.SS3.p5.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p5.4.m4.1a"><mi id="S3.SS3.p5.4.m4.1.1" xref="S3.SS3.p5.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.1b"><ci id="S3.SS3.p5.4.m4.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.1c">N</annotation></semantics></math> examples. By prompting the LLM for <math id="S3.SS3.p5.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p5.5.m5.1a"><mi id="S3.SS3.p5.5.m5.1.1" xref="S3.SS3.p5.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.5.m5.1b"><ci id="S3.SS3.p5.5.m5.1.1.cmml" xref="S3.SS3.p5.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.5.m5.1c">T</annotation></semantics></math> times, we obtain <math id="S3.SS3.p5.6.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p5.6.m6.1a"><mi id="S3.SS3.p5.6.m6.1.1" xref="S3.SS3.p5.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.6.m6.1b"><ci id="S3.SS3.p5.6.m6.1.1.cmml" xref="S3.SS3.p5.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.6.m6.1c">T</annotation></semantics></math> answer predictions. The majority voting is performed over the <math id="S3.SS3.p5.7.m7.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p5.7.m7.1a"><mi id="S3.SS3.p5.7.m7.1.1" xref="S3.SS3.p5.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.7.m7.1b"><ci id="S3.SS3.p5.7.m7.1.1.cmml" xref="S3.SS3.p5.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.7.m7.1c">T</annotation></semantics></math> predictions to determine the final answer. The effects of different <math id="S3.SS3.p5.8.m8.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p5.8.m8.1a"><mi id="S3.SS3.p5.8.m8.1.1" xref="S3.SS3.p5.8.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.8.m8.1b"><ci id="S3.SS3.p5.8.m8.1.1.cmml" xref="S3.SS3.p5.8.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.8.m8.1c">N</annotation></semantics></math> and <math id="S3.SS3.p5.9.m9.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p5.9.m9.1a"><mi id="S3.SS3.p5.9.m9.1.1" xref="S3.SS3.p5.9.m9.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.9.m9.1b"><ci id="S3.SS3.p5.9.m9.1.1.cmml" xref="S3.SS3.p5.9.m9.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.9.m9.1c">T</annotation></semantics></math> will be verified in the experiments.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We mainly evaluate the performance of Prophet on two prevalent knowledge-based VQA datasets: OK-VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and A-OKVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. We conduct comprehensive ablation experiments to explore the effectiveness of Prophet. By taking the ablation results into account, we perform thorough comparisons of Prophet and state-of-the-art methods. Moreover, we showcase the generalization ability of Prophet on two diverse knowledge-based VQA datasets ScienceQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and Text-VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, which require external science and OCR knowledge, respectively.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span id="S4.SS1.1.1" class="ltx_text ltx_font_italic">Datasets</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">OK-VQA</span> is a commonly used knowledge-based VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. The dataset contains 9K and 5K image-question pairs for training and testing, respectively. All questions are manually filtered to ensure that outside knowledge is required to answer the questions. Each data sample is annotated with ten open-ended answers. The accuracy computed by the soft scores is used as the evaluation metric <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. We use the 1.1 version of OK-VQA in the experiments.


<br class="ltx_break"><span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_bold">A-OKVQA</span> is currently the largest knowledge-based VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. The dataset is split into three subsets: 17K training, 1K validation, and 7K testing. Each question is annotated with ten open-ended answers for direct answer (DA) evaluation. Besides, it provides a multiple choice (MC) evaluation to choose the correct answer from four choices.


<br class="ltx_break"><span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_bold">ScienceQA</span> is a dataset that consists of about 21K questions over a diverse set of science topics <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. Out of the 21K questions, only the ‘IMG’ subset of 10.3K (48.7%) samples have image content, which is used in our experiments. Consequently, the retained dataset consists of 6.2K training, 2.1K validation, and 2.0K testing samples. The questions require high school-level science knowledge to arrive at the correct answer chosen from multiple choices.


<br class="ltx_break"><span id="S4.SS1.p1.1.4" class="ltx_text ltx_font_bold">TextVQA</span> contains 28K images and 45K questions, where each question requires models to read and reason about the text in the image to give a correct answer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. The dataset is split into three subsets of 34.6K training, 5K validation, and 5.7K testing questions. Similar to OK-VQA, each question is annotated with ten open-ended answers by humans and soft-voting accuracy is used as the evaluation metric. Following the strategy in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, we supplement the training set with the augmented VQA samples from ST-VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span id="S4.SS2.1.1" class="ltx_text ltx_font_italic">Implementation Details</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p"><span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">Default settings on OK-VQA.</span> We use the MCAN-large <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> as our default VQA model to generate answer heuristics. To improve the model capability, we modify the original MCAN model by: (i) replacing the original bottom-up-attention region-based features with the grid-based features extracted from CLIP’s visual encoder with a RN50<math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mo id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><times id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\times</annotation></semantics></math>64 backbone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>; and (ii) replacing the original LSTM network with a pretrained BERT-large model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, we apply the transfer learning paradigm to further enhance the model capability. The model is first pretrained on the VQAv2 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> and Visual Genome dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. To prevent data contamination, we remove those samples from the pretraining dataset, whose images are used in the testing split of OK-VQA. After that, the pretrained model is further finetuned on the training split of OK-VQA to obtain our final VQA model.
Note that the answer vocabulary of the pretrained model (with 3,129 answers) is quite different from the vocabulary of OK-VQA. To bridge this gap, we merge the answer vocabulary of OK-VQA<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, we collect answers that appear more than eight times in the training set of OK-VQA, resulting in 2,794 answers.</span></span></span> with the existing vocabulary, resulting in an expanded answer vocabulary with 4,477 answers for model finetuning. This model is trained on a <em id="S4.SS2.p2.1.1" class="ltx_emph ltx_font_italic">single</em> Nvidia RTX 3090 GPU, which is affordable for most people.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p">During the prompting stage using LLMs, we follow PICa to use OSCAR+ as the captioning model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. Unless otherwise noted, we set the number of answer candidates <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">K</annotation></semantics></math>=10, the number of in-context examples <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">N</annotation></semantics></math>=16, and the number of queries <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">T</annotation></semantics></math>=5 as our default settings. The default version of GPT-3 used in our experiments is <span id="S4.SS2.p3.3.1" class="ltx_text ltx_font_typewriter">text-davinci-002</span> and the sampling temperature is set to 0.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st1" class="ltx_table ltx_figure_panel">
<table id="S4.T1.st1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st1.1.2" class="ltx_tr">
<td id="S4.T1.st1.1.2.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st1.1.2.1.1" class="ltx_text" style="font-size:70%;">VQA model, paradigm</span></td>
<td id="S4.T1.st1.1.2.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st1.1.2.2.1" class="ltx_text" style="font-size:70%;">stage-1 acc.</span></td>
<td id="S4.T1.st1.1.2.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st1.1.2.3.1" class="ltx_text" style="font-size:70%;">accuracy</span></td>
</tr>
<tr id="S4.T1.st1.1.3" class="ltx_tr">
<td id="S4.T1.st1.1.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T1.st1.1.4" class="ltx_tr">
<td id="S4.T1.st1.1.4.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st1.1.4.1.1" class="ltx_text" style="font-size:70%;">ViLBERT, retrieval </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.st1.1.4.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="S4.T1.st1.1.4.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S4.T1.st1.1.4.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st1.1.4.2.1" class="ltx_text" style="font-size:70%;">35.20</span></td>
<td id="S4.T1.st1.1.4.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st1.1.4.3.1" class="ltx_text" style="font-size:70%;">40.28 (+5.08)</span></td>
</tr>
<tr id="S4.T1.st1.1.1" class="ltx_tr">
<td id="S4.T1.st1.1.1.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st1.1.1.1.1" class="ltx_text" style="font-size:70%;">ViLBERT, prompt</span><sup id="S4.T1.st1.1.1.1.2" class="ltx_sup"><span id="S4.T1.st1.1.1.1.2.1" class="ltx_text ltx_font_italic" style="font-size:70%;">†</span></sup>
</td>
<td id="S4.T1.st1.1.1.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st1.1.1.2.1" class="ltx_text" style="font-size:70%;">35.28</span></td>
<td id="S4.T1.st1.1.1.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st1.1.1.3.1" class="ltx_text" style="font-size:70%;">44.97 (+9.69)</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st1.13.2.1" class="ltx_text" style="font-size:129%;">(a)</span> </span><span id="S4.T1.st1.3.1" class="ltx_text ltx_font_bold" style="font-size:129%;">Prompting <em id="S4.T1.st1.3.1.2" class="ltx_emph ltx_font_italic">vs</em>. retrieval.<span id="S4.T1.st1.3.1.1" class="ltx_text ltx_font_medium"> Our prompting-based paradigm is more effective than the retrieval-based one in MAVEx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. <sup id="S4.T1.st1.3.1.1.1" class="ltx_sup"><span id="S4.T1.st1.3.1.1.1.1" class="ltx_text ltx_font_italic">†</span></sup>: our re-implementation.</span></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st2" class="ltx_table ltx_figure_panel">
<table id="S4.T1.st2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st2.1.2" class="ltx_tr">
<td id="S4.T1.st2.1.2.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.2.1.1" class="ltx_text" style="font-size:70%;">visual features</span></td>
<td id="S4.T1.st2.1.2.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.2.2.1" class="ltx_text" style="font-size:70%;">stage-1 acc.</span></td>
<td id="S4.T1.st2.1.2.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.2.3.1" class="ltx_text" style="font-size:70%;">accuracy</span></td>
</tr>
<tr id="S4.T1.st2.1.3" class="ltx_tr">
<td id="S4.T1.st2.1.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T1.st2.1.4" class="ltx_tr">
<td id="S4.T1.st2.1.4.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st2.1.4.1.1" class="ltx_text" style="font-size:70%;">Bottom-Up </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.st2.1.4.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib25" title="" class="ltx_ref">25</a><span id="S4.T1.st2.1.4.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S4.T1.st2.1.4.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.4.2.1" class="ltx_text" style="font-size:70%;">46.83</span></td>
<td id="S4.T1.st2.1.4.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.4.3.1" class="ltx_text" style="font-size:70%;">55.34 (+8.51)</span></td>
</tr>
<tr id="S4.T1.st2.1.5" class="ltx_tr">
<td id="S4.T1.st2.1.5.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st2.1.5.1.1" class="ltx_text" style="font-size:70%;">VinVL </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.st2.1.5.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib26" title="" class="ltx_ref">26</a><span id="S4.T1.st2.1.5.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S4.T1.st2.1.5.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.5.2.1" class="ltx_text" style="font-size:70%;">47.88</span></td>
<td id="S4.T1.st2.1.5.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.5.3.1" class="ltx_text" style="font-size:70%;">56.23 (+8.35)</span></td>
</tr>
<tr id="S4.T1.st2.1.6" class="ltx_tr">
<td id="S4.T1.st2.1.6.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st2.1.6.1.1" class="ltx_text" style="font-size:70%;">CLIP-ViT-L/14 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.st2.1.6.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib51" title="" class="ltx_ref">51</a><span id="S4.T1.st2.1.6.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S4.T1.st2.1.6.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.6.2.1" class="ltx_text" style="font-size:70%;">52.03</span></td>
<td id="S4.T1.st2.1.6.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.6.3.1" class="ltx_text" style="font-size:70%;">60.12 (+8.09)</span></td>
</tr>
<tr id="S4.T1.st2.1.1" class="ltx_tr">
<td id="S4.T1.st2.1.1.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st2.1.1.1.1" class="ltx_text" style="font-size:70%;">CLIP-RN50</span><math id="S4.T1.st2.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.st2.1.1.1.m1.1a"><mo mathsize="70%" id="S4.T1.st2.1.1.1.m1.1.1" xref="S4.T1.st2.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.st2.1.1.1.m1.1b"><times id="S4.T1.st2.1.1.1.m1.1.1.cmml" xref="S4.T1.st2.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st2.1.1.1.m1.1c">\times</annotation></semantics></math><span id="S4.T1.st2.1.1.1.2" class="ltx_text" style="font-size:70%;">64 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.st2.1.1.1.3.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib51" title="" class="ltx_ref">51</a><span id="S4.T1.st2.1.1.1.4.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S4.T1.st2.1.1.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">53.04</span></td>
<td id="S4.T1.st2.1.1.3" class="ltx_td ltx_align_center" style="background-color:#DEDEDE;padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st2.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;background-color:#DEDEDE;">60.84 (+7.80)</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st2.6.1.1" class="ltx_text" style="font-size:129%;">(b)</span> </span><span id="S4.T1.st2.7.2" class="ltx_text ltx_font_bold" style="font-size:129%;">Capability of VQA models.<span id="S4.T1.st2.7.2.1" class="ltx_text ltx_font_medium"> More powerful VQA models lead to higher accuracies, but obtain slightly less relative improvements from stage-2. </span></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st3" class="ltx_table ltx_figure_panel">
<table id="S4.T1.st3.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st3.1.1" class="ltx_tr">
<td id="S4.T1.st3.1.1.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st3.1.1.1.1" class="ltx_text" style="font-size:70%;">#candidates (</span><math id="S4.T1.st3.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T1.st3.1.1.1.m1.1a"><mi mathsize="70%" id="S4.T1.st3.1.1.1.m1.1.1" xref="S4.T1.st3.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st3.1.1.1.m1.1b"><ci id="S4.T1.st3.1.1.1.m1.1.1.cmml" xref="S4.T1.st3.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st3.1.1.1.m1.1c">K</annotation></semantics></math><span id="S4.T1.st3.1.1.1.2" class="ltx_text" style="font-size:70%;">)</span>
</td>
<td id="S4.T1.st3.1.1.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.1.2.1" class="ltx_text" style="font-size:70%;">hit rate</span></td>
<td id="S4.T1.st3.1.1.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.1.3.1" class="ltx_text" style="font-size:70%;">accuracy</span></td>
</tr>
<tr id="S4.T1.st3.1.2" class="ltx_tr">
<td id="S4.T1.st3.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T1.st3.1.3" class="ltx_tr">
<td id="S4.T1.st3.1.3.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.3.1.1" class="ltx_text" style="font-size:70%;">0</span></td>
<td id="S4.T1.st3.1.3.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.3.2.1" class="ltx_text" style="font-size:70%;">-</span></td>
<td id="S4.T1.st3.1.3.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.3.3.1" class="ltx_text" style="font-size:70%;">49.63</span></td>
</tr>
<tr id="S4.T1.st3.1.4" class="ltx_tr">
<td id="S4.T1.st3.1.4.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.4.1.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="S4.T1.st3.1.4.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.4.2.1" class="ltx_text" style="font-size:70%;">53.04</span></td>
<td id="S4.T1.st3.1.4.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.4.3.1" class="ltx_text" style="font-size:70%;">56.04</span></td>
</tr>
<tr id="S4.T1.st3.1.5" class="ltx_tr">
<td id="S4.T1.st3.1.5.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.5.1.1" class="ltx_text" style="font-size:70%;">5</span></td>
<td id="S4.T1.st3.1.5.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.5.2.1" class="ltx_text" style="font-size:70%;">75.20</span></td>
<td id="S4.T1.st3.1.5.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.5.3.1" class="ltx_text" style="font-size:70%;">60.17</span></td>
</tr>
<tr id="S4.T1.st3.1.6" class="ltx_tr">
<td id="S4.T1.st3.1.6.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.6.1.1" class="ltx_text" style="font-size:70%;">10</span></td>
<td id="S4.T1.st3.1.6.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.6.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">79.83</span></td>
<td id="S4.T1.st3.1.6.3" class="ltx_td ltx_align_center" style="background-color:#DEDEDE;padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st3.1.6.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;background-color:#DEDEDE;">60.84</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st3.9.2.1" class="ltx_text" style="font-size:129%;">(c)</span> </span><span id="S4.T1.st3.3.1" class="ltx_text ltx_font_bold" style="font-size:129%;">Answer candidates.<span id="S4.T1.st3.3.1.1" class="ltx_text ltx_font_medium"> They are crucial to Prophet and increasing <math id="S4.T1.st3.3.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T1.st3.3.1.1.m1.1b"><mi id="S4.T1.st3.3.1.1.m1.1.1" xref="S4.T1.st3.3.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st3.3.1.1.m1.1c"><ci id="S4.T1.st3.3.1.1.m1.1.1.cmml" xref="S4.T1.st3.3.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st3.3.1.1.m1.1d">K</annotation></semantics></math> leads to better performance.</span></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st4" class="ltx_table ltx_figure_panel">
<table id="S4.T1.st4.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st4.2.1" class="ltx_tr">
<td id="S4.T1.st4.2.1.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.1.1.1" class="ltx_text" style="font-size:70%;">example selection</span></td>
<td id="S4.T1.st4.2.1.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.1.2.1" class="ltx_text" style="font-size:70%;">   hit rate</span></td>
<td id="S4.T1.st4.2.1.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.1.3.1" class="ltx_text" style="font-size:70%;">accuracy</span></td>
</tr>
<tr id="S4.T1.st4.2.2" class="ltx_tr">
<td id="S4.T1.st4.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T1.st4.2.3" class="ltx_tr">
<td id="S4.T1.st4.2.3.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.3.1.1" class="ltx_text" style="font-size:70%;">(a) rand</span></td>
<td id="S4.T1.st4.2.3.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.3.2.1" class="ltx_text" style="font-size:70%;">5.31</span></td>
<td id="S4.T1.st4.2.3.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.3.3.1" class="ltx_text" style="font-size:70%;">58.66</span></td>
</tr>
<tr id="S4.T1.st4.2.4" class="ltx_tr">
<td id="S4.T1.st4.2.4.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st4.2.4.1.1" class="ltx_text" style="font-size:70%;">(b) ques + img </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.st4.2.4.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib15" title="" class="ltx_ref">15</a><span id="S4.T1.st4.2.4.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S4.T1.st4.2.4.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.4.2.1" class="ltx_text" style="font-size:70%;">59.58</span></td>
<td id="S4.T1.st4.2.4.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.4.3.1" class="ltx_text" style="font-size:70%;">59.82</span></td>
</tr>
<tr id="S4.T1.st4.2.5" class="ltx_tr">
<td id="S4.T1.st4.2.5.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.5.1.1" class="ltx_text" style="font-size:70%;">(c) fused</span></td>
<td id="S4.T1.st4.2.5.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.5.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">83.63</span></td>
<td id="S4.T1.st4.2.5.3" class="ltx_td ltx_align_center" style="background-color:#DEDEDE;padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.5.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;background-color:#DEDEDE;">60.84</span></td>
</tr>
<tr id="S4.T1.st4.2.6" class="ltx_tr">
<td id="S4.T1.st4.2.6.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.6.1.1" class="ltx_text" style="font-size:70%;">(d) fused + ques + img</span></td>
<td id="S4.T1.st4.2.6.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.6.2.1" class="ltx_text" style="font-size:70%;">82.45</span></td>
<td id="S4.T1.st4.2.6.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.6.3.1" class="ltx_text" style="font-size:70%;">60.38</span></td>
</tr>
<tr id="S4.T1.st4.2.7" class="ltx_tr">
<td id="S4.T1.st4.2.7.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.7.1.1" class="ltx_text" style="font-size:70%;">(e) answer logits</span></td>
<td id="S4.T1.st4.2.7.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.7.2.1" class="ltx_text" style="font-size:70%;">79.25</span></td>
<td id="S4.T1.st4.2.7.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st4.2.7.3.1" class="ltx_text" style="font-size:70%;">60.40</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st4.6.1.1" class="ltx_text" style="font-size:129%;">(d)</span> </span><span id="S4.T1.st4.7.2" class="ltx_text ltx_font_bold" style="font-size:129%;">Example selection strategy.<span id="S4.T1.st4.7.2.1" class="ltx_text ltx_font_medium"> Our answer-aware example selection based on fused features is more effective than the others.</span></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st5" class="ltx_table ltx_figure_panel">
<table id="S4.T1.st5.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st5.3.3" class="ltx_tr">
<td id="S4.T1.st5.1.1.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st5.1.1.1.1" class="ltx_text" style="font-size:70%;">#examples (</span><math id="S4.T1.st5.1.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T1.st5.1.1.1.m1.1a"><mi mathsize="70%" id="S4.T1.st5.1.1.1.m1.1.1" xref="S4.T1.st5.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st5.1.1.1.m1.1b"><ci id="S4.T1.st5.1.1.1.m1.1.1.cmml" xref="S4.T1.st5.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st5.1.1.1.m1.1c">N</annotation></semantics></math><span id="S4.T1.st5.1.1.1.2" class="ltx_text" style="font-size:70%;">)</span>
</td>
<td id="S4.T1.st5.2.2.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st5.2.2.2.1" class="ltx_text" style="font-size:70%;">accuracy (</span><math id="S4.T1.st5.2.2.2.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T1.st5.2.2.2.m1.1a"><mi mathsize="70%" id="S4.T1.st5.2.2.2.m1.1.1" xref="S4.T1.st5.2.2.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st5.2.2.2.m1.1b"><ci id="S4.T1.st5.2.2.2.m1.1.1.cmml" xref="S4.T1.st5.2.2.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st5.2.2.2.m1.1c">T</annotation></semantics></math><span id="S4.T1.st5.2.2.2.2" class="ltx_text" style="font-size:70%;">=1)</span>
</td>
<td id="S4.T1.st5.3.3.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st5.3.3.3.1" class="ltx_text" style="font-size:70%;">accuracy (</span><math id="S4.T1.st5.3.3.3.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T1.st5.3.3.3.m1.1a"><mi mathsize="70%" id="S4.T1.st5.3.3.3.m1.1.1" xref="S4.T1.st5.3.3.3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st5.3.3.3.m1.1b"><ci id="S4.T1.st5.3.3.3.m1.1.1.cmml" xref="S4.T1.st5.3.3.3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st5.3.3.3.m1.1c">T</annotation></semantics></math><span id="S4.T1.st5.3.3.3.2" class="ltx_text" style="font-size:70%;">=5)</span>
</td>
</tr>
<tr id="S4.T1.st5.3.4" class="ltx_tr">
<td id="S4.T1.st5.3.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T1.st5.3.5" class="ltx_tr">
<td id="S4.T1.st5.3.5.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.5.1.1" class="ltx_text" style="font-size:70%;">0</span></td>
<td id="S4.T1.st5.3.5.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.5.2.1" class="ltx_text" style="font-size:70%;">49.97</span></td>
<td id="S4.T1.st5.3.5.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.5.3.1" class="ltx_text" style="font-size:70%;">49.97</span></td>
</tr>
<tr id="S4.T1.st5.3.6" class="ltx_tr">
<td id="S4.T1.st5.3.6.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.6.1.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="S4.T1.st5.3.6.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.6.2.1" class="ltx_text" style="font-size:70%;">54.89</span></td>
<td id="S4.T1.st5.3.6.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.6.3.1" class="ltx_text" style="font-size:70%;">56.75</span></td>
</tr>
<tr id="S4.T1.st5.3.7" class="ltx_tr">
<td id="S4.T1.st5.3.7.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.7.1.1" class="ltx_text" style="font-size:70%;">8</span></td>
<td id="S4.T1.st5.3.7.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.7.2.1" class="ltx_text" style="font-size:70%;">57.49</span></td>
<td id="S4.T1.st5.3.7.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.7.3.1" class="ltx_text" style="font-size:70%;">59.91</span></td>
</tr>
<tr id="S4.T1.st5.3.8" class="ltx_tr">
<td id="S4.T1.st5.3.8.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.8.1.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="S4.T1.st5.3.8.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.8.2.1" class="ltx_text" style="font-size:70%;">57.52</span></td>
<td id="S4.T1.st5.3.8.3" class="ltx_td ltx_align_center" style="background-color:#DEDEDE;padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.8.3.1" class="ltx_text" style="font-size:70%;background-color:#DEDEDE;">60.84</span></td>
</tr>
<tr id="S4.T1.st5.3.9" class="ltx_tr">
<td id="S4.T1.st5.3.9.1" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.9.1.1" class="ltx_text" style="font-size:70%;">20</span></td>
<td id="S4.T1.st5.3.9.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.9.2.1" class="ltx_text" style="font-size:70%;">57.91</span></td>
<td id="S4.T1.st5.3.9.3" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st5.3.9.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">61.10</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st5.14.3.1" class="ltx_text" style="font-size:129%;">(e)</span> </span><span id="S4.T1.st5.7.2" class="ltx_text ltx_font_bold" style="font-size:129%;">Numbers of examples and queries.<span id="S4.T1.st5.7.2.2" class="ltx_text ltx_font_medium"> Increasing <math id="S4.T1.st5.6.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T1.st5.6.1.1.m1.1b"><mi id="S4.T1.st5.6.1.1.m1.1.1" xref="S4.T1.st5.6.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st5.6.1.1.m1.1c"><ci id="S4.T1.st5.6.1.1.m1.1.1.cmml" xref="S4.T1.st5.6.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st5.6.1.1.m1.1d">N</annotation></semantics></math> and <math id="S4.T1.st5.7.2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T1.st5.7.2.2.m2.1b"><mi id="S4.T1.st5.7.2.2.m2.1.1" xref="S4.T1.st5.7.2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T1.st5.7.2.2.m2.1c"><ci id="S4.T1.st5.7.2.2.m2.1.1.cmml" xref="S4.T1.st5.7.2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.st5.7.2.2.m2.1d">T</annotation></semantics></math> improves model performance at the expense of linearly increasing overheads.</span></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.T1.st6" class="ltx_table ltx_figure_panel">
<table id="S4.T1.st6.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.st6.2.1" class="ltx_tr">
<td id="S4.T1.st6.2.1.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.1.1.1" class="ltx_text" style="font-size:70%;">variants</span></td>
<td id="S4.T1.st6.2.1.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.1.2.1" class="ltx_text" style="font-size:70%;">accuracy</span></td>
</tr>
<tr id="S4.T1.st6.2.2" class="ltx_tr">
<td id="S4.T1.st6.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T1.st6.2.3" class="ltx_tr">
<td id="S4.T1.st6.2.3.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.3.1.1" class="ltx_text" style="font-size:70%;">(a) default</span></td>
<td id="S4.T1.st6.2.3.2" class="ltx_td ltx_align_center" style="background-color:#DEDEDE;padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.3.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;background-color:#DEDEDE;">60.84</span></td>
</tr>
<tr id="S4.T1.st6.2.4" class="ltx_tr">
<td id="S4.T1.st6.2.4.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.4.1.1" class="ltx_text" style="font-size:70%;">(b) w/o prompt head</span></td>
<td id="S4.T1.st6.2.4.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.4.2.1" class="ltx_text" style="font-size:70%;">60.54</span></td>
</tr>
<tr id="S4.T1.st6.2.5" class="ltx_tr">
<td id="S4.T1.st6.2.5.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.5.1.1" class="ltx_text" style="font-size:70%;">(c) w/o confidence scores</span></td>
<td id="S4.T1.st6.2.5.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.5.2.1" class="ltx_text" style="font-size:70%;">55.46</span></td>
</tr>
<tr id="S4.T1.st6.2.6" class="ltx_tr">
<td id="S4.T1.st6.2.6.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.6.1.1" class="ltx_text" style="font-size:70%;">(d) w/o image captions</span></td>
<td id="S4.T1.st6.2.6.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.6.2.1" class="ltx_text" style="font-size:70%;">58.27</span></td>
</tr>
<tr id="S4.T1.st6.2.7" class="ltx_tr">
<td id="S4.T1.st6.2.7.1" class="ltx_td ltx_align_left" style="padding-top:0.7pt;padding-bottom:0.7pt;">
<span id="S4.T1.st6.2.7.1.1" class="ltx_text" style="font-size:70%;">(e) default+tags </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.st6.2.7.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib15" title="" class="ltx_ref">15</a><span id="S4.T1.st6.2.7.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S4.T1.st6.2.7.2" class="ltx_td ltx_align_center" style="padding-top:0.7pt;padding-bottom:0.7pt;"><span id="S4.T1.st6.2.7.2.1" class="ltx_text" style="font-size:70%;">60.51</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.st6.6.1.1" class="ltx_text" style="font-size:129%;">(f)</span> </span><span id="S4.T1.st6.7.2" class="ltx_text ltx_font_bold" style="font-size:129%;">Prompt contents.<span id="S4.T1.st6.7.2.1" class="ltx_text ltx_font_medium"> The default settings contain the exact necessary information for prompting.</span></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.7.1.1" class="ltx_text" style="font-size:129%;">TABLE I</span>: </span><span id="S4.T1.8.2" class="ltx_text ltx_font_bold" style="font-size:129%;">Ablation experiments for Prophet<span id="S4.T1.8.2.1" class="ltx_text ltx_font_medium">. All the reported results are evaluated on the testing set of OK-VQA v1.1. The best result in each table is bolded and the result with the default settings is marked in <span id="S4.T1.8.2.1.1" class="ltx_text" style="background-color:#DEDEDE;">gray</span>.</span></span></figcaption>
</figure>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.1" class="ltx_p"><span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_bold">Settings on other datasets.</span>
The settings and strategies for OK-VQA can be directly transferred to A-OKVQA to address its DA task. For the MC task, we follow the strategy in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> to project the predicted answer to the nearest answer choice. Moreover, we design a Prophet variant for the MC task. It uses a slightly different prompt by adding the multiple choices to in-context examples and testing input, and instructs the LLM to <em id="S4.SS2.p4.1.2" class="ltx_emph ltx_font_italic">choose</em> the correct one from four choices.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p">For ScienceQA, we reuse all the default settings for OK-VQA. If a training sample provides extra textual hint, we simply append the text to the generated caption as the new context of the corresponding image. For TextVQA, we use the commercial system from Amazon to extract OCR from images <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://aws.amazon.com/textract/</span></span></span></span>, whose effectiveness has been verified in previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>. The extracted OCR texts are provided in both the in-context examples and testing input to instruct the LLM.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para ltx_noindent">
<p id="S4.SS2.p6.1" class="ltx_p"><span id="S4.SS2.p6.1.1" class="ltx_text ltx_font_bold">Settings of other VQA models.</span> In addition to MCAN, we also experiment with one generative VQA model mPLUG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, which is first pretrained on task-agnostic image-text corpus and then finetuned on specific VQA dataset. Following the aforementioned two-stage transfer learning paradigm for MCAN, the pretrained mPLUG model is first finetuned on the VQAv2 dataset and then further finetuned on specific knowledge-based VQA dataset.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span id="S4.SS3.1.1" class="ltx_text ltx_font_italic">Ablation Studies</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We conduct ablation experiments for Prophet on OK-VQA using the default settings above. Results shown in Table <a href="#S4.T1" title="TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> are discussed in detail below.


<br class="ltx_break"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_bold">Prompting <em id="S4.SS3.p1.1.1.1" class="ltx_emph ltx_font_italic">vs</em>. retrieval.</span> Prophet uses a prompting-based paradigm to predict the answer based on a set of promising answer candidates. In contrast, a previous work MAVEx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> exploits answer candidates but adopts a retrieval-based paradigm to search knowledge from external KBs to determine the answer. As both Prophet and MAVEx train a VQA model to generate answer candidates (stage-1), we can compare the superiority of the two paradigms (stage-2). In Table <a href="#S4.T1.st1" title="In TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I(a)</span></a>, we show the performance of the two paradigms in terms of stage-1 accuracy and final accuracy, respectively.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">For a fair comparison, we re-implement the VQA model used in MAVEx, <em id="S4.SS3.p2.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, ViLBERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, to generate answer heuristics for our Prophet. From the results, we can see that based on the same VQA model, our Prophet outperforms MAVEx by a large margin (44.97% <em id="S4.SS3.p2.1.2" class="ltx_emph ltx_font_italic">vs</em>. 40.28%), showing the superiority of our prompting-based paradigm over MAVEx’s retrieval-based paradigm in external knowledge acquisition and integration.


<br class="ltx_break"><span id="S4.SS3.p2.1.3" class="ltx_text ltx_font_bold">Capability of VQA models.</span> In Table <a href="#S4.T1.st2" title="In TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I(b)</span></a>, we study how the VQA models of different capabilities impact the performance of Prophet. To better control the model capability, we use the same MCAN model trained with four visual features: region-based Bottom-Up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and VinVL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> features and grid-based CLIP features from two backbones (ViT-L/14 and RN50<math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mo id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><times id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\times</annotation></semantics></math>64) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>. Results show that more powerful VQA models (reflected in the stage-1 accuracies) lead to better performance of Prophet, as they provide answer heuristics of higher quality. Combining the results in Table <a href="#S4.T1.st1" title="In TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I(a)</span></a>, we also observe that more powerful VQA models achieve less relative improvements from <span id="S4.SS3.p2.1.4" class="ltx_text">GPT-3</span>, which can be explained by the intrinsic diminishing return property. As a by-product, we verify that the visual features are important to the performance of knowledge-based VQA, which is consistent with the observations in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. The models with CLIP-based visual features significantly outperform those with region-based features, indicating that the CLIP’s visual features contain richer visual knowledge due to large-scale pretraining.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.3" class="ltx_p">In addition to using different visual features for MCAN, we can also replace the whole MCAN model with any generative models pretrained on large-scale multimodal datasets as mentioned in <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="\S" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi mathvariant="normal" id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\S</annotation></semantics></math><a href="#S3.SS1" title="3.1 Preliminaries ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>. These results will be reported in the main results.


<br class="ltx_break"><span id="S4.SS3.p3.3.1" class="ltx_text ltx_font_bold">Answer candidates.</span> Table <a href="#S4.T1.st3" title="In TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I(c)</span></a> varies the number of answer candidates <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">K</annotation></semantics></math> from 0 to 10 to explore its effect on Prophet. For each testing sample, if the ground-truth answer is hit by one of the <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mi id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">K</annotation></semantics></math> answer candidates, we accumulate the soft score of that ground-truth answer<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>In practice, multiple ground-truth answers are provided. If multiple answers are hit simultaneously, we choose the answer with the largest soft score for accumulation.</span></span></span>. The hit rate is calculated over the testing set by dividing the accumulated score by the number of samples.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.4" class="ltx_p">From the results, we can see that: (i) without any answer candidates, Prophet’s accuracy drops by 6.4 points (<math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><mi id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><ci id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">K</annotation></semantics></math>=0 <em id="S4.SS3.p4.4.1" class="ltx_emph ltx_font_italic">vs</em>. <math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><mi id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">K</annotation></semantics></math>=1), showing the importance of answer candidates in Prophet; (ii) with the increase of answer candidates, the hit rate and final accuracy grow accordingly but they exhibit a tendency to saturate. This is because the quality of answer candidates eventually meets saturation as <math id="S4.SS3.p4.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p4.3.m3.1a"><mi id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><ci id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">K</annotation></semantics></math> increases; (iii) when <math id="S4.SS3.p4.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p4.4.m4.1a"><mi id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><ci id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">K</annotation></semantics></math>=1, the final accuracy is even higher than the hit rate (56.04% <em id="S4.SS3.p4.4.2" class="ltx_emph ltx_font_italic">vs</em>. 53.04%), which implies that GPT-3 has a strong capability to correct the wrong answer candidates while keeping the correct ones.


<br class="ltx_break"><span id="S4.SS3.p4.4.3" class="ltx_text ltx_font_bold">Example selection strategy.</span> To show the effectiveness of our answer-aware example selection strategy, we compare it to other example selection strategies in Table <a href="#S4.T1.st4" title="In TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I(d)</span></a>. The compared strategies include: (a) <em id="S4.SS3.p4.4.4" class="ltx_emph ltx_font_italic">rand</em>: examples that are randomly selected; (b) <em id="S4.SS3.p4.4.5" class="ltx_emph ltx_font_italic">ques + img</em>: examples that are selected based on the joint similarity of question and image features, which is used in PICa; (c) <em id="S4.SS3.p4.4.6" class="ltx_emph ltx_font_italic">fused</em>: our default strategy that selects examples based on the similarity of fused features; (d) <em id="S4.SS3.p4.4.7" class="ltx_emph ltx_font_italic">fused + ques + img</em>: a combination of our default strategy and PICa’s strategy; and (e) <em id="S4.SS3.p4.4.8" class="ltx_emph ltx_font_italic">answer logits</em>: examples that are selected based on the similarity of answer logits obtained in Eq.(<a href="#S3.E3" title="In 3.2.1 Discriminative VQA models ‣ 3.2 Stage-1: Answer Heuristics Generation ‣ 3 The Prophet Framework ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Besides the final accuracy, we also report the hit rate of answers within the selected examples for each strategy.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.6" class="ltx_p">The results show that the accuracy is positively correlated with the hit rate of answers, which verifies our hypothesis that answer-aware examples contribute significantly to the performance of Prophet. Compared with other strategies, our default strategy (c) achieves the best performance with the highest hit rate. The strategy (d) that integrates other information (ques + img) into the (c) leads to worse performance due to the introduction of irrelevant and noisy information. Finally, strategy (e) reports slightly worse performance than (c). We conjecture that this is because the answer logits have lost too much information of the input question and image, which is also useful for GPT-3 to perform knowledge reasoning.


<br class="ltx_break"><span id="S4.SS3.p5.6.1" class="ltx_text ltx_font_bold">Numbers of examples and queries.</span> Table <a href="#S4.T1.st4" title="In TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I(d)</span></a> contains the ablation studies for the numbers of examples and queries. We choose different numbers of examples <math id="S4.SS3.p5.1.m1.5" class="ltx_Math" alttext="N\in\{0,1,8,16,20\}" display="inline"><semantics id="S4.SS3.p5.1.m1.5a"><mrow id="S4.SS3.p5.1.m1.5.6" xref="S4.SS3.p5.1.m1.5.6.cmml"><mi id="S4.SS3.p5.1.m1.5.6.2" xref="S4.SS3.p5.1.m1.5.6.2.cmml">N</mi><mo id="S4.SS3.p5.1.m1.5.6.1" xref="S4.SS3.p5.1.m1.5.6.1.cmml">∈</mo><mrow id="S4.SS3.p5.1.m1.5.6.3.2" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS3.p5.1.m1.5.6.3.2.1" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">{</mo><mn id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml">0</mn><mo id="S4.SS3.p5.1.m1.5.6.3.2.2" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.2.2" xref="S4.SS3.p5.1.m1.2.2.cmml">1</mn><mo id="S4.SS3.p5.1.m1.5.6.3.2.3" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.3.3" xref="S4.SS3.p5.1.m1.3.3.cmml">8</mn><mo id="S4.SS3.p5.1.m1.5.6.3.2.4" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.4.4" xref="S4.SS3.p5.1.m1.4.4.cmml">16</mn><mo id="S4.SS3.p5.1.m1.5.6.3.2.5" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.5.5" xref="S4.SS3.p5.1.m1.5.5.cmml">20</mn><mo stretchy="false" id="S4.SS3.p5.1.m1.5.6.3.2.6" xref="S4.SS3.p5.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.5b"><apply id="S4.SS3.p5.1.m1.5.6.cmml" xref="S4.SS3.p5.1.m1.5.6"><in id="S4.SS3.p5.1.m1.5.6.1.cmml" xref="S4.SS3.p5.1.m1.5.6.1"></in><ci id="S4.SS3.p5.1.m1.5.6.2.cmml" xref="S4.SS3.p5.1.m1.5.6.2">𝑁</ci><set id="S4.SS3.p5.1.m1.5.6.3.1.cmml" xref="S4.SS3.p5.1.m1.5.6.3.2"><cn type="integer" id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">0</cn><cn type="integer" id="S4.SS3.p5.1.m1.2.2.cmml" xref="S4.SS3.p5.1.m1.2.2">1</cn><cn type="integer" id="S4.SS3.p5.1.m1.3.3.cmml" xref="S4.SS3.p5.1.m1.3.3">8</cn><cn type="integer" id="S4.SS3.p5.1.m1.4.4.cmml" xref="S4.SS3.p5.1.m1.4.4">16</cn><cn type="integer" id="S4.SS3.p5.1.m1.5.5.cmml" xref="S4.SS3.p5.1.m1.5.5">20</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.5c">N\in\{0,1,8,16,20\}</annotation></semantics></math> for each query and different numbers of queries <math id="S4.SS3.p5.2.m2.2" class="ltx_Math" alttext="T\in\{1,5\}" display="inline"><semantics id="S4.SS3.p5.2.m2.2a"><mrow id="S4.SS3.p5.2.m2.2.3" xref="S4.SS3.p5.2.m2.2.3.cmml"><mi id="S4.SS3.p5.2.m2.2.3.2" xref="S4.SS3.p5.2.m2.2.3.2.cmml">T</mi><mo id="S4.SS3.p5.2.m2.2.3.1" xref="S4.SS3.p5.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.SS3.p5.2.m2.2.3.3.2" xref="S4.SS3.p5.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p5.2.m2.2.3.3.2.1" xref="S4.SS3.p5.2.m2.2.3.3.1.cmml">{</mo><mn id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml">1</mn><mo id="S4.SS3.p5.2.m2.2.3.3.2.2" xref="S4.SS3.p5.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p5.2.m2.2.2" xref="S4.SS3.p5.2.m2.2.2.cmml">5</mn><mo stretchy="false" id="S4.SS3.p5.2.m2.2.3.3.2.3" xref="S4.SS3.p5.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.2b"><apply id="S4.SS3.p5.2.m2.2.3.cmml" xref="S4.SS3.p5.2.m2.2.3"><in id="S4.SS3.p5.2.m2.2.3.1.cmml" xref="S4.SS3.p5.2.m2.2.3.1"></in><ci id="S4.SS3.p5.2.m2.2.3.2.cmml" xref="S4.SS3.p5.2.m2.2.3.2">𝑇</ci><set id="S4.SS3.p5.2.m2.2.3.3.1.cmml" xref="S4.SS3.p5.2.m2.2.3.3.2"><cn type="integer" id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">1</cn><cn type="integer" id="S4.SS3.p5.2.m2.2.2.cmml" xref="S4.SS3.p5.2.m2.2.2">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.2c">T\in\{1,5\}</annotation></semantics></math>, respectively. The results show that the performance of Prophet improves with the increase of <math id="S4.SS3.p5.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p5.3.m3.1a"><mi id="S4.SS3.p5.3.m3.1.1" xref="S4.SS3.p5.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m3.1b"><ci id="S4.SS3.p5.3.m3.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m3.1c">N</annotation></semantics></math> and <math id="S4.SS3.p5.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS3.p5.4.m4.1a"><mi id="S4.SS3.p5.4.m4.1.1" xref="S4.SS3.p5.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.4.m4.1b"><ci id="S4.SS3.p5.4.m4.1.1.cmml" xref="S4.SS3.p5.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.4.m4.1c">T</annotation></semantics></math>, which is consistent with the results in PICa. By increasing <math id="S4.SS3.p5.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS3.p5.5.m5.1a"><mi id="S4.SS3.p5.5.m5.1.1" xref="S4.SS3.p5.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.5.m5.1b"><ci id="S4.SS3.p5.5.m5.1.1.cmml" xref="S4.SS3.p5.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.5.m5.1c">T</annotation></semantics></math> from 1 to 5, the entries with larger <math id="S4.SS3.p5.6.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p5.6.m6.1a"><mi id="S4.SS3.p5.6.m6.1.1" xref="S4.SS3.p5.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.6.m6.1b"><ci id="S4.SS3.p5.6.m6.1.1.cmml" xref="S4.SS3.p5.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.6.m6.1c">N</annotation></semantics></math> enjoy greater performance improvements at the expense of linearly increasing overheads.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.2" class="ltx_p">Interestingly, the Prophet variant with <math id="S4.SS3.p6.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p6.1.m1.1a"><mi id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><ci id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">N</annotation></semantics></math>=0 delivers worse performance than the VQA model in stage-1 (49.97% <em id="S4.SS3.p6.2.1" class="ltx_emph ltx_font_italic">vs</em>. 53.04%), even though answer candidates are provided. Meanwhile, when given one example (<math id="S4.SS3.p6.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p6.2.m2.1a"><mi id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.1b"><ci id="S4.SS3.p6.2.m2.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.1c">N</annotation></semantics></math>=1), the Prophet variant distinctly surpasses the VQA model (56.75% <em id="S4.SS3.p6.2.2" class="ltx_emph ltx_font_italic">vs</em>. 53.04%). This suggests the necessity of few-shot in-context examples for GPT-3 to activate its capability to adapt to the knowledge-based VQA task.


<br class="ltx_break"><span id="S4.SS3.p6.2.3" class="ltx_text ltx_font_bold">Prompt contents.</span> In Table <a href="#S4.T1.st6" title="In TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I(f)</span></a>, we ablate the <span id="S4.SS3.p6.2.4" class="ltx_text">prompt</span> contents in the default settings by: (b) removing the <span id="S4.SS3.p6.2.5" class="ltx_text">prompt</span> head; (c) removing the confidence scores for answer candidates; (d) removing image captions; and (e) adding predicted tags from external models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
</div>
<div id="S4.SS3.p7" class="ltx_para">
<p id="S4.SS3.p7.1" class="ltx_p">The results lead to the following observations: First, the confidence scores are of critical importance to the performance of our Prophet. This is because they carry the necessary information for GPT-3 to understand the answer candidates. Second, without image captions, Prophet still works steadily. This reflects the fact that our answer heuristics in prompts already provide sufficient information for Prophet to solve the task. Third, the prompt head is of less importance, indicating that GPT-3 is capable of understanding the task directly from the in-context examples. Finally, introducing extra information like object tags leads to a slight performance drop, which is contrary to the results in PICa. We conjecture this information has already been encoded in answer heuristics implicitly.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.01903/assets/x3.png" id="S4.F4.sf1.g1" class="ltx_graphics ltx_img_square" width="461" height="458" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">behavior distribution</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.01903/assets/x4.png" id="S4.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="340" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">per-type accuracy</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.9.4.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.6.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Prophet’s prediction behaviors<span id="S4.F4.6.3.3" class="ltx_text ltx_font_medium"> in terms of (a) distribution and (b) per-type accuracy. As Prophet takes <math id="S4.F4.4.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.F4.4.1.1.m1.1b"><mi id="S4.F4.4.1.1.m1.1.1" xref="S4.F4.4.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F4.4.1.1.m1.1c"><ci id="S4.F4.4.1.1.m1.1.1.cmml" xref="S4.F4.4.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.1.1.m1.1d">K</annotation></semantics></math> answer candidates as inputs, we define three prediction behaviors for Prophet as follows: “keep top-1”, “in top 2-<math id="S4.F4.5.2.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.F4.5.2.2.m2.1b"><mi id="S4.F4.5.2.2.m2.1.1" xref="S4.F4.5.2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F4.5.2.2.m2.1c"><ci id="S4.F4.5.2.2.m2.1.1.cmml" xref="S4.F4.5.2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.5.2.2.m2.1d">K</annotation></semantics></math>”, and “beyond top <math id="S4.F4.6.3.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.F4.6.3.3.m3.1b"><mi id="S4.F4.6.3.3.m3.1.1" xref="S4.F4.6.3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F4.6.3.3.m3.1c"><ci id="S4.F4.6.3.3.m3.1.1.cmml" xref="S4.F4.6.3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.6.3.3.m3.1d">K</annotation></semantics></math>”. All the testing samples can be categorized into one of the three classes. </span></span></figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1" class="ltx_td ltx_nopad ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><svg version="1.1" height="24.6" width="159.98" overflow="visible"><g transform="translate(0,24.6) scale(1,-1)"><path d="M 0,24.6 159.98,0" stroke="#000000" stroke-width="0.4"></path><g class="ltx_svg_fog" transform="translate(0,0)"><g transform="translate(0,12.3) scale(1, -1)"><foreignObject width="79.99" height="12.3" overflow="visible">
<span id="S4.T2.1.1.1.pic1.1.1" class="ltx_inline-block">
<span id="S4.T2.1.1.1.pic1.1.1.1" class="ltx_inline-block ltx_align_left">
<span id="S4.T2.1.1.1.pic1.1.1.1.1" class="ltx_p">Stage 1 pred.</span>
</span>
</span></foreignObject></g></g><g class="ltx_svg_fog" transform="translate(79.99,12.3)"><g transform="translate(0,12.3) scale(1, -1)"><foreignObject width="79.99" height="12.3" overflow="visible">
<span id="S4.T2.1.1.1.pic1.2.1" class="ltx_inline-block">
<span id="S4.T2.1.1.1.pic1.2.1.1" class="ltx_inline-block ltx_align_right">
<span id="S4.T2.1.1.1.pic1.2.1.1.1" class="ltx_p">Stage 2 pred.</span>
</span>
</span></foreignObject></g></g></g></svg></td>
<td id="S4.T2.1.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">    correct</td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">    wrong</td>
</tr>
<tr id="S4.T2.1.2" class="ltx_tr">
<td id="S4.T2.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T2.1.3" class="ltx_tr">
<td id="S4.T2.1.3.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">correct</td>
<td id="S4.T2.1.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">54.4%</td>
<td id="S4.T2.1.3.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">4.2%</td>
</tr>
<tr id="S4.T2.1.4" class="ltx_tr">
<td id="S4.T2.1.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">wrong</td>
<td id="S4.T2.1.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">12.0%</td>
<td id="S4.T2.1.4.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">29.4%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.6.1.1" class="ltx_text" style="font-size:90%;">TABLE II</span>: </span><span id="S4.T2.7.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Prophet’s combinatorial prediction behaviors<span id="S4.T2.7.2.1" class="ltx_text ltx_font_medium"> in two stages. Prophet maintains the majority of correct predictions at stage-1, and the accuracy improvement by stage-2 is mainly because the number of <em id="S4.T2.7.2.1.1" class="ltx_emph ltx_font_italic">wrong-to-correct</em> samples is larger than that of the <em id="S4.T2.7.2.1.2" class="ltx_emph ltx_font_italic">correct-to-wrong</em> samples.
</span></span></figcaption>
</figure>
<div id="S4.SS3.p8" class="ltx_para ltx_noindent">
<p id="S4.SS3.p8.4" class="ltx_p"><span id="S4.SS3.p8.4.1" class="ltx_text ltx_font_bold">Prediction behaviors in different stages.</span> In Table <a href="#S4.T1.st2" title="In TABLE I ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I(b)</span></a>, we can observe a significant performance improvement of Prophet (stage-2) over its corresponding MCAN model (stage-1).
To better understand this improvement, we conduct a statistical analysis of Prophet’s prediction behaviors. As Prophet takes <math id="S4.SS3.p8.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p8.1.m1.1a"><mi id="S4.SS3.p8.1.m1.1.1" xref="S4.SS3.p8.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.1.m1.1b"><ci id="S4.SS3.p8.1.m1.1.1.cmml" xref="S4.SS3.p8.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.1.m1.1c">K</annotation></semantics></math> answer candidates from MCAN as inputs, we define three prediction behaviors for Prophet: “keep top-1”, “in top 2-<math id="S4.SS3.p8.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p8.2.m2.1a"><mi id="S4.SS3.p8.2.m2.1.1" xref="S4.SS3.p8.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.2.m2.1b"><ci id="S4.SS3.p8.2.m2.1.1.cmml" xref="S4.SS3.p8.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.2.m2.1c">K</annotation></semantics></math>”, and “beyond top-<math id="S4.SS3.p8.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p8.3.m3.1a"><mi id="S4.SS3.p8.3.m3.1.1" xref="S4.SS3.p8.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.3.m3.1b"><ci id="S4.SS3.p8.3.m3.1.1.cmml" xref="S4.SS3.p8.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.3.m3.1c">K</annotation></semantics></math>”. All the testing samples can be categorized into one of the three classes. The statistical results in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> show that: (i) for 68.1% of the testing samples (green slice), Prophet keeps the top-1 predictions of MCAN. These samples achieve a 69% accuracy and are mostly easy samples; (ii) for 21.8% of the testing samples (blue slice), Prophet selects answers from the top 2-<math id="S4.SS3.p8.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p8.4.m4.1a"><mi id="S4.SS3.p8.4.m4.1.1" xref="S4.SS3.p8.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.4.m4.1b"><ci id="S4.SS3.p8.4.m4.1.1.cmml" xref="S4.SS3.p8.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.4.m4.1c">K</annotation></semantics></math> answer candidates. These samples are relatively hard, so that MCAN delivers a 24% accuracy while Prophet has a much higher 40% accuracy; (iii) for the remaining 10.1% of the testing samples (yellow slice), Prophet predicts answers beyond the answer candidates<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>The probability that Prophet’s prediction is constituted of the combination of candidates is rare that can be neglected.</span></span></span>. For these most difficult samples, MCAN only delivers a 12% accuracy while Prophet magnificently achieves a 42% accuracy.</p>
</div>
<div id="S4.SS3.p9" class="ltx_para">
<p id="S4.SS3.p9.1" class="ltx_p">As a supplement to the above results, we calculate the distribution of four situations of the predictions from stage-1 and stage-2 in Table <a href="#S4.T2" title="TABLE II ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. From the results, we can see that: (i) Prophet maintains the majority of correct predictions by MCAN and only 4.2% samples are overturned; (ii) the improvement of Prophet is mainly due to the fact that the proportion of <em id="S4.SS3.p9.1.1" class="ltx_emph ltx_font_italic">wrong-to-correct</em> samples (12.4%) is larger than that of the <em id="S4.SS3.p9.1.2" class="ltx_emph ltx_font_italic">correct-to-wrong</em> samples (4.2%); (iii) there are still a considerable amount of samples (29.4%) that both MCAN and Prophet fail to give the correct answer, which leaves sufficient room for future improvement.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T3.6.7" class="ltx_tr">
<td id="S4.T3.6.7.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LLM (version or size)</td>
<td id="S4.T3.6.7.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.6.7.2.1" class="ltx_text"></span> <span id="S4.T3.6.7.2.2" class="ltx_text">
<span id="S4.T3.6.7.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.6.7.2.2.1.1" class="ltx_tr">
<span id="S4.T3.6.7.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">per-sample</span></span>
<span id="S4.T3.6.7.2.2.1.2" class="ltx_tr">
<span id="S4.T3.6.7.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">average cost</span></span>
</span></span><span id="S4.T3.6.7.2.3" class="ltx_text"></span></td>
<td id="S4.T3.6.7.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">accuracy</td>
</tr>
<tr id="S4.T3.6.8" class="ltx_tr">
<td id="S4.T3.6.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T3.6.9" class="ltx_tr">
<td id="S4.T3.6.9.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T3.6.9.1.1" class="ltx_text ltx_font_italic">commercial models</span></td>
<td id="S4.T3.6.9.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T3.6.9.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="S4.T3.6.10" class="ltx_tr">
<td id="S4.T3.6.10.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">GPT-3 (text-davinci-002)</td>
<td id="S4.T3.6.10.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">$0.2</td>
<td id="S4.T3.6.10.3" class="ltx_td ltx_align_center" style="background-color:#DEDEDE;padding-top:1pt;padding-bottom:1pt;"><span id="S4.T3.6.10.3.1" class="ltx_text ltx_font_bold" style="background-color:#DEDEDE;">60.8</span></td>
</tr>
<tr id="S4.T3.6.11" class="ltx_tr">
<td id="S4.T3.6.11.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">GPT-3 (3.5-turbo-instruct)</td>
<td id="S4.T3.6.11.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">$0.015</td>
<td id="S4.T3.6.11.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">58.9</td>
</tr>
<tr id="S4.T3.6.12" class="ltx_tr">
<td id="S4.T3.6.12.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:0.5pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T3.6.13" class="ltx_tr">
<td id="S4.T3.6.13.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T3.6.13.1.1" class="ltx_text ltx_font_italic">open-source models</span></td>
<td id="S4.T3.6.13.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T3.6.13.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="S4.T3.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<sup id="S4.T3.1.1.1.1" class="ltx_sup"><span id="S4.T3.1.1.1.1.1" class="ltx_text ltx_font_italic">†</span></sup>LLaMA-1 (7B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
</td>
<td id="S4.T3.1.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">2.6s</td>
<td id="S4.T3.1.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">51.8</td>
</tr>
<tr id="S4.T3.2.2" class="ltx_tr">
<td id="S4.T3.2.2.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<sup id="S4.T3.2.2.1.1" class="ltx_sup"><span id="S4.T3.2.2.1.1.1" class="ltx_text ltx_font_italic">†</span></sup>LLaMA-1 (13B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
</td>
<td id="S4.T3.2.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">4.6s</td>
<td id="S4.T3.2.2.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.1</td>
</tr>
<tr id="S4.T3.3.3" class="ltx_tr">
<td id="S4.T3.3.3.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<sup id="S4.T3.3.3.1.1" class="ltx_sup"><span id="S4.T3.3.3.1.1.1" class="ltx_text ltx_font_italic">†</span></sup>LLaMA-1 (30B)</td>
<td id="S4.T3.3.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">8.7s</td>
<td id="S4.T3.3.3.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">57.1</td>
</tr>
<tr id="S4.T3.4.4" class="ltx_tr">
<td id="S4.T3.4.4.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<sup id="S4.T3.4.4.1.1" class="ltx_sup"><span id="S4.T3.4.4.1.1.1" class="ltx_text ltx_font_italic">†</span></sup>LLaMA-1 (65B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
</td>
<td id="S4.T3.4.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">16.6s</td>
<td id="S4.T3.4.4.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">58.8</td>
</tr>
<tr id="S4.T3.5.5" class="ltx_tr">
<td id="S4.T3.5.5.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<sup id="S4.T3.5.5.1.1" class="ltx_sup"><span id="S4.T3.5.5.1.1.1" class="ltx_text ltx_font_italic">†</span></sup>Falcon (7B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</td>
<td id="S4.T3.5.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">2.7s</td>
<td id="S4.T3.5.5.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50.5</td>
</tr>
<tr id="S4.T3.6.6" class="ltx_tr">
<td id="S4.T3.6.6.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<sup id="S4.T3.6.6.1.1" class="ltx_sup"><span id="S4.T3.6.6.1.1.1" class="ltx_text ltx_font_italic">†</span></sup>Falcon (40B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</td>
<td id="S4.T3.6.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">14.1s</td>
<td id="S4.T3.6.6.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">57.1</td>
</tr>
<tr id="S4.T3.6.14" class="ltx_tr">
<td id="S4.T3.6.14.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LLaMA-2 (7B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>
</td>
<td id="S4.T3.6.14.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">2.7s</td>
<td id="S4.T3.6.14.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.6</td>
</tr>
<tr id="S4.T3.6.15" class="ltx_tr">
<td id="S4.T3.6.15.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LLaMA-2-Chat (7B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>
</td>
<td id="S4.T3.6.15.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">2.7s</td>
<td id="S4.T3.6.15.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">54.0</td>
</tr>
<tr id="S4.T3.6.16" class="ltx_tr">
<td id="S4.T3.6.16.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LLaMA-2 (13B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>
</td>
<td id="S4.T3.6.16.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">4.8s</td>
<td id="S4.T3.6.16.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">57.9</td>
</tr>
<tr id="S4.T3.6.17" class="ltx_tr">
<td id="S4.T3.6.17.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LLaMA-2-Chat (13B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>
</td>
<td id="S4.T3.6.17.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">4.8</td>
<td id="S4.T3.6.17.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.5</td>
</tr>
<tr id="S4.T3.6.18" class="ltx_tr">
<td id="S4.T3.6.18.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LLaMA-2 (70B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>
</td>
<td id="S4.T3.6.18.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">18.3s</td>
<td id="S4.T3.6.18.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">59.6</td>
</tr>
<tr id="S4.T3.6.19" class="ltx_tr">
<td id="S4.T3.6.19.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Mistral (7B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>
</td>
<td id="S4.T3.6.19.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">3.0s</td>
<td id="S4.T3.6.19.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">59.7</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.16.4.1" class="ltx_text" style="font-size:90%;">TABLE III</span>: </span><span id="S4.T3.12.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Ablation study of different LLMs.<span id="S4.T3.12.3.3" class="ltx_text ltx_font_medium"> All variants use the default settings and are evaluated on the testing set of OK-VQA. The per-sample average costs of the open-source models are measured by the GPU running time on a server with A100 GPUs while the costs of the commercial models are measured by money. <sup id="S4.T3.12.3.3.1" class="ltx_sup"><span id="S4.T3.12.3.3.1.1" class="ltx_text ltx_font_italic">†</span></sup> indicates the LLM’s max token length is insufficient for <math id="S4.T3.11.2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T3.11.2.2.m2.1b"><mi id="S4.T3.11.2.2.m2.1.1" xref="S4.T3.11.2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T3.11.2.2.m2.1c"><ci id="S4.T3.11.2.2.m2.1.1.cmml" xref="S4.T3.11.2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.2.2.m2.1d">N</annotation></semantics></math>=16 examples. For these LLMs, we reduce <math id="S4.T3.12.3.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T3.12.3.3.m3.1b"><mi id="S4.T3.12.3.3.m3.1.1" xref="S4.T3.12.3.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T3.12.3.3.m3.1c"><ci id="S4.T3.12.3.3.m3.1.1.cmml" xref="S4.T3.12.3.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.3.3.m3.1d">N</annotation></semantics></math> to fit their maximum capacity.</span></span></figcaption>
</figure>
<div id="S4.SS3.p10" class="ltx_para ltx_noindent">
<p id="S4.SS3.p10.1" class="ltx_p"><span id="S4.SS3.p10.1.1" class="ltx_text ltx_font_bold">Different LLMs.</span> In Table <a href="#S4.T3" title="TABLE III ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, we investigate the effects of different LLMs by replacing the default GPT-3 (text-davinci-002) with the latest commercial and open-source models. From the results, we have the following observations: (i) the capability of the default GPT-3 model significantly outperforms all the compared LLMs, including its accelerated variant (3.5-turbo-instruct) with 0.075<math id="S4.SS3.p10.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS3.p10.1.m1.1a"><mo id="S4.SS3.p10.1.m1.1.1" xref="S4.SS3.p10.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p10.1.m1.1b"><times id="S4.SS3.p10.1.m1.1.1.cmml" xref="S4.SS3.p10.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p10.1.m1.1c">\times</annotation></semantics></math> running cost; (ii) for the LLMs of the same class but different sizes (<em id="S4.SS3.p10.1.2" class="ltx_emph ltx_font_italic">e.g.</em>, 7B and 13B LLaMA-1 models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>), the large-size ones show better performance than the small-size ones at the expense of near-linearly increasing running time; (iii) the chat-oriented variants like LLaMA-2-Chat <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>, which are additionally trained by instruction tuning and human feedback <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, deliver inferior performance to their non-chatty counterparts. This can be explained by the introduced <em id="S4.SS3.p10.1.3" class="ltx_emph ltx_font_italic">alignment tax</em> when aligning the model with human behaviors; (iv) with only 7B model parameters, the latest LLM Mistral <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> reports near <span id="S4.SS3.p10.1.4" class="ltx_text">GPT-3</span> level performance, revealing the potential of open-source LLMs in the near future.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span><span id="S4.SS4.1.1" class="ltx_text ltx_font_italic">Main Results</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.4" class="ltx_p">For the comparisons below, we use all the default settings except the number of examples <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">N</annotation></semantics></math>. We set <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">N</annotation></semantics></math>=20 for OK-VQA and A-OKVQA and respectively set <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">N</annotation></semantics></math>=7 and <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mi id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><ci id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">N</annotation></semantics></math>=16 for ScienceQA and TextVQA as they need extra hint and OCR tokens. By instantiating Prophet with two VQA models, we obtain Prophet (MCAN) and Prophet (mPLUG).


<br class="ltx_break"><span id="S4.SS4.p1.4.1" class="ltx_text ltx_font_bold">Comparative results on OK-VQA.</span> Table <a href="#S4.T4" title="TABLE IV ‣ 4.4 Main Results ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> contains the comparisons of our Prophet and existing state-of-the-art methods on OK-VQA. The table is split into three sections. The first section lists the retrieval-based methods leveraging external KBs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. The
second section contains the methods that are directly pretrained on a large-scale multimodal corpus <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>. The last section shows the methods that incorporate the large language model GPT-3, which is publicly available via an online API <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T4.5.6" class="ltx_tr">
<td id="S4.T4.5.6.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">method</td>
<td id="S4.T4.5.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">accuracy</td>
</tr>
<tr id="S4.T4.5.7" class="ltx_tr">
<td id="S4.T4.5.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T4.5.8" class="ltx_tr">
<td id="S4.T4.5.8.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.5.8.1.1" class="ltx_text ltx_font_italic">methods with external knowledge bases</span></td>
<td id="S4.T4.5.8.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="S4.T4.1.1" class="ltx_tr">
<td id="S4.T4.1.1.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Mucko <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.T4.1.1.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">29.2<sup id="S4.T4.1.1.1.1" class="ltx_sup">∗</sup>
</td>
</tr>
<tr id="S4.T4.2.2" class="ltx_tr">
<td id="S4.T4.2.2.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">ConceptBERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>
</td>
<td id="S4.T4.2.2.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">33.7<sup id="S4.T4.2.2.1.1" class="ltx_sup">∗</sup>
</td>
</tr>
<tr id="S4.T4.5.9" class="ltx_tr">
<td id="S4.T4.5.9.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">KRISP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</td>
<td id="S4.T4.5.9.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">38.9</td>
</tr>
<tr id="S4.T4.5.10" class="ltx_tr">
<td id="S4.T4.5.10.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Visual Retriever-Reader <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>
</td>
<td id="S4.T4.5.10.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">39.2</td>
</tr>
<tr id="S4.T4.5.11" class="ltx_tr">
<td id="S4.T4.5.11.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">MAVEx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>
</td>
<td id="S4.T4.5.11.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">40.3</td>
</tr>
<tr id="S4.T4.5.12" class="ltx_tr">
<td id="S4.T4.5.12.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">TRiG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S4.T4.5.12.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">49.4</td>
</tr>
<tr id="S4.T4.5.13" class="ltx_tr">
<td id="S4.T4.5.13.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">UnifER <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>
</td>
<td id="S4.T4.5.13.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">42.1</td>
</tr>
<tr id="S4.T4.5.14" class="ltx_tr">
<td id="S4.T4.5.14.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:0.5pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T4.5.15" class="ltx_tr">
<td id="S4.T4.5.15.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.5.15.1.1" class="ltx_text ltx_font_italic">methods with multimodal pretraining</span></td>
<td id="S4.T4.5.15.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="S4.T4.5.16" class="ltx_tr">
<td id="S4.T4.5.16.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Unified-IO (2.8B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>
</td>
<td id="S4.T4.5.16.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">54.0</td>
</tr>
<tr id="S4.T4.5.17" class="ltx_tr">
<td id="S4.T4.5.17.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Flamingo (80B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</td>
<td id="S4.T4.5.17.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">57.8</td>
</tr>
<tr id="S4.T4.5.18" class="ltx_tr">
<td id="S4.T4.5.18.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">PALI (17B) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>
</td>
<td id="S4.T4.5.18.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.5.18.2.1" class="ltx_text ltx_font_bold">64.5</span></td>
</tr>
<tr id="S4.T4.5.19" class="ltx_tr">
<td id="S4.T4.5.19.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:0.5pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T4.5.20" class="ltx_tr">
<td id="S4.T4.5.20.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.5.20.1.1" class="ltx_text ltx_font_italic">methods with GPT-3 API</span></td>
<td id="S4.T4.5.20.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
<tr id="S4.T4.5.21" class="ltx_tr">
<td id="S4.T4.5.21.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">PICa <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</td>
<td id="S4.T4.5.21.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">48.0</td>
</tr>
<tr id="S4.T4.3.3" class="ltx_tr">
<td id="S4.T4.3.3.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">KAT<sup id="S4.T4.3.3.1.1" class="ltx_sup"><span id="S4.T4.3.3.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>
</td>
<td id="S4.T4.3.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">53.1</td>
</tr>
<tr id="S4.T4.4.4" class="ltx_tr">
<td id="S4.T4.4.4.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">REVIVE<sup id="S4.T4.4.4.1.1" class="ltx_sup"><span id="S4.T4.4.4.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
</td>
<td id="S4.T4.4.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.6</td>
</tr>
<tr id="S4.T4.5.5" class="ltx_tr">
<td id="S4.T4.5.5.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">PromptCap (OFA)<sup id="S4.T4.5.5.1.1" class="ltx_sup"><span id="S4.T4.5.5.1.1.1" class="ltx_text ltx_font_italic">†</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</td>
<td id="S4.T4.5.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">60.4</td>
</tr>
<tr id="S4.T4.5.22" class="ltx_tr">
<td id="S4.T4.5.22.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.5.22.1.1" class="ltx_text ltx_font_bold">Prophet (MCAN)</span></td>
<td id="S4.T4.5.22.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">61.1</td>
</tr>
<tr id="S4.T4.5.23" class="ltx_tr">
<td id="S4.T4.5.23.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.5.23.1.1" class="ltx_text ltx_font_bold">Prophet (mPLUG)</span></td>
<td id="S4.T4.5.23.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">62.5</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.14.3.1" class="ltx_text" style="font-size:90%;">TABLE IV</span>: </span><span id="S4.T4.9.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Comparisons to the state-of-the-art methods on OK-VQA<span id="S4.T4.9.2.2" class="ltx_text ltx_font_medium"> testing set. The compared methods are split into three groups based on their knowledge resources and usages.
<sup id="S4.T4.9.2.2.1" class="ltx_sup">∗</sup>: accuracy is evaluated on OK-VQA v1.0.
<sup id="S4.T4.9.2.2.2" class="ltx_sup"><span id="S4.T4.9.2.2.2.1" class="ltx_text ltx_font_italic">†</span></sup>: method needs to query GPT-3 during training.</span></span></figcaption>
</figure>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">Our Prophet belongs to the last section. It outperforms all the compared methods by a distinct margin. Prophet is 13.1 points higher than PICa <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> when both methods use GPT-3 as the only knowledge resource. This confirms our hypothesis that the capacity of GPT-3 has not been fully activated in previous studies. Compared to KAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and REVIVE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, which utilize GPT-3 and other external KBs together in sophisticated systems, our Prophet is much simpler and more effective. Moreover, KAT, REVIVE, and PromptCap need to use GPT-3 to process all the training samples for their model training, which significantly increases the costs. In contrast, our Prophet only uses GPT-3 at inference time, which is more economical. Compared to the Flamingo-80B equipped with 32 in-context examples <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, Prophet (MCAN) delivers a significant performance improvement. Despite the fact that Prophet (MCAN) has a clear performance gap compared to PALI-17B <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>, Prophet is more resource-efficient from the perspective of reproducibility<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>Flamingo-80B is trained on 1,536 TPUv4 for 15 days and PALI is trained on 1,024 TPUv4 for 7 days, which are unaffordable for most researchers. In contrast, Prophet (MCAN) uses one RTX-3090 to train a VQA model for 4 days and a certain number of GPT-3 invocations.</span></span></span>. Finally, by replacing MCAN with the pretrained generative model mPLUG, our method exhibits a 1.4-point further improvement, showing the substantial contribution of a powerful VQA model for Prophet.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<table id="S4.T5.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T5.2.1" class="ltx_tr">
<td id="S4.T5.2.1.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.1.1.1" class="ltx_text">method</span></td>
<td id="S4.T5.2.1.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;" colspan="2">DA</td>
<td id="S4.T5.2.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;" colspan="2">MC</td>
</tr>
<tr id="S4.T5.2.2" class="ltx_tr">
<td id="S4.T5.2.2.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.2.1.1" class="ltx_text ltx_inline-block" style="width:20.8pt;">val</span></td>
<td id="S4.T5.2.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">test</td>
<td id="S4.T5.2.2.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.2.3.1" class="ltx_text ltx_inline-block" style="width:20.8pt;">val</span></td>
<td id="S4.T5.2.2.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">test</td>
</tr>
<tr id="S4.T5.2.3" class="ltx_tr">
<td id="S4.T5.2.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="5"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T5.2.4" class="ltx_tr">
<td id="S4.T5.2.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">ClipCap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S4.T5.2.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">30.9</td>
<td id="S4.T5.2.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">25.9</td>
<td id="S4.T5.2.4.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.9</td>
<td id="S4.T5.2.4.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">51.4</td>
</tr>
<tr id="S4.T5.2.5" class="ltx_tr">
<td id="S4.T5.2.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">ViLBERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S4.T5.2.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">30.6</td>
<td id="S4.T5.2.5.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">25.9</td>
<td id="S4.T5.2.5.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">49.1</td>
<td id="S4.T5.2.5.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">41.5</td>
</tr>
<tr id="S4.T5.2.6" class="ltx_tr">
<td id="S4.T5.2.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">LXMERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S4.T5.2.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">30.7</td>
<td id="S4.T5.2.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">25.9</td>
<td id="S4.T5.2.6.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">51.4</td>
<td id="S4.T5.2.6.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">41.6</td>
</tr>
<tr id="S4.T5.2.7" class="ltx_tr">
<td id="S4.T5.2.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">KRISP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S4.T5.2.7.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">33.7</td>
<td id="S4.T5.2.7.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">27.1</td>
<td id="S4.T5.2.7.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">51.9</td>
<td id="S4.T5.2.7.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">42.2</td>
</tr>
<tr id="S4.T5.2.8" class="ltx_tr">
<td id="S4.T5.2.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">GPV-2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S4.T5.2.8.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">48.6</td>
<td id="S4.T5.2.8.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">40.7</td>
<td id="S4.T5.2.8.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">60.3</td>
<td id="S4.T5.2.8.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">53.7</td>
</tr>
<tr id="S4.T5.2.9" class="ltx_tr">
<td id="S4.T5.2.9.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Unified-IO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>
</td>
<td id="S4.T5.2.9.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">-</td>
<td id="S4.T5.2.9.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">45.2</td>
<td id="S4.T5.2.9.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">-</td>
<td id="S4.T5.2.9.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">-</td>
</tr>
<tr id="S4.T5.2.10" class="ltx_tr">
<td id="S4.T5.2.10.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">PromptCap (OFA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</td>
<td id="S4.T5.2.10.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.3</td>
<td id="S4.T5.2.10.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.10.3.1" class="ltx_text ltx_font_bold">59.6</span></td>
<td id="S4.T5.2.10.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">73.2</td>
<td id="S4.T5.2.10.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">73.1</td>
</tr>
<tr id="S4.T5.2.11" class="ltx_tr">
<td id="S4.T5.2.11.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="5"><span class="ltx_rule" style="width:100%;height:0.5pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T5.2.12" class="ltx_tr">
<td id="S4.T5.2.12.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.12.1.1" class="ltx_text ltx_font_bold">Prophet (MCAN)</span></td>
<td id="S4.T5.2.12.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">58.2</td>
<td id="S4.T5.2.12.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">55.7</td>
<td id="S4.T5.2.12.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">76.4</td>
<td id="S4.T5.2.12.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">73.6</td>
</tr>
<tr id="S4.T5.2.13" class="ltx_tr">
<td id="S4.T5.2.13.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.13.1.1" class="ltx_text ltx_font_bold">Prophet (mPLUG)</span></td>
<td id="S4.T5.2.13.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.13.2.1" class="ltx_text ltx_font_bold">64.7</span></td>
<td id="S4.T5.2.13.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">58.5</td>
<td id="S4.T5.2.13.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.13.4.1" class="ltx_text ltx_font_bold">76.6</span></td>
<td id="S4.T5.2.13.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.2.13.5.1" class="ltx_text ltx_font_bold">75.1</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.4.1.1" class="ltx_text" style="font-size:90%;">TABLE V</span>: </span><span id="S4.T5.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Comparisons to the state-of-the-art methods on A-OKVQA<span id="S4.T5.5.2.1" class="ltx_text ltx_font_medium">. DA and MC refer to the direct-answer and multiple-choice tasks, respectively. For the MC task, we devise a Prophet variant with a slightly different prompt.</span></span></figcaption>
</figure>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p"><span id="S4.SS4.p3.1.1" class="ltx_text ltx_font_bold">Comparative results on A-OKVQA.</span> Table <a href="#S4.T5" title="TABLE V ‣ 4.4 Main Results ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> contains the comparative results on the challenging A-OKVQA dataset. The results on the DA task show that Prophet (MCAN) model significantly outperform most existing approaches, reflecting the effectiveness and generalization of our method. Compared to the current state-of-the-art method PromptCap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> which also involves a pretrained VQA model OFA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> and <span id="S4.SS4.p3.1.2" class="ltx_text">GPT-3</span>, Prophet (MCAN) exhibits similar performance when using a weaker VQA model.</p>
</div>
<div id="S4.SS4.p4" class="ltx_para">
<p id="S4.SS4.p4.1" class="ltx_p">For the MC task, we introduce a Prophet variant with slightly modifying the prompt used in the original Prophet. In particular, we add the multiple-choice information into both the in-context examples and testing input to instruct GPT-3 to <em id="S4.SS4.p4.1.1" class="ltx_emph ltx_font_italic">choose</em> the correct one from four choices.
Compared with all the methods, Prophet (MCAN) surpasses all the counterparts on the MC task, showing the flexibility and scalability of Prophet. Moreover, Prophet (mPLUG) steadily outperforms Prophet (MCAN), emphasizing the significance of a powerful VQA model to Prophet.


<br class="ltx_break"><span id="S4.SS4.p4.1.2" class="ltx_text ltx_font_bold">Results on ScienceQA and TextVQA</span>
To verify the generalization ability of Prophet, we conduct experiments on two additional knowledge-based VQA datasets ScienceQA (IMG) and TextVQA, which require different types of knowledge (<em id="S4.SS4.p4.1.3" class="ltx_emph ltx_font_italic">i.e.</em>, scientific knowledge and OCR knowledge) than that for OK-VQA and A-OKVQA.
A
Table <a href="#S4.T6" title="TABLE VI ‣ 4.4 Main Results ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a> shows that comparative results of Prophet and existing state-of-the-art methods on respective datasets. As we have witnessed the steady improvements of mPLUG over MCAN, we only report the results for Prophet (mPLUG) on these two datasets. Specifically, Prophet surpasses all the counterparts on ScienceQA (IMG), including the average human performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and the latest LLaVa model trained with visual instruction tuning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>. On TextVQA, Prophet outperforms the published state-of-the-art methods, including those methods with text-aware or layout-aware pretraining on large-scale scene-text image datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T6.st1" class="ltx_table ltx_figure_panel">
<table id="S4.T6.st1.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T6.st1.2.1" class="ltx_tr">
<td id="S4.T6.st1.2.1.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">method</td>
<td id="S4.T6.st1.2.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">accuracy</td>
</tr>
<tr id="S4.T6.st1.2.2" class="ltx_tr">
<td id="S4.T6.st1.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T6.st1.2.3" class="ltx_tr">
<td id="S4.T6.st1.2.3.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">MCAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</td>
<td id="S4.T6.st1.2.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">51.2</td>
</tr>
<tr id="S4.T6.st1.2.4" class="ltx_tr">
<td id="S4.T6.st1.2.4.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">GPT-3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S4.T6.st1.2.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">65.7</td>
</tr>
<tr id="S4.T6.st1.2.5" class="ltx_tr">
<td id="S4.T6.st1.2.5.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Chameleon <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>
</td>
<td id="S4.T6.st1.2.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">77.6</td>
</tr>
<tr id="S4.T6.st1.2.6" class="ltx_tr">
<td id="S4.T6.st1.2.6.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">InstructBLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>
</td>
<td id="S4.T6.st1.2.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">79.5</td>
</tr>
<tr id="S4.T6.st1.2.7" class="ltx_tr">
<td id="S4.T6.st1.2.7.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LLaMA-Adapter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>
</td>
<td id="S4.T6.st1.2.7.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">80.3</td>
</tr>
<tr id="S4.T6.st1.2.8" class="ltx_tr">
<td id="S4.T6.st1.2.8.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">MM-CoT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
</td>
<td id="S4.T6.st1.2.8.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">82.9</td>
</tr>
<tr id="S4.T6.st1.2.9" class="ltx_tr">
<td id="S4.T6.st1.2.9.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Human Average <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</td>
<td id="S4.T6.st1.2.9.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">87.5</td>
</tr>
<tr id="S4.T6.st1.2.10" class="ltx_tr">
<td id="S4.T6.st1.2.10.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LLaVa <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>
</td>
<td id="S4.T6.st1.2.10.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">88.0</td>
</tr>
<tr id="S4.T6.st1.2.11" class="ltx_tr">
<td id="S4.T6.st1.2.11.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T6.st1.2.11.1.1" class="ltx_text ltx_font_bold">Prophet (mPLUG)</span></td>
<td id="S4.T6.st1.2.11.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T6.st1.2.11.2.1" class="ltx_text ltx_font_bold">88.2</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T6.st1.3.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.T6.st1.4.2" class="ltx_text" style="font-size:90%;">ScienceQA (IMG)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T6.st2" class="ltx_table ltx_figure_panel">
<table id="S4.T6.st2.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T6.st2.2.1" class="ltx_tr">
<td id="S4.T6.st2.2.1.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">method</td>
<td id="S4.T6.st2.2.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">accuracy</td>
</tr>
<tr id="S4.T6.st2.2.2" class="ltx_tr">
<td id="S4.T6.st2.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="S4.T6.st2.2.3" class="ltx_tr">
<td id="S4.T6.st2.2.3.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LoRRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</td>
<td id="S4.T6.st2.2.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">27.6</td>
</tr>
<tr id="S4.T6.st2.2.4" class="ltx_tr">
<td id="S4.T6.st2.2.4.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">M4C <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite>
</td>
<td id="S4.T6.st2.2.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">40.5</td>
</tr>
<tr id="S4.T6.st2.2.5" class="ltx_tr">
<td id="S4.T6.st2.2.5.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">PromptCap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</td>
<td id="S4.T6.st2.2.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">51.9</td>
</tr>
<tr id="S4.T6.st2.2.6" class="ltx_tr">
<td id="S4.T6.st2.2.6.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">TAG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>
</td>
<td id="S4.T6.st2.2.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">53.7</td>
</tr>
<tr id="S4.T6.st2.2.7" class="ltx_tr">
<td id="S4.T6.st2.2.7.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">TAP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>
</td>
<td id="S4.T6.st2.2.7.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">54.0</td>
</tr>
<tr id="S4.T6.st2.2.8" class="ltx_tr">
<td id="S4.T6.st2.2.8.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Flamingo-80B <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</td>
<td id="S4.T6.st2.2.8.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">54.1</td>
</tr>
<tr id="S4.T6.st2.2.9" class="ltx_tr">
<td id="S4.T6.st2.2.9.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">mPLUG-doc <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite>
</td>
<td id="S4.T6.st2.2.9.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">57.6</td>
</tr>
<tr id="S4.T6.st2.2.10" class="ltx_tr">
<td id="S4.T6.st2.2.10.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">LaTr <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>
</td>
<td id="S4.T6.st2.2.10.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">59.6</td>
</tr>
<tr id="S4.T6.st2.2.11" class="ltx_tr">
<td id="S4.T6.st2.2.11.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T6.st2.2.11.1.1" class="ltx_text ltx_font_bold">Prophet (mPLUG)</span></td>
<td id="S4.T6.st2.2.11.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T6.st2.2.11.2.1" class="ltx_text ltx_font_bold">61.3</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T6.st2.3.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.T6.st2.4.2" class="ltx_text" style="font-size:90%;">TextVQA </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T6.3.1.1" class="ltx_text" style="font-size:90%;">TABLE VI</span>: </span><span id="S4.T6.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Comparisons to the state-of-the-art methods<span id="S4.T6.4.2.1" class="ltx_text ltx_font_medium"> on the testing set of ScienceQA and TextVQA, respectively. </span></span></figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span><span id="S4.SS5.1.1" class="ltx_text ltx_font_italic">Qualitative Analysis</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">In Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.5 Qualitative Analysis ‣ 4 Experiments ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we illustrate two typical samples consisting of the testing inputs and their in-context examples to explain how the answer heuristics work. The results show that the synergy of answer candidates and the answer-aware examples facilitates the generation of high-quality answers. In the first sample, the candidate answer ‘<em id="S4.SS5.p1.1.1" class="ltx_emph ltx_font_italic">lace</em>’ with a low confidence score is finally selected by the LLM as it frequently appears in the in-context examples. In the second sample, we see that Prophet can make a correct prediction beyond the answer candidates when the proper answer heuristic (the word ‘<em id="S4.SS5.p1.1.2" class="ltx_emph ltx_font_italic">leash</em>’) is provided in the in-context examples.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2303.01903/assets/x5.png" id="S4.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="372" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.5.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.6.2" class="ltx_text" style="font-size:90%;">We show two typical samples consisting of the testing inputs (left) and their in-context examples (right). The predicted answers of Prophet have a high probability to appear in the <span id="S4.F5.6.2.1" class="ltx_text ltx_font_bold" style="color:#0000FF;">answer candidates</span> and <span id="S4.F5.6.2.2" class="ltx_text ltx_font_bold" style="color:#00B34F;">answer-aware examples</span>, showing the effectiveness of answer heuristics in enhancing LLM’s ability to predict the correct answer.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Broader Impact</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">From a multimodal LLM (MLLM) point of view, Prophet is a loosely-coupled MLLM consisting of a vision-language (VL) model and a frozen LLM, aiming to endow the VL model with knowledge reasoning ability. Compared with the tightly-coupled MLLMs (<em id="S5.p1.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, Flamingo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and LLaVa <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>) which jointly optimize the VL model and LLM in an end-to-end manner, Prophet is more flexible that can support any open-source or commercial LLM.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Moreover, Prophet can also be regarded as a <em id="S5.p2.1.1" class="ltx_emph ltx_font_italic">learning-to-prompt</em> paradigm that learns an external model to generate prompts to better comprehend the target task, thus facilitating the capability of the pretrained LLM (or MLLM). From this point of view, recent studies like VoxPoser <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite> and SoM-Prompting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite> share a similar idea with our work. We believe this paradigm can be widely used in a variety of LLM-related tasks.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we present Prophet—a conceptually simple framework which uses LLMs as the knowledge engine for knowledge-based VQA. To better activate the few-shot learning capacity of LLMs, we introduce a novel paradigm to prompt LLMs with two types of complementary answer heuristics. Extensive ablations, comparative experiments, and comprehensive analyses on four diverse knowledge-based VQA datasets show the superiority of Prophet over all existing state-of-the-art methods. Notably, Prophet can be instantiated with varied combinations of a wide range of VQA models and LLMs, showing its flexibility, scalability, and generalizability.
We hope that our work can inspire future research on knowledge-based VQA and universal multimodal learning in the era of LLMs.</p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>More Implementation Details</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span><span id="A1.SS1.1.1" class="ltx_text ltx_font_italic">The Default VQA Model</span>
</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">Our default VQA model is carefully designed in terms of model architecture and training strategy. In the following table, we show the improvements of our default MCAN model over the counterparts trained from scratch. More details are provided next.</p>
</div>
<figure id="A1.SS1.tab1" class="ltx_table">
<table id="A1.SS1.tab1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A1.SS1.tab1.1.1" class="ltx_tr">
<td id="A1.SS1.tab1.1.1.1" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="A1.SS1.tab1.1.1.1.1" class="ltx_text"></span><span id="A1.SS1.tab1.1.1.1.2" class="ltx_text" style="font-size:90%;"> </span><span id="A1.SS1.tab1.1.1.1.3" class="ltx_text" style="font-size:90%;">
<span id="A1.SS1.tab1.1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<span id="A1.SS1.tab1.1.1.1.3.1.1" class="ltx_tr">
<span id="A1.SS1.tab1.1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">from scratch,</span></span>
<span id="A1.SS1.tab1.1.1.1.3.1.2" class="ltx_tr">
<span id="A1.SS1.tab1.1.1.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">original model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite></span></span>
</span></span><span id="A1.SS1.tab1.1.1.1.4" class="ltx_text"></span><span id="A1.SS1.tab1.1.1.1.5" class="ltx_text" style="font-size:90%;"></span>
</td>
<td id="A1.SS1.tab1.1.1.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="A1.SS1.tab1.1.1.2.1" class="ltx_text"></span><span id="A1.SS1.tab1.1.1.2.2" class="ltx_text" style="font-size:90%;"> </span><span id="A1.SS1.tab1.1.1.2.3" class="ltx_text" style="font-size:90%;">
<span id="A1.SS1.tab1.1.1.2.3.1" class="ltx_tabular ltx_align_middle">
<span id="A1.SS1.tab1.1.1.2.3.1.1" class="ltx_tr">
<span id="A1.SS1.tab1.1.1.2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">from scratch,</span></span>
<span id="A1.SS1.tab1.1.1.2.3.1.2" class="ltx_tr">
<span id="A1.SS1.tab1.1.1.2.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">improved model</span></span>
</span></span><span id="A1.SS1.tab1.1.1.2.4" class="ltx_text"></span><span id="A1.SS1.tab1.1.1.2.5" class="ltx_text" style="font-size:90%;"></span>
</td>
<td id="A1.SS1.tab1.1.1.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="A1.SS1.tab1.1.1.3.1" class="ltx_text"></span><span id="A1.SS1.tab1.1.1.3.2" class="ltx_text" style="font-size:90%;"> </span><span id="A1.SS1.tab1.1.1.3.3" class="ltx_text" style="font-size:90%;">
<span id="A1.SS1.tab1.1.1.3.3.1" class="ltx_tabular ltx_align_middle">
<span id="A1.SS1.tab1.1.1.3.3.1.1" class="ltx_tr">
<span id="A1.SS1.tab1.1.1.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">transfer learning,</span></span>
<span id="A1.SS1.tab1.1.1.3.3.1.2" class="ltx_tr">
<span id="A1.SS1.tab1.1.1.3.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;">improved model</span></span>
</span></span><span id="A1.SS1.tab1.1.1.3.4" class="ltx_text"></span><span id="A1.SS1.tab1.1.1.3.5" class="ltx_text" style="font-size:90%;"></span>
</td>
</tr>
<tr id="A1.SS1.tab1.1.2" class="ltx_tr">
<td id="A1.SS1.tab1.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="A1.SS1.tab1.1.3" class="ltx_tr">
<td id="A1.SS1.tab1.1.3.1" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="A1.SS1.tab1.1.3.1.1" class="ltx_text" style="font-size:90%;">31.5</span></td>
<td id="A1.SS1.tab1.1.3.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="A1.SS1.tab1.1.3.2.1" class="ltx_text" style="font-size:90%;">35.6</span></td>
<td id="A1.SS1.tab1.1.3.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="A1.SS1.tab1.1.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">53.0</span></td>
</tr>
</table>
</figure>
<div id="A1.SS1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS1.p2.1" class="ltx_p"><span id="A1.SS1.p2.1.1" class="ltx_text ltx_font_bold">Improved model architecture.</span> We introduce an improved variant of MCAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> based on its open-sourced MCAN-large implementation. Our modifications to the model architecture include: (i) we replace the original bottom-up-attention features with the grid-based features extracted from the CLIP’s visual encoder with RN50<math id="A1.SS1.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.SS1.p2.1.m1.1a"><mo id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><times id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">\times</annotation></semantics></math>64 backbone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>; (ii) we introduce the RoPE mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite> to each image self-attention layer of MCAN to supplement the grid-based features with positional information; and (iii) we replace the original LSTM network with a pre-trained BERT-large model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> as the text encoder before MCAN. Table <a href="#A1.T7" title="TABLE VII ‣ A.1 The Default VQA Model ‣ Appendix A More Implementation Details ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a> shows the accuracies of different model variants on the testing set of OK-VQA. By progressively adding the modifications to the original MCAN model, our improved MCAN model reports a 53.0% accuracy, which is on par with current state-of-the-art methods like KAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
<figure id="A1.T7" class="ltx_table">
<table id="A1.T7.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A1.T7.2.1" class="ltx_tr">
<td id="A1.T7.2.1.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">case</td>
<td id="A1.T7.2.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">OK-VQA accuracy</td>
</tr>
<tr id="A1.T7.2.2" class="ltx_tr">
<td id="A1.T7.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="A1.T7.2.3" class="ltx_tr">
<td id="A1.T7.2.3.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">original MCAN</td>
<td id="A1.T7.2.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">43.6</td>
</tr>
<tr id="A1.T7.2.4" class="ltx_tr">
<td id="A1.T7.2.4.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">+ CLIP visual feats</td>
<td id="A1.T7.2.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">49.6</td>
</tr>
<tr id="A1.T7.2.5" class="ltx_tr">
<td id="A1.T7.2.5.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">+ RoPE mechanism</td>
<td id="A1.T7.2.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50.3</td>
</tr>
<tr id="A1.T7.2.6" class="ltx_tr">
<td id="A1.T7.2.6.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">+ BERT as the text encoder</td>
<td id="A1.T7.2.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A1.T7.2.6.2.1" class="ltx_text ltx_font_bold">53.0</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T7.4.1.1" class="ltx_text" style="font-size:90%;">TABLE VII</span>: </span><span id="A1.T7.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Ablations for model architectures.<span id="A1.T7.5.2.1" class="ltx_text ltx_font_medium"> ‘+’ denotes each modification is applied to the previous variant.</span></span></figcaption>
</figure>
<figure id="A1.T8" class="ltx_table">
<table id="A1.T8.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A1.T8.2.1" class="ltx_tr">
<td id="A1.T8.2.1.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">training strategy</td>
<td id="A1.T8.2.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">OK-VQA accuracy</td>
</tr>
<tr id="A1.T8.2.2" class="ltx_tr">
<td id="A1.T8.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="A1.T8.2.3" class="ltx_tr">
<td id="A1.T8.2.3.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">(a) train from scratch</td>
<td id="A1.T8.2.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">35.6</td>
</tr>
<tr id="A1.T8.2.4" class="ltx_tr">
<td id="A1.T8.2.4.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">(b) pretrain, w/o finetune</td>
<td id="A1.T8.2.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">41.1</td>
</tr>
<tr id="A1.T8.2.5" class="ltx_tr">
<td id="A1.T8.2.5.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">(c) w/ finetune, replace last layer</td>
<td id="A1.T8.2.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">47.7</td>
</tr>
<tr id="A1.T8.2.6" class="ltx_tr">
<td id="A1.T8.2.6.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">(d) w/ finetune, append new answers</td>
<td id="A1.T8.2.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A1.T8.2.6.2.1" class="ltx_text ltx_font_bold">53.0</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T8.4.1.1" class="ltx_text" style="font-size:90%;">TABLE VIII</span>: </span><span id="A1.T8.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Ablations for training strategies.<span id="A1.T8.5.2.1" class="ltx_text ltx_font_medium"> All variants use the improved model architecture in the last row in Table <a href="#A1.T7" title="TABLE VII ‣ A.1 The Default VQA Model ‣ Appendix A More Implementation Details ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>.
</span></span></figcaption>
</figure>
<figure id="A1.T9" class="ltx_table">
<table id="A1.T9.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A1.T9.2.1" class="ltx_tr">
<td id="A1.T9.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A1.T9.2.1.1.1" class="ltx_text ltx_font_typewriter">Please answer the question according to the context and the answer candidates. Each answer candidate is associated with a</span></td>
</tr>
<tr id="A1.T9.2.2" class="ltx_tr">
<td id="A1.T9.2.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.2.1.1" class="ltx_text ltx_font_typewriter">confidence score within a bracket. The true answer may not be included in the candidates.</span></td>
</tr>
<tr id="A1.T9.2.3" class="ltx_tr">
<td id="A1.T9.2.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.3.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T9.2.4" class="ltx_tr">
<td id="A1.T9.2.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.4.1.1" class="ltx_text ltx_font_typewriter">Context: The motorcycle racers are getting ready for a race.</span></td>
</tr>
<tr id="A1.T9.2.5" class="ltx_tr">
<td id="A1.T9.2.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.5.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T9.2.6" class="ltx_tr">
<td id="A1.T9.2.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.6.1.1" class="ltx_text ltx_font_typewriter">Question: What sport are these guys doing?</span></td>
</tr>
<tr id="A1.T9.2.7" class="ltx_tr">
<td id="A1.T9.2.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.7.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T9.2.8" class="ltx_tr">
<td id="A1.T9.2.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.8.1.1" class="ltx_text ltx_font_typewriter">Candidates: motorcross(0.94), motocross(0.79), bike(0.35), dirt bike(0.28), motorcycle(0.03),</span></td>
</tr>
<tr id="A1.T9.2.9" class="ltx_tr">
<td id="A1.T9.2.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.9.1.1" class="ltx_text ltx_font_typewriter">bmx(0.03), cycling(0.02), motorbike(0.02), race(0.02), bicycle(0.02)</span></td>
</tr>
<tr id="A1.T9.2.10" class="ltx_tr">
<td id="A1.T9.2.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.10.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T9.2.11" class="ltx_tr">
<td id="A1.T9.2.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.11.1.1" class="ltx_text ltx_font_typewriter">Answer: motorcross</span></td>
</tr>
<tr id="A1.T9.2.12" class="ltx_tr">
<td id="A1.T9.2.12.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.12.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T9.2.13" class="ltx_tr">
<td id="A1.T9.2.13.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.13.1.1" class="ltx_text ltx_font_typewriter">Context: a black motorcycle parked in a parking lot.</span></td>
</tr>
<tr id="A1.T9.2.14" class="ltx_tr">
<td id="A1.T9.2.14.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.14.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T9.2.15" class="ltx_tr">
<td id="A1.T9.2.15.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.15.1.1" class="ltx_text ltx_font_typewriter">Question: What sport can you use this for?</span></td>
</tr>
<tr id="A1.T9.2.16" class="ltx_tr">
<td id="A1.T9.2.16.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.16.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T9.2.17" class="ltx_tr">
<td id="A1.T9.2.17.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.17.1.1" class="ltx_text ltx_font_typewriter">Candidates: race(0.53), motorcycle(0.41), motocross(0.19), bike(0.17), motorcross(0.15),</span></td>
</tr>
<tr id="A1.T9.2.18" class="ltx_tr">
<td id="A1.T9.2.18.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.18.1.1" class="ltx_text ltx_font_typewriter">cycling(0.11), dirt bike(0.10), ride(0.08), bicycling(0.01), bicycle(0.01)</span></td>
</tr>
<tr id="A1.T9.2.19" class="ltx_tr">
<td id="A1.T9.2.19.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T9.2.19.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T9.2.20" class="ltx_tr">
<td id="A1.T9.2.20.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r"><span id="A1.T9.2.20.1.1" class="ltx_text ltx_font_typewriter">Answer:</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T9.6.1.1" class="ltx_text" style="font-size:90%;">TABLE IX</span>: </span><span id="A1.T9.7.2" class="ltx_text ltx_font_bold" style="font-size:90%;">An exemplar prompt for the standard Prophet.<span id="A1.T9.7.2.1" class="ltx_text ltx_font_medium"> We show <em id="A1.T9.7.2.1.1" class="ltx_emph ltx_font_italic">one</em> in-context example here due to space limitations. Following the implementations in PICa <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and KAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, we use a special symbol ‘<span id="A1.T9.7.2.1.2" class="ltx_text ltx_font_typewriter">===</span>’ to separate each two lines.</span></span></figcaption>
</figure>
<figure id="A1.T10" class="ltx_table">
<table id="A1.T10.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A1.T10.2.1" class="ltx_tr">
<td id="A1.T10.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A1.T10.2.1.1.1" class="ltx_text ltx_font_typewriter" style="color:#FF0000;">Please choose the correct answer in the choices<span id="A1.T10.2.1.1.1.1" class="ltx_text" style="color:#000000;"> according to the context, the question and the answer candidates. Each answer</span></span></td>
</tr>
<tr id="A1.T10.2.2" class="ltx_tr">
<td id="A1.T10.2.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.2.1.1" class="ltx_text ltx_font_typewriter">candidate is associated with a confidence score within a bracket. The true answer may not be included in the candidates.</span></td>
</tr>
<tr id="A1.T10.2.3" class="ltx_tr">
<td id="A1.T10.2.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.3.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.4" class="ltx_tr">
<td id="A1.T10.2.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.4.1.1" class="ltx_text ltx_font_typewriter">Context: A young man riding a skateboard on a sidewalk.</span></td>
</tr>
<tr id="A1.T10.2.5" class="ltx_tr">
<td id="A1.T10.2.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.5.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.6" class="ltx_tr">
<td id="A1.T10.2.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.6.1.1" class="ltx_text ltx_font_typewriter">Question: What part of his body will be most harmed by the item in his mouth?</span></td>
</tr>
<tr id="A1.T10.2.7" class="ltx_tr">
<td id="A1.T10.2.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.7.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.8" class="ltx_tr">
<td id="A1.T10.2.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.8.1.1" class="ltx_text ltx_font_typewriter">Candidates: skateboard(0.02), nothing(0.02), table(0.01), leg(0.01), helmet(0.00), knees(0.00),</span></td>
</tr>
<tr id="A1.T10.2.9" class="ltx_tr">
<td id="A1.T10.2.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.9.1.1" class="ltx_text ltx_font_typewriter">skateboarding(0.00), head(0.00), teeth(0.00), falling(0.00)</span></td>
</tr>
<tr id="A1.T10.2.10" class="ltx_tr">
<td id="A1.T10.2.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.10.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.11" class="ltx_tr">
<td id="A1.T10.2.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.11.1.1" class="ltx_text ltx_font_typewriter" style="color:#FF0000;">Choices: (A) back, (B) lungs, (C) feet, (D) eyes</span></td>
</tr>
<tr id="A1.T10.2.12" class="ltx_tr">
<td id="A1.T10.2.12.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.12.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.13" class="ltx_tr">
<td id="A1.T10.2.13.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.13.1.1" class="ltx_text ltx_font_typewriter">Answer: <span id="A1.T10.2.13.1.1.1" class="ltx_text" style="color:#FF0000;">(B)</span></span></td>
</tr>
<tr id="A1.T10.2.14" class="ltx_tr">
<td id="A1.T10.2.14.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.14.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.15" class="ltx_tr">
<td id="A1.T10.2.15.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.15.1.1" class="ltx_text ltx_font_typewriter">Context: a young boy kneeling on a skateboard on the street.</span></td>
</tr>
<tr id="A1.T10.2.16" class="ltx_tr">
<td id="A1.T10.2.16.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.16.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.17" class="ltx_tr">
<td id="A1.T10.2.17.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.17.1.1" class="ltx_text ltx_font_typewriter">Question: What did this lad likely injure here?</span></td>
</tr>
<tr id="A1.T10.2.18" class="ltx_tr">
<td id="A1.T10.2.18.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.18.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.19" class="ltx_tr">
<td id="A1.T10.2.19.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.19.1.1" class="ltx_text ltx_font_typewriter">Candidates: skateboard(0.18), shoes(0.02), shoe(0.02), skateboarding(0.01), street(0.01),</span></td>
</tr>
<tr id="A1.T10.2.20" class="ltx_tr">
<td id="A1.T10.2.20.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.20.1.1" class="ltx_text ltx_font_typewriter">flowers(0.01), skating(0.01), boy(0.01), head(0.00), skateboarder(0.00)</span></td>
</tr>
<tr id="A1.T10.2.21" class="ltx_tr">
<td id="A1.T10.2.21.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.21.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.22" class="ltx_tr">
<td id="A1.T10.2.22.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.22.1.1" class="ltx_text ltx_font_typewriter">Choices: <span id="A1.T10.2.22.1.1.1" class="ltx_text" style="color:#FF0000;">(A) knee, (B) elbow, (C) rear, (D) board</span></span></td>
</tr>
<tr id="A1.T10.2.23" class="ltx_tr">
<td id="A1.T10.2.23.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T10.2.23.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T10.2.24" class="ltx_tr">
<td id="A1.T10.2.24.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r"><span id="A1.T10.2.24.1.1" class="ltx_text ltx_font_typewriter">Answer:</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T10.5.1.1" class="ltx_text" style="font-size:90%;">TABLE X</span>: </span><span id="A1.T10.6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">An exemplar prompt for the Prophet variant on the MC task of A-OKVQA.<span id="A1.T10.6.2.1" class="ltx_text ltx_font_medium"> Compared to the standard prompt in Table <a href="#A1.T9" title="TABLE IX ‣ A.1 The Default VQA Model ‣ Appendix A More Implementation Details ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IX</span></a>, we add one extra line of choices for the example and testing input, and change the output format to adapt to the multiple-choice task. All the differences are marked in <span id="A1.T10.6.2.1.1" class="ltx_text" style="color:#FF0000;">red</span>.
</span></span></figcaption>
</figure>
<figure id="A1.T11" class="ltx_table">
<table id="A1.T11.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A1.T11.2.1" class="ltx_tr">
<td id="A1.T11.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A1.T11.2.1.1.1" class="ltx_text ltx_font_typewriter">Please choose the correct answer in the choices according to the context, the question and the answer candidates. Each answer</span></td>
</tr>
<tr id="A1.T11.2.2" class="ltx_tr">
<td id="A1.T11.2.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.2.1.1" class="ltx_text ltx_font_typewriter">candidate is associated with a confidence score within a bracket. The true answer may not be included in the candidates.</span></td>
</tr>
<tr id="A1.T11.2.3" class="ltx_tr">
<td id="A1.T11.2.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.3.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.4" class="ltx_tr">
<td id="A1.T11.2.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.4.1.1" class="ltx_text ltx_font_typewriter">Context: A picture of a black and white model of a molecule. <span id="A1.T11.2.4.1.1.1" class="ltx_text" style="color:#FF0000;">The model below represents graphite. Graphite is used to make</span></span></td>
</tr>
<tr id="A1.T11.2.5" class="ltx_tr">
<td id="A1.T11.2.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.5.1.1" class="ltx_text ltx_font_typewriter" style="color:#FF0000;">pencil lead.</span></td>
</tr>
<tr id="A1.T11.2.6" class="ltx_tr">
<td id="A1.T11.2.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.6.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.7" class="ltx_tr">
<td id="A1.T11.2.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.7.1.1" class="ltx_text ltx_font_typewriter">Question: Complete the statement. Graphite is ().</span></td>
</tr>
<tr id="A1.T11.2.8" class="ltx_tr">
<td id="A1.T11.2.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.8.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.9" class="ltx_tr">
<td id="A1.T11.2.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.9.1.1" class="ltx_text ltx_font_typewriter">Candidates: an elementary substance(1.00), a compound(0.02), an adult substance(0.01), an an elementary substance(0.01)</span></td>
</tr>
<tr id="A1.T11.2.10" class="ltx_tr">
<td id="A1.T11.2.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.10.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.11" class="ltx_tr">
<td id="A1.T11.2.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.11.1.1" class="ltx_text ltx_font_typewriter">Choices: (A) a compound, (B) an elementary substance</span></td>
</tr>
<tr id="A1.T11.2.12" class="ltx_tr">
<td id="A1.T11.2.12.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.12.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.13" class="ltx_tr">
<td id="A1.T11.2.13.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.13.1.1" class="ltx_text ltx_font_typewriter">Answer: (B)</span></td>
</tr>
<tr id="A1.T11.2.14" class="ltx_tr">
<td id="A1.T11.2.14.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.14.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.15" class="ltx_tr">
<td id="A1.T11.2.15.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.15.1.1" class="ltx_text ltx_font_typewriter">Context: A pair of eye glasses with the word h on them. <span id="A1.T11.2.15.1.1.1" class="ltx_text" style="color:#FF0000;">The model below represents a molecule of hydrogen. Hydrogen gas was</span></span></td>
</tr>
<tr id="A1.T11.2.16" class="ltx_tr">
<td id="A1.T11.2.16.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.16.1.1" class="ltx_text ltx_font_typewriter" style="color:#FF0000;">once used to make large airships, such as blimps, float. It is no longer used in airships because it catches fire easily.</span></td>
</tr>
<tr id="A1.T11.2.17" class="ltx_tr">
<td id="A1.T11.2.17.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.17.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.18" class="ltx_tr">
<td id="A1.T11.2.18.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.18.1.1" class="ltx_text ltx_font_typewriter">Question:Complete the statement. Hydrogen is ().</span></td>
</tr>
<tr id="A1.T11.2.19" class="ltx_tr">
<td id="A1.T11.2.19.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.19.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.20" class="ltx_tr">
<td id="A1.T11.2.20.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.20.1.1" class="ltx_text ltx_font_typewriter">Candidates: a compound(0.68), an elementary substance(0.32), the same substance(0.00), the same amount(0.00)</span></td>
</tr>
<tr id="A1.T11.2.21" class="ltx_tr">
<td id="A1.T11.2.21.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.21.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.22" class="ltx_tr">
<td id="A1.T11.2.22.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.22.1.1" class="ltx_text ltx_font_typewriter">Choices: (A) an elementary substance, (B) a compound</span></td>
</tr>
<tr id="A1.T11.2.23" class="ltx_tr">
<td id="A1.T11.2.23.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T11.2.23.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T11.2.24" class="ltx_tr">
<td id="A1.T11.2.24.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r"><span id="A1.T11.2.24.1.1" class="ltx_text ltx_font_typewriter">Answer:</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T11.5.1.1" class="ltx_text" style="font-size:90%;">TABLE XI</span>: </span><span id="A1.T11.6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">An exemplar prompt for the Prophet variant on ScienceQA (IMG).<span id="A1.T11.6.2.1" class="ltx_text ltx_font_medium"> The sentences marked in <span id="A1.T11.6.2.1.1" class="ltx_text" style="color:#FF0000;">red</span> are the optional text hints provided by the dataset.</span></span></figcaption>
</figure>
<figure id="A1.T12" class="ltx_table">
<table id="A1.T12.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A1.T12.2.1" class="ltx_tr">
<td id="A1.T12.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A1.T12.2.1.1.1" class="ltx_text ltx_font_typewriter">Please answer the question according to the context and the answer candidates. Each answer candidate is associated with a</span></td>
</tr>
<tr id="A1.T12.2.2" class="ltx_tr">
<td id="A1.T12.2.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.2.1.1" class="ltx_text ltx_font_typewriter">confidence score within a bracket. The true answer may not be included in the candidates.</span></td>
</tr>
<tr id="A1.T12.2.3" class="ltx_tr">
<td id="A1.T12.2.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.3.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.4" class="ltx_tr">
<td id="A1.T12.2.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.4.1.1" class="ltx_text ltx_font_typewriter">Context: A close up of a cell phone with a keyboard.</span></td>
</tr>
<tr id="A1.T12.2.5" class="ltx_tr">
<td id="A1.T12.2.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.5.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.6" class="ltx_tr">
<td id="A1.T12.2.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.6.1.1" class="ltx_text ltx_font_typewriter" style="color:#FF0000;">OCR: Market, 3, Facebook, Browser, 5, 4, 6, 1, 8, 30.</span></td>
</tr>
<tr id="A1.T12.2.7" class="ltx_tr">
<td id="A1.T12.2.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.7.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.8" class="ltx_tr">
<td id="A1.T12.2.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.8.1.1" class="ltx_text ltx_font_typewriter">Question: How many apps are on this page excluding market?</span></td>
</tr>
<tr id="A1.T12.2.9" class="ltx_tr">
<td id="A1.T12.2.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.9.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.10" class="ltx_tr">
<td id="A1.T12.2.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.10.1.1" class="ltx_text ltx_font_typewriter">Candidates: 6(0.20), 5(0.19), 8(0.18), 9(0.12), 7(0.08), answering does(0.05),10(0.05),13(0.05),12(0.04),4(0.04)</span></td>
</tr>
<tr id="A1.T12.2.11" class="ltx_tr">
<td id="A1.T12.2.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.11.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.12" class="ltx_tr">
<td id="A1.T12.2.12.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.12.1.1" class="ltx_text ltx_font_typewriter">Answer: 7</span></td>
</tr>
<tr id="A1.T12.2.13" class="ltx_tr">
<td id="A1.T12.2.13.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.13.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.14" class="ltx_tr">
<td id="A1.T12.2.14.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.14.1.1" class="ltx_text ltx_font_typewriter">Context: A screenshot of a yahoo mail page.</span></td>
</tr>
<tr id="A1.T12.2.15" class="ltx_tr">
<td id="A1.T12.2.15.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.15.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.16" class="ltx_tr">
<td id="A1.T12.2.16.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.16.1.1" class="ltx_text ltx_font_typewriter" style="color:#FF0000;">OCR: Free, Page, Nake WT My Page, ADVERTISEMENT, YAHOO!, FREE Camera Phone, Notepad, MAIL, Yaboo! Mail.</span></td>
</tr>
<tr id="A1.T12.2.17" class="ltx_tr">
<td id="A1.T12.2.17.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.17.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.18" class="ltx_tr">
<td id="A1.T12.2.18.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.18.1.1" class="ltx_text ltx_font_typewriter">Question: What is free on this page?</span></td>
</tr>
<tr id="A1.T12.2.19" class="ltx_tr">
<td id="A1.T12.2.19.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.19.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.20" class="ltx_tr">
<td id="A1.T12.2.20.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.20.1.1" class="ltx_text ltx_font_typewriter">Candidates: amera(0.40), video camera(0.29), video(0.13), photos(0.04), video call(0.04), webcam(0.03), videos(0.03),</span></td>
</tr>
<tr id="A1.T12.2.21" class="ltx_tr">
<td id="A1.T12.2.21.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.21.1.1" class="ltx_text ltx_font_typewriter">photography(0.01), photoshop(0.01), internet explorer(0.01)</span></td>
</tr>
<tr id="A1.T12.2.22" class="ltx_tr">
<td id="A1.T12.2.22.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="A1.T12.2.22.1.1" class="ltx_text ltx_font_typewriter">===</span></td>
</tr>
<tr id="A1.T12.2.23" class="ltx_tr">
<td id="A1.T12.2.23.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r"><span id="A1.T12.2.23.1.1" class="ltx_text ltx_font_typewriter">Answer:</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T12.5.1.1" class="ltx_text" style="font-size:90%;">TABLE XII</span>: </span><span id="A1.T12.6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">An exemplar prompt for the Prophet variant on TextVQA.<span id="A1.T12.6.2.1" class="ltx_text ltx_font_medium"> Compared to the standard prompt, we additionally introduce the OCR tokens (marked in <span id="A1.T12.6.2.1.1" class="ltx_text" style="color:#FF0000;">red</span>) extracted from an off-the-shelf OCR system. </span></span></figcaption>
</figure>
<div id="A1.SS1.p3" class="ltx_para ltx_noindent">
<p id="A1.SS1.p3.1" class="ltx_p"><span id="A1.SS1.p3.1.1" class="ltx_text ltx_font_bold">Training recipe.</span> We first pretrain the model on the augmented <em id="A1.SS1.p3.1.2" class="ltx_emph ltx_font_italic">train+val+vg</em> dataset from VQAv2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> and Visual Genome<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>, with excluding the samples whose images are used in the testing split of OK-VQA to avoid data contamination. The settings for the pretraining stage are identical to the original implementation of MCAN.
After that, the model is finetuned on the downstream OK-VQA and A-OKVQA datasets, respectively. For finetuning, the commonly used strategy is to replace the last linear layer (<em id="A1.SS1.p3.1.3" class="ltx_emph ltx_font_italic">i.e.</em>, the classification layer) with a new layer to adapt to the answer vocabulary of the downstream dataset. However, the answer vocabularies of the pretraining and finetuning datasets are <em id="A1.SS1.p3.1.4" class="ltx_emph ltx_font_italic">partially</em> overlapped. To maximally utilize the pretrained model parameters in the last layer, we inherit the parameters of existing answers and append new parameters for the new answers. After that, we freeze all the pretrained parameters and only update the new parameters for one epoch as a warm-up, and then train all model parameters for the rest training epochs.</p>
</div>
<div id="A1.SS1.p4" class="ltx_para">
<p id="A1.SS1.p4.1" class="ltx_p">Table <a href="#A1.T8" title="TABLE VIII ‣ A.1 The Default VQA Model ‣ Appendix A More Implementation Details ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VIII</span></a> shows the effects of different training strategies. Even without finetuning, the pretrained model (b) is superior to the model trained from scratch (a), implying the importance of pretraining. Moreover, our new finetuning strategy (d) leads to significantly better performance than the commonly used strategy (c), showing the effectiveness of inheriting model parameters for existing answers.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span><span id="A1.SS2.1.1" class="ltx_text ltx_font_italic">Prompt Formats</span>
</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">We show an exemplar prompt for the standard Prophet in Table <a href="#A1.T9" title="TABLE IX ‣ A.1 The Default VQA Model ‣ Appendix A More Implementation Details ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IX</span></a> and an exemplar prompt for the variant designed for the MC task of A-OKVQA in Table <a href="#A1.T10" title="TABLE X ‣ A.1 The Default VQA Model ‣ Appendix A More Implementation Details ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">X</span></a>.
The exemplar prompts for ScienceQA and TextVQA are illustrated in Table <a href="#A1.T11" title="TABLE XI ‣ A.1 The Default VQA Model ‣ Appendix A More Implementation Details ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">XI</span></a> and <a href="#A1.T12" title="TABLE XII ‣ A.1 The Default VQA Model ‣ Appendix A More Implementation Details ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">XII</span></a>, respectively.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>More Qualitative and Quantitative Analyses</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">We provide more in-depth analyses of Prophet’s performance on the testing set of OKVQA. All results are carried out using the default settings.</p>
</div>
<figure id="A2.T13" class="ltx_table">
<table id="A2.T13.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A2.T13.2.1" class="ltx_tr">
<td id="A2.T13.2.1.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">category</td>
<td id="A2.T13.2.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">MCAN</td>
<td id="A2.T13.2.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">Prophet</td>
</tr>
<tr id="A2.T13.2.2" class="ltx_tr">
<td id="A2.T13.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="3"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="A2.T13.2.3" class="ltx_tr">
<td id="A2.T13.2.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Plants and Animals</td>
<td id="A2.T13.2.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">52.58</td>
<td id="A2.T13.2.3.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.3.3.1" class="ltx_text ltx_font_bold">63.67</span></td>
</tr>
<tr id="A2.T13.2.4" class="ltx_tr">
<td id="A2.T13.2.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Science and Technology</td>
<td id="A2.T13.2.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">48.10</td>
<td id="A2.T13.2.4.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.4.3.1" class="ltx_text ltx_font_bold">48.81</span></td>
</tr>
<tr id="A2.T13.2.5" class="ltx_tr">
<td id="A2.T13.2.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Sports and Recreation</td>
<td id="A2.T13.2.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">59.08</td>
<td id="A2.T13.2.5.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.5.3.1" class="ltx_text ltx_font_bold">66.00</span></td>
</tr>
<tr id="A2.T13.2.6" class="ltx_tr">
<td id="A2.T13.2.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Geography, History, Language and Culture</td>
<td id="A2.T13.2.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">52.48</td>
<td id="A2.T13.2.6.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.6.3.1" class="ltx_text ltx_font_bold">62.98</span></td>
</tr>
<tr id="A2.T13.2.7" class="ltx_tr">
<td id="A2.T13.2.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Brands, Companies and Products</td>
<td id="A2.T13.2.7.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">51.98</td>
<td id="A2.T13.2.7.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.7.3.1" class="ltx_text ltx_font_bold">54.77</span></td>
</tr>
<tr id="A2.T13.2.8" class="ltx_tr">
<td id="A2.T13.2.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Vehicles and Transportation</td>
<td id="A2.T13.2.8.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50.82</td>
<td id="A2.T13.2.8.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.8.3.1" class="ltx_text ltx_font_bold">58.01</span></td>
</tr>
<tr id="A2.T13.2.9" class="ltx_tr">
<td id="A2.T13.2.9.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Cooking and Food</td>
<td id="A2.T13.2.9.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">55.53</td>
<td id="A2.T13.2.9.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.9.3.1" class="ltx_text ltx_font_bold">62.09</span></td>
</tr>
<tr id="A2.T13.2.10" class="ltx_tr">
<td id="A2.T13.2.10.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Weather and Climate</td>
<td id="A2.T13.2.10.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">65.12</td>
<td id="A2.T13.2.10.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.10.3.1" class="ltx_text ltx_font_bold">68.37</span></td>
</tr>
<tr id="A2.T13.2.11" class="ltx_tr">
<td id="A2.T13.2.11.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">People and Everyday life</td>
<td id="A2.T13.2.11.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">49.44</td>
<td id="A2.T13.2.11.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.11.3.1" class="ltx_text ltx_font_bold">54.67</span></td>
</tr>
<tr id="A2.T13.2.12" class="ltx_tr">
<td id="A2.T13.2.12.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Objects, Material and Clothing</td>
<td id="A2.T13.2.12.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50.05</td>
<td id="A2.T13.2.12.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="A2.T13.2.12.3.1" class="ltx_text ltx_font_bold">57.20</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A2.T13.4.1.1" class="ltx_text" style="font-size:90%;">TABLE XIII</span>: </span><span id="A2.T13.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Per-category accuracies <span id="A2.T13.5.2.1" class="ltx_text ltx_font_medium"> of MCAN (stage-1) and Prophet (stage-2). This performance improvements of using GPT-3 are observed on all categories.
</span></span></figcaption>
</figure>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">We show the per-type accuracies of MCAN (stage-1) and Prophet (stage-2) in Table <a href="#A2.T13" title="TABLE XIII ‣ Appendix B More Qualitative and Quantitative Analyses ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">XIII</span></a>. Prophet outperforms MCAN on all categories, indicating that generality of the knowledge in GPT-3. The improvement on the “Science and Technology” category is not as large as the rest categories. which can be explained that the required knowledge for this category is more specialized and professional. These questions are also challenging for humans.</p>
</div>
<figure id="A2.T14" class="ltx_table">
<table id="A2.T14.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A2.T14.2.1" class="ltx_tr">
<td id="A2.T14.2.1.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">failure cause</td>
<td id="A2.T14.2.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">proportion</td>
</tr>
<tr id="A2.T14.2.2" class="ltx_tr">
<td id="A2.T14.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;" colspan="2"><span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span></td>
</tr>
<tr id="A2.T14.2.3" class="ltx_tr">
<td id="A2.T14.2.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">(a) insufficient visual understanding</td>
<td id="A2.T14.2.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">27.3%</td>
</tr>
<tr id="A2.T14.2.4" class="ltx_tr">
<td id="A2.T14.2.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">(b) incorrect knowledge reasoning</td>
<td id="A2.T14.2.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">
<span id="A2.T14.2.4.2.1" class="ltx_text ltx_font_bold">44.1</span>%</td>
</tr>
<tr id="A2.T14.2.5" class="ltx_tr">
<td id="A2.T14.2.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">(c) correct but differently expressed answer</td>
<td id="A2.T14.2.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">22.8%</td>
</tr>
<tr id="A2.T14.2.6" class="ltx_tr">
<td id="A2.T14.2.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">(d) others</td>
<td id="A2.T14.2.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">5.8%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A2.T14.4.1.1" class="ltx_text" style="font-size:90%;">TABLE XIV</span>: </span><span id="A2.T14.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">The distribution of failure causes<span id="A2.T14.5.2.1" class="ltx_text ltx_font_medium"> by human studies.
</span></span></figcaption>
</figure>
<figure id="A2.F6" class="ltx_figure"><img src="/html/2303.01903/assets/x6.png" id="A2.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="438" height="556" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F6.9.3.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="A2.F6.5.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Different categories and prediction behaviors.<span id="A2.F6.5.4.2.2" class="ltx_text ltx_font_medium">
Each row contains four testing samples from a specific knowledge category. The first to the third columns correspond to the correctly answered samples of different prediction behaviors (<em id="A2.F6.5.4.2.2.1" class="ltx_emph ltx_font_italic">i.e.</em>, keep top-1, in top 2-<math id="A2.F6.4.3.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.F6.4.3.1.1.m1.1b"><mi id="A2.F6.4.3.1.1.m1.1.1" xref="A2.F6.4.3.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.F6.4.3.1.1.m1.1c"><ci id="A2.F6.4.3.1.1.m1.1.1.cmml" xref="A2.F6.4.3.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.4.3.1.1.m1.1d">K</annotation></semantics></math>, and beyond top-<math id="A2.F6.5.4.2.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.F6.5.4.2.2.m2.1b"><mi id="A2.F6.5.4.2.2.m2.1.1" xref="A2.F6.5.4.2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.F6.5.4.2.2.m2.1c"><ci id="A2.F6.5.4.2.2.m2.1.1.cmml" xref="A2.F6.5.4.2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.5.4.2.2.m2.1d">K</annotation></semantics></math>). The last column contains failure samples.
</span></span></figcaption>
</figure>
<div id="A2.p3" class="ltx_para">
<p id="A2.p3.1" class="ltx_p">We perform human studies to analyze the causes of wrong predictions in Table <a href="#A2.T14" title="TABLE XIV ‣ Appendix B More Qualitative and Quantitative Analyses ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">XIV</span></a>. For each category, we randomly sample 10% testing samples that Prophet fails to get the correct answer. This results in 172 samples. We ask three annotators to categorize each sample into one of the following four failure causes: (a) insufficient visual understanding; (b) incorrect knowledge reasoning; (c) correct but differently expressed answer; (d) others (<em id="A2.p3.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, the failure is caused by the ambiguity of the question). From the results, we can see that the cause of “(b) incorrect knowledge reasoning” accounts for the highest proportion, which suggests that the bottleneck of Prophet still lies in the knowledge acquisition and reasoning. The cause of “(a) insufficient visual understanding” has the second highest proportion, showing the potential of devising more powerful VQA models. The cause of “(c) correct but differently expressed answer” also accounts for a considerable proportion. This reflects the limitation of the annotations and evaluation metric of OK-VQA.</p>
</div>
<div id="A2.p4" class="ltx_para">
<p id="A2.p4.2" class="ltx_p">Figure <a href="#A2.F6" title="Figure 6 ‣ Appendix B More Qualitative and Quantitative Analyses ‣ Prophet: Prompting Large Language Models with Complementary Answer Heuristics for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> demonstrates some testing samples from different knowledge categories. In the 1st-3rd columns, we show the correctly answered samples with different prediction behaviors (<em id="A2.p4.2.1" class="ltx_emph ltx_font_italic">i.e.</em>, keep top-1, in top 2-<math id="A2.p4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.p4.1.m1.1a"><mi id="A2.p4.1.m1.1.1" xref="A2.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.p4.1.m1.1b"><ci id="A2.p4.1.m1.1.1.cmml" xref="A2.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.1.m1.1c">K</annotation></semantics></math>, and beyond top-<math id="A2.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A2.p4.2.m2.1a"><mi id="A2.p4.2.m2.1.1" xref="A2.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.p4.2.m2.1b"><ci id="A2.p4.2.m2.1.1.cmml" xref="A2.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.2.m2.1c">K</annotation></semantics></math>). The visualized results indicate that Prophet can adaptively choose suitable answers from candidates. In the last column, we show some failure samples, implying that there is still room for future improvement.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal,
A. Neelakantan, P. Shyam, G. Sastry, A. Askell <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Language
models are few-shot learners,” in <em id="bib.bib1.2.2" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2020, pp. 1877–1901.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
J.-B. Alayrac, J. Donahue, P. Luc, A. Miech, I. Barr, Y. Hasson, K. Lenc,
A. Mensch, K. Millican, M. Reynolds <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Flamingo: a visual
language model for few-shot learning,” in <em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
L. Yuan, D. Chen, Y.-L. Chen, N. Codella, X. Dai, J. Gao, H. Hu, X. Huang,
B. Li, C. Li <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Florence: A new foundation model for computer
vision,” <em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2111.11432</em>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
W. Wang, H. Bao, L. Dong, and F. Wei, “Vlmo: Unified vision-language
pre-training with mixture-of-modality-experts,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
P. Wang, Q. Wu, C. Shen, A. Dick, and A. Van Den Hengel, “Fvqa: Fact-based
visual question answering,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE TPAMI</em>, vol. 40, no. 10, pp.
2413–2427, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
P. Wang, Q. Wu, C. Shen, A. R. Dick, and A. van den Hengel, “Explicit
knowledge-based reasoning for visual question answering,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">IJCAI</em>,
2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
K. Marino, M. Rastegari, A. Farhadi, and R. Mottaghi, “Ok-vqa: A visual
question answering benchmark requiring external knowledge,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">CVPR</em>,
2019, pp. 3195–3204.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
D. Schwenk, A. Khandelwal, C. Clark, K. Marino, and R. Mottaghi, “A-okvqa: A
benchmark for visual question answering using world knowledge,” in
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">ECCV</em>.   Springer, 2022, pp.
146–162.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
H. Liu and P. Singh, “Conceptnet: a practical commonsense reasoning
tool-kit,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">BT technology journal</em>, vol. 22, no. 4, pp. 211–226, 2004.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Z. Zhu, J. Yu, Y. Wang, Y. Sun, Y. Hu, and Q. Wu, “Mucko: Multi-layer
cross-modal knowledge reasoning for fact-based visual question answering,”
in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IJCAI</em>, 2020, pp. 1097–1103.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
K. Marino, X. Chen, D. Parikh, A. Gupta, and M. Rohrbach, “Krisp: Integrating
implicit and symbolic knowledge for open-domain knowledge-based vqa,” in
<em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021, pp. 14 111–14 121.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Wu, J. Lu, A. Sabharwal, and R. Mottaghi, “Multi-modal answer validation
for knowledge-based vqa,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">AAAI</em>, 2022, pp. 2712–2721.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
F. Gao, Q. Ping, G. Thattai, A. Reganti, Y. N. Wu, and P. Natarajan,
“Transform-retrieve-generate: Natural language-centric outside-knowledge
visual question answering,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022, pp. 5067–5077.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y. Ding, J. Yu, B. Liu, Y. Hu, M. Cui, and Q. Wu, “Mukea: Multimodal knowledge
extraction and accumulation for knowledge-based visual question answering,”
in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022, pp. 5089–5098.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Z. Yang, Z. Gan, J. Wang, X. Hu, Y. Lu, Z. Liu, and L. Wang, “An empirical
study of gpt-3 for few-shot knowledge-based vqa,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">AAAI</em>, 2022, pp.
3081–3089.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
L. Gui, B. Wang, Q. Huang, A. Hauptmann, Y. Bisk, and J. Gao, “Kat: A
knowledge augmented transformer for vision-and-language,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">NAACL</em>,
2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y. Lin, Y. Xie, D. Chen, Y. Xu, C. Zhu, and L. Yuan, “REVIVE: Regional
visual representation matters in knowledge-based visual question answering,”
in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Z. Yu, J. Yu, Y. Cui, D. Tao, and Q. Tian, “Deep modular co-attention networks
for visual question answering,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2019, pp. 6281–6290.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
C. Li, H. Xu, J. Tian, W. Wang, M. Yan, B. Bi, J. Ye, H. Chen, G. Xu, Z. Cao
<em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “mplug: Effective and efficient vision-language learning by
cross-modal skip-connections,” in <em id="bib.bib19.2.2" class="ltx_emph ltx_font_italic">EMNLP</em>, 2022, pp. 7241–7259.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. Touvron, T. Lavril, G. Izacard, X. Martinet, M.-A. Lachaux, T. Lacroix,
B. Rozière, N. Goyal, E. Hambro, F. Azhar <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Llama: Open
and efficient foundation language models,” <em id="bib.bib20.2.2" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2302.13971</em>, 2023.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
G. Penedo, Q. Malartic, D. Hesslow, R. Cojocaru, A. Cappelli, H. Alobeidli,
B. Pannier, E. Almazrouei, and J. Launay, “The refinedweb dataset for falcon
llm: outperforming curated corpora with web data, and web data only,”
<em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.01116</em>, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Z. Shao, Z. Yu, M. Wang, and J. Yu, “Prompting large language models with
answer heuristics for knowledge-based visual question answering,” in
<em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2023, pp. 14 974–14 983.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
P. Lu, S. Mishra, T. Xia, L. Qiu, K.-W. Chang, S.-C. Zhu, O. Tafjord, P. Clark,
and A. Kalyan, “Learn to explain: Multimodal reasoning via thought chains
for science question answering,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022, pp. 2507–2521.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
A. Singh, V. Natarajan, M. Shah, Y. Jiang, X. Chen, D. Batra, D. Parikh, and
M. Rohrbach, “Towards vqa models that can read,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2019, pp.
8317–8326.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
P. Anderson, X. He, C. Buehler, D. Teney, M. Johnson, S. Gould, and L. Zhang,
“Bottom-up and top-down attention for image captioning and visual question
answering,” in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2018, pp. 6077–6086.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
P. Zhang, X. Li, X. Hu, J. Yang, L. Zhang, L. Wang, Y. Choi, and J. Gao,
“Vinvl: Revisiting visual representations in vision-language models,” in
<em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021, pp. 5579–5588.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
S. Shen, L. H. Li, H. Tan, M. Bansal, A. Rohrbach, K.-W. Chang, Z. Yao, and
K. Keutzer, “How much can clip benefit vision-and-language tasks?”
<em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
R. Hu, J. Andreas, M. Rohrbach, T. Darrell, and K. Saenko, “Learning to
reason: End-to-end module networks for visual question answering,” in
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2017, pp. 804–813.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
J.-H. Kim, J. Jun, and B.-T. Zhang, “Bilinear attention networks,”
<em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, vol. 31, 2018.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
L. Li, Z. Gan, Y. Cheng, and J. Liu, “Relation-aware graph attention network
for visual question answering,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2019, pp. 10 313–10 322.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
J. Li, D. Li, C. Xiong, and S. Hoi, “Blip: Bootstrapping language-image
pre-training for unified vision-language understanding and generation,”
<em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2022.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
J. Lu, D. Batra, D. Parikh, and S. Lee, “Vilbert: Pretraining task-agnostic
visiolinguistic representations for vision-and-language tasks,” in
<em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2019.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
H. Tan and M. Bansal, “Lxmert: Learning cross-modality encoder representations
from transformers,” <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Y.-C. Chen, L. Li, L. Yu, A. El Kholy, F. Ahmed, Z. Gan, Y. Cheng, and J. Liu,
“Uniter: Universal image-text representation learning,” in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">ECCV</em>,
2020, pp. 104–120.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Y. Cui, Z. Yu, C. Wang, Z. Zhao, J. Zhang, M. Wang, and J. Yu, “Rosita:
Enhancing vision-and-language semantic alignments via cross-and intra-modal
knowledge integration,” in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">ACM MM</em>, 2021, pp. 797–806.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
Ł. Kaiser, and I. Polosukhin, “Attention is all you need,”
<em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
P. Wang, A. Yang, R. Men, J. Lin, S. Bai, Z. Li, J. Ma, C. Zhou, J. Zhou, and
H. Yang, “OFA: unifying architectures, tasks, and modalities through a
simple sequence-to-sequence learning framework,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2022, pp.
21 218–23 340.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
J. Yu, Z. Wang, V. Vasudevan, L. Yeung, M. Seyedhosseini, and Y. Wu, “Coca:
Contrastive captioners are image-text foundation models,” <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">TMLR</em>, 2022.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
J. Johnson, B. Hariharan, L. Van Der Maaten, L. Fei-Fei, C. Lawrence Zitnick,
and R. Girshick, “Clevr: A diagnostic dataset for compositional language and
elementary visual reasoning,” in <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017, pp. 2901–2910.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
D. A. Hudson and C. D. Manning, “Gqa: A new dataset for real-world visual
reasoning and compositional question answering,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2019, pp.
6700–6709.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
D. Vrandečić and M. Krötzsch, “Wikidata: A free collaborative
knowledgebase,” <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>, vol. 57, no. 10, pp.
78–85, 2014.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
M. Luo, Y. Zeng, P. Banerjee, and C. Baral, “Weakly-supervised
visual-retriever-reader for knowledge-based question answering,”
<em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, pp. 6417–6431, 2021.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Y. Hu, H. Hua, Z. Yang, W. Shi, N. A. Smith, and J. Luo, “Promptcap:
Prompt-guided image captioning for vqa with gpt-3,” in <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2023,
pp. 2963–2975.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova, “Bert: Pre-training of deep
bidirectional transformers for language understanding,” in <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">NAACL</em>,
2019, pp. 4171–4186.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
I. Sutskever, O. Vinyals, and Q. V. Le, “Sequence to sequence learning with
neural networks,” in <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2014.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
J. Yu, J. Li, Z. Yu, and Q. Huang, “Multimodal transformer with multi-view
visual representation for image captioning,” <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Circuits
Syst. Video Technol.</em>, vol. 30, no. 12, pp. 4467–4480, 2020.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Y. Goyal, T. Khot, D. Summers-Stay, D. Batra, and D. Parikh, “Making the V
in VQA matter: Elevating the role of image understanding in Visual
Question Answering,” in <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Z. Yang, Y. Lu, J. Wang, X. Yin, D. Florencio, L. Wang, C. Zhang, L. Zhang, and
J. Luo, “Tap: Text-aware pre-training for text-vqa and text-caption,” in
<em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021, pp. 8751–8761.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
A. F. Biten, R. Litman, Y. Xie, S. Appalaraju, and R. Manmatha, “Latr:
Layout-aware transformer for scene-text vqa,” in <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022, pp.
16 548–16 558.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
A. F. Biten, R. Tito, A. Mafla, L. Gomez, M. Rusinol, E. Valveny, C. Jawahar,
and D. Karatzas, “Scene text visual question answering,” in <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">ICCV</em>,
2019, pp. 4291–4301.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry,
A. Askell, P. Mishkin, J. Clark <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Learning transferable visual
models from natural language supervision,” in <em id="bib.bib51.2.2" class="ltx_emph ltx_font_italic">ICML</em>, 2021, pp.
8748–8763.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
R. Krishna, Y. Zhu, O. Groth, J. Johnson, K. Hata, J. Kravitz, S. Chen,
Y. Kalantidis, L.-J. Li, D. A. Shamma <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Visual genome:
Connecting language and vision using crowdsourced dense image annotations,”
<em id="bib.bib52.2.2" class="ltx_emph ltx_font_italic">IJCV</em>, vol. 123, no. 1, pp. 32–73, 2017.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
H. Touvron, L. Martin, K. Stone, P. Albert, A. Almahairi, Y. Babaei,
N. Bashlykov, S. Batra, P. Bhargava, S. Bhosale <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Llama 2:
Open foundation and fine-tuned chat models,” <em id="bib.bib53.2.2" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2307.09288</em>, 2023.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
M. AI, “Mistral 7b,” <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.06825</em>, 2023.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
L. Ouyang, J. Wu, X. Jiang, D. Almeida, C. Wainwright, P. Mishkin, C. Zhang,
S. Agarwal, K. Slama, A. Ray <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Training language models to
follow instructions with human feedback,” in <em id="bib.bib55.2.2" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022, pp.
27 730–27 744.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
F. Gardères, M. Ziaeefard, B. Abeloos, and F. Lecue, “Conceptbert:
Concept-aware representation for visual question answering,” in
<em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, 2020, pp. 489–498.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
J. Lu, C. Clark, R. Zellers, R. Mottaghi, and A. Kembhavi, “Unified-io: A
unified model for vision, language, and multi-modal tasks,” <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2206.08916</em>, 2022.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
X. Chen, X. Wang, S. Changpinyo, A. Piergiovanni, P. Padlewski, D. Salz,
S. Goodman, A. Grycner, B. Mustafa, L. Beyer <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Pali: A
jointly-scaled multilingual language-image model,” in <em id="bib.bib58.2.2" class="ltx_emph ltx_font_italic">ICLR</em>, 2023.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Y. Guo, L. Nie, Y. Wong, Y. Liu, Z. Cheng, and M. Kankanhalli, “A unified
end-to-end retriever-reader framework for knowledge-based vqa,” in <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">ACM
MM</em>, 2022, pp. 2061–2069.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
H. Liu, C. Li, Q. Wu, and Y. J. Lee, “Visual instruction tuning,” <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2304.08485</em>, 2023.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
P. Lu, B. Peng, H. Cheng, M. Galley, K.-W. Chang, Y. N. Wu, S.-C. Zhu, and
J. Gao, “Chameleon: Plug-and-play compositional reasoning with large
language models,” <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.09842</em>, 2023.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
W. Dai, J. Li, D. Li, A. M. H. Tiong, J. Zhao, W. Wang, B. Li, P. Fung, and
S. Hoi, “Instructblip: Towards general-purpose vision-language models with
instruction tuning,” 2023.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
R. Zhang, J. Han, A. Zhou, X. Hu, S. Yan, P. Lu, H. Li, P. Gao, and Y. Qiao,
“Llama-adapter: Efficient fine-tuning of language models with zero-init
attention,” <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.16199</em>, 2023.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Z. Zhang, A. Zhang, M. Li, H. Zhao, G. Karypis, and A. Smola, “Multimodal
chain-of-thought reasoning in language models,” <em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2302.00923</em>, 2023.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
R. Hu, A. Singh, T. Darrell, and M. Rohrbach, “Iterative answer prediction
with pointer-augmented multimodal transformers for textvqa,” in <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">CVPR</em>,
2020.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
J. Wang, M. Gao, Y. Hu, R. R. Selvaraju, C. Ramaiah, R. Xu, J. F. JaJa, and
L. S. Davis, “Tag: Boosting text-vqa via text-aware visual question-answer
generation,” 2022.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
J. Ye, A. Hu, H. Xu, Q. Ye, M. Yan, Y. Dan, C. Zhao, G. Xu, C. Li, J. Tian
<em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “mplug-docowl: Modularized multimodal large language model
for document understanding,” <em id="bib.bib67.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.02499</em>, 2023.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
W. Huang, C. Wang, R. Zhang, Y. Li, J. Wu, and L. Fei-Fei, “Voxposer:
Composable 3d value maps for robotic manipulation with language models,”
<em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.05973</em>, 2023.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
J. Yang, H. Zhang, F. Li, X. Zou, C. Li, and J. Gao, “Set-of-mark prompting
unleashes extraordinary visual grounding in gpt-4v,” <em id="bib.bib69.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2310.11441</em>, 2023.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
J. Su, Y. Lu, S. Pan, B. Wen, and Y. Liu, “Roformer: Enhanced transformer with
rotary position embedding,” <em id="bib.bib70.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.09864</em>, 2021.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.01902" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.01903" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.01903">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.01903" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.01904" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 22:09:29 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
