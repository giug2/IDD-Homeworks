<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2101.08978] Visual Question Answering based on Local-Scene-Aware Referring Expression Generation</title><meta property="og:description" content="Visual question answering requires a deep understanding of both images and natural language. However, most methods mainly focus on visual concept; such as the relationships between various objects.
The limited use of o…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Visual Question Answering based on Local-Scene-Aware Referring Expression Generation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Visual Question Answering based on Local-Scene-Aware Referring Expression Generation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2101.08978">

<!--Generated on Sat Mar  2 19:32:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Visual Question Answering based on Local-Scene-Aware Referring Expression Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jung-Jun Kim<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Equally contributed</span></span></span>
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dong-Gyu Lee<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Equally contributed</span></span></span>
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jialin Wu
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hong-Gyu Jung
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Seong-Whan Lee
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:sw.lee@korea.ac.kr">sw.lee@korea.ac.kr</a>
</span>
<span class="ltx_contact ltx_role_address">Department of Brain and Cognitive Engineering, Korea University, 
<br class="ltx_break">Anam-dong, Seongbuk-gu, Seoul 02841, Korea
</span>
<span class="ltx_contact ltx_role_address">Department of Artificial Intelligence, Kyungpook National University,
<br class="ltx_break">Daehak-ro, Buk-gu, Daegu 41566, Korea
</span>
<span class="ltx_contact ltx_role_address">Department of Computer Science, University of Texas at Austin, 
<br class="ltx_break">Austin, TX 78712, United States
</span>
<span class="ltx_contact ltx_role_address">Department of Artificial Intelligence, Korea University,
<br class="ltx_break">Anam-dong, Seongbuk-gu, Seoul 02841, Korea
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Visual question answering requires a deep understanding of both images and natural language. However, most methods mainly focus on visual concept; such as the relationships between various objects.
The limited use of object categories combined with their relationships or simple question embedding is insufficient for representing complex scenes and explaining decisions.
To address this limitation, we propose the use of text expressions generated for images, because such expressions have few structural constraints and can provide richer descriptions of images.
The generated expressions can be incorporated with visual features and question embedding to obtain the question-relevant answer. A joint-embedding multi-head attention network is also proposed to model three different information modalities with co-attention. We quantitatively and qualitatively evaluated the proposed method on the VQA v2 dataset and compared it with state-of-the-art methods in terms of answer prediction. The quality of the generated expressions was also evaluated on the RefCOCO, RefCOCO+, and RefCOCOg datasets. Experimental results demonstrate the effectiveness of the proposed method and reveal that it outperformed all of the competing methods in terms of both quantitative and qualitative results.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Visual question answering, joint-embedding multi-head attention, referring expression generation.

</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_journal"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Neural Networks</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Over the past few years, visual question answering (VQA) has attracted substantial attention from both the computer vision and natural language processing communities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
Compared to the traditional tasks of computer vision or natural language processing, such as object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, tracking <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, face recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, action recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, or machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, the VQA is a challenging task that requires a more fine-grained semantic understanding of both questions and images jointly, as well as common sense knowledge to answer accurately.
The recently collected VQA v2 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> provides complementary pairs of questions and answers.
Each pair includes the same question for two semantically similar images, but the corresponding answers are different.
Because the two images are semantically similar, a VQA model must be able to perform fine-grained reasoning by understanding the details of the scene context to answer questions correctly.
In this paper, we propose a framework that can answer visual questions about a given image and generate human-interpretable textual explanations for answers.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Most VQA research focuses on directly exploiting visual features, such as object attributes or the relationships between objects, to understand images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
Some studies have utilized image captions or descriptive paragraphs to represent the semantic meaning of the image. The semantic understanding with higher-level information of the scene such as contexts and relationships which are difficult to directly extract from low-level features, can be inferred through the descriptive paragraphs. Such textual representations can contain the richer and necessary information to improve model performances <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.
Appropriate captions are highly helpful for VQA, which is demonstrated by the fact VQA models that employ human-annotated captions without images can outperform many VQA models that use image features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">However, representing an image using a single sentence has limitations in terms of expressional power, and it is easy to overlook important attributes or objects when images become complex or when a question asks a model for specific information. Considering a few specific objects with positive pairs yields poor precision and can often generate non-existent objects in complex scenes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To address this issue, we propose a novel speaker module that can produce referring expressions for each specific object. This module is tailored for answer prediction and is aware of local contextual information. The referring expression for a target object, which is a question-relevant object in an image, is generated by considering contextual spatial neighbors. The speaker module can describe detailed local scenes, allowing a VQA model to learn target-object-relevant answers.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2101.08978/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="183" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Visualization of the concept of our proposed approach to VQA. Multiple object expressions for an image are generated using our local-scene-aware speaker module. Then, the VQA model answers questions based on question-relevant object expressions using one of three input modalities.
</figcaption>
</figure>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">As shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, an image can be represented by multiple text expressions for each detected object from object detection. The relationships between multiple objects are efficiently expressed by text. The proposed method predicts the answer “pizza” by simultaneously considering text expressions “woman slicing pizza” as well as the attributes “woman”, “slicing”, and “pizza”. The generated expression “a woman is slicing a pizza” serves as the foundation for the final answer.
Attention mechanisms have been applied in numerous uni-modal deep neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.
In recent studies, the simultaneous learning of co-attention for visual and textual modalities has yielded fine-grained representations of images and questions for VQA tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Inspired by the Transformer model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and Co-attention networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, we designed a joint-embedding multi-head attention (JE-MHA) network, consisting of a combination of three multi-head attention (MHA) modules for learning multi-modal embeddings.
The JE-MHA network takes three types of inputs: visual feature, question and text expressions of an image. Because generated expressions are question-relevant representations, owing to the representational power of the speaker module, a specific semantic understanding of a target image associated with the provided questions allows a VQA model to learn the correct answers to questions.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Overall, our primary contributions can be summarized as follows: (1) we propose a novel speaker module that can contextually understand target objects by considering neighboring objects. This allows us to generate local-scene-aware object text expressions. (2) we designed a VQA framework with the proposed JE-MHA network; this framework can model the question-relevant text expressions with images and questions. (3) the answer prediction performance of the proposed VQA model was validated with complementary pairs. The quality of the generated explanations was also evaluated and compared to that of other methods. The results indicate that the proposed model focuses on important factors for answer prediction.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">The remainder of this paper is organized as follows. In Section 2, we discuss studies related to our work. In Section 3, we provide the details of the proposed methods for VQA and expression generation. In Section 4, we present an analysis of the results of our experiments. Finally, in Section 5, we conclude this paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Visual question answering</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Recent studies on deep learning based VQA systems have used bottom-up visual features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. Such systems detect object attributes using pre-trained detectors, trained on the noisy labeled Visual Genome dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>.
Object-level features help VQA systems attain a semantic understanding of images. One successful approach to VQA is the Transformer model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> with Co-attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. These methods employ a pre-trained text corpus that was collected from a larger corpus in the natural language processing field. A large number of VQA systems have adopted similar ideas of combining attention over visual features and language features to increase model capacity for question-relevant image understanding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Meanwhile, more recently, some researchers have adopted text information as an input modality for VQA, such text is generated from images to supplement the visual relationships between object representations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.
Li <span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_italic">et al. </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> used a pre-trained captioner to generate general captions based on a fixed annotator.
The generated captions for image were fed into an answer predictor in a VQA system. Therefore, these captions were not necessarily relevant to the target questions.
Wu <span id="S2.SS1.p2.1.2" class="ltx_text ltx_font_italic">et al. </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> proposed a question-relevant image captioner to generate captions that are more likely to help the VQA system answer questions. A novel caption-embedding module recognized important words in captions, and produced caption embeddings tailored for answer prediction.
Kim <span id="S2.SS1.p2.1.3" class="ltx_text ltx_font_italic">et al. </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> proposed a visual and textual question answering model to generate caption paragraphs that describe image details to use text as an additional input feature. Their model combines information from text and images via early fusion, late fusion, and later fusion.
However, when a scene becomes complex, image captions can easily disregard important objects. Therefore, it is difficult to represent such scenes accurately. To address this issue, we propose the JE-MHA network, which can consider image, question and expression embeddings, simultaneously. The proposed speaker module generates referring expressions considering local-scene-aware neighboring objects. Common contexts of targets can help identify important objects and their relationships in a complex scene.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Referring expression generation</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Referring expression generation is the task of generating an informative sentence for a particular object in a complex scene. Therefore, referred sentences are more unique and specific than general image captions.
Most studies on referring expressions generation have directly compared the difference of visual attributes, positions and sizes between the target object and positive pairs in the scene <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. The positive pair means that the target object and its pair object belong to the same category, usually the most relevant object within an image, while the negative pair means that the pair object has different categories from the target object <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
Such methods generate sentences regarding particular objects while reducing the ambiguity of expressions between multiple objects in a scene. Therefore, large-scale referring expression generation datasets (RefCOCO ,RefCOCO+ , RefCOCOg) have been developed, for this task <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>.
Mao <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_italic">et al. </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> introduced a max-margin maximum mutual information (MMI) training method that solves the problem of sentence ambiguity and improves the performance of both generation and comprehension tasks.
Their method improved expressive power for both generation and comprehension tasks.
Yu <span id="S2.SS2.p1.1.2" class="ltx_text ltx_font_italic">et al. </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> proposed an explicit encoding method that compares visual feature between objects of the same category in an image. They focused on the most salient objects, rather than general positive pair objects.
Liu <span id="S2.SS2.p1.1.3" class="ltx_text ltx_font_italic">et al. </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> explored the role of attributes of objects and their paired descriptions. Expressions were generated by incorporating visual and learned attributes into the same semantic space.
Yu <span id="S2.SS2.p1.1.4" class="ltx_text ltx_font_italic">et al. </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> proposed a unified framework for both referring expression generation and comprehension tasks. A speaker module and listener module were jointly trained by minimizing the distance between paired objects and sentences mapped in an embedding space.
Tanaka <span id="S2.SS2.p1.1.5" class="ltx_text ltx_font_italic">et al. </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> proposed a method that can be interpreted accurately and quickly by humans. When a target is not salient, their model generates expressions by extracting information from the target and environment. A delicate understanding of scene context is essential for referring expression generation. In this paper, the representational power of detailed object relationships was maximized based on the referring expressions of each target object. This method helps a VQA model understand the context of complex scenes. Additionally, the explanation quality of answers was also increased via referring expression generation.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We present an explainable VQA framework with local-scene-aware referring expression generation. The overall framework is illustrated in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Proposed Method ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. From a given image and question, the speaker module generates referring expressions for each object considering the context of the target object. Three different embedding modalities, namely region of interest (RoI) pooled image embeddings, question embeddings, and expression embeddings are used as inputs for the VQA model. A combination of MHA modules comprises the JE-MHA network, which operates recursively to obtain three final feature vectors. Finally, the answer predictor computes a confidence-level for each answer candidate.</p>
</div>
<div id="S3.F2" class="ltx_figure ltx_transformed_outer" style="width:122.4pt;height:435.5pt;vertical-align:-0.0pt;"><div class="ltx_transformed_inner" style="width:435.5pt;transform:translate(-156.55pt,-156.05pt) rotate(-90deg) ;"><figure><img src="/html/2101.08978/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="128" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overall framework of the proposed VQA system. The JE-MHA network takes RoI pooled image embeddings, question embeddings, and generated expressions as input features. The model simultaneously learns multi-modal attention through a recursive structure and a classifier predicts final answers.</figcaption>
</figure></div></div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Speaker module</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">In this section, we present our approach to generating object expressions that are more detailed and precise for images with crowded backgrounds. The proposed speaker module considers neighboring features to understand the target object’s context. The referring expressions are generated for every object proposal of the object detector to bring as much additional knowledge as possible to answer the given question accurately and to provide a human-interpretable explanation. We also encode context features by calculating visual differences between a target and its neighboring objects.
We discuss local-scene-aware expression generation for each object. The speaker module can generate detailed and precise referring expressions for complex scenes.</p>
</div>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Local scene context with neighbors</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.1" class="ltx_p">Pairs of objects in the same category, which are called positive pairs, have been frequently considered to generate unambiguous referring expressions in recent studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. The same category means that the pair of objects belongs to the same ‘supercategory’. In this paper, we use RefCOCO supercategories <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, which are semantic concepts encompassing several objects under a common theme. For example, the supercategory ‘vehicle’ contains ‘bicycle’, ‘car’, ‘bus’, ‘truck’, etc.
However, in real-world images, there are often many surrounding objects that are not in the same category. The relative locations or sizes of objects are frequently considered to identify positive pairs in an image, but these are insufficient for understanding the overall context of a scene. The context of the surrounding objects can be helpful for generating high-quality referring expressions.</p>
</div>
<div id="S3.SS1.SSS1.p2" class="ltx_para">
<p id="S3.SS1.SSS1.p2.9" class="ltx_p">In this regard, we propose a local-scene-aware referring expression generation method that considers neighboring objects that are associated with target object features.
Instead of utilizing only the locations and sizes of positive pairs of the target, differences in the visual features, locations, and sizes between the target and neighboring objects are extracted as visual comparison features. The explicit encoding of the visual difference between objects in the same category within an image is effective for the target context representation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Thus, we adopt the visual comparison technique to minimize ambiguity by learning the difference between the target and its positive pairs.
This allows the proposed method to understand the discriminative aspects of the target object and leads to more precise expression generation, particularly in the scene with complex background characteristics.
For the object detector, we utilize the Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, to detect objects and extract local-scene-aware features, including targets and neighbors.
We extract five features: the target object <math id="S3.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="o_{i}" display="inline"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><msub id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.1.1.2" xref="S3.SS1.SSS1.p2.1.m1.1.1.2.cmml">o</mi><mi id="S3.SS1.SSS1.p2.1.m1.1.1.3" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><apply id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.2">𝑜</ci><ci id="S3.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">o_{i}</annotation></semantics></math>, global context <math id="S3.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="g_{i}" display="inline"><semantics id="S3.SS1.SSS1.p2.2.m2.1a"><msub id="S3.SS1.SSS1.p2.2.m2.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p2.2.m2.1.1.2" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.cmml">g</mi><mi id="S3.SS1.SSS1.p2.2.m2.1.1.3" xref="S3.SS1.SSS1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.2.m2.1b"><apply id="S3.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2">𝑔</ci><ci id="S3.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.2.m2.1c">g_{i}</annotation></semantics></math> from the entire image, target location/size <math id="S3.SS1.SSS1.p2.3.m3.1" class="ltx_Math" alttext="l_{i}" display="inline"><semantics id="S3.SS1.SSS1.p2.3.m3.1a"><msub id="S3.SS1.SSS1.p2.3.m3.1.1" xref="S3.SS1.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p2.3.m3.1.1.2" xref="S3.SS1.SSS1.p2.3.m3.1.1.2.cmml">l</mi><mi id="S3.SS1.SSS1.p2.3.m3.1.1.3" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.3.m3.1b"><apply id="S3.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.2">𝑙</ci><ci id="S3.SS1.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.3.m3.1c">l_{i}</annotation></semantics></math>, target context (differences in visual features) <math id="S3.SS1.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\delta o_{i}" display="inline"><semantics id="S3.SS1.SSS1.p2.4.m4.1a"><mrow id="S3.SS1.SSS1.p2.4.m4.1.1" xref="S3.SS1.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.SSS1.p2.4.m4.1.1.2" xref="S3.SS1.SSS1.p2.4.m4.1.1.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.4.m4.1.1.1" xref="S3.SS1.SSS1.p2.4.m4.1.1.1.cmml">​</mo><msub id="S3.SS1.SSS1.p2.4.m4.1.1.3" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.4.m4.1.1.3.2" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.2.cmml">o</mi><mi id="S3.SS1.SSS1.p2.4.m4.1.1.3.3" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.4.m4.1b"><apply id="S3.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1"><times id="S3.SS1.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.1"></times><ci id="S3.SS1.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.2">𝛿</ci><apply id="S3.SS1.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.2">𝑜</ci><ci id="S3.SS1.SSS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.4.m4.1c">\delta o_{i}</annotation></semantics></math>, and target location/size context (differences in location/size) <math id="S3.SS1.SSS1.p2.5.m5.1" class="ltx_Math" alttext="\delta l_{i}" display="inline"><semantics id="S3.SS1.SSS1.p2.5.m5.1a"><mrow id="S3.SS1.SSS1.p2.5.m5.1.1" xref="S3.SS1.SSS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p2.5.m5.1.1.2" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.5.m5.1.1.1" xref="S3.SS1.SSS1.p2.5.m5.1.1.1.cmml">​</mo><msub id="S3.SS1.SSS1.p2.5.m5.1.1.3" xref="S3.SS1.SSS1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.5.m5.1.1.3.2" xref="S3.SS1.SSS1.p2.5.m5.1.1.3.2.cmml">l</mi><mi id="S3.SS1.SSS1.p2.5.m5.1.1.3.3" xref="S3.SS1.SSS1.p2.5.m5.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.5.m5.1b"><apply id="S3.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1"><times id="S3.SS1.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.1"></times><ci id="S3.SS1.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2">𝛿</ci><apply id="S3.SS1.SSS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.3.2">𝑙</ci><ci id="S3.SS1.SSS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.5.m5.1c">\delta l_{i}</annotation></semantics></math>.
The global context <math id="S3.SS1.SSS1.p2.6.m6.1" class="ltx_Math" alttext="g_{i}" display="inline"><semantics id="S3.SS1.SSS1.p2.6.m6.1a"><msub id="S3.SS1.SSS1.p2.6.m6.1.1" xref="S3.SS1.SSS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.SSS1.p2.6.m6.1.1.2" xref="S3.SS1.SSS1.p2.6.m6.1.1.2.cmml">g</mi><mi id="S3.SS1.SSS1.p2.6.m6.1.1.3" xref="S3.SS1.SSS1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.6.m6.1b"><apply id="S3.SS1.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1.2">𝑔</ci><ci id="S3.SS1.SSS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.6.m6.1c">g_{i}</annotation></semantics></math> is modeled as the averaged features of objects detected by Faster-RCNN within a scene.
The target object <math id="S3.SS1.SSS1.p2.7.m7.1" class="ltx_Math" alttext="o_{i}" display="inline"><semantics id="S3.SS1.SSS1.p2.7.m7.1a"><msub id="S3.SS1.SSS1.p2.7.m7.1.1" xref="S3.SS1.SSS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.SSS1.p2.7.m7.1.1.2" xref="S3.SS1.SSS1.p2.7.m7.1.1.2.cmml">o</mi><mi id="S3.SS1.SSS1.p2.7.m7.1.1.3" xref="S3.SS1.SSS1.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.7.m7.1b"><apply id="S3.SS1.SSS1.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.SSS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.SSS1.p2.7.m7.1.1.2">𝑜</ci><ci id="S3.SS1.SSS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.SSS1.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.7.m7.1c">o_{i}</annotation></semantics></math> is extracted as an RoI-pooled feature using a region proposal network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The location and size of a target object in an image, which are defined by the <math id="S3.SS1.SSS1.p2.8.m8.2" class="ltx_Math" alttext="x,y" display="inline"><semantics id="S3.SS1.SSS1.p2.8.m8.2a"><mrow id="S3.SS1.SSS1.p2.8.m8.2.3.2" xref="S3.SS1.SSS1.p2.8.m8.2.3.1.cmml"><mi id="S3.SS1.SSS1.p2.8.m8.1.1" xref="S3.SS1.SSS1.p2.8.m8.1.1.cmml">x</mi><mo id="S3.SS1.SSS1.p2.8.m8.2.3.2.1" xref="S3.SS1.SSS1.p2.8.m8.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS1.p2.8.m8.2.2" xref="S3.SS1.SSS1.p2.8.m8.2.2.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.8.m8.2b"><list id="S3.SS1.SSS1.p2.8.m8.2.3.1.cmml" xref="S3.SS1.SSS1.p2.8.m8.2.3.2"><ci id="S3.SS1.SSS1.p2.8.m8.1.1.cmml" xref="S3.SS1.SSS1.p2.8.m8.1.1">𝑥</ci><ci id="S3.SS1.SSS1.p2.8.m8.2.2.cmml" xref="S3.SS1.SSS1.p2.8.m8.2.2">𝑦</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.8.m8.2c">x,y</annotation></semantics></math> coordinates of the top-left and bottom-right corners of the object, as well as its absolute size, are represented as <math id="S3.SS1.SSS1.p2.9.m9.5" class="ltx_Math" alttext="l_{i}=\left[\frac{x_{tl}}{W},\frac{y_{tl}}{H},\frac{x_{br}}{W},\frac{y_{br}}{H},\frac{w_{i}\cdot h_{i}}{W\cdot H}\right]" display="inline"><semantics id="S3.SS1.SSS1.p2.9.m9.5a"><mrow id="S3.SS1.SSS1.p2.9.m9.5.6" xref="S3.SS1.SSS1.p2.9.m9.5.6.cmml"><msub id="S3.SS1.SSS1.p2.9.m9.5.6.2" xref="S3.SS1.SSS1.p2.9.m9.5.6.2.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.5.6.2.2" xref="S3.SS1.SSS1.p2.9.m9.5.6.2.2.cmml">l</mi><mi id="S3.SS1.SSS1.p2.9.m9.5.6.2.3" xref="S3.SS1.SSS1.p2.9.m9.5.6.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p2.9.m9.5.6.1" xref="S3.SS1.SSS1.p2.9.m9.5.6.1.cmml">=</mo><mrow id="S3.SS1.SSS1.p2.9.m9.5.6.3.2" xref="S3.SS1.SSS1.p2.9.m9.5.6.3.1.cmml"><mo id="S3.SS1.SSS1.p2.9.m9.5.6.3.2.1" xref="S3.SS1.SSS1.p2.9.m9.5.6.3.1.cmml">[</mo><mfrac id="S3.SS1.SSS1.p2.9.m9.1.1" xref="S3.SS1.SSS1.p2.9.m9.1.1.cmml"><msub id="S3.SS1.SSS1.p2.9.m9.1.1.2" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.1.1.2.2" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.2.cmml">x</mi><mrow id="S3.SS1.SSS1.p2.9.m9.1.1.2.3" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.3.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.1.1.2.3.2" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.9.m9.1.1.2.3.1" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.9.m9.1.1.2.3.3" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.3.3.cmml">l</mi></mrow></msub><mi id="S3.SS1.SSS1.p2.9.m9.1.1.3" xref="S3.SS1.SSS1.p2.9.m9.1.1.3.cmml">W</mi></mfrac><mo id="S3.SS1.SSS1.p2.9.m9.5.6.3.2.2" xref="S3.SS1.SSS1.p2.9.m9.5.6.3.1.cmml">,</mo><mfrac id="S3.SS1.SSS1.p2.9.m9.2.2" xref="S3.SS1.SSS1.p2.9.m9.2.2.cmml"><msub id="S3.SS1.SSS1.p2.9.m9.2.2.2" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.2.2.2.2" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p2.9.m9.2.2.2.3" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.2.2.2.3.2" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.9.m9.2.2.2.3.1" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.9.m9.2.2.2.3.3" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.3.3.cmml">l</mi></mrow></msub><mi id="S3.SS1.SSS1.p2.9.m9.2.2.3" xref="S3.SS1.SSS1.p2.9.m9.2.2.3.cmml">H</mi></mfrac><mo id="S3.SS1.SSS1.p2.9.m9.5.6.3.2.3" xref="S3.SS1.SSS1.p2.9.m9.5.6.3.1.cmml">,</mo><mfrac id="S3.SS1.SSS1.p2.9.m9.3.3" xref="S3.SS1.SSS1.p2.9.m9.3.3.cmml"><msub id="S3.SS1.SSS1.p2.9.m9.3.3.2" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.3.3.2.2" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.2.cmml">x</mi><mrow id="S3.SS1.SSS1.p2.9.m9.3.3.2.3" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.3.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.3.3.2.3.2" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.9.m9.3.3.2.3.1" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.9.m9.3.3.2.3.3" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.3.3.cmml">r</mi></mrow></msub><mi id="S3.SS1.SSS1.p2.9.m9.3.3.3" xref="S3.SS1.SSS1.p2.9.m9.3.3.3.cmml">W</mi></mfrac><mo id="S3.SS1.SSS1.p2.9.m9.5.6.3.2.4" xref="S3.SS1.SSS1.p2.9.m9.5.6.3.1.cmml">,</mo><mfrac id="S3.SS1.SSS1.p2.9.m9.4.4" xref="S3.SS1.SSS1.p2.9.m9.4.4.cmml"><msub id="S3.SS1.SSS1.p2.9.m9.4.4.2" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.4.4.2.2" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p2.9.m9.4.4.2.3" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.3.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.4.4.2.3.2" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.9.m9.4.4.2.3.1" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.9.m9.4.4.2.3.3" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.3.3.cmml">r</mi></mrow></msub><mi id="S3.SS1.SSS1.p2.9.m9.4.4.3" xref="S3.SS1.SSS1.p2.9.m9.4.4.3.cmml">H</mi></mfrac><mo id="S3.SS1.SSS1.p2.9.m9.5.6.3.2.5" xref="S3.SS1.SSS1.p2.9.m9.5.6.3.1.cmml">,</mo><mfrac id="S3.SS1.SSS1.p2.9.m9.5.5" xref="S3.SS1.SSS1.p2.9.m9.5.5.cmml"><mrow id="S3.SS1.SSS1.p2.9.m9.5.5.2" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.cmml"><msub id="S3.SS1.SSS1.p2.9.m9.5.5.2.2" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.2.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.5.5.2.2.2" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.2.2.cmml">w</mi><mi id="S3.SS1.SSS1.p2.9.m9.5.5.2.2.3" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS1.p2.9.m9.5.5.2.1" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.1.cmml">⋅</mo><msub id="S3.SS1.SSS1.p2.9.m9.5.5.2.3" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.3.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.5.5.2.3.2" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.3.2.cmml">h</mi><mi id="S3.SS1.SSS1.p2.9.m9.5.5.2.3.3" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.3.3.cmml">i</mi></msub></mrow><mrow id="S3.SS1.SSS1.p2.9.m9.5.5.3" xref="S3.SS1.SSS1.p2.9.m9.5.5.3.cmml"><mi id="S3.SS1.SSS1.p2.9.m9.5.5.3.2" xref="S3.SS1.SSS1.p2.9.m9.5.5.3.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS1.p2.9.m9.5.5.3.1" xref="S3.SS1.SSS1.p2.9.m9.5.5.3.1.cmml">⋅</mo><mi id="S3.SS1.SSS1.p2.9.m9.5.5.3.3" xref="S3.SS1.SSS1.p2.9.m9.5.5.3.3.cmml">H</mi></mrow></mfrac><mo id="S3.SS1.SSS1.p2.9.m9.5.6.3.2.6" xref="S3.SS1.SSS1.p2.9.m9.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.9.m9.5b"><apply id="S3.SS1.SSS1.p2.9.m9.5.6.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.6"><eq id="S3.SS1.SSS1.p2.9.m9.5.6.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.6.1"></eq><apply id="S3.SS1.SSS1.p2.9.m9.5.6.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.6.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.9.m9.5.6.2.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.6.2">subscript</csymbol><ci id="S3.SS1.SSS1.p2.9.m9.5.6.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.6.2.2">𝑙</ci><ci id="S3.SS1.SSS1.p2.9.m9.5.6.2.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.6.2.3">𝑖</ci></apply><list id="S3.SS1.SSS1.p2.9.m9.5.6.3.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.6.3.2"><apply id="S3.SS1.SSS1.p2.9.m9.1.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1"><divide id="S3.SS1.SSS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1"></divide><apply id="S3.SS1.SSS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.9.m9.1.1.2.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.p2.9.m9.1.1.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.2">𝑥</ci><apply id="S3.SS1.SSS1.p2.9.m9.1.1.2.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.3"><times id="S3.SS1.SSS1.p2.9.m9.1.1.2.3.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.3.1"></times><ci id="S3.SS1.SSS1.p2.9.m9.1.1.2.3.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p2.9.m9.1.1.2.3.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1.2.3.3">𝑙</ci></apply></apply><ci id="S3.SS1.SSS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.1.1.3">𝑊</ci></apply><apply id="S3.SS1.SSS1.p2.9.m9.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2"><divide id="S3.SS1.SSS1.p2.9.m9.2.2.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2"></divide><apply id="S3.SS1.SSS1.p2.9.m9.2.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.9.m9.2.2.2.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p2.9.m9.2.2.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.2">𝑦</ci><apply id="S3.SS1.SSS1.p2.9.m9.2.2.2.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.3"><times id="S3.SS1.SSS1.p2.9.m9.2.2.2.3.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.3.1"></times><ci id="S3.SS1.SSS1.p2.9.m9.2.2.2.3.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p2.9.m9.2.2.2.3.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2.2.3.3">𝑙</ci></apply></apply><ci id="S3.SS1.SSS1.p2.9.m9.2.2.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.2.2.3">𝐻</ci></apply><apply id="S3.SS1.SSS1.p2.9.m9.3.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3"><divide id="S3.SS1.SSS1.p2.9.m9.3.3.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3"></divide><apply id="S3.SS1.SSS1.p2.9.m9.3.3.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.9.m9.3.3.2.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS1.p2.9.m9.3.3.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.2">𝑥</ci><apply id="S3.SS1.SSS1.p2.9.m9.3.3.2.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.3"><times id="S3.SS1.SSS1.p2.9.m9.3.3.2.3.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.3.1"></times><ci id="S3.SS1.SSS1.p2.9.m9.3.3.2.3.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.3.2">𝑏</ci><ci id="S3.SS1.SSS1.p2.9.m9.3.3.2.3.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3.2.3.3">𝑟</ci></apply></apply><ci id="S3.SS1.SSS1.p2.9.m9.3.3.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.3.3.3">𝑊</ci></apply><apply id="S3.SS1.SSS1.p2.9.m9.4.4.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4"><divide id="S3.SS1.SSS1.p2.9.m9.4.4.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4"></divide><apply id="S3.SS1.SSS1.p2.9.m9.4.4.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.9.m9.4.4.2.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4.2">subscript</csymbol><ci id="S3.SS1.SSS1.p2.9.m9.4.4.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.2">𝑦</ci><apply id="S3.SS1.SSS1.p2.9.m9.4.4.2.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.3"><times id="S3.SS1.SSS1.p2.9.m9.4.4.2.3.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.3.1"></times><ci id="S3.SS1.SSS1.p2.9.m9.4.4.2.3.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.3.2">𝑏</ci><ci id="S3.SS1.SSS1.p2.9.m9.4.4.2.3.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4.2.3.3">𝑟</ci></apply></apply><ci id="S3.SS1.SSS1.p2.9.m9.4.4.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.4.4.3">𝐻</ci></apply><apply id="S3.SS1.SSS1.p2.9.m9.5.5.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5"><divide id="S3.SS1.SSS1.p2.9.m9.5.5.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5"></divide><apply id="S3.SS1.SSS1.p2.9.m9.5.5.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2"><ci id="S3.SS1.SSS1.p2.9.m9.5.5.2.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.1">⋅</ci><apply id="S3.SS1.SSS1.p2.9.m9.5.5.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.9.m9.5.5.2.2.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p2.9.m9.5.5.2.2.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.2.2">𝑤</ci><ci id="S3.SS1.SSS1.p2.9.m9.5.5.2.2.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p2.9.m9.5.5.2.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.9.m9.5.5.2.3.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p2.9.m9.5.5.2.3.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.3.2">ℎ</ci><ci id="S3.SS1.SSS1.p2.9.m9.5.5.2.3.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS1.p2.9.m9.5.5.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.3"><ci id="S3.SS1.SSS1.p2.9.m9.5.5.3.1.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.3.1">⋅</ci><ci id="S3.SS1.SSS1.p2.9.m9.5.5.3.2.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.3.2">𝑊</ci><ci id="S3.SS1.SSS1.p2.9.m9.5.5.3.3.cmml" xref="S3.SS1.SSS1.p2.9.m9.5.5.3.3">𝐻</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.9.m9.5c">l_{i}=\left[\frac{x_{tl}}{W},\frac{y_{tl}}{H},\frac{x_{br}}{W},\frac{y_{br}}{H},\frac{w_{i}\cdot h_{i}}{W\cdot H}\right]</annotation></semantics></math>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2101.08978/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="135" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>High-level illustration of our speaker module. Each detected object constitutes a target object and its neighbors. The expression generator uses the global context, target object, and neighboring features to generate local-scene-aware text expressions. The LSTM is trained to minimize generation loss with reward loss.
</figcaption>
</figure>
<div id="S3.SS1.SSS1.p3" class="ltx_para">
<p id="S3.SS1.SSS1.p3.3" class="ltx_p">To identify meaningful neighbor objects around a target object, we first eliminate duplicate object detection results using non-maximum suppression (NMS).
After that, we select the <math id="S3.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS1.p3.1.m1.1a"><mi id="S3.SS1.SSS1.p3.1.m1.1.1" xref="S3.SS1.SSS1.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.1.m1.1b"><ci id="S3.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.1.m1.1c">k</annotation></semantics></math>-nearest neighbor objects based on Euclidean distance to extract the local scene context.
Using the selected neighbors, we calculate the target context <math id="S3.SS1.SSS1.p3.2.m2.1" class="ltx_Math" alttext="\delta o_{i}=\frac{1}{k}\sum_{j\neq i}\frac{o_{i}-o_{j}}{\left\|o_{i}-o_{j}\right\|}" display="inline"><semantics id="S3.SS1.SSS1.p3.2.m2.1a"><mrow id="S3.SS1.SSS1.p3.2.m2.1.2" xref="S3.SS1.SSS1.p3.2.m2.1.2.cmml"><mrow id="S3.SS1.SSS1.p3.2.m2.1.2.2" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.1.2.2.2" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.2.m2.1.2.2.1" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.1.cmml">​</mo><msub id="S3.SS1.SSS1.p3.2.m2.1.2.2.3" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.3.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.1.2.2.3.2" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.3.2.cmml">o</mi><mi id="S3.SS1.SSS1.p3.2.m2.1.2.2.3.3" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS1.SSS1.p3.2.m2.1.2.1" xref="S3.SS1.SSS1.p3.2.m2.1.2.1.cmml">=</mo><mrow id="S3.SS1.SSS1.p3.2.m2.1.2.3" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.cmml"><mfrac id="S3.SS1.SSS1.p3.2.m2.1.2.3.2" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.2.cmml"><mn id="S3.SS1.SSS1.p3.2.m2.1.2.3.2.2" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.2.2.cmml">1</mn><mi id="S3.SS1.SSS1.p3.2.m2.1.2.3.2.3" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.2.3.cmml">k</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.2.m2.1.2.3.1" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p3.2.m2.1.2.3.3" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.cmml"><msub id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.cmml"><mo id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.2" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.2.cmml">∑</mo><mrow id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.2" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.2.cmml">j</mi><mo id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.1" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.1.cmml">≠</mo><mi id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.3" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.3.cmml">i</mi></mrow></msub><mfrac id="S3.SS1.SSS1.p3.2.m2.1.1" xref="S3.SS1.SSS1.p3.2.m2.1.1.cmml"><mrow id="S3.SS1.SSS1.p3.2.m2.1.1.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.cmml"><msub id="S3.SS1.SSS1.p3.2.m2.1.1.3.2" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.2.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.1.1.3.2.2" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.2.2.cmml">o</mi><mi id="S3.SS1.SSS1.p3.2.m2.1.1.3.2.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p3.2.m2.1.1.3.1" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.1.cmml">−</mo><msub id="S3.SS1.SSS1.p3.2.m2.1.1.3.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.1.1.3.3.2" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.3.2.cmml">o</mi><mi id="S3.SS1.SSS1.p3.2.m2.1.1.3.3.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.3.3.cmml">j</mi></msub></mrow><mrow id="S3.SS1.SSS1.p3.2.m2.1.1.1.1" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.2" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.2.1.cmml">‖</mo><mrow id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.cmml"><msub id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.2" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.2.cmml">o</mi><mi id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.1" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.2" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.2.cmml">o</mi><mi id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.2.m2.1b"><apply id="S3.SS1.SSS1.p3.2.m2.1.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2"><eq id="S3.SS1.SSS1.p3.2.m2.1.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.1"></eq><apply id="S3.SS1.SSS1.p3.2.m2.1.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.2"><times id="S3.SS1.SSS1.p3.2.m2.1.2.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.1"></times><ci id="S3.SS1.SSS1.p3.2.m2.1.2.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.2">𝛿</ci><apply id="S3.SS1.SSS1.p3.2.m2.1.2.2.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.1.2.2.3.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.1.2.2.3.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.3.2">𝑜</ci><ci id="S3.SS1.SSS1.p3.2.m2.1.2.2.3.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS1.p3.2.m2.1.2.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3"><times id="S3.SS1.SSS1.p3.2.m2.1.2.3.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.1"></times><apply id="S3.SS1.SSS1.p3.2.m2.1.2.3.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.2"><divide id="S3.SS1.SSS1.p3.2.m2.1.2.3.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.2"></divide><cn type="integer" id="S3.SS1.SSS1.p3.2.m2.1.2.3.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.2.2">1</cn><ci id="S3.SS1.SSS1.p3.2.m2.1.2.3.2.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.2.3">𝑘</ci></apply><apply id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3"><apply id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1">subscript</csymbol><sum id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.2"></sum><apply id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3"><neq id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.1"></neq><ci id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.2">𝑗</ci><ci id="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.2.3.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1"><divide id="S3.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1"></divide><apply id="S3.SS1.SSS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3"><minus id="S3.SS1.SSS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.1"></minus><apply id="S3.SS1.SSS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.1.1.3.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.1.1.3.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.2.2">𝑜</ci><ci id="S3.SS1.SSS1.p3.2.m2.1.1.3.2.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.3.2">𝑜</ci><ci id="S3.SS1.SSS1.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.SSS1.p3.2.m2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p3.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.2">norm</csymbol><apply id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1"><minus id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.1"></minus><apply id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.2">𝑜</ci><ci id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.2">𝑜</ci><ci id="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.2.m2.1c">\delta o_{i}=\frac{1}{k}\sum_{j\neq i}\frac{o_{i}-o_{j}}{\left\|o_{i}-o_{j}\right\|}</annotation></semantics></math>, where k is the number of objects selected as neighbors and the target location/size context <math id="S3.SS1.SSS1.p3.3.m3.5" class="ltx_Math" alttext="\delta l_{i}=\left[\frac{\left[\bigtriangleup x_{tl}\right]_{ij}}{w_{i}},\frac{\left[\bigtriangleup y_{tl}\right]_{ij}}{h_{i}},\frac{\left[\bigtriangleup x_{br}\right]_{ij}}{w_{i}},\frac{\left[\bigtriangleup y_{br}\right]_{ij}}{h_{i}},\frac{w_{j}\cdot h_{j}}{w_{i}\cdot h_{i}}\right]" display="inline"><semantics id="S3.SS1.SSS1.p3.3.m3.5a"><mrow id="S3.SS1.SSS1.p3.3.m3.5.6" xref="S3.SS1.SSS1.p3.3.m3.5.6.cmml"><mrow id="S3.SS1.SSS1.p3.3.m3.5.6.2" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.5.6.2.2" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.5.6.2.1" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.1.cmml">​</mo><msub id="S3.SS1.SSS1.p3.3.m3.5.6.2.3" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.5.6.2.3.2" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.3.2.cmml">l</mi><mi id="S3.SS1.SSS1.p3.3.m3.5.6.2.3.3" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS1.SSS1.p3.3.m3.5.6.1" xref="S3.SS1.SSS1.p3.3.m3.5.6.1.cmml">=</mo><mrow id="S3.SS1.SSS1.p3.3.m3.5.6.3.2" xref="S3.SS1.SSS1.p3.3.m3.5.6.3.1.cmml"><mo id="S3.SS1.SSS1.p3.3.m3.5.6.3.2.1" xref="S3.SS1.SSS1.p3.3.m3.5.6.3.1.cmml">[</mo><mfrac id="S3.SS1.SSS1.p3.3.m3.1.1" xref="S3.SS1.SSS1.p3.3.m3.1.1.cmml"><msub id="S3.SS1.SSS1.p3.3.m3.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.cmml"><mrow id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.2.cmml"><mo id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1a" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.cmml">△</mo><msub id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.2" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.2" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.1" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.3" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.3.cmml">l</mi></mrow></msub></mrow><mo id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.3" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS1.SSS1.p3.3.m3.1.1.1.3" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.1.1.1.3.2" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.1.1.1.3.1" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.3.m3.1.1.1.3.3" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.3.3.cmml">j</mi></mrow></msub><msub id="S3.SS1.SSS1.p3.3.m3.1.1.3" xref="S3.SS1.SSS1.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.1.1.3.2" xref="S3.SS1.SSS1.p3.3.m3.1.1.3.2.cmml">w</mi><mi id="S3.SS1.SSS1.p3.3.m3.1.1.3.3" xref="S3.SS1.SSS1.p3.3.m3.1.1.3.3.cmml">i</mi></msub></mfrac><mo id="S3.SS1.SSS1.p3.3.m3.5.6.3.2.2" xref="S3.SS1.SSS1.p3.3.m3.5.6.3.1.cmml">,</mo><mfrac id="S3.SS1.SSS1.p3.3.m3.2.2" xref="S3.SS1.SSS1.p3.3.m3.2.2.cmml"><msub id="S3.SS1.SSS1.p3.3.m3.2.2.1" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.cmml"><mrow id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.2.cmml"><mo id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1a" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.cmml">△</mo><msub id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.2" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.2" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.1" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.3" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.3.cmml">l</mi></mrow></msub></mrow><mo id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.3" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS1.SSS1.p3.3.m3.2.2.1.3" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.2.2.1.3.2" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.2.2.1.3.1" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.3.m3.2.2.1.3.3" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.3.3.cmml">j</mi></mrow></msub><msub id="S3.SS1.SSS1.p3.3.m3.2.2.3" xref="S3.SS1.SSS1.p3.3.m3.2.2.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.2.2.3.2" xref="S3.SS1.SSS1.p3.3.m3.2.2.3.2.cmml">h</mi><mi id="S3.SS1.SSS1.p3.3.m3.2.2.3.3" xref="S3.SS1.SSS1.p3.3.m3.2.2.3.3.cmml">i</mi></msub></mfrac><mo id="S3.SS1.SSS1.p3.3.m3.5.6.3.2.3" xref="S3.SS1.SSS1.p3.3.m3.5.6.3.1.cmml">,</mo><mfrac id="S3.SS1.SSS1.p3.3.m3.3.3" xref="S3.SS1.SSS1.p3.3.m3.3.3.cmml"><msub id="S3.SS1.SSS1.p3.3.m3.3.3.1" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.cmml"><mrow id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.2.cmml"><mo id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1a" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.cmml">△</mo><msub id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.2" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.2" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.1" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.3" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.3.cmml">r</mi></mrow></msub></mrow><mo id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.3" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS1.SSS1.p3.3.m3.3.3.1.3" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.3.3.1.3.2" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.3.3.1.3.1" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.3.m3.3.3.1.3.3" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.3.3.cmml">j</mi></mrow></msub><msub id="S3.SS1.SSS1.p3.3.m3.3.3.3" xref="S3.SS1.SSS1.p3.3.m3.3.3.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.3.3.3.2" xref="S3.SS1.SSS1.p3.3.m3.3.3.3.2.cmml">w</mi><mi id="S3.SS1.SSS1.p3.3.m3.3.3.3.3" xref="S3.SS1.SSS1.p3.3.m3.3.3.3.3.cmml">i</mi></msub></mfrac><mo id="S3.SS1.SSS1.p3.3.m3.5.6.3.2.4" xref="S3.SS1.SSS1.p3.3.m3.5.6.3.1.cmml">,</mo><mfrac id="S3.SS1.SSS1.p3.3.m3.4.4" xref="S3.SS1.SSS1.p3.3.m3.4.4.cmml"><msub id="S3.SS1.SSS1.p3.3.m3.4.4.1" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.cmml"><mrow id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.2.cmml"><mo id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1a" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.cmml">△</mo><msub id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.2" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.2" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.1" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.3" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.3.cmml">r</mi></mrow></msub></mrow><mo id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.3" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS1.SSS1.p3.3.m3.4.4.1.3" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.4.4.1.3.2" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.3.m3.4.4.1.3.1" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.3.m3.4.4.1.3.3" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.3.3.cmml">j</mi></mrow></msub><msub id="S3.SS1.SSS1.p3.3.m3.4.4.3" xref="S3.SS1.SSS1.p3.3.m3.4.4.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.4.4.3.2" xref="S3.SS1.SSS1.p3.3.m3.4.4.3.2.cmml">h</mi><mi id="S3.SS1.SSS1.p3.3.m3.4.4.3.3" xref="S3.SS1.SSS1.p3.3.m3.4.4.3.3.cmml">i</mi></msub></mfrac><mo id="S3.SS1.SSS1.p3.3.m3.5.6.3.2.5" xref="S3.SS1.SSS1.p3.3.m3.5.6.3.1.cmml">,</mo><mfrac id="S3.SS1.SSS1.p3.3.m3.5.5" xref="S3.SS1.SSS1.p3.3.m3.5.5.cmml"><mrow id="S3.SS1.SSS1.p3.3.m3.5.5.2" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.cmml"><msub id="S3.SS1.SSS1.p3.3.m3.5.5.2.2" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.2.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.5.5.2.2.2" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.2.2.cmml">w</mi><mi id="S3.SS1.SSS1.p3.3.m3.5.5.2.2.3" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS1.p3.3.m3.5.5.2.1" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.1.cmml">⋅</mo><msub id="S3.SS1.SSS1.p3.3.m3.5.5.2.3" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.5.5.2.3.2" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.3.2.cmml">h</mi><mi id="S3.SS1.SSS1.p3.3.m3.5.5.2.3.3" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.3.3.cmml">j</mi></msub></mrow><mrow id="S3.SS1.SSS1.p3.3.m3.5.5.3" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.cmml"><msub id="S3.SS1.SSS1.p3.3.m3.5.5.3.2" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.2.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.5.5.3.2.2" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.2.2.cmml">w</mi><mi id="S3.SS1.SSS1.p3.3.m3.5.5.3.2.3" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS1.p3.3.m3.5.5.3.1" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.1.cmml">⋅</mo><msub id="S3.SS1.SSS1.p3.3.m3.5.5.3.3" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.3.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.5.5.3.3.2" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.3.2.cmml">h</mi><mi id="S3.SS1.SSS1.p3.3.m3.5.5.3.3.3" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.3.3.cmml">i</mi></msub></mrow></mfrac><mo id="S3.SS1.SSS1.p3.3.m3.5.6.3.2.6" xref="S3.SS1.SSS1.p3.3.m3.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.3.m3.5b"><apply id="S3.SS1.SSS1.p3.3.m3.5.6.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6"><eq id="S3.SS1.SSS1.p3.3.m3.5.6.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.1"></eq><apply id="S3.SS1.SSS1.p3.3.m3.5.6.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.2"><times id="S3.SS1.SSS1.p3.3.m3.5.6.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.5.6.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.2">𝛿</ci><apply id="S3.SS1.SSS1.p3.3.m3.5.6.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.5.6.2.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.5.6.2.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.3.2">𝑙</ci><ci id="S3.SS1.SSS1.p3.3.m3.5.6.2.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.2.3.3">𝑖</ci></apply></apply><list id="S3.SS1.SSS1.p3.3.m3.5.6.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.6.3.2"><apply id="S3.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1"><divide id="S3.SS1.SSS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1"></divide><apply id="S3.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1"><ci id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1">△</ci><apply id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.2">𝑥</ci><apply id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3"><times id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.1.1.1.2.3.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.1.1.1.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.3"><times id="S3.SS1.SSS1.p3.3.m3.1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.3.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS1.p3.3.m3.1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.3.2">𝑤</ci><ci id="S3.SS1.SSS1.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2"><divide id="S3.SS1.SSS1.p3.3.m3.2.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2"></divide><apply id="S3.SS1.SSS1.p3.3.m3.2.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.2.2.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1">subscript</csymbol><apply id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1"><ci id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1">△</ci><apply id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.2">𝑦</ci><apply id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3"><times id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.2.3.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.2.2.1.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.3"><times id="S3.SS1.SSS1.p3.3.m3.2.2.1.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.3.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.2.2.1.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.3.2">𝑖</ci><ci id="S3.SS1.SSS1.p3.3.m3.2.2.1.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.1.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.2.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.2.2.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.2.2.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.3.2">ℎ</ci><ci id="S3.SS1.SSS1.p3.3.m3.2.2.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3"><divide id="S3.SS1.SSS1.p3.3.m3.3.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3"></divide><apply id="S3.SS1.SSS1.p3.3.m3.3.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.3.3.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1">subscript</csymbol><apply id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1"><ci id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1">△</ci><apply id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.2">𝑥</ci><apply id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3"><times id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.2">𝑏</ci><ci id="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.1.1.1.2.3.3">𝑟</ci></apply></apply></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.3.3.1.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.3"><times id="S3.SS1.SSS1.p3.3.m3.3.3.1.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.3.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.3.3.1.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.3.2">𝑖</ci><ci id="S3.SS1.SSS1.p3.3.m3.3.3.1.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.1.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.3.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.3.3.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.3.3.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.3.2">𝑤</ci><ci id="S3.SS1.SSS1.p3.3.m3.3.3.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.3.3.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.4.4.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4"><divide id="S3.SS1.SSS1.p3.3.m3.4.4.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4"></divide><apply id="S3.SS1.SSS1.p3.3.m3.4.4.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.4.4.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1">subscript</csymbol><apply id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1"><ci id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1">△</ci><apply id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.2">𝑦</ci><apply id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3"><times id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.2">𝑏</ci><ci id="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.1.1.1.2.3.3">𝑟</ci></apply></apply></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.4.4.1.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.3"><times id="S3.SS1.SSS1.p3.3.m3.4.4.1.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.3.1"></times><ci id="S3.SS1.SSS1.p3.3.m3.4.4.1.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.3.2">𝑖</ci><ci id="S3.SS1.SSS1.p3.3.m3.4.4.1.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.1.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.4.4.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.4.4.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.4.4.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.3.2">ℎ</ci><ci id="S3.SS1.SSS1.p3.3.m3.4.4.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.4.4.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.5.5.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5"><divide id="S3.SS1.SSS1.p3.3.m3.5.5.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5"></divide><apply id="S3.SS1.SSS1.p3.3.m3.5.5.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2"><ci id="S3.SS1.SSS1.p3.3.m3.5.5.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.1">⋅</ci><apply id="S3.SS1.SSS1.p3.3.m3.5.5.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.5.5.2.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.5.5.2.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.2.2">𝑤</ci><ci id="S3.SS1.SSS1.p3.3.m3.5.5.2.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.2.3">𝑗</ci></apply><apply id="S3.SS1.SSS1.p3.3.m3.5.5.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.5.5.2.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.5.5.2.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.3.2">ℎ</ci><ci id="S3.SS1.SSS1.p3.3.m3.5.5.2.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.SSS1.p3.3.m3.5.5.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3"><ci id="S3.SS1.SSS1.p3.3.m3.5.5.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.1">⋅</ci><apply id="S3.SS1.SSS1.p3.3.m3.5.5.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.5.5.3.2.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.5.5.3.2.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.2.2">𝑤</ci><ci id="S3.SS1.SSS1.p3.3.m3.5.5.3.2.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p3.3.m3.5.5.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.5.5.3.3.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.5.5.3.3.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.3.2">ℎ</ci><ci id="S3.SS1.SSS1.p3.3.m3.5.5.3.3.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.5.5.3.3.3">𝑖</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.3.m3.5c">\delta l_{i}=\left[\frac{\left[\bigtriangleup x_{tl}\right]_{ij}}{w_{i}},\frac{\left[\bigtriangleup y_{tl}\right]_{ij}}{h_{i}},\frac{\left[\bigtriangleup x_{br}\right]_{ij}}{w_{i}},\frac{\left[\bigtriangleup y_{br}\right]_{ij}}{h_{i}},\frac{w_{j}\cdot h_{j}}{w_{i}\cdot h_{i}}\right]</annotation></semantics></math>, which represents the relative location and size of the target object among the neighbor objects.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Referring expression generation</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.6" class="ltx_p">The local-scene-aware visual representation <math id="S3.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS1.SSS2.p1.1.m1.1a"><msub id="S3.SS1.SSS2.p1.1.m1.1.1" xref="S3.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.1.1.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.2.cmml">v</mi><mi id="S3.SS1.SSS2.p1.1.m1.1.1.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.1.m1.1b"><apply id="S3.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.2">𝑣</ci><ci id="S3.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.1.m1.1c">v_{i}</annotation></semantics></math> that is used to generate discriminative sentences is a combination of the five aforementioned image features and is defined as <math id="S3.SS1.SSS2.p1.2.m2.5" class="ltx_Math" alttext="v_{i}=W_{m}[o_{i},g_{i},l_{i},\delta o_{i},\delta l_{i}]" display="inline"><semantics id="S3.SS1.SSS2.p1.2.m2.5a"><mrow id="S3.SS1.SSS2.p1.2.m2.5.5" xref="S3.SS1.SSS2.p1.2.m2.5.5.cmml"><msub id="S3.SS1.SSS2.p1.2.m2.5.5.7" xref="S3.SS1.SSS2.p1.2.m2.5.5.7.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.5.5.7.2" xref="S3.SS1.SSS2.p1.2.m2.5.5.7.2.cmml">v</mi><mi id="S3.SS1.SSS2.p1.2.m2.5.5.7.3" xref="S3.SS1.SSS2.p1.2.m2.5.5.7.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p1.2.m2.5.5.6" xref="S3.SS1.SSS2.p1.2.m2.5.5.6.cmml">=</mo><mrow id="S3.SS1.SSS2.p1.2.m2.5.5.5" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.cmml"><msub id="S3.SS1.SSS2.p1.2.m2.5.5.5.7" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.7.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.5.5.5.7.2" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.7.2.cmml">W</mi><mi id="S3.SS1.SSS2.p1.2.m2.5.5.5.7.3" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.7.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.2.m2.5.5.5.6" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.6.cmml">​</mo><mrow id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.6.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.6" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.6.cmml">[</mo><msub id="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.2.cmml">o</mi><mi id="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.7" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.6.cmml">,</mo><msub id="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2" xref="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.2" xref="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.2.cmml">g</mi><mi id="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.3" xref="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.8" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.6.cmml">,</mo><msub id="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3" xref="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.2" xref="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.2.cmml">l</mi><mi id="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.3" xref="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.9" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.6.cmml">,</mo><mrow id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.2" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.1" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.1.cmml">​</mo><msub id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.2" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.2.cmml">o</mi><mi id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.3" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.10" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.6.cmml">,</mo><mrow id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.2" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.1" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.1.cmml">​</mo><msub id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.2" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.2.cmml">l</mi><mi id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.3" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.11" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.6.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.2.m2.5b"><apply id="S3.SS1.SSS2.p1.2.m2.5.5.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5"><eq id="S3.SS1.SSS2.p1.2.m2.5.5.6.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.6"></eq><apply id="S3.SS1.SSS2.p1.2.m2.5.5.7.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.7"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.5.5.7.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.7">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.5.5.7.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.7.2">𝑣</ci><ci id="S3.SS1.SSS2.p1.2.m2.5.5.7.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.7.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p1.2.m2.5.5.5.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5"><times id="S3.SS1.SSS2.p1.2.m2.5.5.5.6.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.6"></times><apply id="S3.SS1.SSS2.p1.2.m2.5.5.5.7.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.7"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.5.5.5.7.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.7">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.5.5.5.7.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.7.2">𝑊</ci><ci id="S3.SS1.SSS2.p1.2.m2.5.5.5.7.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.7.3">𝑚</ci></apply><list id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.6.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5"><apply id="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.2">𝑜</ci><ci id="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.2">𝑔</ci><ci id="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.2">𝑙</ci><ci id="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.3.3.3.3.3.3.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.cmml" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4"><times id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.1"></times><ci id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.2">𝛿</ci><apply id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.2">𝑜</ci><ci id="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.4.4.4.4.4.4.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5"><times id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.1"></times><ci id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.2">𝛿</ci><apply id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.2">𝑙</ci><ci id="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.5.5.5.5.5.5.3.3">𝑖</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.2.m2.5c">v_{i}=W_{m}[o_{i},g_{i},l_{i},\delta o_{i},\delta l_{i}]</annotation></semantics></math>. To generate object expressions for each referred object, <math id="S3.SS1.SSS2.p1.3.m3.2" class="ltx_Math" alttext="x_{t}=[v_{i};w_{t}]" display="inline"><semantics id="S3.SS1.SSS2.p1.3.m3.2a"><mrow id="S3.SS1.SSS2.p1.3.m3.2.2" xref="S3.SS1.SSS2.p1.3.m3.2.2.cmml"><msub id="S3.SS1.SSS2.p1.3.m3.2.2.4" xref="S3.SS1.SSS2.p1.3.m3.2.2.4.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.2.2.4.2" xref="S3.SS1.SSS2.p1.3.m3.2.2.4.2.cmml">x</mi><mi id="S3.SS1.SSS2.p1.3.m3.2.2.4.3" xref="S3.SS1.SSS2.p1.3.m3.2.2.4.3.cmml">t</mi></msub><mo id="S3.SS1.SSS2.p1.3.m3.2.2.3" xref="S3.SS1.SSS2.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p1.3.m3.2.2.2.2" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.3" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.3.cmml">[</mo><msub id="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.4" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.3.cmml">;</mo><msub id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.2" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.cmml">w</mi><mi id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.3" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.5" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.3.m3.2b"><apply id="S3.SS1.SSS2.p1.3.m3.2.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2"><eq id="S3.SS1.SSS2.p1.3.m3.2.2.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.3"></eq><apply id="S3.SS1.SSS2.p1.3.m3.2.2.4.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.3.m3.2.2.4.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.4">subscript</csymbol><ci id="S3.SS1.SSS2.p1.3.m3.2.2.4.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.4.2">𝑥</ci><ci id="S3.SS1.SSS2.p1.3.m3.2.2.4.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.4.3">𝑡</ci></apply><list id="S3.SS1.SSS2.p1.3.m3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.2"><apply id="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.2">𝑤</ci><ci id="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2.2.2.2.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.3.m3.2c">x_{t}=[v_{i};w_{t}]</annotation></semantics></math> that is a concatenation of <math id="S3.SS1.SSS2.p1.4.m4.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS1.SSS2.p1.4.m4.1a"><msub id="S3.SS1.SSS2.p1.4.m4.1.1" xref="S3.SS1.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p1.4.m4.1.1.2" xref="S3.SS1.SSS2.p1.4.m4.1.1.2.cmml">v</mi><mi id="S3.SS1.SSS2.p1.4.m4.1.1.3" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.4.m4.1b"><apply id="S3.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.2">𝑣</ci><ci id="S3.SS1.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.4.m4.1c">v_{i}</annotation></semantics></math> and a word embedding vector <math id="S3.SS1.SSS2.p1.5.m5.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="S3.SS1.SSS2.p1.5.m5.1a"><msub id="S3.SS1.SSS2.p1.5.m5.1.1" xref="S3.SS1.SSS2.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p1.5.m5.1.1.2" xref="S3.SS1.SSS2.p1.5.m5.1.1.2.cmml">w</mi><mi id="S3.SS1.SSS2.p1.5.m5.1.1.3" xref="S3.SS1.SSS2.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.5.m5.1b"><apply id="S3.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p1.5.m5.1.1.2">𝑤</ci><ci id="S3.SS1.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.5.m5.1c">w_{t}</annotation></semantics></math> is fed into a long short-term memory (LSTM) to minimize the negative log-likelihood with the parameters <math id="S3.SS1.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.SSS2.p1.6.m6.1a"><mi id="S3.SS1.SSS2.p1.6.m6.1.1" xref="S3.SS1.SSS2.p1.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.6.m6.1b"><ci id="S3.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.6.m6.1c">\theta</annotation></semantics></math> as follows:</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E1.m1.3" class="ltx_Math" alttext="L_{s}^{1}(\theta)=-\sum_{i}logP(r_{i}|v_{i};\theta)." display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><msubsup id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2.2" xref="S3.E1.m1.3.3.1.1.3.2.2.2.cmml">L</mi><mi id="S3.E1.m1.3.3.1.1.3.2.2.3" xref="S3.E1.m1.3.3.1.1.3.2.2.3.cmml">s</mi><mn id="S3.E1.m1.3.3.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml">1</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.1" xref="S3.E1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.1" xref="S3.E1.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1a" xref="S3.E1.m1.3.3.1.1.1.cmml">−</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><munder id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E1.m1.3.3.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml">i</mi></munder><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.2a" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.5" xref="S3.E1.m1.3.3.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.2b" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.6" xref="S3.E1.m1.3.3.1.1.1.1.1.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.2c" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><times id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1"></times><apply id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.2">𝐿</ci><ci id="S3.E1.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2.3">𝑠</ci></apply><cn type="integer" id="S3.E1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3">1</cn></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝜃</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><minus id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1"></minus><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2"></sum><ci id="S3.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">𝑙</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.4">𝑜</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.5">𝑔</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.6">𝑃</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><list id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝜃</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">L_{s}^{1}(\theta)=-\sum_{i}logP(r_{i}|v_{i};\theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.SSS2.p3" class="ltx_para">
<p id="S3.SS1.SSS2.p3.7" class="ltx_p">We adopt the maximum mutual information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> constraint that can reduce the ambiguity by minimizing the log-likelihood for positive pairs. Thus, the generated referring expressions for the target object, <math id="S3.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="o_{i}" display="inline"><semantics id="S3.SS1.SSS2.p3.1.m1.1a"><msub id="S3.SS1.SSS2.p3.1.m1.1.1" xref="S3.SS1.SSS2.p3.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p3.1.m1.1.1.2" xref="S3.SS1.SSS2.p3.1.m1.1.1.2.cmml">o</mi><mi id="S3.SS1.SSS2.p3.1.m1.1.1.3" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.1.m1.1b"><apply id="S3.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.2">𝑜</ci><ci id="S3.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.1.m1.1c">o_{i}</annotation></semantics></math>, which is distinguished from the expressions for positive pairs.
There are two constraints; (1) the ground-truth expression <math id="S3.SS1.SSS2.p3.2.m2.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="S3.SS1.SSS2.p3.2.m2.1a"><msub id="S3.SS1.SSS2.p3.2.m2.1.1" xref="S3.SS1.SSS2.p3.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p3.2.m2.1.1.2" xref="S3.SS1.SSS2.p3.2.m2.1.1.2.cmml">r</mi><mi id="S3.SS1.SSS2.p3.2.m2.1.1.3" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.2.m2.1b"><apply id="S3.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.2">𝑟</ci><ci id="S3.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.2.m2.1c">r_{i}</annotation></semantics></math> should be more likely to be generated using the target object <math id="S3.SS1.SSS2.p3.3.m3.1" class="ltx_Math" alttext="o_{i}" display="inline"><semantics id="S3.SS1.SSS2.p3.3.m3.1a"><msub id="S3.SS1.SSS2.p3.3.m3.1.1" xref="S3.SS1.SSS2.p3.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.p3.3.m3.1.1.2" xref="S3.SS1.SSS2.p3.3.m3.1.1.2.cmml">o</mi><mi id="S3.SS1.SSS2.p3.3.m3.1.1.3" xref="S3.SS1.SSS2.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.3.m3.1b"><apply id="S3.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1.2">𝑜</ci><ci id="S3.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.3.m3.1c">o_{i}</annotation></semantics></math> than using any other randomly sampled object <math id="S3.SS1.SSS2.p3.4.m4.1" class="ltx_Math" alttext="o_{k}" display="inline"><semantics id="S3.SS1.SSS2.p3.4.m4.1a"><msub id="S3.SS1.SSS2.p3.4.m4.1.1" xref="S3.SS1.SSS2.p3.4.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p3.4.m4.1.1.2" xref="S3.SS1.SSS2.p3.4.m4.1.1.2.cmml">o</mi><mi id="S3.SS1.SSS2.p3.4.m4.1.1.3" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.4.m4.1b"><apply id="S3.SS1.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.4.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.4.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.2">𝑜</ci><ci id="S3.SS1.SSS2.p3.4.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.4.m4.1c">o_{k}</annotation></semantics></math>. (2) the target object should be more likely to generate the ground-truth expression <math id="S3.SS1.SSS2.p3.5.m5.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="S3.SS1.SSS2.p3.5.m5.1a"><msub id="S3.SS1.SSS2.p3.5.m5.1.1" xref="S3.SS1.SSS2.p3.5.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p3.5.m5.1.1.2" xref="S3.SS1.SSS2.p3.5.m5.1.1.2.cmml">r</mi><mi id="S3.SS1.SSS2.p3.5.m5.1.1.3" xref="S3.SS1.SSS2.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.5.m5.1b"><apply id="S3.SS1.SSS2.p3.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.5.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.5.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p3.5.m5.1.1.2">𝑟</ci><ci id="S3.SS1.SSS2.p3.5.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.5.m5.1c">r_{i}</annotation></semantics></math>, rather than other expressions <math id="S3.SS1.SSS2.p3.6.m6.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS1.SSS2.p3.6.m6.1a"><msub id="S3.SS1.SSS2.p3.6.m6.1.1" xref="S3.SS1.SSS2.p3.6.m6.1.1.cmml"><mi id="S3.SS1.SSS2.p3.6.m6.1.1.2" xref="S3.SS1.SSS2.p3.6.m6.1.1.2.cmml">r</mi><mi id="S3.SS1.SSS2.p3.6.m6.1.1.3" xref="S3.SS1.SSS2.p3.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.6.m6.1b"><apply id="S3.SS1.SSS2.p3.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.6.m6.1.1.1.cmml" xref="S3.SS1.SSS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.6.m6.1.1.2.cmml" xref="S3.SS1.SSS2.p3.6.m6.1.1.2">𝑟</ci><ci id="S3.SS1.SSS2.p3.6.m6.1.1.3.cmml" xref="S3.SS1.SSS2.p3.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.6.m6.1c">r_{j}</annotation></semantics></math> for positive pairs. The marginal loss <math id="S3.SS1.SSS2.p3.7.m7.1" class="ltx_Math" alttext="L_{s}^{2}(\theta)" display="inline"><semantics id="S3.SS1.SSS2.p3.7.m7.1a"><mrow id="S3.SS1.SSS2.p3.7.m7.1.2" xref="S3.SS1.SSS2.p3.7.m7.1.2.cmml"><msubsup id="S3.SS1.SSS2.p3.7.m7.1.2.2" xref="S3.SS1.SSS2.p3.7.m7.1.2.2.cmml"><mi id="S3.SS1.SSS2.p3.7.m7.1.2.2.2.2" xref="S3.SS1.SSS2.p3.7.m7.1.2.2.2.2.cmml">L</mi><mi id="S3.SS1.SSS2.p3.7.m7.1.2.2.2.3" xref="S3.SS1.SSS2.p3.7.m7.1.2.2.2.3.cmml">s</mi><mn id="S3.SS1.SSS2.p3.7.m7.1.2.2.3" xref="S3.SS1.SSS2.p3.7.m7.1.2.2.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p3.7.m7.1.2.1" xref="S3.SS1.SSS2.p3.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS1.SSS2.p3.7.m7.1.2.3.2" xref="S3.SS1.SSS2.p3.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p3.7.m7.1.2.3.2.1" xref="S3.SS1.SSS2.p3.7.m7.1.2.cmml">(</mo><mi id="S3.SS1.SSS2.p3.7.m7.1.1" xref="S3.SS1.SSS2.p3.7.m7.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS1.SSS2.p3.7.m7.1.2.3.2.2" xref="S3.SS1.SSS2.p3.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.7.m7.1b"><apply id="S3.SS1.SSS2.p3.7.m7.1.2.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2"><times id="S3.SS1.SSS2.p3.7.m7.1.2.1.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2.1"></times><apply id="S3.SS1.SSS2.p3.7.m7.1.2.2.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.7.m7.1.2.2.1.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2.2">superscript</csymbol><apply id="S3.SS1.SSS2.p3.7.m7.1.2.2.2.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.7.m7.1.2.2.2.1.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p3.7.m7.1.2.2.2.2.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2.2.2.2">𝐿</ci><ci id="S3.SS1.SSS2.p3.7.m7.1.2.2.2.3.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2.2.2.3">𝑠</ci></apply><cn type="integer" id="S3.SS1.SSS2.p3.7.m7.1.2.2.3.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.2.2.3">2</cn></apply><ci id="S3.SS1.SSS2.p3.7.m7.1.1.cmml" xref="S3.SS1.SSS2.p3.7.m7.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.7.m7.1c">L_{s}^{2}(\theta)</annotation></semantics></math> is calculated as follows:</p>
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.3" class="ltx_Math" alttext="\displaystyle L_{s}^{2}(\theta)=\sum_{i}{\lambda_{1}^{s}max(0,M_{1}+logP(r_{i}|v_{k})-logP(r_{i}|v_{i}))}" display="inline"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml"><mrow id="S3.Ex1.m1.3.3.3" xref="S3.Ex1.m1.3.3.3.cmml"><msubsup id="S3.Ex1.m1.3.3.3.2" xref="S3.Ex1.m1.3.3.3.2.cmml"><mi id="S3.Ex1.m1.3.3.3.2.2.2" xref="S3.Ex1.m1.3.3.3.2.2.2.cmml">L</mi><mi id="S3.Ex1.m1.3.3.3.2.2.3" xref="S3.Ex1.m1.3.3.3.2.2.3.cmml">s</mi><mn id="S3.Ex1.m1.3.3.3.2.3" xref="S3.Ex1.m1.3.3.3.2.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.3.1" xref="S3.Ex1.m1.3.3.3.1.cmml">​</mo><mrow id="S3.Ex1.m1.3.3.3.3.2" xref="S3.Ex1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.3.3.3.2.1" xref="S3.Ex1.m1.3.3.3.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.Ex1.m1.3.3.3.3.2.2" xref="S3.Ex1.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.3.3.2" xref="S3.Ex1.m1.3.3.2.cmml">=</mo><mrow id="S3.Ex1.m1.3.3.1" xref="S3.Ex1.m1.3.3.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m1.3.3.1.2" xref="S3.Ex1.m1.3.3.1.2.cmml"><munder id="S3.Ex1.m1.3.3.1.2a" xref="S3.Ex1.m1.3.3.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m1.3.3.1.2.2" xref="S3.Ex1.m1.3.3.1.2.2.cmml">∑</mo><mi id="S3.Ex1.m1.3.3.1.2.3" xref="S3.Ex1.m1.3.3.1.2.3.cmml">i</mi></munder></mstyle><mrow id="S3.Ex1.m1.3.3.1.1" xref="S3.Ex1.m1.3.3.1.1.cmml"><msubsup id="S3.Ex1.m1.3.3.1.1.3" xref="S3.Ex1.m1.3.3.1.1.3.cmml"><mi id="S3.Ex1.m1.3.3.1.1.3.2.2" xref="S3.Ex1.m1.3.3.1.1.3.2.2.cmml">λ</mi><mn id="S3.Ex1.m1.3.3.1.1.3.2.3" xref="S3.Ex1.m1.3.3.1.1.3.2.3.cmml">1</mn><mi id="S3.Ex1.m1.3.3.1.1.3.3" xref="S3.Ex1.m1.3.3.1.1.3.3.cmml">s</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.2" xref="S3.Ex1.m1.3.3.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.4" xref="S3.Ex1.m1.3.3.1.1.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.2a" xref="S3.Ex1.m1.3.3.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.5" xref="S3.Ex1.m1.3.3.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.2b" xref="S3.Ex1.m1.3.3.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.6" xref="S3.Ex1.m1.3.3.1.1.6.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.2c" xref="S3.Ex1.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.2.cmml">(</mo><mn id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">0</mn><mo id="S3.Ex1.m1.3.3.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.2.cmml">,</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.2.cmml">M</mi><mn id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2a" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.5" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2b" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.6" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2c" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">v</mi><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.4" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.2a" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.5" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.2b" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.2.cmml">​</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.6" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.2c" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.cmml"><msub id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.2.cmml">r</mi><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.1.cmml">|</mo><msub id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.2.cmml">v</mi><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.1.1.4" xref="S3.Ex1.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3"><eq id="S3.Ex1.m1.3.3.2.cmml" xref="S3.Ex1.m1.3.3.2"></eq><apply id="S3.Ex1.m1.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3"><times id="S3.Ex1.m1.3.3.3.1.cmml" xref="S3.Ex1.m1.3.3.3.1"></times><apply id="S3.Ex1.m1.3.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.2.1.cmml" xref="S3.Ex1.m1.3.3.3.2">superscript</csymbol><apply id="S3.Ex1.m1.3.3.3.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.2.2.1.cmml" xref="S3.Ex1.m1.3.3.3.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.2.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2">𝐿</ci><ci id="S3.Ex1.m1.3.3.3.2.2.3.cmml" xref="S3.Ex1.m1.3.3.3.2.2.3">𝑠</ci></apply><cn type="integer" id="S3.Ex1.m1.3.3.3.2.3.cmml" xref="S3.Ex1.m1.3.3.3.2.3">2</cn></apply><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝜃</ci></apply><apply id="S3.Ex1.m1.3.3.1.cmml" xref="S3.Ex1.m1.3.3.1"><apply id="S3.Ex1.m1.3.3.1.2.cmml" xref="S3.Ex1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.2.1.cmml" xref="S3.Ex1.m1.3.3.1.2">subscript</csymbol><sum id="S3.Ex1.m1.3.3.1.2.2.cmml" xref="S3.Ex1.m1.3.3.1.2.2"></sum><ci id="S3.Ex1.m1.3.3.1.2.3.cmml" xref="S3.Ex1.m1.3.3.1.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1"><times id="S3.Ex1.m1.3.3.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.2"></times><apply id="S3.Ex1.m1.3.3.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3">superscript</csymbol><apply id="S3.Ex1.m1.3.3.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.3.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.3.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.2">𝜆</ci><cn type="integer" id="S3.Ex1.m1.3.3.1.1.3.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.2.3">1</cn></apply><ci id="S3.Ex1.m1.3.3.1.1.3.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3.3">𝑠</ci></apply><ci id="S3.Ex1.m1.3.3.1.1.4.cmml" xref="S3.Ex1.m1.3.3.1.1.4">𝑚</ci><ci id="S3.Ex1.m1.3.3.1.1.5.cmml" xref="S3.Ex1.m1.3.3.1.1.5">𝑎</ci><ci id="S3.Ex1.m1.3.3.1.1.6.cmml" xref="S3.Ex1.m1.3.3.1.1.6">𝑥</ci><interval closure="open" id="S3.Ex1.m1.3.3.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1"><cn type="integer" id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">0</cn><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1"><minus id="S3.Ex1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.3"></minus><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1"><plus id="S3.Ex1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.2"></plus><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.2">𝑀</ci><cn type="integer" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1"><times id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.3">𝑙</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.4">𝑜</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.5.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.5">𝑔</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.6.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.6">𝑃</ci><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2"><times id="S3.Ex1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.2"></times><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.3">𝑙</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.4.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.4">𝑜</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.5.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.5">𝑔</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.6.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.6">𝑃</ci><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.2">𝑟</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.2">𝑣</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">\displaystyle L_{s}^{2}(\theta)=\sum_{i}{\lambda_{1}^{s}max(0,M_{1}+logP(r_{i}|v_{k})-logP(r_{i}|v_{i}))}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\displaystyle+{\lambda_{2}^{s}max(0,M_{2}+logP(r_{j}|v_{i})-logP(r_{i}|v_{i}))}," display="inline"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1a" xref="S3.E2.m1.2.2.1.1.cmml">+</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.1.3.2.2.cmml">λ</mi><mn id="S3.E2.m1.2.2.1.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.1.3.2.3.cmml">2</mn><mi id="S3.E2.m1.2.2.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.3.3.cmml">s</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.2a" xref="S3.E2.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.5" xref="S3.E2.m1.2.2.1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.2b" xref="S3.E2.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.6" xref="S3.E2.m1.2.2.1.1.1.6.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.2c" xref="S3.E2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">(</mo><mn id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">0</mn><mo id="S3.E2.m1.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">,</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">M</mi><mn id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2a" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.5" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2b" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.6" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2c" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">v</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.4" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2a" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.5" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2b" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.6" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2c" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.2.cmml">r</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml">|</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.2.cmml">v</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><plus id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1"></plus><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"></times><apply id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2.2">𝜆</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2.3">2</cn></apply><ci id="S3.E2.m1.2.2.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3">𝑠</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.4">𝑚</ci><ci id="S3.E2.m1.2.2.1.1.1.5.cmml" xref="S3.E2.m1.2.2.1.1.1.5">𝑎</ci><ci id="S3.E2.m1.2.2.1.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.1.6">𝑥</ci><interval closure="open" id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><cn type="integer" id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">0</cn><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1"><minus id="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3"></minus><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1"><plus id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2"></plus><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.2">𝑀</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑙</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.4">𝑜</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.5">𝑔</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.6">𝑃</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2"><times id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2"></times><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.3">𝑙</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.4">𝑜</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.5.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.5">𝑔</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.6.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.6">𝑃</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.2">𝑟</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.2">𝑣</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\displaystyle+{\lambda_{2}^{s}max(0,M_{2}+logP(r_{j}|v_{i})-logP(r_{i}|v_{i}))},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p3.12" class="ltx_p">where <math id="S3.SS1.SSS2.p3.8.m1.1" class="ltx_Math" alttext="v_{k}" display="inline"><semantics id="S3.SS1.SSS2.p3.8.m1.1a"><msub id="S3.SS1.SSS2.p3.8.m1.1.1" xref="S3.SS1.SSS2.p3.8.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p3.8.m1.1.1.2" xref="S3.SS1.SSS2.p3.8.m1.1.1.2.cmml">v</mi><mi id="S3.SS1.SSS2.p3.8.m1.1.1.3" xref="S3.SS1.SSS2.p3.8.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.8.m1.1b"><apply id="S3.SS1.SSS2.p3.8.m1.1.1.cmml" xref="S3.SS1.SSS2.p3.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.8.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.8.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.8.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p3.8.m1.1.1.2">𝑣</ci><ci id="S3.SS1.SSS2.p3.8.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p3.8.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.8.m1.1c">v_{k}</annotation></semantics></math> denotes the visual representations of positive pairs of target objects, and <math id="S3.SS1.SSS2.p3.9.m2.1" class="ltx_Math" alttext="\lambda_{1}^{s}" display="inline"><semantics id="S3.SS1.SSS2.p3.9.m2.1a"><msubsup id="S3.SS1.SSS2.p3.9.m2.1.1" xref="S3.SS1.SSS2.p3.9.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p3.9.m2.1.1.2.2" xref="S3.SS1.SSS2.p3.9.m2.1.1.2.2.cmml">λ</mi><mn id="S3.SS1.SSS2.p3.9.m2.1.1.2.3" xref="S3.SS1.SSS2.p3.9.m2.1.1.2.3.cmml">1</mn><mi id="S3.SS1.SSS2.p3.9.m2.1.1.3" xref="S3.SS1.SSS2.p3.9.m2.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.9.m2.1b"><apply id="S3.SS1.SSS2.p3.9.m2.1.1.cmml" xref="S3.SS1.SSS2.p3.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.9.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p3.9.m2.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p3.9.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p3.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.9.m2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p3.9.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.9.m2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p3.9.m2.1.1.2.2">𝜆</ci><cn type="integer" id="S3.SS1.SSS2.p3.9.m2.1.1.2.3.cmml" xref="S3.SS1.SSS2.p3.9.m2.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS2.p3.9.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p3.9.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.9.m2.1c">\lambda_{1}^{s}</annotation></semantics></math>, <math id="S3.SS1.SSS2.p3.10.m3.1" class="ltx_Math" alttext="\lambda_{2}^{s}" display="inline"><semantics id="S3.SS1.SSS2.p3.10.m3.1a"><msubsup id="S3.SS1.SSS2.p3.10.m3.1.1" xref="S3.SS1.SSS2.p3.10.m3.1.1.cmml"><mi id="S3.SS1.SSS2.p3.10.m3.1.1.2.2" xref="S3.SS1.SSS2.p3.10.m3.1.1.2.2.cmml">λ</mi><mn id="S3.SS1.SSS2.p3.10.m3.1.1.2.3" xref="S3.SS1.SSS2.p3.10.m3.1.1.2.3.cmml">2</mn><mi id="S3.SS1.SSS2.p3.10.m3.1.1.3" xref="S3.SS1.SSS2.p3.10.m3.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.10.m3.1b"><apply id="S3.SS1.SSS2.p3.10.m3.1.1.cmml" xref="S3.SS1.SSS2.p3.10.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.10.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p3.10.m3.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p3.10.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p3.10.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.10.m3.1.1.2.1.cmml" xref="S3.SS1.SSS2.p3.10.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.10.m3.1.1.2.2.cmml" xref="S3.SS1.SSS2.p3.10.m3.1.1.2.2">𝜆</ci><cn type="integer" id="S3.SS1.SSS2.p3.10.m3.1.1.2.3.cmml" xref="S3.SS1.SSS2.p3.10.m3.1.1.2.3">2</cn></apply><ci id="S3.SS1.SSS2.p3.10.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p3.10.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.10.m3.1c">\lambda_{2}^{s}</annotation></semantics></math>, and <math id="S3.SS1.SSS2.p3.11.m4.1" class="ltx_Math" alttext="M_{1}" display="inline"><semantics id="S3.SS1.SSS2.p3.11.m4.1a"><msub id="S3.SS1.SSS2.p3.11.m4.1.1" xref="S3.SS1.SSS2.p3.11.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p3.11.m4.1.1.2" xref="S3.SS1.SSS2.p3.11.m4.1.1.2.cmml">M</mi><mn id="S3.SS1.SSS2.p3.11.m4.1.1.3" xref="S3.SS1.SSS2.p3.11.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.11.m4.1b"><apply id="S3.SS1.SSS2.p3.11.m4.1.1.cmml" xref="S3.SS1.SSS2.p3.11.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.11.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p3.11.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.11.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p3.11.m4.1.1.2">𝑀</ci><cn type="integer" id="S3.SS1.SSS2.p3.11.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p3.11.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.11.m4.1c">M_{1}</annotation></semantics></math>, <math id="S3.SS1.SSS2.p3.12.m5.1" class="ltx_Math" alttext="M_{2}" display="inline"><semantics id="S3.SS1.SSS2.p3.12.m5.1a"><msub id="S3.SS1.SSS2.p3.12.m5.1.1" xref="S3.SS1.SSS2.p3.12.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p3.12.m5.1.1.2" xref="S3.SS1.SSS2.p3.12.m5.1.1.2.cmml">M</mi><mn id="S3.SS1.SSS2.p3.12.m5.1.1.3" xref="S3.SS1.SSS2.p3.12.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.12.m5.1b"><apply id="S3.SS1.SSS2.p3.12.m5.1.1.cmml" xref="S3.SS1.SSS2.p3.12.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.12.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p3.12.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.12.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p3.12.m5.1.1.2">𝑀</ci><cn type="integer" id="S3.SS1.SSS2.p3.12.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p3.12.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.12.m5.1c">M_{2}</annotation></semantics></math> are marginal hyper parameters.
The optimized marginal loss indicates that the generated expression is more focused on the target objects than the positive pair. It is because the MMI constraint is designed to maximize and to minimize the log-likelihood for the target object and the positive pair, respectively.</p>
</div>
<div id="S3.SS1.SSS2.p4" class="ltx_para">
<p id="S3.SS1.SSS2.p4.1" class="ltx_p">We also adopt a reinforcer module <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> to generate precise referring expressions for each target object by calculating reward loss. Specifically, a two-layered multi layer perception (MLP) network is used to evaluate the consistency between generated expressions and visual features. Expression representations and visual representations are combined by the MLP to generate reward loss.
We use the local-scene-aware target object feature <math id="S3.SS1.SSS2.p4.1.m1.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS1.SSS2.p4.1.m1.1a"><msub id="S3.SS1.SSS2.p4.1.m1.1.1" xref="S3.SS1.SSS2.p4.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p4.1.m1.1.1.2" xref="S3.SS1.SSS2.p4.1.m1.1.1.2.cmml">v</mi><mi id="S3.SS1.SSS2.p4.1.m1.1.1.3" xref="S3.SS1.SSS2.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.1.m1.1b"><apply id="S3.SS1.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p4.1.m1.1.1.2">𝑣</ci><ci id="S3.SS1.SSS2.p4.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.1.m1.1c">v_{i}</annotation></semantics></math> as a visual feature and employ an LSTM to encode the generated expressions as sentence features.
The evaluation scores are then used as rewards. The policy-gradient technique is used to optimize the reward function as follows:</p>
</div>
<div id="S3.SS1.SSS2.p5" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E3.m1.3" class="ltx_Math" alttext="{\bigtriangledown}_{\theta}J=-E_{P(W_{1:T}|v_{i})}[F(w_{1:T},v_{i}){\bigtriangledown}_{\theta}logP(w_{1:T}|v_{i};\theta)]," display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml"><msub id="S3.E3.m1.3.3.1.1.3.1" xref="S3.E3.m1.3.3.1.1.3.1.cmml"><mo id="S3.E3.m1.3.3.1.1.3.1.2" xref="S3.E3.m1.3.3.1.1.3.1.2.cmml">▽</mo><mi id="S3.E3.m1.3.3.1.1.3.1.3" xref="S3.E3.m1.3.3.1.1.3.1.3.cmml">θ</mi></msub><mi id="S3.E3.m1.3.3.1.1.3.2" xref="S3.E3.m1.3.3.1.1.3.2.cmml">J</mi></mrow><mo id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml"><mo id="S3.E3.m1.3.3.1.1.1a" xref="S3.E3.m1.3.3.1.1.1.cmml">−</mo><mrow id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.3.2.cmml">E</mi><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.cmml">W</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml"><mn id="S3.E3.m1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.1.1.1.1.1.1.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.cmml">v</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.4" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml">v</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.5" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.cmml"><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.2.cmml">▽</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.3.cmml">θ</mi></msub><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">​</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.4" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2a" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">​</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.5" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2b" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">​</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.6" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2c" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.cmml">w</mi><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.cmml"><mn id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.1.cmml">:</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.cmml">|</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.2.cmml"><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.2.cmml">;</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"></eq><apply id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"><apply id="S3.E3.m1.3.3.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1.3.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.3.1.2.cmml" xref="S3.E3.m1.3.3.1.1.3.1.2">▽</ci><ci id="S3.E3.m1.3.3.1.1.3.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3.1.3">𝜃</ci></apply><ci id="S3.E3.m1.3.3.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.2">𝐽</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><minus id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1"></minus><apply id="S3.E3.m1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.2"></times><apply id="S3.E3.m1.3.3.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.3.2">𝐸</ci><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝑃</ci><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2">𝑊</ci><apply id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3"><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1"><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.2">▽</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.4.3">𝜃</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.3"></times><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.4">𝐹</ci><interval closure="open" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2"><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2">𝑣</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3"><times id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.2"></times><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.4">𝑜</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.5">𝑔</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.6.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.6">𝑃</ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2">conditional</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2">𝑤</ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3"><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.1">:</ci><cn type="integer" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.2">1</cn><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.3">𝑇</ci></apply></apply><list id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1"><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝜃</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">{\bigtriangledown}_{\theta}J=-E_{P(W_{1:T}|v_{i})}[F(w_{1:T},v_{i}){\bigtriangledown}_{\theta}logP(w_{1:T}|v_{i};\theta)],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p5.2" class="ltx_p">where <math id="S3.SS1.SSS2.p5.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.SSS2.p5.1.m1.1a"><mi id="S3.SS1.SSS2.p5.1.m1.1.1" xref="S3.SS1.SSS2.p5.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.1.m1.1b"><ci id="S3.SS1.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.1.m1.1c">w</annotation></semantics></math> and <math id="S3.SS1.SSS2.p5.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.SSS2.p5.2.m2.1a"><mi id="S3.SS1.SSS2.p5.2.m2.1.1" xref="S3.SS1.SSS2.p5.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.2.m2.1b"><ci id="S3.SS1.SSS2.p5.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.2.m2.1c">T</annotation></semantics></math> denote a word vector and the number of words in a sentence, respectively.
The LSTM loss is used to minimize the expression of positive pairs while maximizing the expression of the target object by combining generation loss with reward loss.
Consequently, the speaker module can generate precise text expressions regarding the target object, which makes answers more accurate and increases the quality of the text expressions fed into the VQA.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Image, question, and expression embedding</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p">In the proposed framework, the JE-MHA network takes three feature representations as inputs, namely; image embeddings, question embeddings, and expression embeddings. With regard to the image embedding, we use 36 detected object regions per image as a form of Up-down attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
A Faster R-CNN head <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> with a ResNet-101 network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> is employed for object detection.
The detection head was first pre-trained on the Visual Genome dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, which was learned to detect 1,600 object categories and 400 attributes.
To generate an output set of image features <span id="S3.SS2.p1.3.1" class="ltx_text ltx_markedasmath ltx_font_bold">X</span>, we extract RoI pooled image features from the detected regions and perform NMS for each object category.
The Word2Vec method is applied for question embedding.
We used a publicly available pre-trained model for the word embedding matrix of the 300-dimensional glove vectors and fine-tune weights during training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>.
Expression embedding is performed using a standard gated recurrent unit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> with <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mn id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><cn type="integer" id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">512</annotation></semantics></math> hidden units.
The hidden unit in the final stage is extracted as the embedding feature <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="x_{c}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑥</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">x_{c}</annotation></semantics></math> for the text expression of each object.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Joint embedding multi-head-attention network</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The visual, question, and expression embeddings are fed into the JE-MHA network module to generate fused features. In this section, we elucidate the working of the JE-MHA module, which consist of a combination of three MHA modules. Multiple JE-MHAs are utilized recursively, and final results are combined through a feed-forward network (FFN).</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2101.08978/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="149" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>(left) MHA module takes queries, keys and values as inputs. Outputs are computed as weighted sums of inputs. (right) JE-MHA network takes image, question, and expression embeddings as inputs. Each JE-MHA module outputs three different embeddings, which are used as inputs for the next module.</figcaption>
</figure>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Multi-head-attention</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.1" class="ltx_p">An attention function maps a query and set of key-value pairs to an output, as discussed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. We compute the dot-product of the queries for all keys and divide each query by <math id="S3.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\sqrt{d_{k}}" display="inline"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><msqrt id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><msub id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.2.cmml">d</mi><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.cmml">k</mi></msub></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><root id="S3.SS3.SSS1.p1.1.m1.1.1a.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"></root><apply id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.2">𝑑</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\sqrt{d_{k}}</annotation></semantics></math> to scale each query dimension. Then, the softmax function is applied to obtain weights for the individual values as follows:</p>
<table id="Sx1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.5" class="ltx_Math" alttext="\displaystyle\text{Attention}(Q,K,V)=\text{softmax}(\frac{QK^{T}}{\sqrt{d_{k}}})\textbf{V}." display="inline"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml"><mtext id="S3.E4.m1.5.5.1.1.2.2" xref="S3.E4.m1.5.5.1.1.2.2a.cmml">Attention</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.2.1" xref="S3.E4.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="S3.E4.m1.5.5.1.1.2.3.2" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.1.1.2.3.2.1" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">Q</mi><mo id="S3.E4.m1.5.5.1.1.2.3.2.2" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">K</mi><mo id="S3.E4.m1.5.5.1.1.2.3.2.3" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">V</mi><mo stretchy="false" id="S3.E4.m1.5.5.1.1.2.3.2.4" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><mtext id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.3.1" xref="S3.E4.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.5.5.1.1.3.3.2" xref="S3.E4.m1.4.4.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.1.1.3.3.2.1" xref="S3.E4.m1.4.4.cmml">(</mo><mstyle displaystyle="true" id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mfrac id="S3.E4.m1.4.4a" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.2.cmml"><mi id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.2.1" xref="S3.E4.m1.4.4.2.1.cmml">​</mo><msup id="S3.E4.m1.4.4.2.3" xref="S3.E4.m1.4.4.2.3.cmml"><mi id="S3.E4.m1.4.4.2.3.2" xref="S3.E4.m1.4.4.2.3.2.cmml">K</mi><mi id="S3.E4.m1.4.4.2.3.3" xref="S3.E4.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><msub id="S3.E4.m1.4.4.3.2" xref="S3.E4.m1.4.4.3.2.cmml"><mi id="S3.E4.m1.4.4.3.2.2" xref="S3.E4.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.E4.m1.4.4.3.2.3" xref="S3.E4.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E4.m1.5.5.1.1.3.3.2.2" xref="S3.E4.m1.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.3.1a" xref="S3.E4.m1.5.5.1.1.3.1.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="S3.E4.m1.5.5.1.1.3.4" xref="S3.E4.m1.5.5.1.1.3.4a.cmml">V</mtext></mrow></mrow><mo lspace="0em" id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><eq id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"></eq><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><times id="S3.E4.m1.5.5.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2.1"></times><ci id="S3.E4.m1.5.5.1.1.2.2a.cmml" xref="S3.E4.m1.5.5.1.1.2.2"><mtext id="S3.E4.m1.5.5.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2">Attention</mtext></ci><vector id="S3.E4.m1.5.5.1.1.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.2.3.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑄</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝐾</ci><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝑉</ci></vector></apply><apply id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3"><times id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1"></times><ci id="S3.E4.m1.5.5.1.1.3.2a.cmml" xref="S3.E4.m1.5.5.1.1.3.2"><mtext id="S3.E4.m1.5.5.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2">softmax</mtext></ci><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.5.5.1.1.3.3.2"><divide id="S3.E4.m1.4.4.1.cmml" xref="S3.E4.m1.5.5.1.1.3.3.2"></divide><apply id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4.2"><times id="S3.E4.m1.4.4.2.1.cmml" xref="S3.E4.m1.4.4.2.1"></times><ci id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2">𝑄</ci><apply id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.3.1.cmml" xref="S3.E4.m1.4.4.2.3">superscript</csymbol><ci id="S3.E4.m1.4.4.2.3.2.cmml" xref="S3.E4.m1.4.4.2.3.2">𝐾</ci><ci id="S3.E4.m1.4.4.2.3.3.cmml" xref="S3.E4.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><root id="S3.E4.m1.4.4.3a.cmml" xref="S3.E4.m1.4.4.3"></root><apply id="S3.E4.m1.4.4.3.2.cmml" xref="S3.E4.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.2.1.cmml" xref="S3.E4.m1.4.4.3.2">subscript</csymbol><ci id="S3.E4.m1.4.4.3.2.2.cmml" xref="S3.E4.m1.4.4.3.2.2">𝑑</ci><ci id="S3.E4.m1.4.4.3.2.3.cmml" xref="S3.E4.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.E4.m1.5.5.1.1.3.4a.cmml" xref="S3.E4.m1.5.5.1.1.3.4"><mtext class="ltx_mathvariant_bold" id="S3.E4.m1.5.5.1.1.3.4.cmml" xref="S3.E4.m1.5.5.1.1.3.4">V</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\displaystyle\text{Attention}(Q,K,V)=\text{softmax}(\frac{QK^{T}}{\sqrt{d_{k}}})\textbf{V}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.SSS1.p2" class="ltx_para">
<p id="S3.SS3.SSS1.p2.1" class="ltx_p">The MHA is constructed by using linear projection to attend each query jointly based on key and value features in the same feature space. Then, a scaled dot-product is calculated <math id="S3.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.SSS1.p2.1.m1.1a"><mi id="S3.SS3.SSS1.p2.1.m1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.1.m1.1b"><ci id="S3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.1.m1.1c">h</annotation></semantics></math> times in parallel, as follows:</p>
</div>
<div id="S3.SS3.SSS1.p3" class="ltx_para">
<table id="Sx1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.5" class="ltx_Math" alttext="\displaystyle\text{MHA}(\text{Q},\text{K},\text{V})=\text{Concat}(\text{head}_{1},...,\text{head}_{h})W^{O}," display="inline"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.4" xref="S3.E5.m1.5.5.1.1.4.cmml"><mtext id="S3.E5.m1.5.5.1.1.4.2" xref="S3.E5.m1.5.5.1.1.4.2a.cmml">MHA</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.4.1" xref="S3.E5.m1.5.5.1.1.4.1.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.4.3.2" xref="S3.E5.m1.5.5.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.4.3.2.1" xref="S3.E5.m1.5.5.1.1.4.3.1.cmml">(</mo><mtext id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1a.cmml">Q</mtext><mo id="S3.E5.m1.5.5.1.1.4.3.2.2" xref="S3.E5.m1.5.5.1.1.4.3.1.cmml">,</mo><mtext id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2a.cmml">K</mtext><mo id="S3.E5.m1.5.5.1.1.4.3.2.3" xref="S3.E5.m1.5.5.1.1.4.3.1.cmml">,</mo><mtext id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3a.cmml">V</mtext><mo stretchy="false" id="S3.E5.m1.5.5.1.1.4.3.2.4" xref="S3.E5.m1.5.5.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.3" xref="S3.E5.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml"><mtext id="S3.E5.m1.5.5.1.1.2.4" xref="S3.E5.m1.5.5.1.1.2.4a.cmml">Concat</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.2.3" xref="S3.E5.m1.5.5.1.1.2.3.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.2.2.2" xref="S3.E5.m1.5.5.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.2.2.2.3" xref="S3.E5.m1.5.5.1.1.2.2.3.cmml">(</mo><msub id="S3.E5.m1.5.5.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml"><mtext id="S3.E5.m1.5.5.1.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2a.cmml">head</mtext><mn id="S3.E5.m1.5.5.1.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E5.m1.5.5.1.1.2.2.2.4" xref="S3.E5.m1.5.5.1.1.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">…</mi><mo id="S3.E5.m1.5.5.1.1.2.2.2.5" xref="S3.E5.m1.5.5.1.1.2.2.3.cmml">,</mo><msub id="S3.E5.m1.5.5.1.1.2.2.2.2" xref="S3.E5.m1.5.5.1.1.2.2.2.2.cmml"><mtext id="S3.E5.m1.5.5.1.1.2.2.2.2.2" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2a.cmml">head</mtext><mi id="S3.E5.m1.5.5.1.1.2.2.2.2.3" xref="S3.E5.m1.5.5.1.1.2.2.2.2.3.cmml">h</mi></msub><mo stretchy="false" id="S3.E5.m1.5.5.1.1.2.2.2.6" xref="S3.E5.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.2.3a" xref="S3.E5.m1.5.5.1.1.2.3.cmml">​</mo><msup id="S3.E5.m1.5.5.1.1.2.5" xref="S3.E5.m1.5.5.1.1.2.5.cmml"><mi id="S3.E5.m1.5.5.1.1.2.5.2" xref="S3.E5.m1.5.5.1.1.2.5.2.cmml">W</mi><mi id="S3.E5.m1.5.5.1.1.2.5.3" xref="S3.E5.m1.5.5.1.1.2.5.3.cmml">O</mi></msup></mrow></mrow><mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1"><eq id="S3.E5.m1.5.5.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.3"></eq><apply id="S3.E5.m1.5.5.1.1.4.cmml" xref="S3.E5.m1.5.5.1.1.4"><times id="S3.E5.m1.5.5.1.1.4.1.cmml" xref="S3.E5.m1.5.5.1.1.4.1"></times><ci id="S3.E5.m1.5.5.1.1.4.2a.cmml" xref="S3.E5.m1.5.5.1.1.4.2"><mtext id="S3.E5.m1.5.5.1.1.4.2.cmml" xref="S3.E5.m1.5.5.1.1.4.2">MHA</mtext></ci><vector id="S3.E5.m1.5.5.1.1.4.3.1.cmml" xref="S3.E5.m1.5.5.1.1.4.3.2"><ci id="S3.E5.m1.1.1a.cmml" xref="S3.E5.m1.1.1"><mtext id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">Q</mtext></ci><ci id="S3.E5.m1.2.2a.cmml" xref="S3.E5.m1.2.2"><mtext id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">K</mtext></ci><ci id="S3.E5.m1.3.3a.cmml" xref="S3.E5.m1.3.3"><mtext id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">V</mtext></ci></vector></apply><apply id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2"><times id="S3.E5.m1.5.5.1.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.3"></times><ci id="S3.E5.m1.5.5.1.1.2.4a.cmml" xref="S3.E5.m1.5.5.1.1.2.4"><mtext id="S3.E5.m1.5.5.1.1.2.4.cmml" xref="S3.E5.m1.5.5.1.1.2.4">Concat</mtext></ci><vector id="S3.E5.m1.5.5.1.1.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2"><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.2a.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2"><mtext id="S3.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2">head</mtext></ci><cn type="integer" id="S3.E5.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">…</ci><apply id="S3.E5.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.2.2.2.2.2a.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2"><mtext id="S3.E5.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2">head</mtext></ci><ci id="S3.E5.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2.3">ℎ</ci></apply></vector><apply id="S3.E5.m1.5.5.1.1.2.5.cmml" xref="S3.E5.m1.5.5.1.1.2.5"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.5.1.cmml" xref="S3.E5.m1.5.5.1.1.2.5">superscript</csymbol><ci id="S3.E5.m1.5.5.1.1.2.5.2.cmml" xref="S3.E5.m1.5.5.1.1.2.5.2">𝑊</ci><ci id="S3.E5.m1.5.5.1.1.2.5.3.cmml" xref="S3.E5.m1.5.5.1.1.2.5.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\displaystyle\text{MHA}(\text{Q},\text{K},\text{V})=\text{Concat}(\text{head}_{1},...,\text{head}_{h})W^{O},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle\text{head}_{i}=\text{Attention}(QW^{Q}_{i},KW^{K}_{i},VW^{V}_{i})." display="inline"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.5" xref="S3.E6.m1.1.1.1.1.5.cmml"><mtext id="S3.E6.m1.1.1.1.1.5.2" xref="S3.E6.m1.1.1.1.1.5.2a.cmml">head</mtext><mi id="S3.E6.m1.1.1.1.1.5.3" xref="S3.E6.m1.1.1.1.1.5.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mtext id="S3.E6.m1.1.1.1.1.3.5" xref="S3.E6.m1.1.1.1.1.3.5a.cmml">Attention</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.3.4" xref="S3.E6.m1.1.1.1.1.3.4.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3.3.3.4" xref="S3.E6.m1.1.1.1.1.3.3.4.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">Q</mi></msubsup></mrow><mo id="S3.E6.m1.1.1.1.1.3.3.3.5" xref="S3.E6.m1.1.1.1.1.3.3.4.cmml">,</mo><mrow id="S3.E6.m1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.2.2.2.2.1" xref="S3.E6.m1.1.1.1.1.2.2.2.2.1.cmml">​</mo><msubsup id="S3.E6.m1.1.1.1.1.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.2.cmml">W</mi><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.3.cmml">i</mi><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.3.cmml">K</mi></msubsup></mrow><mo id="S3.E6.m1.1.1.1.1.3.3.3.6" xref="S3.E6.m1.1.1.1.1.3.3.4.cmml">,</mo><mrow id="S3.E6.m1.1.1.1.1.3.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.3.3.3.2" xref="S3.E6.m1.1.1.1.1.3.3.3.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.3.3.3.3.1" xref="S3.E6.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><msubsup id="S3.E6.m1.1.1.1.1.3.3.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.2" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.2.cmml">W</mi><mi id="S3.E6.m1.1.1.1.1.3.3.3.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3.3.cmml">i</mi><mi id="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.3" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.3.cmml">V</mi></msubsup></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3.3.3.7" xref="S3.E6.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.4"></eq><apply id="S3.E6.m1.1.1.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.5.1.cmml" xref="S3.E6.m1.1.1.1.1.5">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.5.2a.cmml" xref="S3.E6.m1.1.1.1.1.5.2"><mtext id="S3.E6.m1.1.1.1.1.5.2.cmml" xref="S3.E6.m1.1.1.1.1.5.2">head</mtext></ci><ci id="S3.E6.m1.1.1.1.1.5.3.cmml" xref="S3.E6.m1.1.1.1.1.5.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><times id="S3.E6.m1.1.1.1.1.3.4.cmml" xref="S3.E6.m1.1.1.1.1.3.4"></times><ci id="S3.E6.m1.1.1.1.1.3.5a.cmml" xref="S3.E6.m1.1.1.1.1.3.5"><mtext id="S3.E6.m1.1.1.1.1.3.5.cmml" xref="S3.E6.m1.1.1.1.1.3.5">Attention</mtext></ci><vector id="S3.E6.m1.1.1.1.1.3.3.4.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2">𝑄</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.3">𝑄</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2"><times id="S3.E6.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.1"></times><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2">𝐾</ci><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.2">𝑊</ci><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.3">𝐾</ci></apply><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3"><times id="S3.E6.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E6.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.2">𝑉</ci><apply id="S3.E6.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.2">𝑊</ci><ci id="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3.2.3">𝑉</ci></apply><ci id="S3.E6.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3.3.3">𝑖</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\text{head}_{i}=\text{Attention}(QW^{Q}_{i},KW^{K}_{i},VW^{V}_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.SSS1.p4" class="ltx_para">
<p id="S3.SS3.SSS1.p4.1" class="ltx_p">The dot-product-based attention functions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, which consist of keys, queries, and values as input features are more effective at embedding two different input modalities compared to traditional attention techniques (e.g., additive attention) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Therefore, we utilize dot-product attention for our MHA to obtain more discriminative embeddings compared to additive attention techniques.</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>JE-MHA network with image, question, and expression features</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.14" class="ltx_p">The JE-MHA network utilizes three MHA modules to construct connections between image, question, and expression embedding features based on co-attention. Let <math id="S3.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\textbf{Q}\in R^{N\times d}" display="inline"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mrow id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2a.cmml">Q</mtext><mo id="S3.SS3.SSS2.p1.1.m1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.SSS2.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><in id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1"></in><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2a.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2">Q</mtext></ci><apply id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.2">𝑅</ci><apply id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3"><times id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">\textbf{Q}\in R^{N\times d}</annotation></semantics></math> denote a set of question features containing <math id="S3.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">N</annotation></semantics></math> tokens. Each token has <math id="S3.SS3.SSS2.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS3.SSS2.p1.3.m3.1a"><mi id="S3.SS3.SSS2.p1.3.m3.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m3.1b"><ci id="S3.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m3.1c">d</annotation></semantics></math>-dimensional features. Let <math id="S3.SS3.SSS2.p1.4.m4.1" class="ltx_Math" alttext="\textbf{X}\in R^{M\times d}" display="inline"><semantics id="S3.SS3.SSS2.p1.4.m4.1a"><mrow id="S3.SS3.SSS2.p1.4.m4.1.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS2.p1.4.m4.1.1.2" xref="S3.SS3.SSS2.p1.4.m4.1.1.2a.cmml">X</mtext><mo id="S3.SS3.SSS2.p1.4.m4.1.1.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p1.4.m4.1.1.3" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.4.m4.1.1.3.2" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.SSS2.p1.4.m4.1.1.3.3" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p1.4.m4.1.1.3.3.2" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p1.4.m4.1.1.3.3.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.1.3.3.3" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.4.m4.1b"><apply id="S3.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1"><in id="S3.SS3.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.1"></in><ci id="S3.SS3.SSS2.p1.4.m4.1.1.2a.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.2">X</mtext></ci><apply id="S3.SS3.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.2">𝑅</ci><apply id="S3.SS3.SSS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.3"><times id="S3.SS3.SSS2.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.3.2">𝑀</ci><ci id="S3.SS3.SSS2.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m4.1c">\textbf{X}\in R^{M\times d}</annotation></semantics></math> denote the image embeddings of the <math id="S3.SS3.SSS2.p1.5.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS3.SSS2.p1.5.m5.1a"><mi id="S3.SS3.SSS2.p1.5.m5.1.1" xref="S3.SS3.SSS2.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.5.m5.1b"><ci id="S3.SS3.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.5.m5.1c">d</annotation></semantics></math>-dimensional features for <math id="S3.SS3.SSS2.p1.6.m6.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.SSS2.p1.6.m6.1a"><mi id="S3.SS3.SSS2.p1.6.m6.1.1" xref="S3.SS3.SSS2.p1.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.6.m6.1b"><ci id="S3.SS3.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.6.m6.1c">M</annotation></semantics></math> detected objects. The attention module first utilizes the image embedding features <span id="S3.SS3.SSS2.p1.14.1" class="ltx_text ltx_markedasmath ltx_font_bold">X</span> to produce query vectors <math id="S3.SS3.SSS2.p1.8.m8.1" class="ltx_Math" alttext="q_{x}" display="inline"><semantics id="S3.SS3.SSS2.p1.8.m8.1a"><msub id="S3.SS3.SSS2.p1.8.m8.1.1" xref="S3.SS3.SSS2.p1.8.m8.1.1.cmml"><mi id="S3.SS3.SSS2.p1.8.m8.1.1.2" xref="S3.SS3.SSS2.p1.8.m8.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS2.p1.8.m8.1.1.3" xref="S3.SS3.SSS2.p1.8.m8.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.8.m8.1b"><apply id="S3.SS3.SSS2.p1.8.m8.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.8.m8.1.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.8.m8.1.1.2.cmml" xref="S3.SS3.SSS2.p1.8.m8.1.1.2">𝑞</ci><ci id="S3.SS3.SSS2.p1.8.m8.1.1.3.cmml" xref="S3.SS3.SSS2.p1.8.m8.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.8.m8.1c">q_{x}</annotation></semantics></math>.
It then uses the question features <span id="S3.SS3.SSS2.p1.14.2" class="ltx_text ltx_markedasmath ltx_font_bold">Q</span> to generate a key <math id="S3.SS3.SSS2.p1.10.m10.1" class="ltx_Math" alttext="k_{q}" display="inline"><semantics id="S3.SS3.SSS2.p1.10.m10.1a"><msub id="S3.SS3.SSS2.p1.10.m10.1.1" xref="S3.SS3.SSS2.p1.10.m10.1.1.cmml"><mi id="S3.SS3.SSS2.p1.10.m10.1.1.2" xref="S3.SS3.SSS2.p1.10.m10.1.1.2.cmml">k</mi><mi id="S3.SS3.SSS2.p1.10.m10.1.1.3" xref="S3.SS3.SSS2.p1.10.m10.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.10.m10.1b"><apply id="S3.SS3.SSS2.p1.10.m10.1.1.cmml" xref="S3.SS3.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.10.m10.1.1.1.cmml" xref="S3.SS3.SSS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.10.m10.1.1.2.cmml" xref="S3.SS3.SSS2.p1.10.m10.1.1.2">𝑘</ci><ci id="S3.SS3.SSS2.p1.10.m10.1.1.3.cmml" xref="S3.SS3.SSS2.p1.10.m10.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.10.m10.1c">k_{q}</annotation></semantics></math> and value <math id="S3.SS3.SSS2.p1.11.m11.1" class="ltx_Math" alttext="v_{q}" display="inline"><semantics id="S3.SS3.SSS2.p1.11.m11.1a"><msub id="S3.SS3.SSS2.p1.11.m11.1.1" xref="S3.SS3.SSS2.p1.11.m11.1.1.cmml"><mi id="S3.SS3.SSS2.p1.11.m11.1.1.2" xref="S3.SS3.SSS2.p1.11.m11.1.1.2.cmml">v</mi><mi id="S3.SS3.SSS2.p1.11.m11.1.1.3" xref="S3.SS3.SSS2.p1.11.m11.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.11.m11.1b"><apply id="S3.SS3.SSS2.p1.11.m11.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m11.1.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m11.1.1.2.cmml" xref="S3.SS3.SSS2.p1.11.m11.1.1.2">𝑣</ci><ci id="S3.SS3.SSS2.p1.11.m11.1.1.3.cmml" xref="S3.SS3.SSS2.p1.11.m11.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.11.m11.1c">v_{q}</annotation></semantics></math>.
The inner-product of the query <math id="S3.SS3.SSS2.p1.12.m12.1" class="ltx_Math" alttext="q_{x}" display="inline"><semantics id="S3.SS3.SSS2.p1.12.m12.1a"><msub id="S3.SS3.SSS2.p1.12.m12.1.1" xref="S3.SS3.SSS2.p1.12.m12.1.1.cmml"><mi id="S3.SS3.SSS2.p1.12.m12.1.1.2" xref="S3.SS3.SSS2.p1.12.m12.1.1.2.cmml">q</mi><mi id="S3.SS3.SSS2.p1.12.m12.1.1.3" xref="S3.SS3.SSS2.p1.12.m12.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.12.m12.1b"><apply id="S3.SS3.SSS2.p1.12.m12.1.1.cmml" xref="S3.SS3.SSS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.12.m12.1.1.1.cmml" xref="S3.SS3.SSS2.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.12.m12.1.1.2.cmml" xref="S3.SS3.SSS2.p1.12.m12.1.1.2">𝑞</ci><ci id="S3.SS3.SSS2.p1.12.m12.1.1.3.cmml" xref="S3.SS3.SSS2.p1.12.m12.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.12.m12.1c">q_{x}</annotation></semantics></math> and key <math id="S3.SS3.SSS2.p1.13.m13.1" class="ltx_Math" alttext="k_{q}" display="inline"><semantics id="S3.SS3.SSS2.p1.13.m13.1a"><msub id="S3.SS3.SSS2.p1.13.m13.1.1" xref="S3.SS3.SSS2.p1.13.m13.1.1.cmml"><mi id="S3.SS3.SSS2.p1.13.m13.1.1.2" xref="S3.SS3.SSS2.p1.13.m13.1.1.2.cmml">k</mi><mi id="S3.SS3.SSS2.p1.13.m13.1.1.3" xref="S3.SS3.SSS2.p1.13.m13.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.13.m13.1b"><apply id="S3.SS3.SSS2.p1.13.m13.1.1.cmml" xref="S3.SS3.SSS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.13.m13.1.1.1.cmml" xref="S3.SS3.SSS2.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.13.m13.1.1.2.cmml" xref="S3.SS3.SSS2.p1.13.m13.1.1.2">𝑘</ci><ci id="S3.SS3.SSS2.p1.13.m13.1.1.3.cmml" xref="S3.SS3.SSS2.p1.13.m13.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.13.m13.1c">k_{q}</annotation></semantics></math> are computed to learn the softmax result for the attention weights. The attention is then used to weight the value vectors <math id="S3.SS3.SSS2.p1.14.m14.1" class="ltx_Math" alttext="v_{q}" display="inline"><semantics id="S3.SS3.SSS2.p1.14.m14.1a"><msub id="S3.SS3.SSS2.p1.14.m14.1.1" xref="S3.SS3.SSS2.p1.14.m14.1.1.cmml"><mi id="S3.SS3.SSS2.p1.14.m14.1.1.2" xref="S3.SS3.SSS2.p1.14.m14.1.1.2.cmml">v</mi><mi id="S3.SS3.SSS2.p1.14.m14.1.1.3" xref="S3.SS3.SSS2.p1.14.m14.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.14.m14.1b"><apply id="S3.SS3.SSS2.p1.14.m14.1.1.cmml" xref="S3.SS3.SSS2.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.14.m14.1.1.1.cmml" xref="S3.SS3.SSS2.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.14.m14.1.1.2.cmml" xref="S3.SS3.SSS2.p1.14.m14.1.1.2">𝑣</ci><ci id="S3.SS3.SSS2.p1.14.m14.1.1.3.cmml" xref="S3.SS3.SSS2.p1.14.m14.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.14.m14.1c">v_{q}</annotation></semantics></math> to generate weighted features, as defined in Eq. (<a href="#S3.E4" title="In 3.3.1 Multi-head-attention ‣ 3.3 Joint embedding multi-head-attention network ‣ 3 Proposed Method ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div id="S3.SS3.SSS2.p2" class="ltx_para">
<p id="S3.SS3.SSS2.p2.6" class="ltx_p">In our multi-head setting, <math id="S3.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><mi id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><ci id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">h</annotation></semantics></math> instances of the attended feature are computed using <math id="S3.SS3.SSS2.p2.2.m2.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><mi id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><ci id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">h</annotation></semantics></math> different projections of the original queries, keys, and values to improve the quality of attended features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.
The projected vectors have <math id="S3.SS3.SSS2.p2.3.m3.1" class="ltx_Math" alttext="d/h" display="inline"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><mrow id="S3.SS3.SSS2.p2.3.m3.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml">d</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.1.cmml">/</mo><mi id="S3.SS3.SSS2.p2.3.m3.1.1.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><apply id="S3.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1"><divide id="S3.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.1"></divide><ci id="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">d/h</annotation></semantics></math> dimensions to ensure that the numbers of parameters are on the same scale.
The output of the JE-MHA module following six recursive processes based on the outputs of each MHA is a concatenation of the <math id="S3.SS3.SSS2.p2.4.m4.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.SSS2.p2.4.m4.1a"><mi id="S3.SS3.SSS2.p2.4.m4.1.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m4.1b"><ci id="S3.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m4.1c">h</annotation></semantics></math>-th attended features with dimensions of <math id="S3.SS3.SSS2.p2.5.m5.1" class="ltx_Math" alttext="M\times(d/h)" display="inline"><semantics id="S3.SS3.SSS2.p2.5.m5.1a"><mrow id="S3.SS3.SSS2.p2.5.m5.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p2.5.m5.1.1.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml">×</mo><mrow id="S3.SS3.SSS2.p2.5.m5.1.1.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.2.cmml">d</mi><mo id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.1.cmml">/</mo><mi id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.3.cmml">h</mi></mrow><mo stretchy="false" id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m5.1b"><apply id="S3.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1"><times id="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.2"></times><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3">𝑀</ci><apply id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1"><divide id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.1"></divide><ci id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.2">𝑑</ci><ci id="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.1.1.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m5.1c">M\times(d/h)</annotation></semantics></math>, resulting in a final output size of <math id="S3.SS3.SSS2.p2.6.m6.1" class="ltx_Math" alttext="F\in R^{M\times d}" display="inline"><semantics id="S3.SS3.SSS2.p2.6.m6.1a"><mrow id="S3.SS3.SSS2.p2.6.m6.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml">F</mi><mo id="S3.SS3.SSS2.p2.6.m6.1.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.6.m6.1.1.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.SSS2.p2.6.m6.1.1.3.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m6.1b"><apply id="S3.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1"><in id="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.1"></in><ci id="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.2">𝐹</ci><apply id="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.2">𝑅</ci><apply id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3"><times id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2">𝑀</ci><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m6.1c">F\in R^{M\times d}</annotation></semantics></math>.
Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.3 Joint embedding multi-head-attention network ‣ 3 Proposed Method ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> presents the overall composition of the JE-MHA network and MHA module.</p>
</div>
</section>
<section id="S3.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Recursive block of the JE-MHA network</h4>

<div id="S3.SS3.SSS3.p1" class="ltx_para">
<p id="S3.SS3.SSS3.p1.9" class="ltx_p">In the proposed VQA system, we combine JE-MHA modules recursively. The input embeddings <math id="S3.SS3.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\textbf{Q}^{i}" display="inline"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><msup id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p1.1.m1.1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.2a.cmml">Q</mtext><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.2a.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.2">Q</mtext></ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">\textbf{Q}^{i}</annotation></semantics></math>, <math id="S3.SS3.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\textbf{X}^{i}_{o}" display="inline"><semantics id="S3.SS3.SSS3.p1.2.m2.1a"><msubsup id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p1.2.m2.1.1.2.2" xref="S3.SS3.SSS3.p1.2.m2.1.1.2.2a.cmml">X</mtext><mi id="S3.SS3.SSS3.p1.2.m2.1.1.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml">o</mi><mi id="S3.SS3.SSS3.p1.2.m2.1.1.2.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b"><apply id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p1.2.m2.1.1.2.2a.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.2.2">X</mtext></ci><ci id="S3.SS3.SSS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">\textbf{X}^{i}_{o}</annotation></semantics></math>, and <math id="S3.SS3.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\textbf{X}^{i}_{c}" display="inline"><semantics id="S3.SS3.SSS3.p1.3.m3.1a"><msubsup id="S3.SS3.SSS3.p1.3.m3.1.1" xref="S3.SS3.SSS3.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p1.3.m3.1.1.2.2" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.2a.cmml">X</mtext><mi id="S3.SS3.SSS3.p1.3.m3.1.1.3" xref="S3.SS3.SSS3.p1.3.m3.1.1.3.cmml">c</mi><mi id="S3.SS3.SSS3.p1.3.m3.1.1.2.3" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.3.m3.1b"><apply id="S3.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p1.3.m3.1.1.2.2a.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.2">X</mtext></ci><ci id="S3.SS3.SSS3.p1.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.3.m3.1c">\textbf{X}^{i}_{c}</annotation></semantics></math> are used as the question, image, and expression features for the <math id="S3.SS3.SSS3.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS3.p1.4.m4.1a"><mi id="S3.SS3.SSS3.p1.4.m4.1.1" xref="S3.SS3.SSS3.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.4.m4.1b"><ci id="S3.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.4.m4.1c">i</annotation></semantics></math>-th recursion, respectively. Additionally, we use <span id="S3.SS3.SSS3.p1.9.1" class="ltx_text ltx_markedasmath">MHA</span> and <math id="S3.SS3.SSS3.p1.6.m6.1" class="ltx_Math" alttext="\text{FFN}_{d}" display="inline"><semantics id="S3.SS3.SSS3.p1.6.m6.1a"><msub id="S3.SS3.SSS3.p1.6.m6.1.1" xref="S3.SS3.SSS3.p1.6.m6.1.1.cmml"><mtext id="S3.SS3.SSS3.p1.6.m6.1.1.2" xref="S3.SS3.SSS3.p1.6.m6.1.1.2a.cmml">FFN</mtext><mi id="S3.SS3.SSS3.p1.6.m6.1.1.3" xref="S3.SS3.SSS3.p1.6.m6.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.6.m6.1b"><apply id="S3.SS3.SSS3.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.6.m6.1.1.2a.cmml" xref="S3.SS3.SSS3.p1.6.m6.1.1.2"><mtext id="S3.SS3.SSS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.SSS3.p1.6.m6.1.1.2">FFN</mtext></ci><ci id="S3.SS3.SSS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.SSS3.p1.6.m6.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.6.m6.1c">\text{FFN}_{d}</annotation></semantics></math> to denote an MHA module and the FFN layer with <math id="S3.SS3.SSS3.p1.7.m7.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS3.SSS3.p1.7.m7.1a"><mi id="S3.SS3.SSS3.p1.7.m7.1.1" xref="S3.SS3.SSS3.p1.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.7.m7.1b"><ci id="S3.SS3.SSS3.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS3.p1.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.7.m7.1c">d</annotation></semantics></math> output units, respectively.
Based on the inputs from the <math id="S3.SS3.SSS3.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS3.p1.8.m8.1a"><mi id="S3.SS3.SSS3.p1.8.m8.1.1" xref="S3.SS3.SSS3.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.8.m8.1b"><ci id="S3.SS3.SSS3.p1.8.m8.1.1.cmml" xref="S3.SS3.SSS3.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.8.m8.1c">i</annotation></semantics></math>-th recursion, we compute the (<math id="S3.SS3.SSS3.p1.9.m9.1" class="ltx_Math" alttext="i+1" display="inline"><semantics id="S3.SS3.SSS3.p1.9.m9.1a"><mrow id="S3.SS3.SSS3.p1.9.m9.1.1" xref="S3.SS3.SSS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.SSS3.p1.9.m9.1.1.2" xref="S3.SS3.SSS3.p1.9.m9.1.1.2.cmml">i</mi><mo id="S3.SS3.SSS3.p1.9.m9.1.1.1" xref="S3.SS3.SSS3.p1.9.m9.1.1.1.cmml">+</mo><mn id="S3.SS3.SSS3.p1.9.m9.1.1.3" xref="S3.SS3.SSS3.p1.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.9.m9.1b"><apply id="S3.SS3.SSS3.p1.9.m9.1.1.cmml" xref="S3.SS3.SSS3.p1.9.m9.1.1"><plus id="S3.SS3.SSS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.SSS3.p1.9.m9.1.1.1"></plus><ci id="S3.SS3.SSS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.SSS3.p1.9.m9.1.1.2">𝑖</ci><cn type="integer" id="S3.SS3.SSS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.SSS3.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.9.m9.1c">i+1</annotation></semantics></math>)-th recursion as follows:</p>
<table id="Sx1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{Q}^{i+1}" display="inline"><semantics id="S3.E7.m1.1a"><msup id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2a.cmml">Q</mtext><mrow id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.3.1" xref="S3.E7.m1.1.1.3.1.cmml">+</mo><mn id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.2a.cmml" xref="S3.E7.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2">Q</mtext></ci><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><plus id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3.1"></plus><ci id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle\textbf{Q}^{i+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m2.1" class="ltx_Math" alttext="\displaystyle=\text{MHA}(\textbf{Q}^{i},\textbf{Q}^{i},\textbf{Q}^{i})," display="inline"><semantics id="S3.E7.m2.1a"><mrow id="S3.E7.m2.1.1.1" xref="S3.E7.m2.1.1.1.1.cmml"><mrow id="S3.E7.m2.1.1.1.1" xref="S3.E7.m2.1.1.1.1.cmml"><mi id="S3.E7.m2.1.1.1.1.5" xref="S3.E7.m2.1.1.1.1.5.cmml"></mi><mo id="S3.E7.m2.1.1.1.1.4" xref="S3.E7.m2.1.1.1.1.4.cmml">=</mo><mrow id="S3.E7.m2.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.3.cmml"><mtext id="S3.E7.m2.1.1.1.1.3.5" xref="S3.E7.m2.1.1.1.1.3.5a.cmml">MHA</mtext><mo lspace="0em" rspace="0em" id="S3.E7.m2.1.1.1.1.3.4" xref="S3.E7.m2.1.1.1.1.3.4.cmml">​</mo><mrow id="S3.E7.m2.1.1.1.1.3.3.3" xref="S3.E7.m2.1.1.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E7.m2.1.1.1.1.3.3.3.4" xref="S3.E7.m2.1.1.1.1.3.3.4.cmml">(</mo><msup id="S3.E7.m2.1.1.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m2.1.1.1.1.1.1.1.1.2" xref="S3.E7.m2.1.1.1.1.1.1.1.1.2a.cmml">Q</mtext><mi id="S3.E7.m2.1.1.1.1.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.E7.m2.1.1.1.1.3.3.3.5" xref="S3.E7.m2.1.1.1.1.3.3.4.cmml">,</mo><msup id="S3.E7.m2.1.1.1.1.2.2.2.2" xref="S3.E7.m2.1.1.1.1.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m2.1.1.1.1.2.2.2.2.2" xref="S3.E7.m2.1.1.1.1.2.2.2.2.2a.cmml">Q</mtext><mi id="S3.E7.m2.1.1.1.1.2.2.2.2.3" xref="S3.E7.m2.1.1.1.1.2.2.2.2.3.cmml">i</mi></msup><mo id="S3.E7.m2.1.1.1.1.3.3.3.6" xref="S3.E7.m2.1.1.1.1.3.3.4.cmml">,</mo><msup id="S3.E7.m2.1.1.1.1.3.3.3.3" xref="S3.E7.m2.1.1.1.1.3.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m2.1.1.1.1.3.3.3.3.2" xref="S3.E7.m2.1.1.1.1.3.3.3.3.2a.cmml">Q</mtext><mi id="S3.E7.m2.1.1.1.1.3.3.3.3.3" xref="S3.E7.m2.1.1.1.1.3.3.3.3.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E7.m2.1.1.1.1.3.3.3.7" xref="S3.E7.m2.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m2.1.1.1.2" xref="S3.E7.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.1b"><apply id="S3.E7.m2.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1"><eq id="S3.E7.m2.1.1.1.1.4.cmml" xref="S3.E7.m2.1.1.1.1.4"></eq><csymbol cd="latexml" id="S3.E7.m2.1.1.1.1.5.cmml" xref="S3.E7.m2.1.1.1.1.5">absent</csymbol><apply id="S3.E7.m2.1.1.1.1.3.cmml" xref="S3.E7.m2.1.1.1.1.3"><times id="S3.E7.m2.1.1.1.1.3.4.cmml" xref="S3.E7.m2.1.1.1.1.3.4"></times><ci id="S3.E7.m2.1.1.1.1.3.5a.cmml" xref="S3.E7.m2.1.1.1.1.3.5"><mtext id="S3.E7.m2.1.1.1.1.3.5.cmml" xref="S3.E7.m2.1.1.1.1.3.5">MHA</mtext></ci><vector id="S3.E7.m2.1.1.1.1.3.3.4.cmml" xref="S3.E7.m2.1.1.1.1.3.3.3"><apply id="S3.E7.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m2.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E7.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.2">Q</mtext></ci><ci id="S3.E7.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E7.m2.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E7.m2.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E7.m2.1.1.1.1.2.2.2.2.2a.cmml" xref="S3.E7.m2.1.1.1.1.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E7.m2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E7.m2.1.1.1.1.2.2.2.2.2">Q</mtext></ci><ci id="S3.E7.m2.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E7.m2.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E7.m2.1.1.1.1.3.3.3.3.cmml" xref="S3.E7.m2.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E7.m2.1.1.1.1.3.3.3.3">superscript</csymbol><ci id="S3.E7.m2.1.1.1.1.3.3.3.3.2a.cmml" xref="S3.E7.m2.1.1.1.1.3.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E7.m2.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E7.m2.1.1.1.1.3.3.3.3.2">Q</mtext></ci><ci id="S3.E7.m2.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E7.m2.1.1.1.1.3.3.3.3.3">𝑖</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.1c">\displaystyle=\text{MHA}(\textbf{Q}^{i},\textbf{Q}^{i},\textbf{Q}^{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{H}_{o}^{i+1}" display="inline"><semantics id="S3.E8.m1.1a"><msubsup id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.2.2" xref="S3.E8.m1.1.1.2.2a.cmml">H</mtext><mi id="S3.E8.m1.1.1.2.3" xref="S3.E8.m1.1.1.2.3.cmml">o</mi><mrow id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">i</mi><mo id="S3.E8.m1.1.1.3.1" xref="S3.E8.m1.1.1.3.1.cmml">+</mo><mn id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1">superscript</csymbol><apply id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.cmml" xref="S3.E8.m1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.2.2a.cmml" xref="S3.E8.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.2.2">H</mtext></ci><ci id="S3.E8.m1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.2.3">𝑜</ci></apply><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><plus id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3.1"></plus><ci id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle\textbf{H}_{o}^{i+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m2.1" class="ltx_Math" alttext="\displaystyle=\text{LayerNorm}(\text{MHA}(\textbf{X}^{i}_{o},\textbf{Q}^{i},\textbf{Q}^{i})+\textbf{X}^{i}_{o})," display="inline"><semantics id="S3.E8.m2.1a"><mrow id="S3.E8.m2.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.3.cmml"></mi><mo id="S3.E8.m2.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8.m2.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.cmml"><mtext id="S3.E8.m2.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.3a.cmml">LayerNorm</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m2.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m2.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m2.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m2.1.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S3.E8.m2.1.1.1.1.1.1.1.1.3.5" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.5a.cmml">MHA</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m2.1.1.1.1.1.1.1.1.3.4" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.4.cmml">​</mo><mrow id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.4" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">X</mtext><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">o</mi><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.5" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.2a.cmml">Q</mtext><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msup><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.6" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.2a.cmml">Q</mtext><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.7" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.4" xref="S3.E8.m2.1.1.1.1.1.1.1.1.4.cmml">+</mo><msubsup id="S3.E8.m2.1.1.1.1.1.1.1.1.5" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.2a.cmml">X</mtext><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.5.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5.3.cmml">o</mi><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S3.E8.m2.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m2.1.1.1.2" xref="S3.E8.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.1b"><apply id="S3.E8.m2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1"><eq id="S3.E8.m2.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E8.m2.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E8.m2.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1"><times id="S3.E8.m2.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.2"></times><ci id="S3.E8.m2.1.1.1.1.1.3a.cmml" xref="S3.E8.m2.1.1.1.1.1.3"><mtext id="S3.E8.m2.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1"><plus id="S3.E8.m2.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.4"></plus><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3"><times id="S3.E8.m2.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.4"></times><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.3.5a.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.5"><mtext id="S3.E8.m2.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.5">MHA</mtext></ci><vector id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3"><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">X</mtext></ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑜</ci></apply><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.2a.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.2">Q</mtext></ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3">superscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.2a.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.2">Q</mtext></ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3.3.3.3.3">𝑖</ci></apply></vector></apply><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5">subscript</csymbol><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5">superscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.2a.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.2">X</mtext></ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5.2.3">𝑖</ci></apply><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.5.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.1c">\displaystyle=\text{LayerNorm}(\text{MHA}(\textbf{X}^{i}_{o},\textbf{Q}^{i},\textbf{Q}^{i})+\textbf{X}^{i}_{o}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{X}^{i+1}_{o}" display="inline"><semantics id="S3.E9.m1.1a"><msubsup id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2a.cmml">X</mtext><mi id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">o</mi><mrow id="S3.E9.m1.1.1.2.3" xref="S3.E9.m1.1.1.2.3.cmml"><mi id="S3.E9.m1.1.1.2.3.2" xref="S3.E9.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.E9.m1.1.1.2.3.1" xref="S3.E9.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.E9.m1.1.1.2.3.3" xref="S3.E9.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1">subscript</csymbol><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1">superscript</csymbol><ci id="S3.E9.m1.1.1.2.2a.cmml" xref="S3.E9.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2">X</mtext></ci><apply id="S3.E9.m1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.2.3"><plus id="S3.E9.m1.1.1.2.3.1.cmml" xref="S3.E9.m1.1.1.2.3.1"></plus><ci id="S3.E9.m1.1.1.2.3.2.cmml" xref="S3.E9.m1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E9.m1.1.1.2.3.3.cmml" xref="S3.E9.m1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\textbf{X}^{i+1}_{o}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m2.1" class="ltx_Math" alttext="\displaystyle=\text{LayerNorm}(\text{FFN}_{d}(\textbf{H}_{o}^{i+1})+\textbf{H}_{o}^{i+1})," display="inline"><semantics id="S3.E9.m2.1a"><mrow id="S3.E9.m2.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml"><mrow id="S3.E9.m2.1.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml"><mi id="S3.E9.m2.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.3.cmml"></mi><mo id="S3.E9.m2.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9.m2.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.cmml"><mtext id="S3.E9.m2.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.3a.cmml">LayerNorm</mtext><mo lspace="0em" rspace="0em" id="S3.E9.m2.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m2.1.1.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m2.1.1.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m2.1.1.1.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m2.1.1.1.1.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.2a.cmml">FFN</mtext><mi id="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">H</mtext><mi id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">o</mi><mrow id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m2.1.1.1.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.2.cmml">+</mo><msubsup id="S3.E9.m2.1.1.1.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.2a.cmml">H</mtext><mi id="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.3.cmml">o</mi><mrow id="S3.E9.m2.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo stretchy="false" id="S3.E9.m2.1.1.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.1.1.1.2" xref="S3.E9.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.1b"><apply id="S3.E9.m2.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1"><eq id="S3.E9.m2.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E9.m2.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E9.m2.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1"><times id="S3.E9.m2.1.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.1.2"></times><ci id="S3.E9.m2.1.1.1.1.1.3a.cmml" xref="S3.E9.m2.1.1.1.1.1.3"><mtext id="S3.E9.m2.1.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1"><plus id="S3.E9.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.2"></plus><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1"><times id="S3.E9.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.2"><mtext id="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.2">FFN</mtext></ci><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">H</mtext></ci><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑜</ci></apply><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3"><plus id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.2a.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.2">H</mtext></ci><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.2.3">𝑜</ci></apply><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.3"><plus id="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><cn type="integer" id="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.1c">\displaystyle=\text{LayerNorm}(\text{FFN}_{d}(\textbf{H}_{o}^{i+1})+\textbf{H}_{o}^{i+1}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{H}_{c}^{i+1}" display="inline"><semantics id="S3.E10.m1.1a"><msubsup id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.1.1.2.2" xref="S3.E10.m1.1.1.2.2a.cmml">H</mtext><mi id="S3.E10.m1.1.1.2.3" xref="S3.E10.m1.1.1.2.3.cmml">c</mi><mrow id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.3.2" xref="S3.E10.m1.1.1.3.2.cmml">i</mi><mo id="S3.E10.m1.1.1.3.1" xref="S3.E10.m1.1.1.3.1.cmml">+</mo><mn id="S3.E10.m1.1.1.3.3" xref="S3.E10.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1">superscript</csymbol><apply id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.2.1.cmml" xref="S3.E10.m1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.2.2a.cmml" xref="S3.E10.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.2.2">H</mtext></ci><ci id="S3.E10.m1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.2.3">𝑐</ci></apply><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><plus id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3.1"></plus><ci id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\displaystyle\textbf{H}_{c}^{i+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E10.m2.1" class="ltx_Math" alttext="\displaystyle=\text{LayerNorm}(\text{MHA}(\textbf{X}^{i}_{c},\textbf{Q}^{i},\textbf{Q}^{i})+\textbf{X}^{i}_{c})," display="inline"><semantics id="S3.E10.m2.1a"><mrow id="S3.E10.m2.1.1.1" xref="S3.E10.m2.1.1.1.1.cmml"><mrow id="S3.E10.m2.1.1.1.1" xref="S3.E10.m2.1.1.1.1.cmml"><mi id="S3.E10.m2.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.3.cmml"></mi><mo id="S3.E10.m2.1.1.1.1.2" xref="S3.E10.m2.1.1.1.1.2.cmml">=</mo><mrow id="S3.E10.m2.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.cmml"><mtext id="S3.E10.m2.1.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.1.3a.cmml">LayerNorm</mtext><mo lspace="0em" rspace="0em" id="S3.E10.m2.1.1.1.1.1.2" xref="S3.E10.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m2.1.1.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m2.1.1.1.1.1.1.1.2" xref="S3.E10.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m2.1.1.1.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E10.m2.1.1.1.1.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S3.E10.m2.1.1.1.1.1.1.1.1.3.5" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.5a.cmml">MHA</mtext><mo lspace="0em" rspace="0em" id="S3.E10.m2.1.1.1.1.1.1.1.1.3.4" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.4.cmml">​</mo><mrow id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.4" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">X</mtext><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.5" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.2a.cmml">Q</mtext><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msup><mo id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.6" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.2a.cmml">Q</mtext><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.7" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E10.m2.1.1.1.1.1.1.1.1.4" xref="S3.E10.m2.1.1.1.1.1.1.1.1.4.cmml">+</mo><msubsup id="S3.E10.m2.1.1.1.1.1.1.1.1.5" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.2" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.2a.cmml">X</mtext><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.5.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5.3.cmml">c</mi><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S3.E10.m2.1.1.1.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m2.1.1.1.2" xref="S3.E10.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m2.1b"><apply id="S3.E10.m2.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1"><eq id="S3.E10.m2.1.1.1.1.2.cmml" xref="S3.E10.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E10.m2.1.1.1.1.3.cmml" xref="S3.E10.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E10.m2.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1"><times id="S3.E10.m2.1.1.1.1.1.2.cmml" xref="S3.E10.m2.1.1.1.1.1.2"></times><ci id="S3.E10.m2.1.1.1.1.1.3a.cmml" xref="S3.E10.m2.1.1.1.1.1.3"><mtext id="S3.E10.m2.1.1.1.1.1.3.cmml" xref="S3.E10.m2.1.1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.E10.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1"><plus id="S3.E10.m2.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.4"></plus><apply id="S3.E10.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3"><times id="S3.E10.m2.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.4"></times><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.3.5a.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.5"><mtext id="S3.E10.m2.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.5">MHA</mtext></ci><vector id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3"><apply id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">X</mtext></ci><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.2a.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.2">Q</mtext></ci><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3">superscript</csymbol><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.2a.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.2">Q</mtext></ci><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.3.3.3.3.3">𝑖</ci></apply></vector></apply><apply id="S3.E10.m2.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5">subscript</csymbol><apply id="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5">superscript</csymbol><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.2a.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.2">X</mtext></ci><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5.2.3">𝑖</ci></apply><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.5.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m2.1c">\displaystyle=\text{LayerNorm}(\text{MHA}(\textbf{X}^{i}_{c},\textbf{Q}^{i},\textbf{Q}^{i})+\textbf{X}^{i}_{c}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{X}^{i+1}_{c}" display="inline"><semantics id="S3.E11.m1.1a"><msubsup id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.1.1.2.2" xref="S3.E11.m1.1.1.2.2a.cmml">X</mtext><mi id="S3.E11.m1.1.1.3" xref="S3.E11.m1.1.1.3.cmml">c</mi><mrow id="S3.E11.m1.1.1.2.3" xref="S3.E11.m1.1.1.2.3.cmml"><mi id="S3.E11.m1.1.1.2.3.2" xref="S3.E11.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.E11.m1.1.1.2.3.1" xref="S3.E11.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.E11.m1.1.1.2.3.3" xref="S3.E11.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.cmml" xref="S3.E11.m1.1.1">subscript</csymbol><apply id="S3.E11.m1.1.1.2.cmml" xref="S3.E11.m1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.2.1.cmml" xref="S3.E11.m1.1.1">superscript</csymbol><ci id="S3.E11.m1.1.1.2.2a.cmml" xref="S3.E11.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.2.2">X</mtext></ci><apply id="S3.E11.m1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.2.3"><plus id="S3.E11.m1.1.1.2.3.1.cmml" xref="S3.E11.m1.1.1.2.3.1"></plus><ci id="S3.E11.m1.1.1.2.3.2.cmml" xref="S3.E11.m1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E11.m1.1.1.2.3.3.cmml" xref="S3.E11.m1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E11.m1.1.1.3.cmml" xref="S3.E11.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\displaystyle\textbf{X}^{i+1}_{c}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E11.m2.1" class="ltx_Math" alttext="\displaystyle=\text{LayerNorm}(\text{FFN}_{d}(\textbf{H}_{c}^{i+1})+\textbf{H}_{c}^{i+1})." display="inline"><semantics id="S3.E11.m2.1a"><mrow id="S3.E11.m2.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mrow id="S3.E11.m2.1.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.3.cmml"></mi><mo id="S3.E11.m2.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.2.cmml">=</mo><mrow id="S3.E11.m2.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.cmml"><mtext id="S3.E11.m2.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.3a.cmml">LayerNorm</mtext><mo lspace="0em" rspace="0em" id="S3.E11.m2.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E11.m2.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m2.1.1.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m2.1.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m2.1.1.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E11.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.2a.cmml">FFN</mtext><mi id="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">H</mtext><mi id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi><mrow id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m2.1.1.1.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.2.cmml">+</mo><msubsup id="S3.E11.m2.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.2a.cmml">H</mtext><mi id="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.3.cmml">c</mi><mrow id="S3.E11.m2.1.1.1.1.1.1.1.1.3.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo stretchy="false" id="S3.E11.m2.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E11.m2.1.1.1.2" xref="S3.E11.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m2.1b"><apply id="S3.E11.m2.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1"><eq id="S3.E11.m2.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E11.m2.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E11.m2.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1"><times id="S3.E11.m2.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.2"></times><ci id="S3.E11.m2.1.1.1.1.1.3a.cmml" xref="S3.E11.m2.1.1.1.1.1.3"><mtext id="S3.E11.m2.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1"><plus id="S3.E11.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.2"></plus><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1"><times id="S3.E11.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.2"><mtext id="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.2">FFN</mtext></ci><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">H</mtext></ci><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3"><plus id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.2a.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.2">H</mtext></ci><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.2.3">𝑐</ci></apply><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.3"><plus id="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><cn type="integer" id="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m2.1c">\displaystyle=\text{LayerNorm}(\text{FFN}_{d}(\textbf{H}_{c}^{i+1})+\textbf{H}_{c}^{i+1}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.SSS3.p2" class="ltx_para">
<p id="S3.SS3.SSS3.p2.6" class="ltx_p">From the three final outputs of the recursive JE-MHA module, namely <math id="S3.SS3.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\textbf{Q}^{t}" display="inline"><semantics id="S3.SS3.SSS3.p2.1.m1.1a"><msup id="S3.SS3.SSS3.p2.1.m1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.1.m1.1.1.2" xref="S3.SS3.SSS3.p2.1.m1.1.1.2a.cmml">Q</mtext><mi id="S3.SS3.SSS3.p2.1.m1.1.1.3" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.1.m1.1b"><apply id="S3.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.1.m1.1.1.2a.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.2">Q</mtext></ci><ci id="S3.SS3.SSS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.1.m1.1c">\textbf{Q}^{t}</annotation></semantics></math>, <math id="S3.SS3.SSS3.p2.2.m2.1" class="ltx_Math" alttext="\textbf{X}^{t}_{o}" display="inline"><semantics id="S3.SS3.SSS3.p2.2.m2.1a"><msubsup id="S3.SS3.SSS3.p2.2.m2.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.2.m2.1.1.2.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.2.2a.cmml">X</mtext><mi id="S3.SS3.SSS3.p2.2.m2.1.1.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.cmml">o</mi><mi id="S3.SS3.SSS3.p2.2.m2.1.1.2.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.2.m2.1b"><apply id="S3.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.2.m2.1.1.2.2a.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.2.2">X</mtext></ci><ci id="S3.SS3.SSS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.2.m2.1c">\textbf{X}^{t}_{o}</annotation></semantics></math>, and <math id="S3.SS3.SSS3.p2.3.m3.1" class="ltx_Math" alttext="\textbf{X}^{t}_{c}" display="inline"><semantics id="S3.SS3.SSS3.p2.3.m3.1a"><msubsup id="S3.SS3.SSS3.p2.3.m3.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.3.m3.1.1.2.2" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.2a.cmml">X</mtext><mi id="S3.SS3.SSS3.p2.3.m3.1.1.3" xref="S3.SS3.SSS3.p2.3.m3.1.1.3.cmml">c</mi><mi id="S3.SS3.SSS3.p2.3.m3.1.1.2.3" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.3.m3.1b"><apply id="S3.SS3.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.3.m3.1.1.2.2a.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.2">X</mtext></ci><ci id="S3.SS3.SSS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.3.m3.1c">\textbf{X}^{t}_{c}</annotation></semantics></math>, we construct a classifier to predict the confidence for each answer candidate. To compute the vector representations for <math id="S3.SS3.SSS3.p2.4.m4.1" class="ltx_Math" alttext="\textbf{Q}^{t}" display="inline"><semantics id="S3.SS3.SSS3.p2.4.m4.1a"><msup id="S3.SS3.SSS3.p2.4.m4.1.1" xref="S3.SS3.SSS3.p2.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.4.m4.1.1.2" xref="S3.SS3.SSS3.p2.4.m4.1.1.2a.cmml">Q</mtext><mi id="S3.SS3.SSS3.p2.4.m4.1.1.3" xref="S3.SS3.SSS3.p2.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.4.m4.1b"><apply id="S3.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.4.m4.1.1.2a.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2">Q</mtext></ci><ci id="S3.SS3.SSS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.4.m4.1c">\textbf{Q}^{t}</annotation></semantics></math>, <math id="S3.SS3.SSS3.p2.5.m5.1" class="ltx_Math" alttext="\textbf{X}^{t}_{o}" display="inline"><semantics id="S3.SS3.SSS3.p2.5.m5.1a"><msubsup id="S3.SS3.SSS3.p2.5.m5.1.1" xref="S3.SS3.SSS3.p2.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.5.m5.1.1.2.2" xref="S3.SS3.SSS3.p2.5.m5.1.1.2.2a.cmml">X</mtext><mi id="S3.SS3.SSS3.p2.5.m5.1.1.3" xref="S3.SS3.SSS3.p2.5.m5.1.1.3.cmml">o</mi><mi id="S3.SS3.SSS3.p2.5.m5.1.1.2.3" xref="S3.SS3.SSS3.p2.5.m5.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.5.m5.1b"><apply id="S3.SS3.SSS3.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.5.m5.1.1.2.2a.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1.2.2">X</mtext></ci><ci id="S3.SS3.SSS3.p2.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.5.m5.1c">\textbf{X}^{t}_{o}</annotation></semantics></math>, and <math id="S3.SS3.SSS3.p2.6.m6.1" class="ltx_Math" alttext="\textbf{X}^{t}_{c}" display="inline"><semantics id="S3.SS3.SSS3.p2.6.m6.1a"><msubsup id="S3.SS3.SSS3.p2.6.m6.1.1" xref="S3.SS3.SSS3.p2.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.6.m6.1.1.2.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.2a.cmml">X</mtext><mi id="S3.SS3.SSS3.p2.6.m6.1.1.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml">c</mi><mi id="S3.SS3.SSS3.p2.6.m6.1.1.2.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.6.m6.1b"><apply id="S3.SS3.SSS3.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.6.m6.1.1.2.2a.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p2.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.2">X</mtext></ci><ci id="S3.SS3.SSS3.p2.6.m6.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.6.m6.1c">\textbf{X}^{t}_{c}</annotation></semantics></math>, we adopt the attention fusion approach as shown below:</p>
<table id="Sx1.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{q}=(\text{softmax}(FFN_{1}(\textbf{Q}^{t})))^{T}\textbf{Q}^{t}," display="inline"><semantics id="S3.E12.m1.1a"><mrow id="S3.E12.m1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml"><mrow id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.3a.cmml">q</mtext><mo id="S3.E12.m1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.cmml"><msup id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E12.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml">N</mi><mn id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2b" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">Q</mtext><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E12.m1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.2.cmml">​</mo><msup id="S3.E12.m1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.1.1.1.1.1.3.2" xref="S3.E12.m1.1.1.1.1.1.3.2a.cmml">Q</mtext><mi id="S3.E12.m1.1.1.1.1.1.3.3" xref="S3.E12.m1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow></mrow><mo id="S3.E12.m1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1"><eq id="S3.E12.m1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.2"></eq><ci id="S3.E12.m1.1.1.1.1.3a.cmml" xref="S3.E12.m1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.3">q</mtext></ci><apply id="S3.E12.m1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1"><times id="S3.E12.m1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.2"></times><apply id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1"><times id="S3.E12.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E12.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.3">softmax</mtext></ci><apply id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐹</ci><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.4">𝐹</ci><apply id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2">𝑁</ci><cn type="integer" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3">1</cn></apply><apply id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">Q</mtext></ci><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><ci id="S3.E12.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E12.m1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.3.2a.cmml" xref="S3.E12.m1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.1.3.2">Q</mtext></ci><ci id="S3.E12.m1.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle\textbf{q}=(\text{softmax}(FFN_{1}(\textbf{Q}^{t})))^{T}\textbf{Q}^{t},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{x}_{c}=(\text{softmax}(FFN_{1}(\textbf{X}^{t}_{c})))^{T}\textbf{X}^{t}_{c}," display="inline"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><msub id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.1.3.2a.cmml">x</mtext><mi id="S3.E13.m1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.3.3.cmml">c</mi></msub><mo id="S3.E13.m1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.cmml"><msup id="S3.E13.m1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E13.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml">N</mi><mn id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2b" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">X</mtext><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E13.m1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S3.E13.m1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.1.3.2.2" xref="S3.E13.m1.1.1.1.1.1.3.2.2a.cmml">X</mtext><mi id="S3.E13.m1.1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.1.3.3.cmml">c</mi><mi id="S3.E13.m1.1.1.1.1.1.3.2.3" xref="S3.E13.m1.1.1.1.1.1.3.2.3.cmml">t</mi></msubsup></mrow></mrow><mo id="S3.E13.m1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><eq id="S3.E13.m1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2"></eq><apply id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.2a.cmml" xref="S3.E13.m1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2">x</mtext></ci><ci id="S3.E13.m1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3">𝑐</ci></apply><apply id="S3.E13.m1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"><times id="S3.E13.m1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.2"></times><apply id="S3.E13.m1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1"><times id="S3.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E13.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.3">softmax</mtext></ci><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐹</ci><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.4">𝐹</ci><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2">𝑁</ci><cn type="integer" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3">1</cn></apply><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">X</mtext></ci><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply><ci id="S3.E13.m1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E13.m1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E13.m1.1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.3.2.2a.cmml" xref="S3.E13.m1.1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.3.2.2">X</mtext></ci><ci id="S3.E13.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E13.m1.1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\displaystyle\textbf{x}_{c}=(\text{softmax}(FFN_{1}(\textbf{X}^{t}_{c})))^{T}\textbf{X}^{t}_{c},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E14.m1.1" class="ltx_Math" alttext="\displaystyle\textbf{x}_{o}=(\text{softmax}(FFN_{1}(\textbf{X}^{t}_{o})))^{T}\textbf{X}^{t}_{o}," display="inline"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><msub id="S3.E14.m1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.3.2a.cmml">x</mtext><mi id="S3.E14.m1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.3.3.cmml">o</mi></msub><mo id="S3.E14.m1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.cmml"><msup id="S3.E14.m1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E14.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml">N</mi><mn id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.2b" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">X</mtext><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">o</mi><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E14.m1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S3.E14.m1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.1.3.2.2" xref="S3.E14.m1.1.1.1.1.1.3.2.2a.cmml">X</mtext><mi id="S3.E14.m1.1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.1.3.3.cmml">o</mi><mi id="S3.E14.m1.1.1.1.1.1.3.2.3" xref="S3.E14.m1.1.1.1.1.1.3.2.3.cmml">t</mi></msubsup></mrow></mrow><mo id="S3.E14.m1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2"></eq><apply id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.2a.cmml" xref="S3.E14.m1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.3.2">x</mtext></ci><ci id="S3.E14.m1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.3.3">𝑜</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1"><times id="S3.E14.m1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.2"></times><apply id="S3.E14.m1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1"><times id="S3.E14.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E14.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.3">softmax</mtext></ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐹</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.4">𝐹</ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2">𝑁</ci><cn type="integer" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3">1</cn></apply><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">X</mtext></ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑜</ci></apply></apply></apply><ci id="S3.E14.m1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.3.2.2a.cmml" xref="S3.E14.m1.1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.3.2.2">X</mtext></ci><ci id="S3.E14.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E14.m1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.3.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\displaystyle\textbf{x}_{o}=(\text{softmax}(FFN_{1}(\textbf{X}^{t}_{o})))^{T}\textbf{X}^{t}_{o},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS3.p2.8" class="ltx_p">Finally, the answer confidence is computed as a projection of the joint question, image, and expression features as follows;</p>
<table id="Sx1.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E15.m1.2" class="ltx_Math" alttext="\displaystyle A=FFN_{|dict|}(\textbf{q}\odot(\textbf{x}_{c}+\textbf{x}_{o}))," display="inline"><semantics id="S3.E15.m1.2a"><mrow id="S3.E15.m1.2.2.1" xref="S3.E15.m1.2.2.1.1.cmml"><mrow id="S3.E15.m1.2.2.1.1" xref="S3.E15.m1.2.2.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.3" xref="S3.E15.m1.2.2.1.1.3.cmml">A</mi><mo id="S3.E15.m1.2.2.1.1.2" xref="S3.E15.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E15.m1.2.2.1.1.1" xref="S3.E15.m1.2.2.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S3.E15.m1.2.2.1.1.1.4" xref="S3.E15.m1.2.2.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.1.2a" xref="S3.E15.m1.2.2.1.1.1.2.cmml">​</mo><msub id="S3.E15.m1.2.2.1.1.1.5" xref="S3.E15.m1.2.2.1.1.1.5.cmml"><mi id="S3.E15.m1.2.2.1.1.1.5.2" xref="S3.E15.m1.2.2.1.1.1.5.2.cmml">N</mi><mrow id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E15.m1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E15.m1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.1.1a" xref="S3.E15.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.1.4" xref="S3.E15.m1.1.1.1.1.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.1.1b" xref="S3.E15.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.1.5" xref="S3.E15.m1.1.1.1.1.1.5.cmml">t</mi></mrow><mo stretchy="false" id="S3.E15.m1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.1.2b" xref="S3.E15.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.2.2.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3a.cmml">q</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.E15.m1.2.2.1.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.2a.cmml">x</mtext><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2a.cmml">x</mtext><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E15.m1.2.2.1.2" xref="S3.E15.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.2b"><apply id="S3.E15.m1.2.2.1.1.cmml" xref="S3.E15.m1.2.2.1"><eq id="S3.E15.m1.2.2.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.2"></eq><ci id="S3.E15.m1.2.2.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.3">𝐴</ci><apply id="S3.E15.m1.2.2.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1"><times id="S3.E15.m1.2.2.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.2"></times><ci id="S3.E15.m1.2.2.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.3">𝐹</ci><ci id="S3.E15.m1.2.2.1.1.1.4.cmml" xref="S3.E15.m1.2.2.1.1.1.4">𝐹</ci><apply id="S3.E15.m1.2.2.1.1.1.5.cmml" xref="S3.E15.m1.2.2.1.1.1.5"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.5.1.cmml" xref="S3.E15.m1.2.2.1.1.1.5">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.5.2.cmml" xref="S3.E15.m1.2.2.1.1.1.5.2">𝑁</ci><apply id="S3.E15.m1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1"><abs id="S3.E15.m1.1.1.1.2.1.cmml" xref="S3.E15.m1.1.1.1.1.2"></abs><apply id="S3.E15.m1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1"><times id="S3.E15.m1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1"></times><ci id="S3.E15.m1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.1.2">𝑑</ci><ci id="S3.E15.m1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.3">𝑖</ci><ci id="S3.E15.m1.1.1.1.1.1.4.cmml" xref="S3.E15.m1.1.1.1.1.1.4">𝑐</ci><ci id="S3.E15.m1.1.1.1.1.1.5.cmml" xref="S3.E15.m1.1.1.1.1.1.5">𝑡</ci></apply></apply></apply><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E15.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2">direct-product</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3">q</mtext></ci><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1"><plus id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">x</mtext></ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">x</mtext></ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑜</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.2c">\displaystyle A=FFN_{|dict|}(\textbf{q}\odot(\textbf{x}_{c}+\textbf{x}_{o})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS3.p2.7" class="ltx_p">where <math id="S3.SS3.SSS3.p2.7.m1.1" class="ltx_Math" alttext="|dict|" display="inline"><semantics id="S3.SS3.SSS3.p2.7.m1.1a"><mrow id="S3.SS3.SSS3.p2.7.m1.1.1.1" xref="S3.SS3.SSS3.p2.7.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p2.7.m1.1.1.1.2" xref="S3.SS3.SSS3.p2.7.m1.1.1.2.1.cmml">|</mo><mrow id="S3.SS3.SSS3.p2.7.m1.1.1.1.1" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.2" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.1" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.3" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.1a" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.4" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.1b" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.5" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.5.cmml">t</mi></mrow><mo stretchy="false" id="S3.SS3.SSS3.p2.7.m1.1.1.1.3" xref="S3.SS3.SSS3.p2.7.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.7.m1.1b"><apply id="S3.SS3.SSS3.p2.7.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.7.m1.1.1.1"><abs id="S3.SS3.SSS3.p2.7.m1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.2"></abs><apply id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1"><times id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.1"></times><ci id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.2">𝑑</ci><ci id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.3">𝑖</ci><ci id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.4.cmml" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.4">𝑐</ci><ci id="S3.SS3.SSS3.p2.7.m1.1.1.1.1.5.cmml" xref="S3.SS3.SSS3.p2.7.m1.1.1.1.1.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.7.m1.1c">|dict|</annotation></semantics></math> denotes the word corpus of training data.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We validated the effectiveness of the proposed method by comparing it to state-of-the art methods on the VQA v2.0 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> to evaluate the accuracy of answer prediction and on the RefCOCO, RefCOCO+, and RefCOCO datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> to highlight the explainability of the proposed method.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Visual question answering.</span> We evaluated our proposed VQA model on the recent VQA v2.0 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. This dataset contains 1.1 million question and answer pairs based on MSCOCO images. The training, validation and test splits of the VQA 2.0 dataset were collected from the training, validation, and test splits of MSCOCO dataset, respectively.
This dataset includes complementary VQA pairs that ask the same question for two semantically similar images with different answers.
Because these pairs of images are semantically similar, fine-grained reasoning is required to answer the question correctly. Therefore, our explanations focus on the important factors for predicting answers that can be compared for complementary pairs. Each question and expression have fixed lengths of 14 and 20 words, respectively.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Referring expression generation.</span> We performed experiments on three expression datasets (RefCOCO, RefCOCO+, and RefCOCOg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> collected from MSCOCO images.
The RefCOCO and RefCOCO+ datasets are constructed based on the Image CLEF IAPR image retrieval dataset. For the RefCOCOg dataset, all the training, validation and test splits were constructed on images sampled from the training split of the MSCOCO dataset.
Since text expressions, which are generated from images, are utilized as an important component of the proposed method, we validated the quality of our generated text expressions. RefCOCO and RefCOCO+ were collected with time constraints for easily identifying target objects, whereas RefCOCOg was collected with no interactive settings and contains longer expressions than those in RefCOCO and RefCOCO+. Each dataset has 3.9 total objects and 1.63 objects of the same type per image. Overall, the three datasets contain 142,210, 141,565, and 104,560 expressions, respectively.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation details</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We optimized our speaker module using the Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> with a batch size of 128 and initialized the learning rate to 4e-4. The learning rate was set to decay by 0.5 every 500 iterations. The hidden state size of the LSTM generator for word embeddings was set to 512. Additionally, we empirically found that considering 20 neighbors with a 0.7 IoU in the NMS stage yields optimal results. For the reinforcer, our model generates three sample sentences and estimates the corresponding rewards. During the test, we used beam search with a beam size of 10.
For question and expression embedding, text preprocessing and tokenizing for UpDn features was performed using Stanford’s CoreNLP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The questions and expressions were first converted to lower case, trimmed to a maximum of <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="14" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">14</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn type="integer" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">14</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">14</annotation></semantics></math> words, then tokenized based on white spaces.
During the training phase, we trained our system on the VQA v2 training set for 13 epochs using the binary cross-entropy loss with soft scores, and BertAdam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> with a batch size of 64. After 10 epochs, the learning rate decayed by 0.2 every two epochs according to the method described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.
For the evaluation of VQA tasks, during the training phase of the speaker module, we used the RefCOCOg dataset only to exploit their abundant expressions for the target object.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results for visual question answering with explanations</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In this experiment, we first evaluated the performance of our proposed VQA method on the VQA v2 dataset. We compared its performance with the state-of-the-art methods, i.e., Bottom-up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, MuRel <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>, MCAN VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, Caption VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, MFH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, MFH+Bottom-Up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, BANGlCnt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, DFAF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, DCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, and Counter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>.
After that, we also performed ablation studies to evaluate the contributions of input modalities and the effectiveness of using generated referring expressions.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T1.1.1.1.1.1" class="ltx_text">Method</span></th>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">Test-dev</td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Test-std</td>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<td id="S4.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">All</td>
<td id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes/No</td>
<td id="S4.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Num</td>
<td id="S4.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Other</td>
<td id="S4.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">All</td>
</tr>
<tr id="S4.T1.1.3.3" class="ltx_tr">
<th id="S4.T1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Bottom-up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S4.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.32</td>
<td id="S4.T1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">81.82</td>
<td id="S4.T1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44.21</td>
<td id="S4.T1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.05</td>
<td id="S4.T1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.67</td>
</tr>
<tr id="S4.T1.1.4.4" class="ltx_tr">
<th id="S4.T1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">MuRel <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>
</th>
<td id="S4.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r">68.03</td>
<td id="S4.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">84.77</td>
<td id="S4.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r">49.84</td>
<td id="S4.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r">57.85</td>
<td id="S4.T1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_r">68.41</td>
</tr>
<tr id="S4.T1.1.5.5" class="ltx_tr">
<th id="S4.T1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Caption VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S4.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">66.10</td>
<td id="S4.T1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">82.80</td>
<td id="S4.T1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r">44.10</td>
<td id="S4.T1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r">56.80</td>
<td id="S4.T1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_r">68.40</td>
</tr>
<tr id="S4.T1.1.6.6" class="ltx_tr">
<th id="S4.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">MCAN VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</th>
<td id="S4.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r">70.63</td>
<td id="S4.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">86.82</td>
<td id="S4.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r">53.26</td>
<td id="S4.T1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r">60.72</td>
<td id="S4.T1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_r">70.90</td>
</tr>
<tr id="S4.T1.1.7.7" class="ltx_tr">
<th id="S4.T1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">MFH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>
</th>
<td id="S4.T1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r">68.02</td>
<td id="S4.T1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T1.1.7.7.6" class="ltx_td ltx_align_center ltx_border_r">-</td>
</tr>
<tr id="S4.T1.1.8.8" class="ltx_tr">
<th id="S4.T1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">MFH+Bottom-Up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>
</th>
<td id="S4.T1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r">68.76</td>
<td id="S4.T1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r">84.27</td>
<td id="S4.T1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r">49.56</td>
<td id="S4.T1.1.8.8.5" class="ltx_td ltx_align_center ltx_border_r">59.89</td>
<td id="S4.T1.1.8.8.6" class="ltx_td ltx_align_center ltx_border_r">-</td>
</tr>
<tr id="S4.T1.1.9.9" class="ltx_tr">
<th id="S4.T1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">BANGlCnt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>
</th>
<td id="S4.T1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r">70.04</td>
<td id="S4.T1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r">85.42</td>
<td id="S4.T1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_r">54.04</td>
<td id="S4.T1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_r">60.52</td>
<td id="S4.T1.1.9.9.6" class="ltx_td ltx_align_center ltx_border_r">70.35</td>
</tr>
<tr id="S4.T1.1.10.10" class="ltx_tr">
<th id="S4.T1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">DFAF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>
</th>
<td id="S4.T1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r">70.22</td>
<td id="S4.T1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r">86.09</td>
<td id="S4.T1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r">55.32</td>
<td id="S4.T1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_r">60.49</td>
<td id="S4.T1.1.10.10.6" class="ltx_td ltx_align_center ltx_border_r">70.34</td>
</tr>
<tr id="S4.T1.1.11.11" class="ltx_tr">
<th id="S4.T1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">DCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>
</th>
<td id="S4.T1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_r">66.87</td>
<td id="S4.T1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_r">83.51</td>
<td id="S4.T1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_r">46.61</td>
<td id="S4.T1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_r">57.26</td>
<td id="S4.T1.1.11.11.6" class="ltx_td ltx_align_center ltx_border_r">66.97</td>
</tr>
<tr id="S4.T1.1.12.12" class="ltx_tr">
<th id="S4.T1.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Counter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>
</th>
<td id="S4.T1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_r">68.09</td>
<td id="S4.T1.1.12.12.3" class="ltx_td ltx_align_center ltx_border_r">83.14</td>
<td id="S4.T1.1.12.12.4" class="ltx_td ltx_align_center ltx_border_r">51.62</td>
<td id="S4.T1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_r">58.97</td>
<td id="S4.T1.1.12.12.6" class="ltx_td ltx_align_center ltx_border_r">68.41</td>
</tr>
<tr id="S4.T1.1.13.13" class="ltx_tr">
<th id="S4.T1.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">JE-MHA (ours)</th>
<td id="S4.T1.1.13.13.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">69.70</td>
<td id="S4.T1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">86.30</td>
<td id="S4.T1.1.13.13.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">50.80</td>
<td id="S4.T1.1.13.13.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">59.90</td>
<td id="S4.T1.1.13.13.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">70.79</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>VQA performance comparisons between the proposed method and competing methods on the VQA v2 test-dev and test-std split.</figcaption>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Results for visual question answering with explanations ‣ 4 Experiments ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> lists the answer prediction accuracies of each category and the corresponding average values on the VQA v2 test-dev split and test-standard split.
We can see that the proposed JE-MHA VQA achieved 69.70% and 70.79 % accuracy on average, while the recent state-of-the-art method, MCAN VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> achieves 70.63% and 70.90% on the test-dev split and test-std split of the VQA v2 dataset, respectively. This is because the proposed method showed a little short ability to count numbers. Even though the proposed method showed slightly lower accuracy on the test-dev split, it has the advantage of a capability of human-understandable explanation generation. We believe that the explainability can be the most promising characteristic of the proposed framework. Furthermore, the proposed method showed it showed one of highest accuracy in test-std split, and the state-of-the-art performance on the validation split, of the VQA v2 dataset.
We conducted a comparison with additional ablation studies on validation split of VQA v2 dataset to show the effect of text feature: We compared the JE-MHA VQA model in two different settings: 1) visual features only and 2) visual features + text features.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.1" class="ltx_inline-block ltx_transformed_outer" style="width:441.1pt;height:109pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p id="S4.T2.1.1" class="ltx_p"><span id="S4.T2.1.1.1" class="ltx_text">
<span id="S4.T2.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="S4.T2.1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T2.1.1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Method</span>
<span id="S4.T2.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Visual</span>
<span id="S4.T2.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Textual</span>
<span id="S4.T2.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">All</span>
<span id="S4.T2.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes/No</span>
<span id="S4.T2.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Num</span>
<span id="S4.T2.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Other</span></span>
<span id="S4.T2.1.1.1.1.2.2" class="ltx_tr">
<span id="S4.T2.1.1.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Tell-Answer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite></span>
<span id="S4.T2.1.1.1.1.2.2.2" class="ltx_td ltx_border_r ltx_border_t"></span>
<span id="S4.T2.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✓</span>
<span id="S4.T2.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.9</span>
<span id="S4.T2.1.1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76.3</span>
<span id="S4.T2.1.1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">36.6</span>
<span id="S4.T2.1.1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">42.2</span></span>
<span id="S4.T2.1.1.1.1.3.3" class="ltx_tr">
<span id="S4.T2.1.1.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">JE-MHA VQA</span>
<span id="S4.T2.1.1.1.1.3.3.2" class="ltx_td ltx_border_r"></span>
<span id="S4.T2.1.1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r">✓</span>
<span id="S4.T2.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.1.1.1.3.3.4.1" class="ltx_text ltx_font_bold">56.8</span></span>
<span id="S4.T2.1.1.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.1.1.1.3.3.5.1" class="ltx_text ltx_font_bold">76.5</span></span>
<span id="S4.T2.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.1.1.1.3.3.6.1" class="ltx_text ltx_font_bold">37.2</span></span>
<span id="S4.T2.1.1.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.1.1.1.3.3.7.1" class="ltx_text ltx_font_bold">46.9</span></span></span>
<span id="S4.T2.1.1.1.1.4.4" class="ltx_tr">
<span id="S4.T2.1.1.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">MCAN VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite></span>
<span id="S4.T2.1.1.1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✓</span>
<span id="S4.T2.1.1.1.1.4.4.3" class="ltx_td ltx_border_r ltx_border_t"></span>
<span id="S4.T2.1.1.1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.4</span>
<span id="S4.T2.1.1.1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">84.3</span>
<span id="S4.T2.1.1.1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">48.2</span>
<span id="S4.T2.1.1.1.1.4.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.7</span></span>
<span id="S4.T2.1.1.1.1.5.5" class="ltx_tr">
<span id="S4.T2.1.1.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Caption VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite></span>
<span id="S4.T2.1.1.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">✓</span>
<span id="S4.T2.1.1.1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">✓</span>
<span id="S4.T2.1.1.1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r">65.8</span>
<span id="S4.T2.1.1.1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r">82.6</span>
<span id="S4.T2.1.1.1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_r">43.9</span>
<span id="S4.T2.1.1.1.1.5.5.7" class="ltx_td ltx_align_center ltx_border_r">56.4</span></span>
<span id="S4.T2.1.1.1.1.6.6" class="ltx_tr">
<span id="S4.T2.1.1.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">JE-MHA VQA (visdif+text)</span>
<span id="S4.T2.1.1.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">✓</span>
<span id="S4.T2.1.1.1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">✓</span>
<span id="S4.T2.1.1.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.1.1.1.6.6.4.1" class="ltx_text ltx_font_bold">66.7</span></span>
<span id="S4.T2.1.1.1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.1.1.1.6.6.5.1" class="ltx_text ltx_font_bold">84.6</span></span>
<span id="S4.T2.1.1.1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.1.1.1.6.6.6.1" class="ltx_text ltx_font_bold">48.3</span></span>
<span id="S4.T2.1.1.1.1.6.6.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.1.1.1.6.6.7.1" class="ltx_text ltx_font_bold">58.0</span></span></span>
</span>
</span></span></p>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>VQA performance comparisons with various input modalities on the VQA v2 validation split. “Visual” and “Textual” denote that the VQA models use visual or textual inputs, respectively.</figcaption>
</figure>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">The experimental result demonstrates the effectiveness of each component of the proposed framework as shown in Table 2.
The textual feature without visual information showed 56.8% on average, while the proposed model achieved 66.7% with both visual and textual information. From this experiment, we can see that a baseline model using the generated expressions underperforms the proposed method. The results of the Tell-Answer method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> indicate that learning appropriate text expressions without visual features for VQA tasks can also yield good answer prediction performances. The proposed method also exhibits the best accuracy when only textual inputs are used. It is noteworthy that the proposed method not only provides an excellent answer prediction ability but also can provide explanations for the answers.</p>
</div>
<div id="S4.F5" class="ltx_figure ltx_transformed_outer" style="width:219.0pt;height:352.8pt;vertical-align:-0.0pt;"><div class="ltx_transformed_inner" style="width:352.8pt;transform:translate(-66.93pt,-66.93pt) rotate(-90deg) ;"><figure><img src="/html/2101.08978/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="233" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Example VQA results with generated text explanations. The influential objects with the top three attention weights are indicated by bounding boxes. Each box is colored according to the importance of the corresponding visual feature, where darker red colors indicate higher weight.</figcaption>
</figure></div></div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.3 Results for visual question answering with explanations ‣ 4 Experiments ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> presents comparisons between the proposed method and the MCAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> model. The green text in first lines represents the original MCAN predictions, the blue text in second lines represents the answers of our model, and the “E” phrases in third lines represent the explanations generated from our model. Our approach not only yields superior performance, but also makes decisions understandable for humans by presenting natural language expressions.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2101.08978/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="177" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Qualitative comparison to the MCAN method in terms of answer prediction. The yellow boxes indicate the most-attended objects in our model and the corresponding expressions are provided below (E:).</figcaption>
</figure>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p">Additional examples of answer predictions with generated explanations are presented in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results for visual question answering with explanations ‣ 4 Experiments ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Two different questions are asked for each of the four images, and the information used for predicting answers is presented in order of importance.
The bounding boxes represent the most influential objects and their textual expressions with the top three attention weights. The generated human-readable sentences can also provide insights for interpreting the VQA model.
One can see that the bounding boxes of detected objects and generated explanations vary depending on the questions. The representational power of the speaker module is highlighted by the diverse expression generation in these examples.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Results for referring expression generation</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Since the proposed method aims to generate human-understandable text explanations for the answer predictions, we evaluated the quality of generated explanations by comparing them to those provided by state-of-the-art referring expression generation methods, including the speaker-listener-reinforcer (SLR) model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, re-implemented SLR (re-SLR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> and referring expression based on grand theft auto <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">V</annotation></semantics></math> (RefGTA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>.</p>
</div>
<div id="S4.T3" class="ltx_table ltx_transformed_outer" style="width:180.0pt;height:437pt;vertical-align:-0.0pt;"><div class="ltx_transformed_inner" style="width:437.0pt;transform:translate(-128.5pt,-128pt) rotate(-90deg) ;"><figure>
<div id="S4.T3.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:179pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-132.1pt,54.5pt) scale(0.621367254515152,0.621367254515152) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T3.1.1.1.1.1.1" class="ltx_text">Method</span></th>
<td id="S4.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T3.1.1.1.1.2.1" class="ltx_text">
<span id="S4.T3.1.1.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.1.1.1.1.2.1.1.1" class="ltx_tr">
<span id="S4.T3.1.1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Features</span></span>
<span id="S4.T3.1.1.1.1.2.1.1.2" class="ltx_tr">
<span id="S4.T3.1.1.1.1.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">from.</span></span>
</span></span></td>
<td id="S4.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">RefCOCO</td>
<td id="S4.T3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">RefCOCO+</td>
<td id="S4.T3.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">RefCOCOg</td>
</tr>
<tr id="S4.T3.1.1.2.2" class="ltx_tr">
<td id="S4.T3.1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Test A</td>
<td id="S4.T3.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Test B</td>
<td id="S4.T3.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Test A</td>
<td id="S4.T3.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Test B</td>
<td id="S4.T3.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Val</td>
</tr>
<tr id="S4.T3.1.1.3.3" class="ltx_tr">
<td id="S4.T3.1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Meteor</td>
<td id="S4.T3.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CIDEr</td>
<td id="S4.T3.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Meteor</td>
<td id="S4.T3.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CIDEr</td>
<td id="S4.T3.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Meteor</td>
<td id="S4.T3.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CIDEr</td>
<td id="S4.T3.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Meteor</td>
<td id="S4.T3.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CIDEr</td>
<td id="S4.T3.1.1.3.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Meteor</td>
<td id="S4.T3.1.1.3.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CIDEr</td>
</tr>
<tr id="S4.T3.1.1.4.4" class="ltx_tr">
<th id="S4.T3.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">SLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S4.T3.1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">VGGNet</td>
<td id="S4.T3.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.268</td>
<td id="S4.T3.1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.697</td>
<td id="S4.T3.1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.329</td>
<td id="S4.T3.1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.323</td>
<td id="S4.T3.1.1.4.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.204</td>
<td id="S4.T3.1.1.4.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.494</td>
<td id="S4.T3.1.1.4.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.202</td>
<td id="S4.T3.1.1.4.4.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.709</td>
<td id="S4.T3.1.1.4.4.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.154</td>
<td id="S4.T3.1.1.4.4.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.592</td>
</tr>
<tr id="S4.T3.1.1.5.5" class="ltx_tr">
<th id="S4.T3.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">SLR+rerank</th>
<td id="S4.T3.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">VGGNet</td>
<td id="S4.T3.1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">0.296</td>
<td id="S4.T3.1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r">0.717</td>
<td id="S4.T3.1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r">0.340</td>
<td id="S4.T3.1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_r">1.320</td>
<td id="S4.T3.1.1.5.5.7" class="ltx_td ltx_align_center ltx_border_r">0.213</td>
<td id="S4.T3.1.1.5.5.8" class="ltx_td ltx_align_center ltx_border_r">0.520</td>
<td id="S4.T3.1.1.5.5.9" class="ltx_td ltx_align_center ltx_border_r">0.215</td>
<td id="S4.T3.1.1.5.5.10" class="ltx_td ltx_align_center ltx_border_r">0.735</td>
<td id="S4.T3.1.1.5.5.11" class="ltx_td ltx_align_center ltx_border_r">0.159</td>
<td id="S4.T3.1.1.5.5.12" class="ltx_td ltx_align_center ltx_border_r">0.662</td>
</tr>
<tr id="S4.T3.1.1.6.6" class="ltx_tr">
<th id="S4.T3.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">re-SLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>
</th>
<td id="S4.T3.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">VGGNet</td>
<td id="S4.T3.1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.279</td>
<td id="S4.T3.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.729</td>
<td id="S4.T3.1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.334</td>
<td id="S4.T3.1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.315</td>
<td id="S4.T3.1.1.6.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.201</td>
<td id="S4.T3.1.1.6.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.491</td>
<td id="S4.T3.1.1.6.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.211</td>
<td id="S4.T3.1.1.6.6.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.757</td>
<td id="S4.T3.1.1.6.6.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.146</td>
<td id="S4.T3.1.1.6.6.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.679</td>
</tr>
<tr id="S4.T3.1.1.7.7" class="ltx_tr">
<th id="S4.T3.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">re-SLR+rerank</th>
<td id="S4.T3.1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r">VGGNet</td>
<td id="S4.T3.1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">0.278</td>
<td id="S4.T3.1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r">0.717</td>
<td id="S4.T3.1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_r">0.332</td>
<td id="S4.T3.1.1.7.7.6" class="ltx_td ltx_align_center ltx_border_r">1.262</td>
<td id="S4.T3.1.1.7.7.7" class="ltx_td ltx_align_center ltx_border_r">0.198</td>
<td id="S4.T3.1.1.7.7.8" class="ltx_td ltx_align_center ltx_border_r">0.476</td>
<td id="S4.T3.1.1.7.7.9" class="ltx_td ltx_align_center ltx_border_r">0.206</td>
<td id="S4.T3.1.1.7.7.10" class="ltx_td ltx_align_center ltx_border_r">0.721</td>
<td id="S4.T3.1.1.7.7.11" class="ltx_td ltx_align_center ltx_border_r">0.150</td>
<td id="S4.T3.1.1.7.7.12" class="ltx_td ltx_align_center ltx_border_r">0.676</td>
</tr>
<tr id="S4.T3.1.1.8.8" class="ltx_tr">
<th id="S4.T3.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">re-SLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>
</th>
<td id="S4.T3.1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ResNet</td>
<td id="S4.T3.1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.296</td>
<td id="S4.T3.1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.804</td>
<td id="S4.T3.1.1.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.341</td>
<td id="S4.T3.1.1.8.8.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.358</td>
<td id="S4.T3.1.1.8.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.220</td>
<td id="S4.T3.1.1.8.8.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.579</td>
<td id="S4.T3.1.1.8.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.221</td>
<td id="S4.T3.1.1.8.8.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.798</td>
<td id="S4.T3.1.1.8.8.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.153</td>
<td id="S4.T3.1.1.8.8.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.742</td>
</tr>
<tr id="S4.T3.1.1.9.9" class="ltx_tr">
<th id="S4.T3.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">RefGTA SR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>
</th>
<td id="S4.T3.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ResNet</td>
<td id="S4.T3.1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.307</td>
<td id="S4.T3.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.865</td>
<td id="S4.T3.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.343</td>
<td id="S4.T3.1.1.9.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.381</td>
<td id="S4.T3.1.1.9.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.242</td>
<td id="S4.T3.1.1.9.9.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.671</td>
<td id="S4.T3.1.1.9.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.220</td>
<td id="S4.T3.1.1.9.9.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.812</td>
<td id="S4.T3.1.1.9.9.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.164</td>
<td id="S4.T3.1.1.9.9.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.738</td>
</tr>
<tr id="S4.T3.1.1.10.10" class="ltx_tr">
<th id="S4.T3.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">RefGTA SR+rerank</th>
<td id="S4.T3.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r">ResNet</td>
<td id="S4.T3.1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r">0.310</td>
<td id="S4.T3.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r">0.842</td>
<td id="S4.T3.1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.1.1.10.10.5.1" class="ltx_text ltx_font_bold">0.348</span></td>
<td id="S4.T3.1.1.10.10.6" class="ltx_td ltx_align_center ltx_border_r">1.356</td>
<td id="S4.T3.1.1.10.10.7" class="ltx_td ltx_align_center ltx_border_r">0.241</td>
<td id="S4.T3.1.1.10.10.8" class="ltx_td ltx_align_center ltx_border_r">0.656</td>
<td id="S4.T3.1.1.10.10.9" class="ltx_td ltx_align_center ltx_border_r">0.219</td>
<td id="S4.T3.1.1.10.10.10" class="ltx_td ltx_align_center ltx_border_r">0.782</td>
<td id="S4.T3.1.1.10.10.11" class="ltx_td ltx_align_center ltx_border_r">0.167</td>
<td id="S4.T3.1.1.10.10.12" class="ltx_td ltx_align_center ltx_border_r">0.773</td>
</tr>
<tr id="S4.T3.1.1.11.11" class="ltx_tr">
<th id="S4.T3.1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">RefGTA SLR</th>
<td id="S4.T3.1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ResNet</td>
<td id="S4.T3.1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.310</td>
<td id="S4.T3.1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.859</td>
<td id="S4.T3.1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.342</td>
<td id="S4.T3.1.1.11.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.375</td>
<td id="S4.T3.1.1.11.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.241</td>
<td id="S4.T3.1.1.11.11.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.663</td>
<td id="S4.T3.1.1.11.11.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.225</td>
<td id="S4.T3.1.1.11.11.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.812</td>
<td id="S4.T3.1.1.11.11.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.164</td>
<td id="S4.T3.1.1.11.11.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.763</td>
</tr>
<tr id="S4.T3.1.1.12.12" class="ltx_tr">
<th id="S4.T3.1.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">RefGTA SLR+rerank</th>
<td id="S4.T3.1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_r">ResNet</td>
<td id="S4.T3.1.1.12.12.3" class="ltx_td ltx_align_center ltx_border_r">0.313</td>
<td id="S4.T3.1.1.12.12.4" class="ltx_td ltx_align_center ltx_border_r">0.837</td>
<td id="S4.T3.1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_r">0.341</td>
<td id="S4.T3.1.1.12.12.6" class="ltx_td ltx_align_center ltx_border_r">1.329</td>
<td id="S4.T3.1.1.12.12.7" class="ltx_td ltx_align_center ltx_border_r">0.242</td>
<td id="S4.T3.1.1.12.12.8" class="ltx_td ltx_align_center ltx_border_r">0.664</td>
<td id="S4.T3.1.1.12.12.9" class="ltx_td ltx_align_center ltx_border_r">0.228</td>
<td id="S4.T3.1.1.12.12.10" class="ltx_td ltx_align_center ltx_border_r">0.787</td>
<td id="S4.T3.1.1.12.12.11" class="ltx_td ltx_align_center ltx_border_r">0.170</td>
<td id="S4.T3.1.1.12.12.12" class="ltx_td ltx_align_center ltx_border_r">0.777</td>
</tr>
<tr id="S4.T3.1.1.13.13" class="ltx_tr">
<th id="S4.T3.1.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Our SR</th>
<td id="S4.T3.1.1.13.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ResNet</td>
<td id="S4.T3.1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.119</td>
<td id="S4.T3.1.1.13.13.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.230</td>
<td id="S4.T3.1.1.13.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.100</td>
<td id="S4.T3.1.1.13.13.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.162</td>
<td id="S4.T3.1.1.13.13.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.152</td>
<td id="S4.T3.1.1.13.13.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.316</td>
<td id="S4.T3.1.1.13.13.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.114</td>
<td id="S4.T3.1.1.13.13.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.398</td>
<td id="S4.T3.1.1.13.13.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.086</td>
<td id="S4.T3.1.1.13.13.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.223</td>
</tr>
<tr id="S4.T3.1.1.14.14" class="ltx_tr">
<th id="S4.T3.1.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Our SR+rerank</th>
<td id="S4.T3.1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_r">ResNet</td>
<td id="S4.T3.1.1.14.14.3" class="ltx_td ltx_align_center ltx_border_r">0.163</td>
<td id="S4.T3.1.1.14.14.4" class="ltx_td ltx_align_center ltx_border_r">0.303</td>
<td id="S4.T3.1.1.14.14.5" class="ltx_td ltx_align_center ltx_border_r">0.136</td>
<td id="S4.T3.1.1.14.14.6" class="ltx_td ltx_align_center ltx_border_r">0.191</td>
<td id="S4.T3.1.1.14.14.7" class="ltx_td ltx_align_center ltx_border_r">0.176</td>
<td id="S4.T3.1.1.14.14.8" class="ltx_td ltx_align_center ltx_border_r">0.405</td>
<td id="S4.T3.1.1.14.14.9" class="ltx_td ltx_align_center ltx_border_r">0.124</td>
<td id="S4.T3.1.1.14.14.10" class="ltx_td ltx_align_center ltx_border_r">0.442</td>
<td id="S4.T3.1.1.14.14.11" class="ltx_td ltx_align_center ltx_border_r">0.092</td>
<td id="S4.T3.1.1.14.14.12" class="ltx_td ltx_align_center ltx_border_r">0.258</td>
</tr>
<tr id="S4.T3.1.1.15.15" class="ltx_tr">
<th id="S4.T3.1.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Our SLR</th>
<td id="S4.T3.1.1.15.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ResNet</td>
<td id="S4.T3.1.1.15.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.322</td>
<td id="S4.T3.1.1.15.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.905</td>
<td id="S4.T3.1.1.15.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.342</td>
<td id="S4.T3.1.1.15.15.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.1.1.15.15.6.1" class="ltx_text ltx_font_bold">1.393</span></td>
<td id="S4.T3.1.1.15.15.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.260</td>
<td id="S4.T3.1.1.15.15.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.722</td>
<td id="S4.T3.1.1.15.15.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.235</td>
<td id="S4.T3.1.1.15.15.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.1.1.15.15.10.1" class="ltx_text ltx_font_bold">0.853</span></td>
<td id="S4.T3.1.1.15.15.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.177</td>
<td id="S4.T3.1.1.15.15.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.1.1.15.15.12.1" class="ltx_text ltx_font_bold">0.896</span></td>
</tr>
<tr id="S4.T3.1.1.16.16" class="ltx_tr">
<th id="S4.T3.1.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">Our SLR+rerank</th>
<td id="S4.T3.1.1.16.16.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">ResNet</td>
<td id="S4.T3.1.1.16.16.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.1.1.16.16.3.1" class="ltx_text ltx_font_bold">0.324</span></td>
<td id="S4.T3.1.1.16.16.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.1.1.16.16.4.1" class="ltx_text ltx_font_bold">0.905</span></td>
<td id="S4.T3.1.1.16.16.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.346</td>
<td id="S4.T3.1.1.16.16.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">1.362</td>
<td id="S4.T3.1.1.16.16.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.1.1.16.16.7.1" class="ltx_text ltx_font_bold">0.276</span></td>
<td id="S4.T3.1.1.16.16.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.1.1.16.16.8.1" class="ltx_text ltx_font_bold">0.769</span></td>
<td id="S4.T3.1.1.16.16.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.1.1.16.16.9.1" class="ltx_text ltx_font_bold">0.235</span></td>
<td id="S4.T3.1.1.16.16.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.832</td>
<td id="S4.T3.1.1.16.16.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.1.1.16.16.11.1" class="ltx_text ltx_font_bold">0.177</span></td>
<td id="S4.T3.1.1.16.16.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.854</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparison of our results to the state-of-the-art methods for referring expression generation for the RefCOCO, RefCOCO+, and RefCOCOg datasets. “+rerank” indicates re-ranking the generated expressions according to the listener module. “SLR” denotes the original SLR model and “re-SLR” is a re-implemented version that uses ResNet image features as inputs.</figcaption>
</figure></div></div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">The experimental results in Table <a href="#S4.T3" title="Table 3 ‣ 4.4 Results for referring expression generation ‣ 4 Experiments ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> demonstrate that a reranking mechanism combined with a listener module improves expression quality in general, but such a combination is not very effective for the RefGTA model.
In particular, the speaker-reinforcer (SR) model yields worse performance than the SLR model. However, in our expression generation module, because our listener module can locate the referred objects accurately, better expressions are generated and our method outperforms all competing methods, including the RefGTA model.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2101.08978/assets/x7.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="137" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Qualitative results for our referring expression generator on the RefCOCOg validation set and comparisons to the SLR model. Because the RefCOCOg dataset consist of longer sentences than RefCOCO, RefCOCO+, we trained our expression generator using the RefCOCOg dataset. </figcaption>
</figure>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">For the qualitative comparison, we also compared our generated expressions to those generated by SLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> on RefCOCOg dataset, which was used to generate textual expressions for VQA.
Fig. <a href="#S4.F7" title="Figure 7 ‣ 4.4 Results for referring expression generation ‣ 4 Experiments ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> presents the generated expressions and target objects.
One can observe that if the target object is occluded by other objects, our model understands the surrounding environment more accurately and generates less ambiguous sentences compared to SLR. This is important because our speaker module can generate referring expressions in complex situations, wherein ambiguous objects must be considered.</p>
</div>
<section id="S4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span>Comprehensive evaluation</h4>

<div id="S4.SS4.SSS1.p1" class="ltx_para">
<p id="S4.SS4.SSS1.p1.3" class="ltx_p">In this section, we evaluate the performance of the speaker, listener, and reinforcer modules comprehensively to show the effects of each module for expression generation.
Our model is compared to the RefGTA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> and SLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> models, which are based on SLR strategies, for evaluation. We calculated scores for the reinforcer/speaker modules using the ground-truth bounding boxes for all objects given <math id="S4.SS4.SSS1.p1.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS4.SSS1.p1.1.m1.1a"><mi id="S4.SS4.SSS1.p1.1.m1.1.1" xref="S4.SS4.SSS1.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.1.m1.1b"><ci id="S4.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.1.m1.1c">r</annotation></semantics></math>, <math id="S4.SS4.SSS1.p1.2.m2.2" class="ltx_Math" alttext="o^{*}=argmax_{i}F(r,o_{i})" display="inline"><semantics id="S4.SS4.SSS1.p1.2.m2.2a"><mrow id="S4.SS4.SSS1.p1.2.m2.2.2" xref="S4.SS4.SSS1.p1.2.m2.2.2.cmml"><msup id="S4.SS4.SSS1.p1.2.m2.2.2.3" xref="S4.SS4.SSS1.p1.2.m2.2.2.3.cmml"><mi id="S4.SS4.SSS1.p1.2.m2.2.2.3.2" xref="S4.SS4.SSS1.p1.2.m2.2.2.3.2.cmml">o</mi><mo id="S4.SS4.SSS1.p1.2.m2.2.2.3.3" xref="S4.SS4.SSS1.p1.2.m2.2.2.3.3.cmml">∗</mo></msup><mo id="S4.SS4.SSS1.p1.2.m2.2.2.2" xref="S4.SS4.SSS1.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S4.SS4.SSS1.p1.2.m2.2.2.1" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.cmml"><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.3" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.2.2.1.2" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.4" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.2.2.1.2a" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.5" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.2.2.1.2b" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.6" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.2.2.1.2c" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.7" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.2.2.1.2d" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.2.cmml">​</mo><msub id="S4.SS4.SSS1.p1.2.m2.2.2.1.8" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.8.cmml"><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.8.2" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.8.2.cmml">x</mi><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.8.3" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.8.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.2.2.1.2e" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.9" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.9.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.2.2.1.2f" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.2.cmml">​</mo><mrow id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.2" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.2.cmml">(</mo><mi id="S4.SS4.SSS1.p1.2.m2.1.1" xref="S4.SS4.SSS1.p1.2.m2.1.1.cmml">r</mi><mo id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.3" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.2.cmml">,</mo><msub id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.2" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.2.cmml">o</mi><mi id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.3" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.4" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.2.m2.2b"><apply id="S4.SS4.SSS1.p1.2.m2.2.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2"><eq id="S4.SS4.SSS1.p1.2.m2.2.2.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.2"></eq><apply id="S4.SS4.SSS1.p1.2.m2.2.2.3.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.3"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.2.m2.2.2.3.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.3">superscript</csymbol><ci id="S4.SS4.SSS1.p1.2.m2.2.2.3.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.3.2">𝑜</ci><times id="S4.SS4.SSS1.p1.2.m2.2.2.3.3.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.3.3"></times></apply><apply id="S4.SS4.SSS1.p1.2.m2.2.2.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1"><times id="S4.SS4.SSS1.p1.2.m2.2.2.1.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.2"></times><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.3.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.3">𝑎</ci><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.4.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.4">𝑟</ci><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.5.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.5">𝑔</ci><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.6.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.6">𝑚</ci><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.7.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.7">𝑎</ci><apply id="S4.SS4.SSS1.p1.2.m2.2.2.1.8.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.8"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.2.m2.2.2.1.8.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.8">subscript</csymbol><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.8.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.8.2">𝑥</ci><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.8.3.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.8.3">𝑖</ci></apply><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.9.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.9">𝐹</ci><interval closure="open" id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1"><ci id="S4.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1">𝑟</ci><apply id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.2">𝑜</ci><ci id="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S4.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.2.m2.2c">o^{*}=argmax_{i}F(r,o_{i})</annotation></semantics></math>, and <math id="S4.SS4.SSS1.p1.3.m3.1" class="ltx_Math" alttext="o^{*}=argmax_{i}P(r|o_{i})" display="inline"><semantics id="S4.SS4.SSS1.p1.3.m3.1a"><mrow id="S4.SS4.SSS1.p1.3.m3.1.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.cmml"><msup id="S4.SS4.SSS1.p1.3.m3.1.1.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.3.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.2.cmml">o</mi><mo id="S4.SS4.SSS1.p1.3.m3.1.1.3.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.3.cmml">∗</mo></msup><mo id="S4.SS4.SSS1.p1.3.m3.1.1.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.cmml">=</mo><mrow id="S4.SS4.SSS1.p1.3.m3.1.1.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.3.m3.1.1.1.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.4" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.3.m3.1.1.1.2a" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.5" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.3.m3.1.1.1.2b" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.6" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.3.m3.1.1.1.2c" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.7" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.3.m3.1.1.1.2d" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.2.cmml">​</mo><msub id="S4.SS4.SSS1.p1.3.m3.1.1.1.8" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.8.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.8.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.8.2.cmml">x</mi><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.8.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.8.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.3.m3.1.1.1.2e" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.2.cmml">​</mo><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.9" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.9.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.3.m3.1.1.1.2f" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.2.cmml">​</mo><mrow id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.2.cmml">r</mi><mo fence="false" id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.2.cmml">o</mi><mi id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.3.m3.1b"><apply id="S4.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1"><eq id="S4.SS4.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.2"></eq><apply id="S4.SS4.SSS1.p1.3.m3.1.1.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS4.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.2">𝑜</ci><times id="S4.SS4.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.3"></times></apply><apply id="S4.SS4.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1"><times id="S4.SS4.SSS1.p1.3.m3.1.1.1.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.2"></times><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.3">𝑎</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.4.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.4">𝑟</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.5.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.5">𝑔</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.6.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.6">𝑚</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.7.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.7">𝑎</ci><apply id="S4.SS4.SSS1.p1.3.m3.1.1.1.8.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.8"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.3.m3.1.1.1.8.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.8">subscript</csymbol><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.8.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.8.2">𝑥</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.8.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.8.3">𝑖</ci></apply><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.9.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.9">𝑃</ci><apply id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.2">𝑟</ci><apply id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.2">𝑜</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.3.m3.1c">o^{*}=argmax_{i}P(r|o_{i})</annotation></semantics></math>.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<div id="S4.T4.1" class="ltx_inline-block ltx_transformed_outer" style="width:502.8pt;height:253pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p id="S4.T4.1.1" class="ltx_p"><span id="S4.T4.1.1.1" class="ltx_text">
<span id="S4.T4.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="S4.T4.1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T4.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2"><span id="S4.T4.1.1.1.1.1.1.1.1" class="ltx_text">Method</span></span>
<span id="S4.T4.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_colspan ltx_colspan_2">RefCOCO</span>
<span id="S4.T4.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_colspan ltx_colspan_2">RefCOCO+</span>
<span id="S4.T4.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">RefCOCOg</span></span>
<span id="S4.T4.1.1.1.1.2.2" class="ltx_tr">
<span id="S4.T4.1.1.1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Test A</span>
<span id="S4.T4.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Test B</span>
<span id="S4.T4.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Test A</span>
<span id="S4.T4.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Test B</span>
<span id="S4.T4.1.1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Val</span></span>
<span id="S4.T4.1.1.1.1.3.3" class="ltx_tr">
<span id="S4.T4.1.1.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">SLR (ensemble) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite></span>
<span id="S4.T4.1.1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">80.08%</span>
<span id="S4.T4.1.1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">81.73%</span>
<span id="S4.T4.1.1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.40%</span>
<span id="S4.T4.1.1.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.73%</span>
<span id="S4.T4.1.1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">74.19%</span></span>
<span id="S4.T4.1.1.1.1.4.4" class="ltx_tr">
<span id="S4.T4.1.1.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">re-SLR(ensemble) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite></span>
<span id="S4.T4.1.1.1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r">78.43%</span>
<span id="S4.T4.1.1.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">81.33%</span>
<span id="S4.T4.1.1.1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r">64.57%</span>
<span id="S4.T4.1.1.1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r">60.48%</span>
<span id="S4.T4.1.1.1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_r">70.95%</span></span>
<span id="S4.T4.1.1.1.1.5.5" class="ltx_tr">
<span id="S4.T4.1.1.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">re-SLR (listener)</span>
<span id="S4.T4.1.1.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">81.14%</span>
<span id="S4.T4.1.1.1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">80.80%</span>
<span id="S4.T4.1.1.1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.16%</span>
<span id="S4.T4.1.1.1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59.69%</span>
<span id="S4.T4.1.1.1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.36%</span></span>
<span id="S4.T4.1.1.1.1.6.6" class="ltx_tr">
<span id="S4.T4.1.1.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">RefGTA SLR (listener) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite></span>
<span id="S4.T4.1.1.1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r">79.05%</span>
<span id="S4.T4.1.1.1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">80.31%</span>
<span id="S4.T4.1.1.1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r">65.75%</span>
<span id="S4.T4.1.1.1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r">62.18%</span>
<span id="S4.T4.1.1.1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_r">73.39%</span></span>
<span id="S4.T4.1.1.1.1.7.7" class="ltx_tr">
<span id="S4.T4.1.1.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Our SLR (listener)</span>
<span id="S4.T4.1.1.1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.1.1.1.1.7.7.2.1" class="ltx_text ltx_font_bold">82.67%</span></span>
<span id="S4.T4.1.1.1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">78.83%</span>
<span id="S4.T4.1.1.1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.1.1.1.1.7.7.4.1" class="ltx_text ltx_font_bold">75.80%</span></span>
<span id="S4.T4.1.1.1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.1.1.1.1.7.7.5.1" class="ltx_text ltx_font_bold">63.69%</span></span>
<span id="S4.T4.1.1.1.1.7.7.6" class="ltx_td ltx_align_center ltx_border_r">78.35%</span></span>
<span id="S4.T4.1.1.1.1.8.8" class="ltx_tr">
<span id="S4.T4.1.1.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">RefGTA SR (reinforcer)</span>
<span id="S4.T4.1.1.1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r">80.44%</span>
<span id="S4.T4.1.1.1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.1.1.1.1.8.8.3.1" class="ltx_text ltx_font_bold">81.04%</span></span>
<span id="S4.T4.1.1.1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r">67.81%</span>
<span id="S4.T4.1.1.1.1.8.8.5" class="ltx_td ltx_align_center ltx_border_r">58.97%</span>
<span id="S4.T4.1.1.1.1.8.8.6" class="ltx_td ltx_align_center ltx_border_r">74.94%</span></span>
<span id="S4.T4.1.1.1.1.9.9" class="ltx_tr">
<span id="S4.T4.1.1.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Our SR (reinforcer)</span>
<span id="S4.T4.1.1.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r">82.17%</span>
<span id="S4.T4.1.1.1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r">79.04%</span>
<span id="S4.T4.1.1.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_r">74.88%</span>
<span id="S4.T4.1.1.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_r">62.81%</span>
<span id="S4.T4.1.1.1.1.9.9.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.1.1.1.1.9.9.6.1" class="ltx_text ltx_font_bold">78.41%</span></span></span>
<span id="S4.T4.1.1.1.1.10.10" class="ltx_tr">
<span id="S4.T4.1.1.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">re-SLR (speaker)</span>
<span id="S4.T4.1.1.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">80.70%</span>
<span id="S4.T4.1.1.1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">81.71%</span>
<span id="S4.T4.1.1.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.91%</span>
<span id="S4.T4.1.1.1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.77%</span>
<span id="S4.T4.1.1.1.1.10.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.55%</span></span>
<span id="S4.T4.1.1.1.1.11.11" class="ltx_tr">
<span id="S4.T4.1.1.1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">RefGTA SR (speaker)</span>
<span id="S4.T4.1.1.1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_r">82.45%</span>
<span id="S4.T4.1.1.1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.1.1.1.1.11.11.3.1" class="ltx_text ltx_font_bold">82.00%</span></span>
<span id="S4.T4.1.1.1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_r">72.07%</span>
<span id="S4.T4.1.1.1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_r">61.06%</span>
<span id="S4.T4.1.1.1.1.11.11.6" class="ltx_td ltx_align_center ltx_border_r">70.35%</span></span>
<span id="S4.T4.1.1.1.1.12.12" class="ltx_tr">
<span id="S4.T4.1.1.1.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">RefGTA SLR (speaker)</span>
<span id="S4.T4.1.1.1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_r">83.05%</span>
<span id="S4.T4.1.1.1.1.12.12.3" class="ltx_td ltx_align_center ltx_border_r">81.84%</span>
<span id="S4.T4.1.1.1.1.12.12.4" class="ltx_td ltx_align_center ltx_border_r">72.37%</span>
<span id="S4.T4.1.1.1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_r">59.13%</span>
<span id="S4.T4.1.1.1.1.12.12.6" class="ltx_td ltx_align_center ltx_border_r">74.79%</span></span>
<span id="S4.T4.1.1.1.1.13.13" class="ltx_tr">
<span id="S4.T4.1.1.1.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Our SR (speaker)</span>
<span id="S4.T4.1.1.1.1.13.13.2" class="ltx_td ltx_align_center ltx_border_r">67.98%</span>
<span id="S4.T4.1.1.1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_r">64.83%</span>
<span id="S4.T4.1.1.1.1.13.13.4" class="ltx_td ltx_align_center ltx_border_r">61.04%</span>
<span id="S4.T4.1.1.1.1.13.13.5" class="ltx_td ltx_align_center ltx_border_r">48.40%</span>
<span id="S4.T4.1.1.1.1.13.13.6" class="ltx_td ltx_align_center ltx_border_r">63.85%</span></span>
<span id="S4.T4.1.1.1.1.14.14" class="ltx_tr">
<span id="S4.T4.1.1.1.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">Our SLR (speaker)</span>
<span id="S4.T4.1.1.1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.1.1.1.1.14.14.2.1" class="ltx_text ltx_font_bold">83.21%</span></span>
<span id="S4.T4.1.1.1.1.14.14.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">78.55%</span>
<span id="S4.T4.1.1.1.1.14.14.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.1.1.1.1.14.14.4.1" class="ltx_text ltx_font_bold">76.40%</span></span>
<span id="S4.T4.1.1.1.1.14.14.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.1.1.1.1.14.14.5.1" class="ltx_text ltx_font_bold">63.75%</span></span>
<span id="S4.T4.1.1.1.1.14.14.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.1.1.1.1.14.14.6.1" class="ltx_text ltx_font_bold">78.31%</span></span></span>
</span>
</span></span></p>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comprehensive evaluations on the RefCOCO, RefCOCO+, and RefCOCOg datasets. “Ensemble” indicates using both the speaker and listener or reinforcer. Our three modules (speaker, listener, reinforcer) exhibit improved performance in most cases compared to the state-of-the-art methods.</figcaption>
</figure>
<div id="S4.SS4.SSS1.p2" class="ltx_para">
<p id="S4.SS4.SSS1.p2.1" class="ltx_p">The results of our expression comprehension experiments are listed in Table <a href="#S4.T4" title="Table 4 ‣ 4.4.1 Comprehensive evaluation ‣ 4.4 Results for referring expression generation ‣ 4 Experiments ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The listener module plays a more important role in our model than in other models. This is because our system considers the neighboring features of each target object. As a result, our method can improve the performance of the listener module by selecting a local-scene-aware context feature to generate unambiguous expressions.</p>
</div>
</section>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Effectiveness of adjusting top-down attention</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">The proposed method also has an advantage in its ability to adjust top-down attention weights based on local-scene-aware context analysis. In addition to providing explanations, our model can focus and understand detailed images and questions.</p>
</div>
<figure id="S4.F8" class="ltx_figure"><img src="/html/2101.08978/assets/x8.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_img_square" width="369" height="383" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Two examples of object-expression-based attention adjustment. The object expressions help the VQA model adjust visual attention more accurately. “C” and “E” denote image captions and explanations, respectively.
</figcaption>
</figure>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">Fig. <a href="#S4.F8" title="Figure 8 ‣ 4.5 Effectiveness of adjusting top-down attention ‣ 4 Experiments ‣ Visual Question Answering based on Local-Scene-Aware Referring Expression Generation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> demonstrates that our model can attend regions in complex scenes accurately. We compared our model to the Tell-Answer model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> to verify its effectiveness. Each box in the figure above represents the most attended region for predicting a final answer. In other words, the boxes represent the main focal areas of our model.
In the second example, our model also handles ambiguous references such as “yellow one” well.
One can see that using generated expressions helps our model accurately attend regions and understand questions in relatively complex VQA scenes.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We proposed a novel JE-MHA framework for visual question answering with explanations. The proposed speaker module generates local-scene-aware text expressions considering the spatial context of neighboring features. The resulting high-quality object expressions are combined with visual features and question embeddings through the proposed JE-MHA network.
Owing to representational power of text expressions, and co-attention of multimodal embedding, our VQA model can successfully predict answers for questions and provide rich explanations regarding scenes and questions.
Experimental results showed state-of-the-art performance on the VQA v2 dataset for answer prediction. We also showed expression quality using the RefCOCO, RefCOCO+, and RefCOCOg datasets by comparing different expression generation methods. Qualitative results for the generated expressions indicated that the proposed method can accurately answer questions when scenes are complex. In the future, we will extend our work on VQA with explanations to video data.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported by Institute for Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government (MSIT) (No. 2017-0-01779, A machine learning and statistical inference framework for explainable artificial intelligence, and No. 2019-0-00079, Artificial Intelligence Graduate School Program, Korea University).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
P. Anderson, X. He, C. Buehler, D. Teney, M. Johnson, S. Gould, L. Zhang,
Bottom-up and top-down attention for image captioning and visual question
answering, in: Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition, 2018, pp. 6077–6086.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Fukui, D. H. Park, D. Yang, A. Rohrbach, T. Darrell, M. Rohrbach, Multimodal
compact bilinear pooling for visual question answering and visual grounding,
in: Proceedings of the Conference on Empirical Methods in Natural Language
Processing, 2016, pp. 457–468.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
H. Ben-Younes, R. Cadene, M. Cord, N. Thome, Mutan: Multimodal tucker fusion
for visual question answering, in: Proceedings of the IEEE International
Conference on Computer Vision, 2017, pp. 2612–2620.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. Lawrence Zitnick,
D. Parikh, Vqa: Visual question answering, in: Proceedings of the IEEE
International Conference on Computer Vision, 2015, pp. 2425–2433.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Y. Goyal, T. Khot, D. Summers-Stay, D. Batra, D. Parikh, Making the v in vqa
matter: Elevating the role of image understanding in visual question
answering, in: Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition, 2017, pp. 6904–6913.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Z. Yu, J. Yu, Y. Cui, D. Tao, Q. Tian, Deep modular co-attention networks for
visual question answering, in: Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition, 2019, pp. 6281–6290.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
D. Teney, P. Anderson, X. He, A. Van Den Hengel, Tips and tricks for visual
question answering: Learnings from the 2017 challenge, in: Proceedings of the
IEEE Conference on Computer Vision and Pattern Recognition, 2018, pp.
4223–4232.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
P. Lu, L. Ji, W. Zhang, N. Duan, M. Zhou, J. Wang, R-vqa: Learning visual
relation facts with semantic attention for visual question answering, in:
Proceedings of the International Conference on Knowledge Discovery &amp; Data
Mining, 2018, pp. 1880–1889.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
S. Ren, K. He, R. Girshick, J. Sun, Faster r-cnn: Towards real-time object
detection with region proposal networks, in: Advances in Neural Information
Processing Systems, 2015, pp. 91–99.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. J. Rennie, E. Marcheret, Y. Mroueh, J. Ross, V. Goel, Self-critical sequence
training for image captioning, in: Proceedings of the IEEE Conference on
Computer Vision and Pattern Recognition, 2017, pp. 7008–7024.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
J. Lu, C. Xiong, D. Parikh, R. Socher, Knowing when to look: Adaptive attention
via a visual sentinel for image captioning, in: Proceedings of the IEEE
Conference on Computer Vision and Pattern Recognition, 2017, pp. 375–383.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
M. Pedersoli, T. Lucas, C. Schmid, J. Verbeek, Areas of attention for image
captioning, in: Proceedings of the IEEE International Conference on Computer
Vision, 2017, pp. 1242–1250.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
J. Liu, L. Wang, M.-H. Yang, Referring expression generation and comprehension
via attributes, in: Proceedings of the IEEE International Conference on
Computer Vision, 2017, pp. 4856–4864.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
L. Yu, H. Tan, M. Bansal, T. L. Berg, A joint speaker-listener-reinforcer model
for referring expressions, in: Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition, 2017, pp. 7282–7290.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M.-C. Roh, T.-Y. Kim, J. Park, S.-W. Lee, Accurate object contour tracking
based on boundary edge selection, Pattern Recognition 40 (3) (2007) 931–943.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
U. Park, H.-C. Choi, A. K. Jain, S.-W. Lee, Face tracking and recognition at a
distance: A coaxial and concentric ptz camera system, IEEE Transactions on
Information Forensics and Security 8 (10) (2013) 1665–1677.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
H. Maeng, S. Liao, D. Kang, S.-W. Lee, A. K. Jain, Nighttime face recognition
at long distance: Cross-distance and cross-spectral matching, in: Asian
Conference on Computer Vision, 2012, pp. 708–721.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
D. Kang, H. Han, A. K. Jain, S.-W. Lee, Nighttime face recognition at large
standoff: Cross-distance and cross-spectral matching, Pattern Recognition
47 (12) (2014) 3750–3766.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
M.-C. Roh, H.-K. Shin, S.-W. Lee, View-independent human action recognition
with volume motion template on single stereo camera, Pattern Recognition
Letters 31 (7) (2010) 639–647.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Y.-J. Kim, D.-G. Lee, S.-W. Lee, Three-stream fusion network for first-person
interaction recognition, Pattern Recognition 103 (2020) 107279.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
D.-G. Lee, S.-W. Lee, Prediction of partially observed human activity based on
pre-trained deep representation, Pattern Recognition 85 (2019) 198–206.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
K. Cho, B. van Merriënboer, C. Gulcehre, D. Bahdanau, F. Bougares,
H. Schwenk, Y. Bengio, Learning phrase representations using rnn
encoder–decoder for statistical machine translation, in: Proceedings of the
Conference on Empirical Methods in Natural Language Processing, 2014, pp.
1724–1734.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
D. Bahdanau, K. Cho, Y. Bengio, Neural machine translation by jointly learning
to align and translate, in: International Conference on Learning
Representations, 2015, pp. 1–15.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
J. Hong, J. Fu, Y. Uh, T. Mei, H. Byun, Exploiting hierarchical visual features
for visual question answering, Neurocomputing 351 (2019) 187–195.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
J. Wu, Z. Hu, R. Mooney, Generating question relevant captions to aid visual
question answering, in: Proceedings of the Annual Meeting of the Association
for Computational Linguistics, 2019, pp. 3585–3594.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
H. Kim, M. Bansal, Improving visual question answering by referring to
generated paragraph captions, in: Proceedings of the Annual Meeting of the
Association for Computational Linguistics, 2019, pp. 3606––3612.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Q. Li, J. Fu, D. Yu, T. Mei, J. Luo, Tell-and-answer: Towards explainable
visual question answering using attributes and captions, in: Proceedings of
the Conference on Empirical Methods in Natural Language Processing, 2018, pp.
1338–1346.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
J. Mao, J. Huang, A. Toshev, O. Camburu, A. L. Yuille, K. Murphy, Generation
and comprehension of unambiguous object descriptions, in: Proceedings of the
IEEE Conference on Computer Vision and Pattern Recognition, 2016, pp. 11–20.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
M. Tanaka, T. Itamochi, K. Narioka, I. Sato, Y. Ushiku, T. Harada, Generating
easy-to-understand referring expressions for target identifications, in:
Proceedings of the IEEE International Conference on Computer Vision, 2019,
pp. 5794–5803.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
L. Yu, P. Poirson, S. Yang, A. C. Berg, T. L. Berg, Modeling context in
referring expressions, in: Proceedings of the European Conference on Computer
Vision, 2016, pp. 69–85.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
V. Mnih, N. Heess, A. Graves, et al., Recurrent models of visual attention, in:
Advances in Neural Information Processing Systems, 2014, pp. 2204–2212.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
K. J. Shih, S. Singh, D. Hoiem, Where to look: Focus regions for visual
question answering, in: Proceedings of the IEEE Conference on Computer Vision
and Pattern Recognition, 2016, pp. 4613–4621.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
Ł. Kaiser, I. Polosukhin, Attention is all you need, in: Advances in
Neural Information Processing Systems, 2017, pp. 5998–6008.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
D.-K. Nguyen, T. Okatani, Improved fusion of visual and language
representations by dense symmetric co-attention for visual question
answering, in: Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition, 2018, pp. 6087–6096.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
J.-H. Kim, J. Jun, B.-T. Zhang, Bilinear attention networks, in: Advances in
Neural Information Processing Systems, 2018, pp. 1564–1574.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
R. Krishna, Y. Zhu, O. Groth, J. Johnson, K. Hata, J. Kravitz, S. Chen,
Y. Kalantidis, L.-J. Li, D. A. Shamma, et al., Visual genome: Connecting
language and vision using crowdsourced dense image annotations, International
Journal of Computer Vision 123 (1) (2017) 32–73.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
J. Lu, J. Yang, D. Batra, D. Parikh, Hierarchical question-image co-attention
for visual question answering, in: Advances in Neural Information Processing
Systems, 2016, pp. 289–297.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
H. Xu, K. Saenko, Ask, attend and answer: Exploring question-guided spatial
attention for visual question answering, in: Proceedings of the European
Conference on Computer Vision, Springer, 2016, pp. 451–466.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
S. Kazemzadeh, V. Ordonez, M. Matten, T. Berg, Referitgame: Referring to
objects in photographs of natural scenes, in: Proceedings of the 2014
conference on empirical methods in natural language processing (EMNLP), 2014,
pp. 787–798.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, J. Sun, Deep residual learning for image recognition,
in: Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition, 2016, pp. 770–778.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
J. Pennington, R. Socher, C. D. Manning, Glove: Global vectors for word
representation, in: Proceedings of the 2014 conference on empirical methods
in natural language processing (EMNLP), 2014, pp. 1532–1543.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
J. Lu, D. Batra, D. Parikh, S. Lee, Vilbert: Pretraining task-agnostic
visiolinguistic representations for vision-and-language tasks, in: Advances
in Neural Information Processing Systems, 2019, pp. 13–23.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
J. Lu, V. Goswami, M. Rohrbach, D. Parikh, S. Lee, 12-in-1: Multi-task vision
and language representation learning, arXiv preprint arXiv:1912.02315 (2019).

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
D. P. Kingma, J. Ba, Adam: A method for stochastic optimization, arXiv preprint
arXiv:1412.6980 (2014).

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
C. D. Manning, M. Surdeanu, J. Bauer, J. R. Finkel, S. Bethard, D. McClosky,
The stanford corenlp natural language processing toolkit, in: Proceedings of
52nd annual meeting of the association for computational linguistics: system
demonstrations, 2014, pp. 55–60.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
J. Devlin, M.-W. Chang, K. Lee, K. Toutanova, Bert: Pre-training of deep
bidirectional transformers for language understanding, in: Proceedings of the
Annual Meeting of the Association for Computational Linguistics, 2019, pp.
4171–4186.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
R. Cadene, H. Ben-Younes, M. Cord, N. Thome, Murel: Multimodal relational
reasoning for visual question answering, in: Proceedings of the IEEE
Conference on Computer Vision and Pattern Recognition, 2019, pp. 1989–1998.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Z. Yu, J. Yu, C. Xiang, J. Fan, D. Tao, Beyond bilinear: Generalized multimodal
factorized high-order pooling for visual question answering, IEEE
transactions on neural networks and learning systems 29 (12) (2018)
5947–5959.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
P. Gao, Z. Jiang, H. You, P. Lu, S. C. Hoi, X. Wang, H. Li, Dynamic fusion with
intra-and inter-modality attention flow for visual question answering, in:
Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition, 2019, pp. 6639–6648.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Y. Zhang, J. Hare, A. Prügel-Bennett, Learning to count objects in natural
images for visual question answering, arXiv preprint arXiv:1802.05766 (2018).

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2101.08976" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2101.08978" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2101.08978">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2101.08978" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2101.08980" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 19:32:40 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
