<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou</title>
<!--Generated on Fri Aug 16 05:15:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommendation; Click-Through Rate Prediction" lang="en" name="keywords"/>
<base href="/html/2407.16357v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S1" title="In TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S2" title="In TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3" title="In TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.SS1" title="In 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.SS2" title="In 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Overall Workflow</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.SS3" title="In 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Life-Cycle User Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.SS3.SSS1" title="In 3.3. Life-Cycle User Modeling ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Hierarchical Clustering Over Life Cycle</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.SS3.SSS2" title="In 3.3. Life-Cycle User Modeling ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Extracting Cluster Representation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.SS3.SSS3" title="In 3.3. Life-Cycle User Modeling ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Cluster-aware Target Attention</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.SS4" title="In 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Deployment of TWIN-V2</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4" title="In TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS1" title="In 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS1.SSS1" title="In 4.1. Experimental Setup ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS1.SSS2" title="In 4.1. Experimental Setup ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS1.SSS3" title="In 4.1. Experimental Setup ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span>Evaluation Metrics &amp; Protocal</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS1.SSS4" title="In 4.1. Experimental Setup ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.4 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS2" title="In 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Overall Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS3" title="In 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS3.SSS1" title="In 4.3. Ablation Study ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Comparison of Different Hierarchical Clustering Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS3.SSS2" title="In 4.3. Ablation Study ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Effectiveness of Cluster-aware Target Attention</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS4" title="In 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Online Experiments</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S5" title="In TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#A1" title="In TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>APPENDIX</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#A1.SS1" title="In Appendix A APPENDIX ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Summary of Notations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#A1.SS2" title="In Appendix A APPENDIX ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Behavior Feature Splits and Linear Projection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#A1.SS3" title="In Appendix A APPENDIX ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Analysis of User Activity Levels</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zihua Si
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id4.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id5.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zihua%CB%99si@ruc.edu.cn">zihua˙si@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lin Guan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id6.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id7.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id8.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:guanlin03@kuaishou.com">guanlin03@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhongxiang Sun
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id10.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id11.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:sunzhongxiang@ruc.edu.cn">sunzhongxiang@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaoxue Zang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id12.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id13.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id14.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zangxiaoxue@kuaishou.com">zangxiaoxue@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jing Lu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id15.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id16.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id17.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lvjing06@kuaishou.com">lvjing06@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yiqun Hui
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id18.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id19.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id20.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:huiyiqun@kuaishou.com">huiyiqun@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xingchao Cao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id21.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id22.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id23.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:caoxingchao@kuaishou.com">caoxingchao@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zeyu Yang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id24.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id25.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id26.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yangzeyu03@kuaishou.com">yangzeyu03@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yichen Zheng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id27.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id28.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id29.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhengyichen@kuaishou.com">zhengyichen@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dewei Leng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id30.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id31.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id32.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lengdewei@kuaishou.com">lengdewei@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kai Zheng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id33.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id34.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id35.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhengkai@kuaishou.com">zhengkai@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chenbin Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id36.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id37.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id38.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:aleczhang13@yeah.net">aleczhang13@yeah.net</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yanan Niu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id39.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id40.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id41.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:niuyanan@kuaishou.com">niuyanan@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yang Song
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id42.1.id1">Kuaishou Technology Co., Ltd.</span><span class="ltx_text ltx_affiliation_city" id="id43.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id44.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:ys@sonyis.me">ys@sonyis.me</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kun Gai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id45.1.id1">Independent</span><span class="ltx_text ltx_affiliation_city" id="id46.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id47.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:gai.kun@qq.com">gai.kun@qq.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id2.2">The significance of modeling long-term user interests for CTR prediction tasks in large-scale recommendation systems is progressively gaining attention among researchers and practitioners.
Existing work, such as SIM and TWIN, typically employs a two-stage approach to model long-term user behavior sequences for efficiency concerns.
The first stage rapidly retrieves a subset of sequences related to the target item from a long sequence using a search-based mechanism namely the General Search Unit (GSU), while the second stage calculates the interest scores using the Exact Search Unit (ESU) on the retrieved results.
Given the extensive length of user behavior sequences spanning the entire life cycle, potentially reaching up to <math alttext="10^{6}" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mn id="id1.1.m1.1.1.2" xref="id1.1.m1.1.1.2.cmml">10</mn><mn id="id1.1.m1.1.1.3" xref="id1.1.m1.1.1.3.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><csymbol cd="ambiguous" id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1">superscript</csymbol><cn id="id1.1.m1.1.1.2.cmml" type="integer" xref="id1.1.m1.1.1.2">10</cn><cn id="id1.1.m1.1.1.3.cmml" type="integer" xref="id1.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">10^{6}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math> in scale, there is currently no effective solution for fully modeling such expansive user interests.
To overcome this issue, we introduced TWIN-V2, an enhancement of TWIN, where a <em class="ltx_emph ltx_font_italic" id="id2.2.1">divide-and-conquer</em> approach is applied to compress life-cycle behaviors and uncover more accurate and diverse user interests.
Specifically, a hierarchical clustering method groups items with similar characteristics in life-cycle behaviors into a single cluster during the offline phase.
By limiting the size of clusters, we can compress behavior sequences well beyond the magnitude of <math alttext="10^{5}" class="ltx_Math" display="inline" id="id2.2.m2.1"><semantics id="id2.2.m2.1a"><msup id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml"><mn id="id2.2.m2.1.1.2" xref="id2.2.m2.1.1.2.cmml">10</mn><mn id="id2.2.m2.1.1.3" xref="id2.2.m2.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><apply id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"><csymbol cd="ambiguous" id="id2.2.m2.1.1.1.cmml" xref="id2.2.m2.1.1">superscript</csymbol><cn id="id2.2.m2.1.1.2.cmml" type="integer" xref="id2.2.m2.1.1.2">10</cn><cn id="id2.2.m2.1.1.3.cmml" type="integer" xref="id2.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">10^{5}</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math> to a length manageable for online inference in GSU retrieval.
Cluster-aware target attention extracts comprehensive and multi-faceted long-term interests of users, thereby making the final recommendation results more accurate and diverse.
Extensive offline experiments on a multi-billion-scale industrial dataset and online A/B tests have demonstrated the effectiveness of TWIN-V2.
Under an efficient deployment framework, TWIN-V2 has been successfully deployed to the primary traffic that serves hundreds of millions of daily active users at Kuaishou.</p>
</div>
<div class="ltx_keywords">Recommendation; Click-Through Rate Prediction
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management; October 21–25, 2024; Boise, ID, USA.</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management (CIKM ’24), October 21–25, 2024, Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0436-9/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3627673.3680030</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Personalization</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Click-Through Rate (CTR) prediction is crucial for internet applications.
For instance, Kuaishou<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.kuaishou.com/en" title="">https://www.kuaishou.com/en</a></span></span></span>, one of China’s largest short-video sharing platforms, has employed CTR prediction as a core component of its ranking system.
Recently, much effort <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib25" title="">2018</a>; Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib2" title="">2022</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite> has been devoted to modeling users’ long-term historical behavior in CTR prediction.
Due to the extensive length of behaviors across the life cycle, modeling life-cycle user behaviors presents a challenging task.
Despite ongoing efforts to extend the length of historical behavior modeling in existing research, no method has yet been developed that can model a user’s entire life cycle, encompassing up to 1 million behaviors within an app.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="160" id="S1.F1.g1" src="x1.png" width="340"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">The Proportion of user count and app usage duration at Kuaishou. We grouped users based on the number of videos they have viewed over the past three years.
Highly active users, though a small percentage (12%), contribute the most usage duration (60%).
</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Modern industrial systems <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib14" title="">2020</a>; Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib2" title="">2022</a>)</cite>, to utilize as long a user history as possible within a controllable inference time, have adopted a two-stage approach.
Specifically, in the first stage, a module called the General Search Unit (GSU) is used to filter long-term historical behaviors, selecting items related to the target item.
In the second stage, a module called the Exact Search Unit (ESU) further processes the filtered items, extracting the user’s long-term interests through target attention.
The coarse-grained pre-filtering by the GSU enables the system to model longer historical behaviors at a faster speed during online inference.
Many approaches have tried different GSU structures to improve the accuracy of pre-filtering, such as ETA <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib4" title="">2021</a>)</cite>, SDIM <cite class="ltx_cite ltx_citemacro_citep">(Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib2" title="">2022</a>)</cite> and TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.8">Despite their effectiveness, existing first-stage GSUs generally have length limitations and cannot model user behaviors throughout the life cycle.
For instance, SIM, ETA, and SDIM can filter historical behaviors up to a maximum length of <math alttext="10^{3}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msup id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mn id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">10</mn><mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">superscript</csymbol><cn id="S1.p3.1.m1.1.1.2.cmml" type="integer" xref="S1.p3.1.m1.1.1.2">10</cn><cn id="S1.p3.1.m1.1.1.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">10^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>. TWIN extends the maximum length at the <math alttext="10^{4}" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><msup id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml"><mn id="S1.p3.2.m2.1.1.2" xref="S1.p3.2.m2.1.1.2.cmml">10</mn><mn id="S1.p3.2.m2.1.1.3" xref="S1.p3.2.m2.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.cmml" xref="S1.p3.2.m2.1.1">superscript</csymbol><cn id="S1.p3.2.m2.1.1.2.cmml" type="integer" xref="S1.p3.2.m2.1.1.2">10</cn><cn id="S1.p3.2.m2.1.1.3.cmml" type="integer" xref="S1.p3.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">10^{4}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="10^{5}" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><msup id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml"><mn id="S1.p3.3.m3.1.1.2" xref="S1.p3.3.m3.1.1.2.cmml">10</mn><mn id="S1.p3.3.m3.1.1.3" xref="S1.p3.3.m3.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><apply id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.cmml" xref="S1.p3.3.m3.1.1">superscript</csymbol><cn id="S1.p3.3.m3.1.1.2.cmml" type="integer" xref="S1.p3.3.m3.1.1.2">10</cn><cn id="S1.p3.3.m3.1.1.3.cmml" type="integer" xref="S1.p3.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">10^{5}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math> level.
During deployment, TWIN utilizes the recent <math alttext="10,000" class="ltx_Math" display="inline" id="S1.p3.4.m4.2"><semantics id="S1.p3.4.m4.2a"><mrow id="S1.p3.4.m4.2.3.2" xref="S1.p3.4.m4.2.3.1.cmml"><mn id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml">10</mn><mo id="S1.p3.4.m4.2.3.2.1" xref="S1.p3.4.m4.2.3.1.cmml">,</mo><mn id="S1.p3.4.m4.2.2" xref="S1.p3.4.m4.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.2b"><list id="S1.p3.4.m4.2.3.1.cmml" xref="S1.p3.4.m4.2.3.2"><cn id="S1.p3.4.m4.1.1.cmml" type="integer" xref="S1.p3.4.m4.1.1">10</cn><cn id="S1.p3.4.m4.2.2.cmml" type="integer" xref="S1.p3.4.m4.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.2c">10,000</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.2d">10 , 000</annotation></semantics></math> behaviors as inputs for GSU.
Unfortunately, these <math alttext="10,000" class="ltx_Math" display="inline" id="S1.p3.5.m5.2"><semantics id="S1.p3.5.m5.2a"><mrow id="S1.p3.5.m5.2.3.2" xref="S1.p3.5.m5.2.3.1.cmml"><mn id="S1.p3.5.m5.1.1" xref="S1.p3.5.m5.1.1.cmml">10</mn><mo id="S1.p3.5.m5.2.3.2.1" xref="S1.p3.5.m5.2.3.1.cmml">,</mo><mn id="S1.p3.5.m5.2.2" xref="S1.p3.5.m5.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.2b"><list id="S1.p3.5.m5.2.3.1.cmml" xref="S1.p3.5.m5.2.3.2"><cn id="S1.p3.5.m5.1.1.cmml" type="integer" xref="S1.p3.5.m5.1.1">10</cn><cn id="S1.p3.5.m5.2.2.cmml" type="integer" xref="S1.p3.5.m5.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.2c">10,000</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m5.2d">10 , 000</annotation></semantics></math> behaviors only cover the user’s history for the last 3-4 months in the Kuaishou app, failing to encompass the entire life cycle of user behavior.
As illustrated in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>, we analyzed user behavior in the Kuaishou app over the past three years.
The medium and high user groups can view between <math alttext="10^{4}" class="ltx_Math" display="inline" id="S1.p3.6.m6.1"><semantics id="S1.p3.6.m6.1a"><msup id="S1.p3.6.m6.1.1" xref="S1.p3.6.m6.1.1.cmml"><mn id="S1.p3.6.m6.1.1.2" xref="S1.p3.6.m6.1.1.2.cmml">10</mn><mn id="S1.p3.6.m6.1.1.3" xref="S1.p3.6.m6.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p3.6.m6.1b"><apply id="S1.p3.6.m6.1.1.cmml" xref="S1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p3.6.m6.1.1.1.cmml" xref="S1.p3.6.m6.1.1">superscript</csymbol><cn id="S1.p3.6.m6.1.1.2.cmml" type="integer" xref="S1.p3.6.m6.1.1.2">10</cn><cn id="S1.p3.6.m6.1.1.3.cmml" type="integer" xref="S1.p3.6.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m6.1c">10^{4}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.6.m6.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="10^{6}" class="ltx_Math" display="inline" id="S1.p3.7.m7.1"><semantics id="S1.p3.7.m7.1a"><msup id="S1.p3.7.m7.1.1" xref="S1.p3.7.m7.1.1.cmml"><mn id="S1.p3.7.m7.1.1.2" xref="S1.p3.7.m7.1.1.2.cmml">10</mn><mn id="S1.p3.7.m7.1.1.3" xref="S1.p3.7.m7.1.1.3.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p3.7.m7.1b"><apply id="S1.p3.7.m7.1.1.cmml" xref="S1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S1.p3.7.m7.1.1.1.cmml" xref="S1.p3.7.m7.1.1">superscript</csymbol><cn id="S1.p3.7.m7.1.1.2.cmml" type="integer" xref="S1.p3.7.m7.1.1.2">10</cn><cn id="S1.p3.7.m7.1.1.3.cmml" type="integer" xref="S1.p3.7.m7.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.7.m7.1c">10^{6}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.7.m7.1d">10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math> videos over three years, contributing the majority of the app’s usage duration (<math alttext="60\%+35\%=95\%" class="ltx_Math" display="inline" id="S1.p3.8.m8.1"><semantics id="S1.p3.8.m8.1a"><mrow id="S1.p3.8.m8.1.1" xref="S1.p3.8.m8.1.1.cmml"><mrow id="S1.p3.8.m8.1.1.2" xref="S1.p3.8.m8.1.1.2.cmml"><mrow id="S1.p3.8.m8.1.1.2.2" xref="S1.p3.8.m8.1.1.2.2.cmml"><mn id="S1.p3.8.m8.1.1.2.2.2" xref="S1.p3.8.m8.1.1.2.2.2.cmml">60</mn><mo id="S1.p3.8.m8.1.1.2.2.1" xref="S1.p3.8.m8.1.1.2.2.1.cmml">%</mo></mrow><mo id="S1.p3.8.m8.1.1.2.1" xref="S1.p3.8.m8.1.1.2.1.cmml">+</mo><mrow id="S1.p3.8.m8.1.1.2.3" xref="S1.p3.8.m8.1.1.2.3.cmml"><mn id="S1.p3.8.m8.1.1.2.3.2" xref="S1.p3.8.m8.1.1.2.3.2.cmml">35</mn><mo id="S1.p3.8.m8.1.1.2.3.1" xref="S1.p3.8.m8.1.1.2.3.1.cmml">%</mo></mrow></mrow><mo id="S1.p3.8.m8.1.1.1" xref="S1.p3.8.m8.1.1.1.cmml">=</mo><mrow id="S1.p3.8.m8.1.1.3" xref="S1.p3.8.m8.1.1.3.cmml"><mn id="S1.p3.8.m8.1.1.3.2" xref="S1.p3.8.m8.1.1.3.2.cmml">95</mn><mo id="S1.p3.8.m8.1.1.3.1" xref="S1.p3.8.m8.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.8.m8.1b"><apply id="S1.p3.8.m8.1.1.cmml" xref="S1.p3.8.m8.1.1"><eq id="S1.p3.8.m8.1.1.1.cmml" xref="S1.p3.8.m8.1.1.1"></eq><apply id="S1.p3.8.m8.1.1.2.cmml" xref="S1.p3.8.m8.1.1.2"><plus id="S1.p3.8.m8.1.1.2.1.cmml" xref="S1.p3.8.m8.1.1.2.1"></plus><apply id="S1.p3.8.m8.1.1.2.2.cmml" xref="S1.p3.8.m8.1.1.2.2"><csymbol cd="latexml" id="S1.p3.8.m8.1.1.2.2.1.cmml" xref="S1.p3.8.m8.1.1.2.2.1">percent</csymbol><cn id="S1.p3.8.m8.1.1.2.2.2.cmml" type="integer" xref="S1.p3.8.m8.1.1.2.2.2">60</cn></apply><apply id="S1.p3.8.m8.1.1.2.3.cmml" xref="S1.p3.8.m8.1.1.2.3"><csymbol cd="latexml" id="S1.p3.8.m8.1.1.2.3.1.cmml" xref="S1.p3.8.m8.1.1.2.3.1">percent</csymbol><cn id="S1.p3.8.m8.1.1.2.3.2.cmml" type="integer" xref="S1.p3.8.m8.1.1.2.3.2">35</cn></apply></apply><apply id="S1.p3.8.m8.1.1.3.cmml" xref="S1.p3.8.m8.1.1.3"><csymbol cd="latexml" id="S1.p3.8.m8.1.1.3.1.cmml" xref="S1.p3.8.m8.1.1.3.1">percent</csymbol><cn id="S1.p3.8.m8.1.1.3.2.cmml" type="integer" xref="S1.p3.8.m8.1.1.3.2">95</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.8.m8.1c">60\%+35\%=95\%</annotation><annotation encoding="application/x-llamapun" id="S1.p3.8.m8.1d">60 % + 35 % = 95 %</annotation></semantics></math>).
Hence, modeling the full life-cycle behaviors may enhance user experience and boost the platform’s commercial gains.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To overcome this issue, we propose TWIN-V2, an enhancement of TWIN, enabling it to model the full life cycle of user behavior.
TWIN-V2 employs a <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">divide-and-conquer</em> approach, decomposing the full life-cycle history into different clusters and using these clusters to model the user’s long-term interests.
Specifically, we divide the model into two parts: offline and online.
In the offline part, we employ hierarchical clustering to aggregate similar items in life-cycle behaviors into clusters and extract features from each cluster to form a virtual item.
In the online part, we utilize cluster-aware target attention to extract long-term interests based on clustered behaviors. Here, the attention scores are reweighted based on the corresponding cluster size.
Extensive experiments reveal that TWIN-V2 enhances performance across various types of users, leading to more accurate and diverse recommendation results.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The main contributions are summarized as follows:</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><mo id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">∙</annotation></semantics></math> We propose TWIN-V2 to capture user interests from extremely long user behavior, which successfully extends the maximum length for user modeling across the life cycle.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p7.1.m1.1"><semantics id="S1.p7.1.m1.1a"><mo id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><ci id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p7.1.m1.1d">∙</annotation></semantics></math> The hierarchical clustering method and cluster-aware target attention improve the efficiency of long sequence modeling and model more accurate and diverse user interests.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p8">
<p class="ltx_p" id="S1.p8.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p8.1.m1.1"><semantics id="S1.p8.1.m1.1a"><mo id="S1.p8.1.m1.1.1" xref="S1.p8.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p8.1.m1.1b"><ci id="S1.p8.1.m1.1.1.cmml" xref="S1.p8.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p8.1.m1.1d">∙</annotation></semantics></math> Extensive offline and online experiments have validated the effectiveness of TWIN-V2 in scaling ultra-long user behavior sequences.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p9">
<p class="ltx_p" id="S1.p9.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p9.1.m1.1"><semantics id="S1.p9.1.m1.1a"><mo id="S1.p9.1.m1.1.1" xref="S1.p9.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p9.1.m1.1b"><ci id="S1.p9.1.m1.1.1.cmml" xref="S1.p9.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p9.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p9.1.m1.1d">∙</annotation></semantics></math> We share hands-on practices for deploying TWIN-V2, including offline processing and online serving, which serve the main traffic of around 400 million active users daily at Kuaishou.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Click-Through Rate Prediction.</span>
Click-Through Rate (CTR) prediction is vital for modern Internet businesses.
Pioneering studies leveraged shallow models, like LR <cite class="ltx_cite ltx_citemacro_citep">(Richardson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib19" title="">2007</a>)</cite>, FM <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib18" title="">2010</a>)</cite>, and FFM <cite class="ltx_cite ltx_citemacro_citep">(Juan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib10" title="">2016</a>)</cite>, to model feature interactions.
Wide&amp;Deep <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib6" title="">2016</a>)</cite>, DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib9" title="">2017</a>)</cite>, and DCN <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib21" title="">2017</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib22" title="">2021</a>)</cite> successfully combine deep and shallow models.
Furthermore, several studies have explored more complex neural networks, such as AutoInt <cite class="ltx_cite ltx_citemacro_citep">(Song et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib20" title="">2019</a>)</cite> leveraging the multi-head self-attention mechanism.
Users’ behavioral data have gained much attention recently.
YoutubeDNN <cite class="ltx_cite ltx_citemacro_citep">(Covington et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib7" title="">2016</a>)</cite> has employed average pooling across the entire sequence of past behaviors.
Furthermore, DIN <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib25" title="">2018</a>)</cite> leveraged a target attention mechanism to adaptively capture user interests from historical behaviors concerning the target item.
This target attention approach has been widely used by practitioners <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib25" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib24" title="">2019</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib4" title="">2021</a>; Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib2" title="">2022</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite>.
Following this line, DIEN <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib24" title="">2019</a>)</cite> and DSIN <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib8" title="">2019</a>)</cite> incorporated temporal information into the target attention.
BST <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib5" title="">2019</a>)</cite> and TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite> leveraged the multi-head attention for the target attention.</p>
</div>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S2.T1.15.1.1" style="font-size:113%;">Table 1</span>. </span><span class="ltx_text" id="S2.T1.16.2" style="font-size:113%;">Comparison with SOTA methods. The lower part lists the two-stage models. ‘Length’ means the maximum sequence length of user behaviors in original papers.
</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S2.T1.11">
<tr class="ltx_tr" id="S2.T1.11.12">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S2.T1.11.12.1">
<span class="ltx_text" id="S2.T1.11.12.1.1"></span><span class="ltx_text" id="S2.T1.11.12.1.2" style="font-size:80%;"> </span><span class="ltx_text" id="S2.T1.11.12.1.3" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="S2.T1.11.12.1.3.1">
<span class="ltx_tr" id="S2.T1.11.12.1.3.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T1.11.12.1.3.1.1.1">Method</span></span>
</span></span><span class="ltx_text" id="S2.T1.11.12.1.4"></span><span class="ltx_text" id="S2.T1.11.12.1.5" style="font-size:80%;"></span>
</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S2.T1.11.12.2">
<span class="ltx_text" id="S2.T1.11.12.2.1"></span><span class="ltx_text" id="S2.T1.11.12.2.2" style="font-size:80%;"> </span><span class="ltx_text" id="S2.T1.11.12.2.3" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="S2.T1.11.12.2.3.1">
<span class="ltx_tr" id="S2.T1.11.12.2.3.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T1.11.12.2.3.1.1.1">Length</span></span>
</span></span><span class="ltx_text" id="S2.T1.11.12.2.4"></span><span class="ltx_text" id="S2.T1.11.12.2.5" style="font-size:80%;"></span>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S2.T1.11.12.3">
<span class="ltx_text" id="S2.T1.11.12.3.1"></span><span class="ltx_text" id="S2.T1.11.12.3.2" style="font-size:80%;"> </span><span class="ltx_text" id="S2.T1.11.12.3.3" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="S2.T1.11.12.3.3.1">
<span class="ltx_tr" id="S2.T1.11.12.3.3.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T1.11.12.3.3.1.1.1">GSU Stragegy</span></span>
</span></span><span class="ltx_text" id="S2.T1.11.12.3.4"></span><span class="ltx_text" id="S2.T1.11.12.3.5" style="font-size:80%;"></span>
</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.1.1.2">
<span class="ltx_text" id="S2.T1.1.1.2.1" style="font-size:80%;">DIN </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.1.1.2.2.1" style="font-size:80%;">(</span>Zhou et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.1.1.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib25" title="">2018</a><span class="ltx_text" id="S2.T1.1.1.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.1.1.1"><math alttext="\sim 10^{3}" class="ltx_Math" display="inline" id="S2.T1.1.1.1.m1.1"><semantics id="S2.T1.1.1.1.m1.1a"><mrow id="S2.T1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.m1.1.1.cmml"><mi id="S2.T1.1.1.1.m1.1.1.2" xref="S2.T1.1.1.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.1.1.1.m1.1.1.1" mathsize="80%" xref="S2.T1.1.1.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.1.1.1.m1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.3.cmml"><mn id="S2.T1.1.1.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.1.1.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.1.1.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.1.1.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.m1.1b"><apply id="S2.T1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.1.1.1.m1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.1.1.1.m1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.1.1.1.m1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.1.1.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.1.1.1.m1.1.1.3.2">10</cn><cn id="S2.T1.1.1.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.1.1.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.m1.1c">\sim 10^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.1.1.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3"><span class="ltx_text" id="S2.T1.1.1.3.1" style="font-size:80%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.2.2">
<td class="ltx_td ltx_align_left" id="S2.T1.2.2.2">
<span class="ltx_text" id="S2.T1.2.2.2.1" style="font-size:80%;">DIEN </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.2.2.2.2.1" style="font-size:80%;">(</span>Zhou et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.2.2.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib24" title="">2019</a><span class="ltx_text" id="S2.T1.2.2.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left" id="S2.T1.2.2.1"><math alttext="\sim 10^{2}" class="ltx_Math" display="inline" id="S2.T1.2.2.1.m1.1"><semantics id="S2.T1.2.2.1.m1.1a"><mrow id="S2.T1.2.2.1.m1.1.1" xref="S2.T1.2.2.1.m1.1.1.cmml"><mi id="S2.T1.2.2.1.m1.1.1.2" xref="S2.T1.2.2.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.2.2.1.m1.1.1.1" mathsize="80%" xref="S2.T1.2.2.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.2.2.1.m1.1.1.3" xref="S2.T1.2.2.1.m1.1.1.3.cmml"><mn id="S2.T1.2.2.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.2.2.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.2.2.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.2.2.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.1.m1.1b"><apply id="S2.T1.2.2.1.m1.1.1.cmml" xref="S2.T1.2.2.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.2.2.1.m1.1.1.1.cmml" xref="S2.T1.2.2.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.2.2.1.m1.1.1.2.cmml" xref="S2.T1.2.2.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.2.2.1.m1.1.1.3.cmml" xref="S2.T1.2.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.2.2.1.m1.1.1.3.1.cmml" xref="S2.T1.2.2.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.2.2.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.2.2.1.m1.1.1.3.2">10</cn><cn id="S2.T1.2.2.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.2.2.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.1.m1.1c">\sim 10^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.2.2.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.2.2.3"><span class="ltx_text" id="S2.T1.2.2.3.1" style="font-size:80%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.3">
<td class="ltx_td ltx_align_left" id="S2.T1.3.3.2">
<span class="ltx_text" id="S2.T1.3.3.2.1" style="font-size:80%;">MIMN </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.3.3.2.2.1" style="font-size:80%;">(</span>Pi et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.3.3.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib13" title="">2019</a><span class="ltx_text" id="S2.T1.3.3.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left" id="S2.T1.3.3.1"><math alttext="\sim 10^{3}" class="ltx_Math" display="inline" id="S2.T1.3.3.1.m1.1"><semantics id="S2.T1.3.3.1.m1.1a"><mrow id="S2.T1.3.3.1.m1.1.1" xref="S2.T1.3.3.1.m1.1.1.cmml"><mi id="S2.T1.3.3.1.m1.1.1.2" xref="S2.T1.3.3.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.3.3.1.m1.1.1.1" mathsize="80%" xref="S2.T1.3.3.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.3.3.1.m1.1.1.3" xref="S2.T1.3.3.1.m1.1.1.3.cmml"><mn id="S2.T1.3.3.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.3.3.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.3.3.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.3.3.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.1.m1.1b"><apply id="S2.T1.3.3.1.m1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.3.3.1.m1.1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.3.3.1.m1.1.1.2.cmml" xref="S2.T1.3.3.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.3.3.1.m1.1.1.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.3.3.1.m1.1.1.3.1.cmml" xref="S2.T1.3.3.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.3.3.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.3.3.1.m1.1.1.3.2">10</cn><cn id="S2.T1.3.3.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.3.3.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.1.m1.1c">\sim 10^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.3.3.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.3.3"><span class="ltx_text" id="S2.T1.3.3.3.1" style="font-size:80%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.4">
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.2">
<span class="ltx_text" id="S2.T1.4.4.2.1" style="font-size:80%;">DGIN </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.4.4.2.2.1" style="font-size:80%;">(</span>Liu et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.4.4.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib11" title="">2023</a><span class="ltx_text" id="S2.T1.4.4.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.1"><math alttext="\sim 10^{4}" class="ltx_Math" display="inline" id="S2.T1.4.4.1.m1.1"><semantics id="S2.T1.4.4.1.m1.1a"><mrow id="S2.T1.4.4.1.m1.1.1" xref="S2.T1.4.4.1.m1.1.1.cmml"><mi id="S2.T1.4.4.1.m1.1.1.2" xref="S2.T1.4.4.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.4.4.1.m1.1.1.1" mathsize="80%" xref="S2.T1.4.4.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.4.4.1.m1.1.1.3" xref="S2.T1.4.4.1.m1.1.1.3.cmml"><mn id="S2.T1.4.4.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.4.4.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.4.4.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.4.4.1.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.1.m1.1b"><apply id="S2.T1.4.4.1.m1.1.1.cmml" xref="S2.T1.4.4.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.4.4.1.m1.1.1.1.cmml" xref="S2.T1.4.4.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.4.4.1.m1.1.1.2.cmml" xref="S2.T1.4.4.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.4.4.1.m1.1.1.3.cmml" xref="S2.T1.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.4.4.1.m1.1.1.3.1.cmml" xref="S2.T1.4.4.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.4.4.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.4.4.1.m1.1.1.3.2">10</cn><cn id="S2.T1.4.4.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.4.4.1.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.1.m1.1c">\sim 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.4.4.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.4.3"><span class="ltx_text" id="S2.T1.4.4.3.1" style="font-size:80%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.5.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.5.5.2">
<span class="ltx_text" id="S2.T1.5.5.2.1" style="font-size:80%;">UBR4CTR </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.5.5.2.2.1" style="font-size:80%;">(</span>Qin et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.5.5.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib15" title="">2023</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib16" title="">2020</a><span class="ltx_text" id="S2.T1.5.5.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.5.5.1"><math alttext="\sim 10^{2}" class="ltx_Math" display="inline" id="S2.T1.5.5.1.m1.1"><semantics id="S2.T1.5.5.1.m1.1a"><mrow id="S2.T1.5.5.1.m1.1.1" xref="S2.T1.5.5.1.m1.1.1.cmml"><mi id="S2.T1.5.5.1.m1.1.1.2" xref="S2.T1.5.5.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.5.5.1.m1.1.1.1" mathsize="80%" xref="S2.T1.5.5.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.5.5.1.m1.1.1.3" xref="S2.T1.5.5.1.m1.1.1.3.cmml"><mn id="S2.T1.5.5.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.5.5.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.5.5.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.5.5.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.5.5.1.m1.1b"><apply id="S2.T1.5.5.1.m1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.5.5.1.m1.1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.5.5.1.m1.1.1.2.cmml" xref="S2.T1.5.5.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.5.5.1.m1.1.1.3.cmml" xref="S2.T1.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.5.5.1.m1.1.1.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.5.5.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.5.5.1.m1.1.1.3.2">10</cn><cn id="S2.T1.5.5.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.5.5.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.5.1.m1.1c">\sim 10^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.5.5.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.5.5.3"><span class="ltx_text" id="S2.T1.5.5.3.1" style="font-size:80%;">BM25</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.6.6">
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.2">
<span class="ltx_text" id="S2.T1.6.6.2.1" style="font-size:80%;">SIM Hard </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.6.6.2.2.1" style="font-size:80%;">(</span>Pi et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.6.6.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib14" title="">2020</a><span class="ltx_text" id="S2.T1.6.6.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.1"><math alttext="\sim 10^{3}" class="ltx_Math" display="inline" id="S2.T1.6.6.1.m1.1"><semantics id="S2.T1.6.6.1.m1.1a"><mrow id="S2.T1.6.6.1.m1.1.1" xref="S2.T1.6.6.1.m1.1.1.cmml"><mi id="S2.T1.6.6.1.m1.1.1.2" xref="S2.T1.6.6.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.6.6.1.m1.1.1.1" mathsize="80%" xref="S2.T1.6.6.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.6.6.1.m1.1.1.3" xref="S2.T1.6.6.1.m1.1.1.3.cmml"><mn id="S2.T1.6.6.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.6.6.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.6.6.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.6.6.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.6.6.1.m1.1b"><apply id="S2.T1.6.6.1.m1.1.1.cmml" xref="S2.T1.6.6.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.6.6.1.m1.1.1.1.cmml" xref="S2.T1.6.6.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.6.6.1.m1.1.1.2.cmml" xref="S2.T1.6.6.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.6.6.1.m1.1.1.3.cmml" xref="S2.T1.6.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.6.6.1.m1.1.1.3.1.cmml" xref="S2.T1.6.6.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.6.6.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.6.6.1.m1.1.1.3.2">10</cn><cn id="S2.T1.6.6.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.6.6.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.6.1.m1.1c">\sim 10^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.6.6.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.6.6.3"><span class="ltx_text" id="S2.T1.6.6.3.1" style="font-size:80%;">Category Filtering</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.7.7">
<td class="ltx_td ltx_align_left" id="S2.T1.7.7.2">
<span class="ltx_text" id="S2.T1.7.7.2.1" style="font-size:80%;">SIM Soft </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.7.7.2.2.1" style="font-size:80%;">(</span>Pi et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.7.7.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib14" title="">2020</a><span class="ltx_text" id="S2.T1.7.7.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left" id="S2.T1.7.7.1"><math alttext="\sim 10^{3}" class="ltx_Math" display="inline" id="S2.T1.7.7.1.m1.1"><semantics id="S2.T1.7.7.1.m1.1a"><mrow id="S2.T1.7.7.1.m1.1.1" xref="S2.T1.7.7.1.m1.1.1.cmml"><mi id="S2.T1.7.7.1.m1.1.1.2" xref="S2.T1.7.7.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.7.7.1.m1.1.1.1" mathsize="80%" xref="S2.T1.7.7.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.7.7.1.m1.1.1.3" xref="S2.T1.7.7.1.m1.1.1.3.cmml"><mn id="S2.T1.7.7.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.7.7.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.7.7.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.7.7.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.7.7.1.m1.1b"><apply id="S2.T1.7.7.1.m1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.7.7.1.m1.1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.7.7.1.m1.1.1.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.7.7.1.m1.1.1.3.cmml" xref="S2.T1.7.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.7.7.1.m1.1.1.3.1.cmml" xref="S2.T1.7.7.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.7.7.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.7.7.1.m1.1.1.3.2">10</cn><cn id="S2.T1.7.7.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.7.7.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.7.1.m1.1c">\sim 10^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.7.7.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.7.7.3"><span class="ltx_text" id="S2.T1.7.7.3.1" style="font-size:80%;">Inner Product</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.8.8">
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.2">
<span class="ltx_text" id="S2.T1.8.8.2.1" style="font-size:80%;">ETA </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.8.8.2.2.1" style="font-size:80%;">(</span>Chen et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.8.8.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib4" title="">2021</a><span class="ltx_text" id="S2.T1.8.8.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.1"><math alttext="\sim 10^{3}" class="ltx_Math" display="inline" id="S2.T1.8.8.1.m1.1"><semantics id="S2.T1.8.8.1.m1.1a"><mrow id="S2.T1.8.8.1.m1.1.1" xref="S2.T1.8.8.1.m1.1.1.cmml"><mi id="S2.T1.8.8.1.m1.1.1.2" xref="S2.T1.8.8.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.8.8.1.m1.1.1.1" mathsize="80%" xref="S2.T1.8.8.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.8.8.1.m1.1.1.3" xref="S2.T1.8.8.1.m1.1.1.3.cmml"><mn id="S2.T1.8.8.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.8.8.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.8.8.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.8.8.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.8.8.1.m1.1b"><apply id="S2.T1.8.8.1.m1.1.1.cmml" xref="S2.T1.8.8.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.8.8.1.m1.1.1.1.cmml" xref="S2.T1.8.8.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.8.8.1.m1.1.1.2.cmml" xref="S2.T1.8.8.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.8.8.1.m1.1.1.3.cmml" xref="S2.T1.8.8.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.8.8.1.m1.1.1.3.1.cmml" xref="S2.T1.8.8.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.8.8.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.8.8.1.m1.1.1.3.2">10</cn><cn id="S2.T1.8.8.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.8.8.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.8.8.1.m1.1c">\sim 10^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.8.8.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.8.8.3"><span class="ltx_text" id="S2.T1.8.8.3.1" style="font-size:80%;">LSH &amp; Hamming</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.9.9">
<td class="ltx_td ltx_align_left" id="S2.T1.9.9.2">
<span class="ltx_text" id="S2.T1.9.9.2.1" style="font-size:80%;">SDIM </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.9.9.2.2.1" style="font-size:80%;">(</span>Cao et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.9.9.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib2" title="">2022</a><span class="ltx_text" id="S2.T1.9.9.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left" id="S2.T1.9.9.1"><math alttext="\sim 10^{3}" class="ltx_Math" display="inline" id="S2.T1.9.9.1.m1.1"><semantics id="S2.T1.9.9.1.m1.1a"><mrow id="S2.T1.9.9.1.m1.1.1" xref="S2.T1.9.9.1.m1.1.1.cmml"><mi id="S2.T1.9.9.1.m1.1.1.2" xref="S2.T1.9.9.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.9.9.1.m1.1.1.1" mathsize="80%" xref="S2.T1.9.9.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.9.9.1.m1.1.1.3" xref="S2.T1.9.9.1.m1.1.1.3.cmml"><mn id="S2.T1.9.9.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.9.9.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.9.9.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.9.9.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.9.9.1.m1.1b"><apply id="S2.T1.9.9.1.m1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.9.9.1.m1.1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.9.9.1.m1.1.1.2.cmml" xref="S2.T1.9.9.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.9.9.1.m1.1.1.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.9.9.1.m1.1.1.3.1.cmml" xref="S2.T1.9.9.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.9.9.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.9.9.1.m1.1.1.3.2">10</cn><cn id="S2.T1.9.9.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.9.9.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.9.9.1.m1.1c">\sim 10^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.9.9.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.9.9.3"><span class="ltx_text" id="S2.T1.9.9.3.1" style="font-size:80%;">Hash Collision</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.10.10">
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.2">
<span class="ltx_text" id="S2.T1.10.10.2.1" style="font-size:80%;">TWIN </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S2.T1.10.10.2.2.1" style="font-size:80%;">(</span>Chang et al<span class="ltx_text">.</span><span class="ltx_text" id="S2.T1.10.10.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a><span class="ltx_text" id="S2.T1.10.10.2.4.3" style="font-size:80%;">)</span></cite>
</td>
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.1"><math alttext="\sim 10^{5}" class="ltx_Math" display="inline" id="S2.T1.10.10.1.m1.1"><semantics id="S2.T1.10.10.1.m1.1a"><mrow id="S2.T1.10.10.1.m1.1.1" xref="S2.T1.10.10.1.m1.1.1.cmml"><mi id="S2.T1.10.10.1.m1.1.1.2" xref="S2.T1.10.10.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.10.10.1.m1.1.1.1" mathsize="80%" xref="S2.T1.10.10.1.m1.1.1.1.cmml">∼</mo><msup id="S2.T1.10.10.1.m1.1.1.3" xref="S2.T1.10.10.1.m1.1.1.3.cmml"><mn id="S2.T1.10.10.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.10.10.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.10.10.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.10.10.1.m1.1.1.3.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.10.10.1.m1.1b"><apply id="S2.T1.10.10.1.m1.1.1.cmml" xref="S2.T1.10.10.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.10.10.1.m1.1.1.1.cmml" xref="S2.T1.10.10.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S2.T1.10.10.1.m1.1.1.2.cmml" xref="S2.T1.10.10.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.10.10.1.m1.1.1.3.cmml" xref="S2.T1.10.10.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.10.10.1.m1.1.1.3.1.cmml" xref="S2.T1.10.10.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.10.10.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.10.10.1.m1.1.1.3.2">10</cn><cn id="S2.T1.10.10.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.10.10.1.m1.1.1.3.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.10.10.1.m1.1c">\sim 10^{5}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.10.10.1.m1.1d">∼ 10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.10.10.3"><span class="ltx_text" id="S2.T1.10.10.3.1" style="font-size:80%;">Efficient Target Attention (TA)</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.11.11">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S2.T1.11.11.2"><span class="ltx_text" id="S2.T1.11.11.2.1" style="font-size:80%;">TWIN-V2 (ours)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S2.T1.11.11.1"><math alttext="\gg 10^{5}" class="ltx_Math" display="inline" id="S2.T1.11.11.1.m1.1"><semantics id="S2.T1.11.11.1.m1.1a"><mrow id="S2.T1.11.11.1.m1.1.1" xref="S2.T1.11.11.1.m1.1.1.cmml"><mi id="S2.T1.11.11.1.m1.1.1.2" xref="S2.T1.11.11.1.m1.1.1.2.cmml"></mi><mo id="S2.T1.11.11.1.m1.1.1.1" mathsize="80%" xref="S2.T1.11.11.1.m1.1.1.1.cmml">≫</mo><msup id="S2.T1.11.11.1.m1.1.1.3" xref="S2.T1.11.11.1.m1.1.1.3.cmml"><mn id="S2.T1.11.11.1.m1.1.1.3.2" mathsize="80%" xref="S2.T1.11.11.1.m1.1.1.3.2.cmml">10</mn><mn id="S2.T1.11.11.1.m1.1.1.3.3" mathsize="80%" xref="S2.T1.11.11.1.m1.1.1.3.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.11.11.1.m1.1b"><apply id="S2.T1.11.11.1.m1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1"><csymbol cd="latexml" id="S2.T1.11.11.1.m1.1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1">much-greater-than</csymbol><csymbol cd="latexml" id="S2.T1.11.11.1.m1.1.1.2.cmml" xref="S2.T1.11.11.1.m1.1.1.2">absent</csymbol><apply id="S2.T1.11.11.1.m1.1.1.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.11.11.1.m1.1.1.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.3">superscript</csymbol><cn id="S2.T1.11.11.1.m1.1.1.3.2.cmml" type="integer" xref="S2.T1.11.11.1.m1.1.1.3.2">10</cn><cn id="S2.T1.11.11.1.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.11.11.1.m1.1.1.3.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.11.11.1.m1.1c">\gg 10^{5}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.11.11.1.m1.1d">≫ 10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.11.11.3"><span class="ltx_text" id="S2.T1.11.11.3.1" style="font-size:80%;">Hierarchical Clustering &amp; TA</span></td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_figure_panel" id="S2.I1">
<li class="ltx_item" id="S2.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span>
<div class="ltx_para" id="S2.I1.ix1.p1">
<p class="ltx_p" id="S2.I1.ix1.p1.2"><span class="ltx_text ltx_font_bold" id="S2.I1.ix1.p1.2.1" style="font-size:80%;">TWIN-V2</span><span class="ltx_text" id="S2.I1.ix1.p1.2.2" style="font-size:80%;">: It can handle behavioral histories far exceeding </span><math alttext="10^{5}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.1.m1.1"><semantics id="S2.I1.ix1.p1.1.m1.1a"><msup id="S2.I1.ix1.p1.1.m1.1.1" xref="S2.I1.ix1.p1.1.m1.1.1.cmml"><mn id="S2.I1.ix1.p1.1.m1.1.1.2" mathsize="80%" xref="S2.I1.ix1.p1.1.m1.1.1.2.cmml">10</mn><mn id="S2.I1.ix1.p1.1.m1.1.1.3" mathsize="80%" xref="S2.I1.ix1.p1.1.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.1.m1.1b"><apply id="S2.I1.ix1.p1.1.m1.1.1.cmml" xref="S2.I1.ix1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.1.m1.1.1.1.cmml" xref="S2.I1.ix1.p1.1.m1.1.1">superscript</csymbol><cn id="S2.I1.ix1.p1.1.m1.1.1.2.cmml" type="integer" xref="S2.I1.ix1.p1.1.m1.1.1.2">10</cn><cn id="S2.I1.ix1.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.ix1.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.1.m1.1c">10^{5}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.1.m1.1d">10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S2.I1.ix1.p1.2.3" style="font-size:80%;"> by adjusting the clustering hyper-parameters. The settings in this paper can process behaviors up to </span><math alttext="10^{6}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.2.m2.1"><semantics id="S2.I1.ix1.p1.2.m2.1a"><msup id="S2.I1.ix1.p1.2.m2.1.1" xref="S2.I1.ix1.p1.2.m2.1.1.cmml"><mn id="S2.I1.ix1.p1.2.m2.1.1.2" mathsize="80%" xref="S2.I1.ix1.p1.2.m2.1.1.2.cmml">10</mn><mn id="S2.I1.ix1.p1.2.m2.1.1.3" mathsize="80%" xref="S2.I1.ix1.p1.2.m2.1.1.3.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.2.m2.1b"><apply id="S2.I1.ix1.p1.2.m2.1.1.cmml" xref="S2.I1.ix1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.2.m2.1.1.1.cmml" xref="S2.I1.ix1.p1.2.m2.1.1">superscript</csymbol><cn id="S2.I1.ix1.p1.2.m2.1.1.2.cmml" type="integer" xref="S2.I1.ix1.p1.2.m2.1.1.2">10</cn><cn id="S2.I1.ix1.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.I1.ix1.p1.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.2.m2.1c">10^{6}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.2.m2.1d">10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S2.I1.ix1.p1.2.4" style="font-size:80%;">, sufficiently covering the entire life cycle of users at Kuaishou.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.2"><span class="ltx_text ltx_font_bold" id="S2.p2.2.1">Long-Term User Behavior Modeling.</span>
Modeling lifelong historical behaviors is crucial in CTR prediction.
Early efforts involved memory networks to capture and remember user interests, such as HPMN <cite class="ltx_cite ltx_citemacro_citep">(Ren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib17" title="">2019</a>)</cite> and MIMN <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib13" title="">2019</a>)</cite>.
Several approaches attempt to directly shorten the length of user behaviors, such as UBCS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib23" title="">2022</a>)</cite> which samples sub-sequences from the entire history and clusters all candidate items to accelerate the sampling process, and DGIN <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib11" title="">2023</a>)</cite> employs item IDs to deduplicate history, thereby compressing redundant items.
Given the inconsistency between long-term and short-term interests, recent works commonly consider them separately.
SIM <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib14" title="">2020</a>)</cite> and UBR4CTR <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib15" title="">2023</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib16" title="">2020</a>)</cite> employ a two-stage approach, first retrieving a subset of behaviors related to the target item from long-term history, and then modeling long-term interests with retrieved behaviors and short-term interests with latest history.
Following them, ETA <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib4" title="">2021</a>)</cite> explored the locality-sensitive hashing method and the Hamming distance to retrieve relevant behaviors.
SDIM <cite class="ltx_cite ltx_citemacro_citep">(Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib2" title="">2022</a>)</cite> directly gathers behavior items that share the same hash signature with the candidate item.
TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite> improves the retrieval accuracy by leveraging an identical target-behavior relevance metric for both stages.
TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite> also extends the maximum length of lifelong behaviors around <math alttext="10^{3}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><msup id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mn id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">10</mn><mn id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1">superscript</csymbol><cn id="S2.p2.1.m1.1.1.2.cmml" type="integer" xref="S2.p2.1.m1.1.1.2">10</cn><cn id="S2.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.p2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">10^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="10^{4}-10^{5}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><msup id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml"><mn id="S2.p2.2.m2.1.1.2.2" xref="S2.p2.2.m2.1.1.2.2.cmml">10</mn><mn id="S2.p2.2.m2.1.1.2.3" xref="S2.p2.2.m2.1.1.2.3.cmml">4</mn></msup><mo id="S2.p2.2.m2.1.1.1" xref="S2.p2.2.m2.1.1.1.cmml">−</mo><msup id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml"><mn id="S2.p2.2.m2.1.1.3.2" xref="S2.p2.2.m2.1.1.3.2.cmml">10</mn><mn id="S2.p2.2.m2.1.1.3.3" xref="S2.p2.2.m2.1.1.3.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><minus id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1"></minus><apply id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.2.1.cmml" xref="S2.p2.2.m2.1.1.2">superscript</csymbol><cn id="S2.p2.2.m2.1.1.2.2.cmml" type="integer" xref="S2.p2.2.m2.1.1.2.2">10</cn><cn id="S2.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S2.p2.2.m2.1.1.2.3">4</cn></apply><apply id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.3.1.cmml" xref="S2.p2.2.m2.1.1.3">superscript</csymbol><cn id="S2.p2.2.m2.1.1.3.2.cmml" type="integer" xref="S2.p2.2.m2.1.1.3.2">10</cn><cn id="S2.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S2.p2.2.m2.1.1.3.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">10^{4}-10^{5}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT - 10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math> by accelerating the target attention mechanism.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">This paper aims to extend long-term history modeling to the life-cycle level while maintaining efficiency.
<span class="ltx_ref ltx_refmacro_autoref ltx_missing_label ltx_ref_self">LABEL:tab:comparison</span> summarizes the comparison between TWIN-V2 and previous works.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">This section elaborates on the proposed model, detailing the entire process from the overall workflow to the deployment framework.
Notations are summarized in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#A1.SS1" title="A.1. Summary of Notations ‣ Appendix A APPENDIX ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Preliminaries</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.4">The core task of CTR prediction is to forecast the probability of a user clicking on an item.
Let <math alttext="\mathbf{x}_{k}\in\mathbb{R}^{d_{0}}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><msub id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.1.m1.1.1.2.3" xref="S3.SS1.p1.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">d</mi><mn id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">0</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><apply id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2">𝐱</ci><ci id="S3.SS1.p1.1.m1.1.1.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝑑</ci><cn id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{x}_{k}\in\mathbb{R}^{d_{0}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> denote the feature representation of <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_k</annotation></semantics></math>-th data sample and let <math alttext="y_{k}\in\{0,1\}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.2"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.3" xref="S3.SS1.p1.3.m3.2.3.cmml"><msub id="S3.SS1.p1.3.m3.2.3.2" xref="S3.SS1.p1.3.m3.2.3.2.cmml"><mi id="S3.SS1.p1.3.m3.2.3.2.2" xref="S3.SS1.p1.3.m3.2.3.2.2.cmml">y</mi><mi id="S3.SS1.p1.3.m3.2.3.2.3" xref="S3.SS1.p1.3.m3.2.3.2.3.cmml">k</mi></msub><mo id="S3.SS1.p1.3.m3.2.3.1" xref="S3.SS1.p1.3.m3.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.3.m3.2.3.3.2" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml"><mo id="S3.SS1.p1.3.m3.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml">{</mo><mn id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">0</mn><mo id="S3.SS1.p1.3.m3.2.3.3.2.2" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml">1</mn><mo id="S3.SS1.p1.3.m3.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3"><in id="S3.SS1.p1.3.m3.2.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.1"></in><apply id="S3.SS1.p1.3.m3.2.3.2.cmml" xref="S3.SS1.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.3.2.1.cmml" xref="S3.SS1.p1.3.m3.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.3.2.2">𝑦</ci><ci id="S3.SS1.p1.3.m3.2.3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3.2.3">𝑘</ci></apply><set id="S3.SS1.p1.3.m3.2.3.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.3.2"><cn id="S3.SS1.p1.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1">0</cn><cn id="S3.SS1.p1.3.m3.2.2.cmml" type="integer" xref="S3.SS1.p1.3.m3.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">y_{k}\in\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.2d">italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ { 0 , 1 }</annotation></semantics></math> denote the label of the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_k</annotation></semantics></math>-th interaction.
The process of CTR prediction can be written as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{k}=\sigma(f(\mathbf{x}_{k}))," class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E1.m1.1.1.1.1.3.2.1" xref="S3.E1.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2"><ci id="S3.E1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.2.1">^</ci><ci id="S3.E1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">𝑓</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\hat{y}_{k}=\sigma(f(\mathbf{x}_{k})),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_σ ( italic_f ( bold_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.9">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m1.1"><semantics id="S3.SS1.p1.5.m1.1a"><mrow id="S3.SS1.p1.5.m1.1.2" xref="S3.SS1.p1.5.m1.1.2.cmml"><mi id="S3.SS1.p1.5.m1.1.2.2" xref="S3.SS1.p1.5.m1.1.2.2.cmml">σ</mi><mo id="S3.SS1.p1.5.m1.1.2.1" xref="S3.SS1.p1.5.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.5.m1.1.2.3.2" xref="S3.SS1.p1.5.m1.1.2.cmml"><mo id="S3.SS1.p1.5.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.5.m1.1.2.cmml">(</mo><mo id="S3.SS1.p1.5.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.5.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.5.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m1.1b"><apply id="S3.SS1.p1.5.m1.1.2.cmml" xref="S3.SS1.p1.5.m1.1.2"><times id="S3.SS1.p1.5.m1.1.2.1.cmml" xref="S3.SS1.p1.5.m1.1.2.1"></times><ci id="S3.SS1.p1.5.m1.1.2.2.cmml" xref="S3.SS1.p1.5.m1.1.2.2">𝜎</ci><ci id="S3.SS1.p1.5.m1.1.1.cmml" xref="S3.SS1.p1.5.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m1.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m1.1d">italic_σ ( ⋅ )</annotation></semantics></math> is the sigmoid function, <math alttext="f" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m2.1"><semantics id="S3.SS1.p1.6.m2.1a"><mi id="S3.SS1.p1.6.m2.1.1" xref="S3.SS1.p1.6.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m2.1b"><ci id="S3.SS1.p1.6.m2.1.1.cmml" xref="S3.SS1.p1.6.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m2.1d">italic_f</annotation></semantics></math> is the mapping function implemented as the CTR model <math alttext="f:\mathbb{R}^{d_{0}}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m3.1"><semantics id="S3.SS1.p1.7.m3.1a"><mrow id="S3.SS1.p1.7.m3.1.1" xref="S3.SS1.p1.7.m3.1.1.cmml"><mi id="S3.SS1.p1.7.m3.1.1.2" xref="S3.SS1.p1.7.m3.1.1.2.cmml">f</mi><mo id="S3.SS1.p1.7.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.7.m3.1.1.1.cmml">:</mo><mrow id="S3.SS1.p1.7.m3.1.1.3" xref="S3.SS1.p1.7.m3.1.1.3.cmml"><msup id="S3.SS1.p1.7.m3.1.1.3.2" xref="S3.SS1.p1.7.m3.1.1.3.2.cmml"><mi id="S3.SS1.p1.7.m3.1.1.3.2.2" xref="S3.SS1.p1.7.m3.1.1.3.2.2.cmml">ℝ</mi><msub id="S3.SS1.p1.7.m3.1.1.3.2.3" xref="S3.SS1.p1.7.m3.1.1.3.2.3.cmml"><mi id="S3.SS1.p1.7.m3.1.1.3.2.3.2" xref="S3.SS1.p1.7.m3.1.1.3.2.3.2.cmml">d</mi><mn id="S3.SS1.p1.7.m3.1.1.3.2.3.3" xref="S3.SS1.p1.7.m3.1.1.3.2.3.3.cmml">0</mn></msub></msup><mo id="S3.SS1.p1.7.m3.1.1.3.1" stretchy="false" xref="S3.SS1.p1.7.m3.1.1.3.1.cmml">→</mo><mi id="S3.SS1.p1.7.m3.1.1.3.3" xref="S3.SS1.p1.7.m3.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m3.1b"><apply id="S3.SS1.p1.7.m3.1.1.cmml" xref="S3.SS1.p1.7.m3.1.1"><ci id="S3.SS1.p1.7.m3.1.1.1.cmml" xref="S3.SS1.p1.7.m3.1.1.1">:</ci><ci id="S3.SS1.p1.7.m3.1.1.2.cmml" xref="S3.SS1.p1.7.m3.1.1.2">𝑓</ci><apply id="S3.SS1.p1.7.m3.1.1.3.cmml" xref="S3.SS1.p1.7.m3.1.1.3"><ci id="S3.SS1.p1.7.m3.1.1.3.1.cmml" xref="S3.SS1.p1.7.m3.1.1.3.1">→</ci><apply id="S3.SS1.p1.7.m3.1.1.3.2.cmml" xref="S3.SS1.p1.7.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m3.1.1.3.2.1.cmml" xref="S3.SS1.p1.7.m3.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p1.7.m3.1.1.3.2.2.cmml" xref="S3.SS1.p1.7.m3.1.1.3.2.2">ℝ</ci><apply id="S3.SS1.p1.7.m3.1.1.3.2.3.cmml" xref="S3.SS1.p1.7.m3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m3.1.1.3.2.3.1.cmml" xref="S3.SS1.p1.7.m3.1.1.3.2.3">subscript</csymbol><ci id="S3.SS1.p1.7.m3.1.1.3.2.3.2.cmml" xref="S3.SS1.p1.7.m3.1.1.3.2.3.2">𝑑</ci><cn id="S3.SS1.p1.7.m3.1.1.3.2.3.3.cmml" type="integer" xref="S3.SS1.p1.7.m3.1.1.3.2.3.3">0</cn></apply></apply><ci id="S3.SS1.p1.7.m3.1.1.3.3.cmml" xref="S3.SS1.p1.7.m3.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m3.1c">f:\mathbb{R}^{d_{0}}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m3.1d">italic_f : blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT → blackboard_R</annotation></semantics></math>, and <math alttext="\hat{y}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m4.1"><semantics id="S3.SS1.p1.8.m4.1a"><msub id="S3.SS1.p1.8.m4.1.1" xref="S3.SS1.p1.8.m4.1.1.cmml"><mover accent="true" id="S3.SS1.p1.8.m4.1.1.2" xref="S3.SS1.p1.8.m4.1.1.2.cmml"><mi id="S3.SS1.p1.8.m4.1.1.2.2" xref="S3.SS1.p1.8.m4.1.1.2.2.cmml">y</mi><mo id="S3.SS1.p1.8.m4.1.1.2.1" xref="S3.SS1.p1.8.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.8.m4.1.1.3" xref="S3.SS1.p1.8.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m4.1b"><apply id="S3.SS1.p1.8.m4.1.1.cmml" xref="S3.SS1.p1.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m4.1.1.1.cmml" xref="S3.SS1.p1.8.m4.1.1">subscript</csymbol><apply id="S3.SS1.p1.8.m4.1.1.2.cmml" xref="S3.SS1.p1.8.m4.1.1.2"><ci id="S3.SS1.p1.8.m4.1.1.2.1.cmml" xref="S3.SS1.p1.8.m4.1.1.2.1">^</ci><ci id="S3.SS1.p1.8.m4.1.1.2.2.cmml" xref="S3.SS1.p1.8.m4.1.1.2.2">𝑦</ci></apply><ci id="S3.SS1.p1.8.m4.1.1.3.cmml" xref="S3.SS1.p1.8.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m4.1c">\hat{y}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m4.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the predicted probability. The model <math alttext="f" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m5.1"><semantics id="S3.SS1.p1.9.m5.1a"><mi id="S3.SS1.p1.9.m5.1.1" xref="S3.SS1.p1.9.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m5.1b"><ci id="S3.SS1.p1.9.m5.1.1.cmml" xref="S3.SS1.p1.9.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m5.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m5.1d">italic_f</annotation></semantics></math> is trained by the binary cross entropy loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=-\frac{1}{|\mathcal{D}|}\sum_{k=1}^{|\mathcal{D}|}y_{k}\log(\hat{y%
}_{k})+(1-y_{k})\log(1-\hat{y}_{k})," class="ltx_Math" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.5" xref="S3.E2.m1.5.5.1.1.5.cmml">ℒ</mi><mo id="S3.E2.m1.5.5.1.1.4" xref="S3.E2.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml"><mrow id="S3.E2.m1.5.5.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1a" xref="S3.E2.m1.5.5.1.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.cmml"><mfrac id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mn id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">1</mn><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.3.1" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.E2.m1.1.1.1.3.2" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E2.m1.5.5.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml"><munderover id="S3.E2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E2.m1.2.2.1.3" xref="S3.E2.m1.2.2.1.2.cmml"><mo id="S3.E2.m1.2.2.1.3.1" stretchy="false" xref="S3.E2.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">𝒟</mi><mo id="S3.E2.m1.2.2.1.3.2" stretchy="false" xref="S3.E2.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.2" lspace="0.167em" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">log</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1a" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.3.4" xref="S3.E2.m1.5.5.1.1.3.4.cmml">+</mo><mrow id="S3.E2.m1.5.5.1.1.3.3" xref="S3.E2.m1.5.5.1.1.3.3.cmml"><mrow id="S3.E2.m1.5.5.1.1.2.2.1.1" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.cmml"><mo id="S3.E2.m1.5.5.1.1.2.2.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.1.1.1" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.cmml"><mn id="S3.E2.m1.5.5.1.1.2.2.1.1.1.2" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S3.E2.m1.5.5.1.1.2.2.1.1.1.1" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="S3.E2.m1.5.5.1.1.2.2.1.1.1.3" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.2.cmml">y</mi><mi id="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.3" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E2.m1.5.5.1.1.2.2.1.1.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.5.5.1.1.3.3.3" lspace="0.167em" xref="S3.E2.m1.5.5.1.1.3.3.3.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.3.3.2.1" xref="S3.E2.m1.5.5.1.1.3.3.2.2.cmml"><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">log</mi><mo id="S3.E2.m1.5.5.1.1.3.3.2.1a" xref="S3.E2.m1.5.5.1.1.3.3.2.2.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.1.1.3.3.2.1.1" xref="S3.E2.m1.5.5.1.1.3.3.2.2.cmml"><mo id="S3.E2.m1.5.5.1.1.3.3.2.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.1.1.3.3.2.2.cmml">(</mo><mrow id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.cmml"><mn id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.2" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.2.cmml">1</mn><mo id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.1" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.1.cmml">−</mo><msub id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.cmml"><mover accent="true" id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.cmml"><mi id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.2" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.1" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.3" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E2.m1.5.5.1.1.3.3.2.1.1.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.4.cmml" xref="S3.E2.m1.5.5.1.1.4"></eq><ci id="S3.E2.m1.5.5.1.1.5.cmml" xref="S3.E2.m1.5.5.1.1.5">ℒ</ci><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"><plus id="S3.E2.m1.5.5.1.1.3.4.cmml" xref="S3.E2.m1.5.5.1.1.3.4"></plus><apply id="S3.E2.m1.5.5.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1"><minus id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1"></minus><apply id="S3.E2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><divide id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1"></divide><cn id="S3.E2.m1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.3">1</cn><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.3"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.3.1"></abs><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1"><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3"><eq id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.2">𝑘</ci><cn id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.3"><abs id="S3.E2.m1.2.2.1.2.1.cmml" xref="S3.E2.m1.2.2.1.3.1"></abs><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝒟</ci></apply></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1"><log id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"></log><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.5.5.1.1.3.3.cmml" xref="S3.E2.m1.5.5.1.1.3.3"><times id="S3.E2.m1.5.5.1.1.3.3.3.cmml" xref="S3.E2.m1.5.5.1.1.3.3.3"></times><apply id="S3.E2.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1"><minus id="S3.E2.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.1"></minus><cn id="S3.E2.m1.5.5.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.2">1</cn><apply id="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.2">𝑦</ci><ci id="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.5.5.1.1.3.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1"><log id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"></log><apply id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1"><minus id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.1"></minus><cn id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.2.cmml" type="integer" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.2">1</cn><apply id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3">subscript</csymbol><apply id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2"><ci id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.1">^</ci><ci id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.2.2">𝑦</ci></apply><ci id="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.3.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\mathcal{L}=-\frac{1}{|\mathcal{D}|}\sum_{k=1}^{|\mathcal{D}|}y_{k}\log(\hat{y%
}_{k})+(1-y_{k})\log(1-\hat{y}_{k}),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">caligraphic_L = - divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_D | end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) + ( 1 - italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) roman_log ( 1 - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.10">where <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m1.1"><semantics id="S3.SS1.p1.10.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m1.1.1" xref="S3.SS1.p1.10.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m1.1b"><ci id="S3.SS1.p1.10.m1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m1.1d">caligraphic_D</annotation></semantics></math> denotes the training dataset.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Overall Workflow</h3>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="280" id="S3.F2.g1" src="x2.png" width="648"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">Overview of TWIN-V2 in Kuaishou’s CTR prediction system.
Left: the offline component compresses life-cycle behaviors and extracts features of clustered behaviors.
Right: the online component captures user interests from life-cycle behaviors, which adopts a two-stage approach. GSU and ESU for both stages take clustered behaviors as input.
</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#S3.F2" title="Figure 2 ‣ 3.2. Overall Workflow ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Figure 2</span></a> illustrates the overall framework of TWIN-V2, including <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.1">offline</em> and <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.2">online</em> parts.
This paper focuses on life-cycle behavior modeling. Thus we emphasize this part and omit other parts.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Since the behavior over the entire life cycle is too lengthy for online inferring, we initially compress it during the <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.1">offline</em> phase.
User behavior often includes many similar videos, as users frequently browse their favorite topics.
Therefore, we employ hierarchical clustering to aggregate items with similar interests in each user’s history into clusters. Online inferring captures the user’s long-term interests using these clusters and their representation vectors.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">During <em class="ltx_emph ltx_font_italic" id="S3.SS2.p3.1.1">online inferring</em>, we adopt a two-stage approach for life-cycle modeling. First, we use GSU to retrieve the top 100 clusters related to the target item from the clustered behaviors, and then employ ESU to extract long-term interests from these clusters.
In GSU and ESU, we implement cluster-aware target attention, adjusting weights for different clusters.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Life-Cycle User Modeling</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Considering that the user histories over the life cycle have ultra-long sequences, we first compress these behaviors in a divide-and-conquer method and then extract users’ long-term interests from compressed behaviors.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1. </span>Hierarchical Clustering Over Life Cycle</h4>
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.47">
<div class="ltx_listingline" id="algorithm1.10.10">
<span class="ltx_text" id="algorithm1.10.10.10" style="font-size:80%;">
<span class="ltx_text" id="algorithm1.10.10.10.1"><span class="ltx_text ltx_font_bold" id="algorithm1.10.10.10.1.1">Input:</span> </span>
History items <math alttext="S_{1:T}" class="ltx_Math" display="inline" id="algorithm1.1.1.1.m1.1"><semantics id="algorithm1.1.1.1.m1.1a"><msub id="algorithm1.1.1.1.m1.1.1" xref="algorithm1.1.1.1.m1.1.1.cmml"><mi id="algorithm1.1.1.1.m1.1.1.2" xref="algorithm1.1.1.1.m1.1.1.2.cmml">S</mi><mrow id="algorithm1.1.1.1.m1.1.1.3" xref="algorithm1.1.1.1.m1.1.1.3.cmml"><mn id="algorithm1.1.1.1.m1.1.1.3.2" xref="algorithm1.1.1.1.m1.1.1.3.2.cmml">1</mn><mo id="algorithm1.1.1.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="algorithm1.1.1.1.m1.1.1.3.1.cmml">:</mo><mi id="algorithm1.1.1.1.m1.1.1.3.3" xref="algorithm1.1.1.1.m1.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.1.m1.1b"><apply id="algorithm1.1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1">subscript</csymbol><ci id="algorithm1.1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.1.m1.1.1.2">𝑆</ci><apply id="algorithm1.1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.1.m1.1.1.3"><ci id="algorithm1.1.1.1.m1.1.1.3.1.cmml" xref="algorithm1.1.1.1.m1.1.1.3.1">:</ci><cn id="algorithm1.1.1.1.m1.1.1.3.2.cmml" type="integer" xref="algorithm1.1.1.1.m1.1.1.3.2">1</cn><ci id="algorithm1.1.1.1.m1.1.1.3.3.cmml" xref="algorithm1.1.1.1.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.1.m1.1c">S_{1:T}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.1.m1.1d">italic_S start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT</annotation></semantics></math>, Item embeddings <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="algorithm1.2.2.2.m2.1"><semantics id="algorithm1.2.2.2.m2.1a"><msub id="algorithm1.2.2.2.m2.1.1" xref="algorithm1.2.2.2.m2.1.1.cmml"><mi id="algorithm1.2.2.2.m2.1.1.2" xref="algorithm1.2.2.2.m2.1.1.2.cmml">𝐊</mi><mi id="algorithm1.2.2.2.m2.1.1.3" xref="algorithm1.2.2.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.2.m2.1b"><apply id="algorithm1.2.2.2.m2.1.1.cmml" xref="algorithm1.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.2.2.2.m2.1.1.1.cmml" xref="algorithm1.2.2.2.m2.1.1">subscript</csymbol><ci id="algorithm1.2.2.2.m2.1.1.2.cmml" xref="algorithm1.2.2.2.m2.1.1.2">𝐊</ci><ci id="algorithm1.2.2.2.m2.1.1.3.cmml" xref="algorithm1.2.2.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.2.m2.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.2.m2.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, Item Playing Completion Ratio <math alttext="P_{1:T}" class="ltx_Math" display="inline" id="algorithm1.3.3.3.m3.1"><semantics id="algorithm1.3.3.3.m3.1a"><msub id="algorithm1.3.3.3.m3.1.1" xref="algorithm1.3.3.3.m3.1.1.cmml"><mi id="algorithm1.3.3.3.m3.1.1.2" xref="algorithm1.3.3.3.m3.1.1.2.cmml">P</mi><mrow id="algorithm1.3.3.3.m3.1.1.3" xref="algorithm1.3.3.3.m3.1.1.3.cmml"><mn id="algorithm1.3.3.3.m3.1.1.3.2" xref="algorithm1.3.3.3.m3.1.1.3.2.cmml">1</mn><mo id="algorithm1.3.3.3.m3.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="algorithm1.3.3.3.m3.1.1.3.1.cmml">:</mo><mi id="algorithm1.3.3.3.m3.1.1.3.3" xref="algorithm1.3.3.3.m3.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.3.m3.1b"><apply id="algorithm1.3.3.3.m3.1.1.cmml" xref="algorithm1.3.3.3.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.3.3.3.m3.1.1.1.cmml" xref="algorithm1.3.3.3.m3.1.1">subscript</csymbol><ci id="algorithm1.3.3.3.m3.1.1.2.cmml" xref="algorithm1.3.3.3.m3.1.1.2">𝑃</ci><apply id="algorithm1.3.3.3.m3.1.1.3.cmml" xref="algorithm1.3.3.3.m3.1.1.3"><ci id="algorithm1.3.3.3.m3.1.1.3.1.cmml" xref="algorithm1.3.3.3.m3.1.1.3.1">:</ci><cn id="algorithm1.3.3.3.m3.1.1.3.2.cmml" type="integer" xref="algorithm1.3.3.3.m3.1.1.3.2">1</cn><ci id="algorithm1.3.3.3.m3.1.1.3.3.cmml" xref="algorithm1.3.3.3.m3.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.3.m3.1c">P_{1:T}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.3.m3.1d">italic_P start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT</annotation></semantics></math>, group number <math alttext="M" class="ltx_Math" display="inline" id="algorithm1.4.4.4.m4.1"><semantics id="algorithm1.4.4.4.m4.1a"><mi id="algorithm1.4.4.4.m4.1.1" xref="algorithm1.4.4.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.4.m4.1b"><ci id="algorithm1.4.4.4.m4.1.1.cmml" xref="algorithm1.4.4.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.4.m4.1d">italic_M</annotation></semantics></math>, and maximum cluster size <math alttext="\gamma" class="ltx_Math" display="inline" id="algorithm1.5.5.5.m5.1"><semantics id="algorithm1.5.5.5.m5.1a"><mi id="algorithm1.5.5.5.m5.1.1" xref="algorithm1.5.5.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.5.m5.1b"><ci id="algorithm1.5.5.5.m5.1.1.cmml" xref="algorithm1.5.5.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.5.m5.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.5.m5.1d">italic_γ</annotation></semantics></math>, where <math alttext="s_{j}" class="ltx_Math" display="inline" id="algorithm1.6.6.6.m6.1"><semantics id="algorithm1.6.6.6.m6.1a"><msub id="algorithm1.6.6.6.m6.1.1" xref="algorithm1.6.6.6.m6.1.1.cmml"><mi id="algorithm1.6.6.6.m6.1.1.2" xref="algorithm1.6.6.6.m6.1.1.2.cmml">s</mi><mi id="algorithm1.6.6.6.m6.1.1.3" xref="algorithm1.6.6.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.6.m6.1b"><apply id="algorithm1.6.6.6.m6.1.1.cmml" xref="algorithm1.6.6.6.m6.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.6.m6.1.1.1.cmml" xref="algorithm1.6.6.6.m6.1.1">subscript</csymbol><ci id="algorithm1.6.6.6.m6.1.1.2.cmml" xref="algorithm1.6.6.6.m6.1.1.2">𝑠</ci><ci id="algorithm1.6.6.6.m6.1.1.3.cmml" xref="algorithm1.6.6.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.6.m6.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.6.m6.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="j" class="ltx_Math" display="inline" id="algorithm1.7.7.7.m7.1"><semantics id="algorithm1.7.7.7.m7.1a"><mi id="algorithm1.7.7.7.m7.1.1" xref="algorithm1.7.7.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.7.m7.1b"><ci id="algorithm1.7.7.7.m7.1.1.cmml" xref="algorithm1.7.7.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.7.m7.1d">italic_j</annotation></semantics></math>-th item, <math alttext="\mathbf{K}_{s}\in\mathbb{R}^{T\times d}" class="ltx_Math" display="inline" id="algorithm1.8.8.8.m8.1"><semantics id="algorithm1.8.8.8.m8.1a"><mrow id="algorithm1.8.8.8.m8.1.1" xref="algorithm1.8.8.8.m8.1.1.cmml"><msub id="algorithm1.8.8.8.m8.1.1.2" xref="algorithm1.8.8.8.m8.1.1.2.cmml"><mi id="algorithm1.8.8.8.m8.1.1.2.2" xref="algorithm1.8.8.8.m8.1.1.2.2.cmml">𝐊</mi><mi id="algorithm1.8.8.8.m8.1.1.2.3" xref="algorithm1.8.8.8.m8.1.1.2.3.cmml">s</mi></msub><mo id="algorithm1.8.8.8.m8.1.1.1" xref="algorithm1.8.8.8.m8.1.1.1.cmml">∈</mo><msup id="algorithm1.8.8.8.m8.1.1.3" xref="algorithm1.8.8.8.m8.1.1.3.cmml"><mi id="algorithm1.8.8.8.m8.1.1.3.2" xref="algorithm1.8.8.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="algorithm1.8.8.8.m8.1.1.3.3" xref="algorithm1.8.8.8.m8.1.1.3.3.cmml"><mi id="algorithm1.8.8.8.m8.1.1.3.3.2" xref="algorithm1.8.8.8.m8.1.1.3.3.2.cmml">T</mi><mo id="algorithm1.8.8.8.m8.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm1.8.8.8.m8.1.1.3.3.1.cmml">×</mo><mi id="algorithm1.8.8.8.m8.1.1.3.3.3" xref="algorithm1.8.8.8.m8.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.8.m8.1b"><apply id="algorithm1.8.8.8.m8.1.1.cmml" xref="algorithm1.8.8.8.m8.1.1"><in id="algorithm1.8.8.8.m8.1.1.1.cmml" xref="algorithm1.8.8.8.m8.1.1.1"></in><apply id="algorithm1.8.8.8.m8.1.1.2.cmml" xref="algorithm1.8.8.8.m8.1.1.2"><csymbol cd="ambiguous" id="algorithm1.8.8.8.m8.1.1.2.1.cmml" xref="algorithm1.8.8.8.m8.1.1.2">subscript</csymbol><ci id="algorithm1.8.8.8.m8.1.1.2.2.cmml" xref="algorithm1.8.8.8.m8.1.1.2.2">𝐊</ci><ci id="algorithm1.8.8.8.m8.1.1.2.3.cmml" xref="algorithm1.8.8.8.m8.1.1.2.3">𝑠</ci></apply><apply id="algorithm1.8.8.8.m8.1.1.3.cmml" xref="algorithm1.8.8.8.m8.1.1.3"><csymbol cd="ambiguous" id="algorithm1.8.8.8.m8.1.1.3.1.cmml" xref="algorithm1.8.8.8.m8.1.1.3">superscript</csymbol><ci id="algorithm1.8.8.8.m8.1.1.3.2.cmml" xref="algorithm1.8.8.8.m8.1.1.3.2">ℝ</ci><apply id="algorithm1.8.8.8.m8.1.1.3.3.cmml" xref="algorithm1.8.8.8.m8.1.1.3.3"><times id="algorithm1.8.8.8.m8.1.1.3.3.1.cmml" xref="algorithm1.8.8.8.m8.1.1.3.3.1"></times><ci id="algorithm1.8.8.8.m8.1.1.3.3.2.cmml" xref="algorithm1.8.8.8.m8.1.1.3.3.2">𝑇</ci><ci id="algorithm1.8.8.8.m8.1.1.3.3.3.cmml" xref="algorithm1.8.8.8.m8.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.8.m8.1c">\mathbf{K}_{s}\in\mathbb{R}^{T\times d}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.8.m8.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_T × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="p_{i}\in\mathbb{R}" class="ltx_Math" display="inline" id="algorithm1.9.9.9.m9.1"><semantics id="algorithm1.9.9.9.m9.1a"><mrow id="algorithm1.9.9.9.m9.1.1" xref="algorithm1.9.9.9.m9.1.1.cmml"><msub id="algorithm1.9.9.9.m9.1.1.2" xref="algorithm1.9.9.9.m9.1.1.2.cmml"><mi id="algorithm1.9.9.9.m9.1.1.2.2" xref="algorithm1.9.9.9.m9.1.1.2.2.cmml">p</mi><mi id="algorithm1.9.9.9.m9.1.1.2.3" xref="algorithm1.9.9.9.m9.1.1.2.3.cmml">i</mi></msub><mo id="algorithm1.9.9.9.m9.1.1.1" xref="algorithm1.9.9.9.m9.1.1.1.cmml">∈</mo><mi id="algorithm1.9.9.9.m9.1.1.3" xref="algorithm1.9.9.9.m9.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.9.m9.1b"><apply id="algorithm1.9.9.9.m9.1.1.cmml" xref="algorithm1.9.9.9.m9.1.1"><in id="algorithm1.9.9.9.m9.1.1.1.cmml" xref="algorithm1.9.9.9.m9.1.1.1"></in><apply id="algorithm1.9.9.9.m9.1.1.2.cmml" xref="algorithm1.9.9.9.m9.1.1.2"><csymbol cd="ambiguous" id="algorithm1.9.9.9.m9.1.1.2.1.cmml" xref="algorithm1.9.9.9.m9.1.1.2">subscript</csymbol><ci id="algorithm1.9.9.9.m9.1.1.2.2.cmml" xref="algorithm1.9.9.9.m9.1.1.2.2">𝑝</ci><ci id="algorithm1.9.9.9.m9.1.1.2.3.cmml" xref="algorithm1.9.9.9.m9.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.9.9.9.m9.1.1.3.cmml" xref="algorithm1.9.9.9.m9.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.9.m9.1c">p_{i}\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.9.m9.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R</annotation></semantics></math>, and <math alttext="M,\gamma\in\mathbb{N}^{+}" class="ltx_Math" display="inline" id="algorithm1.10.10.10.m10.2"><semantics id="algorithm1.10.10.10.m10.2a"><mrow id="algorithm1.10.10.10.m10.2.3" xref="algorithm1.10.10.10.m10.2.3.cmml"><mrow id="algorithm1.10.10.10.m10.2.3.2.2" xref="algorithm1.10.10.10.m10.2.3.2.1.cmml"><mi id="algorithm1.10.10.10.m10.1.1" xref="algorithm1.10.10.10.m10.1.1.cmml">M</mi><mo id="algorithm1.10.10.10.m10.2.3.2.2.1" xref="algorithm1.10.10.10.m10.2.3.2.1.cmml">,</mo><mi id="algorithm1.10.10.10.m10.2.2" xref="algorithm1.10.10.10.m10.2.2.cmml">γ</mi></mrow><mo id="algorithm1.10.10.10.m10.2.3.1" xref="algorithm1.10.10.10.m10.2.3.1.cmml">∈</mo><msup id="algorithm1.10.10.10.m10.2.3.3" xref="algorithm1.10.10.10.m10.2.3.3.cmml"><mi id="algorithm1.10.10.10.m10.2.3.3.2" xref="algorithm1.10.10.10.m10.2.3.3.2.cmml">ℕ</mi><mo id="algorithm1.10.10.10.m10.2.3.3.3" xref="algorithm1.10.10.10.m10.2.3.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.10.m10.2b"><apply id="algorithm1.10.10.10.m10.2.3.cmml" xref="algorithm1.10.10.10.m10.2.3"><in id="algorithm1.10.10.10.m10.2.3.1.cmml" xref="algorithm1.10.10.10.m10.2.3.1"></in><list id="algorithm1.10.10.10.m10.2.3.2.1.cmml" xref="algorithm1.10.10.10.m10.2.3.2.2"><ci id="algorithm1.10.10.10.m10.1.1.cmml" xref="algorithm1.10.10.10.m10.1.1">𝑀</ci><ci id="algorithm1.10.10.10.m10.2.2.cmml" xref="algorithm1.10.10.10.m10.2.2">𝛾</ci></list><apply id="algorithm1.10.10.10.m10.2.3.3.cmml" xref="algorithm1.10.10.10.m10.2.3.3"><csymbol cd="ambiguous" id="algorithm1.10.10.10.m10.2.3.3.1.cmml" xref="algorithm1.10.10.10.m10.2.3.3">superscript</csymbol><ci id="algorithm1.10.10.10.m10.2.3.3.2.cmml" xref="algorithm1.10.10.10.m10.2.3.3.2">ℕ</ci><plus id="algorithm1.10.10.10.m10.2.3.3.3.cmml" xref="algorithm1.10.10.10.m10.2.3.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.10.m10.2c">M,\gamma\in\mathbb{N}^{+}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.10.m10.2d">italic_M , italic_γ ∈ blackboard_N start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="algorithm1.11.11">
<span class="ltx_text" id="algorithm1.11.11.1" style="font-size:80%;">
</span><span class="ltx_text" id="algorithm1.11.11.2" style="font-size:80%;"><span class="ltx_text ltx_font_bold" id="algorithm1.11.11.2.1">Output:</span> </span><span class="ltx_text" id="algorithm1.11.11.3" style="font-size:80%;">Clustered items </span><math alttext="C_{1:\hat{T}}" class="ltx_Math" display="inline" id="algorithm1.11.11.m1.1"><semantics id="algorithm1.11.11.m1.1a"><msub id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml"><mi id="algorithm1.11.11.m1.1.1.2" mathsize="80%" xref="algorithm1.11.11.m1.1.1.2.cmml">C</mi><mrow id="algorithm1.11.11.m1.1.1.3" xref="algorithm1.11.11.m1.1.1.3.cmml"><mn id="algorithm1.11.11.m1.1.1.3.2" mathsize="80%" xref="algorithm1.11.11.m1.1.1.3.2.cmml">1</mn><mo id="algorithm1.11.11.m1.1.1.3.1" lspace="0.278em" mathsize="80%" rspace="0.278em" xref="algorithm1.11.11.m1.1.1.3.1.cmml">:</mo><mover accent="true" id="algorithm1.11.11.m1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.3.3.cmml"><mi id="algorithm1.11.11.m1.1.1.3.3.2" mathsize="80%" xref="algorithm1.11.11.m1.1.1.3.3.2.cmml">T</mi><mo id="algorithm1.11.11.m1.1.1.3.3.1" mathsize="80%" xref="algorithm1.11.11.m1.1.1.3.3.1.cmml">^</mo></mover></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.2">𝐶</ci><apply id="algorithm1.11.11.m1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.3"><ci id="algorithm1.11.11.m1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.3.1">:</ci><cn id="algorithm1.11.11.m1.1.1.3.2.cmml" type="integer" xref="algorithm1.11.11.m1.1.1.3.2">1</cn><apply id="algorithm1.11.11.m1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.1.1.3.3"><ci id="algorithm1.11.11.m1.1.1.3.3.1.cmml" xref="algorithm1.11.11.m1.1.1.3.3.1">^</ci><ci id="algorithm1.11.11.m1.1.1.3.3.2.cmml" xref="algorithm1.11.11.m1.1.1.3.3.2">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">C_{1:\hat{T}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.11.m1.1d">italic_C start_POSTSUBSCRIPT 1 : over^ start_ARG italic_T end_ARG end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.12.12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.12.12.1.1.1" style="font-size:80%;">1</span></span><span class="ltx_text" id="algorithm1.12.12.2" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="algorithm1.12.12.3" style="font-size:80%;">Function</span><span class="ltx_text" id="algorithm1.12.12.4" style="font-size:80%;"> </span><math alttext="h_{\text{comp}(S_{1:T})}" class="ltx_Math" display="inline" id="algorithm1.12.12.m1.1"><semantics id="algorithm1.12.12.m1.1a"><msub id="algorithm1.12.12.m1.1.2" xref="algorithm1.12.12.m1.1.2.cmml"><mi id="algorithm1.12.12.m1.1.2.2" mathsize="80%" xref="algorithm1.12.12.m1.1.2.2.cmml">h</mi><mrow id="algorithm1.12.12.m1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.cmml"><mtext id="algorithm1.12.12.m1.1.1.1.3" mathsize="80%" xref="algorithm1.12.12.m1.1.1.1.3a.cmml">comp</mtext><mo id="algorithm1.12.12.m1.1.1.1.2" xref="algorithm1.12.12.m1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.12.12.m1.1.1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.1.1.1.cmml"><mo id="algorithm1.12.12.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="algorithm1.12.12.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.12.12.m1.1.1.1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.12.12.m1.1.1.1.1.1.1.2" mathsize="80%" xref="algorithm1.12.12.m1.1.1.1.1.1.1.2.cmml">S</mi><mrow id="algorithm1.12.12.m1.1.1.1.1.1.1.3" xref="algorithm1.12.12.m1.1.1.1.1.1.1.3.cmml"><mn id="algorithm1.12.12.m1.1.1.1.1.1.1.3.2" mathsize="80%" xref="algorithm1.12.12.m1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="algorithm1.12.12.m1.1.1.1.1.1.1.3.1" lspace="0.278em" mathsize="80%" rspace="0.278em" xref="algorithm1.12.12.m1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="algorithm1.12.12.m1.1.1.1.1.1.1.3.3" mathsize="80%" xref="algorithm1.12.12.m1.1.1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="algorithm1.12.12.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="algorithm1.12.12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.2.cmml" xref="algorithm1.12.12.m1.1.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.2.1.cmml" xref="algorithm1.12.12.m1.1.2">subscript</csymbol><ci id="algorithm1.12.12.m1.1.2.2.cmml" xref="algorithm1.12.12.m1.1.2.2">ℎ</ci><apply id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1"><times id="algorithm1.12.12.m1.1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.1.2"></times><ci id="algorithm1.12.12.m1.1.1.1.3a.cmml" xref="algorithm1.12.12.m1.1.1.1.3"><mtext id="algorithm1.12.12.m1.1.1.1.3.cmml" mathsize="56%" xref="algorithm1.12.12.m1.1.1.1.3">comp</mtext></ci><apply id="algorithm1.12.12.m1.1.1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.12.12.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.1.1.1.1.2">𝑆</ci><apply id="algorithm1.12.12.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.1.1.1.1.3"><ci id="algorithm1.12.12.m1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.12.12.m1.1.1.1.1.1.1.3.1">:</ci><cn id="algorithm1.12.12.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="algorithm1.12.12.m1.1.1.1.1.1.1.3.2">1</cn><ci id="algorithm1.12.12.m1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.12.12.m1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">h_{\text{comp}(S_{1:T})}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.12.m1.1d">italic_h start_POSTSUBSCRIPT comp ( italic_S start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm1.12.12.5" style="font-size:80%;"> :

</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.48">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.48.1.1.1" style="font-size:80%;">2</span></span><span class="ltx_text" id="algorithm1.47.48.2" style="font-size:80%;color:#336699;"># Rule-based item grouping in lines 3-8</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.49">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.49.1.1.1" style="font-size:80%;">3</span></span><span class="ltx_text" id="algorithm1.47.49.2" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="algorithm1.14.14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.14.14.1.1.1" style="font-size:80%;">4</span></span><span class="ltx_text" id="algorithm1.14.14.2" style="font-size:80%;">Initialize </span><math alttext="M" class="ltx_Math" display="inline" id="algorithm1.13.13.m1.1"><semantics id="algorithm1.13.13.m1.1a"><mi id="algorithm1.13.13.m1.1.1" mathsize="80%" xref="algorithm1.13.13.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><ci id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.13.m1.1d">italic_M</annotation></semantics></math><span class="ltx_text" id="algorithm1.14.14.3" style="font-size:80%;"> empty lists </span><math alttext="L_{1},L_{2},\cdots,L_{M}" class="ltx_Math" display="inline" id="algorithm1.14.14.m2.4"><semantics id="algorithm1.14.14.m2.4a"><mrow id="algorithm1.14.14.m2.4.4.3" xref="algorithm1.14.14.m2.4.4.4.cmml"><msub id="algorithm1.14.14.m2.2.2.1.1" xref="algorithm1.14.14.m2.2.2.1.1.cmml"><mi id="algorithm1.14.14.m2.2.2.1.1.2" mathsize="80%" xref="algorithm1.14.14.m2.2.2.1.1.2.cmml">L</mi><mn id="algorithm1.14.14.m2.2.2.1.1.3" mathsize="80%" xref="algorithm1.14.14.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="algorithm1.14.14.m2.4.4.3.4" mathsize="80%" xref="algorithm1.14.14.m2.4.4.4.cmml">,</mo><msub id="algorithm1.14.14.m2.3.3.2.2" xref="algorithm1.14.14.m2.3.3.2.2.cmml"><mi id="algorithm1.14.14.m2.3.3.2.2.2" mathsize="80%" xref="algorithm1.14.14.m2.3.3.2.2.2.cmml">L</mi><mn id="algorithm1.14.14.m2.3.3.2.2.3" mathsize="80%" xref="algorithm1.14.14.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="algorithm1.14.14.m2.4.4.3.5" mathsize="80%" xref="algorithm1.14.14.m2.4.4.4.cmml">,</mo><mi id="algorithm1.14.14.m2.1.1" mathsize="80%" mathvariant="normal" xref="algorithm1.14.14.m2.1.1.cmml">⋯</mi><mo id="algorithm1.14.14.m2.4.4.3.6" mathsize="80%" xref="algorithm1.14.14.m2.4.4.4.cmml">,</mo><msub id="algorithm1.14.14.m2.4.4.3.3" xref="algorithm1.14.14.m2.4.4.3.3.cmml"><mi id="algorithm1.14.14.m2.4.4.3.3.2" mathsize="80%" xref="algorithm1.14.14.m2.4.4.3.3.2.cmml">L</mi><mi id="algorithm1.14.14.m2.4.4.3.3.3" mathsize="80%" xref="algorithm1.14.14.m2.4.4.3.3.3.cmml">M</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m2.4b"><list id="algorithm1.14.14.m2.4.4.4.cmml" xref="algorithm1.14.14.m2.4.4.3"><apply id="algorithm1.14.14.m2.2.2.1.1.cmml" xref="algorithm1.14.14.m2.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.2.2.1.1.1.cmml" xref="algorithm1.14.14.m2.2.2.1.1">subscript</csymbol><ci id="algorithm1.14.14.m2.2.2.1.1.2.cmml" xref="algorithm1.14.14.m2.2.2.1.1.2">𝐿</ci><cn id="algorithm1.14.14.m2.2.2.1.1.3.cmml" type="integer" xref="algorithm1.14.14.m2.2.2.1.1.3">1</cn></apply><apply id="algorithm1.14.14.m2.3.3.2.2.cmml" xref="algorithm1.14.14.m2.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.3.3.2.2.1.cmml" xref="algorithm1.14.14.m2.3.3.2.2">subscript</csymbol><ci id="algorithm1.14.14.m2.3.3.2.2.2.cmml" xref="algorithm1.14.14.m2.3.3.2.2.2">𝐿</ci><cn id="algorithm1.14.14.m2.3.3.2.2.3.cmml" type="integer" xref="algorithm1.14.14.m2.3.3.2.2.3">2</cn></apply><ci id="algorithm1.14.14.m2.1.1.cmml" xref="algorithm1.14.14.m2.1.1">⋯</ci><apply id="algorithm1.14.14.m2.4.4.3.3.cmml" xref="algorithm1.14.14.m2.4.4.3.3"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.4.4.3.3.1.cmml" xref="algorithm1.14.14.m2.4.4.3.3">subscript</csymbol><ci id="algorithm1.14.14.m2.4.4.3.3.2.cmml" xref="algorithm1.14.14.m2.4.4.3.3.2">𝐿</ci><ci id="algorithm1.14.14.m2.4.4.3.3.3.cmml" xref="algorithm1.14.14.m2.4.4.3.3.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m2.4c">L_{1},L_{2},\cdots,L_{M}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.14.14.m2.4d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm1.14.14.4" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="algorithm1.18.18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.18.18.1.1.1" style="font-size:80%;">5</span></span><span class="ltx_text" id="algorithm1.18.18.2" style="font-size:80%;">
Define a function </span><math alttext="\text{getGroup}(p)" class="ltx_Math" display="inline" id="algorithm1.15.15.m1.1"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.2" xref="algorithm1.15.15.m1.1.2.cmml"><mtext id="algorithm1.15.15.m1.1.2.2" mathsize="80%" xref="algorithm1.15.15.m1.1.2.2a.cmml">getGroup</mtext><mo id="algorithm1.15.15.m1.1.2.1" xref="algorithm1.15.15.m1.1.2.1.cmml">⁢</mo><mrow id="algorithm1.15.15.m1.1.2.3.2" xref="algorithm1.15.15.m1.1.2.cmml"><mo id="algorithm1.15.15.m1.1.2.3.2.1" maxsize="80%" minsize="80%" xref="algorithm1.15.15.m1.1.2.cmml">(</mo><mi id="algorithm1.15.15.m1.1.1" mathsize="80%" xref="algorithm1.15.15.m1.1.1.cmml">p</mi><mo id="algorithm1.15.15.m1.1.2.3.2.2" maxsize="80%" minsize="80%" xref="algorithm1.15.15.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.2.cmml" xref="algorithm1.15.15.m1.1.2"><times id="algorithm1.15.15.m1.1.2.1.cmml" xref="algorithm1.15.15.m1.1.2.1"></times><ci id="algorithm1.15.15.m1.1.2.2a.cmml" xref="algorithm1.15.15.m1.1.2.2"><mtext id="algorithm1.15.15.m1.1.2.2.cmml" mathsize="80%" xref="algorithm1.15.15.m1.1.2.2">getGroup</mtext></ci><ci id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">\text{getGroup}(p)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.15.15.m1.1d">getGroup ( italic_p )</annotation></semantics></math><span class="ltx_text" id="algorithm1.18.18.3" style="font-size:80%;"> that returns the group number </span><math alttext="m" class="ltx_Math" display="inline" id="algorithm1.16.16.m2.1"><semantics id="algorithm1.16.16.m2.1a"><mi id="algorithm1.16.16.m2.1.1" mathsize="80%" xref="algorithm1.16.16.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m2.1b"><ci id="algorithm1.16.16.m2.1.1.cmml" xref="algorithm1.16.16.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="algorithm1.16.16.m2.1d">italic_m</annotation></semantics></math><span class="ltx_text" id="algorithm1.18.18.4" style="font-size:80%;"> for the </span><math alttext="j" class="ltx_Math" display="inline" id="algorithm1.17.17.m3.1"><semantics id="algorithm1.17.17.m3.1a"><mi id="algorithm1.17.17.m3.1.1" mathsize="80%" xref="algorithm1.17.17.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m3.1b"><ci id="algorithm1.17.17.m3.1.1.cmml" xref="algorithm1.17.17.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="algorithm1.17.17.m3.1d">italic_j</annotation></semantics></math><span class="ltx_text" id="algorithm1.18.18.5" style="font-size:80%;">-th item considering its </span><math alttext="p_{j}" class="ltx_Math" display="inline" id="algorithm1.18.18.m4.1"><semantics id="algorithm1.18.18.m4.1a"><msub id="algorithm1.18.18.m4.1.1" xref="algorithm1.18.18.m4.1.1.cmml"><mi id="algorithm1.18.18.m4.1.1.2" mathsize="80%" xref="algorithm1.18.18.m4.1.1.2.cmml">p</mi><mi id="algorithm1.18.18.m4.1.1.3" mathsize="80%" xref="algorithm1.18.18.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m4.1b"><apply id="algorithm1.18.18.m4.1.1.cmml" xref="algorithm1.18.18.m4.1.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m4.1.1.1.cmml" xref="algorithm1.18.18.m4.1.1">subscript</csymbol><ci id="algorithm1.18.18.m4.1.1.2.cmml" xref="algorithm1.18.18.m4.1.1.2">𝑝</ci><ci id="algorithm1.18.18.m4.1.1.3.cmml" xref="algorithm1.18.18.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m4.1c">p_{j}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.18.18.m4.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm1.18.18.6" style="font-size:80%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm1.20.20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.20.20.3.1.1" style="font-size:80%;">6</span></span><span class="ltx_text ltx_font_bold" id="algorithm1.20.20.4" style="font-size:80%;">for</span><span class="ltx_text" id="algorithm1.20.20.5" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm1.20.20.2" style="font-size:80%;"><math alttext="j=1" class="ltx_Math" display="inline" id="algorithm1.19.19.1.m1.1"><semantics id="algorithm1.19.19.1.m1.1a"><mrow id="algorithm1.19.19.1.m1.1.1" xref="algorithm1.19.19.1.m1.1.1.cmml"><mi id="algorithm1.19.19.1.m1.1.1.2" xref="algorithm1.19.19.1.m1.1.1.2.cmml">j</mi><mo id="algorithm1.19.19.1.m1.1.1.1" xref="algorithm1.19.19.1.m1.1.1.1.cmml">=</mo><mn id="algorithm1.19.19.1.m1.1.1.3" xref="algorithm1.19.19.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.1.m1.1b"><apply id="algorithm1.19.19.1.m1.1.1.cmml" xref="algorithm1.19.19.1.m1.1.1"><eq id="algorithm1.19.19.1.m1.1.1.1.cmml" xref="algorithm1.19.19.1.m1.1.1.1"></eq><ci id="algorithm1.19.19.1.m1.1.1.2.cmml" xref="algorithm1.19.19.1.m1.1.1.2">𝑗</ci><cn id="algorithm1.19.19.1.m1.1.1.3.cmml" type="integer" xref="algorithm1.19.19.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.1.m1.1c">j=1</annotation><annotation encoding="application/x-llamapun" id="algorithm1.19.19.1.m1.1d">italic_j = 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="algorithm1.20.20.2.1">to</span> <math alttext="T" class="ltx_Math" display="inline" id="algorithm1.20.20.2.m2.1"><semantics id="algorithm1.20.20.2.m2.1a"><mi id="algorithm1.20.20.2.m2.1.1" xref="algorithm1.20.20.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.2.m2.1b"><ci id="algorithm1.20.20.2.m2.1.1.cmml" xref="algorithm1.20.20.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="algorithm1.20.20.2.m2.1d">italic_T</annotation></semantics></math></em><span class="ltx_text" id="algorithm1.20.20.6" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm1.20.20.7" style="font-size:80%;">do</span><span class="ltx_text" id="algorithm1.20.20.8" style="font-size:80%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm1.21.21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.21.21.1.1.1" style="font-size:80%;">7</span></span><span class="ltx_text" id="algorithm1.21.21.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.21.21.3" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.21.21.4" style="font-size:80%;">
</span><math alttext="m=\text{getGroup}(p_{j})" class="ltx_Math" display="inline" id="algorithm1.21.21.m1.1"><semantics id="algorithm1.21.21.m1.1a"><mrow id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml"><mi id="algorithm1.21.21.m1.1.1.3" mathsize="80%" xref="algorithm1.21.21.m1.1.1.3.cmml">m</mi><mo id="algorithm1.21.21.m1.1.1.2" mathsize="80%" xref="algorithm1.21.21.m1.1.1.2.cmml">=</mo><mrow id="algorithm1.21.21.m1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.cmml"><mtext id="algorithm1.21.21.m1.1.1.1.3" mathsize="80%" xref="algorithm1.21.21.m1.1.1.1.3a.cmml">getGroup</mtext><mo id="algorithm1.21.21.m1.1.1.1.2" xref="algorithm1.21.21.m1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.21.21.m1.1.1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.1.1.1.cmml"><mo id="algorithm1.21.21.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="algorithm1.21.21.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.21.21.m1.1.1.1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.21.21.m1.1.1.1.1.1.1.2" mathsize="80%" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="algorithm1.21.21.m1.1.1.1.1.1.1.3" mathsize="80%" xref="algorithm1.21.21.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="algorithm1.21.21.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="algorithm1.21.21.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.1b"><apply id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1"><eq id="algorithm1.21.21.m1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.2"></eq><ci id="algorithm1.21.21.m1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.3">𝑚</ci><apply id="algorithm1.21.21.m1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1"><times id="algorithm1.21.21.m1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1.2"></times><ci id="algorithm1.21.21.m1.1.1.1.3a.cmml" xref="algorithm1.21.21.m1.1.1.1.3"><mtext id="algorithm1.21.21.m1.1.1.1.3.cmml" mathsize="80%" xref="algorithm1.21.21.m1.1.1.1.3">getGroup</mtext></ci><apply id="algorithm1.21.21.m1.1.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.1c">m=\text{getGroup}(p_{j})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.21.21.m1.1d">italic_m = getGroup ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="algorithm1.21.21.5" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="algorithm1.22.22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.22.22.1.1.1" style="font-size:80%;">8</span></span><span class="ltx_text" id="algorithm1.22.22.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.22.22.3" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.22.22.4" style="font-size:80%;">
</span><math alttext="L_{m}.\text{Append}(s_{j})" class="ltx_Math" display="inline" id="algorithm1.22.22.m1.2"><semantics id="algorithm1.22.22.m1.2a"><mrow id="algorithm1.22.22.m1.2.2.2" xref="algorithm1.22.22.m1.2.2.3.cmml"><msub id="algorithm1.22.22.m1.1.1.1.1" xref="algorithm1.22.22.m1.1.1.1.1.cmml"><mi id="algorithm1.22.22.m1.1.1.1.1.2" mathsize="80%" xref="algorithm1.22.22.m1.1.1.1.1.2.cmml">L</mi><mi id="algorithm1.22.22.m1.1.1.1.1.3" mathsize="80%" xref="algorithm1.22.22.m1.1.1.1.1.3.cmml">m</mi></msub><mo id="algorithm1.22.22.m1.2.2.2.3" lspace="0em" mathsize="80%" rspace="0.167em" xref="algorithm1.22.22.m1.2.2.3a.cmml">.</mo><mrow id="algorithm1.22.22.m1.2.2.2.2" xref="algorithm1.22.22.m1.2.2.2.2.cmml"><mtext id="algorithm1.22.22.m1.2.2.2.2.3" mathsize="80%" xref="algorithm1.22.22.m1.2.2.2.2.3a.cmml">Append</mtext><mo id="algorithm1.22.22.m1.2.2.2.2.2" xref="algorithm1.22.22.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="algorithm1.22.22.m1.2.2.2.2.1.1" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.cmml"><mo id="algorithm1.22.22.m1.2.2.2.2.1.1.2" maxsize="80%" minsize="80%" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="algorithm1.22.22.m1.2.2.2.2.1.1.1" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.22.22.m1.2.2.2.2.1.1.1.2" mathsize="80%" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.2.cmml">s</mi><mi id="algorithm1.22.22.m1.2.2.2.2.1.1.1.3" mathsize="80%" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="algorithm1.22.22.m1.2.2.2.2.1.1.3" maxsize="80%" minsize="80%" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.2b"><apply id="algorithm1.22.22.m1.2.2.3.cmml" xref="algorithm1.22.22.m1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.2.2.3a.cmml" xref="algorithm1.22.22.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm1.22.22.m1.1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.1.1.2">𝐿</ci><ci id="algorithm1.22.22.m1.1.1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.1.1.3">𝑚</ci></apply><apply id="algorithm1.22.22.m1.2.2.2.2.cmml" xref="algorithm1.22.22.m1.2.2.2.2"><times id="algorithm1.22.22.m1.2.2.2.2.2.cmml" xref="algorithm1.22.22.m1.2.2.2.2.2"></times><ci id="algorithm1.22.22.m1.2.2.2.2.3a.cmml" xref="algorithm1.22.22.m1.2.2.2.2.3"><mtext id="algorithm1.22.22.m1.2.2.2.2.3.cmml" mathsize="80%" xref="algorithm1.22.22.m1.2.2.2.2.3">Append</mtext></ci><apply id="algorithm1.22.22.m1.2.2.2.2.1.1.1.cmml" xref="algorithm1.22.22.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.22.22.m1.2.2.2.2.1.1">subscript</csymbol><ci id="algorithm1.22.22.m1.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.2">𝑠</ci><ci id="algorithm1.22.22.m1.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.2c">L_{m}.\text{Append}(s_{j})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.22.22.m1.2d">italic_L start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT . Append ( italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="algorithm1.22.22.5" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.50">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.50.1.1.1" style="font-size:80%;">9</span></span><span class="ltx_text" id="algorithm1.47.50.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.50.3" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.47.50.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.51">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.51.1.1.1" style="font-size:80%;">10</span></span><span class="ltx_text" id="algorithm1.47.51.2" style="font-size:80%;"> end for</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.52">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.52.1.1.1" style="font-size:80%;">11</span></span>
</div>
<div class="ltx_listingline" id="algorithm1.47.53">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.53.1.1.1" style="font-size:80%;">12</span></span><span class="ltx_text" id="algorithm1.47.53.2" style="font-size:80%;color:#336699;"># Recursively adaptive clustering in lines 10-28</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.54">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.54.1.1.1" style="font-size:80%;">13</span></span><span class="ltx_text" id="algorithm1.47.54.2" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="algorithm1.23.23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.23.23.1.1.1" style="font-size:80%;">14</span></span><span class="ltx_text" id="algorithm1.23.23.2" style="font-size:80%;">Initialize an empty list </span><math alttext="C" class="ltx_Math" display="inline" id="algorithm1.23.23.m1.1"><semantics id="algorithm1.23.23.m1.1a"><mi id="algorithm1.23.23.m1.1.1" mathsize="80%" xref="algorithm1.23.23.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m1.1b"><ci id="algorithm1.23.23.m1.1.1.cmml" xref="algorithm1.23.23.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="algorithm1.23.23.m1.1d">italic_C</annotation></semantics></math><span class="ltx_text" id="algorithm1.23.23.3" style="font-size:80%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm1.25.25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.25.25.3.1.1" style="font-size:80%;">15</span></span><span class="ltx_text ltx_font_bold" id="algorithm1.25.25.4" style="font-size:80%;">for</span><span class="ltx_text" id="algorithm1.25.25.5" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm1.25.25.2" style="font-size:80%;"><math alttext="m=1" class="ltx_Math" display="inline" id="algorithm1.24.24.1.m1.1"><semantics id="algorithm1.24.24.1.m1.1a"><mrow id="algorithm1.24.24.1.m1.1.1" xref="algorithm1.24.24.1.m1.1.1.cmml"><mi id="algorithm1.24.24.1.m1.1.1.2" xref="algorithm1.24.24.1.m1.1.1.2.cmml">m</mi><mo id="algorithm1.24.24.1.m1.1.1.1" xref="algorithm1.24.24.1.m1.1.1.1.cmml">=</mo><mn id="algorithm1.24.24.1.m1.1.1.3" xref="algorithm1.24.24.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.1.m1.1b"><apply id="algorithm1.24.24.1.m1.1.1.cmml" xref="algorithm1.24.24.1.m1.1.1"><eq id="algorithm1.24.24.1.m1.1.1.1.cmml" xref="algorithm1.24.24.1.m1.1.1.1"></eq><ci id="algorithm1.24.24.1.m1.1.1.2.cmml" xref="algorithm1.24.24.1.m1.1.1.2">𝑚</ci><cn id="algorithm1.24.24.1.m1.1.1.3.cmml" type="integer" xref="algorithm1.24.24.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.1.m1.1c">m=1</annotation><annotation encoding="application/x-llamapun" id="algorithm1.24.24.1.m1.1d">italic_m = 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="algorithm1.25.25.2.1">to</span> <math alttext="M" class="ltx_Math" display="inline" id="algorithm1.25.25.2.m2.1"><semantics id="algorithm1.25.25.2.m2.1a"><mi id="algorithm1.25.25.2.m2.1.1" xref="algorithm1.25.25.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.2.m2.1b"><ci id="algorithm1.25.25.2.m2.1.1.cmml" xref="algorithm1.25.25.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="algorithm1.25.25.2.m2.1d">italic_M</annotation></semantics></math></em><span class="ltx_text" id="algorithm1.25.25.6" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm1.25.25.7" style="font-size:80%;">do</span><span class="ltx_text" id="algorithm1.25.25.8" style="font-size:80%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.26.26.1.1.1" style="font-size:80%;">16</span></span><span class="ltx_text" id="algorithm1.26.26.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.26.26.3" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.26.26.4" style="font-size:80%;">
Initialize an empty queue </span><math alttext="Q" class="ltx_Math" display="inline" id="algorithm1.26.26.m1.1"><semantics id="algorithm1.26.26.m1.1a"><mi id="algorithm1.26.26.m1.1.1" mathsize="80%" xref="algorithm1.26.26.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m1.1b"><ci id="algorithm1.26.26.m1.1.1.cmml" xref="algorithm1.26.26.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="algorithm1.26.26.m1.1d">italic_Q</annotation></semantics></math><span class="ltx_text" id="algorithm1.26.26.5" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="algorithm1.27.27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.27.27.1.1.1" style="font-size:80%;">17</span></span><span class="ltx_text" id="algorithm1.27.27.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.27.27.3" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.27.27.4" style="font-size:80%;">
</span><math alttext="Q.\text{enqueue}(L_{m})" class="ltx_Math" display="inline" id="algorithm1.27.27.m1.2"><semantics id="algorithm1.27.27.m1.2a"><mrow id="algorithm1.27.27.m1.2.2.1" xref="algorithm1.27.27.m1.2.2.2.cmml"><mi id="algorithm1.27.27.m1.1.1" mathsize="80%" xref="algorithm1.27.27.m1.1.1.cmml">Q</mi><mo id="algorithm1.27.27.m1.2.2.1.2" lspace="0em" mathsize="80%" rspace="0.167em" xref="algorithm1.27.27.m1.2.2.2a.cmml">.</mo><mrow id="algorithm1.27.27.m1.2.2.1.1" xref="algorithm1.27.27.m1.2.2.1.1.cmml"><mtext id="algorithm1.27.27.m1.2.2.1.1.3" mathsize="80%" xref="algorithm1.27.27.m1.2.2.1.1.3a.cmml">enqueue</mtext><mo id="algorithm1.27.27.m1.2.2.1.1.2" xref="algorithm1.27.27.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="algorithm1.27.27.m1.2.2.1.1.1.1" xref="algorithm1.27.27.m1.2.2.1.1.1.1.1.cmml"><mo id="algorithm1.27.27.m1.2.2.1.1.1.1.2" maxsize="80%" minsize="80%" xref="algorithm1.27.27.m1.2.2.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.27.27.m1.2.2.1.1.1.1.1" xref="algorithm1.27.27.m1.2.2.1.1.1.1.1.cmml"><mi id="algorithm1.27.27.m1.2.2.1.1.1.1.1.2" mathsize="80%" xref="algorithm1.27.27.m1.2.2.1.1.1.1.1.2.cmml">L</mi><mi id="algorithm1.27.27.m1.2.2.1.1.1.1.1.3" mathsize="80%" xref="algorithm1.27.27.m1.2.2.1.1.1.1.1.3.cmml">m</mi></msub><mo id="algorithm1.27.27.m1.2.2.1.1.1.1.3" maxsize="80%" minsize="80%" xref="algorithm1.27.27.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m1.2b"><apply id="algorithm1.27.27.m1.2.2.2.cmml" xref="algorithm1.27.27.m1.2.2.1"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.2.2.2a.cmml" xref="algorithm1.27.27.m1.2.2.1.2">formulae-sequence</csymbol><ci id="algorithm1.27.27.m1.1.1.cmml" xref="algorithm1.27.27.m1.1.1">𝑄</ci><apply id="algorithm1.27.27.m1.2.2.1.1.cmml" xref="algorithm1.27.27.m1.2.2.1.1"><times id="algorithm1.27.27.m1.2.2.1.1.2.cmml" xref="algorithm1.27.27.m1.2.2.1.1.2"></times><ci id="algorithm1.27.27.m1.2.2.1.1.3a.cmml" xref="algorithm1.27.27.m1.2.2.1.1.3"><mtext id="algorithm1.27.27.m1.2.2.1.1.3.cmml" mathsize="80%" xref="algorithm1.27.27.m1.2.2.1.1.3">enqueue</mtext></ci><apply id="algorithm1.27.27.m1.2.2.1.1.1.1.1.cmml" xref="algorithm1.27.27.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.27.27.m1.2.2.1.1.1.1">subscript</csymbol><ci id="algorithm1.27.27.m1.2.2.1.1.1.1.1.2.cmml" xref="algorithm1.27.27.m1.2.2.1.1.1.1.1.2">𝐿</ci><ci id="algorithm1.27.27.m1.2.2.1.1.1.1.1.3.cmml" xref="algorithm1.27.27.m1.2.2.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m1.2c">Q.\text{enqueue}(L_{m})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.27.27.m1.2d">italic_Q . enqueue ( italic_L start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="algorithm1.27.27.5" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="algorithm1.28.28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.28.28.2.1.1" style="font-size:80%;">18</span></span><span class="ltx_text" id="algorithm1.28.28.3" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.28.28.4" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.28.28.5" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="algorithm1.28.28.6" style="font-size:80%;">while</span><span class="ltx_text" id="algorithm1.28.28.7" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm1.28.28.1" style="font-size:80%;"><math alttext="Q" class="ltx_Math" display="inline" id="algorithm1.28.28.1.m1.1"><semantics id="algorithm1.28.28.1.m1.1a"><mi id="algorithm1.28.28.1.m1.1.1" xref="algorithm1.28.28.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algorithm1.28.28.1.m1.1b"><ci id="algorithm1.28.28.1.m1.1.1.cmml" xref="algorithm1.28.28.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.28.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="algorithm1.28.28.1.m1.1d">italic_Q</annotation></semantics></math> is not empty</em><span class="ltx_text" id="algorithm1.28.28.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm1.28.28.9" style="font-size:80%;">do</span><span class="ltx_text" id="algorithm1.28.28.10" style="font-size:80%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm1.31.31">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.31.31.1.1.1" style="font-size:80%;">19</span></span><span class="ltx_text" id="algorithm1.31.31.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.31.31.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.31.31.4" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.31.31.5" style="font-size:80%;">
</span><math alttext="V" class="ltx_Math" display="inline" id="algorithm1.29.29.m1.1"><semantics id="algorithm1.29.29.m1.1a"><mi id="algorithm1.29.29.m1.1.1" mathsize="80%" xref="algorithm1.29.29.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="algorithm1.29.29.m1.1b"><ci id="algorithm1.29.29.m1.1.1.cmml" xref="algorithm1.29.29.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.29.m1.1c">V</annotation><annotation encoding="application/x-llamapun" id="algorithm1.29.29.m1.1d">italic_V</annotation></semantics></math><span class="ltx_text" id="algorithm1.31.31.6" style="font-size:80%;"> </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="algorithm1.30.30.m2.1"><semantics id="algorithm1.30.30.m2.1a"><mo id="algorithm1.30.30.m2.1.1" mathsize="80%" stretchy="false" xref="algorithm1.30.30.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm1.30.30.m2.1b"><ci id="algorithm1.30.30.m2.1.1.cmml" xref="algorithm1.30.30.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.30.m2.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm1.30.30.m2.1d">←</annotation></semantics></math><span class="ltx_text" id="algorithm1.31.31.7" style="font-size:80%;"> </span><math alttext="Q.\text{dequeue}()" class="ltx_Math" display="inline" id="algorithm1.31.31.m3.2"><semantics id="algorithm1.31.31.m3.2a"><mrow id="algorithm1.31.31.m3.2.2.1" xref="algorithm1.31.31.m3.2.2.2.cmml"><mi id="algorithm1.31.31.m3.1.1" mathsize="80%" xref="algorithm1.31.31.m3.1.1.cmml">Q</mi><mo id="algorithm1.31.31.m3.2.2.1.2" lspace="0em" mathsize="80%" rspace="0.167em" xref="algorithm1.31.31.m3.2.2.2a.cmml">.</mo><mrow id="algorithm1.31.31.m3.2.2.1.1" xref="algorithm1.31.31.m3.2.2.1.1.cmml"><mtext id="algorithm1.31.31.m3.2.2.1.1.2" mathsize="80%" xref="algorithm1.31.31.m3.2.2.1.1.2a.cmml">dequeue</mtext><mo id="algorithm1.31.31.m3.2.2.1.1.1" xref="algorithm1.31.31.m3.2.2.1.1.1.cmml">⁢</mo><mrow id="algorithm1.31.31.m3.2.2.1.1.3.2" xref="algorithm1.31.31.m3.2.2.1.1.cmml"><mo id="algorithm1.31.31.m3.2.2.1.1.3.2.1" maxsize="80%" minsize="80%" xref="algorithm1.31.31.m3.2.2.1.1.3.1.cmml">(</mo><mo id="algorithm1.31.31.m3.2.2.1.1.3.2.2" maxsize="80%" minsize="80%" xref="algorithm1.31.31.m3.2.2.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.31.31.m3.2b"><apply id="algorithm1.31.31.m3.2.2.2.cmml" xref="algorithm1.31.31.m3.2.2.1"><csymbol cd="ambiguous" id="algorithm1.31.31.m3.2.2.2a.cmml" xref="algorithm1.31.31.m3.2.2.1.2">formulae-sequence</csymbol><ci id="algorithm1.31.31.m3.1.1.cmml" xref="algorithm1.31.31.m3.1.1">𝑄</ci><apply id="algorithm1.31.31.m3.2.2.1.1.cmml" xref="algorithm1.31.31.m3.2.2.1.1"><times id="algorithm1.31.31.m3.2.2.1.1.1.cmml" xref="algorithm1.31.31.m3.2.2.1.1.1"></times><ci id="algorithm1.31.31.m3.2.2.1.1.2a.cmml" xref="algorithm1.31.31.m3.2.2.1.1.2"><mtext id="algorithm1.31.31.m3.2.2.1.1.2.cmml" mathsize="80%" xref="algorithm1.31.31.m3.2.2.1.1.2">dequeue</mtext></ci><list id="algorithm1.31.31.m3.2.2.1.1.3.1.cmml" xref="algorithm1.31.31.m3.2.2.1.1.3.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.31.m3.2c">Q.\text{dequeue}()</annotation><annotation encoding="application/x-llamapun" id="algorithm1.31.31.m3.2d">italic_Q . dequeue ( )</annotation></semantics></math><span class="ltx_text" id="algorithm1.31.31.8" style="font-size:80%;"> ;</span>
</div>
<div class="ltx_listingline" id="algorithm1.32.32">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.32.32.2.1.1" style="font-size:80%;">20</span></span><span class="ltx_text" id="algorithm1.32.32.3" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.32.32.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.32.32.5" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.32.32.6" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="algorithm1.32.32.7" style="font-size:80%;">if</span><span class="ltx_text" id="algorithm1.32.32.8" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm1.32.32.1" style="font-size:80%;"><math alttext="|V|&lt;\gamma" class="ltx_Math" display="inline" id="algorithm1.32.32.1.m1.1"><semantics id="algorithm1.32.32.1.m1.1a"><mrow id="algorithm1.32.32.1.m1.1.2" xref="algorithm1.32.32.1.m1.1.2.cmml"><mrow id="algorithm1.32.32.1.m1.1.2.2.2" xref="algorithm1.32.32.1.m1.1.2.2.1.cmml"><mo id="algorithm1.32.32.1.m1.1.2.2.2.1" stretchy="false" xref="algorithm1.32.32.1.m1.1.2.2.1.1.cmml">|</mo><mi id="algorithm1.32.32.1.m1.1.1" xref="algorithm1.32.32.1.m1.1.1.cmml">V</mi><mo id="algorithm1.32.32.1.m1.1.2.2.2.2" stretchy="false" xref="algorithm1.32.32.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="algorithm1.32.32.1.m1.1.2.1" xref="algorithm1.32.32.1.m1.1.2.1.cmml">&lt;</mo><mi id="algorithm1.32.32.1.m1.1.2.3" xref="algorithm1.32.32.1.m1.1.2.3.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.32.32.1.m1.1b"><apply id="algorithm1.32.32.1.m1.1.2.cmml" xref="algorithm1.32.32.1.m1.1.2"><lt id="algorithm1.32.32.1.m1.1.2.1.cmml" xref="algorithm1.32.32.1.m1.1.2.1"></lt><apply id="algorithm1.32.32.1.m1.1.2.2.1.cmml" xref="algorithm1.32.32.1.m1.1.2.2.2"><abs id="algorithm1.32.32.1.m1.1.2.2.1.1.cmml" xref="algorithm1.32.32.1.m1.1.2.2.2.1"></abs><ci id="algorithm1.32.32.1.m1.1.1.cmml" xref="algorithm1.32.32.1.m1.1.1">𝑉</ci></apply><ci id="algorithm1.32.32.1.m1.1.2.3.cmml" xref="algorithm1.32.32.1.m1.1.2.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.32.32.1.m1.1c">|V|&lt;\gamma</annotation><annotation encoding="application/x-llamapun" id="algorithm1.32.32.1.m1.1d">| italic_V | &lt; italic_γ</annotation></semantics></math></em><span class="ltx_text" id="algorithm1.32.32.9" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm1.32.32.10" style="font-size:80%;">then</span><span class="ltx_text" id="algorithm1.32.32.11" style="font-size:80%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm1.33.33">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.33.33.1.1.1" style="font-size:80%;">21</span></span><span class="ltx_text" id="algorithm1.33.33.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.33.33.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.33.33.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.33.33.5" style="font-size:80%;">   </span><math alttext="C.\text{append}(V)" class="ltx_Math" display="inline" id="algorithm1.33.33.m1.3"><semantics id="algorithm1.33.33.m1.3a"><mrow id="algorithm1.33.33.m1.3.3.1" xref="algorithm1.33.33.m1.3.3.2.cmml"><mi id="algorithm1.33.33.m1.2.2" mathsize="80%" xref="algorithm1.33.33.m1.2.2.cmml">C</mi><mo id="algorithm1.33.33.m1.3.3.1.2" lspace="0em" mathsize="80%" rspace="0.167em" xref="algorithm1.33.33.m1.3.3.2a.cmml">.</mo><mrow id="algorithm1.33.33.m1.3.3.1.1" xref="algorithm1.33.33.m1.3.3.1.1.cmml"><mtext id="algorithm1.33.33.m1.3.3.1.1.2" mathsize="80%" xref="algorithm1.33.33.m1.3.3.1.1.2a.cmml">append</mtext><mo id="algorithm1.33.33.m1.3.3.1.1.1" xref="algorithm1.33.33.m1.3.3.1.1.1.cmml">⁢</mo><mrow id="algorithm1.33.33.m1.3.3.1.1.3.2" xref="algorithm1.33.33.m1.3.3.1.1.cmml"><mo id="algorithm1.33.33.m1.3.3.1.1.3.2.1" maxsize="80%" minsize="80%" xref="algorithm1.33.33.m1.3.3.1.1.cmml">(</mo><mi id="algorithm1.33.33.m1.1.1" mathsize="80%" xref="algorithm1.33.33.m1.1.1.cmml">V</mi><mo id="algorithm1.33.33.m1.3.3.1.1.3.2.2" maxsize="80%" minsize="80%" xref="algorithm1.33.33.m1.3.3.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.33.33.m1.3b"><apply id="algorithm1.33.33.m1.3.3.2.cmml" xref="algorithm1.33.33.m1.3.3.1"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.3.3.2a.cmml" xref="algorithm1.33.33.m1.3.3.1.2">formulae-sequence</csymbol><ci id="algorithm1.33.33.m1.2.2.cmml" xref="algorithm1.33.33.m1.2.2">𝐶</ci><apply id="algorithm1.33.33.m1.3.3.1.1.cmml" xref="algorithm1.33.33.m1.3.3.1.1"><times id="algorithm1.33.33.m1.3.3.1.1.1.cmml" xref="algorithm1.33.33.m1.3.3.1.1.1"></times><ci id="algorithm1.33.33.m1.3.3.1.1.2a.cmml" xref="algorithm1.33.33.m1.3.3.1.1.2"><mtext id="algorithm1.33.33.m1.3.3.1.1.2.cmml" mathsize="80%" xref="algorithm1.33.33.m1.3.3.1.1.2">append</mtext></ci><ci id="algorithm1.33.33.m1.1.1.cmml" xref="algorithm1.33.33.m1.1.1">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.33.33.m1.3c">C.\text{append}(V)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.33.33.m1.3d">italic_C . append ( italic_V )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.47.55">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.55.1.1.1" style="font-size:80%;">22</span></span><span class="ltx_text" id="algorithm1.47.55.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.55.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.55.4" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.47.55.5" style="font-size:80%;"> end if</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.56">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.56.1.1.1" style="font-size:80%;">23</span></span><span class="ltx_text" id="algorithm1.47.56.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.56.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.56.4" style="font-size:80%;">   </span><span class="ltx_text ltx_font_bold" id="algorithm1.47.56.5" style="font-size:80%;">else</span><span class="ltx_text" id="algorithm1.47.56.6" style="font-size:80%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm1.36.36">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.36.36.1.1.1" style="font-size:80%;">24</span></span><span class="ltx_text" id="algorithm1.36.36.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.36.36.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.36.36.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.36.36.5" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.36.36.6" style="font-size:80%;">
</span><math alttext="\delta" class="ltx_Math" display="inline" id="algorithm1.34.34.m1.1"><semantics id="algorithm1.34.34.m1.1a"><mi id="algorithm1.34.34.m1.1.1" mathsize="80%" xref="algorithm1.34.34.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.34.34.m1.1b"><ci id="algorithm1.34.34.m1.1.1.cmml" xref="algorithm1.34.34.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.34.34.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="algorithm1.34.34.m1.1d">italic_δ</annotation></semantics></math><span class="ltx_text" id="algorithm1.36.36.7" style="font-size:80%;"> </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="algorithm1.35.35.m2.1"><semantics id="algorithm1.35.35.m2.1a"><mo id="algorithm1.35.35.m2.1.1" mathsize="80%" stretchy="false" xref="algorithm1.35.35.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm1.35.35.m2.1b"><ci id="algorithm1.35.35.m2.1.1.cmml" xref="algorithm1.35.35.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.35.35.m2.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm1.35.35.m2.1d">←</annotation></semantics></math><span class="ltx_text" id="algorithm1.36.36.8" style="font-size:80%;"> </span><math alttext="\lfloor|V|^{0.3}\rfloor" class="ltx_Math" display="inline" id="algorithm1.36.36.m3.2"><semantics id="algorithm1.36.36.m3.2a"><mrow id="algorithm1.36.36.m3.2.2.1" xref="algorithm1.36.36.m3.2.2.2.cmml"><mo id="algorithm1.36.36.m3.2.2.1.2" maxsize="80%" minsize="80%" xref="algorithm1.36.36.m3.2.2.2.1.cmml">⌊</mo><msup id="algorithm1.36.36.m3.2.2.1.1" xref="algorithm1.36.36.m3.2.2.1.1.cmml"><mrow id="algorithm1.36.36.m3.2.2.1.1.2.2" xref="algorithm1.36.36.m3.2.2.1.1.2.1.cmml"><mo id="algorithm1.36.36.m3.2.2.1.1.2.2.1" maxsize="80%" minsize="80%" xref="algorithm1.36.36.m3.2.2.1.1.2.1.1.cmml">|</mo><mi id="algorithm1.36.36.m3.1.1" mathsize="80%" xref="algorithm1.36.36.m3.1.1.cmml">V</mi><mo id="algorithm1.36.36.m3.2.2.1.1.2.2.2" maxsize="80%" minsize="80%" xref="algorithm1.36.36.m3.2.2.1.1.2.1.1.cmml">|</mo></mrow><mn id="algorithm1.36.36.m3.2.2.1.1.3" mathsize="80%" xref="algorithm1.36.36.m3.2.2.1.1.3.cmml">0.3</mn></msup><mo id="algorithm1.36.36.m3.2.2.1.3" maxsize="80%" minsize="80%" xref="algorithm1.36.36.m3.2.2.2.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.36.36.m3.2b"><apply id="algorithm1.36.36.m3.2.2.2.cmml" xref="algorithm1.36.36.m3.2.2.1"><floor id="algorithm1.36.36.m3.2.2.2.1.cmml" xref="algorithm1.36.36.m3.2.2.1.2"></floor><apply id="algorithm1.36.36.m3.2.2.1.1.cmml" xref="algorithm1.36.36.m3.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.36.36.m3.2.2.1.1.1.cmml" xref="algorithm1.36.36.m3.2.2.1.1">superscript</csymbol><apply id="algorithm1.36.36.m3.2.2.1.1.2.1.cmml" xref="algorithm1.36.36.m3.2.2.1.1.2.2"><abs id="algorithm1.36.36.m3.2.2.1.1.2.1.1.cmml" xref="algorithm1.36.36.m3.2.2.1.1.2.2.1"></abs><ci id="algorithm1.36.36.m3.1.1.cmml" xref="algorithm1.36.36.m3.1.1">𝑉</ci></apply><cn id="algorithm1.36.36.m3.2.2.1.1.3.cmml" type="float" xref="algorithm1.36.36.m3.2.2.1.1.3">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.36.36.m3.2c">\lfloor|V|^{0.3}\rfloor</annotation><annotation encoding="application/x-llamapun" id="algorithm1.36.36.m3.2d">⌊ | italic_V | start_POSTSUPERSCRIPT 0.3 end_POSTSUPERSCRIPT ⌋</annotation></semantics></math><span class="ltx_text" id="algorithm1.36.36.9" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="algorithm1.39.39">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.39.39.4.1.1" style="font-size:80%;">25</span></span><span class="ltx_text" id="algorithm1.39.39.5" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.39.39.6" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.39.39.7" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.39.39.8" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.39.39.9" style="font-size:80%;">
</span><span class="ltx_text" id="algorithm1.39.39.3" style="font-size:80%;color:#336699;"># Cluster items in <math alttext="V" class="ltx_Math" display="inline" id="algorithm1.37.37.1.m1.1"><semantics id="algorithm1.37.37.1.m1.1a"><mi id="algorithm1.37.37.1.m1.1.1" mathcolor="#336699" xref="algorithm1.37.37.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="algorithm1.37.37.1.m1.1b"><ci id="algorithm1.37.37.1.m1.1.1.cmml" xref="algorithm1.37.37.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.37.37.1.m1.1c">V</annotation><annotation encoding="application/x-llamapun" id="algorithm1.37.37.1.m1.1d">italic_V</annotation></semantics></math> into <math alttext="\delta" class="ltx_Math" display="inline" id="algorithm1.38.38.2.m2.1"><semantics id="algorithm1.38.38.2.m2.1a"><mi id="algorithm1.38.38.2.m2.1.1" mathcolor="#336699" xref="algorithm1.38.38.2.m2.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.38.38.2.m2.1b"><ci id="algorithm1.38.38.2.m2.1.1.cmml" xref="algorithm1.38.38.2.m2.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.38.38.2.m2.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="algorithm1.38.38.2.m2.1d">italic_δ</annotation></semantics></math> groups based on their corresponding embeddings in <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="algorithm1.39.39.3.m3.1"><semantics id="algorithm1.39.39.3.m3.1a"><msub id="algorithm1.39.39.3.m3.1.1" xref="algorithm1.39.39.3.m3.1.1.cmml"><mi id="algorithm1.39.39.3.m3.1.1.2" mathcolor="#336699" xref="algorithm1.39.39.3.m3.1.1.2.cmml">𝐊</mi><mi id="algorithm1.39.39.3.m3.1.1.3" mathcolor="#336699" xref="algorithm1.39.39.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.39.39.3.m3.1b"><apply id="algorithm1.39.39.3.m3.1.1.cmml" xref="algorithm1.39.39.3.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.39.39.3.m3.1.1.1.cmml" xref="algorithm1.39.39.3.m3.1.1">subscript</csymbol><ci id="algorithm1.39.39.3.m3.1.1.2.cmml" xref="algorithm1.39.39.3.m3.1.1.2">𝐊</ci><ci id="algorithm1.39.39.3.m3.1.1.3.cmml" xref="algorithm1.39.39.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.39.39.3.m3.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.39.39.3.m3.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="algorithm1.42.42">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.42.42.1.1.1" style="font-size:80%;">26</span></span><span class="ltx_text" id="algorithm1.42.42.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.42.42.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.42.42.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.42.42.5" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.42.42.6" style="font-size:80%;">
</span><math alttext="J_{1:\delta}" class="ltx_Math" display="inline" id="algorithm1.40.40.m1.1"><semantics id="algorithm1.40.40.m1.1a"><msub id="algorithm1.40.40.m1.1.1" xref="algorithm1.40.40.m1.1.1.cmml"><mi id="algorithm1.40.40.m1.1.1.2" mathsize="80%" xref="algorithm1.40.40.m1.1.1.2.cmml">J</mi><mrow id="algorithm1.40.40.m1.1.1.3" xref="algorithm1.40.40.m1.1.1.3.cmml"><mn id="algorithm1.40.40.m1.1.1.3.2" mathsize="80%" xref="algorithm1.40.40.m1.1.1.3.2.cmml">1</mn><mo id="algorithm1.40.40.m1.1.1.3.1" lspace="0.278em" mathsize="80%" rspace="0.278em" xref="algorithm1.40.40.m1.1.1.3.1.cmml">:</mo><mi id="algorithm1.40.40.m1.1.1.3.3" mathsize="80%" xref="algorithm1.40.40.m1.1.1.3.3.cmml">δ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.40.40.m1.1b"><apply id="algorithm1.40.40.m1.1.1.cmml" xref="algorithm1.40.40.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.40.40.m1.1.1.1.cmml" xref="algorithm1.40.40.m1.1.1">subscript</csymbol><ci id="algorithm1.40.40.m1.1.1.2.cmml" xref="algorithm1.40.40.m1.1.1.2">𝐽</ci><apply id="algorithm1.40.40.m1.1.1.3.cmml" xref="algorithm1.40.40.m1.1.1.3"><ci id="algorithm1.40.40.m1.1.1.3.1.cmml" xref="algorithm1.40.40.m1.1.1.3.1">:</ci><cn id="algorithm1.40.40.m1.1.1.3.2.cmml" type="integer" xref="algorithm1.40.40.m1.1.1.3.2">1</cn><ci id="algorithm1.40.40.m1.1.1.3.3.cmml" xref="algorithm1.40.40.m1.1.1.3.3">𝛿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.40.40.m1.1c">J_{1:\delta}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.40.40.m1.1d">italic_J start_POSTSUBSCRIPT 1 : italic_δ end_POSTSUBSCRIPT</annotation></semantics></math><math alttext="\leftarrow" class="ltx_Math" display="inline" id="algorithm1.41.41.m2.1"><semantics id="algorithm1.41.41.m2.1a"><mo id="algorithm1.41.41.m2.1.1" mathsize="80%" stretchy="false" xref="algorithm1.41.41.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm1.41.41.m2.1b"><ci id="algorithm1.41.41.m2.1.1.cmml" xref="algorithm1.41.41.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.41.41.m2.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm1.41.41.m2.1d">←</annotation></semantics></math><span class="ltx_text" id="algorithm1.42.42.7" style="font-size:80%;">Kmeans(</span><math alttext="\delta,V,\mathbf{K}_{s}" class="ltx_Math" display="inline" id="algorithm1.42.42.m3.3"><semantics id="algorithm1.42.42.m3.3a"><mrow id="algorithm1.42.42.m3.3.3.1" xref="algorithm1.42.42.m3.3.3.2.cmml"><mi id="algorithm1.42.42.m3.1.1" mathsize="80%" xref="algorithm1.42.42.m3.1.1.cmml">δ</mi><mo id="algorithm1.42.42.m3.3.3.1.2" mathsize="80%" xref="algorithm1.42.42.m3.3.3.2.cmml">,</mo><mi id="algorithm1.42.42.m3.2.2" mathsize="80%" xref="algorithm1.42.42.m3.2.2.cmml">V</mi><mo id="algorithm1.42.42.m3.3.3.1.3" mathsize="80%" xref="algorithm1.42.42.m3.3.3.2.cmml">,</mo><msub id="algorithm1.42.42.m3.3.3.1.1" xref="algorithm1.42.42.m3.3.3.1.1.cmml"><mi id="algorithm1.42.42.m3.3.3.1.1.2" mathsize="80%" xref="algorithm1.42.42.m3.3.3.1.1.2.cmml">𝐊</mi><mi id="algorithm1.42.42.m3.3.3.1.1.3" mathsize="80%" xref="algorithm1.42.42.m3.3.3.1.1.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.42.42.m3.3b"><list id="algorithm1.42.42.m3.3.3.2.cmml" xref="algorithm1.42.42.m3.3.3.1"><ci id="algorithm1.42.42.m3.1.1.cmml" xref="algorithm1.42.42.m3.1.1">𝛿</ci><ci id="algorithm1.42.42.m3.2.2.cmml" xref="algorithm1.42.42.m3.2.2">𝑉</ci><apply id="algorithm1.42.42.m3.3.3.1.1.cmml" xref="algorithm1.42.42.m3.3.3.1.1"><csymbol cd="ambiguous" id="algorithm1.42.42.m3.3.3.1.1.1.cmml" xref="algorithm1.42.42.m3.3.3.1.1">subscript</csymbol><ci id="algorithm1.42.42.m3.3.3.1.1.2.cmml" xref="algorithm1.42.42.m3.3.3.1.1.2">𝐊</ci><ci id="algorithm1.42.42.m3.3.3.1.1.3.cmml" xref="algorithm1.42.42.m3.3.3.1.1.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.42.42.m3.3c">\delta,V,\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.42.42.m3.3d">italic_δ , italic_V , bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm1.42.42.8" style="font-size:80%;">);</span>
</div>
<div class="ltx_listingline" id="algorithm1.44.44">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.44.44.3.1.1" style="font-size:80%;">27</span></span><span class="ltx_text" id="algorithm1.44.44.4" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.44.44.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.44.44.6" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.44.44.7" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.44.44.8" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="algorithm1.44.44.9" style="font-size:80%;">for</span><span class="ltx_text" id="algorithm1.44.44.10" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm1.44.44.2" style="font-size:80%;"><math alttext="i=1" class="ltx_Math" display="inline" id="algorithm1.43.43.1.m1.1"><semantics id="algorithm1.43.43.1.m1.1a"><mrow id="algorithm1.43.43.1.m1.1.1" xref="algorithm1.43.43.1.m1.1.1.cmml"><mi id="algorithm1.43.43.1.m1.1.1.2" xref="algorithm1.43.43.1.m1.1.1.2.cmml">i</mi><mo id="algorithm1.43.43.1.m1.1.1.1" xref="algorithm1.43.43.1.m1.1.1.1.cmml">=</mo><mn id="algorithm1.43.43.1.m1.1.1.3" xref="algorithm1.43.43.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.43.43.1.m1.1b"><apply id="algorithm1.43.43.1.m1.1.1.cmml" xref="algorithm1.43.43.1.m1.1.1"><eq id="algorithm1.43.43.1.m1.1.1.1.cmml" xref="algorithm1.43.43.1.m1.1.1.1"></eq><ci id="algorithm1.43.43.1.m1.1.1.2.cmml" xref="algorithm1.43.43.1.m1.1.1.2">𝑖</ci><cn id="algorithm1.43.43.1.m1.1.1.3.cmml" type="integer" xref="algorithm1.43.43.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.43.43.1.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="algorithm1.43.43.1.m1.1d">italic_i = 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="algorithm1.44.44.2.1">to</span> <math alttext="\delta" class="ltx_Math" display="inline" id="algorithm1.44.44.2.m2.1"><semantics id="algorithm1.44.44.2.m2.1a"><mi id="algorithm1.44.44.2.m2.1.1" xref="algorithm1.44.44.2.m2.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.44.44.2.m2.1b"><ci id="algorithm1.44.44.2.m2.1.1.cmml" xref="algorithm1.44.44.2.m2.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.44.44.2.m2.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="algorithm1.44.44.2.m2.1d">italic_δ</annotation></semantics></math> </em><span class="ltx_text" id="algorithm1.44.44.11" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm1.44.44.12" style="font-size:80%;">do</span><span class="ltx_text" id="algorithm1.44.44.13" style="font-size:80%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm1.46.46">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.46.46.1.1.1" style="font-size:80%;">28</span></span><span class="ltx_text" id="algorithm1.46.46.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.46.46.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.46.46.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.46.46.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.46.46.6" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.46.46.7" style="font-size:80%;">
</span><math alttext="Q" class="ltx_Math" display="inline" id="algorithm1.45.45.m1.1"><semantics id="algorithm1.45.45.m1.1a"><mi id="algorithm1.45.45.m1.1.1" mathsize="80%" xref="algorithm1.45.45.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algorithm1.45.45.m1.1b"><ci id="algorithm1.45.45.m1.1.1.cmml" xref="algorithm1.45.45.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.45.45.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="algorithm1.45.45.m1.1d">italic_Q</annotation></semantics></math><span class="ltx_text" id="algorithm1.46.46.8" style="font-size:80%;">.enqueue(</span><math alttext="J_{i}" class="ltx_Math" display="inline" id="algorithm1.46.46.m2.1"><semantics id="algorithm1.46.46.m2.1a"><msub id="algorithm1.46.46.m2.1.1" xref="algorithm1.46.46.m2.1.1.cmml"><mi id="algorithm1.46.46.m2.1.1.2" mathsize="80%" xref="algorithm1.46.46.m2.1.1.2.cmml">J</mi><mi id="algorithm1.46.46.m2.1.1.3" mathsize="80%" xref="algorithm1.46.46.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.46.46.m2.1b"><apply id="algorithm1.46.46.m2.1.1.cmml" xref="algorithm1.46.46.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.46.46.m2.1.1.1.cmml" xref="algorithm1.46.46.m2.1.1">subscript</csymbol><ci id="algorithm1.46.46.m2.1.1.2.cmml" xref="algorithm1.46.46.m2.1.1.2">𝐽</ci><ci id="algorithm1.46.46.m2.1.1.3.cmml" xref="algorithm1.46.46.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.46.46.m2.1c">J_{i}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.46.46.m2.1d">italic_J start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm1.46.46.9" style="font-size:80%;">);</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.57">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.57.1.1.1" style="font-size:80%;">29</span></span><span class="ltx_text" id="algorithm1.47.57.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.57.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.57.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.57.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.57.6" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.47.57.7" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.58">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.58.1.1.1" style="font-size:80%;">30</span></span><span class="ltx_text" id="algorithm1.47.58.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.58.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.58.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.58.5" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.47.58.6" style="font-size:80%;"> end for</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.59">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.59.1.1.1" style="font-size:80%;">31</span></span><span class="ltx_text" id="algorithm1.47.59.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.59.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.59.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.59.5" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="algorithm1.47.60">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.60.1.1.1" style="font-size:80%;">32</span></span><span class="ltx_text" id="algorithm1.47.60.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.60.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.60.4" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.47.60.5" style="font-size:80%;"> end if</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.61">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.61.1.1.1" style="font-size:80%;">33</span></span><span class="ltx_text" id="algorithm1.47.61.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.61.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.61.4" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="algorithm1.47.62">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.62.1.1.1" style="font-size:80%;">34</span></span><span class="ltx_text" id="algorithm1.47.62.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.62.3" style="font-size:80%;">   </span><span class="ltx_text" id="algorithm1.47.62.4" style="font-size:80%;"> end while</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.63">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.63.1.1.1" style="font-size:80%;">35</span></span><span class="ltx_text" id="algorithm1.47.63.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.47.63.3" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="algorithm1.47.64">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algorithm1.47.64.1.1.1" style="font-size:80%;">36</span></span><span class="ltx_text" id="algorithm1.47.64.2" style="font-size:80%;"> end for</span>
</div>
<div class="ltx_listingline" id="algorithm1.47.47">
<span class="ltx_text ltx_font_bold" id="algorithm1.47.47.2" style="font-size:80%;">return</span><span class="ltx_text" id="algorithm1.47.47.3" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm1.47.47.1" style="font-size:80%;"><math alttext="C" class="ltx_Math" display="inline" id="algorithm1.47.47.1.m1.1"><semantics id="algorithm1.47.47.1.m1.1a"><mi id="algorithm1.47.47.1.m1.1.1" xref="algorithm1.47.47.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.47.47.1.m1.1b"><ci id="algorithm1.47.47.1.m1.1.1.cmml" xref="algorithm1.47.47.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.47.47.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="algorithm1.47.47.1.m1.1d">italic_C</annotation></semantics></math></em><span class="ltx_text" id="algorithm1.47.47.4" style="font-size:80%;"> </span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:80%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.51.1.1">Algorithm 1</span> </span>Hierarchical Clustering Over Life Cycle</figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.8">For a user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mi id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">italic_u</annotation></semantics></math>, we represent all her historical behaviors as a sequence of items <math alttext="S=[s_{1},s_{2},\cdots,s_{T}]" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.4"><semantics id="S3.SS3.SSS1.p1.2.m2.4a"><mrow id="S3.SS3.SSS1.p1.2.m2.4.4" xref="S3.SS3.SSS1.p1.2.m2.4.4.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.4.4.5" xref="S3.SS3.SSS1.p1.2.m2.4.4.5.cmml">S</mi><mo id="S3.SS3.SSS1.p1.2.m2.4.4.4" xref="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.2.m2.4.4.3.3" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.4.cmml"><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.4.cmml">[</mo><msub id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.5" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.2.cmml">s</mi><mn id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.6" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">⋯</mi><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.7" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.2" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.2.cmml">s</mi><mi id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.3.cmml">T</mi></msub><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.4b"><apply id="S3.SS3.SSS1.p1.2.m2.4.4.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4"><eq id="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.4"></eq><ci id="S3.SS3.SSS1.p1.2.m2.4.4.5.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.5">𝑆</ci><list id="S3.SS3.SSS1.p1.2.m2.4.4.3.4.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3"><apply id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.2">𝑠</ci><cn id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.2">𝑠</ci><cn id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">⋯</ci><apply id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.2">𝑠</ci><ci id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.4c">S=[s_{1},s_{2},\cdots,s_{T}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.4d">italic_S = [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m3.1"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><mi id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><ci id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.1d">italic_T</annotation></semantics></math> is the number of life-cycle behaviors and <math alttext="s_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.4.m4.1"><semantics id="S3.SS3.SSS1.p1.4.m4.1a"><msub id="S3.SS3.SSS1.p1.4.m4.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.1.1.2" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.cmml">s</mi><mi id="S3.SS3.SSS1.p1.4.m4.1.1.3" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.1b"><apply id="S3.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2">𝑠</ci><ci id="S3.SS3.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.5.m5.1"><semantics id="S3.SS3.SSS1.p1.5.m5.1a"><mi id="S3.SS3.SSS1.p1.5.m5.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m5.1b"><ci id="S3.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.5.m5.1d">italic_j</annotation></semantics></math>-th interacted item.
Users may watch many similar videos in <math alttext="S" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.6.m6.1"><semantics id="S3.SS3.SSS1.p1.6.m6.1a"><mi id="S3.SS3.SSS1.p1.6.m6.1.1" xref="S3.SS3.SSS1.p1.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.6.m6.1b"><ci id="S3.SS3.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.6.m6.1d">italic_S</annotation></semantics></math>.
For instance, a user fond of NBA games may have hundreds of basketball-related videos in his history.
Therefore, a natural idea is to aggregate similar items in <math alttext="S" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.7.m7.1"><semantics id="S3.SS3.SSS1.p1.7.m7.1a"><mi id="S3.SS3.SSS1.p1.7.m7.1.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.7.m7.1b"><ci id="S3.SS3.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.7.m7.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.7.m7.1d">italic_S</annotation></semantics></math> into clusters, using a single cluster to represent many similar items, thereby reducing the size of <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.8.m8.1"><semantics id="S3.SS3.SSS1.p1.8.m8.1a"><mi id="S3.SS3.SSS1.p1.8.m8.1.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.8.m8.1b"><ci id="S3.SS3.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.8.m8.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.8.m8.1d">italic_T</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.5">Formally, we aim to use a compression function <math alttext="h_{\text{comp}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.1.m1.1"><semantics id="S3.SS3.SSS1.p2.1.m1.1a"><msub id="S3.SS3.SSS1.p2.1.m1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS1.p2.1.m1.1.1.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3a.cmml">comp</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.1.m1.1b"><apply id="S3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.2">ℎ</ci><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3a.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3"><mtext id="S3.SS3.SSS1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p2.1.m1.1.1.3">comp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.1.m1.1c">h_{\text{comp}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.1.m1.1d">italic_h start_POSTSUBSCRIPT comp end_POSTSUBSCRIPT</annotation></semantics></math> to reduce a behavior sequence <math alttext="S" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.2.m2.1"><semantics id="S3.SS3.SSS1.p2.2.m2.1a"><mi id="S3.SS3.SSS1.p2.2.m2.1.1" xref="S3.SS3.SSS1.p2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.2.m2.1b"><ci id="S3.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.2.m2.1d">italic_S</annotation></semantics></math> of length <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.3.m3.1"><semantics id="S3.SS3.SSS1.p2.3.m3.1a"><mi id="S3.SS3.SSS1.p2.3.m3.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.3.m3.1b"><ci id="S3.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.3.m3.1d">italic_T</annotation></semantics></math> to a sequence <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.4.m4.1"><semantics id="S3.SS3.SSS1.p2.4.m4.1a"><mi id="S3.SS3.SSS1.p2.4.m4.1.1" xref="S3.SS3.SSS1.p2.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.4.m4.1b"><ci id="S3.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.4.m4.1d">italic_C</annotation></semantics></math> of length <math alttext="\hat{T}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.5.m5.1"><semantics id="S3.SS3.SSS1.p2.5.m5.1a"><mover accent="true" id="S3.SS3.SSS1.p2.5.m5.1.1" xref="S3.SS3.SSS1.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSS1.p2.5.m5.1.1.2" xref="S3.SS3.SSS1.p2.5.m5.1.1.2.cmml">T</mi><mo id="S3.SS3.SSS1.p2.5.m5.1.1.1" xref="S3.SS3.SSS1.p2.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.5.m5.1b"><apply id="S3.SS3.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p2.5.m5.1.1"><ci id="S3.SS3.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p2.5.m5.1.1.1">^</ci><ci id="S3.SS3.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p2.5.m5.1.1.2">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.5.m5.1c">\hat{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.5.m5.1d">over^ start_ARG italic_T end_ARG</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="C=h_{\text{comp}}(S)," class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml">C</mi><mo id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><msub id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml"><mi id="S3.E3.m1.2.2.1.1.3.2.2" xref="S3.E3.m1.2.2.1.1.3.2.2.cmml">h</mi><mtext id="S3.E3.m1.2.2.1.1.3.2.3" xref="S3.E3.m1.2.2.1.1.3.2.3a.cmml">comp</mtext></msub><mo id="S3.E3.m1.2.2.1.1.3.1" xref="S3.E3.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.2" xref="S3.E3.m1.2.2.1.1.3.cmml"><mo id="S3.E3.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">S</mi><mo id="S3.E3.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"></eq><ci id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2">𝐶</ci><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><times id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.1"></times><apply id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2.2">ℎ</ci><ci id="S3.E3.m1.2.2.1.1.3.2.3a.cmml" xref="S3.E3.m1.2.2.1.1.3.2.3"><mtext id="S3.E3.m1.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E3.m1.2.2.1.1.3.2.3">comp</mtext></ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">C=h_{\text{comp}}(S),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">italic_C = italic_h start_POSTSUBSCRIPT comp end_POSTSUBSCRIPT ( italic_S ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p2.10">where <math alttext="\hat{T}\ll T" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.6.m1.1"><semantics id="S3.SS3.SSS1.p2.6.m1.1a"><mrow id="S3.SS3.SSS1.p2.6.m1.1.1" xref="S3.SS3.SSS1.p2.6.m1.1.1.cmml"><mover accent="true" id="S3.SS3.SSS1.p2.6.m1.1.1.2" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.cmml"><mi id="S3.SS3.SSS1.p2.6.m1.1.1.2.2" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.2.cmml">T</mi><mo id="S3.SS3.SSS1.p2.6.m1.1.1.2.1" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS3.SSS1.p2.6.m1.1.1.1" xref="S3.SS3.SSS1.p2.6.m1.1.1.1.cmml">≪</mo><mi id="S3.SS3.SSS1.p2.6.m1.1.1.3" xref="S3.SS3.SSS1.p2.6.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.6.m1.1b"><apply id="S3.SS3.SSS1.p2.6.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.p2.6.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.1">much-less-than</csymbol><apply id="S3.SS3.SSS1.p2.6.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.2"><ci id="S3.SS3.SSS1.p2.6.m1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.1">^</ci><ci id="S3.SS3.SSS1.p2.6.m1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.2">𝑇</ci></apply><ci id="S3.SS3.SSS1.p2.6.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.6.m1.1c">\hat{T}\ll T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.6.m1.1d">over^ start_ARG italic_T end_ARG ≪ italic_T</annotation></semantics></math>. Let <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.7.m2.1"><semantics id="S3.SS3.SSS1.p2.7.m2.1a"><mi id="S3.SS3.SSS1.p2.7.m2.1.1" xref="S3.SS3.SSS1.p2.7.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.7.m2.1b"><ci id="S3.SS3.SSS1.p2.7.m2.1.1.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.7.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.7.m2.1d">italic_C</annotation></semantics></math> denote the clustered behaviors <math alttext="C=[c_{1},c_{2},\cdots,c_{\hat{T}}]" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.8.m3.4"><semantics id="S3.SS3.SSS1.p2.8.m3.4a"><mrow id="S3.SS3.SSS1.p2.8.m3.4.4" xref="S3.SS3.SSS1.p2.8.m3.4.4.cmml"><mi id="S3.SS3.SSS1.p2.8.m3.4.4.5" xref="S3.SS3.SSS1.p2.8.m3.4.4.5.cmml">C</mi><mo id="S3.SS3.SSS1.p2.8.m3.4.4.4" xref="S3.SS3.SSS1.p2.8.m3.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p2.8.m3.4.4.3.3" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.4.cmml"><mo id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.4" stretchy="false" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.4.cmml">[</mo><msub id="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1" xref="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.2" xref="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.2.cmml">c</mi><mn id="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.3" xref="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.5" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2" xref="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.2" xref="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.2.cmml">c</mi><mn id="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.3" xref="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.6" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.4.cmml">,</mo><mi id="S3.SS3.SSS1.p2.8.m3.1.1" mathvariant="normal" xref="S3.SS3.SSS1.p2.8.m3.1.1.cmml">⋯</mi><mo id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.7" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.2" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.2.cmml">c</mi><mover accent="true" id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.2" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.2.cmml">T</mi><mo id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.1" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.1.cmml">^</mo></mover></msub><mo id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.8" stretchy="false" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.8.m3.4b"><apply id="S3.SS3.SSS1.p2.8.m3.4.4.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4"><eq id="S3.SS3.SSS1.p2.8.m3.4.4.4.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.4"></eq><ci id="S3.SS3.SSS1.p2.8.m3.4.4.5.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.5">𝐶</ci><list id="S3.SS3.SSS1.p2.8.m3.4.4.3.4.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3"><apply id="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.2">𝑐</ci><cn id="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p2.8.m3.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.2">𝑐</ci><cn id="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS1.p2.8.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.SSS1.p2.8.m3.1.1.cmml" xref="S3.SS3.SSS1.p2.8.m3.1.1">⋯</ci><apply id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.2">𝑐</ci><apply id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3"><ci id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.1">^</ci><ci id="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p2.8.m3.4.4.3.3.3.3.2">𝑇</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.8.m3.4c">C=[c_{1},c_{2},\cdots,c_{\hat{T}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.8.m3.4d">italic_C = [ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_c start_POSTSUBSCRIPT over^ start_ARG italic_T end_ARG end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.9.m4.1"><semantics id="S3.SS3.SSS1.p2.9.m4.1a"><msub id="S3.SS3.SSS1.p2.9.m4.1.1" xref="S3.SS3.SSS1.p2.9.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p2.9.m4.1.1.2" xref="S3.SS3.SSS1.p2.9.m4.1.1.2.cmml">c</mi><mi id="S3.SS3.SSS1.p2.9.m4.1.1.3" xref="S3.SS3.SSS1.p2.9.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.9.m4.1b"><apply id="S3.SS3.SSS1.p2.9.m4.1.1.cmml" xref="S3.SS3.SSS1.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.9.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p2.9.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.9.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p2.9.m4.1.1.2">𝑐</ci><ci id="S3.SS3.SSS1.p2.9.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p2.9.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.9.m4.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.9.m4.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.10.m5.1"><semantics id="S3.SS3.SSS1.p2.10.m5.1a"><mi id="S3.SS3.SSS1.p2.10.m5.1.1" xref="S3.SS3.SSS1.p2.10.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.10.m5.1b"><ci id="S3.SS3.SSS1.p2.10.m5.1.1.cmml" xref="S3.SS3.SSS1.p2.10.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.10.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.10.m5.1d">italic_i</annotation></semantics></math>-th set containing clustered items.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p3">
<p class="ltx_p" id="S3.SS3.SSS1.p3.11">Specifically, we employ a hierarchical clustering approach to implement <math alttext="h_{\text{comp}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.1.m1.1"><semantics id="S3.SS3.SSS1.p3.1.m1.1a"><msub id="S3.SS3.SSS1.p3.1.m1.1.1" xref="S3.SS3.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p3.1.m1.1.1.2" xref="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS1.p3.1.m1.1.1.3" xref="S3.SS3.SSS1.p3.1.m1.1.1.3a.cmml">comp</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.1.m1.1b"><apply id="S3.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.2">ℎ</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.3a.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.3"><mtext id="S3.SS3.SSS1.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p3.1.m1.1.1.3">comp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.1.m1.1c">h_{\text{comp}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.1.m1.1d">italic_h start_POSTSUBSCRIPT comp end_POSTSUBSCRIPT</annotation></semantics></math>, as illustrated in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#algorithm1" title="In 3.3.1. Hierarchical Clustering Over Life Cycle ‣ 3.3. Life-Cycle User Modeling ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">1</span></a>.
In the first step, we simply split the historical behaviors into groups.
We first categorize historical items into <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.2.m2.1"><semantics id="S3.SS3.SSS1.p3.2.m2.1a"><mi id="S3.SS3.SSS1.p3.2.m2.1.1" xref="S3.SS3.SSS1.p3.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.2.m2.1b"><ci id="S3.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.2.m2.1d">italic_M</annotation></semantics></math> different groups based on the proportion of time they were played by the user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.3.m3.1"><semantics id="S3.SS3.SSS1.p3.3.m3.1a"><mi id="S3.SS3.SSS1.p3.3.m3.1.1" xref="S3.SS3.SSS1.p3.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.3.m3.1b"><ci id="S3.SS3.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.3.m3.1d">italic_u</annotation></semantics></math>, which is denoted as <math alttext="p_{j}=\frac{\text{playing time}}{\text{video duration}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.4.m4.1"><semantics id="S3.SS3.SSS1.p3.4.m4.1a"><mrow id="S3.SS3.SSS1.p3.4.m4.1.1" xref="S3.SS3.SSS1.p3.4.m4.1.1.cmml"><msub id="S3.SS3.SSS1.p3.4.m4.1.1.2" xref="S3.SS3.SSS1.p3.4.m4.1.1.2.cmml"><mi id="S3.SS3.SSS1.p3.4.m4.1.1.2.2" xref="S3.SS3.SSS1.p3.4.m4.1.1.2.2.cmml">p</mi><mi id="S3.SS3.SSS1.p3.4.m4.1.1.2.3" xref="S3.SS3.SSS1.p3.4.m4.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS3.SSS1.p3.4.m4.1.1.1" xref="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml">=</mo><mfrac id="S3.SS3.SSS1.p3.4.m4.1.1.3" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.cmml"><mtext id="S3.SS3.SSS1.p3.4.m4.1.1.3.2" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.2a.cmml">playing time</mtext><mtext id="S3.SS3.SSS1.p3.4.m4.1.1.3.3" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.3a.cmml">video duration</mtext></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.4.m4.1b"><apply id="S3.SS3.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1"><eq id="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.1"></eq><apply id="S3.SS3.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.2.2">𝑝</ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.2.3">𝑗</ci></apply><apply id="S3.SS3.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.3"><divide id="S3.SS3.SSS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.3"></divide><ci id="S3.SS3.SSS1.p3.4.m4.1.1.3.2a.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.2"><mtext id="S3.SS3.SSS1.p3.4.m4.1.1.3.2.cmml" mathsize="70%" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.2">playing time</mtext></ci><ci id="S3.SS3.SSS1.p3.4.m4.1.1.3.3a.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.3"><mtext id="S3.SS3.SSS1.p3.4.m4.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p3.4.m4.1.1.3.3">video duration</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.4.m4.1c">p_{j}=\frac{\text{playing time}}{\text{video duration}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = divide start_ARG playing time end_ARG start_ARG video duration end_ARG</annotation></semantics></math> for the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.5.m5.1"><semantics id="S3.SS3.SSS1.p3.5.m5.1a"><mi id="S3.SS3.SSS1.p3.5.m5.1.1" xref="S3.SS3.SSS1.p3.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.5.m5.1b"><ci id="S3.SS3.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.5.m5.1d">italic_j</annotation></semantics></math>-th behavior item <math alttext="s_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.6.m6.1"><semantics id="S3.SS3.SSS1.p3.6.m6.1a"><msub id="S3.SS3.SSS1.p3.6.m6.1.1" xref="S3.SS3.SSS1.p3.6.m6.1.1.cmml"><mi id="S3.SS3.SSS1.p3.6.m6.1.1.2" xref="S3.SS3.SSS1.p3.6.m6.1.1.2.cmml">s</mi><mi id="S3.SS3.SSS1.p3.6.m6.1.1.3" xref="S3.SS3.SSS1.p3.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.6.m6.1b"><apply id="S3.SS3.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p3.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.2">𝑠</ci><ci id="S3.SS3.SSS1.p3.6.m6.1.1.3.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.6.m6.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.6.m6.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
In the second step, we recursively cluster the life-cycle historical behaviors of each group until the number of items in each cluster does not exceed <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.7.m7.1"><semantics id="S3.SS3.SSS1.p3.7.m7.1a"><mi id="S3.SS3.SSS1.p3.7.m7.1.1" xref="S3.SS3.SSS1.p3.7.m7.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.7.m7.1b"><ci id="S3.SS3.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.7.m7.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.7.m7.1d">italic_γ</annotation></semantics></math>.
We employ the widely used k-means method with adaptive cluster size <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.8.m8.1"><semantics id="S3.SS3.SSS1.p3.8.m8.1a"><mi id="S3.SS3.SSS1.p3.8.m8.1.1" xref="S3.SS3.SSS1.p3.8.m8.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.8.m8.1b"><ci id="S3.SS3.SSS1.p3.8.m8.1.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.8.m8.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.8.m8.1d">italic_γ</annotation></semantics></math> to cluster the embeddings <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.9.m9.1"><semantics id="S3.SS3.SSS1.p3.9.m9.1a"><msub id="S3.SS3.SSS1.p3.9.m9.1.1" xref="S3.SS3.SSS1.p3.9.m9.1.1.cmml"><mi id="S3.SS3.SSS1.p3.9.m9.1.1.2" xref="S3.SS3.SSS1.p3.9.m9.1.1.2.cmml">𝐊</mi><mi id="S3.SS3.SSS1.p3.9.m9.1.1.3" xref="S3.SS3.SSS1.p3.9.m9.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.9.m9.1b"><apply id="S3.SS3.SSS1.p3.9.m9.1.1.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.9.m9.1.1.1.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p3.9.m9.1.1.2.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1.2">𝐊</ci><ci id="S3.SS3.SSS1.p3.9.m9.1.1.3.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.9.m9.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.9.m9.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> of behaviors <math alttext="S" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.10.m10.1"><semantics id="S3.SS3.SSS1.p3.10.m10.1a"><mi id="S3.SS3.SSS1.p3.10.m10.1.1" xref="S3.SS3.SSS1.p3.10.m10.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.10.m10.1b"><ci id="S3.SS3.SSS1.p3.10.m10.1.1.cmml" xref="S3.SS3.SSS1.p3.10.m10.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.10.m10.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.10.m10.1d">italic_S</annotation></semantics></math> obtained from the recommendation model. <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.11.m11.1"><semantics id="S3.SS3.SSS1.p3.11.m11.1a"><mi id="S3.SS3.SSS1.p3.11.m11.1.1" xref="S3.SS3.SSS1.p3.11.m11.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.11.m11.1b"><ci id="S3.SS3.SSS1.p3.11.m11.1.1.cmml" xref="S3.SS3.SSS1.p3.11.m11.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.11.m11.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.11.m11.1d">italic_γ</annotation></semantics></math> is a hyper-parameter to control the maximum cluster size.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p4">
<p class="ltx_p" id="S3.SS3.SSS1.p4.1">Next, we will elaborate on the rationales behind Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#algorithm1" title="In 3.3.1. Hierarchical Clustering Over Life Cycle ‣ 3.3. Life-Cycle User Modeling ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">1</span></a>:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS1.p5">
<p class="ltx_p" id="S3.SS3.SSS1.p5.3"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p5.1.m1.1"><semantics id="S3.SS3.SSS1.p5.1.m1.1a"><mo id="S3.SS3.SSS1.p5.1.m1.1.1" xref="S3.SS3.SSS1.p5.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.1.m1.1b"><ci id="S3.SS3.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p5.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p5.1.m1.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS1.p5.3.1">Item Grouping:</span>
In short video scenarios, the playing completion ratio of a video can be seen as an indicator of the user’s level of interest in the video.
We initially group behaviors by playing completion ratio to ensure the final clustering results have a relatively consistent playing time ratio.
If this is not done, it would result in an imbalanced distribution within each cluster because k-means only considers item embeddings.
The function <math alttext="\text{getGroup}(p_{j})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p5.2.m2.1"><semantics id="S3.SS3.SSS1.p5.2.m2.1a"><mrow id="S3.SS3.SSS1.p5.2.m2.1.1" xref="S3.SS3.SSS1.p5.2.m2.1.1.cmml"><mtext id="S3.SS3.SSS1.p5.2.m2.1.1.3" xref="S3.SS3.SSS1.p5.2.m2.1.1.3a.cmml">getGroup</mtext><mo id="S3.SS3.SSS1.p5.2.m2.1.1.2" xref="S3.SS3.SSS1.p5.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p5.2.m2.1.1.1.1" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.2" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.3" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.2.m2.1b"><apply id="S3.SS3.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1"><times id="S3.SS3.SSS1.p5.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.2"></times><ci id="S3.SS3.SSS1.p5.2.m2.1.1.3a.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.3"><mtext id="S3.SS3.SSS1.p5.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.3">getGroup</mtext></ci><apply id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p5.2.m2.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.2.m2.1c">\text{getGroup}(p_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p5.2.m2.1d">getGroup ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> is specific to the application scenarios, for example, dividing the proportional range into five equal parts.
<math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p5.3.m3.1"><semantics id="S3.SS3.SSS1.p5.3.m3.1a"><mi id="S3.SS3.SSS1.p5.3.m3.1.1" xref="S3.SS3.SSS1.p5.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.3.m3.1b"><ci id="S3.SS3.SSS1.p5.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p5.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p5.3.m3.1d">italic_M</annotation></semantics></math> is a constant, set to 5 in our practices.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS1.p6">
<p class="ltx_p" id="S3.SS3.SSS1.p6.9"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.1.m1.1"><semantics id="S3.SS3.SSS1.p6.1.m1.1a"><mo id="S3.SS3.SSS1.p6.1.m1.1.1" xref="S3.SS3.SSS1.p6.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.1.m1.1b"><ci id="S3.SS3.SSS1.p6.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p6.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.1.m1.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS1.p6.9.1">Recursively Adaptive Clustering</span>: We opt for hierarchical clustering instead of single-step clustering because user history is personalized, making it impractical to set a universal number of clustering iterations.
We also dynamically set the number of clusters (<math alttext="\delta" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.2.m2.1"><semantics id="S3.SS3.SSS1.p6.2.m2.1a"><mi id="S3.SS3.SSS1.p6.2.m2.1.1" xref="S3.SS3.SSS1.p6.2.m2.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.2.m2.1b"><ci id="S3.SS3.SSS1.p6.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p6.2.m2.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.2.m2.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.2.m2.1d">italic_δ</annotation></semantics></math> equals the <math alttext="0.3" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.3.m3.1"><semantics id="S3.SS3.SSS1.p6.3.m3.1a"><mn id="S3.SS3.SSS1.p6.3.m3.1.1" xref="S3.SS3.SSS1.p6.3.m3.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.3.m3.1b"><cn id="S3.SS3.SSS1.p6.3.m3.1.1.cmml" type="float" xref="S3.SS3.SSS1.p6.3.m3.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.3.m3.1c">0.3</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.3.m3.1d">0.3</annotation></semantics></math> power of the number of items), allowing clustering to adapt to varying scales of behaviors.
The clustering process stops when the item size falls below <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.4.m4.1"><semantics id="S3.SS3.SSS1.p6.4.m4.1a"><mi id="S3.SS3.SSS1.p6.4.m4.1.1" xref="S3.SS3.SSS1.p6.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.4.m4.1b"><ci id="S3.SS3.SSS1.p6.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p6.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.4.m4.1d">italic_γ</annotation></semantics></math>, where <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.5.m5.1"><semantics id="S3.SS3.SSS1.p6.5.m5.1a"><mi id="S3.SS3.SSS1.p6.5.m5.1.1" xref="S3.SS3.SSS1.p6.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.5.m5.1b"><ci id="S3.SS3.SSS1.p6.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p6.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.5.m5.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.5.m5.1d">italic_γ</annotation></semantics></math> is set to 20.
In our practice, the average cluster size is approximately <math alttext="\frac{\gamma}{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.6.m6.1"><semantics id="S3.SS3.SSS1.p6.6.m6.1a"><mfrac id="S3.SS3.SSS1.p6.6.m6.1.1" xref="S3.SS3.SSS1.p6.6.m6.1.1.cmml"><mi id="S3.SS3.SSS1.p6.6.m6.1.1.2" xref="S3.SS3.SSS1.p6.6.m6.1.1.2.cmml">γ</mi><mn id="S3.SS3.SSS1.p6.6.m6.1.1.3" xref="S3.SS3.SSS1.p6.6.m6.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.6.m6.1b"><apply id="S3.SS3.SSS1.p6.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p6.6.m6.1.1"><divide id="S3.SS3.SSS1.p6.6.m6.1.1.1.cmml" xref="S3.SS3.SSS1.p6.6.m6.1.1"></divide><ci id="S3.SS3.SSS1.p6.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.p6.6.m6.1.1.2">𝛾</ci><cn id="S3.SS3.SSS1.p6.6.m6.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p6.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.6.m6.1c">\frac{\gamma}{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.6.m6.1d">divide start_ARG italic_γ end_ARG start_ARG 2 end_ARG</annotation></semantics></math>, hence <math alttext="\hat{T}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.7.m7.1"><semantics id="S3.SS3.SSS1.p6.7.m7.1a"><mover accent="true" id="S3.SS3.SSS1.p6.7.m7.1.1" xref="S3.SS3.SSS1.p6.7.m7.1.1.cmml"><mi id="S3.SS3.SSS1.p6.7.m7.1.1.2" xref="S3.SS3.SSS1.p6.7.m7.1.1.2.cmml">T</mi><mo id="S3.SS3.SSS1.p6.7.m7.1.1.1" xref="S3.SS3.SSS1.p6.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.7.m7.1b"><apply id="S3.SS3.SSS1.p6.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p6.7.m7.1.1"><ci id="S3.SS3.SSS1.p6.7.m7.1.1.1.cmml" xref="S3.SS3.SSS1.p6.7.m7.1.1.1">^</ci><ci id="S3.SS3.SSS1.p6.7.m7.1.1.2.cmml" xref="S3.SS3.SSS1.p6.7.m7.1.1.2">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.7.m7.1c">\hat{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.7.m7.1d">over^ start_ARG italic_T end_ARG</annotation></semantics></math> is about <math alttext="\frac{T}{10}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.8.m8.1"><semantics id="S3.SS3.SSS1.p6.8.m8.1a"><mfrac id="S3.SS3.SSS1.p6.8.m8.1.1" xref="S3.SS3.SSS1.p6.8.m8.1.1.cmml"><mi id="S3.SS3.SSS1.p6.8.m8.1.1.2" xref="S3.SS3.SSS1.p6.8.m8.1.1.2.cmml">T</mi><mn id="S3.SS3.SSS1.p6.8.m8.1.1.3" xref="S3.SS3.SSS1.p6.8.m8.1.1.3.cmml">10</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.8.m8.1b"><apply id="S3.SS3.SSS1.p6.8.m8.1.1.cmml" xref="S3.SS3.SSS1.p6.8.m8.1.1"><divide id="S3.SS3.SSS1.p6.8.m8.1.1.1.cmml" xref="S3.SS3.SSS1.p6.8.m8.1.1"></divide><ci id="S3.SS3.SSS1.p6.8.m8.1.1.2.cmml" xref="S3.SS3.SSS1.p6.8.m8.1.1.2">𝑇</ci><cn id="S3.SS3.SSS1.p6.8.m8.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p6.8.m8.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.8.m8.1c">\frac{T}{10}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.8.m8.1d">divide start_ARG italic_T end_ARG start_ARG 10 end_ARG</annotation></semantics></math>, significantly reducing the length of life-cycle behaviors.
Item embeddings <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p6.9.m9.1"><semantics id="S3.SS3.SSS1.p6.9.m9.1a"><msub id="S3.SS3.SSS1.p6.9.m9.1.1" xref="S3.SS3.SSS1.p6.9.m9.1.1.cmml"><mi id="S3.SS3.SSS1.p6.9.m9.1.1.2" xref="S3.SS3.SSS1.p6.9.m9.1.1.2.cmml">𝐊</mi><mi id="S3.SS3.SSS1.p6.9.m9.1.1.3" xref="S3.SS3.SSS1.p6.9.m9.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p6.9.m9.1b"><apply id="S3.SS3.SSS1.p6.9.m9.1.1.cmml" xref="S3.SS3.SSS1.p6.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p6.9.m9.1.1.1.cmml" xref="S3.SS3.SSS1.p6.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p6.9.m9.1.1.2.cmml" xref="S3.SS3.SSS1.p6.9.m9.1.1.2">𝐊</ci><ci id="S3.SS3.SSS1.p6.9.m9.1.1.3.cmml" xref="S3.SS3.SSS1.p6.9.m9.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p6.9.m9.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p6.9.m9.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> used for clustering are obtained from the recommendation model, which means the clustering is guided by collaborative filtering signals.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p7">
<p class="ltx_p" id="S3.SS3.SSS1.p7.2">Thus, we compress the originally lengthy user behavior sequence <math alttext="S=[s_{1},s_{2},\cdots,s_{T}]" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p7.1.m1.4"><semantics id="S3.SS3.SSS1.p7.1.m1.4a"><mrow id="S3.SS3.SSS1.p7.1.m1.4.4" xref="S3.SS3.SSS1.p7.1.m1.4.4.cmml"><mi id="S3.SS3.SSS1.p7.1.m1.4.4.5" xref="S3.SS3.SSS1.p7.1.m1.4.4.5.cmml">S</mi><mo id="S3.SS3.SSS1.p7.1.m1.4.4.4" xref="S3.SS3.SSS1.p7.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p7.1.m1.4.4.3.3" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.4.cmml"><mo id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1" xref="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.2" xref="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.3" xref="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.5" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2" xref="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.2" xref="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.2.cmml">s</mi><mn id="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.3" xref="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.6" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS3.SSS1.p7.1.m1.1.1" mathvariant="normal" xref="S3.SS3.SSS1.p7.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.7" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.2" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.2.cmml">s</mi><mi id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.3" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.3.cmml">T</mi></msub><mo id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p7.1.m1.4b"><apply id="S3.SS3.SSS1.p7.1.m1.4.4.cmml" xref="S3.SS3.SSS1.p7.1.m1.4.4"><eq id="S3.SS3.SSS1.p7.1.m1.4.4.4.cmml" xref="S3.SS3.SSS1.p7.1.m1.4.4.4"></eq><ci id="S3.SS3.SSS1.p7.1.m1.4.4.5.cmml" xref="S3.SS3.SSS1.p7.1.m1.4.4.5">𝑆</ci><list id="S3.SS3.SSS1.p7.1.m1.4.4.3.4.cmml" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.3"><apply id="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.2">𝑠</ci><cn id="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p7.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.2">𝑠</ci><cn id="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS1.p7.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.SSS1.p7.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p7.1.m1.1.1">⋯</ci><apply id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.2">𝑠</ci><ci id="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS1.p7.1.m1.4.4.3.3.3.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p7.1.m1.4c">S=[s_{1},s_{2},\cdots,s_{T}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p7.1.m1.4d">italic_S = [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ]</annotation></semantics></math> into a
shorter sequence <math alttext="C=[c_{1},c_{2},\cdots,c_{\hat{T}}]" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p7.2.m2.4"><semantics id="S3.SS3.SSS1.p7.2.m2.4a"><mrow id="S3.SS3.SSS1.p7.2.m2.4.4" xref="S3.SS3.SSS1.p7.2.m2.4.4.cmml"><mi id="S3.SS3.SSS1.p7.2.m2.4.4.5" xref="S3.SS3.SSS1.p7.2.m2.4.4.5.cmml">C</mi><mo id="S3.SS3.SSS1.p7.2.m2.4.4.4" xref="S3.SS3.SSS1.p7.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p7.2.m2.4.4.3.3" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.4.cmml"><mo id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.4.cmml">[</mo><msub id="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1" xref="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.2" xref="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.2.cmml">c</mi><mn id="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.3" xref="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.5" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2" xref="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.2" xref="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.2.cmml">c</mi><mn id="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.3" xref="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.6" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS3.SSS1.p7.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS1.p7.2.m2.1.1.cmml">⋯</mi><mo id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.7" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.2" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.2.cmml">c</mi><mover accent="true" id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.2" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.2.cmml">T</mi><mo id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.1" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.1.cmml">^</mo></mover></msub><mo id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p7.2.m2.4b"><apply id="S3.SS3.SSS1.p7.2.m2.4.4.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4"><eq id="S3.SS3.SSS1.p7.2.m2.4.4.4.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.4"></eq><ci id="S3.SS3.SSS1.p7.2.m2.4.4.5.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.5">𝐶</ci><list id="S3.SS3.SSS1.p7.2.m2.4.4.3.4.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3"><apply id="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.2">𝑐</ci><cn id="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p7.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.2">𝑐</ci><cn id="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS1.p7.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.SSS1.p7.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p7.2.m2.1.1">⋯</ci><apply id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.2">𝑐</ci><apply id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3"><ci id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.1">^</ci><ci id="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p7.2.m2.4.4.3.3.3.3.2">𝑇</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p7.2.m2.4c">C=[c_{1},c_{2},\cdots,c_{\hat{T}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p7.2.m2.4d">italic_C = [ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_c start_POSTSUBSCRIPT over^ start_ARG italic_T end_ARG end_POSTSUBSCRIPT ]</annotation></semantics></math> by aggregating similar items into clusters.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2. </span>Extracting Cluster Representation</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">After obtaining clusters <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mi id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><ci id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_C</annotation></semantics></math>, we need to extract features from items of each cluster.
To minimize computational and storage overhead, we use a virtual item to represent the features of each cluster.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.p2.1">We divide item features into two categories (numerical and categorical) and extract them using different methods.
Numerical features are typically represented using scalers, for example, video duration and user playing time for a video.
Categorical features are commonly represented using one-hot (or multi-hot) vectors, such as video ID and author ID.
Formally, given an arbitrary item <math alttext="v" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.m1.1"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><mi id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><ci id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.1.m1.1d">italic_v</annotation></semantics></math>, its feature can be written as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathbf{x}_{v}=[\underbrace{\mathbf{x}_{c,1}^{(v)};\mathbf{x}_{c,2}^{(v)%
};\dots;\mathbf{x}_{c,N_{1}}^{(v)}}_{\text{categorical (one-hot)}};\underbrace%
{x_{s,1}^{(v)};x_{s,2}^{(v)};\dots;x_{s,N_{2}}^{(v)}}_{\text{numerical (scaler%
)}}]," class="ltx_Math" display="block" id="S3.E4.m1.27"><semantics id="S3.E4.m1.27a"><mrow id="S3.E4.m1.27.27.1" xref="S3.E4.m1.27.27.1.1.cmml"><mrow id="S3.E4.m1.27.27.1.1" xref="S3.E4.m1.27.27.1.1.cmml"><msub id="S3.E4.m1.27.27.1.1.4" xref="S3.E4.m1.27.27.1.1.4.cmml"><mi id="S3.E4.m1.27.27.1.1.4.2" mathsize="90%" xref="S3.E4.m1.27.27.1.1.4.2.cmml">𝐱</mi><mi id="S3.E4.m1.27.27.1.1.4.3" mathsize="90%" xref="S3.E4.m1.27.27.1.1.4.3.cmml">v</mi></msub><mo id="S3.E4.m1.27.27.1.1.3" mathsize="90%" xref="S3.E4.m1.27.27.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.27.27.1.1.2.2" xref="S3.E4.m1.27.27.1.1.2.3.cmml"><mo id="S3.E4.m1.27.27.1.1.2.2.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.27.27.1.1.2.3.cmml">[</mo><munder id="S3.E4.m1.27.27.1.1.1.1.1" xref="S3.E4.m1.27.27.1.1.1.1.1.cmml"><munder accentunder="true" id="S3.E4.m1.13.13" xref="S3.E4.m1.13.13.cmml"><mrow id="S3.E4.m1.13.13.13.13" xref="S3.E4.m1.13.13.13.14.cmml"><msubsup id="S3.E4.m1.11.11.11.11.1" xref="S3.E4.m1.11.11.11.11.1.cmml"><mi id="S3.E4.m1.11.11.11.11.1.2.2" mathsize="90%" xref="S3.E4.m1.11.11.11.11.1.2.2.cmml">𝐱</mi><mrow id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.1.cmml">c</mi><mo id="S3.E4.m1.2.2.2.2.2.4.1" mathsize="90%" xref="S3.E4.m1.2.2.2.2.2.3.cmml">,</mo><mn id="S3.E4.m1.2.2.2.2.2.2" mathsize="90%" xref="S3.E4.m1.2.2.2.2.2.2.cmml">1</mn></mrow><mrow id="S3.E4.m1.3.3.3.3.1.3" xref="S3.E4.m1.11.11.11.11.1.cmml"><mo id="S3.E4.m1.3.3.3.3.1.3.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.11.11.11.11.1.cmml">(</mo><mi id="S3.E4.m1.3.3.3.3.1.1" mathsize="90%" xref="S3.E4.m1.3.3.3.3.1.1.cmml">v</mi><mo id="S3.E4.m1.3.3.3.3.1.3.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.11.11.11.11.1.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.13.13.13.13.4" mathsize="90%" xref="S3.E4.m1.13.13.13.14.cmml">;</mo><msubsup id="S3.E4.m1.12.12.12.12.2" xref="S3.E4.m1.12.12.12.12.2.cmml"><mi id="S3.E4.m1.12.12.12.12.2.2.2" mathsize="90%" xref="S3.E4.m1.12.12.12.12.2.2.2.cmml">𝐱</mi><mrow id="S3.E4.m1.5.5.5.5.2.4" xref="S3.E4.m1.5.5.5.5.2.3.cmml"><mi id="S3.E4.m1.4.4.4.4.1.1" mathsize="90%" xref="S3.E4.m1.4.4.4.4.1.1.cmml">c</mi><mo id="S3.E4.m1.5.5.5.5.2.4.1" mathsize="90%" xref="S3.E4.m1.5.5.5.5.2.3.cmml">,</mo><mn id="S3.E4.m1.5.5.5.5.2.2" mathsize="90%" xref="S3.E4.m1.5.5.5.5.2.2.cmml">2</mn></mrow><mrow id="S3.E4.m1.6.6.6.6.1.3" xref="S3.E4.m1.12.12.12.12.2.cmml"><mo id="S3.E4.m1.6.6.6.6.1.3.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.12.12.12.12.2.cmml">(</mo><mi id="S3.E4.m1.6.6.6.6.1.1" mathsize="90%" xref="S3.E4.m1.6.6.6.6.1.1.cmml">v</mi><mo id="S3.E4.m1.6.6.6.6.1.3.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.12.12.12.12.2.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.13.13.13.13.5" mathsize="90%" xref="S3.E4.m1.13.13.13.14.cmml">;</mo><mi id="S3.E4.m1.10.10.10.10" mathsize="90%" mathvariant="normal" xref="S3.E4.m1.10.10.10.10.cmml">…</mi><mo id="S3.E4.m1.13.13.13.13.6" mathsize="90%" xref="S3.E4.m1.13.13.13.14.cmml">;</mo><msubsup id="S3.E4.m1.13.13.13.13.3" xref="S3.E4.m1.13.13.13.13.3.cmml"><mi id="S3.E4.m1.13.13.13.13.3.2.2" mathsize="90%" xref="S3.E4.m1.13.13.13.13.3.2.2.cmml">𝐱</mi><mrow id="S3.E4.m1.8.8.8.8.2.2" xref="S3.E4.m1.8.8.8.8.2.3.cmml"><mi id="S3.E4.m1.7.7.7.7.1.1" mathsize="90%" xref="S3.E4.m1.7.7.7.7.1.1.cmml">c</mi><mo id="S3.E4.m1.8.8.8.8.2.2.2" mathsize="90%" xref="S3.E4.m1.8.8.8.8.2.3.cmml">,</mo><msub id="S3.E4.m1.8.8.8.8.2.2.1" xref="S3.E4.m1.8.8.8.8.2.2.1.cmml"><mi id="S3.E4.m1.8.8.8.8.2.2.1.2" mathsize="90%" xref="S3.E4.m1.8.8.8.8.2.2.1.2.cmml">N</mi><mn id="S3.E4.m1.8.8.8.8.2.2.1.3" mathsize="90%" xref="S3.E4.m1.8.8.8.8.2.2.1.3.cmml">1</mn></msub></mrow><mrow id="S3.E4.m1.9.9.9.9.1.3" xref="S3.E4.m1.13.13.13.13.3.cmml"><mo id="S3.E4.m1.9.9.9.9.1.3.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.13.13.13.13.3.cmml">(</mo><mi id="S3.E4.m1.9.9.9.9.1.1" mathsize="90%" xref="S3.E4.m1.9.9.9.9.1.1.cmml">v</mi><mo id="S3.E4.m1.9.9.9.9.1.3.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.13.13.13.13.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E4.m1.13.13.14" mathsize="90%" xref="S3.E4.m1.13.13.14.cmml">⏟</mo></munder><mtext id="S3.E4.m1.27.27.1.1.1.1.1.2" mathsize="90%" xref="S3.E4.m1.27.27.1.1.1.1.1.2a.cmml">categorical (one-hot)</mtext></munder><mo id="S3.E4.m1.27.27.1.1.2.2.4" mathsize="90%" xref="S3.E4.m1.27.27.1.1.2.3.cmml">;</mo><munder id="S3.E4.m1.27.27.1.1.2.2.2" xref="S3.E4.m1.27.27.1.1.2.2.2.cmml"><munder accentunder="true" id="S3.E4.m1.26.26" xref="S3.E4.m1.26.26.cmml"><mrow id="S3.E4.m1.26.26.13.13" xref="S3.E4.m1.26.26.13.14.cmml"><msubsup id="S3.E4.m1.24.24.11.11.1" xref="S3.E4.m1.24.24.11.11.1.cmml"><mi id="S3.E4.m1.24.24.11.11.1.2.2" mathsize="90%" xref="S3.E4.m1.24.24.11.11.1.2.2.cmml">x</mi><mrow id="S3.E4.m1.15.15.2.2.2.4" xref="S3.E4.m1.15.15.2.2.2.3.cmml"><mi id="S3.E4.m1.14.14.1.1.1.1" mathsize="90%" xref="S3.E4.m1.14.14.1.1.1.1.cmml">s</mi><mo id="S3.E4.m1.15.15.2.2.2.4.1" mathsize="90%" xref="S3.E4.m1.15.15.2.2.2.3.cmml">,</mo><mn id="S3.E4.m1.15.15.2.2.2.2" mathsize="90%" xref="S3.E4.m1.15.15.2.2.2.2.cmml">1</mn></mrow><mrow id="S3.E4.m1.16.16.3.3.1.3" xref="S3.E4.m1.24.24.11.11.1.cmml"><mo id="S3.E4.m1.16.16.3.3.1.3.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.24.24.11.11.1.cmml">(</mo><mi id="S3.E4.m1.16.16.3.3.1.1" mathsize="90%" xref="S3.E4.m1.16.16.3.3.1.1.cmml">v</mi><mo id="S3.E4.m1.16.16.3.3.1.3.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.24.24.11.11.1.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.26.26.13.13.4" mathsize="90%" xref="S3.E4.m1.26.26.13.14.cmml">;</mo><msubsup id="S3.E4.m1.25.25.12.12.2" xref="S3.E4.m1.25.25.12.12.2.cmml"><mi id="S3.E4.m1.25.25.12.12.2.2.2" mathsize="90%" xref="S3.E4.m1.25.25.12.12.2.2.2.cmml">x</mi><mrow id="S3.E4.m1.18.18.5.5.2.4" xref="S3.E4.m1.18.18.5.5.2.3.cmml"><mi id="S3.E4.m1.17.17.4.4.1.1" mathsize="90%" xref="S3.E4.m1.17.17.4.4.1.1.cmml">s</mi><mo id="S3.E4.m1.18.18.5.5.2.4.1" mathsize="90%" xref="S3.E4.m1.18.18.5.5.2.3.cmml">,</mo><mn id="S3.E4.m1.18.18.5.5.2.2" mathsize="90%" xref="S3.E4.m1.18.18.5.5.2.2.cmml">2</mn></mrow><mrow id="S3.E4.m1.19.19.6.6.1.3" xref="S3.E4.m1.25.25.12.12.2.cmml"><mo id="S3.E4.m1.19.19.6.6.1.3.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.25.25.12.12.2.cmml">(</mo><mi id="S3.E4.m1.19.19.6.6.1.1" mathsize="90%" xref="S3.E4.m1.19.19.6.6.1.1.cmml">v</mi><mo id="S3.E4.m1.19.19.6.6.1.3.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.25.25.12.12.2.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.26.26.13.13.5" mathsize="90%" xref="S3.E4.m1.26.26.13.14.cmml">;</mo><mi id="S3.E4.m1.23.23.10.10" mathsize="90%" mathvariant="normal" xref="S3.E4.m1.23.23.10.10.cmml">…</mi><mo id="S3.E4.m1.26.26.13.13.6" mathsize="90%" xref="S3.E4.m1.26.26.13.14.cmml">;</mo><msubsup id="S3.E4.m1.26.26.13.13.3" xref="S3.E4.m1.26.26.13.13.3.cmml"><mi id="S3.E4.m1.26.26.13.13.3.2.2" mathsize="90%" xref="S3.E4.m1.26.26.13.13.3.2.2.cmml">x</mi><mrow id="S3.E4.m1.21.21.8.8.2.2" xref="S3.E4.m1.21.21.8.8.2.3.cmml"><mi id="S3.E4.m1.20.20.7.7.1.1" mathsize="90%" xref="S3.E4.m1.20.20.7.7.1.1.cmml">s</mi><mo id="S3.E4.m1.21.21.8.8.2.2.2" mathsize="90%" xref="S3.E4.m1.21.21.8.8.2.3.cmml">,</mo><msub id="S3.E4.m1.21.21.8.8.2.2.1" xref="S3.E4.m1.21.21.8.8.2.2.1.cmml"><mi id="S3.E4.m1.21.21.8.8.2.2.1.2" mathsize="90%" xref="S3.E4.m1.21.21.8.8.2.2.1.2.cmml">N</mi><mn id="S3.E4.m1.21.21.8.8.2.2.1.3" mathsize="90%" xref="S3.E4.m1.21.21.8.8.2.2.1.3.cmml">2</mn></msub></mrow><mrow id="S3.E4.m1.22.22.9.9.1.3" xref="S3.E4.m1.26.26.13.13.3.cmml"><mo id="S3.E4.m1.22.22.9.9.1.3.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.26.26.13.13.3.cmml">(</mo><mi id="S3.E4.m1.22.22.9.9.1.1" mathsize="90%" xref="S3.E4.m1.22.22.9.9.1.1.cmml">v</mi><mo id="S3.E4.m1.22.22.9.9.1.3.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.26.26.13.13.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E4.m1.26.26.14" mathsize="90%" xref="S3.E4.m1.26.26.14.cmml">⏟</mo></munder><mtext id="S3.E4.m1.27.27.1.1.2.2.2.2" mathsize="90%" xref="S3.E4.m1.27.27.1.1.2.2.2.2a.cmml">numerical (scaler)</mtext></munder><mo id="S3.E4.m1.27.27.1.1.2.2.5" maxsize="90%" minsize="90%" xref="S3.E4.m1.27.27.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.27.27.1.2" mathsize="90%" xref="S3.E4.m1.27.27.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.27b"><apply id="S3.E4.m1.27.27.1.1.cmml" xref="S3.E4.m1.27.27.1"><eq id="S3.E4.m1.27.27.1.1.3.cmml" xref="S3.E4.m1.27.27.1.1.3"></eq><apply id="S3.E4.m1.27.27.1.1.4.cmml" xref="S3.E4.m1.27.27.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.27.27.1.1.4.1.cmml" xref="S3.E4.m1.27.27.1.1.4">subscript</csymbol><ci id="S3.E4.m1.27.27.1.1.4.2.cmml" xref="S3.E4.m1.27.27.1.1.4.2">𝐱</ci><ci id="S3.E4.m1.27.27.1.1.4.3.cmml" xref="S3.E4.m1.27.27.1.1.4.3">𝑣</ci></apply><list id="S3.E4.m1.27.27.1.1.2.3.cmml" xref="S3.E4.m1.27.27.1.1.2.2"><apply id="S3.E4.m1.27.27.1.1.1.1.1.cmml" xref="S3.E4.m1.27.27.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.27.27.1.1.1.1.1.1.cmml" xref="S3.E4.m1.27.27.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.13.13.cmml" xref="S3.E4.m1.13.13"><ci id="S3.E4.m1.13.13.14.cmml" xref="S3.E4.m1.13.13.14">⏟</ci><list id="S3.E4.m1.13.13.13.14.cmml" xref="S3.E4.m1.13.13.13.13"><apply id="S3.E4.m1.11.11.11.11.1.cmml" xref="S3.E4.m1.11.11.11.11.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.11.11.1.1.cmml" xref="S3.E4.m1.11.11.11.11.1">superscript</csymbol><apply id="S3.E4.m1.11.11.11.11.1.2.cmml" xref="S3.E4.m1.11.11.11.11.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.11.11.1.2.1.cmml" xref="S3.E4.m1.11.11.11.11.1">subscript</csymbol><ci id="S3.E4.m1.11.11.11.11.1.2.2.cmml" xref="S3.E4.m1.11.11.11.11.1.2.2">𝐱</ci><list id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑐</ci><cn id="S3.E4.m1.2.2.2.2.2.2.cmml" type="integer" xref="S3.E4.m1.2.2.2.2.2.2">1</cn></list></apply><ci id="S3.E4.m1.3.3.3.3.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1">𝑣</ci></apply><apply id="S3.E4.m1.12.12.12.12.2.cmml" xref="S3.E4.m1.12.12.12.12.2"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.12.2.1.cmml" xref="S3.E4.m1.12.12.12.12.2">superscript</csymbol><apply id="S3.E4.m1.12.12.12.12.2.2.cmml" xref="S3.E4.m1.12.12.12.12.2"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.12.2.2.1.cmml" xref="S3.E4.m1.12.12.12.12.2">subscript</csymbol><ci id="S3.E4.m1.12.12.12.12.2.2.2.cmml" xref="S3.E4.m1.12.12.12.12.2.2.2">𝐱</ci><list id="S3.E4.m1.5.5.5.5.2.3.cmml" xref="S3.E4.m1.5.5.5.5.2.4"><ci id="S3.E4.m1.4.4.4.4.1.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1">𝑐</ci><cn id="S3.E4.m1.5.5.5.5.2.2.cmml" type="integer" xref="S3.E4.m1.5.5.5.5.2.2">2</cn></list></apply><ci id="S3.E4.m1.6.6.6.6.1.1.cmml" xref="S3.E4.m1.6.6.6.6.1.1">𝑣</ci></apply><ci id="S3.E4.m1.10.10.10.10.cmml" xref="S3.E4.m1.10.10.10.10">…</ci><apply id="S3.E4.m1.13.13.13.13.3.cmml" xref="S3.E4.m1.13.13.13.13.3"><csymbol cd="ambiguous" id="S3.E4.m1.13.13.13.13.3.1.cmml" xref="S3.E4.m1.13.13.13.13.3">superscript</csymbol><apply id="S3.E4.m1.13.13.13.13.3.2.cmml" xref="S3.E4.m1.13.13.13.13.3"><csymbol cd="ambiguous" id="S3.E4.m1.13.13.13.13.3.2.1.cmml" xref="S3.E4.m1.13.13.13.13.3">subscript</csymbol><ci id="S3.E4.m1.13.13.13.13.3.2.2.cmml" xref="S3.E4.m1.13.13.13.13.3.2.2">𝐱</ci><list id="S3.E4.m1.8.8.8.8.2.3.cmml" xref="S3.E4.m1.8.8.8.8.2.2"><ci id="S3.E4.m1.7.7.7.7.1.1.cmml" xref="S3.E4.m1.7.7.7.7.1.1">𝑐</ci><apply id="S3.E4.m1.8.8.8.8.2.2.1.cmml" xref="S3.E4.m1.8.8.8.8.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.8.8.2.2.1.1.cmml" xref="S3.E4.m1.8.8.8.8.2.2.1">subscript</csymbol><ci id="S3.E4.m1.8.8.8.8.2.2.1.2.cmml" xref="S3.E4.m1.8.8.8.8.2.2.1.2">𝑁</ci><cn id="S3.E4.m1.8.8.8.8.2.2.1.3.cmml" type="integer" xref="S3.E4.m1.8.8.8.8.2.2.1.3">1</cn></apply></list></apply><ci id="S3.E4.m1.9.9.9.9.1.1.cmml" xref="S3.E4.m1.9.9.9.9.1.1">𝑣</ci></apply></list></apply><ci id="S3.E4.m1.27.27.1.1.1.1.1.2a.cmml" xref="S3.E4.m1.27.27.1.1.1.1.1.2"><mtext id="S3.E4.m1.27.27.1.1.1.1.1.2.cmml" mathsize="63%" xref="S3.E4.m1.27.27.1.1.1.1.1.2">categorical (one-hot)</mtext></ci></apply><apply id="S3.E4.m1.27.27.1.1.2.2.2.cmml" xref="S3.E4.m1.27.27.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.27.27.1.1.2.2.2.1.cmml" xref="S3.E4.m1.27.27.1.1.2.2.2">subscript</csymbol><apply id="S3.E4.m1.26.26.cmml" xref="S3.E4.m1.26.26"><ci id="S3.E4.m1.26.26.14.cmml" xref="S3.E4.m1.26.26.14">⏟</ci><list id="S3.E4.m1.26.26.13.14.cmml" xref="S3.E4.m1.26.26.13.13"><apply id="S3.E4.m1.24.24.11.11.1.cmml" xref="S3.E4.m1.24.24.11.11.1"><csymbol cd="ambiguous" id="S3.E4.m1.24.24.11.11.1.1.cmml" xref="S3.E4.m1.24.24.11.11.1">superscript</csymbol><apply id="S3.E4.m1.24.24.11.11.1.2.cmml" xref="S3.E4.m1.24.24.11.11.1"><csymbol cd="ambiguous" id="S3.E4.m1.24.24.11.11.1.2.1.cmml" xref="S3.E4.m1.24.24.11.11.1">subscript</csymbol><ci id="S3.E4.m1.24.24.11.11.1.2.2.cmml" xref="S3.E4.m1.24.24.11.11.1.2.2">𝑥</ci><list id="S3.E4.m1.15.15.2.2.2.3.cmml" xref="S3.E4.m1.15.15.2.2.2.4"><ci id="S3.E4.m1.14.14.1.1.1.1.cmml" xref="S3.E4.m1.14.14.1.1.1.1">𝑠</ci><cn id="S3.E4.m1.15.15.2.2.2.2.cmml" type="integer" xref="S3.E4.m1.15.15.2.2.2.2">1</cn></list></apply><ci id="S3.E4.m1.16.16.3.3.1.1.cmml" xref="S3.E4.m1.16.16.3.3.1.1">𝑣</ci></apply><apply id="S3.E4.m1.25.25.12.12.2.cmml" xref="S3.E4.m1.25.25.12.12.2"><csymbol cd="ambiguous" id="S3.E4.m1.25.25.12.12.2.1.cmml" xref="S3.E4.m1.25.25.12.12.2">superscript</csymbol><apply id="S3.E4.m1.25.25.12.12.2.2.cmml" xref="S3.E4.m1.25.25.12.12.2"><csymbol cd="ambiguous" id="S3.E4.m1.25.25.12.12.2.2.1.cmml" xref="S3.E4.m1.25.25.12.12.2">subscript</csymbol><ci id="S3.E4.m1.25.25.12.12.2.2.2.cmml" xref="S3.E4.m1.25.25.12.12.2.2.2">𝑥</ci><list id="S3.E4.m1.18.18.5.5.2.3.cmml" xref="S3.E4.m1.18.18.5.5.2.4"><ci id="S3.E4.m1.17.17.4.4.1.1.cmml" xref="S3.E4.m1.17.17.4.4.1.1">𝑠</ci><cn id="S3.E4.m1.18.18.5.5.2.2.cmml" type="integer" xref="S3.E4.m1.18.18.5.5.2.2">2</cn></list></apply><ci id="S3.E4.m1.19.19.6.6.1.1.cmml" xref="S3.E4.m1.19.19.6.6.1.1">𝑣</ci></apply><ci id="S3.E4.m1.23.23.10.10.cmml" xref="S3.E4.m1.23.23.10.10">…</ci><apply id="S3.E4.m1.26.26.13.13.3.cmml" xref="S3.E4.m1.26.26.13.13.3"><csymbol cd="ambiguous" id="S3.E4.m1.26.26.13.13.3.1.cmml" xref="S3.E4.m1.26.26.13.13.3">superscript</csymbol><apply id="S3.E4.m1.26.26.13.13.3.2.cmml" xref="S3.E4.m1.26.26.13.13.3"><csymbol cd="ambiguous" id="S3.E4.m1.26.26.13.13.3.2.1.cmml" xref="S3.E4.m1.26.26.13.13.3">subscript</csymbol><ci id="S3.E4.m1.26.26.13.13.3.2.2.cmml" xref="S3.E4.m1.26.26.13.13.3.2.2">𝑥</ci><list id="S3.E4.m1.21.21.8.8.2.3.cmml" xref="S3.E4.m1.21.21.8.8.2.2"><ci id="S3.E4.m1.20.20.7.7.1.1.cmml" xref="S3.E4.m1.20.20.7.7.1.1">𝑠</ci><apply id="S3.E4.m1.21.21.8.8.2.2.1.cmml" xref="S3.E4.m1.21.21.8.8.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.21.21.8.8.2.2.1.1.cmml" xref="S3.E4.m1.21.21.8.8.2.2.1">subscript</csymbol><ci id="S3.E4.m1.21.21.8.8.2.2.1.2.cmml" xref="S3.E4.m1.21.21.8.8.2.2.1.2">𝑁</ci><cn id="S3.E4.m1.21.21.8.8.2.2.1.3.cmml" type="integer" xref="S3.E4.m1.21.21.8.8.2.2.1.3">2</cn></apply></list></apply><ci id="S3.E4.m1.22.22.9.9.1.1.cmml" xref="S3.E4.m1.22.22.9.9.1.1">𝑣</ci></apply></list></apply><ci id="S3.E4.m1.27.27.1.1.2.2.2.2a.cmml" xref="S3.E4.m1.27.27.1.1.2.2.2.2"><mtext id="S3.E4.m1.27.27.1.1.2.2.2.2.cmml" mathsize="63%" xref="S3.E4.m1.27.27.1.1.2.2.2.2">numerical (scaler)</mtext></ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.27c">\small\mathbf{x}_{v}=[\underbrace{\mathbf{x}_{c,1}^{(v)};\mathbf{x}_{c,2}^{(v)%
};\dots;\mathbf{x}_{c,N_{1}}^{(v)}}_{\text{categorical (one-hot)}};\underbrace%
{x_{s,1}^{(v)};x_{s,2}^{(v)};\dots;x_{s,N_{2}}^{(v)}}_{\text{numerical (scaler%
)}}],</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.27d">bold_x start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = [ under⏟ start_ARG bold_x start_POSTSUBSCRIPT italic_c , 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT ; bold_x start_POSTSUBSCRIPT italic_c , 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT ; … ; bold_x start_POSTSUBSCRIPT italic_c , italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT categorical (one-hot) end_POSTSUBSCRIPT ; under⏟ start_ARG italic_x start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT ; italic_x start_POSTSUBSCRIPT italic_s , 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT ; … ; italic_x start_POSTSUBSCRIPT italic_s , italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT numerical (scaler) end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.6">For simplicity, we use <math alttext="\mathbf{x}^{(v)}_{1:N_{1}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m1.1"><semantics id="S3.SS3.SSS2.p2.2.m1.1a"><msubsup id="S3.SS3.SSS2.p2.2.m1.1.2" xref="S3.SS3.SSS2.p2.2.m1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.2.m1.1.2.2.2" xref="S3.SS3.SSS2.p2.2.m1.1.2.2.2.cmml">𝐱</mi><mrow id="S3.SS3.SSS2.p2.2.m1.1.2.3" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.cmml"><mn id="S3.SS3.SSS2.p2.2.m1.1.2.3.2" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.2.cmml">1</mn><mo id="S3.SS3.SSS2.p2.2.m1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.1.cmml">:</mo><msub id="S3.SS3.SSS2.p2.2.m1.1.2.3.3" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.3.cmml"><mi id="S3.SS3.SSS2.p2.2.m1.1.2.3.3.2" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.3.2.cmml">N</mi><mn id="S3.SS3.SSS2.p2.2.m1.1.2.3.3.3" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.3.3.cmml">1</mn></msub></mrow><mrow id="S3.SS3.SSS2.p2.2.m1.1.1.1.3" xref="S3.SS3.SSS2.p2.2.m1.1.2.cmml"><mo id="S3.SS3.SSS2.p2.2.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS2.p2.2.m1.1.2.cmml">(</mo><mi id="S3.SS3.SSS2.p2.2.m1.1.1.1.1" xref="S3.SS3.SSS2.p2.2.m1.1.1.1.1.cmml">v</mi><mo id="S3.SS3.SSS2.p2.2.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS2.p2.2.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m1.1b"><apply id="S3.SS3.SSS2.p2.2.m1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2">subscript</csymbol><apply id="S3.SS3.SSS2.p2.2.m1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2.2.2">𝐱</ci><ci id="S3.SS3.SSS2.p2.2.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.1.1.1">𝑣</ci></apply><apply id="S3.SS3.SSS2.p2.2.m1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2.3"><ci id="S3.SS3.SSS2.p2.2.m1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.1">:</ci><cn id="S3.SS3.SSS2.p2.2.m1.1.2.3.2.cmml" type="integer" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.2">1</cn><apply id="S3.SS3.SSS2.p2.2.m1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m1.1.2.3.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m1.1.2.3.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.3.2">𝑁</ci><cn id="S3.SS3.SSS2.p2.2.m1.1.2.3.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.2.m1.1.2.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m1.1c">\mathbf{x}^{(v)}_{1:N_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.2.m1.1d">bold_x start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to denote categorical features and <math alttext="\mathbf{x}^{(v)}_{1:N_{2}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.3.m2.1"><semantics id="S3.SS3.SSS2.p2.3.m2.1a"><msubsup id="S3.SS3.SSS2.p2.3.m2.1.2" xref="S3.SS3.SSS2.p2.3.m2.1.2.cmml"><mi id="S3.SS3.SSS2.p2.3.m2.1.2.2.2" xref="S3.SS3.SSS2.p2.3.m2.1.2.2.2.cmml">𝐱</mi><mrow id="S3.SS3.SSS2.p2.3.m2.1.2.3" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.cmml"><mn id="S3.SS3.SSS2.p2.3.m2.1.2.3.2" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.2.cmml">1</mn><mo id="S3.SS3.SSS2.p2.3.m2.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.1.cmml">:</mo><msub id="S3.SS3.SSS2.p2.3.m2.1.2.3.3" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m2.1.2.3.3.2" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.3.2.cmml">N</mi><mn id="S3.SS3.SSS2.p2.3.m2.1.2.3.3.3" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.3.3.cmml">2</mn></msub></mrow><mrow id="S3.SS3.SSS2.p2.3.m2.1.1.1.3" xref="S3.SS3.SSS2.p2.3.m2.1.2.cmml"><mo id="S3.SS3.SSS2.p2.3.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS2.p2.3.m2.1.2.cmml">(</mo><mi id="S3.SS3.SSS2.p2.3.m2.1.1.1.1" xref="S3.SS3.SSS2.p2.3.m2.1.1.1.1.cmml">v</mi><mo id="S3.SS3.SSS2.p2.3.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS2.p2.3.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m2.1b"><apply id="S3.SS3.SSS2.p2.3.m2.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m2.1.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2">subscript</csymbol><apply id="S3.SS3.SSS2.p2.3.m2.1.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m2.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m2.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2.2.2">𝐱</ci><ci id="S3.SS3.SSS2.p2.3.m2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.1.1.1">𝑣</ci></apply><apply id="S3.SS3.SSS2.p2.3.m2.1.2.3.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2.3"><ci id="S3.SS3.SSS2.p2.3.m2.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.1">:</ci><cn id="S3.SS3.SSS2.p2.3.m2.1.2.3.2.cmml" type="integer" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.2">1</cn><apply id="S3.SS3.SSS2.p2.3.m2.1.2.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m2.1.2.3.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m2.1.2.3.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.3.2">𝑁</ci><cn id="S3.SS3.SSS2.p2.3.m2.1.2.3.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.3.m2.1.2.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m2.1c">\mathbf{x}^{(v)}_{1:N_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.3.m2.1d">bold_x start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to denote numerical features.
For a cluster <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.4.m3.1"><semantics id="S3.SS3.SSS2.p2.4.m3.1a"><msub id="S3.SS3.SSS2.p2.4.m3.1.1" xref="S3.SS3.SSS2.p2.4.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p2.4.m3.1.1.2" xref="S3.SS3.SSS2.p2.4.m3.1.1.2.cmml">c</mi><mi id="S3.SS3.SSS2.p2.4.m3.1.1.3" xref="S3.SS3.SSS2.p2.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m3.1b"><apply id="S3.SS3.SSS2.p2.4.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.4.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.4.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.4.m3.1.1.2">𝑐</ci><ci id="S3.SS3.SSS2.p2.4.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m3.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.4.m3.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.5.m4.1"><semantics id="S3.SS3.SSS2.p2.5.m4.1a"><mi id="S3.SS3.SSS2.p2.5.m4.1.1" xref="S3.SS3.SSS2.p2.5.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m4.1b"><ci id="S3.SS3.SSS2.p2.5.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.5.m4.1d">italic_C</annotation></semantics></math>, we calculate the average of all numerical features of the items it contains as <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.6.m5.1"><semantics id="S3.SS3.SSS2.p2.6.m5.1a"><msub id="S3.SS3.SSS2.p2.6.m5.1.1" xref="S3.SS3.SSS2.p2.6.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p2.6.m5.1.1.2" xref="S3.SS3.SSS2.p2.6.m5.1.1.2.cmml">c</mi><mi id="S3.SS3.SSS2.p2.6.m5.1.1.3" xref="S3.SS3.SSS2.p2.6.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m5.1b"><apply id="S3.SS3.SSS2.p2.6.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m5.1.1.2">𝑐</ci><ci id="S3.SS3.SSS2.p2.6.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m5.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.6.m5.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>’s numerical feature representation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{c}^{(i)}_{1:N_{2}}=\frac{1}{|c_{i}|}\sum_{v\in c_{i}}\mathbf{x}^{(v)}_%
{1:N_{2}}," class="ltx_Math" display="block" id="S3.E5.m1.4"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.4.1" xref="S3.E5.m1.4.4.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.cmml"><msubsup id="S3.E5.m1.4.4.1.1.2" xref="S3.E5.m1.4.4.1.1.2.cmml"><mi id="S3.E5.m1.4.4.1.1.2.2.2" xref="S3.E5.m1.4.4.1.1.2.2.2.cmml">𝐜</mi><mrow id="S3.E5.m1.4.4.1.1.2.3" xref="S3.E5.m1.4.4.1.1.2.3.cmml"><mn id="S3.E5.m1.4.4.1.1.2.3.2" xref="S3.E5.m1.4.4.1.1.2.3.2.cmml">1</mn><mo id="S3.E5.m1.4.4.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E5.m1.4.4.1.1.2.3.1.cmml">:</mo><msub id="S3.E5.m1.4.4.1.1.2.3.3" xref="S3.E5.m1.4.4.1.1.2.3.3.cmml"><mi id="S3.E5.m1.4.4.1.1.2.3.3.2" xref="S3.E5.m1.4.4.1.1.2.3.3.2.cmml">N</mi><mn id="S3.E5.m1.4.4.1.1.2.3.3.3" xref="S3.E5.m1.4.4.1.1.2.3.3.3.cmml">2</mn></msub></mrow><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.3.1" stretchy="false" xref="S3.E5.m1.4.4.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.1.1.1.3.2" stretchy="false" xref="S3.E5.m1.4.4.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.4.4.1.1.3" xref="S3.E5.m1.4.4.1.1.3.cmml"><mfrac id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mn id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml">1</mn><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">c</mi><mi id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.2.2.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E5.m1.4.4.1.1.3.1" xref="S3.E5.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.1.1.3.2" xref="S3.E5.m1.4.4.1.1.3.2.cmml"><munder id="S3.E5.m1.4.4.1.1.3.2.1" xref="S3.E5.m1.4.4.1.1.3.2.1.cmml"><mo id="S3.E5.m1.4.4.1.1.3.2.1.2" movablelimits="false" xref="S3.E5.m1.4.4.1.1.3.2.1.2.cmml">∑</mo><mrow id="S3.E5.m1.4.4.1.1.3.2.1.3" xref="S3.E5.m1.4.4.1.1.3.2.1.3.cmml"><mi id="S3.E5.m1.4.4.1.1.3.2.1.3.2" xref="S3.E5.m1.4.4.1.1.3.2.1.3.2.cmml">v</mi><mo id="S3.E5.m1.4.4.1.1.3.2.1.3.1" xref="S3.E5.m1.4.4.1.1.3.2.1.3.1.cmml">∈</mo><msub id="S3.E5.m1.4.4.1.1.3.2.1.3.3" xref="S3.E5.m1.4.4.1.1.3.2.1.3.3.cmml"><mi id="S3.E5.m1.4.4.1.1.3.2.1.3.3.2" xref="S3.E5.m1.4.4.1.1.3.2.1.3.3.2.cmml">c</mi><mi id="S3.E5.m1.4.4.1.1.3.2.1.3.3.3" xref="S3.E5.m1.4.4.1.1.3.2.1.3.3.3.cmml">i</mi></msub></mrow></munder><msubsup id="S3.E5.m1.4.4.1.1.3.2.2" xref="S3.E5.m1.4.4.1.1.3.2.2.cmml"><mi id="S3.E5.m1.4.4.1.1.3.2.2.2.2" xref="S3.E5.m1.4.4.1.1.3.2.2.2.2.cmml">𝐱</mi><mrow id="S3.E5.m1.4.4.1.1.3.2.2.3" xref="S3.E5.m1.4.4.1.1.3.2.2.3.cmml"><mn id="S3.E5.m1.4.4.1.1.3.2.2.3.2" xref="S3.E5.m1.4.4.1.1.3.2.2.3.2.cmml">1</mn><mo id="S3.E5.m1.4.4.1.1.3.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E5.m1.4.4.1.1.3.2.2.3.1.cmml">:</mo><msub id="S3.E5.m1.4.4.1.1.3.2.2.3.3" xref="S3.E5.m1.4.4.1.1.3.2.2.3.3.cmml"><mi id="S3.E5.m1.4.4.1.1.3.2.2.3.3.2" xref="S3.E5.m1.4.4.1.1.3.2.2.3.3.2.cmml">N</mi><mn id="S3.E5.m1.4.4.1.1.3.2.2.3.3.3" xref="S3.E5.m1.4.4.1.1.3.2.2.3.3.3.cmml">2</mn></msub></mrow><mrow id="S3.E5.m1.3.3.1.3" xref="S3.E5.m1.4.4.1.1.3.2.2.cmml"><mo id="S3.E5.m1.3.3.1.3.1" stretchy="false" xref="S3.E5.m1.4.4.1.1.3.2.2.cmml">(</mo><mi id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml">v</mi><mo id="S3.E5.m1.3.3.1.3.2" stretchy="false" xref="S3.E5.m1.4.4.1.1.3.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E5.m1.4.4.1.2" xref="S3.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1"><eq id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1"></eq><apply id="S3.E5.m1.4.4.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.2.1.cmml" xref="S3.E5.m1.4.4.1.1.2">subscript</csymbol><apply id="S3.E5.m1.4.4.1.1.2.2.cmml" xref="S3.E5.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.2.2.1.cmml" xref="S3.E5.m1.4.4.1.1.2">superscript</csymbol><ci id="S3.E5.m1.4.4.1.1.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.2.2.2">𝐜</ci><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E5.m1.4.4.1.1.2.3.cmml" xref="S3.E5.m1.4.4.1.1.2.3"><ci id="S3.E5.m1.4.4.1.1.2.3.1.cmml" xref="S3.E5.m1.4.4.1.1.2.3.1">:</ci><cn id="S3.E5.m1.4.4.1.1.2.3.2.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.2.3.2">1</cn><apply id="S3.E5.m1.4.4.1.1.2.3.3.cmml" xref="S3.E5.m1.4.4.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.2.3.3.1.cmml" xref="S3.E5.m1.4.4.1.1.2.3.3">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.2.3.3.2.cmml" xref="S3.E5.m1.4.4.1.1.2.3.3.2">𝑁</ci><cn id="S3.E5.m1.4.4.1.1.2.3.3.3.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E5.m1.4.4.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.3"><times id="S3.E5.m1.4.4.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3.1"></times><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><divide id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2"></divide><cn id="S3.E5.m1.2.2.3.cmml" type="integer" xref="S3.E5.m1.2.2.3">1</cn><apply id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.1"><abs id="S3.E5.m1.2.2.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2"></abs><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2">𝑐</ci><ci id="S3.E5.m1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E5.m1.4.4.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2"><apply id="S3.E5.m1.4.4.1.1.3.2.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.3.2.1.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1">subscript</csymbol><sum id="S3.E5.m1.4.4.1.1.3.2.1.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1.2"></sum><apply id="S3.E5.m1.4.4.1.1.3.2.1.3.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1.3"><in id="S3.E5.m1.4.4.1.1.3.2.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1.3.1"></in><ci id="S3.E5.m1.4.4.1.1.3.2.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1.3.2">𝑣</ci><apply id="S3.E5.m1.4.4.1.1.3.2.1.3.3.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.3.2.1.3.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1.3.3">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.3.2.1.3.3.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1.3.3.2">𝑐</ci><ci id="S3.E5.m1.4.4.1.1.3.2.1.3.3.3.cmml" xref="S3.E5.m1.4.4.1.1.3.2.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E5.m1.4.4.1.1.3.2.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.3.2.2.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2">subscript</csymbol><apply id="S3.E5.m1.4.4.1.1.3.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.3.2.2.2.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2">superscript</csymbol><ci id="S3.E5.m1.4.4.1.1.3.2.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2.2.2">𝐱</ci><ci id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1">𝑣</ci></apply><apply id="S3.E5.m1.4.4.1.1.3.2.2.3.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2.3"><ci id="S3.E5.m1.4.4.1.1.3.2.2.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2.3.1">:</ci><cn id="S3.E5.m1.4.4.1.1.3.2.2.3.2.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.3.2.2.3.2">1</cn><apply id="S3.E5.m1.4.4.1.1.3.2.2.3.3.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.3.2.2.3.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2.3.3">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.3.2.2.3.3.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2.3.3.2">𝑁</ci><cn id="S3.E5.m1.4.4.1.1.3.2.2.3.3.3.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.3.2.2.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\mathbf{c}^{(i)}_{1:N_{2}}=\frac{1}{|c_{i}|}\sum_{v\in c_{i}}\mathbf{x}^{(v)}_%
{1:N_{2}},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.4d">bold_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG | italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_v ∈ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_x start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.8">For categorical features, since their average is meaningless, we adopt the closest item to the centroid in cluster <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.7.m1.1"><semantics id="S3.SS3.SSS2.p2.7.m1.1a"><msub id="S3.SS3.SSS2.p2.7.m1.1.1" xref="S3.SS3.SSS2.p2.7.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.7.m1.1.1.2" xref="S3.SS3.SSS2.p2.7.m1.1.1.2.cmml">c</mi><mi id="S3.SS3.SSS2.p2.7.m1.1.1.3" xref="S3.SS3.SSS2.p2.7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m1.1b"><apply id="S3.SS3.SSS2.p2.7.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.1.2">𝑐</ci><ci id="S3.SS3.SSS2.p2.7.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m1.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.7.m1.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to represent cluster <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.8.m2.1"><semantics id="S3.SS3.SSS2.p2.8.m2.1a"><msub id="S3.SS3.SSS2.p2.8.m2.1.1" xref="S3.SS3.SSS2.p2.8.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p2.8.m2.1.1.2" xref="S3.SS3.SSS2.p2.8.m2.1.1.2.cmml">c</mi><mi id="S3.SS3.SSS2.p2.8.m2.1.1.3" xref="S3.SS3.SSS2.p2.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m2.1b"><apply id="S3.SS3.SSS2.p2.8.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.8.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.2">𝑐</ci><ci id="S3.SS3.SSS2.p2.8.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m2.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.8.m2.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{c}^{(i)}_{1:N_{1}}=\mathbf{x}^{(v)}_{1:N_{1}}," class="ltx_Math" display="block" id="S3.E6.m1.3"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><msubsup id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.cmml">𝐜</mi><mrow id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml"><mn id="S3.E6.m1.3.3.1.1.2.3.2" xref="S3.E6.m1.3.3.1.1.2.3.2.cmml">1</mn><mo id="S3.E6.m1.3.3.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E6.m1.3.3.1.1.2.3.1.cmml">:</mo><msub id="S3.E6.m1.3.3.1.1.2.3.3" xref="S3.E6.m1.3.3.1.1.2.3.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.3.3.2" xref="S3.E6.m1.3.3.1.1.2.3.3.2.cmml">N</mi><mn id="S3.E6.m1.3.3.1.1.2.3.3.3" xref="S3.E6.m1.3.3.1.1.2.3.3.3.cmml">1</mn></msub></mrow><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.3.1" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.1.1.1.3.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml">=</mo><msubsup id="S3.E6.m1.3.3.1.1.3" xref="S3.E6.m1.3.3.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.3.2.2" xref="S3.E6.m1.3.3.1.1.3.2.2.cmml">𝐱</mi><mrow id="S3.E6.m1.3.3.1.1.3.3" xref="S3.E6.m1.3.3.1.1.3.3.cmml"><mn id="S3.E6.m1.3.3.1.1.3.3.2" xref="S3.E6.m1.3.3.1.1.3.3.2.cmml">1</mn><mo id="S3.E6.m1.3.3.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E6.m1.3.3.1.1.3.3.1.cmml">:</mo><msub id="S3.E6.m1.3.3.1.1.3.3.3" xref="S3.E6.m1.3.3.1.1.3.3.3.cmml"><mi id="S3.E6.m1.3.3.1.1.3.3.3.2" xref="S3.E6.m1.3.3.1.1.3.3.3.2.cmml">N</mi><mn id="S3.E6.m1.3.3.1.1.3.3.3.3" xref="S3.E6.m1.3.3.1.1.3.3.3.3.cmml">1</mn></msub></mrow><mrow id="S3.E6.m1.2.2.1.3" xref="S3.E6.m1.3.3.1.1.3.cmml"><mo id="S3.E6.m1.2.2.1.3.1" stretchy="false" xref="S3.E6.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml">v</mi><mo id="S3.E6.m1.2.2.1.3.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"></eq><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2">𝐜</ci><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3"><ci id="S3.E6.m1.3.3.1.1.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.3.1">:</ci><cn id="S3.E6.m1.3.3.1.1.2.3.2.cmml" type="integer" xref="S3.E6.m1.3.3.1.1.2.3.2">1</cn><apply id="S3.E6.m1.3.3.1.1.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.3.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.3.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.3.3.2">𝑁</ci><cn id="S3.E6.m1.3.3.1.1.2.3.3.3.cmml" type="integer" xref="S3.E6.m1.3.3.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.3">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E6.m1.3.3.1.1.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.3.2.2">𝐱</ci><ci id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1.1">𝑣</ci></apply><apply id="S3.E6.m1.3.3.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.3.3"><ci id="S3.E6.m1.3.3.1.1.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.3.3.1">:</ci><cn id="S3.E6.m1.3.3.1.1.3.3.2.cmml" type="integer" xref="S3.E6.m1.3.3.1.1.3.3.2">1</cn><apply id="S3.E6.m1.3.3.1.1.3.3.3.cmml" xref="S3.E6.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E6.m1.3.3.1.1.3.3.3.2">𝑁</ci><cn id="S3.E6.m1.3.3.1.1.3.3.3.3.cmml" type="integer" xref="S3.E6.m1.3.3.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\displaystyle\mathbf{c}^{(i)}_{1:N_{1}}=\mathbf{x}^{(v)}_{1:N_{1}},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.3d">bold_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = bold_x start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle v=\operatorname*{arg\,min}_{v\in c_{i}}\left\|\mathbf{k}_{v}-%
\mathbf{k}_{\textrm{centroid}}\right\|_{2}^{2}," class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml">v</mi><mo id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><munder id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.1.2.2.2.cmml">arg</mi><mo id="S3.E7.m1.1.1.1.1.1.2.2.1" lspace="0.170em" xref="S3.E7.m1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.1.2.2.3.cmml">min</mi></mrow><mrow id="S3.E7.m1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.1.1.1.1.1.2.3.2.cmml">v</mi><mo id="S3.E7.m1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E7.m1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2.3.3.2" xref="S3.E7.m1.1.1.1.1.1.2.3.3.2.cmml">c</mi><mi id="S3.E7.m1.1.1.1.1.1.2.3.3.3" xref="S3.E7.m1.1.1.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munder><mo id="S3.E7.m1.1.1.1.1.1a" xref="S3.E7.m1.1.1.1.1.1.cmml">⁡</mo><msubsup id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐤</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">v</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐤</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">centroid</mtext></msub></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></eq><ci id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3">𝑣</ci><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><apply id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2.2"><times id="S3.E7.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.2.2.1"></times><ci id="S3.E7.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2.2.2">arg</ci><ci id="S3.E7.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.2.2.3">min</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.2.3"><in id="S3.E7.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.2.3.1"></in><ci id="S3.E7.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2.3.2">𝑣</ci><apply id="S3.E7.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2.3.3.2">𝑐</ci><ci id="S3.E7.m1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐤</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑣</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐤</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3">centroid</mtext></ci></apply></apply></apply><cn id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E7.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle v=\operatorname*{arg\,min}_{v\in c_{i}}\left\|\mathbf{k}_{v}-%
\mathbf{k}_{\textrm{centroid}}\right\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_v = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_v ∈ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_k start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT - bold_k start_POSTSUBSCRIPT centroid end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.16">where <math alttext="\mathbf{k}_{v},\mathbf{k}_{\textrm{centroid}}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.9.m1.2"><semantics id="S3.SS3.SSS2.p2.9.m1.2a"><mrow id="S3.SS3.SSS2.p2.9.m1.2.2" xref="S3.SS3.SSS2.p2.9.m1.2.2.cmml"><mrow id="S3.SS3.SSS2.p2.9.m1.2.2.2.2" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.3.cmml"><msub id="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.2.cmml">𝐤</mi><mi id="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.3" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.2.cmml">𝐤</mi><mtext id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.3" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.3a.cmml">centroid</mtext></msub></mrow><mo id="S3.SS3.SSS2.p2.9.m1.2.2.3" xref="S3.SS3.SSS2.p2.9.m1.2.2.3.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.9.m1.2.2.4" xref="S3.SS3.SSS2.p2.9.m1.2.2.4.cmml"><mi id="S3.SS3.SSS2.p2.9.m1.2.2.4.2" xref="S3.SS3.SSS2.p2.9.m1.2.2.4.2.cmml">ℝ</mi><mi id="S3.SS3.SSS2.p2.9.m1.2.2.4.3" xref="S3.SS3.SSS2.p2.9.m1.2.2.4.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.9.m1.2b"><apply id="S3.SS3.SSS2.p2.9.m1.2.2.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2"><in id="S3.SS3.SSS2.p2.9.m1.2.2.3.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.3"></in><list id="S3.SS3.SSS2.p2.9.m1.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2"><apply id="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.2">𝐤</ci><ci id="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.2">𝐤</ci><ci id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.3a.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.3"><mtext id="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS3.SSS2.p2.9.m1.2.2.2.2.2.3">centroid</mtext></ci></apply></list><apply id="S3.SS3.SSS2.p2.9.m1.2.2.4.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m1.2.2.4.1.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.4">superscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m1.2.2.4.2.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.4.2">ℝ</ci><ci id="S3.SS3.SSS2.p2.9.m1.2.2.4.3.cmml" xref="S3.SS3.SSS2.p2.9.m1.2.2.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.9.m1.2c">\mathbf{k}_{v},\mathbf{k}_{\textrm{centroid}}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.9.m1.2d">bold_k start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , bold_k start_POSTSUBSCRIPT centroid end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are embeddings of the item <math alttext="v" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.10.m2.1"><semantics id="S3.SS3.SSS2.p2.10.m2.1a"><mi id="S3.SS3.SSS2.p2.10.m2.1.1" xref="S3.SS3.SSS2.p2.10.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.10.m2.1b"><ci id="S3.SS3.SSS2.p2.10.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.10.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.10.m2.1d">italic_v</annotation></semantics></math> and centroid in <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.11.m3.1"><semantics id="S3.SS3.SSS2.p2.11.m3.1a"><msub id="S3.SS3.SSS2.p2.11.m3.1.1" xref="S3.SS3.SSS2.p2.11.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p2.11.m3.1.1.2" xref="S3.SS3.SSS2.p2.11.m3.1.1.2.cmml">c</mi><mi id="S3.SS3.SSS2.p2.11.m3.1.1.3" xref="S3.SS3.SSS2.p2.11.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.11.m3.1b"><apply id="S3.SS3.SSS2.p2.11.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.11.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.11.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.11.m3.1.1.2">𝑐</ci><ci id="S3.SS3.SSS2.p2.11.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.11.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.11.m3.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.11.m3.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, respectively. These embeddings can be looked up from <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.12.m4.1"><semantics id="S3.SS3.SSS2.p2.12.m4.1a"><msub id="S3.SS3.SSS2.p2.12.m4.1.1" xref="S3.SS3.SSS2.p2.12.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p2.12.m4.1.1.2" xref="S3.SS3.SSS2.p2.12.m4.1.1.2.cmml">𝐊</mi><mi id="S3.SS3.SSS2.p2.12.m4.1.1.3" xref="S3.SS3.SSS2.p2.12.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.12.m4.1b"><apply id="S3.SS3.SSS2.p2.12.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.12.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.12.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.12.m4.1.1.2">𝐊</ci><ci id="S3.SS3.SSS2.p2.12.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p2.12.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.12.m4.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.12.m4.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>.
Thus, the entire cluster <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.13.m5.1"><semantics id="S3.SS3.SSS2.p2.13.m5.1a"><msub id="S3.SS3.SSS2.p2.13.m5.1.1" xref="S3.SS3.SSS2.p2.13.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p2.13.m5.1.1.2" xref="S3.SS3.SSS2.p2.13.m5.1.1.2.cmml">c</mi><mi id="S3.SS3.SSS2.p2.13.m5.1.1.3" xref="S3.SS3.SSS2.p2.13.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.13.m5.1b"><apply id="S3.SS3.SSS2.p2.13.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.13.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.13.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p2.13.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.13.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p2.13.m5.1.1.2">𝑐</ci><ci id="S3.SS3.SSS2.p2.13.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p2.13.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.13.m5.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.13.m5.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is represented by an aggregated, virtual item feature <math alttext="\mathbf{c}_{i}=[\mathbf{c}^{(i)}_{1:N_{1}};\mathbf{c}^{(i)}_{1:N_{2}}]" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.14.m6.4"><semantics id="S3.SS3.SSS2.p2.14.m6.4a"><mrow id="S3.SS3.SSS2.p2.14.m6.4.4" xref="S3.SS3.SSS2.p2.14.m6.4.4.cmml"><msub id="S3.SS3.SSS2.p2.14.m6.4.4.4" xref="S3.SS3.SSS2.p2.14.m6.4.4.4.cmml"><mi id="S3.SS3.SSS2.p2.14.m6.4.4.4.2" xref="S3.SS3.SSS2.p2.14.m6.4.4.4.2.cmml">𝐜</mi><mi id="S3.SS3.SSS2.p2.14.m6.4.4.4.3" xref="S3.SS3.SSS2.p2.14.m6.4.4.4.3.cmml">i</mi></msub><mo id="S3.SS3.SSS2.p2.14.m6.4.4.3" xref="S3.SS3.SSS2.p2.14.m6.4.4.3.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.14.m6.4.4.2.2" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.3.cmml"><mo id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.3.cmml">[</mo><msubsup id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.2.2" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.2.2.cmml">𝐜</mi><mrow id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.cmml"><mn id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.2" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.1.cmml">:</mo><msub id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.2" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.2.cmml">N</mi><mn id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.3" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.3.cmml">1</mn></msub></mrow><mrow id="S3.SS3.SSS2.p2.14.m6.1.1.1.3" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.cmml"><mo id="S3.SS3.SSS2.p2.14.m6.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS2.p2.14.m6.1.1.1.1" xref="S3.SS3.SSS2.p2.14.m6.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS2.p2.14.m6.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.4" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.3.cmml">;</mo><msubsup id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.2.2" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.2.2.cmml">𝐜</mi><mrow id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.cmml"><mn id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.2" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.2.cmml">1</mn><mo id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.1.cmml">:</mo><msub id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.cmml"><mi id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.2" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.2.cmml">N</mi><mn id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.3" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.3.cmml">2</mn></msub></mrow><mrow id="S3.SS3.SSS2.p2.14.m6.2.2.1.3" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.cmml"><mo id="S3.SS3.SSS2.p2.14.m6.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.cmml">(</mo><mi id="S3.SS3.SSS2.p2.14.m6.2.2.1.1" xref="S3.SS3.SSS2.p2.14.m6.2.2.1.1.cmml">i</mi><mo id="S3.SS3.SSS2.p2.14.m6.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.14.m6.4b"><apply id="S3.SS3.SSS2.p2.14.m6.4.4.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4"><eq id="S3.SS3.SSS2.p2.14.m6.4.4.3.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.3"></eq><apply id="S3.SS3.SSS2.p2.14.m6.4.4.4.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m6.4.4.4.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.4">subscript</csymbol><ci id="S3.SS3.SSS2.p2.14.m6.4.4.4.2.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.4.2">𝐜</ci><ci id="S3.SS3.SSS2.p2.14.m6.4.4.4.3.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.4.3">𝑖</ci></apply><list id="S3.SS3.SSS2.p2.14.m6.4.4.2.3.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2"><apply id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.2.2">𝐜</ci><ci id="S3.SS3.SSS2.p2.14.m6.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3"><ci id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.1">:</ci><cn id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.2">1</cn><apply id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.2">𝑁</ci><cn id="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.14.m6.3.3.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.2.2">𝐜</ci><ci id="S3.SS3.SSS2.p2.14.m6.2.2.1.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.2.2.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3"><ci id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.1">:</ci><cn id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.2.cmml" type="integer" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.2">1</cn><apply id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.1.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.2.cmml" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.2">𝑁</ci><cn id="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.14.m6.4.4.2.2.2.3.3.3">2</cn></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.14.m6.4c">\mathbf{c}_{i}=[\mathbf{c}^{(i)}_{1:N_{1}};\mathbf{c}^{(i)}_{1:N_{2}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.14.m6.4d">bold_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = [ bold_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ; bold_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>.
After passing through embedding layers, each cluster’s feature is embedded into a vector, e.g., <math alttext="\mathbf{k}_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.15.m7.1"><semantics id="S3.SS3.SSS2.p2.15.m7.1a"><mrow id="S3.SS3.SSS2.p2.15.m7.1.1" xref="S3.SS3.SSS2.p2.15.m7.1.1.cmml"><msub id="S3.SS3.SSS2.p2.15.m7.1.1.2" xref="S3.SS3.SSS2.p2.15.m7.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.15.m7.1.1.2.2" xref="S3.SS3.SSS2.p2.15.m7.1.1.2.2.cmml">𝐤</mi><mi id="S3.SS3.SSS2.p2.15.m7.1.1.2.3" xref="S3.SS3.SSS2.p2.15.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS2.p2.15.m7.1.1.1" xref="S3.SS3.SSS2.p2.15.m7.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.15.m7.1.1.3" xref="S3.SS3.SSS2.p2.15.m7.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.15.m7.1.1.3.2" xref="S3.SS3.SSS2.p2.15.m7.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS2.p2.15.m7.1.1.3.3" xref="S3.SS3.SSS2.p2.15.m7.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.15.m7.1b"><apply id="S3.SS3.SSS2.p2.15.m7.1.1.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1"><in id="S3.SS3.SSS2.p2.15.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.1"></in><apply id="S3.SS3.SSS2.p2.15.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.15.m7.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.15.m7.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.2.2">𝐤</ci><ci id="S3.SS3.SSS2.p2.15.m7.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p2.15.m7.1.1.3.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.15.m7.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.15.m7.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS2.p2.15.m7.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.15.m7.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.15.m7.1c">\mathbf{k}_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.15.m7.1d">bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> for <math alttext="\mathbf{c}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.16.m8.1"><semantics id="S3.SS3.SSS2.p2.16.m8.1a"><msub id="S3.SS3.SSS2.p2.16.m8.1.1" xref="S3.SS3.SSS2.p2.16.m8.1.1.cmml"><mi id="S3.SS3.SSS2.p2.16.m8.1.1.2" xref="S3.SS3.SSS2.p2.16.m8.1.1.2.cmml">𝐜</mi><mi id="S3.SS3.SSS2.p2.16.m8.1.1.3" xref="S3.SS3.SSS2.p2.16.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.16.m8.1b"><apply id="S3.SS3.SSS2.p2.16.m8.1.1.cmml" xref="S3.SS3.SSS2.p2.16.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.16.m8.1.1.1.cmml" xref="S3.SS3.SSS2.p2.16.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.16.m8.1.1.2.cmml" xref="S3.SS3.SSS2.p2.16.m8.1.1.2">𝐜</ci><ci id="S3.SS3.SSS2.p2.16.m8.1.1.3.cmml" xref="S3.SS3.SSS2.p2.16.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.16.m8.1c">\mathbf{c}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.16.m8.1d">bold_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
The GSU and ESU modules estimate the relevance between each cluster and the target item based on these embedded vectors.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3. </span>Cluster-aware Target Attention</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.1">Following TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite>, we employ an identical efficient attention mechanism in both ESU and GSU, which take representations of clusters <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><mi id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><ci id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.1.m1.1d">italic_C</annotation></semantics></math> as input.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p2">
<p class="ltx_p" id="S3.SS3.SSS3.p2.9">Given the clustered behaviors <math alttext="C=[c_{1},c_{2},\cdots,c_{\hat{T}}]" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.1.m1.4"><semantics id="S3.SS3.SSS3.p2.1.m1.4a"><mrow id="S3.SS3.SSS3.p2.1.m1.4.4" xref="S3.SS3.SSS3.p2.1.m1.4.4.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.4.4.5" xref="S3.SS3.SSS3.p2.1.m1.4.4.5.cmml">C</mi><mo id="S3.SS3.SSS3.p2.1.m1.4.4.4" xref="S3.SS3.SSS3.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS3.p2.1.m1.4.4.3.3" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.4.cmml"><mo id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.2.cmml">c</mi><mn id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.5" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.2" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.2.cmml">c</mi><mn id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.3" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.6" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS3.SSS3.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS3.SSS3.p2.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.7" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.2" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.2.cmml">c</mi><mover accent="true" id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.2" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.2.cmml">T</mi><mo id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.1" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.1.cmml">^</mo></mover></msub><mo id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.1.m1.4b"><apply id="S3.SS3.SSS3.p2.1.m1.4.4.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4"><eq id="S3.SS3.SSS3.p2.1.m1.4.4.4.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.4"></eq><ci id="S3.SS3.SSS3.p2.1.m1.4.4.5.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.5">𝐶</ci><list id="S3.SS3.SSS3.p2.1.m1.4.4.3.4.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3"><apply id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.2">𝑐</ci><cn id="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.2">𝑐</ci><cn id="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1">⋯</ci><apply id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.2">𝑐</ci><apply id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3"><ci id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.1">^</ci><ci id="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.4.4.3.3.3.3.2">𝑇</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.1.m1.4c">C=[c_{1},c_{2},\cdots,c_{\hat{T}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.1.m1.4d">italic_C = [ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_c start_POSTSUBSCRIPT over^ start_ARG italic_T end_ARG end_POSTSUBSCRIPT ]</annotation></semantics></math>, we obtain a matrix <math alttext="\mathbf{K}\in\mathbb{R}^{\hat{T}\times d}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.2.m2.1"><semantics id="S3.SS3.SSS3.p2.2.m2.1a"><mrow id="S3.SS3.SSS3.p2.2.m2.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.1.1.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.2.cmml">𝐊</mi><mo id="S3.SS3.SSS3.p2.2.m2.1.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.2.m2.1.1.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.1.1.3.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS3.p2.2.m2.1.1.3.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.cmml"><mover accent="true" id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.2.cmml">T</mi><mo id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.1.cmml">^</mo></mover><mo id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.2.m2.1b"><apply id="S3.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1"><in id="S3.SS3.SSS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1"></in><ci id="S3.SS3.SSS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.2">𝐊</ci><apply id="S3.SS3.SSS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3"><times id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.1"></times><apply id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2"><ci id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.1">^</ci><ci id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.2.2">𝑇</ci></apply><ci id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.2.m2.1c">\mathbf{K}\in\mathbb{R}^{\hat{T}\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.2.m2.1d">bold_K ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> composed of representation vectors through the embedding layer, where <math alttext="\mathbf{k}_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.3.m3.1"><semantics id="S3.SS3.SSS3.p2.3.m3.1a"><mrow id="S3.SS3.SSS3.p2.3.m3.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.cmml"><msub id="S3.SS3.SSS3.p2.3.m3.1.1.2" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.1.1.2.2" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.2.cmml">𝐤</mi><mi id="S3.SS3.SSS3.p2.3.m3.1.1.2.3" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p2.3.m3.1.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.3.m3.1.1.3" xref="S3.SS3.SSS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.1.1.3.2" xref="S3.SS3.SSS3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS3.p2.3.m3.1.1.3.3" xref="S3.SS3.SSS3.p2.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.3.m3.1b"><apply id="S3.SS3.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1"><in id="S3.SS3.SSS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.1"></in><apply id="S3.SS3.SSS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.2">𝐤</ci><ci id="S3.SS3.SSS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.3.m3.1c">\mathbf{k}_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.3.m3.1d">bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the vector for <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.4.m4.1"><semantics id="S3.SS3.SSS3.p2.4.m4.1a"><mi id="S3.SS3.SSS3.p2.4.m4.1.1" xref="S3.SS3.SSS3.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.4.m4.1b"><ci id="S3.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.4.m4.1d">italic_i</annotation></semantics></math>-th cluster’s feature <math alttext="\mathbf{c}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.5.m5.1"><semantics id="S3.SS3.SSS3.p2.5.m5.1a"><msub id="S3.SS3.SSS3.p2.5.m5.1.1" xref="S3.SS3.SSS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSS3.p2.5.m5.1.1.2" xref="S3.SS3.SSS3.p2.5.m5.1.1.2.cmml">𝐜</mi><mi id="S3.SS3.SSS3.p2.5.m5.1.1.3" xref="S3.SS3.SSS3.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.5.m5.1b"><apply id="S3.SS3.SSS3.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1.2">𝐜</ci><ci id="S3.SS3.SSS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.5.m5.1c">\mathbf{c}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.5.m5.1d">bold_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
Then we use a target attention mechanism to measure the relevance between the target item and historical behaviors.
We initially apply the ”Behavior Feature Splits and Linear Projection” technique from TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite> to enhance the efficiency of target attention, details in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#A1.SS2" title="A.2. Behavior Feature Splits and Linear Projection ‣ Appendix A APPENDIX ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">A.2</span></a>.
This method splits item embeddings into inherent and cross parts.
<math alttext="\mathbf{q}\in\mathbb{R}^{H}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.6.m6.1"><semantics id="S3.SS3.SSS3.p2.6.m6.1a"><mrow id="S3.SS3.SSS3.p2.6.m6.1.1" xref="S3.SS3.SSS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.SSS3.p2.6.m6.1.1.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.cmml">𝐪</mi><mo id="S3.SS3.SSS3.p2.6.m6.1.1.1" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.6.m6.1.1.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.6.m6.1.1.3.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS3.p2.6.m6.1.1.3.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.3.cmml">H</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.6.m6.1b"><apply id="S3.SS3.SSS3.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1"><in id="S3.SS3.SSS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.1"></in><ci id="S3.SS3.SSS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.2">𝐪</ci><apply id="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.6.m6.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS3.p2.6.m6.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.6.m6.1c">\mathbf{q}\in\mathbb{R}^{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.6.m6.1d">bold_q ∈ blackboard_R start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the vector of the target item’s inherent features.
<math alttext="\mathbf{K}_{h}\in\mathbb{R}^{\hat{T}\times H},\mathbf{K}_{c}\in\mathbb{R}^{%
\hat{T}\times C}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.7.m7.2"><semantics id="S3.SS3.SSS3.p2.7.m7.2a"><mrow id="S3.SS3.SSS3.p2.7.m7.2.2.2" xref="S3.SS3.SSS3.p2.7.m7.2.2.3.cmml"><mrow id="S3.SS3.SSS3.p2.7.m7.1.1.1.1" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.cmml"><msub id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.2" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.2.cmml">𝐊</mi><mi id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.3" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.3.cmml">h</mi></msub><mo id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.1" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.2" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.cmml"><mover accent="true" id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.2" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.2.cmml">T</mi><mo id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.1" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.1.cmml">^</mo></mover><mo id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.3" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><mo id="S3.SS3.SSS3.p2.7.m7.2.2.2.3" xref="S3.SS3.SSS3.p2.7.m7.2.2.3a.cmml">,</mo><mrow id="S3.SS3.SSS3.p2.7.m7.2.2.2.2" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.cmml"><msub id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.2" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.2.cmml">𝐊</mi><mi id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.3" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.3.cmml">c</mi></msub><mo id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.1" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.2" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.cmml"><mover accent="true" id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.cmml"><mi id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.2" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.2.cmml">T</mi><mo id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.1" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.1.cmml">^</mo></mover><mo id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.3" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.3.cmml">C</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.7.m7.2b"><apply id="S3.SS3.SSS3.p2.7.m7.2.2.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.7.m7.2.2.3a.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1"><in id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.1"></in><apply id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.2">𝐊</ci><ci id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3"><times id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.1"></times><apply id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2"><ci id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.1">^</ci><ci id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.2.2">𝑇</ci></apply><ci id="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply><apply id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2"><in id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.1"></in><apply id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.2">𝐊</ci><ci id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.2.3">𝑐</ci></apply><apply id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.2">ℝ</ci><apply id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3"><times id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.1"></times><apply id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2"><ci id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.1.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.1">^</ci><ci id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.2.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.2.2">𝑇</ci></apply><ci id="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.3.cmml" xref="S3.SS3.SSS3.p2.7.m7.2.2.2.2.3.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.7.m7.2c">\mathbf{K}_{h}\in\mathbb{R}^{\hat{T}\times H},\mathbf{K}_{c}\in\mathbb{R}^{%
\hat{T}\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.7.m7.2d">bold_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG × italic_H end_POSTSUPERSCRIPT , bold_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> are inherent and cross embeddings of clustered behaviors respectively, where <math alttext="\mathbf{K}=[\mathbf{K}_{h},\mathbf{K}_{c}]" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.8.m8.2"><semantics id="S3.SS3.SSS3.p2.8.m8.2a"><mrow id="S3.SS3.SSS3.p2.8.m8.2.2" xref="S3.SS3.SSS3.p2.8.m8.2.2.cmml"><mi id="S3.SS3.SSS3.p2.8.m8.2.2.4" xref="S3.SS3.SSS3.p2.8.m8.2.2.4.cmml">𝐊</mi><mo id="S3.SS3.SSS3.p2.8.m8.2.2.3" xref="S3.SS3.SSS3.p2.8.m8.2.2.3.cmml">=</mo><mrow id="S3.SS3.SSS3.p2.8.m8.2.2.2.2" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.3.cmml"><mo id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.3" stretchy="false" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.3.cmml">[</mo><msub id="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1" xref="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.2" xref="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.2.cmml">𝐊</mi><mi id="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.3" xref="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.3.cmml">h</mi></msub><mo id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.4" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.2" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.2.cmml">𝐊</mi><mi id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.3" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.3.cmml">c</mi></msub><mo id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.5" stretchy="false" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.8.m8.2b"><apply id="S3.SS3.SSS3.p2.8.m8.2.2.cmml" xref="S3.SS3.SSS3.p2.8.m8.2.2"><eq id="S3.SS3.SSS3.p2.8.m8.2.2.3.cmml" xref="S3.SS3.SSS3.p2.8.m8.2.2.3"></eq><ci id="S3.SS3.SSS3.p2.8.m8.2.2.4.cmml" xref="S3.SS3.SSS3.p2.8.m8.2.2.4">𝐊</ci><interval closure="closed" id="S3.SS3.SSS3.p2.8.m8.2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.2"><apply id="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.2">𝐊</ci><ci id="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.8.m8.1.1.1.1.1.3">ℎ</ci></apply><apply id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.2">𝐊</ci><ci id="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.8.m8.2.2.2.2.2.3">𝑐</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.8.m8.2c">\mathbf{K}=[\mathbf{K}_{h},\mathbf{K}_{c}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.8.m8.2d">bold_K = [ bold_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , bold_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ]</annotation></semantics></math>.
We can calculate the relevance scores <math alttext="\boldsymbol{\alpha}\in\mathbb{R}^{\hat{T}}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.9.m9.1"><semantics id="S3.SS3.SSS3.p2.9.m9.1a"><mrow id="S3.SS3.SSS3.p2.9.m9.1.1" xref="S3.SS3.SSS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.SSS3.p2.9.m9.1.1.2" xref="S3.SS3.SSS3.p2.9.m9.1.1.2.cmml">𝜶</mi><mo id="S3.SS3.SSS3.p2.9.m9.1.1.1" xref="S3.SS3.SSS3.p2.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.9.m9.1.1.3" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.9.m9.1.1.3.2" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.2.cmml">ℝ</mi><mover accent="true" id="S3.SS3.SSS3.p2.9.m9.1.1.3.3" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.3.cmml"><mi id="S3.SS3.SSS3.p2.9.m9.1.1.3.3.2" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.3.2.cmml">T</mi><mo id="S3.SS3.SSS3.p2.9.m9.1.1.3.3.1" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.3.1.cmml">^</mo></mover></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.9.m9.1b"><apply id="S3.SS3.SSS3.p2.9.m9.1.1.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1"><in id="S3.SS3.SSS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1.1"></in><ci id="S3.SS3.SSS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1.2">𝜶</ci><apply id="S3.SS3.SSS3.p2.9.m9.1.1.3.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.9.m9.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.9.m9.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS3.p2.9.m9.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.3"><ci id="S3.SS3.SSS3.p2.9.m9.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.3.1">^</ci><ci id="S3.SS3.SSS3.p2.9.m9.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.p2.9.m9.1.1.3.3.2">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.9.m9.1c">\boldsymbol{\alpha}\in\mathbb{R}^{\hat{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.9.m9.1d">bold_italic_α ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math> between the target item and clustered behaviors as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{\alpha}=\frac{(\mathbf{K}_{h}\mathbf{W}^{h})(\mathbf{q}^{\top}%
\mathbf{W}^{q})^{\top}}{\sqrt{d}_{k}}+(\mathbf{K}_{c}\mathbf{W}^{c})%
\boldsymbol{\beta}," class="ltx_Math" display="block" id="S3.E8.m1.3"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.3" xref="S3.E8.m1.3.3.1.1.3.cmml">𝜶</mi><mo id="S3.E8.m1.3.3.1.1.2" xref="S3.E8.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.3.3.1.1.1" xref="S3.E8.m1.3.3.1.1.1.cmml"><mfrac id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><mrow id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml"><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.1.1.2.2.cmml">𝐊</mi><mi id="S3.E8.m1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.1.1.2.3.cmml">h</mi></msub><mo id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mi id="S3.E8.m1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.cmml">h</mi></msup></mrow><mo id="S3.E8.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">⁢</mo><msup id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml"><mrow id="S3.E8.m1.2.2.2.2.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.E8.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.2.2.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.cmml"><msup id="S3.E8.m1.2.2.2.2.1.1.1.2" xref="S3.E8.m1.2.2.2.2.1.1.1.2.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.1.2.2" xref="S3.E8.m1.2.2.2.2.1.1.1.2.2.cmml">𝐪</mi><mo id="S3.E8.m1.2.2.2.2.1.1.1.2.3" xref="S3.E8.m1.2.2.2.2.1.1.1.2.3.cmml">⊤</mo></msup><mo id="S3.E8.m1.2.2.2.2.1.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S3.E8.m1.2.2.2.2.1.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.1.3.2" xref="S3.E8.m1.2.2.2.2.1.1.1.3.2.cmml">𝐖</mi><mi id="S3.E8.m1.2.2.2.2.1.1.1.3.3" xref="S3.E8.m1.2.2.2.2.1.1.1.3.3.cmml">q</mi></msup></mrow><mo id="S3.E8.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.2.2.2.2.3" xref="S3.E8.m1.2.2.2.2.3.cmml">⊤</mo></msup></mrow><msub id="S3.E8.m1.2.2.4" xref="S3.E8.m1.2.2.4.cmml"><msqrt id="S3.E8.m1.2.2.4.2" xref="S3.E8.m1.2.2.4.2.cmml"><mi id="S3.E8.m1.2.2.4.2.2" xref="S3.E8.m1.2.2.4.2.2.cmml">d</mi></msqrt><mi id="S3.E8.m1.2.2.4.3" xref="S3.E8.m1.2.2.4.3.cmml">k</mi></msub></mfrac><mo id="S3.E8.m1.3.3.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.2.cmml">+</mo><mrow id="S3.E8.m1.3.3.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">𝐊</mi><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">c</mi></msup></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E8.m1.3.3.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.3.cmml">𝜷</mi></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.2" xref="S3.E8.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1"><eq id="S3.E8.m1.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2"></eq><ci id="S3.E8.m1.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.3">𝜶</ci><apply id="S3.E8.m1.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1"><plus id="S3.E8.m1.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.2"></plus><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><divide id="S3.E8.m1.2.2.3.cmml" xref="S3.E8.m1.2.2"></divide><apply id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"><times id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.3"></times><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"></times><apply id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2.2">𝐊</ci><ci id="S3.E8.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2">𝐖</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply><apply id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">superscript</csymbol><apply id="S3.E8.m1.2.2.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1"><times id="S3.E8.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1"></times><apply id="S3.E8.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S3.E8.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.2.2">𝐪</ci><csymbol cd="latexml" id="S3.E8.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.2.3">top</csymbol></apply><apply id="S3.E8.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.3.2">𝐖</ci><ci id="S3.E8.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.3.3">𝑞</ci></apply></apply><csymbol cd="latexml" id="S3.E8.m1.2.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.2.3">top</csymbol></apply></apply><apply id="S3.E8.m1.2.2.4.cmml" xref="S3.E8.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.4.1.cmml" xref="S3.E8.m1.2.2.4">subscript</csymbol><apply id="S3.E8.m1.2.2.4.2.cmml" xref="S3.E8.m1.2.2.4.2"><root id="S3.E8.m1.2.2.4.2a.cmml" xref="S3.E8.m1.2.2.4.2"></root><ci id="S3.E8.m1.2.2.4.2.2.cmml" xref="S3.E8.m1.2.2.4.2.2">𝑑</ci></apply><ci id="S3.E8.m1.2.2.4.3.cmml" xref="S3.E8.m1.2.2.4.3">𝑘</ci></apply></apply><apply id="S3.E8.m1.3.3.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1"><times id="S3.E8.m1.3.3.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2"></times><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1"><times id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1"></times><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.2">𝐊</ci><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.2">𝐖</ci><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply><ci id="S3.E8.m1.3.3.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3">𝜷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\boldsymbol{\alpha}=\frac{(\mathbf{K}_{h}\mathbf{W}^{h})(\mathbf{q}^{\top}%
\mathbf{W}^{q})^{\top}}{\sqrt{d}_{k}}+(\mathbf{K}_{c}\mathbf{W}^{c})%
\boldsymbol{\beta},</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.3d">bold_italic_α = divide start_ARG ( bold_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ) ( bold_q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_W start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG + ( bold_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ) bold_italic_β ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p2.13">where <math alttext="\mathbf{W}^{h},\mathbf{W}^{q},\mathbf{W}^{c}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.10.m1.3"><semantics id="S3.SS3.SSS3.p2.10.m1.3a"><mrow id="S3.SS3.SSS3.p2.10.m1.3.3.3" xref="S3.SS3.SSS3.p2.10.m1.3.3.4.cmml"><msup id="S3.SS3.SSS3.p2.10.m1.1.1.1.1" xref="S3.SS3.SSS3.p2.10.m1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.10.m1.1.1.1.1.2" xref="S3.SS3.SSS3.p2.10.m1.1.1.1.1.2.cmml">𝐖</mi><mi id="S3.SS3.SSS3.p2.10.m1.1.1.1.1.3" xref="S3.SS3.SSS3.p2.10.m1.1.1.1.1.3.cmml">h</mi></msup><mo id="S3.SS3.SSS3.p2.10.m1.3.3.3.4" xref="S3.SS3.SSS3.p2.10.m1.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS3.p2.10.m1.2.2.2.2" xref="S3.SS3.SSS3.p2.10.m1.2.2.2.2.cmml"><mi id="S3.SS3.SSS3.p2.10.m1.2.2.2.2.2" xref="S3.SS3.SSS3.p2.10.m1.2.2.2.2.2.cmml">𝐖</mi><mi id="S3.SS3.SSS3.p2.10.m1.2.2.2.2.3" xref="S3.SS3.SSS3.p2.10.m1.2.2.2.2.3.cmml">q</mi></msup><mo id="S3.SS3.SSS3.p2.10.m1.3.3.3.5" xref="S3.SS3.SSS3.p2.10.m1.3.3.4.cmml">,</mo><msup id="S3.SS3.SSS3.p2.10.m1.3.3.3.3" xref="S3.SS3.SSS3.p2.10.m1.3.3.3.3.cmml"><mi id="S3.SS3.SSS3.p2.10.m1.3.3.3.3.2" xref="S3.SS3.SSS3.p2.10.m1.3.3.3.3.2.cmml">𝐖</mi><mi id="S3.SS3.SSS3.p2.10.m1.3.3.3.3.3" xref="S3.SS3.SSS3.p2.10.m1.3.3.3.3.3.cmml">c</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.10.m1.3b"><list id="S3.SS3.SSS3.p2.10.m1.3.3.4.cmml" xref="S3.SS3.SSS3.p2.10.m1.3.3.3"><apply id="S3.SS3.SSS3.p2.10.m1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.10.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.10.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.10.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.10.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.10.m1.1.1.1.1.2">𝐖</ci><ci id="S3.SS3.SSS3.p2.10.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.10.m1.1.1.1.1.3">ℎ</ci></apply><apply id="S3.SS3.SSS3.p2.10.m1.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.10.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.10.m1.2.2.2.2.1.cmml" xref="S3.SS3.SSS3.p2.10.m1.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS3.p2.10.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.10.m1.2.2.2.2.2">𝐖</ci><ci id="S3.SS3.SSS3.p2.10.m1.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.10.m1.2.2.2.2.3">𝑞</ci></apply><apply id="S3.SS3.SSS3.p2.10.m1.3.3.3.3.cmml" xref="S3.SS3.SSS3.p2.10.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.10.m1.3.3.3.3.1.cmml" xref="S3.SS3.SSS3.p2.10.m1.3.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.10.m1.3.3.3.3.2.cmml" xref="S3.SS3.SSS3.p2.10.m1.3.3.3.3.2">𝐖</ci><ci id="S3.SS3.SSS3.p2.10.m1.3.3.3.3.3.cmml" xref="S3.SS3.SSS3.p2.10.m1.3.3.3.3.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.10.m1.3c">\mathbf{W}^{h},\mathbf{W}^{q},\mathbf{W}^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.10.m1.3d">bold_W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT , bold_W start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , bold_W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> are linear projections, <math alttext="d_{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.11.m2.1"><semantics id="S3.SS3.SSS3.p2.11.m2.1a"><msub id="S3.SS3.SSS3.p2.11.m2.1.1" xref="S3.SS3.SSS3.p2.11.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p2.11.m2.1.1.2" xref="S3.SS3.SSS3.p2.11.m2.1.1.2.cmml">d</mi><mi id="S3.SS3.SSS3.p2.11.m2.1.1.3" xref="S3.SS3.SSS3.p2.11.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.11.m2.1b"><apply id="S3.SS3.SSS3.p2.11.m2.1.1.cmml" xref="S3.SS3.SSS3.p2.11.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.11.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.11.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.11.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p2.11.m2.1.1.2">𝑑</ci><ci id="S3.SS3.SSS3.p2.11.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p2.11.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.11.m2.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.11.m2.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the projected dimension, and <math alttext="\boldsymbol{\beta}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.12.m3.1"><semantics id="S3.SS3.SSS3.p2.12.m3.1a"><mi id="S3.SS3.SSS3.p2.12.m3.1.1" xref="S3.SS3.SSS3.p2.12.m3.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.12.m3.1b"><ci id="S3.SS3.SSS3.p2.12.m3.1.1.cmml" xref="S3.SS3.SSS3.p2.12.m3.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.12.m3.1c">\boldsymbol{\beta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.12.m3.1d">bold_italic_β</annotation></semantics></math> is a learnable cross feature weight.
The <math alttext="\boldsymbol{\alpha}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.13.m4.1"><semantics id="S3.SS3.SSS3.p2.13.m4.1a"><mi id="S3.SS3.SSS3.p2.13.m4.1.1" xref="S3.SS3.SSS3.p2.13.m4.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.13.m4.1b"><ci id="S3.SS3.SSS3.p2.13.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.13.m4.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.13.m4.1c">\boldsymbol{\alpha}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.13.m4.1d">bold_italic_α</annotation></semantics></math> inadequately represents the relationship between clusters and the target item, due to varying item counts in clusters.
Assuming two clusters have the same relevance, the cluster with more items should be considered more important, as more items imply a stronger user preference.
Thus, we adjust the relevance scores according to the cluster size:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{\alpha}^{\prime}=\boldsymbol{\alpha}+\ln{\mathbf{n}}," class="ltx_Math" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><msup id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.2.2.cmml">𝜶</mi><mo id="S3.E9.m1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml">𝜶</mi><mo id="S3.E9.m1.1.1.1.1.3.1" xref="S3.E9.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.3.1" xref="S3.E9.m1.1.1.1.1.3.3.1.cmml">ln</mi><mo id="S3.E9.m1.1.1.1.1.3.3a" lspace="0.167em" xref="S3.E9.m1.1.1.1.1.3.3.cmml">⁡</mo><mi id="S3.E9.m1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.3.3.2.cmml">𝐧</mi></mrow></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"></eq><apply id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.2">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.2.2">𝜶</ci><ci id="S3.E9.m1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.2.3">′</ci></apply><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><plus id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.1"></plus><ci id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2">𝜶</ci><apply id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3"><ln id="S3.E9.m1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3.1"></ln><ci id="S3.E9.m1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.2">𝐧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\boldsymbol{\alpha}^{\prime}=\boldsymbol{\alpha}+\ln{\mathbf{n}},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">bold_italic_α start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = bold_italic_α + roman_ln bold_n ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p2.17">where <math alttext="\mathbf{n}\in\mathbb{N}^{\hat{T}}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.14.m1.1"><semantics id="S3.SS3.SSS3.p2.14.m1.1a"><mrow id="S3.SS3.SSS3.p2.14.m1.1.1" xref="S3.SS3.SSS3.p2.14.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.14.m1.1.1.2" xref="S3.SS3.SSS3.p2.14.m1.1.1.2.cmml">𝐧</mi><mo id="S3.SS3.SSS3.p2.14.m1.1.1.1" xref="S3.SS3.SSS3.p2.14.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.14.m1.1.1.3" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.14.m1.1.1.3.2" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.2.cmml">ℕ</mi><mover accent="true" id="S3.SS3.SSS3.p2.14.m1.1.1.3.3" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS3.p2.14.m1.1.1.3.3.2" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.3.2.cmml">T</mi><mo id="S3.SS3.SSS3.p2.14.m1.1.1.3.3.1" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.3.1.cmml">^</mo></mover></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.14.m1.1b"><apply id="S3.SS3.SSS3.p2.14.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1"><in id="S3.SS3.SSS3.p2.14.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1.1"></in><ci id="S3.SS3.SSS3.p2.14.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1.2">𝐧</ci><apply id="S3.SS3.SSS3.p2.14.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.14.m1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.14.m1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.2">ℕ</ci><apply id="S3.SS3.SSS3.p2.14.m1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.3"><ci id="S3.SS3.SSS3.p2.14.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.3.1">^</ci><ci id="S3.SS3.SSS3.p2.14.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.p2.14.m1.1.1.3.3.2">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.14.m1.1c">\mathbf{n}\in\mathbb{N}^{\hat{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.14.m1.1d">bold_n ∈ blackboard_N start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math> denote the size of all clusters in <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.15.m2.1"><semantics id="S3.SS3.SSS3.p2.15.m2.1a"><mi id="S3.SS3.SSS3.p2.15.m2.1.1" xref="S3.SS3.SSS3.p2.15.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.15.m2.1b"><ci id="S3.SS3.SSS3.p2.15.m2.1.1.cmml" xref="S3.SS3.SSS3.p2.15.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.15.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.15.m2.1d">italic_C</annotation></semantics></math>. Each element <math alttext="n_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.16.m3.1"><semantics id="S3.SS3.SSS3.p2.16.m3.1a"><msub id="S3.SS3.SSS3.p2.16.m3.1.1" xref="S3.SS3.SSS3.p2.16.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p2.16.m3.1.1.2" xref="S3.SS3.SSS3.p2.16.m3.1.1.2.cmml">n</mi><mi id="S3.SS3.SSS3.p2.16.m3.1.1.3" xref="S3.SS3.SSS3.p2.16.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.16.m3.1b"><apply id="S3.SS3.SSS3.p2.16.m3.1.1.cmml" xref="S3.SS3.SSS3.p2.16.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.16.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p2.16.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.16.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p2.16.m3.1.1.2">𝑛</ci><ci id="S3.SS3.SSS3.p2.16.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p2.16.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.16.m3.1c">n_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.16.m3.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> means the cluster size of <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.17.m4.1"><semantics id="S3.SS3.SSS3.p2.17.m4.1a"><msub id="S3.SS3.SSS3.p2.17.m4.1.1" xref="S3.SS3.SSS3.p2.17.m4.1.1.cmml"><mi id="S3.SS3.SSS3.p2.17.m4.1.1.2" xref="S3.SS3.SSS3.p2.17.m4.1.1.2.cmml">c</mi><mi id="S3.SS3.SSS3.p2.17.m4.1.1.3" xref="S3.SS3.SSS3.p2.17.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.17.m4.1b"><apply id="S3.SS3.SSS3.p2.17.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.17.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.17.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p2.17.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.17.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p2.17.m4.1.1.2">𝑐</ci><ci id="S3.SS3.SSS3.p2.17.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p2.17.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.17.m4.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.17.m4.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p3">
<p class="ltx_p" id="S3.SS3.SSS3.p3.3">During the GSU stage, we use <math alttext="\boldsymbol{\alpha}^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.1.m1.1"><semantics id="S3.SS3.SSS3.p3.1.m1.1a"><msup id="S3.SS3.SSS3.p3.1.m1.1.1" xref="S3.SS3.SSS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p3.1.m1.1.1.2" xref="S3.SS3.SSS3.p3.1.m1.1.1.2.cmml">𝜶</mi><mo id="S3.SS3.SSS3.p3.1.m1.1.1.3" xref="S3.SS3.SSS3.p3.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.1.m1.1b"><apply id="S3.SS3.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.1.m1.1.1.2">𝜶</ci><ci id="S3.SS3.SSS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.1.m1.1c">\boldsymbol{\alpha}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.1.m1.1d">bold_italic_α start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> to select the top <math alttext="100" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.2.m2.1"><semantics id="S3.SS3.SSS3.p3.2.m2.1a"><mn id="S3.SS3.SSS3.p3.2.m2.1.1" xref="S3.SS3.SSS3.p3.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.2.m2.1b"><cn id="S3.SS3.SSS3.p3.2.m2.1.1.cmml" type="integer" xref="S3.SS3.SSS3.p3.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.2.m2.1c">100</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.2.m2.1d">100</annotation></semantics></math> clusters with the highest relevance scores from the clustered behaviors of length <math alttext="\hat{T}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.3.m3.1"><semantics id="S3.SS3.SSS3.p3.3.m3.1a"><mover accent="true" id="S3.SS3.SSS3.p3.3.m3.1.1" xref="S3.SS3.SSS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p3.3.m3.1.1.2" xref="S3.SS3.SSS3.p3.3.m3.1.1.2.cmml">T</mi><mo id="S3.SS3.SSS3.p3.3.m3.1.1.1" xref="S3.SS3.SSS3.p3.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.3.m3.1b"><apply id="S3.SS3.SSS3.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1"><ci id="S3.SS3.SSS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.1">^</ci><ci id="S3.SS3.SSS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.2">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.3.m3.1c">\hat{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.3.m3.1d">over^ start_ARG italic_T end_ARG</annotation></semantics></math>.
Then, these 100 clusters are input into the ESU, where they are aggregated based on relevance scores, resulting in a representation of the user’s long-term interests:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{Attention}(\mathbf{q}^{\top}\mathbf{W}^{q},\mathbf{K}_{h}\mathbf{W}^{h%
},\mathbf{K}_{c}\mathbf{W}^{c},\mathbf{K}\mathbf{W}^{v})=\text{Softmax}(%
\boldsymbol{\alpha}^{\prime})^{\top}\mathbf{K}\mathbf{W}^{v},\\
" class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1.4" xref="S3.E10.m1.1.1.1.1.4.cmml"><mtext id="S3.E10.m1.1.1.1.1.4.6" xref="S3.E10.m1.1.1.1.1.4.6a.cmml">Attention</mtext><mo id="S3.E10.m1.1.1.1.1.4.5" xref="S3.E10.m1.1.1.1.1.4.5.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.4.4.4" xref="S3.E10.m1.1.1.1.1.4.4.5.cmml"><mo id="S3.E10.m1.1.1.1.1.4.4.4.5" stretchy="false" xref="S3.E10.m1.1.1.1.1.4.4.5.cmml">(</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E10.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐪</mi><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msup><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S3.E10.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml">q</mi></msup></mrow><mo id="S3.E10.m1.1.1.1.1.4.4.4.6" xref="S3.E10.m1.1.1.1.1.4.4.5.cmml">,</mo><mrow id="S3.E10.m1.1.1.1.1.2.2.2.2" xref="S3.E10.m1.1.1.1.1.2.2.2.2.cmml"><msub id="S3.E10.m1.1.1.1.1.2.2.2.2.2" xref="S3.E10.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E10.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E10.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝐊</mi><mi id="S3.E10.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E10.m1.1.1.1.1.2.2.2.2.2.3.cmml">h</mi></msub><mo id="S3.E10.m1.1.1.1.1.2.2.2.2.1" xref="S3.E10.m1.1.1.1.1.2.2.2.2.1.cmml">⁢</mo><msup id="S3.E10.m1.1.1.1.1.2.2.2.2.3" xref="S3.E10.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E10.m1.1.1.1.1.2.2.2.2.3.2.cmml">𝐖</mi><mi id="S3.E10.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E10.m1.1.1.1.1.2.2.2.2.3.3.cmml">h</mi></msup></mrow><mo id="S3.E10.m1.1.1.1.1.4.4.4.7" xref="S3.E10.m1.1.1.1.1.4.4.5.cmml">,</mo><mrow id="S3.E10.m1.1.1.1.1.3.3.3.3" xref="S3.E10.m1.1.1.1.1.3.3.3.3.cmml"><msub id="S3.E10.m1.1.1.1.1.3.3.3.3.2" xref="S3.E10.m1.1.1.1.1.3.3.3.3.2.cmml"><mi id="S3.E10.m1.1.1.1.1.3.3.3.3.2.2" xref="S3.E10.m1.1.1.1.1.3.3.3.3.2.2.cmml">𝐊</mi><mi id="S3.E10.m1.1.1.1.1.3.3.3.3.2.3" xref="S3.E10.m1.1.1.1.1.3.3.3.3.2.3.cmml">c</mi></msub><mo id="S3.E10.m1.1.1.1.1.3.3.3.3.1" xref="S3.E10.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><msup id="S3.E10.m1.1.1.1.1.3.3.3.3.3" xref="S3.E10.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.3.3.3.3.2" xref="S3.E10.m1.1.1.1.1.3.3.3.3.3.2.cmml">𝐖</mi><mi id="S3.E10.m1.1.1.1.1.3.3.3.3.3.3" xref="S3.E10.m1.1.1.1.1.3.3.3.3.3.3.cmml">c</mi></msup></mrow><mo id="S3.E10.m1.1.1.1.1.4.4.4.8" xref="S3.E10.m1.1.1.1.1.4.4.5.cmml">,</mo><msup id="S3.E10.m1.1.1.1.1.4.4.4.4" xref="S3.E10.m1.1.1.1.1.4.4.4.4.cmml"><mi id="S3.E10.m1.1.1.1.1.4.4.4.4.2" xref="S3.E10.m1.1.1.1.1.4.4.4.4.2.cmml">𝐊𝐖</mi><mi id="S3.E10.m1.1.1.1.1.4.4.4.4.3" xref="S3.E10.m1.1.1.1.1.4.4.4.4.3.cmml">v</mi></msup><mo id="S3.E10.m1.1.1.1.1.4.4.4.9" stretchy="false" xref="S3.E10.m1.1.1.1.1.4.4.5.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.6" xref="S3.E10.m1.1.1.1.1.6.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.5" xref="S3.E10.m1.1.1.1.1.5.cmml"><mtext id="S3.E10.m1.1.1.1.1.5.3" xref="S3.E10.m1.1.1.1.1.5.3a.cmml">Softmax</mtext><mo id="S3.E10.m1.1.1.1.1.5.2" xref="S3.E10.m1.1.1.1.1.5.2.cmml">⁢</mo><msup id="S3.E10.m1.1.1.1.1.5.1" xref="S3.E10.m1.1.1.1.1.5.1.cmml"><mrow id="S3.E10.m1.1.1.1.1.5.1.1.1" xref="S3.E10.m1.1.1.1.1.5.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.5.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.5.1.1.1.1.cmml">(</mo><msup id="S3.E10.m1.1.1.1.1.5.1.1.1.1" xref="S3.E10.m1.1.1.1.1.5.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.5.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.5.1.1.1.1.2.cmml">𝜶</mi><mo id="S3.E10.m1.1.1.1.1.5.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.5.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E10.m1.1.1.1.1.5.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.5.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E10.m1.1.1.1.1.5.1.3" xref="S3.E10.m1.1.1.1.1.5.1.3.cmml">⊤</mo></msup><mo id="S3.E10.m1.1.1.1.1.5.2a" xref="S3.E10.m1.1.1.1.1.5.2.cmml">⁢</mo><msup id="S3.E10.m1.1.1.1.1.5.4" xref="S3.E10.m1.1.1.1.1.5.4.cmml"><mi id="S3.E10.m1.1.1.1.1.5.4.2" xref="S3.E10.m1.1.1.1.1.5.4.2.cmml">𝐊𝐖</mi><mi id="S3.E10.m1.1.1.1.1.5.4.3" xref="S3.E10.m1.1.1.1.1.5.4.3.cmml">v</mi></msup></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.6.cmml" xref="S3.E10.m1.1.1.1.1.6"></eq><apply id="S3.E10.m1.1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.1.4"><times id="S3.E10.m1.1.1.1.1.4.5.cmml" xref="S3.E10.m1.1.1.1.1.4.5"></times><ci id="S3.E10.m1.1.1.1.1.4.6a.cmml" xref="S3.E10.m1.1.1.1.1.4.6"><mtext id="S3.E10.m1.1.1.1.1.4.6.cmml" xref="S3.E10.m1.1.1.1.1.4.6">Attention</mtext></ci><vector id="S3.E10.m1.1.1.1.1.4.4.5.cmml" xref="S3.E10.m1.1.1.1.1.4.4.4"><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.2">𝐪</ci><csymbol cd="latexml" id="S3.E10.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.2">𝐖</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S3.E10.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2"><times id="S3.E10.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.1"></times><apply id="S3.E10.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.2.2">𝐊</ci><ci id="S3.E10.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.2.3">ℎ</ci></apply><apply id="S3.E10.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.3.2">𝐖</ci><ci id="S3.E10.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2.2.3.3">ℎ</ci></apply></apply><apply id="S3.E10.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3"><times id="S3.E10.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.1"></times><apply id="S3.E10.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.2.2">𝐊</ci><ci id="S3.E10.m1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.2.3">𝑐</ci></apply><apply id="S3.E10.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.3.2">𝐖</ci><ci id="S3.E10.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3.3.3">𝑐</ci></apply></apply><apply id="S3.E10.m1.1.1.1.1.4.4.4.4.cmml" xref="S3.E10.m1.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.4.4.4.4.1.cmml" xref="S3.E10.m1.1.1.1.1.4.4.4.4">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.4.4.4.4.2.cmml" xref="S3.E10.m1.1.1.1.1.4.4.4.4.2">𝐊𝐖</ci><ci id="S3.E10.m1.1.1.1.1.4.4.4.4.3.cmml" xref="S3.E10.m1.1.1.1.1.4.4.4.4.3">𝑣</ci></apply></vector></apply><apply id="S3.E10.m1.1.1.1.1.5.cmml" xref="S3.E10.m1.1.1.1.1.5"><times id="S3.E10.m1.1.1.1.1.5.2.cmml" xref="S3.E10.m1.1.1.1.1.5.2"></times><ci id="S3.E10.m1.1.1.1.1.5.3a.cmml" xref="S3.E10.m1.1.1.1.1.5.3"><mtext id="S3.E10.m1.1.1.1.1.5.3.cmml" xref="S3.E10.m1.1.1.1.1.5.3">Softmax</mtext></ci><apply id="S3.E10.m1.1.1.1.1.5.1.cmml" xref="S3.E10.m1.1.1.1.1.5.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.5.1.2.cmml" xref="S3.E10.m1.1.1.1.1.5.1">superscript</csymbol><apply id="S3.E10.m1.1.1.1.1.5.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.5.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.5.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.5.1.1.1">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.5.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.5.1.1.1.1.2">𝜶</ci><ci id="S3.E10.m1.1.1.1.1.5.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.5.1.1.1.1.3">′</ci></apply><csymbol cd="latexml" id="S3.E10.m1.1.1.1.1.5.1.3.cmml" xref="S3.E10.m1.1.1.1.1.5.1.3">top</csymbol></apply><apply id="S3.E10.m1.1.1.1.1.5.4.cmml" xref="S3.E10.m1.1.1.1.1.5.4"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.5.4.1.cmml" xref="S3.E10.m1.1.1.1.1.5.4">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.5.4.2.cmml" xref="S3.E10.m1.1.1.1.1.5.4.2">𝐊𝐖</ci><ci id="S3.E10.m1.1.1.1.1.5.4.3.cmml" xref="S3.E10.m1.1.1.1.1.5.4.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\textrm{Attention}(\mathbf{q}^{\top}\mathbf{W}^{q},\mathbf{K}_{h}\mathbf{W}^{h%
},\mathbf{K}_{c}\mathbf{W}^{c},\mathbf{K}\mathbf{W}^{v})=\text{Softmax}(%
\boldsymbol{\alpha}^{\prime})^{\top}\mathbf{K}\mathbf{W}^{v},\\
</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">Attention ( bold_q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_W start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , bold_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT , bold_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT , bold_KW start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT ) = Softmax ( bold_italic_α start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_KW start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p3.6">where <math alttext="\textbf{W}^{v}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.4.m1.1"><semantics id="S3.SS3.SSS3.p3.4.m1.1a"><msup id="S3.SS3.SSS3.p3.4.m1.1.1" xref="S3.SS3.SSS3.p3.4.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p3.4.m1.1.1.2" xref="S3.SS3.SSS3.p3.4.m1.1.1.2a.cmml">W</mtext><mi id="S3.SS3.SSS3.p3.4.m1.1.1.3" xref="S3.SS3.SSS3.p3.4.m1.1.1.3.cmml">v</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.4.m1.1b"><apply id="S3.SS3.SSS3.p3.4.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.4.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.4.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p3.4.m1.1.1.2a.cmml" xref="S3.SS3.SSS3.p3.4.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS3.p3.4.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.4.m1.1.1.2">W</mtext></ci><ci id="S3.SS3.SSS3.p3.4.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.4.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.4.m1.1c">\textbf{W}^{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.4.m1.1d">W start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT</annotation></semantics></math> is a projection matrix and the notations in this equation are slightly abused for simplicity by setting <math alttext="\hat{T}=100" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.5.m2.1"><semantics id="S3.SS3.SSS3.p3.5.m2.1a"><mrow id="S3.SS3.SSS3.p3.5.m2.1.1" xref="S3.SS3.SSS3.p3.5.m2.1.1.cmml"><mover accent="true" id="S3.SS3.SSS3.p3.5.m2.1.1.2" xref="S3.SS3.SSS3.p3.5.m2.1.1.2.cmml"><mi id="S3.SS3.SSS3.p3.5.m2.1.1.2.2" xref="S3.SS3.SSS3.p3.5.m2.1.1.2.2.cmml">T</mi><mo id="S3.SS3.SSS3.p3.5.m2.1.1.2.1" xref="S3.SS3.SSS3.p3.5.m2.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS3.SSS3.p3.5.m2.1.1.1" xref="S3.SS3.SSS3.p3.5.m2.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS3.p3.5.m2.1.1.3" xref="S3.SS3.SSS3.p3.5.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.5.m2.1b"><apply id="S3.SS3.SSS3.p3.5.m2.1.1.cmml" xref="S3.SS3.SSS3.p3.5.m2.1.1"><eq id="S3.SS3.SSS3.p3.5.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p3.5.m2.1.1.1"></eq><apply id="S3.SS3.SSS3.p3.5.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p3.5.m2.1.1.2"><ci id="S3.SS3.SSS3.p3.5.m2.1.1.2.1.cmml" xref="S3.SS3.SSS3.p3.5.m2.1.1.2.1">^</ci><ci id="S3.SS3.SSS3.p3.5.m2.1.1.2.2.cmml" xref="S3.SS3.SSS3.p3.5.m2.1.1.2.2">𝑇</ci></apply><cn id="S3.SS3.SSS3.p3.5.m2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p3.5.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.5.m2.1c">\hat{T}=100</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.5.m2.1d">over^ start_ARG italic_T end_ARG = 100</annotation></semantics></math> for the ESU stage.
Please note that the <math alttext="\text{Softmax}(\boldsymbol{\alpha}^{\prime})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.6.m3.1"><semantics id="S3.SS3.SSS3.p3.6.m3.1a"><mrow id="S3.SS3.SSS3.p3.6.m3.1.1" xref="S3.SS3.SSS3.p3.6.m3.1.1.cmml"><mtext id="S3.SS3.SSS3.p3.6.m3.1.1.3" xref="S3.SS3.SSS3.p3.6.m3.1.1.3a.cmml">Softmax</mtext><mo id="S3.SS3.SSS3.p3.6.m3.1.1.2" xref="S3.SS3.SSS3.p3.6.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p3.6.m3.1.1.1.1" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.2" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.2.cmml">𝜶</mi><mo id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.3" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.6.m3.1b"><apply id="S3.SS3.SSS3.p3.6.m3.1.1.cmml" xref="S3.SS3.SSS3.p3.6.m3.1.1"><times id="S3.SS3.SSS3.p3.6.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p3.6.m3.1.1.2"></times><ci id="S3.SS3.SSS3.p3.6.m3.1.1.3a.cmml" xref="S3.SS3.SSS3.p3.6.m3.1.1.3"><mtext id="S3.SS3.SSS3.p3.6.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p3.6.m3.1.1.3">Softmax</mtext></ci><apply id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.2">𝜶</ci><ci id="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.6.m3.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.6.m3.1c">\text{Softmax}(\boldsymbol{\alpha}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.6.m3.1d">Softmax ( bold_italic_α start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> can be written as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Softmax}(\boldsymbol{\alpha}^{\prime})=\sum_{i=1}^{\hat{T}}\frac{n_{i}%
\cdot\exp{\alpha_{i}}}{\Sigma_{j=1}^{\hat{T}}n_{j}\cdot\exp{\alpha_{j}}}," class="ltx_Math" display="block" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.3a.cmml">Softmax</mtext><mo id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex1.m1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml">𝜶</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.2" rspace="0.111em" xref="S3.Ex1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml"><munderover id="S3.Ex1.m1.1.1.1.1.3.1" xref="S3.Ex1.m1.1.1.1.1.3.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.Ex1.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.1.1.1.1.3.1.2.3" xref="S3.Ex1.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.1.2.3.2" xref="S3.Ex1.m1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.1.1.1.1.3.1.2.3.1" xref="S3.Ex1.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.1.1.1.1.3.1.2.3.3" xref="S3.Ex1.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mover accent="true" id="S3.Ex1.m1.1.1.1.1.3.1.3" xref="S3.Ex1.m1.1.1.1.1.3.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.1.3.2" xref="S3.Ex1.m1.1.1.1.1.3.1.3.2.cmml">T</mi><mo id="S3.Ex1.m1.1.1.1.1.3.1.3.1" xref="S3.Ex1.m1.1.1.1.1.3.1.3.1.cmml">^</mo></mover></munderover><mfrac id="S3.Ex1.m1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.3.2.2" xref="S3.Ex1.m1.1.1.1.1.3.2.2.cmml"><msub id="S3.Ex1.m1.1.1.1.1.3.2.2.2" xref="S3.Ex1.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.2.2.2" xref="S3.Ex1.m1.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S3.Ex1.m1.1.1.1.1.3.2.2.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1.m1.1.1.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.1.1.1.1.3.2.2.1.cmml">⋅</mo><mrow id="S3.Ex1.m1.1.1.1.1.3.2.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.2.3.1" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.1.cmml">exp</mi><mo id="S3.Ex1.m1.1.1.1.1.3.2.2.3a" lspace="0.167em" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.cmml">⁡</mo><msub id="S3.Ex1.m1.1.1.1.1.3.2.2.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.2" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.2.cmml">α</mi><mi id="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.3.cmml">i</mi></msub></mrow></mrow><mrow id="S3.Ex1.m1.1.1.1.1.3.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.3.2.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.cmml"><msubsup id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.2" mathvariant="normal" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.2.cmml">Σ</mi><mrow id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.2.cmml">j</mi><mo id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.1" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.3.cmml">1</mn></mrow><mover accent="true" id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.2.cmml">T</mi><mo id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.1" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.1.cmml">^</mo></mover></msubsup><mo id="S3.Ex1.m1.1.1.1.1.3.2.3.2.1" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.1.cmml">⁢</mo><msub id="S3.Ex1.m1.1.1.1.1.3.2.3.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.2.cmml">n</mi><mi id="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1.m1.1.1.1.1.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.1.1.1.1.3.2.3.1.cmml">⋅</mo><mrow id="S3.Ex1.m1.1.1.1.1.3.2.3.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.3.3.1" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.1.cmml">exp</mi><mo id="S3.Ex1.m1.1.1.1.1.3.2.3.3a" lspace="0.167em" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.cmml">⁡</mo><msub id="S3.Ex1.m1.1.1.1.1.3.2.3.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.2" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.2.cmml">α</mi><mi id="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.3.cmml">j</mi></msub></mrow></mrow></mfrac></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><eq id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2"></eq><apply id="S3.Ex1.m1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3"><mtext id="S3.Ex1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3">Softmax</mtext></ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2">𝜶</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3"><apply id="S3.Ex1.m1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.3.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.Ex1.m1.1.1.1.1.3.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1.2.2"></sum><apply id="S3.Ex1.m1.1.1.1.1.3.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1.2.3"><eq id="S3.Ex1.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.Ex1.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.Ex1.m1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.Ex1.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1.3"><ci id="S3.Ex1.m1.1.1.1.1.3.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1.3.1">^</ci><ci id="S3.Ex1.m1.1.1.1.1.3.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.1.3.2">𝑇</ci></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2"><divide id="S3.Ex1.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2"></divide><apply id="S3.Ex1.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2"><ci id="S3.Ex1.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.1">⋅</ci><apply id="S3.Ex1.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S3.Ex1.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3"><exp id="S3.Ex1.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.1"></exp><apply id="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.2">𝛼</ci><ci id="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2.3.2.3">𝑖</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3"><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.1">⋅</ci><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2"><times id="S3.Ex1.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.1"></times><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2">superscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.2">Σ</ci><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3"><eq id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.1"></eq><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.2">𝑗</ci><cn id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.3.cmml" type="integer" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.2.3.3">1</cn></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3"><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.1">^</ci><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.2.3.2">𝑇</ci></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.2">𝑛</ci><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3"><exp id="S3.Ex1.m1.1.1.1.1.3.2.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.1"></exp><apply id="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.2">𝛼</ci><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3.3.2.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\text{Softmax}(\boldsymbol{\alpha}^{\prime})=\sum_{i=1}^{\hat{T}}\frac{n_{i}%
\cdot\exp{\alpha_{i}}}{\Sigma_{j=1}^{\hat{T}}n_{j}\cdot\exp{\alpha_{j}}},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">Softmax ( bold_italic_α start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG end_POSTSUPERSCRIPT divide start_ARG italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ roman_exp italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG roman_Σ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG end_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⋅ roman_exp italic_α start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p3.9">where the relevance score of each cluster <math alttext="\alpha_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.7.m1.1"><semantics id="S3.SS3.SSS3.p3.7.m1.1a"><msub id="S3.SS3.SSS3.p3.7.m1.1.1" xref="S3.SS3.SSS3.p3.7.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p3.7.m1.1.1.2" xref="S3.SS3.SSS3.p3.7.m1.1.1.2.cmml">α</mi><mi id="S3.SS3.SSS3.p3.7.m1.1.1.3" xref="S3.SS3.SSS3.p3.7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.7.m1.1b"><apply id="S3.SS3.SSS3.p3.7.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.7.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p3.7.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1.2">𝛼</ci><ci id="S3.SS3.SSS3.p3.7.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.7.m1.1c">\alpha_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.7.m1.1d">italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is reweighted by cluster size <math alttext="n_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.8.m2.1"><semantics id="S3.SS3.SSS3.p3.8.m2.1a"><msub id="S3.SS3.SSS3.p3.8.m2.1.1" xref="S3.SS3.SSS3.p3.8.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p3.8.m2.1.1.2" xref="S3.SS3.SSS3.p3.8.m2.1.1.2.cmml">n</mi><mi id="S3.SS3.SSS3.p3.8.m2.1.1.3" xref="S3.SS3.SSS3.p3.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.8.m2.1b"><apply id="S3.SS3.SSS3.p3.8.m2.1.1.cmml" xref="S3.SS3.SSS3.p3.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.8.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p3.8.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p3.8.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p3.8.m2.1.1.2">𝑛</ci><ci id="S3.SS3.SSS3.p3.8.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p3.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.8.m2.1c">n_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.8.m2.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. We employ multi-head attention with <math alttext="4" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.9.m3.1"><semantics id="S3.SS3.SSS3.p3.9.m3.1a"><mn id="S3.SS3.SSS3.p3.9.m3.1.1" xref="S3.SS3.SSS3.p3.9.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.9.m3.1b"><cn id="S3.SS3.SSS3.p3.9.m3.1.1.cmml" type="integer" xref="S3.SS3.SSS3.p3.9.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.9.m3.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.9.m3.1d">4</annotation></semantics></math> heads to obtain the ultimate long-term interest:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E11">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E11X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Long-term Interests}=\text{Concat}(\text{head}_{1},...,%
\text{head}_{4})\mathbf{W}^{o}," class="ltx_Math" display="inline" id="S3.E11X.2.1.1.m1.2"><semantics id="S3.E11X.2.1.1.m1.2a"><mrow id="S3.E11X.2.1.1.m1.2.2.1" xref="S3.E11X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E11X.2.1.1.m1.2.2.1.1" xref="S3.E11X.2.1.1.m1.2.2.1.1.cmml"><mtext id="S3.E11X.2.1.1.m1.2.2.1.1.4" xref="S3.E11X.2.1.1.m1.2.2.1.1.4a.cmml">Long-term Interests</mtext><mo id="S3.E11X.2.1.1.m1.2.2.1.1.3" xref="S3.E11X.2.1.1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E11X.2.1.1.m1.2.2.1.1.2" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.cmml"><mtext id="S3.E11X.2.1.1.m1.2.2.1.1.2.4" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.4a.cmml">Concat</mtext><mo id="S3.E11X.2.1.1.m1.2.2.1.1.2.3" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.3.cmml"><mo id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mtext id="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.2a.cmml">head</mtext><mn id="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.4" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.3.cmml">,</mo><mi id="S3.E11X.2.1.1.m1.1.1" mathvariant="normal" xref="S3.E11X.2.1.1.m1.1.1.cmml">…</mi><mo id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.5" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml"><mtext id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.2a.cmml">head</mtext><mn id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.3" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">4</mn></msub><mo id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.6" stretchy="false" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow><mo id="S3.E11X.2.1.1.m1.2.2.1.1.2.3a" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.3.cmml">⁢</mo><msup id="S3.E11X.2.1.1.m1.2.2.1.1.2.5" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.5.cmml"><mi id="S3.E11X.2.1.1.m1.2.2.1.1.2.5.2" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.5.2.cmml">𝐖</mi><mi id="S3.E11X.2.1.1.m1.2.2.1.1.2.5.3" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.5.3.cmml">o</mi></msup></mrow></mrow><mo id="S3.E11X.2.1.1.m1.2.2.1.2" xref="S3.E11X.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11X.2.1.1.m1.2b"><apply id="S3.E11X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E11X.2.1.1.m1.2.2.1"><eq id="S3.E11X.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.3"></eq><ci id="S3.E11X.2.1.1.m1.2.2.1.1.4a.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.4"><mtext id="S3.E11X.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.4">Long-term Interests</mtext></ci><apply id="S3.E11X.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2"><times id="S3.E11X.2.1.1.m1.2.2.1.1.2.3.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.3"></times><ci id="S3.E11X.2.1.1.m1.2.2.1.1.2.4a.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.4"><mtext id="S3.E11X.2.1.1.m1.2.2.1.1.2.4.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.4">Concat</mtext></ci><vector id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2"><apply id="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.2a.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.2"><mtext id="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.2">head</mtext></ci><cn id="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E11X.2.1.1.m1.2.2.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E11X.2.1.1.m1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1">…</ci><apply id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.2a.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.2"><mtext id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.2">head</mtext></ci><cn id="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.2.2.2.3">4</cn></apply></vector><apply id="S3.E11X.2.1.1.m1.2.2.1.1.2.5.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.5"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.2.2.1.1.2.5.1.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.5">superscript</csymbol><ci id="S3.E11X.2.1.1.m1.2.2.1.1.2.5.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.5.2">𝐖</ci><ci id="S3.E11X.2.1.1.m1.2.2.1.1.2.5.3.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1.2.5.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11X.2.1.1.m1.2c">\displaystyle\text{Long-term Interests}=\text{Concat}(\text{head}_{1},...,%
\text{head}_{4})\mathbf{W}^{o},</annotation><annotation encoding="application/x-llamapun" id="S3.E11X.2.1.1.m1.2d">Long-term Interests = Concat ( head start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , head start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ) bold_W start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E11Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{head}_{a}" class="ltx_Math" display="inline" id="S3.E11Xa.2.1.1.m1.1"><semantics id="S3.E11Xa.2.1.1.m1.1a"><msub id="S3.E11Xa.2.1.1.m1.1.1" xref="S3.E11Xa.2.1.1.m1.1.1.cmml"><mtext id="S3.E11Xa.2.1.1.m1.1.1.2" xref="S3.E11Xa.2.1.1.m1.1.1.2a.cmml">head</mtext><mi id="S3.E11Xa.2.1.1.m1.1.1.3" xref="S3.E11Xa.2.1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E11Xa.2.1.1.m1.1b"><apply id="S3.E11Xa.2.1.1.m1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E11Xa.2.1.1.m1.1.1.2a.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.2"><mtext id="S3.E11Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.2">head</mtext></ci><ci id="S3.E11Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E11Xa.2.1.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11Xa.2.1.1.m1.1c">\displaystyle\text{head}_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.E11Xa.2.1.1.m1.1d">head start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Attention}(\mathbf{q}^{\top}\mathbf{W}_{a}^{q},\mathbf{K}_%
{h}\mathbf{W}_{a}^{h},\mathbf{K}_{c}\mathbf{W}_{a}^{c},\mathbf{K}\mathbf{W}_{a%
}^{v}),a\in\{1,...,4\}," class="ltx_Math" display="inline" id="S3.E11Xa.3.2.2.m1.4"><semantics id="S3.E11Xa.3.2.2.m1.4a"><mrow id="S3.E11Xa.3.2.2.m1.4.4.1"><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.3.cmml"><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.6" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.6.cmml"></mi><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.5" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.5.cmml">=</mo><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.cmml"><mtext id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.6" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.6a.cmml">Attention</mtext><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.5" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.5.cmml">⁢</mo><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.5.cmml"><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.5" stretchy="false" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.5.cmml">(</mo><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">𝐪</mi><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msup><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml">a</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml">q</mi></msubsup></mrow><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.6" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.5.cmml">,</mo><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.cmml"><msub id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.2.cmml">𝐊</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml">h</mi></msub><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.1" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.1.cmml">⁢</mo><msubsup id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.2.cmml">𝐖</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.3.cmml">a</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.3.cmml">h</mi></msubsup></mrow><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.7" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.5.cmml">,</mo><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.cmml"><msub id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.2.cmml">𝐊</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.3.cmml">c</mi></msub><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.1" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><msubsup id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.2.cmml">𝐖</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.3.cmml">a</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.3.cmml">c</mi></msubsup></mrow><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.8" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.5.cmml">,</mo><msubsup id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.2.cmml">𝐊𝐖</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.3.cmml">a</mi><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.3.cmml">v</mi></msubsup><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.9" stretchy="false" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.5.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.cmml"><mi id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.2.cmml">a</mi><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.1" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.1.cmml">∈</mo><mrow id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.1.cmml"><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.2.1" stretchy="false" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.1.cmml">{</mo><mn id="S3.E11Xa.3.2.2.m1.1.1" xref="S3.E11Xa.3.2.2.m1.1.1.cmml">1</mn><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.2.2" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E11Xa.3.2.2.m1.2.2" mathvariant="normal" xref="S3.E11Xa.3.2.2.m1.2.2.cmml">…</mi><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.2.3" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.1.cmml">,</mo><mn id="S3.E11Xa.3.2.2.m1.3.3" xref="S3.E11Xa.3.2.2.m1.3.3.cmml">4</mn><mo id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.2.4" stretchy="false" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E11Xa.3.2.2.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11Xa.3.2.2.m1.4b"><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.3a.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1"><eq id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.5.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.5"></eq><csymbol cd="latexml" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.6.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.6">absent</csymbol><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4"><times id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.5.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.5"></times><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.6a.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.6"><mtext id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.6.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.6">Attention</mtext></ci><vector id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.5.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4"><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.2">𝐪</ci><csymbol cd="latexml" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.2.3">𝑎</ci></apply><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2"><times id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.1"></times><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.2">𝐊</ci><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.2.3">ℎ</ci></apply><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3">superscript</csymbol><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.2">𝐖</ci><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.2.3">𝑎</ci></apply><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.2.2.2.2.3.3">ℎ</ci></apply></apply><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3"><times id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.1"></times><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2">subscript</csymbol><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.2">𝐊</ci><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.2.3">𝑐</ci></apply><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3">superscript</csymbol><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.2">𝐖</ci><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.2.3">𝑎</ci></apply><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.3.3.3.3.3.3">𝑐</ci></apply></apply><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4">superscript</csymbol><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4">subscript</csymbol><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.2">𝐊𝐖</ci><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.2.3">𝑎</ci></apply><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.3.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.1.1.4.4.4.4.3">𝑣</ci></apply></vector></apply></apply><apply id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2"><in id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.1"></in><ci id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.2">𝑎</ci><set id="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E11Xa.3.2.2.m1.4.4.1.1.2.2.3.2"><cn id="S3.E11Xa.3.2.2.m1.1.1.cmml" type="integer" xref="S3.E11Xa.3.2.2.m1.1.1">1</cn><ci id="S3.E11Xa.3.2.2.m1.2.2.cmml" xref="S3.E11Xa.3.2.2.m1.2.2">…</ci><cn id="S3.E11Xa.3.2.2.m1.3.3.cmml" type="integer" xref="S3.E11Xa.3.2.2.m1.3.3">4</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11Xa.3.2.2.m1.4c">\displaystyle=\text{Attention}(\mathbf{q}^{\top}\mathbf{W}_{a}^{q},\mathbf{K}_%
{h}\mathbf{W}_{a}^{h},\mathbf{K}_{c}\mathbf{W}_{a}^{c},\mathbf{K}\mathbf{W}_{a%
}^{v}),a\in\{1,...,4\},</annotation><annotation encoding="application/x-llamapun" id="S3.E11Xa.3.2.2.m1.4d">= Attention ( bold_q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , bold_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT , bold_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT , bold_KW start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT ) , italic_a ∈ { 1 , … , 4 } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p3.10">where <math alttext="\mathbf{W}^{o}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.10.m1.1"><semantics id="S3.SS3.SSS3.p3.10.m1.1a"><msup id="S3.SS3.SSS3.p3.10.m1.1.1" xref="S3.SS3.SSS3.p3.10.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p3.10.m1.1.1.2" xref="S3.SS3.SSS3.p3.10.m1.1.1.2.cmml">𝐖</mi><mi id="S3.SS3.SSS3.p3.10.m1.1.1.3" xref="S3.SS3.SSS3.p3.10.m1.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.10.m1.1b"><apply id="S3.SS3.SSS3.p3.10.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.10.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.10.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p3.10.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.10.m1.1.1.2">𝐖</ci><ci id="S3.SS3.SSS3.p3.10.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.10.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.10.m1.1c">\mathbf{W}^{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.10.m1.1d">bold_W start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math> is a projection.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p4">
<p class="ltx_p" id="S3.SS3.SSS3.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p4.1.1">Remark.</span> Utilizing behaviors derived from hierarchical clustering in GSU enables the model to accommodate longer historical behaviors, achieving life-cycle level modeling in our systems.
Compared to TWIN, GSU’s input of life-cycle behaviors encompasses a broader range of historical interests, thereby offering a more comprehensive and accurate modeling of user interests.
Additionally, while existing works use the top 100 retrieved behaviors as input for ESU, TWIN-V2 utilizes 100 clusters.
These clusters cover more behaviors beyond 100, allowing ESU to model a broader spectrum of behaviors.
All these advantages lead to more accurate and diverse recommendation results, verified in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S4.SS4" title="4.4. Online Experiments ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">4.4</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Deployment of TWIN-V2</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">We divide our hands-on practices for deploying TWIN-V2 into two parts: online and offline, as shown in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#S3.F3" title="Figure 3 ‣ 3.4. Deployment of TWIN-V2 ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Figure 3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="161" id="S3.F3.g1" src="x3.png" width="374"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">
The deployment of TWIN-V2 at Kuaishou.
</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p2.1.1">Overview. </span>
In <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#S3.F3" title="Figure 3 ‣ 3.4. Deployment of TWIN-V2 ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Figure 3</span></a>, we illustrate with a single user example.
When the system receives a user’s request, it first extracts behavioral features from the offline-processed user life-cycle behaviors. Then, using GSU and ESU, it models these into long-term interest inputs for the CTR model to make predictions.
We employ a nearline trainer for real-time model training, which incrementally updates model parameters using real-time user interaction data within an 8-minute window.
For life-cycle behaviors, we apply hierarchical clustering and feature extraction to process them. This is conducted through periodic offline processing and updates.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.5"><span class="ltx_text ltx_font_bold" id="S3.SS4.p3.5.1">Offline Processing.</span>
Offline processing aims to compress the user’s entire life-cycle behaviors.
Considering Kuaishou’s user count is on a billion scale, we periodically compress their life-cycle behaviors.
The hierarchical clustering runner performs a full update every 2 weeks.
We set the maximum cluster size <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_γ</annotation></semantics></math> in hierarchical clustering to <math alttext="20" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mn id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><cn id="S3.SS4.p3.2.m2.1.1.cmml" type="integer" xref="S3.SS4.p3.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">20</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">20</annotation></semantics></math>, leading to an average cluster size around <math alttext="10" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1"><semantics id="S3.SS4.p3.3.m3.1a"><mn id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><cn id="S3.SS4.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS4.p3.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">10</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.1d">10</annotation></semantics></math>.
Through cluster representation extraction, each cluster is aggregated into a virtual item.
In our practices, historical behavior is compressed to <math alttext="10\%" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m4.1"><semantics id="S3.SS4.p3.4.m4.1a"><mrow id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml"><mn id="S3.SS4.p3.4.m4.1.1.2" xref="S3.SS4.p3.4.m4.1.1.2.cmml">10</mn><mo id="S3.SS4.p3.4.m4.1.1.1" xref="S3.SS4.p3.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><apply id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1"><csymbol cd="latexml" id="S3.SS4.p3.4.m4.1.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1.1">percent</csymbol><cn id="S3.SS4.p3.4.m4.1.1.2.cmml" type="integer" xref="S3.SS4.p3.4.m4.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m4.1d">10 %</annotation></semantics></math> of its original length, resulting in a <math alttext="90\%" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m5.1"><semantics id="S3.SS4.p3.5.m5.1a"><mrow id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml"><mn id="S3.SS4.p3.5.m5.1.1.2" xref="S3.SS4.p3.5.m5.1.1.2.cmml">90</mn><mo id="S3.SS4.p3.5.m5.1.1.1" xref="S3.SS4.p3.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><apply id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1"><csymbol cd="latexml" id="S3.SS4.p3.5.m5.1.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1.1">percent</csymbol><cn id="S3.SS4.p3.5.m5.1.1.2.cmml" type="integer" xref="S3.SS4.p3.5.m5.1.1.2">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">90\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m5.1d">90 %</annotation></semantics></math> reduction in storage costs.
We employ the inherent feature projector proposed in TWIN for the embedding server, refreshing its parameters every 15 minutes from the latest CTR model.</p>
</div>
<div class="ltx_para" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p4.1.1">Online Serving. </span>
After the user sends a request to the system, the offline system sends data features to the GSU, which calculates the behavior-target relevance scores, <math alttext="\boldsymbol{\alpha}^{\prime}" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.1"><semantics id="S3.SS4.p4.1.m1.1a"><msup id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">𝜶</mi><mo id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝜶</ci><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">\boldsymbol{\alpha}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.1.m1.1d">bold_italic_α start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, according to Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.E8" title="In 3.3.3. Cluster-aware Target Attention ‣ 3.3. Life-Cycle User Modeling ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">8</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.E9" title="In 3.3.3. Cluster-aware Target Attention ‣ 3.3. Life-Cycle User Modeling ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">9</span></a>).
Then, the ESU selects and aggregates the top 100 clustered behaviors as long-term interests for the CTR model, which makes a prediction.
To ensure efficiency in online inference, we maintain the precomputing and caching strategies from TWIN.</p>
</div>
<div class="ltx_para" id="S3.SS4.p5">
<p class="ltx_p" id="S3.SS4.p5.1">TWIN-V2 was incrementally deployed with TWIN. TWIN models the behaviors in recent months, while TWIN-V2 models the behaviors throughout the entire life cycle, allowing them to complement each other.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiment</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we verify the effectiveness of TWIN-V2 by conducting extensive offline and online experiments.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Setup</h3>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span>Dataset</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.2">Since TWIN-V2 is designed for user behaviors with extremely long lengths, it’s necessary to use datasets with ample user history.
To the best of our knowledge, there is no existing public dataset with an average history length exceeding <math alttext="10^{4}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.1.m1.1"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><msup id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.SSS1.p1.1.m1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml">10</mn><mn id="S4.SS1.SSS1.p1.1.m1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">superscript</csymbol><cn id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS1.SSS1.p1.1.m1.1.1.2">10</cn><cn id="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">10^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.1.m1.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math>.
Therefore, we extracted user interaction data from the Kuaishou app over five consecutive days to serve as the training and testing sets.
Samples were constructed from clicking logs with click-through as labels.
To capture users’ life-cycle histories, we further retraced each user’s past behavior, covering the maximum history length for each user at <math alttext="100,000" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.2.m2.2"><semantics id="S4.SS1.SSS1.p1.2.m2.2a"><mrow id="S4.SS1.SSS1.p1.2.m2.2.3.2" xref="S4.SS1.SSS1.p1.2.m2.2.3.1.cmml"><mn id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml">100</mn><mo id="S4.SS1.SSS1.p1.2.m2.2.3.2.1" xref="S4.SS1.SSS1.p1.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS1.p1.2.m2.2.2" xref="S4.SS1.SSS1.p1.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.2b"><list id="S4.SS1.SSS1.p1.2.m2.2.3.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.2"><cn id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS1.p1.2.m2.1.1">100</cn><cn id="S4.SS1.SSS1.p1.2.m2.2.2.cmml" type="integer" xref="S4.SS1.SSS1.p1.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.2c">100,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.2.m2.2d">100 , 000</annotation></semantics></math>.
<span class="ltx_ref ltx_refmacro_autoref ltx_missing_label ltx_ref_self">LABEL:tab:dataset</span> shows the basic statistics of this industrial dataset.
The first 23 hours of each day were used as the training set, while the final hour served as the testing set.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.4.1.1" style="font-size:113%;">Table 2</span>. </span><span class="ltx_text" id="S4.T2.5.2" style="font-size:113%;">Statistics of the large-scale industrial dataset collected from Kuaishou.</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T2.6">
<tr class="ltx_tr" id="S4.T2.6.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T2.6.1.1"><span class="ltx_text" id="S4.T2.6.1.1.1" style="font-size:80%;">Data</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T2.6.1.2"><span class="ltx_text" id="S4.T2.6.1.2.1" style="font-size:80%;">Field</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.6.1.3"><span class="ltx_text" id="S4.T2.6.1.3.1" style="font-size:80%;">Size</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.6.2.1" rowspan="4"><span class="ltx_text" id="S4.T2.6.2.1.1" style="font-size:80%;">Daily Log Info</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.6.2.2"><span class="ltx_text" id="S4.T2.6.2.2.1" style="font-size:80%;">Users</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.2.3"><span class="ltx_text" id="S4.T2.6.2.3.1" style="font-size:80%;">345.5 million</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.3">
<td class="ltx_td ltx_align_left" id="S4.T2.6.3.1"><span class="ltx_text" id="S4.T2.6.3.1.1" style="font-size:80%;">Videos</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.3.2"><span class="ltx_text" id="S4.T2.6.3.2.1" style="font-size:80%;">45.1 million</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.4">
<td class="ltx_td ltx_align_left" id="S4.T2.6.4.1"><span class="ltx_text" id="S4.T2.6.4.1.1" style="font-size:80%;">Samples</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.4.2"><span class="ltx_text" id="S4.T2.6.4.2.1" style="font-size:80%;">46.2 billion</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.5">
<td class="ltx_td ltx_align_left" id="S4.T2.6.5.1"><span class="ltx_text" id="S4.T2.6.5.1.1" style="font-size:80%;">Average User Actions</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.5.2"><span class="ltx_text" id="S4.T2.6.5.2.1" style="font-size:80%;">133.7 / day</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T2.6.6.1" rowspan="2"><span class="ltx_text" id="S4.T2.6.6.1.1" style="font-size:80%;">Historical Behaviors</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.6.6.2"><span class="ltx_text" id="S4.T2.6.6.2.1" style="font-size:80%;">Average User Behaviors</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.3"><span class="ltx_text" id="S4.T2.6.6.3.1" style="font-size:80%;">14.5 thousand</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.6.7.1"><span class="ltx_text" id="S4.T2.6.7.1.1" style="font-size:80%;">Max User Behaviors</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.7.2"><span class="ltx_text" id="S4.T2.6.7.2.1" style="font-size:80%;">100 thousand</span></td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span>Baselines</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">Following common practices <cite class="ltx_cite ltx_citemacro_citep">(Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib2" title="">2022</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite>, given that our focus is on modeling extremely long user histories, we compare TWIN-V2 with the following SOTA baselines:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS2.p2">
<p class="ltx_p" id="S4.SS1.SSS2.p2.2">(1) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.1">Avg-Pooling</span> : A naive method leverages average pooling. (2) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.2">DIN</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib25" title="">2018</a>)</cite>: It introduces the target attention for recommendation. (3) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.3">SIM Hard</span> <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib14" title="">2020</a>)</cite>: Hard-search refers to the process where GSU filters long-term history based on its category. (4) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.4">SIM Soft</span> <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib14" title="">2020</a>)</cite>: Soft search involves selecting the top-k items by computing the vector dot product between the target item and items in the history. (5) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.5">ETA</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib4" title="">2021</a>)</cite>: It employs Locality Sensitive Hashing to facilitate end-to-end training. (6) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.6">SDIM</span> <cite class="ltx_cite ltx_citemacro_citep">(Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib2" title="">2022</a>)</cite>: The GSU aggregates long-term history by gathering behaviors that share the same hashing signature with the target item. (7) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.7">SIM Cluster</span>: Due to the reliance on annotated categories in SIM Hard, we improved it by the clustering of video embeddings. GSU retrieves history behaviors within the same cluster with the target item. Here we clustered all items into <math alttext="1,000" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.1.m1.2"><semantics id="S4.SS1.SSS2.p2.1.m1.2a"><mrow id="S4.SS1.SSS2.p2.1.m1.2.3.2" xref="S4.SS1.SSS2.p2.1.m1.2.3.1.cmml"><mn id="S4.SS1.SSS2.p2.1.m1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.cmml">1</mn><mo id="S4.SS1.SSS2.p2.1.m1.2.3.2.1" xref="S4.SS1.SSS2.p2.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS2.p2.1.m1.2.2" xref="S4.SS1.SSS2.p2.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.1.m1.2b"><list id="S4.SS1.SSS2.p2.1.m1.2.3.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.2.3.2"><cn id="S4.SS1.SSS2.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS2.p2.1.m1.1.1">1</cn><cn id="S4.SS1.SSS2.p2.1.m1.2.2.cmml" type="integer" xref="S4.SS1.SSS2.p2.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.1.m1.2c">1,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.1.m1.2d">1 , 000</annotation></semantics></math> groups. (8)
<span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.8">SIM Cluster+</span>: This is an advanced variant of SIM Cluster with increasing cluster number to <math alttext="10,000" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p2.2.m2.2"><semantics id="S4.SS1.SSS2.p2.2.m2.2a"><mrow id="S4.SS1.SSS2.p2.2.m2.2.3.2" xref="S4.SS1.SSS2.p2.2.m2.2.3.1.cmml"><mn id="S4.SS1.SSS2.p2.2.m2.1.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.cmml">10</mn><mo id="S4.SS1.SSS2.p2.2.m2.2.3.2.1" xref="S4.SS1.SSS2.p2.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS2.p2.2.m2.2.2" xref="S4.SS1.SSS2.p2.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.2.m2.2b"><list id="S4.SS1.SSS2.p2.2.m2.2.3.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.2.3.2"><cn id="S4.SS1.SSS2.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS2.p2.2.m2.1.1">10</cn><cn id="S4.SS1.SSS2.p2.2.m2.2.2.cmml" type="integer" xref="S4.SS1.SSS2.p2.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.2.m2.2c">10,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p2.2.m2.2d">10 , 000</annotation></semantics></math>. (9) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p2.2.9">TWIN</span> <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite>: It proposes an efficient target attention for GSU and ESU stages.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS2.p3">
<p class="ltx_p" id="S4.SS1.SSS2.p3.1">To ensure a fair comparison, we maintained consistency in all aspects of the models except for the long-term interest modeling.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3. </span>Evaluation Metrics &amp; Protocal</h4>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.1">We split the dataset into training and testing sets based on timestamps.
We utilized data from 23 consecutive hours each day for the training set and the remaining 1 hour’s data for the test set.
For all models, we evaluated their performance over five consecutive days and reported the average results.
As for evaluation metrics, we adopted <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS3.p1.1.1">AUC</span> (Area under the ROC curve) and <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS3.p1.1.2">GAUC</span> (Group AUC), which are widely used.
We calculated the <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS3.p1.1.3">mean</span> and standard deviation (<span class="ltx_text ltx_font_italic" id="S4.SS1.SSS3.p1.1.4">std</span>) of both metrics over 5 consecutive days.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4. </span>Implementation Details</h4>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3. </span>
Overall comparison.
The best and the second-best performances are denoted in bold and underlined fonts, respectively.
An 0.001-level improvement is considered significant for CTR prediction, as supported by <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib22" title="">2021</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib12" title="">2018</a>)</cite>.
</figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T3.24">
<tr class="ltx_tr" id="S4.T3.4.4">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.4.4.5"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.5.1" style="font-size:90%;">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.2">
<span class="ltx_text ltx_font_bold" id="S4.T3.2.2.2.2" style="font-size:90%;">AUC</span><span class="ltx_text" id="S4.T3.2.2.2.3" style="font-size:90%;"> (</span><span class="ltx_text ltx_font_italic" id="S4.T3.2.2.2.4" style="font-size:90%;">mean</span><span class="ltx_text" id="S4.T3.2.2.2.5" style="font-size:90%;"> </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.m1.1a"><mo id="S4.T3.1.1.1.m1.1.1" mathsize="80%" xref="S4.T3.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.2.2.2.1" style="font-size:80%;"> <span class="ltx_text ltx_font_italic" id="S4.T3.2.2.2.1.1">std</span> ) <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.2.2.2.1.m1.1"><semantics id="S4.T3.2.2.2.1.m1.1a"><mo id="S4.T3.2.2.2.1.m1.1.1" stretchy="false" xref="S4.T3.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.1.m1.1b"><ci id="S4.T3.2.2.2.1.m1.1.1.cmml" xref="S4.T3.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.1.m1.1d">↑</annotation></semantics></math></span>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.4.4">
<span class="ltx_text ltx_font_bold" id="S4.T3.4.4.4.2" style="font-size:90%;">GAUC</span><span class="ltx_text" id="S4.T3.4.4.4.3" style="font-size:90%;"> (</span><span class="ltx_text ltx_font_italic" id="S4.T3.4.4.4.4" style="font-size:90%;">mean</span><span class="ltx_text" id="S4.T3.4.4.4.5" style="font-size:90%;"> </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.3.3.3.m1.1"><semantics id="S4.T3.3.3.3.m1.1a"><mo id="S4.T3.3.3.3.m1.1.1" mathsize="80%" xref="S4.T3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.4.4.4.1" style="font-size:80%;"> <span class="ltx_text ltx_font_italic" id="S4.T3.4.4.4.1.1">std</span> ) <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.4.4.4.1.m1.1"><semantics id="S4.T3.4.4.4.1.m1.1a"><mo id="S4.T3.4.4.4.1.m1.1.1" stretchy="false" xref="S4.T3.4.4.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.1.m1.1b"><ci id="S4.T3.4.4.4.1.m1.1.1.cmml" xref="S4.T3.4.4.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.4.1.m1.1d">↑</annotation></semantics></math></span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.6.6.3"><span class="ltx_text" id="S4.T3.6.6.3.1" style="font-size:90%;">Avg-Pooling</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.1">
<span class="ltx_text" id="S4.T3.5.5.1.1" style="font-size:90%;">0.7855 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.5.5.1.m1.1"><semantics id="S4.T3.5.5.1.m1.1a"><mo id="S4.T3.5.5.1.m1.1.1" mathsize="80%" xref="S4.T3.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T3.5.5.1.m1.1.1.cmml" xref="S4.T3.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.5.5.1.2" style="font-size:80%;"> 0.00023</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.6.2">
<span class="ltx_text" id="S4.T3.6.6.2.1" style="font-size:90%;">0.7168 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.6.6.2.m1.1"><semantics id="S4.T3.6.6.2.m1.1a"><mo id="S4.T3.6.6.2.m1.1.1" mathsize="80%" xref="S4.T3.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.2.m1.1b"><csymbol cd="latexml" id="S4.T3.6.6.2.m1.1.1.cmml" xref="S4.T3.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.6.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.6.6.2.2" style="font-size:80%;"> 0.00019</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.8">
<td class="ltx_td ltx_align_left" id="S4.T3.8.8.3"><span class="ltx_text" id="S4.T3.8.8.3.1" style="font-size:90%;">DIN</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.7.1">
<span class="ltx_text" id="S4.T3.7.7.1.1" style="font-size:90%;">0.7873 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.7.7.1.m1.1"><semantics id="S4.T3.7.7.1.m1.1a"><mo id="S4.T3.7.7.1.m1.1.1" mathsize="80%" xref="S4.T3.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.1.m1.1b"><csymbol cd="latexml" id="S4.T3.7.7.1.m1.1.1.cmml" xref="S4.T3.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.7.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.7.7.1.2" style="font-size:80%;"> 0.00014</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.8.2">
<span class="ltx_text" id="S4.T3.8.8.2.1" style="font-size:90%;">0.7191 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.8.8.2.m1.1"><semantics id="S4.T3.8.8.2.m1.1a"><mo id="S4.T3.8.8.2.m1.1.1" mathsize="80%" xref="S4.T3.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.2.m1.1b"><csymbol cd="latexml" id="S4.T3.8.8.2.m1.1.1.cmml" xref="S4.T3.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.8.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.8.8.2.2" style="font-size:80%;"> 0.00012</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.10.10">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.10.10.3"><span class="ltx_text" id="S4.T3.10.10.3.1" style="font-size:90%;">SIM Hard</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.1">
<span class="ltx_text" id="S4.T3.9.9.1.1" style="font-size:90%;">0.7901 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.9.9.1.m1.1"><semantics id="S4.T3.9.9.1.m1.1a"><mo id="S4.T3.9.9.1.m1.1.1" mathsize="80%" xref="S4.T3.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.9.9.1.m1.1b"><csymbol cd="latexml" id="S4.T3.9.9.1.m1.1.1.cmml" xref="S4.T3.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.9.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.9.9.1.2" style="font-size:80%;"> 0.00016</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.10.10.2">
<span class="ltx_text" id="S4.T3.10.10.2.1" style="font-size:90%;">0.7224 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.10.10.2.m1.1"><semantics id="S4.T3.10.10.2.m1.1a"><mo id="S4.T3.10.10.2.m1.1.1" mathsize="80%" xref="S4.T3.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.10.10.2.m1.1b"><csymbol cd="latexml" id="S4.T3.10.10.2.m1.1.1.cmml" xref="S4.T3.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.10.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.10.10.2.2" style="font-size:80%;"> 0.00021</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.12">
<td class="ltx_td ltx_align_left" id="S4.T3.12.12.3"><span class="ltx_text" id="S4.T3.12.12.3.1" style="font-size:90%;">ETA</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.11.11.1">
<span class="ltx_text" id="S4.T3.11.11.1.1" style="font-size:90%;">0.7910 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.11.11.1.m1.1"><semantics id="S4.T3.11.11.1.m1.1a"><mo id="S4.T3.11.11.1.m1.1.1" mathsize="80%" xref="S4.T3.11.11.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.11.11.1.m1.1b"><csymbol cd="latexml" id="S4.T3.11.11.1.m1.1.1.cmml" xref="S4.T3.11.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.11.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.11.11.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.11.11.1.2" style="font-size:80%;"> 0.00004</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.12.2">
<span class="ltx_text" id="S4.T3.12.12.2.1" style="font-size:90%;">0.7243 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.12.12.2.m1.1"><semantics id="S4.T3.12.12.2.m1.1a"><mo id="S4.T3.12.12.2.m1.1.1" mathsize="80%" xref="S4.T3.12.12.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.12.12.2.m1.1b"><csymbol cd="latexml" id="S4.T3.12.12.2.m1.1.1.cmml" xref="S4.T3.12.12.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.12.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.12.12.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.12.12.2.2" style="font-size:80%;"> 0.00011</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.14.14">
<td class="ltx_td ltx_align_left" id="S4.T3.14.14.3"><span class="ltx_text" id="S4.T3.14.14.3.1" style="font-size:90%;">SIM Cluster</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.13.13.1">
<span class="ltx_text" id="S4.T3.13.13.1.1" style="font-size:90%;">0.7915 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.13.13.1.m1.1"><semantics id="S4.T3.13.13.1.m1.1a"><mo id="S4.T3.13.13.1.m1.1.1" mathsize="80%" xref="S4.T3.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.13.13.1.m1.1b"><csymbol cd="latexml" id="S4.T3.13.13.1.m1.1.1.cmml" xref="S4.T3.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.13.13.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.13.13.1.2" style="font-size:80%;"> 0.00017</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.14.14.2">
<span class="ltx_text" id="S4.T3.14.14.2.1" style="font-size:90%;">0.7253 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.14.14.2.m1.1"><semantics id="S4.T3.14.14.2.m1.1a"><mo id="S4.T3.14.14.2.m1.1.1" mathsize="80%" xref="S4.T3.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.14.14.2.m1.1b"><csymbol cd="latexml" id="S4.T3.14.14.2.m1.1.1.cmml" xref="S4.T3.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.14.14.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.14.14.2.2" style="font-size:80%;"> 0.00018</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.16.16">
<td class="ltx_td ltx_align_left" id="S4.T3.16.16.3"><span class="ltx_text" id="S4.T3.16.16.3.1" style="font-size:90%;">SDIM</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.15.15.1">
<span class="ltx_text" id="S4.T3.15.15.1.1" style="font-size:90%;">0.7919 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.15.15.1.m1.1"><semantics id="S4.T3.15.15.1.m1.1a"><mo id="S4.T3.15.15.1.m1.1.1" mathsize="80%" xref="S4.T3.15.15.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.15.15.1.m1.1b"><csymbol cd="latexml" id="S4.T3.15.15.1.m1.1.1.cmml" xref="S4.T3.15.15.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.15.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.15.15.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.15.15.1.2" style="font-size:80%;"> 0.00009</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.16.16.2">
<span class="ltx_text" id="S4.T3.16.16.2.1" style="font-size:90%;">0.7267 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.16.16.2.m1.1"><semantics id="S4.T3.16.16.2.m1.1a"><mo id="S4.T3.16.16.2.m1.1.1" mathsize="80%" xref="S4.T3.16.16.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.16.16.2.m1.1b"><csymbol cd="latexml" id="S4.T3.16.16.2.m1.1.1.cmml" xref="S4.T3.16.16.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.16.16.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.16.16.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.16.16.2.2" style="font-size:80%;"> 0.00006</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.18.18">
<td class="ltx_td ltx_align_left" id="S4.T3.18.18.3"><span class="ltx_text" id="S4.T3.18.18.3.1" style="font-size:90%;">SIM Cluster+</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.17.17.1">
<span class="ltx_text" id="S4.T3.17.17.1.1" style="font-size:90%;">0.7927 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.17.17.1.m1.1"><semantics id="S4.T3.17.17.1.m1.1a"><mo id="S4.T3.17.17.1.m1.1.1" mathsize="80%" xref="S4.T3.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.17.17.1.m1.1b"><csymbol cd="latexml" id="S4.T3.17.17.1.m1.1.1.cmml" xref="S4.T3.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.17.17.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.17.17.1.2" style="font-size:80%;"> 0.00009</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.18.18.2">
<span class="ltx_text" id="S4.T3.18.18.2.1" style="font-size:90%;">0.7275 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.18.18.2.m1.1"><semantics id="S4.T3.18.18.2.m1.1a"><mo id="S4.T3.18.18.2.m1.1.1" mathsize="80%" xref="S4.T3.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.18.18.2.m1.1b"><csymbol cd="latexml" id="S4.T3.18.18.2.m1.1.1.cmml" xref="S4.T3.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.18.18.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.18.18.2.2" style="font-size:80%;"> 0.00011</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.20">
<td class="ltx_td ltx_align_left" id="S4.T3.20.20.3"><span class="ltx_text" id="S4.T3.20.20.3.1" style="font-size:90%;">SIM Soft</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.19.19.1">
<span class="ltx_text" id="S4.T3.19.19.1.1" style="font-size:90%;">0.7939 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.19.19.1.m1.1"><semantics id="S4.T3.19.19.1.m1.1a"><mo id="S4.T3.19.19.1.m1.1.1" mathsize="80%" xref="S4.T3.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.19.19.1.m1.1b"><csymbol cd="latexml" id="S4.T3.19.19.1.m1.1.1.cmml" xref="S4.T3.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.19.19.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.19.19.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.19.19.1.2" style="font-size:80%;"> 0.00014</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.20.2">
<span class="ltx_text" id="S4.T3.20.20.2.1" style="font-size:90%;">0.7299 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.20.20.2.m1.1"><semantics id="S4.T3.20.20.2.m1.1a"><mo id="S4.T3.20.20.2.m1.1.1" mathsize="80%" xref="S4.T3.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.20.20.2.m1.1b"><csymbol cd="latexml" id="S4.T3.20.20.2.m1.1.1.cmml" xref="S4.T3.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.20.20.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.20.20.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.20.20.2.2" style="font-size:80%;"> 0.00013</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.22.22">
<td class="ltx_td ltx_align_left" id="S4.T3.22.22.3"><span class="ltx_text" id="S4.T3.22.22.3.1" style="font-size:90%;">TWIN</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.21.21.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.21.21.1.1" style="font-size:90%;">0.7962 <math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.21.21.1.1.m1.1"><semantics id="S4.T3.21.21.1.1.m1.1a"><mo id="S4.T3.21.21.1.1.m1.1.1" mathsize="89%" xref="S4.T3.21.21.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.21.21.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.21.21.1.1.m1.1.1.cmml" xref="S4.T3.21.21.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.21.21.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.21.21.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.21.21.1.1.1" style="font-size:89%;"> 0.00008</span></span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.22.22.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.22.22.2.1" style="font-size:90%;">0.7336 <math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.22.22.2.1.m1.1"><semantics id="S4.T3.22.22.2.1.m1.1a"><mo id="S4.T3.22.22.2.1.m1.1.1" mathsize="89%" xref="S4.T3.22.22.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.22.22.2.1.m1.1b"><csymbol cd="latexml" id="S4.T3.22.22.2.1.m1.1.1.cmml" xref="S4.T3.22.22.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.22.22.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.22.22.2.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.22.22.2.1.1" style="font-size:89%;"> 0.00011</span></span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.24.24">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.24.24.3"><span class="ltx_text" id="S4.T3.24.24.3.1" style="font-size:90%;">TWIN-V2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.23.23.1"><span class="ltx_text ltx_font_bold" id="S4.T3.23.23.1.1" style="font-size:90%;">0.7975 <math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.23.23.1.1.m1.1"><semantics id="S4.T3.23.23.1.1.m1.1a"><mo id="S4.T3.23.23.1.1.m1.1.1" mathsize="89%" xref="S4.T3.23.23.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.23.23.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.23.23.1.1.m1.1.1.cmml" xref="S4.T3.23.23.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.23.23.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.23.23.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.23.23.1.1.1" style="font-size:89%;"> 0.00010</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.24.24.2"><span class="ltx_text ltx_font_bold" id="S4.T3.24.24.2.1" style="font-size:90%;">0.7360 <math alttext="\pm" class="ltx_Math" display="inline" id="S4.T3.24.24.2.1.m1.1"><semantics id="S4.T3.24.24.2.1.m1.1a"><mo id="S4.T3.24.24.2.1.m1.1.1" mathsize="89%" xref="S4.T3.24.24.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.24.24.2.1.m1.1b"><csymbol cd="latexml" id="S4.T3.24.24.2.1.m1.1.1.cmml" xref="S4.T3.24.24.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.24.24.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T3.24.24.2.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T3.24.24.2.1.1" style="font-size:89%;"> 0.00009</span></span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.24.25">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.24.25.1"><span class="ltx_text" id="S4.T3.24.25.1.1" style="font-size:90%;">Improv.</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.24.25.2"><span class="ltx_text" id="S4.T3.24.25.2.1" style="font-size:90%;">+0.16%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.24.25.3"><span class="ltx_text" id="S4.T3.24.25.3.1" style="font-size:90%;">+0.33%</span></td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.SSS4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.p1.6">For all models, we utilize the same item and user features in our industrial context, including ample attributes such as video ID, author ID and user ID.
TWIN-V2 limits the length of individual user history to a maximum of <math alttext="100,000" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.1.m1.2"><semantics id="S4.SS1.SSS4.p1.1.m1.2a"><mrow id="S4.SS1.SSS4.p1.1.m1.2.3.2" xref="S4.SS1.SSS4.p1.1.m1.2.3.1.cmml"><mn id="S4.SS1.SSS4.p1.1.m1.1.1" xref="S4.SS1.SSS4.p1.1.m1.1.1.cmml">100</mn><mo id="S4.SS1.SSS4.p1.1.m1.2.3.2.1" xref="S4.SS1.SSS4.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS4.p1.1.m1.2.2" xref="S4.SS1.SSS4.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.1.m1.2b"><list id="S4.SS1.SSS4.p1.1.m1.2.3.1.cmml" xref="S4.SS1.SSS4.p1.1.m1.2.3.2"><cn id="S4.SS1.SSS4.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.1.m1.1.1">100</cn><cn id="S4.SS1.SSS4.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS1.SSS4.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.1.m1.2c">100,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.1.m1.2d">100 , 000</annotation></semantics></math> items for clustering life-cycle user behavior.
As discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.SS4" title="3.4. Deployment of TWIN-V2 ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">3.4</span></a>, TWIN-V2 empirically compresses historical behavior to about <math alttext="10\%" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.2.m2.1"><semantics id="S4.SS1.SSS4.p1.2.m2.1a"><mrow id="S4.SS1.SSS4.p1.2.m2.1.1" xref="S4.SS1.SSS4.p1.2.m2.1.1.cmml"><mn id="S4.SS1.SSS4.p1.2.m2.1.1.2" xref="S4.SS1.SSS4.p1.2.m2.1.1.2.cmml">10</mn><mo id="S4.SS1.SSS4.p1.2.m2.1.1.1" xref="S4.SS1.SSS4.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.2.m2.1b"><apply id="S4.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS4.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS4.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS4.p1.2.m2.1.1.1">percent</csymbol><cn id="S4.SS1.SSS4.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS1.SSS4.p1.2.m2.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.2.m2.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.2.m2.1d">10 %</annotation></semantics></math> of its original size, resulting in a maximum input length of approximately <math alttext="10,000" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.3.m3.2"><semantics id="S4.SS1.SSS4.p1.3.m3.2a"><mrow id="S4.SS1.SSS4.p1.3.m3.2.3.2" xref="S4.SS1.SSS4.p1.3.m3.2.3.1.cmml"><mn id="S4.SS1.SSS4.p1.3.m3.1.1" xref="S4.SS1.SSS4.p1.3.m3.1.1.cmml">10</mn><mo id="S4.SS1.SSS4.p1.3.m3.2.3.2.1" xref="S4.SS1.SSS4.p1.3.m3.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS4.p1.3.m3.2.2" xref="S4.SS1.SSS4.p1.3.m3.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.3.m3.2b"><list id="S4.SS1.SSS4.p1.3.m3.2.3.1.cmml" xref="S4.SS1.SSS4.p1.3.m3.2.3.2"><cn id="S4.SS1.SSS4.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.3.m3.1.1">10</cn><cn id="S4.SS1.SSS4.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS1.SSS4.p1.3.m3.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.3.m3.2c">10,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.3.m3.2d">10 , 000</annotation></semantics></math> in the GSU.
For other two-stage models, the maximum length of historical behavior input into the GSU is limited to <math alttext="10,000" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.4.m4.2"><semantics id="S4.SS1.SSS4.p1.4.m4.2a"><mrow id="S4.SS1.SSS4.p1.4.m4.2.3.2" xref="S4.SS1.SSS4.p1.4.m4.2.3.1.cmml"><mn id="S4.SS1.SSS4.p1.4.m4.1.1" xref="S4.SS1.SSS4.p1.4.m4.1.1.cmml">10</mn><mo id="S4.SS1.SSS4.p1.4.m4.2.3.2.1" xref="S4.SS1.SSS4.p1.4.m4.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS4.p1.4.m4.2.2" xref="S4.SS1.SSS4.p1.4.m4.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.4.m4.2b"><list id="S4.SS1.SSS4.p1.4.m4.2.3.1.cmml" xref="S4.SS1.SSS4.p1.4.m4.2.3.2"><cn id="S4.SS1.SSS4.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.4.m4.1.1">10</cn><cn id="S4.SS1.SSS4.p1.4.m4.2.2.cmml" type="integer" xref="S4.SS1.SSS4.p1.4.m4.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.4.m4.2c">10,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.4.m4.2d">10 , 000</annotation></semantics></math> behaviors.
For DIN and Avg-Pooling, the maximum length of recent history is <math alttext="100" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.5.m5.1"><semantics id="S4.SS1.SSS4.p1.5.m5.1a"><mn id="S4.SS1.SSS4.p1.5.m5.1.1" xref="S4.SS1.SSS4.p1.5.m5.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.5.m5.1b"><cn id="S4.SS1.SSS4.p1.5.m5.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.5.m5.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.5.m5.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.5.m5.1d">100</annotation></semantics></math> since they are not designed for long-term behaviors.
All the two-stage models leverage the GSU to retrieve the top <math alttext="100" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.6.m6.1"><semantics id="S4.SS1.SSS4.p1.6.m6.1a"><mn id="S4.SS1.SSS4.p1.6.m6.1.1" xref="S4.SS1.SSS4.p1.6.m6.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.6.m6.1b"><cn id="S4.SS1.SSS4.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.6.m6.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.6.m6.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.6.m6.1d">100</annotation></semantics></math> historical items and feed them into the ESU for interest modeling.
The batch size is set to 8192.
The learning rate is 5e-6 for Adam.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Overall Performance</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">From the results in <span class="ltx_ref ltx_refmacro_autoref ltx_missing_label ltx_ref_self">LABEL:tab:overall</span>, we have the following observations:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.4"><math alttext="\bullet" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mo id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">∙</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.4.1">TWIN-V2 significantly outperforms other baselines by a large margin.</span>
As supported by existing literature <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib22" title="">2021</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib12" title="">2018</a>)</cite>, an improvement of <math alttext="0.001" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><cn id="S4.SS2.p2.2.m2.1.1.cmml" type="float" xref="S4.SS2.p2.2.m2.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">0.001</annotation></semantics></math> in AUC is considered significant for CTR prediction and is sufficient to yield online benefits.
TWIN-V2 achieves an improvement over the second-best performing TWIN model, with an increase of <math alttext="0.0013" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mn id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">0.0013</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><cn id="S4.SS2.p2.3.m3.1.1.cmml" type="float" xref="S4.SS2.p2.3.m3.1.1">0.0013</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">0.0013</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">0.0013</annotation></semantics></math> in AUC and <math alttext="0.0024" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mn id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">0.0024</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><cn id="S4.SS2.p2.4.m4.1.1.cmml" type="float" xref="S4.SS2.p2.4.m4.1.1">0.0024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">0.0024</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">0.0024</annotation></semantics></math> in GAUC.
These improvements verify the effectiveness of TWIN-V2.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mo id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">∙</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">TWIN-V2 exhibited a higher relative improvement in GAUC compared to its relative improvement in AUC.</span>
GAUC provides a more fine-grained measure of models.
The larger improvement in GAUC indicates that TWIN-V2 achieves enhancements across various types of users, rather than just performing better on the overall samples, and it also excels in specific subsets.
Since TWIN-V2 incorporates longer behavioral sequences, we believe it achieves greater improvements among highly active user groups, a hypothesis validated in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#A1.SS3" title="A.3. Analysis of User Activity Levels ‣ Appendix A APPENDIX ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We conducted an ablation study to investigate the role of core modules in TWIN-V2 and the rationale behind our design.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1. </span>Comparison of Different Hierarchical Clustering Methods</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.4">Our hierarchical clustering method has two key features: 1. It utilizes a dynamic clustering number <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.1.m1.1"><semantics id="S4.SS3.SSS1.p1.1.m1.1a"><mi id="S4.SS3.SSS1.p1.1.m1.1.1" xref="S4.SS3.SSS1.p1.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.1.m1.1b"><ci id="S4.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p1.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.1.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.1.m1.1d">italic_δ</annotation></semantics></math> to adapt to varying sizes of behaviors; 2. The k-means clustering is non-uniform, resulting in clusters of different sizes in the end.
We first verify the effectiveness of adaptive <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.2.m2.1"><semantics id="S4.SS3.SSS1.p1.2.m2.1a"><mi id="S4.SS3.SSS1.p1.2.m2.1.1" xref="S4.SS3.SSS1.p1.2.m2.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.2.m2.1b"><ci id="S4.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.2.m2.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.2.m2.1d">italic_δ</annotation></semantics></math>, creating a variant that uses a fixed cluster number <math alttext="\delta=2" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.3.m3.1"><semantics id="S4.SS3.SSS1.p1.3.m3.1a"><mrow id="S4.SS3.SSS1.p1.3.m3.1.1" xref="S4.SS3.SSS1.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS1.p1.3.m3.1.1.2" xref="S4.SS3.SSS1.p1.3.m3.1.1.2.cmml">δ</mi><mo id="S4.SS3.SSS1.p1.3.m3.1.1.1" xref="S4.SS3.SSS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS1.p1.3.m3.1.1.3" xref="S4.SS3.SSS1.p1.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.3.m3.1b"><apply id="S4.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p1.3.m3.1.1"><eq id="S4.SS3.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p1.3.m3.1.1.1"></eq><ci id="S4.SS3.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p1.3.m3.1.1.2">𝛿</ci><cn id="S4.SS3.SSS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.3.m3.1c">\delta=2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.3.m3.1d">italic_δ = 2</annotation></semantics></math> for all cases, denoted as ‘Binary’.
Furthermore, to test the effect of uniform cluster sizes, we create a variant that enforces balanced k-means clustering results when <math alttext="\delta=2" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.4.m4.1"><semantics id="S4.SS3.SSS1.p1.4.m4.1a"><mrow id="S4.SS3.SSS1.p1.4.m4.1.1" xref="S4.SS3.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p1.4.m4.1.1.2" xref="S4.SS3.SSS1.p1.4.m4.1.1.2.cmml">δ</mi><mo id="S4.SS3.SSS1.p1.4.m4.1.1.1" xref="S4.SS3.SSS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS1.p1.4.m4.1.1.3" xref="S4.SS3.SSS1.p1.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.4.m4.1b"><apply id="S4.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1"><eq id="S4.SS3.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1.1"></eq><ci id="S4.SS3.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1.2">𝛿</ci><cn id="S4.SS3.SSS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.4.m4.1c">\delta=2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.4.m4.1d">italic_δ = 2</annotation></semantics></math>, denoted as ‘Balanced&amp;Binary’.
In this variant, after each k-means iteration, a portion of items from the larger cluster, which are closer to the centroid of the other cluster, are moved to the other cluster to ensure equal sizes of the final two clusters.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.11.3.1" style="font-size:113%;">Table 4</span>. </span><span class="ltx_text" id="S4.T4.4.2" style="font-size:113%;"> Statistical analyses for different hierarchical clustering methods.
‘Adaptive’ denotes our method. ‘Binary’ denotes the variant with <math alttext="\delta=2" class="ltx_Math" display="inline" id="S4.T4.3.1.m1.1"><semantics id="S4.T4.3.1.m1.1b"><mrow id="S4.T4.3.1.m1.1.1" xref="S4.T4.3.1.m1.1.1.cmml"><mi id="S4.T4.3.1.m1.1.1.2" xref="S4.T4.3.1.m1.1.1.2.cmml">δ</mi><mo id="S4.T4.3.1.m1.1.1.1" xref="S4.T4.3.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.3.1.m1.1.1.3" xref="S4.T4.3.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.1.m1.1c"><apply id="S4.T4.3.1.m1.1.1.cmml" xref="S4.T4.3.1.m1.1.1"><eq id="S4.T4.3.1.m1.1.1.1.cmml" xref="S4.T4.3.1.m1.1.1.1"></eq><ci id="S4.T4.3.1.m1.1.1.2.cmml" xref="S4.T4.3.1.m1.1.1.2">𝛿</ci><cn id="S4.T4.3.1.m1.1.1.3.cmml" type="integer" xref="S4.T4.3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.1.m1.1d">\delta=2</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.1.m1.1e">italic_δ = 2</annotation></semantics></math>. ‘Balanced&amp;Binary’ denotes the variant with <math alttext="\delta=2" class="ltx_Math" display="inline" id="S4.T4.4.2.m2.1"><semantics id="S4.T4.4.2.m2.1b"><mrow id="S4.T4.4.2.m2.1.1" xref="S4.T4.4.2.m2.1.1.cmml"><mi id="S4.T4.4.2.m2.1.1.2" xref="S4.T4.4.2.m2.1.1.2.cmml">δ</mi><mo id="S4.T4.4.2.m2.1.1.1" xref="S4.T4.4.2.m2.1.1.1.cmml">=</mo><mn id="S4.T4.4.2.m2.1.1.3" xref="S4.T4.4.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.2.m2.1c"><apply id="S4.T4.4.2.m2.1.1.cmml" xref="S4.T4.4.2.m2.1.1"><eq id="S4.T4.4.2.m2.1.1.1.cmml" xref="S4.T4.4.2.m2.1.1.1"></eq><ci id="S4.T4.4.2.m2.1.1.2.cmml" xref="S4.T4.4.2.m2.1.1.2">𝛿</ci><cn id="S4.T4.4.2.m2.1.1.3.cmml" type="integer" xref="S4.T4.4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.2.m2.1d">\delta=2</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.2.m2.1e">italic_δ = 2</annotation></semantics></math> and enforced balanced k-means.
</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S4.T4.5">
<tr class="ltx_tr" id="S4.T4.5.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T4.5.1.2"><span class="ltx_text" id="S4.T4.5.1.2.1" style="font-size:80%;">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.5.1.1">
<span class="ltx_text" id="S4.T4.5.1.1.1" style="font-size:80%;">Cluster number </span><math alttext="\delta" class="ltx_Math" display="inline" id="S4.T4.5.1.1.m1.1"><semantics id="S4.T4.5.1.1.m1.1a"><mi id="S4.T4.5.1.1.m1.1.1" mathsize="80%" xref="S4.T4.5.1.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.T4.5.1.1.m1.1b"><ci id="S4.T4.5.1.1.m1.1.1.cmml" xref="S4.T4.5.1.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.1.1.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.1.1.m1.1d">italic_δ</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.5.1.3"><span class="ltx_text" id="S4.T4.5.1.3.1" style="font-size:80%;">Cluster Accuracy</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.5.1.4"><span class="ltx_text" id="S4.T4.5.1.4.1" style="font-size:80%;">Running Time (sec)</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.2.1"><span class="ltx_text" id="S4.T4.5.2.1.1" style="font-size:80%;">Balanced&amp;Binary</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.5.2.2"><span class="ltx_text" id="S4.T4.5.2.2.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.5.2.3"><span class="ltx_text" id="S4.T4.5.2.3.1" style="font-size:80%;">0.765</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.5.2.4"><span class="ltx_text" id="S4.T4.5.2.4.1" style="font-size:80%;">1.010</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.5.3.1"><span class="ltx_text" id="S4.T4.5.3.1.1" style="font-size:80%;">Binary</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.5.3.2"><span class="ltx_text" id="S4.T4.5.3.2.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.5.3.3"><span class="ltx_text" id="S4.T4.5.3.3.1" style="font-size:80%;">0.789</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.5.3.4"><span class="ltx_text" id="S4.T4.5.3.4.1" style="font-size:80%;">1.201</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.5.4.1"><span class="ltx_text" id="S4.T4.5.4.1.1" style="font-size:80%;">Adaptive (ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.5.4.2"><span class="ltx_text" id="S4.T4.5.4.2.1" style="font-size:80%;">dynamic</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.5.4.3"><span class="ltx_text" id="S4.T4.5.4.3.1" style="font-size:80%;">0.802</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.5.4.4"><span class="ltx_text" id="S4.T4.5.4.4.1" style="font-size:80%;">0.750</span></td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S4.I1">
<li class="ltx_item" id="S4.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span>
<div class="ltx_para" id="S4.I1.ix1.p1">
<p class="ltx_p" id="S4.I1.ix1.p1.1"><span class="ltx_text" id="S4.I1.ix1.p1.1.1" style="font-size:80%;">Cluster accuracy is measured by the average cosine similarity of each item to the centroid within each cluster.
Running time denotes the average time taken for each user to complete hierarchical clustering.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#S4.T4" title="Table 4 ‣ 4.3.1. Comparison of Different Hierarchical Clustering Methods ‣ 4.3. Ablation Study ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Table 4</span></a> reports the statistical analyses on TWIN-V2 and these two variants.
Among the three methods, ours achieves the highest cluster accuracy.
This suggests that our method creates clusters where items have more closely matched representation vectors, resulting in higher similarity among items within each cluster.
Our method also achieves the shortest running time, confirming the efficiency of adaptive <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.1.m1.1"><semantics id="S4.SS3.SSS1.p2.1.m1.1a"><mi id="S4.SS3.SSS1.p2.1.m1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.1.m1.1b"><ci id="S4.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.1.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.1.m1.1d">italic_δ</annotation></semantics></math>.
Furthermore, we reported the performance of these methods on the test set, as depicted in the left part of <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#S4.F4" title="Figure 4 ‣ 4.3.1. Comparison of Different Hierarchical Clustering Methods ‣ 4.3. Ablation Study ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Figure 4</span></a>.
These results validate that the adaptive method can assign more similar items within each cluster and speed up the hierarchical clustering process compared with other methods.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="803" id="S4.F4.1.g1" src="x4.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="803" id="S4.F4.2.g1" src="x5.png" width="830"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.4.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S4.F4.5.2" style="font-size:90%;">Effects of core modules in TWIN-V2.
Left: Comparisons between different hierarchical clustering methods.
Right: Impact of omitting cluster size in the reweighting of relevance scores.
</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2. </span>Effectiveness of Cluster-aware Target Attention</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.2">In the proposed cluster-aware target attention, as compared to TWIN, the main difference lies in using clustered behavior as input and reweighting the attention scores based on cluster size.
We separately removed the cluster size reweighting part from GSU and ESU to assess its impact on performance.
In specific, we replaced the <math alttext="\boldsymbol{\alpha}^{\prime}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.1.m1.1"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><msup id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml">𝜶</mi><mo id="S4.SS3.SSS2.p1.1.m1.1.1.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><apply id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2">𝜶</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">\boldsymbol{\alpha}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.1.m1.1d">bold_italic_α start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="\boldsymbol{\alpha}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.2.m2.1"><semantics id="S4.SS3.SSS2.p1.2.m2.1a"><mi id="S4.SS3.SSS2.p1.2.m2.1.1" xref="S4.SS3.SSS2.p1.2.m2.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.2.m2.1b"><ci id="S4.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p1.2.m2.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.2.m2.1c">\boldsymbol{\alpha}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.2.m2.1d">bold_italic_α</annotation></semantics></math> separately for both GSU and ESU in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#S3.E9" title="In 3.3.3. Cluster-aware Target Attention ‣ 3.3. Life-Cycle User Modeling ‣ 3. Method ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">9</span></a>).
The right part of <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#S4.F4" title="Figure 4 ‣ 4.3.1. Comparison of Different Hierarchical Clustering Methods ‣ 4.3. Ablation Study ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Figure 4</span></a> shows the experimental results.
Omitting reweighting leads to performance decline, validating the effectiveness of adjusting attention scores through cluster size.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Online Experiments</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">We conducted an online A/B test to validate the performance of TWIN-V2 in our industrial system.
<a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#S4.T5" title="Table 5 ‣ 4.4. Online Experiments ‣ 4. Experiment ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Table 5</span></a> illustrates the relative improvements of TWIN-V2 in terms of watch time and diversity of recommended results in three representative scenarios in Kuaishou (Featured-Video Tab, Discovery Tab, and Slide Tab).
Watch Time measures the total amount of time users spend.
Diversity refers to the variety in the model’s recommended outcomes, such as the richness in types of videos.
From the results, it is evident that TWIN-V2 can better model user interests, leading to improved watch time. Additionally, by modeling longer historical behaviors, TWIN-V2 uncovers a more diverse range of user interests, resulting in more varied and diverse recommended results.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5. </span>Results from online A/B test.
Both watch time and the diversity of recommended results demonstrated improvements compared with TWIN.
</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S4.T5.4">
<tr class="ltx_tr" id="S4.T5.4.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T5.4.1.1" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.1.1.1" style="font-size:90%;">Scenarios</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.4.1.2" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.1.2.1" style="font-size:90%;">Featured-Video Tab</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.4.1.3" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.1.3.1" style="font-size:90%;">Discovery Tab</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.4.1.4" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.4.1.4.1" style="font-size:90%;">Slide Tab</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T5.4.2.1" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text" id="S4.T5.4.2.1.1" style="font-size:90%;">Watch Time</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.2" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text" id="S4.T5.4.2.2.1" style="font-size:90%;">+0.672%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.3" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text" id="S4.T5.4.2.3.1" style="font-size:90%;">+0.800%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.4" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text" id="S4.T5.4.2.4.1" style="font-size:90%;">+0.728%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T5.4.3.1" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text" id="S4.T5.4.3.1.1" style="font-size:90%;">Diversity</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text" id="S4.T5.4.3.2.1" style="font-size:90%;">+0.262%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.3" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text" id="S4.T5.4.3.3.1" style="font-size:90%;">+0.740%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.4" style="padding-left:2.6pt;padding-right:2.6pt;"><span class="ltx_text" id="S4.T5.4.3.4.1" style="font-size:90%;">+0.005%</span></td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text" id="S4.I2.i1.p1.1.1" style="font-size:90%;">0.1% increase is a significant improvement that brings great business gains in Kuaishou.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we propose the TWIN-V2, which effectively extends the maximum length of user history to the life-cycle level, accommodating up to <math alttext="10^{6}" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><msup id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mn id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">10</mn><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">superscript</csymbol><cn id="S5.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.p1.1.m1.1.1.2">10</cn><cn id="S5.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.p1.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">10^{6}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math> behaviors in Kuaishou.
The offline hierarchical clustering and feature extraction methods compress ultra-long behaviors into shorter clusters, significantly reducing the storage and computational overhead for life-cycle behaviors by 90%.
The cluster-aware target attention for online inferring captures comprehensive and multi-faceted user interests, leading to more accurate and diverse recommendation results.
Extensive offline and online experiments have demonstrated the effectiveness of TWIN-V2 over SOTA baselines.
TWIN-V2 has been successfully deployed in Kuaishou, serving the main traffic of around 400 million active users daily.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yue Cao, Xiaojiang Zhou, Jiaqi Feng, Peihao Huang, Yao Xiao, Dayao Chen, and Sheng Chen. 2022.

</span>
<span class="ltx_bibblock">Sampling Is All You Need on Modeling Long-Term User Behaviors for CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</em> (Atlanta, GA, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib2.4.2">(CIKM ’22)</em>. Association for Computing Machinery, New York, NY, USA, 2974–2983.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3511808.3557082" title="">https://doi.org/10.1145/3511808.3557082</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chenbin Zhang, Zhiyi Fu, Xiaoxue Zang, Lin Guan, Jing Lu, Yiqun Hui, Dewei Leng, Yanan Niu, Yang Song, and Kun Gai. 2023.

</span>
<span class="ltx_bibblock">TWIN: TWo-Stage Interest Network for Lifelong User Behavior Modeling in CTR Prediction at Kuaishou. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib3.4.2">(KDD ’23)</em>. Association for Computing Machinery, New York, NY, USA, 3785–3794.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3580305.3599922" title="">https://doi.org/10.1145/3580305.3599922</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Qiwei Chen, Changhua Pei, Shanshan Lv, Chao Li, Junfeng Ge, and Wenwu Ou. 2021.

</span>
<span class="ltx_bibblock">End-to-End User Behavior Retrieval in Click-Through RatePrediction Model.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:cs.IR/2108.04468

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Qiwei Chen, Huan Zhao, Wei Li, Pipei Huang, and Wenwu Ou. 2019.

</span>
<span class="ltx_bibblock">Behavior Sequence Transformer for E-commerce Recommendation in Alibaba.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">CoRR</em> abs/1905.06874 (2019).

</span>
<span class="ltx_bibblock">arXiv:1905.06874

<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1905.06874" title="">http://arxiv.org/abs/1905.06874</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Heng-Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra, Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, Rohan Anil, Zakaria Haque, Lichan Hong, Vihan Jain, Xiaobing Liu, and Hemal Shah. 2016.

</span>
<span class="ltx_bibblock">Wide &amp; Deep Learning for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Proceedings of the 1st Workshop on Deep Learning for Recommender Systems</em> (Boston, MA, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib6.4.2">(DLRS 2016)</em>. Association for Computing Machinery, New York, NY, USA, 7–10.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2988450.2988454" title="">https://doi.org/10.1145/2988450.2988454</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Covington et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin. 2016.

</span>
<span class="ltx_bibblock">Deep Neural Networks for YouTube Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the 10th ACM Conference on Recommender Systems</em> (Boston, Massachusetts, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib7.4.2">(RecSys ’16)</em>. Association for Computing Machinery, New York, NY, USA, 191–198.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2959100.2959190" title="">https://doi.org/10.1145/2959100.2959190</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Yufei Feng, Fuyu Lv, Weichen Shen, Menghan Wang, Fei Sun, Yu Zhu, and Keping Yang. 2019.

</span>
<span class="ltx_bibblock">Deep Session Interest Network for Click-through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the 28th International Joint Conference on Artificial Intelligence</em> (Macao, China) <em class="ltx_emph ltx_font_italic" id="bib.bib8.4.2">(IJCAI’19)</em>. AAAI Press, 2301–2307.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He. 2017.

</span>
<span class="ltx_bibblock">DeepFM: A Factorization-Machine Based Neural Network for CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 26th International Joint Conference on Artificial Intelligence</em> (Melbourne, Australia) <em class="ltx_emph ltx_font_italic" id="bib.bib9.4.2">(IJCAI’17)</em>. AAAI Press, 1725–1731.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Juan et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yuchin Juan, Yong Zhuang, Wei-Sheng Chin, and Chih-Jen Lin. 2016.

</span>
<span class="ltx_bibblock">Field-Aware Factorization Machines for CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 10th ACM Conference on Recommender Systems</em> (Boston, Massachusetts, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib10.4.2">(RecSys ’16)</em>. Association for Computing Machinery, New York, NY, USA, 43–50.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2959100.2959134" title="">https://doi.org/10.1145/2959100.2959134</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Qi Liu, Xuyang Hou, Haoran Jin, jin Chen, Zhe Wang, Defu Lian, Tan Qu, Jia Cheng, and Jun Lei. 2023.

</span>
<span class="ltx_bibblock">Deep Group Interest Modeling of Full Lifelong User Behaviors for CTR Prediction.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:cs.IR/2311.10764

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Xiao Ma, Liqin Zhao, Guan Huang, Zhi Wang, Zelin Hu, Xiaoqiang Zhu, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Entire Space Multi-Task Model: An Effective Approach for Estimating Post-Click Conversion Rate. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">The 41st International ACM SIGIR Conference on Research &amp; Development in Information Retrieval</em> (Ann Arbor, MI, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib12.4.2">(SIGIR ’18)</em>. Association for Computing Machinery, New York, NY, USA, 1137–1140.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3209978.3210104" title="">https://doi.org/10.1145/3209978.3210104</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pi et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Qi Pi, Weijie Bian, Guorui Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Practice on Long Sequential User Behavior Modeling for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> (Anchorage, AK, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib13.4.2">(KDD ’19)</em>. Association for Computing Machinery, New York, NY, USA, 2671–2679.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3292500.3330666" title="">https://doi.org/10.1145/3292500.3330666</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pi et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Qi Pi, Guorui Zhou, Yujing Zhang, Zhe Wang, Lejian Ren, Ying Fan, Xiaoqiang Zhu, and Kun Gai. 2020.

</span>
<span class="ltx_bibblock">Search-Based User Interest Modeling with Lifelong Sequential Behavior Data for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em> (Virtual Event, Ireland) <em class="ltx_emph ltx_font_italic" id="bib.bib14.4.2">(CIKM ’20)</em>. Association for Computing Machinery, New York, NY, USA, 2685–2692.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3340531.3412744" title="">https://doi.org/10.1145/3340531.3412744</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jiarui Qin, Weinan Zhang, Rong Su, Zhirong Liu, Weiwen Liu, Guangpeng Zhao, Hao Li, Ruiming Tang, Xiuqiang He, and Yong Yu. 2023.

</span>
<span class="ltx_bibblock">Learning to Retrieve User Behaviors for Click-through Rate Estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">ACM Trans. Inf. Syst.</em> 41, 4, Article 98 (apr 2023), 31 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3579354" title="">https://doi.org/10.1145/3579354</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jiarui Qin, Weinan Zhang, Xin Wu, Jiarui Jin, Yuchen Fang, and Yong Yu. 2020.

</span>
<span class="ltx_bibblock">User Behavior Retrieval for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (Virtual Event, China) <em class="ltx_emph ltx_font_italic" id="bib.bib16.4.2">(SIGIR ’20)</em>. Association for Computing Machinery, New York, NY, USA, 2347–2356.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3397271.3401440" title="">https://doi.org/10.1145/3397271.3401440</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Kan Ren, Jiarui Qin, Yuchen Fang, Weinan Zhang, Lei Zheng, Weijie Bian, Guorui Zhou, Jian Xu, Yong Yu, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Lifelong Sequential Modeling with Personalized Memorization for User Response Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 42nd International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (Paris, France) <em class="ltx_emph ltx_font_italic" id="bib.bib17.4.2">(SIGIR’19)</em>. Association for Computing Machinery, New York, NY, USA, 565–574.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3331184.3331230" title="">https://doi.org/10.1145/3331184.3331230</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2010.

</span>
<span class="ltx_bibblock">Factorization Machines. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">2010 IEEE International Conference on Data Mining</em>. 995–1000.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ICDM.2010.127" title="">https://doi.org/10.1109/ICDM.2010.127</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Richardson et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2007)</span>
<span class="ltx_bibblock">
Matthew Richardson, Ewa Dominowska, and Robert Ragno. 2007.

</span>
<span class="ltx_bibblock">Predicting Clicks: Estimating the Click-through Rate for New Ads. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the 16th International Conference on World Wide Web</em> (Banff, Alberta, Canada) <em class="ltx_emph ltx_font_italic" id="bib.bib19.4.2">(WWW ’07)</em>. Association for Computing Machinery, New York, NY, USA, 521–530.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1242572.1242643" title="">https://doi.org/10.1145/1242572.1242643</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Weiping Song, Chence Shi, Zhiping Xiao, Zhijian Duan, Yewen Xu, Ming Zhang, and Jian Tang. 2019.

</span>
<span class="ltx_bibblock">AutoInt: Automatic Feature Interaction Learning via Self-Attentive Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</em> (Beijing, China) <em class="ltx_emph ltx_font_italic" id="bib.bib20.4.2">(CIKM ’19)</em>. Association for Computing Machinery, New York, NY, USA, 1161–1170.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3357384.3357925" title="">https://doi.org/10.1145/3357384.3357925</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Bin Fu, Gang Fu, and Mingliang Wang. 2017.

</span>
<span class="ltx_bibblock">Deep &amp; Cross Network for Ad Click Predictions. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the ADKDD’17</em> (Halifax, NS, Canada) <em class="ltx_emph ltx_font_italic" id="bib.bib21.4.2">(ADKDD’17)</em>. Association for Computing Machinery, New York, NY, USA, Article 12, 7 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3124749.3124754" title="">https://doi.org/10.1145/3124749.3124754</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Rakesh Shivanna, Derek Cheng, Sagar Jain, Dong Lin, Lichan Hong, and Ed Chi. 2021.

</span>
<span class="ltx_bibblock">DCN V2: Improved Deep &amp; Cross Network and Practical Lessons for Web-Scale Learning to Rank Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the Web Conference 2021</em> (Ljubljana, Slovenia) <em class="ltx_emph ltx_font_italic" id="bib.bib22.4.2">(WWW ’21)</em>. Association for Computing Machinery, New York, NY, USA, 1785–1797.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3442381.3450078" title="">https://doi.org/10.1145/3442381.3450078</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yuren Zhang, Enhong Chen, Binbin Jin, Hao Wang, Min Hou, Wei Huang, and Runlong Yu. 2022.

</span>
<span class="ltx_bibblock">Clustering Based Behavior Sampling with Long Sequential Data for CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (¡conf-loc¿, ¡city¿Madrid¡/city¿, ¡country¿Spain¡/country¿, ¡/conf-loc¿) <em class="ltx_emph ltx_font_italic" id="bib.bib23.4.2">(SIGIR ’22)</em>. Association for Computing Machinery, New York, NY, USA, 2195–2200.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3477495.3531829" title="">https://doi.org/10.1145/3477495.3531829</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Guorui Zhou, Na Mou, Ying Fan, Qi Pi, Weijie Bian, Chang Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Deep Interest Evolution Network for Click-Through Rate Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em> 33, 01 (Jul. 2019), 5941–5948.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1609/aaai.v33i01.33015941" title="">https://doi.org/10.1609/aaai.v33i01.33015941</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep Interest Network for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> (London, United Kingdom) <em class="ltx_emph ltx_font_italic" id="bib.bib25.4.2">(KDD ’18)</em>. Association for Computing Machinery, New York, NY, USA, 1059–1068.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3219819.3219823" title="">https://doi.org/10.1145/3219819.3219823</a>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>APPENDIX</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1. </span>Summary of Notations</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">We summarize the important notations used in Section 3 in the following table:</p>
</div>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 6. </span>Important Notations Used in Section 3.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="A1.T6.9.9">
<tr class="ltx_tr" id="A1.T6.3.3.3">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T6.1.1.1.1"><math alttext="f" class="ltx_Math" display="inline" id="A1.T6.1.1.1.1.m1.1"><semantics id="A1.T6.1.1.1.1.m1.1a"><mi id="A1.T6.1.1.1.1.m1.1.1" mathsize="90%" xref="A1.T6.1.1.1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.T6.1.1.1.1.m1.1b"><ci id="A1.T6.1.1.1.1.m1.1.1.cmml" xref="A1.T6.1.1.1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.1.1.1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.T6.1.1.1.1.m1.1d">italic_f</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T6.3.3.3.4"><span class="ltx_text" id="A1.T6.3.3.3.4.1" style="font-size:90%;">predictor</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T6.2.2.2.2"><math alttext="\sigma" class="ltx_Math" display="inline" id="A1.T6.2.2.2.2.m1.1"><semantics id="A1.T6.2.2.2.2.m1.1a"><mi id="A1.T6.2.2.2.2.m1.1.1" mathsize="90%" xref="A1.T6.2.2.2.2.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="A1.T6.2.2.2.2.m1.1b"><ci id="A1.T6.2.2.2.2.m1.1.1.cmml" xref="A1.T6.2.2.2.2.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.2.2.2.2.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="A1.T6.2.2.2.2.m1.1d">italic_σ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T6.3.3.3.5"><span class="ltx_text" id="A1.T6.3.3.3.5.1" style="font-size:90%;">sigmoid</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T6.3.3.3.3"><math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="A1.T6.3.3.3.3.m1.1"><semantics id="A1.T6.3.3.3.3.m1.1a"><mi id="A1.T6.3.3.3.3.m1.1.1" mathsize="90%" xref="A1.T6.3.3.3.3.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="A1.T6.3.3.3.3.m1.1b"><ci id="A1.T6.3.3.3.3.m1.1.1.cmml" xref="A1.T6.3.3.3.3.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.3.3.3.3.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.3.3.3.3.m1.1d">bold_x</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T6.3.3.3.6"><span class="ltx_text" id="A1.T6.3.3.3.6.1" style="font-size:90%;">feature vector</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.6.6.6">
<td class="ltx_td ltx_align_left" id="A1.T6.4.4.4.1"><math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="A1.T6.4.4.4.1.m1.1"><semantics id="A1.T6.4.4.4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.T6.4.4.4.1.m1.1.1" mathsize="90%" xref="A1.T6.4.4.4.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.T6.4.4.4.1.m1.1b"><ci id="A1.T6.4.4.4.1.m1.1.1.cmml" xref="A1.T6.4.4.4.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.4.4.4.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.4.4.4.1.m1.1d">caligraphic_D</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.6.6.6.4"><span class="ltx_text" id="A1.T6.6.6.6.4.1" style="font-size:90%;">dateset</span></td>
<td class="ltx_td ltx_align_left" id="A1.T6.5.5.5.2"><math alttext="\mathbb{R}" class="ltx_Math" display="inline" id="A1.T6.5.5.5.2.m1.1"><semantics id="A1.T6.5.5.5.2.m1.1a"><mi id="A1.T6.5.5.5.2.m1.1.1" mathsize="90%" xref="A1.T6.5.5.5.2.m1.1.1.cmml">ℝ</mi><annotation-xml encoding="MathML-Content" id="A1.T6.5.5.5.2.m1.1b"><ci id="A1.T6.5.5.5.2.m1.1.1.cmml" xref="A1.T6.5.5.5.2.m1.1.1">ℝ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.5.5.5.2.m1.1c">\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.5.5.5.2.m1.1d">blackboard_R</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.6.6.6.5"><span class="ltx_text" id="A1.T6.6.6.6.5.1" style="font-size:90%;">real number set</span></td>
<td class="ltx_td ltx_align_left" id="A1.T6.6.6.6.3"><math alttext="\hat{y}" class="ltx_Math" display="inline" id="A1.T6.6.6.6.3.m1.1"><semantics id="A1.T6.6.6.6.3.m1.1a"><mover accent="true" id="A1.T6.6.6.6.3.m1.1.1" xref="A1.T6.6.6.6.3.m1.1.1.cmml"><mi id="A1.T6.6.6.6.3.m1.1.1.2" mathsize="90%" xref="A1.T6.6.6.6.3.m1.1.1.2.cmml">y</mi><mo id="A1.T6.6.6.6.3.m1.1.1.1" mathsize="90%" xref="A1.T6.6.6.6.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.T6.6.6.6.3.m1.1b"><apply id="A1.T6.6.6.6.3.m1.1.1.cmml" xref="A1.T6.6.6.6.3.m1.1.1"><ci id="A1.T6.6.6.6.3.m1.1.1.1.cmml" xref="A1.T6.6.6.6.3.m1.1.1.1">^</ci><ci id="A1.T6.6.6.6.3.m1.1.1.2.cmml" xref="A1.T6.6.6.6.3.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.6.6.6.3.m1.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.6.6.6.3.m1.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.6.6.6.6"><span class="ltx_text" id="A1.T6.6.6.6.6.1" style="font-size:90%;">predicted CTR</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.9.9.9">
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.7.7.7.1"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="A1.T6.7.7.7.1.m1.1"><semantics id="A1.T6.7.7.7.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.T6.7.7.7.1.m1.1.1" mathsize="90%" xref="A1.T6.7.7.7.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="A1.T6.7.7.7.1.m1.1b"><ci id="A1.T6.7.7.7.1.m1.1.1.cmml" xref="A1.T6.7.7.7.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.7.7.7.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.7.7.7.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A1.T6.9.9.9.4"><span class="ltx_text" id="A1.T6.9.9.9.4.1" style="font-size:90%;">loss</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.8.8.8.2"><math alttext="d_{0}" class="ltx_Math" display="inline" id="A1.T6.8.8.8.2.m1.1"><semantics id="A1.T6.8.8.8.2.m1.1a"><msub id="A1.T6.8.8.8.2.m1.1.1" xref="A1.T6.8.8.8.2.m1.1.1.cmml"><mi id="A1.T6.8.8.8.2.m1.1.1.2" mathsize="90%" xref="A1.T6.8.8.8.2.m1.1.1.2.cmml">d</mi><mn id="A1.T6.8.8.8.2.m1.1.1.3" mathsize="90%" xref="A1.T6.8.8.8.2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.T6.8.8.8.2.m1.1b"><apply id="A1.T6.8.8.8.2.m1.1.1.cmml" xref="A1.T6.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.8.8.8.2.m1.1.1.1.cmml" xref="A1.T6.8.8.8.2.m1.1.1">subscript</csymbol><ci id="A1.T6.8.8.8.2.m1.1.1.2.cmml" xref="A1.T6.8.8.8.2.m1.1.1.2">𝑑</ci><cn id="A1.T6.8.8.8.2.m1.1.1.3.cmml" type="integer" xref="A1.T6.8.8.8.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.8.8.8.2.m1.1c">d_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.8.8.8.2.m1.1d">italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A1.T6.9.9.9.5"><span class="ltx_text" id="A1.T6.9.9.9.5.1" style="font-size:90%;">feature dimension</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.9.9.9.3"><math alttext="y" class="ltx_Math" display="inline" id="A1.T6.9.9.9.3.m1.1"><semantics id="A1.T6.9.9.9.3.m1.1a"><mi id="A1.T6.9.9.9.3.m1.1.1" mathsize="90%" xref="A1.T6.9.9.9.3.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.T6.9.9.9.3.m1.1b"><ci id="A1.T6.9.9.9.3.m1.1.1.cmml" xref="A1.T6.9.9.9.3.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.9.9.9.3.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="A1.T6.9.9.9.3.m1.1d">italic_y</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.9.9.9.6"><span class="ltx_text" id="A1.T6.9.9.9.6.1" style="font-size:90%;">ground truth label</span></td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="A1.T6.34.34">
<tr class="ltx_tr" id="A1.T6.12.12.3">
<td class="ltx_td ltx_align_left" id="A1.T6.10.10.1.1"><math alttext="S" class="ltx_Math" display="inline" id="A1.T6.10.10.1.1.m1.1"><semantics id="A1.T6.10.10.1.1.m1.1a"><mi id="A1.T6.10.10.1.1.m1.1.1" mathsize="90%" xref="A1.T6.10.10.1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.T6.10.10.1.1.m1.1b"><ci id="A1.T6.10.10.1.1.m1.1.1.cmml" xref="A1.T6.10.10.1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.10.10.1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.T6.10.10.1.1.m1.1d">italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.12.12.3.4"><span class="ltx_text" id="A1.T6.12.12.3.4.1" style="font-size:90%;">historical behaviors</span></td>
<td class="ltx_td ltx_align_left" id="A1.T6.11.11.2.2"><math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A1.T6.11.11.2.2.m1.1"><semantics id="A1.T6.11.11.2.2.m1.1a"><mi id="A1.T6.11.11.2.2.m1.1.1" mathsize="90%" xref="A1.T6.11.11.2.2.m1.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A1.T6.11.11.2.2.m1.1b"><ci id="A1.T6.11.11.2.2.m1.1.1.cmml" xref="A1.T6.11.11.2.2.m1.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.11.11.2.2.m1.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.11.11.2.2.m1.1d">bold_K</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.12.12.3.3">
<span class="ltx_text" id="A1.T6.12.12.3.3.1" style="font-size:90%;">cluster embeddings of </span><math alttext="C" class="ltx_Math" display="inline" id="A1.T6.12.12.3.3.m1.1"><semantics id="A1.T6.12.12.3.3.m1.1a"><mi id="A1.T6.12.12.3.3.m1.1.1" mathsize="90%" xref="A1.T6.12.12.3.3.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.T6.12.12.3.3.m1.1b"><ci id="A1.T6.12.12.3.3.m1.1.1.cmml" xref="A1.T6.12.12.3.3.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.12.12.3.3.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.T6.12.12.3.3.m1.1d">italic_C</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.15.15.6">
<td class="ltx_td ltx_align_left" id="A1.T6.13.13.4.1"><math alttext="C" class="ltx_Math" display="inline" id="A1.T6.13.13.4.1.m1.1"><semantics id="A1.T6.13.13.4.1.m1.1a"><mi id="A1.T6.13.13.4.1.m1.1.1" mathsize="90%" xref="A1.T6.13.13.4.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.T6.13.13.4.1.m1.1b"><ci id="A1.T6.13.13.4.1.m1.1.1.cmml" xref="A1.T6.13.13.4.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.13.13.4.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.T6.13.13.4.1.m1.1d">italic_C</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.15.15.6.4"><span class="ltx_text" id="A1.T6.15.15.6.4.1" style="font-size:90%;">clustered behaviors</span></td>
<td class="ltx_td ltx_align_left" id="A1.T6.14.14.5.2"><math alttext="P" class="ltx_Math" display="inline" id="A1.T6.14.14.5.2.m1.1"><semantics id="A1.T6.14.14.5.2.m1.1a"><mi id="A1.T6.14.14.5.2.m1.1.1" mathsize="90%" xref="A1.T6.14.14.5.2.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A1.T6.14.14.5.2.m1.1b"><ci id="A1.T6.14.14.5.2.m1.1.1.cmml" xref="A1.T6.14.14.5.2.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.14.14.5.2.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="A1.T6.14.14.5.2.m1.1d">italic_P</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.15.15.6.3">
<span class="ltx_text" id="A1.T6.15.15.6.3.1" style="font-size:90%;">playing completion ratio of </span><math alttext="S" class="ltx_Math" display="inline" id="A1.T6.15.15.6.3.m1.1"><semantics id="A1.T6.15.15.6.3.m1.1a"><mi id="A1.T6.15.15.6.3.m1.1.1" mathsize="90%" xref="A1.T6.15.15.6.3.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.T6.15.15.6.3.m1.1b"><ci id="A1.T6.15.15.6.3.m1.1.1.cmml" xref="A1.T6.15.15.6.3.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.15.15.6.3.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.T6.15.15.6.3.m1.1d">italic_S</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.20.20.11">
<td class="ltx_td ltx_align_left" id="A1.T6.16.16.7.1"><math alttext="s_{j}" class="ltx_Math" display="inline" id="A1.T6.16.16.7.1.m1.1"><semantics id="A1.T6.16.16.7.1.m1.1a"><msub id="A1.T6.16.16.7.1.m1.1.1" xref="A1.T6.16.16.7.1.m1.1.1.cmml"><mi id="A1.T6.16.16.7.1.m1.1.1.2" mathsize="90%" xref="A1.T6.16.16.7.1.m1.1.1.2.cmml">s</mi><mi id="A1.T6.16.16.7.1.m1.1.1.3" mathsize="90%" xref="A1.T6.16.16.7.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.16.16.7.1.m1.1b"><apply id="A1.T6.16.16.7.1.m1.1.1.cmml" xref="A1.T6.16.16.7.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.16.16.7.1.m1.1.1.1.cmml" xref="A1.T6.16.16.7.1.m1.1.1">subscript</csymbol><ci id="A1.T6.16.16.7.1.m1.1.1.2.cmml" xref="A1.T6.16.16.7.1.m1.1.1.2">𝑠</ci><ci id="A1.T6.16.16.7.1.m1.1.1.3.cmml" xref="A1.T6.16.16.7.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.16.16.7.1.m1.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.16.16.7.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.18.18.9.3">
<math alttext="j" class="ltx_Math" display="inline" id="A1.T6.17.17.8.2.m1.1"><semantics id="A1.T6.17.17.8.2.m1.1a"><mi id="A1.T6.17.17.8.2.m1.1.1" mathsize="90%" xref="A1.T6.17.17.8.2.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.T6.17.17.8.2.m1.1b"><ci id="A1.T6.17.17.8.2.m1.1.1.cmml" xref="A1.T6.17.17.8.2.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.17.17.8.2.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.T6.17.17.8.2.m1.1d">italic_j</annotation></semantics></math><span class="ltx_text" id="A1.T6.18.18.9.3.1" style="font-size:90%;">-th behavior in </span><math alttext="S" class="ltx_Math" display="inline" id="A1.T6.18.18.9.3.m2.1"><semantics id="A1.T6.18.18.9.3.m2.1a"><mi id="A1.T6.18.18.9.3.m2.1.1" mathsize="90%" xref="A1.T6.18.18.9.3.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.T6.18.18.9.3.m2.1b"><ci id="A1.T6.18.18.9.3.m2.1.1.cmml" xref="A1.T6.18.18.9.3.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.18.18.9.3.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.T6.18.18.9.3.m2.1d">italic_S</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A1.T6.19.19.10.4"><math alttext="p_{j}" class="ltx_Math" display="inline" id="A1.T6.19.19.10.4.m1.1"><semantics id="A1.T6.19.19.10.4.m1.1a"><msub id="A1.T6.19.19.10.4.m1.1.1" xref="A1.T6.19.19.10.4.m1.1.1.cmml"><mi id="A1.T6.19.19.10.4.m1.1.1.2" mathsize="90%" xref="A1.T6.19.19.10.4.m1.1.1.2.cmml">p</mi><mi id="A1.T6.19.19.10.4.m1.1.1.3" mathsize="90%" xref="A1.T6.19.19.10.4.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.19.19.10.4.m1.1b"><apply id="A1.T6.19.19.10.4.m1.1.1.cmml" xref="A1.T6.19.19.10.4.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.19.19.10.4.m1.1.1.1.cmml" xref="A1.T6.19.19.10.4.m1.1.1">subscript</csymbol><ci id="A1.T6.19.19.10.4.m1.1.1.2.cmml" xref="A1.T6.19.19.10.4.m1.1.1.2">𝑝</ci><ci id="A1.T6.19.19.10.4.m1.1.1.3.cmml" xref="A1.T6.19.19.10.4.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.19.19.10.4.m1.1c">p_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.19.19.10.4.m1.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.20.20.11.5">
<span class="ltx_text" id="A1.T6.20.20.11.5.1" style="font-size:90%;">playing completion ratio of </span><math alttext="s_{j}" class="ltx_Math" display="inline" id="A1.T6.20.20.11.5.m1.1"><semantics id="A1.T6.20.20.11.5.m1.1a"><msub id="A1.T6.20.20.11.5.m1.1.1" xref="A1.T6.20.20.11.5.m1.1.1.cmml"><mi id="A1.T6.20.20.11.5.m1.1.1.2" mathsize="90%" xref="A1.T6.20.20.11.5.m1.1.1.2.cmml">s</mi><mi id="A1.T6.20.20.11.5.m1.1.1.3" mathsize="90%" xref="A1.T6.20.20.11.5.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.20.20.11.5.m1.1b"><apply id="A1.T6.20.20.11.5.m1.1.1.cmml" xref="A1.T6.20.20.11.5.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.20.20.11.5.m1.1.1.1.cmml" xref="A1.T6.20.20.11.5.m1.1.1">subscript</csymbol><ci id="A1.T6.20.20.11.5.m1.1.1.2.cmml" xref="A1.T6.20.20.11.5.m1.1.1.2">𝑠</ci><ci id="A1.T6.20.20.11.5.m1.1.1.3.cmml" xref="A1.T6.20.20.11.5.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.20.20.11.5.m1.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.20.20.11.5.m1.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.24.24.15">
<td class="ltx_td ltx_align_left" id="A1.T6.21.21.12.1"><math alttext="c_{i}" class="ltx_Math" display="inline" id="A1.T6.21.21.12.1.m1.1"><semantics id="A1.T6.21.21.12.1.m1.1a"><msub id="A1.T6.21.21.12.1.m1.1.1" xref="A1.T6.21.21.12.1.m1.1.1.cmml"><mi id="A1.T6.21.21.12.1.m1.1.1.2" mathsize="90%" xref="A1.T6.21.21.12.1.m1.1.1.2.cmml">c</mi><mi id="A1.T6.21.21.12.1.m1.1.1.3" mathsize="90%" xref="A1.T6.21.21.12.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.21.21.12.1.m1.1b"><apply id="A1.T6.21.21.12.1.m1.1.1.cmml" xref="A1.T6.21.21.12.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.21.21.12.1.m1.1.1.1.cmml" xref="A1.T6.21.21.12.1.m1.1.1">subscript</csymbol><ci id="A1.T6.21.21.12.1.m1.1.1.2.cmml" xref="A1.T6.21.21.12.1.m1.1.1.2">𝑐</ci><ci id="A1.T6.21.21.12.1.m1.1.1.3.cmml" xref="A1.T6.21.21.12.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.21.21.12.1.m1.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.21.21.12.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.23.23.14.3">
<math alttext="i" class="ltx_Math" display="inline" id="A1.T6.22.22.13.2.m1.1"><semantics id="A1.T6.22.22.13.2.m1.1a"><mi id="A1.T6.22.22.13.2.m1.1.1" mathsize="90%" xref="A1.T6.22.22.13.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.T6.22.22.13.2.m1.1b"><ci id="A1.T6.22.22.13.2.m1.1.1.cmml" xref="A1.T6.22.22.13.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.22.22.13.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.T6.22.22.13.2.m1.1d">italic_i</annotation></semantics></math><span class="ltx_text" id="A1.T6.23.23.14.3.1" style="font-size:90%;">-th cluster in </span><math alttext="C" class="ltx_Math" display="inline" id="A1.T6.23.23.14.3.m2.1"><semantics id="A1.T6.23.23.14.3.m2.1a"><mi id="A1.T6.23.23.14.3.m2.1.1" mathsize="90%" xref="A1.T6.23.23.14.3.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.T6.23.23.14.3.m2.1b"><ci id="A1.T6.23.23.14.3.m2.1.1.cmml" xref="A1.T6.23.23.14.3.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.23.23.14.3.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.T6.23.23.14.3.m2.1d">italic_C</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A1.T6.24.24.15.4"><math alttext="M" class="ltx_Math" display="inline" id="A1.T6.24.24.15.4.m1.1"><semantics id="A1.T6.24.24.15.4.m1.1a"><mi id="A1.T6.24.24.15.4.m1.1.1" mathsize="90%" xref="A1.T6.24.24.15.4.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A1.T6.24.24.15.4.m1.1b"><ci id="A1.T6.24.24.15.4.m1.1.1.cmml" xref="A1.T6.24.24.15.4.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.24.24.15.4.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="A1.T6.24.24.15.4.m1.1d">italic_M</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.24.24.15.5"><span class="ltx_text" id="A1.T6.24.24.15.5.1" style="font-size:90%;">group number</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.28.28.19">
<td class="ltx_td ltx_align_left" id="A1.T6.25.25.16.1"><math alttext="T" class="ltx_Math" display="inline" id="A1.T6.25.25.16.1.m1.1"><semantics id="A1.T6.25.25.16.1.m1.1a"><mi id="A1.T6.25.25.16.1.m1.1.1" mathsize="90%" xref="A1.T6.25.25.16.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A1.T6.25.25.16.1.m1.1b"><ci id="A1.T6.25.25.16.1.m1.1.1.cmml" xref="A1.T6.25.25.16.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.25.25.16.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="A1.T6.25.25.16.1.m1.1d">italic_T</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.26.26.17.2">
<span class="ltx_text" id="A1.T6.26.26.17.2.1" style="font-size:90%;">length of </span><math alttext="S" class="ltx_Math" display="inline" id="A1.T6.26.26.17.2.m1.1"><semantics id="A1.T6.26.26.17.2.m1.1a"><mi id="A1.T6.26.26.17.2.m1.1.1" mathsize="90%" xref="A1.T6.26.26.17.2.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.T6.26.26.17.2.m1.1b"><ci id="A1.T6.26.26.17.2.m1.1.1.cmml" xref="A1.T6.26.26.17.2.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.26.26.17.2.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.T6.26.26.17.2.m1.1d">italic_S</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A1.T6.27.27.18.3"><math alttext="L_{m}" class="ltx_Math" display="inline" id="A1.T6.27.27.18.3.m1.1"><semantics id="A1.T6.27.27.18.3.m1.1a"><msub id="A1.T6.27.27.18.3.m1.1.1" xref="A1.T6.27.27.18.3.m1.1.1.cmml"><mi id="A1.T6.27.27.18.3.m1.1.1.2" mathsize="90%" xref="A1.T6.27.27.18.3.m1.1.1.2.cmml">L</mi><mi id="A1.T6.27.27.18.3.m1.1.1.3" mathsize="90%" xref="A1.T6.27.27.18.3.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.27.27.18.3.m1.1b"><apply id="A1.T6.27.27.18.3.m1.1.1.cmml" xref="A1.T6.27.27.18.3.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.27.27.18.3.m1.1.1.1.cmml" xref="A1.T6.27.27.18.3.m1.1.1">subscript</csymbol><ci id="A1.T6.27.27.18.3.m1.1.1.2.cmml" xref="A1.T6.27.27.18.3.m1.1.1.2">𝐿</ci><ci id="A1.T6.27.27.18.3.m1.1.1.3.cmml" xref="A1.T6.27.27.18.3.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.27.27.18.3.m1.1c">L_{m}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.27.27.18.3.m1.1d">italic_L start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.28.28.19.4">
<math alttext="m" class="ltx_Math" display="inline" id="A1.T6.28.28.19.4.m1.1"><semantics id="A1.T6.28.28.19.4.m1.1a"><mi id="A1.T6.28.28.19.4.m1.1.1" mathsize="90%" xref="A1.T6.28.28.19.4.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A1.T6.28.28.19.4.m1.1b"><ci id="A1.T6.28.28.19.4.m1.1.1.cmml" xref="A1.T6.28.28.19.4.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.28.28.19.4.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="A1.T6.28.28.19.4.m1.1d">italic_m</annotation></semantics></math><span class="ltx_text" id="A1.T6.28.28.19.4.1" style="font-size:90%;">-th item group</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.31.31.22">
<td class="ltx_td ltx_align_left" id="A1.T6.29.29.20.1"><math alttext="\hat{T}" class="ltx_Math" display="inline" id="A1.T6.29.29.20.1.m1.1"><semantics id="A1.T6.29.29.20.1.m1.1a"><mover accent="true" id="A1.T6.29.29.20.1.m1.1.1" xref="A1.T6.29.29.20.1.m1.1.1.cmml"><mi id="A1.T6.29.29.20.1.m1.1.1.2" mathsize="90%" xref="A1.T6.29.29.20.1.m1.1.1.2.cmml">T</mi><mo id="A1.T6.29.29.20.1.m1.1.1.1" mathsize="90%" xref="A1.T6.29.29.20.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.T6.29.29.20.1.m1.1b"><apply id="A1.T6.29.29.20.1.m1.1.1.cmml" xref="A1.T6.29.29.20.1.m1.1.1"><ci id="A1.T6.29.29.20.1.m1.1.1.1.cmml" xref="A1.T6.29.29.20.1.m1.1.1.1">^</ci><ci id="A1.T6.29.29.20.1.m1.1.1.2.cmml" xref="A1.T6.29.29.20.1.m1.1.1.2">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.29.29.20.1.m1.1c">\hat{T}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.29.29.20.1.m1.1d">over^ start_ARG italic_T end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.30.30.21.2">
<span class="ltx_text" id="A1.T6.30.30.21.2.1" style="font-size:90%;">length of </span><math alttext="C" class="ltx_Math" display="inline" id="A1.T6.30.30.21.2.m1.1"><semantics id="A1.T6.30.30.21.2.m1.1a"><mi id="A1.T6.30.30.21.2.m1.1.1" mathsize="90%" xref="A1.T6.30.30.21.2.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.T6.30.30.21.2.m1.1b"><ci id="A1.T6.30.30.21.2.m1.1.1.cmml" xref="A1.T6.30.30.21.2.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.30.30.21.2.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.T6.30.30.21.2.m1.1d">italic_C</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A1.T6.31.31.22.3"><math alttext="\gamma" class="ltx_Math" display="inline" id="A1.T6.31.31.22.3.m1.1"><semantics id="A1.T6.31.31.22.3.m1.1a"><mi id="A1.T6.31.31.22.3.m1.1.1" mathsize="90%" xref="A1.T6.31.31.22.3.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.T6.31.31.22.3.m1.1b"><ci id="A1.T6.31.31.22.3.m1.1.1.cmml" xref="A1.T6.31.31.22.3.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.31.31.22.3.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.T6.31.31.22.3.m1.1d">italic_γ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.31.31.22.4"><span class="ltx_text" id="A1.T6.31.31.22.4.1" style="font-size:90%;">maximum cluster size</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.34.34.25">
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.32.32.23.1"><math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="A1.T6.32.32.23.1.m1.1"><semantics id="A1.T6.32.32.23.1.m1.1a"><msub id="A1.T6.32.32.23.1.m1.1.1" xref="A1.T6.32.32.23.1.m1.1.1.cmml"><mi id="A1.T6.32.32.23.1.m1.1.1.2" mathsize="90%" xref="A1.T6.32.32.23.1.m1.1.1.2.cmml">𝐊</mi><mi id="A1.T6.32.32.23.1.m1.1.1.3" mathsize="90%" xref="A1.T6.32.32.23.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.32.32.23.1.m1.1b"><apply id="A1.T6.32.32.23.1.m1.1.1.cmml" xref="A1.T6.32.32.23.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.32.32.23.1.m1.1.1.1.cmml" xref="A1.T6.32.32.23.1.m1.1.1">subscript</csymbol><ci id="A1.T6.32.32.23.1.m1.1.1.2.cmml" xref="A1.T6.32.32.23.1.m1.1.1.2">𝐊</ci><ci id="A1.T6.32.32.23.1.m1.1.1.3.cmml" xref="A1.T6.32.32.23.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.32.32.23.1.m1.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.32.32.23.1.m1.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A1.T6.33.33.24.2">
<span class="ltx_text" id="A1.T6.33.33.24.2.1" style="font-size:90%;">item embeddings of </span><math alttext="S" class="ltx_Math" display="inline" id="A1.T6.33.33.24.2.m1.1"><semantics id="A1.T6.33.33.24.2.m1.1a"><mi id="A1.T6.33.33.24.2.m1.1.1" mathsize="90%" xref="A1.T6.33.33.24.2.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.T6.33.33.24.2.m1.1b"><ci id="A1.T6.33.33.24.2.m1.1.1.cmml" xref="A1.T6.33.33.24.2.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.33.33.24.2.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.T6.33.33.24.2.m1.1d">italic_S</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.34.34.25.3"><math alttext="\delta" class="ltx_Math" display="inline" id="A1.T6.34.34.25.3.m1.1"><semantics id="A1.T6.34.34.25.3.m1.1a"><mi id="A1.T6.34.34.25.3.m1.1.1" mathsize="90%" xref="A1.T6.34.34.25.3.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="A1.T6.34.34.25.3.m1.1b"><ci id="A1.T6.34.34.25.3.m1.1.1.cmml" xref="A1.T6.34.34.25.3.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.34.34.25.3.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="A1.T6.34.34.25.3.m1.1d">italic_δ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.34.34.25.4"><span class="ltx_text" id="A1.T6.34.34.25.4.1" style="font-size:90%;">adaptive cluster number</span></td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="A1.T6.49.49">
<tr class="ltx_tr" id="A1.T6.38.38.4">
<td class="ltx_td ltx_align_left" id="A1.T6.35.35.1.1"><math alttext="\mathbf{x}_{v}" class="ltx_Math" display="inline" id="A1.T6.35.35.1.1.m1.1"><semantics id="A1.T6.35.35.1.1.m1.1a"><msub id="A1.T6.35.35.1.1.m1.1.1" xref="A1.T6.35.35.1.1.m1.1.1.cmml"><mi id="A1.T6.35.35.1.1.m1.1.1.2" mathsize="90%" xref="A1.T6.35.35.1.1.m1.1.1.2.cmml">𝐱</mi><mi id="A1.T6.35.35.1.1.m1.1.1.3" mathsize="90%" xref="A1.T6.35.35.1.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.35.35.1.1.m1.1b"><apply id="A1.T6.35.35.1.1.m1.1.1.cmml" xref="A1.T6.35.35.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.35.35.1.1.m1.1.1.1.cmml" xref="A1.T6.35.35.1.1.m1.1.1">subscript</csymbol><ci id="A1.T6.35.35.1.1.m1.1.1.2.cmml" xref="A1.T6.35.35.1.1.m1.1.1.2">𝐱</ci><ci id="A1.T6.35.35.1.1.m1.1.1.3.cmml" xref="A1.T6.35.35.1.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.35.35.1.1.m1.1c">\mathbf{x}_{v}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.35.35.1.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.36.36.2.2">
<span class="ltx_text" id="A1.T6.36.36.2.2.1" style="font-size:90%;">feature vector of item </span><math alttext="v" class="ltx_Math" display="inline" id="A1.T6.36.36.2.2.m1.1"><semantics id="A1.T6.36.36.2.2.m1.1a"><mi id="A1.T6.36.36.2.2.m1.1.1" mathsize="90%" xref="A1.T6.36.36.2.2.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A1.T6.36.36.2.2.m1.1b"><ci id="A1.T6.36.36.2.2.m1.1.1.cmml" xref="A1.T6.36.36.2.2.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.36.36.2.2.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="A1.T6.36.36.2.2.m1.1d">italic_v</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A1.T6.37.37.3.3"><math alttext="\mathbf{c}_{i}" class="ltx_Math" display="inline" id="A1.T6.37.37.3.3.m1.1"><semantics id="A1.T6.37.37.3.3.m1.1a"><msub id="A1.T6.37.37.3.3.m1.1.1" xref="A1.T6.37.37.3.3.m1.1.1.cmml"><mi id="A1.T6.37.37.3.3.m1.1.1.2" mathsize="90%" xref="A1.T6.37.37.3.3.m1.1.1.2.cmml">𝐜</mi><mi id="A1.T6.37.37.3.3.m1.1.1.3" mathsize="90%" xref="A1.T6.37.37.3.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.37.37.3.3.m1.1b"><apply id="A1.T6.37.37.3.3.m1.1.1.cmml" xref="A1.T6.37.37.3.3.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.37.37.3.3.m1.1.1.1.cmml" xref="A1.T6.37.37.3.3.m1.1.1">subscript</csymbol><ci id="A1.T6.37.37.3.3.m1.1.1.2.cmml" xref="A1.T6.37.37.3.3.m1.1.1.2">𝐜</ci><ci id="A1.T6.37.37.3.3.m1.1.1.3.cmml" xref="A1.T6.37.37.3.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.37.37.3.3.m1.1c">\mathbf{c}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.37.37.3.3.m1.1d">bold_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.38.38.4.4">
<span class="ltx_text" id="A1.T6.38.38.4.4.1" style="font-size:90%;">feature vector of cluster </span><math alttext="c_{i}" class="ltx_Math" display="inline" id="A1.T6.38.38.4.4.m1.1"><semantics id="A1.T6.38.38.4.4.m1.1a"><msub id="A1.T6.38.38.4.4.m1.1.1" xref="A1.T6.38.38.4.4.m1.1.1.cmml"><mi id="A1.T6.38.38.4.4.m1.1.1.2" mathsize="90%" xref="A1.T6.38.38.4.4.m1.1.1.2.cmml">c</mi><mi id="A1.T6.38.38.4.4.m1.1.1.3" mathsize="90%" xref="A1.T6.38.38.4.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.38.38.4.4.m1.1b"><apply id="A1.T6.38.38.4.4.m1.1.1.cmml" xref="A1.T6.38.38.4.4.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.38.38.4.4.m1.1.1.1.cmml" xref="A1.T6.38.38.4.4.m1.1.1">subscript</csymbol><ci id="A1.T6.38.38.4.4.m1.1.1.2.cmml" xref="A1.T6.38.38.4.4.m1.1.1.2">𝑐</ci><ci id="A1.T6.38.38.4.4.m1.1.1.3.cmml" xref="A1.T6.38.38.4.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.38.38.4.4.m1.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.38.38.4.4.m1.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.42.42.8">
<td class="ltx_td ltx_align_left" id="A1.T6.39.39.5.1"><math alttext="\mathbf{x}_{1:N_{1}}^{(v)}" class="ltx_Math" display="inline" id="A1.T6.39.39.5.1.m1.1"><semantics id="A1.T6.39.39.5.1.m1.1a"><msubsup id="A1.T6.39.39.5.1.m1.1.2" xref="A1.T6.39.39.5.1.m1.1.2.cmml"><mi id="A1.T6.39.39.5.1.m1.1.2.2.2" mathsize="90%" xref="A1.T6.39.39.5.1.m1.1.2.2.2.cmml">𝐱</mi><mrow id="A1.T6.39.39.5.1.m1.1.2.2.3" xref="A1.T6.39.39.5.1.m1.1.2.2.3.cmml"><mn id="A1.T6.39.39.5.1.m1.1.2.2.3.2" mathsize="90%" xref="A1.T6.39.39.5.1.m1.1.2.2.3.2.cmml">1</mn><mo id="A1.T6.39.39.5.1.m1.1.2.2.3.1" lspace="0.278em" mathsize="90%" rspace="0.278em" xref="A1.T6.39.39.5.1.m1.1.2.2.3.1.cmml">:</mo><msub id="A1.T6.39.39.5.1.m1.1.2.2.3.3" xref="A1.T6.39.39.5.1.m1.1.2.2.3.3.cmml"><mi id="A1.T6.39.39.5.1.m1.1.2.2.3.3.2" mathsize="90%" xref="A1.T6.39.39.5.1.m1.1.2.2.3.3.2.cmml">N</mi><mn id="A1.T6.39.39.5.1.m1.1.2.2.3.3.3" mathsize="90%" xref="A1.T6.39.39.5.1.m1.1.2.2.3.3.3.cmml">1</mn></msub></mrow><mrow id="A1.T6.39.39.5.1.m1.1.1.1.3" xref="A1.T6.39.39.5.1.m1.1.2.cmml"><mo id="A1.T6.39.39.5.1.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="A1.T6.39.39.5.1.m1.1.2.cmml">(</mo><mi id="A1.T6.39.39.5.1.m1.1.1.1.1" mathsize="90%" xref="A1.T6.39.39.5.1.m1.1.1.1.1.cmml">v</mi><mo id="A1.T6.39.39.5.1.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="A1.T6.39.39.5.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.T6.39.39.5.1.m1.1b"><apply id="A1.T6.39.39.5.1.m1.1.2.cmml" xref="A1.T6.39.39.5.1.m1.1.2"><csymbol cd="ambiguous" id="A1.T6.39.39.5.1.m1.1.2.1.cmml" xref="A1.T6.39.39.5.1.m1.1.2">superscript</csymbol><apply id="A1.T6.39.39.5.1.m1.1.2.2.cmml" xref="A1.T6.39.39.5.1.m1.1.2"><csymbol cd="ambiguous" id="A1.T6.39.39.5.1.m1.1.2.2.1.cmml" xref="A1.T6.39.39.5.1.m1.1.2">subscript</csymbol><ci id="A1.T6.39.39.5.1.m1.1.2.2.2.cmml" xref="A1.T6.39.39.5.1.m1.1.2.2.2">𝐱</ci><apply id="A1.T6.39.39.5.1.m1.1.2.2.3.cmml" xref="A1.T6.39.39.5.1.m1.1.2.2.3"><ci id="A1.T6.39.39.5.1.m1.1.2.2.3.1.cmml" xref="A1.T6.39.39.5.1.m1.1.2.2.3.1">:</ci><cn id="A1.T6.39.39.5.1.m1.1.2.2.3.2.cmml" type="integer" xref="A1.T6.39.39.5.1.m1.1.2.2.3.2">1</cn><apply id="A1.T6.39.39.5.1.m1.1.2.2.3.3.cmml" xref="A1.T6.39.39.5.1.m1.1.2.2.3.3"><csymbol cd="ambiguous" id="A1.T6.39.39.5.1.m1.1.2.2.3.3.1.cmml" xref="A1.T6.39.39.5.1.m1.1.2.2.3.3">subscript</csymbol><ci id="A1.T6.39.39.5.1.m1.1.2.2.3.3.2.cmml" xref="A1.T6.39.39.5.1.m1.1.2.2.3.3.2">𝑁</ci><cn id="A1.T6.39.39.5.1.m1.1.2.2.3.3.3.cmml" type="integer" xref="A1.T6.39.39.5.1.m1.1.2.2.3.3.3">1</cn></apply></apply></apply><ci id="A1.T6.39.39.5.1.m1.1.1.1.1.cmml" xref="A1.T6.39.39.5.1.m1.1.1.1.1">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.39.39.5.1.m1.1c">\mathbf{x}_{1:N_{1}}^{(v)}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.39.39.5.1.m1.1d">bold_x start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.40.40.6.2">
<span class="ltx_text" id="A1.T6.40.40.6.2.1" style="font-size:90%;">categorical part of </span><math alttext="\mathbf{x}_{v}" class="ltx_Math" display="inline" id="A1.T6.40.40.6.2.m1.1"><semantics id="A1.T6.40.40.6.2.m1.1a"><msub id="A1.T6.40.40.6.2.m1.1.1" xref="A1.T6.40.40.6.2.m1.1.1.cmml"><mi id="A1.T6.40.40.6.2.m1.1.1.2" mathsize="90%" xref="A1.T6.40.40.6.2.m1.1.1.2.cmml">𝐱</mi><mi id="A1.T6.40.40.6.2.m1.1.1.3" mathsize="90%" xref="A1.T6.40.40.6.2.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.40.40.6.2.m1.1b"><apply id="A1.T6.40.40.6.2.m1.1.1.cmml" xref="A1.T6.40.40.6.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.40.40.6.2.m1.1.1.1.cmml" xref="A1.T6.40.40.6.2.m1.1.1">subscript</csymbol><ci id="A1.T6.40.40.6.2.m1.1.1.2.cmml" xref="A1.T6.40.40.6.2.m1.1.1.2">𝐱</ci><ci id="A1.T6.40.40.6.2.m1.1.1.3.cmml" xref="A1.T6.40.40.6.2.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.40.40.6.2.m1.1c">\mathbf{x}_{v}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.40.40.6.2.m1.1d">bold_x start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A1.T6.41.41.7.3"><math alttext="\mathbf{c}_{1:N_{1}}^{(i)}" class="ltx_Math" display="inline" id="A1.T6.41.41.7.3.m1.1"><semantics id="A1.T6.41.41.7.3.m1.1a"><msubsup id="A1.T6.41.41.7.3.m1.1.2" xref="A1.T6.41.41.7.3.m1.1.2.cmml"><mi id="A1.T6.41.41.7.3.m1.1.2.2.2" mathsize="90%" xref="A1.T6.41.41.7.3.m1.1.2.2.2.cmml">𝐜</mi><mrow id="A1.T6.41.41.7.3.m1.1.2.2.3" xref="A1.T6.41.41.7.3.m1.1.2.2.3.cmml"><mn id="A1.T6.41.41.7.3.m1.1.2.2.3.2" mathsize="90%" xref="A1.T6.41.41.7.3.m1.1.2.2.3.2.cmml">1</mn><mo id="A1.T6.41.41.7.3.m1.1.2.2.3.1" lspace="0.278em" mathsize="90%" rspace="0.278em" xref="A1.T6.41.41.7.3.m1.1.2.2.3.1.cmml">:</mo><msub id="A1.T6.41.41.7.3.m1.1.2.2.3.3" xref="A1.T6.41.41.7.3.m1.1.2.2.3.3.cmml"><mi id="A1.T6.41.41.7.3.m1.1.2.2.3.3.2" mathsize="90%" xref="A1.T6.41.41.7.3.m1.1.2.2.3.3.2.cmml">N</mi><mn id="A1.T6.41.41.7.3.m1.1.2.2.3.3.3" mathsize="90%" xref="A1.T6.41.41.7.3.m1.1.2.2.3.3.3.cmml">1</mn></msub></mrow><mrow id="A1.T6.41.41.7.3.m1.1.1.1.3" xref="A1.T6.41.41.7.3.m1.1.2.cmml"><mo id="A1.T6.41.41.7.3.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="A1.T6.41.41.7.3.m1.1.2.cmml">(</mo><mi id="A1.T6.41.41.7.3.m1.1.1.1.1" mathsize="90%" xref="A1.T6.41.41.7.3.m1.1.1.1.1.cmml">i</mi><mo id="A1.T6.41.41.7.3.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="A1.T6.41.41.7.3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.T6.41.41.7.3.m1.1b"><apply id="A1.T6.41.41.7.3.m1.1.2.cmml" xref="A1.T6.41.41.7.3.m1.1.2"><csymbol cd="ambiguous" id="A1.T6.41.41.7.3.m1.1.2.1.cmml" xref="A1.T6.41.41.7.3.m1.1.2">superscript</csymbol><apply id="A1.T6.41.41.7.3.m1.1.2.2.cmml" xref="A1.T6.41.41.7.3.m1.1.2"><csymbol cd="ambiguous" id="A1.T6.41.41.7.3.m1.1.2.2.1.cmml" xref="A1.T6.41.41.7.3.m1.1.2">subscript</csymbol><ci id="A1.T6.41.41.7.3.m1.1.2.2.2.cmml" xref="A1.T6.41.41.7.3.m1.1.2.2.2">𝐜</ci><apply id="A1.T6.41.41.7.3.m1.1.2.2.3.cmml" xref="A1.T6.41.41.7.3.m1.1.2.2.3"><ci id="A1.T6.41.41.7.3.m1.1.2.2.3.1.cmml" xref="A1.T6.41.41.7.3.m1.1.2.2.3.1">:</ci><cn id="A1.T6.41.41.7.3.m1.1.2.2.3.2.cmml" type="integer" xref="A1.T6.41.41.7.3.m1.1.2.2.3.2">1</cn><apply id="A1.T6.41.41.7.3.m1.1.2.2.3.3.cmml" xref="A1.T6.41.41.7.3.m1.1.2.2.3.3"><csymbol cd="ambiguous" id="A1.T6.41.41.7.3.m1.1.2.2.3.3.1.cmml" xref="A1.T6.41.41.7.3.m1.1.2.2.3.3">subscript</csymbol><ci id="A1.T6.41.41.7.3.m1.1.2.2.3.3.2.cmml" xref="A1.T6.41.41.7.3.m1.1.2.2.3.3.2">𝑁</ci><cn id="A1.T6.41.41.7.3.m1.1.2.2.3.3.3.cmml" type="integer" xref="A1.T6.41.41.7.3.m1.1.2.2.3.3.3">1</cn></apply></apply></apply><ci id="A1.T6.41.41.7.3.m1.1.1.1.1.cmml" xref="A1.T6.41.41.7.3.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.41.41.7.3.m1.1c">\mathbf{c}_{1:N_{1}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.41.41.7.3.m1.1d">bold_c start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.42.42.8.4">
<span class="ltx_text" id="A1.T6.42.42.8.4.1" style="font-size:90%;">categorical part of </span><math alttext="\mathbf{c}_{i}" class="ltx_Math" display="inline" id="A1.T6.42.42.8.4.m1.1"><semantics id="A1.T6.42.42.8.4.m1.1a"><msub id="A1.T6.42.42.8.4.m1.1.1" xref="A1.T6.42.42.8.4.m1.1.1.cmml"><mi id="A1.T6.42.42.8.4.m1.1.1.2" mathsize="90%" xref="A1.T6.42.42.8.4.m1.1.1.2.cmml">𝐜</mi><mi id="A1.T6.42.42.8.4.m1.1.1.3" mathsize="90%" xref="A1.T6.42.42.8.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.42.42.8.4.m1.1b"><apply id="A1.T6.42.42.8.4.m1.1.1.cmml" xref="A1.T6.42.42.8.4.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.42.42.8.4.m1.1.1.1.cmml" xref="A1.T6.42.42.8.4.m1.1.1">subscript</csymbol><ci id="A1.T6.42.42.8.4.m1.1.1.2.cmml" xref="A1.T6.42.42.8.4.m1.1.1.2">𝐜</ci><ci id="A1.T6.42.42.8.4.m1.1.1.3.cmml" xref="A1.T6.42.42.8.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.42.42.8.4.m1.1c">\mathbf{c}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.42.42.8.4.m1.1d">bold_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.46.46.12">
<td class="ltx_td ltx_align_left" id="A1.T6.43.43.9.1"><math alttext="\mathbf{x}_{1:N_{2}}^{(v)}" class="ltx_Math" display="inline" id="A1.T6.43.43.9.1.m1.1"><semantics id="A1.T6.43.43.9.1.m1.1a"><msubsup id="A1.T6.43.43.9.1.m1.1.2" xref="A1.T6.43.43.9.1.m1.1.2.cmml"><mi id="A1.T6.43.43.9.1.m1.1.2.2.2" mathsize="90%" xref="A1.T6.43.43.9.1.m1.1.2.2.2.cmml">𝐱</mi><mrow id="A1.T6.43.43.9.1.m1.1.2.2.3" xref="A1.T6.43.43.9.1.m1.1.2.2.3.cmml"><mn id="A1.T6.43.43.9.1.m1.1.2.2.3.2" mathsize="90%" xref="A1.T6.43.43.9.1.m1.1.2.2.3.2.cmml">1</mn><mo id="A1.T6.43.43.9.1.m1.1.2.2.3.1" lspace="0.278em" mathsize="90%" rspace="0.278em" xref="A1.T6.43.43.9.1.m1.1.2.2.3.1.cmml">:</mo><msub id="A1.T6.43.43.9.1.m1.1.2.2.3.3" xref="A1.T6.43.43.9.1.m1.1.2.2.3.3.cmml"><mi id="A1.T6.43.43.9.1.m1.1.2.2.3.3.2" mathsize="90%" xref="A1.T6.43.43.9.1.m1.1.2.2.3.3.2.cmml">N</mi><mn id="A1.T6.43.43.9.1.m1.1.2.2.3.3.3" mathsize="90%" xref="A1.T6.43.43.9.1.m1.1.2.2.3.3.3.cmml">2</mn></msub></mrow><mrow id="A1.T6.43.43.9.1.m1.1.1.1.3" xref="A1.T6.43.43.9.1.m1.1.2.cmml"><mo id="A1.T6.43.43.9.1.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="A1.T6.43.43.9.1.m1.1.2.cmml">(</mo><mi id="A1.T6.43.43.9.1.m1.1.1.1.1" mathsize="90%" xref="A1.T6.43.43.9.1.m1.1.1.1.1.cmml">v</mi><mo id="A1.T6.43.43.9.1.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="A1.T6.43.43.9.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.T6.43.43.9.1.m1.1b"><apply id="A1.T6.43.43.9.1.m1.1.2.cmml" xref="A1.T6.43.43.9.1.m1.1.2"><csymbol cd="ambiguous" id="A1.T6.43.43.9.1.m1.1.2.1.cmml" xref="A1.T6.43.43.9.1.m1.1.2">superscript</csymbol><apply id="A1.T6.43.43.9.1.m1.1.2.2.cmml" xref="A1.T6.43.43.9.1.m1.1.2"><csymbol cd="ambiguous" id="A1.T6.43.43.9.1.m1.1.2.2.1.cmml" xref="A1.T6.43.43.9.1.m1.1.2">subscript</csymbol><ci id="A1.T6.43.43.9.1.m1.1.2.2.2.cmml" xref="A1.T6.43.43.9.1.m1.1.2.2.2">𝐱</ci><apply id="A1.T6.43.43.9.1.m1.1.2.2.3.cmml" xref="A1.T6.43.43.9.1.m1.1.2.2.3"><ci id="A1.T6.43.43.9.1.m1.1.2.2.3.1.cmml" xref="A1.T6.43.43.9.1.m1.1.2.2.3.1">:</ci><cn id="A1.T6.43.43.9.1.m1.1.2.2.3.2.cmml" type="integer" xref="A1.T6.43.43.9.1.m1.1.2.2.3.2">1</cn><apply id="A1.T6.43.43.9.1.m1.1.2.2.3.3.cmml" xref="A1.T6.43.43.9.1.m1.1.2.2.3.3"><csymbol cd="ambiguous" id="A1.T6.43.43.9.1.m1.1.2.2.3.3.1.cmml" xref="A1.T6.43.43.9.1.m1.1.2.2.3.3">subscript</csymbol><ci id="A1.T6.43.43.9.1.m1.1.2.2.3.3.2.cmml" xref="A1.T6.43.43.9.1.m1.1.2.2.3.3.2">𝑁</ci><cn id="A1.T6.43.43.9.1.m1.1.2.2.3.3.3.cmml" type="integer" xref="A1.T6.43.43.9.1.m1.1.2.2.3.3.3">2</cn></apply></apply></apply><ci id="A1.T6.43.43.9.1.m1.1.1.1.1.cmml" xref="A1.T6.43.43.9.1.m1.1.1.1.1">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.43.43.9.1.m1.1c">\mathbf{x}_{1:N_{2}}^{(v)}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.43.43.9.1.m1.1d">bold_x start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_v ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.44.44.10.2">
<span class="ltx_text" id="A1.T6.44.44.10.2.1" style="font-size:90%;">numerical part of </span><math alttext="\mathbf{x}_{v}" class="ltx_Math" display="inline" id="A1.T6.44.44.10.2.m1.1"><semantics id="A1.T6.44.44.10.2.m1.1a"><msub id="A1.T6.44.44.10.2.m1.1.1" xref="A1.T6.44.44.10.2.m1.1.1.cmml"><mi id="A1.T6.44.44.10.2.m1.1.1.2" mathsize="90%" xref="A1.T6.44.44.10.2.m1.1.1.2.cmml">𝐱</mi><mi id="A1.T6.44.44.10.2.m1.1.1.3" mathsize="90%" xref="A1.T6.44.44.10.2.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.44.44.10.2.m1.1b"><apply id="A1.T6.44.44.10.2.m1.1.1.cmml" xref="A1.T6.44.44.10.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.44.44.10.2.m1.1.1.1.cmml" xref="A1.T6.44.44.10.2.m1.1.1">subscript</csymbol><ci id="A1.T6.44.44.10.2.m1.1.1.2.cmml" xref="A1.T6.44.44.10.2.m1.1.1.2">𝐱</ci><ci id="A1.T6.44.44.10.2.m1.1.1.3.cmml" xref="A1.T6.44.44.10.2.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.44.44.10.2.m1.1c">\mathbf{x}_{v}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.44.44.10.2.m1.1d">bold_x start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A1.T6.45.45.11.3"><math alttext="\mathbf{c}_{1:N_{2}}^{(i)}" class="ltx_Math" display="inline" id="A1.T6.45.45.11.3.m1.1"><semantics id="A1.T6.45.45.11.3.m1.1a"><msubsup id="A1.T6.45.45.11.3.m1.1.2" xref="A1.T6.45.45.11.3.m1.1.2.cmml"><mi id="A1.T6.45.45.11.3.m1.1.2.2.2" mathsize="90%" xref="A1.T6.45.45.11.3.m1.1.2.2.2.cmml">𝐜</mi><mrow id="A1.T6.45.45.11.3.m1.1.2.2.3" xref="A1.T6.45.45.11.3.m1.1.2.2.3.cmml"><mn id="A1.T6.45.45.11.3.m1.1.2.2.3.2" mathsize="90%" xref="A1.T6.45.45.11.3.m1.1.2.2.3.2.cmml">1</mn><mo id="A1.T6.45.45.11.3.m1.1.2.2.3.1" lspace="0.278em" mathsize="90%" rspace="0.278em" xref="A1.T6.45.45.11.3.m1.1.2.2.3.1.cmml">:</mo><msub id="A1.T6.45.45.11.3.m1.1.2.2.3.3" xref="A1.T6.45.45.11.3.m1.1.2.2.3.3.cmml"><mi id="A1.T6.45.45.11.3.m1.1.2.2.3.3.2" mathsize="90%" xref="A1.T6.45.45.11.3.m1.1.2.2.3.3.2.cmml">N</mi><mn id="A1.T6.45.45.11.3.m1.1.2.2.3.3.3" mathsize="90%" xref="A1.T6.45.45.11.3.m1.1.2.2.3.3.3.cmml">2</mn></msub></mrow><mrow id="A1.T6.45.45.11.3.m1.1.1.1.3" xref="A1.T6.45.45.11.3.m1.1.2.cmml"><mo id="A1.T6.45.45.11.3.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="A1.T6.45.45.11.3.m1.1.2.cmml">(</mo><mi id="A1.T6.45.45.11.3.m1.1.1.1.1" mathsize="90%" xref="A1.T6.45.45.11.3.m1.1.1.1.1.cmml">i</mi><mo id="A1.T6.45.45.11.3.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="A1.T6.45.45.11.3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.T6.45.45.11.3.m1.1b"><apply id="A1.T6.45.45.11.3.m1.1.2.cmml" xref="A1.T6.45.45.11.3.m1.1.2"><csymbol cd="ambiguous" id="A1.T6.45.45.11.3.m1.1.2.1.cmml" xref="A1.T6.45.45.11.3.m1.1.2">superscript</csymbol><apply id="A1.T6.45.45.11.3.m1.1.2.2.cmml" xref="A1.T6.45.45.11.3.m1.1.2"><csymbol cd="ambiguous" id="A1.T6.45.45.11.3.m1.1.2.2.1.cmml" xref="A1.T6.45.45.11.3.m1.1.2">subscript</csymbol><ci id="A1.T6.45.45.11.3.m1.1.2.2.2.cmml" xref="A1.T6.45.45.11.3.m1.1.2.2.2">𝐜</ci><apply id="A1.T6.45.45.11.3.m1.1.2.2.3.cmml" xref="A1.T6.45.45.11.3.m1.1.2.2.3"><ci id="A1.T6.45.45.11.3.m1.1.2.2.3.1.cmml" xref="A1.T6.45.45.11.3.m1.1.2.2.3.1">:</ci><cn id="A1.T6.45.45.11.3.m1.1.2.2.3.2.cmml" type="integer" xref="A1.T6.45.45.11.3.m1.1.2.2.3.2">1</cn><apply id="A1.T6.45.45.11.3.m1.1.2.2.3.3.cmml" xref="A1.T6.45.45.11.3.m1.1.2.2.3.3"><csymbol cd="ambiguous" id="A1.T6.45.45.11.3.m1.1.2.2.3.3.1.cmml" xref="A1.T6.45.45.11.3.m1.1.2.2.3.3">subscript</csymbol><ci id="A1.T6.45.45.11.3.m1.1.2.2.3.3.2.cmml" xref="A1.T6.45.45.11.3.m1.1.2.2.3.3.2">𝑁</ci><cn id="A1.T6.45.45.11.3.m1.1.2.2.3.3.3.cmml" type="integer" xref="A1.T6.45.45.11.3.m1.1.2.2.3.3.3">2</cn></apply></apply></apply><ci id="A1.T6.45.45.11.3.m1.1.1.1.1.cmml" xref="A1.T6.45.45.11.3.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.45.45.11.3.m1.1c">\mathbf{c}_{1:N_{2}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.45.45.11.3.m1.1d">bold_c start_POSTSUBSCRIPT 1 : italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.46.46.12.4">
<span class="ltx_text" id="A1.T6.46.46.12.4.1" style="font-size:90%;">numerical part of </span><math alttext="\mathbf{c}_{i}" class="ltx_Math" display="inline" id="A1.T6.46.46.12.4.m1.1"><semantics id="A1.T6.46.46.12.4.m1.1a"><msub id="A1.T6.46.46.12.4.m1.1.1" xref="A1.T6.46.46.12.4.m1.1.1.cmml"><mi id="A1.T6.46.46.12.4.m1.1.1.2" mathsize="90%" xref="A1.T6.46.46.12.4.m1.1.1.2.cmml">𝐜</mi><mi id="A1.T6.46.46.12.4.m1.1.1.3" mathsize="90%" xref="A1.T6.46.46.12.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.46.46.12.4.m1.1b"><apply id="A1.T6.46.46.12.4.m1.1.1.cmml" xref="A1.T6.46.46.12.4.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.46.46.12.4.m1.1.1.1.cmml" xref="A1.T6.46.46.12.4.m1.1.1">subscript</csymbol><ci id="A1.T6.46.46.12.4.m1.1.1.2.cmml" xref="A1.T6.46.46.12.4.m1.1.1.2">𝐜</ci><ci id="A1.T6.46.46.12.4.m1.1.1.3.cmml" xref="A1.T6.46.46.12.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.46.46.12.4.m1.1c">\mathbf{c}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.46.46.12.4.m1.1d">bold_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.49.49.15">
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.47.47.13.1"><math alttext="\mathbf{k}_{i}" class="ltx_Math" display="inline" id="A1.T6.47.47.13.1.m1.1"><semantics id="A1.T6.47.47.13.1.m1.1a"><msub id="A1.T6.47.47.13.1.m1.1.1" xref="A1.T6.47.47.13.1.m1.1.1.cmml"><mi id="A1.T6.47.47.13.1.m1.1.1.2" mathsize="90%" xref="A1.T6.47.47.13.1.m1.1.1.2.cmml">𝐤</mi><mi id="A1.T6.47.47.13.1.m1.1.1.3" mathsize="90%" xref="A1.T6.47.47.13.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.47.47.13.1.m1.1b"><apply id="A1.T6.47.47.13.1.m1.1.1.cmml" xref="A1.T6.47.47.13.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.47.47.13.1.m1.1.1.1.cmml" xref="A1.T6.47.47.13.1.m1.1.1">subscript</csymbol><ci id="A1.T6.47.47.13.1.m1.1.1.2.cmml" xref="A1.T6.47.47.13.1.m1.1.1.2">𝐤</ci><ci id="A1.T6.47.47.13.1.m1.1.1.3.cmml" xref="A1.T6.47.47.13.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.47.47.13.1.m1.1c">\mathbf{k}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.47.47.13.1.m1.1d">bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A1.T6.48.48.14.2">
<span class="ltx_text" id="A1.T6.48.48.14.2.1" style="font-size:90%;">embedding vector of </span><math alttext="c_{i}" class="ltx_Math" display="inline" id="A1.T6.48.48.14.2.m1.1"><semantics id="A1.T6.48.48.14.2.m1.1a"><msub id="A1.T6.48.48.14.2.m1.1.1" xref="A1.T6.48.48.14.2.m1.1.1.cmml"><mi id="A1.T6.48.48.14.2.m1.1.1.2" mathsize="90%" xref="A1.T6.48.48.14.2.m1.1.1.2.cmml">c</mi><mi id="A1.T6.48.48.14.2.m1.1.1.3" mathsize="90%" xref="A1.T6.48.48.14.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.48.48.14.2.m1.1b"><apply id="A1.T6.48.48.14.2.m1.1.1.cmml" xref="A1.T6.48.48.14.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.48.48.14.2.m1.1.1.1.cmml" xref="A1.T6.48.48.14.2.m1.1.1">subscript</csymbol><ci id="A1.T6.48.48.14.2.m1.1.1.2.cmml" xref="A1.T6.48.48.14.2.m1.1.1.2">𝑐</ci><ci id="A1.T6.48.48.14.2.m1.1.1.3.cmml" xref="A1.T6.48.48.14.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.48.48.14.2.m1.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.48.48.14.2.m1.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.49.49.15.3"><math alttext="d" class="ltx_Math" display="inline" id="A1.T6.49.49.15.3.m1.1"><semantics id="A1.T6.49.49.15.3.m1.1a"><mi id="A1.T6.49.49.15.3.m1.1.1" mathsize="90%" xref="A1.T6.49.49.15.3.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A1.T6.49.49.15.3.m1.1b"><ci id="A1.T6.49.49.15.3.m1.1.1.cmml" xref="A1.T6.49.49.15.3.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.49.49.15.3.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="A1.T6.49.49.15.3.m1.1d">italic_d</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.49.49.15.4"><span class="ltx_text" id="A1.T6.49.49.15.4.1" style="font-size:90%;">embedding dimension</span></td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="A1.T6.62.62">
<tr class="ltx_tr" id="A1.T6.51.51.2">
<td class="ltx_td ltx_align_left" id="A1.T6.50.50.1.1"><math alttext="\mathbf{q}" class="ltx_Math" display="inline" id="A1.T6.50.50.1.1.m1.1"><semantics id="A1.T6.50.50.1.1.m1.1a"><mi id="A1.T6.50.50.1.1.m1.1.1" mathsize="90%" xref="A1.T6.50.50.1.1.m1.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="A1.T6.50.50.1.1.m1.1b"><ci id="A1.T6.50.50.1.1.m1.1.1.cmml" xref="A1.T6.50.50.1.1.m1.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.50.50.1.1.m1.1c">\mathbf{q}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.50.50.1.1.m1.1d">bold_q</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.51.51.2.3"><span class="ltx_text" id="A1.T6.51.51.2.3.1" style="font-size:80%;">target item’s inherent embedding</span></td>
<td class="ltx_td ltx_align_left" id="A1.T6.51.51.2.2"><math alttext="\boldsymbol{\beta}" class="ltx_Math" display="inline" id="A1.T6.51.51.2.2.m1.1"><semantics id="A1.T6.51.51.2.2.m1.1a"><mi id="A1.T6.51.51.2.2.m1.1.1" mathsize="90%" xref="A1.T6.51.51.2.2.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="A1.T6.51.51.2.2.m1.1b"><ci id="A1.T6.51.51.2.2.m1.1.1.cmml" xref="A1.T6.51.51.2.2.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.51.51.2.2.m1.1c">\boldsymbol{\beta}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.51.51.2.2.m1.1d">bold_italic_β</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.51.51.2.4"><span class="ltx_text" id="A1.T6.51.51.2.4.1" style="font-size:80%;">learnable cross feature weight</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.55.55.6">
<td class="ltx_td ltx_align_left" id="A1.T6.52.52.3.1"><math alttext="\mathbf{K}_{h}" class="ltx_Math" display="inline" id="A1.T6.52.52.3.1.m1.1"><semantics id="A1.T6.52.52.3.1.m1.1a"><msub id="A1.T6.52.52.3.1.m1.1.1" xref="A1.T6.52.52.3.1.m1.1.1.cmml"><mi id="A1.T6.52.52.3.1.m1.1.1.2" mathsize="90%" xref="A1.T6.52.52.3.1.m1.1.1.2.cmml">𝐊</mi><mi id="A1.T6.52.52.3.1.m1.1.1.3" mathsize="90%" xref="A1.T6.52.52.3.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.52.52.3.1.m1.1b"><apply id="A1.T6.52.52.3.1.m1.1.1.cmml" xref="A1.T6.52.52.3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.52.52.3.1.m1.1.1.1.cmml" xref="A1.T6.52.52.3.1.m1.1.1">subscript</csymbol><ci id="A1.T6.52.52.3.1.m1.1.1.2.cmml" xref="A1.T6.52.52.3.1.m1.1.1.2">𝐊</ci><ci id="A1.T6.52.52.3.1.m1.1.1.3.cmml" xref="A1.T6.52.52.3.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.52.52.3.1.m1.1c">\mathbf{K}_{h}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.52.52.3.1.m1.1d">bold_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.53.53.4.2">
<span class="ltx_text" id="A1.T6.53.53.4.2.1" style="font-size:90%;">inherent feature part of </span><math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A1.T6.53.53.4.2.m1.1"><semantics id="A1.T6.53.53.4.2.m1.1a"><mi id="A1.T6.53.53.4.2.m1.1.1" mathsize="90%" xref="A1.T6.53.53.4.2.m1.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A1.T6.53.53.4.2.m1.1b"><ci id="A1.T6.53.53.4.2.m1.1.1.cmml" xref="A1.T6.53.53.4.2.m1.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.53.53.4.2.m1.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.53.53.4.2.m1.1d">bold_K</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="A1.T6.54.54.5.3"><math alttext="\mathbf{K}_{c}" class="ltx_Math" display="inline" id="A1.T6.54.54.5.3.m1.1"><semantics id="A1.T6.54.54.5.3.m1.1a"><msub id="A1.T6.54.54.5.3.m1.1.1" xref="A1.T6.54.54.5.3.m1.1.1.cmml"><mi id="A1.T6.54.54.5.3.m1.1.1.2" mathsize="90%" xref="A1.T6.54.54.5.3.m1.1.1.2.cmml">𝐊</mi><mi id="A1.T6.54.54.5.3.m1.1.1.3" mathsize="90%" xref="A1.T6.54.54.5.3.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T6.54.54.5.3.m1.1b"><apply id="A1.T6.54.54.5.3.m1.1.1.cmml" xref="A1.T6.54.54.5.3.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.54.54.5.3.m1.1.1.1.cmml" xref="A1.T6.54.54.5.3.m1.1.1">subscript</csymbol><ci id="A1.T6.54.54.5.3.m1.1.1.2.cmml" xref="A1.T6.54.54.5.3.m1.1.1.2">𝐊</ci><ci id="A1.T6.54.54.5.3.m1.1.1.3.cmml" xref="A1.T6.54.54.5.3.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.54.54.5.3.m1.1c">\mathbf{K}_{c}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.54.54.5.3.m1.1d">bold_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.55.55.6.4">
<span class="ltx_text" id="A1.T6.55.55.6.4.1" style="font-size:90%;">cross feature part of </span><math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A1.T6.55.55.6.4.m1.1"><semantics id="A1.T6.55.55.6.4.m1.1a"><mi id="A1.T6.55.55.6.4.m1.1.1" mathsize="90%" xref="A1.T6.55.55.6.4.m1.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A1.T6.55.55.6.4.m1.1b"><ci id="A1.T6.55.55.6.4.m1.1.1.cmml" xref="A1.T6.55.55.6.4.m1.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.55.55.6.4.m1.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.55.55.6.4.m1.1d">bold_K</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.57.57.8">
<td class="ltx_td ltx_align_left" id="A1.T6.56.56.7.1"><math alttext="H" class="ltx_Math" display="inline" id="A1.T6.56.56.7.1.m1.1"><semantics id="A1.T6.56.56.7.1.m1.1a"><mi id="A1.T6.56.56.7.1.m1.1.1" mathsize="90%" xref="A1.T6.56.56.7.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A1.T6.56.56.7.1.m1.1b"><ci id="A1.T6.56.56.7.1.m1.1.1.cmml" xref="A1.T6.56.56.7.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.56.56.7.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="A1.T6.56.56.7.1.m1.1d">italic_H</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.57.57.8.3"><span class="ltx_text" id="A1.T6.57.57.8.3.1" style="font-size:90%;">inherent feature dimension</span></td>
<td class="ltx_td ltx_align_left" id="A1.T6.57.57.8.2"><math alttext="C" class="ltx_Math" display="inline" id="A1.T6.57.57.8.2.m1.1"><semantics id="A1.T6.57.57.8.2.m1.1a"><mi id="A1.T6.57.57.8.2.m1.1.1" mathsize="90%" xref="A1.T6.57.57.8.2.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.T6.57.57.8.2.m1.1b"><ci id="A1.T6.57.57.8.2.m1.1.1.cmml" xref="A1.T6.57.57.8.2.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.57.57.8.2.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.T6.57.57.8.2.m1.1d">italic_C</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.57.57.8.4"><span class="ltx_text" id="A1.T6.57.57.8.4.1" style="font-size:90%;">cross feature dimension</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.59.59.10">
<td class="ltx_td ltx_align_left" id="A1.T6.58.58.9.1"><math alttext="\boldsymbol{\alpha}" class="ltx_Math" display="inline" id="A1.T6.58.58.9.1.m1.1"><semantics id="A1.T6.58.58.9.1.m1.1a"><mi id="A1.T6.58.58.9.1.m1.1.1" mathsize="90%" xref="A1.T6.58.58.9.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="A1.T6.58.58.9.1.m1.1b"><ci id="A1.T6.58.58.9.1.m1.1.1.cmml" xref="A1.T6.58.58.9.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.58.58.9.1.m1.1c">\boldsymbol{\alpha}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.58.58.9.1.m1.1d">bold_italic_α</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.59.59.10.3"><span class="ltx_text" id="A1.T6.59.59.10.3.1" style="font-size:90%;">attention weight</span></td>
<td class="ltx_td ltx_align_left" id="A1.T6.59.59.10.2"><math alttext="\boldsymbol{\alpha}^{\prime}" class="ltx_Math" display="inline" id="A1.T6.59.59.10.2.m1.1"><semantics id="A1.T6.59.59.10.2.m1.1a"><msup id="A1.T6.59.59.10.2.m1.1.1" xref="A1.T6.59.59.10.2.m1.1.1.cmml"><mi id="A1.T6.59.59.10.2.m1.1.1.2" mathsize="90%" xref="A1.T6.59.59.10.2.m1.1.1.2.cmml">𝜶</mi><mo id="A1.T6.59.59.10.2.m1.1.1.3" mathsize="90%" xref="A1.T6.59.59.10.2.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.T6.59.59.10.2.m1.1b"><apply id="A1.T6.59.59.10.2.m1.1.1.cmml" xref="A1.T6.59.59.10.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T6.59.59.10.2.m1.1.1.1.cmml" xref="A1.T6.59.59.10.2.m1.1.1">superscript</csymbol><ci id="A1.T6.59.59.10.2.m1.1.1.2.cmml" xref="A1.T6.59.59.10.2.m1.1.1.2">𝜶</ci><ci id="A1.T6.59.59.10.2.m1.1.1.3.cmml" xref="A1.T6.59.59.10.2.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.59.59.10.2.m1.1c">\boldsymbol{\alpha}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.59.59.10.2.m1.1d">bold_italic_α start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="A1.T6.59.59.10.4"><span class="ltx_text" id="A1.T6.59.59.10.4.1" style="font-size:90%;">adjusted attention weight</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.62.62.13">
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.60.60.11.1"><math alttext="\mathbf{n}" class="ltx_Math" display="inline" id="A1.T6.60.60.11.1.m1.1"><semantics id="A1.T6.60.60.11.1.m1.1a"><mi id="A1.T6.60.60.11.1.m1.1.1" mathsize="90%" xref="A1.T6.60.60.11.1.m1.1.1.cmml">𝐧</mi><annotation-xml encoding="MathML-Content" id="A1.T6.60.60.11.1.m1.1b"><ci id="A1.T6.60.60.11.1.m1.1.1.cmml" xref="A1.T6.60.60.11.1.m1.1.1">𝐧</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.60.60.11.1.m1.1c">\mathbf{n}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.60.60.11.1.m1.1d">bold_n</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A1.T6.61.61.12.2">
<span class="ltx_text" id="A1.T6.61.61.12.2.1" style="font-size:90%;">cluster size of </span><math alttext="C" class="ltx_Math" display="inline" id="A1.T6.61.61.12.2.m1.1"><semantics id="A1.T6.61.61.12.2.m1.1a"><mi id="A1.T6.61.61.12.2.m1.1.1" mathsize="90%" xref="A1.T6.61.61.12.2.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.T6.61.61.12.2.m1.1b"><ci id="A1.T6.61.61.12.2.m1.1.1.cmml" xref="A1.T6.61.61.12.2.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.61.61.12.2.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.T6.61.61.12.2.m1.1d">italic_C</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.62.62.13.3"><math alttext="\mathbb{N}" class="ltx_Math" display="inline" id="A1.T6.62.62.13.3.m1.1"><semantics id="A1.T6.62.62.13.3.m1.1a"><mi id="A1.T6.62.62.13.3.m1.1.1" mathsize="90%" xref="A1.T6.62.62.13.3.m1.1.1.cmml">ℕ</mi><annotation-xml encoding="MathML-Content" id="A1.T6.62.62.13.3.m1.1b"><ci id="A1.T6.62.62.13.3.m1.1.1.cmml" xref="A1.T6.62.62.13.3.m1.1.1">ℕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.62.62.13.3.m1.1c">\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.62.62.13.3.m1.1d">blackboard_N</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="A1.T6.62.62.13.4"><span class="ltx_text" id="A1.T6.62.62.13.4.1" style="font-size:90%;">natural number set</span></td>
</tr>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="A1.T6.65.65">
<tr class="ltx_tr" id="A1.T6.65.65.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T6.63.63.1.1"><math alttext="\qquad\mathbf{W}^{q},\mathbf{W}^{h},\mathbf{W}^{c},\mathbf{W}^{v},\mathbf{W}^{%
o}\qquad" class="ltx_Math" display="inline" id="A1.T6.63.63.1.1.m1.1"><semantics id="A1.T6.63.63.1.1.m1.1a"><mrow id="A1.T6.63.63.1.1.m1.1.1.1"><mrow id="A1.T6.63.63.1.1.m1.1.1.1.1.5" xref="A1.T6.63.63.1.1.m1.1.1.1.1.6.cmml"><msup id="A1.T6.63.63.1.1.m1.1.1.1.1.1.1" xref="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.2" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.2.cmml">𝐖</mi><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.3" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.3.cmml">q</mi></msup><mo id="A1.T6.63.63.1.1.m1.1.1.1.1.5.6" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.6.cmml">,</mo><msup id="A1.T6.63.63.1.1.m1.1.1.1.1.2.2" xref="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.cmml"><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.2" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.3" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.3.cmml">h</mi></msup><mo id="A1.T6.63.63.1.1.m1.1.1.1.1.5.7" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.6.cmml">,</mo><msup id="A1.T6.63.63.1.1.m1.1.1.1.1.3.3" xref="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.cmml"><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.2" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.2.cmml">𝐖</mi><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.3" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.3.cmml">c</mi></msup><mo id="A1.T6.63.63.1.1.m1.1.1.1.1.5.8" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.6.cmml">,</mo><msup id="A1.T6.63.63.1.1.m1.1.1.1.1.4.4" xref="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.cmml"><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.2" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.2.cmml">𝐖</mi><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.3" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.3.cmml">v</mi></msup><mo id="A1.T6.63.63.1.1.m1.1.1.1.1.5.9" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.6.cmml">,</mo><msup id="A1.T6.63.63.1.1.m1.1.1.1.1.5.5" xref="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.cmml"><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.2" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.2.cmml">𝐖</mi><mi id="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.3" mathsize="90%" xref="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.3.cmml">o</mi></msup></mrow><mspace id="A1.T6.63.63.1.1.m1.1.1.1.2" width="1.8em"></mspace></mrow><annotation-xml encoding="MathML-Content" id="A1.T6.63.63.1.1.m1.1b"><list id="A1.T6.63.63.1.1.m1.1.1.1.1.6.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.5"><apply id="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.2">𝐖</ci><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.1.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.2.2">superscript</csymbol><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.2.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.2">𝐖</ci><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.3.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.2.2.3">ℎ</ci></apply><apply id="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.1.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.2.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.2">𝐖</ci><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.3.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.3.3.3">𝑐</ci></apply><apply id="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.1.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.4.4">superscript</csymbol><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.2.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.2">𝐖</ci><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.3.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.4.4.3">𝑣</ci></apply><apply id="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.5.5"><csymbol cd="ambiguous" id="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.1.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.5.5">superscript</csymbol><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.2.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.2">𝐖</ci><ci id="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.3.cmml" xref="A1.T6.63.63.1.1.m1.1.1.1.1.5.5.3">𝑜</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.63.63.1.1.m1.1c">\qquad\mathbf{W}^{q},\mathbf{W}^{h},\mathbf{W}^{c},\mathbf{W}^{v},\mathbf{W}^{%
o}\qquad</annotation><annotation encoding="application/x-llamapun" id="A1.T6.63.63.1.1.m1.1d">bold_W start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , bold_W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT , bold_W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT , bold_W start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT , bold_W start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T6.65.65.3.3">
<span class="ltx_text" id="A1.T6.65.65.3.3.1" style="font-size:90%;">      </span><span class="ltx_text" id="A1.T6.65.65.3.3.2" style="font-size:90%;">linear projection parameters</span>
</td>
</tr>
</table>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2. </span>Behavior Feature Splits and Linear Projection</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.4">Following TWIN <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.16357v2#bib.bib3" title="">2023</a>)</cite>, we define the feature representations of a length <math alttext="\hat{T}" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mover accent="true" id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">T</mi><mo id="A1.SS2.p1.1.m1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><ci id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1">^</ci><ci id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\hat{T}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">over^ start_ARG italic_T end_ARG</annotation></semantics></math> clustered behavior sequence <math alttext="[c_{1},c_{2},...,c_{\hat{T}}]" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m2.4"><semantics id="A1.SS2.p1.2.m2.4a"><mrow id="A1.SS2.p1.2.m2.4.4.3" xref="A1.SS2.p1.2.m2.4.4.4.cmml"><mo id="A1.SS2.p1.2.m2.4.4.3.4" stretchy="false" xref="A1.SS2.p1.2.m2.4.4.4.cmml">[</mo><msub id="A1.SS2.p1.2.m2.2.2.1.1" xref="A1.SS2.p1.2.m2.2.2.1.1.cmml"><mi id="A1.SS2.p1.2.m2.2.2.1.1.2" xref="A1.SS2.p1.2.m2.2.2.1.1.2.cmml">c</mi><mn id="A1.SS2.p1.2.m2.2.2.1.1.3" xref="A1.SS2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="A1.SS2.p1.2.m2.4.4.3.5" xref="A1.SS2.p1.2.m2.4.4.4.cmml">,</mo><msub id="A1.SS2.p1.2.m2.3.3.2.2" xref="A1.SS2.p1.2.m2.3.3.2.2.cmml"><mi id="A1.SS2.p1.2.m2.3.3.2.2.2" xref="A1.SS2.p1.2.m2.3.3.2.2.2.cmml">c</mi><mn id="A1.SS2.p1.2.m2.3.3.2.2.3" xref="A1.SS2.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="A1.SS2.p1.2.m2.4.4.3.6" xref="A1.SS2.p1.2.m2.4.4.4.cmml">,</mo><mi id="A1.SS2.p1.2.m2.1.1" mathvariant="normal" xref="A1.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="A1.SS2.p1.2.m2.4.4.3.7" xref="A1.SS2.p1.2.m2.4.4.4.cmml">,</mo><msub id="A1.SS2.p1.2.m2.4.4.3.3" xref="A1.SS2.p1.2.m2.4.4.3.3.cmml"><mi id="A1.SS2.p1.2.m2.4.4.3.3.2" xref="A1.SS2.p1.2.m2.4.4.3.3.2.cmml">c</mi><mover accent="true" id="A1.SS2.p1.2.m2.4.4.3.3.3" xref="A1.SS2.p1.2.m2.4.4.3.3.3.cmml"><mi id="A1.SS2.p1.2.m2.4.4.3.3.3.2" xref="A1.SS2.p1.2.m2.4.4.3.3.3.2.cmml">T</mi><mo id="A1.SS2.p1.2.m2.4.4.3.3.3.1" xref="A1.SS2.p1.2.m2.4.4.3.3.3.1.cmml">^</mo></mover></msub><mo id="A1.SS2.p1.2.m2.4.4.3.8" stretchy="false" xref="A1.SS2.p1.2.m2.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.4b"><list id="A1.SS2.p1.2.m2.4.4.4.cmml" xref="A1.SS2.p1.2.m2.4.4.3"><apply id="A1.SS2.p1.2.m2.2.2.1.1.cmml" xref="A1.SS2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="A1.SS2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="A1.SS2.p1.2.m2.2.2.1.1.2.cmml" xref="A1.SS2.p1.2.m2.2.2.1.1.2">𝑐</ci><cn id="A1.SS2.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="A1.SS2.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="A1.SS2.p1.2.m2.3.3.2.2.cmml" xref="A1.SS2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.3.3.2.2.1.cmml" xref="A1.SS2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="A1.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="A1.SS2.p1.2.m2.3.3.2.2.2">𝑐</ci><cn id="A1.SS2.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="A1.SS2.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">…</ci><apply id="A1.SS2.p1.2.m2.4.4.3.3.cmml" xref="A1.SS2.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.4.4.3.3.1.cmml" xref="A1.SS2.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="A1.SS2.p1.2.m2.4.4.3.3.2.cmml" xref="A1.SS2.p1.2.m2.4.4.3.3.2">𝑐</ci><apply id="A1.SS2.p1.2.m2.4.4.3.3.3.cmml" xref="A1.SS2.p1.2.m2.4.4.3.3.3"><ci id="A1.SS2.p1.2.m2.4.4.3.3.3.1.cmml" xref="A1.SS2.p1.2.m2.4.4.3.3.3.1">^</ci><ci id="A1.SS2.p1.2.m2.4.4.3.3.3.2.cmml" xref="A1.SS2.p1.2.m2.4.4.3.3.3.2">𝑇</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.4c">[c_{1},c_{2},...,c_{\hat{T}}]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m2.4d">[ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT over^ start_ARG italic_T end_ARG end_POSTSUBSCRIPT ]</annotation></semantics></math> as matrix <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A1.SS2.p1.3.m3.1"><semantics id="A1.SS2.p1.3.m3.1a"><mi id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><ci id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m3.1d">bold_K</annotation></semantics></math>, where each row denotes the features of one behavior.
In practice, the linear projection of <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A1.SS2.p1.4.m4.1"><semantics id="A1.SS2.p1.4.m4.1a"><mi id="A1.SS2.p1.4.m4.1.1" xref="A1.SS2.p1.4.m4.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m4.1b"><ci id="A1.SS2.p1.4.m4.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m4.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.4.m4.1d">bold_K</annotation></semantics></math> in the attention score computation of MHTA is the key computational bottleneck that hinders the application of multi-head target attention (MHTA) on ultra-long user behavior sequences. We thus propose the following to reduce its complexity.</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1">We first split the behavior features matrix <span class="ltx_text ltx_markedasmath ltx_font_bold" id="A1.SS2.p2.1.1">K</span> into two parts,</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{K}=[\mathbf{K}_{h},\mathbf{K}_{c}]\in\mathbb{R}^{\hat{T}\times(H+C)}," class="ltx_Math" display="block" id="A1.E12.m1.2"><semantics id="A1.E12.m1.2a"><mrow id="A1.E12.m1.2.2.1" xref="A1.E12.m1.2.2.1.1.cmml"><mrow id="A1.E12.m1.2.2.1.1" xref="A1.E12.m1.2.2.1.1.cmml"><mi id="A1.E12.m1.2.2.1.1.4" xref="A1.E12.m1.2.2.1.1.4.cmml">𝐊</mi><mo id="A1.E12.m1.2.2.1.1.5" xref="A1.E12.m1.2.2.1.1.5.cmml">=</mo><mrow id="A1.E12.m1.2.2.1.1.2.2" xref="A1.E12.m1.2.2.1.1.2.3.cmml"><mo id="A1.E12.m1.2.2.1.1.2.2.3" stretchy="false" xref="A1.E12.m1.2.2.1.1.2.3.cmml">[</mo><msub id="A1.E12.m1.2.2.1.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.1.cmml"><mi id="A1.E12.m1.2.2.1.1.1.1.1.2" xref="A1.E12.m1.2.2.1.1.1.1.1.2.cmml">𝐊</mi><mi id="A1.E12.m1.2.2.1.1.1.1.1.3" xref="A1.E12.m1.2.2.1.1.1.1.1.3.cmml">h</mi></msub><mo id="A1.E12.m1.2.2.1.1.2.2.4" xref="A1.E12.m1.2.2.1.1.2.3.cmml">,</mo><msub id="A1.E12.m1.2.2.1.1.2.2.2" xref="A1.E12.m1.2.2.1.1.2.2.2.cmml"><mi id="A1.E12.m1.2.2.1.1.2.2.2.2" xref="A1.E12.m1.2.2.1.1.2.2.2.2.cmml">𝐊</mi><mi id="A1.E12.m1.2.2.1.1.2.2.2.3" xref="A1.E12.m1.2.2.1.1.2.2.2.3.cmml">c</mi></msub><mo id="A1.E12.m1.2.2.1.1.2.2.5" stretchy="false" xref="A1.E12.m1.2.2.1.1.2.3.cmml">]</mo></mrow><mo id="A1.E12.m1.2.2.1.1.6" xref="A1.E12.m1.2.2.1.1.6.cmml">∈</mo><msup id="A1.E12.m1.2.2.1.1.7" xref="A1.E12.m1.2.2.1.1.7.cmml"><mi id="A1.E12.m1.2.2.1.1.7.2" xref="A1.E12.m1.2.2.1.1.7.2.cmml">ℝ</mi><mrow id="A1.E12.m1.1.1.1" xref="A1.E12.m1.1.1.1.cmml"><mover accent="true" id="A1.E12.m1.1.1.1.3" xref="A1.E12.m1.1.1.1.3.cmml"><mi id="A1.E12.m1.1.1.1.3.2" xref="A1.E12.m1.1.1.1.3.2.cmml">T</mi><mo id="A1.E12.m1.1.1.1.3.1" xref="A1.E12.m1.1.1.1.3.1.cmml">^</mo></mover><mo id="A1.E12.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A1.E12.m1.1.1.1.2.cmml">×</mo><mrow id="A1.E12.m1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.2.cmml">H</mi><mo id="A1.E12.m1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.cmml">+</mo><mi id="A1.E12.m1.1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.3.cmml">C</mi></mrow><mo id="A1.E12.m1.1.1.1.1.1.3" stretchy="false" xref="A1.E12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><mo id="A1.E12.m1.2.2.1.2" xref="A1.E12.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.2b"><apply id="A1.E12.m1.2.2.1.1.cmml" xref="A1.E12.m1.2.2.1"><and id="A1.E12.m1.2.2.1.1a.cmml" xref="A1.E12.m1.2.2.1"></and><apply id="A1.E12.m1.2.2.1.1b.cmml" xref="A1.E12.m1.2.2.1"><eq id="A1.E12.m1.2.2.1.1.5.cmml" xref="A1.E12.m1.2.2.1.1.5"></eq><ci id="A1.E12.m1.2.2.1.1.4.cmml" xref="A1.E12.m1.2.2.1.1.4">𝐊</ci><interval closure="closed" id="A1.E12.m1.2.2.1.1.2.3.cmml" xref="A1.E12.m1.2.2.1.1.2.2"><apply id="A1.E12.m1.2.2.1.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E12.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.2">𝐊</ci><ci id="A1.E12.m1.2.2.1.1.1.1.1.3.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.3">ℎ</ci></apply><apply id="A1.E12.m1.2.2.1.1.2.2.2.cmml" xref="A1.E12.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.2.2.1.1.2.2.2.1.cmml" xref="A1.E12.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="A1.E12.m1.2.2.1.1.2.2.2.2.cmml" xref="A1.E12.m1.2.2.1.1.2.2.2.2">𝐊</ci><ci id="A1.E12.m1.2.2.1.1.2.2.2.3.cmml" xref="A1.E12.m1.2.2.1.1.2.2.2.3">𝑐</ci></apply></interval></apply><apply id="A1.E12.m1.2.2.1.1c.cmml" xref="A1.E12.m1.2.2.1"><in id="A1.E12.m1.2.2.1.1.6.cmml" xref="A1.E12.m1.2.2.1.1.6"></in><share href="https://arxiv.org/html/2407.16357v2#A1.E12.m1.2.2.1.1.2.cmml" id="A1.E12.m1.2.2.1.1d.cmml" xref="A1.E12.m1.2.2.1"></share><apply id="A1.E12.m1.2.2.1.1.7.cmml" xref="A1.E12.m1.2.2.1.1.7"><csymbol cd="ambiguous" id="A1.E12.m1.2.2.1.1.7.1.cmml" xref="A1.E12.m1.2.2.1.1.7">superscript</csymbol><ci id="A1.E12.m1.2.2.1.1.7.2.cmml" xref="A1.E12.m1.2.2.1.1.7.2">ℝ</ci><apply id="A1.E12.m1.1.1.1.cmml" xref="A1.E12.m1.1.1.1"><times id="A1.E12.m1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.2"></times><apply id="A1.E12.m1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.3"><ci id="A1.E12.m1.1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.1.3.1">^</ci><ci id="A1.E12.m1.1.1.1.3.2.cmml" xref="A1.E12.m1.1.1.1.3.2">𝑇</ci></apply><apply id="A1.E12.m1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1"><plus id="A1.E12.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1"></plus><ci id="A1.E12.m1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2">𝐻</ci><ci id="A1.E12.m1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3">𝐶</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.2c">\mathbf{K}=[\mathbf{K}_{h},\mathbf{K}_{c}]\in\mathbb{R}^{\hat{T}\times(H+C)},</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.2d">bold_K = [ bold_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , bold_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG × ( italic_H + italic_C ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p2.5">We define <math alttext="\textbf{K}_{h}\in\mathbb{R}^{\hat{T}\times H}" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m1.1"><semantics id="A1.SS2.p2.2.m1.1a"><mrow id="A1.SS2.p2.2.m1.1.1" xref="A1.SS2.p2.2.m1.1.1.cmml"><msub id="A1.SS2.p2.2.m1.1.1.2" xref="A1.SS2.p2.2.m1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.2.m1.1.1.2.2" xref="A1.SS2.p2.2.m1.1.1.2.2a.cmml">K</mtext><mi id="A1.SS2.p2.2.m1.1.1.2.3" xref="A1.SS2.p2.2.m1.1.1.2.3.cmml">h</mi></msub><mo id="A1.SS2.p2.2.m1.1.1.1" xref="A1.SS2.p2.2.m1.1.1.1.cmml">∈</mo><msup id="A1.SS2.p2.2.m1.1.1.3" xref="A1.SS2.p2.2.m1.1.1.3.cmml"><mi id="A1.SS2.p2.2.m1.1.1.3.2" xref="A1.SS2.p2.2.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS2.p2.2.m1.1.1.3.3" xref="A1.SS2.p2.2.m1.1.1.3.3.cmml"><mover accent="true" id="A1.SS2.p2.2.m1.1.1.3.3.2" xref="A1.SS2.p2.2.m1.1.1.3.3.2.cmml"><mi id="A1.SS2.p2.2.m1.1.1.3.3.2.2" xref="A1.SS2.p2.2.m1.1.1.3.3.2.2.cmml">T</mi><mo id="A1.SS2.p2.2.m1.1.1.3.3.2.1" xref="A1.SS2.p2.2.m1.1.1.3.3.2.1.cmml">^</mo></mover><mo id="A1.SS2.p2.2.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p2.2.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.SS2.p2.2.m1.1.1.3.3.3" xref="A1.SS2.p2.2.m1.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m1.1b"><apply id="A1.SS2.p2.2.m1.1.1.cmml" xref="A1.SS2.p2.2.m1.1.1"><in id="A1.SS2.p2.2.m1.1.1.1.cmml" xref="A1.SS2.p2.2.m1.1.1.1"></in><apply id="A1.SS2.p2.2.m1.1.1.2.cmml" xref="A1.SS2.p2.2.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m1.1.1.2.1.cmml" xref="A1.SS2.p2.2.m1.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.2.m1.1.1.2.2a.cmml" xref="A1.SS2.p2.2.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.2.m1.1.1.2.2.cmml" xref="A1.SS2.p2.2.m1.1.1.2.2">K</mtext></ci><ci id="A1.SS2.p2.2.m1.1.1.2.3.cmml" xref="A1.SS2.p2.2.m1.1.1.2.3">ℎ</ci></apply><apply id="A1.SS2.p2.2.m1.1.1.3.cmml" xref="A1.SS2.p2.2.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m1.1.1.3.1.cmml" xref="A1.SS2.p2.2.m1.1.1.3">superscript</csymbol><ci id="A1.SS2.p2.2.m1.1.1.3.2.cmml" xref="A1.SS2.p2.2.m1.1.1.3.2">ℝ</ci><apply id="A1.SS2.p2.2.m1.1.1.3.3.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3"><times id="A1.SS2.p2.2.m1.1.1.3.3.1.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.1"></times><apply id="A1.SS2.p2.2.m1.1.1.3.3.2.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.2"><ci id="A1.SS2.p2.2.m1.1.1.3.3.2.1.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.2.1">^</ci><ci id="A1.SS2.p2.2.m1.1.1.3.3.2.2.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.2.2">𝑇</ci></apply><ci id="A1.SS2.p2.2.m1.1.1.3.3.3.cmml" xref="A1.SS2.p2.2.m1.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m1.1c">\textbf{K}_{h}\in\mathbb{R}^{\hat{T}\times H}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m1.1d">K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math> as the <span class="ltx_text ltx_font_italic" id="A1.SS2.p2.5.1">inherent</span> features of behavior items (e.g. video id, author, topic, duration) which are
independent of the specific user/behavior sequence,
and <math alttext="\textbf{K}_{c}\in\mathbb{R}^{\hat{T}\times C}" class="ltx_Math" display="inline" id="A1.SS2.p2.3.m2.1"><semantics id="A1.SS2.p2.3.m2.1a"><mrow id="A1.SS2.p2.3.m2.1.1" xref="A1.SS2.p2.3.m2.1.1.cmml"><msub id="A1.SS2.p2.3.m2.1.1.2" xref="A1.SS2.p2.3.m2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.3.m2.1.1.2.2" xref="A1.SS2.p2.3.m2.1.1.2.2a.cmml">K</mtext><mi id="A1.SS2.p2.3.m2.1.1.2.3" xref="A1.SS2.p2.3.m2.1.1.2.3.cmml">c</mi></msub><mo id="A1.SS2.p2.3.m2.1.1.1" xref="A1.SS2.p2.3.m2.1.1.1.cmml">∈</mo><msup id="A1.SS2.p2.3.m2.1.1.3" xref="A1.SS2.p2.3.m2.1.1.3.cmml"><mi id="A1.SS2.p2.3.m2.1.1.3.2" xref="A1.SS2.p2.3.m2.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS2.p2.3.m2.1.1.3.3" xref="A1.SS2.p2.3.m2.1.1.3.3.cmml"><mover accent="true" id="A1.SS2.p2.3.m2.1.1.3.3.2" xref="A1.SS2.p2.3.m2.1.1.3.3.2.cmml"><mi id="A1.SS2.p2.3.m2.1.1.3.3.2.2" xref="A1.SS2.p2.3.m2.1.1.3.3.2.2.cmml">T</mi><mo id="A1.SS2.p2.3.m2.1.1.3.3.2.1" xref="A1.SS2.p2.3.m2.1.1.3.3.2.1.cmml">^</mo></mover><mo id="A1.SS2.p2.3.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p2.3.m2.1.1.3.3.1.cmml">×</mo><mi id="A1.SS2.p2.3.m2.1.1.3.3.3" xref="A1.SS2.p2.3.m2.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m2.1b"><apply id="A1.SS2.p2.3.m2.1.1.cmml" xref="A1.SS2.p2.3.m2.1.1"><in id="A1.SS2.p2.3.m2.1.1.1.cmml" xref="A1.SS2.p2.3.m2.1.1.1"></in><apply id="A1.SS2.p2.3.m2.1.1.2.cmml" xref="A1.SS2.p2.3.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.3.m2.1.1.2.1.cmml" xref="A1.SS2.p2.3.m2.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.3.m2.1.1.2.2a.cmml" xref="A1.SS2.p2.3.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.3.m2.1.1.2.2.cmml" xref="A1.SS2.p2.3.m2.1.1.2.2">K</mtext></ci><ci id="A1.SS2.p2.3.m2.1.1.2.3.cmml" xref="A1.SS2.p2.3.m2.1.1.2.3">𝑐</ci></apply><apply id="A1.SS2.p2.3.m2.1.1.3.cmml" xref="A1.SS2.p2.3.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.3.m2.1.1.3.1.cmml" xref="A1.SS2.p2.3.m2.1.1.3">superscript</csymbol><ci id="A1.SS2.p2.3.m2.1.1.3.2.cmml" xref="A1.SS2.p2.3.m2.1.1.3.2">ℝ</ci><apply id="A1.SS2.p2.3.m2.1.1.3.3.cmml" xref="A1.SS2.p2.3.m2.1.1.3.3"><times id="A1.SS2.p2.3.m2.1.1.3.3.1.cmml" xref="A1.SS2.p2.3.m2.1.1.3.3.1"></times><apply id="A1.SS2.p2.3.m2.1.1.3.3.2.cmml" xref="A1.SS2.p2.3.m2.1.1.3.3.2"><ci id="A1.SS2.p2.3.m2.1.1.3.3.2.1.cmml" xref="A1.SS2.p2.3.m2.1.1.3.3.2.1">^</ci><ci id="A1.SS2.p2.3.m2.1.1.3.3.2.2.cmml" xref="A1.SS2.p2.3.m2.1.1.3.3.2.2">𝑇</ci></apply><ci id="A1.SS2.p2.3.m2.1.1.3.3.3.cmml" xref="A1.SS2.p2.3.m2.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m2.1c">\textbf{K}_{c}\in\mathbb{R}^{\hat{T}\times C}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m2.1d">K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> as the user-item cross features (e.g. user click timestamp, user play time, clicked page position, user-video interactions).
This split allows highly efficient computation of the following linear projection <math alttext="\textbf{K}_{h}\textbf{W}^{h}" class="ltx_Math" display="inline" id="A1.SS2.p2.4.m3.1"><semantics id="A1.SS2.p2.4.m3.1a"><mrow id="A1.SS2.p2.4.m3.1.1" xref="A1.SS2.p2.4.m3.1.1.cmml"><msub id="A1.SS2.p2.4.m3.1.1.2" xref="A1.SS2.p2.4.m3.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.4.m3.1.1.2.2" xref="A1.SS2.p2.4.m3.1.1.2.2a.cmml">K</mtext><mi id="A1.SS2.p2.4.m3.1.1.2.3" xref="A1.SS2.p2.4.m3.1.1.2.3.cmml">h</mi></msub><mo id="A1.SS2.p2.4.m3.1.1.1" xref="A1.SS2.p2.4.m3.1.1.1.cmml">⁢</mo><msup id="A1.SS2.p2.4.m3.1.1.3" xref="A1.SS2.p2.4.m3.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.4.m3.1.1.3.2" xref="A1.SS2.p2.4.m3.1.1.3.2a.cmml">W</mtext><mi id="A1.SS2.p2.4.m3.1.1.3.3" xref="A1.SS2.p2.4.m3.1.1.3.3.cmml">h</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.4.m3.1b"><apply id="A1.SS2.p2.4.m3.1.1.cmml" xref="A1.SS2.p2.4.m3.1.1"><times id="A1.SS2.p2.4.m3.1.1.1.cmml" xref="A1.SS2.p2.4.m3.1.1.1"></times><apply id="A1.SS2.p2.4.m3.1.1.2.cmml" xref="A1.SS2.p2.4.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m3.1.1.2.1.cmml" xref="A1.SS2.p2.4.m3.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.4.m3.1.1.2.2a.cmml" xref="A1.SS2.p2.4.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.4.m3.1.1.2.2.cmml" xref="A1.SS2.p2.4.m3.1.1.2.2">K</mtext></ci><ci id="A1.SS2.p2.4.m3.1.1.2.3.cmml" xref="A1.SS2.p2.4.m3.1.1.2.3">ℎ</ci></apply><apply id="A1.SS2.p2.4.m3.1.1.3.cmml" xref="A1.SS2.p2.4.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m3.1.1.3.1.cmml" xref="A1.SS2.p2.4.m3.1.1.3">superscript</csymbol><ci id="A1.SS2.p2.4.m3.1.1.3.2a.cmml" xref="A1.SS2.p2.4.m3.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.4.m3.1.1.3.2.cmml" xref="A1.SS2.p2.4.m3.1.1.3.2">W</mtext></ci><ci id="A1.SS2.p2.4.m3.1.1.3.3.cmml" xref="A1.SS2.p2.4.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.4.m3.1c">\textbf{K}_{h}\textbf{W}^{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.4.m3.1d">K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\textbf{K}_{c}\textbf{W}^{c}" class="ltx_Math" display="inline" id="A1.SS2.p2.5.m4.1"><semantics id="A1.SS2.p2.5.m4.1a"><mrow id="A1.SS2.p2.5.m4.1.1" xref="A1.SS2.p2.5.m4.1.1.cmml"><msub id="A1.SS2.p2.5.m4.1.1.2" xref="A1.SS2.p2.5.m4.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.5.m4.1.1.2.2" xref="A1.SS2.p2.5.m4.1.1.2.2a.cmml">K</mtext><mi id="A1.SS2.p2.5.m4.1.1.2.3" xref="A1.SS2.p2.5.m4.1.1.2.3.cmml">c</mi></msub><mo id="A1.SS2.p2.5.m4.1.1.1" xref="A1.SS2.p2.5.m4.1.1.1.cmml">⁢</mo><msup id="A1.SS2.p2.5.m4.1.1.3" xref="A1.SS2.p2.5.m4.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.5.m4.1.1.3.2" xref="A1.SS2.p2.5.m4.1.1.3.2a.cmml">W</mtext><mi id="A1.SS2.p2.5.m4.1.1.3.3" xref="A1.SS2.p2.5.m4.1.1.3.3.cmml">c</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.5.m4.1b"><apply id="A1.SS2.p2.5.m4.1.1.cmml" xref="A1.SS2.p2.5.m4.1.1"><times id="A1.SS2.p2.5.m4.1.1.1.cmml" xref="A1.SS2.p2.5.m4.1.1.1"></times><apply id="A1.SS2.p2.5.m4.1.1.2.cmml" xref="A1.SS2.p2.5.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.5.m4.1.1.2.1.cmml" xref="A1.SS2.p2.5.m4.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.5.m4.1.1.2.2a.cmml" xref="A1.SS2.p2.5.m4.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.5.m4.1.1.2.2.cmml" xref="A1.SS2.p2.5.m4.1.1.2.2">K</mtext></ci><ci id="A1.SS2.p2.5.m4.1.1.2.3.cmml" xref="A1.SS2.p2.5.m4.1.1.2.3">𝑐</ci></apply><apply id="A1.SS2.p2.5.m4.1.1.3.cmml" xref="A1.SS2.p2.5.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.5.m4.1.1.3.1.cmml" xref="A1.SS2.p2.5.m4.1.1.3">superscript</csymbol><ci id="A1.SS2.p2.5.m4.1.1.3.2a.cmml" xref="A1.SS2.p2.5.m4.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p2.5.m4.1.1.3.2.cmml" xref="A1.SS2.p2.5.m4.1.1.3.2">W</mtext></ci><ci id="A1.SS2.p2.5.m4.1.1.3.3.cmml" xref="A1.SS2.p2.5.m4.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.5.m4.1c">\textbf{K}_{c}\textbf{W}^{c}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.5.m4.1d">K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.3">For the inherent features <math alttext="\textbf{K}_{h}" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><msub id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p3.1.m1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2a.cmml">K</mtext><mi id="A1.SS2.p3.1.m1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.1.m1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p3.1.m1.1.1.2a.cmml" xref="A1.SS2.p3.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p3.1.m1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.2">K</mtext></ci><ci id="A1.SS2.p3.1.m1.1.1.3.cmml" xref="A1.SS2.p3.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">\textbf{K}_{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>, although the dimension <span class="ltx_text ltx_markedasmath ltx_font_bold" id="A1.SS2.p3.3.1">H</span> is large (64 for each id feature), the linear projection is not costly. The inherent features of a specific item are shared across users/behavior sequences. With essential caching strategies, <math alttext="\textbf{K}_{h}\textbf{W}^{h}" class="ltx_Math" display="inline" id="A1.SS2.p3.3.m3.1"><semantics id="A1.SS2.p3.3.m3.1a"><mrow id="A1.SS2.p3.3.m3.1.1" xref="A1.SS2.p3.3.m3.1.1.cmml"><msub id="A1.SS2.p3.3.m3.1.1.2" xref="A1.SS2.p3.3.m3.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p3.3.m3.1.1.2.2" xref="A1.SS2.p3.3.m3.1.1.2.2a.cmml">K</mtext><mi id="A1.SS2.p3.3.m3.1.1.2.3" xref="A1.SS2.p3.3.m3.1.1.2.3.cmml">h</mi></msub><mo id="A1.SS2.p3.3.m3.1.1.1" xref="A1.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><msup id="A1.SS2.p3.3.m3.1.1.3" xref="A1.SS2.p3.3.m3.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p3.3.m3.1.1.3.2" xref="A1.SS2.p3.3.m3.1.1.3.2a.cmml">W</mtext><mi id="A1.SS2.p3.3.m3.1.1.3.3" xref="A1.SS2.p3.3.m3.1.1.3.3.cmml">h</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.1b"><apply id="A1.SS2.p3.3.m3.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1"><times id="A1.SS2.p3.3.m3.1.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1.1"></times><apply id="A1.SS2.p3.3.m3.1.1.2.cmml" xref="A1.SS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.1.2.1.cmml" xref="A1.SS2.p3.3.m3.1.1.2">subscript</csymbol><ci id="A1.SS2.p3.3.m3.1.1.2.2a.cmml" xref="A1.SS2.p3.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p3.3.m3.1.1.2.2.cmml" xref="A1.SS2.p3.3.m3.1.1.2.2">K</mtext></ci><ci id="A1.SS2.p3.3.m3.1.1.2.3.cmml" xref="A1.SS2.p3.3.m3.1.1.2.3">ℎ</ci></apply><apply id="A1.SS2.p3.3.m3.1.1.3.cmml" xref="A1.SS2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.1.3.1.cmml" xref="A1.SS2.p3.3.m3.1.1.3">superscript</csymbol><ci id="A1.SS2.p3.3.m3.1.1.3.2a.cmml" xref="A1.SS2.p3.3.m3.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p3.3.m3.1.1.3.2.cmml" xref="A1.SS2.p3.3.m3.1.1.3.2">W</mtext></ci><ci id="A1.SS2.p3.3.m3.1.1.3.3.cmml" xref="A1.SS2.p3.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.1c">\textbf{K}_{h}\textbf{W}^{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.3.m3.1d">K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> could be efficiently “calculated” by a look-up and gathering procedure.</p>
</div>
<div class="ltx_para" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.1">For the user-item cross features <math alttext="\textbf{K}_{c}" class="ltx_Math" display="inline" id="A1.SS2.p4.1.m1.1"><semantics id="A1.SS2.p4.1.m1.1a"><msub id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2a.cmml">K</mtext><mi id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p4.1.m1.1.1.2a.cmml" xref="A1.SS2.p4.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2">K</mtext></ci><ci id="A1.SS2.p4.1.m1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">\textbf{K}_{c}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.1.m1.1d">K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, caching strategies are not applicable because:
1). Cross features describe the interaction details between a user and a video, thus not shared across users’ behavior sequences.
2). Each user watches a video at most once. Namely, there is no duplicated computation in projecting cross features.
We thus reduce the computational cost by simplifying the linear projection weight.</p>
</div>
<div class="ltx_para" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.3">Given <math alttext="J" class="ltx_Math" display="inline" id="A1.SS2.p5.1.m1.1"><semantics id="A1.SS2.p5.1.m1.1a"><mi id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b"><ci id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">J</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.1.m1.1d">italic_J</annotation></semantics></math> cross features, each with embedding dimension <math alttext="8" class="ltx_Math" display="inline" id="A1.SS2.p5.2.m2.1"><semantics id="A1.SS2.p5.2.m2.1a"><mn id="A1.SS2.p5.2.m2.1.1" xref="A1.SS2.p5.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.1b"><cn id="A1.SS2.p5.2.m2.1.1.cmml" type="integer" xref="A1.SS2.p5.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.2.m2.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.2.m2.1d">8</annotation></semantics></math> (since not id features with huge vocabulary size). We have <math alttext="C=8J" class="ltx_Math" display="inline" id="A1.SS2.p5.3.m3.1"><semantics id="A1.SS2.p5.3.m3.1a"><mrow id="A1.SS2.p5.3.m3.1.1" xref="A1.SS2.p5.3.m3.1.1.cmml"><mi id="A1.SS2.p5.3.m3.1.1.2" xref="A1.SS2.p5.3.m3.1.1.2.cmml">C</mi><mo id="A1.SS2.p5.3.m3.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.cmml">=</mo><mrow id="A1.SS2.p5.3.m3.1.1.3" xref="A1.SS2.p5.3.m3.1.1.3.cmml"><mn id="A1.SS2.p5.3.m3.1.1.3.2" xref="A1.SS2.p5.3.m3.1.1.3.2.cmml">8</mn><mo id="A1.SS2.p5.3.m3.1.1.3.1" xref="A1.SS2.p5.3.m3.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p5.3.m3.1.1.3.3" xref="A1.SS2.p5.3.m3.1.1.3.3.cmml">J</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.1b"><apply id="A1.SS2.p5.3.m3.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1"><eq id="A1.SS2.p5.3.m3.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1"></eq><ci id="A1.SS2.p5.3.m3.1.1.2.cmml" xref="A1.SS2.p5.3.m3.1.1.2">𝐶</ci><apply id="A1.SS2.p5.3.m3.1.1.3.cmml" xref="A1.SS2.p5.3.m3.1.1.3"><times id="A1.SS2.p5.3.m3.1.1.3.1.cmml" xref="A1.SS2.p5.3.m3.1.1.3.1"></times><cn id="A1.SS2.p5.3.m3.1.1.3.2.cmml" type="integer" xref="A1.SS2.p5.3.m3.1.1.3.2">8</cn><ci id="A1.SS2.p5.3.m3.1.1.3.3.cmml" xref="A1.SS2.p5.3.m3.1.1.3.3">𝐽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.1c">C=8J</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.3.m3.1d">italic_C = 8 italic_J</annotation></semantics></math>.
We simplify the linear projection as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{K}_{c}\textbf{W}^{c}\triangleq\left[\begin{array}[]{ccc}\textbf{K}_{c,%
1}\mathbf{w}_{1}^{c},&amp;...&amp;,\textbf{K}_{c,J}\mathbf{w}_{J}^{c}\end{array}\right]," class="ltx_math_unparsed" display="block" id="A1.E13.m1.6"><semantics id="A1.E13.m1.6a"><mrow id="A1.E13.m1.6.6.1"><mrow id="A1.E13.m1.6.6.1.1"><mrow id="A1.E13.m1.6.6.1.1.2"><msub id="A1.E13.m1.6.6.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="A1.E13.m1.6.6.1.1.2.2.2">K</mtext><mi id="A1.E13.m1.6.6.1.1.2.2.3">c</mi></msub><mo id="A1.E13.m1.6.6.1.1.2.1">⁢</mo><msup id="A1.E13.m1.6.6.1.1.2.3"><mtext class="ltx_mathvariant_bold" id="A1.E13.m1.6.6.1.1.2.3.2">W</mtext><mi id="A1.E13.m1.6.6.1.1.2.3.3">c</mi></msup></mrow><mo id="A1.E13.m1.6.6.1.1.1">≜</mo><mrow id="A1.E13.m1.6.6.1.1.3.2"><mo id="A1.E13.m1.6.6.1.1.3.2.1">[</mo><mtable columnspacing="5pt" displaystyle="true" id="A1.E13.m1.5.5"><mtr id="A1.E13.m1.5.5a"><mtd id="A1.E13.m1.5.5b"><mrow id="A1.E13.m1.3.3.3.3.3.3"><mrow id="A1.E13.m1.3.3.3.3.3.3.1"><msub id="A1.E13.m1.3.3.3.3.3.3.1.2"><mtext class="ltx_mathvariant_bold" id="A1.E13.m1.3.3.3.3.3.3.1.2.2">K</mtext><mrow id="A1.E13.m1.2.2.2.2.2.2.2.4"><mi id="A1.E13.m1.1.1.1.1.1.1.1.1">c</mi><mo id="A1.E13.m1.2.2.2.2.2.2.2.4.1">,</mo><mn id="A1.E13.m1.2.2.2.2.2.2.2.2">1</mn></mrow></msub><mo id="A1.E13.m1.3.3.3.3.3.3.1.1">⁢</mo><msubsup id="A1.E13.m1.3.3.3.3.3.3.1.3"><mi id="A1.E13.m1.3.3.3.3.3.3.1.3.2.2">𝐰</mi><mn id="A1.E13.m1.3.3.3.3.3.3.1.3.2.3">1</mn><mi id="A1.E13.m1.3.3.3.3.3.3.1.3.3">c</mi></msubsup></mrow><mo id="A1.E13.m1.3.3.3.3.3.3.2">,</mo></mrow></mtd><mtd id="A1.E13.m1.5.5c"><mi id="A1.E13.m1.5.5.5.6.1" mathvariant="normal">…</mi></mtd><mtd id="A1.E13.m1.5.5d"><mrow id="A1.E13.m1.5.5.5.5.2"><mo id="A1.E13.m1.5.5.5.5.2.3">,</mo><msub id="A1.E13.m1.5.5.5.5.2.4"><mtext class="ltx_mathvariant_bold" id="A1.E13.m1.5.5.5.5.2.4.2">K</mtext><mrow id="A1.E13.m1.5.5.5.5.2.2.2.4"><mi id="A1.E13.m1.4.4.4.4.1.1.1.1">c</mi><mo id="A1.E13.m1.5.5.5.5.2.2.2.4.1">,</mo><mi id="A1.E13.m1.5.5.5.5.2.2.2.2">J</mi></mrow></msub><msubsup id="A1.E13.m1.5.5.5.5.2.5"><mi id="A1.E13.m1.5.5.5.5.2.5.2.2">𝐰</mi><mi id="A1.E13.m1.5.5.5.5.2.5.2.3">J</mi><mi id="A1.E13.m1.5.5.5.5.2.5.3">c</mi></msubsup></mrow></mtd></mtr></mtable><mo id="A1.E13.m1.6.6.1.1.3.2.2">]</mo></mrow></mrow><mo id="A1.E13.m1.6.6.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="A1.E13.m1.6b">\textbf{K}_{c}\textbf{W}^{c}\triangleq\left[\begin{array}[]{ccc}\textbf{K}_{c,%
1}\mathbf{w}_{1}^{c},&amp;...&amp;,\textbf{K}_{c,J}\mathbf{w}_{J}^{c}\end{array}\right],</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.6c">K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ≜ [ start_ARRAY start_ROW start_CELL K start_POSTSUBSCRIPT italic_c , 1 end_POSTSUBSCRIPT bold_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT , end_CELL start_CELL … end_CELL start_CELL , K start_POSTSUBSCRIPT italic_c , italic_J end_POSTSUBSCRIPT bold_w start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT end_CELL end_ROW end_ARRAY ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p5.9">where <math alttext="\textbf{K}_{c,j}\in\mathbb{R}^{\hat{T}\times 8}" class="ltx_Math" display="inline" id="A1.SS2.p5.4.m1.2"><semantics id="A1.SS2.p5.4.m1.2a"><mrow id="A1.SS2.p5.4.m1.2.3" xref="A1.SS2.p5.4.m1.2.3.cmml"><msub id="A1.SS2.p5.4.m1.2.3.2" xref="A1.SS2.p5.4.m1.2.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.4.m1.2.3.2.2" xref="A1.SS2.p5.4.m1.2.3.2.2a.cmml">K</mtext><mrow id="A1.SS2.p5.4.m1.2.2.2.4" xref="A1.SS2.p5.4.m1.2.2.2.3.cmml"><mi id="A1.SS2.p5.4.m1.1.1.1.1" xref="A1.SS2.p5.4.m1.1.1.1.1.cmml">c</mi><mo id="A1.SS2.p5.4.m1.2.2.2.4.1" xref="A1.SS2.p5.4.m1.2.2.2.3.cmml">,</mo><mi id="A1.SS2.p5.4.m1.2.2.2.2" xref="A1.SS2.p5.4.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.SS2.p5.4.m1.2.3.1" xref="A1.SS2.p5.4.m1.2.3.1.cmml">∈</mo><msup id="A1.SS2.p5.4.m1.2.3.3" xref="A1.SS2.p5.4.m1.2.3.3.cmml"><mi id="A1.SS2.p5.4.m1.2.3.3.2" xref="A1.SS2.p5.4.m1.2.3.3.2.cmml">ℝ</mi><mrow id="A1.SS2.p5.4.m1.2.3.3.3" xref="A1.SS2.p5.4.m1.2.3.3.3.cmml"><mover accent="true" id="A1.SS2.p5.4.m1.2.3.3.3.2" xref="A1.SS2.p5.4.m1.2.3.3.3.2.cmml"><mi id="A1.SS2.p5.4.m1.2.3.3.3.2.2" xref="A1.SS2.p5.4.m1.2.3.3.3.2.2.cmml">T</mi><mo id="A1.SS2.p5.4.m1.2.3.3.3.2.1" xref="A1.SS2.p5.4.m1.2.3.3.3.2.1.cmml">^</mo></mover><mo id="A1.SS2.p5.4.m1.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p5.4.m1.2.3.3.3.1.cmml">×</mo><mn id="A1.SS2.p5.4.m1.2.3.3.3.3" xref="A1.SS2.p5.4.m1.2.3.3.3.3.cmml">8</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.4.m1.2b"><apply id="A1.SS2.p5.4.m1.2.3.cmml" xref="A1.SS2.p5.4.m1.2.3"><in id="A1.SS2.p5.4.m1.2.3.1.cmml" xref="A1.SS2.p5.4.m1.2.3.1"></in><apply id="A1.SS2.p5.4.m1.2.3.2.cmml" xref="A1.SS2.p5.4.m1.2.3.2"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m1.2.3.2.1.cmml" xref="A1.SS2.p5.4.m1.2.3.2">subscript</csymbol><ci id="A1.SS2.p5.4.m1.2.3.2.2a.cmml" xref="A1.SS2.p5.4.m1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.4.m1.2.3.2.2.cmml" xref="A1.SS2.p5.4.m1.2.3.2.2">K</mtext></ci><list id="A1.SS2.p5.4.m1.2.2.2.3.cmml" xref="A1.SS2.p5.4.m1.2.2.2.4"><ci id="A1.SS2.p5.4.m1.1.1.1.1.cmml" xref="A1.SS2.p5.4.m1.1.1.1.1">𝑐</ci><ci id="A1.SS2.p5.4.m1.2.2.2.2.cmml" xref="A1.SS2.p5.4.m1.2.2.2.2">𝑗</ci></list></apply><apply id="A1.SS2.p5.4.m1.2.3.3.cmml" xref="A1.SS2.p5.4.m1.2.3.3"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m1.2.3.3.1.cmml" xref="A1.SS2.p5.4.m1.2.3.3">superscript</csymbol><ci id="A1.SS2.p5.4.m1.2.3.3.2.cmml" xref="A1.SS2.p5.4.m1.2.3.3.2">ℝ</ci><apply id="A1.SS2.p5.4.m1.2.3.3.3.cmml" xref="A1.SS2.p5.4.m1.2.3.3.3"><times id="A1.SS2.p5.4.m1.2.3.3.3.1.cmml" xref="A1.SS2.p5.4.m1.2.3.3.3.1"></times><apply id="A1.SS2.p5.4.m1.2.3.3.3.2.cmml" xref="A1.SS2.p5.4.m1.2.3.3.3.2"><ci id="A1.SS2.p5.4.m1.2.3.3.3.2.1.cmml" xref="A1.SS2.p5.4.m1.2.3.3.3.2.1">^</ci><ci id="A1.SS2.p5.4.m1.2.3.3.3.2.2.cmml" xref="A1.SS2.p5.4.m1.2.3.3.3.2.2">𝑇</ci></apply><cn id="A1.SS2.p5.4.m1.2.3.3.3.3.cmml" type="integer" xref="A1.SS2.p5.4.m1.2.3.3.3.3">8</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.4.m1.2c">\textbf{K}_{c,j}\in\mathbb{R}^{\hat{T}\times 8}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.4.m1.2d">K start_POSTSUBSCRIPT italic_c , italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG × 8 end_POSTSUPERSCRIPT</annotation></semantics></math> is a column-wise slice of <math alttext="\textbf{K}_{c}" class="ltx_Math" display="inline" id="A1.SS2.p5.5.m2.1"><semantics id="A1.SS2.p5.5.m2.1a"><msub id="A1.SS2.p5.5.m2.1.1" xref="A1.SS2.p5.5.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.5.m2.1.1.2" xref="A1.SS2.p5.5.m2.1.1.2a.cmml">K</mtext><mi id="A1.SS2.p5.5.m2.1.1.3" xref="A1.SS2.p5.5.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.5.m2.1b"><apply id="A1.SS2.p5.5.m2.1.1.cmml" xref="A1.SS2.p5.5.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.5.m2.1.1.1.cmml" xref="A1.SS2.p5.5.m2.1.1">subscript</csymbol><ci id="A1.SS2.p5.5.m2.1.1.2a.cmml" xref="A1.SS2.p5.5.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.5.m2.1.1.2.cmml" xref="A1.SS2.p5.5.m2.1.1.2">K</mtext></ci><ci id="A1.SS2.p5.5.m2.1.1.3.cmml" xref="A1.SS2.p5.5.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.5.m2.1c">\textbf{K}_{c}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.5.m2.1d">K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> for the <math alttext="j" class="ltx_Math" display="inline" id="A1.SS2.p5.6.m3.1"><semantics id="A1.SS2.p5.6.m3.1a"><mi id="A1.SS2.p5.6.m3.1.1" xref="A1.SS2.p5.6.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.6.m3.1b"><ci id="A1.SS2.p5.6.m3.1.1.cmml" xref="A1.SS2.p5.6.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.6.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.6.m3.1d">italic_j</annotation></semantics></math>-th cross feature, and <math alttext="\mathbf{w}_{j}^{c}\in\mathbb{R}^{8}" class="ltx_Math" display="inline" id="A1.SS2.p5.7.m4.1"><semantics id="A1.SS2.p5.7.m4.1a"><mrow id="A1.SS2.p5.7.m4.1.1" xref="A1.SS2.p5.7.m4.1.1.cmml"><msubsup id="A1.SS2.p5.7.m4.1.1.2" xref="A1.SS2.p5.7.m4.1.1.2.cmml"><mi id="A1.SS2.p5.7.m4.1.1.2.2.2" xref="A1.SS2.p5.7.m4.1.1.2.2.2.cmml">𝐰</mi><mi id="A1.SS2.p5.7.m4.1.1.2.2.3" xref="A1.SS2.p5.7.m4.1.1.2.2.3.cmml">j</mi><mi id="A1.SS2.p5.7.m4.1.1.2.3" xref="A1.SS2.p5.7.m4.1.1.2.3.cmml">c</mi></msubsup><mo id="A1.SS2.p5.7.m4.1.1.1" xref="A1.SS2.p5.7.m4.1.1.1.cmml">∈</mo><msup id="A1.SS2.p5.7.m4.1.1.3" xref="A1.SS2.p5.7.m4.1.1.3.cmml"><mi id="A1.SS2.p5.7.m4.1.1.3.2" xref="A1.SS2.p5.7.m4.1.1.3.2.cmml">ℝ</mi><mn id="A1.SS2.p5.7.m4.1.1.3.3" xref="A1.SS2.p5.7.m4.1.1.3.3.cmml">8</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.7.m4.1b"><apply id="A1.SS2.p5.7.m4.1.1.cmml" xref="A1.SS2.p5.7.m4.1.1"><in id="A1.SS2.p5.7.m4.1.1.1.cmml" xref="A1.SS2.p5.7.m4.1.1.1"></in><apply id="A1.SS2.p5.7.m4.1.1.2.cmml" xref="A1.SS2.p5.7.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p5.7.m4.1.1.2.1.cmml" xref="A1.SS2.p5.7.m4.1.1.2">superscript</csymbol><apply id="A1.SS2.p5.7.m4.1.1.2.2.cmml" xref="A1.SS2.p5.7.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p5.7.m4.1.1.2.2.1.cmml" xref="A1.SS2.p5.7.m4.1.1.2">subscript</csymbol><ci id="A1.SS2.p5.7.m4.1.1.2.2.2.cmml" xref="A1.SS2.p5.7.m4.1.1.2.2.2">𝐰</ci><ci id="A1.SS2.p5.7.m4.1.1.2.2.3.cmml" xref="A1.SS2.p5.7.m4.1.1.2.2.3">𝑗</ci></apply><ci id="A1.SS2.p5.7.m4.1.1.2.3.cmml" xref="A1.SS2.p5.7.m4.1.1.2.3">𝑐</ci></apply><apply id="A1.SS2.p5.7.m4.1.1.3.cmml" xref="A1.SS2.p5.7.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.7.m4.1.1.3.1.cmml" xref="A1.SS2.p5.7.m4.1.1.3">superscript</csymbol><ci id="A1.SS2.p5.7.m4.1.1.3.2.cmml" xref="A1.SS2.p5.7.m4.1.1.3.2">ℝ</ci><cn id="A1.SS2.p5.7.m4.1.1.3.3.cmml" type="integer" xref="A1.SS2.p5.7.m4.1.1.3.3">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.7.m4.1c">\mathbf{w}_{j}^{c}\in\mathbb{R}^{8}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.7.m4.1d">bold_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 8 end_POSTSUPERSCRIPT</annotation></semantics></math> is its linear projection weight. Using this simplified projection, we compress each cross feature into one dimension, i.e., <math alttext="\textbf{K}_{c}\textbf{W}^{c}\in\mathbb{R}^{\hat{T}\times J}" class="ltx_Math" display="inline" id="A1.SS2.p5.8.m5.1"><semantics id="A1.SS2.p5.8.m5.1a"><mrow id="A1.SS2.p5.8.m5.1.1" xref="A1.SS2.p5.8.m5.1.1.cmml"><mrow id="A1.SS2.p5.8.m5.1.1.2" xref="A1.SS2.p5.8.m5.1.1.2.cmml"><msub id="A1.SS2.p5.8.m5.1.1.2.2" xref="A1.SS2.p5.8.m5.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.8.m5.1.1.2.2.2" xref="A1.SS2.p5.8.m5.1.1.2.2.2a.cmml">K</mtext><mi id="A1.SS2.p5.8.m5.1.1.2.2.3" xref="A1.SS2.p5.8.m5.1.1.2.2.3.cmml">c</mi></msub><mo id="A1.SS2.p5.8.m5.1.1.2.1" xref="A1.SS2.p5.8.m5.1.1.2.1.cmml">⁢</mo><msup id="A1.SS2.p5.8.m5.1.1.2.3" xref="A1.SS2.p5.8.m5.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.8.m5.1.1.2.3.2" xref="A1.SS2.p5.8.m5.1.1.2.3.2a.cmml">W</mtext><mi id="A1.SS2.p5.8.m5.1.1.2.3.3" xref="A1.SS2.p5.8.m5.1.1.2.3.3.cmml">c</mi></msup></mrow><mo id="A1.SS2.p5.8.m5.1.1.1" xref="A1.SS2.p5.8.m5.1.1.1.cmml">∈</mo><msup id="A1.SS2.p5.8.m5.1.1.3" xref="A1.SS2.p5.8.m5.1.1.3.cmml"><mi id="A1.SS2.p5.8.m5.1.1.3.2" xref="A1.SS2.p5.8.m5.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS2.p5.8.m5.1.1.3.3" xref="A1.SS2.p5.8.m5.1.1.3.3.cmml"><mover accent="true" id="A1.SS2.p5.8.m5.1.1.3.3.2" xref="A1.SS2.p5.8.m5.1.1.3.3.2.cmml"><mi id="A1.SS2.p5.8.m5.1.1.3.3.2.2" xref="A1.SS2.p5.8.m5.1.1.3.3.2.2.cmml">T</mi><mo id="A1.SS2.p5.8.m5.1.1.3.3.2.1" xref="A1.SS2.p5.8.m5.1.1.3.3.2.1.cmml">^</mo></mover><mo id="A1.SS2.p5.8.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p5.8.m5.1.1.3.3.1.cmml">×</mo><mi id="A1.SS2.p5.8.m5.1.1.3.3.3" xref="A1.SS2.p5.8.m5.1.1.3.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.8.m5.1b"><apply id="A1.SS2.p5.8.m5.1.1.cmml" xref="A1.SS2.p5.8.m5.1.1"><in id="A1.SS2.p5.8.m5.1.1.1.cmml" xref="A1.SS2.p5.8.m5.1.1.1"></in><apply id="A1.SS2.p5.8.m5.1.1.2.cmml" xref="A1.SS2.p5.8.m5.1.1.2"><times id="A1.SS2.p5.8.m5.1.1.2.1.cmml" xref="A1.SS2.p5.8.m5.1.1.2.1"></times><apply id="A1.SS2.p5.8.m5.1.1.2.2.cmml" xref="A1.SS2.p5.8.m5.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p5.8.m5.1.1.2.2.1.cmml" xref="A1.SS2.p5.8.m5.1.1.2.2">subscript</csymbol><ci id="A1.SS2.p5.8.m5.1.1.2.2.2a.cmml" xref="A1.SS2.p5.8.m5.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.8.m5.1.1.2.2.2.cmml" xref="A1.SS2.p5.8.m5.1.1.2.2.2">K</mtext></ci><ci id="A1.SS2.p5.8.m5.1.1.2.2.3.cmml" xref="A1.SS2.p5.8.m5.1.1.2.2.3">𝑐</ci></apply><apply id="A1.SS2.p5.8.m5.1.1.2.3.cmml" xref="A1.SS2.p5.8.m5.1.1.2.3"><csymbol cd="ambiguous" id="A1.SS2.p5.8.m5.1.1.2.3.1.cmml" xref="A1.SS2.p5.8.m5.1.1.2.3">superscript</csymbol><ci id="A1.SS2.p5.8.m5.1.1.2.3.2a.cmml" xref="A1.SS2.p5.8.m5.1.1.2.3.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.8.m5.1.1.2.3.2.cmml" xref="A1.SS2.p5.8.m5.1.1.2.3.2">W</mtext></ci><ci id="A1.SS2.p5.8.m5.1.1.2.3.3.cmml" xref="A1.SS2.p5.8.m5.1.1.2.3.3">𝑐</ci></apply></apply><apply id="A1.SS2.p5.8.m5.1.1.3.cmml" xref="A1.SS2.p5.8.m5.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.8.m5.1.1.3.1.cmml" xref="A1.SS2.p5.8.m5.1.1.3">superscript</csymbol><ci id="A1.SS2.p5.8.m5.1.1.3.2.cmml" xref="A1.SS2.p5.8.m5.1.1.3.2">ℝ</ci><apply id="A1.SS2.p5.8.m5.1.1.3.3.cmml" xref="A1.SS2.p5.8.m5.1.1.3.3"><times id="A1.SS2.p5.8.m5.1.1.3.3.1.cmml" xref="A1.SS2.p5.8.m5.1.1.3.3.1"></times><apply id="A1.SS2.p5.8.m5.1.1.3.3.2.cmml" xref="A1.SS2.p5.8.m5.1.1.3.3.2"><ci id="A1.SS2.p5.8.m5.1.1.3.3.2.1.cmml" xref="A1.SS2.p5.8.m5.1.1.3.3.2.1">^</ci><ci id="A1.SS2.p5.8.m5.1.1.3.3.2.2.cmml" xref="A1.SS2.p5.8.m5.1.1.3.3.2.2">𝑇</ci></apply><ci id="A1.SS2.p5.8.m5.1.1.3.3.3.cmml" xref="A1.SS2.p5.8.m5.1.1.3.3.3">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.8.m5.1c">\textbf{K}_{c}\textbf{W}^{c}\in\mathbb{R}^{\hat{T}\times J}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.8.m5.1d">K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG × italic_J end_POSTSUPERSCRIPT</annotation></semantics></math>. Note that
this simplified projection is
equivalent to restricting <math alttext="\textbf{W}^{c}" class="ltx_Math" display="inline" id="A1.SS2.p5.9.m6.1"><semantics id="A1.SS2.p5.9.m6.1a"><msup id="A1.SS2.p5.9.m6.1.1" xref="A1.SS2.p5.9.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.9.m6.1.1.2" xref="A1.SS2.p5.9.m6.1.1.2a.cmml">W</mtext><mi id="A1.SS2.p5.9.m6.1.1.3" xref="A1.SS2.p5.9.m6.1.1.3.cmml">c</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.9.m6.1b"><apply id="A1.SS2.p5.9.m6.1.1.cmml" xref="A1.SS2.p5.9.m6.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.9.m6.1.1.1.cmml" xref="A1.SS2.p5.9.m6.1.1">superscript</csymbol><ci id="A1.SS2.p5.9.m6.1.1.2a.cmml" xref="A1.SS2.p5.9.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.p5.9.m6.1.1.2.cmml" xref="A1.SS2.p5.9.m6.1.1.2">W</mtext></ci><ci id="A1.SS2.p5.9.m6.1.1.3.cmml" xref="A1.SS2.p5.9.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.9.m6.1c">\textbf{W}^{c}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.9.m6.1d">W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> to a diagonal block matrix.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3. </span>Analysis of User Activity Levels</h3>
<figure class="ltx_figure" id="A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="137" id="A1.F5.g1" src="x6.png" width="332"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F5.2.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="A1.F5.3.2" style="font-size:90%;">GAUC improvement among users of three activity levels with different proportions.
The improvement in GAUC is calculated by subtracting the GAUC of TWIN from the GAUC of TWIN-V2.
TWIN-V2 demonstrates more improvements for users with a longer history.
</span></figcaption>
</figure>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">We postulate that enhancing recommendation model performance can be achieved by extending the length of user history input.
Given that users with different activity levels exhibit varied lengths of historical behavior, the effect of extending long-term interest modeling to the life-cycle level is likely to differ among them.
Consequently, we grouped users by different history lengths and reported the performance improvement across these groups.</p>
</div>
<div class="ltx_para" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.1">We categorized users in the dataset into three groups based on the number of their historical behaviors: Low, Medium, and High.
Additionally, we calculated the GAUC for TWIN and TWIN-V2 models across these groups. The improvements in GAUC for TWIN-V2 in different groups and their respective proportions of the total user count are shown in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2407.16357v2#A1.F5" title="Figure 5 ‣ A.3. Analysis of User Activity Levels ‣ Appendix A APPENDIX ‣ TWIN V2: Scaling Ultra-Long User Behavior Sequence Modeling for Enhanced CTR Prediction at Kuaishou"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>.
It is observable that TWIN-V2 achieves performance improvements across all user groups, validating the effectiveness of our approach.
It is also evident that the absolute increase in GAUC is greater in user groups with a higher number of historical behaviors.
This occurs as users with a greater number of historical actions possess a broader spectrum of interests within their life-cycle behaviors, thereby presenting more significant opportunities for enhancement.
Additionally, TWIN-V2 also achieves performance improvements in groups of users with shorter histories.
This is due to the incorporation of clustered behavior features in the cluster-aware target attention mechanism. These features represent the aggregated characteristics of all items within the cluster. Consequently, the data fed into GSU and ESU reflects a more comprehensive scope of behaviors compared to TWIN, leading to improved performance.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Aug 16 05:15:54 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
