<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.00534] RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training</title><meta property="og:description" content="Vision-and-language multi-modal pretraining and fine-tuning have shown great success in visual question answering (VQA).
Compared to general domain VQA, the performance of biomedical VQA suffers from limited data.
In t…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.00534">

<!--Generated on Thu Feb 29 22:20:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">RAMM: Retrieval-augmented Biomedical Visual Question Answering 
<br class="ltx_break">with Multi-modal Pre-training</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zheng Yuan<sup id="id10.10.id1" class="ltx_sup"><span id="id10.10.id1.1" class="ltx_text ltx_font_italic">1</span></sup>, Qiao Jin<sup id="id11.11.id2" class="ltx_sup"><span id="id11.11.id2.1" class="ltx_text ltx_font_italic">12</span></sup>, Chuanqi Tan<sup id="id12.12.id3" class="ltx_sup"><span id="id12.12.id3.1" class="ltx_text ltx_font_italic">1</span></sup>, Zhengyun Zhao<sup id="id13.13.id4" class="ltx_sup"><span id="id13.13.id4.1" class="ltx_text ltx_font_italic">2</span></sup>, Hongyi Yuan<sup id="id14.14.id5" class="ltx_sup"><span id="id14.14.id5.1" class="ltx_text ltx_font_italic">12</span></sup>, Fei Huang<sup id="id15.15.id6" class="ltx_sup"><span id="id15.15.id6.1" class="ltx_text ltx_font_italic">1</span></sup>, Songfang Huang<sup id="id16.16.id7" class="ltx_sup"><span id="id16.16.id7.1" class="ltx_text ltx_font_italic">1</span></sup>
<br class="ltx_break"><sup id="id17.17.id8" class="ltx_sup"><span id="id17.17.id8.1" class="ltx_text ltx_font_italic">1</span></sup>Alibaba Group, <sup id="id18.18.id9" class="ltx_sup"><span id="id18.18.id9.1" class="ltx_text ltx_font_italic">2</span></sup>Tsinghua University 
<br class="ltx_break"><span id="id19.19.id10" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{yuanzheng.yuanzhen,qiao.jqa,chuanqi.tcq,f.huang,songfang.hsf}@alibaba-inc.com
</span> 
<br class="ltx_break"><span id="id20.20.id11" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{zhengyun21,yuanhy20}@mails.tsinghua.edu.cn</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id21.id1" class="ltx_p">Vision-and-language multi-modal pretraining and fine-tuning have shown great success in visual question answering (VQA).
Compared to general domain VQA, the performance of biomedical VQA suffers from limited data.
In this paper, we propose a retrieval-augmented pretrain-and-finetune paradigm named <span id="id21.id1.1" class="ltx_text ltx_font_bold">RAMM</span> for biomedical VQA to overcome the data limitation issue. Specifically, we collect a new biomedical dataset named <span id="id21.id1.2" class="ltx_text ltx_font_bold">PMCPM</span> which offers patient-based image-text pairs containing diverse patient situations from PubMed. Then, we
pretrain the biomedical multi-modal model to learn visual and textual representation for image-text pairs and align these representations with image-text contrastive objective (ITC).
Finally, we propose a retrieval-augmented method to better use the limited data. We propose to retrieve similar image-text pairs based on ITC from pretraining datasets and introduce a novel retrieval-attention module to fuse the representation of the image and the question with the retrieved images and texts.
Experiments demonstrate that our retrieval-augmented pretrain-and-finetune paradigm obtains state-of-the-art performance on Med-VQA2019, Med-VQA2021, VQARAD, and SLAKE datasets.
Further analysis shows that the proposed RAMM and PMCPM can enhance biomedical VQA performance compared with previous resources and methods.
We will open-source our dataset, codes, and pretrained model.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2303.00534/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="452" height="206" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Example of a similar image whose text includes helpful information for answering biomedical questions. The left part is a biomedical-related question with a provided image. The right part is a similar image in PubMed with a relevant caption that indicates the answer (text in red) to the question.
</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Biomedical visual question answering (VQA) aims to answer a biomedical-related question with a provided image.
The images in the biomedical VQA are usually radiology images
(e.g. CT, MRI, and X-Ray), and the questions usually involve modalities, body parts, planes, and abnormal parts in corresponding images.
Answering these questions requires rich knowledge of clinical and medical imaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, which is challenging for automated approaches.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">With the success of the general domain VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, some works follow the pretrain-and-finetune paradigm to attempt domain-specific vision-and-language modeling for biomedical VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
However, unlike the general domain that adequates labeled VQA pairs for fine-tuning, the biomedical domain still suffers from limited data in fine-tuning, which makes models vulnerable to overfitting and hampers the models’ ability to learn comprehensive domain knowledge for answering complicated questions.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In contrast to limited data in biomedical VQA datasets, biomedical literature contains abundant and high-quality image-text pairs.
These texts usually describe the images in all aspects including modality, body part, plane, and abnormality which are the information in which biomedical VQA is interested.
Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows an example that the image-text pair from PubMed<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2769318/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2769318/</a></span></span></span> can benefit to answer the question in the VQA dataset.
Based on this observation, we argue that retrieval is a feasible option for biomedical VQA. This procedure simulates how doctors solve complicated patient cases: doctors search for similar cases to the provided one and propose a solution based on previous experience.
Therefore, we can retrieve similar image-text pairs from literature to help answer the question. To retrieve related image-text pairs from biomedical literature, there are three key questions to be answered: <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">Where</span> to retrieve? <span id="S1.p3.1.2" class="ltx_text ltx_font_bold">How</span> to retrieve? and <span id="S1.p3.1.3" class="ltx_text ltx_font_bold">How</span> to leverage the retrieved image-text pairs?</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To this end, we propose a Retrieval-Augmented bioMedical Multi-modal pretrain-and-finetune paradigm (<span id="S1.p4.1.1" class="ltx_text ltx_font_bold">RAMM)</span> for biomedical VQA. Firstly, there are existing biomedical image-text pairs including ROCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> and MIMIC-CXR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> that can be used for retrieval. However, ROCO is limited by quantity and MIMIC-CXR only focuses on chest X-Ray. A massive, diverse, and high-quality dataset is required for better retrieval. Therefore, we propose PMC-Patients-Multi-modal (<span id="S1.p4.1.2" class="ltx_text ltx_font_bold">PMCPM</span>), a patient-based image-text dataset filtered from PubMed Central, which is larger than ROCO and MIMIC-CXR with various modalities and conditions of images. Secondly, since questions are homogenous in biomedical VQA, we propose to use images for retrieving. We pretrain the biomedical multi-modal model with three tasks: masked language modeling, image-text contrastive learning, and image-text matching using the combination of our PMCPM dataset and previous widely-used ROCO and MIMIC-CXR datasets.
As the image-text contrastive objective in the pretraining phase aims to align visual and textual representations in the same embedding space <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, the image-text contrastive similarity can be used to retrieve similar pairs.
Finally, taking the above datasets as resources, we propose to retrieve the related image-text pair to the given image. To leverage the retrieved pairs, we propose a retrieval-augmented fine-tuning method with a novel retrieval-attention module in the multi-modal encoder layer and apply the fused representation to predict the final answer.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We conduct experiments on four biomedical VQA datasets. Our RAMM achieves state-of-the-art results of 82.13, 39.20, 78.27, and 86.05 scores on VQA-Med 2019 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, VQA-Med 2021 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, VQARAD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, and SLAKE (English Version) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, respectively. We also conduct ablation studies to verify the effectiveness of our collected PMCPM dataset and the retrieval-augmented fine-tuning methods. Case studies show the retrieved image-text pairs benefit to answer the question.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We summarize our contributions as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We collect PMCPM, a patient-based image-text dataset from PubMed which can be used for biomedical multi-modal pretraining and retrieving.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose RAMM, a retrieval-augmented multi-modal pretrain-and-finetune paradigm for biomedical VQA with a novel retrieval-attention module.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Experiments show that the proposed RAMM with additional PMCPM dataset outperforms previous VQA methods on VQA-Med 2019, VQA-Med 2021, VQARAD, and SLAKE datasets.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Biomedical Multi-modal Pretraining</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">In the general domain, multi-modal pretraining models show effectiveness in various image-text-related downstream tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>.
In the biomedical NLP community, previous research has shown that further continue training in the in-domain corpus can enhance the performance of pretrained language models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>.
Combining the above-mentioned two points, it is direct to consider pretraining a biomedical in-domain multi-modal model for biomedical VQA.
Previous biomedical pretrained multi-modal models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> mainly leverage ROCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> and MIMIC-CXR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> as pretraining datasets.
These models predict masked tokens <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> or image patches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and conduct image-text alignment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> as pretraining tasks.
Compared with previous models, our RAMM is pretrained with our additional proposed PMCPM dataset which contains images from diverse conditions of patients.
For pretraining tasks, our model adopts masked language modeling, image-text contrastive learning, and image-text matching. Image-text contrastive similarities are used for retrieving in RAMM.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Biomedical Visual Question Answering</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">VQA requires answering an image-related question.
Different from general domain VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, the training samples of biomedical VQA are much fewer.
To overcome the data limitation in biomedical VQA, meta-learning is adapted for quick fitting to VQA questions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
With the success of the pretrain-and-finetune paradigm, pretraining a multi-modal model with large-scale unsupervised datasets learns better visual and textual representations which mitigate the impact of data limitation and boosts biomedical VQA performances significantly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
In this paper, we also pretrain a biomedical multi-modal model RAMM with patient-based image-text pairs PMCPM.
While fine-tuning VQA datasets, RAMM retrieves similar image-text pairs and tries to leverage useful information from these images and texts.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Retrieval Augmentation</h5>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">has been applied successfully in NLP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and CV <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> for knowledge-intensive tasks.
In this paper, we decide to use retrieval augmentation to solve the knowledge-intensive and under-labeled biomedical VQA tasks.
A retriever may be sparse like BM-25 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> or dense using pretrained encoders <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>.
For our task, the model pretrained by the image-text contrastive (ITC) task can be naturally used as a multi-modal retriever.
Thus, we pretrain a biomedical multi-modal model by ITC for retrieval augmentation.
We also propose a retrieval-attention module to fuse these retrieved samples.
To the best of our knowledge, this is the first work to leverage retrieval augmentation in biomedical VQA.
</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2303.00534/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="203" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.3.2" class="ltx_text" style="font-size:90%;">The workflow of our proposed retrieval-augmented paradigm RAMM for biomedical VQA.
The origin image is from VQA datasets, and the other images are retrieved.
Blue lines represent retrieving image-text pairs (PMCID:4061445, 2278144, 4725742, and 3616602) from PMCPM, ROCO, and MIMIC-CXR datasets based on image-text contrastive similarities.
Retrieval-augmented samples are sent into uni-modal and multi-modal encoders. Multi-modal encoders contain retrieval-attention to fuse retrieved information. Representations obtained by multi-modal encoders are used for VQA classification.
</span></figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Approach</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we first introduce how we build the PMCPM dataset.
We then describe the model architecture and pretraining tasks.
Finally, we introduce how RAMM retrieves image-text pairs from pretraining datasets, and how we combine retrieved samples during biomedical VQA fine-tuning.
Our overall workflow is shown in Figure <a href="#S2.F2" title="Figure 2 ‣ Retrieval Augmentation ‣ 2 Related Work ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>PMCPM Dataset</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">To obtain domain-specific image-text pairs of high quality and large scale, we first consider using the Open Access subset of PubMed Central (PMC OA)<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://www.ncbi.nlm.nih.gov/pmc/tools/openftlist/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.ncbi.nlm.nih.gov/pmc/tools/openftlist/</a></span></span></span>, a free biomedical literature archive of over <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mn id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><cn type="integer" id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">4</annotation></semantics></math>M publications with both full-text (including figure captions) and figures in these articles publicly available through the official FTP service<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://www.ncbi.nlm.nih.gov/pmc/tools/ftp/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.ncbi.nlm.nih.gov/pmc/tools/ftp/</a></span></span></span>.
However, the figures in PMC OA full set can be quite noisy: apart from clinical images, many kinds of graphs appear in a research article, including flowcharts, histograms, and scatter plots, which provide little information for multi-modal pretraining.
Pelka <em id="S3.SS1.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S3.SS1.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> use neural networks trained on human annotated datasets to automatically filter compound, multi-pane, and non-radiology images, collecting a clean dataset with 81k image-text pairs.
To further explore and utilize the figure resource in PMC, we instead resort to a “patient-based” collection pipeline inspired by Zhao <em id="S3.SS1.p1.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S3.SS1.p1.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>.
“<span id="S3.SS1.p1.1.5" class="ltx_text ltx_font_italic">Case Report</span>” is a specific type of medical literature, generally describing the whole admission of a patient.
Following Zhao <em id="S3.SS1.p1.1.6" class="ltx_emph ltx_font_italic">et al</em>.<span id="S3.SS1.p1.1.7" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>, we use regular expressions to identify sections containing patient notes, extract the corresponding texts, and apply various filters to remove noises, resulting in a collection of 167k patient notes with high-quality and diverse conditions.
The figures accompanied by these patient notes are closely related to the patient’s clinical conditions and contain richer information than solely radiology images.
We thus collect these figures with corresponding captions to build our PMCPM dataset. Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 PMCPM Dataset ‣ 3 Approach ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows two examples of our PMCPM (PMCID: 509249) with the images and their corresponding captions. Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 PMCPM Dataset ‣ 3 Approach ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>A shows a photomicrograph describing the presence of adenoid cystic carcinoma with cribriform pattern and perineurial invasion. Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 PMCPM Dataset ‣ 3 Approach ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>B shows a radiology image that multiple metastatic lesions scatter in both lobes. The examples show that our patient-based collecting method can target clinical-related figures with more image modality and detailed text descriptions.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2303.00534/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="267" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">Examples of image-text pairs from PMCPM.
</span></figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Model Architecture</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.7" class="ltx_p">Given an image-text pair <math id="S3.SS2.p1.1.m1.2" class="ltx_Math" alttext="(\it{I},\it{T})" display="inline"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.2.3.2.1" xref="S3.SS2.p1.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">I</mi><mo id="S3.SS2.p1.1.m1.2.3.2.2" xref="S3.SS2.p1.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">T</mi><mo stretchy="false" id="S3.SS2.p1.1.m1.2.3.2.3" xref="S3.SS2.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><interval closure="open" id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.2"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐼</ci><ci id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">𝑇</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">(\it{I},\it{T})</annotation></semantics></math>, RAMM first obtains uni-modal features independently and then fuses them for multi-modal representations.
Fused representations are used for VQA classification.
RAMM consists of a text encoder, an image encoder, and a multi-modal encoder for fusing two different modal representations.
The text <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\it{T}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\it{T}</annotation></semantics></math> is tokenized into subwords <math id="S3.SS2.p1.3.m3.4" class="ltx_Math" alttext="\{x_{cls},x_{1},...,x_{n}\}" display="inline"><semantics id="S3.SS2.p1.3.m3.4a"><mrow id="S3.SS2.p1.3.m3.4.4.3" xref="S3.SS2.p1.3.m3.4.4.4.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.4.4.3.4" xref="S3.SS2.p1.3.m3.4.4.4.cmml">{</mo><msub id="S3.SS2.p1.3.m3.2.2.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.2" xref="S3.SS2.p1.3.m3.2.2.1.1.2.cmml">x</mi><mrow id="S3.SS2.p1.3.m3.2.2.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.3.2" xref="S3.SS2.p1.3.m3.2.2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.2.2.1.1.3.1" xref="S3.SS2.p1.3.m3.2.2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.3.m3.2.2.1.1.3.3" xref="S3.SS2.p1.3.m3.2.2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.2.2.1.1.3.1a" xref="S3.SS2.p1.3.m3.2.2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.3.m3.2.2.1.1.3.4" xref="S3.SS2.p1.3.m3.2.2.1.1.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS2.p1.3.m3.4.4.3.5" xref="S3.SS2.p1.3.m3.4.4.4.cmml">,</mo><msub id="S3.SS2.p1.3.m3.3.3.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS2.p1.3.m3.3.3.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.cmml">x</mi><mn id="S3.SS2.p1.3.m3.3.3.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.p1.3.m3.4.4.3.6" xref="S3.SS2.p1.3.m3.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p1.3.m3.4.4.3.7" xref="S3.SS2.p1.3.m3.4.4.4.cmml">,</mo><msub id="S3.SS2.p1.3.m3.4.4.3.3" xref="S3.SS2.p1.3.m3.4.4.3.3.cmml"><mi id="S3.SS2.p1.3.m3.4.4.3.3.2" xref="S3.SS2.p1.3.m3.4.4.3.3.2.cmml">x</mi><mi id="S3.SS2.p1.3.m3.4.4.3.3.3" xref="S3.SS2.p1.3.m3.4.4.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS2.p1.3.m3.4.4.3.8" xref="S3.SS2.p1.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.4b"><set id="S3.SS2.p1.3.m3.4.4.4.cmml" xref="S3.SS2.p1.3.m3.4.4.3"><apply id="S3.SS2.p1.3.m3.2.2.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.2">𝑥</ci><apply id="S3.SS2.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.3"><times id="S3.SS2.p1.3.m3.2.2.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.3.1"></times><ci id="S3.SS2.p1.3.m3.2.2.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.3.2">𝑐</ci><ci id="S3.SS2.p1.3.m3.2.2.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.3.3">𝑙</ci><ci id="S3.SS2.p1.3.m3.2.2.1.1.3.4.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.3.4">𝑠</ci></apply></apply><apply id="S3.SS2.p1.3.m3.3.3.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2">𝑥</ci><cn type="integer" id="S3.SS2.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.3">1</cn></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">…</ci><apply id="S3.SS2.p1.3.m3.4.4.3.3.cmml" xref="S3.SS2.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.4.4.3.3.1.cmml" xref="S3.SS2.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.4.4.3.3.2.cmml" xref="S3.SS2.p1.3.m3.4.4.3.3.2">𝑥</ci><ci id="S3.SS2.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS2.p1.3.m3.4.4.3.3.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.4c">\{x_{cls},x_{1},...,x_{n}\}</annotation></semantics></math> and transformed into hidden representations <math id="S3.SS2.p1.4.m4.4" class="ltx_Math" alttext="\mathbf{w}_{0}=\{\mathbf{w}_{cls},\mathbf{w}_{1},...,\mathbf{w}_{n}\}" display="inline"><semantics id="S3.SS2.p1.4.m4.4a"><mrow id="S3.SS2.p1.4.m4.4.4" xref="S3.SS2.p1.4.m4.4.4.cmml"><msub id="S3.SS2.p1.4.m4.4.4.5" xref="S3.SS2.p1.4.m4.4.4.5.cmml"><mi id="S3.SS2.p1.4.m4.4.4.5.2" xref="S3.SS2.p1.4.m4.4.4.5.2.cmml">𝐰</mi><mn id="S3.SS2.p1.4.m4.4.4.5.3" xref="S3.SS2.p1.4.m4.4.4.5.3.cmml">0</mn></msub><mo id="S3.SS2.p1.4.m4.4.4.4" xref="S3.SS2.p1.4.m4.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.4.m4.4.4.3.3" xref="S3.SS2.p1.4.m4.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.4.4.3.3.4" xref="S3.SS2.p1.4.m4.4.4.3.4.cmml">{</mo><msub id="S3.SS2.p1.4.m4.2.2.1.1.1" xref="S3.SS2.p1.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.2.2.1.1.1.2" xref="S3.SS2.p1.4.m4.2.2.1.1.1.2.cmml">𝐰</mi><mrow id="S3.SS2.p1.4.m4.2.2.1.1.1.3" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.2.2.1.1.1.3.2" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.2.2.1.1.1.3.1" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.4.m4.2.2.1.1.1.3.3" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.2.2.1.1.1.3.1a" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.4.m4.2.2.1.1.1.3.4" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS2.p1.4.m4.4.4.3.3.5" xref="S3.SS2.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.4.m4.3.3.2.2.2" xref="S3.SS2.p1.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.4.m4.3.3.2.2.2.2" xref="S3.SS2.p1.4.m4.3.3.2.2.2.2.cmml">𝐰</mi><mn id="S3.SS2.p1.4.m4.3.3.2.2.2.3" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.p1.4.m4.4.4.3.3.6" xref="S3.SS2.p1.4.m4.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS2.p1.4.m4.4.4.3.3.7" xref="S3.SS2.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.4.m4.4.4.3.3.3" xref="S3.SS2.p1.4.m4.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.4.m4.4.4.3.3.3.2" xref="S3.SS2.p1.4.m4.4.4.3.3.3.2.cmml">𝐰</mi><mi id="S3.SS2.p1.4.m4.4.4.3.3.3.3" xref="S3.SS2.p1.4.m4.4.4.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS2.p1.4.m4.4.4.3.3.8" xref="S3.SS2.p1.4.m4.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.4b"><apply id="S3.SS2.p1.4.m4.4.4.cmml" xref="S3.SS2.p1.4.m4.4.4"><eq id="S3.SS2.p1.4.m4.4.4.4.cmml" xref="S3.SS2.p1.4.m4.4.4.4"></eq><apply id="S3.SS2.p1.4.m4.4.4.5.cmml" xref="S3.SS2.p1.4.m4.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.4.4.5.1.cmml" xref="S3.SS2.p1.4.m4.4.4.5">subscript</csymbol><ci id="S3.SS2.p1.4.m4.4.4.5.2.cmml" xref="S3.SS2.p1.4.m4.4.4.5.2">𝐰</ci><cn type="integer" id="S3.SS2.p1.4.m4.4.4.5.3.cmml" xref="S3.SS2.p1.4.m4.4.4.5.3">0</cn></apply><set id="S3.SS2.p1.4.m4.4.4.3.4.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3"><apply id="S3.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.2">𝐰</ci><apply id="S3.SS2.p1.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3"><times id="S3.SS2.p1.4.m4.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.1"></times><ci id="S3.SS2.p1.4.m4.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.2">𝑐</ci><ci id="S3.SS2.p1.4.m4.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.3">𝑙</ci><ci id="S3.SS2.p1.4.m4.2.2.1.1.1.3.4.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.4">𝑠</ci></apply></apply><apply id="S3.SS2.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.2">𝐰</ci><cn type="integer" id="S3.SS2.p1.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3">1</cn></apply><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">…</ci><apply id="S3.SS2.p1.4.m4.4.4.3.3.3.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.4.m4.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.3.2">𝐰</ci><ci id="S3.SS2.p1.4.m4.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.4c">\mathbf{w}_{0}=\{\mathbf{w}_{cls},\mathbf{w}_{1},...,\mathbf{w}_{n}\}</annotation></semantics></math> by the text encoder.
The image <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\it{I}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\it{I}</annotation></semantics></math> is divided into patches <math id="S3.SS2.p1.6.m6.4" class="ltx_Math" alttext="\{y_{cls},y_{1},...,y_{m}\}" display="inline"><semantics id="S3.SS2.p1.6.m6.4a"><mrow id="S3.SS2.p1.6.m6.4.4.3" xref="S3.SS2.p1.6.m6.4.4.4.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m6.4.4.3.4" xref="S3.SS2.p1.6.m6.4.4.4.cmml">{</mo><msub id="S3.SS2.p1.6.m6.2.2.1.1" xref="S3.SS2.p1.6.m6.2.2.1.1.cmml"><mi id="S3.SS2.p1.6.m6.2.2.1.1.2" xref="S3.SS2.p1.6.m6.2.2.1.1.2.cmml">y</mi><mrow id="S3.SS2.p1.6.m6.2.2.1.1.3" xref="S3.SS2.p1.6.m6.2.2.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.2.2.1.1.3.2" xref="S3.SS2.p1.6.m6.2.2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.2.2.1.1.3.1" xref="S3.SS2.p1.6.m6.2.2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.6.m6.2.2.1.1.3.3" xref="S3.SS2.p1.6.m6.2.2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.2.2.1.1.3.1a" xref="S3.SS2.p1.6.m6.2.2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.6.m6.2.2.1.1.3.4" xref="S3.SS2.p1.6.m6.2.2.1.1.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS2.p1.6.m6.4.4.3.5" xref="S3.SS2.p1.6.m6.4.4.4.cmml">,</mo><msub id="S3.SS2.p1.6.m6.3.3.2.2" xref="S3.SS2.p1.6.m6.3.3.2.2.cmml"><mi id="S3.SS2.p1.6.m6.3.3.2.2.2" xref="S3.SS2.p1.6.m6.3.3.2.2.2.cmml">y</mi><mn id="S3.SS2.p1.6.m6.3.3.2.2.3" xref="S3.SS2.p1.6.m6.3.3.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.p1.6.m6.4.4.3.6" xref="S3.SS2.p1.6.m6.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">…</mi><mo id="S3.SS2.p1.6.m6.4.4.3.7" xref="S3.SS2.p1.6.m6.4.4.4.cmml">,</mo><msub id="S3.SS2.p1.6.m6.4.4.3.3" xref="S3.SS2.p1.6.m6.4.4.3.3.cmml"><mi id="S3.SS2.p1.6.m6.4.4.3.3.2" xref="S3.SS2.p1.6.m6.4.4.3.3.2.cmml">y</mi><mi id="S3.SS2.p1.6.m6.4.4.3.3.3" xref="S3.SS2.p1.6.m6.4.4.3.3.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS2.p1.6.m6.4.4.3.8" xref="S3.SS2.p1.6.m6.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.4b"><set id="S3.SS2.p1.6.m6.4.4.4.cmml" xref="S3.SS2.p1.6.m6.4.4.3"><apply id="S3.SS2.p1.6.m6.2.2.1.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.2.2.1.1.2.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.2">𝑦</ci><apply id="S3.SS2.p1.6.m6.2.2.1.1.3.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.3"><times id="S3.SS2.p1.6.m6.2.2.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.3.1"></times><ci id="S3.SS2.p1.6.m6.2.2.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.3.2">𝑐</ci><ci id="S3.SS2.p1.6.m6.2.2.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.3.3">𝑙</ci><ci id="S3.SS2.p1.6.m6.2.2.1.1.3.4.cmml" xref="S3.SS2.p1.6.m6.2.2.1.1.3.4">𝑠</ci></apply></apply><apply id="S3.SS2.p1.6.m6.3.3.2.2.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.3.3.2.2.1.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.2">𝑦</ci><cn type="integer" id="S3.SS2.p1.6.m6.3.3.2.2.3.cmml" xref="S3.SS2.p1.6.m6.3.3.2.2.3">1</cn></apply><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">…</ci><apply id="S3.SS2.p1.6.m6.4.4.3.3.cmml" xref="S3.SS2.p1.6.m6.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.4.4.3.3.1.cmml" xref="S3.SS2.p1.6.m6.4.4.3.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.4.4.3.3.2.cmml" xref="S3.SS2.p1.6.m6.4.4.3.3.2">𝑦</ci><ci id="S3.SS2.p1.6.m6.4.4.3.3.3.cmml" xref="S3.SS2.p1.6.m6.4.4.3.3.3">𝑚</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.4c">\{y_{cls},y_{1},...,y_{m}\}</annotation></semantics></math> and represented as <math id="S3.SS2.p1.7.m7.4" class="ltx_Math" alttext="\mathbf{v}_{0}=\{\mathbf{v}_{cls},\mathbf{v}_{1},...,\mathbf{v}_{m}\}" display="inline"><semantics id="S3.SS2.p1.7.m7.4a"><mrow id="S3.SS2.p1.7.m7.4.4" xref="S3.SS2.p1.7.m7.4.4.cmml"><msub id="S3.SS2.p1.7.m7.4.4.5" xref="S3.SS2.p1.7.m7.4.4.5.cmml"><mi id="S3.SS2.p1.7.m7.4.4.5.2" xref="S3.SS2.p1.7.m7.4.4.5.2.cmml">𝐯</mi><mn id="S3.SS2.p1.7.m7.4.4.5.3" xref="S3.SS2.p1.7.m7.4.4.5.3.cmml">0</mn></msub><mo id="S3.SS2.p1.7.m7.4.4.4" xref="S3.SS2.p1.7.m7.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.7.m7.4.4.3.3" xref="S3.SS2.p1.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m7.4.4.3.3.4" xref="S3.SS2.p1.7.m7.4.4.3.4.cmml">{</mo><msub id="S3.SS2.p1.7.m7.2.2.1.1.1" xref="S3.SS2.p1.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.7.m7.2.2.1.1.1.2" xref="S3.SS2.p1.7.m7.2.2.1.1.1.2.cmml">𝐯</mi><mrow id="S3.SS2.p1.7.m7.2.2.1.1.1.3" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.2.2.1.1.1.3.2" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.2.2.1.1.1.3.1" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.7.m7.2.2.1.1.1.3.3" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.2.2.1.1.1.3.1a" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.7.m7.2.2.1.1.1.3.4" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS2.p1.7.m7.4.4.3.3.5" xref="S3.SS2.p1.7.m7.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.7.m7.3.3.2.2.2" xref="S3.SS2.p1.7.m7.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.7.m7.3.3.2.2.2.2" xref="S3.SS2.p1.7.m7.3.3.2.2.2.2.cmml">𝐯</mi><mn id="S3.SS2.p1.7.m7.3.3.2.2.2.3" xref="S3.SS2.p1.7.m7.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.p1.7.m7.4.4.3.3.6" xref="S3.SS2.p1.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS2.p1.7.m7.4.4.3.3.7" xref="S3.SS2.p1.7.m7.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.7.m7.4.4.3.3.3" xref="S3.SS2.p1.7.m7.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.7.m7.4.4.3.3.3.2" xref="S3.SS2.p1.7.m7.4.4.3.3.3.2.cmml">𝐯</mi><mi id="S3.SS2.p1.7.m7.4.4.3.3.3.3" xref="S3.SS2.p1.7.m7.4.4.3.3.3.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS2.p1.7.m7.4.4.3.3.8" xref="S3.SS2.p1.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.4b"><apply id="S3.SS2.p1.7.m7.4.4.cmml" xref="S3.SS2.p1.7.m7.4.4"><eq id="S3.SS2.p1.7.m7.4.4.4.cmml" xref="S3.SS2.p1.7.m7.4.4.4"></eq><apply id="S3.SS2.p1.7.m7.4.4.5.cmml" xref="S3.SS2.p1.7.m7.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.4.4.5.1.cmml" xref="S3.SS2.p1.7.m7.4.4.5">subscript</csymbol><ci id="S3.SS2.p1.7.m7.4.4.5.2.cmml" xref="S3.SS2.p1.7.m7.4.4.5.2">𝐯</ci><cn type="integer" id="S3.SS2.p1.7.m7.4.4.5.3.cmml" xref="S3.SS2.p1.7.m7.4.4.5.3">0</cn></apply><set id="S3.SS2.p1.7.m7.4.4.3.4.cmml" xref="S3.SS2.p1.7.m7.4.4.3.3"><apply id="S3.SS2.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS2.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.2.2.1.1.1.2">𝐯</ci><apply id="S3.SS2.p1.7.m7.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3"><times id="S3.SS2.p1.7.m7.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.1"></times><ci id="S3.SS2.p1.7.m7.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.2">𝑐</ci><ci id="S3.SS2.p1.7.m7.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.3">𝑙</ci><ci id="S3.SS2.p1.7.m7.2.2.1.1.1.3.4.cmml" xref="S3.SS2.p1.7.m7.2.2.1.1.1.3.4">𝑠</ci></apply></apply><apply id="S3.SS2.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS2.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.7.m7.3.3.2.2.2.2">𝐯</ci><cn type="integer" id="S3.SS2.p1.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.7.m7.3.3.2.2.2.3">1</cn></apply><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">…</ci><apply id="S3.SS2.p1.7.m7.4.4.3.3.3.cmml" xref="S3.SS2.p1.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.7.m7.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.7.m7.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.7.m7.4.4.3.3.3.2">𝐯</ci><ci id="S3.SS2.p1.7.m7.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.7.m7.4.4.3.3.3.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.4c">\mathbf{v}_{0}=\{\mathbf{v}_{cls},\mathbf{v}_{1},...,\mathbf{v}_{m}\}</annotation></semantics></math> by the image encoder.
The multi-modal encoder is a co-attention style dual-stream transformer.</p>
</div>
<section id="S3.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Multi-modal Fusion Layer</h5>

<div id="S3.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p1.6" class="ltx_p">We apply co-attention style multi-modal fusion layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> upon text features <math id="S3.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{0}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">𝐰</mi><mn id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝐰</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">\mathbf{w}_{0}</annotation></semantics></math> and visual features <math id="S3.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{v}_{0}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">𝐯</mi><mn id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝐯</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">\mathbf{v}_{0}</annotation></semantics></math> with layer count <math id="S3.SS2.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">L</annotation></semantics></math>.
Specifically, co-attention fusion layers consist of dual-stream transformer layers where one stream corresponds to one modal. Each transformer layer is combined with a self-attention module and a cross-attention module<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Feed-forward networks are omitted for notation brevity.</span></span></span>.
For layer <math id="S3.SS2.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">i</annotation></semantics></math>, we denote text hidden representations as <math id="S3.SS2.SSS0.Px1.p1.5.m5.4" class="ltx_Math" alttext="\mathbf{w}_{i}=\{\mathbf{w}_{cls}^{i},\mathbf{w}_{1}^{i},...,\mathbf{w}_{n}^{i}\}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.4a"><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.4.4" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.cmml"><msub id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.2.cmml">𝐰</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.4" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.4" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2.cmml">𝐰</mi><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.1a" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.4" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.4.cmml">s</mi></mrow><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.5" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.2.cmml">𝐰</mi><mn id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.3.cmml">1</mn><mi id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.6" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.7" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.2.cmml">𝐰</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.3.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.8" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m5.4b"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4"><eq id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.4"></eq><apply id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.2">𝐰</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.5.3">𝑖</ci></apply><set id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.2">𝐰</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3"><times id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.1"></times><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.3">𝑙</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.2">𝐰</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.3.3.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1">…</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.2">𝐰</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.2.3">𝑛</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.4.4.3.3.3.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.4c">\mathbf{w}_{i}=\{\mathbf{w}_{cls}^{i},\mathbf{w}_{1}^{i},...,\mathbf{w}_{n}^{i}\}</annotation></semantics></math> and image hidden representations as <math id="S3.SS2.SSS0.Px1.p1.6.m6.4" class="ltx_Math" alttext="\mathbf{v}_{i}=\{\mathbf{v}_{cls}^{i},\mathbf{v}_{1}^{i},...,\mathbf{v}_{m}^{i}\}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.6.m6.4a"><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.4.4" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.cmml"><msub id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.2.cmml">𝐯</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.4" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.4" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.2.cmml">𝐯</mi><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.1a" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.4" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.4.cmml">s</mi></mrow><mi id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.5" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.2.cmml">𝐯</mi><mn id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.3.cmml">1</mn><mi id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.6" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.7" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.2.cmml">𝐯</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.3.cmml">m</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.8" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m6.4b"><apply id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4"><eq id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.4"></eq><apply id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.2">𝐯</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.5.3">𝑖</ci></apply><set id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3"><apply id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.2">𝐯</ci><apply id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3"><times id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.1"></times><ci id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.2">𝑐</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.3">𝑙</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.2">𝐯</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.2.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1">…</ci><apply id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.2">𝐯</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.2.3">𝑚</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.3.3.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m6.4c">\mathbf{v}_{i}=\{\mathbf{v}_{cls}^{i},\mathbf{v}_{1}^{i},...,\mathbf{v}_{m}^{i}\}</annotation></semantics></math>. The attention module in transformers is defined as:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\mathrm{Attn}(Q,K,V)=\mathrm{softmax}(\frac{QK^{\top}}{\sqrt{d_{k}}})V" display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.5" xref="S3.E1.m1.4.5.cmml"><mrow id="S3.E1.m1.4.5.2" xref="S3.E1.m1.4.5.2.cmml"><mi id="S3.E1.m1.4.5.2.2" xref="S3.E1.m1.4.5.2.2.cmml">Attn</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.2.1" xref="S3.E1.m1.4.5.2.1.cmml">​</mo><mrow id="S3.E1.m1.4.5.2.3.2" xref="S3.E1.m1.4.5.2.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.5.2.3.2.1" xref="S3.E1.m1.4.5.2.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">Q</mi><mo id="S3.E1.m1.4.5.2.3.2.2" xref="S3.E1.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">K</mi><mo id="S3.E1.m1.4.5.2.3.2.3" xref="S3.E1.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">V</mi><mo stretchy="false" id="S3.E1.m1.4.5.2.3.2.4" xref="S3.E1.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.5.1" xref="S3.E1.m1.4.5.1.cmml">=</mo><mrow id="S3.E1.m1.4.5.3" xref="S3.E1.m1.4.5.3.cmml"><mi id="S3.E1.m1.4.5.3.2" xref="S3.E1.m1.4.5.3.2.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.3.1" xref="S3.E1.m1.4.5.3.1.cmml">​</mo><mrow id="S3.E1.m1.4.5.3.3.2" xref="S3.E1.m1.4.4.cmml"><mo stretchy="false" id="S3.E1.m1.4.5.3.3.2.1" xref="S3.E1.m1.4.4.cmml">(</mo><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml"><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.2.1" xref="S3.E1.m1.4.4.2.1.cmml">​</mo><msup id="S3.E1.m1.4.4.2.3" xref="S3.E1.m1.4.4.2.3.cmml"><mi id="S3.E1.m1.4.4.2.3.2" xref="S3.E1.m1.4.4.2.3.2.cmml">K</mi><mo id="S3.E1.m1.4.4.2.3.3" xref="S3.E1.m1.4.4.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><msub id="S3.E1.m1.4.4.3.2" xref="S3.E1.m1.4.4.3.2.cmml"><mi id="S3.E1.m1.4.4.3.2.2" xref="S3.E1.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.E1.m1.4.4.3.2.3" xref="S3.E1.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo stretchy="false" id="S3.E1.m1.4.5.3.3.2.2" xref="S3.E1.m1.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.3.1a" xref="S3.E1.m1.4.5.3.1.cmml">​</mo><mi id="S3.E1.m1.4.5.3.4" xref="S3.E1.m1.4.5.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.5.cmml" xref="S3.E1.m1.4.5"><eq id="S3.E1.m1.4.5.1.cmml" xref="S3.E1.m1.4.5.1"></eq><apply id="S3.E1.m1.4.5.2.cmml" xref="S3.E1.m1.4.5.2"><times id="S3.E1.m1.4.5.2.1.cmml" xref="S3.E1.m1.4.5.2.1"></times><ci id="S3.E1.m1.4.5.2.2.cmml" xref="S3.E1.m1.4.5.2.2">Attn</ci><vector id="S3.E1.m1.4.5.2.3.1.cmml" xref="S3.E1.m1.4.5.2.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑄</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐾</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑉</ci></vector></apply><apply id="S3.E1.m1.4.5.3.cmml" xref="S3.E1.m1.4.5.3"><times id="S3.E1.m1.4.5.3.1.cmml" xref="S3.E1.m1.4.5.3.1"></times><ci id="S3.E1.m1.4.5.3.2.cmml" xref="S3.E1.m1.4.5.3.2">softmax</ci><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.5.3.3.2"><divide id="S3.E1.m1.4.4.1.cmml" xref="S3.E1.m1.4.5.3.3.2"></divide><apply id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"><times id="S3.E1.m1.4.4.2.1.cmml" xref="S3.E1.m1.4.4.2.1"></times><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝑄</ci><apply id="S3.E1.m1.4.4.2.3.cmml" xref="S3.E1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.3.1.cmml" xref="S3.E1.m1.4.4.2.3">superscript</csymbol><ci id="S3.E1.m1.4.4.2.3.2.cmml" xref="S3.E1.m1.4.4.2.3.2">𝐾</ci><csymbol cd="latexml" id="S3.E1.m1.4.4.2.3.3.cmml" xref="S3.E1.m1.4.4.2.3.3">top</csymbol></apply></apply><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><root id="S3.E1.m1.4.4.3a.cmml" xref="S3.E1.m1.4.4.3"></root><apply id="S3.E1.m1.4.4.3.2.cmml" xref="S3.E1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.3.2.1.cmml" xref="S3.E1.m1.4.4.3.2">subscript</csymbol><ci id="S3.E1.m1.4.4.3.2.2.cmml" xref="S3.E1.m1.4.4.3.2.2">𝑑</ci><ci id="S3.E1.m1.4.4.3.2.3.cmml" xref="S3.E1.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.E1.m1.4.5.3.4.cmml" xref="S3.E1.m1.4.5.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\mathrm{Attn}(Q,K,V)=\mathrm{softmax}(\frac{QK^{\top}}{\sqrt{d_{k}}})V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px1.p1.14" class="ltx_p">Using this denotation, self-attention is defined as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.8" class="ltx_Math" alttext="Q^{i,w}=W_{Q}^{w}\mathbf{w}_{i},K^{i,w}=W_{K}^{w}\mathbf{w}_{i},V^{i,w}=W_{V}^{w}\mathbf{w}_{i}" display="block"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8.2" xref="S3.E2.m1.8.8.3.cmml"><mrow id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml"><msup id="S3.E2.m1.7.7.1.1.2" xref="S3.E2.m1.7.7.1.1.2.cmml"><mi id="S3.E2.m1.7.7.1.1.2.2" xref="S3.E2.m1.7.7.1.1.2.2.cmml">Q</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">i</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">w</mi></mrow></msup><mo id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.3" xref="S3.E2.m1.7.7.1.1.3.cmml"><msubsup id="S3.E2.m1.7.7.1.1.3.2" xref="S3.E2.m1.7.7.1.1.3.2.cmml"><mi id="S3.E2.m1.7.7.1.1.3.2.2.2" xref="S3.E2.m1.7.7.1.1.3.2.2.2.cmml">W</mi><mi id="S3.E2.m1.7.7.1.1.3.2.2.3" xref="S3.E2.m1.7.7.1.1.3.2.2.3.cmml">Q</mi><mi id="S3.E2.m1.7.7.1.1.3.2.3" xref="S3.E2.m1.7.7.1.1.3.2.3.cmml">w</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.3.1" xref="S3.E2.m1.7.7.1.1.3.1.cmml">​</mo><msub id="S3.E2.m1.7.7.1.1.3.3" xref="S3.E2.m1.7.7.1.1.3.3.cmml"><mi id="S3.E2.m1.7.7.1.1.3.3.2" xref="S3.E2.m1.7.7.1.1.3.3.2.cmml">𝐰</mi><mi id="S3.E2.m1.7.7.1.1.3.3.3" xref="S3.E2.m1.7.7.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E2.m1.8.8.2.3" xref="S3.E2.m1.8.8.3a.cmml">,</mo><mrow id="S3.E2.m1.8.8.2.2.2" xref="S3.E2.m1.8.8.2.2.3.cmml"><mrow id="S3.E2.m1.8.8.2.2.1.1" xref="S3.E2.m1.8.8.2.2.1.1.cmml"><msup id="S3.E2.m1.8.8.2.2.1.1.2" xref="S3.E2.m1.8.8.2.2.1.1.2.cmml"><mi id="S3.E2.m1.8.8.2.2.1.1.2.2" xref="S3.E2.m1.8.8.2.2.1.1.2.2.cmml">K</mi><mrow id="S3.E2.m1.4.4.2.4" xref="S3.E2.m1.4.4.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">i</mi><mo id="S3.E2.m1.4.4.2.4.1" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">w</mi></mrow></msup><mo id="S3.E2.m1.8.8.2.2.1.1.1" xref="S3.E2.m1.8.8.2.2.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.8.8.2.2.1.1.3" xref="S3.E2.m1.8.8.2.2.1.1.3.cmml"><msubsup id="S3.E2.m1.8.8.2.2.1.1.3.2" xref="S3.E2.m1.8.8.2.2.1.1.3.2.cmml"><mi id="S3.E2.m1.8.8.2.2.1.1.3.2.2.2" xref="S3.E2.m1.8.8.2.2.1.1.3.2.2.2.cmml">W</mi><mi id="S3.E2.m1.8.8.2.2.1.1.3.2.2.3" xref="S3.E2.m1.8.8.2.2.1.1.3.2.2.3.cmml">K</mi><mi id="S3.E2.m1.8.8.2.2.1.1.3.2.3" xref="S3.E2.m1.8.8.2.2.1.1.3.2.3.cmml">w</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.2.2.1.1.3.1" xref="S3.E2.m1.8.8.2.2.1.1.3.1.cmml">​</mo><msub id="S3.E2.m1.8.8.2.2.1.1.3.3" xref="S3.E2.m1.8.8.2.2.1.1.3.3.cmml"><mi id="S3.E2.m1.8.8.2.2.1.1.3.3.2" xref="S3.E2.m1.8.8.2.2.1.1.3.3.2.cmml">𝐰</mi><mi id="S3.E2.m1.8.8.2.2.1.1.3.3.3" xref="S3.E2.m1.8.8.2.2.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E2.m1.8.8.2.2.2.3" xref="S3.E2.m1.8.8.2.2.3a.cmml">,</mo><mrow id="S3.E2.m1.8.8.2.2.2.2" xref="S3.E2.m1.8.8.2.2.2.2.cmml"><msup id="S3.E2.m1.8.8.2.2.2.2.2" xref="S3.E2.m1.8.8.2.2.2.2.2.cmml"><mi id="S3.E2.m1.8.8.2.2.2.2.2.2" xref="S3.E2.m1.8.8.2.2.2.2.2.2.cmml">V</mi><mrow id="S3.E2.m1.6.6.2.4" xref="S3.E2.m1.6.6.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml">i</mi><mo id="S3.E2.m1.6.6.2.4.1" xref="S3.E2.m1.6.6.2.3.cmml">,</mo><mi id="S3.E2.m1.6.6.2.2" xref="S3.E2.m1.6.6.2.2.cmml">w</mi></mrow></msup><mo id="S3.E2.m1.8.8.2.2.2.2.1" xref="S3.E2.m1.8.8.2.2.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.8.8.2.2.2.2.3" xref="S3.E2.m1.8.8.2.2.2.2.3.cmml"><msubsup id="S3.E2.m1.8.8.2.2.2.2.3.2" xref="S3.E2.m1.8.8.2.2.2.2.3.2.cmml"><mi id="S3.E2.m1.8.8.2.2.2.2.3.2.2.2" xref="S3.E2.m1.8.8.2.2.2.2.3.2.2.2.cmml">W</mi><mi id="S3.E2.m1.8.8.2.2.2.2.3.2.2.3" xref="S3.E2.m1.8.8.2.2.2.2.3.2.2.3.cmml">V</mi><mi id="S3.E2.m1.8.8.2.2.2.2.3.2.3" xref="S3.E2.m1.8.8.2.2.2.2.3.2.3.cmml">w</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.2.2.2.2.3.1" xref="S3.E2.m1.8.8.2.2.2.2.3.1.cmml">​</mo><msub id="S3.E2.m1.8.8.2.2.2.2.3.3" xref="S3.E2.m1.8.8.2.2.2.2.3.3.cmml"><mi id="S3.E2.m1.8.8.2.2.2.2.3.3.2" xref="S3.E2.m1.8.8.2.2.2.2.3.3.2.cmml">𝐰</mi><mi id="S3.E2.m1.8.8.2.2.2.2.3.3.3" xref="S3.E2.m1.8.8.2.2.2.2.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.3.cmml" xref="S3.E2.m1.8.8.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.3a.cmml" xref="S3.E2.m1.8.8.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1.1"><eq id="S3.E2.m1.7.7.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1"></eq><apply id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.2">superscript</csymbol><ci id="S3.E2.m1.7.7.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.2.2">𝑄</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑖</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑤</ci></list></apply><apply id="S3.E2.m1.7.7.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3"><times id="S3.E2.m1.7.7.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3.1"></times><apply id="S3.E2.m1.7.7.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.3.2.1.cmml" xref="S3.E2.m1.7.7.1.1.3.2">superscript</csymbol><apply id="S3.E2.m1.7.7.1.1.3.2.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2.2.2">𝑊</ci><ci id="S3.E2.m1.7.7.1.1.3.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.3.2.2.3">𝑄</ci></apply><ci id="S3.E2.m1.7.7.1.1.3.2.3.cmml" xref="S3.E2.m1.7.7.1.1.3.2.3">𝑤</ci></apply><apply id="S3.E2.m1.7.7.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.3.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.3.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.3.2">𝐰</ci><ci id="S3.E2.m1.7.7.1.1.3.3.3.cmml" xref="S3.E2.m1.7.7.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.8.8.2.2.3.cmml" xref="S3.E2.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.3a.cmml" xref="S3.E2.m1.8.8.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.8.8.2.2.1.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1"><eq id="S3.E2.m1.8.8.2.2.1.1.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1.1"></eq><apply id="S3.E2.m1.8.8.2.2.1.1.2.cmml" xref="S3.E2.m1.8.8.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.1.1.2.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1.2">superscript</csymbol><ci id="S3.E2.m1.8.8.2.2.1.1.2.2.cmml" xref="S3.E2.m1.8.8.2.2.1.1.2.2">𝐾</ci><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.4"><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑖</ci><ci id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2">𝑤</ci></list></apply><apply id="S3.E2.m1.8.8.2.2.1.1.3.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3"><times id="S3.E2.m1.8.8.2.2.1.1.3.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.1"></times><apply id="S3.E2.m1.8.8.2.2.1.1.3.2.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.2">superscript</csymbol><apply id="S3.E2.m1.8.8.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.1.1.3.2.2.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.8.8.2.2.1.1.3.2.2.2.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.2.2.2">𝑊</ci><ci id="S3.E2.m1.8.8.2.2.1.1.3.2.2.3.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.2.2.3">𝐾</ci></apply><ci id="S3.E2.m1.8.8.2.2.1.1.3.2.3.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.2.3">𝑤</ci></apply><apply id="S3.E2.m1.8.8.2.2.1.1.3.3.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.1.1.3.3.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.8.8.2.2.1.1.3.3.2.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.3.2">𝐰</ci><ci id="S3.E2.m1.8.8.2.2.1.1.3.3.3.cmml" xref="S3.E2.m1.8.8.2.2.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.8.8.2.2.2.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2"><eq id="S3.E2.m1.8.8.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.2.2.2.2.1"></eq><apply id="S3.E2.m1.8.8.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.2.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.8.8.2.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2.2.2">𝑉</ci><list id="S3.E2.m1.6.6.2.3.cmml" xref="S3.E2.m1.6.6.2.4"><ci id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1.1">𝑖</ci><ci id="S3.E2.m1.6.6.2.2.cmml" xref="S3.E2.m1.6.6.2.2">𝑤</ci></list></apply><apply id="S3.E2.m1.8.8.2.2.2.2.3.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3"><times id="S3.E2.m1.8.8.2.2.2.2.3.1.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.1"></times><apply id="S3.E2.m1.8.8.2.2.2.2.3.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.2.2.3.2.1.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.2">superscript</csymbol><apply id="S3.E2.m1.8.8.2.2.2.2.3.2.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.2.2.3.2.2.1.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.2">subscript</csymbol><ci id="S3.E2.m1.8.8.2.2.2.2.3.2.2.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.2.2.2">𝑊</ci><ci id="S3.E2.m1.8.8.2.2.2.2.3.2.2.3.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.2.2.3">𝑉</ci></apply><ci id="S3.E2.m1.8.8.2.2.2.2.3.2.3.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.2.3">𝑤</ci></apply><apply id="S3.E2.m1.8.8.2.2.2.2.3.3.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.2.2.3.3.1.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.8.8.2.2.2.2.3.3.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.3.2">𝐰</ci><ci id="S3.E2.m1.8.8.2.2.2.2.3.3.3.cmml" xref="S3.E2.m1.8.8.2.2.2.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">Q^{i,w}=W_{Q}^{w}\mathbf{w}_{i},K^{i,w}=W_{K}^{w}\mathbf{w}_{i},V^{i,w}=W_{V}^{w}\mathbf{w}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.8" class="ltx_Math" alttext="Q^{i,v}=W_{Q}^{v}\mathbf{v}_{i},K^{i,v}=W_{K}^{v}\mathbf{v}_{i},V^{i,v}=W_{V}^{v}\mathbf{v}_{i}" display="block"><semantics id="S3.E3.m1.8a"><mrow id="S3.E3.m1.8.8.2" xref="S3.E3.m1.8.8.3.cmml"><mrow id="S3.E3.m1.7.7.1.1" xref="S3.E3.m1.7.7.1.1.cmml"><msup id="S3.E3.m1.7.7.1.1.2" xref="S3.E3.m1.7.7.1.1.2.cmml"><mi id="S3.E3.m1.7.7.1.1.2.2" xref="S3.E3.m1.7.7.1.1.2.2.cmml">Q</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">v</mi></mrow></msup><mo id="S3.E3.m1.7.7.1.1.1" xref="S3.E3.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.7.7.1.1.3" xref="S3.E3.m1.7.7.1.1.3.cmml"><msubsup id="S3.E3.m1.7.7.1.1.3.2" xref="S3.E3.m1.7.7.1.1.3.2.cmml"><mi id="S3.E3.m1.7.7.1.1.3.2.2.2" xref="S3.E3.m1.7.7.1.1.3.2.2.2.cmml">W</mi><mi id="S3.E3.m1.7.7.1.1.3.2.2.3" xref="S3.E3.m1.7.7.1.1.3.2.2.3.cmml">Q</mi><mi id="S3.E3.m1.7.7.1.1.3.2.3" xref="S3.E3.m1.7.7.1.1.3.2.3.cmml">v</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.7.7.1.1.3.1" xref="S3.E3.m1.7.7.1.1.3.1.cmml">​</mo><msub id="S3.E3.m1.7.7.1.1.3.3" xref="S3.E3.m1.7.7.1.1.3.3.cmml"><mi id="S3.E3.m1.7.7.1.1.3.3.2" xref="S3.E3.m1.7.7.1.1.3.3.2.cmml">𝐯</mi><mi id="S3.E3.m1.7.7.1.1.3.3.3" xref="S3.E3.m1.7.7.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E3.m1.8.8.2.3" xref="S3.E3.m1.8.8.3a.cmml">,</mo><mrow id="S3.E3.m1.8.8.2.2.2" xref="S3.E3.m1.8.8.2.2.3.cmml"><mrow id="S3.E3.m1.8.8.2.2.1.1" xref="S3.E3.m1.8.8.2.2.1.1.cmml"><msup id="S3.E3.m1.8.8.2.2.1.1.2" xref="S3.E3.m1.8.8.2.2.1.1.2.cmml"><mi id="S3.E3.m1.8.8.2.2.1.1.2.2" xref="S3.E3.m1.8.8.2.2.1.1.2.2.cmml">K</mi><mrow id="S3.E3.m1.4.4.2.4" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">i</mi><mo id="S3.E3.m1.4.4.2.4.1" xref="S3.E3.m1.4.4.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">v</mi></mrow></msup><mo id="S3.E3.m1.8.8.2.2.1.1.1" xref="S3.E3.m1.8.8.2.2.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.8.8.2.2.1.1.3" xref="S3.E3.m1.8.8.2.2.1.1.3.cmml"><msubsup id="S3.E3.m1.8.8.2.2.1.1.3.2" xref="S3.E3.m1.8.8.2.2.1.1.3.2.cmml"><mi id="S3.E3.m1.8.8.2.2.1.1.3.2.2.2" xref="S3.E3.m1.8.8.2.2.1.1.3.2.2.2.cmml">W</mi><mi id="S3.E3.m1.8.8.2.2.1.1.3.2.2.3" xref="S3.E3.m1.8.8.2.2.1.1.3.2.2.3.cmml">K</mi><mi id="S3.E3.m1.8.8.2.2.1.1.3.2.3" xref="S3.E3.m1.8.8.2.2.1.1.3.2.3.cmml">v</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.2.2.1.1.3.1" xref="S3.E3.m1.8.8.2.2.1.1.3.1.cmml">​</mo><msub id="S3.E3.m1.8.8.2.2.1.1.3.3" xref="S3.E3.m1.8.8.2.2.1.1.3.3.cmml"><mi id="S3.E3.m1.8.8.2.2.1.1.3.3.2" xref="S3.E3.m1.8.8.2.2.1.1.3.3.2.cmml">𝐯</mi><mi id="S3.E3.m1.8.8.2.2.1.1.3.3.3" xref="S3.E3.m1.8.8.2.2.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E3.m1.8.8.2.2.2.3" xref="S3.E3.m1.8.8.2.2.3a.cmml">,</mo><mrow id="S3.E3.m1.8.8.2.2.2.2" xref="S3.E3.m1.8.8.2.2.2.2.cmml"><msup id="S3.E3.m1.8.8.2.2.2.2.2" xref="S3.E3.m1.8.8.2.2.2.2.2.cmml"><mi id="S3.E3.m1.8.8.2.2.2.2.2.2" xref="S3.E3.m1.8.8.2.2.2.2.2.2.cmml">V</mi><mrow id="S3.E3.m1.6.6.2.4" xref="S3.E3.m1.6.6.2.3.cmml"><mi id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml">i</mi><mo id="S3.E3.m1.6.6.2.4.1" xref="S3.E3.m1.6.6.2.3.cmml">,</mo><mi id="S3.E3.m1.6.6.2.2" xref="S3.E3.m1.6.6.2.2.cmml">v</mi></mrow></msup><mo id="S3.E3.m1.8.8.2.2.2.2.1" xref="S3.E3.m1.8.8.2.2.2.2.1.cmml">=</mo><mrow id="S3.E3.m1.8.8.2.2.2.2.3" xref="S3.E3.m1.8.8.2.2.2.2.3.cmml"><msubsup id="S3.E3.m1.8.8.2.2.2.2.3.2" xref="S3.E3.m1.8.8.2.2.2.2.3.2.cmml"><mi id="S3.E3.m1.8.8.2.2.2.2.3.2.2.2" xref="S3.E3.m1.8.8.2.2.2.2.3.2.2.2.cmml">W</mi><mi id="S3.E3.m1.8.8.2.2.2.2.3.2.2.3" xref="S3.E3.m1.8.8.2.2.2.2.3.2.2.3.cmml">V</mi><mi id="S3.E3.m1.8.8.2.2.2.2.3.2.3" xref="S3.E3.m1.8.8.2.2.2.2.3.2.3.cmml">v</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.2.2.2.2.3.1" xref="S3.E3.m1.8.8.2.2.2.2.3.1.cmml">​</mo><msub id="S3.E3.m1.8.8.2.2.2.2.3.3" xref="S3.E3.m1.8.8.2.2.2.2.3.3.cmml"><mi id="S3.E3.m1.8.8.2.2.2.2.3.3.2" xref="S3.E3.m1.8.8.2.2.2.2.3.3.2.cmml">𝐯</mi><mi id="S3.E3.m1.8.8.2.2.2.2.3.3.3" xref="S3.E3.m1.8.8.2.2.2.2.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.8b"><apply id="S3.E3.m1.8.8.3.cmml" xref="S3.E3.m1.8.8.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.3a.cmml" xref="S3.E3.m1.8.8.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.7.7.1.1.cmml" xref="S3.E3.m1.7.7.1.1"><eq id="S3.E3.m1.7.7.1.1.1.cmml" xref="S3.E3.m1.7.7.1.1.1"></eq><apply id="S3.E3.m1.7.7.1.1.2.cmml" xref="S3.E3.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.1.1.2.1.cmml" xref="S3.E3.m1.7.7.1.1.2">superscript</csymbol><ci id="S3.E3.m1.7.7.1.1.2.2.cmml" xref="S3.E3.m1.7.7.1.1.2.2">𝑄</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑖</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑣</ci></list></apply><apply id="S3.E3.m1.7.7.1.1.3.cmml" xref="S3.E3.m1.7.7.1.1.3"><times id="S3.E3.m1.7.7.1.1.3.1.cmml" xref="S3.E3.m1.7.7.1.1.3.1"></times><apply id="S3.E3.m1.7.7.1.1.3.2.cmml" xref="S3.E3.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.1.1.3.2.1.cmml" xref="S3.E3.m1.7.7.1.1.3.2">superscript</csymbol><apply id="S3.E3.m1.7.7.1.1.3.2.2.cmml" xref="S3.E3.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E3.m1.7.7.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E3.m1.7.7.1.1.3.2.2.2">𝑊</ci><ci id="S3.E3.m1.7.7.1.1.3.2.2.3.cmml" xref="S3.E3.m1.7.7.1.1.3.2.2.3">𝑄</ci></apply><ci id="S3.E3.m1.7.7.1.1.3.2.3.cmml" xref="S3.E3.m1.7.7.1.1.3.2.3">𝑣</ci></apply><apply id="S3.E3.m1.7.7.1.1.3.3.cmml" xref="S3.E3.m1.7.7.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.1.1.3.3.1.cmml" xref="S3.E3.m1.7.7.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.7.7.1.1.3.3.2.cmml" xref="S3.E3.m1.7.7.1.1.3.3.2">𝐯</ci><ci id="S3.E3.m1.7.7.1.1.3.3.3.cmml" xref="S3.E3.m1.7.7.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.8.8.2.2.3.cmml" xref="S3.E3.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.3a.cmml" xref="S3.E3.m1.8.8.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.8.8.2.2.1.1.cmml" xref="S3.E3.m1.8.8.2.2.1.1"><eq id="S3.E3.m1.8.8.2.2.1.1.1.cmml" xref="S3.E3.m1.8.8.2.2.1.1.1"></eq><apply id="S3.E3.m1.8.8.2.2.1.1.2.cmml" xref="S3.E3.m1.8.8.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.1.1.2.1.cmml" xref="S3.E3.m1.8.8.2.2.1.1.2">superscript</csymbol><ci id="S3.E3.m1.8.8.2.2.1.1.2.2.cmml" xref="S3.E3.m1.8.8.2.2.1.1.2.2">𝐾</ci><list id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.4"><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑖</ci><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝑣</ci></list></apply><apply id="S3.E3.m1.8.8.2.2.1.1.3.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3"><times id="S3.E3.m1.8.8.2.2.1.1.3.1.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.1"></times><apply id="S3.E3.m1.8.8.2.2.1.1.3.2.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.1.1.3.2.1.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.2">superscript</csymbol><apply id="S3.E3.m1.8.8.2.2.1.1.3.2.2.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.1.1.3.2.2.1.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.8.8.2.2.1.1.3.2.2.2.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.2.2.2">𝑊</ci><ci id="S3.E3.m1.8.8.2.2.1.1.3.2.2.3.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.2.2.3">𝐾</ci></apply><ci id="S3.E3.m1.8.8.2.2.1.1.3.2.3.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.2.3">𝑣</ci></apply><apply id="S3.E3.m1.8.8.2.2.1.1.3.3.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.1.1.3.3.1.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.8.8.2.2.1.1.3.3.2.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.3.2">𝐯</ci><ci id="S3.E3.m1.8.8.2.2.1.1.3.3.3.cmml" xref="S3.E3.m1.8.8.2.2.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.8.8.2.2.2.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2"><eq id="S3.E3.m1.8.8.2.2.2.2.1.cmml" xref="S3.E3.m1.8.8.2.2.2.2.1"></eq><apply id="S3.E3.m1.8.8.2.2.2.2.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.2.2.2.1.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2">superscript</csymbol><ci id="S3.E3.m1.8.8.2.2.2.2.2.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2.2">𝑉</ci><list id="S3.E3.m1.6.6.2.3.cmml" xref="S3.E3.m1.6.6.2.4"><ci id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1.1">𝑖</ci><ci id="S3.E3.m1.6.6.2.2.cmml" xref="S3.E3.m1.6.6.2.2">𝑣</ci></list></apply><apply id="S3.E3.m1.8.8.2.2.2.2.3.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3"><times id="S3.E3.m1.8.8.2.2.2.2.3.1.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.1"></times><apply id="S3.E3.m1.8.8.2.2.2.2.3.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.2">superscript</csymbol><apply id="S3.E3.m1.8.8.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.2.2.3.2.2.1.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.2">subscript</csymbol><ci id="S3.E3.m1.8.8.2.2.2.2.3.2.2.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.2.2.2">𝑊</ci><ci id="S3.E3.m1.8.8.2.2.2.2.3.2.2.3.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.2.2.3">𝑉</ci></apply><ci id="S3.E3.m1.8.8.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.2.3">𝑣</ci></apply><apply id="S3.E3.m1.8.8.2.2.2.2.3.3.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.2.2.3.3.1.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E3.m1.8.8.2.2.2.2.3.3.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.3.2">𝐯</ci><ci id="S3.E3.m1.8.8.2.2.2.2.3.3.3.cmml" xref="S3.E3.m1.8.8.2.2.2.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.8c">Q^{i,v}=W_{Q}^{v}\mathbf{v}_{i},K^{i,v}=W_{K}^{v}\mathbf{v}_{i},V^{i,v}=W_{V}^{v}\mathbf{v}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.9" class="ltx_Math" alttext="\mathbf{w}^{\prime}_{i}=\mathrm{Attn}(Q^{i,w},K^{i,w},V^{i,w})" display="block"><semantics id="S3.E4.m1.9a"><mrow id="S3.E4.m1.9.9" xref="S3.E4.m1.9.9.cmml"><msubsup id="S3.E4.m1.9.9.5" xref="S3.E4.m1.9.9.5.cmml"><mi id="S3.E4.m1.9.9.5.2.2" xref="S3.E4.m1.9.9.5.2.2.cmml">𝐰</mi><mi id="S3.E4.m1.9.9.5.3" xref="S3.E4.m1.9.9.5.3.cmml">i</mi><mo id="S3.E4.m1.9.9.5.2.3" xref="S3.E4.m1.9.9.5.2.3.cmml">′</mo></msubsup><mo id="S3.E4.m1.9.9.4" xref="S3.E4.m1.9.9.4.cmml">=</mo><mrow id="S3.E4.m1.9.9.3" xref="S3.E4.m1.9.9.3.cmml"><mi id="S3.E4.m1.9.9.3.5" xref="S3.E4.m1.9.9.3.5.cmml">Attn</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.3.4" xref="S3.E4.m1.9.9.3.4.cmml">​</mo><mrow id="S3.E4.m1.9.9.3.3.3" xref="S3.E4.m1.9.9.3.3.4.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.3.3.3.4" xref="S3.E4.m1.9.9.3.3.4.cmml">(</mo><msup id="S3.E4.m1.7.7.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">Q</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">w</mi></mrow></msup><mo id="S3.E4.m1.9.9.3.3.3.5" xref="S3.E4.m1.9.9.3.3.4.cmml">,</mo><msup id="S3.E4.m1.8.8.2.2.2.2" xref="S3.E4.m1.8.8.2.2.2.2.cmml"><mi id="S3.E4.m1.8.8.2.2.2.2.2" xref="S3.E4.m1.8.8.2.2.2.2.2.cmml">K</mi><mrow id="S3.E4.m1.4.4.2.4" xref="S3.E4.m1.4.4.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">i</mi><mo id="S3.E4.m1.4.4.2.4.1" xref="S3.E4.m1.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml">w</mi></mrow></msup><mo id="S3.E4.m1.9.9.3.3.3.6" xref="S3.E4.m1.9.9.3.3.4.cmml">,</mo><msup id="S3.E4.m1.9.9.3.3.3.3" xref="S3.E4.m1.9.9.3.3.3.3.cmml"><mi id="S3.E4.m1.9.9.3.3.3.3.2" xref="S3.E4.m1.9.9.3.3.3.3.2.cmml">V</mi><mrow id="S3.E4.m1.6.6.2.4" xref="S3.E4.m1.6.6.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml">i</mi><mo id="S3.E4.m1.6.6.2.4.1" xref="S3.E4.m1.6.6.2.3.cmml">,</mo><mi id="S3.E4.m1.6.6.2.2" xref="S3.E4.m1.6.6.2.2.cmml">w</mi></mrow></msup><mo stretchy="false" id="S3.E4.m1.9.9.3.3.3.7" xref="S3.E4.m1.9.9.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.9b"><apply id="S3.E4.m1.9.9.cmml" xref="S3.E4.m1.9.9"><eq id="S3.E4.m1.9.9.4.cmml" xref="S3.E4.m1.9.9.4"></eq><apply id="S3.E4.m1.9.9.5.cmml" xref="S3.E4.m1.9.9.5"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.5.1.cmml" xref="S3.E4.m1.9.9.5">subscript</csymbol><apply id="S3.E4.m1.9.9.5.2.cmml" xref="S3.E4.m1.9.9.5"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.5.2.1.cmml" xref="S3.E4.m1.9.9.5">superscript</csymbol><ci id="S3.E4.m1.9.9.5.2.2.cmml" xref="S3.E4.m1.9.9.5.2.2">𝐰</ci><ci id="S3.E4.m1.9.9.5.2.3.cmml" xref="S3.E4.m1.9.9.5.2.3">′</ci></apply><ci id="S3.E4.m1.9.9.5.3.cmml" xref="S3.E4.m1.9.9.5.3">𝑖</ci></apply><apply id="S3.E4.m1.9.9.3.cmml" xref="S3.E4.m1.9.9.3"><times id="S3.E4.m1.9.9.3.4.cmml" xref="S3.E4.m1.9.9.3.4"></times><ci id="S3.E4.m1.9.9.3.5.cmml" xref="S3.E4.m1.9.9.3.5">Attn</ci><vector id="S3.E4.m1.9.9.3.3.4.cmml" xref="S3.E4.m1.9.9.3.3.3"><apply id="S3.E4.m1.7.7.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2">𝑄</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑤</ci></list></apply><apply id="S3.E4.m1.8.8.2.2.2.2.cmml" xref="S3.E4.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.2.2.2.2.1.cmml" xref="S3.E4.m1.8.8.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.8.8.2.2.2.2.2.cmml" xref="S3.E4.m1.8.8.2.2.2.2.2">𝐾</ci><list id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.4"><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝑖</ci><ci id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2">𝑤</ci></list></apply><apply id="S3.E4.m1.9.9.3.3.3.3.cmml" xref="S3.E4.m1.9.9.3.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.3.3.3.3.1.cmml" xref="S3.E4.m1.9.9.3.3.3.3">superscript</csymbol><ci id="S3.E4.m1.9.9.3.3.3.3.2.cmml" xref="S3.E4.m1.9.9.3.3.3.3.2">𝑉</ci><list id="S3.E4.m1.6.6.2.3.cmml" xref="S3.E4.m1.6.6.2.4"><ci id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1">𝑖</ci><ci id="S3.E4.m1.6.6.2.2.cmml" xref="S3.E4.m1.6.6.2.2">𝑤</ci></list></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.9c">\mathbf{w}^{\prime}_{i}=\mathrm{Attn}(Q^{i,w},K^{i,w},V^{i,w})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.9" class="ltx_Math" alttext="\mathbf{v}^{\prime}_{i}=\mathrm{Attn}(Q^{i,v},K^{i,v},V^{i,v})" display="block"><semantics id="S3.E5.m1.9a"><mrow id="S3.E5.m1.9.9" xref="S3.E5.m1.9.9.cmml"><msubsup id="S3.E5.m1.9.9.5" xref="S3.E5.m1.9.9.5.cmml"><mi id="S3.E5.m1.9.9.5.2.2" xref="S3.E5.m1.9.9.5.2.2.cmml">𝐯</mi><mi id="S3.E5.m1.9.9.5.3" xref="S3.E5.m1.9.9.5.3.cmml">i</mi><mo id="S3.E5.m1.9.9.5.2.3" xref="S3.E5.m1.9.9.5.2.3.cmml">′</mo></msubsup><mo id="S3.E5.m1.9.9.4" xref="S3.E5.m1.9.9.4.cmml">=</mo><mrow id="S3.E5.m1.9.9.3" xref="S3.E5.m1.9.9.3.cmml"><mi id="S3.E5.m1.9.9.3.5" xref="S3.E5.m1.9.9.3.5.cmml">Attn</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.3.4" xref="S3.E5.m1.9.9.3.4.cmml">​</mo><mrow id="S3.E5.m1.9.9.3.3.3" xref="S3.E5.m1.9.9.3.3.4.cmml"><mo stretchy="false" id="S3.E5.m1.9.9.3.3.3.4" xref="S3.E5.m1.9.9.3.3.4.cmml">(</mo><msup id="S3.E5.m1.7.7.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.2.cmml">Q</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">v</mi></mrow></msup><mo id="S3.E5.m1.9.9.3.3.3.5" xref="S3.E5.m1.9.9.3.3.4.cmml">,</mo><msup id="S3.E5.m1.8.8.2.2.2.2" xref="S3.E5.m1.8.8.2.2.2.2.cmml"><mi id="S3.E5.m1.8.8.2.2.2.2.2" xref="S3.E5.m1.8.8.2.2.2.2.2.cmml">K</mi><mrow id="S3.E5.m1.4.4.2.4" xref="S3.E5.m1.4.4.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml">i</mi><mo id="S3.E5.m1.4.4.2.4.1" xref="S3.E5.m1.4.4.2.3.cmml">,</mo><mi id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.2.cmml">v</mi></mrow></msup><mo id="S3.E5.m1.9.9.3.3.3.6" xref="S3.E5.m1.9.9.3.3.4.cmml">,</mo><msup id="S3.E5.m1.9.9.3.3.3.3" xref="S3.E5.m1.9.9.3.3.3.3.cmml"><mi id="S3.E5.m1.9.9.3.3.3.3.2" xref="S3.E5.m1.9.9.3.3.3.3.2.cmml">V</mi><mrow id="S3.E5.m1.6.6.2.4" xref="S3.E5.m1.6.6.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml">i</mi><mo id="S3.E5.m1.6.6.2.4.1" xref="S3.E5.m1.6.6.2.3.cmml">,</mo><mi id="S3.E5.m1.6.6.2.2" xref="S3.E5.m1.6.6.2.2.cmml">v</mi></mrow></msup><mo stretchy="false" id="S3.E5.m1.9.9.3.3.3.7" xref="S3.E5.m1.9.9.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.9b"><apply id="S3.E5.m1.9.9.cmml" xref="S3.E5.m1.9.9"><eq id="S3.E5.m1.9.9.4.cmml" xref="S3.E5.m1.9.9.4"></eq><apply id="S3.E5.m1.9.9.5.cmml" xref="S3.E5.m1.9.9.5"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.5.1.cmml" xref="S3.E5.m1.9.9.5">subscript</csymbol><apply id="S3.E5.m1.9.9.5.2.cmml" xref="S3.E5.m1.9.9.5"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.5.2.1.cmml" xref="S3.E5.m1.9.9.5">superscript</csymbol><ci id="S3.E5.m1.9.9.5.2.2.cmml" xref="S3.E5.m1.9.9.5.2.2">𝐯</ci><ci id="S3.E5.m1.9.9.5.2.3.cmml" xref="S3.E5.m1.9.9.5.2.3">′</ci></apply><ci id="S3.E5.m1.9.9.5.3.cmml" xref="S3.E5.m1.9.9.5.3">𝑖</ci></apply><apply id="S3.E5.m1.9.9.3.cmml" xref="S3.E5.m1.9.9.3"><times id="S3.E5.m1.9.9.3.4.cmml" xref="S3.E5.m1.9.9.3.4"></times><ci id="S3.E5.m1.9.9.3.5.cmml" xref="S3.E5.m1.9.9.3.5">Attn</ci><vector id="S3.E5.m1.9.9.3.3.4.cmml" xref="S3.E5.m1.9.9.3.3.3"><apply id="S3.E5.m1.7.7.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.2">𝑄</ci><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑣</ci></list></apply><apply id="S3.E5.m1.8.8.2.2.2.2.cmml" xref="S3.E5.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.2.2.2.2.1.cmml" xref="S3.E5.m1.8.8.2.2.2.2">superscript</csymbol><ci id="S3.E5.m1.8.8.2.2.2.2.2.cmml" xref="S3.E5.m1.8.8.2.2.2.2.2">𝐾</ci><list id="S3.E5.m1.4.4.2.3.cmml" xref="S3.E5.m1.4.4.2.4"><ci id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1">𝑖</ci><ci id="S3.E5.m1.4.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2">𝑣</ci></list></apply><apply id="S3.E5.m1.9.9.3.3.3.3.cmml" xref="S3.E5.m1.9.9.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.3.3.3.3.1.cmml" xref="S3.E5.m1.9.9.3.3.3.3">superscript</csymbol><ci id="S3.E5.m1.9.9.3.3.3.3.2.cmml" xref="S3.E5.m1.9.9.3.3.3.3.2">𝑉</ci><list id="S3.E5.m1.6.6.2.3.cmml" xref="S3.E5.m1.6.6.2.4"><ci id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1.1">𝑖</ci><ci id="S3.E5.m1.6.6.2.2.cmml" xref="S3.E5.m1.6.6.2.2">𝑣</ci></list></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.9c">\mathbf{v}^{\prime}_{i}=\mathrm{Attn}(Q^{i,v},K^{i,v},V^{i,v})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px1.p1.11" class="ltx_p">We reuse the notation of <math id="S3.SS2.SSS0.Px1.p1.7.m1.15" class="ltx_Math" alttext="Q^{i,\{w,v\}},K^{i,\{w,v\}},V^{i,\{w,v\}}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.7.m1.15a"><mrow id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.4.cmml"><msup id="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1.2.cmml">Q</mi><mrow id="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4" xref="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.5.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m1.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.3.3.3.3.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.5.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.2.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.1.cmml">{</mo><mi id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.1.1.cmml">w</mi><mo id="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.7.m1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.2.2.2.2.cmml">v</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.2.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.1.cmml">}</mo></mrow></mrow></msup><mo id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.4" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.4.cmml">,</mo><msup id="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2.2.cmml">K</mi><mrow id="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4" xref="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.5.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m1.7.7.3.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.7.7.3.3.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.5.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.2.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.1.cmml">{</mo><mi id="S3.SS2.SSS0.Px1.p1.7.m1.5.5.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.5.5.1.1.cmml">w</mi><mo id="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.7.m1.6.6.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.6.6.2.2.cmml">v</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.2.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.1.cmml">}</mo></mrow></mrow></msup><mo id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.5" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.4.cmml">,</mo><msup id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3.2.cmml">V</mi><mrow id="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4" xref="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.5.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m1.11.11.3.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.11.11.3.3.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.5.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.2.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.1.cmml">{</mo><mi id="S3.SS2.SSS0.Px1.p1.7.m1.9.9.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m1.9.9.1.1.cmml">w</mi><mo id="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.7.m1.10.10.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m1.10.10.2.2.cmml">v</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.2.3" xref="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.1.cmml">}</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.7.m1.15b"><list id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.4.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3"><apply id="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.13.13.1.1.2">𝑄</ci><list id="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.5.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4"><ci id="S3.SS2.SSS0.Px1.p1.7.m1.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.3.3.3.3">𝑖</ci><set id="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.4.4.4.4.1.2"><ci id="S3.SS2.SSS0.Px1.p1.7.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.1.1.1.1">𝑤</ci><ci id="S3.SS2.SSS0.Px1.p1.7.m1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.2.2.2.2">𝑣</ci></set></list></apply><apply id="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.14.14.2.2.2">𝐾</ci><list id="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.5.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4"><ci id="S3.SS2.SSS0.Px1.p1.7.m1.7.7.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.7.7.3.3">𝑖</ci><set id="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.8.8.4.4.1.2"><ci id="S3.SS2.SSS0.Px1.p1.7.m1.5.5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.5.5.1.1">𝑤</ci><ci id="S3.SS2.SSS0.Px1.p1.7.m1.6.6.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.6.6.2.2">𝑣</ci></set></list></apply><apply id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.15.15.3.3.2">𝑉</ci><list id="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.5.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4"><ci id="S3.SS2.SSS0.Px1.p1.7.m1.11.11.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.11.11.3.3">𝑖</ci><set id="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.12.12.4.4.1.2"><ci id="S3.SS2.SSS0.Px1.p1.7.m1.9.9.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.9.9.1.1">𝑤</ci><ci id="S3.SS2.SSS0.Px1.p1.7.m1.10.10.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m1.10.10.2.2">𝑣</ci></set></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.7.m1.15c">Q^{i,\{w,v\}},K^{i,\{w,v\}},V^{i,\{w,v\}}</annotation></semantics></math> by replacing <math id="S3.SS2.SSS0.Px1.p1.8.m2.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.8.m2.1a"><msub id="S3.SS2.SSS0.Px1.p1.8.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.8.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1.2.cmml">𝐰</mi><mi id="S3.SS2.SSS0.Px1.p1.8.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.8.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.8.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.8.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.8.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1.2">𝐰</ci><ci id="S3.SS2.SSS0.Px1.p1.8.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.8.m2.1c">\mathbf{w}_{i}</annotation></semantics></math> with <math id="S3.SS2.SSS0.Px1.p1.9.m3.1" class="ltx_Math" alttext="\mathbf{w}^{\prime}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.9.m3.1a"><msubsup id="S3.SS2.SSS0.Px1.p1.9.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.3" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1.3.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.9.m3.1b"><apply id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.2">𝐰</ci><ci id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1.2.3">′</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.9.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.9.m3.1c">\mathbf{w}^{\prime}_{i}</annotation></semantics></math> and <math id="S3.SS2.SSS0.Px1.p1.10.m4.1" class="ltx_Math" alttext="\mathbf{v}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.10.m4.1a"><msub id="S3.SS2.SSS0.Px1.p1.10.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.10.m4.1.1.2" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1.2.cmml">𝐯</mi><mi id="S3.SS2.SSS0.Px1.p1.10.m4.1.1.3" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.10.m4.1b"><apply id="S3.SS2.SSS0.Px1.p1.10.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.10.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.10.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1.2">𝐯</ci><ci id="S3.SS2.SSS0.Px1.p1.10.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.10.m4.1c">\mathbf{v}_{i}</annotation></semantics></math> with <math id="S3.SS2.SSS0.Px1.p1.11.m5.1" class="ltx_Math" alttext="\mathbf{v}^{\prime}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.11.m5.1a"><msubsup id="S3.SS2.SSS0.Px1.p1.11.m5.1.1" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.3" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1.3.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.11.m5.1b"><apply id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.2">𝐯</ci><ci id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1.2.3">′</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.11.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.11.m5.1c">\mathbf{v}^{\prime}_{i}</annotation></semantics></math>, and cross-attention is defined as:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.9" class="ltx_Math" alttext="\mathbf{w}_{i+1}=\mathrm{Attn}(Q^{i,w},K^{i,v},V^{i,v})" display="block"><semantics id="S3.E6.m1.9a"><mrow id="S3.E6.m1.9.9" xref="S3.E6.m1.9.9.cmml"><msub id="S3.E6.m1.9.9.5" xref="S3.E6.m1.9.9.5.cmml"><mi id="S3.E6.m1.9.9.5.2" xref="S3.E6.m1.9.9.5.2.cmml">𝐰</mi><mrow id="S3.E6.m1.9.9.5.3" xref="S3.E6.m1.9.9.5.3.cmml"><mi id="S3.E6.m1.9.9.5.3.2" xref="S3.E6.m1.9.9.5.3.2.cmml">i</mi><mo id="S3.E6.m1.9.9.5.3.1" xref="S3.E6.m1.9.9.5.3.1.cmml">+</mo><mn id="S3.E6.m1.9.9.5.3.3" xref="S3.E6.m1.9.9.5.3.3.cmml">1</mn></mrow></msub><mo id="S3.E6.m1.9.9.4" xref="S3.E6.m1.9.9.4.cmml">=</mo><mrow id="S3.E6.m1.9.9.3" xref="S3.E6.m1.9.9.3.cmml"><mi id="S3.E6.m1.9.9.3.5" xref="S3.E6.m1.9.9.3.5.cmml">Attn</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.9.9.3.4" xref="S3.E6.m1.9.9.3.4.cmml">​</mo><mrow id="S3.E6.m1.9.9.3.3.3" xref="S3.E6.m1.9.9.3.3.4.cmml"><mo stretchy="false" id="S3.E6.m1.9.9.3.3.3.4" xref="S3.E6.m1.9.9.3.3.4.cmml">(</mo><msup id="S3.E6.m1.7.7.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.2.cmml">Q</mi><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">w</mi></mrow></msup><mo id="S3.E6.m1.9.9.3.3.3.5" xref="S3.E6.m1.9.9.3.3.4.cmml">,</mo><msup id="S3.E6.m1.8.8.2.2.2.2" xref="S3.E6.m1.8.8.2.2.2.2.cmml"><mi id="S3.E6.m1.8.8.2.2.2.2.2" xref="S3.E6.m1.8.8.2.2.2.2.2.cmml">K</mi><mrow id="S3.E6.m1.4.4.2.4" xref="S3.E6.m1.4.4.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml">i</mi><mo id="S3.E6.m1.4.4.2.4.1" xref="S3.E6.m1.4.4.2.3.cmml">,</mo><mi id="S3.E6.m1.4.4.2.2" xref="S3.E6.m1.4.4.2.2.cmml">v</mi></mrow></msup><mo id="S3.E6.m1.9.9.3.3.3.6" xref="S3.E6.m1.9.9.3.3.4.cmml">,</mo><msup id="S3.E6.m1.9.9.3.3.3.3" xref="S3.E6.m1.9.9.3.3.3.3.cmml"><mi id="S3.E6.m1.9.9.3.3.3.3.2" xref="S3.E6.m1.9.9.3.3.3.3.2.cmml">V</mi><mrow id="S3.E6.m1.6.6.2.4" xref="S3.E6.m1.6.6.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml">i</mi><mo id="S3.E6.m1.6.6.2.4.1" xref="S3.E6.m1.6.6.2.3.cmml">,</mo><mi id="S3.E6.m1.6.6.2.2" xref="S3.E6.m1.6.6.2.2.cmml">v</mi></mrow></msup><mo stretchy="false" id="S3.E6.m1.9.9.3.3.3.7" xref="S3.E6.m1.9.9.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.9b"><apply id="S3.E6.m1.9.9.cmml" xref="S3.E6.m1.9.9"><eq id="S3.E6.m1.9.9.4.cmml" xref="S3.E6.m1.9.9.4"></eq><apply id="S3.E6.m1.9.9.5.cmml" xref="S3.E6.m1.9.9.5"><csymbol cd="ambiguous" id="S3.E6.m1.9.9.5.1.cmml" xref="S3.E6.m1.9.9.5">subscript</csymbol><ci id="S3.E6.m1.9.9.5.2.cmml" xref="S3.E6.m1.9.9.5.2">𝐰</ci><apply id="S3.E6.m1.9.9.5.3.cmml" xref="S3.E6.m1.9.9.5.3"><plus id="S3.E6.m1.9.9.5.3.1.cmml" xref="S3.E6.m1.9.9.5.3.1"></plus><ci id="S3.E6.m1.9.9.5.3.2.cmml" xref="S3.E6.m1.9.9.5.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.9.9.5.3.3.cmml" xref="S3.E6.m1.9.9.5.3.3">1</cn></apply></apply><apply id="S3.E6.m1.9.9.3.cmml" xref="S3.E6.m1.9.9.3"><times id="S3.E6.m1.9.9.3.4.cmml" xref="S3.E6.m1.9.9.3.4"></times><ci id="S3.E6.m1.9.9.3.5.cmml" xref="S3.E6.m1.9.9.3.5">Attn</ci><vector id="S3.E6.m1.9.9.3.3.4.cmml" xref="S3.E6.m1.9.9.3.3.3"><apply id="S3.E6.m1.7.7.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.2">𝑄</ci><list id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑤</ci></list></apply><apply id="S3.E6.m1.8.8.2.2.2.2.cmml" xref="S3.E6.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.2.2.2.2.1.cmml" xref="S3.E6.m1.8.8.2.2.2.2">superscript</csymbol><ci id="S3.E6.m1.8.8.2.2.2.2.2.cmml" xref="S3.E6.m1.8.8.2.2.2.2.2">𝐾</ci><list id="S3.E6.m1.4.4.2.3.cmml" xref="S3.E6.m1.4.4.2.4"><ci id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1">𝑖</ci><ci id="S3.E6.m1.4.4.2.2.cmml" xref="S3.E6.m1.4.4.2.2">𝑣</ci></list></apply><apply id="S3.E6.m1.9.9.3.3.3.3.cmml" xref="S3.E6.m1.9.9.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.9.9.3.3.3.3.1.cmml" xref="S3.E6.m1.9.9.3.3.3.3">superscript</csymbol><ci id="S3.E6.m1.9.9.3.3.3.3.2.cmml" xref="S3.E6.m1.9.9.3.3.3.3.2">𝑉</ci><list id="S3.E6.m1.6.6.2.3.cmml" xref="S3.E6.m1.6.6.2.4"><ci id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1">𝑖</ci><ci id="S3.E6.m1.6.6.2.2.cmml" xref="S3.E6.m1.6.6.2.2">𝑣</ci></list></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.9c">\mathbf{w}_{i+1}=\mathrm{Attn}(Q^{i,w},K^{i,v},V^{i,v})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.9" class="ltx_Math" alttext="\mathbf{v}_{i+1}=\mathrm{Attn}(Q^{i,v},K^{i,w},V^{i,w})" display="block"><semantics id="S3.E7.m1.9a"><mrow id="S3.E7.m1.9.9" xref="S3.E7.m1.9.9.cmml"><msub id="S3.E7.m1.9.9.5" xref="S3.E7.m1.9.9.5.cmml"><mi id="S3.E7.m1.9.9.5.2" xref="S3.E7.m1.9.9.5.2.cmml">𝐯</mi><mrow id="S3.E7.m1.9.9.5.3" xref="S3.E7.m1.9.9.5.3.cmml"><mi id="S3.E7.m1.9.9.5.3.2" xref="S3.E7.m1.9.9.5.3.2.cmml">i</mi><mo id="S3.E7.m1.9.9.5.3.1" xref="S3.E7.m1.9.9.5.3.1.cmml">+</mo><mn id="S3.E7.m1.9.9.5.3.3" xref="S3.E7.m1.9.9.5.3.3.cmml">1</mn></mrow></msub><mo id="S3.E7.m1.9.9.4" xref="S3.E7.m1.9.9.4.cmml">=</mo><mrow id="S3.E7.m1.9.9.3" xref="S3.E7.m1.9.9.3.cmml"><mi id="S3.E7.m1.9.9.3.5" xref="S3.E7.m1.9.9.3.5.cmml">Attn</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.9.9.3.4" xref="S3.E7.m1.9.9.3.4.cmml">​</mo><mrow id="S3.E7.m1.9.9.3.3.3" xref="S3.E7.m1.9.9.3.3.4.cmml"><mo stretchy="false" id="S3.E7.m1.9.9.3.3.3.4" xref="S3.E7.m1.9.9.3.3.4.cmml">(</mo><msup id="S3.E7.m1.7.7.1.1.1.1" xref="S3.E7.m1.7.7.1.1.1.1.cmml"><mi id="S3.E7.m1.7.7.1.1.1.1.2" xref="S3.E7.m1.7.7.1.1.1.1.2.cmml">Q</mi><mrow id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.2.2.2.4.1" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">v</mi></mrow></msup><mo id="S3.E7.m1.9.9.3.3.3.5" xref="S3.E7.m1.9.9.3.3.4.cmml">,</mo><msup id="S3.E7.m1.8.8.2.2.2.2" xref="S3.E7.m1.8.8.2.2.2.2.cmml"><mi id="S3.E7.m1.8.8.2.2.2.2.2" xref="S3.E7.m1.8.8.2.2.2.2.2.cmml">K</mi><mrow id="S3.E7.m1.4.4.2.4" xref="S3.E7.m1.4.4.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml">i</mi><mo id="S3.E7.m1.4.4.2.4.1" xref="S3.E7.m1.4.4.2.3.cmml">,</mo><mi id="S3.E7.m1.4.4.2.2" xref="S3.E7.m1.4.4.2.2.cmml">w</mi></mrow></msup><mo id="S3.E7.m1.9.9.3.3.3.6" xref="S3.E7.m1.9.9.3.3.4.cmml">,</mo><msup id="S3.E7.m1.9.9.3.3.3.3" xref="S3.E7.m1.9.9.3.3.3.3.cmml"><mi id="S3.E7.m1.9.9.3.3.3.3.2" xref="S3.E7.m1.9.9.3.3.3.3.2.cmml">V</mi><mrow id="S3.E7.m1.6.6.2.4" xref="S3.E7.m1.6.6.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml">i</mi><mo id="S3.E7.m1.6.6.2.4.1" xref="S3.E7.m1.6.6.2.3.cmml">,</mo><mi id="S3.E7.m1.6.6.2.2" xref="S3.E7.m1.6.6.2.2.cmml">w</mi></mrow></msup><mo stretchy="false" id="S3.E7.m1.9.9.3.3.3.7" xref="S3.E7.m1.9.9.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.9b"><apply id="S3.E7.m1.9.9.cmml" xref="S3.E7.m1.9.9"><eq id="S3.E7.m1.9.9.4.cmml" xref="S3.E7.m1.9.9.4"></eq><apply id="S3.E7.m1.9.9.5.cmml" xref="S3.E7.m1.9.9.5"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.5.1.cmml" xref="S3.E7.m1.9.9.5">subscript</csymbol><ci id="S3.E7.m1.9.9.5.2.cmml" xref="S3.E7.m1.9.9.5.2">𝐯</ci><apply id="S3.E7.m1.9.9.5.3.cmml" xref="S3.E7.m1.9.9.5.3"><plus id="S3.E7.m1.9.9.5.3.1.cmml" xref="S3.E7.m1.9.9.5.3.1"></plus><ci id="S3.E7.m1.9.9.5.3.2.cmml" xref="S3.E7.m1.9.9.5.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.9.9.5.3.3.cmml" xref="S3.E7.m1.9.9.5.3.3">1</cn></apply></apply><apply id="S3.E7.m1.9.9.3.cmml" xref="S3.E7.m1.9.9.3"><times id="S3.E7.m1.9.9.3.4.cmml" xref="S3.E7.m1.9.9.3.4"></times><ci id="S3.E7.m1.9.9.3.5.cmml" xref="S3.E7.m1.9.9.3.5">Attn</ci><vector id="S3.E7.m1.9.9.3.3.4.cmml" xref="S3.E7.m1.9.9.3.3.3"><apply id="S3.E7.m1.7.7.1.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.7.7.1.1.1.1.2.cmml" xref="S3.E7.m1.7.7.1.1.1.1.2">𝑄</ci><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.4"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑖</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑣</ci></list></apply><apply id="S3.E7.m1.8.8.2.2.2.2.cmml" xref="S3.E7.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.2.2.2.2.1.cmml" xref="S3.E7.m1.8.8.2.2.2.2">superscript</csymbol><ci id="S3.E7.m1.8.8.2.2.2.2.2.cmml" xref="S3.E7.m1.8.8.2.2.2.2.2">𝐾</ci><list id="S3.E7.m1.4.4.2.3.cmml" xref="S3.E7.m1.4.4.2.4"><ci id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1">𝑖</ci><ci id="S3.E7.m1.4.4.2.2.cmml" xref="S3.E7.m1.4.4.2.2">𝑤</ci></list></apply><apply id="S3.E7.m1.9.9.3.3.3.3.cmml" xref="S3.E7.m1.9.9.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.3.3.3.3.1.cmml" xref="S3.E7.m1.9.9.3.3.3.3">superscript</csymbol><ci id="S3.E7.m1.9.9.3.3.3.3.2.cmml" xref="S3.E7.m1.9.9.3.3.3.3.2">𝑉</ci><list id="S3.E7.m1.6.6.2.3.cmml" xref="S3.E7.m1.6.6.2.4"><ci id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1.1">𝑖</ci><ci id="S3.E7.m1.6.6.2.2.cmml" xref="S3.E7.m1.6.6.2.2">𝑤</ci></list></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.9c">\mathbf{v}_{i+1}=\mathrm{Attn}(Q^{i,v},K^{i,w},V^{i,w})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px1.p1.13" class="ltx_p">The fused representations of text and image are denoted as <math id="S3.SS2.SSS0.Px1.p1.12.m1.1" class="ltx_Math" alttext="\mathbf{w}_{L}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.12.m1.1a"><msub id="S3.SS2.SSS0.Px1.p1.12.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.12.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.12.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.12.m1.1.1.2.cmml">𝐰</mi><mi id="S3.SS2.SSS0.Px1.p1.12.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.12.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.12.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.12.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.12.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.12.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.12.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.12.m1.1.1.2">𝐰</ci><ci id="S3.SS2.SSS0.Px1.p1.12.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.12.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.12.m1.1c">\mathbf{w}_{L}</annotation></semantics></math> and <math id="S3.SS2.SSS0.Px1.p1.13.m2.1" class="ltx_Math" alttext="\mathbf{v}_{L}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.13.m2.1a"><msub id="S3.SS2.SSS0.Px1.p1.13.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.13.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.13.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.13.m2.1.1.2.cmml">𝐯</mi><mi id="S3.SS2.SSS0.Px1.p1.13.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.13.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.13.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.13.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.13.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.13.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m2.1.1.2">𝐯</ci><ci id="S3.SS2.SSS0.Px1.p1.13.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.13.m2.1c">\mathbf{v}_{L}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Pretraining Tasks</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.9" class="ltx_p">To pretrain RAMM, we employ three pretraining tasks including Image-Text Contrastive learning (ITC) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, Image-Text Matching (ITM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, and Masked Language Modeling (MLM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
The pretraining objective function of RAMM is defined by the sum of these three tasks. ITC aligns uni-modal visual and textual representations <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}=g_{w}(\mathbf{w}_{cls})" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">𝐰</mi><mo id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml"><msub id="S3.SS3.p1.1.m1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.1.3.2.cmml">g</mi><mi id="S3.SS3.p1.1.m1.1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.1.3.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.1.m1.1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.2.cmml">𝐰</mi><mrow id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.1a" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.4" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><eq id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2"></eq><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝐰</ci><apply id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1"><times id="S3.SS3.p1.1.m1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.2"></times><apply id="S3.SS3.p1.1.m1.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.3.2">𝑔</ci><ci id="S3.SS3.p1.1.m1.1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.3.3">𝑤</ci></apply><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.2">𝐰</ci><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3"><times id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.4.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathbf{w}=g_{w}(\mathbf{w}_{cls})</annotation></semantics></math> and <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{v}=g_{v}(\mathbf{v}_{cls})" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">𝐯</mi><mo id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml"><msub id="S3.SS3.p1.2.m2.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.1.3.2.cmml">g</mi><mi id="S3.SS3.p1.2.m2.1.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.1.3.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.2.m2.1.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.2.m2.1.1.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.2.cmml">𝐯</mi><mrow id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.1a" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.4" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><eq id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"></eq><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝐯</ci><apply id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1"><times id="S3.SS3.p1.2.m2.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.2"></times><apply id="S3.SS3.p1.2.m2.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.3.2">𝑔</ci><ci id="S3.SS3.p1.2.m2.1.1.1.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.3.3">𝑣</ci></apply><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.2">𝐯</ci><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3"><times id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.1"></times><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.4.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\mathbf{v}=g_{v}(\mathbf{v}_{cls})</annotation></semantics></math> in the same embedding space, where <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="g_{w}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">g</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑔</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">g_{w}</annotation></semantics></math> and <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="g_{v}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">g</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑔</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">g_{v}</annotation></semantics></math> are two linear projections with <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="L^{2}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><msup id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">L</mi><mn id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝐿</ci><cn type="integer" id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">L^{2}</annotation></semantics></math> normalization.
ITM predicts whether one image and one text match each other based on fused representations <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{w}_{L}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><msub id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">𝐰</mi><mi id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">𝐰</ci><ci id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\mathbf{w}_{L}</annotation></semantics></math> and <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{v}_{L}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msub id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">𝐯</mi><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">𝐯</ci><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\mathbf{v}_{L}</annotation></semantics></math>.
MLM predicts masked token in text <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="\it{T}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\it{T}</annotation></semantics></math> based on fused textual representations <math id="S3.SS3.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{w}_{L}" display="inline"><semantics id="S3.SS3.p1.9.m9.1a"><msub id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">𝐰</mi><mi id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">𝐰</ci><ci id="S3.SS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">\mathbf{w}_{L}</annotation></semantics></math>.
Since ITC aims to align images and texts with cosine similarities, it becomes a natural choice to retrieve related images and texts.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Retrieval-augmented Fine-tuning</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">We use image-text contrastive similarity to retrieve related image-text pairs and fuse them with a retrieval-attention module in fine-tuning.</p>
</div>
<section id="S3.SS4.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Retrieve related image text pairs</h5>

<div id="S3.SS4.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS4.SSS0.Px1.p1.11" class="ltx_p">Let <math id="S3.SS4.SSS0.Px1.p1.1.m1.2" class="ltx_Math" alttext="\mathcal{D}=\{(\it{I}_{j},\it{T}_{j})|j\in\mathcal{A}\}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.1.m1.2a"><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.2.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.4" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.4.cmml">𝒟</mi><mo id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.3.1.cmml">{</mo><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.2.cmml">I</mi><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.4" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.2.cmml">T</mi><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.5" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.4" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.2.cmml">j</mi><mo id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.1" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.cmml">𝒜</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.5" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.1.m1.2b"><apply id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2"><eq id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.3"></eq><ci id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.4.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.4">𝒟</ci><apply id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2"><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.2">𝐼</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.2">𝑇</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval><apply id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2"><in id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.1"></in><ci id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.2">𝑗</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.3">𝒜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.1.m1.2c">\mathcal{D}=\{(\it{I}_{j},\it{T}_{j})|j\in\mathcal{A}\}</annotation></semantics></math> denotes the set of all image-text pairs, where <math id="S3.SS4.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS4.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.2.m2.1c">\mathcal{A}</annotation></semantics></math> is an index set.
For image-question pair <math id="S3.SS4.SSS0.Px1.p1.3.m3.2" class="ltx_Math" alttext="(\it{I},\it{T})" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.3.m3.2a"><mrow id="S3.SS4.SSS0.Px1.p1.3.m3.2.3.2" xref="S3.SS4.SSS0.Px1.p1.3.m3.2.3.1.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.3.m3.2.3.2.1" xref="S3.SS4.SSS0.Px1.p1.3.m3.2.3.1.cmml">(</mo><mi id="S3.SS4.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.cmml">I</mi><mo id="S3.SS4.SSS0.Px1.p1.3.m3.2.3.2.2" xref="S3.SS4.SSS0.Px1.p1.3.m3.2.3.1.cmml">,</mo><mi id="S3.SS4.SSS0.Px1.p1.3.m3.2.2" xref="S3.SS4.SSS0.Px1.p1.3.m3.2.2.cmml">T</mi><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.3.m3.2.3.2.3" xref="S3.SS4.SSS0.Px1.p1.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.3.m3.2b"><interval closure="open" id="S3.SS4.SSS0.Px1.p1.3.m3.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.2.3.2"><ci id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1">𝐼</ci><ci id="S3.SS4.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.2.2">𝑇</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.3.m3.2c">(\it{I},\it{T})</annotation></semantics></math> from VQA datasets, we retrieve <math id="S3.SS4.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS4.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS4.SSS0.Px1.p1.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS4.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.4.m4.1c">r</annotation></semantics></math> augmented samples from <math id="S3.SS4.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.5.m5.1b"><ci id="S3.SS4.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.5.m5.1c">\mathcal{D}</annotation></semantics></math> based on uni-modal image representations <math id="S3.SS4.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\textbf{v}_{cls}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.6.m6.1a"><msub id="S3.SS4.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2a.cmml">v</mtext><mrow id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.2" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.1" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.3" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.1a" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.4" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2a.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2">v</mtext></ci><apply id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3"><times id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.2">𝑐</ci><ci id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.3">𝑙</ci><ci id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.4.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.6.m6.1c">\textbf{v}_{cls}</annotation></semantics></math>.
Here we do not use the representations from question <math id="S3.SS4.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="\it{T}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.7.m7.1a"><mi id="S3.SS4.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS4.SSS0.Px1.p1.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.7.m7.1b"><ci id="S3.SS4.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.7.m7.1c">\it{T}</annotation></semantics></math> to retrieve since questions in VQA datasets are homogeneous and non-informative.
With different images, questions can be similar to <span id="S3.SS4.SSS0.Px1.p1.11.1" class="ltx_text ltx_font_italic">What is the abnormality in this image?</span> or <span id="S3.SS4.SSS0.Px1.p1.11.2" class="ltx_text ltx_font_italic">Is there an abnormality in this image?</span>
For image-text pair <math id="S3.SS4.SSS0.Px1.p1.8.m8.2" class="ltx_Math" alttext="(\it{I}_{j},\it{T}_{j})\in\mathcal{D}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.8.m8.2a"><mrow id="S3.SS4.SSS0.Px1.p1.8.m8.2.2" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.cmml"><mrow id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.3.cmml">(</mo><msub id="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.cmml">I</mi><mi id="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.4" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.3.cmml">,</mo><msub id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.2.cmml">T</mi><mi id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.5" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.3.cmml">)</mo></mrow><mo id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.3" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.4" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.4.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.8.m8.2b"><apply id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2"><in id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.3"></in><interval closure="open" id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2"><apply id="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.2">𝐼</ci><ci id="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.2">𝑇</ci><ci id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.2.2.2.3">𝑗</ci></apply></interval><ci id="S3.SS4.SSS0.Px1.p1.8.m8.2.2.4.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.2.2.4">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.8.m8.2c">(\it{I}_{j},\it{T}_{j})\in\mathcal{D}</annotation></semantics></math> with uni-modal representations <math id="S3.SS4.SSS0.Px1.p1.9.m9.1" class="ltx_Math" alttext="\textbf{v}_{cls}^{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.9.m9.1a"><msubsup id="S3.SS4.SSS0.Px1.p1.9.m9.1.1" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.2a.cmml">v</mtext><mrow id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.cmml"><mi id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.2" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.1" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.3" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.1a" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.4" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.4.cmml">s</mi></mrow><mi id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.3" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.9.m9.1b"><apply id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.2a.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.2">v</mtext></ci><apply id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3"><times id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.1"></times><ci id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.2.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.2">𝑐</ci><ci id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.3">𝑙</ci><ci id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.4.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S3.SS4.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.9.m9.1c">\textbf{v}_{cls}^{j}</annotation></semantics></math> and <math id="S3.SS4.SSS0.Px1.p1.10.m10.1" class="ltx_Math" alttext="\textbf{w}_{cls}^{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.10.m10.1a"><msubsup id="S3.SS4.SSS0.Px1.p1.10.m10.1.1" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.2a.cmml">w</mtext><mrow id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.cmml"><mi id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.2" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.1" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.3" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.1a" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.4" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.4.cmml">s</mi></mrow><mi id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.3" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.10.m10.1b"><apply id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.2a.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.2">w</mtext></ci><apply id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3"><times id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.1"></times><ci id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.2.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.2">𝑐</ci><ci id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.3">𝑙</ci><ci id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.4.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S3.SS4.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.10.m10.1c">\textbf{w}_{cls}^{j}</annotation></semantics></math>, we calculate the similarities between image <math id="S3.SS4.SSS0.Px1.p1.11.m11.1" class="ltx_Math" alttext="\it{I}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.11.m11.1a"><mi id="S3.SS4.SSS0.Px1.p1.11.m11.1.1" xref="S3.SS4.SSS0.Px1.p1.11.m11.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.11.m11.1b"><ci id="S3.SS4.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.11.m11.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.11.m11.1c">\it{I}</annotation></semantics></math> using ITC similarity scores:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.2" class="ltx_Math" alttext="s_{w}^{j}=g_{v}(\mathbf{v}_{cls})^{\top}g_{w}(\mathbf{w}^{j}_{cls})" display="block"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><msubsup id="S3.E8.m1.2.2.4" xref="S3.E8.m1.2.2.4.cmml"><mi id="S3.E8.m1.2.2.4.2.2" xref="S3.E8.m1.2.2.4.2.2.cmml">s</mi><mi id="S3.E8.m1.2.2.4.2.3" xref="S3.E8.m1.2.2.4.2.3.cmml">w</mi><mi id="S3.E8.m1.2.2.4.3" xref="S3.E8.m1.2.2.4.3.cmml">j</mi></msubsup><mo id="S3.E8.m1.2.2.3" xref="S3.E8.m1.2.2.3.cmml">=</mo><mrow id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml"><msub id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.4.cmml"><mi id="S3.E8.m1.2.2.2.4.2" xref="S3.E8.m1.2.2.2.4.2.cmml">g</mi><mi id="S3.E8.m1.2.2.2.4.3" xref="S3.E8.m1.2.2.2.4.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">​</mo><msup id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mrow id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.1.3.1a" xref="S3.E8.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1.3.4" xref="S3.E8.m1.1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.3a" xref="S3.E8.m1.2.2.2.3.cmml">​</mo><msub id="S3.E8.m1.2.2.2.5" xref="S3.E8.m1.2.2.2.5.cmml"><mi id="S3.E8.m1.2.2.2.5.2" xref="S3.E8.m1.2.2.2.5.2.cmml">g</mi><mi id="S3.E8.m1.2.2.2.5.3" xref="S3.E8.m1.2.2.2.5.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.3b" xref="S3.E8.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E8.m1.2.2.2.2.1" xref="S3.E8.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.2" xref="S3.E8.m1.2.2.2.2.1.1.cmml">(</mo><msubsup id="S3.E8.m1.2.2.2.2.1.1" xref="S3.E8.m1.2.2.2.2.1.1.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.2.2" xref="S3.E8.m1.2.2.2.2.1.1.2.2.cmml">𝐰</mi><mrow id="S3.E8.m1.2.2.2.2.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.3.2" xref="S3.E8.m1.2.2.2.2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.1.1.3.1" xref="S3.E8.m1.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.2.2.1.1.3.3" xref="S3.E8.m1.2.2.2.2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.1.1.3.1a" xref="S3.E8.m1.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.2.2.1.1.3.4" xref="S3.E8.m1.2.2.2.2.1.1.3.4.cmml">s</mi></mrow><mi id="S3.E8.m1.2.2.2.2.1.1.2.3" xref="S3.E8.m1.2.2.2.2.1.1.2.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.3" xref="S3.E8.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><eq id="S3.E8.m1.2.2.3.cmml" xref="S3.E8.m1.2.2.3"></eq><apply id="S3.E8.m1.2.2.4.cmml" xref="S3.E8.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.4.1.cmml" xref="S3.E8.m1.2.2.4">superscript</csymbol><apply id="S3.E8.m1.2.2.4.2.cmml" xref="S3.E8.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.4.2.1.cmml" xref="S3.E8.m1.2.2.4">subscript</csymbol><ci id="S3.E8.m1.2.2.4.2.2.cmml" xref="S3.E8.m1.2.2.4.2.2">𝑠</ci><ci id="S3.E8.m1.2.2.4.2.3.cmml" xref="S3.E8.m1.2.2.4.2.3">𝑤</ci></apply><ci id="S3.E8.m1.2.2.4.3.cmml" xref="S3.E8.m1.2.2.4.3">𝑗</ci></apply><apply id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"><times id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.3"></times><apply id="S3.E8.m1.2.2.2.4.cmml" xref="S3.E8.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.4.1.cmml" xref="S3.E8.m1.2.2.2.4">subscript</csymbol><ci id="S3.E8.m1.2.2.2.4.2.cmml" xref="S3.E8.m1.2.2.2.4.2">𝑔</ci><ci id="S3.E8.m1.2.2.2.4.3.cmml" xref="S3.E8.m1.2.2.2.4.3">𝑣</ci></apply><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.2">𝐯</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3"><times id="S3.E8.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply><csymbol cd="latexml" id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3">top</csymbol></apply><apply id="S3.E8.m1.2.2.2.5.cmml" xref="S3.E8.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.5.1.cmml" xref="S3.E8.m1.2.2.2.5">subscript</csymbol><ci id="S3.E8.m1.2.2.2.5.2.cmml" xref="S3.E8.m1.2.2.2.5.2">𝑔</ci><ci id="S3.E8.m1.2.2.2.5.3.cmml" xref="S3.E8.m1.2.2.2.5.3">𝑤</ci></apply><apply id="S3.E8.m1.2.2.2.2.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1">subscript</csymbol><apply id="S3.E8.m1.2.2.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E8.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E8.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.2">𝐰</ci><ci id="S3.E8.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S3.E8.m1.2.2.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.3"><times id="S3.E8.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.E8.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.3.2">𝑐</ci><ci id="S3.E8.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.3.3">𝑙</ci><ci id="S3.E8.m1.2.2.2.2.1.1.3.4.cmml" xref="S3.E8.m1.2.2.2.2.1.1.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">s_{w}^{j}=g_{v}(\mathbf{v}_{cls})^{\top}g_{w}(\mathbf{w}^{j}_{cls})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.2" class="ltx_Math" alttext="s_{v}^{j}=g_{v}(\mathbf{v}_{cls})^{\top}g_{v}(\mathbf{v}^{j}_{cls})" display="block"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><msubsup id="S3.E9.m1.2.2.4" xref="S3.E9.m1.2.2.4.cmml"><mi id="S3.E9.m1.2.2.4.2.2" xref="S3.E9.m1.2.2.4.2.2.cmml">s</mi><mi id="S3.E9.m1.2.2.4.2.3" xref="S3.E9.m1.2.2.4.2.3.cmml">v</mi><mi id="S3.E9.m1.2.2.4.3" xref="S3.E9.m1.2.2.4.3.cmml">j</mi></msubsup><mo id="S3.E9.m1.2.2.3" xref="S3.E9.m1.2.2.3.cmml">=</mo><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><msub id="S3.E9.m1.2.2.2.4" xref="S3.E9.m1.2.2.2.4.cmml"><mi id="S3.E9.m1.2.2.2.4.2" xref="S3.E9.m1.2.2.2.4.2.cmml">g</mi><mi id="S3.E9.m1.2.2.2.4.3" xref="S3.E9.m1.2.2.2.4.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml">​</mo><msup id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mrow id="S3.E9.m1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.3.1" xref="S3.E9.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.3.1a" xref="S3.E9.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.3.4" xref="S3.E9.m1.1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.3a" xref="S3.E9.m1.2.2.2.3.cmml">​</mo><msub id="S3.E9.m1.2.2.2.5" xref="S3.E9.m1.2.2.2.5.cmml"><mi id="S3.E9.m1.2.2.2.5.2" xref="S3.E9.m1.2.2.2.5.2.cmml">g</mi><mi id="S3.E9.m1.2.2.2.5.3" xref="S3.E9.m1.2.2.2.5.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.3b" xref="S3.E9.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E9.m1.2.2.2.2.1" xref="S3.E9.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.2.2.1.2" xref="S3.E9.m1.2.2.2.2.1.1.cmml">(</mo><msubsup id="S3.E9.m1.2.2.2.2.1.1" xref="S3.E9.m1.2.2.2.2.1.1.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.2.2" xref="S3.E9.m1.2.2.2.2.1.1.2.2.cmml">𝐯</mi><mrow id="S3.E9.m1.2.2.2.2.1.1.3" xref="S3.E9.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.3.2" xref="S3.E9.m1.2.2.2.2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.1.1.3.1" xref="S3.E9.m1.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E9.m1.2.2.2.2.1.1.3.3" xref="S3.E9.m1.2.2.2.2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.1.1.3.1a" xref="S3.E9.m1.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E9.m1.2.2.2.2.1.1.3.4" xref="S3.E9.m1.2.2.2.2.1.1.3.4.cmml">s</mi></mrow><mi id="S3.E9.m1.2.2.2.2.1.1.2.3" xref="S3.E9.m1.2.2.2.2.1.1.2.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E9.m1.2.2.2.2.1.3" xref="S3.E9.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><eq id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2.3"></eq><apply id="S3.E9.m1.2.2.4.cmml" xref="S3.E9.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.4.1.cmml" xref="S3.E9.m1.2.2.4">superscript</csymbol><apply id="S3.E9.m1.2.2.4.2.cmml" xref="S3.E9.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.4.2.1.cmml" xref="S3.E9.m1.2.2.4">subscript</csymbol><ci id="S3.E9.m1.2.2.4.2.2.cmml" xref="S3.E9.m1.2.2.4.2.2">𝑠</ci><ci id="S3.E9.m1.2.2.4.2.3.cmml" xref="S3.E9.m1.2.2.4.2.3">𝑣</ci></apply><ci id="S3.E9.m1.2.2.4.3.cmml" xref="S3.E9.m1.2.2.4.3">𝑗</ci></apply><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><times id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"></times><apply id="S3.E9.m1.2.2.2.4.cmml" xref="S3.E9.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.4.1.cmml" xref="S3.E9.m1.2.2.2.4">subscript</csymbol><ci id="S3.E9.m1.2.2.2.4.2.cmml" xref="S3.E9.m1.2.2.2.4.2">𝑔</ci><ci id="S3.E9.m1.2.2.2.4.3.cmml" xref="S3.E9.m1.2.2.2.4.3">𝑣</ci></apply><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.2">𝐯</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3"><times id="S3.E9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply><csymbol cd="latexml" id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3">top</csymbol></apply><apply id="S3.E9.m1.2.2.2.5.cmml" xref="S3.E9.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.5.1.cmml" xref="S3.E9.m1.2.2.2.5">subscript</csymbol><ci id="S3.E9.m1.2.2.2.5.2.cmml" xref="S3.E9.m1.2.2.2.5.2">𝑔</ci><ci id="S3.E9.m1.2.2.2.5.3.cmml" xref="S3.E9.m1.2.2.2.5.3">𝑣</ci></apply><apply id="S3.E9.m1.2.2.2.2.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1">subscript</csymbol><apply id="S3.E9.m1.2.2.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E9.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E9.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.2">𝐯</ci><ci id="S3.E9.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S3.E9.m1.2.2.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3"><times id="S3.E9.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.E9.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.2">𝑐</ci><ci id="S3.E9.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.3">𝑙</ci><ci id="S3.E9.m1.2.2.2.2.1.1.3.4.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">s_{v}^{j}=g_{v}(\mathbf{v}_{cls})^{\top}g_{v}(\mathbf{v}^{j}_{cls})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.SSS0.Px1.p1.18" class="ltx_p">ITC optimizes <math id="S3.SS4.SSS0.Px1.p1.12.m1.2" class="ltx_Math" alttext="g_{v}(\mathbf{v}^{j}_{cls})^{\top}g_{w}(\mathbf{w}^{j}_{cls})\rightarrow 1" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.12.m1.2a"><mrow id="S3.SS4.SSS0.Px1.p1.12.m1.2.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.cmml"><mrow id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.cmml"><msub id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.cmml"><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.2.cmml">g</mi><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.3.cmml">​</mo><msup id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.cmml"><mrow id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.2.cmml">𝐯</mi><mrow id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.1" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.1a" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.4" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow><mi id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.3a" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.3.cmml">​</mo><msub id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.cmml"><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.2.cmml">g</mi><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.3b" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.3.cmml">​</mo><mrow id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.cmml">(</mo><msubsup id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.2.cmml">𝐰</mi><mrow id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.2" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.1" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.1a" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.4" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.4.cmml">s</mi></mrow><mi id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.3" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.3.cmml">→</mo><mn id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.4" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.4.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.12.m1.2b"><apply id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2"><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.3">→</ci><apply id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2"><times id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.3"></times><apply id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.2">𝑔</ci><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.4.3">𝑣</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.2">𝐯</ci><ci id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3"><times id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.1.1.1.1.3">top</csymbol></apply><apply id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.2">𝑔</ci><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.5.3">𝑤</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1">subscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3"><times id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.2">𝑐</ci><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.3">𝑙</ci><ci id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.4.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.2.2.1.1.3.4">𝑠</ci></apply></apply></apply><cn type="integer" id="S3.SS4.SSS0.Px1.p1.12.m1.2.2.4.cmml" xref="S3.SS4.SSS0.Px1.p1.12.m1.2.2.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.12.m1.2c">g_{v}(\mathbf{v}^{j}_{cls})^{\top}g_{w}(\mathbf{w}^{j}_{cls})\rightarrow 1</annotation></semantics></math> while pretraining, and this leads <math id="S3.SS4.SSS0.Px1.p1.13.m2.1" class="ltx_Math" alttext="s_{w}^{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.13.m2.1a"><msubsup id="S3.SS4.SSS0.Px1.p1.13.m2.1.1" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.3.cmml">w</mi><mi id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.3" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.13.m2.1b"><apply id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1.2.3">𝑤</ci></apply><ci id="S3.SS4.SSS0.Px1.p1.13.m2.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.13.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.13.m2.1c">s_{w}^{j}</annotation></semantics></math> and <math id="S3.SS4.SSS0.Px1.p1.14.m3.1" class="ltx_Math" alttext="s_{v}^{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.14.m3.1a"><msubsup id="S3.SS4.SSS0.Px1.p1.14.m3.1.1" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.3.cmml">v</mi><mi id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.3" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.14.m3.1b"><apply id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1.2.3">𝑣</ci></apply><ci id="S3.SS4.SSS0.Px1.p1.14.m3.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.14.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.14.m3.1c">s_{v}^{j}</annotation></semantics></math> to be close.
So we use the maximum of <math id="S3.SS4.SSS0.Px1.p1.15.m4.1" class="ltx_Math" alttext="s_{w}^{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.15.m4.1a"><msubsup id="S3.SS4.SSS0.Px1.p1.15.m4.1.1" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.3.cmml">w</mi><mi id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.3" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.15.m4.1b"><apply id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1.2.3">𝑤</ci></apply><ci id="S3.SS4.SSS0.Px1.p1.15.m4.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.15.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.15.m4.1c">s_{w}^{j}</annotation></semantics></math> and <math id="S3.SS4.SSS0.Px1.p1.16.m5.1" class="ltx_Math" alttext="s_{v}^{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.16.m5.1a"><msubsup id="S3.SS4.SSS0.Px1.p1.16.m5.1.1" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.3.cmml">v</mi><mi id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.3" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.16.m5.1b"><apply id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1.2.3">𝑣</ci></apply><ci id="S3.SS4.SSS0.Px1.p1.16.m5.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.16.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.16.m5.1c">s_{v}^{j}</annotation></semantics></math> to define the similarity between <math id="S3.SS4.SSS0.Px1.p1.17.m6.2" class="ltx_Math" alttext="(\it{I}_{j},\it{T}_{j})" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.17.m6.2a"><mrow id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.3" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.3.cmml">(</mo><msub id="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.2.cmml">I</mi><mi id="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.4" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.3.cmml">,</mo><msub id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.2.cmml">T</mi><mi id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.5" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.17.m6.2b"><interval closure="open" id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2"><apply id="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.2">𝐼</ci><ci id="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.2">𝑇</ci><ci id="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.17.m6.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.17.m6.2c">(\it{I}_{j},\it{T}_{j})</annotation></semantics></math> with <math id="S3.SS4.SSS0.Px1.p1.18.m7.1" class="ltx_Math" alttext="\it{I}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.18.m7.1a"><mi id="S3.SS4.SSS0.Px1.p1.18.m7.1.1" xref="S3.SS4.SSS0.Px1.p1.18.m7.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.18.m7.1b"><ci id="S3.SS4.SSS0.Px1.p1.18.m7.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.18.m7.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.18.m7.1c">\it{I}</annotation></semantics></math>:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.3" class="ltx_Math" alttext="s_{j}=\max(s_{w}^{j},s_{v}^{j})" display="block"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml"><msub id="S3.E10.m1.3.3.4" xref="S3.E10.m1.3.3.4.cmml"><mi id="S3.E10.m1.3.3.4.2" xref="S3.E10.m1.3.3.4.2.cmml">s</mi><mi id="S3.E10.m1.3.3.4.3" xref="S3.E10.m1.3.3.4.3.cmml">j</mi></msub><mo id="S3.E10.m1.3.3.3" xref="S3.E10.m1.3.3.3.cmml">=</mo><mrow id="S3.E10.m1.3.3.2.2" xref="S3.E10.m1.3.3.2.3.cmml"><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">max</mi><mo id="S3.E10.m1.3.3.2.2a" xref="S3.E10.m1.3.3.2.3.cmml">⁡</mo><mrow id="S3.E10.m1.3.3.2.2.2" xref="S3.E10.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.2.2.2.3" xref="S3.E10.m1.3.3.2.3.cmml">(</mo><msubsup id="S3.E10.m1.2.2.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.2.2" xref="S3.E10.m1.2.2.1.1.1.1.2.2.cmml">s</mi><mi id="S3.E10.m1.2.2.1.1.1.1.2.3" xref="S3.E10.m1.2.2.1.1.1.1.2.3.cmml">w</mi><mi id="S3.E10.m1.2.2.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.E10.m1.3.3.2.2.2.4" xref="S3.E10.m1.3.3.2.3.cmml">,</mo><msubsup id="S3.E10.m1.3.3.2.2.2.2" xref="S3.E10.m1.3.3.2.2.2.2.cmml"><mi id="S3.E10.m1.3.3.2.2.2.2.2.2" xref="S3.E10.m1.3.3.2.2.2.2.2.2.cmml">s</mi><mi id="S3.E10.m1.3.3.2.2.2.2.2.3" xref="S3.E10.m1.3.3.2.2.2.2.2.3.cmml">v</mi><mi id="S3.E10.m1.3.3.2.2.2.2.3" xref="S3.E10.m1.3.3.2.2.2.2.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E10.m1.3.3.2.2.2.5" xref="S3.E10.m1.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3"><eq id="S3.E10.m1.3.3.3.cmml" xref="S3.E10.m1.3.3.3"></eq><apply id="S3.E10.m1.3.3.4.cmml" xref="S3.E10.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.4.1.cmml" xref="S3.E10.m1.3.3.4">subscript</csymbol><ci id="S3.E10.m1.3.3.4.2.cmml" xref="S3.E10.m1.3.3.4.2">𝑠</ci><ci id="S3.E10.m1.3.3.4.3.cmml" xref="S3.E10.m1.3.3.4.3">𝑗</ci></apply><apply id="S3.E10.m1.3.3.2.3.cmml" xref="S3.E10.m1.3.3.2.2"><max id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"></max><apply id="S3.E10.m1.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2.2">𝑠</ci><ci id="S3.E10.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2.3">𝑤</ci></apply><ci id="S3.E10.m1.2.2.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E10.m1.3.3.2.2.2.2.cmml" xref="S3.E10.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.2.2.2.2.1.cmml" xref="S3.E10.m1.3.3.2.2.2.2">superscript</csymbol><apply id="S3.E10.m1.3.3.2.2.2.2.2.cmml" xref="S3.E10.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.E10.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.E10.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E10.m1.3.3.2.2.2.2.2.2">𝑠</ci><ci id="S3.E10.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.E10.m1.3.3.2.2.2.2.2.3">𝑣</ci></apply><ci id="S3.E10.m1.3.3.2.2.2.2.3.cmml" xref="S3.E10.m1.3.3.2.2.2.2.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">s_{j}=\max(s_{w}^{j},s_{v}^{j})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.SSS0.Px1.p1.19" class="ltx_p">We freeze the uni-modal encoders while calculating <math id="S3.SS4.SSS0.Px1.p1.19.m1.1" class="ltx_Math" alttext="s_{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p1.19.m1.1a"><msub id="S3.SS4.SSS0.Px1.p1.19.m1.1.1" xref="S3.SS4.SSS0.Px1.p1.19.m1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.19.m1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.19.m1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p1.19.m1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.19.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.19.m1.1b"><apply id="S3.SS4.SSS0.Px1.p1.19.m1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.19.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.19.m1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.19.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.19.m1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.19.m1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p1.19.m1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.19.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.19.m1.1c">s_{j}</annotation></semantics></math>. The first reason is that ITC scores may change dramatically while fine-tuning. The second reason is representations from the pretraining dataset can be pre-computed, and similarity calculation can be conducted by Faiss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> quickly.</p>
</div>
<div id="S3.SS4.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS4.SSS0.Px1.p2.16" class="ltx_p">We first calculate top-<math id="S3.SS4.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.1.m1.1a"><mi id="S3.SS4.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.1.m1.1b"><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.1.m1.1c">r</annotation></semantics></math> <math id="S3.SS4.SSS0.Px1.p2.2.m2.2" class="ltx_Math" alttext="\{s_{w}^{j}|j\in\mathcal{R}_{w}\}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.2.m2.2a"><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3.1.cmml">{</mo><msubsup id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.3.cmml">w</mi><mi id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.4" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.2.cmml">j</mi><mo id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.1.cmml">∈</mo><msub id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.2.cmml">ℛ</mi><mi id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.3.cmml">w</mi></msub></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.5" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.2.m2.2b"><apply id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.2.3">𝑤</ci></apply><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2"><in id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.1"></in><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.2">𝑗</ci><apply id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.2">ℛ</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.2.m2.2c">\{s_{w}^{j}|j\in\mathcal{R}_{w}\}</annotation></semantics></math> among <math id="S3.SS4.SSS0.Px1.p2.3.m3.2" class="ltx_Math" alttext="\{s_{w}^{j}|j\in\mathcal{A}\}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.3.m3.2a"><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3.1.cmml">{</mo><msubsup id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.3.cmml">w</mi><mi id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.4" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.2.cmml">j</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.3.cmml">𝒜</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.5" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.3.m3.2b"><apply id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.2.3">𝑤</ci></apply><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2"><in id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.1"></in><ci id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.2">𝑗</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.3">𝒜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.3.m3.2c">\{s_{w}^{j}|j\in\mathcal{A}\}</annotation></semantics></math> and top-<math id="S3.SS4.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.4.m4.1a"><mi id="S3.SS4.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS4.SSS0.Px1.p2.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.4.m4.1b"><ci id="S3.SS4.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.4.m4.1c">r</annotation></semantics></math> <math id="S3.SS4.SSS0.Px1.p2.5.m5.2" class="ltx_Math" alttext="\{s_{v}^{j}|j\in\mathcal{R}_{v}\}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.5.m5.2a"><mrow id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.3.1.cmml">{</mo><msubsup id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.3.cmml">v</mi><mi id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.4" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.2.cmml">j</mi><mo id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.1" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.1.cmml">∈</mo><msub id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.2" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.2.cmml">ℛ</mi><mi id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.3" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.3.cmml">v</mi></msub></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.5" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.5.m5.2b"><apply id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.2.3">𝑣</ci></apply><ci id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2"><in id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.1"></in><ci id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.2">𝑗</ci><apply id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.2">ℛ</ci><ci id="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.2.2.2.2.3.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.5.m5.2c">\{s_{v}^{j}|j\in\mathcal{R}_{v}\}</annotation></semantics></math> among <math id="S3.SS4.SSS0.Px1.p2.6.m6.2" class="ltx_Math" alttext="\{s_{v}^{j}|j\in\mathcal{A}\}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.6.m6.2a"><mrow id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.3.1.cmml">{</mo><msubsup id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.3.cmml">v</mi><mi id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.4" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.2.cmml">j</mi><mo id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.1" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.3.cmml">𝒜</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.5" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.6.m6.2b"><apply id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.2.3">𝑣</ci></apply><ci id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2"><in id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.1"></in><ci id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.2">𝑗</ci><ci id="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.2.2.2.2.3">𝒜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.6.m6.2c">\{s_{v}^{j}|j\in\mathcal{A}\}</annotation></semantics></math> using Faiss.
<math id="S3.SS4.SSS0.Px1.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{R}_{w}\cup\mathcal{R}_{v}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.7.m7.1a"><mrow id="S3.SS4.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.cmml"><msub id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.2.cmml">ℛ</mi><mi id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3.cmml">w</mi></msub><mo id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.1" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.1.cmml">∪</mo><msub id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.2.cmml">ℛ</mi><mi id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.7.m7.1b"><apply id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1"><union id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.1"></union><apply id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.2">ℛ</ci><ci id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3">𝑤</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.2">ℛ</ci><ci id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.7.m7.1c">\mathcal{R}_{w}\cup\mathcal{R}_{v}</annotation></semantics></math> contains <math id="S3.SS4.SSS0.Px1.p2.8.m8.2" class="ltx_Math" alttext="[r,2r]" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.8.m8.2a"><mrow id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.2.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.2" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.2.cmml">[</mo><mi id="S3.SS4.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.cmml">r</mi><mo id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.3" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.2.cmml">,</mo><mrow id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.cmml"><mn id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.2" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.1" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.3" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.3.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.4" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.8.m8.2b"><interval closure="closed" id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1"><ci id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1">𝑟</ci><apply id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1"><times id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.1"></times><cn type="integer" id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.2">2</cn><ci id="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.2.2.1.1.3">𝑟</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.8.m8.2c">[r,2r]</annotation></semantics></math> image-text pairs.
When training, we randomly select <math id="S3.SS4.SSS0.Px1.p2.9.m9.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.9.m9.1a"><mi id="S3.SS4.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS4.SSS0.Px1.p2.9.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.9.m9.1b"><ci id="S3.SS4.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.9.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.9.m9.1c">r</annotation></semantics></math> image-text pairs from <math id="S3.SS4.SSS0.Px1.p2.10.m10.1" class="ltx_Math" alttext="\mathcal{R}_{w}\cup\mathcal{R}_{v}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.10.m10.1a"><mrow id="S3.SS4.SSS0.Px1.p2.10.m10.1.1" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.cmml"><msub id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.2.cmml">ℛ</mi><mi id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.3.cmml">w</mi></msub><mo id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.1" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.1.cmml">∪</mo><msub id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.2.cmml">ℛ</mi><mi id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.10.m10.1b"><apply id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1"><union id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.1"></union><apply id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.2">ℛ</ci><ci id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.2.3">𝑤</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.2">ℛ</ci><ci id="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m10.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.10.m10.1c">\mathcal{R}_{w}\cup\mathcal{R}_{v}</annotation></semantics></math>.
The probabilities of each image-text pair are rational to similarities <math id="S3.SS4.SSS0.Px1.p2.11.m11.1" class="ltx_Math" alttext="s^{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.11.m11.1a"><msup id="S3.SS4.SSS0.Px1.p2.11.m11.1.1" xref="S3.SS4.SSS0.Px1.p2.11.m11.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.11.m11.1.1.2" xref="S3.SS4.SSS0.Px1.p2.11.m11.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p2.11.m11.1.1.3" xref="S3.SS4.SSS0.Px1.p2.11.m11.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.11.m11.1b"><apply id="S3.SS4.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.11.m11.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.11.m11.1.1">superscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.11.m11.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.11.m11.1.1.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.11.m11.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.11.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.11.m11.1c">s^{j}</annotation></semantics></math>.
When inference, we select top-<math id="S3.SS4.SSS0.Px1.p2.12.m12.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.12.m12.1a"><mi id="S3.SS4.SSS0.Px1.p2.12.m12.1.1" xref="S3.SS4.SSS0.Px1.p2.12.m12.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.12.m12.1b"><ci id="S3.SS4.SSS0.Px1.p2.12.m12.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.12.m12.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.12.m12.1c">r</annotation></semantics></math> similar image-text pairs from <math id="S3.SS4.SSS0.Px1.p2.13.m13.1" class="ltx_Math" alttext="\mathcal{R}_{w}\cup\mathcal{R}_{v}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.13.m13.1a"><mrow id="S3.SS4.SSS0.Px1.p2.13.m13.1.1" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.cmml"><msub id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.2.cmml">ℛ</mi><mi id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.3.cmml">w</mi></msub><mo id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.1" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.1.cmml">∪</mo><msub id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.2.cmml">ℛ</mi><mi id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.13.m13.1b"><apply id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1"><union id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.1"></union><apply id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.2">ℛ</ci><ci id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.2.3">𝑤</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.2">ℛ</ci><ci id="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m13.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.13.m13.1c">\mathcal{R}_{w}\cup\mathcal{R}_{v}</annotation></semantics></math> based on <math id="S3.SS4.SSS0.Px1.p2.14.m14.1" class="ltx_Math" alttext="s^{j}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.14.m14.1a"><msup id="S3.SS4.SSS0.Px1.p2.14.m14.1.1" xref="S3.SS4.SSS0.Px1.p2.14.m14.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.14.m14.1.1.2" xref="S3.SS4.SSS0.Px1.p2.14.m14.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS0.Px1.p2.14.m14.1.1.3" xref="S3.SS4.SSS0.Px1.p2.14.m14.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.14.m14.1b"><apply id="S3.SS4.SSS0.Px1.p2.14.m14.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.14.m14.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.14.m14.1.1">superscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.14.m14.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.14.m14.1.1.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.14.m14.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.14.m14.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.14.m14.1c">s^{j}</annotation></semantics></math>.
We denote retrieved <math id="S3.SS4.SSS0.Px1.p2.15.m15.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.15.m15.1a"><mi id="S3.SS4.SSS0.Px1.p2.15.m15.1.1" xref="S3.SS4.SSS0.Px1.p2.15.m15.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.15.m15.1b"><ci id="S3.SS4.SSS0.Px1.p2.15.m15.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.15.m15.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.15.m15.1c">r</annotation></semantics></math> image-text pairs as <math id="S3.SS4.SSS0.Px1.p2.16.m16.2" class="ltx_Math" alttext="\{(\it{I}_{j},\it{T}_{j})|1\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px1.p2.16.m16.2a"><mrow id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.3.1.cmml">{</mo><mrow id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.3.cmml">(</mo><msub id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.2.cmml">I</mi><mi id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.4" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.3.cmml">,</mo><msub id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.2.cmml">T</mi><mi id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.5" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.4" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.cmml"><mn class="ltx_mathvariant_italic" mathvariant="italic" id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.2.cmml">1</mn><mo id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.4" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.5" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.6" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.5" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.16.m16.2b"><apply id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2"><apply id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.2">𝐼</ci><ci id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.2">𝑇</ci><ci id="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.1.1.1.1.2.2.3">𝑗</ci></apply></interval><apply id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2"><and id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2"><leq id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.2">1</cn><ci id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2"><leq id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px1.p2.16.m16.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.16.m16.2c">\{(\it{I}_{j},\it{T}_{j})|1\leq j\leq r\}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS4.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Retrieval fusion in multi-modal encoder</h5>

<div id="S3.SS4.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS4.SSS0.Px2.p1.14" class="ltx_p">To fuse the knowledge of retrieved samples, we propose a retrieval-attention module in the multi-modal fusion layer.
The retrieval-attention module is applied after the self-attention and cross-attention in each multi-modal fusion layer.
Figures <a href="#S3.F4" title="Figure 4 ‣ Retrieval fusion in multi-modal encoder ‣ 3.4 Retrieval-augmented Fine-tuning ‣ 3 Approach ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the model architecture of retrieval-attention applied to text modality.
Specifically, we use uni-modal encoders encode retrieved image-text pairs <math id="S3.SS4.SSS0.Px2.p1.1.m1.2" class="ltx_Math" alttext="\{(\it{I}_{j},\it{T}_{j})|1\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.1.m1.2a"><mrow id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.3.1.cmml">{</mo><mrow id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2.cmml">I</mi><mi id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.4" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.2.cmml">T</mi><mi id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.5" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.cmml"><mn class="ltx_mathvariant_italic" mathvariant="italic" id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml">1</mn><mo id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.1.m1.2b"><apply id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2"><apply id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2">𝐼</ci><ci id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.2">𝑇</ci><ci id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.3">𝑗</ci></apply></interval><apply id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.2">1</cn><ci id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.1.m1.2c">\{(\it{I}_{j},\it{T}_{j})|1\leq j\leq r\}</annotation></semantics></math> to <math id="S3.SS4.SSS0.Px2.p1.2.m2.2" class="ltx_Math" alttext="\{(\mathbf{w}_{0}^{j},\mathbf{v}_{0}^{j})|1\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.2.m2.2a"><mrow id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.3.1.cmml">{</mo><mrow id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mn id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3.cmml">0</mn><mi id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.4" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.2.cmml">𝐯</mi><mn id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.3.cmml">0</mn><mi id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.5" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.2.cmml">1</mn><mo id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.2.m2.2b"><apply id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2"><apply id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2">𝐰</ci><cn type="integer" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.2">𝐯</ci><cn type="integer" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.2.3">0</cn></apply><ci id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.1.2.2.3">𝑗</ci></apply></interval><apply id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.2">1</cn><ci id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.2.m2.2c">\{(\mathbf{w}_{0}^{j},\mathbf{v}_{0}^{j})|1\leq j\leq r\}</annotation></semantics></math>.
We denote the <math id="S3.SS4.SSS0.Px2.p1.3.m3.4" class="ltx_Math" alttext="(\mathbf{w}_{0}^{0},\mathbf{v}_{0}^{0})=(\mathbf{w}_{0},\mathbf{v}_{0})" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.3.m3.4a"><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.4.4" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.cmml"><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.3.cmml">(</mo><msubsup id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.cmml">𝐰</mi><mn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.3.cmml">0</mn><mn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml">0</mn></msubsup><mo id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.3.cmml">,</mo><msubsup id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.cmml">𝐯</mi><mn id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.cmml">0</mn><mn id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.3.cmml">)</mo></mrow><mo id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.5" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.5.cmml">=</mo><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.3.cmml">(</mo><msub id="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.2.cmml">𝐰</mi><mn id="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.3.cmml">0</mn></msub><mo id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.4" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.3.cmml">,</mo><msub id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.2.cmml">𝐯</mi><mn id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.3.cmml">0</mn></msub><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.5" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.3.m3.4b"><apply id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4"><eq id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.5.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.5"></eq><interval closure="open" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2"><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.2">𝐰</ci><cn type="integer" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.3">0</cn></apply><cn type="integer" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.3">0</cn></apply><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2">𝐯</ci><cn type="integer" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3">0</cn></apply><cn type="integer" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.3">0</cn></apply></interval><interval closure="open" id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2"><apply id="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.2">𝐰</ci><cn type="integer" id="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.3.3.3.1.1.3">0</cn></apply><apply id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.2">𝐯</ci><cn type="integer" id="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.4.4.4.2.2.3">0</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.3.m3.4c">(\mathbf{w}_{0}^{0},\mathbf{v}_{0}^{0})=(\mathbf{w}_{0},\mathbf{v}_{0})</annotation></semantics></math> for symbol unification.
For <math id="S3.SS4.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.4.m4.1a"><msup id="S3.SS4.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml">i</mi><mrow id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.2" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.1" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2">𝑖</ci><apply id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3"><times id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.1"></times><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.4.m4.1c">i^{th}</annotation></semantics></math> multi-modal fusion layer, inputs of text hidden representations are <math id="S3.SS4.SSS0.Px2.p1.5.m5.2" class="ltx_Math" alttext="\{\mathbf{w}_{i}^{j}|0\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.5.m5.2a"><mrow id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.3.1.cmml">{</mo><msubsup id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml">0</mn><mo id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.5.m5.2b"><apply id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2">0</cn><ci id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.5.m5.2c">\{\mathbf{w}_{i}^{j}|0\leq j\leq r\}</annotation></semantics></math> and image hidden representations are <math id="S3.SS4.SSS0.Px2.p1.6.m6.2" class="ltx_Math" alttext="\{\mathbf{v}_{i}^{j}|0\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.6.m6.2a"><mrow id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.3.1.cmml">{</mo><msubsup id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.3.cmml">j</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.2.cmml">0</mn><mo id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.6.m6.2b"><apply id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.2">𝐯</ci><ci id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.2">0</cn><ci id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.6.m6.2c">\{\mathbf{v}_{i}^{j}|0\leq j\leq r\}</annotation></semantics></math>.
By applying self-attention and cross-attention defined in Section <a href="#S3.SS2.SSS0.Px1" title="Multi-modal Fusion Layer ‣ 3.2 Model Architecture ‣ 3 Approach ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we obtain text representations <math id="S3.SS4.SSS0.Px2.p1.7.m7.2" class="ltx_Math" alttext="\{{\mathbf{w}_{i}^{j}}^{\prime}|0\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.7.m7.2a"><mrow id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.3.1.cmml">{</mo><mmultiscripts id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1a" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.2.cmml">0</mn><mo id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.7.m7.2b"><apply id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.1.3">′</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.2">0</cn><ci id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.7.m7.2c">\{{\mathbf{w}_{i}^{j}}^{\prime}|0\leq j\leq r\}</annotation></semantics></math> and image representations <math id="S3.SS4.SSS0.Px2.p1.8.m8.2" class="ltx_Math" alttext="\{{\mathbf{v}_{i}^{j}}^{\prime}|0\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.8.m8.2a"><mrow id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.3.1.cmml">{</mo><mmultiscripts id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.2.cmml">𝐯</mi><mi id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1a" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.2.cmml">0</mn><mo id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.8.m8.2b"><apply id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.2">𝐯</ci><ci id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.1.3">′</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.2">0</cn><ci id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.8.m8.2c">\{{\mathbf{v}_{i}^{j}}^{\prime}|0\leq j\leq r\}</annotation></semantics></math>.
Retrieval-attention is applied to each modal independently.
Takes text representations as an example, retrieval-attention uses the <math id="S3.SS4.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="\rm{[CLS]}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.9.m9.1a"><mrow id="S3.SS4.SSS0.Px2.p1.9.m9.1.2.2" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.2.1.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.9.m9.1.2.2.1" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.2.1.1.cmml">[</mo><mi id="S3.SS4.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.1.cmml">CLS</mi><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.9.m9.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.9.m9.1b"><apply id="S3.SS4.SSS0.Px2.p1.9.m9.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.9.m9.1.2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS4.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.1">CLS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.9.m9.1c">\rm{[CLS]}</annotation></semantics></math> representations of <math id="S3.SS4.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="{\mathbf{w}_{i}^{0}}^{\prime}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.10.m10.1a"><mmultiscripts id="S3.SS4.SSS0.Px2.p1.10.m10.1.1" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.3.cmml">i</mi><mn id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.3.cmml">0</mn><mrow id="S3.SS4.SSS0.Px2.p1.10.m10.1.1a" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.3" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.3.cmml">′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.10.m10.1b"><apply id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.2.3">0</cn></apply><ci id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.10.m10.1c">{\mathbf{w}_{i}^{0}}^{\prime}</annotation></semantics></math> as attention queries and <math id="S3.SS4.SSS0.Px2.p1.11.m11.1" class="ltx_Math" alttext="\rm{[CLS]}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.11.m11.1a"><mrow id="S3.SS4.SSS0.Px2.p1.11.m11.1.2.2" xref="S3.SS4.SSS0.Px2.p1.11.m11.1.2.1.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.11.m11.1.2.2.1" xref="S3.SS4.SSS0.Px2.p1.11.m11.1.2.1.1.cmml">[</mo><mi id="S3.SS4.SSS0.Px2.p1.11.m11.1.1" xref="S3.SS4.SSS0.Px2.p1.11.m11.1.1.cmml">CLS</mi><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.11.m11.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.11.m11.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.11.m11.1b"><apply id="S3.SS4.SSS0.Px2.p1.11.m11.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m11.1.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.11.m11.1.2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m11.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS4.SSS0.Px2.p1.11.m11.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m11.1.1">CLS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.11.m11.1c">\rm{[CLS]}</annotation></semantics></math> representations of <math id="S3.SS4.SSS0.Px2.p1.12.m12.2" class="ltx_Math" alttext="\{{\mathbf{w}_{i}^{j}}^{\prime}|0\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.12.m12.2a"><mrow id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.3.1.cmml">{</mo><mmultiscripts id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1a" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.2.cmml">0</mn><mo id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.12.m12.2b"><apply id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.1.1.1.1.3">′</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.2">0</cn><ci id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m12.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.12.m12.2c">\{{\mathbf{w}_{i}^{j}}^{\prime}|0\leq j\leq r\}</annotation></semantics></math> as attention keys and values.
The outputs of retrieval attention are only added to original representations <math id="S3.SS4.SSS0.Px2.p1.13.m13.1" class="ltx_Math" alttext="{\mathbf{w}_{i}^{0}}^{\prime}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.13.m13.1a"><mmultiscripts id="S3.SS4.SSS0.Px2.p1.13.m13.1.1" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.3.cmml">i</mi><mn id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.3.cmml">0</mn><mrow id="S3.SS4.SSS0.Px2.p1.13.m13.1.1a" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.3" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.3.cmml">′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.13.m13.1b"><apply id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.2.3">0</cn></apply><ci id="S3.SS4.SSS0.Px2.p1.13.m13.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m13.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.13.m13.1c">{\mathbf{w}_{i}^{0}}^{\prime}</annotation></semantics></math> but not retrieved representations <math id="S3.SS4.SSS0.Px2.p1.14.m14.2" class="ltx_Math" alttext="\{{\mathbf{w}_{i}^{j}}^{\prime}|1\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p1.14.m14.2a"><mrow id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.3.1.cmml">{</mo><mmultiscripts id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1a" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.2.cmml">1</mn><mo id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.5" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.14.m14.2b"><apply id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.1.1.1.1.3">′</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.2">1</cn><ci id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m14.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.14.m14.2c">\{{\mathbf{w}_{i}^{j}}^{\prime}|1\leq j\leq r\}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS4.SSS0.Px2.p2" class="ltx_para">
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.4" class="ltx_Math" alttext="Q^{i,r}=W_{Q}^{r}{\mathbf{w}_{i,cls}^{0}}^{\prime}" display="block"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4.5" xref="S3.E11.m1.4.5.cmml"><msup id="S3.E11.m1.4.5.2" xref="S3.E11.m1.4.5.2.cmml"><mi id="S3.E11.m1.4.5.2.2" xref="S3.E11.m1.4.5.2.2.cmml">Q</mi><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">i</mi><mo id="S3.E11.m1.2.2.2.4.1" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">r</mi></mrow></msup><mo id="S3.E11.m1.4.5.1" xref="S3.E11.m1.4.5.1.cmml">=</mo><mrow id="S3.E11.m1.4.5.3" xref="S3.E11.m1.4.5.3.cmml"><msubsup id="S3.E11.m1.4.5.3.2" xref="S3.E11.m1.4.5.3.2.cmml"><mi id="S3.E11.m1.4.5.3.2.2.2" xref="S3.E11.m1.4.5.3.2.2.2.cmml">W</mi><mi id="S3.E11.m1.4.5.3.2.2.3" xref="S3.E11.m1.4.5.3.2.2.3.cmml">Q</mi><mi id="S3.E11.m1.4.5.3.2.3" xref="S3.E11.m1.4.5.3.2.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E11.m1.4.5.3.1" xref="S3.E11.m1.4.5.3.1.cmml">​</mo><mmultiscripts id="S3.E11.m1.4.5.3.3" xref="S3.E11.m1.4.5.3.3.cmml"><mi id="S3.E11.m1.4.5.3.3.2.2.2" xref="S3.E11.m1.4.5.3.3.2.2.2.cmml">𝐰</mi><mrow id="S3.E11.m1.4.4.2.2" xref="S3.E11.m1.4.4.2.3.cmml"><mi id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml">i</mi><mo id="S3.E11.m1.4.4.2.2.2" xref="S3.E11.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E11.m1.4.4.2.2.1" xref="S3.E11.m1.4.4.2.2.1.cmml"><mi id="S3.E11.m1.4.4.2.2.1.2" xref="S3.E11.m1.4.4.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.4.4.2.2.1.1" xref="S3.E11.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E11.m1.4.4.2.2.1.3" xref="S3.E11.m1.4.4.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.4.4.2.2.1.1a" xref="S3.E11.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E11.m1.4.4.2.2.1.4" xref="S3.E11.m1.4.4.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E11.m1.4.5.3.3.2.3" xref="S3.E11.m1.4.5.3.3.2.3.cmml">0</mn><mrow id="S3.E11.m1.4.5.3.3a" xref="S3.E11.m1.4.5.3.3.cmml"></mrow><mo id="S3.E11.m1.4.5.3.3.3" xref="S3.E11.m1.4.5.3.3.3.cmml">′</mo></mmultiscripts></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.4b"><apply id="S3.E11.m1.4.5.cmml" xref="S3.E11.m1.4.5"><eq id="S3.E11.m1.4.5.1.cmml" xref="S3.E11.m1.4.5.1"></eq><apply id="S3.E11.m1.4.5.2.cmml" xref="S3.E11.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.5.2.1.cmml" xref="S3.E11.m1.4.5.2">superscript</csymbol><ci id="S3.E11.m1.4.5.2.2.cmml" xref="S3.E11.m1.4.5.2.2">𝑄</ci><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑖</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">𝑟</ci></list></apply><apply id="S3.E11.m1.4.5.3.cmml" xref="S3.E11.m1.4.5.3"><times id="S3.E11.m1.4.5.3.1.cmml" xref="S3.E11.m1.4.5.3.1"></times><apply id="S3.E11.m1.4.5.3.2.cmml" xref="S3.E11.m1.4.5.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.5.3.2.1.cmml" xref="S3.E11.m1.4.5.3.2">superscript</csymbol><apply id="S3.E11.m1.4.5.3.2.2.cmml" xref="S3.E11.m1.4.5.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.5.3.2.2.1.cmml" xref="S3.E11.m1.4.5.3.2">subscript</csymbol><ci id="S3.E11.m1.4.5.3.2.2.2.cmml" xref="S3.E11.m1.4.5.3.2.2.2">𝑊</ci><ci id="S3.E11.m1.4.5.3.2.2.3.cmml" xref="S3.E11.m1.4.5.3.2.2.3">𝑄</ci></apply><ci id="S3.E11.m1.4.5.3.2.3.cmml" xref="S3.E11.m1.4.5.3.2.3">𝑟</ci></apply><apply id="S3.E11.m1.4.5.3.3.cmml" xref="S3.E11.m1.4.5.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.5.3.3.1.cmml" xref="S3.E11.m1.4.5.3.3">superscript</csymbol><apply id="S3.E11.m1.4.5.3.3.2.cmml" xref="S3.E11.m1.4.5.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.5.3.3.2.1.cmml" xref="S3.E11.m1.4.5.3.3">superscript</csymbol><apply id="S3.E11.m1.4.5.3.3.2.2.cmml" xref="S3.E11.m1.4.5.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.5.3.3.2.2.1.cmml" xref="S3.E11.m1.4.5.3.3">subscript</csymbol><ci id="S3.E11.m1.4.5.3.3.2.2.2.cmml" xref="S3.E11.m1.4.5.3.3.2.2.2">𝐰</ci><list id="S3.E11.m1.4.4.2.3.cmml" xref="S3.E11.m1.4.4.2.2"><ci id="S3.E11.m1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1.1">𝑖</ci><apply id="S3.E11.m1.4.4.2.2.1.cmml" xref="S3.E11.m1.4.4.2.2.1"><times id="S3.E11.m1.4.4.2.2.1.1.cmml" xref="S3.E11.m1.4.4.2.2.1.1"></times><ci id="S3.E11.m1.4.4.2.2.1.2.cmml" xref="S3.E11.m1.4.4.2.2.1.2">𝑐</ci><ci id="S3.E11.m1.4.4.2.2.1.3.cmml" xref="S3.E11.m1.4.4.2.2.1.3">𝑙</ci><ci id="S3.E11.m1.4.4.2.2.1.4.cmml" xref="S3.E11.m1.4.4.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E11.m1.4.5.3.3.2.3.cmml" xref="S3.E11.m1.4.5.3.3.2.3">0</cn></apply><ci id="S3.E11.m1.4.5.3.3.3.cmml" xref="S3.E11.m1.4.5.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.4c">Q^{i,r}=W_{Q}^{r}{\mathbf{w}_{i,cls}^{0}}^{\prime}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.12" class="ltx_Math" alttext="K^{i,r}=W_{K}^{r}[{\mathbf{w}_{i,cls}^{0}}^{\prime},{\mathbf{w}_{i,cls}^{1}}^{\prime},...,{\mathbf{w}_{i,cls}^{r}}^{\prime}]" display="block"><semantics id="S3.E12.m1.12a"><mrow id="S3.E12.m1.12.12" xref="S3.E12.m1.12.12.cmml"><msup id="S3.E12.m1.12.12.5" xref="S3.E12.m1.12.12.5.cmml"><mi id="S3.E12.m1.12.12.5.2" xref="S3.E12.m1.12.12.5.2.cmml">K</mi><mrow id="S3.E12.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">i</mi><mo id="S3.E12.m1.2.2.2.4.1" xref="S3.E12.m1.2.2.2.3.cmml">,</mo><mi id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.cmml">r</mi></mrow></msup><mo id="S3.E12.m1.12.12.4" xref="S3.E12.m1.12.12.4.cmml">=</mo><mrow id="S3.E12.m1.12.12.3" xref="S3.E12.m1.12.12.3.cmml"><msubsup id="S3.E12.m1.12.12.3.5" xref="S3.E12.m1.12.12.3.5.cmml"><mi id="S3.E12.m1.12.12.3.5.2.2" xref="S3.E12.m1.12.12.3.5.2.2.cmml">W</mi><mi id="S3.E12.m1.12.12.3.5.2.3" xref="S3.E12.m1.12.12.3.5.2.3.cmml">K</mi><mi id="S3.E12.m1.12.12.3.5.3" xref="S3.E12.m1.12.12.3.5.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E12.m1.12.12.3.4" xref="S3.E12.m1.12.12.3.4.cmml">​</mo><mrow id="S3.E12.m1.12.12.3.3.3" xref="S3.E12.m1.12.12.3.3.4.cmml"><mo stretchy="false" id="S3.E12.m1.12.12.3.3.3.4" xref="S3.E12.m1.12.12.3.3.4.cmml">[</mo><mmultiscripts id="S3.E12.m1.10.10.1.1.1.1" xref="S3.E12.m1.10.10.1.1.1.1.cmml"><mi id="S3.E12.m1.10.10.1.1.1.1.2.2.2" xref="S3.E12.m1.10.10.1.1.1.1.2.2.2.cmml">𝐰</mi><mrow id="S3.E12.m1.4.4.2.2" xref="S3.E12.m1.4.4.2.3.cmml"><mi id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml">i</mi><mo id="S3.E12.m1.4.4.2.2.2" xref="S3.E12.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E12.m1.4.4.2.2.1" xref="S3.E12.m1.4.4.2.2.1.cmml"><mi id="S3.E12.m1.4.4.2.2.1.2" xref="S3.E12.m1.4.4.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.2.2.1.1" xref="S3.E12.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E12.m1.4.4.2.2.1.3" xref="S3.E12.m1.4.4.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.2.2.1.1a" xref="S3.E12.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E12.m1.4.4.2.2.1.4" xref="S3.E12.m1.4.4.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E12.m1.10.10.1.1.1.1.2.3" xref="S3.E12.m1.10.10.1.1.1.1.2.3.cmml">0</mn><mrow id="S3.E12.m1.10.10.1.1.1.1a" xref="S3.E12.m1.10.10.1.1.1.1.cmml"></mrow><mo id="S3.E12.m1.10.10.1.1.1.1.3" xref="S3.E12.m1.10.10.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo id="S3.E12.m1.12.12.3.3.3.5" xref="S3.E12.m1.12.12.3.3.4.cmml">,</mo><mmultiscripts id="S3.E12.m1.11.11.2.2.2.2" xref="S3.E12.m1.11.11.2.2.2.2.cmml"><mi id="S3.E12.m1.11.11.2.2.2.2.2.2.2" xref="S3.E12.m1.11.11.2.2.2.2.2.2.2.cmml">𝐰</mi><mrow id="S3.E12.m1.6.6.2.2" xref="S3.E12.m1.6.6.2.3.cmml"><mi id="S3.E12.m1.5.5.1.1" xref="S3.E12.m1.5.5.1.1.cmml">i</mi><mo id="S3.E12.m1.6.6.2.2.2" xref="S3.E12.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E12.m1.6.6.2.2.1" xref="S3.E12.m1.6.6.2.2.1.cmml"><mi id="S3.E12.m1.6.6.2.2.1.2" xref="S3.E12.m1.6.6.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.6.6.2.2.1.1" xref="S3.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E12.m1.6.6.2.2.1.3" xref="S3.E12.m1.6.6.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.6.6.2.2.1.1a" xref="S3.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E12.m1.6.6.2.2.1.4" xref="S3.E12.m1.6.6.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E12.m1.11.11.2.2.2.2.2.3" xref="S3.E12.m1.11.11.2.2.2.2.2.3.cmml">1</mn><mrow id="S3.E12.m1.11.11.2.2.2.2a" xref="S3.E12.m1.11.11.2.2.2.2.cmml"></mrow><mo id="S3.E12.m1.11.11.2.2.2.2.3" xref="S3.E12.m1.11.11.2.2.2.2.3.cmml">′</mo></mmultiscripts><mo id="S3.E12.m1.12.12.3.3.3.6" xref="S3.E12.m1.12.12.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E12.m1.9.9" xref="S3.E12.m1.9.9.cmml">…</mi><mo id="S3.E12.m1.12.12.3.3.3.7" xref="S3.E12.m1.12.12.3.3.4.cmml">,</mo><mmultiscripts id="S3.E12.m1.12.12.3.3.3.3" xref="S3.E12.m1.12.12.3.3.3.3.cmml"><mi id="S3.E12.m1.12.12.3.3.3.3.2.2.2" xref="S3.E12.m1.12.12.3.3.3.3.2.2.2.cmml">𝐰</mi><mrow id="S3.E12.m1.8.8.2.2" xref="S3.E12.m1.8.8.2.3.cmml"><mi id="S3.E12.m1.7.7.1.1" xref="S3.E12.m1.7.7.1.1.cmml">i</mi><mo id="S3.E12.m1.8.8.2.2.2" xref="S3.E12.m1.8.8.2.3.cmml">,</mo><mrow id="S3.E12.m1.8.8.2.2.1" xref="S3.E12.m1.8.8.2.2.1.cmml"><mi id="S3.E12.m1.8.8.2.2.1.2" xref="S3.E12.m1.8.8.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.8.8.2.2.1.1" xref="S3.E12.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E12.m1.8.8.2.2.1.3" xref="S3.E12.m1.8.8.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.8.8.2.2.1.1a" xref="S3.E12.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E12.m1.8.8.2.2.1.4" xref="S3.E12.m1.8.8.2.2.1.4.cmml">s</mi></mrow></mrow><mi id="S3.E12.m1.12.12.3.3.3.3.2.3" xref="S3.E12.m1.12.12.3.3.3.3.2.3.cmml">r</mi><mrow id="S3.E12.m1.12.12.3.3.3.3a" xref="S3.E12.m1.12.12.3.3.3.3.cmml"></mrow><mo id="S3.E12.m1.12.12.3.3.3.3.3" xref="S3.E12.m1.12.12.3.3.3.3.3.cmml">′</mo></mmultiscripts><mo stretchy="false" id="S3.E12.m1.12.12.3.3.3.8" xref="S3.E12.m1.12.12.3.3.4.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.12b"><apply id="S3.E12.m1.12.12.cmml" xref="S3.E12.m1.12.12"><eq id="S3.E12.m1.12.12.4.cmml" xref="S3.E12.m1.12.12.4"></eq><apply id="S3.E12.m1.12.12.5.cmml" xref="S3.E12.m1.12.12.5"><csymbol cd="ambiguous" id="S3.E12.m1.12.12.5.1.cmml" xref="S3.E12.m1.12.12.5">superscript</csymbol><ci id="S3.E12.m1.12.12.5.2.cmml" xref="S3.E12.m1.12.12.5.2">𝐾</ci><list id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.4"><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑖</ci><ci id="S3.E12.m1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2">𝑟</ci></list></apply><apply id="S3.E12.m1.12.12.3.cmml" xref="S3.E12.m1.12.12.3"><times id="S3.E12.m1.12.12.3.4.cmml" xref="S3.E12.m1.12.12.3.4"></times><apply id="S3.E12.m1.12.12.3.5.cmml" xref="S3.E12.m1.12.12.3.5"><csymbol cd="ambiguous" id="S3.E12.m1.12.12.3.5.1.cmml" xref="S3.E12.m1.12.12.3.5">superscript</csymbol><apply id="S3.E12.m1.12.12.3.5.2.cmml" xref="S3.E12.m1.12.12.3.5"><csymbol cd="ambiguous" id="S3.E12.m1.12.12.3.5.2.1.cmml" xref="S3.E12.m1.12.12.3.5">subscript</csymbol><ci id="S3.E12.m1.12.12.3.5.2.2.cmml" xref="S3.E12.m1.12.12.3.5.2.2">𝑊</ci><ci id="S3.E12.m1.12.12.3.5.2.3.cmml" xref="S3.E12.m1.12.12.3.5.2.3">𝐾</ci></apply><ci id="S3.E12.m1.12.12.3.5.3.cmml" xref="S3.E12.m1.12.12.3.5.3">𝑟</ci></apply><list id="S3.E12.m1.12.12.3.3.4.cmml" xref="S3.E12.m1.12.12.3.3.3"><apply id="S3.E12.m1.10.10.1.1.1.1.cmml" xref="S3.E12.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.10.10.1.1.1.1.1.cmml" xref="S3.E12.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.10.10.1.1.1.1.2.cmml" xref="S3.E12.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.10.10.1.1.1.1.2.1.cmml" xref="S3.E12.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.10.10.1.1.1.1.2.2.cmml" xref="S3.E12.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.10.10.1.1.1.1.2.2.1.cmml" xref="S3.E12.m1.10.10.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.10.10.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.10.10.1.1.1.1.2.2.2">𝐰</ci><list id="S3.E12.m1.4.4.2.3.cmml" xref="S3.E12.m1.4.4.2.2"><ci id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1.1">𝑖</ci><apply id="S3.E12.m1.4.4.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.1"><times id="S3.E12.m1.4.4.2.2.1.1.cmml" xref="S3.E12.m1.4.4.2.2.1.1"></times><ci id="S3.E12.m1.4.4.2.2.1.2.cmml" xref="S3.E12.m1.4.4.2.2.1.2">𝑐</ci><ci id="S3.E12.m1.4.4.2.2.1.3.cmml" xref="S3.E12.m1.4.4.2.2.1.3">𝑙</ci><ci id="S3.E12.m1.4.4.2.2.1.4.cmml" xref="S3.E12.m1.4.4.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E12.m1.10.10.1.1.1.1.2.3.cmml" xref="S3.E12.m1.10.10.1.1.1.1.2.3">0</cn></apply><ci id="S3.E12.m1.10.10.1.1.1.1.3.cmml" xref="S3.E12.m1.10.10.1.1.1.1.3">′</ci></apply><apply id="S3.E12.m1.11.11.2.2.2.2.cmml" xref="S3.E12.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.11.11.2.2.2.2.1.cmml" xref="S3.E12.m1.11.11.2.2.2.2">superscript</csymbol><apply id="S3.E12.m1.11.11.2.2.2.2.2.cmml" xref="S3.E12.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.11.11.2.2.2.2.2.1.cmml" xref="S3.E12.m1.11.11.2.2.2.2">superscript</csymbol><apply id="S3.E12.m1.11.11.2.2.2.2.2.2.cmml" xref="S3.E12.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.11.11.2.2.2.2.2.2.1.cmml" xref="S3.E12.m1.11.11.2.2.2.2">subscript</csymbol><ci id="S3.E12.m1.11.11.2.2.2.2.2.2.2.cmml" xref="S3.E12.m1.11.11.2.2.2.2.2.2.2">𝐰</ci><list id="S3.E12.m1.6.6.2.3.cmml" xref="S3.E12.m1.6.6.2.2"><ci id="S3.E12.m1.5.5.1.1.cmml" xref="S3.E12.m1.5.5.1.1">𝑖</ci><apply id="S3.E12.m1.6.6.2.2.1.cmml" xref="S3.E12.m1.6.6.2.2.1"><times id="S3.E12.m1.6.6.2.2.1.1.cmml" xref="S3.E12.m1.6.6.2.2.1.1"></times><ci id="S3.E12.m1.6.6.2.2.1.2.cmml" xref="S3.E12.m1.6.6.2.2.1.2">𝑐</ci><ci id="S3.E12.m1.6.6.2.2.1.3.cmml" xref="S3.E12.m1.6.6.2.2.1.3">𝑙</ci><ci id="S3.E12.m1.6.6.2.2.1.4.cmml" xref="S3.E12.m1.6.6.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E12.m1.11.11.2.2.2.2.2.3.cmml" xref="S3.E12.m1.11.11.2.2.2.2.2.3">1</cn></apply><ci id="S3.E12.m1.11.11.2.2.2.2.3.cmml" xref="S3.E12.m1.11.11.2.2.2.2.3">′</ci></apply><ci id="S3.E12.m1.9.9.cmml" xref="S3.E12.m1.9.9">…</ci><apply id="S3.E12.m1.12.12.3.3.3.3.cmml" xref="S3.E12.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.12.12.3.3.3.3.1.cmml" xref="S3.E12.m1.12.12.3.3.3.3">superscript</csymbol><apply id="S3.E12.m1.12.12.3.3.3.3.2.cmml" xref="S3.E12.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.12.12.3.3.3.3.2.1.cmml" xref="S3.E12.m1.12.12.3.3.3.3">superscript</csymbol><apply id="S3.E12.m1.12.12.3.3.3.3.2.2.cmml" xref="S3.E12.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.12.12.3.3.3.3.2.2.1.cmml" xref="S3.E12.m1.12.12.3.3.3.3">subscript</csymbol><ci id="S3.E12.m1.12.12.3.3.3.3.2.2.2.cmml" xref="S3.E12.m1.12.12.3.3.3.3.2.2.2">𝐰</ci><list id="S3.E12.m1.8.8.2.3.cmml" xref="S3.E12.m1.8.8.2.2"><ci id="S3.E12.m1.7.7.1.1.cmml" xref="S3.E12.m1.7.7.1.1">𝑖</ci><apply id="S3.E12.m1.8.8.2.2.1.cmml" xref="S3.E12.m1.8.8.2.2.1"><times id="S3.E12.m1.8.8.2.2.1.1.cmml" xref="S3.E12.m1.8.8.2.2.1.1"></times><ci id="S3.E12.m1.8.8.2.2.1.2.cmml" xref="S3.E12.m1.8.8.2.2.1.2">𝑐</ci><ci id="S3.E12.m1.8.8.2.2.1.3.cmml" xref="S3.E12.m1.8.8.2.2.1.3">𝑙</ci><ci id="S3.E12.m1.8.8.2.2.1.4.cmml" xref="S3.E12.m1.8.8.2.2.1.4">𝑠</ci></apply></list></apply><ci id="S3.E12.m1.12.12.3.3.3.3.2.3.cmml" xref="S3.E12.m1.12.12.3.3.3.3.2.3">𝑟</ci></apply><ci id="S3.E12.m1.12.12.3.3.3.3.3.cmml" xref="S3.E12.m1.12.12.3.3.3.3.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.12c">K^{i,r}=W_{K}^{r}[{\mathbf{w}_{i,cls}^{0}}^{\prime},{\mathbf{w}_{i,cls}^{1}}^{\prime},...,{\mathbf{w}_{i,cls}^{r}}^{\prime}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.12" class="ltx_Math" alttext="V^{i,r}=W_{V}^{r}[{\mathbf{w}_{i,cls}^{0}}^{\prime},{\mathbf{w}_{i,cls}^{1}}^{\prime},...,{\mathbf{w}_{i,cls}^{r}}^{\prime}]" display="block"><semantics id="S3.E13.m1.12a"><mrow id="S3.E13.m1.12.12" xref="S3.E13.m1.12.12.cmml"><msup id="S3.E13.m1.12.12.5" xref="S3.E13.m1.12.12.5.cmml"><mi id="S3.E13.m1.12.12.5.2" xref="S3.E13.m1.12.12.5.2.cmml">V</mi><mrow id="S3.E13.m1.2.2.2.4" xref="S3.E13.m1.2.2.2.3.cmml"><mi id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml">i</mi><mo id="S3.E13.m1.2.2.2.4.1" xref="S3.E13.m1.2.2.2.3.cmml">,</mo><mi id="S3.E13.m1.2.2.2.2" xref="S3.E13.m1.2.2.2.2.cmml">r</mi></mrow></msup><mo id="S3.E13.m1.12.12.4" xref="S3.E13.m1.12.12.4.cmml">=</mo><mrow id="S3.E13.m1.12.12.3" xref="S3.E13.m1.12.12.3.cmml"><msubsup id="S3.E13.m1.12.12.3.5" xref="S3.E13.m1.12.12.3.5.cmml"><mi id="S3.E13.m1.12.12.3.5.2.2" xref="S3.E13.m1.12.12.3.5.2.2.cmml">W</mi><mi id="S3.E13.m1.12.12.3.5.2.3" xref="S3.E13.m1.12.12.3.5.2.3.cmml">V</mi><mi id="S3.E13.m1.12.12.3.5.3" xref="S3.E13.m1.12.12.3.5.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E13.m1.12.12.3.4" xref="S3.E13.m1.12.12.3.4.cmml">​</mo><mrow id="S3.E13.m1.12.12.3.3.3" xref="S3.E13.m1.12.12.3.3.4.cmml"><mo stretchy="false" id="S3.E13.m1.12.12.3.3.3.4" xref="S3.E13.m1.12.12.3.3.4.cmml">[</mo><mmultiscripts id="S3.E13.m1.10.10.1.1.1.1" xref="S3.E13.m1.10.10.1.1.1.1.cmml"><mi id="S3.E13.m1.10.10.1.1.1.1.2.2.2" xref="S3.E13.m1.10.10.1.1.1.1.2.2.2.cmml">𝐰</mi><mrow id="S3.E13.m1.4.4.2.2" xref="S3.E13.m1.4.4.2.3.cmml"><mi id="S3.E13.m1.3.3.1.1" xref="S3.E13.m1.3.3.1.1.cmml">i</mi><mo id="S3.E13.m1.4.4.2.2.2" xref="S3.E13.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E13.m1.4.4.2.2.1" xref="S3.E13.m1.4.4.2.2.1.cmml"><mi id="S3.E13.m1.4.4.2.2.1.2" xref="S3.E13.m1.4.4.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.2.2.1.1" xref="S3.E13.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E13.m1.4.4.2.2.1.3" xref="S3.E13.m1.4.4.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.2.2.1.1a" xref="S3.E13.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E13.m1.4.4.2.2.1.4" xref="S3.E13.m1.4.4.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E13.m1.10.10.1.1.1.1.2.3" xref="S3.E13.m1.10.10.1.1.1.1.2.3.cmml">0</mn><mrow id="S3.E13.m1.10.10.1.1.1.1a" xref="S3.E13.m1.10.10.1.1.1.1.cmml"></mrow><mo id="S3.E13.m1.10.10.1.1.1.1.3" xref="S3.E13.m1.10.10.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo id="S3.E13.m1.12.12.3.3.3.5" xref="S3.E13.m1.12.12.3.3.4.cmml">,</mo><mmultiscripts id="S3.E13.m1.11.11.2.2.2.2" xref="S3.E13.m1.11.11.2.2.2.2.cmml"><mi id="S3.E13.m1.11.11.2.2.2.2.2.2.2" xref="S3.E13.m1.11.11.2.2.2.2.2.2.2.cmml">𝐰</mi><mrow id="S3.E13.m1.6.6.2.2" xref="S3.E13.m1.6.6.2.3.cmml"><mi id="S3.E13.m1.5.5.1.1" xref="S3.E13.m1.5.5.1.1.cmml">i</mi><mo id="S3.E13.m1.6.6.2.2.2" xref="S3.E13.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E13.m1.6.6.2.2.1" xref="S3.E13.m1.6.6.2.2.1.cmml"><mi id="S3.E13.m1.6.6.2.2.1.2" xref="S3.E13.m1.6.6.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.6.6.2.2.1.1" xref="S3.E13.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E13.m1.6.6.2.2.1.3" xref="S3.E13.m1.6.6.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.6.6.2.2.1.1a" xref="S3.E13.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E13.m1.6.6.2.2.1.4" xref="S3.E13.m1.6.6.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E13.m1.11.11.2.2.2.2.2.3" xref="S3.E13.m1.11.11.2.2.2.2.2.3.cmml">1</mn><mrow id="S3.E13.m1.11.11.2.2.2.2a" xref="S3.E13.m1.11.11.2.2.2.2.cmml"></mrow><mo id="S3.E13.m1.11.11.2.2.2.2.3" xref="S3.E13.m1.11.11.2.2.2.2.3.cmml">′</mo></mmultiscripts><mo id="S3.E13.m1.12.12.3.3.3.6" xref="S3.E13.m1.12.12.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E13.m1.9.9" xref="S3.E13.m1.9.9.cmml">…</mi><mo id="S3.E13.m1.12.12.3.3.3.7" xref="S3.E13.m1.12.12.3.3.4.cmml">,</mo><mmultiscripts id="S3.E13.m1.12.12.3.3.3.3" xref="S3.E13.m1.12.12.3.3.3.3.cmml"><mi id="S3.E13.m1.12.12.3.3.3.3.2.2.2" xref="S3.E13.m1.12.12.3.3.3.3.2.2.2.cmml">𝐰</mi><mrow id="S3.E13.m1.8.8.2.2" xref="S3.E13.m1.8.8.2.3.cmml"><mi id="S3.E13.m1.7.7.1.1" xref="S3.E13.m1.7.7.1.1.cmml">i</mi><mo id="S3.E13.m1.8.8.2.2.2" xref="S3.E13.m1.8.8.2.3.cmml">,</mo><mrow id="S3.E13.m1.8.8.2.2.1" xref="S3.E13.m1.8.8.2.2.1.cmml"><mi id="S3.E13.m1.8.8.2.2.1.2" xref="S3.E13.m1.8.8.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.8.8.2.2.1.1" xref="S3.E13.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E13.m1.8.8.2.2.1.3" xref="S3.E13.m1.8.8.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.8.8.2.2.1.1a" xref="S3.E13.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E13.m1.8.8.2.2.1.4" xref="S3.E13.m1.8.8.2.2.1.4.cmml">s</mi></mrow></mrow><mi id="S3.E13.m1.12.12.3.3.3.3.2.3" xref="S3.E13.m1.12.12.3.3.3.3.2.3.cmml">r</mi><mrow id="S3.E13.m1.12.12.3.3.3.3a" xref="S3.E13.m1.12.12.3.3.3.3.cmml"></mrow><mo id="S3.E13.m1.12.12.3.3.3.3.3" xref="S3.E13.m1.12.12.3.3.3.3.3.cmml">′</mo></mmultiscripts><mo stretchy="false" id="S3.E13.m1.12.12.3.3.3.8" xref="S3.E13.m1.12.12.3.3.4.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.12b"><apply id="S3.E13.m1.12.12.cmml" xref="S3.E13.m1.12.12"><eq id="S3.E13.m1.12.12.4.cmml" xref="S3.E13.m1.12.12.4"></eq><apply id="S3.E13.m1.12.12.5.cmml" xref="S3.E13.m1.12.12.5"><csymbol cd="ambiguous" id="S3.E13.m1.12.12.5.1.cmml" xref="S3.E13.m1.12.12.5">superscript</csymbol><ci id="S3.E13.m1.12.12.5.2.cmml" xref="S3.E13.m1.12.12.5.2">𝑉</ci><list id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.4"><ci id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1">𝑖</ci><ci id="S3.E13.m1.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2">𝑟</ci></list></apply><apply id="S3.E13.m1.12.12.3.cmml" xref="S3.E13.m1.12.12.3"><times id="S3.E13.m1.12.12.3.4.cmml" xref="S3.E13.m1.12.12.3.4"></times><apply id="S3.E13.m1.12.12.3.5.cmml" xref="S3.E13.m1.12.12.3.5"><csymbol cd="ambiguous" id="S3.E13.m1.12.12.3.5.1.cmml" xref="S3.E13.m1.12.12.3.5">superscript</csymbol><apply id="S3.E13.m1.12.12.3.5.2.cmml" xref="S3.E13.m1.12.12.3.5"><csymbol cd="ambiguous" id="S3.E13.m1.12.12.3.5.2.1.cmml" xref="S3.E13.m1.12.12.3.5">subscript</csymbol><ci id="S3.E13.m1.12.12.3.5.2.2.cmml" xref="S3.E13.m1.12.12.3.5.2.2">𝑊</ci><ci id="S3.E13.m1.12.12.3.5.2.3.cmml" xref="S3.E13.m1.12.12.3.5.2.3">𝑉</ci></apply><ci id="S3.E13.m1.12.12.3.5.3.cmml" xref="S3.E13.m1.12.12.3.5.3">𝑟</ci></apply><list id="S3.E13.m1.12.12.3.3.4.cmml" xref="S3.E13.m1.12.12.3.3.3"><apply id="S3.E13.m1.10.10.1.1.1.1.cmml" xref="S3.E13.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.1.1.1.1.1.cmml" xref="S3.E13.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E13.m1.10.10.1.1.1.1.2.cmml" xref="S3.E13.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.1.1.1.1.2.1.cmml" xref="S3.E13.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E13.m1.10.10.1.1.1.1.2.2.cmml" xref="S3.E13.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.1.1.1.1.2.2.1.cmml" xref="S3.E13.m1.10.10.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.10.10.1.1.1.1.2.2.2.cmml" xref="S3.E13.m1.10.10.1.1.1.1.2.2.2">𝐰</ci><list id="S3.E13.m1.4.4.2.3.cmml" xref="S3.E13.m1.4.4.2.2"><ci id="S3.E13.m1.3.3.1.1.cmml" xref="S3.E13.m1.3.3.1.1">𝑖</ci><apply id="S3.E13.m1.4.4.2.2.1.cmml" xref="S3.E13.m1.4.4.2.2.1"><times id="S3.E13.m1.4.4.2.2.1.1.cmml" xref="S3.E13.m1.4.4.2.2.1.1"></times><ci id="S3.E13.m1.4.4.2.2.1.2.cmml" xref="S3.E13.m1.4.4.2.2.1.2">𝑐</ci><ci id="S3.E13.m1.4.4.2.2.1.3.cmml" xref="S3.E13.m1.4.4.2.2.1.3">𝑙</ci><ci id="S3.E13.m1.4.4.2.2.1.4.cmml" xref="S3.E13.m1.4.4.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E13.m1.10.10.1.1.1.1.2.3.cmml" xref="S3.E13.m1.10.10.1.1.1.1.2.3">0</cn></apply><ci id="S3.E13.m1.10.10.1.1.1.1.3.cmml" xref="S3.E13.m1.10.10.1.1.1.1.3">′</ci></apply><apply id="S3.E13.m1.11.11.2.2.2.2.cmml" xref="S3.E13.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.2.2.2.2.1.cmml" xref="S3.E13.m1.11.11.2.2.2.2">superscript</csymbol><apply id="S3.E13.m1.11.11.2.2.2.2.2.cmml" xref="S3.E13.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.2.2.2.2.2.1.cmml" xref="S3.E13.m1.11.11.2.2.2.2">superscript</csymbol><apply id="S3.E13.m1.11.11.2.2.2.2.2.2.cmml" xref="S3.E13.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.2.2.2.2.2.2.1.cmml" xref="S3.E13.m1.11.11.2.2.2.2">subscript</csymbol><ci id="S3.E13.m1.11.11.2.2.2.2.2.2.2.cmml" xref="S3.E13.m1.11.11.2.2.2.2.2.2.2">𝐰</ci><list id="S3.E13.m1.6.6.2.3.cmml" xref="S3.E13.m1.6.6.2.2"><ci id="S3.E13.m1.5.5.1.1.cmml" xref="S3.E13.m1.5.5.1.1">𝑖</ci><apply id="S3.E13.m1.6.6.2.2.1.cmml" xref="S3.E13.m1.6.6.2.2.1"><times id="S3.E13.m1.6.6.2.2.1.1.cmml" xref="S3.E13.m1.6.6.2.2.1.1"></times><ci id="S3.E13.m1.6.6.2.2.1.2.cmml" xref="S3.E13.m1.6.6.2.2.1.2">𝑐</ci><ci id="S3.E13.m1.6.6.2.2.1.3.cmml" xref="S3.E13.m1.6.6.2.2.1.3">𝑙</ci><ci id="S3.E13.m1.6.6.2.2.1.4.cmml" xref="S3.E13.m1.6.6.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E13.m1.11.11.2.2.2.2.2.3.cmml" xref="S3.E13.m1.11.11.2.2.2.2.2.3">1</cn></apply><ci id="S3.E13.m1.11.11.2.2.2.2.3.cmml" xref="S3.E13.m1.11.11.2.2.2.2.3">′</ci></apply><ci id="S3.E13.m1.9.9.cmml" xref="S3.E13.m1.9.9">…</ci><apply id="S3.E13.m1.12.12.3.3.3.3.cmml" xref="S3.E13.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.12.12.3.3.3.3.1.cmml" xref="S3.E13.m1.12.12.3.3.3.3">superscript</csymbol><apply id="S3.E13.m1.12.12.3.3.3.3.2.cmml" xref="S3.E13.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.12.12.3.3.3.3.2.1.cmml" xref="S3.E13.m1.12.12.3.3.3.3">superscript</csymbol><apply id="S3.E13.m1.12.12.3.3.3.3.2.2.cmml" xref="S3.E13.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.12.12.3.3.3.3.2.2.1.cmml" xref="S3.E13.m1.12.12.3.3.3.3">subscript</csymbol><ci id="S3.E13.m1.12.12.3.3.3.3.2.2.2.cmml" xref="S3.E13.m1.12.12.3.3.3.3.2.2.2">𝐰</ci><list id="S3.E13.m1.8.8.2.3.cmml" xref="S3.E13.m1.8.8.2.2"><ci id="S3.E13.m1.7.7.1.1.cmml" xref="S3.E13.m1.7.7.1.1">𝑖</ci><apply id="S3.E13.m1.8.8.2.2.1.cmml" xref="S3.E13.m1.8.8.2.2.1"><times id="S3.E13.m1.8.8.2.2.1.1.cmml" xref="S3.E13.m1.8.8.2.2.1.1"></times><ci id="S3.E13.m1.8.8.2.2.1.2.cmml" xref="S3.E13.m1.8.8.2.2.1.2">𝑐</ci><ci id="S3.E13.m1.8.8.2.2.1.3.cmml" xref="S3.E13.m1.8.8.2.2.1.3">𝑙</ci><ci id="S3.E13.m1.8.8.2.2.1.4.cmml" xref="S3.E13.m1.8.8.2.2.1.4">𝑠</ci></apply></list></apply><ci id="S3.E13.m1.12.12.3.3.3.3.2.3.cmml" xref="S3.E13.m1.12.12.3.3.3.3.2.3">𝑟</ci></apply><ci id="S3.E13.m1.12.12.3.3.3.3.3.cmml" xref="S3.E13.m1.12.12.3.3.3.3.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.12c">V^{i,r}=W_{V}^{r}[{\mathbf{w}_{i,cls}^{0}}^{\prime},{\mathbf{w}_{i,cls}^{1}}^{\prime},...,{\mathbf{w}_{i,cls}^{r}}^{\prime}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.6" class="ltx_Math" alttext="{\mathbf{w}_{i+1,cls}^{j}}=\begin{cases}{\mathbf{w}_{i,cls}^{j}}^{\prime}+\mathrm{Attn}(Q^{i,r},K^{i,r},V^{i,r}),&amp;j=0\\
{\mathbf{w}_{i,cls}^{j}}^{\prime},&amp;j&gt;0\end{cases}" display="block"><semantics id="S3.E14.m1.6a"><mrow id="S3.E14.m1.6.7" xref="S3.E14.m1.6.7.cmml"><msubsup id="S3.E14.m1.6.7.2" xref="S3.E14.m1.6.7.2.cmml"><mi id="S3.E14.m1.6.7.2.2.2" xref="S3.E14.m1.6.7.2.2.2.cmml">𝐰</mi><mrow id="S3.E14.m1.6.6.2.2" xref="S3.E14.m1.6.6.2.3.cmml"><mrow id="S3.E14.m1.5.5.1.1.1" xref="S3.E14.m1.5.5.1.1.1.cmml"><mi id="S3.E14.m1.5.5.1.1.1.2" xref="S3.E14.m1.5.5.1.1.1.2.cmml">i</mi><mo id="S3.E14.m1.5.5.1.1.1.1" xref="S3.E14.m1.5.5.1.1.1.1.cmml">+</mo><mn id="S3.E14.m1.5.5.1.1.1.3" xref="S3.E14.m1.5.5.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E14.m1.6.6.2.2.3" xref="S3.E14.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E14.m1.6.6.2.2.2" xref="S3.E14.m1.6.6.2.2.2.cmml"><mi id="S3.E14.m1.6.6.2.2.2.2" xref="S3.E14.m1.6.6.2.2.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.6.6.2.2.2.1" xref="S3.E14.m1.6.6.2.2.2.1.cmml">​</mo><mi id="S3.E14.m1.6.6.2.2.2.3" xref="S3.E14.m1.6.6.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.6.6.2.2.2.1a" xref="S3.E14.m1.6.6.2.2.2.1.cmml">​</mo><mi id="S3.E14.m1.6.6.2.2.2.4" xref="S3.E14.m1.6.6.2.2.2.4.cmml">s</mi></mrow></mrow><mi id="S3.E14.m1.6.7.2.3" xref="S3.E14.m1.6.7.2.3.cmml">j</mi></msubsup><mo id="S3.E14.m1.6.7.1" xref="S3.E14.m1.6.7.1.cmml">=</mo><mrow id="S3.E14.m1.4.4" xref="S3.E14.m1.6.7.3.1.cmml"><mo id="S3.E14.m1.4.4.5" xref="S3.E14.m1.6.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E14.m1.4.4.4" xref="S3.E14.m1.6.7.3.1.cmml"><mtr id="S3.E14.m1.4.4.4a" xref="S3.E14.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E14.m1.4.4.4b" xref="S3.E14.m1.6.7.3.1.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1.9" xref="S3.E14.m1.1.1.1.1.1.1.9.1.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1.9.1" xref="S3.E14.m1.1.1.1.1.1.1.9.1.cmml"><mmultiscripts id="S3.E14.m1.1.1.1.1.1.1.9.1.5" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.2.2.cmml">𝐰</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E14.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.2" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mi id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.3" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.1a" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mi id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.4" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.4.cmml">s</mi></mrow></mrow><mi id="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.3" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.3.cmml">j</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.9.1.5a" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5.cmml"></mrow><mo id="S3.E14.m1.1.1.1.1.1.1.9.1.5.3" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5.3.cmml">′</mo></mmultiscripts><mo id="S3.E14.m1.1.1.1.1.1.1.9.1.4" xref="S3.E14.m1.1.1.1.1.1.1.9.1.4.cmml">+</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.9.1.3" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.9.1.3.5" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.5.cmml">Attn</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.9.1.3.4" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.4.cmml">​</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.4.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.4" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.4.cmml">(</mo><msup id="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.cmml">Q</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.4.2.4" xref="S3.E14.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.3.1.1" xref="S3.E14.m1.1.1.1.1.1.1.3.1.1.cmml">i</mi><mo id="S3.E14.m1.1.1.1.1.1.1.4.2.4.1" xref="S3.E14.m1.1.1.1.1.1.1.4.2.3.cmml">,</mo><mi id="S3.E14.m1.1.1.1.1.1.1.4.2.2" xref="S3.E14.m1.1.1.1.1.1.1.4.2.2.cmml">r</mi></mrow></msup><mo id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.5" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.4.cmml">,</mo><msup id="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2.2.cmml">K</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.6.2.4" xref="S3.E14.m1.1.1.1.1.1.1.6.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.5.1.1" xref="S3.E14.m1.1.1.1.1.1.1.5.1.1.cmml">i</mi><mo id="S3.E14.m1.1.1.1.1.1.1.6.2.4.1" xref="S3.E14.m1.1.1.1.1.1.1.6.2.3.cmml">,</mo><mi id="S3.E14.m1.1.1.1.1.1.1.6.2.2" xref="S3.E14.m1.1.1.1.1.1.1.6.2.2.cmml">r</mi></mrow></msup><mo id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.6" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.4.cmml">,</mo><msup id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3.2" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3.2.cmml">V</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.8.2.4" xref="S3.E14.m1.1.1.1.1.1.1.8.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.7.1.1" xref="S3.E14.m1.1.1.1.1.1.1.7.1.1.cmml">i</mi><mo id="S3.E14.m1.1.1.1.1.1.1.8.2.4.1" xref="S3.E14.m1.1.1.1.1.1.1.8.2.3.cmml">,</mo><mi id="S3.E14.m1.1.1.1.1.1.1.8.2.2" xref="S3.E14.m1.1.1.1.1.1.1.8.2.2.cmml">r</mi></mrow></msup><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.7" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E14.m1.1.1.1.1.1.1.9.2" xref="S3.E14.m1.1.1.1.1.1.1.9.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E14.m1.4.4.4c" xref="S3.E14.m1.6.7.3.1.cmml"><mrow id="S3.E14.m1.2.2.2.2.2.1" xref="S3.E14.m1.2.2.2.2.2.1.cmml"><mi id="S3.E14.m1.2.2.2.2.2.1.2" xref="S3.E14.m1.2.2.2.2.2.1.2.cmml">j</mi><mo id="S3.E14.m1.2.2.2.2.2.1.1" xref="S3.E14.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="S3.E14.m1.2.2.2.2.2.1.3" xref="S3.E14.m1.2.2.2.2.2.1.3.cmml">0</mn></mrow></mtd></mtr><mtr id="S3.E14.m1.4.4.4d" xref="S3.E14.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E14.m1.4.4.4e" xref="S3.E14.m1.6.7.3.1.cmml"><mrow id="S3.E14.m1.3.3.3.3.1.1.3" xref="S3.E14.m1.3.3.3.3.1.1.3.1.cmml"><mmultiscripts id="S3.E14.m1.3.3.3.3.1.1.3.1" xref="S3.E14.m1.3.3.3.3.1.1.3.1.cmml"><mi id="S3.E14.m1.3.3.3.3.1.1.3.1.2.2.2" xref="S3.E14.m1.3.3.3.3.1.1.3.1.2.2.2.cmml">𝐰</mi><mrow id="S3.E14.m1.3.3.3.3.1.1.2.2.2" xref="S3.E14.m1.3.3.3.3.1.1.2.2.3.cmml"><mi id="S3.E14.m1.3.3.3.3.1.1.1.1.1" xref="S3.E14.m1.3.3.3.3.1.1.1.1.1.cmml">i</mi><mo id="S3.E14.m1.3.3.3.3.1.1.2.2.2.2" xref="S3.E14.m1.3.3.3.3.1.1.2.2.3.cmml">,</mo><mrow id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.cmml"><mi id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.2" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.1" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.3" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.1a" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.4" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.4.cmml">s</mi></mrow></mrow><mi id="S3.E14.m1.3.3.3.3.1.1.3.1.2.3" xref="S3.E14.m1.3.3.3.3.1.1.3.1.2.3.cmml">j</mi><mrow id="S3.E14.m1.3.3.3.3.1.1.3.1a" xref="S3.E14.m1.3.3.3.3.1.1.3.1.cmml"></mrow><mo id="S3.E14.m1.3.3.3.3.1.1.3.1.3" xref="S3.E14.m1.3.3.3.3.1.1.3.1.3.cmml">′</mo></mmultiscripts><mo id="S3.E14.m1.3.3.3.3.1.1.3.2" xref="S3.E14.m1.3.3.3.3.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E14.m1.4.4.4f" xref="S3.E14.m1.6.7.3.1.cmml"><mrow id="S3.E14.m1.4.4.4.4.2.1" xref="S3.E14.m1.4.4.4.4.2.1.cmml"><mi id="S3.E14.m1.4.4.4.4.2.1.2" xref="S3.E14.m1.4.4.4.4.2.1.2.cmml">j</mi><mo id="S3.E14.m1.4.4.4.4.2.1.1" xref="S3.E14.m1.4.4.4.4.2.1.1.cmml">&gt;</mo><mn id="S3.E14.m1.4.4.4.4.2.1.3" xref="S3.E14.m1.4.4.4.4.2.1.3.cmml">0</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.6b"><apply id="S3.E14.m1.6.7.cmml" xref="S3.E14.m1.6.7"><eq id="S3.E14.m1.6.7.1.cmml" xref="S3.E14.m1.6.7.1"></eq><apply id="S3.E14.m1.6.7.2.cmml" xref="S3.E14.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E14.m1.6.7.2.1.cmml" xref="S3.E14.m1.6.7.2">superscript</csymbol><apply id="S3.E14.m1.6.7.2.2.cmml" xref="S3.E14.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E14.m1.6.7.2.2.1.cmml" xref="S3.E14.m1.6.7.2">subscript</csymbol><ci id="S3.E14.m1.6.7.2.2.2.cmml" xref="S3.E14.m1.6.7.2.2.2">𝐰</ci><list id="S3.E14.m1.6.6.2.3.cmml" xref="S3.E14.m1.6.6.2.2"><apply id="S3.E14.m1.5.5.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1"><plus id="S3.E14.m1.5.5.1.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1"></plus><ci id="S3.E14.m1.5.5.1.1.1.2.cmml" xref="S3.E14.m1.5.5.1.1.1.2">𝑖</ci><cn type="integer" id="S3.E14.m1.5.5.1.1.1.3.cmml" xref="S3.E14.m1.5.5.1.1.1.3">1</cn></apply><apply id="S3.E14.m1.6.6.2.2.2.cmml" xref="S3.E14.m1.6.6.2.2.2"><times id="S3.E14.m1.6.6.2.2.2.1.cmml" xref="S3.E14.m1.6.6.2.2.2.1"></times><ci id="S3.E14.m1.6.6.2.2.2.2.cmml" xref="S3.E14.m1.6.6.2.2.2.2">𝑐</ci><ci id="S3.E14.m1.6.6.2.2.2.3.cmml" xref="S3.E14.m1.6.6.2.2.2.3">𝑙</ci><ci id="S3.E14.m1.6.6.2.2.2.4.cmml" xref="S3.E14.m1.6.6.2.2.2.4">𝑠</ci></apply></list></apply><ci id="S3.E14.m1.6.7.2.3.cmml" xref="S3.E14.m1.6.7.2.3">𝑗</ci></apply><apply id="S3.E14.m1.6.7.3.1.cmml" xref="S3.E14.m1.4.4"><csymbol cd="latexml" id="S3.E14.m1.6.7.3.1.1.cmml" xref="S3.E14.m1.4.4.5">cases</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.9.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9"><plus id="S3.E14.m1.1.1.1.1.1.1.9.1.4.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.4"></plus><apply id="S3.E14.m1.1.1.1.1.1.1.9.1.5.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.9.1.5.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5">superscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5">superscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.2.2">𝐰</ci><list id="S3.E14.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2"><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1">𝑖</ci><apply id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1"><times id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.1"></times><ci id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.2">𝑐</ci><ci id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.3">𝑙</ci><ci id="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.4.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.1.4">𝑠</ci></apply></list></apply><ci id="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5.2.3">𝑗</ci></apply><ci id="S3.E14.m1.1.1.1.1.1.1.9.1.5.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.5.3">′</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.1.9.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3"><times id="S3.E14.m1.1.1.1.1.1.1.9.1.3.4.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.4"></times><ci id="S3.E14.m1.1.1.1.1.1.1.9.1.3.5.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.5">Attn</ci><vector id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.4.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3"><apply id="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.1.1.1.1.2">𝑄</ci><list id="S3.E14.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.4.2.4"><ci id="S3.E14.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1.1">𝑖</ci><ci id="S3.E14.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.4.2.2">𝑟</ci></list></apply><apply id="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.2.2.2.2.2">𝐾</ci><list id="S3.E14.m1.1.1.1.1.1.1.6.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.6.2.4"><ci id="S3.E14.m1.1.1.1.1.1.1.5.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.5.1.1">𝑖</ci><ci id="S3.E14.m1.1.1.1.1.1.1.6.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.6.2.2">𝑟</ci></list></apply><apply id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.9.1.3.3.3.3.2">𝑉</ci><list id="S3.E14.m1.1.1.1.1.1.1.8.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.8.2.4"><ci id="S3.E14.m1.1.1.1.1.1.1.7.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.7.1.1">𝑖</ci><ci id="S3.E14.m1.1.1.1.1.1.1.8.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.8.2.2">𝑟</ci></list></apply></vector></apply></apply><apply id="S3.E14.m1.2.2.2.2.2.1.cmml" xref="S3.E14.m1.2.2.2.2.2.1"><eq id="S3.E14.m1.2.2.2.2.2.1.1.cmml" xref="S3.E14.m1.2.2.2.2.2.1.1"></eq><ci id="S3.E14.m1.2.2.2.2.2.1.2.cmml" xref="S3.E14.m1.2.2.2.2.2.1.2">𝑗</ci><cn type="integer" id="S3.E14.m1.2.2.2.2.2.1.3.cmml" xref="S3.E14.m1.2.2.2.2.2.1.3">0</cn></apply><apply id="S3.E14.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.3.3.1.1.3.1.1.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3">superscript</csymbol><apply id="S3.E14.m1.3.3.3.3.1.1.3.1.2.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.3.3.1.1.3.1.2.1.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3">superscript</csymbol><apply id="S3.E14.m1.3.3.3.3.1.1.3.1.2.2.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.3.3.3.3.1.1.3.1.2.2.1.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E14.m1.3.3.3.3.1.1.3.1.2.2.2.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3.1.2.2.2">𝐰</ci><list id="S3.E14.m1.3.3.3.3.1.1.2.2.3.cmml" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2"><ci id="S3.E14.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E14.m1.3.3.3.3.1.1.1.1.1">𝑖</ci><apply id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1"><times id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.1.cmml" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.1"></times><ci id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.2.cmml" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.2">𝑐</ci><ci id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.3.cmml" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.3">𝑙</ci><ci id="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.4.cmml" xref="S3.E14.m1.3.3.3.3.1.1.2.2.2.1.4">𝑠</ci></apply></list></apply><ci id="S3.E14.m1.3.3.3.3.1.1.3.1.2.3.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3.1.2.3">𝑗</ci></apply><ci id="S3.E14.m1.3.3.3.3.1.1.3.1.3.cmml" xref="S3.E14.m1.3.3.3.3.1.1.3.1.3">′</ci></apply><apply id="S3.E14.m1.4.4.4.4.2.1.cmml" xref="S3.E14.m1.4.4.4.4.2.1"><gt id="S3.E14.m1.4.4.4.4.2.1.1.cmml" xref="S3.E14.m1.4.4.4.4.2.1.1"></gt><ci id="S3.E14.m1.4.4.4.4.2.1.2.cmml" xref="S3.E14.m1.4.4.4.4.2.1.2">𝑗</ci><cn type="integer" id="S3.E14.m1.4.4.4.4.2.1.3.cmml" xref="S3.E14.m1.4.4.4.4.2.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.6c">{\mathbf{w}_{i+1,cls}^{j}}=\begin{cases}{\mathbf{w}_{i,cls}^{j}}^{\prime}+\mathrm{Attn}(Q^{i,r},K^{i,r},V^{i,r}),&amp;j=0\\
{\mathbf{w}_{i,cls}^{j}}^{\prime},&amp;j&gt;0\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.SSS0.Px2.p3" class="ltx_para">
<p id="S3.SS4.SSS0.Px2.p3.1" class="ltx_p">The retrieval-attention on image modality is calculated similarly.</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E15.m1.4" class="ltx_Math" alttext="Q^{i,r}=W_{Q}^{r}{\mathbf{v}_{i,cls}^{0}}^{\prime}" display="block"><semantics id="S3.E15.m1.4a"><mrow id="S3.E15.m1.4.5" xref="S3.E15.m1.4.5.cmml"><msup id="S3.E15.m1.4.5.2" xref="S3.E15.m1.4.5.2.cmml"><mi id="S3.E15.m1.4.5.2.2" xref="S3.E15.m1.4.5.2.2.cmml">Q</mi><mrow id="S3.E15.m1.2.2.2.4" xref="S3.E15.m1.2.2.2.3.cmml"><mi id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml">i</mi><mo id="S3.E15.m1.2.2.2.4.1" xref="S3.E15.m1.2.2.2.3.cmml">,</mo><mi id="S3.E15.m1.2.2.2.2" xref="S3.E15.m1.2.2.2.2.cmml">r</mi></mrow></msup><mo id="S3.E15.m1.4.5.1" xref="S3.E15.m1.4.5.1.cmml">=</mo><mrow id="S3.E15.m1.4.5.3" xref="S3.E15.m1.4.5.3.cmml"><msubsup id="S3.E15.m1.4.5.3.2" xref="S3.E15.m1.4.5.3.2.cmml"><mi id="S3.E15.m1.4.5.3.2.2.2" xref="S3.E15.m1.4.5.3.2.2.2.cmml">W</mi><mi id="S3.E15.m1.4.5.3.2.2.3" xref="S3.E15.m1.4.5.3.2.2.3.cmml">Q</mi><mi id="S3.E15.m1.4.5.3.2.3" xref="S3.E15.m1.4.5.3.2.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E15.m1.4.5.3.1" xref="S3.E15.m1.4.5.3.1.cmml">​</mo><mmultiscripts id="S3.E15.m1.4.5.3.3" xref="S3.E15.m1.4.5.3.3.cmml"><mi id="S3.E15.m1.4.5.3.3.2.2.2" xref="S3.E15.m1.4.5.3.3.2.2.2.cmml">𝐯</mi><mrow id="S3.E15.m1.4.4.2.2" xref="S3.E15.m1.4.4.2.3.cmml"><mi id="S3.E15.m1.3.3.1.1" xref="S3.E15.m1.3.3.1.1.cmml">i</mi><mo id="S3.E15.m1.4.4.2.2.2" xref="S3.E15.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E15.m1.4.4.2.2.1" xref="S3.E15.m1.4.4.2.2.1.cmml"><mi id="S3.E15.m1.4.4.2.2.1.2" xref="S3.E15.m1.4.4.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.4.4.2.2.1.1" xref="S3.E15.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E15.m1.4.4.2.2.1.3" xref="S3.E15.m1.4.4.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.4.4.2.2.1.1a" xref="S3.E15.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E15.m1.4.4.2.2.1.4" xref="S3.E15.m1.4.4.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E15.m1.4.5.3.3.2.3" xref="S3.E15.m1.4.5.3.3.2.3.cmml">0</mn><mrow id="S3.E15.m1.4.5.3.3a" xref="S3.E15.m1.4.5.3.3.cmml"></mrow><mo id="S3.E15.m1.4.5.3.3.3" xref="S3.E15.m1.4.5.3.3.3.cmml">′</mo></mmultiscripts></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.4b"><apply id="S3.E15.m1.4.5.cmml" xref="S3.E15.m1.4.5"><eq id="S3.E15.m1.4.5.1.cmml" xref="S3.E15.m1.4.5.1"></eq><apply id="S3.E15.m1.4.5.2.cmml" xref="S3.E15.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E15.m1.4.5.2.1.cmml" xref="S3.E15.m1.4.5.2">superscript</csymbol><ci id="S3.E15.m1.4.5.2.2.cmml" xref="S3.E15.m1.4.5.2.2">𝑄</ci><list id="S3.E15.m1.2.2.2.3.cmml" xref="S3.E15.m1.2.2.2.4"><ci id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1">𝑖</ci><ci id="S3.E15.m1.2.2.2.2.cmml" xref="S3.E15.m1.2.2.2.2">𝑟</ci></list></apply><apply id="S3.E15.m1.4.5.3.cmml" xref="S3.E15.m1.4.5.3"><times id="S3.E15.m1.4.5.3.1.cmml" xref="S3.E15.m1.4.5.3.1"></times><apply id="S3.E15.m1.4.5.3.2.cmml" xref="S3.E15.m1.4.5.3.2"><csymbol cd="ambiguous" id="S3.E15.m1.4.5.3.2.1.cmml" xref="S3.E15.m1.4.5.3.2">superscript</csymbol><apply id="S3.E15.m1.4.5.3.2.2.cmml" xref="S3.E15.m1.4.5.3.2"><csymbol cd="ambiguous" id="S3.E15.m1.4.5.3.2.2.1.cmml" xref="S3.E15.m1.4.5.3.2">subscript</csymbol><ci id="S3.E15.m1.4.5.3.2.2.2.cmml" xref="S3.E15.m1.4.5.3.2.2.2">𝑊</ci><ci id="S3.E15.m1.4.5.3.2.2.3.cmml" xref="S3.E15.m1.4.5.3.2.2.3">𝑄</ci></apply><ci id="S3.E15.m1.4.5.3.2.3.cmml" xref="S3.E15.m1.4.5.3.2.3">𝑟</ci></apply><apply id="S3.E15.m1.4.5.3.3.cmml" xref="S3.E15.m1.4.5.3.3"><csymbol cd="ambiguous" id="S3.E15.m1.4.5.3.3.1.cmml" xref="S3.E15.m1.4.5.3.3">superscript</csymbol><apply id="S3.E15.m1.4.5.3.3.2.cmml" xref="S3.E15.m1.4.5.3.3"><csymbol cd="ambiguous" id="S3.E15.m1.4.5.3.3.2.1.cmml" xref="S3.E15.m1.4.5.3.3">superscript</csymbol><apply id="S3.E15.m1.4.5.3.3.2.2.cmml" xref="S3.E15.m1.4.5.3.3"><csymbol cd="ambiguous" id="S3.E15.m1.4.5.3.3.2.2.1.cmml" xref="S3.E15.m1.4.5.3.3">subscript</csymbol><ci id="S3.E15.m1.4.5.3.3.2.2.2.cmml" xref="S3.E15.m1.4.5.3.3.2.2.2">𝐯</ci><list id="S3.E15.m1.4.4.2.3.cmml" xref="S3.E15.m1.4.4.2.2"><ci id="S3.E15.m1.3.3.1.1.cmml" xref="S3.E15.m1.3.3.1.1">𝑖</ci><apply id="S3.E15.m1.4.4.2.2.1.cmml" xref="S3.E15.m1.4.4.2.2.1"><times id="S3.E15.m1.4.4.2.2.1.1.cmml" xref="S3.E15.m1.4.4.2.2.1.1"></times><ci id="S3.E15.m1.4.4.2.2.1.2.cmml" xref="S3.E15.m1.4.4.2.2.1.2">𝑐</ci><ci id="S3.E15.m1.4.4.2.2.1.3.cmml" xref="S3.E15.m1.4.4.2.2.1.3">𝑙</ci><ci id="S3.E15.m1.4.4.2.2.1.4.cmml" xref="S3.E15.m1.4.4.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E15.m1.4.5.3.3.2.3.cmml" xref="S3.E15.m1.4.5.3.3.2.3">0</cn></apply><ci id="S3.E15.m1.4.5.3.3.3.cmml" xref="S3.E15.m1.4.5.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.4c">Q^{i,r}=W_{Q}^{r}{\mathbf{v}_{i,cls}^{0}}^{\prime}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E16.m1.12" class="ltx_Math" alttext="K^{i,r}=W_{K}^{r}[{\mathbf{v}_{i,cls}^{0}}^{\prime},{\mathbf{v}_{i,cls}^{1}}^{\prime},...,{\mathbf{v}_{i,cls}^{r}}^{\prime}]" display="block"><semantics id="S3.E16.m1.12a"><mrow id="S3.E16.m1.12.12" xref="S3.E16.m1.12.12.cmml"><msup id="S3.E16.m1.12.12.5" xref="S3.E16.m1.12.12.5.cmml"><mi id="S3.E16.m1.12.12.5.2" xref="S3.E16.m1.12.12.5.2.cmml">K</mi><mrow id="S3.E16.m1.2.2.2.4" xref="S3.E16.m1.2.2.2.3.cmml"><mi id="S3.E16.m1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.cmml">i</mi><mo id="S3.E16.m1.2.2.2.4.1" xref="S3.E16.m1.2.2.2.3.cmml">,</mo><mi id="S3.E16.m1.2.2.2.2" xref="S3.E16.m1.2.2.2.2.cmml">r</mi></mrow></msup><mo id="S3.E16.m1.12.12.4" xref="S3.E16.m1.12.12.4.cmml">=</mo><mrow id="S3.E16.m1.12.12.3" xref="S3.E16.m1.12.12.3.cmml"><msubsup id="S3.E16.m1.12.12.3.5" xref="S3.E16.m1.12.12.3.5.cmml"><mi id="S3.E16.m1.12.12.3.5.2.2" xref="S3.E16.m1.12.12.3.5.2.2.cmml">W</mi><mi id="S3.E16.m1.12.12.3.5.2.3" xref="S3.E16.m1.12.12.3.5.2.3.cmml">K</mi><mi id="S3.E16.m1.12.12.3.5.3" xref="S3.E16.m1.12.12.3.5.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E16.m1.12.12.3.4" xref="S3.E16.m1.12.12.3.4.cmml">​</mo><mrow id="S3.E16.m1.12.12.3.3.3" xref="S3.E16.m1.12.12.3.3.4.cmml"><mo stretchy="false" id="S3.E16.m1.12.12.3.3.3.4" xref="S3.E16.m1.12.12.3.3.4.cmml">[</mo><mmultiscripts id="S3.E16.m1.10.10.1.1.1.1" xref="S3.E16.m1.10.10.1.1.1.1.cmml"><mi id="S3.E16.m1.10.10.1.1.1.1.2.2.2" xref="S3.E16.m1.10.10.1.1.1.1.2.2.2.cmml">𝐯</mi><mrow id="S3.E16.m1.4.4.2.2" xref="S3.E16.m1.4.4.2.3.cmml"><mi id="S3.E16.m1.3.3.1.1" xref="S3.E16.m1.3.3.1.1.cmml">i</mi><mo id="S3.E16.m1.4.4.2.2.2" xref="S3.E16.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E16.m1.4.4.2.2.1" xref="S3.E16.m1.4.4.2.2.1.cmml"><mi id="S3.E16.m1.4.4.2.2.1.2" xref="S3.E16.m1.4.4.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.4.4.2.2.1.1" xref="S3.E16.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E16.m1.4.4.2.2.1.3" xref="S3.E16.m1.4.4.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.4.4.2.2.1.1a" xref="S3.E16.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E16.m1.4.4.2.2.1.4" xref="S3.E16.m1.4.4.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E16.m1.10.10.1.1.1.1.2.3" xref="S3.E16.m1.10.10.1.1.1.1.2.3.cmml">0</mn><mrow id="S3.E16.m1.10.10.1.1.1.1a" xref="S3.E16.m1.10.10.1.1.1.1.cmml"></mrow><mo id="S3.E16.m1.10.10.1.1.1.1.3" xref="S3.E16.m1.10.10.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo id="S3.E16.m1.12.12.3.3.3.5" xref="S3.E16.m1.12.12.3.3.4.cmml">,</mo><mmultiscripts id="S3.E16.m1.11.11.2.2.2.2" xref="S3.E16.m1.11.11.2.2.2.2.cmml"><mi id="S3.E16.m1.11.11.2.2.2.2.2.2.2" xref="S3.E16.m1.11.11.2.2.2.2.2.2.2.cmml">𝐯</mi><mrow id="S3.E16.m1.6.6.2.2" xref="S3.E16.m1.6.6.2.3.cmml"><mi id="S3.E16.m1.5.5.1.1" xref="S3.E16.m1.5.5.1.1.cmml">i</mi><mo id="S3.E16.m1.6.6.2.2.2" xref="S3.E16.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E16.m1.6.6.2.2.1" xref="S3.E16.m1.6.6.2.2.1.cmml"><mi id="S3.E16.m1.6.6.2.2.1.2" xref="S3.E16.m1.6.6.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.6.6.2.2.1.1" xref="S3.E16.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E16.m1.6.6.2.2.1.3" xref="S3.E16.m1.6.6.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.6.6.2.2.1.1a" xref="S3.E16.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E16.m1.6.6.2.2.1.4" xref="S3.E16.m1.6.6.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E16.m1.11.11.2.2.2.2.2.3" xref="S3.E16.m1.11.11.2.2.2.2.2.3.cmml">1</mn><mrow id="S3.E16.m1.11.11.2.2.2.2a" xref="S3.E16.m1.11.11.2.2.2.2.cmml"></mrow><mo id="S3.E16.m1.11.11.2.2.2.2.3" xref="S3.E16.m1.11.11.2.2.2.2.3.cmml">′</mo></mmultiscripts><mo id="S3.E16.m1.12.12.3.3.3.6" xref="S3.E16.m1.12.12.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E16.m1.9.9" xref="S3.E16.m1.9.9.cmml">…</mi><mo id="S3.E16.m1.12.12.3.3.3.7" xref="S3.E16.m1.12.12.3.3.4.cmml">,</mo><mmultiscripts id="S3.E16.m1.12.12.3.3.3.3" xref="S3.E16.m1.12.12.3.3.3.3.cmml"><mi id="S3.E16.m1.12.12.3.3.3.3.2.2.2" xref="S3.E16.m1.12.12.3.3.3.3.2.2.2.cmml">𝐯</mi><mrow id="S3.E16.m1.8.8.2.2" xref="S3.E16.m1.8.8.2.3.cmml"><mi id="S3.E16.m1.7.7.1.1" xref="S3.E16.m1.7.7.1.1.cmml">i</mi><mo id="S3.E16.m1.8.8.2.2.2" xref="S3.E16.m1.8.8.2.3.cmml">,</mo><mrow id="S3.E16.m1.8.8.2.2.1" xref="S3.E16.m1.8.8.2.2.1.cmml"><mi id="S3.E16.m1.8.8.2.2.1.2" xref="S3.E16.m1.8.8.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.8.8.2.2.1.1" xref="S3.E16.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E16.m1.8.8.2.2.1.3" xref="S3.E16.m1.8.8.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.8.8.2.2.1.1a" xref="S3.E16.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E16.m1.8.8.2.2.1.4" xref="S3.E16.m1.8.8.2.2.1.4.cmml">s</mi></mrow></mrow><mi id="S3.E16.m1.12.12.3.3.3.3.2.3" xref="S3.E16.m1.12.12.3.3.3.3.2.3.cmml">r</mi><mrow id="S3.E16.m1.12.12.3.3.3.3a" xref="S3.E16.m1.12.12.3.3.3.3.cmml"></mrow><mo id="S3.E16.m1.12.12.3.3.3.3.3" xref="S3.E16.m1.12.12.3.3.3.3.3.cmml">′</mo></mmultiscripts><mo stretchy="false" id="S3.E16.m1.12.12.3.3.3.8" xref="S3.E16.m1.12.12.3.3.4.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.12b"><apply id="S3.E16.m1.12.12.cmml" xref="S3.E16.m1.12.12"><eq id="S3.E16.m1.12.12.4.cmml" xref="S3.E16.m1.12.12.4"></eq><apply id="S3.E16.m1.12.12.5.cmml" xref="S3.E16.m1.12.12.5"><csymbol cd="ambiguous" id="S3.E16.m1.12.12.5.1.cmml" xref="S3.E16.m1.12.12.5">superscript</csymbol><ci id="S3.E16.m1.12.12.5.2.cmml" xref="S3.E16.m1.12.12.5.2">𝐾</ci><list id="S3.E16.m1.2.2.2.3.cmml" xref="S3.E16.m1.2.2.2.4"><ci id="S3.E16.m1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1">𝑖</ci><ci id="S3.E16.m1.2.2.2.2.cmml" xref="S3.E16.m1.2.2.2.2">𝑟</ci></list></apply><apply id="S3.E16.m1.12.12.3.cmml" xref="S3.E16.m1.12.12.3"><times id="S3.E16.m1.12.12.3.4.cmml" xref="S3.E16.m1.12.12.3.4"></times><apply id="S3.E16.m1.12.12.3.5.cmml" xref="S3.E16.m1.12.12.3.5"><csymbol cd="ambiguous" id="S3.E16.m1.12.12.3.5.1.cmml" xref="S3.E16.m1.12.12.3.5">superscript</csymbol><apply id="S3.E16.m1.12.12.3.5.2.cmml" xref="S3.E16.m1.12.12.3.5"><csymbol cd="ambiguous" id="S3.E16.m1.12.12.3.5.2.1.cmml" xref="S3.E16.m1.12.12.3.5">subscript</csymbol><ci id="S3.E16.m1.12.12.3.5.2.2.cmml" xref="S3.E16.m1.12.12.3.5.2.2">𝑊</ci><ci id="S3.E16.m1.12.12.3.5.2.3.cmml" xref="S3.E16.m1.12.12.3.5.2.3">𝐾</ci></apply><ci id="S3.E16.m1.12.12.3.5.3.cmml" xref="S3.E16.m1.12.12.3.5.3">𝑟</ci></apply><list id="S3.E16.m1.12.12.3.3.4.cmml" xref="S3.E16.m1.12.12.3.3.3"><apply id="S3.E16.m1.10.10.1.1.1.1.cmml" xref="S3.E16.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.10.10.1.1.1.1.1.cmml" xref="S3.E16.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E16.m1.10.10.1.1.1.1.2.cmml" xref="S3.E16.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.10.10.1.1.1.1.2.1.cmml" xref="S3.E16.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E16.m1.10.10.1.1.1.1.2.2.cmml" xref="S3.E16.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.10.10.1.1.1.1.2.2.1.cmml" xref="S3.E16.m1.10.10.1.1.1.1">subscript</csymbol><ci id="S3.E16.m1.10.10.1.1.1.1.2.2.2.cmml" xref="S3.E16.m1.10.10.1.1.1.1.2.2.2">𝐯</ci><list id="S3.E16.m1.4.4.2.3.cmml" xref="S3.E16.m1.4.4.2.2"><ci id="S3.E16.m1.3.3.1.1.cmml" xref="S3.E16.m1.3.3.1.1">𝑖</ci><apply id="S3.E16.m1.4.4.2.2.1.cmml" xref="S3.E16.m1.4.4.2.2.1"><times id="S3.E16.m1.4.4.2.2.1.1.cmml" xref="S3.E16.m1.4.4.2.2.1.1"></times><ci id="S3.E16.m1.4.4.2.2.1.2.cmml" xref="S3.E16.m1.4.4.2.2.1.2">𝑐</ci><ci id="S3.E16.m1.4.4.2.2.1.3.cmml" xref="S3.E16.m1.4.4.2.2.1.3">𝑙</ci><ci id="S3.E16.m1.4.4.2.2.1.4.cmml" xref="S3.E16.m1.4.4.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E16.m1.10.10.1.1.1.1.2.3.cmml" xref="S3.E16.m1.10.10.1.1.1.1.2.3">0</cn></apply><ci id="S3.E16.m1.10.10.1.1.1.1.3.cmml" xref="S3.E16.m1.10.10.1.1.1.1.3">′</ci></apply><apply id="S3.E16.m1.11.11.2.2.2.2.cmml" xref="S3.E16.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.11.11.2.2.2.2.1.cmml" xref="S3.E16.m1.11.11.2.2.2.2">superscript</csymbol><apply id="S3.E16.m1.11.11.2.2.2.2.2.cmml" xref="S3.E16.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.11.11.2.2.2.2.2.1.cmml" xref="S3.E16.m1.11.11.2.2.2.2">superscript</csymbol><apply id="S3.E16.m1.11.11.2.2.2.2.2.2.cmml" xref="S3.E16.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.11.11.2.2.2.2.2.2.1.cmml" xref="S3.E16.m1.11.11.2.2.2.2">subscript</csymbol><ci id="S3.E16.m1.11.11.2.2.2.2.2.2.2.cmml" xref="S3.E16.m1.11.11.2.2.2.2.2.2.2">𝐯</ci><list id="S3.E16.m1.6.6.2.3.cmml" xref="S3.E16.m1.6.6.2.2"><ci id="S3.E16.m1.5.5.1.1.cmml" xref="S3.E16.m1.5.5.1.1">𝑖</ci><apply id="S3.E16.m1.6.6.2.2.1.cmml" xref="S3.E16.m1.6.6.2.2.1"><times id="S3.E16.m1.6.6.2.2.1.1.cmml" xref="S3.E16.m1.6.6.2.2.1.1"></times><ci id="S3.E16.m1.6.6.2.2.1.2.cmml" xref="S3.E16.m1.6.6.2.2.1.2">𝑐</ci><ci id="S3.E16.m1.6.6.2.2.1.3.cmml" xref="S3.E16.m1.6.6.2.2.1.3">𝑙</ci><ci id="S3.E16.m1.6.6.2.2.1.4.cmml" xref="S3.E16.m1.6.6.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E16.m1.11.11.2.2.2.2.2.3.cmml" xref="S3.E16.m1.11.11.2.2.2.2.2.3">1</cn></apply><ci id="S3.E16.m1.11.11.2.2.2.2.3.cmml" xref="S3.E16.m1.11.11.2.2.2.2.3">′</ci></apply><ci id="S3.E16.m1.9.9.cmml" xref="S3.E16.m1.9.9">…</ci><apply id="S3.E16.m1.12.12.3.3.3.3.cmml" xref="S3.E16.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E16.m1.12.12.3.3.3.3.1.cmml" xref="S3.E16.m1.12.12.3.3.3.3">superscript</csymbol><apply id="S3.E16.m1.12.12.3.3.3.3.2.cmml" xref="S3.E16.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E16.m1.12.12.3.3.3.3.2.1.cmml" xref="S3.E16.m1.12.12.3.3.3.3">superscript</csymbol><apply id="S3.E16.m1.12.12.3.3.3.3.2.2.cmml" xref="S3.E16.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E16.m1.12.12.3.3.3.3.2.2.1.cmml" xref="S3.E16.m1.12.12.3.3.3.3">subscript</csymbol><ci id="S3.E16.m1.12.12.3.3.3.3.2.2.2.cmml" xref="S3.E16.m1.12.12.3.3.3.3.2.2.2">𝐯</ci><list id="S3.E16.m1.8.8.2.3.cmml" xref="S3.E16.m1.8.8.2.2"><ci id="S3.E16.m1.7.7.1.1.cmml" xref="S3.E16.m1.7.7.1.1">𝑖</ci><apply id="S3.E16.m1.8.8.2.2.1.cmml" xref="S3.E16.m1.8.8.2.2.1"><times id="S3.E16.m1.8.8.2.2.1.1.cmml" xref="S3.E16.m1.8.8.2.2.1.1"></times><ci id="S3.E16.m1.8.8.2.2.1.2.cmml" xref="S3.E16.m1.8.8.2.2.1.2">𝑐</ci><ci id="S3.E16.m1.8.8.2.2.1.3.cmml" xref="S3.E16.m1.8.8.2.2.1.3">𝑙</ci><ci id="S3.E16.m1.8.8.2.2.1.4.cmml" xref="S3.E16.m1.8.8.2.2.1.4">𝑠</ci></apply></list></apply><ci id="S3.E16.m1.12.12.3.3.3.3.2.3.cmml" xref="S3.E16.m1.12.12.3.3.3.3.2.3">𝑟</ci></apply><ci id="S3.E16.m1.12.12.3.3.3.3.3.cmml" xref="S3.E16.m1.12.12.3.3.3.3.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.12c">K^{i,r}=W_{K}^{r}[{\mathbf{v}_{i,cls}^{0}}^{\prime},{\mathbf{v}_{i,cls}^{1}}^{\prime},...,{\mathbf{v}_{i,cls}^{r}}^{\prime}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<table id="S3.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E17.m1.12" class="ltx_Math" alttext="V^{i,r}=W_{V}^{r}[{\mathbf{v}_{i,cls}^{0}}^{\prime},{\mathbf{v}_{i,cls}^{1}}^{\prime},...,{\mathbf{v}_{i,cls}^{r}}^{\prime}]" display="block"><semantics id="S3.E17.m1.12a"><mrow id="S3.E17.m1.12.12" xref="S3.E17.m1.12.12.cmml"><msup id="S3.E17.m1.12.12.5" xref="S3.E17.m1.12.12.5.cmml"><mi id="S3.E17.m1.12.12.5.2" xref="S3.E17.m1.12.12.5.2.cmml">V</mi><mrow id="S3.E17.m1.2.2.2.4" xref="S3.E17.m1.2.2.2.3.cmml"><mi id="S3.E17.m1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.cmml">i</mi><mo id="S3.E17.m1.2.2.2.4.1" xref="S3.E17.m1.2.2.2.3.cmml">,</mo><mi id="S3.E17.m1.2.2.2.2" xref="S3.E17.m1.2.2.2.2.cmml">r</mi></mrow></msup><mo id="S3.E17.m1.12.12.4" xref="S3.E17.m1.12.12.4.cmml">=</mo><mrow id="S3.E17.m1.12.12.3" xref="S3.E17.m1.12.12.3.cmml"><msubsup id="S3.E17.m1.12.12.3.5" xref="S3.E17.m1.12.12.3.5.cmml"><mi id="S3.E17.m1.12.12.3.5.2.2" xref="S3.E17.m1.12.12.3.5.2.2.cmml">W</mi><mi id="S3.E17.m1.12.12.3.5.2.3" xref="S3.E17.m1.12.12.3.5.2.3.cmml">V</mi><mi id="S3.E17.m1.12.12.3.5.3" xref="S3.E17.m1.12.12.3.5.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E17.m1.12.12.3.4" xref="S3.E17.m1.12.12.3.4.cmml">​</mo><mrow id="S3.E17.m1.12.12.3.3.3" xref="S3.E17.m1.12.12.3.3.4.cmml"><mo stretchy="false" id="S3.E17.m1.12.12.3.3.3.4" xref="S3.E17.m1.12.12.3.3.4.cmml">[</mo><mmultiscripts id="S3.E17.m1.10.10.1.1.1.1" xref="S3.E17.m1.10.10.1.1.1.1.cmml"><mi id="S3.E17.m1.10.10.1.1.1.1.2.2.2" xref="S3.E17.m1.10.10.1.1.1.1.2.2.2.cmml">𝐯</mi><mrow id="S3.E17.m1.4.4.2.2" xref="S3.E17.m1.4.4.2.3.cmml"><mi id="S3.E17.m1.3.3.1.1" xref="S3.E17.m1.3.3.1.1.cmml">i</mi><mo id="S3.E17.m1.4.4.2.2.2" xref="S3.E17.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E17.m1.4.4.2.2.1" xref="S3.E17.m1.4.4.2.2.1.cmml"><mi id="S3.E17.m1.4.4.2.2.1.2" xref="S3.E17.m1.4.4.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.4.4.2.2.1.1" xref="S3.E17.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E17.m1.4.4.2.2.1.3" xref="S3.E17.m1.4.4.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.4.4.2.2.1.1a" xref="S3.E17.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E17.m1.4.4.2.2.1.4" xref="S3.E17.m1.4.4.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E17.m1.10.10.1.1.1.1.2.3" xref="S3.E17.m1.10.10.1.1.1.1.2.3.cmml">0</mn><mrow id="S3.E17.m1.10.10.1.1.1.1a" xref="S3.E17.m1.10.10.1.1.1.1.cmml"></mrow><mo id="S3.E17.m1.10.10.1.1.1.1.3" xref="S3.E17.m1.10.10.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo id="S3.E17.m1.12.12.3.3.3.5" xref="S3.E17.m1.12.12.3.3.4.cmml">,</mo><mmultiscripts id="S3.E17.m1.11.11.2.2.2.2" xref="S3.E17.m1.11.11.2.2.2.2.cmml"><mi id="S3.E17.m1.11.11.2.2.2.2.2.2.2" xref="S3.E17.m1.11.11.2.2.2.2.2.2.2.cmml">𝐯</mi><mrow id="S3.E17.m1.6.6.2.2" xref="S3.E17.m1.6.6.2.3.cmml"><mi id="S3.E17.m1.5.5.1.1" xref="S3.E17.m1.5.5.1.1.cmml">i</mi><mo id="S3.E17.m1.6.6.2.2.2" xref="S3.E17.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E17.m1.6.6.2.2.1" xref="S3.E17.m1.6.6.2.2.1.cmml"><mi id="S3.E17.m1.6.6.2.2.1.2" xref="S3.E17.m1.6.6.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.6.6.2.2.1.1" xref="S3.E17.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E17.m1.6.6.2.2.1.3" xref="S3.E17.m1.6.6.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.6.6.2.2.1.1a" xref="S3.E17.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E17.m1.6.6.2.2.1.4" xref="S3.E17.m1.6.6.2.2.1.4.cmml">s</mi></mrow></mrow><mn id="S3.E17.m1.11.11.2.2.2.2.2.3" xref="S3.E17.m1.11.11.2.2.2.2.2.3.cmml">1</mn><mrow id="S3.E17.m1.11.11.2.2.2.2a" xref="S3.E17.m1.11.11.2.2.2.2.cmml"></mrow><mo id="S3.E17.m1.11.11.2.2.2.2.3" xref="S3.E17.m1.11.11.2.2.2.2.3.cmml">′</mo></mmultiscripts><mo id="S3.E17.m1.12.12.3.3.3.6" xref="S3.E17.m1.12.12.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E17.m1.9.9" xref="S3.E17.m1.9.9.cmml">…</mi><mo id="S3.E17.m1.12.12.3.3.3.7" xref="S3.E17.m1.12.12.3.3.4.cmml">,</mo><mmultiscripts id="S3.E17.m1.12.12.3.3.3.3" xref="S3.E17.m1.12.12.3.3.3.3.cmml"><mi id="S3.E17.m1.12.12.3.3.3.3.2.2.2" xref="S3.E17.m1.12.12.3.3.3.3.2.2.2.cmml">𝐯</mi><mrow id="S3.E17.m1.8.8.2.2" xref="S3.E17.m1.8.8.2.3.cmml"><mi id="S3.E17.m1.7.7.1.1" xref="S3.E17.m1.7.7.1.1.cmml">i</mi><mo id="S3.E17.m1.8.8.2.2.2" xref="S3.E17.m1.8.8.2.3.cmml">,</mo><mrow id="S3.E17.m1.8.8.2.2.1" xref="S3.E17.m1.8.8.2.2.1.cmml"><mi id="S3.E17.m1.8.8.2.2.1.2" xref="S3.E17.m1.8.8.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.8.8.2.2.1.1" xref="S3.E17.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E17.m1.8.8.2.2.1.3" xref="S3.E17.m1.8.8.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.8.8.2.2.1.1a" xref="S3.E17.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E17.m1.8.8.2.2.1.4" xref="S3.E17.m1.8.8.2.2.1.4.cmml">s</mi></mrow></mrow><mi id="S3.E17.m1.12.12.3.3.3.3.2.3" xref="S3.E17.m1.12.12.3.3.3.3.2.3.cmml">r</mi><mrow id="S3.E17.m1.12.12.3.3.3.3a" xref="S3.E17.m1.12.12.3.3.3.3.cmml"></mrow><mo id="S3.E17.m1.12.12.3.3.3.3.3" xref="S3.E17.m1.12.12.3.3.3.3.3.cmml">′</mo></mmultiscripts><mo stretchy="false" id="S3.E17.m1.12.12.3.3.3.8" xref="S3.E17.m1.12.12.3.3.4.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.12b"><apply id="S3.E17.m1.12.12.cmml" xref="S3.E17.m1.12.12"><eq id="S3.E17.m1.12.12.4.cmml" xref="S3.E17.m1.12.12.4"></eq><apply id="S3.E17.m1.12.12.5.cmml" xref="S3.E17.m1.12.12.5"><csymbol cd="ambiguous" id="S3.E17.m1.12.12.5.1.cmml" xref="S3.E17.m1.12.12.5">superscript</csymbol><ci id="S3.E17.m1.12.12.5.2.cmml" xref="S3.E17.m1.12.12.5.2">𝑉</ci><list id="S3.E17.m1.2.2.2.3.cmml" xref="S3.E17.m1.2.2.2.4"><ci id="S3.E17.m1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1">𝑖</ci><ci id="S3.E17.m1.2.2.2.2.cmml" xref="S3.E17.m1.2.2.2.2">𝑟</ci></list></apply><apply id="S3.E17.m1.12.12.3.cmml" xref="S3.E17.m1.12.12.3"><times id="S3.E17.m1.12.12.3.4.cmml" xref="S3.E17.m1.12.12.3.4"></times><apply id="S3.E17.m1.12.12.3.5.cmml" xref="S3.E17.m1.12.12.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.12.12.3.5.1.cmml" xref="S3.E17.m1.12.12.3.5">superscript</csymbol><apply id="S3.E17.m1.12.12.3.5.2.cmml" xref="S3.E17.m1.12.12.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.12.12.3.5.2.1.cmml" xref="S3.E17.m1.12.12.3.5">subscript</csymbol><ci id="S3.E17.m1.12.12.3.5.2.2.cmml" xref="S3.E17.m1.12.12.3.5.2.2">𝑊</ci><ci id="S3.E17.m1.12.12.3.5.2.3.cmml" xref="S3.E17.m1.12.12.3.5.2.3">𝑉</ci></apply><ci id="S3.E17.m1.12.12.3.5.3.cmml" xref="S3.E17.m1.12.12.3.5.3">𝑟</ci></apply><list id="S3.E17.m1.12.12.3.3.4.cmml" xref="S3.E17.m1.12.12.3.3.3"><apply id="S3.E17.m1.10.10.1.1.1.1.cmml" xref="S3.E17.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.10.10.1.1.1.1.1.cmml" xref="S3.E17.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E17.m1.10.10.1.1.1.1.2.cmml" xref="S3.E17.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.10.10.1.1.1.1.2.1.cmml" xref="S3.E17.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E17.m1.10.10.1.1.1.1.2.2.cmml" xref="S3.E17.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.10.10.1.1.1.1.2.2.1.cmml" xref="S3.E17.m1.10.10.1.1.1.1">subscript</csymbol><ci id="S3.E17.m1.10.10.1.1.1.1.2.2.2.cmml" xref="S3.E17.m1.10.10.1.1.1.1.2.2.2">𝐯</ci><list id="S3.E17.m1.4.4.2.3.cmml" xref="S3.E17.m1.4.4.2.2"><ci id="S3.E17.m1.3.3.1.1.cmml" xref="S3.E17.m1.3.3.1.1">𝑖</ci><apply id="S3.E17.m1.4.4.2.2.1.cmml" xref="S3.E17.m1.4.4.2.2.1"><times id="S3.E17.m1.4.4.2.2.1.1.cmml" xref="S3.E17.m1.4.4.2.2.1.1"></times><ci id="S3.E17.m1.4.4.2.2.1.2.cmml" xref="S3.E17.m1.4.4.2.2.1.2">𝑐</ci><ci id="S3.E17.m1.4.4.2.2.1.3.cmml" xref="S3.E17.m1.4.4.2.2.1.3">𝑙</ci><ci id="S3.E17.m1.4.4.2.2.1.4.cmml" xref="S3.E17.m1.4.4.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E17.m1.10.10.1.1.1.1.2.3.cmml" xref="S3.E17.m1.10.10.1.1.1.1.2.3">0</cn></apply><ci id="S3.E17.m1.10.10.1.1.1.1.3.cmml" xref="S3.E17.m1.10.10.1.1.1.1.3">′</ci></apply><apply id="S3.E17.m1.11.11.2.2.2.2.cmml" xref="S3.E17.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.11.11.2.2.2.2.1.cmml" xref="S3.E17.m1.11.11.2.2.2.2">superscript</csymbol><apply id="S3.E17.m1.11.11.2.2.2.2.2.cmml" xref="S3.E17.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.11.11.2.2.2.2.2.1.cmml" xref="S3.E17.m1.11.11.2.2.2.2">superscript</csymbol><apply id="S3.E17.m1.11.11.2.2.2.2.2.2.cmml" xref="S3.E17.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.11.11.2.2.2.2.2.2.1.cmml" xref="S3.E17.m1.11.11.2.2.2.2">subscript</csymbol><ci id="S3.E17.m1.11.11.2.2.2.2.2.2.2.cmml" xref="S3.E17.m1.11.11.2.2.2.2.2.2.2">𝐯</ci><list id="S3.E17.m1.6.6.2.3.cmml" xref="S3.E17.m1.6.6.2.2"><ci id="S3.E17.m1.5.5.1.1.cmml" xref="S3.E17.m1.5.5.1.1">𝑖</ci><apply id="S3.E17.m1.6.6.2.2.1.cmml" xref="S3.E17.m1.6.6.2.2.1"><times id="S3.E17.m1.6.6.2.2.1.1.cmml" xref="S3.E17.m1.6.6.2.2.1.1"></times><ci id="S3.E17.m1.6.6.2.2.1.2.cmml" xref="S3.E17.m1.6.6.2.2.1.2">𝑐</ci><ci id="S3.E17.m1.6.6.2.2.1.3.cmml" xref="S3.E17.m1.6.6.2.2.1.3">𝑙</ci><ci id="S3.E17.m1.6.6.2.2.1.4.cmml" xref="S3.E17.m1.6.6.2.2.1.4">𝑠</ci></apply></list></apply><cn type="integer" id="S3.E17.m1.11.11.2.2.2.2.2.3.cmml" xref="S3.E17.m1.11.11.2.2.2.2.2.3">1</cn></apply><ci id="S3.E17.m1.11.11.2.2.2.2.3.cmml" xref="S3.E17.m1.11.11.2.2.2.2.3">′</ci></apply><ci id="S3.E17.m1.9.9.cmml" xref="S3.E17.m1.9.9">…</ci><apply id="S3.E17.m1.12.12.3.3.3.3.cmml" xref="S3.E17.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E17.m1.12.12.3.3.3.3.1.cmml" xref="S3.E17.m1.12.12.3.3.3.3">superscript</csymbol><apply id="S3.E17.m1.12.12.3.3.3.3.2.cmml" xref="S3.E17.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E17.m1.12.12.3.3.3.3.2.1.cmml" xref="S3.E17.m1.12.12.3.3.3.3">superscript</csymbol><apply id="S3.E17.m1.12.12.3.3.3.3.2.2.cmml" xref="S3.E17.m1.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S3.E17.m1.12.12.3.3.3.3.2.2.1.cmml" xref="S3.E17.m1.12.12.3.3.3.3">subscript</csymbol><ci id="S3.E17.m1.12.12.3.3.3.3.2.2.2.cmml" xref="S3.E17.m1.12.12.3.3.3.3.2.2.2">𝐯</ci><list id="S3.E17.m1.8.8.2.3.cmml" xref="S3.E17.m1.8.8.2.2"><ci id="S3.E17.m1.7.7.1.1.cmml" xref="S3.E17.m1.7.7.1.1">𝑖</ci><apply id="S3.E17.m1.8.8.2.2.1.cmml" xref="S3.E17.m1.8.8.2.2.1"><times id="S3.E17.m1.8.8.2.2.1.1.cmml" xref="S3.E17.m1.8.8.2.2.1.1"></times><ci id="S3.E17.m1.8.8.2.2.1.2.cmml" xref="S3.E17.m1.8.8.2.2.1.2">𝑐</ci><ci id="S3.E17.m1.8.8.2.2.1.3.cmml" xref="S3.E17.m1.8.8.2.2.1.3">𝑙</ci><ci id="S3.E17.m1.8.8.2.2.1.4.cmml" xref="S3.E17.m1.8.8.2.2.1.4">𝑠</ci></apply></list></apply><ci id="S3.E17.m1.12.12.3.3.3.3.2.3.cmml" xref="S3.E17.m1.12.12.3.3.3.3.2.3">𝑟</ci></apply><ci id="S3.E17.m1.12.12.3.3.3.3.3.cmml" xref="S3.E17.m1.12.12.3.3.3.3.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.12c">V^{i,r}=W_{V}^{r}[{\mathbf{v}_{i,cls}^{0}}^{\prime},{\mathbf{v}_{i,cls}^{1}}^{\prime},...,{\mathbf{v}_{i,cls}^{r}}^{\prime}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<table id="S3.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E18.m1.6" class="ltx_Math" alttext="{\mathbf{v}_{i+1,cls}^{j}}=\begin{cases}{\mathbf{v}_{i,cls}^{j}}^{\prime}+\mathrm{Attn}(Q^{i,r},K^{i,r},V^{i,r}),&amp;j=0\\
{\mathbf{v}_{i,cls}^{j}}^{\prime},&amp;j&gt;0\end{cases}" display="block"><semantics id="S3.E18.m1.6a"><mrow id="S3.E18.m1.6.7" xref="S3.E18.m1.6.7.cmml"><msubsup id="S3.E18.m1.6.7.2" xref="S3.E18.m1.6.7.2.cmml"><mi id="S3.E18.m1.6.7.2.2.2" xref="S3.E18.m1.6.7.2.2.2.cmml">𝐯</mi><mrow id="S3.E18.m1.6.6.2.2" xref="S3.E18.m1.6.6.2.3.cmml"><mrow id="S3.E18.m1.5.5.1.1.1" xref="S3.E18.m1.5.5.1.1.1.cmml"><mi id="S3.E18.m1.5.5.1.1.1.2" xref="S3.E18.m1.5.5.1.1.1.2.cmml">i</mi><mo id="S3.E18.m1.5.5.1.1.1.1" xref="S3.E18.m1.5.5.1.1.1.1.cmml">+</mo><mn id="S3.E18.m1.5.5.1.1.1.3" xref="S3.E18.m1.5.5.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E18.m1.6.6.2.2.3" xref="S3.E18.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E18.m1.6.6.2.2.2" xref="S3.E18.m1.6.6.2.2.2.cmml"><mi id="S3.E18.m1.6.6.2.2.2.2" xref="S3.E18.m1.6.6.2.2.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.6.6.2.2.2.1" xref="S3.E18.m1.6.6.2.2.2.1.cmml">​</mo><mi id="S3.E18.m1.6.6.2.2.2.3" xref="S3.E18.m1.6.6.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.6.6.2.2.2.1a" xref="S3.E18.m1.6.6.2.2.2.1.cmml">​</mo><mi id="S3.E18.m1.6.6.2.2.2.4" xref="S3.E18.m1.6.6.2.2.2.4.cmml">s</mi></mrow></mrow><mi id="S3.E18.m1.6.7.2.3" xref="S3.E18.m1.6.7.2.3.cmml">j</mi></msubsup><mo id="S3.E18.m1.6.7.1" xref="S3.E18.m1.6.7.1.cmml">=</mo><mrow id="S3.E18.m1.4.4" xref="S3.E18.m1.6.7.3.1.cmml"><mo id="S3.E18.m1.4.4.5" xref="S3.E18.m1.6.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E18.m1.4.4.4" xref="S3.E18.m1.6.7.3.1.cmml"><mtr id="S3.E18.m1.4.4.4a" xref="S3.E18.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E18.m1.4.4.4b" xref="S3.E18.m1.6.7.3.1.cmml"><mrow id="S3.E18.m1.1.1.1.1.1.1.9" xref="S3.E18.m1.1.1.1.1.1.1.9.1.cmml"><mrow id="S3.E18.m1.1.1.1.1.1.1.9.1" xref="S3.E18.m1.1.1.1.1.1.1.9.1.cmml"><mmultiscripts id="S3.E18.m1.1.1.1.1.1.1.9.1.5" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.2.2.cmml">𝐯</mi><mrow id="S3.E18.m1.1.1.1.1.1.1.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E18.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.2" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.3" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.1a" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.4" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.4.cmml">s</mi></mrow></mrow><mi id="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.3" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.3.cmml">j</mi><mrow id="S3.E18.m1.1.1.1.1.1.1.9.1.5a" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5.cmml"></mrow><mo id="S3.E18.m1.1.1.1.1.1.1.9.1.5.3" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5.3.cmml">′</mo></mmultiscripts><mo id="S3.E18.m1.1.1.1.1.1.1.9.1.4" xref="S3.E18.m1.1.1.1.1.1.1.9.1.4.cmml">+</mo><mrow id="S3.E18.m1.1.1.1.1.1.1.9.1.3" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.9.1.3.5" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.5.cmml">Attn</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.1.1.1.1.9.1.3.4" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.4.cmml">​</mo><mrow id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.4.cmml"><mo stretchy="false" id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.4" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.4.cmml">(</mo><msup id="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1.2" xref="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.cmml">Q</mi><mrow id="S3.E18.m1.1.1.1.1.1.1.4.2.4" xref="S3.E18.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.3.1.1" xref="S3.E18.m1.1.1.1.1.1.1.3.1.1.cmml">i</mi><mo id="S3.E18.m1.1.1.1.1.1.1.4.2.4.1" xref="S3.E18.m1.1.1.1.1.1.1.4.2.3.cmml">,</mo><mi id="S3.E18.m1.1.1.1.1.1.1.4.2.2" xref="S3.E18.m1.1.1.1.1.1.1.4.2.2.cmml">r</mi></mrow></msup><mo id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.5" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.4.cmml">,</mo><msup id="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2.2.cmml">K</mi><mrow id="S3.E18.m1.1.1.1.1.1.1.6.2.4" xref="S3.E18.m1.1.1.1.1.1.1.6.2.3.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.5.1.1" xref="S3.E18.m1.1.1.1.1.1.1.5.1.1.cmml">i</mi><mo id="S3.E18.m1.1.1.1.1.1.1.6.2.4.1" xref="S3.E18.m1.1.1.1.1.1.1.6.2.3.cmml">,</mo><mi id="S3.E18.m1.1.1.1.1.1.1.6.2.2" xref="S3.E18.m1.1.1.1.1.1.1.6.2.2.cmml">r</mi></mrow></msup><mo id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.6" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.4.cmml">,</mo><msup id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3.2" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3.2.cmml">V</mi><mrow id="S3.E18.m1.1.1.1.1.1.1.8.2.4" xref="S3.E18.m1.1.1.1.1.1.1.8.2.3.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.7.1.1" xref="S3.E18.m1.1.1.1.1.1.1.7.1.1.cmml">i</mi><mo id="S3.E18.m1.1.1.1.1.1.1.8.2.4.1" xref="S3.E18.m1.1.1.1.1.1.1.8.2.3.cmml">,</mo><mi id="S3.E18.m1.1.1.1.1.1.1.8.2.2" xref="S3.E18.m1.1.1.1.1.1.1.8.2.2.cmml">r</mi></mrow></msup><mo stretchy="false" id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.7" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E18.m1.1.1.1.1.1.1.9.2" xref="S3.E18.m1.1.1.1.1.1.1.9.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E18.m1.4.4.4c" xref="S3.E18.m1.6.7.3.1.cmml"><mrow id="S3.E18.m1.2.2.2.2.2.1" xref="S3.E18.m1.2.2.2.2.2.1.cmml"><mi id="S3.E18.m1.2.2.2.2.2.1.2" xref="S3.E18.m1.2.2.2.2.2.1.2.cmml">j</mi><mo id="S3.E18.m1.2.2.2.2.2.1.1" xref="S3.E18.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="S3.E18.m1.2.2.2.2.2.1.3" xref="S3.E18.m1.2.2.2.2.2.1.3.cmml">0</mn></mrow></mtd></mtr><mtr id="S3.E18.m1.4.4.4d" xref="S3.E18.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E18.m1.4.4.4e" xref="S3.E18.m1.6.7.3.1.cmml"><mrow id="S3.E18.m1.3.3.3.3.1.1.3" xref="S3.E18.m1.3.3.3.3.1.1.3.1.cmml"><mmultiscripts id="S3.E18.m1.3.3.3.3.1.1.3.1" xref="S3.E18.m1.3.3.3.3.1.1.3.1.cmml"><mi id="S3.E18.m1.3.3.3.3.1.1.3.1.2.2.2" xref="S3.E18.m1.3.3.3.3.1.1.3.1.2.2.2.cmml">𝐯</mi><mrow id="S3.E18.m1.3.3.3.3.1.1.2.2.2" xref="S3.E18.m1.3.3.3.3.1.1.2.2.3.cmml"><mi id="S3.E18.m1.3.3.3.3.1.1.1.1.1" xref="S3.E18.m1.3.3.3.3.1.1.1.1.1.cmml">i</mi><mo id="S3.E18.m1.3.3.3.3.1.1.2.2.2.2" xref="S3.E18.m1.3.3.3.3.1.1.2.2.3.cmml">,</mo><mrow id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.cmml"><mi id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.2" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.1" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.3" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.1a" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.4" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.4.cmml">s</mi></mrow></mrow><mi id="S3.E18.m1.3.3.3.3.1.1.3.1.2.3" xref="S3.E18.m1.3.3.3.3.1.1.3.1.2.3.cmml">j</mi><mrow id="S3.E18.m1.3.3.3.3.1.1.3.1a" xref="S3.E18.m1.3.3.3.3.1.1.3.1.cmml"></mrow><mo id="S3.E18.m1.3.3.3.3.1.1.3.1.3" xref="S3.E18.m1.3.3.3.3.1.1.3.1.3.cmml">′</mo></mmultiscripts><mo id="S3.E18.m1.3.3.3.3.1.1.3.2" xref="S3.E18.m1.3.3.3.3.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E18.m1.4.4.4f" xref="S3.E18.m1.6.7.3.1.cmml"><mrow id="S3.E18.m1.4.4.4.4.2.1" xref="S3.E18.m1.4.4.4.4.2.1.cmml"><mi id="S3.E18.m1.4.4.4.4.2.1.2" xref="S3.E18.m1.4.4.4.4.2.1.2.cmml">j</mi><mo id="S3.E18.m1.4.4.4.4.2.1.1" xref="S3.E18.m1.4.4.4.4.2.1.1.cmml">&gt;</mo><mn id="S3.E18.m1.4.4.4.4.2.1.3" xref="S3.E18.m1.4.4.4.4.2.1.3.cmml">0</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.6b"><apply id="S3.E18.m1.6.7.cmml" xref="S3.E18.m1.6.7"><eq id="S3.E18.m1.6.7.1.cmml" xref="S3.E18.m1.6.7.1"></eq><apply id="S3.E18.m1.6.7.2.cmml" xref="S3.E18.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E18.m1.6.7.2.1.cmml" xref="S3.E18.m1.6.7.2">superscript</csymbol><apply id="S3.E18.m1.6.7.2.2.cmml" xref="S3.E18.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E18.m1.6.7.2.2.1.cmml" xref="S3.E18.m1.6.7.2">subscript</csymbol><ci id="S3.E18.m1.6.7.2.2.2.cmml" xref="S3.E18.m1.6.7.2.2.2">𝐯</ci><list id="S3.E18.m1.6.6.2.3.cmml" xref="S3.E18.m1.6.6.2.2"><apply id="S3.E18.m1.5.5.1.1.1.cmml" xref="S3.E18.m1.5.5.1.1.1"><plus id="S3.E18.m1.5.5.1.1.1.1.cmml" xref="S3.E18.m1.5.5.1.1.1.1"></plus><ci id="S3.E18.m1.5.5.1.1.1.2.cmml" xref="S3.E18.m1.5.5.1.1.1.2">𝑖</ci><cn type="integer" id="S3.E18.m1.5.5.1.1.1.3.cmml" xref="S3.E18.m1.5.5.1.1.1.3">1</cn></apply><apply id="S3.E18.m1.6.6.2.2.2.cmml" xref="S3.E18.m1.6.6.2.2.2"><times id="S3.E18.m1.6.6.2.2.2.1.cmml" xref="S3.E18.m1.6.6.2.2.2.1"></times><ci id="S3.E18.m1.6.6.2.2.2.2.cmml" xref="S3.E18.m1.6.6.2.2.2.2">𝑐</ci><ci id="S3.E18.m1.6.6.2.2.2.3.cmml" xref="S3.E18.m1.6.6.2.2.2.3">𝑙</ci><ci id="S3.E18.m1.6.6.2.2.2.4.cmml" xref="S3.E18.m1.6.6.2.2.2.4">𝑠</ci></apply></list></apply><ci id="S3.E18.m1.6.7.2.3.cmml" xref="S3.E18.m1.6.7.2.3">𝑗</ci></apply><apply id="S3.E18.m1.6.7.3.1.cmml" xref="S3.E18.m1.4.4"><csymbol cd="latexml" id="S3.E18.m1.6.7.3.1.1.cmml" xref="S3.E18.m1.4.4.5">cases</csymbol><apply id="S3.E18.m1.1.1.1.1.1.1.9.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9"><plus id="S3.E18.m1.1.1.1.1.1.1.9.1.4.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.4"></plus><apply id="S3.E18.m1.1.1.1.1.1.1.9.1.5.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.9.1.5.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5">superscript</csymbol><apply id="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5">superscript</csymbol><apply id="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.2.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5">subscript</csymbol><ci id="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.2.2">𝐯</ci><list id="S3.E18.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2"><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1">𝑖</ci><apply id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1"><times id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.1"></times><ci id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.2">𝑐</ci><ci id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.3">𝑙</ci><ci id="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.4.cmml" xref="S3.E18.m1.1.1.1.1.1.1.2.2.2.1.4">𝑠</ci></apply></list></apply><ci id="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5.2.3">𝑗</ci></apply><ci id="S3.E18.m1.1.1.1.1.1.1.9.1.5.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.5.3">′</ci></apply><apply id="S3.E18.m1.1.1.1.1.1.1.9.1.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3"><times id="S3.E18.m1.1.1.1.1.1.1.9.1.3.4.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.4"></times><ci id="S3.E18.m1.1.1.1.1.1.1.9.1.3.5.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.5">Attn</ci><vector id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.4.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3"><apply id="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1">superscript</csymbol><ci id="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.1.1.1.1.2">𝑄</ci><list id="S3.E18.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.4.2.4"><ci id="S3.E18.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.3.1.1">𝑖</ci><ci id="S3.E18.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.4.2.2">𝑟</ci></list></apply><apply id="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2">superscript</csymbol><ci id="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.2.2.2.2.2">𝐾</ci><list id="S3.E18.m1.1.1.1.1.1.1.6.2.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.6.2.4"><ci id="S3.E18.m1.1.1.1.1.1.1.5.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.5.1.1">𝑖</ci><ci id="S3.E18.m1.1.1.1.1.1.1.6.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.6.2.2">𝑟</ci></list></apply><apply id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3">superscript</csymbol><ci id="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.9.1.3.3.3.3.2">𝑉</ci><list id="S3.E18.m1.1.1.1.1.1.1.8.2.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.8.2.4"><ci id="S3.E18.m1.1.1.1.1.1.1.7.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.7.1.1">𝑖</ci><ci id="S3.E18.m1.1.1.1.1.1.1.8.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.8.2.2">𝑟</ci></list></apply></vector></apply></apply><apply id="S3.E18.m1.2.2.2.2.2.1.cmml" xref="S3.E18.m1.2.2.2.2.2.1"><eq id="S3.E18.m1.2.2.2.2.2.1.1.cmml" xref="S3.E18.m1.2.2.2.2.2.1.1"></eq><ci id="S3.E18.m1.2.2.2.2.2.1.2.cmml" xref="S3.E18.m1.2.2.2.2.2.1.2">𝑗</ci><cn type="integer" id="S3.E18.m1.2.2.2.2.2.1.3.cmml" xref="S3.E18.m1.2.2.2.2.2.1.3">0</cn></apply><apply id="S3.E18.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E18.m1.3.3.3.3.1.1.3.1.1.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3">superscript</csymbol><apply id="S3.E18.m1.3.3.3.3.1.1.3.1.2.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E18.m1.3.3.3.3.1.1.3.1.2.1.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3">superscript</csymbol><apply id="S3.E18.m1.3.3.3.3.1.1.3.1.2.2.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E18.m1.3.3.3.3.1.1.3.1.2.2.1.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E18.m1.3.3.3.3.1.1.3.1.2.2.2.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3.1.2.2.2">𝐯</ci><list id="S3.E18.m1.3.3.3.3.1.1.2.2.3.cmml" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2"><ci id="S3.E18.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E18.m1.3.3.3.3.1.1.1.1.1">𝑖</ci><apply id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1"><times id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.1.cmml" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.1"></times><ci id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.2.cmml" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.2">𝑐</ci><ci id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.3.cmml" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.3">𝑙</ci><ci id="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.4.cmml" xref="S3.E18.m1.3.3.3.3.1.1.2.2.2.1.4">𝑠</ci></apply></list></apply><ci id="S3.E18.m1.3.3.3.3.1.1.3.1.2.3.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3.1.2.3">𝑗</ci></apply><ci id="S3.E18.m1.3.3.3.3.1.1.3.1.3.cmml" xref="S3.E18.m1.3.3.3.3.1.1.3.1.3">′</ci></apply><apply id="S3.E18.m1.4.4.4.4.2.1.cmml" xref="S3.E18.m1.4.4.4.4.2.1"><gt id="S3.E18.m1.4.4.4.4.2.1.1.cmml" xref="S3.E18.m1.4.4.4.4.2.1.1"></gt><ci id="S3.E18.m1.4.4.4.4.2.1.2.cmml" xref="S3.E18.m1.4.4.4.4.2.1.2">𝑗</ci><cn type="integer" id="S3.E18.m1.4.4.4.4.2.1.3.cmml" xref="S3.E18.m1.4.4.4.4.2.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.6c">{\mathbf{v}_{i+1,cls}^{j}}=\begin{cases}{\mathbf{v}_{i,cls}^{j}}^{\prime}+\mathrm{Attn}(Q^{i,r},K^{i,r},V^{i,r}),&amp;j=0\\
{\mathbf{v}_{i,cls}^{j}}^{\prime},&amp;j&gt;0\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2303.00534/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="438" height="362" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S3.F4.3.2" class="ltx_text" style="font-size:90%;">The architecture of retrieval-attention for text modality.
</span></figcaption>
</figure>
<div id="S3.SS4.SSS0.Px2.p4" class="ltx_para">
<p id="S3.SS4.SSS0.Px2.p4.5" class="ltx_p">We perform retrieval-attention on original representations <math id="S3.SS4.SSS0.Px2.p4.1.m1.1" class="ltx_Math" alttext="{\mathbf{w}_{i}^{0}}^{\prime}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p4.1.m1.1a"><mmultiscripts id="S3.SS4.SSS0.Px2.p4.1.m1.1.1" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.3.cmml">i</mi><mn id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.3.cmml">0</mn><mrow id="S3.SS4.SSS0.Px2.p4.1.m1.1.1a" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.3" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.3.cmml">′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p4.1.m1.1b"><apply id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.2.3">0</cn></apply><ci id="S3.SS4.SSS0.Px2.p4.1.m1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p4.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p4.1.m1.1c">{\mathbf{w}_{i}^{0}}^{\prime}</annotation></semantics></math> or <math id="S3.SS4.SSS0.Px2.p4.2.m2.1" class="ltx_Math" alttext="{\mathbf{v}_{i}^{0}}^{\prime}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p4.2.m2.1a"><mmultiscripts id="S3.SS4.SSS0.Px2.p4.2.m2.1.1" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.2.cmml">𝐯</mi><mi id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.3.cmml">i</mi><mn id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.3" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.3.cmml">0</mn><mrow id="S3.SS4.SSS0.Px2.p4.2.m2.1.1a" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.3" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.3.cmml">′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p4.2.m2.1b"><apply id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.2">𝐯</ci><ci id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.2.3">0</cn></apply><ci id="S3.SS4.SSS0.Px2.p4.2.m2.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p4.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p4.2.m2.1c">{\mathbf{v}_{i}^{0}}^{\prime}</annotation></semantics></math> to fuse additional information from <math id="S3.SS4.SSS0.Px2.p4.3.m3.2" class="ltx_Math" alttext="\{{\mathbf{w}_{i}^{j}}^{\prime}|1\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p4.3.m3.2a"><mrow id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.3" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.3.1.cmml">{</mo><mmultiscripts id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1a" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.4" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.2.cmml">1</mn><mo id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.5" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p4.3.m3.2b"><apply id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.1.1.1.1.3">′</ci></apply><apply id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.2">1</cn><ci id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p4.3.m3.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p4.3.m3.2c">\{{\mathbf{w}_{i}^{j}}^{\prime}|1\leq j\leq r\}</annotation></semantics></math> or <math id="S3.SS4.SSS0.Px2.p4.4.m4.2" class="ltx_Math" alttext="\{{\mathbf{v}_{i}^{j}}^{\prime}|1\leq j\leq r\}" display="inline"><semantics id="S3.SS4.SSS0.Px2.p4.4.m4.2a"><mrow id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.3" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.3.1.cmml">{</mo><mmultiscripts id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.2.cmml">𝐯</mi><mi id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1a" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.cmml"></mrow><mo id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.4" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.3.1.cmml">|</mo><mrow id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.cmml"><mn id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.2.cmml">1</mn><mo id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.4" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.4.cmml">j</mi><mo id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.5" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.6" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.6.cmml">r</mi></mrow><mo stretchy="false" id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.5" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p4.4.m4.2b"><apply id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2"><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.3">conditional-set</csymbol><apply id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.2">𝐯</ci><ci id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.1.1.1.1.3">′</ci></apply><apply id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2"><and id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2"></and><apply id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.3"></leq><cn type="integer" id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.2">1</cn><ci id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.4">𝑗</ci></apply><apply id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2"><leq id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.5"></leq><share href="#S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2"></share><ci id="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.6.cmml" xref="S3.SS4.SSS0.Px2.p4.4.m4.2.2.2.2.6">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p4.4.m4.2c">\{{\mathbf{v}_{i}^{j}}^{\prime}|1\leq j\leq r\}</annotation></semantics></math>.
We do not apply it to retrieved samples since we do not need to exchange information among them.
We use the final layer of origin samples representations <math id="S3.SS4.SSS0.Px2.p4.5.m5.2" class="ltx_Math" alttext="({\mathbf{w}_{L}^{0}},{\mathbf{v}_{L}^{0}})" display="inline"><semantics id="S3.SS4.SSS0.Px2.p4.5.m5.2a"><mrow id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.3" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.3.cmml">(</mo><msubsup id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.3.cmml">L</mi><mn id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.3.cmml">0</mn></msubsup><mo id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.4" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.3.cmml">,</mo><msubsup id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.2.cmml">𝐯</mi><mi id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.3.cmml">L</mi><mn id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.5" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p4.5.m5.2b"><interval closure="open" id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2"><apply id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.2">𝐰</ci><ci id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.2.3">𝐿</ci></apply><cn type="integer" id="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.1.1.1.1.3">0</cn></apply><apply id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2">superscript</csymbol><apply id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.2">𝐯</ci><ci id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.2.3">𝐿</ci></apply><cn type="integer" id="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p4.5.m5.2.2.2.2.3">0</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p4.5.m5.2c">({\mathbf{w}_{L}^{0}},{\mathbf{v}_{L}^{0}})</annotation></semantics></math> for VQA classification.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We conduct experiments on four biomedical VQA datasets as VQA-Med 2019 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, VQA-Med 2021 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, VQARAD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, and SLAKE (English Version) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
To fairly compare with previous works, we follow the same data split with Chen <em id="S4.SS1.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S4.SS1.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> for VQA-Med 2019, VQARAD, and SLAKE, as well as Gong <em id="S4.SS1.p1.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S4.SS1.p1.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> for VQA-Med 2021.
We use accuracy to measure model performance.
Detailed statistics of these datasets are listed in Appendix A.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Baselines</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We compare RAMM with non-pretrained methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and pre-trained methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> in biomedical VQA.
We introduce the following methods since they are more related to us:</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">PubmedCLIP</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> fine-tunes CLIP with ROCO to obtain the biomedical image and text representations.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p"><span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_bold">MMBert</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> feeds CNN features of images with masked tokens to apply masked language model pretraining.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.1" class="ltx_p"><span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_bold">MTPT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposes a multi-task pretraining with an image understanding task and a question-image compatibility task.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.p5.1" class="ltx_p"><span id="S4.SS2.p5.1.1" class="ltx_text ltx_font_bold">M3AE</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> pretrains a biomedical multi-modal model by reconstructing masked tokens and images.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Implementation Details</h3>

<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Pre-training Data</h5>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p1.1" class="ltx_p">As introduced in Section <a href="#S3.SS1" title="3.1 PMCPM Dataset ‣ 3 Approach ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we collect 398k biomedical image-text pairs of publication quality and various types from PMC OA as PMCPM. Then, we combine the PMCPM with two widely-used biomedical pretrained datasets ROCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> and MIMIC-CXR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> for model pre-training. Following the previous work, we only use their train splits as pretraining datasets and only use images in frontal view for MIMIC-CXR.
The statistics of training data are shown in Table <a href="#S4.T1" title="Table 1 ‣ Pre-training Data ‣ 4.3 Implementation Details ‣ 4 Experiments ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.2.1.1" class="ltx_tr">
<th id="S4.T1.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Dataset</th>
<th id="S4.T1.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Count</th>
<th id="S4.T1.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Sources</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.2.2.1" class="ltx_tr">
<th id="S4.T1.2.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ROCO</th>
<td id="S4.T1.2.2.1.2" class="ltx_td ltx_align_center ltx_border_t">70,306</td>
<td id="S4.T1.2.2.1.3" class="ltx_td ltx_align_center ltx_border_t">PubMed</td>
</tr>
<tr id="S4.T1.2.3.2" class="ltx_tr">
<th id="S4.T1.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MIMIC-CXR</th>
<td id="S4.T1.2.3.2.2" class="ltx_td ltx_align_center">225,829</td>
<td id="S4.T1.2.3.2.3" class="ltx_td ltx_align_center">BIDMC</td>
</tr>
<tr id="S4.T1.2.4.3" class="ltx_tr">
<th id="S4.T1.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">PMCPM</th>
<td id="S4.T1.2.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">398,109</td>
<td id="S4.T1.2.4.3.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.2.4.3.3.1" class="ltx_text ltx_font_italic">Case Report</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.4.2" class="ltx_text" style="font-size:90%;">Pretraining datasets statistics, where count reports the number of image-text pairs in their train splits. BIDMC is the abbreviation of Beth Israel Deaconess Medical Center.</span></figcaption>
</figure>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Pre-training Setting</h5>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px2.p1.3" class="ltx_p">For the uni-modal encoders, we initialize the text encoder by PubmedBert <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and the image encoder by Swin-Base <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.
For the multi-modal encoder, we apply a 6-layer Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> with hidden dimension <math id="S4.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="d=768" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">d</mi><mo id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">768</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1"><eq id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1"></eq><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2">𝑑</ci><cn type="integer" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3">768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">d=768</annotation></semantics></math> and head count <math id="S4.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="n_{head}=12" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><msub id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.2.cmml">n</mi><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.1a" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.4" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.1b" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.5" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.5.cmml">d</mi></mrow></msub><mo id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1"><eq id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1"></eq><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.2">𝑛</ci><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3"><times id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.1"></times><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.2">ℎ</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.3">𝑒</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.4.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.4">𝑎</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.5.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.3.5">𝑑</ci></apply></apply><cn type="integer" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.1c">n_{head}=12</annotation></semantics></math> with random initialization.
Images are transformed into resolutions <math id="S4.SS3.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.3.m3.1a"><mrow id="S4.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mn id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.1" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1"><times id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.1"></times><cn type="integer" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.2">224</cn><cn type="integer" id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.3.m3.1c">224\times 224</annotation></semantics></math> with RandAugment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.
We apply the momentum distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> with the momentum parameter as 0.995.
The model is trained for 30 epochs with a batch size of 512.
We use AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> to optimize our models with a linear learning rate decay.
For the detailed pretraining hyper-parameters, please refer to Appendix B.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Fine-tuning Setting</h5>

<div id="S4.SS3.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px3.p1.4" class="ltx_p">Following previous works, we regard biomedical VQA as a classification problem and optimize the model by the cross-entropy loss.
For all datasets, we fine-tune our pretrained models with 100 epochs.
We use frozen uni-modal encoders of RAMM to retrieve image-text pairs as mentioned in Section <a href="#S3.SS4" title="3.4 Retrieval-augmented Fine-tuning ‣ 3 Approach ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>.
We retrieve <math id="S4.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="r=4" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.cmml">r</mi><mo id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1"><eq id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.1"></eq><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2">𝑟</ci><cn type="integer" id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.1c">r=4</annotation></semantics></math> pairs for each instance from the combination of ROCO, MIMIC-CXR, and PMCPM.
Images are transformed into resolutions <math id="S4.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml"><mn id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1"><times id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1"></times><cn type="integer" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2">224</cn><cn type="integer" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.2.m2.1c">224\times 224</annotation></semantics></math> while fine-tuning.
In VQA-Med 2019, VQARAD, and SLAKE, we center crop images, while we use RandAugment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> in VQA-Med 2021.
Exponential moving average <math id="S4.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="\theta=0.999" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.3.m3.1a"><mrow id="S4.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml">θ</mi><mo id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1"><eq id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.1"></eq><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2">𝜃</ci><cn type="float" id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.3.m3.1c">\theta=0.999</annotation></semantics></math> and R-Drop <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> <math id="S4.SS3.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="\alpha=0.6" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.4.m4.1a"><mrow id="S4.SS3.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.cmml">α</mi><mo id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.4.m4.1b"><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1"><eq id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1"></eq><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2">𝛼</ci><cn type="float" id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.4.m4.1c">\alpha=0.6</annotation></semantics></math> are also used while fine-tuning.
We list detailed hyper-parameters in Appendix C.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.2.1.1" class="ltx_tr">
<th id="S4.T2.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S4.T2.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<td id="S4.T2.2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.2.1.1.2.1" class="ltx_text" style="font-size:90%;">VQAMed2019</span></td>
<td id="S4.T2.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.2.1.1.3.1" class="ltx_text" style="font-size:90%;">VQARAD</span></td>
<td id="S4.T2.2.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.2.1.1.4.1" class="ltx_text" style="font-size:90%;">SLAKE</span></td>
</tr>
<tr id="S4.T2.2.2.2" class="ltx_tr">
<th id="S4.T2.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><em id="S4.T2.2.2.2.1.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">No Pretraining</em></th>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.2.2.2.3" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.2.2.2.4" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T2.2.3.3" class="ltx_tr">
<th id="S4.T2.2.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.3.3.1.1" class="ltx_text" style="font-size:90%;">MFB </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.3.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib43" title="" class="ltx_ref">43</a><span id="S4.T2.2.3.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.3.3.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.3.3.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.2.3.3.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.3.3.3.1" class="ltx_text" style="font-size:90%;">50.60</span></td>
<td id="S4.T2.2.3.3.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.3.3.4.1" class="ltx_text" style="font-size:90%;">73.30</span></td>
</tr>
<tr id="S4.T2.2.4.4" class="ltx_tr">
<th id="S4.T2.2.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.4.4.1.1" class="ltx_text" style="font-size:90%;">SAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.4.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib42" title="" class="ltx_ref">42</a><span id="S4.T2.2.4.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.4.4.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.4.4.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.2.4.4.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.4.4.3.1" class="ltx_text" style="font-size:90%;">54.30</span></td>
<td id="S4.T2.2.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.4.4.4.1" class="ltx_text" style="font-size:90%;">76.00</span></td>
</tr>
<tr id="S4.T2.2.5.5" class="ltx_tr">
<th id="S4.T2.2.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.5.5.1.1" class="ltx_text" style="font-size:90%;">BAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.5.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T2.2.5.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.5.5.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.5.5.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.2.5.5.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.5.5.3.1" class="ltx_text" style="font-size:90%;">58.30</span></td>
<td id="S4.T2.2.5.5.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.5.5.4.1" class="ltx_text" style="font-size:90%;">76.30</span></td>
</tr>
<tr id="S4.T2.2.6.6" class="ltx_tr">
<th id="S4.T2.2.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><em id="S4.T2.2.6.6.1.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">With Pretraining</em></th>
<td id="S4.T2.2.6.6.2" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.2.6.6.3" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.2.6.6.4" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T2.2.7.7" class="ltx_tr">
<th id="S4.T2.2.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.7.7.1.1" class="ltx_text" style="font-size:90%;">MEVF-BAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.7.7.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T2.2.7.7.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.7.7.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.7.7.2.1" class="ltx_text" style="font-size:90%;">77.86</span></td>
<td id="S4.T2.2.7.7.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.7.7.3.1" class="ltx_text" style="font-size:90%;">66.10</span></td>
<td id="S4.T2.2.7.7.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.7.7.4.1" class="ltx_text" style="font-size:90%;">78.60</span></td>
</tr>
<tr id="S4.T2.2.8.8" class="ltx_tr">
<th id="S4.T2.2.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.8.8.1.1" class="ltx_text" style="font-size:90%;">CPRD-BAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.8.8.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib29" title="" class="ltx_ref">29</a><span id="S4.T2.2.8.8.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.8.8.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.8.8.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.2.8.8.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.8.8.3.1" class="ltx_text" style="font-size:90%;">67.80</span></td>
<td id="S4.T2.2.8.8.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.8.8.4.1" class="ltx_text" style="font-size:90%;">81.10</span></td>
</tr>
<tr id="S4.T2.2.9.9" class="ltx_tr">
<th id="S4.T2.2.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.9.9.1.1" class="ltx_text" style="font-size:90%;">COND-RE </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.9.9.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib46" title="" class="ltx_ref">46</a><span id="S4.T2.2.9.9.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.9.9.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.9.9.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.2.9.9.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.9.9.3.1" class="ltx_text" style="font-size:90%;">71.60</span></td>
<td id="S4.T2.2.9.9.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.9.9.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S4.T2.2.10.10" class="ltx_tr">
<th id="S4.T2.2.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.10.10.1.1" class="ltx_text" style="font-size:90%;">PubmedCLIP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.10.10.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T2.2.10.10.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.10.10.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.10.10.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.2.10.10.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.10.10.3.1" class="ltx_text" style="font-size:90%;">72.10</span></td>
<td id="S4.T2.2.10.10.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.10.10.4.1" class="ltx_text" style="font-size:90%;">80.10</span></td>
</tr>
<tr id="S4.T2.2.11.11" class="ltx_tr">
<th id="S4.T2.2.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.11.11.1.1" class="ltx_text" style="font-size:90%;">MMBert </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.11.11.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib20" title="" class="ltx_ref">20</a><span id="S4.T2.2.11.11.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.11.11.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.11.11.2.1" class="ltx_text" style="font-size:90%;">77.90</span></td>
<td id="S4.T2.2.11.11.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.11.11.3.1" class="ltx_text" style="font-size:90%;">72.00</span></td>
<td id="S4.T2.2.11.11.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.11.11.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S4.T2.2.12.12" class="ltx_tr">
<th id="S4.T2.2.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.12.12.1.1" class="ltx_text" style="font-size:90%;">MTPT </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.12.12.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="S4.T2.2.12.12.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.12.12.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.12.12.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.2.12.12.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.12.12.3.1" class="ltx_text" style="font-size:90%;">73.20</span></td>
<td id="S4.T2.2.12.12.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.12.12.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S4.T2.2.13.13" class="ltx_tr">
<th id="S4.T2.2.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.2.13.13.1.1" class="ltx_text" style="font-size:90%;">M3AE </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.2.13.13.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S4.T2.2.13.13.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.2.13.13.2" class="ltx_td ltx_align_center"><span id="S4.T2.2.13.13.2.1" class="ltx_text" style="font-size:90%;">79.87</span></td>
<td id="S4.T2.2.13.13.3" class="ltx_td ltx_align_center"><span id="S4.T2.2.13.13.3.1" class="ltx_text" style="font-size:90%;">77.01</span></td>
<td id="S4.T2.2.13.13.4" class="ltx_td ltx_align_center"><span id="S4.T2.2.13.13.4.1" class="ltx_text" style="font-size:90%;">83.25</span></td>
</tr>
<tr id="S4.T2.2.14.14" class="ltx_tr">
<th id="S4.T2.2.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T2.2.14.14.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">RAMM</span></th>
<td id="S4.T2.2.14.14.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.14.14.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.13</span></td>
<td id="S4.T2.2.14.14.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.14.14.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">78.27</span></td>
<td id="S4.T2.2.14.14.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.2.14.14.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">86.05</span></td>
</tr>
<tr id="S4.T2.2.15.15" class="ltx_tr">
<th id="S4.T2.2.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S4.T2.2.15.15.1.1" class="ltx_text" style="font-size:90%;">w/o retrieval</span></th>
<td id="S4.T2.2.15.15.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.15.15.2.1" class="ltx_text" style="font-size:90%;">80.27</span></td>
<td id="S4.T2.2.15.15.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.15.15.3.1" class="ltx_text" style="font-size:90%;">76.72</span></td>
<td id="S4.T2.2.15.15.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.2.15.15.4.1" class="ltx_text" style="font-size:90%;">85.58</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results on the VQA-Med 2019, VQARAD, and SLAKE dataset.</figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.2.1.1" class="ltx_tr">
<th id="S4.T3.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T3.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S4.T3.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.2.1.1.2.1" class="ltx_text" style="font-size:90%;">VQA-Med 2021</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.2.2.1" class="ltx_tr">
<th id="S4.T3.2.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S4.T3.2.2.1.1.1" class="ltx_text" style="font-size:90%;">VilMedic * </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.2.2.1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S4.T3.2.2.1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.2.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.2.2.1.2.1" class="ltx_text" style="font-size:90%;">37.80</span></td>
</tr>
<tr id="S4.T3.2.3.2" class="ltx_tr">
<th id="S4.T3.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T3.2.3.2.1.1" class="ltx_text" style="font-size:90%;">SYSU-HCP * </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.2.3.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib13" title="" class="ltx_ref">13</a><span id="S4.T3.2.3.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.2.3.2.2" class="ltx_td ltx_align_center"><span id="S4.T3.2.3.2.2.1" class="ltx_text" style="font-size:90%;">38.20</span></td>
</tr>
<tr id="S4.T3.2.4.3" class="ltx_tr">
<th id="S4.T3.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S4.T3.2.4.3.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">RAMM</span></th>
<td id="S4.T3.2.4.3.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.2.4.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">39.20</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results on the VQA-Med 2021. * indicates ensembled results.</figcaption>
</figure>
</section>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Main Results</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We compare our approach with baseline methods in four datasets.
As shown in Table <a href="#S4.T2" title="Table 2 ‣ Fine-tuning Setting ‣ 4.3 Implementation Details ‣ 4 Experiments ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, methods with pretrained models outperform non-pretrained models by a large margin.
Our proposed RAMM achieves 82.13, 78.27, and 86.05 on VQA-Med 2019, VQARAD, and SLAKE respectively, which exceeds the previous best result by 1.86, 1.26, and 2.80 respectively. Table 4 shows results on the VQA-Med 2021 dataset. Our RAMM achieves 39.20 in terms of accuracy, which even outperforms the state-of-the-art ensemble methods with 1.00 in the VQA-Med 2021 Challenge.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">We also report the result of our RAMM without retrieving additional image-text pairs on the VQA-Med 2019, VQARAD, and SLAKE datasets. As shown in Table <a href="#S4.T2" title="Table 2 ‣ Fine-tuning Setting ‣ 4.3 Implementation Details ‣ 4 Experiments ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, it achieves 80.27, 76.72, and 85.58 on VQA-Med 2019, VQARAD, and SLAKE respectively.
Without retrieval augmentation, RAMM still outperforms the previous state-of-the-art method M3AE on VQA-Med 2019 with 0.4 as well as SLAKE with 2.33 and performs on par on VQARAD (76.72 v.s. 77.01).
This indicates that the pretraining with additional PMCPM dataset learns better visual and textual representations for biomedical VQA tasks.
Compared with models without retrieval augmentation, we observe that our RAMM achieves consistent improvements of 1.90, 1.55, 0.47 on VQA-Med 2019, VQARAD, and SLAKE respectively, which demonstrates that our proposed retrieval augmentation can boost biomedical VQA performances.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.2.1.1" class="ltx_tr">
<td id="S4.T4.2.1.1.1" class="ltx_td ltx_border_tt"></td>
<td id="S4.T4.2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T4.2.1.1.2.1" class="ltx_text" style="font-size:90%;">Pre-training</span></td>
<td id="S4.T4.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T4.2.1.1.3.1" class="ltx_text" style="font-size:90%;">Retrieval</span></td>
<td id="S4.T4.2.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="3"><span id="S4.T4.2.1.1.4.1" class="ltx_text" style="font-size:90%;">VQA Datasets</span></td>
</tr>
<tr id="S4.T4.2.2.2" class="ltx_tr">
<td id="S4.T4.2.2.2.1" class="ltx_td"></td>
<td id="S4.T4.2.2.2.2" class="ltx_td ltx_align_center"><span id="S4.T4.2.2.2.2.1" class="ltx_text" style="font-size:90%;">PMCPM</span></td>
<td id="S4.T4.2.2.2.3" class="ltx_td ltx_align_center"><span id="S4.T4.2.2.2.3.1" class="ltx_text" style="font-size:90%;">ROCO+CXR</span></td>
<td id="S4.T4.2.2.2.4" class="ltx_td ltx_align_center"><span id="S4.T4.2.2.2.4.1" class="ltx_text" style="font-size:90%;">PMCPM</span></td>
<td id="S4.T4.2.2.2.5" class="ltx_td ltx_align_center"><span id="S4.T4.2.2.2.5.1" class="ltx_text" style="font-size:90%;">ROCO+CXR</span></td>
<td id="S4.T4.2.2.2.6" class="ltx_td ltx_align_center"><span id="S4.T4.2.2.2.6.1" class="ltx_text" style="font-size:90%;">VQAMed19</span></td>
<td id="S4.T4.2.2.2.7" class="ltx_td ltx_align_center"><span id="S4.T4.2.2.2.7.1" class="ltx_text" style="font-size:90%;">VQARAD</span></td>
<td id="S4.T4.2.2.2.8" class="ltx_td ltx_align_center"><span id="S4.T4.2.2.2.8.1" class="ltx_text" style="font-size:90%;">SLAKE</span></td>
</tr>
<tr id="S4.T4.2.3.3" class="ltx_tr">
<td id="S4.T4.2.3.3.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.3.3.1.1" class="ltx_text" style="font-size:90%;">(a)</span></td>
<td id="S4.T4.2.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.3.3.2.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.3.3.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.3.3.4.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.3.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.3.3.5.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.3.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.3.3.6.1" class="ltx_text" style="font-size:90%;">77.60</span></td>
<td id="S4.T4.2.3.3.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.3.3.7.1" class="ltx_text" style="font-size:90%;">74.06</span></td>
<td id="S4.T4.2.3.3.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.3.3.8.1" class="ltx_text" style="font-size:90%;">81.43</span></td>
</tr>
<tr id="S4.T4.2.4.4" class="ltx_tr">
<td id="S4.T4.2.4.4.1" class="ltx_td ltx_align_center"><span id="S4.T4.2.4.4.1.1" class="ltx_text" style="font-size:90%;">(b)</span></td>
<td id="S4.T4.2.4.4.2" class="ltx_td ltx_align_center"><span id="S4.T4.2.4.4.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.4.4.3" class="ltx_td ltx_align_center"><span id="S4.T4.2.4.4.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T4.2.4.4.4.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.4.4.5" class="ltx_td ltx_align_center"><span id="S4.T4.2.4.4.5.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.4.4.6" class="ltx_td ltx_align_center"><span id="S4.T4.2.4.4.6.1" class="ltx_text" style="font-size:90%;">78.40</span></td>
<td id="S4.T4.2.4.4.7" class="ltx_td ltx_align_center"><span id="S4.T4.2.4.4.7.1" class="ltx_text" style="font-size:90%;">74.94</span></td>
<td id="S4.T4.2.4.4.8" class="ltx_td ltx_align_center"><span id="S4.T4.2.4.4.8.1" class="ltx_text" style="font-size:90%;">83.60</span></td>
</tr>
<tr id="S4.T4.2.5.5" class="ltx_tr">
<td id="S4.T4.2.5.5.1" class="ltx_td ltx_align_center"><span id="S4.T4.2.5.5.1.1" class="ltx_text" style="font-size:90%;">(c)</span></td>
<td id="S4.T4.2.5.5.2" class="ltx_td ltx_align_center"><span id="S4.T4.2.5.5.2.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.5.5.3" class="ltx_td ltx_align_center"><span id="S4.T4.2.5.5.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.5.5.4" class="ltx_td ltx_align_center"><span id="S4.T4.2.5.5.4.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.5.5.5" class="ltx_td ltx_align_center"><span id="S4.T4.2.5.5.5.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.5.5.6" class="ltx_td ltx_align_center"><span id="S4.T4.2.5.5.6.1" class="ltx_text" style="font-size:90%;">79.73</span></td>
<td id="S4.T4.2.5.5.7" class="ltx_td ltx_align_center"><span id="S4.T4.2.5.5.7.1" class="ltx_text" style="font-size:90%;">75.17</span></td>
<td id="S4.T4.2.5.5.8" class="ltx_td ltx_align_center"><span id="S4.T4.2.5.5.8.1" class="ltx_text" style="font-size:90%;">82.94</span></td>
</tr>
<tr id="S4.T4.2.6.6" class="ltx_tr">
<td id="S4.T4.2.6.6.1" class="ltx_td ltx_align_center"><span id="S4.T4.2.6.6.1.1" class="ltx_text" style="font-size:90%;">(d)</span></td>
<td id="S4.T4.2.6.6.2" class="ltx_td ltx_align_center"><span id="S4.T4.2.6.6.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.6.6.3" class="ltx_td ltx_align_center"><span id="S4.T4.2.6.6.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.6.6.4" class="ltx_td ltx_align_center"><span id="S4.T4.2.6.6.4.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.6.6.5" class="ltx_td ltx_align_center"><span id="S4.T4.2.6.6.5.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.6.6.6" class="ltx_td ltx_align_center"><span id="S4.T4.2.6.6.6.1" class="ltx_text" style="font-size:90%;">80.27</span></td>
<td id="S4.T4.2.6.6.7" class="ltx_td ltx_align_center"><span id="S4.T4.2.6.6.7.1" class="ltx_text" style="font-size:90%;">76.72</span></td>
<td id="S4.T4.2.6.6.8" class="ltx_td ltx_align_center"><span id="S4.T4.2.6.6.8.1" class="ltx_text" style="font-size:90%;">85.58</span></td>
</tr>
<tr id="S4.T4.2.7.7" class="ltx_tr">
<td id="S4.T4.2.7.7.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.7.7.1.1" class="ltx_text" style="font-size:90%;">(e)</span></td>
<td id="S4.T4.2.7.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.7.7.2.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.7.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.7.7.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.7.7.4.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.7.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.7.7.5.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.7.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.7.7.6.1" class="ltx_text" style="font-size:90%;">80.00</span></td>
<td id="S4.T4.2.7.7.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.7.7.7.1" class="ltx_text" style="font-size:90%;">76.72</span></td>
<td id="S4.T4.2.7.7.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.2.7.7.8.1" class="ltx_text" style="font-size:90%;">85.20</span></td>
</tr>
<tr id="S4.T4.2.8.8" class="ltx_tr">
<td id="S4.T4.2.8.8.1" class="ltx_td ltx_align_center"><span id="S4.T4.2.8.8.1.1" class="ltx_text" style="font-size:90%;">(f)</span></td>
<td id="S4.T4.2.8.8.2" class="ltx_td ltx_align_center"><span id="S4.T4.2.8.8.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.8.8.3" class="ltx_td ltx_align_center"><span id="S4.T4.2.8.8.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.8.8.4" class="ltx_td ltx_align_center"><span id="S4.T4.2.8.8.4.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T4.2.8.8.5" class="ltx_td ltx_align_center"><span id="S4.T4.2.8.8.5.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.8.8.6" class="ltx_td ltx_align_center"><span id="S4.T4.2.8.8.6.1" class="ltx_text" style="font-size:90%;">81.07</span></td>
<td id="S4.T4.2.8.8.7" class="ltx_td ltx_align_center"><span id="S4.T4.2.8.8.7.1" class="ltx_text" style="font-size:90%;">77.16</span></td>
<td id="S4.T4.2.8.8.8" class="ltx_td ltx_align_center"><span id="S4.T4.2.8.8.8.1" class="ltx_text" style="font-size:90%;">85.67</span></td>
</tr>
<tr id="S4.T4.2.9.9" class="ltx_tr">
<td id="S4.T4.2.9.9.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.9.9.1.1" class="ltx_text" style="font-size:90%;">(g)</span></td>
<td id="S4.T4.2.9.9.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.9.9.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.9.9.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.9.9.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.9.9.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.9.9.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.9.9.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.9.9.5.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T4.2.9.9.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.9.9.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.13</span></td>
<td id="S4.T4.2.9.9.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.9.9.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">78.27</span></td>
<td id="S4.T4.2.9.9.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.2.9.9.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">86.05</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>Results of RAMM on the VQA-Med 2019, VQARAD, and SLAKE with different pretraining and retrieval settings.</figcaption>
</figure>
<figure id="S4.T5" class="ltx_table">
<table id="S4.T5.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.2.1.1" class="ltx_tr">
<th id="S4.T5.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T5.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Task</span></th>
<th id="S4.T5.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S4.T5.2.1.1.2.1" class="ltx_text" style="font-size:90%;">VQAMed19</span></th>
<th id="S4.T5.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S4.T5.2.1.1.3.1" class="ltx_text" style="font-size:90%;">VQARAD</span></th>
<th id="S4.T5.2.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S4.T5.2.1.1.4.1" class="ltx_text" style="font-size:90%;">SLAKE</span></th>
</tr>
<tr id="S4.T5.2.2.2" class="ltx_tr">
<th id="S4.T5.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row"><span id="S4.T5.2.2.2.1.1" class="ltx_text" style="font-size:90%;">Dataset</span></th>
<th id="S4.T5.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T5.2.2.2.2.1" class="ltx_text" style="font-size:90%;">Retrieve%</span></th>
<th id="S4.T5.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T5.2.2.2.3.1" class="ltx_text" style="font-size:90%;">Have Ans%</span></th>
<th id="S4.T5.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T5.2.2.2.4.1" class="ltx_text" style="font-size:90%;">Retrieve%</span></th>
<th id="S4.T5.2.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T5.2.2.2.5.1" class="ltx_text" style="font-size:90%;">Have Ans%</span></th>
<th id="S4.T5.2.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T5.2.2.2.6.1" class="ltx_text" style="font-size:90%;">Retrieve%</span></th>
<th id="S4.T5.2.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T5.2.2.2.7.1" class="ltx_text" style="font-size:90%;">Have Ans%</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.2.3.1" class="ltx_tr">
<th id="S4.T5.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T5.2.3.1.1.1" class="ltx_text" style="font-size:90%;">PMCPM + ROCO + MIMIC-CXR</span></th>
<td id="S4.T5.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.2.3.1.2.1" class="ltx_text" style="font-size:90%;">100.0%</span></td>
<td id="S4.T5.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.2.3.1.3.1" class="ltx_text" style="font-size:90%;">29.6%</span></td>
<td id="S4.T5.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.2.3.1.4.1" class="ltx_text" style="font-size:90%;">100.0%</span></td>
<td id="S4.T5.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.2.3.1.5.1" class="ltx_text" style="font-size:90%;">28.4%</span></td>
<td id="S4.T5.2.3.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.2.3.1.6.1" class="ltx_text" style="font-size:90%;">100.0%</span></td>
<td id="S4.T5.2.3.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.2.3.1.7.1" class="ltx_text" style="font-size:90%;">38.7%</span></td>
</tr>
<tr id="S4.T5.2.4.2" class="ltx_tr">
<th id="S4.T5.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T5.2.4.2.1.1" class="ltx_text" style="font-size:90%;">PMCPM</span></th>
<td id="S4.T5.2.4.2.2" class="ltx_td ltx_align_center"><span id="S4.T5.2.4.2.2.1" class="ltx_text" style="font-size:90%;">52.2%</span></td>
<td id="S4.T5.2.4.2.3" class="ltx_td ltx_align_center"><span id="S4.T5.2.4.2.3.1" class="ltx_text" style="font-size:90%;">20.8%</span></td>
<td id="S4.T5.2.4.2.4" class="ltx_td ltx_align_center"><span id="S4.T5.2.4.2.4.1" class="ltx_text" style="font-size:90%;">51.9%</span></td>
<td id="S4.T5.2.4.2.5" class="ltx_td ltx_align_center"><span id="S4.T5.2.4.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">21.3%</span></td>
<td id="S4.T5.2.4.2.6" class="ltx_td ltx_align_center"><span id="S4.T5.2.4.2.6.1" class="ltx_text" style="font-size:90%;">54.9%</span></td>
<td id="S4.T5.2.4.2.7" class="ltx_td ltx_align_center"><span id="S4.T5.2.4.2.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">30.5%</span></td>
</tr>
<tr id="S4.T5.2.5.3" class="ltx_tr">
<th id="S4.T5.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S4.T5.2.5.3.1.1" class="ltx_text" style="font-size:90%;">ROCO + MIMIC-CXR</span></th>
<td id="S4.T5.2.5.3.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.2.5.3.2.1" class="ltx_text" style="font-size:90%;">47.8%</span></td>
<td id="S4.T5.2.5.3.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.2.5.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">21.1%</span></td>
<td id="S4.T5.2.5.3.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.2.5.3.4.1" class="ltx_text" style="font-size:90%;">48.1%</span></td>
<td id="S4.T5.2.5.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.2.5.3.5.1" class="ltx_text" style="font-size:90%;">20.0%</span></td>
<td id="S4.T5.2.5.3.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.2.5.3.6.1" class="ltx_text" style="font-size:90%;">45.1%</span></td>
<td id="S4.T5.2.5.3.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.2.5.3.7.1" class="ltx_text" style="font-size:90%;">26.9%</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5: </span>Analysis of the source and quality of retrieving on VQA-Med 2019, VQARAD, and SLAKE datasets.
</figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Ablation Study</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">To further analyze the influence of the collected PMCPM dataset and the retrieval strategy, we conduct detailed ablation studies as shown in Table <a href="#S4.T4" title="Table 4 ‣ 4.4 Main Results ‣ 4 Experiments ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">Firstly, we analyze the impact of using different data during the pre-training phase. ROCO and MIMIC-CXR are well-used biomedical multi-modal pre-training datasets. ROCO contains labeled radiology images in relatively small amounts. The amount of MIMIC-CXR is large, while it only contains chest X-Ray image-text pairs. The collection of PMCPM comes from the rich and diverse conditions of patients, and PMCPM is much larger than ROCO and MIMIC-CXR.
With the numerous and diverse image-text pairs from PMCPM, the model has the potential to obtain better visual and textual representations. Comparing (a) and (b), we show the effectiveness of pretraining on our collected PMCPM dataset. Results from (b) and (c) show that the data of PMCPM and previous ROCO plus MIMIC-CXR can complement each other. ROCO plus MIMIC-CXR shows better results on VQA-Med-2019 and VQARAD datasets, while PMCPM is better on SLAKE dataset. By combining the two settings with three resources, setting (d) achieves the best performance with a large margin by only using either of them. The above results demonstrate that PMCPM can enhance the model pretraining in biomedical VQA tasks.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">Secondly, the above datasets are also treated as retrieval resources in this work. Therefore, we also analyze the impact of using different data during the fine-tuning phase. Setting (e) only uses the previous ROCO and MIMIC-CXR datasets for retrieval. By comparing it with setting (c), we show that the proposed retrieval strategy is effective in the previously widely-used resource. Then, we further demonstrate the usefulness of our collected PMCPM data. Compared with settings (f) and (g), we observe that retrieving additional PMCPM data yields gains of 1.06, 1.11, and 0.38, respectively.
In addition, results from setting (g) with (d) reflect the great improvement brought by our proposed retrieval method. The above ablation studies show that our collected PMCPM dataset and our proposed retrieval method can benefit both pretraining and retrieving in biomedical VQA tasks.</p>
</div>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Analysis and Discussion</h3>

<section id="S4.SS6.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.6.1 </span>Retrieval</h4>

<section id="S4.SS6.SSS1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Retrieval distribution</h5>

<div id="S4.SS6.SSS1.Px1.p1" class="ltx_para">
<p id="S4.SS6.SSS1.Px1.p1.1" class="ltx_p">To understand how RAMM retrieve from different resources and how retrieved texts help our model for biomedical VQA tasks, we count the sources of retrieved samples and how many retrieved texts contain the answers.
Statistics are listed in Table <a href="#S4.T5" title="Table 5 ‣ 4.4 Main Results ‣ 4 Experiments ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
There are 29.6%, 28.4%, and 38.7% of answers that can be found in retrieved texts in VQA-Med 2019, VQARAD, and SLAKE respectively, which are considerable amounts.
These retrieved texts may help RAMM answer the questions directly.
We observe that in these tasks, RAMM retrieves image-text pairs from PMCPM over half which shows that PMCPM is more related to biomedical VQA images than ROCO and MIMIC-CXR.
The percentages of retrieved texts containing answers are nearly the same for PMCPM and <span id="S4.SS6.SSS1.Px1.p1.1.1" class="ltx_text ltx_font_italic">out of PMCPM</span> in VQA-Med 2019 and VQARAD. In SLAKE, PMCPM contributes more texts containing answers.
To conclude, PMCPM is important during retrieval which supplies additional texts containing answers.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<table id="S4.T6.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.4.1.1" class="ltx_tr">
<th id="S4.T6.4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T6.4.1.1.1.1" class="ltx_text" style="font-size:90%;"># Retrieval</span></th>
<th id="S4.T6.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T6.4.1.1.2.1" class="ltx_text" style="font-size:90%;">VQARAD</span></th>
<th id="S4.T6.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T6.4.1.1.3.1" class="ltx_text" style="font-size:90%;">SLAKE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.4.2.1" class="ltx_tr">
<th id="S4.T6.4.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S4.T6.4.2.1.1.1" class="ltx_text" style="font-size:90%;">0</span></th>
<td id="S4.T6.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T6.4.2.1.2.1" class="ltx_text" style="font-size:90%;">76.72</span></td>
<td id="S4.T6.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T6.4.2.1.3.1" class="ltx_text" style="font-size:90%;">85.58</span></td>
</tr>
<tr id="S4.T6.4.3.2" class="ltx_tr">
<th id="S4.T6.4.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T6.4.3.2.1.1" class="ltx_text" style="font-size:90%;">1</span></th>
<td id="S4.T6.4.3.2.2" class="ltx_td ltx_align_center"><span id="S4.T6.4.3.2.2.1" class="ltx_text" style="font-size:90%;">77.38</span></td>
<td id="S4.T6.4.3.2.3" class="ltx_td ltx_align_center"><span id="S4.T6.4.3.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">86.33</span></td>
</tr>
<tr id="S4.T6.4.4.3" class="ltx_tr">
<th id="S4.T6.4.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T6.4.4.3.1.1" class="ltx_text" style="font-size:90%;">2</span></th>
<td id="S4.T6.4.4.3.2" class="ltx_td ltx_align_center"><span id="S4.T6.4.4.3.2.1" class="ltx_text" style="font-size:90%;">78.05</span></td>
<td id="S4.T6.4.4.3.3" class="ltx_td ltx_align_center"><span id="S4.T6.4.4.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">86.33</span></td>
</tr>
<tr id="S4.T6.4.5.4" class="ltx_tr">
<th id="S4.T6.4.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T6.4.5.4.1.1" class="ltx_text" style="font-size:90%;">4</span></th>
<td id="S4.T6.4.5.4.2" class="ltx_td ltx_align_center"><span id="S4.T6.4.5.4.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">78.27</span></td>
<td id="S4.T6.4.5.4.3" class="ltx_td ltx_align_center"><span id="S4.T6.4.5.4.3.1" class="ltx_text" style="font-size:90%;">86.05</span></td>
</tr>
<tr id="S4.T6.4.6.5" class="ltx_tr">
<th id="S4.T6.4.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S4.T6.4.6.5.1.1" class="ltx_text" style="font-size:90%;">8</span></th>
<td id="S4.T6.4.6.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T6.4.6.5.2.1" class="ltx_text" style="font-size:90%;">76.50</span></td>
<td id="S4.T6.4.6.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T6.4.6.5.3.1" class="ltx_text" style="font-size:90%;">84.54</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 6: </span>Results on the VQARAD and SLAKE datasets with different <math id="S4.T6.2.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.T6.2.m1.1b"><mi id="S4.T6.2.m1.1.1" xref="S4.T6.2.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.T6.2.m1.1c"><ci id="S4.T6.2.m1.1.1.cmml" xref="S4.T6.2.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.m1.1d">r</annotation></semantics></math> of retrieved image-text pairs.</figcaption>
</figure>
<figure id="S4.T7" class="ltx_table">
<table id="S4.T7.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T7.2.1.1" class="ltx_tr">
<th id="S4.T7.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T7.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S4.T7.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S4.T7.2.1.1.2.1" class="ltx_text" style="font-size:90%;">VQARAD</span></th>
<th id="S4.T7.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S4.T7.2.1.1.3.1" class="ltx_text" style="font-size:90%;">SLAKE</span></th>
</tr>
<tr id="S4.T7.2.2.2" class="ltx_tr">
<th id="S4.T7.2.2.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S4.T7.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T7.2.2.2.2.1" class="ltx_text" style="font-size:90%;">Open</span></th>
<th id="S4.T7.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T7.2.2.2.3.1" class="ltx_text" style="font-size:90%;">Closed</span></th>
<th id="S4.T7.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T7.2.2.2.4.1" class="ltx_text" style="font-size:90%;">Open</span></th>
<th id="S4.T7.2.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T7.2.2.2.5.1" class="ltx_text" style="font-size:90%;">Closed</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T7.2.3.1" class="ltx_tr">
<th id="S4.T7.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T7.2.3.1.1.1" class="ltx_text" style="font-size:90%;">MEVF-BAN</span></th>
<td id="S4.T7.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T7.2.3.1.2.1" class="ltx_text" style="font-size:90%;">49.20</span></td>
<td id="S4.T7.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T7.2.3.1.3.1" class="ltx_text" style="font-size:90%;">77.20</span></td>
<td id="S4.T7.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T7.2.3.1.4.1" class="ltx_text" style="font-size:90%;">77.80</span></td>
<td id="S4.T7.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T7.2.3.1.5.1" class="ltx_text" style="font-size:90%;">79.80</span></td>
</tr>
<tr id="S4.T7.2.4.2" class="ltx_tr">
<th id="S4.T7.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T7.2.4.2.1.1" class="ltx_text" style="font-size:90%;">CPRD-BAN</span></th>
<td id="S4.T7.2.4.2.2" class="ltx_td ltx_align_center"><span id="S4.T7.2.4.2.2.1" class="ltx_text" style="font-size:90%;">52.50</span></td>
<td id="S4.T7.2.4.2.3" class="ltx_td ltx_align_center"><span id="S4.T7.2.4.2.3.1" class="ltx_text" style="font-size:90%;">77.90</span></td>
<td id="S4.T7.2.4.2.4" class="ltx_td ltx_align_center"><span id="S4.T7.2.4.2.4.1" class="ltx_text" style="font-size:90%;">79.50</span></td>
<td id="S4.T7.2.4.2.5" class="ltx_td ltx_align_center"><span id="S4.T7.2.4.2.5.1" class="ltx_text" style="font-size:90%;">83.40</span></td>
</tr>
<tr id="S4.T7.2.5.3" class="ltx_tr">
<th id="S4.T7.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T7.2.5.3.1.1" class="ltx_text" style="font-size:90%;">M3AE</span></th>
<td id="S4.T7.2.5.3.2" class="ltx_td ltx_align_center"><span id="S4.T7.2.5.3.2.1" class="ltx_text" style="font-size:90%;">67.23</span></td>
<td id="S4.T7.2.5.3.3" class="ltx_td ltx_align_center"><span id="S4.T7.2.5.3.3.1" class="ltx_text" style="font-size:90%;">83.46</span></td>
<td id="S4.T7.2.5.3.4" class="ltx_td ltx_align_center"><span id="S4.T7.2.5.3.4.1" class="ltx_text" style="font-size:90%;">80.31</span></td>
<td id="S4.T7.2.5.3.5" class="ltx_td ltx_align_center"><span id="S4.T7.2.5.3.5.1" class="ltx_text" style="font-size:90%;">87.82</span></td>
</tr>
<tr id="S4.T7.2.6.4" class="ltx_tr">
<th id="S4.T7.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S4.T7.2.6.4.1.1" class="ltx_text" style="font-size:90%;">RAMM</span></th>
<td id="S4.T7.2.6.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T7.2.6.4.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">67.60</span></td>
<td id="S4.T7.2.6.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T7.2.6.4.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">85.29</span></td>
<td id="S4.T7.2.6.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T7.2.6.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.48</span></td>
<td id="S4.T7.2.6.4.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T7.2.6.4.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">91.59</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 7: </span>Analysis of open-ended and closed-ended results on the VQARAD and SLAKE datasets.</figcaption>
</figure>
</section>
<section id="S4.SS6.SSS1.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Image-text pairs retrieval count</h5>

<div id="S4.SS6.SSS1.Px2.p1" class="ltx_para">
<p id="S4.SS6.SSS1.Px2.p1.2" class="ltx_p">To explore how image-text pairs retrieval count influences biomedical VQA fine-tuning, we search the number of retrieved images among <math id="S4.SS6.SSS1.Px2.p1.1.m1.5" class="ltx_Math" alttext="\{0,1,2,4,8\}" display="inline"><semantics id="S4.SS6.SSS1.Px2.p1.1.m1.5a"><mrow id="S4.SS6.SSS1.Px2.p1.1.m1.5.6.2" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.6.1.cmml"><mo stretchy="false" id="S4.SS6.SSS1.Px2.p1.1.m1.5.6.2.1" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.6.1.cmml">{</mo><mn id="S4.SS6.SSS1.Px2.p1.1.m1.1.1" xref="S4.SS6.SSS1.Px2.p1.1.m1.1.1.cmml">0</mn><mo id="S4.SS6.SSS1.Px2.p1.1.m1.5.6.2.2" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS6.SSS1.Px2.p1.1.m1.2.2" xref="S4.SS6.SSS1.Px2.p1.1.m1.2.2.cmml">1</mn><mo id="S4.SS6.SSS1.Px2.p1.1.m1.5.6.2.3" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS6.SSS1.Px2.p1.1.m1.3.3" xref="S4.SS6.SSS1.Px2.p1.1.m1.3.3.cmml">2</mn><mo id="S4.SS6.SSS1.Px2.p1.1.m1.5.6.2.4" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS6.SSS1.Px2.p1.1.m1.4.4" xref="S4.SS6.SSS1.Px2.p1.1.m1.4.4.cmml">4</mn><mo id="S4.SS6.SSS1.Px2.p1.1.m1.5.6.2.5" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS6.SSS1.Px2.p1.1.m1.5.5" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.5.cmml">8</mn><mo stretchy="false" id="S4.SS6.SSS1.Px2.p1.1.m1.5.6.2.6" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.SSS1.Px2.p1.1.m1.5b"><set id="S4.SS6.SSS1.Px2.p1.1.m1.5.6.1.cmml" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.6.2"><cn type="integer" id="S4.SS6.SSS1.Px2.p1.1.m1.1.1.cmml" xref="S4.SS6.SSS1.Px2.p1.1.m1.1.1">0</cn><cn type="integer" id="S4.SS6.SSS1.Px2.p1.1.m1.2.2.cmml" xref="S4.SS6.SSS1.Px2.p1.1.m1.2.2">1</cn><cn type="integer" id="S4.SS6.SSS1.Px2.p1.1.m1.3.3.cmml" xref="S4.SS6.SSS1.Px2.p1.1.m1.3.3">2</cn><cn type="integer" id="S4.SS6.SSS1.Px2.p1.1.m1.4.4.cmml" xref="S4.SS6.SSS1.Px2.p1.1.m1.4.4">4</cn><cn type="integer" id="S4.SS6.SSS1.Px2.p1.1.m1.5.5.cmml" xref="S4.SS6.SSS1.Px2.p1.1.m1.5.5">8</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.SSS1.Px2.p1.1.m1.5c">\{0,1,2,4,8\}</annotation></semantics></math>. Results for VQARAD and SLAKE are shown in Table <a href="#S4.T6" title="Table 6 ‣ Retrieval distribution ‣ 4.6.1 Retrieval ‣ 4.6 Analysis and Discussion ‣ 4 Experiments ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
Compared with vanilla fine-tuning (i.e. retrieval count 0), retrieving <math id="S4.SS6.SSS1.Px2.p1.2.m2.3" class="ltx_Math" alttext="\{1,2,4\}" display="inline"><semantics id="S4.SS6.SSS1.Px2.p1.2.m2.3a"><mrow id="S4.SS6.SSS1.Px2.p1.2.m2.3.4.2" xref="S4.SS6.SSS1.Px2.p1.2.m2.3.4.1.cmml"><mo stretchy="false" id="S4.SS6.SSS1.Px2.p1.2.m2.3.4.2.1" xref="S4.SS6.SSS1.Px2.p1.2.m2.3.4.1.cmml">{</mo><mn id="S4.SS6.SSS1.Px2.p1.2.m2.1.1" xref="S4.SS6.SSS1.Px2.p1.2.m2.1.1.cmml">1</mn><mo id="S4.SS6.SSS1.Px2.p1.2.m2.3.4.2.2" xref="S4.SS6.SSS1.Px2.p1.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS6.SSS1.Px2.p1.2.m2.2.2" xref="S4.SS6.SSS1.Px2.p1.2.m2.2.2.cmml">2</mn><mo id="S4.SS6.SSS1.Px2.p1.2.m2.3.4.2.3" xref="S4.SS6.SSS1.Px2.p1.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS6.SSS1.Px2.p1.2.m2.3.3" xref="S4.SS6.SSS1.Px2.p1.2.m2.3.3.cmml">4</mn><mo stretchy="false" id="S4.SS6.SSS1.Px2.p1.2.m2.3.4.2.4" xref="S4.SS6.SSS1.Px2.p1.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.SSS1.Px2.p1.2.m2.3b"><set id="S4.SS6.SSS1.Px2.p1.2.m2.3.4.1.cmml" xref="S4.SS6.SSS1.Px2.p1.2.m2.3.4.2"><cn type="integer" id="S4.SS6.SSS1.Px2.p1.2.m2.1.1.cmml" xref="S4.SS6.SSS1.Px2.p1.2.m2.1.1">1</cn><cn type="integer" id="S4.SS6.SSS1.Px2.p1.2.m2.2.2.cmml" xref="S4.SS6.SSS1.Px2.p1.2.m2.2.2">2</cn><cn type="integer" id="S4.SS6.SSS1.Px2.p1.2.m2.3.3.cmml" xref="S4.SS6.SSS1.Px2.p1.2.m2.3.3">4</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.SSS1.Px2.p1.2.m2.3c">\{1,2,4\}</annotation></semantics></math> image-text pairs can boost performances.
We empirically find retrieving 2 or 4 image-text pairs work well.
Furthermore, using 8 image-text pairs downgrades the model performance, which indicates that retrieving too many image-text pairs may introduce unrelated image-text pairs with noisy knowledge.</p>
</div>
</section>
</section>
<section id="S4.SS6.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.6.2 </span>Question Type</h4>

<div id="S4.SS6.SSS2.p1" class="ltx_para">
<p id="S4.SS6.SSS2.p1.1" class="ltx_p">In biomedical VQA, questions can be divided into closed-ended and open-ended questions.
The answers to closed-ended questions are limited to multiple choices like <span id="S4.SS6.SSS2.p1.1.1" class="ltx_text ltx_font_italic">Yes</span> or <span id="S4.SS6.SSS2.p1.1.2" class="ltx_text ltx_font_italic">No</span>, while the answers to open-ended questions are not limited.
Closed-ended questions are easier than open-ended questions due to the form.
Table <a href="#S4.T7" title="Table 7 ‣ Retrieval distribution ‣ 4.6.1 Retrieval ‣ 4.6 Analysis and Discussion ‣ 4 Experiments ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> lists comparisons among different methods on open-ended and closed-ended questions.
RAMM performs better than M3AE on both closed-ended and open-ended questions.
RAMM improves M3AE on closed-ended questions more than open-ended questions.
The reason is that closed-ended questions are limited in answer choices, and are easier to be covered by retrieved texts.</p>
</div>
</section>
<section id="S4.SS6.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.6.3 </span>Comparison with ROCO</h4>

<div id="S4.SS6.SSS3.p1" class="ltx_para">
<p id="S4.SS6.SSS3.p1.1" class="ltx_p">ROCO and PMCPM are both subsets of PubMed.
ROCO uses a trained neural network to filter radiology images, while PMCPM finds images by “<span id="S4.SS6.SSS3.p1.1.1" class="ltx_text ltx_font_italic">Case Report</span>” from PubMed.
We calculate the involved article count in ROCO and PMCPM train split.
ROCO uses 40,857 articles from PubMed, and PMCPM uses 127,455 articles from PubMed.
There are 17,189 articles appeared in both datasets.
Although ROCO and PMCPM filter image-text pairs using different methods, nearly half of the pairs in ROCO are also collected by PMCPM.
Considering ROCO is a manually corrected dataset, it can reflect the quality of the larger dataset PMCPM from the side.</p>
</div>
</section>
<section id="S4.SS6.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.6.4 </span>Case Study</h4>

<div id="S4.SS6.SSS4.p1" class="ltx_para">
<p id="S4.SS6.SSS4.p1.1" class="ltx_p">We show retrieved image-text pairs of RAMM in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.6.4 Case Study ‣ 4.6 Analysis and Discussion ‣ 4 Experiments ‣ RAMM: Retrieval-augmented Biomedical Visual Question Answering with Multi-modal Pre-training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
The retrieved samples are all from PMCPM.
Retrieved images are in the same modalities and are the same organs as the original images.
These cases show that the retrieved images contain useful information for answering questions.
Although the answer (i.e. <span id="S4.SS6.SSS4.p1.1.1" class="ltx_text ltx_font_italic">Yes</span>/<span id="S4.SS6.SSS4.p1.1.2" class="ltx_text ltx_font_italic">No</span>) is not covered in retrieved text for the second example, the retrieved text is still useful for answering.
The second and third examples further show that RAMM can answer correctly with retrieval augmentation while naive fine-tuning fails.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2303.00534/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="401" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.3.2" class="ltx_text" style="font-size:90%;">Examples of retrieved image-text pairs of RAMM. </span></figcaption>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we present a retrieval-augmented pretrain-and-finetune paradigm RAMM for biomedical VQA which includes a high-quality image-text pairs PMCPM, a pretrained multi-modal model, and a novel retrieval-augmented attention module for fine-tuning.
RAMM uses ITC to retrieve related image-text pairs and fuse retrieved information with retrieval-attention.
Experiments have shown that our approach outperforms state-of-the-art methods in various biomedical VQA datasets.
Ablation studies show the effectiveness of proposed RAMM and PMCPM for pretraining and retrieving.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Iz Beltagy, Kyle Lo, and Arman Cohan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">SciBERT: A pretrained language model for scientific text.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing and the 9th International Joint Conference on
Natural Language Processing (EMNLP-IJCNLP)</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, pages 3615–3620, Hong Kong,
China, Nov. 2019. Association for Computational Linguistics.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Asma Ben Abacha, Sadid A Hasan, Vivek V Datla, Dina Demner-Fushman, and Henning
Müller.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Vqa-med: Overview of the medical visual question answering task at
imageclef 2019.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of CLEF (Conference and Labs of the Evaluation
Forum) 2019 Working Notes</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">. 9-12 September 2019, 2019.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
D. Nguyen Binh, Do Thanh-Toan, X. Nguyen Binh, Do Tuong, Tjiputra Erman, and
D. Tran Quang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Overcoming data limitation in medical visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">MICCAI</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Zhihong Chen, Yuhao Du, Jinpeng Hu, Yang Liu, Guanbin Li, Xiang Wan, and
Tsung-Hui Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Multi-modal masked autoencoders for medical vision-and-language
pre-training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Medical Image Computing and
Computer-Assisted Intervention</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">. Springer, 2022.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Zhihong Chen, Guanbin Li, and Xiang Wan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Align, reason and learn: Enhancing medical vision-and-language
pre-training with knowledge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 30th ACM International Conference on
Multimedia</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, pages 5152–5161, 2022.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Ekin Dogus Cubuk, Barret Zoph, Jon Shlens, and Quoc Le.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Randaugment: Practical automated data augmentation with a reduced
search space.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In H. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan, and H. Lin,
editors, </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, volume 33,
pages 18613–18624. Curran Associates, Inc., 2020.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Jean-benoit Delbrouck, Khaled Saab, Maya Varma, Sabri Eyuboglu, Pierre Chambon,
Jared Dunnmon, Juan Zambrano, Akshay Chaudhari, and Curtis Langlotz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">ViLMedic: a framework for research at the intersection of vision
and language in medical AI.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 60th Annual Meeting of the Association for
Computational Linguistics: System Demonstrations</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, pages 23–34, Dublin,
Ireland, May 2022. Association for Computational Linguistics.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">BERT: Pre-training of deep bidirectional transformers for language
understanding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 1 (Long and Short Papers)</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, pages 4171–4186,
Minneapolis, Minnesota, June 2019. Association for Computational Linguistics.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Tuong Do, Binh X. Nguyen, Erman Tjiputra, Minh Tran, Quang D. Tran, and Anh
Nguyen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Multiple meta-model quantifying for medical visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">MICCAI</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Zi-Yi Dou, Yichong Xu, Zhe Gan, Jianfeng Wang, Shuohang Wang, Lijuan Wang,
Chenguang Zhu, Pengchuan Zhang, Lu Yuan, Nanyun Peng, Zicheng Liu, and
Michael Zeng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">An empirical study of training end-to-end vision-and-language
transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Conference on Computer Vision and Pattern Recognition
(CVPR)</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Sedigheh Eslami, Gerard de Melo, and Christoph Meinel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Does CLIP benefit visual question answering in the medical domain
as much as it does in the general domain?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv e-prints</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, Dec. 2021.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Haifan Gong, Guanqi Chen, Sishuo Liu, Yizhou Yu, and Guanbin Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Cross-modal self-attention with multi-task pre-training for medical
visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICMR ’21: International Conference on Multimedia Retrieval,
Taipei, Taiwan, August 21-24, 2021</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, pages 456–460. ACM, 2021.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Haifan Gong, Ricong Huang, Guanqi Chen, and Guanbin Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Sysu-hcp at vqa-med 2021: A data-centric model with efficient
training methodology for medical visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CLEF 2021 – Conference and Labs of the Evaluation Forum,
September 21–24, 2021, Bucharest, Romania</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, CEUR Workshop Proceedings, 2021.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Yuxian Gu, Robert Tinn, Hao Cheng, Michael R. Lucas, Naoto Usuyama, Xiaodong
Liu, Tristan Naumann, Jianfeng Gao, and Hoifung Poon.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Domain-specific language model pretraining for biomedical natural
language processing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM Transactions on Computing for Healthcare (HEALTH)</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 3:1 –
23, 2022.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Kelvin Guu, Kenton Lee, Zora Tung, Panupong Pasupat, and Mingwei Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Retrieval augmented language model pre-training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, pages
3929–3938. PMLR, 2020.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Bogdan Ionescu, Henning Müller, Renaud Péteri, Asma Ben Abacha, Mourad
Sarrouti, Dina Demner-Fushman, Sadid A Hasan, Serge Kozlovski, Vitali
Liauchuk, Yashin Dicente Cid, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Overview of the imageclef 2021: Multimedia retrieval in medical,
nature, internet and social media applications.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference of the Cross-Language Evaluation
Forum for European Languages</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, pages 345–370. Springer, 2021.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Qiao Jin, Zheng Yuan, Guangzhi Xiong, Qianlan Yu, Huaiyuan Ying, Chuanqi Tan,
Mosha Chen, Songfang Huang, Xiaozhong Liu, and Sheng Yu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Biomedical question answering: A survey of approaches and challenges.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM Comput. Surv.</span><span id="bib.bib17.4.2" class="ltx_text" style="font-size:90%;">, 55(2), jan 2022.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Alistair E. W. Johnson, Tom J. Pollard, Seth J. Berkowitz, Nathaniel R.
Greenbaum, Matthew P. Lungren, Chih ying Deng, Roger G. Mark, and Steven
Horng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Mimic-cxr, a de-identified publicly available database of chest
radiographs with free-text reports.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Scientific Data</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">, 6, 2019.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Jeff Johnson, Matthijs Douze, and Hervé Jégou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Billion-scale similarity search with GPUs.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Big Data</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 7(3):535–547, 2019.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Yash Khare, Viraj Bagal, Minesh Mathew, Adithi Devi, U Deva Priyakumar, and CV
Jawahar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Mmbert: multimodal bert pretraining for improved medical vqa.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2021 IEEE 18th International Symposium on Biomedical Imaging
(ISBI)</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, pages 1033–1036. IEEE, 2021.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Jin-Hwa Kim, Jaehyun Jun, and Byoung-Tak Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Bilinear Attention Networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems 31</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, pages
1571–1581, 2018.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Jason J Lau, Soumya Gayen, Asma Ben Abacha, and Dina Demner-Fushman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">A dataset of clinically generated visual questions and answers about
radiology images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Scientific data</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 5(1):1–10, 2018.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Jinhyuk Lee, Wonjin Yoon, Sungdong Kim, Donghyeon Kim, Sunkyu Kim, Chan Ho So,
and Jaewoo Kang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Biobert: a pre-trained biomedical language representation model for
biomedical text mining.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Bioinformatics</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 36(4):1234–1240, 2020.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Kenton Lee, Ming-Wei Chang, and Kristina Toutanova.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Latent retrieval for weakly supervised open domain question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 57th Annual Meeting of the Association for
Computational Linguistics</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, pages 6086–6096, Florence, Italy, July 2019.
Association for Computational Linguistics.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir
Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim
Rocktäschel, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Retrieval-augmented generation for knowledge-intensive nlp tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">,
33:9459–9474, 2020.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Chenliang Li, Haiyang Xu, Junfeng Tian, Wei Wang, Ming Yan, Bin Bi, Jiabo Ye,
Hehong Chen, Guohai Xu, Zheng Cao, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">mplug: Effective and efficient vision-language learning by
cross-modal skip-connections.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2205.12005</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Junnan Li, Ramprasaath R. Selvaraju, Akhilesh Deepak Gotmare, Shafiq Joty,
Caiming Xiong, and Steven Hoi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Align before fuse: Vision and language representation learning with
momentum distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Xiaobo Liang, Lijun Wu, Juntao Li, Yue Wang, Qi Meng, Tao Qin, Wei Chen, Min
Zhang, and Tie-Yan Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">R-drop: Regularized dropout for neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Bo Liu, Li-Ming Zhan, and Xiao-Ming Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Contrastive pre-training and representation distillation for medical
visual question answering based on radiology images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Medical Image Computing and
Computer-Assisted Intervention</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages 210–220. Springer, 2021.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Bo Liu, Li-Ming Zhan, Li Xu, Lin Ma, Yan Yang, and Xiao-Ming Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Slake: a semantically-labeled knowledge-enhanced dataset for medical
visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2021 IEEE 18th International Symposium on Biomedical Imaging
(ISBI)</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, pages 1650–1654. IEEE, 2021.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Ze Liu, Yutong Lin, Yue Cao, Han Hu, Yixuan Wei, Zheng Zhang, Stephen Lin, and
Baining Guo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Swin transformer: Hierarchical vision transformer using shifted
windows.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 10012–10022, 2021.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Alexander Long, Wei Yin, Thalaiyasingam Ajanthan, Vu Nguyen, Pulak Purkait,
Ravi Garg, Alan Blair, Chunhua Shen, and Anton van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Retrieval augmented classification for long-tail visual recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 6959–6969, 2022.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Ilya Loshchilov and Frank Hutter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Decoupled weight decay regularization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">7th International Conference on Learning Representations,
ICLR 2019, New Orleans, LA, USA, May 6-9, 2019</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Jong Hak Moon, Hyungyung Lee, Woncheol Shin, Young-Hak Kim, and Edward Choi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Multi-modal understanding and generation for medical images and text
via vision-language pre-training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Journal of Biomedical and Health Informatics</span><span id="bib.bib34.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Binh D Nguyen, Thanh-Toan Do, Binh X Nguyen, Tuong Do, Erman Tjiputra, and
Quang D Tran.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Overcoming data limitation in medical visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Medical Image Computing and
Computer-Assisted Intervention</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, pages 522–530. Springer, 2019.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Obioma Pelka, Sven Koitka, Johannes Rückert, Felix Nensa, and Christoph M
Friedrich.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Radiology objects in context (roco): a multimodal image dataset.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Intravascular Imaging and Computer Assisted Stenting and
Large-Scale Annotation of Biomedical Data and Expert Label Synthesis</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, pages
180–189. Springer, 2018.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Learning transferable visual models from natural language
supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, pages
8748–8763. PMLR, 2021.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Stephen E. Robertson and Hugo Zaragoza.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">The probabilistic relevance framework: Bm25 and beyond.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Found. Trends Inf. Retr.</span><span id="bib.bib38.4.2" class="ltx_text" style="font-size:90%;">, 3:333–389, 2009.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Sara Sarto, Marcella Cornia, Lorenzo Baraldi, and Rita Cucchiara.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Retrieval-augmented transformer for image captioning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Content-based Multimedia
Indexing</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, pages 1–7, 2022.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib40.4.2" class="ltx_text" style="font-size:90%;">, 30, 2017.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Wenhui Wang, Hangbo Bao, Li Dong, Johan Bjorck, Zhiliang Peng, Qiang Liu, Kriti
Aggarwal, Owais Khan Mohammed, Saksham Singhal, Subhojit Som, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Image as a foreign language: Beit pretraining for all vision and
vision-language tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2208.10442</span><span id="bib.bib41.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Zichao Yang, Xiaodong He, Jianfeng Gao, Li Deng, and Alex Smola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Stacked attention networks for image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, pages 21–29, 2016.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Zhou Yu, Jun Yu, Jianping Fan, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Multi-modal factorized bilinear pooling with co-attention learning
for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE International Conference on Computer Vision (ICCV)</span><span id="bib.bib43.4.2" class="ltx_text" style="font-size:90%;">, pages
1839–1848, 2017.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Hongyi Yuan, Zheng Yuan, Ruyi Gan, Jiaxing Zhang, Yutao Xie, and Sheng Yu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">BioBART: Pretraining and evaluation of a biomedical generative
language model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib44.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 21st Workshop on Biomedical Language
Processing</span><span id="bib.bib44.5.3" class="ltx_text" style="font-size:90%;">, pages 97–109, Dublin, Ireland, May 2022. Association for
Computational Linguistics.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Zheng Yuan, Yijia Liu, Chuanqi Tan, Songfang Huang, and Fei Huang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Improving biomedical pretrained language models with knowledge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib45.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 20th Workshop on Biomedical Language
Processing</span><span id="bib.bib45.5.3" class="ltx_text" style="font-size:90%;">, pages 180–190, Online, June 2021. Association for Computational
Linguistics.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Li-Ming Zhan, Bo Liu, Lu Fan, Jiaxin Chen, and Xiao-Ming Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Medical visual question answering via conditional reasoning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 28th ACM International Conference on
Multimedia</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, pages 2345–2354, 2020.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Zhengyun Zhao, Qiao Jin, and Sheng Yu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Pmc-patients: A large-scale dataset of patient notes and relations
extracted from case reports in pubmed central.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2202.13876</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.00533" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.00534" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.00534">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.00534" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.00535" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 22:20:49 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
