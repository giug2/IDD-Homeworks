<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems</title>
<!--Generated on Fri May 31 05:23:02 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Recommender System; Performance Heterogeneity; Causal Distillation; Front-door Adjustment
" lang="en" name="keywords"/>
<base href="/html/2405.20626v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S1" title="In Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2" title="In Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span><span class="ltx_text ltx_font_smallcaps">Preliminaries</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.SS1" title="In 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span><span class="ltx_text ltx_font_italic">Back-door Adjustment</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.SS2" title="In 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span><span class="ltx_text ltx_font_italic">Front-door Adjustment</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3" title="In Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span><span class="ltx_text ltx_font_smallcaps">Method</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS1" title="In 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span><span class="ltx_text ltx_font_italic">Problem Formulation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS2" title="In 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span><span class="ltx_text ltx_font_italic">Front-door Adjustment in Recommendation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS3" title="In 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span><span class="ltx_text ltx_font_italic">Causal Multi-teacher Distillation</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS3.SSS1" title="In 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Constructing Heterogeneous Teachers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS3.SSS2" title="In 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Front-door Adjustment for Causal Label Distillation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS3.SSS3" title="In 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Feature Distillation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS4" title="In 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span><span class="ltx_text ltx_font_italic">Model Training</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS5" title="In 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span><span class="ltx_text ltx_font_italic">Method Analysis</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS5.SSS1" title="In 3.5 Method Analysis ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.1 </span>Training Complexity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS5.SSS2" title="In 3.5 Method Analysis ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.2 </span>Inference Complexity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS5.SSS3" title="In 3.5 Method Analysis ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.3 </span><span class="ltx_text">Connection between causal label distillation and causal feature distillation</span></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S4" title="In Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span><span class="ltx_text ltx_font_smallcaps">Related Works</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S4.SS1" title="In 4 Related Works ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span><span class="ltx_text ltx_font_italic">Debiased Recommendation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S4.SS2" title="In 4 Related Works ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span><span class="ltx_text ltx_font_italic">Knowledge Distillation</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5" title="In Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span><span class="ltx_text ltx_font_smallcaps">Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.SS1" title="In 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span><span class="ltx_text ltx_font_italic">Experimental Setup</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.SS2" title="In 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span><span class="ltx_text ltx_font_italic">Overall Performance (RQ1)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.SS3" title="In 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span><span class="ltx_text ltx_font_italic">Deconfounding Analysis (RQ2)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.SS4" title="In 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span><span class="ltx_text ltx_font_italic">In-depth Model Analysis (RQ3)</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S6" title="In Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span><span class="ltx_text ltx_font_smallcaps">Conclusion and Future Work</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shengyu Zhang†, Ziqi Jiang†, Jiangchao Yao, Fuli Feng, Kun Kuang*, Zhou Zhao, Shuo Li, 
<br class="ltx_break"/>Hongxia Yang, Tat-seng Chua, Fei Wu
</span><span class="ltx_author_notes">Shengyu Zhang, Ziqi Jiang, and Zhou Zhao are with Zhejiang University, Hangzhou 310027, China. E-mail: {sy_zhang, jiangzq, zhouzhao}@zju.edu.cnKun Kuang is with Zhejiang University, Hangzhou 310027, China, and also with the Key Laboratory for Corneal Diseases Research of Zhejiang Province, Hangzhou 310016, China. E-mail: {kunkuang}@zju.edu.cnFei Wu is with the College of Computer Science and Technology, Zhejiang University, Hangzhou 310027, China, with the Shanghai Institute for Advanced Study, Zhejiang University, Shanghai 201210, China, and also with the Shanghai AI Laboratory, Shanghai 200232, China.
<br class="ltx_break"/>E-mail: wufei@zju.edu.cnJiangchao Yao is with the Cooperative Medianet Innovation Center, Shanghai Jiao Tong University, Shanghai 200240, China, and with the Shanghai AI Laboratory, Shanghai 200232, China.
Fuli Feng is with the University of Science and Technology of China, Hefei 230026, China. E-mail: fulifeng93@gmail.com
Shuo Li and Tat-Seng Chua are with the National University of Singapore, Singapore. E-mail: li.shuo980@gmail.com, chuats@comp.nus.edu.sg
Hongxia Yang is with Alibaba Group, Hangzhou 310052, China. 
<br class="ltx_break"/>E-mail: yang.yhx@alibaba-inc.com† Equal contribution* Corresponding authors</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id11.id1">Recommendation performance usually exhibits a long-tail distribution over users — a small portion of head users enjoy much more accurate recommendation services than the others.
We reveal two sources of this performance heterogeneity problem: the uneven distribution of historical interactions (a natural source); and the biased training of recommender models (a model source).
As addressing this problem cannot sacrifice the overall performance, a wise choice is to eliminate the model bias while maintaining the natural heterogeneity. The key to debiased training lies in eliminating the effect of confounders that influence both the user’s historical behaviors and the next behavior. The emerging causal recommendation methods achieve this by modeling the causal effect between user behaviors, however
potentially neglect unobserved confounders (<span class="ltx_text ltx_font_italic" id="id11.id1.1">e</span>.<span class="ltx_text ltx_font_italic" id="id11.id1.2">g</span>., friend suggestions) that
are hard to measure in practice.</p>
<p class="ltx_p" id="id12.id2">To address unobserved confounders, we resort to the front-door adjustment (FDA) in causal theory and propose a causal multi-teacher distillation framework (CausalD). FDA requires proper mediators in order to estimate the causal effects of historical behaviors on the next behavior. To achieve this, we equip CausalD with multiple heterogeneous recommendation models to model the mediator distribution.
Then, the causal effect estimated by FDA is the expectation of recommendation prediction over the mediator distribution and the prior distribution of historical behaviors, which is technically achieved by multi-teacher ensemble.
To pursue efficient inference, CausalD further distills multiple teachers into one student model to directly infer the causal effect for making recommendations.
We instantiate CausalD on two representative models, DeepFM and DIN, and conduct extensive experiments on three real-world datasets, which validate the superiority of CausalD over state-of-the-art methods. Through in-depth analysis, we find that CausalD largely improves the performance of tail users, reduces the performance heterogeneity, and enhances the overall performance.
</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Recommender System; Performance Heterogeneity; Causal Distillation; Front-door Adjustment

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="346" id="S1.F1.1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.4.2" style="font-size:90%;">
Recommendation performance over user groups clustered by 1) user activeness, and 2) behavior consistency on popular items. DIN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib1" title="">1</a>]</cite> and DIN (Group-wise) are under unified training and group-wise training, respectively.
The user number of each group remains the same.
</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommender systems alleviate the information overload on the Web by providing personalized services for users seeking information.
It has become a default choice to learn recommender models from user historical behaviors <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib5" title="">5</a>]</cite>. The model typically exhibits performance heterogeneity with significant divergence across different user groups.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">1</span></a> provides empirical evidence where
we train a representative recommendation model DIN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib1" title="">1</a>]</cite> on the benchmark Amazon Review dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib6" title="">6</a>]</cite> and evaluate the performance over equally sized user groups. User groups can be divided according to diverse factors, and we take two factors for illustration: 1) the activeness of users (<span class="ltx_text ltx_font_italic" id="S1.p1.1.1">i</span>.<span class="ltx_text ltx_font_italic" id="S1.p1.1.2">e</span>., the number of interactions during training); and 2) the user behavior consistency on popular items<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We cluster items into eighteen groups by popularity, equally split the behavior sequence of each user into two parts (past and now), and represent each part with item distribution over the clusters. We measure the behavior consistency on popular items of a user with the KL divergence of these two distributions. Intuitively, recommender models will perform better on users with consistent behaviors. </span></span></span>. In both cases, it is observed that a small portion of head users receive more accurate recommendation results than the others. Moreover, head users enjoy significantly more performance gains under unified training (one model for all groups) than group-wise training (one model for each group). This means that the unified training might aggravate the <span class="ltx_text ltx_font_bold" id="S1.p1.1.3">performance heterogeneity</span> problem among users due to model biases.
In this work, we analyze and address the performance heterogeneity issue in recommender systems, which has thus far received little scrutiny.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">There are indeed two sources of the performance heterogeneity issue from the data and model perspectives. A <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">natural source</span> is the imbalance of training data distribution over users. For instance, active users are likely to receive relatively accurate recommendations owing to rich interaction records and more comprehensive interest modeling. A <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">model source</span> is that recommender models further amplify the impact of data imbalance during training <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib7" title="">7</a>]</cite>, <span class="ltx_text ltx_font_italic" id="S1.p2.1.3">i</span>.<span class="ltx_text ltx_font_italic" id="S1.p2.1.4">e</span>., the model bias towards the head users.
Accordingly, we set two targets in addressing this performance heterogeneity issue: (1) we want to preserve the natural heterogeneity since forcibly removing it might hurt the overall performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib8" title="">8</a>]</cite>; and (2) we would like to eliminate the model bias that amplifies the heterogeneity. However, most existing methods either neglect or eliminate the heterogeneity, such as the fairness recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib9" title="">9</a>]</cite> that pursues equal performance across different groups<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Note that recommendation methods enforcing fairness also requires known sensitive features, which might be unavailable in the performance <span class="ltx_text" id="footnote2.1">heterogeneity<span class="ltx_text" id="footnote2.1.1"> problem.</span></span></span></span></span>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.10">To achieve the targets, we dive into the generation process of interactions to uncover the causes of the model bias, which is abstracted as a <span class="ltx_text ltx_font_italic" id="S1.p3.10.1">causal graph</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib10" title="">10</a>]</cite> as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">2</span></a>:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.5"><math alttext="X\rightarrow Y" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><mrow id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.2.cmml">X</mi><mo id="S1.I1.i1.p1.1.m1.1.1.1" stretchy="false" xref="S1.I1.i1.p1.1.m1.1.1.1.cmml">→</mo><mi id="S1.I1.i1.p1.1.m1.1.1.3" xref="S1.I1.i1.p1.1.m1.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><apply id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1"><ci id="S1.I1.i1.p1.1.m1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1">→</ci><ci id="S1.I1.i1.p1.1.m1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.2">𝑋</ci><ci id="S1.I1.i1.p1.1.m1.1.1.3.cmml" xref="S1.I1.i1.p1.1.m1.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">X\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">italic_X → italic_Y</annotation></semantics></math>. Recommendation models predict user next behavior <math alttext="Y" class="ltx_Math" display="inline" id="S1.I1.i1.p1.2.m2.1"><semantics id="S1.I1.i1.p1.2.m2.1a"><mi id="S1.I1.i1.p1.2.m2.1.1" xref="S1.I1.i1.p1.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.2.m2.1b"><ci id="S1.I1.i1.p1.2.m2.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.2.m2.1d">italic_Y</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S1.I1.i1.p1.5.1">e</span>.<span class="ltx_text ltx_font_italic" id="S1.I1.i1.p1.5.2">g</span>., clicking an item), based on user historical behaviors <math alttext="X" class="ltx_Math" display="inline" id="S1.I1.i1.p1.3.m3.1"><semantics id="S1.I1.i1.p1.3.m3.1a"><mi id="S1.I1.i1.p1.3.m3.1.1" xref="S1.I1.i1.p1.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.3.m3.1b"><ci id="S1.I1.i1.p1.3.m3.1.1.cmml" xref="S1.I1.i1.p1.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.3.m3.1d">italic_X</annotation></semantics></math> under the assumption that historical behaviors <math alttext="X" class="ltx_Math" display="inline" id="S1.I1.i1.p1.4.m4.1"><semantics id="S1.I1.i1.p1.4.m4.1a"><mi id="S1.I1.i1.p1.4.m4.1.1" xref="S1.I1.i1.p1.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.4.m4.1b"><ci id="S1.I1.i1.p1.4.m4.1.1.cmml" xref="S1.I1.i1.p1.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.4.m4.1d">italic_X</annotation></semantics></math> are the cause of next behavior <math alttext="Y" class="ltx_Math" display="inline" id="S1.I1.i1.p1.5.m5.1"><semantics id="S1.I1.i1.p1.5.m5.1a"><mi id="S1.I1.i1.p1.5.m5.1.1" xref="S1.I1.i1.p1.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.5.m5.1b"><ci id="S1.I1.i1.p1.5.m5.1.1.cmml" xref="S1.I1.i1.p1.5.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.5.m5.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.5.m5.1d">italic_Y</annotation></semantics></math>  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib2" title="">2</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.7"><math alttext="U\rightarrow X,U\rightarrow Y" class="ltx_Math" display="inline" id="S1.I1.i2.p1.1.m1.2"><semantics id="S1.I1.i2.p1.1.m1.2a"><mrow id="S1.I1.i2.p1.1.m1.2.2.2" xref="S1.I1.i2.p1.1.m1.2.2.3.cmml"><mrow id="S1.I1.i2.p1.1.m1.1.1.1.1" xref="S1.I1.i2.p1.1.m1.1.1.1.1.cmml"><mi id="S1.I1.i2.p1.1.m1.1.1.1.1.2" xref="S1.I1.i2.p1.1.m1.1.1.1.1.2.cmml">U</mi><mo id="S1.I1.i2.p1.1.m1.1.1.1.1.1" stretchy="false" xref="S1.I1.i2.p1.1.m1.1.1.1.1.1.cmml">→</mo><mi id="S1.I1.i2.p1.1.m1.1.1.1.1.3" xref="S1.I1.i2.p1.1.m1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S1.I1.i2.p1.1.m1.2.2.2.3" xref="S1.I1.i2.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="S1.I1.i2.p1.1.m1.2.2.2.2" xref="S1.I1.i2.p1.1.m1.2.2.2.2.cmml"><mi id="S1.I1.i2.p1.1.m1.2.2.2.2.2" xref="S1.I1.i2.p1.1.m1.2.2.2.2.2.cmml">U</mi><mo id="S1.I1.i2.p1.1.m1.2.2.2.2.1" stretchy="false" xref="S1.I1.i2.p1.1.m1.2.2.2.2.1.cmml">→</mo><mi id="S1.I1.i2.p1.1.m1.2.2.2.2.3" xref="S1.I1.i2.p1.1.m1.2.2.2.2.3.cmml">Y</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.m1.2b"><apply id="S1.I1.i2.p1.1.m1.2.2.3.cmml" xref="S1.I1.i2.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S1.I1.i2.p1.1.m1.2.2.3a.cmml" xref="S1.I1.i2.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S1.I1.i2.p1.1.m1.1.1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1.1.1"><ci id="S1.I1.i2.p1.1.m1.1.1.1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1.1.1.1">→</ci><ci id="S1.I1.i2.p1.1.m1.1.1.1.1.2.cmml" xref="S1.I1.i2.p1.1.m1.1.1.1.1.2">𝑈</ci><ci id="S1.I1.i2.p1.1.m1.1.1.1.1.3.cmml" xref="S1.I1.i2.p1.1.m1.1.1.1.1.3">𝑋</ci></apply><apply id="S1.I1.i2.p1.1.m1.2.2.2.2.cmml" xref="S1.I1.i2.p1.1.m1.2.2.2.2"><ci id="S1.I1.i2.p1.1.m1.2.2.2.2.1.cmml" xref="S1.I1.i2.p1.1.m1.2.2.2.2.1">→</ci><ci id="S1.I1.i2.p1.1.m1.2.2.2.2.2.cmml" xref="S1.I1.i2.p1.1.m1.2.2.2.2.2">𝑈</ci><ci id="S1.I1.i2.p1.1.m1.2.2.2.2.3.cmml" xref="S1.I1.i2.p1.1.m1.2.2.2.2.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.m1.2c">U\rightarrow X,U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.1.m1.2d">italic_U → italic_X , italic_U → italic_Y</annotation></semantics></math>. <math alttext="U" class="ltx_Math" display="inline" id="S1.I1.i2.p1.2.m2.1"><semantics id="S1.I1.i2.p1.2.m2.1a"><mi id="S1.I1.i2.p1.2.m2.1.1" xref="S1.I1.i2.p1.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.2.m2.1b"><ci id="S1.I1.i2.p1.2.m2.1.1.cmml" xref="S1.I1.i2.p1.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.2.m2.1c">U</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.2.m2.1d">italic_U</annotation></semantics></math> represents a set of factors (<span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.7.1">e</span>.<span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.7.2">g</span>., user activeness, and user preference on popular items) that directly influence user historical behaviors and next behaviors apart from the effect <math alttext="X\rightarrow Y" class="ltx_Math" display="inline" id="S1.I1.i2.p1.3.m3.1"><semantics id="S1.I1.i2.p1.3.m3.1a"><mrow id="S1.I1.i2.p1.3.m3.1.1" xref="S1.I1.i2.p1.3.m3.1.1.cmml"><mi id="S1.I1.i2.p1.3.m3.1.1.2" xref="S1.I1.i2.p1.3.m3.1.1.2.cmml">X</mi><mo id="S1.I1.i2.p1.3.m3.1.1.1" stretchy="false" xref="S1.I1.i2.p1.3.m3.1.1.1.cmml">→</mo><mi id="S1.I1.i2.p1.3.m3.1.1.3" xref="S1.I1.i2.p1.3.m3.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.3.m3.1b"><apply id="S1.I1.i2.p1.3.m3.1.1.cmml" xref="S1.I1.i2.p1.3.m3.1.1"><ci id="S1.I1.i2.p1.3.m3.1.1.1.cmml" xref="S1.I1.i2.p1.3.m3.1.1.1">→</ci><ci id="S1.I1.i2.p1.3.m3.1.1.2.cmml" xref="S1.I1.i2.p1.3.m3.1.1.2">𝑋</ci><ci id="S1.I1.i2.p1.3.m3.1.1.3.cmml" xref="S1.I1.i2.p1.3.m3.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.3.m3.1c">X\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.3.m3.1d">italic_X → italic_Y</annotation></semantics></math>. For instance, user activeness will increase the size of historical records <math alttext="U\rightarrow X" class="ltx_Math" display="inline" id="S1.I1.i2.p1.4.m4.1"><semantics id="S1.I1.i2.p1.4.m4.1a"><mrow id="S1.I1.i2.p1.4.m4.1.1" xref="S1.I1.i2.p1.4.m4.1.1.cmml"><mi id="S1.I1.i2.p1.4.m4.1.1.2" xref="S1.I1.i2.p1.4.m4.1.1.2.cmml">U</mi><mo id="S1.I1.i2.p1.4.m4.1.1.1" stretchy="false" xref="S1.I1.i2.p1.4.m4.1.1.1.cmml">→</mo><mi id="S1.I1.i2.p1.4.m4.1.1.3" xref="S1.I1.i2.p1.4.m4.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.4.m4.1b"><apply id="S1.I1.i2.p1.4.m4.1.1.cmml" xref="S1.I1.i2.p1.4.m4.1.1"><ci id="S1.I1.i2.p1.4.m4.1.1.1.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1">→</ci><ci id="S1.I1.i2.p1.4.m4.1.1.2.cmml" xref="S1.I1.i2.p1.4.m4.1.1.2">𝑈</ci><ci id="S1.I1.i2.p1.4.m4.1.1.3.cmml" xref="S1.I1.i2.p1.4.m4.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.4.m4.1c">U\rightarrow X</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.4.m4.1d">italic_U → italic_X</annotation></semantics></math> and encourage item exploration <math alttext="U\rightarrow Y" class="ltx_Math" display="inline" id="S1.I1.i2.p1.5.m5.1"><semantics id="S1.I1.i2.p1.5.m5.1a"><mrow id="S1.I1.i2.p1.5.m5.1.1" xref="S1.I1.i2.p1.5.m5.1.1.cmml"><mi id="S1.I1.i2.p1.5.m5.1.1.2" xref="S1.I1.i2.p1.5.m5.1.1.2.cmml">U</mi><mo id="S1.I1.i2.p1.5.m5.1.1.1" stretchy="false" xref="S1.I1.i2.p1.5.m5.1.1.1.cmml">→</mo><mi id="S1.I1.i2.p1.5.m5.1.1.3" xref="S1.I1.i2.p1.5.m5.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.5.m5.1b"><apply id="S1.I1.i2.p1.5.m5.1.1.cmml" xref="S1.I1.i2.p1.5.m5.1.1"><ci id="S1.I1.i2.p1.5.m5.1.1.1.cmml" xref="S1.I1.i2.p1.5.m5.1.1.1">→</ci><ci id="S1.I1.i2.p1.5.m5.1.1.2.cmml" xref="S1.I1.i2.p1.5.m5.1.1.2">𝑈</ci><ci id="S1.I1.i2.p1.5.m5.1.1.3.cmml" xref="S1.I1.i2.p1.5.m5.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.5.m5.1c">U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.5.m5.1d">italic_U → italic_Y</annotation></semantics></math>. User preference on popular items will influence the distribution of user historical behaviors <math alttext="U\rightarrow X" class="ltx_Math" display="inline" id="S1.I1.i2.p1.6.m6.1"><semantics id="S1.I1.i2.p1.6.m6.1a"><mrow id="S1.I1.i2.p1.6.m6.1.1" xref="S1.I1.i2.p1.6.m6.1.1.cmml"><mi id="S1.I1.i2.p1.6.m6.1.1.2" xref="S1.I1.i2.p1.6.m6.1.1.2.cmml">U</mi><mo id="S1.I1.i2.p1.6.m6.1.1.1" stretchy="false" xref="S1.I1.i2.p1.6.m6.1.1.1.cmml">→</mo><mi id="S1.I1.i2.p1.6.m6.1.1.3" xref="S1.I1.i2.p1.6.m6.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.6.m6.1b"><apply id="S1.I1.i2.p1.6.m6.1.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1"><ci id="S1.I1.i2.p1.6.m6.1.1.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1">→</ci><ci id="S1.I1.i2.p1.6.m6.1.1.2.cmml" xref="S1.I1.i2.p1.6.m6.1.1.2">𝑈</ci><ci id="S1.I1.i2.p1.6.m6.1.1.3.cmml" xref="S1.I1.i2.p1.6.m6.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.6.m6.1c">U\rightarrow X</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.6.m6.1d">italic_U → italic_X</annotation></semantics></math> and the property of the next item <math alttext="U\rightarrow Y" class="ltx_Math" display="inline" id="S1.I1.i2.p1.7.m7.1"><semantics id="S1.I1.i2.p1.7.m7.1a"><mrow id="S1.I1.i2.p1.7.m7.1.1" xref="S1.I1.i2.p1.7.m7.1.1.cmml"><mi id="S1.I1.i2.p1.7.m7.1.1.2" xref="S1.I1.i2.p1.7.m7.1.1.2.cmml">U</mi><mo id="S1.I1.i2.p1.7.m7.1.1.1" stretchy="false" xref="S1.I1.i2.p1.7.m7.1.1.1.cmml">→</mo><mi id="S1.I1.i2.p1.7.m7.1.1.3" xref="S1.I1.i2.p1.7.m7.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.7.m7.1b"><apply id="S1.I1.i2.p1.7.m7.1.1.cmml" xref="S1.I1.i2.p1.7.m7.1.1"><ci id="S1.I1.i2.p1.7.m7.1.1.1.cmml" xref="S1.I1.i2.p1.7.m7.1.1.1">→</ci><ci id="S1.I1.i2.p1.7.m7.1.1.2.cmml" xref="S1.I1.i2.p1.7.m7.1.1.2">𝑈</ci><ci id="S1.I1.i2.p1.7.m7.1.1.3.cmml" xref="S1.I1.i2.p1.7.m7.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.7.m7.1c">U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.7.m7.1d">italic_U → italic_Y</annotation></semantics></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p3.9"><math alttext="U" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_U</annotation></semantics></math> is identified as a confounder between <math alttext="X" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><mi id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><ci id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><mi id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><ci id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">italic_Y</annotation></semantics></math>, which will lead to spurious correlation <math alttext="X\leftarrow U\rightarrow Y" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><mrow id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml"><mi id="S1.p3.4.m4.1.1.2" xref="S1.p3.4.m4.1.1.2.cmml">X</mi><mo id="S1.p3.4.m4.1.1.3" stretchy="false" xref="S1.p3.4.m4.1.1.3.cmml">←</mo><mi id="S1.p3.4.m4.1.1.4" xref="S1.p3.4.m4.1.1.4.cmml">U</mi><mo id="S1.p3.4.m4.1.1.5" stretchy="false" xref="S1.p3.4.m4.1.1.5.cmml">→</mo><mi id="S1.p3.4.m4.1.1.6" xref="S1.p3.4.m4.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><apply id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1"><and id="S1.p3.4.m4.1.1a.cmml" xref="S1.p3.4.m4.1.1"></and><apply id="S1.p3.4.m4.1.1b.cmml" xref="S1.p3.4.m4.1.1"><ci id="S1.p3.4.m4.1.1.3.cmml" xref="S1.p3.4.m4.1.1.3">←</ci><ci id="S1.p3.4.m4.1.1.2.cmml" xref="S1.p3.4.m4.1.1.2">𝑋</ci><ci id="S1.p3.4.m4.1.1.4.cmml" xref="S1.p3.4.m4.1.1.4">𝑈</ci></apply><apply id="S1.p3.4.m4.1.1c.cmml" xref="S1.p3.4.m4.1.1"><ci id="S1.p3.4.m4.1.1.5.cmml" xref="S1.p3.4.m4.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S1.p3.4.m4.1.1.4.cmml" id="S1.p3.4.m4.1.1d.cmml" xref="S1.p3.4.m4.1.1"></share><ci id="S1.p3.4.m4.1.1.6.cmml" xref="S1.p3.4.m4.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">X\leftarrow U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">italic_X ← italic_U → italic_Y</annotation></semantics></math> when recommendation models (<span class="ltx_text ltx_font_italic" id="S1.p3.9.1">e</span>.<span class="ltx_text ltx_font_italic" id="S1.p3.9.2">g</span>., sequential recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib12" title="">12</a>]</cite> and graph-based recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib13" title="">13</a>]</cite>) estimate the correlation between historical behaviors and next behaviors <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib10" title="">10</a>]</cite>. The spurious correlation is the source of model bias that amplifies the performance heterogeneity.
For instance, preferring popular items <math alttext="U=1" class="ltx_Math" display="inline" id="S1.p3.5.m5.1"><semantics id="S1.p3.5.m5.1a"><mrow id="S1.p3.5.m5.1.1" xref="S1.p3.5.m5.1.1.cmml"><mi id="S1.p3.5.m5.1.1.2" xref="S1.p3.5.m5.1.1.2.cmml">U</mi><mo id="S1.p3.5.m5.1.1.1" xref="S1.p3.5.m5.1.1.1.cmml">=</mo><mn id="S1.p3.5.m5.1.1.3" xref="S1.p3.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.1b"><apply id="S1.p3.5.m5.1.1.cmml" xref="S1.p3.5.m5.1.1"><eq id="S1.p3.5.m5.1.1.1.cmml" xref="S1.p3.5.m5.1.1.1"></eq><ci id="S1.p3.5.m5.1.1.2.cmml" xref="S1.p3.5.m5.1.1.2">𝑈</ci><cn id="S1.p3.5.m5.1.1.3.cmml" type="integer" xref="S1.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.1c">U=1</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m5.1d">italic_U = 1</annotation></semantics></math> will lead to next behaviors <math alttext="Y" class="ltx_Math" display="inline" id="S1.p3.6.m6.1"><semantics id="S1.p3.6.m6.1a"><mi id="S1.p3.6.m6.1.1" xref="S1.p3.6.m6.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S1.p3.6.m6.1b"><ci id="S1.p3.6.m6.1.1.cmml" xref="S1.p3.6.m6.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m6.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S1.p3.6.m6.1d">italic_Y</annotation></semantics></math> linked with popular items that are not caused by historical behaviors <math alttext="X" class="ltx_Math" display="inline" id="S1.p3.7.m7.1"><semantics id="S1.p3.7.m7.1a"><mi id="S1.p3.7.m7.1.1" xref="S1.p3.7.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S1.p3.7.m7.1b"><ci id="S1.p3.7.m7.1.1.cmml" xref="S1.p3.7.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.7.m7.1c">X</annotation><annotation encoding="application/x-llamapun" id="S1.p3.7.m7.1d">italic_X</annotation></semantics></math>. Such <math alttext="&lt;" class="ltx_Math" display="inline" id="S1.p3.8.m8.1"><semantics id="S1.p3.8.m8.1a"><mo id="S1.p3.8.m8.1.1" xref="S1.p3.8.m8.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S1.p3.8.m8.1b"><lt id="S1.p3.8.m8.1.1.cmml" xref="S1.p3.8.m8.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.8.m8.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S1.p3.8.m8.1d">&lt;</annotation></semantics></math> historical behaviors, next behavior <math alttext="&gt;" class="ltx_Math" display="inline" id="S1.p3.9.m9.1"><semantics id="S1.p3.9.m9.1a"><mo id="S1.p3.9.m9.1.1" xref="S1.p3.9.m9.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S1.p3.9.m9.1b"><gt id="S1.p3.9.m9.1.1.cmml" xref="S1.p3.9.m9.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.9.m9.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S1.p3.9.m9.1d">&gt;</annotation></semantics></math> pairs are spuriously correlated and bias the model to recommend popular items regardless of historical behaviors. Note that such model bias might not do harm to users that prefer popular items (head users). However, other users might suffer from these spurious correlations under the unified training<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>The spurious correlation scores in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">2</span></a> are correlated with the results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">1</span></a> where the experiments are conducted in the Amazon Book dataset. Tail users obtain few gains in unified training due to suffering more spurious correlations.</span></span></span> and receive low-quality recommendations (<span class="ltx_text ltx_font_italic" id="S1.p3.9.3">cf</span>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">2</span></a>). As such, the performance heterogeneity issue is amplified due to the confounding.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.4">In this light, we focus on alleviating performance heterogeneity by blocking the spurious correlation <math alttext="X\leftarrow U\rightarrow Y" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mrow id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">X</mi><mo id="S1.p4.1.m1.1.1.3" stretchy="false" xref="S1.p4.1.m1.1.1.3.cmml">←</mo><mi id="S1.p4.1.m1.1.1.4" xref="S1.p4.1.m1.1.1.4.cmml">U</mi><mo id="S1.p4.1.m1.1.1.5" stretchy="false" xref="S1.p4.1.m1.1.1.5.cmml">→</mo><mi id="S1.p4.1.m1.1.1.6" xref="S1.p4.1.m1.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><and id="S1.p4.1.m1.1.1a.cmml" xref="S1.p4.1.m1.1.1"></and><apply id="S1.p4.1.m1.1.1b.cmml" xref="S1.p4.1.m1.1.1"><ci id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">←</ci><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">𝑋</ci><ci id="S1.p4.1.m1.1.1.4.cmml" xref="S1.p4.1.m1.1.1.4">𝑈</ci></apply><apply id="S1.p4.1.m1.1.1c.cmml" xref="S1.p4.1.m1.1.1"><ci id="S1.p4.1.m1.1.1.5.cmml" xref="S1.p4.1.m1.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S1.p4.1.m1.1.1.4.cmml" id="S1.p4.1.m1.1.1d.cmml" xref="S1.p4.1.m1.1.1"></share><ci id="S1.p4.1.m1.1.1.6.cmml" xref="S1.p4.1.m1.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">X\leftarrow U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_X ← italic_U → italic_Y</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S1.p4.4.3">i</span>.<span class="ltx_text ltx_font_italic" id="S1.p4.4.4">e</span>. modeling the causal effect <math alttext="X\rightarrow Y" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mrow id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mi id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2.cmml">X</mi><mo id="S1.p4.2.m2.1.1.1" stretchy="false" xref="S1.p4.2.m2.1.1.1.cmml">→</mo><mi id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><ci id="S1.p4.2.m2.1.1.1.cmml" xref="S1.p4.2.m2.1.1.1">→</ci><ci id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2">𝑋</ci><ci id="S1.p4.2.m2.1.1.3.cmml" xref="S1.p4.2.m2.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">X\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">italic_X → italic_Y</annotation></semantics></math>. Intuitively, we can achieve the target by applying the debiasing techniques in recommendation that handles confounders such as inverse propensity scoring (IPS)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib15" title="">15</a>]</cite>, back-door adjustment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib17" title="">17</a>]</cite>, counterfactual inference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib19" title="">19</a>]</cite>. To obtain accurate estimation, these methods require either unbiased data or <span class="ltx_text ltx_font_italic" id="S1.p4.4.5">observations of confounders</span>, which might not be easily satisfied in real-world recommender systems. For example, collecting unbiased data from random trials (<span class="ltx_text ltx_font_italic" id="S1.p4.4.6">e</span>.<span class="ltx_text ltx_font_italic" id="S1.p4.4.7">g</span>. uniform exposure) is costly due to hurting user experience. Meanwhile, <span class="ltx_text ltx_font_italic" id="S1.p4.4.8">unobserved</span> confounders are common in recommendation, breaking the unconfoundedness assumption <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib20" title="">20</a>]</cite>. <span class="ltx_text" id="S1.p4.4.2">For instance, social relationships (<span class="ltx_text ltx_font_italic" id="S1.p4.4.2.1">e</span>.<span class="ltx_text ltx_font_italic" id="S1.p4.4.2.2">g</span>., friends and family members) are known to have significant impact on recommender systems, <span class="ltx_text ltx_font_italic" id="S1.p4.4.2.3">i</span>.<span class="ltx_text ltx_font_italic" id="S1.p4.4.2.4">e</span>., bringing exposure to items (<math alttext="U\rightarrow Y" class="ltx_Math" display="inline" id="S1.p4.3.1.m1.1"><semantics id="S1.p4.3.1.m1.1a"><mrow id="S1.p4.3.1.m1.1.1" xref="S1.p4.3.1.m1.1.1.cmml"><mi id="S1.p4.3.1.m1.1.1.2" xref="S1.p4.3.1.m1.1.1.2.cmml">U</mi><mo id="S1.p4.3.1.m1.1.1.1" stretchy="false" xref="S1.p4.3.1.m1.1.1.1.cmml">→</mo><mi id="S1.p4.3.1.m1.1.1.3" xref="S1.p4.3.1.m1.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.3.1.m1.1b"><apply id="S1.p4.3.1.m1.1.1.cmml" xref="S1.p4.3.1.m1.1.1"><ci id="S1.p4.3.1.m1.1.1.1.cmml" xref="S1.p4.3.1.m1.1.1.1">→</ci><ci id="S1.p4.3.1.m1.1.1.2.cmml" xref="S1.p4.3.1.m1.1.1.2">𝑈</ci><ci id="S1.p4.3.1.m1.1.1.3.cmml" xref="S1.p4.3.1.m1.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.1.m1.1c">U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.1.m1.1d">italic_U → italic_Y</annotation></semantics></math>) when friends directly recommend items, and conformity to the users (<math alttext="U\rightarrow X" class="ltx_Math" display="inline" id="S1.p4.4.2.m2.1"><semantics id="S1.p4.4.2.m2.1a"><mrow id="S1.p4.4.2.m2.1.1" xref="S1.p4.4.2.m2.1.1.cmml"><mi id="S1.p4.4.2.m2.1.1.2" xref="S1.p4.4.2.m2.1.1.2.cmml">U</mi><mo id="S1.p4.4.2.m2.1.1.1" stretchy="false" xref="S1.p4.4.2.m2.1.1.1.cmml">→</mo><mi id="S1.p4.4.2.m2.1.1.3" xref="S1.p4.4.2.m2.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.4.2.m2.1b"><apply id="S1.p4.4.2.m2.1.1.cmml" xref="S1.p4.4.2.m2.1.1"><ci id="S1.p4.4.2.m2.1.1.1.cmml" xref="S1.p4.4.2.m2.1.1.1">→</ci><ci id="S1.p4.4.2.m2.1.1.2.cmml" xref="S1.p4.4.2.m2.1.1.2">𝑈</ci><ci id="S1.p4.4.2.m2.1.1.3.cmml" xref="S1.p4.4.2.m2.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.2.m2.1c">U\rightarrow X</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.2.m2.1d">italic_U → italic_X</annotation></semantics></math>). However, whether a click happens due to the user’s inherent interests or the suggestions/recommendations from the user’s friends or family members is not routinely available for many recommender systems. Another example of unobserved confounder is user’s current mood, which would TODO <span class="ltx_text" id="S1.p4.4.2.5"></span></span></p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Hence, there is an urgent need for a debiasing method to deal with unobserved confounders without costly unbiased data.
</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="291" id="S1.F2.1.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F2.3.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S1.F2.4.2" style="font-size:90%;">
Causal graph for illustrating the amplified performance heterogeneity due to spurious correlation.
</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.21">Towards the goal, we propose to estimate the causal effect <math alttext="P(Y\mid do(X))" class="ltx_Math" display="inline" id="S1.p6.1.m1.2"><semantics id="S1.p6.1.m1.2a"><mrow id="S1.p6.1.m1.2.2" xref="S1.p6.1.m1.2.2.cmml"><mi id="S1.p6.1.m1.2.2.3" xref="S1.p6.1.m1.2.2.3.cmml">P</mi><mo id="S1.p6.1.m1.2.2.2" xref="S1.p6.1.m1.2.2.2.cmml">⁢</mo><mrow id="S1.p6.1.m1.2.2.1.1" xref="S1.p6.1.m1.2.2.1.1.1.cmml"><mo id="S1.p6.1.m1.2.2.1.1.2" stretchy="false" xref="S1.p6.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S1.p6.1.m1.2.2.1.1.1" xref="S1.p6.1.m1.2.2.1.1.1.cmml"><mi id="S1.p6.1.m1.2.2.1.1.1.2" xref="S1.p6.1.m1.2.2.1.1.1.2.cmml">Y</mi><mo id="S1.p6.1.m1.2.2.1.1.1.1" xref="S1.p6.1.m1.2.2.1.1.1.1.cmml">∣</mo><mrow id="S1.p6.1.m1.2.2.1.1.1.3" xref="S1.p6.1.m1.2.2.1.1.1.3.cmml"><mi id="S1.p6.1.m1.2.2.1.1.1.3.2" xref="S1.p6.1.m1.2.2.1.1.1.3.2.cmml">d</mi><mo id="S1.p6.1.m1.2.2.1.1.1.3.1" xref="S1.p6.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S1.p6.1.m1.2.2.1.1.1.3.3" xref="S1.p6.1.m1.2.2.1.1.1.3.3.cmml">o</mi><mo id="S1.p6.1.m1.2.2.1.1.1.3.1a" xref="S1.p6.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S1.p6.1.m1.2.2.1.1.1.3.4.2" xref="S1.p6.1.m1.2.2.1.1.1.3.cmml"><mo id="S1.p6.1.m1.2.2.1.1.1.3.4.2.1" stretchy="false" xref="S1.p6.1.m1.2.2.1.1.1.3.cmml">(</mo><mi id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">X</mi><mo id="S1.p6.1.m1.2.2.1.1.1.3.4.2.2" stretchy="false" xref="S1.p6.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S1.p6.1.m1.2.2.1.1.3" stretchy="false" xref="S1.p6.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.2b"><apply id="S1.p6.1.m1.2.2.cmml" xref="S1.p6.1.m1.2.2"><times id="S1.p6.1.m1.2.2.2.cmml" xref="S1.p6.1.m1.2.2.2"></times><ci id="S1.p6.1.m1.2.2.3.cmml" xref="S1.p6.1.m1.2.2.3">𝑃</ci><apply id="S1.p6.1.m1.2.2.1.1.1.cmml" xref="S1.p6.1.m1.2.2.1.1"><csymbol cd="latexml" id="S1.p6.1.m1.2.2.1.1.1.1.cmml" xref="S1.p6.1.m1.2.2.1.1.1.1">conditional</csymbol><ci id="S1.p6.1.m1.2.2.1.1.1.2.cmml" xref="S1.p6.1.m1.2.2.1.1.1.2">𝑌</ci><apply id="S1.p6.1.m1.2.2.1.1.1.3.cmml" xref="S1.p6.1.m1.2.2.1.1.1.3"><times id="S1.p6.1.m1.2.2.1.1.1.3.1.cmml" xref="S1.p6.1.m1.2.2.1.1.1.3.1"></times><ci id="S1.p6.1.m1.2.2.1.1.1.3.2.cmml" xref="S1.p6.1.m1.2.2.1.1.1.3.2">𝑑</ci><ci id="S1.p6.1.m1.2.2.1.1.1.3.3.cmml" xref="S1.p6.1.m1.2.2.1.1.1.3.3">𝑜</ci><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.2c">P(Y\mid do(X))</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.2d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_X ) )</annotation></semantics></math> in recommendation through the front-door adjustment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib10" title="">10</a>]</cite> (FDA) according to the latent representation of user historical behaviors, which is a mediator between <math alttext="X" class="ltx_Math" display="inline" id="S1.p6.2.m2.1"><semantics id="S1.p6.2.m2.1a"><mi id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><ci id="S1.p6.2.m2.1.1.cmml" xref="S1.p6.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S1.p6.2.m2.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S1.p6.3.m3.1"><semantics id="S1.p6.3.m3.1a"><mi id="S1.p6.3.m3.1.1" xref="S1.p6.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S1.p6.3.m3.1b"><ci id="S1.p6.3.m3.1.1.cmml" xref="S1.p6.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.3.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S1.p6.3.m3.1d">italic_Y</annotation></semantics></math> (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.F3" title="Figure 3 ‣ 2.1 Back-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">3</span></a>).
The core idea of FDA is to estimate the outcome of the intervention <math alttext="do(X)" class="ltx_Math" display="inline" id="S1.p6.4.m4.1"><semantics id="S1.p6.4.m4.1a"><mrow id="S1.p6.4.m4.1.2" xref="S1.p6.4.m4.1.2.cmml"><mi id="S1.p6.4.m4.1.2.2" xref="S1.p6.4.m4.1.2.2.cmml">d</mi><mo id="S1.p6.4.m4.1.2.1" xref="S1.p6.4.m4.1.2.1.cmml">⁢</mo><mi id="S1.p6.4.m4.1.2.3" xref="S1.p6.4.m4.1.2.3.cmml">o</mi><mo id="S1.p6.4.m4.1.2.1a" xref="S1.p6.4.m4.1.2.1.cmml">⁢</mo><mrow id="S1.p6.4.m4.1.2.4.2" xref="S1.p6.4.m4.1.2.cmml"><mo id="S1.p6.4.m4.1.2.4.2.1" stretchy="false" xref="S1.p6.4.m4.1.2.cmml">(</mo><mi id="S1.p6.4.m4.1.1" xref="S1.p6.4.m4.1.1.cmml">X</mi><mo id="S1.p6.4.m4.1.2.4.2.2" stretchy="false" xref="S1.p6.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.4.m4.1b"><apply id="S1.p6.4.m4.1.2.cmml" xref="S1.p6.4.m4.1.2"><times id="S1.p6.4.m4.1.2.1.cmml" xref="S1.p6.4.m4.1.2.1"></times><ci id="S1.p6.4.m4.1.2.2.cmml" xref="S1.p6.4.m4.1.2.2">𝑑</ci><ci id="S1.p6.4.m4.1.2.3.cmml" xref="S1.p6.4.m4.1.2.3">𝑜</ci><ci id="S1.p6.4.m4.1.1.cmml" xref="S1.p6.4.m4.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.4.m4.1c">do(X)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.4.m4.1d">italic_d italic_o ( italic_X )</annotation></semantics></math> by adjusting the distribution <math alttext="P(Y\mid do(M))" class="ltx_Math" display="inline" id="S1.p6.5.m5.2"><semantics id="S1.p6.5.m5.2a"><mrow id="S1.p6.5.m5.2.2" xref="S1.p6.5.m5.2.2.cmml"><mi id="S1.p6.5.m5.2.2.3" xref="S1.p6.5.m5.2.2.3.cmml">P</mi><mo id="S1.p6.5.m5.2.2.2" xref="S1.p6.5.m5.2.2.2.cmml">⁢</mo><mrow id="S1.p6.5.m5.2.2.1.1" xref="S1.p6.5.m5.2.2.1.1.1.cmml"><mo id="S1.p6.5.m5.2.2.1.1.2" stretchy="false" xref="S1.p6.5.m5.2.2.1.1.1.cmml">(</mo><mrow id="S1.p6.5.m5.2.2.1.1.1" xref="S1.p6.5.m5.2.2.1.1.1.cmml"><mi id="S1.p6.5.m5.2.2.1.1.1.2" xref="S1.p6.5.m5.2.2.1.1.1.2.cmml">Y</mi><mo id="S1.p6.5.m5.2.2.1.1.1.1" xref="S1.p6.5.m5.2.2.1.1.1.1.cmml">∣</mo><mrow id="S1.p6.5.m5.2.2.1.1.1.3" xref="S1.p6.5.m5.2.2.1.1.1.3.cmml"><mi id="S1.p6.5.m5.2.2.1.1.1.3.2" xref="S1.p6.5.m5.2.2.1.1.1.3.2.cmml">d</mi><mo id="S1.p6.5.m5.2.2.1.1.1.3.1" xref="S1.p6.5.m5.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S1.p6.5.m5.2.2.1.1.1.3.3" xref="S1.p6.5.m5.2.2.1.1.1.3.3.cmml">o</mi><mo id="S1.p6.5.m5.2.2.1.1.1.3.1a" xref="S1.p6.5.m5.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S1.p6.5.m5.2.2.1.1.1.3.4.2" xref="S1.p6.5.m5.2.2.1.1.1.3.cmml"><mo id="S1.p6.5.m5.2.2.1.1.1.3.4.2.1" stretchy="false" xref="S1.p6.5.m5.2.2.1.1.1.3.cmml">(</mo><mi id="S1.p6.5.m5.1.1" xref="S1.p6.5.m5.1.1.cmml">M</mi><mo id="S1.p6.5.m5.2.2.1.1.1.3.4.2.2" stretchy="false" xref="S1.p6.5.m5.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S1.p6.5.m5.2.2.1.1.3" stretchy="false" xref="S1.p6.5.m5.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.5.m5.2b"><apply id="S1.p6.5.m5.2.2.cmml" xref="S1.p6.5.m5.2.2"><times id="S1.p6.5.m5.2.2.2.cmml" xref="S1.p6.5.m5.2.2.2"></times><ci id="S1.p6.5.m5.2.2.3.cmml" xref="S1.p6.5.m5.2.2.3">𝑃</ci><apply id="S1.p6.5.m5.2.2.1.1.1.cmml" xref="S1.p6.5.m5.2.2.1.1"><csymbol cd="latexml" id="S1.p6.5.m5.2.2.1.1.1.1.cmml" xref="S1.p6.5.m5.2.2.1.1.1.1">conditional</csymbol><ci id="S1.p6.5.m5.2.2.1.1.1.2.cmml" xref="S1.p6.5.m5.2.2.1.1.1.2">𝑌</ci><apply id="S1.p6.5.m5.2.2.1.1.1.3.cmml" xref="S1.p6.5.m5.2.2.1.1.1.3"><times id="S1.p6.5.m5.2.2.1.1.1.3.1.cmml" xref="S1.p6.5.m5.2.2.1.1.1.3.1"></times><ci id="S1.p6.5.m5.2.2.1.1.1.3.2.cmml" xref="S1.p6.5.m5.2.2.1.1.1.3.2">𝑑</ci><ci id="S1.p6.5.m5.2.2.1.1.1.3.3.cmml" xref="S1.p6.5.m5.2.2.1.1.1.3.3">𝑜</ci><ci id="S1.p6.5.m5.1.1.cmml" xref="S1.p6.5.m5.1.1">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.5.m5.2c">P(Y\mid do(M))</annotation><annotation encoding="application/x-llamapun" id="S1.p6.5.m5.2d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_M ) )</annotation></semantics></math> over <math alttext="P(M\mid X)" class="ltx_Math" display="inline" id="S1.p6.6.m6.1"><semantics id="S1.p6.6.m6.1a"><mrow id="S1.p6.6.m6.1.1" xref="S1.p6.6.m6.1.1.cmml"><mi id="S1.p6.6.m6.1.1.3" xref="S1.p6.6.m6.1.1.3.cmml">P</mi><mo id="S1.p6.6.m6.1.1.2" xref="S1.p6.6.m6.1.1.2.cmml">⁢</mo><mrow id="S1.p6.6.m6.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.cmml"><mo id="S1.p6.6.m6.1.1.1.1.2" stretchy="false" xref="S1.p6.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.6.m6.1.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.cmml"><mi id="S1.p6.6.m6.1.1.1.1.1.2" xref="S1.p6.6.m6.1.1.1.1.1.2.cmml">M</mi><mo id="S1.p6.6.m6.1.1.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.1.cmml">∣</mo><mi id="S1.p6.6.m6.1.1.1.1.1.3" xref="S1.p6.6.m6.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S1.p6.6.m6.1.1.1.1.3" stretchy="false" xref="S1.p6.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.6.m6.1b"><apply id="S1.p6.6.m6.1.1.cmml" xref="S1.p6.6.m6.1.1"><times id="S1.p6.6.m6.1.1.2.cmml" xref="S1.p6.6.m6.1.1.2"></times><ci id="S1.p6.6.m6.1.1.3.cmml" xref="S1.p6.6.m6.1.1.3">𝑃</ci><apply id="S1.p6.6.m6.1.1.1.1.1.cmml" xref="S1.p6.6.m6.1.1.1.1"><csymbol cd="latexml" id="S1.p6.6.m6.1.1.1.1.1.1.cmml" xref="S1.p6.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p6.6.m6.1.1.1.1.1.2.cmml" xref="S1.p6.6.m6.1.1.1.1.1.2">𝑀</ci><ci id="S1.p6.6.m6.1.1.1.1.1.3.cmml" xref="S1.p6.6.m6.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.6.m6.1c">P(M\mid X)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.6.m6.1d">italic_P ( italic_M ∣ italic_X )</annotation></semantics></math>.
FDA thus takes a two-step estimation procedure: 1) sampling <math alttext="M=m" class="ltx_Math" display="inline" id="S1.p6.7.m7.1"><semantics id="S1.p6.7.m7.1a"><mrow id="S1.p6.7.m7.1.1" xref="S1.p6.7.m7.1.1.cmml"><mi id="S1.p6.7.m7.1.1.2" xref="S1.p6.7.m7.1.1.2.cmml">M</mi><mo id="S1.p6.7.m7.1.1.1" xref="S1.p6.7.m7.1.1.1.cmml">=</mo><mi id="S1.p6.7.m7.1.1.3" xref="S1.p6.7.m7.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.7.m7.1b"><apply id="S1.p6.7.m7.1.1.cmml" xref="S1.p6.7.m7.1.1"><eq id="S1.p6.7.m7.1.1.1.cmml" xref="S1.p6.7.m7.1.1.1"></eq><ci id="S1.p6.7.m7.1.1.2.cmml" xref="S1.p6.7.m7.1.1.2">𝑀</ci><ci id="S1.p6.7.m7.1.1.3.cmml" xref="S1.p6.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.7.m7.1c">M=m</annotation><annotation encoding="application/x-llamapun" id="S1.p6.7.m7.1d">italic_M = italic_m</annotation></semantics></math> from <math alttext="P(M\mid X)" class="ltx_Math" display="inline" id="S1.p6.8.m8.1"><semantics id="S1.p6.8.m8.1a"><mrow id="S1.p6.8.m8.1.1" xref="S1.p6.8.m8.1.1.cmml"><mi id="S1.p6.8.m8.1.1.3" xref="S1.p6.8.m8.1.1.3.cmml">P</mi><mo id="S1.p6.8.m8.1.1.2" xref="S1.p6.8.m8.1.1.2.cmml">⁢</mo><mrow id="S1.p6.8.m8.1.1.1.1" xref="S1.p6.8.m8.1.1.1.1.1.cmml"><mo id="S1.p6.8.m8.1.1.1.1.2" stretchy="false" xref="S1.p6.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.8.m8.1.1.1.1.1" xref="S1.p6.8.m8.1.1.1.1.1.cmml"><mi id="S1.p6.8.m8.1.1.1.1.1.2" xref="S1.p6.8.m8.1.1.1.1.1.2.cmml">M</mi><mo id="S1.p6.8.m8.1.1.1.1.1.1" xref="S1.p6.8.m8.1.1.1.1.1.1.cmml">∣</mo><mi id="S1.p6.8.m8.1.1.1.1.1.3" xref="S1.p6.8.m8.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S1.p6.8.m8.1.1.1.1.3" stretchy="false" xref="S1.p6.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.8.m8.1b"><apply id="S1.p6.8.m8.1.1.cmml" xref="S1.p6.8.m8.1.1"><times id="S1.p6.8.m8.1.1.2.cmml" xref="S1.p6.8.m8.1.1.2"></times><ci id="S1.p6.8.m8.1.1.3.cmml" xref="S1.p6.8.m8.1.1.3">𝑃</ci><apply id="S1.p6.8.m8.1.1.1.1.1.cmml" xref="S1.p6.8.m8.1.1.1.1"><csymbol cd="latexml" id="S1.p6.8.m8.1.1.1.1.1.1.cmml" xref="S1.p6.8.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p6.8.m8.1.1.1.1.1.2.cmml" xref="S1.p6.8.m8.1.1.1.1.1.2">𝑀</ci><ci id="S1.p6.8.m8.1.1.1.1.1.3.cmml" xref="S1.p6.8.m8.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.8.m8.1c">P(M\mid X)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.8.m8.1d">italic_P ( italic_M ∣ italic_X )</annotation></semantics></math>; and 2) estimating the causal effect from <math alttext="M" class="ltx_Math" display="inline" id="S1.p6.9.m9.1"><semantics id="S1.p6.9.m9.1a"><mi id="S1.p6.9.m9.1.1" xref="S1.p6.9.m9.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p6.9.m9.1b"><ci id="S1.p6.9.m9.1.1.cmml" xref="S1.p6.9.m9.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.9.m9.1c">M</annotation><annotation encoding="application/x-llamapun" id="S1.p6.9.m9.1d">italic_M</annotation></semantics></math> to <math alttext="Y" class="ltx_Math" display="inline" id="S1.p6.10.m10.1"><semantics id="S1.p6.10.m10.1a"><mi id="S1.p6.10.m10.1.1" xref="S1.p6.10.m10.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S1.p6.10.m10.1b"><ci id="S1.p6.10.m10.1.1.cmml" xref="S1.p6.10.m10.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.10.m10.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S1.p6.10.m10.1d">italic_Y</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S1.p6.21.1">i</span>.<span class="ltx_text ltx_font_italic" id="S1.p6.21.2">e</span>. <math alttext="P(Y\mid do(M=m))" class="ltx_Math" display="inline" id="S1.p6.11.m11.1"><semantics id="S1.p6.11.m11.1a"><mrow id="S1.p6.11.m11.1.1" xref="S1.p6.11.m11.1.1.cmml"><mi id="S1.p6.11.m11.1.1.3" xref="S1.p6.11.m11.1.1.3.cmml">P</mi><mo id="S1.p6.11.m11.1.1.2" xref="S1.p6.11.m11.1.1.2.cmml">⁢</mo><mrow id="S1.p6.11.m11.1.1.1.1" xref="S1.p6.11.m11.1.1.1.1.1.cmml"><mo id="S1.p6.11.m11.1.1.1.1.2" stretchy="false" xref="S1.p6.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.11.m11.1.1.1.1.1" xref="S1.p6.11.m11.1.1.1.1.1.cmml"><mi id="S1.p6.11.m11.1.1.1.1.1.3" xref="S1.p6.11.m11.1.1.1.1.1.3.cmml">Y</mi><mo id="S1.p6.11.m11.1.1.1.1.1.2" xref="S1.p6.11.m11.1.1.1.1.1.2.cmml">∣</mo><mrow id="S1.p6.11.m11.1.1.1.1.1.1" xref="S1.p6.11.m11.1.1.1.1.1.1.cmml"><mi id="S1.p6.11.m11.1.1.1.1.1.1.3" xref="S1.p6.11.m11.1.1.1.1.1.1.3.cmml">d</mi><mo id="S1.p6.11.m11.1.1.1.1.1.1.2" xref="S1.p6.11.m11.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S1.p6.11.m11.1.1.1.1.1.1.4" xref="S1.p6.11.m11.1.1.1.1.1.1.4.cmml">o</mi><mo id="S1.p6.11.m11.1.1.1.1.1.1.2a" xref="S1.p6.11.m11.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S1.p6.11.m11.1.1.1.1.1.1.1.1" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.cmml"><mo id="S1.p6.11.m11.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.11.m11.1.1.1.1.1.1.1.1.1" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.cmml"><mi id="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.2" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.2.cmml">M</mi><mo id="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.1" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.3" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S1.p6.11.m11.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S1.p6.11.m11.1.1.1.1.3" stretchy="false" xref="S1.p6.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.11.m11.1b"><apply id="S1.p6.11.m11.1.1.cmml" xref="S1.p6.11.m11.1.1"><times id="S1.p6.11.m11.1.1.2.cmml" xref="S1.p6.11.m11.1.1.2"></times><ci id="S1.p6.11.m11.1.1.3.cmml" xref="S1.p6.11.m11.1.1.3">𝑃</ci><apply id="S1.p6.11.m11.1.1.1.1.1.cmml" xref="S1.p6.11.m11.1.1.1.1"><csymbol cd="latexml" id="S1.p6.11.m11.1.1.1.1.1.2.cmml" xref="S1.p6.11.m11.1.1.1.1.1.2">conditional</csymbol><ci id="S1.p6.11.m11.1.1.1.1.1.3.cmml" xref="S1.p6.11.m11.1.1.1.1.1.3">𝑌</ci><apply id="S1.p6.11.m11.1.1.1.1.1.1.cmml" xref="S1.p6.11.m11.1.1.1.1.1.1"><times id="S1.p6.11.m11.1.1.1.1.1.1.2.cmml" xref="S1.p6.11.m11.1.1.1.1.1.1.2"></times><ci id="S1.p6.11.m11.1.1.1.1.1.1.3.cmml" xref="S1.p6.11.m11.1.1.1.1.1.1.3">𝑑</ci><ci id="S1.p6.11.m11.1.1.1.1.1.1.4.cmml" xref="S1.p6.11.m11.1.1.1.1.1.1.4">𝑜</ci><apply id="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.cmml" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1"><eq id="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.1"></eq><ci id="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.2.cmml" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.3.cmml" xref="S1.p6.11.m11.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.11.m11.1c">P(Y\mid do(M=m))</annotation><annotation encoding="application/x-llamapun" id="S1.p6.11.m11.1d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_M = italic_m ) )</annotation></semantics></math>.
However, these estimations are non-trivial in recommendation for two reasons:
1) the deterministic encoder in many existing recommendation models can only generate one latent user representation <math alttext="m" class="ltx_Math" display="inline" id="S1.p6.12.m12.1"><semantics id="S1.p6.12.m12.1a"><mi id="S1.p6.12.m12.1.1" xref="S1.p6.12.m12.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.p6.12.m12.1b"><ci id="S1.p6.12.m12.1.1.cmml" xref="S1.p6.12.m12.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.12.m12.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.p6.12.m12.1d">italic_m</annotation></semantics></math>, failing to model the conditional distribution <math alttext="P(M\mid X)" class="ltx_Math" display="inline" id="S1.p6.13.m13.1"><semantics id="S1.p6.13.m13.1a"><mrow id="S1.p6.13.m13.1.1" xref="S1.p6.13.m13.1.1.cmml"><mi id="S1.p6.13.m13.1.1.3" xref="S1.p6.13.m13.1.1.3.cmml">P</mi><mo id="S1.p6.13.m13.1.1.2" xref="S1.p6.13.m13.1.1.2.cmml">⁢</mo><mrow id="S1.p6.13.m13.1.1.1.1" xref="S1.p6.13.m13.1.1.1.1.1.cmml"><mo id="S1.p6.13.m13.1.1.1.1.2" stretchy="false" xref="S1.p6.13.m13.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.13.m13.1.1.1.1.1" xref="S1.p6.13.m13.1.1.1.1.1.cmml"><mi id="S1.p6.13.m13.1.1.1.1.1.2" xref="S1.p6.13.m13.1.1.1.1.1.2.cmml">M</mi><mo id="S1.p6.13.m13.1.1.1.1.1.1" xref="S1.p6.13.m13.1.1.1.1.1.1.cmml">∣</mo><mi id="S1.p6.13.m13.1.1.1.1.1.3" xref="S1.p6.13.m13.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S1.p6.13.m13.1.1.1.1.3" stretchy="false" xref="S1.p6.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.13.m13.1b"><apply id="S1.p6.13.m13.1.1.cmml" xref="S1.p6.13.m13.1.1"><times id="S1.p6.13.m13.1.1.2.cmml" xref="S1.p6.13.m13.1.1.2"></times><ci id="S1.p6.13.m13.1.1.3.cmml" xref="S1.p6.13.m13.1.1.3">𝑃</ci><apply id="S1.p6.13.m13.1.1.1.1.1.cmml" xref="S1.p6.13.m13.1.1.1.1"><csymbol cd="latexml" id="S1.p6.13.m13.1.1.1.1.1.1.cmml" xref="S1.p6.13.m13.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p6.13.m13.1.1.1.1.1.2.cmml" xref="S1.p6.13.m13.1.1.1.1.1.2">𝑀</ci><ci id="S1.p6.13.m13.1.1.1.1.1.3.cmml" xref="S1.p6.13.m13.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.13.m13.1c">P(M\mid X)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.13.m13.1d">italic_P ( italic_M ∣ italic_X )</annotation></semantics></math> and sample multiple <math alttext="m" class="ltx_Math" display="inline" id="S1.p6.14.m14.1"><semantics id="S1.p6.14.m14.1a"><mi id="S1.p6.14.m14.1.1" xref="S1.p6.14.m14.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.p6.14.m14.1b"><ci id="S1.p6.14.m14.1.1.cmml" xref="S1.p6.14.m14.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.14.m14.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.p6.14.m14.1d">italic_m</annotation></semantics></math>;
and 2) under the strict latency restrictions in recommender systems, the computation cost of enumerating <math alttext="M" class="ltx_Math" display="inline" id="S1.p6.15.m15.1"><semantics id="S1.p6.15.m15.1a"><mi id="S1.p6.15.m15.1.1" xref="S1.p6.15.m15.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p6.15.m15.1b"><ci id="S1.p6.15.m15.1.1.cmml" xref="S1.p6.15.m15.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.15.m15.1c">M</annotation><annotation encoding="application/x-llamapun" id="S1.p6.15.m15.1d">italic_M</annotation></semantics></math> and <math alttext="X" class="ltx_Math" display="inline" id="S1.p6.16.m16.1"><semantics id="S1.p6.16.m16.1a"><mi id="S1.p6.16.m16.1.1" xref="S1.p6.16.m16.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S1.p6.16.m16.1b"><ci id="S1.p6.16.m16.1.1.cmml" xref="S1.p6.16.m16.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.16.m16.1c">X</annotation><annotation encoding="application/x-llamapun" id="S1.p6.16.m16.1d">italic_X</annotation></semantics></math> is unaffordable during model inference.
To tackle these two challenges, we encapsulate multi-teacher distillation into the instantiation of FDA, and propose the causal distillation framework, named <span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p6.21.3" style="color:#000000;">CausalD</span>. CausalD employs the pre-trained heterogeneous models to perform sampling of <math alttext="M=m" class="ltx_Math" display="inline" id="S1.p6.17.m17.1"><semantics id="S1.p6.17.m17.1a"><mrow id="S1.p6.17.m17.1.1" xref="S1.p6.17.m17.1.1.cmml"><mi id="S1.p6.17.m17.1.1.2" xref="S1.p6.17.m17.1.1.2.cmml">M</mi><mo id="S1.p6.17.m17.1.1.1" xref="S1.p6.17.m17.1.1.1.cmml">=</mo><mi id="S1.p6.17.m17.1.1.3" xref="S1.p6.17.m17.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.17.m17.1b"><apply id="S1.p6.17.m17.1.1.cmml" xref="S1.p6.17.m17.1.1"><eq id="S1.p6.17.m17.1.1.1.cmml" xref="S1.p6.17.m17.1.1.1"></eq><ci id="S1.p6.17.m17.1.1.2.cmml" xref="S1.p6.17.m17.1.1.2">𝑀</ci><ci id="S1.p6.17.m17.1.1.3.cmml" xref="S1.p6.17.m17.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.17.m17.1c">M=m</annotation><annotation encoding="application/x-llamapun" id="S1.p6.17.m17.1d">italic_M = italic_m</annotation></semantics></math> give <math alttext="X" class="ltx_Math" display="inline" id="S1.p6.18.m18.1"><semantics id="S1.p6.18.m18.1a"><mi id="S1.p6.18.m18.1.1" xref="S1.p6.18.m18.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S1.p6.18.m18.1b"><ci id="S1.p6.18.m18.1.1.cmml" xref="S1.p6.18.m18.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.18.m18.1c">X</annotation><annotation encoding="application/x-llamapun" id="S1.p6.18.m18.1d">italic_X</annotation></semantics></math> (Challenge 1). Upon the model-based sampling, CausalD estimates the causal effects based on user sampling and multi-teacher ensemble. The estimated causal effects serve as the distillation label for training an efficient student recommendation model, which directly estimates the effect without modeling <math alttext="P(M\mid X)" class="ltx_Math" display="inline" id="S1.p6.19.m19.1"><semantics id="S1.p6.19.m19.1a"><mrow id="S1.p6.19.m19.1.1" xref="S1.p6.19.m19.1.1.cmml"><mi id="S1.p6.19.m19.1.1.3" xref="S1.p6.19.m19.1.1.3.cmml">P</mi><mo id="S1.p6.19.m19.1.1.2" xref="S1.p6.19.m19.1.1.2.cmml">⁢</mo><mrow id="S1.p6.19.m19.1.1.1.1" xref="S1.p6.19.m19.1.1.1.1.1.cmml"><mo id="S1.p6.19.m19.1.1.1.1.2" stretchy="false" xref="S1.p6.19.m19.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.19.m19.1.1.1.1.1" xref="S1.p6.19.m19.1.1.1.1.1.cmml"><mi id="S1.p6.19.m19.1.1.1.1.1.2" xref="S1.p6.19.m19.1.1.1.1.1.2.cmml">M</mi><mo id="S1.p6.19.m19.1.1.1.1.1.1" xref="S1.p6.19.m19.1.1.1.1.1.1.cmml">∣</mo><mi id="S1.p6.19.m19.1.1.1.1.1.3" xref="S1.p6.19.m19.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S1.p6.19.m19.1.1.1.1.3" stretchy="false" xref="S1.p6.19.m19.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.19.m19.1b"><apply id="S1.p6.19.m19.1.1.cmml" xref="S1.p6.19.m19.1.1"><times id="S1.p6.19.m19.1.1.2.cmml" xref="S1.p6.19.m19.1.1.2"></times><ci id="S1.p6.19.m19.1.1.3.cmml" xref="S1.p6.19.m19.1.1.3">𝑃</ci><apply id="S1.p6.19.m19.1.1.1.1.1.cmml" xref="S1.p6.19.m19.1.1.1.1"><csymbol cd="latexml" id="S1.p6.19.m19.1.1.1.1.1.1.cmml" xref="S1.p6.19.m19.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p6.19.m19.1.1.1.1.1.2.cmml" xref="S1.p6.19.m19.1.1.1.1.1.2">𝑀</ci><ci id="S1.p6.19.m19.1.1.1.1.1.3.cmml" xref="S1.p6.19.m19.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.19.m19.1c">P(M\mid X)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.19.m19.1d">italic_P ( italic_M ∣ italic_X )</annotation></semantics></math> and <math alttext="(Y\mid do(M=m))" class="ltx_Math" display="inline" id="S1.p6.20.m20.1"><semantics id="S1.p6.20.m20.1a"><mrow id="S1.p6.20.m20.1.1.1" xref="S1.p6.20.m20.1.1.1.1.cmml"><mo id="S1.p6.20.m20.1.1.1.2" stretchy="false" xref="S1.p6.20.m20.1.1.1.1.cmml">(</mo><mrow id="S1.p6.20.m20.1.1.1.1" xref="S1.p6.20.m20.1.1.1.1.cmml"><mi id="S1.p6.20.m20.1.1.1.1.3" xref="S1.p6.20.m20.1.1.1.1.3.cmml">Y</mi><mo id="S1.p6.20.m20.1.1.1.1.2" xref="S1.p6.20.m20.1.1.1.1.2.cmml">∣</mo><mrow id="S1.p6.20.m20.1.1.1.1.1" xref="S1.p6.20.m20.1.1.1.1.1.cmml"><mi id="S1.p6.20.m20.1.1.1.1.1.3" xref="S1.p6.20.m20.1.1.1.1.1.3.cmml">d</mi><mo id="S1.p6.20.m20.1.1.1.1.1.2" xref="S1.p6.20.m20.1.1.1.1.1.2.cmml">⁢</mo><mi id="S1.p6.20.m20.1.1.1.1.1.4" xref="S1.p6.20.m20.1.1.1.1.1.4.cmml">o</mi><mo id="S1.p6.20.m20.1.1.1.1.1.2a" xref="S1.p6.20.m20.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S1.p6.20.m20.1.1.1.1.1.1.1" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.cmml"><mo id="S1.p6.20.m20.1.1.1.1.1.1.1.2" stretchy="false" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.20.m20.1.1.1.1.1.1.1.1" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.cmml"><mi id="S1.p6.20.m20.1.1.1.1.1.1.1.1.2" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.2.cmml">M</mi><mo id="S1.p6.20.m20.1.1.1.1.1.1.1.1.1" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S1.p6.20.m20.1.1.1.1.1.1.1.1.3" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S1.p6.20.m20.1.1.1.1.1.1.1.3" stretchy="false" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S1.p6.20.m20.1.1.1.3" stretchy="false" xref="S1.p6.20.m20.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.20.m20.1b"><apply id="S1.p6.20.m20.1.1.1.1.cmml" xref="S1.p6.20.m20.1.1.1"><csymbol cd="latexml" id="S1.p6.20.m20.1.1.1.1.2.cmml" xref="S1.p6.20.m20.1.1.1.1.2">conditional</csymbol><ci id="S1.p6.20.m20.1.1.1.1.3.cmml" xref="S1.p6.20.m20.1.1.1.1.3">𝑌</ci><apply id="S1.p6.20.m20.1.1.1.1.1.cmml" xref="S1.p6.20.m20.1.1.1.1.1"><times id="S1.p6.20.m20.1.1.1.1.1.2.cmml" xref="S1.p6.20.m20.1.1.1.1.1.2"></times><ci id="S1.p6.20.m20.1.1.1.1.1.3.cmml" xref="S1.p6.20.m20.1.1.1.1.1.3">𝑑</ci><ci id="S1.p6.20.m20.1.1.1.1.1.4.cmml" xref="S1.p6.20.m20.1.1.1.1.1.4">𝑜</ci><apply id="S1.p6.20.m20.1.1.1.1.1.1.1.1.cmml" xref="S1.p6.20.m20.1.1.1.1.1.1.1"><eq id="S1.p6.20.m20.1.1.1.1.1.1.1.1.1.cmml" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.1"></eq><ci id="S1.p6.20.m20.1.1.1.1.1.1.1.1.2.cmml" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S1.p6.20.m20.1.1.1.1.1.1.1.1.3.cmml" xref="S1.p6.20.m20.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.20.m20.1c">(Y\mid do(M=m))</annotation><annotation encoding="application/x-llamapun" id="S1.p6.20.m20.1d">( italic_Y ∣ italic_d italic_o ( italic_M = italic_m ) )</annotation></semantics></math> per <math alttext="m" class="ltx_Math" display="inline" id="S1.p6.21.m21.1"><semantics id="S1.p6.21.m21.1a"><mi id="S1.p6.21.m21.1.1" xref="S1.p6.21.m21.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.p6.21.m21.1b"><ci id="S1.p6.21.m21.1.1.cmml" xref="S1.p6.21.m21.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.21.m21.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.p6.21.m21.1d">italic_m</annotation></semantics></math> (Challenge 2).
In summary, this work makes the following contributions:
</p>
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">We analyze the performance heterogeneity issue of recommender models from a causal view and address the issue by modeling causal effect with front-door adjustment to handle the <span class="ltx_text ltx_font_italic" id="S1.I2.i1.p1.1.1">unobserved confounders</span>.
</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1">We propose a <span class="ltx_text ltx_font_italic" id="S1.I2.i2.p1.1.1">causal multi-teacher distillation</span> (CausalD) framework, which realizes FDA to estimate the causal effect and preserves the inference efficiency.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1">We instantiate CausalD on DIN and DeepFM, and conduct extensive experiments on three real-world datasets, validating the effectiveness of our analysis and CausalD.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Preliminaries</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.13">Confounding is the distortion of the association between two variables <math alttext="X" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_Y</annotation></semantics></math>, which share a common cause, namely the confounder <math alttext="U" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">U</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_U</annotation></semantics></math>. The confounder will bring the spurious correlation between <math alttext="X" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_Y</annotation></semantics></math> (<math alttext="X\leftarrow U\rightarrow Y" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><mrow id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">X</mi><mo id="S2.p1.6.m6.1.1.3" stretchy="false" xref="S2.p1.6.m6.1.1.3.cmml">←</mo><mi id="S2.p1.6.m6.1.1.4" xref="S2.p1.6.m6.1.1.4.cmml">U</mi><mo id="S2.p1.6.m6.1.1.5" stretchy="false" xref="S2.p1.6.m6.1.1.5.cmml">→</mo><mi id="S2.p1.6.m6.1.1.6" xref="S2.p1.6.m6.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><and id="S2.p1.6.m6.1.1a.cmml" xref="S2.p1.6.m6.1.1"></and><apply id="S2.p1.6.m6.1.1b.cmml" xref="S2.p1.6.m6.1.1"><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">←</ci><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑋</ci><ci id="S2.p1.6.m6.1.1.4.cmml" xref="S2.p1.6.m6.1.1.4">𝑈</ci></apply><apply id="S2.p1.6.m6.1.1c.cmml" xref="S2.p1.6.m6.1.1"><ci id="S2.p1.6.m6.1.1.5.cmml" xref="S2.p1.6.m6.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S2.p1.6.m6.1.1.4.cmml" id="S2.p1.6.m6.1.1d.cmml" xref="S2.p1.6.m6.1.1"></share><ci id="S2.p1.6.m6.1.1.6.cmml" xref="S2.p1.6.m6.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">X\leftarrow U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">italic_X ← italic_U → italic_Y</annotation></semantics></math>), leading to the gap between <math alttext="P(Y\mid X)" class="ltx_Math" display="inline" id="S2.p1.7.m7.1"><semantics id="S2.p1.7.m7.1a"><mrow id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mi id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml">P</mi><mo id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml">⁢</mo><mrow id="S2.p1.7.m7.1.1.1.1" xref="S2.p1.7.m7.1.1.1.1.1.cmml"><mo id="S2.p1.7.m7.1.1.1.1.2" stretchy="false" xref="S2.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S2.p1.7.m7.1.1.1.1.1" xref="S2.p1.7.m7.1.1.1.1.1.cmml"><mi id="S2.p1.7.m7.1.1.1.1.1.2" xref="S2.p1.7.m7.1.1.1.1.1.2.cmml">Y</mi><mo id="S2.p1.7.m7.1.1.1.1.1.1" xref="S2.p1.7.m7.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.p1.7.m7.1.1.1.1.1.3" xref="S2.p1.7.m7.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S2.p1.7.m7.1.1.1.1.3" stretchy="false" xref="S2.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><times id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2"></times><ci id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3">𝑃</ci><apply id="S2.p1.7.m7.1.1.1.1.1.cmml" xref="S2.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="S2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S2.p1.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S2.p1.7.m7.1.1.1.1.1.2">𝑌</ci><ci id="S2.p1.7.m7.1.1.1.1.1.3.cmml" xref="S2.p1.7.m7.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">P(Y\mid X)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.1d">italic_P ( italic_Y ∣ italic_X )</annotation></semantics></math> and the causal effect of <math alttext="X" class="ltx_Math" display="inline" id="S2.p1.8.m8.1"><semantics id="S2.p1.8.m8.1a"><mi id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><ci id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m8.1d">italic_X</annotation></semantics></math> on <math alttext="Y" class="ltx_Math" display="inline" id="S2.p1.9.m9.1"><semantics id="S2.p1.9.m9.1a"><mi id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.1b"><ci id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.p1.9.m9.1d">italic_Y</annotation></semantics></math>.
To accurately estimate the causal effect, causal inference performs interventions by introducing the <math alttext="do" class="ltx_Math" display="inline" id="S2.p1.10.m10.1"><semantics id="S2.p1.10.m10.1a"><mrow id="S2.p1.10.m10.1.1" xref="S2.p1.10.m10.1.1.cmml"><mi id="S2.p1.10.m10.1.1.2" xref="S2.p1.10.m10.1.1.2.cmml">d</mi><mo id="S2.p1.10.m10.1.1.1" xref="S2.p1.10.m10.1.1.1.cmml">⁢</mo><mi id="S2.p1.10.m10.1.1.3" xref="S2.p1.10.m10.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.10.m10.1b"><apply id="S2.p1.10.m10.1.1.cmml" xref="S2.p1.10.m10.1.1"><times id="S2.p1.10.m10.1.1.1.cmml" xref="S2.p1.10.m10.1.1.1"></times><ci id="S2.p1.10.m10.1.1.2.cmml" xref="S2.p1.10.m10.1.1.2">𝑑</ci><ci id="S2.p1.10.m10.1.1.3.cmml" xref="S2.p1.10.m10.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m10.1c">do</annotation><annotation encoding="application/x-llamapun" id="S2.p1.10.m10.1d">italic_d italic_o</annotation></semantics></math>-operator and estimates <math alttext="P(Y\mid do(X))" class="ltx_Math" display="inline" id="S2.p1.11.m11.2"><semantics id="S2.p1.11.m11.2a"><mrow id="S2.p1.11.m11.2.2" xref="S2.p1.11.m11.2.2.cmml"><mi id="S2.p1.11.m11.2.2.3" xref="S2.p1.11.m11.2.2.3.cmml">P</mi><mo id="S2.p1.11.m11.2.2.2" xref="S2.p1.11.m11.2.2.2.cmml">⁢</mo><mrow id="S2.p1.11.m11.2.2.1.1" xref="S2.p1.11.m11.2.2.1.1.1.cmml"><mo id="S2.p1.11.m11.2.2.1.1.2" stretchy="false" xref="S2.p1.11.m11.2.2.1.1.1.cmml">(</mo><mrow id="S2.p1.11.m11.2.2.1.1.1" xref="S2.p1.11.m11.2.2.1.1.1.cmml"><mi id="S2.p1.11.m11.2.2.1.1.1.2" xref="S2.p1.11.m11.2.2.1.1.1.2.cmml">Y</mi><mo id="S2.p1.11.m11.2.2.1.1.1.1" xref="S2.p1.11.m11.2.2.1.1.1.1.cmml">∣</mo><mrow id="S2.p1.11.m11.2.2.1.1.1.3" xref="S2.p1.11.m11.2.2.1.1.1.3.cmml"><mi id="S2.p1.11.m11.2.2.1.1.1.3.2" xref="S2.p1.11.m11.2.2.1.1.1.3.2.cmml">d</mi><mo id="S2.p1.11.m11.2.2.1.1.1.3.1" xref="S2.p1.11.m11.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.p1.11.m11.2.2.1.1.1.3.3" xref="S2.p1.11.m11.2.2.1.1.1.3.3.cmml">o</mi><mo id="S2.p1.11.m11.2.2.1.1.1.3.1a" xref="S2.p1.11.m11.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.p1.11.m11.2.2.1.1.1.3.4.2" xref="S2.p1.11.m11.2.2.1.1.1.3.cmml"><mo id="S2.p1.11.m11.2.2.1.1.1.3.4.2.1" stretchy="false" xref="S2.p1.11.m11.2.2.1.1.1.3.cmml">(</mo><mi id="S2.p1.11.m11.1.1" xref="S2.p1.11.m11.1.1.cmml">X</mi><mo id="S2.p1.11.m11.2.2.1.1.1.3.4.2.2" stretchy="false" xref="S2.p1.11.m11.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p1.11.m11.2.2.1.1.3" stretchy="false" xref="S2.p1.11.m11.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.11.m11.2b"><apply id="S2.p1.11.m11.2.2.cmml" xref="S2.p1.11.m11.2.2"><times id="S2.p1.11.m11.2.2.2.cmml" xref="S2.p1.11.m11.2.2.2"></times><ci id="S2.p1.11.m11.2.2.3.cmml" xref="S2.p1.11.m11.2.2.3">𝑃</ci><apply id="S2.p1.11.m11.2.2.1.1.1.cmml" xref="S2.p1.11.m11.2.2.1.1"><csymbol cd="latexml" id="S2.p1.11.m11.2.2.1.1.1.1.cmml" xref="S2.p1.11.m11.2.2.1.1.1.1">conditional</csymbol><ci id="S2.p1.11.m11.2.2.1.1.1.2.cmml" xref="S2.p1.11.m11.2.2.1.1.1.2">𝑌</ci><apply id="S2.p1.11.m11.2.2.1.1.1.3.cmml" xref="S2.p1.11.m11.2.2.1.1.1.3"><times id="S2.p1.11.m11.2.2.1.1.1.3.1.cmml" xref="S2.p1.11.m11.2.2.1.1.1.3.1"></times><ci id="S2.p1.11.m11.2.2.1.1.1.3.2.cmml" xref="S2.p1.11.m11.2.2.1.1.1.3.2">𝑑</ci><ci id="S2.p1.11.m11.2.2.1.1.1.3.3.cmml" xref="S2.p1.11.m11.2.2.1.1.1.3.3">𝑜</ci><ci id="S2.p1.11.m11.1.1.cmml" xref="S2.p1.11.m11.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m11.2c">P(Y\mid do(X))</annotation><annotation encoding="application/x-llamapun" id="S2.p1.11.m11.2d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_X ) )</annotation></semantics></math> instead of <math alttext="P(Y\mid X)" class="ltx_Math" display="inline" id="S2.p1.12.m12.1"><semantics id="S2.p1.12.m12.1a"><mrow id="S2.p1.12.m12.1.1" xref="S2.p1.12.m12.1.1.cmml"><mi id="S2.p1.12.m12.1.1.3" xref="S2.p1.12.m12.1.1.3.cmml">P</mi><mo id="S2.p1.12.m12.1.1.2" xref="S2.p1.12.m12.1.1.2.cmml">⁢</mo><mrow id="S2.p1.12.m12.1.1.1.1" xref="S2.p1.12.m12.1.1.1.1.1.cmml"><mo id="S2.p1.12.m12.1.1.1.1.2" stretchy="false" xref="S2.p1.12.m12.1.1.1.1.1.cmml">(</mo><mrow id="S2.p1.12.m12.1.1.1.1.1" xref="S2.p1.12.m12.1.1.1.1.1.cmml"><mi id="S2.p1.12.m12.1.1.1.1.1.2" xref="S2.p1.12.m12.1.1.1.1.1.2.cmml">Y</mi><mo id="S2.p1.12.m12.1.1.1.1.1.1" xref="S2.p1.12.m12.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.p1.12.m12.1.1.1.1.1.3" xref="S2.p1.12.m12.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S2.p1.12.m12.1.1.1.1.3" stretchy="false" xref="S2.p1.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.12.m12.1b"><apply id="S2.p1.12.m12.1.1.cmml" xref="S2.p1.12.m12.1.1"><times id="S2.p1.12.m12.1.1.2.cmml" xref="S2.p1.12.m12.1.1.2"></times><ci id="S2.p1.12.m12.1.1.3.cmml" xref="S2.p1.12.m12.1.1.3">𝑃</ci><apply id="S2.p1.12.m12.1.1.1.1.1.cmml" xref="S2.p1.12.m12.1.1.1.1"><csymbol cd="latexml" id="S2.p1.12.m12.1.1.1.1.1.1.cmml" xref="S2.p1.12.m12.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p1.12.m12.1.1.1.1.1.2.cmml" xref="S2.p1.12.m12.1.1.1.1.1.2">𝑌</ci><ci id="S2.p1.12.m12.1.1.1.1.1.3.cmml" xref="S2.p1.12.m12.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m12.1c">P(Y\mid X)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.12.m12.1d">italic_P ( italic_Y ∣ italic_X )</annotation></semantics></math>. There are mainly two deconfounding techniques that estimate <math alttext="P(Y\mid do(X))" class="ltx_Math" display="inline" id="S2.p1.13.m13.2"><semantics id="S2.p1.13.m13.2a"><mrow id="S2.p1.13.m13.2.2" xref="S2.p1.13.m13.2.2.cmml"><mi id="S2.p1.13.m13.2.2.3" xref="S2.p1.13.m13.2.2.3.cmml">P</mi><mo id="S2.p1.13.m13.2.2.2" xref="S2.p1.13.m13.2.2.2.cmml">⁢</mo><mrow id="S2.p1.13.m13.2.2.1.1" xref="S2.p1.13.m13.2.2.1.1.1.cmml"><mo id="S2.p1.13.m13.2.2.1.1.2" stretchy="false" xref="S2.p1.13.m13.2.2.1.1.1.cmml">(</mo><mrow id="S2.p1.13.m13.2.2.1.1.1" xref="S2.p1.13.m13.2.2.1.1.1.cmml"><mi id="S2.p1.13.m13.2.2.1.1.1.2" xref="S2.p1.13.m13.2.2.1.1.1.2.cmml">Y</mi><mo id="S2.p1.13.m13.2.2.1.1.1.1" xref="S2.p1.13.m13.2.2.1.1.1.1.cmml">∣</mo><mrow id="S2.p1.13.m13.2.2.1.1.1.3" xref="S2.p1.13.m13.2.2.1.1.1.3.cmml"><mi id="S2.p1.13.m13.2.2.1.1.1.3.2" xref="S2.p1.13.m13.2.2.1.1.1.3.2.cmml">d</mi><mo id="S2.p1.13.m13.2.2.1.1.1.3.1" xref="S2.p1.13.m13.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.p1.13.m13.2.2.1.1.1.3.3" xref="S2.p1.13.m13.2.2.1.1.1.3.3.cmml">o</mi><mo id="S2.p1.13.m13.2.2.1.1.1.3.1a" xref="S2.p1.13.m13.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.p1.13.m13.2.2.1.1.1.3.4.2" xref="S2.p1.13.m13.2.2.1.1.1.3.cmml"><mo id="S2.p1.13.m13.2.2.1.1.1.3.4.2.1" stretchy="false" xref="S2.p1.13.m13.2.2.1.1.1.3.cmml">(</mo><mi id="S2.p1.13.m13.1.1" xref="S2.p1.13.m13.1.1.cmml">X</mi><mo id="S2.p1.13.m13.2.2.1.1.1.3.4.2.2" stretchy="false" xref="S2.p1.13.m13.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p1.13.m13.2.2.1.1.3" stretchy="false" xref="S2.p1.13.m13.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.13.m13.2b"><apply id="S2.p1.13.m13.2.2.cmml" xref="S2.p1.13.m13.2.2"><times id="S2.p1.13.m13.2.2.2.cmml" xref="S2.p1.13.m13.2.2.2"></times><ci id="S2.p1.13.m13.2.2.3.cmml" xref="S2.p1.13.m13.2.2.3">𝑃</ci><apply id="S2.p1.13.m13.2.2.1.1.1.cmml" xref="S2.p1.13.m13.2.2.1.1"><csymbol cd="latexml" id="S2.p1.13.m13.2.2.1.1.1.1.cmml" xref="S2.p1.13.m13.2.2.1.1.1.1">conditional</csymbol><ci id="S2.p1.13.m13.2.2.1.1.1.2.cmml" xref="S2.p1.13.m13.2.2.1.1.1.2">𝑌</ci><apply id="S2.p1.13.m13.2.2.1.1.1.3.cmml" xref="S2.p1.13.m13.2.2.1.1.1.3"><times id="S2.p1.13.m13.2.2.1.1.1.3.1.cmml" xref="S2.p1.13.m13.2.2.1.1.1.3.1"></times><ci id="S2.p1.13.m13.2.2.1.1.1.3.2.cmml" xref="S2.p1.13.m13.2.2.1.1.1.3.2">𝑑</ci><ci id="S2.p1.13.m13.2.2.1.1.1.3.3.cmml" xref="S2.p1.13.m13.2.2.1.1.1.3.3">𝑜</ci><ci id="S2.p1.13.m13.1.1.cmml" xref="S2.p1.13.m13.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.13.m13.2c">P(Y\mid do(X))</annotation><annotation encoding="application/x-llamapun" id="S2.p1.13.m13.2d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_X ) )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib10" title="">10</a>]</cite> from observed data, <span class="ltx_text ltx_font_italic" id="S2.p1.13.1">i</span>.<span class="ltx_text ltx_font_italic" id="S2.p1.13.2">e</span>., back-door adjustment, and front-door adjustment. In this section, we review the main idea of these techniques:</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span><span class="ltx_text ltx_font_italic" id="S2.SS1.1.1">Back-door Adjustment</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.3">Back-door adjustment can handle <span class="ltx_text ltx_framed ltx_framed_underline" id="S2.SS1.p1.3.1">observed</span> confounders <math alttext="Z" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_Z</annotation></semantics></math>. Note that <math alttext="U" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">U</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_U</annotation></semantics></math> represents all confounders. Under Bayes Rule, the posterior <math alttext="P(Y|X)" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">P</mi><mo id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.3.m3.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S2.SS1.p1.3.m3.1.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S2.SS1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><times id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2"></times><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑃</ci><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2">𝑌</ci><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">P(Y|X)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_P ( italic_Y | italic_X )</annotation></semantics></math> can be written as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle P(Y\mid X)=\sum_{z}P(Y\mid X,Z=z)\underline{P(Z=z\mid X)}." class="ltx_Math" display="inline" id="S2.E1.m1.4"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3" mathcolor="#000000" xref="S2.E1.m1.4.4.1.1.1.3.cmml">P</mi><mo id="S2.E1.m1.4.4.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml">Y</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S2.E1.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.1.1.3" xref="S2.E1.m1.4.4.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.4.4.1.1.2" xref="S2.E1.m1.4.4.1.1.2.cmml"><mstyle displaystyle="true" id="S2.E1.m1.4.4.1.1.2.2" xref="S2.E1.m1.4.4.1.1.2.2.cmml"><munder id="S2.E1.m1.4.4.1.1.2.2a" xref="S2.E1.m1.4.4.1.1.2.2.cmml"><mo id="S2.E1.m1.4.4.1.1.2.2.2" movablelimits="false" xref="S2.E1.m1.4.4.1.1.2.2.2.cmml">∑</mo><mi id="S2.E1.m1.4.4.1.1.2.2.3" xref="S2.E1.m1.4.4.1.1.2.2.3.cmml">z</mi></munder></mstyle><mrow id="S2.E1.m1.4.4.1.1.2.1" xref="S2.E1.m1.4.4.1.1.2.1.cmml"><mi id="S2.E1.m1.4.4.1.1.2.1.3" mathcolor="#000000" xref="S2.E1.m1.4.4.1.1.2.1.3.cmml">P</mi><mo id="S2.E1.m1.4.4.1.1.2.1.2" xref="S2.E1.m1.4.4.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.2.1.1.1" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.cmml"><mo id="S2.E1.m1.4.4.1.1.2.1.1.1.2" stretchy="false" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.2.1.1.1.1" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.cmml"><mi id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.2" mathcolor="#000000" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.2.cmml">Y</mi><mo id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.1" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.1.cmml">∣</mo><mrow id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.3.2" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.3.1.cmml"><mi id="S2.E1.m1.2.2" mathcolor="#000000" xref="S2.E1.m1.2.2.cmml">X</mi><mo id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.3.2.1" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E1.m1.3.3" mathcolor="#000000" xref="S2.E1.m1.3.3.cmml">Z</mi></mrow></mrow><mo id="S2.E1.m1.4.4.1.1.2.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.1.cmml">=</mo><mi id="S2.E1.m1.4.4.1.1.2.1.1.1.1.3" mathcolor="#000000" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.3.cmml">z</mi></mrow><mo id="S2.E1.m1.4.4.1.1.2.1.1.1.3" stretchy="false" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.4.4.1.1.2.1.2a" xref="S2.E1.m1.4.4.1.1.2.1.2.cmml">⁢</mo><munder accentunder="true" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.3" mathcolor="#000000" xref="S2.E1.m1.1.1.1.3.cmml">P</mi><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">Z</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2" mathcolor="#000000" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml">z</mi><mo id="S2.E1.m1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.1.cmml">∣</mo><mi id="S2.E1.m1.1.1.1.1.1.1.3.3" mathcolor="#000000" xref="S2.E1.m1.1.1.1.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S2.E1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">¯</mo></munder></mrow></mrow></mrow><mo id="S2.E1.m1.4.4.1.2" lspace="0em" xref="S2.E1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1"><eq id="S2.E1.m1.4.4.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.3"></eq><apply id="S2.E1.m1.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2"></times><ci id="S2.E1.m1.4.4.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3">𝑃</ci><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2">𝑌</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3">𝑋</ci></apply></apply><apply id="S2.E1.m1.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2"><apply id="S2.E1.m1.4.4.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.2.2">subscript</csymbol><sum id="S2.E1.m1.4.4.1.1.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2"></sum><ci id="S2.E1.m1.4.4.1.1.2.2.3.cmml" xref="S2.E1.m1.4.4.1.1.2.2.3">𝑧</ci></apply><apply id="S2.E1.m1.4.4.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.2.1"><times id="S2.E1.m1.4.4.1.1.2.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2.1.2"></times><ci id="S2.E1.m1.4.4.1.1.2.1.3.cmml" xref="S2.E1.m1.4.4.1.1.2.1.3">𝑃</ci><apply id="S2.E1.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.2.1.1.1"><eq id="S2.E1.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.1"></eq><apply id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2"><csymbol cd="latexml" id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.1">conditional</csymbol><ci id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.2">𝑌</ci><list id="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.2.3.2"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑋</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑍</ci></list></apply><ci id="S2.E1.m1.4.4.1.1.2.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.2.1.1.1.1.3">𝑧</ci></apply><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><ci id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2">¯</ci><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><times id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></times><ci id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3">𝑃</ci><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"></eq><ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">𝑍</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3">𝑋</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\displaystyle P(Y\mid X)=\sum_{z}P(Y\mid X,Z=z)\underline{P(Z=z\mid X)}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.4d">italic_P ( italic_Y ∣ italic_X ) = ∑ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT italic_P ( italic_Y ∣ italic_X , italic_Z = italic_z ) under¯ start_ARG italic_P ( italic_Z = italic_z ∣ italic_X ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.15">In this modeling, there is a back-door path between <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m1.1"><semantics id="S2.SS1.p1.4.m1.1a"><mi id="S2.SS1.p1.4.m1.1.1" xref="S2.SS1.p1.4.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m1.1b"><ci id="S2.SS1.p1.4.m1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m1.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m2.1"><semantics id="S2.SS1.p1.5.m2.1a"><mi id="S2.SS1.p1.5.m2.1.1" xref="S2.SS1.p1.5.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m2.1b"><ci id="S2.SS1.p1.5.m2.1.1.cmml" xref="S2.SS1.p1.5.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m2.1d">italic_Y</annotation></semantics></math>, which refers to the indirect path from <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m3.1"><semantics id="S2.SS1.p1.6.m3.1a"><mi id="S2.SS1.p1.6.m3.1.1" xref="S2.SS1.p1.6.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m3.1b"><ci id="S2.SS1.p1.6.m3.1.1.cmml" xref="S2.SS1.p1.6.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m3.1d">italic_X</annotation></semantics></math> to <math alttext="Y" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m4.1"><semantics id="S2.SS1.p1.7.m4.1a"><mi id="S2.SS1.p1.7.m4.1.1" xref="S2.SS1.p1.7.m4.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m4.1b"><ci id="S2.SS1.p1.7.m4.1.1.cmml" xref="S2.SS1.p1.7.m4.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m4.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m4.1d">italic_Y</annotation></semantics></math> that contains an arrow to <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m5.1"><semantics id="S2.SS1.p1.8.m5.1a"><mi id="S2.SS1.p1.8.m5.1.1" xref="S2.SS1.p1.8.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m5.1b"><ci id="S2.SS1.p1.8.m5.1.1.cmml" xref="S2.SS1.p1.8.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m5.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m5.1d">italic_X</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.15.1">i</span>.<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.15.2">e</span>., <math alttext="X\leftarrow Z\rightarrow Y" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m6.1"><semantics id="S2.SS1.p1.9.m6.1a"><mrow id="S2.SS1.p1.9.m6.1.1" xref="S2.SS1.p1.9.m6.1.1.cmml"><mi id="S2.SS1.p1.9.m6.1.1.2" xref="S2.SS1.p1.9.m6.1.1.2.cmml">X</mi><mo id="S2.SS1.p1.9.m6.1.1.3" stretchy="false" xref="S2.SS1.p1.9.m6.1.1.3.cmml">←</mo><mi id="S2.SS1.p1.9.m6.1.1.4" xref="S2.SS1.p1.9.m6.1.1.4.cmml">Z</mi><mo id="S2.SS1.p1.9.m6.1.1.5" stretchy="false" xref="S2.SS1.p1.9.m6.1.1.5.cmml">→</mo><mi id="S2.SS1.p1.9.m6.1.1.6" xref="S2.SS1.p1.9.m6.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m6.1b"><apply id="S2.SS1.p1.9.m6.1.1.cmml" xref="S2.SS1.p1.9.m6.1.1"><and id="S2.SS1.p1.9.m6.1.1a.cmml" xref="S2.SS1.p1.9.m6.1.1"></and><apply id="S2.SS1.p1.9.m6.1.1b.cmml" xref="S2.SS1.p1.9.m6.1.1"><ci id="S2.SS1.p1.9.m6.1.1.3.cmml" xref="S2.SS1.p1.9.m6.1.1.3">←</ci><ci id="S2.SS1.p1.9.m6.1.1.2.cmml" xref="S2.SS1.p1.9.m6.1.1.2">𝑋</ci><ci id="S2.SS1.p1.9.m6.1.1.4.cmml" xref="S2.SS1.p1.9.m6.1.1.4">𝑍</ci></apply><apply id="S2.SS1.p1.9.m6.1.1c.cmml" xref="S2.SS1.p1.9.m6.1.1"><ci id="S2.SS1.p1.9.m6.1.1.5.cmml" xref="S2.SS1.p1.9.m6.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S2.SS1.p1.9.m6.1.1.4.cmml" id="S2.SS1.p1.9.m6.1.1d.cmml" xref="S2.SS1.p1.9.m6.1.1"></share><ci id="S2.SS1.p1.9.m6.1.1.6.cmml" xref="S2.SS1.p1.9.m6.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m6.1c">X\leftarrow Z\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m6.1d">italic_X ← italic_Z → italic_Y</annotation></semantics></math>. To block the back-door path, back-door adjustment adjusts the parent variables of <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m7.1"><semantics id="S2.SS1.p1.10.m7.1a"><mi id="S2.SS1.p1.10.m7.1.1" xref="S2.SS1.p1.10.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m7.1b"><ci id="S2.SS1.p1.10.m7.1.1.cmml" xref="S2.SS1.p1.10.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m7.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m7.1d">italic_X</annotation></semantics></math> to make these variables independent of <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m8.1"><semantics id="S2.SS1.p1.11.m8.1a"><mi id="S2.SS1.p1.11.m8.1.1" xref="S2.SS1.p1.11.m8.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m8.1b"><ci id="S2.SS1.p1.11.m8.1.1.cmml" xref="S2.SS1.p1.11.m8.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m8.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m8.1d">italic_X</annotation></semantics></math> with the <math alttext="do" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m9.1"><semantics id="S2.SS1.p1.12.m9.1a"><mrow id="S2.SS1.p1.12.m9.1.1" xref="S2.SS1.p1.12.m9.1.1.cmml"><mi id="S2.SS1.p1.12.m9.1.1.2" xref="S2.SS1.p1.12.m9.1.1.2.cmml">d</mi><mo id="S2.SS1.p1.12.m9.1.1.1" xref="S2.SS1.p1.12.m9.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p1.12.m9.1.1.3" xref="S2.SS1.p1.12.m9.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m9.1b"><apply id="S2.SS1.p1.12.m9.1.1.cmml" xref="S2.SS1.p1.12.m9.1.1"><times id="S2.SS1.p1.12.m9.1.1.1.cmml" xref="S2.SS1.p1.12.m9.1.1.1"></times><ci id="S2.SS1.p1.12.m9.1.1.2.cmml" xref="S2.SS1.p1.12.m9.1.1.2">𝑑</ci><ci id="S2.SS1.p1.12.m9.1.1.3.cmml" xref="S2.SS1.p1.12.m9.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m9.1c">do</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m9.1d">italic_d italic_o</annotation></semantics></math>-operator. As such, <math alttext="X\leftarrow Z" class="ltx_Math" display="inline" id="S2.SS1.p1.13.m10.1"><semantics id="S2.SS1.p1.13.m10.1a"><mrow id="S2.SS1.p1.13.m10.1.1" xref="S2.SS1.p1.13.m10.1.1.cmml"><mi id="S2.SS1.p1.13.m10.1.1.2" xref="S2.SS1.p1.13.m10.1.1.2.cmml">X</mi><mo id="S2.SS1.p1.13.m10.1.1.1" stretchy="false" xref="S2.SS1.p1.13.m10.1.1.1.cmml">←</mo><mi id="S2.SS1.p1.13.m10.1.1.3" xref="S2.SS1.p1.13.m10.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m10.1b"><apply id="S2.SS1.p1.13.m10.1.1.cmml" xref="S2.SS1.p1.13.m10.1.1"><ci id="S2.SS1.p1.13.m10.1.1.1.cmml" xref="S2.SS1.p1.13.m10.1.1.1">←</ci><ci id="S2.SS1.p1.13.m10.1.1.2.cmml" xref="S2.SS1.p1.13.m10.1.1.2">𝑋</ci><ci id="S2.SS1.p1.13.m10.1.1.3.cmml" xref="S2.SS1.p1.13.m10.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m10.1c">X\leftarrow Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.13.m10.1d">italic_X ← italic_Z</annotation></semantics></math> is cut due to the independence, <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.15.3">i</span>.<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.15.4">e</span>., forcibly assigning a target value to <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.14.m11.1"><semantics id="S2.SS1.p1.14.m11.1a"><mi id="S2.SS1.p1.14.m11.1.1" xref="S2.SS1.p1.14.m11.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m11.1b"><ci id="S2.SS1.p1.14.m11.1.1.cmml" xref="S2.SS1.p1.14.m11.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m11.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.14.m11.1d">italic_X</annotation></semantics></math> regardless of its parent <math alttext="Z" class="ltx_Math" display="inline" id="S2.SS1.p1.15.m12.1"><semantics id="S2.SS1.p1.15.m12.1a"><mi id="S2.SS1.p1.15.m12.1.1" xref="S2.SS1.p1.15.m12.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m12.1b"><ci id="S2.SS1.p1.15.m12.1.1.cmml" xref="S2.SS1.p1.15.m12.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m12.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.15.m12.1d">italic_Z</annotation></semantics></math>. Formally,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E2X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle P(Y\mid do(X))" class="ltx_Math" display="inline" id="S2.E2X.2.1.1.m1.2"><semantics id="S2.E2X.2.1.1.m1.2a"><mrow id="S2.E2X.2.1.1.m1.2.2" xref="S2.E2X.2.1.1.m1.2.2.cmml"><mi id="S2.E2X.2.1.1.m1.2.2.3" mathcolor="#000000" xref="S2.E2X.2.1.1.m1.2.2.3.cmml">P</mi><mo id="S2.E2X.2.1.1.m1.2.2.2" xref="S2.E2X.2.1.1.m1.2.2.2.cmml">⁢</mo><mrow id="S2.E2X.2.1.1.m1.2.2.1.1" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.cmml"><mo id="S2.E2X.2.1.1.m1.2.2.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E2X.2.1.1.m1.2.2.1.1.1" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.cmml"><mi id="S2.E2X.2.1.1.m1.2.2.1.1.1.2" mathcolor="#000000" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.2.cmml">Y</mi><mo id="S2.E2X.2.1.1.m1.2.2.1.1.1.1" mathcolor="#000000" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.1.cmml">∣</mo><mrow id="S2.E2X.2.1.1.m1.2.2.1.1.1.3" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.cmml"><mi id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.2" mathcolor="#000000" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.2.cmml">d</mi><mo id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.1" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.3" mathcolor="#000000" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.3.cmml">o</mi><mo id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.1a" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.4.2" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.cmml"><mo id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.4.2.1" mathcolor="#000000" stretchy="false" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.cmml">(</mo><mi id="S2.E2X.2.1.1.m1.1.1" mathcolor="#000000" xref="S2.E2X.2.1.1.m1.1.1.cmml">X</mi><mo id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.4.2.2" mathcolor="#000000" stretchy="false" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2X.2.1.1.m1.2.2.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.2.1.1.m1.2b"><apply id="S2.E2X.2.1.1.m1.2.2.cmml" xref="S2.E2X.2.1.1.m1.2.2"><times id="S2.E2X.2.1.1.m1.2.2.2.cmml" xref="S2.E2X.2.1.1.m1.2.2.2"></times><ci id="S2.E2X.2.1.1.m1.2.2.3.cmml" xref="S2.E2X.2.1.1.m1.2.2.3">𝑃</ci><apply id="S2.E2X.2.1.1.m1.2.2.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.2.2.1.1"><csymbol cd="latexml" id="S2.E2X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.1">conditional</csymbol><ci id="S2.E2X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.2">𝑌</ci><apply id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3"><times id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.1.cmml" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.1"></times><ci id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.2.cmml" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.2">𝑑</ci><ci id="S2.E2X.2.1.1.m1.2.2.1.1.1.3.3.cmml" xref="S2.E2X.2.1.1.m1.2.2.1.1.1.3.3">𝑜</ci><ci id="S2.E2X.2.1.1.m1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.2.1.1.m1.2c">\displaystyle P(Y\mid do(X))</annotation><annotation encoding="application/x-llamapun" id="S2.E2X.2.1.1.m1.2d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_X ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{z}P(Y\mid do(X,Z=z))P(Z=z\mid do(X))," class="ltx_Math" display="inline" id="S2.E2X.3.2.2.m1.4"><semantics id="S2.E2X.3.2.2.m1.4a"><mrow id="S2.E2X.3.2.2.m1.4.4.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S2.E2X.3.2.2.m1.4.4.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.4" xref="S2.E2X.3.2.2.m1.4.4.1.1.4.cmml"></mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.3.cmml">=</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.cmml"><mstyle displaystyle="true" id="S2.E2X.3.2.2.m1.4.4.1.1.2.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.cmml"><munder id="S2.E2X.3.2.2.m1.4.4.1.1.2.3a" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.cmml"><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2" movablelimits="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2.cmml">∑</mo><mi id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.3.cmml">z</mi></munder></mstyle><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.4" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.4.cmml">P</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.3.cmml">Y</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">d</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.4" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.4.cmml">o</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2a" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml"><mi id="S2.E2X.3.2.2.m1.1.1" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.1.1.cmml">X</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">,</mo><mi id="S2.E2X.3.2.2.m1.2.2" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.2.2.cmml">Z</mi></mrow><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.3a" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.3.cmml">⁢</mo><mi id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.5" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.5.cmml">P</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.3b" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.cmml"><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.2" stretchy="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.2" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.2.cmml">Z</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.1.cmml">=</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.2" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.2.cmml">z</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.1.cmml">∣</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.cmml"><mi id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.2" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.2.cmml">d</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.1" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.3" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.3.cmml">o</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.1a" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.1.cmml">⁢</mo><mrow id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.4.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.cmml"><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.4.2.1" stretchy="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.cmml">(</mo><mi id="S2.E2X.3.2.2.m1.3.3" mathcolor="#000000" xref="S2.E2X.3.2.2.m1.3.3.cmml">X</mi><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.4.2.2" stretchy="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.3" stretchy="false" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2X.3.2.2.m1.4.4.1.2" xref="S2.E2X.3.2.2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.3.2.2.m1.4b"><apply id="S2.E2X.3.2.2.m1.4.4.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1"><eq id="S2.E2X.3.2.2.m1.4.4.1.1.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.3"></eq><csymbol cd="latexml" id="S2.E2X.3.2.2.m1.4.4.1.1.4.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.4">absent</csymbol><apply id="S2.E2X.3.2.2.m1.4.4.1.1.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2"><apply id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3">subscript</csymbol><sum id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.2"></sum><ci id="S2.E2X.3.2.2.m1.4.4.1.1.2.3.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.3.3">𝑧</ci></apply><apply id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2"><times id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.3"></times><ci id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.4.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.4">𝑃</ci><apply id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.3">𝑌</ci><apply id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1"><times id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3">𝑑</ci><ci id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.4">𝑜</ci><apply id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1"><eq id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></eq><list id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S2.E2X.3.2.2.m1.1.1.cmml" xref="S2.E2X.3.2.2.m1.1.1">𝑋</ci><ci id="S2.E2X.3.2.2.m1.2.2.cmml" xref="S2.E2X.3.2.2.m1.2.2">𝑍</ci></list><ci id="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply><ci id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.5.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.5">𝑃</ci><apply id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1"><eq id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.1"></eq><ci id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.2">𝑍</ci><apply id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3"><csymbol cd="latexml" id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.1">conditional</csymbol><ci id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.2">𝑧</ci><apply id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3"><times id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.1.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.1"></times><ci id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.2.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.2">𝑑</ci><ci id="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.3.cmml" xref="S2.E2X.3.2.2.m1.4.4.1.1.2.2.2.1.1.3.3.3">𝑜</ci><ci id="S2.E2X.3.2.2.m1.3.3.cmml" xref="S2.E2X.3.2.2.m1.3.3">𝑋</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.3.2.2.m1.4c">\displaystyle=\sum_{z}P(Y\mid do(X,Z=z))P(Z=z\mid do(X)),</annotation><annotation encoding="application/x-llamapun" id="S2.E2X.3.2.2.m1.4d">= ∑ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT italic_P ( italic_Y ∣ italic_d italic_o ( italic_X , italic_Z = italic_z ) ) italic_P ( italic_Z = italic_z ∣ italic_d italic_o ( italic_X ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E2Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{z}P(Y\mid X,Z=z)\underline{P(Z=z)}." class="ltx_Math" display="inline" id="S2.E2Xa.2.1.1.m1.4"><semantics id="S2.E2Xa.2.1.1.m1.4a"><mrow id="S2.E2Xa.2.1.1.m1.4.4.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.cmml"><mrow id="S2.E2Xa.2.1.1.m1.4.4.1.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.4.4.1.1.3" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.3.cmml"></mi><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.2" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.E2Xa.2.1.1.m1.4.4.1.1.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.cmml"><munder id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2a" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.cmml"><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.2" movablelimits="false" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.2.cmml">∑</mo><mi id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.3" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.3.cmml">z</mi></munder></mstyle><mrow id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.3" mathcolor="#000000" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.3.cmml">P</mi><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.2" mathcolor="#000000" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">∣</mo><mrow id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2" mathcolor="#000000" xref="S2.E2Xa.2.1.1.m1.2.2.cmml">X</mi><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.3.2.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E2Xa.2.1.1.m1.3.3" mathcolor="#000000" xref="S2.E2Xa.2.1.1.m1.3.3.cmml">Z</mi></mrow></mrow><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.2a" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml">⁢</mo><munder accentunder="true" id="S2.E2Xa.2.1.1.m1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.cmml"><mrow id="S2.E2Xa.2.1.1.m1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.1.1.1.3" mathcolor="#000000" xref="S2.E2Xa.2.1.1.m1.1.1.1.3.cmml">P</mi><mo id="S2.E2Xa.2.1.1.m1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2Xa.2.1.1.m1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml">Z</mi><mo id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2Xa.2.1.1.m1.1.1.2" xref="S2.E2Xa.2.1.1.m1.1.1.2.cmml">¯</mo></munder></mrow></mrow></mrow><mo id="S2.E2Xa.2.1.1.m1.4.4.1.2" lspace="0em" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xa.2.1.1.m1.4b"><apply id="S2.E2Xa.2.1.1.m1.4.4.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1"><eq id="S2.E2Xa.2.1.1.m1.4.4.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.2"></eq><csymbol cd="latexml" id="S2.E2Xa.2.1.1.m1.4.4.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.3">absent</csymbol><apply id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1"><apply id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2">subscript</csymbol><sum id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.2"></sum><ci id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.3.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.2.3">𝑧</ci></apply><apply id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1"><times id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.2"></times><ci id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.3">𝑃</ci><apply id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1"><eq id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"></eq><apply id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.2">𝑌</ci><list id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2.3.2"><ci id="S2.E2Xa.2.1.1.m1.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2">𝑋</ci><ci id="S2.E2Xa.2.1.1.m1.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.3.3">𝑍</ci></list></apply><ci id="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.E2Xa.2.1.1.m1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1"><ci id="S2.E2Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.2">¯</ci><apply id="S2.E2Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1"><times id="S2.E2Xa.2.1.1.m1.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.2"></times><ci id="S2.E2Xa.2.1.1.m1.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.3">𝑃</ci><apply id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1"><eq id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.1"></eq><ci id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.2">𝑍</ci><ci id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xa.2.1.1.m1.4c">\displaystyle=\sum_{z}P(Y\mid X,Z=z)\underline{P(Z=z)}.</annotation><annotation encoding="application/x-llamapun" id="S2.E2Xa.2.1.1.m1.4d">= ∑ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT italic_P ( italic_Y ∣ italic_X , italic_Z = italic_z ) under¯ start_ARG italic_P ( italic_Z = italic_z ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.33">The conditional probability <math alttext="P(Y\mid X,Z=z)" class="ltx_Math" display="inline" id="S2.SS1.p1.16.m1.3"><semantics id="S2.SS1.p1.16.m1.3a"><mrow id="S2.SS1.p1.16.m1.3.3" xref="S2.SS1.p1.16.m1.3.3.cmml"><mi id="S2.SS1.p1.16.m1.3.3.3" xref="S2.SS1.p1.16.m1.3.3.3.cmml">P</mi><mo id="S2.SS1.p1.16.m1.3.3.2" xref="S2.SS1.p1.16.m1.3.3.2.cmml">⁢</mo><mrow id="S2.SS1.p1.16.m1.3.3.1.1" xref="S2.SS1.p1.16.m1.3.3.1.1.1.cmml"><mo id="S2.SS1.p1.16.m1.3.3.1.1.2" stretchy="false" xref="S2.SS1.p1.16.m1.3.3.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.16.m1.3.3.1.1.1" xref="S2.SS1.p1.16.m1.3.3.1.1.1.cmml"><mrow id="S2.SS1.p1.16.m1.3.3.1.1.1.2" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2.cmml"><mi id="S2.SS1.p1.16.m1.3.3.1.1.1.2.2" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2.2.cmml">Y</mi><mo id="S2.SS1.p1.16.m1.3.3.1.1.1.2.1" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2.1.cmml">∣</mo><mrow id="S2.SS1.p1.16.m1.3.3.1.1.1.2.3.2" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2.3.1.cmml"><mi id="S2.SS1.p1.16.m1.1.1" xref="S2.SS1.p1.16.m1.1.1.cmml">X</mi><mo id="S2.SS1.p1.16.m1.3.3.1.1.1.2.3.2.1" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2.3.1.cmml">,</mo><mi id="S2.SS1.p1.16.m1.2.2" xref="S2.SS1.p1.16.m1.2.2.cmml">Z</mi></mrow></mrow><mo id="S2.SS1.p1.16.m1.3.3.1.1.1.1" xref="S2.SS1.p1.16.m1.3.3.1.1.1.1.cmml">=</mo><mi id="S2.SS1.p1.16.m1.3.3.1.1.1.3" xref="S2.SS1.p1.16.m1.3.3.1.1.1.3.cmml">z</mi></mrow><mo id="S2.SS1.p1.16.m1.3.3.1.1.3" stretchy="false" xref="S2.SS1.p1.16.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m1.3b"><apply id="S2.SS1.p1.16.m1.3.3.cmml" xref="S2.SS1.p1.16.m1.3.3"><times id="S2.SS1.p1.16.m1.3.3.2.cmml" xref="S2.SS1.p1.16.m1.3.3.2"></times><ci id="S2.SS1.p1.16.m1.3.3.3.cmml" xref="S2.SS1.p1.16.m1.3.3.3">𝑃</ci><apply id="S2.SS1.p1.16.m1.3.3.1.1.1.cmml" xref="S2.SS1.p1.16.m1.3.3.1.1"><eq id="S2.SS1.p1.16.m1.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.16.m1.3.3.1.1.1.1"></eq><apply id="S2.SS1.p1.16.m1.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2"><csymbol cd="latexml" id="S2.SS1.p1.16.m1.3.3.1.1.1.2.1.cmml" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2.1">conditional</csymbol><ci id="S2.SS1.p1.16.m1.3.3.1.1.1.2.2.cmml" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2.2">𝑌</ci><list id="S2.SS1.p1.16.m1.3.3.1.1.1.2.3.1.cmml" xref="S2.SS1.p1.16.m1.3.3.1.1.1.2.3.2"><ci id="S2.SS1.p1.16.m1.1.1.cmml" xref="S2.SS1.p1.16.m1.1.1">𝑋</ci><ci id="S2.SS1.p1.16.m1.2.2.cmml" xref="S2.SS1.p1.16.m1.2.2">𝑍</ci></list></apply><ci id="S2.SS1.p1.16.m1.3.3.1.1.1.3.cmml" xref="S2.SS1.p1.16.m1.3.3.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m1.3c">P(Y\mid X,Z=z)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.16.m1.3d">italic_P ( italic_Y ∣ italic_X , italic_Z = italic_z )</annotation></semantics></math> is invariant to adjustment since how <math alttext="Y" class="ltx_Math" display="inline" id="S2.SS1.p1.17.m2.1"><semantics id="S2.SS1.p1.17.m2.1a"><mi id="S2.SS1.p1.17.m2.1.1" xref="S2.SS1.p1.17.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m2.1b"><ci id="S2.SS1.p1.17.m2.1.1.cmml" xref="S2.SS1.p1.17.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.17.m2.1d">italic_Y</annotation></semantics></math> responds to <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.18.m3.1"><semantics id="S2.SS1.p1.18.m3.1a"><mi id="S2.SS1.p1.18.m3.1.1" xref="S2.SS1.p1.18.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m3.1b"><ci id="S2.SS1.p1.18.m3.1.1.cmml" xref="S2.SS1.p1.18.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.18.m3.1d">italic_X</annotation></semantics></math> and <math alttext="Z" class="ltx_Math" display="inline" id="S2.SS1.p1.19.m4.1"><semantics id="S2.SS1.p1.19.m4.1a"><mi id="S2.SS1.p1.19.m4.1.1" xref="S2.SS1.p1.19.m4.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.19.m4.1b"><ci id="S2.SS1.p1.19.m4.1.1.cmml" xref="S2.SS1.p1.19.m4.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.19.m4.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.19.m4.1d">italic_Z</annotation></semantics></math> is regardless of whether the change of <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.20.m5.1"><semantics id="S2.SS1.p1.20.m5.1a"><mi id="S2.SS1.p1.20.m5.1.1" xref="S2.SS1.p1.20.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.20.m5.1b"><ci id="S2.SS1.p1.20.m5.1.1.cmml" xref="S2.SS1.p1.20.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.20.m5.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.20.m5.1d">italic_X</annotation></semantics></math> is independent of <math alttext="Z" class="ltx_Math" display="inline" id="S2.SS1.p1.21.m6.1"><semantics id="S2.SS1.p1.21.m6.1a"><mi id="S2.SS1.p1.21.m6.1.1" xref="S2.SS1.p1.21.m6.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.21.m6.1b"><ci id="S2.SS1.p1.21.m6.1.1.cmml" xref="S2.SS1.p1.21.m6.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.21.m6.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.21.m6.1d">italic_Z</annotation></semantics></math>. As such, <math alttext="P(Y\mid do(X,Z=z))=P(Y\mid X,Z=z)" class="ltx_Math" display="inline" id="S2.SS1.p1.22.m7.6"><semantics id="S2.SS1.p1.22.m7.6a"><mrow id="S2.SS1.p1.22.m7.6.6" xref="S2.SS1.p1.22.m7.6.6.cmml"><mrow id="S2.SS1.p1.22.m7.5.5.1" xref="S2.SS1.p1.22.m7.5.5.1.cmml"><mi id="S2.SS1.p1.22.m7.5.5.1.3" xref="S2.SS1.p1.22.m7.5.5.1.3.cmml">P</mi><mo id="S2.SS1.p1.22.m7.5.5.1.2" xref="S2.SS1.p1.22.m7.5.5.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.22.m7.5.5.1.1.1" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.cmml"><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.2" stretchy="false" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.22.m7.5.5.1.1.1.1" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.cmml"><mi id="S2.SS1.p1.22.m7.5.5.1.1.1.1.3" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.3.cmml">Y</mi><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.1.2" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.2.cmml">∣</mo><mrow id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.3" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.3.cmml">d</mi><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.2" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.4" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.4.cmml">o</mi><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.2a" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.2.1.cmml"><mi id="S2.SS1.p1.22.m7.1.1" xref="S2.SS1.p1.22.m7.1.1.cmml">X</mi><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.2.2.1" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.2.1.cmml">,</mo><mi id="S2.SS1.p1.22.m7.2.2" xref="S2.SS1.p1.22.m7.2.2.cmml">Z</mi></mrow><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS1.p1.22.m7.5.5.1.1.1.3" stretchy="false" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.22.m7.6.6.3" xref="S2.SS1.p1.22.m7.6.6.3.cmml">=</mo><mrow id="S2.SS1.p1.22.m7.6.6.2" xref="S2.SS1.p1.22.m7.6.6.2.cmml"><mi id="S2.SS1.p1.22.m7.6.6.2.3" xref="S2.SS1.p1.22.m7.6.6.2.3.cmml">P</mi><mo id="S2.SS1.p1.22.m7.6.6.2.2" xref="S2.SS1.p1.22.m7.6.6.2.2.cmml">⁢</mo><mrow id="S2.SS1.p1.22.m7.6.6.2.1.1" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.cmml"><mo id="S2.SS1.p1.22.m7.6.6.2.1.1.2" stretchy="false" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.22.m7.6.6.2.1.1.1" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.cmml"><mrow id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.cmml"><mi id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.2" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.2.cmml">Y</mi><mo id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.1" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.1.cmml">∣</mo><mrow id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.3.2" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.3.1.cmml"><mi id="S2.SS1.p1.22.m7.3.3" xref="S2.SS1.p1.22.m7.3.3.cmml">X</mi><mo id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.3.2.1" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.3.1.cmml">,</mo><mi id="S2.SS1.p1.22.m7.4.4" xref="S2.SS1.p1.22.m7.4.4.cmml">Z</mi></mrow></mrow><mo id="S2.SS1.p1.22.m7.6.6.2.1.1.1.1" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.1.cmml">=</mo><mi id="S2.SS1.p1.22.m7.6.6.2.1.1.1.3" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.3.cmml">z</mi></mrow><mo id="S2.SS1.p1.22.m7.6.6.2.1.1.3" stretchy="false" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.22.m7.6b"><apply id="S2.SS1.p1.22.m7.6.6.cmml" xref="S2.SS1.p1.22.m7.6.6"><eq id="S2.SS1.p1.22.m7.6.6.3.cmml" xref="S2.SS1.p1.22.m7.6.6.3"></eq><apply id="S2.SS1.p1.22.m7.5.5.1.cmml" xref="S2.SS1.p1.22.m7.5.5.1"><times id="S2.SS1.p1.22.m7.5.5.1.2.cmml" xref="S2.SS1.p1.22.m7.5.5.1.2"></times><ci id="S2.SS1.p1.22.m7.5.5.1.3.cmml" xref="S2.SS1.p1.22.m7.5.5.1.3">𝑃</ci><apply id="S2.SS1.p1.22.m7.5.5.1.1.1.1.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.22.m7.5.5.1.1.1.1.2.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.2">conditional</csymbol><ci id="S2.SS1.p1.22.m7.5.5.1.1.1.1.3.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.3">𝑌</ci><apply id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1"><times id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.2"></times><ci id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.3">𝑑</ci><ci id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.4.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.4">𝑜</ci><apply id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1"><eq id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.1"></eq><list id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.2.2"><ci id="S2.SS1.p1.22.m7.1.1.cmml" xref="S2.SS1.p1.22.m7.1.1">𝑋</ci><ci id="S2.SS1.p1.22.m7.2.2.cmml" xref="S2.SS1.p1.22.m7.2.2">𝑍</ci></list><ci id="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.22.m7.5.5.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply></apply><apply id="S2.SS1.p1.22.m7.6.6.2.cmml" xref="S2.SS1.p1.22.m7.6.6.2"><times id="S2.SS1.p1.22.m7.6.6.2.2.cmml" xref="S2.SS1.p1.22.m7.6.6.2.2"></times><ci id="S2.SS1.p1.22.m7.6.6.2.3.cmml" xref="S2.SS1.p1.22.m7.6.6.2.3">𝑃</ci><apply id="S2.SS1.p1.22.m7.6.6.2.1.1.1.cmml" xref="S2.SS1.p1.22.m7.6.6.2.1.1"><eq id="S2.SS1.p1.22.m7.6.6.2.1.1.1.1.cmml" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.1"></eq><apply id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.cmml" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2"><csymbol cd="latexml" id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.1.cmml" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.1">conditional</csymbol><ci id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.2.cmml" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.2">𝑌</ci><list id="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.3.1.cmml" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.2.3.2"><ci id="S2.SS1.p1.22.m7.3.3.cmml" xref="S2.SS1.p1.22.m7.3.3">𝑋</ci><ci id="S2.SS1.p1.22.m7.4.4.cmml" xref="S2.SS1.p1.22.m7.4.4">𝑍</ci></list></apply><ci id="S2.SS1.p1.22.m7.6.6.2.1.1.1.3.cmml" xref="S2.SS1.p1.22.m7.6.6.2.1.1.1.3">𝑧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.22.m7.6c">P(Y\mid do(X,Z=z))=P(Y\mid X,Z=z)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.22.m7.6d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_X , italic_Z = italic_z ) ) = italic_P ( italic_Y ∣ italic_X , italic_Z = italic_z )</annotation></semantics></math>.
In essence, back-door adjustment computes the association between <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.23.m8.1"><semantics id="S2.SS1.p1.23.m8.1a"><mi id="S2.SS1.p1.23.m8.1.1" xref="S2.SS1.p1.23.m8.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.23.m8.1b"><ci id="S2.SS1.p1.23.m8.1.1.cmml" xref="S2.SS1.p1.23.m8.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.23.m8.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.23.m8.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S2.SS1.p1.24.m9.1"><semantics id="S2.SS1.p1.24.m9.1a"><mi id="S2.SS1.p1.24.m9.1.1" xref="S2.SS1.p1.24.m9.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.24.m9.1b"><ci id="S2.SS1.p1.24.m9.1.1.cmml" xref="S2.SS1.p1.24.m9.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.24.m9.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.24.m9.1d">italic_Y</annotation></semantics></math> for each value <math alttext="z" class="ltx_Math" display="inline" id="S2.SS1.p1.25.m10.1"><semantics id="S2.SS1.p1.25.m10.1a"><mi id="S2.SS1.p1.25.m10.1.1" xref="S2.SS1.p1.25.m10.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.25.m10.1b"><ci id="S2.SS1.p1.25.m10.1.1.cmml" xref="S2.SS1.p1.25.m10.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.25.m10.1c">z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.25.m10.1d">italic_z</annotation></semantics></math> of <math alttext="Z" class="ltx_Math" display="inline" id="S2.SS1.p1.26.m11.1"><semantics id="S2.SS1.p1.26.m11.1a"><mi id="S2.SS1.p1.26.m11.1.1" xref="S2.SS1.p1.26.m11.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.26.m11.1b"><ci id="S2.SS1.p1.26.m11.1.1.cmml" xref="S2.SS1.p1.26.m11.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.26.m11.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.26.m11.1d">italic_Z</annotation></semantics></math>, and takes the average over the prior probability <math alttext="P(Z=z)" class="ltx_Math" display="inline" id="S2.SS1.p1.27.m12.1"><semantics id="S2.SS1.p1.27.m12.1a"><mrow id="S2.SS1.p1.27.m12.1.1" xref="S2.SS1.p1.27.m12.1.1.cmml"><mi id="S2.SS1.p1.27.m12.1.1.3" xref="S2.SS1.p1.27.m12.1.1.3.cmml">P</mi><mo id="S2.SS1.p1.27.m12.1.1.2" xref="S2.SS1.p1.27.m12.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.27.m12.1.1.1.1" xref="S2.SS1.p1.27.m12.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.27.m12.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.27.m12.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.27.m12.1.1.1.1.1" xref="S2.SS1.p1.27.m12.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.27.m12.1.1.1.1.1.2" xref="S2.SS1.p1.27.m12.1.1.1.1.1.2.cmml">Z</mi><mo id="S2.SS1.p1.27.m12.1.1.1.1.1.1" xref="S2.SS1.p1.27.m12.1.1.1.1.1.1.cmml">=</mo><mi id="S2.SS1.p1.27.m12.1.1.1.1.1.3" xref="S2.SS1.p1.27.m12.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="S2.SS1.p1.27.m12.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.27.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.27.m12.1b"><apply id="S2.SS1.p1.27.m12.1.1.cmml" xref="S2.SS1.p1.27.m12.1.1"><times id="S2.SS1.p1.27.m12.1.1.2.cmml" xref="S2.SS1.p1.27.m12.1.1.2"></times><ci id="S2.SS1.p1.27.m12.1.1.3.cmml" xref="S2.SS1.p1.27.m12.1.1.3">𝑃</ci><apply id="S2.SS1.p1.27.m12.1.1.1.1.1.cmml" xref="S2.SS1.p1.27.m12.1.1.1.1"><eq id="S2.SS1.p1.27.m12.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.27.m12.1.1.1.1.1.1"></eq><ci id="S2.SS1.p1.27.m12.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.27.m12.1.1.1.1.1.2">𝑍</ci><ci id="S2.SS1.p1.27.m12.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.27.m12.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.27.m12.1c">P(Z=z)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.27.m12.1d">italic_P ( italic_Z = italic_z )</annotation></semantics></math>. The transition from <math alttext="P(Z=z\mid X)" class="ltx_Math" display="inline" id="S2.SS1.p1.28.m13.1"><semantics id="S2.SS1.p1.28.m13.1a"><mrow id="S2.SS1.p1.28.m13.1.1" xref="S2.SS1.p1.28.m13.1.1.cmml"><mi id="S2.SS1.p1.28.m13.1.1.3" xref="S2.SS1.p1.28.m13.1.1.3.cmml">P</mi><mo id="S2.SS1.p1.28.m13.1.1.2" xref="S2.SS1.p1.28.m13.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.28.m13.1.1.1.1" xref="S2.SS1.p1.28.m13.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.28.m13.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.28.m13.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.28.m13.1.1.1.1.1" xref="S2.SS1.p1.28.m13.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.28.m13.1.1.1.1.1.2" xref="S2.SS1.p1.28.m13.1.1.1.1.1.2.cmml">Z</mi><mo id="S2.SS1.p1.28.m13.1.1.1.1.1.1" xref="S2.SS1.p1.28.m13.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.28.m13.1.1.1.1.1.3" xref="S2.SS1.p1.28.m13.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.28.m13.1.1.1.1.1.3.2" xref="S2.SS1.p1.28.m13.1.1.1.1.1.3.2.cmml">z</mi><mo id="S2.SS1.p1.28.m13.1.1.1.1.1.3.1" xref="S2.SS1.p1.28.m13.1.1.1.1.1.3.1.cmml">∣</mo><mi id="S2.SS1.p1.28.m13.1.1.1.1.1.3.3" xref="S2.SS1.p1.28.m13.1.1.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S2.SS1.p1.28.m13.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.28.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.28.m13.1b"><apply id="S2.SS1.p1.28.m13.1.1.cmml" xref="S2.SS1.p1.28.m13.1.1"><times id="S2.SS1.p1.28.m13.1.1.2.cmml" xref="S2.SS1.p1.28.m13.1.1.2"></times><ci id="S2.SS1.p1.28.m13.1.1.3.cmml" xref="S2.SS1.p1.28.m13.1.1.3">𝑃</ci><apply id="S2.SS1.p1.28.m13.1.1.1.1.1.cmml" xref="S2.SS1.p1.28.m13.1.1.1.1"><eq id="S2.SS1.p1.28.m13.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.28.m13.1.1.1.1.1.1"></eq><ci id="S2.SS1.p1.28.m13.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.28.m13.1.1.1.1.1.2">𝑍</ci><apply id="S2.SS1.p1.28.m13.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.28.m13.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.SS1.p1.28.m13.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.28.m13.1.1.1.1.1.3.1">conditional</csymbol><ci id="S2.SS1.p1.28.m13.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.28.m13.1.1.1.1.1.3.2">𝑧</ci><ci id="S2.SS1.p1.28.m13.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.28.m13.1.1.1.1.1.3.3">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.28.m13.1c">P(Z=z\mid X)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.28.m13.1d">italic_P ( italic_Z = italic_z ∣ italic_X )</annotation></semantics></math> to <math alttext="P(Z=z)" class="ltx_Math" display="inline" id="S2.SS1.p1.29.m14.1"><semantics id="S2.SS1.p1.29.m14.1a"><mrow id="S2.SS1.p1.29.m14.1.1" xref="S2.SS1.p1.29.m14.1.1.cmml"><mi id="S2.SS1.p1.29.m14.1.1.3" xref="S2.SS1.p1.29.m14.1.1.3.cmml">P</mi><mo id="S2.SS1.p1.29.m14.1.1.2" xref="S2.SS1.p1.29.m14.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.29.m14.1.1.1.1" xref="S2.SS1.p1.29.m14.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.29.m14.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.29.m14.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.29.m14.1.1.1.1.1" xref="S2.SS1.p1.29.m14.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.29.m14.1.1.1.1.1.2" xref="S2.SS1.p1.29.m14.1.1.1.1.1.2.cmml">Z</mi><mo id="S2.SS1.p1.29.m14.1.1.1.1.1.1" xref="S2.SS1.p1.29.m14.1.1.1.1.1.1.cmml">=</mo><mi id="S2.SS1.p1.29.m14.1.1.1.1.1.3" xref="S2.SS1.p1.29.m14.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="S2.SS1.p1.29.m14.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.29.m14.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.29.m14.1b"><apply id="S2.SS1.p1.29.m14.1.1.cmml" xref="S2.SS1.p1.29.m14.1.1"><times id="S2.SS1.p1.29.m14.1.1.2.cmml" xref="S2.SS1.p1.29.m14.1.1.2"></times><ci id="S2.SS1.p1.29.m14.1.1.3.cmml" xref="S2.SS1.p1.29.m14.1.1.3">𝑃</ci><apply id="S2.SS1.p1.29.m14.1.1.1.1.1.cmml" xref="S2.SS1.p1.29.m14.1.1.1.1"><eq id="S2.SS1.p1.29.m14.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.29.m14.1.1.1.1.1.1"></eq><ci id="S2.SS1.p1.29.m14.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.29.m14.1.1.1.1.1.2">𝑍</ci><ci id="S2.SS1.p1.29.m14.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.29.m14.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.29.m14.1c">P(Z=z)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.29.m14.1d">italic_P ( italic_Z = italic_z )</annotation></semantics></math> indicates that the change of <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.30.m15.1"><semantics id="S2.SS1.p1.30.m15.1a"><mi id="S2.SS1.p1.30.m15.1.1" xref="S2.SS1.p1.30.m15.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.30.m15.1b"><ci id="S2.SS1.p1.30.m15.1.1.cmml" xref="S2.SS1.p1.30.m15.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.30.m15.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.30.m15.1d">italic_X</annotation></semantics></math> no longer affects the distribution of choosing <math alttext="Z" class="ltx_Math" display="inline" id="S2.SS1.p1.31.m16.1"><semantics id="S2.SS1.p1.31.m16.1a"><mi id="S2.SS1.p1.31.m16.1.1" xref="S2.SS1.p1.31.m16.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.31.m16.1b"><ci id="S2.SS1.p1.31.m16.1.1.cmml" xref="S2.SS1.p1.31.m16.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.31.m16.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.31.m16.1d">italic_Z</annotation></semantics></math>, thus obeying the randomized experiments where we can accurately estimate the causal effect of <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p1.32.m17.1"><semantics id="S2.SS1.p1.32.m17.1a"><mi id="S2.SS1.p1.32.m17.1.1" xref="S2.SS1.p1.32.m17.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.32.m17.1b"><ci id="S2.SS1.p1.32.m17.1.1.cmml" xref="S2.SS1.p1.32.m17.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.32.m17.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.32.m17.1d">italic_X</annotation></semantics></math> on <math alttext="Y" class="ltx_Math" display="inline" id="S2.SS1.p1.33.m18.1"><semantics id="S2.SS1.p1.33.m18.1a"><mi id="S2.SS1.p1.33.m18.1.1" xref="S2.SS1.p1.33.m18.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.33.m18.1b"><ci id="S2.SS1.p1.33.m18.1.1.cmml" xref="S2.SS1.p1.33.m18.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.33.m18.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.33.m18.1d">italic_Y</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="410" id="S2.F3.1.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F3.3.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S2.F3.4.2" style="font-size:90%;">
Causal graph for illustrating the back-door adjustment and front-door adjustment.
</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span><span class="ltx_text ltx_font_italic" id="S2.SS2.1.1">Front-door Adjustment</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.7">From Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E2" title="In 2.1 Back-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">2</span></a>), we can find that the back-door adjustment requires the knowledge of the confounder variable <math alttext="Z" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_Z</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.7.5">i</span>.<span class="ltx_text ltx_font_italic" id="S2.SS2.p1.7.6">e</span>., the detailed values <math alttext="z" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_z</annotation></semantics></math>. However, there are many unobserved confounders in <math alttext="U" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">U</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_U</annotation></semantics></math> that are hard to measure in practice, such as the <span class="ltx_text" id="S2.SS2.p1.7.4">social relationships that might bring exposure to items (<span class="ltx_text ltx_font_italic" id="S2.SS2.p1.7.4.5">e</span>.<span class="ltx_text ltx_font_italic" id="S2.SS2.p1.7.4.6">g</span>., friends recommending items) and conformity to users,<span class="ltx_text" id="S2.SS2.p1.7.4.4"> in recommender systems. Fortunately, front-door adjustment can estimate the causal effects by introducing a proper mediator variable <math alttext="M" class="ltx_Math" display="inline" id="S2.SS2.p1.4.1.1.m1.1"><semantics id="S2.SS2.p1.4.1.1.m1.1a"><mi id="S2.SS2.p1.4.1.1.m1.1.1" xref="S2.SS2.p1.4.1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.1.1.m1.1b"><ci id="S2.SS2.p1.4.1.1.m1.1.1.cmml" xref="S2.SS2.p1.4.1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.1.1.m1.1d">italic_M</annotation></semantics></math> between <math alttext="X" class="ltx_Math" display="inline" id="S2.SS2.p1.5.2.2.m2.1"><semantics id="S2.SS2.p1.5.2.2.m2.1a"><mi id="S2.SS2.p1.5.2.2.m2.1.1" xref="S2.SS2.p1.5.2.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.2.2.m2.1b"><ci id="S2.SS2.p1.5.2.2.m2.1.1.cmml" xref="S2.SS2.p1.5.2.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.2.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.2.2.m2.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S2.SS2.p1.6.3.3.m3.1"><semantics id="S2.SS2.p1.6.3.3.m3.1a"><mi id="S2.SS2.p1.6.3.3.m3.1.1" xref="S2.SS2.p1.6.3.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.3.3.m3.1b"><ci id="S2.SS2.p1.6.3.3.m3.1.1.cmml" xref="S2.SS2.p1.6.3.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.3.3.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.3.3.m3.1d">italic_Y</annotation></semantics></math>. By Bayes Rule, with the mediator, the posterior with <math alttext="do" class="ltx_Math" display="inline" id="S2.SS2.p1.7.4.4.m4.1"><semantics id="S2.SS2.p1.7.4.4.m4.1a"><mrow id="S2.SS2.p1.7.4.4.m4.1.1" xref="S2.SS2.p1.7.4.4.m4.1.1.cmml"><mi id="S2.SS2.p1.7.4.4.m4.1.1.2" xref="S2.SS2.p1.7.4.4.m4.1.1.2.cmml">d</mi><mo id="S2.SS2.p1.7.4.4.m4.1.1.1" xref="S2.SS2.p1.7.4.4.m4.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p1.7.4.4.m4.1.1.3" xref="S2.SS2.p1.7.4.4.m4.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.4.4.m4.1b"><apply id="S2.SS2.p1.7.4.4.m4.1.1.cmml" xref="S2.SS2.p1.7.4.4.m4.1.1"><times id="S2.SS2.p1.7.4.4.m4.1.1.1.cmml" xref="S2.SS2.p1.7.4.4.m4.1.1.1"></times><ci id="S2.SS2.p1.7.4.4.m4.1.1.2.cmml" xref="S2.SS2.p1.7.4.4.m4.1.1.2">𝑑</ci><ci id="S2.SS2.p1.7.4.4.m4.1.1.3.cmml" xref="S2.SS2.p1.7.4.4.m4.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.4.4.m4.1c">do</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.4.4.m4.1d">italic_d italic_o</annotation></semantics></math>-operator can be written as:</span></span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx2">
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P(Y\mid do(X))=\sum_{m}P(M=m\mid do(X))P(Y\mid do(M=m))." class="ltx_Math" display="inline" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.1.3" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.1.3.cmml">P</mi><mo id="S2.E3.m1.3.3.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml">Y</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml">∣</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.3.2" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml">d</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.3.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.3.3" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.3.cmml">o</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.3.1a" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.3.4.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.3.4.2.1" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E3.m1.1.1" mathcolor="#000000" xref="S2.E3.m1.1.1.cmml">X</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.3.4.2.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.4" xref="S2.E3.m1.3.3.1.1.4.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.3" xref="S2.E3.m1.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E3.m1.3.3.1.1.3.3" xref="S2.E3.m1.3.3.1.1.3.3.cmml"><munder id="S2.E3.m1.3.3.1.1.3.3a" xref="S2.E3.m1.3.3.1.1.3.3.cmml"><mo id="S2.E3.m1.3.3.1.1.3.3.2" movablelimits="false" xref="S2.E3.m1.3.3.1.1.3.3.2.cmml">∑</mo><mi id="S2.E3.m1.3.3.1.1.3.3.3" xref="S2.E3.m1.3.3.1.1.3.3.3.cmml">m</mi></munder></mstyle><mrow id="S2.E3.m1.3.3.1.1.3.2" xref="S2.E3.m1.3.3.1.1.3.2.cmml"><mi id="S2.E3.m1.3.3.1.1.3.2.4" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.3.2.4.cmml">P</mi><mo id="S2.E3.m1.3.3.1.1.3.2.3" xref="S2.E3.m1.3.3.1.1.3.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.2.1.1.1" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.2.1.1.1.1" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.2.1.1.1.1.2" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.2.cmml">M</mi><mo id="S2.E3.m1.3.3.1.1.2.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.2" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.2.cmml">m</mi><mo id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.1" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.1.cmml">∣</mo><mrow id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.2" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.2.cmml">d</mi><mo id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.1" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.3" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.3.cmml">o</mi><mo id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.1a" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.4.2" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.cmml"><mo id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.4.2.1" stretchy="false" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.cmml">(</mo><mi id="S2.E3.m1.2.2" mathcolor="#000000" xref="S2.E3.m1.2.2.cmml">X</mi><mo id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.4.2.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.2.1.1.1.3" stretchy="false" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.3.3.1.1.3.2.3a" xref="S2.E3.m1.3.3.1.1.3.2.3.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.3.2.5" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.3.2.5.cmml">P</mi><mo id="S2.E3.m1.3.3.1.1.3.2.3b" xref="S2.E3.m1.3.3.1.1.3.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.3.2.2.1" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.3.2.2.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.3.2.2.1.1" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.3.2.2.1.1.3" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.3.cmml">Y</mi><mo id="S2.E3.m1.3.3.1.1.3.2.2.1.1.2" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.2.cmml">∣</mo><mrow id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.3" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.3.cmml">d</mi><mo id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.2" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.2.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.4" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.4.cmml">o</mi><mo id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.2a" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.2.cmml">M</mi><mo id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.3.2.2.1.3" stretchy="false" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.2" lspace="0em" xref="S2.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><eq id="S2.E3.m1.3.3.1.1.4.cmml" xref="S2.E3.m1.3.3.1.1.4"></eq><apply id="S2.E3.m1.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"><times id="S2.E3.m1.3.3.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.2"></times><ci id="S2.E3.m1.3.3.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.3">𝑃</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2">𝑌</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3"><times id="S2.E3.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.1"></times><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.3">𝑜</ci><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑋</ci></apply></apply></apply><apply id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3"><apply id="S2.E3.m1.3.3.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.3.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3.3">subscript</csymbol><sum id="S2.E3.m1.3.3.1.1.3.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.3.2"></sum><ci id="S2.E3.m1.3.3.1.1.3.3.3.cmml" xref="S2.E3.m1.3.3.1.1.3.3.3">𝑚</ci></apply><apply id="S2.E3.m1.3.3.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2"><times id="S2.E3.m1.3.3.1.1.3.2.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3"></times><ci id="S2.E3.m1.3.3.1.1.3.2.4.cmml" xref="S2.E3.m1.3.3.1.1.3.2.4">𝑃</ci><apply id="S2.E3.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1"><eq id="S2.E3.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.1"></eq><ci id="S2.E3.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.2">𝑀</ci><apply id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3"><csymbol cd="latexml" id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.1">conditional</csymbol><ci id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.2">𝑚</ci><apply id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3"><times id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.1"></times><ci id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.1.1.1.1.3.3.3">𝑜</ci><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑋</ci></apply></apply></apply><ci id="S2.E3.m1.3.3.1.1.3.2.5.cmml" xref="S2.E3.m1.3.3.1.1.3.2.5">𝑃</ci><apply id="S2.E3.m1.3.3.1.1.3.2.2.1.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1"><csymbol cd="latexml" id="S2.E3.m1.3.3.1.1.3.2.2.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.2">conditional</csymbol><ci id="S2.E3.m1.3.3.1.1.3.2.2.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.3">𝑌</ci><apply id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1"><times id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.2"></times><ci id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.3">𝑑</ci><ci id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.4.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.4">𝑜</ci><apply id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1"><eq id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.1"></eq><ci id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.2">𝑀</ci><ci id="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\displaystyle P(Y\mid do(X))=\sum_{m}P(M=m\mid do(X))P(Y\mid do(M=m)).</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_X ) ) = ∑ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT italic_P ( italic_M = italic_m ∣ italic_d italic_o ( italic_X ) ) italic_P ( italic_Y ∣ italic_d italic_o ( italic_M = italic_m ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.14">Then, FDA can be decomposed into the following two steps:</p>
<ol class="ltx_enumerate" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.7">Estimating <math alttext="P(M=m\mid do(X))" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.2"><semantics id="S2.I1.i1.p1.1.m1.2a"><mrow id="S2.I1.i1.p1.1.m1.2.2" xref="S2.I1.i1.p1.1.m1.2.2.cmml"><mi id="S2.I1.i1.p1.1.m1.2.2.3" xref="S2.I1.i1.p1.1.m1.2.2.3.cmml">P</mi><mo id="S2.I1.i1.p1.1.m1.2.2.2" xref="S2.I1.i1.p1.1.m1.2.2.2.cmml">⁢</mo><mrow id="S2.I1.i1.p1.1.m1.2.2.1.1" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.cmml"><mo id="S2.I1.i1.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.I1.i1.p1.1.m1.2.2.1.1.1" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.I1.i1.p1.1.m1.2.2.1.1.1.2" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.2.cmml">M</mi><mo id="S2.I1.i1.p1.1.m1.2.2.1.1.1.1" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.1.cmml">=</mo><mrow id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.cmml"><mi id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.2" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.2.cmml">m</mi><mo id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.1" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.1.cmml">∣</mo><mrow id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.cmml"><mi id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.2" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.2.cmml">d</mi><mo id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.1" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.3" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.3.cmml">o</mi><mo id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.1a" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mrow id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.4.2" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.cmml"><mo id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.4.2.1" stretchy="false" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.cmml">(</mo><mi id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">X</mi><mo id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.4.2.2" stretchy="false" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.I1.i1.p1.1.m1.2.2.1.1.3" stretchy="false" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.2b"><apply id="S2.I1.i1.p1.1.m1.2.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2"><times id="S2.I1.i1.p1.1.m1.2.2.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2"></times><ci id="S2.I1.i1.p1.1.m1.2.2.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.3">𝑃</ci><apply id="S2.I1.i1.p1.1.m1.2.2.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1"><eq id="S2.I1.i1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.1"></eq><ci id="S2.I1.i1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.2">𝑀</ci><apply id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3"><csymbol cd="latexml" id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.1">conditional</csymbol><ci id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.2">𝑚</ci><apply id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3"><times id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.1"></times><ci id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.2">𝑑</ci><ci id="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.1.1.1.3.3.3">𝑜</ci><ci id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">𝑋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.2c">P(M=m\mid do(X))</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.2d">italic_P ( italic_M = italic_m ∣ italic_d italic_o ( italic_X ) )</annotation></semantics></math>. <math alttext="P(M=m\mid do(X))=P(M=m\mid X)" class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m2.3"><semantics id="S2.I1.i1.p1.2.m2.3a"><mrow id="S2.I1.i1.p1.2.m2.3.3" xref="S2.I1.i1.p1.2.m2.3.3.cmml"><mrow id="S2.I1.i1.p1.2.m2.2.2.1" xref="S2.I1.i1.p1.2.m2.2.2.1.cmml"><mi id="S2.I1.i1.p1.2.m2.2.2.1.3" xref="S2.I1.i1.p1.2.m2.2.2.1.3.cmml">P</mi><mo id="S2.I1.i1.p1.2.m2.2.2.1.2" xref="S2.I1.i1.p1.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S2.I1.i1.p1.2.m2.2.2.1.1.1" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.cmml"><mo id="S2.I1.i1.p1.2.m2.2.2.1.1.1.2" stretchy="false" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.2" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.2.cmml">M</mi><mo id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.1" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.1.cmml">=</mo><mrow id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.cmml"><mi id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.2" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.2.cmml">m</mi><mo id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.1" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.1.cmml">∣</mo><mrow id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.cmml"><mi id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.2" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.2.cmml">d</mi><mo id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.1" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.3" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.3.cmml">o</mi><mo id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.1a" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.1.cmml">⁢</mo><mrow id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.4.2" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.cmml"><mo id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.4.2.1" stretchy="false" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.cmml">(</mo><mi id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml">X</mi><mo id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.4.2.2" stretchy="false" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.I1.i1.p1.2.m2.2.2.1.1.1.3" stretchy="false" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i1.p1.2.m2.3.3.3" xref="S2.I1.i1.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S2.I1.i1.p1.2.m2.3.3.2" xref="S2.I1.i1.p1.2.m2.3.3.2.cmml"><mi id="S2.I1.i1.p1.2.m2.3.3.2.3" xref="S2.I1.i1.p1.2.m2.3.3.2.3.cmml">P</mi><mo id="S2.I1.i1.p1.2.m2.3.3.2.2" xref="S2.I1.i1.p1.2.m2.3.3.2.2.cmml">⁢</mo><mrow id="S2.I1.i1.p1.2.m2.3.3.2.1.1" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.cmml"><mo id="S2.I1.i1.p1.2.m2.3.3.2.1.1.2" stretchy="false" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.cmml">(</mo><mrow id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.2" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.2.cmml">M</mi><mo id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.1" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.1.cmml">=</mo><mrow id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.cmml"><mi id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.2" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.2.cmml">m</mi><mo id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.1" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.1.cmml">∣</mo><mi id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.3" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S2.I1.i1.p1.2.m2.3.3.2.1.1.3" stretchy="false" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.3b"><apply id="S2.I1.i1.p1.2.m2.3.3.cmml" xref="S2.I1.i1.p1.2.m2.3.3"><eq id="S2.I1.i1.p1.2.m2.3.3.3.cmml" xref="S2.I1.i1.p1.2.m2.3.3.3"></eq><apply id="S2.I1.i1.p1.2.m2.2.2.1.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1"><times id="S2.I1.i1.p1.2.m2.2.2.1.2.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.2"></times><ci id="S2.I1.i1.p1.2.m2.2.2.1.3.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.3">𝑃</ci><apply id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1"><eq id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.1"></eq><ci id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.2">𝑀</ci><apply id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3"><csymbol cd="latexml" id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.1">conditional</csymbol><ci id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.2.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.2">𝑚</ci><apply id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3"><times id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.1.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.1"></times><ci id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.2.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.3.cmml" xref="S2.I1.i1.p1.2.m2.2.2.1.1.1.1.3.3.3">𝑜</ci><ci id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">𝑋</ci></apply></apply></apply></apply><apply id="S2.I1.i1.p1.2.m2.3.3.2.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2"><times id="S2.I1.i1.p1.2.m2.3.3.2.2.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.2"></times><ci id="S2.I1.i1.p1.2.m2.3.3.2.3.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.3">𝑃</ci><apply id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1"><eq id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.1"></eq><ci id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.2">𝑀</ci><apply id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3"><csymbol cd="latexml" id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.1.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.1">conditional</csymbol><ci id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.2.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.2">𝑚</ci><ci id="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.3.cmml" xref="S2.I1.i1.p1.2.m2.3.3.2.1.1.1.3.3">𝑋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.3c">P(M=m\mid do(X))=P(M=m\mid X)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m2.3d">italic_P ( italic_M = italic_m ∣ italic_d italic_o ( italic_X ) ) = italic_P ( italic_M = italic_m ∣ italic_X )</annotation></semantics></math> since the back-door path <math alttext="X\leftarrow U\rightarrow Y\leftarrow M" class="ltx_Math" display="inline" id="S2.I1.i1.p1.3.m3.1"><semantics id="S2.I1.i1.p1.3.m3.1a"><mrow id="S2.I1.i1.p1.3.m3.1.1" xref="S2.I1.i1.p1.3.m3.1.1.cmml"><mi id="S2.I1.i1.p1.3.m3.1.1.2" xref="S2.I1.i1.p1.3.m3.1.1.2.cmml">X</mi><mo id="S2.I1.i1.p1.3.m3.1.1.3" stretchy="false" xref="S2.I1.i1.p1.3.m3.1.1.3.cmml">←</mo><mi id="S2.I1.i1.p1.3.m3.1.1.4" xref="S2.I1.i1.p1.3.m3.1.1.4.cmml">U</mi><mo id="S2.I1.i1.p1.3.m3.1.1.5" stretchy="false" xref="S2.I1.i1.p1.3.m3.1.1.5.cmml">→</mo><mi id="S2.I1.i1.p1.3.m3.1.1.6" xref="S2.I1.i1.p1.3.m3.1.1.6.cmml">Y</mi><mo id="S2.I1.i1.p1.3.m3.1.1.7" stretchy="false" xref="S2.I1.i1.p1.3.m3.1.1.7.cmml">←</mo><mi id="S2.I1.i1.p1.3.m3.1.1.8" xref="S2.I1.i1.p1.3.m3.1.1.8.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m3.1b"><apply id="S2.I1.i1.p1.3.m3.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><and id="S2.I1.i1.p1.3.m3.1.1a.cmml" xref="S2.I1.i1.p1.3.m3.1.1"></and><apply id="S2.I1.i1.p1.3.m3.1.1b.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><ci id="S2.I1.i1.p1.3.m3.1.1.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.3">←</ci><ci id="S2.I1.i1.p1.3.m3.1.1.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2">𝑋</ci><ci id="S2.I1.i1.p1.3.m3.1.1.4.cmml" xref="S2.I1.i1.p1.3.m3.1.1.4">𝑈</ci></apply><apply id="S2.I1.i1.p1.3.m3.1.1c.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><ci id="S2.I1.i1.p1.3.m3.1.1.5.cmml" xref="S2.I1.i1.p1.3.m3.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S2.I1.i1.p1.3.m3.1.1.4.cmml" id="S2.I1.i1.p1.3.m3.1.1d.cmml" xref="S2.I1.i1.p1.3.m3.1.1"></share><ci id="S2.I1.i1.p1.3.m3.1.1.6.cmml" xref="S2.I1.i1.p1.3.m3.1.1.6">𝑌</ci></apply><apply id="S2.I1.i1.p1.3.m3.1.1e.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><ci id="S2.I1.i1.p1.3.m3.1.1.7.cmml" xref="S2.I1.i1.p1.3.m3.1.1.7">←</ci><share href="https://arxiv.org/html/2405.20626v1#S2.I1.i1.p1.3.m3.1.1.6.cmml" id="S2.I1.i1.p1.3.m3.1.1f.cmml" xref="S2.I1.i1.p1.3.m3.1.1"></share><ci id="S2.I1.i1.p1.3.m3.1.1.8.cmml" xref="S2.I1.i1.p1.3.m3.1.1.8">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m3.1c">X\leftarrow U\rightarrow Y\leftarrow M</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.3.m3.1d">italic_X ← italic_U → italic_Y ← italic_M</annotation></semantics></math> is naturally blocked thanks to the colliding effect <math alttext="U\rightarrow Y\leftarrow M" class="ltx_Math" display="inline" id="S2.I1.i1.p1.4.m4.1"><semantics id="S2.I1.i1.p1.4.m4.1a"><mrow id="S2.I1.i1.p1.4.m4.1.1" xref="S2.I1.i1.p1.4.m4.1.1.cmml"><mi id="S2.I1.i1.p1.4.m4.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.2.cmml">U</mi><mo id="S2.I1.i1.p1.4.m4.1.1.3" stretchy="false" xref="S2.I1.i1.p1.4.m4.1.1.3.cmml">→</mo><mi id="S2.I1.i1.p1.4.m4.1.1.4" xref="S2.I1.i1.p1.4.m4.1.1.4.cmml">Y</mi><mo id="S2.I1.i1.p1.4.m4.1.1.5" stretchy="false" xref="S2.I1.i1.p1.4.m4.1.1.5.cmml">←</mo><mi id="S2.I1.i1.p1.4.m4.1.1.6" xref="S2.I1.i1.p1.4.m4.1.1.6.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.4.m4.1b"><apply id="S2.I1.i1.p1.4.m4.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1"><and id="S2.I1.i1.p1.4.m4.1.1a.cmml" xref="S2.I1.i1.p1.4.m4.1.1"></and><apply id="S2.I1.i1.p1.4.m4.1.1b.cmml" xref="S2.I1.i1.p1.4.m4.1.1"><ci id="S2.I1.i1.p1.4.m4.1.1.3.cmml" xref="S2.I1.i1.p1.4.m4.1.1.3">→</ci><ci id="S2.I1.i1.p1.4.m4.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.2">𝑈</ci><ci id="S2.I1.i1.p1.4.m4.1.1.4.cmml" xref="S2.I1.i1.p1.4.m4.1.1.4">𝑌</ci></apply><apply id="S2.I1.i1.p1.4.m4.1.1c.cmml" xref="S2.I1.i1.p1.4.m4.1.1"><ci id="S2.I1.i1.p1.4.m4.1.1.5.cmml" xref="S2.I1.i1.p1.4.m4.1.1.5">←</ci><share href="https://arxiv.org/html/2405.20626v1#S2.I1.i1.p1.4.m4.1.1.4.cmml" id="S2.I1.i1.p1.4.m4.1.1d.cmml" xref="S2.I1.i1.p1.4.m4.1.1"></share><ci id="S2.I1.i1.p1.4.m4.1.1.6.cmml" xref="S2.I1.i1.p1.4.m4.1.1.6">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.4.m4.1c">U\rightarrow Y\leftarrow M</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.4.m4.1d">italic_U → italic_Y ← italic_M</annotation></semantics></math>. An uncontrolled collider variable <math alttext="Y" class="ltx_Math" display="inline" id="S2.I1.i1.p1.5.m5.1"><semantics id="S2.I1.i1.p1.5.m5.1a"><mi id="S2.I1.i1.p1.5.m5.1.1" xref="S2.I1.i1.p1.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.5.m5.1b"><ci id="S2.I1.i1.p1.5.m5.1.1.cmml" xref="S2.I1.i1.p1.5.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.5.m5.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.5.m5.1d">italic_Y</annotation></semantics></math> will block the effect from <math alttext="U" class="ltx_Math" display="inline" id="S2.I1.i1.p1.6.m6.1"><semantics id="S2.I1.i1.p1.6.m6.1a"><mi id="S2.I1.i1.p1.6.m6.1.1" xref="S2.I1.i1.p1.6.m6.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.6.m6.1b"><ci id="S2.I1.i1.p1.6.m6.1.1.cmml" xref="S2.I1.i1.p1.6.m6.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.6.m6.1c">U</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.6.m6.1d">italic_U</annotation></semantics></math> to <math alttext="M" class="ltx_Math" display="inline" id="S2.I1.i1.p1.7.m7.1"><semantics id="S2.I1.i1.p1.7.m7.1a"><mi id="S2.I1.i1.p1.7.m7.1.1" xref="S2.I1.i1.p1.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.7.m7.1b"><ci id="S2.I1.i1.p1.7.m7.1.1.cmml" xref="S2.I1.i1.p1.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.7.m7.1d">italic_M</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib10" title="">10</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.6">Estimating <math alttext="P(Y\mid do(M=m))" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><mrow id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml">P</mi><mo id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.I1.i2.p1.1.m1.1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.I1.i2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.I1.i2.p1.1.m1.1.1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml">Y</mi><mo id="S2.I1.i2.p1.1.m1.1.1.1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.3.cmml">d</mi><mo id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.4" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.4.cmml">o</mi><mo id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.2a" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">M</mi><mo id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.I1.i2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><times id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2"></times><ci id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3">𝑃</ci><apply id="S2.I1.i2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.2">conditional</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.3">𝑌</ci><apply id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1"><times id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.2"></times><ci id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.3">𝑑</ci><ci id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.4.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.4">𝑜</ci><apply id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1"><eq id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.1"></eq><ci id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">P(Y\mid do(M=m))</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_M = italic_m ) )</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.6.1">w</span>.<span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.6.2">r</span>.<span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.6.3">t</span>. the unblocked back-door path <math alttext="M\leftarrow X\leftarrow U\rightarrow Y" class="ltx_Math" display="inline" id="S2.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i2.p1.2.m2.1a"><mrow id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.2" xref="S2.I1.i2.p1.2.m2.1.1.2.cmml">M</mi><mo id="S2.I1.i2.p1.2.m2.1.1.3" stretchy="false" xref="S2.I1.i2.p1.2.m2.1.1.3.cmml">←</mo><mi id="S2.I1.i2.p1.2.m2.1.1.4" xref="S2.I1.i2.p1.2.m2.1.1.4.cmml">X</mi><mo id="S2.I1.i2.p1.2.m2.1.1.5" stretchy="false" xref="S2.I1.i2.p1.2.m2.1.1.5.cmml">←</mo><mi id="S2.I1.i2.p1.2.m2.1.1.6" xref="S2.I1.i2.p1.2.m2.1.1.6.cmml">U</mi><mo id="S2.I1.i2.p1.2.m2.1.1.7" stretchy="false" xref="S2.I1.i2.p1.2.m2.1.1.7.cmml">→</mo><mi id="S2.I1.i2.p1.2.m2.1.1.8" xref="S2.I1.i2.p1.2.m2.1.1.8.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><apply id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><and id="S2.I1.i2.p1.2.m2.1.1a.cmml" xref="S2.I1.i2.p1.2.m2.1.1"></and><apply id="S2.I1.i2.p1.2.m2.1.1b.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><ci id="S2.I1.i2.p1.2.m2.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3">←</ci><ci id="S2.I1.i2.p1.2.m2.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.2">𝑀</ci><ci id="S2.I1.i2.p1.2.m2.1.1.4.cmml" xref="S2.I1.i2.p1.2.m2.1.1.4">𝑋</ci></apply><apply id="S2.I1.i2.p1.2.m2.1.1c.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><ci id="S2.I1.i2.p1.2.m2.1.1.5.cmml" xref="S2.I1.i2.p1.2.m2.1.1.5">←</ci><share href="https://arxiv.org/html/2405.20626v1#S2.I1.i2.p1.2.m2.1.1.4.cmml" id="S2.I1.i2.p1.2.m2.1.1d.cmml" xref="S2.I1.i2.p1.2.m2.1.1"></share><ci id="S2.I1.i2.p1.2.m2.1.1.6.cmml" xref="S2.I1.i2.p1.2.m2.1.1.6">𝑈</ci></apply><apply id="S2.I1.i2.p1.2.m2.1.1e.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><ci id="S2.I1.i2.p1.2.m2.1.1.7.cmml" xref="S2.I1.i2.p1.2.m2.1.1.7">→</ci><share href="https://arxiv.org/html/2405.20626v1#S2.I1.i2.p1.2.m2.1.1.6.cmml" id="S2.I1.i2.p1.2.m2.1.1f.cmml" xref="S2.I1.i2.p1.2.m2.1.1"></share><ci id="S2.I1.i2.p1.2.m2.1.1.8.cmml" xref="S2.I1.i2.p1.2.m2.1.1.8">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">M\leftarrow X\leftarrow U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.2.m2.1d">italic_M ← italic_X ← italic_U → italic_Y</annotation></semantics></math>. Similar to the back-door adjustment, the remedy is to adjust the parents of <math alttext="M" class="ltx_Math" display="inline" id="S2.I1.i2.p1.3.m3.1"><semantics id="S2.I1.i2.p1.3.m3.1a"><mi id="S2.I1.i2.p1.3.m3.1.1" xref="S2.I1.i2.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.1b"><ci id="S2.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.3.m3.1d">italic_M</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.6.4">i</span>.<span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.6.5">e</span>., <math alttext="X" class="ltx_Math" display="inline" id="S2.I1.i2.p1.4.m4.1"><semantics id="S2.I1.i2.p1.4.m4.1a"><mi id="S2.I1.i2.p1.4.m4.1.1" xref="S2.I1.i2.p1.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m4.1b"><ci id="S2.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.4.m4.1d">italic_X</annotation></semantics></math> and make <math alttext="(X,M)" class="ltx_Math" display="inline" id="S2.I1.i2.p1.5.m5.2"><semantics id="S2.I1.i2.p1.5.m5.2a"><mrow id="S2.I1.i2.p1.5.m5.2.3.2" xref="S2.I1.i2.p1.5.m5.2.3.1.cmml"><mo id="S2.I1.i2.p1.5.m5.2.3.2.1" stretchy="false" xref="S2.I1.i2.p1.5.m5.2.3.1.cmml">(</mo><mi id="S2.I1.i2.p1.5.m5.1.1" xref="S2.I1.i2.p1.5.m5.1.1.cmml">X</mi><mo id="S2.I1.i2.p1.5.m5.2.3.2.2" xref="S2.I1.i2.p1.5.m5.2.3.1.cmml">,</mo><mi id="S2.I1.i2.p1.5.m5.2.2" xref="S2.I1.i2.p1.5.m5.2.2.cmml">M</mi><mo id="S2.I1.i2.p1.5.m5.2.3.2.3" stretchy="false" xref="S2.I1.i2.p1.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.5.m5.2b"><interval closure="open" id="S2.I1.i2.p1.5.m5.2.3.1.cmml" xref="S2.I1.i2.p1.5.m5.2.3.2"><ci id="S2.I1.i2.p1.5.m5.1.1.cmml" xref="S2.I1.i2.p1.5.m5.1.1">𝑋</ci><ci id="S2.I1.i2.p1.5.m5.2.2.cmml" xref="S2.I1.i2.p1.5.m5.2.2">𝑀</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.5.m5.2c">(X,M)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.5.m5.2d">( italic_X , italic_M )</annotation></semantics></math> independent so that we can block the back-door path by cutting <math alttext="M\leftarrow X" class="ltx_Math" display="inline" id="S2.I1.i2.p1.6.m6.1"><semantics id="S2.I1.i2.p1.6.m6.1a"><mrow id="S2.I1.i2.p1.6.m6.1.1" xref="S2.I1.i2.p1.6.m6.1.1.cmml"><mi id="S2.I1.i2.p1.6.m6.1.1.2" xref="S2.I1.i2.p1.6.m6.1.1.2.cmml">M</mi><mo id="S2.I1.i2.p1.6.m6.1.1.1" stretchy="false" xref="S2.I1.i2.p1.6.m6.1.1.1.cmml">←</mo><mi id="S2.I1.i2.p1.6.m6.1.1.3" xref="S2.I1.i2.p1.6.m6.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.6.m6.1b"><apply id="S2.I1.i2.p1.6.m6.1.1.cmml" xref="S2.I1.i2.p1.6.m6.1.1"><ci id="S2.I1.i2.p1.6.m6.1.1.1.cmml" xref="S2.I1.i2.p1.6.m6.1.1.1">←</ci><ci id="S2.I1.i2.p1.6.m6.1.1.2.cmml" xref="S2.I1.i2.p1.6.m6.1.1.2">𝑀</ci><ci id="S2.I1.i2.p1.6.m6.1.1.3.cmml" xref="S2.I1.i2.p1.6.m6.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.6.m6.1c">M\leftarrow X</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.6.m6.1d">italic_M ← italic_X</annotation></semantics></math>.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S2.SS2.p1.15">By the Bayes Rule, the original likelihood can be written as:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P(Y\mid X)=" class="ltx_Math" display="inline" id="S2.E4X.2.1.1.m1.1"><semantics id="S2.E4X.2.1.1.m1.1a"><mrow id="S2.E4X.2.1.1.m1.1.1" xref="S2.E4X.2.1.1.m1.1.1.cmml"><mrow id="S2.E4X.2.1.1.m1.1.1.1" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mi id="S2.E4X.2.1.1.m1.1.1.1.3" mathcolor="#000000" xref="S2.E4X.2.1.1.m1.1.1.1.3.cmml">P</mi><mo id="S2.E4X.2.1.1.m1.1.1.1.2" xref="S2.E4X.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4X.2.1.1.m1.1.1.1.1.1" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E4X.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4X.2.1.1.m1.1.1.1.1.1.1" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E4X.2.1.1.m1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.2.cmml">Y</mi><mo id="S2.E4X.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.E4X.2.1.1.m1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S2.E4X.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4X.2.1.1.m1.1.1.2" xref="S2.E4X.2.1.1.m1.1.1.2.cmml">=</mo><mi id="S2.E4X.2.1.1.m1.1.1.3" xref="S2.E4X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E4X.2.1.1.m1.1b"><apply id="S2.E4X.2.1.1.m1.1.1.cmml" xref="S2.E4X.2.1.1.m1.1.1"><eq id="S2.E4X.2.1.1.m1.1.1.2.cmml" xref="S2.E4X.2.1.1.m1.1.1.2"></eq><apply id="S2.E4X.2.1.1.m1.1.1.1.cmml" xref="S2.E4X.2.1.1.m1.1.1.1"><times id="S2.E4X.2.1.1.m1.1.1.1.2.cmml" xref="S2.E4X.2.1.1.m1.1.1.1.2"></times><ci id="S2.E4X.2.1.1.m1.1.1.1.3.cmml" xref="S2.E4X.2.1.1.m1.1.1.1.3">𝑃</ci><apply id="S2.E4X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E4X.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E4X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.2">𝑌</ci><ci id="S2.E4X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E4X.2.1.1.m1.1.1.1.1.1.1.3">𝑋</ci></apply></apply><csymbol cd="latexml" id="S2.E4X.2.1.1.m1.1.1.3.cmml" xref="S2.E4X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4X.2.1.1.m1.1c">\displaystyle P(Y\mid X)=</annotation><annotation encoding="application/x-llamapun" id="S2.E4X.2.1.1.m1.1d">italic_P ( italic_Y ∣ italic_X ) =</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{m}P(M=m|X)\sum_{x}\underline{P(X=x|M=m)}[P(Y|M=m,X=x)]." class="ltx_Math" display="inline" id="S2.E4Xa.2.1.1.m1.2"><semantics id="S2.E4Xa.2.1.1.m1.2a"><mrow id="S2.E4Xa.2.1.1.m1.2.2.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S2.E4Xa.2.1.1.m1.2.2.1.1.3" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.3.cmml"><munder id="S2.E4Xa.2.1.1.m1.2.2.1.1.3a" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.3.cmml"><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.3.2" mathcolor="#000000" movablelimits="false" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.3.2.cmml">∑</mo><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.3.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.3.3.cmml">m</mi></munder></mstyle><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.4" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.4.cmml">P</mi><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">M</mi><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">m</mi><mo fence="false" id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.3a" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.cmml"><mstyle displaystyle="true" id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><munder id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2a" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.2" mathcolor="#000000" movablelimits="false" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.3.cmml">x</mi></munder></mstyle><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.cmml"><munder accentunder="true" id="S2.E4Xa.2.1.1.m1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.cmml"><mrow id="S2.E4Xa.2.1.1.m1.1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.1.1.1.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.1.3.cmml">P</mi><mo id="S2.E4Xa.2.1.1.m1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml">X</mi><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.cmml"><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.2" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.2.cmml">x</mi><mo fence="false" id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.1" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.1.cmml">|</mo><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.3.cmml">M</mi></mrow><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.5" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.5.cmml">=</mo><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.6" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.6.cmml">m</mi></mrow><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.1.1.2" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.1.1.2.cmml">¯</mo></munder><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.2" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.cmml"><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.3.cmml">P</mi><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3.cmml"><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">Y</mi><mo fence="false" id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">M</mi></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.1" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.2" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">X</mi><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.1" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.1.cmml">=</mo><mi id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.3" mathcolor="#000000" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">x</mi></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.1.2" lspace="0em" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4Xa.2.1.1.m1.2b"><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1"><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.1.1.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.3">subscript</csymbol><sum id="S2.E4Xa.2.1.1.m1.2.2.1.1.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.3.2"></sum><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.3.3">𝑚</ci></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2"><times id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.3"></times><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.4.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.4">𝑃</ci><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1"><eq id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1"></eq><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2">𝑀</ci><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3">𝑋</ci></apply></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2"><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2">subscript</csymbol><sum id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.2"></sum><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.2.3">𝑥</ci></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1"><times id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.2"></times><apply id="S2.E4Xa.2.1.1.m1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1"><ci id="S2.E4Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.2">¯</ci><apply id="S2.E4Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1"><times id="S2.E4Xa.2.1.1.m1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.2"></times><ci id="S2.E4Xa.2.1.1.m1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.3">𝑃</ci><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1"><and id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1a.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1"></and><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1b.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1"><eq id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.3"></eq><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.2">𝑋</ci><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4"><csymbol cd="latexml" id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.1">conditional</csymbol><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.2">𝑥</ci><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.3">𝑀</ci></apply></apply><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1c.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1"><eq id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.5.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2405.20626v1#S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.4.cmml" id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1d.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1"></share><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.6.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.6">𝑚</ci></apply></apply></apply></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1"><times id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.2"></times><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.3">𝑃</ci><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1"><eq id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑌</ci><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑀</ci></apply><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2"><eq id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.1"></eq><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.2">𝑋</ci><ci id="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4Xa.2.1.1.m1.2c">\displaystyle\sum_{m}P(M=m|X)\sum_{x}\underline{P(X=x|M=m)}[P(Y|M=m,X=x)].</annotation><annotation encoding="application/x-llamapun" id="S2.E4Xa.2.1.1.m1.2d">∑ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT italic_P ( italic_M = italic_m | italic_X ) ∑ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT under¯ start_ARG italic_P ( italic_X = italic_x | italic_M = italic_m ) end_ARG [ italic_P ( italic_Y | italic_M = italic_m , italic_X = italic_x ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.8">By adjusting <math alttext="X" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m1.1"><semantics id="S2.SS2.p1.8.m1.1a"><mi id="S2.SS2.p1.8.m1.1.1" xref="S2.SS2.p1.8.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m1.1b"><ci id="S2.SS2.p1.8.m1.1.1.cmml" xref="S2.SS2.p1.8.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m1.1d">italic_X</annotation></semantics></math>, FDA estimates the causal effects as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P(Y\mid do(X))=" class="ltx_Math" display="inline" id="S2.E5X.2.1.1.m1.2"><semantics id="S2.E5X.2.1.1.m1.2a"><mrow id="S2.E5X.2.1.1.m1.2.2" xref="S2.E5X.2.1.1.m1.2.2.cmml"><mrow id="S2.E5X.2.1.1.m1.2.2.1" xref="S2.E5X.2.1.1.m1.2.2.1.cmml"><mi id="S2.E5X.2.1.1.m1.2.2.1.3" mathcolor="#000000" xref="S2.E5X.2.1.1.m1.2.2.1.3.cmml">P</mi><mo id="S2.E5X.2.1.1.m1.2.2.1.2" xref="S2.E5X.2.1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E5X.2.1.1.m1.2.2.1.1.1" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.cmml"><mo id="S2.E5X.2.1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E5X.2.1.1.m1.2.2.1.1.1.1" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.cmml"><mi id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.2" mathcolor="#000000" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.2.cmml">Y</mi><mo id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.1" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.1.cmml">∣</mo><mrow id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.2" mathcolor="#000000" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.2.cmml">d</mi><mo id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.1" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.3" mathcolor="#000000" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.3.cmml">o</mi><mo id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.1a" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.4.2" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.cmml"><mo id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.4.2.1" stretchy="false" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.cmml">(</mo><mi id="S2.E5X.2.1.1.m1.1.1" mathcolor="#000000" xref="S2.E5X.2.1.1.m1.1.1.cmml">X</mi><mo id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.4.2.2" stretchy="false" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5X.2.1.1.m1.2.2.1.1.1.3" stretchy="false" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5X.2.1.1.m1.2.2.2" xref="S2.E5X.2.1.1.m1.2.2.2.cmml">=</mo><mi id="S2.E5X.2.1.1.m1.2.2.3" xref="S2.E5X.2.1.1.m1.2.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E5X.2.1.1.m1.2b"><apply id="S2.E5X.2.1.1.m1.2.2.cmml" xref="S2.E5X.2.1.1.m1.2.2"><eq id="S2.E5X.2.1.1.m1.2.2.2.cmml" xref="S2.E5X.2.1.1.m1.2.2.2"></eq><apply id="S2.E5X.2.1.1.m1.2.2.1.cmml" xref="S2.E5X.2.1.1.m1.2.2.1"><times id="S2.E5X.2.1.1.m1.2.2.1.2.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.2"></times><ci id="S2.E5X.2.1.1.m1.2.2.1.3.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.3">𝑃</ci><apply id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.2">𝑌</ci><apply id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3"><times id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.1"></times><ci id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.2">𝑑</ci><ci id="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.E5X.2.1.1.m1.2.2.1.1.1.1.3.3">𝑜</ci><ci id="S2.E5X.2.1.1.m1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1">𝑋</ci></apply></apply></apply><csymbol cd="latexml" id="S2.E5X.2.1.1.m1.2.2.3.cmml" xref="S2.E5X.2.1.1.m1.2.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.2.1.1.m1.2c">\displaystyle P(Y\mid do(X))=</annotation><annotation encoding="application/x-llamapun" id="S2.E5X.2.1.1.m1.2d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_X ) ) =</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{m}P(M=m\mid X)\sum_{x}\underline{P(X=x)}[P(Y\mid M=m,X=x)]." class="ltx_Math" display="inline" id="S2.E5Xa.2.1.1.m1.2"><semantics id="S2.E5Xa.2.1.1.m1.2a"><mrow id="S2.E5Xa.2.1.1.m1.2.2.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S2.E5Xa.2.1.1.m1.2.2.1.1.3" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.3.cmml"><munder id="S2.E5Xa.2.1.1.m1.2.2.1.1.3a" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.3.cmml"><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.3.2" mathcolor="#000000" movablelimits="false" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.3.2.cmml">∑</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.3.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.3.3.cmml">m</mi></munder></mstyle><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.4" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.4.cmml">P</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.3" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">M</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">m</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">∣</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.3a" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.cmml"><mstyle displaystyle="true" id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><munder id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2a" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2" mathcolor="#000000" movablelimits="false" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.3.cmml">x</mi></munder></mstyle><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.cmml"><munder accentunder="true" id="S2.E5Xa.2.1.1.m1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.cmml"><mrow id="S2.E5Xa.2.1.1.m1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.1.1.1.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.1.1.1.3.cmml">P</mi><mo id="S2.E5Xa.2.1.1.m1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xa.2.1.1.m1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml">X</mi><mo id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.1" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.1.1.2" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.1.1.2.cmml">¯</mo></munder><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.2" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.cmml"><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.3.cmml">P</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3.cmml"><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">∣</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">M</mi></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.1" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.2" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">X</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.1" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.1.cmml">=</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.3" mathcolor="#000000" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">x</mi></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.1.2" lspace="0em" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xa.2.1.1.m1.2b"><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1"><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.1.1.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.3">subscript</csymbol><sum id="S2.E5Xa.2.1.1.m1.2.2.1.1.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.3.2"></sum><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.3.3">𝑚</ci></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2"><times id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.3"></times><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.4.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.4">𝑃</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1"><eq id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1"></eq><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2">𝑀</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3">𝑋</ci></apply></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2"><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2">subscript</csymbol><sum id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.2"></sum><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.2.3">𝑥</ci></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1"><times id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.2"></times><apply id="S2.E5Xa.2.1.1.m1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1"><ci id="S2.E5Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.2">¯</ci><apply id="S2.E5Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1"><times id="S2.E5Xa.2.1.1.m1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.2"></times><ci id="S2.E5Xa.2.1.1.m1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.3">𝑃</ci><apply id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1"><eq id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.1"></eq><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1"><times id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.2"></times><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.3">𝑃</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1"><eq id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑌</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑀</ci></apply><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2"><eq id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.1"></eq><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.2">𝑋</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2.2.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xa.2.1.1.m1.2c">\displaystyle\sum_{m}P(M=m\mid X)\sum_{x}\underline{P(X=x)}[P(Y\mid M=m,X=x)].</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xa.2.1.1.m1.2d">∑ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT italic_P ( italic_M = italic_m ∣ italic_X ) ∑ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT under¯ start_ARG italic_P ( italic_X = italic_x ) end_ARG [ italic_P ( italic_Y ∣ italic_M = italic_m , italic_X = italic_x ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.13">For brevity, we omit the transition details which share similar spirits to Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E2" title="In 2.1 Back-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">2</span></a>). In essence, after adjustment, <math alttext="M" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m1.1"><semantics id="S2.SS2.p1.9.m1.1a"><mi id="S2.SS2.p1.9.m1.1.1" xref="S2.SS2.p1.9.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m1.1b"><ci id="S2.SS2.p1.9.m1.1.1.cmml" xref="S2.SS2.p1.9.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m1.1d">italic_M</annotation></semantics></math> becomes independent of <math alttext="X" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m2.1"><semantics id="S2.SS2.p1.10.m2.1a"><mi id="S2.SS2.p1.10.m2.1.1" xref="S2.SS2.p1.10.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m2.1b"><ci id="S2.SS2.p1.10.m2.1.1.cmml" xref="S2.SS2.p1.10.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m2.1d">italic_X</annotation></semantics></math> and <math alttext="P(X=x\mid do(M=m))=P(X=x)" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m3.2"><semantics id="S2.SS2.p1.11.m3.2a"><mrow id="S2.SS2.p1.11.m3.2.2" xref="S2.SS2.p1.11.m3.2.2.cmml"><mrow id="S2.SS2.p1.11.m3.1.1.1" xref="S2.SS2.p1.11.m3.1.1.1.cmml"><mi id="S2.SS2.p1.11.m3.1.1.1.3" xref="S2.SS2.p1.11.m3.1.1.1.3.cmml">P</mi><mo id="S2.SS2.p1.11.m3.1.1.1.2" xref="S2.SS2.p1.11.m3.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.11.m3.1.1.1.1.1" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.11.m3.1.1.1.1.1.1" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.11.m3.1.1.1.1.1.1.3" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.3.cmml">X</mi><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.1.2" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.3.cmml">x</mi><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.3.cmml">d</mi><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.4" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.4.cmml">o</mi><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.2a" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">M</mi><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.SS2.p1.11.m3.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.11.m3.2.2.3" xref="S2.SS2.p1.11.m3.2.2.3.cmml">=</mo><mrow id="S2.SS2.p1.11.m3.2.2.2" xref="S2.SS2.p1.11.m3.2.2.2.cmml"><mi id="S2.SS2.p1.11.m3.2.2.2.3" xref="S2.SS2.p1.11.m3.2.2.2.3.cmml">P</mi><mo id="S2.SS2.p1.11.m3.2.2.2.2" xref="S2.SS2.p1.11.m3.2.2.2.2.cmml">⁢</mo><mrow id="S2.SS2.p1.11.m3.2.2.2.1.1" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.cmml"><mo id="S2.SS2.p1.11.m3.2.2.2.1.1.2" stretchy="false" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.11.m3.2.2.2.1.1.1" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.11.m3.2.2.2.1.1.1.2" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.2.cmml">X</mi><mo id="S2.SS2.p1.11.m3.2.2.2.1.1.1.1" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.1.cmml">=</mo><mi id="S2.SS2.p1.11.m3.2.2.2.1.1.1.3" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS2.p1.11.m3.2.2.2.1.1.3" stretchy="false" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m3.2b"><apply id="S2.SS2.p1.11.m3.2.2.cmml" xref="S2.SS2.p1.11.m3.2.2"><eq id="S2.SS2.p1.11.m3.2.2.3.cmml" xref="S2.SS2.p1.11.m3.2.2.3"></eq><apply id="S2.SS2.p1.11.m3.1.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1.1"><times id="S2.SS2.p1.11.m3.1.1.1.2.cmml" xref="S2.SS2.p1.11.m3.1.1.1.2"></times><ci id="S2.SS2.p1.11.m3.1.1.1.3.cmml" xref="S2.SS2.p1.11.m3.1.1.1.3">𝑃</ci><apply id="S2.SS2.p1.11.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1"><eq id="S2.SS2.p1.11.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.2"></eq><ci id="S2.SS2.p1.11.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.3">𝑋</ci><apply id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.3">𝑥</ci><apply id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1"><times id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.2"></times><ci id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.3">𝑑</ci><ci id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.4.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.4">𝑜</ci><apply id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1"><eq id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.1"></eq><ci id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.11.m3.1.1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></apply><apply id="S2.SS2.p1.11.m3.2.2.2.cmml" xref="S2.SS2.p1.11.m3.2.2.2"><times id="S2.SS2.p1.11.m3.2.2.2.2.cmml" xref="S2.SS2.p1.11.m3.2.2.2.2"></times><ci id="S2.SS2.p1.11.m3.2.2.2.3.cmml" xref="S2.SS2.p1.11.m3.2.2.2.3">𝑃</ci><apply id="S2.SS2.p1.11.m3.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.11.m3.2.2.2.1.1"><eq id="S2.SS2.p1.11.m3.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.1"></eq><ci id="S2.SS2.p1.11.m3.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.2">𝑋</ci><ci id="S2.SS2.p1.11.m3.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.11.m3.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m3.2c">P(X=x\mid do(M=m))=P(X=x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m3.2d">italic_P ( italic_X = italic_x ∣ italic_d italic_o ( italic_M = italic_m ) ) = italic_P ( italic_X = italic_x )</annotation></semantics></math>, thus blocking the path <math alttext="Y\leftarrow U\rightarrow X\rightarrow M" class="ltx_Math" display="inline" id="S2.SS2.p1.12.m4.1"><semantics id="S2.SS2.p1.12.m4.1a"><mrow id="S2.SS2.p1.12.m4.1.1" xref="S2.SS2.p1.12.m4.1.1.cmml"><mi id="S2.SS2.p1.12.m4.1.1.2" xref="S2.SS2.p1.12.m4.1.1.2.cmml">Y</mi><mo id="S2.SS2.p1.12.m4.1.1.3" stretchy="false" xref="S2.SS2.p1.12.m4.1.1.3.cmml">←</mo><mi id="S2.SS2.p1.12.m4.1.1.4" xref="S2.SS2.p1.12.m4.1.1.4.cmml">U</mi><mo id="S2.SS2.p1.12.m4.1.1.5" stretchy="false" xref="S2.SS2.p1.12.m4.1.1.5.cmml">→</mo><mi id="S2.SS2.p1.12.m4.1.1.6" xref="S2.SS2.p1.12.m4.1.1.6.cmml">X</mi><mo id="S2.SS2.p1.12.m4.1.1.7" stretchy="false" xref="S2.SS2.p1.12.m4.1.1.7.cmml">→</mo><mi id="S2.SS2.p1.12.m4.1.1.8" xref="S2.SS2.p1.12.m4.1.1.8.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m4.1b"><apply id="S2.SS2.p1.12.m4.1.1.cmml" xref="S2.SS2.p1.12.m4.1.1"><and id="S2.SS2.p1.12.m4.1.1a.cmml" xref="S2.SS2.p1.12.m4.1.1"></and><apply id="S2.SS2.p1.12.m4.1.1b.cmml" xref="S2.SS2.p1.12.m4.1.1"><ci id="S2.SS2.p1.12.m4.1.1.3.cmml" xref="S2.SS2.p1.12.m4.1.1.3">←</ci><ci id="S2.SS2.p1.12.m4.1.1.2.cmml" xref="S2.SS2.p1.12.m4.1.1.2">𝑌</ci><ci id="S2.SS2.p1.12.m4.1.1.4.cmml" xref="S2.SS2.p1.12.m4.1.1.4">𝑈</ci></apply><apply id="S2.SS2.p1.12.m4.1.1c.cmml" xref="S2.SS2.p1.12.m4.1.1"><ci id="S2.SS2.p1.12.m4.1.1.5.cmml" xref="S2.SS2.p1.12.m4.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S2.SS2.p1.12.m4.1.1.4.cmml" id="S2.SS2.p1.12.m4.1.1d.cmml" xref="S2.SS2.p1.12.m4.1.1"></share><ci id="S2.SS2.p1.12.m4.1.1.6.cmml" xref="S2.SS2.p1.12.m4.1.1.6">𝑋</ci></apply><apply id="S2.SS2.p1.12.m4.1.1e.cmml" xref="S2.SS2.p1.12.m4.1.1"><ci id="S2.SS2.p1.12.m4.1.1.7.cmml" xref="S2.SS2.p1.12.m4.1.1.7">→</ci><share href="https://arxiv.org/html/2405.20626v1#S2.SS2.p1.12.m4.1.1.6.cmml" id="S2.SS2.p1.12.m4.1.1f.cmml" xref="S2.SS2.p1.12.m4.1.1"></share><ci id="S2.SS2.p1.12.m4.1.1.8.cmml" xref="S2.SS2.p1.12.m4.1.1.8">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m4.1c">Y\leftarrow U\rightarrow X\rightarrow M</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.12.m4.1d">italic_Y ← italic_U → italic_X → italic_M</annotation></semantics></math>. More details of FDA can be found in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib10" title="">10</a>]</cite>. To use FDA, a proper <math alttext="M" class="ltx_Math" display="inline" id="S2.SS2.p1.13.m5.1"><semantics id="S2.SS2.p1.13.m5.1a"><mi id="S2.SS2.p1.13.m5.1.1" xref="S2.SS2.p1.13.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m5.1b"><ci id="S2.SS2.p1.13.m5.1.1.cmml" xref="S2.SS2.p1.13.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.13.m5.1d">italic_M</annotation></semantics></math> should satisfy the following three requirements:</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<ol class="ltx_enumerate" id="S2.I2">
<li class="ltx_item" id="S2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(i)</span>
<div class="ltx_para" id="S2.I2.i1.p1">
<p class="ltx_p" id="S2.I2.i1.p1.3"><math alttext="M" class="ltx_Math" display="inline" id="S2.I2.i1.p1.1.m1.1"><semantics id="S2.I2.i1.p1.1.m1.1a"><mi id="S2.I2.i1.p1.1.m1.1.1" xref="S2.I2.i1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i1.p1.1.m1.1b"><ci id="S2.I2.i1.p1.1.m1.1.1.cmml" xref="S2.I2.i1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i1.p1.1.m1.1d">italic_M</annotation></semantics></math> intercepts all directed paths from <math alttext="X" class="ltx_Math" display="inline" id="S2.I2.i1.p1.2.m2.1"><semantics id="S2.I2.i1.p1.2.m2.1a"><mi id="S2.I2.i1.p1.2.m2.1.1" xref="S2.I2.i1.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i1.p1.2.m2.1b"><ci id="S2.I2.i1.p1.2.m2.1.1.cmml" xref="S2.I2.i1.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i1.p1.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i1.p1.2.m2.1d">italic_X</annotation></semantics></math> to <math alttext="Y" class="ltx_Math" display="inline" id="S2.I2.i1.p1.3.m3.1"><semantics id="S2.I2.i1.p1.3.m3.1a"><mi id="S2.I2.i1.p1.3.m3.1.1" xref="S2.I2.i1.p1.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i1.p1.3.m3.1b"><ci id="S2.I2.i1.p1.3.m3.1.1.cmml" xref="S2.I2.i1.p1.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i1.p1.3.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i1.p1.3.m3.1d">italic_Y</annotation></semantics></math>;</p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(ii)</span>
<div class="ltx_para" id="S2.I2.i2.p1">
<p class="ltx_p" id="S2.I2.i2.p1.2">there is no unblocked back-door path from <math alttext="X" class="ltx_Math" display="inline" id="S2.I2.i2.p1.1.m1.1"><semantics id="S2.I2.i2.p1.1.m1.1a"><mi id="S2.I2.i2.p1.1.m1.1.1" xref="S2.I2.i2.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i2.p1.1.m1.1b"><ci id="S2.I2.i2.p1.1.m1.1.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i2.p1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i2.p1.1.m1.1d">italic_X</annotation></semantics></math> to <math alttext="M" class="ltx_Math" display="inline" id="S2.I2.i2.p1.2.m2.1"><semantics id="S2.I2.i2.p1.2.m2.1a"><mi id="S2.I2.i2.p1.2.m2.1.1" xref="S2.I2.i2.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i2.p1.2.m2.1b"><ci id="S2.I2.i2.p1.2.m2.1.1.cmml" xref="S2.I2.i2.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i2.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i2.p1.2.m2.1d">italic_M</annotation></semantics></math>;</p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(iii)</span>
<div class="ltx_para" id="S2.I2.i3.p1">
<p class="ltx_p" id="S2.I2.i3.p1.3">all back-door paths from <math alttext="M" class="ltx_Math" display="inline" id="S2.I2.i3.p1.1.m1.1"><semantics id="S2.I2.i3.p1.1.m1.1a"><mi id="S2.I2.i3.p1.1.m1.1.1" xref="S2.I2.i3.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i3.p1.1.m1.1b"><ci id="S2.I2.i3.p1.1.m1.1.1.cmml" xref="S2.I2.i3.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i3.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i3.p1.1.m1.1d">italic_M</annotation></semantics></math> to <math alttext="Y" class="ltx_Math" display="inline" id="S2.I2.i3.p1.2.m2.1"><semantics id="S2.I2.i3.p1.2.m2.1a"><mi id="S2.I2.i3.p1.2.m2.1.1" xref="S2.I2.i3.p1.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i3.p1.2.m2.1b"><ci id="S2.I2.i3.p1.2.m2.1.1.cmml" xref="S2.I2.i3.p1.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i3.p1.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i3.p1.2.m2.1d">italic_Y</annotation></semantics></math> are blocked by <math alttext="X" class="ltx_Math" display="inline" id="S2.I2.i3.p1.3.m3.1"><semantics id="S2.I2.i3.p1.3.m3.1a"><mi id="S2.I2.i3.p1.3.m3.1.1" xref="S2.I2.i3.p1.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i3.p1.3.m3.1b"><ci id="S2.I2.i3.p1.3.m3.1.1.cmml" xref="S2.I2.i3.p1.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i3.p1.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i3.p1.3.m3.1d">italic_X</annotation></semantics></math>.</p>
</div>
</li>
</ol>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Method</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span class="ltx_text ltx_font_italic" id="S3.SS1.1.1">Problem Formulation</span>
</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.7"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.7.1">Recommendation. </span> A recommendation dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_D</annotation></semantics></math> contains user-item interaction records <math alttext="\{(x_{i},y_{i},o_{i})\}_{i=1,\dots,|\mathcal{D}|}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.5"><semantics id="S3.SS1.p1.2.m2.5a"><msub id="S3.SS1.p1.2.m2.5.5" xref="S3.SS1.p1.2.m2.5.5.cmml"><mrow id="S3.SS1.p1.2.m2.5.5.1.1" xref="S3.SS1.p1.2.m2.5.5.1.2.cmml"><mo id="S3.SS1.p1.2.m2.5.5.1.1.2" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.1.2.cmml">{</mo><mrow id="S3.SS1.p1.2.m2.5.5.1.1.1.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.4.cmml"><mo id="S3.SS1.p1.2.m2.5.5.1.1.1.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.1.1.1.4.cmml">(</mo><msub id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.5.5.1.1.1.3.5" xref="S3.SS1.p1.2.m2.5.5.1.1.1.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.1.1.1.2.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.5.5.1.1.1.3.6" xref="S3.SS1.p1.2.m2.5.5.1.1.1.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.2.cmml">o</mi><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.5.5.1.1.1.3.7" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.1.1.1.4.cmml">)</mo></mrow><mo id="S3.SS1.p1.2.m2.5.5.1.1.3" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.2.m2.4.4.4" xref="S3.SS1.p1.2.m2.4.4.4.cmml"><mi id="S3.SS1.p1.2.m2.4.4.4.6" xref="S3.SS1.p1.2.m2.4.4.4.6.cmml">i</mi><mo id="S3.SS1.p1.2.m2.4.4.4.5" xref="S3.SS1.p1.2.m2.4.4.4.5.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.4.4.4.4.1" xref="S3.SS1.p1.2.m2.4.4.4.4.2.cmml"><mn id="S3.SS1.p1.2.m2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.cmml">1</mn><mo id="S3.SS1.p1.2.m2.4.4.4.4.1.2" xref="S3.SS1.p1.2.m2.4.4.4.4.2.cmml">,</mo><mi id="S3.SS1.p1.2.m2.3.3.3.3" mathvariant="normal" xref="S3.SS1.p1.2.m2.3.3.3.3.cmml">…</mi><mo id="S3.SS1.p1.2.m2.4.4.4.4.1.3" xref="S3.SS1.p1.2.m2.4.4.4.4.2.cmml">,</mo><mrow id="S3.SS1.p1.2.m2.4.4.4.4.1.1.2" xref="S3.SS1.p1.2.m2.4.4.4.4.1.1.1.cmml"><mo id="S3.SS1.p1.2.m2.4.4.4.4.1.1.2.1" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.4.4.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.1.1" mathcolor="#000000" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">𝒟</mi><mo id="S3.SS1.p1.2.m2.4.4.4.4.1.1.2.2" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.4.4.1.1.1.1.cmml">|</mo></mrow></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><apply id="S3.SS1.p1.2.m2.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.2.cmml" xref="S3.SS1.p1.2.m2.5.5">subscript</csymbol><set id="S3.SS1.p1.2.m2.5.5.1.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1"><vector id="S3.SS1.p1.2.m2.5.5.1.1.1.4.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3"><apply id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.2">𝑜</ci><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.3">𝑖</ci></apply></vector></set><apply id="S3.SS1.p1.2.m2.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.4"><eq id="S3.SS1.p1.2.m2.4.4.4.5.cmml" xref="S3.SS1.p1.2.m2.4.4.4.5"></eq><ci id="S3.SS1.p1.2.m2.4.4.4.6.cmml" xref="S3.SS1.p1.2.m2.4.4.4.6">𝑖</ci><list id="S3.SS1.p1.2.m2.4.4.4.4.2.cmml" xref="S3.SS1.p1.2.m2.4.4.4.4.1"><cn id="S3.SS1.p1.2.m2.2.2.2.2.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.2.2">1</cn><ci id="S3.SS1.p1.2.m2.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.3.3">…</ci><apply id="S3.SS1.p1.2.m2.4.4.4.4.1.1.1.cmml" xref="S3.SS1.p1.2.m2.4.4.4.4.1.1.2"><abs id="S3.SS1.p1.2.m2.4.4.4.4.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.4.4.4.4.1.1.2.1"></abs><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝒟</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">\{(x_{i},y_{i},o_{i})\}_{i=1,\dots,|\mathcal{D}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.5d">{ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 , … , | caligraphic_D | end_POSTSUBSCRIPT</annotation></semantics></math> logged in a recommender system. <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑥</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the user data such as user ID and user historical behaviors. <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑦</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the item data such as item ID. <math alttext="o_{i}\in\{0,1\}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.2"><semantics id="S3.SS1.p1.5.m5.2a"><mrow id="S3.SS1.p1.5.m5.2.3" xref="S3.SS1.p1.5.m5.2.3.cmml"><msub id="S3.SS1.p1.5.m5.2.3.2" xref="S3.SS1.p1.5.m5.2.3.2.cmml"><mi id="S3.SS1.p1.5.m5.2.3.2.2" xref="S3.SS1.p1.5.m5.2.3.2.2.cmml">o</mi><mi id="S3.SS1.p1.5.m5.2.3.2.3" xref="S3.SS1.p1.5.m5.2.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.5.m5.2.3.1" xref="S3.SS1.p1.5.m5.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.5.m5.2.3.3.2" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml"><mo id="S3.SS1.p1.5.m5.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">{</mo><mn id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">0</mn><mo id="S3.SS1.p1.5.m5.2.3.3.2.2" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.5.m5.2.2" xref="S3.SS1.p1.5.m5.2.2.cmml">1</mn><mo id="S3.SS1.p1.5.m5.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.2b"><apply id="S3.SS1.p1.5.m5.2.3.cmml" xref="S3.SS1.p1.5.m5.2.3"><in id="S3.SS1.p1.5.m5.2.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.1"></in><apply id="S3.SS1.p1.5.m5.2.3.2.cmml" xref="S3.SS1.p1.5.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.3.2.1.cmml" xref="S3.SS1.p1.5.m5.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.2.3.2.2.cmml" xref="S3.SS1.p1.5.m5.2.3.2.2">𝑜</ci><ci id="S3.SS1.p1.5.m5.2.3.2.3.cmml" xref="S3.SS1.p1.5.m5.2.3.2.3">𝑖</ci></apply><set id="S3.SS1.p1.5.m5.2.3.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.3.2"><cn id="S3.SS1.p1.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p1.5.m5.1.1">0</cn><cn id="S3.SS1.p1.5.m5.2.2.cmml" type="integer" xref="S3.SS1.p1.5.m5.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.2c">o_{i}\in\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.2d">italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { 0 , 1 }</annotation></semantics></math> is a binary factor indicating whether the user has interacted with the item. Given user data <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_x</annotation></semantics></math> and item data <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_y</annotation></semantics></math>, a recommendation model is learned to predict how likely the user will interact with the item, and the prediction score is used for candidate item ranking. Top-ranked items will appear in the recommendation list and are sorted according to the ranking scores.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.2">Performance Heterogeneity.<span class="ltx_text" id="S3.SS1.p2.1.2.1"> </span></span> <span class="ltx_text" id="S3.SS1.p2.1.1">We define the total performance heterogeneity as the standard deviation of recommendation performances on different user groups’ datasets <math alttext="\{\mathcal{D}_{e}\}_{e\in\mathcal{E}}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.1.m1.1"><semantics id="S3.SS1.p2.1.1.m1.1a"><msub id="S3.SS1.p2.1.1.m1.1.1" xref="S3.SS1.p2.1.1.m1.1.1.cmml"><mrow id="S3.SS1.p2.1.1.m1.1.1.1.1" xref="S3.SS1.p2.1.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p2.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.1.1.m1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.1.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.1.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.1.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.1.m1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.SS1.p2.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.1.1.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.1.1.m1.1.1.3" xref="S3.SS1.p2.1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.1.m1.1.1.3.2" xref="S3.SS1.p2.1.1.m1.1.1.3.2.cmml">e</mi><mo id="S3.SS1.p2.1.1.m1.1.1.3.1" xref="S3.SS1.p2.1.1.m1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.1.m1.1.1.3.3" mathcolor="#000000" xref="S3.SS1.p2.1.1.m1.1.1.3.3.cmml">ℰ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.1.m1.1b"><apply id="S3.SS1.p2.1.1.m1.1.1.cmml" xref="S3.SS1.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.1.m1.1.1">subscript</csymbol><set id="S3.SS1.p2.1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p2.1.1.m1.1.1.1.1"><apply id="S3.SS1.p2.1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.1.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.SS1.p2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.1.m1.1.1.1.1.1.3">𝑒</ci></apply></set><apply id="S3.SS1.p2.1.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.1.m1.1.1.3"><in id="S3.SS1.p2.1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.1.m1.1.1.3.1"></in><ci id="S3.SS1.p2.1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.1.m1.1.1.3.2">𝑒</ci><ci id="S3.SS1.p2.1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.1.m1.1.1.3.3">ℰ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.1.m1.1c">\{\mathcal{D}_{e}\}_{e\in\mathcal{E}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.1.m1.1d">{ caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_e ∈ caligraphic_E end_POSTSUBSCRIPT</annotation></semantics></math> under <span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS1.p2.1.1.1" style="color:#000000;">unified training</span>, <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.1.1.2">i</span>.<span class="ltx_text ltx_font_italic" id="S3.SS1.p2.1.1.3">e</span>., <span class="ltx_text" id="S3.SS1.p2.1.1.4"></span></span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx3">
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}%
S_{h}=\sqrt{\frac{1}{|\mathcal{E}|-1}\sum_{e\in\mathcal{E}}(S(\mathcal{D}_{e})%
-{\bar{S}})^{2}}," class="ltx_Math" display="inline" id="S3.E6.m1.3"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2" mathcolor="#000000" xref="S3.E6.m1.3.3.1.1.2.2.cmml">S</mi><mi id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml">h</mi></msub><mo id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml">=</mo><msqrt id="S3.E6.m1.2.2" mathcolor="#000000" xref="S3.E6.m1.2.2.cmml"><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mfrac id="S3.E6.m1.1.1.1.1a" mathcolor="#000000" xref="S3.E6.m1.1.1.1.1.cmml"><mn id="S3.E6.m1.1.1.1.1.3" mathcolor="#000000" xref="S3.E6.m1.1.1.1.1.3.cmml">1</mn><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.3.2.1" mathcolor="#000000" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.1" mathcolor="#000000" xref="S3.E6.m1.1.1.1.1.1.1.cmml">ℰ</mi><mo id="S3.E6.m1.1.1.1.1.1.3.2.2" mathcolor="#000000" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.E6.m1.1.1.1.1.1.2" mathcolor="#000000" xref="S3.E6.m1.1.1.1.1.1.2.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.1.4" mathcolor="#000000" xref="S3.E6.m1.1.1.1.1.1.4.cmml">1</mn></mrow></mfrac></mstyle><mo id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E6.m1.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.cmml"><munder id="S3.E6.m1.2.2.2.2.2a" xref="S3.E6.m1.2.2.2.2.2.cmml"><mo id="S3.E6.m1.2.2.2.2.2.2" mathcolor="#000000" movablelimits="false" xref="S3.E6.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.2.2.2.2.2.3" xref="S3.E6.m1.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.2.2.2.2.2.3.2" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.2.3.2.cmml">e</mi><mo id="S3.E6.m1.2.2.2.2.2.3.1" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.2.2.3.3" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.2.3.3.cmml">ℰ</mi></mrow></munder></mstyle><msup id="S3.E6.m1.2.2.2.2.1" xref="S3.E6.m1.2.2.2.2.1.cmml"><mrow id="S3.E6.m1.2.2.2.2.1.1.1" xref="S3.E6.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E6.m1.2.2.2.2.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S3.E6.m1.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.2.2.1.1.1.1" xref="S3.E6.m1.2.2.2.2.1.1.1.1.cmml"><mrow id="S3.E6.m1.2.2.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.cmml">S</mi><mo id="S3.E6.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.2.2.2.2.1.1.1.1.2" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.1.1.1.1.2.cmml">−</mo><mover accent="true" id="S3.E6.m1.2.2.2.2.1.1.1.1.3" xref="S3.E6.m1.2.2.2.2.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.2.2.1.1.1.1.3.2" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.1.1.1.1.3.2.cmml">S</mi><mo id="S3.E6.m1.2.2.2.2.1.1.1.1.3.1" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S3.E6.m1.2.2.2.2.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S3.E6.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E6.m1.2.2.2.2.1.3" mathcolor="#000000" xref="S3.E6.m1.2.2.2.2.1.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><mo id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"></eq><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2">𝑆</ci><ci id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3">ℎ</ci></apply><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><root id="S3.E6.m1.2.2a.cmml" xref="S3.E6.m1.2.2"></root><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><times id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3"></times><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><divide id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1"></divide><cn id="S3.E6.m1.1.1.1.1.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.3">1</cn><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><minus id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></minus><apply id="S3.E6.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2"><abs id="S3.E6.m1.1.1.1.1.1.3.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1"></abs><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">ℰ</ci></apply><cn id="S3.E6.m1.1.1.1.1.1.4.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.4">1</cn></apply></apply><apply id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2"><apply id="S3.E6.m1.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.2">subscript</csymbol><sum id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2"></sum><apply id="S3.E6.m1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.3"><in id="S3.E6.m1.2.2.2.2.2.3.1.cmml" xref="S3.E6.m1.2.2.2.2.2.3.1"></in><ci id="S3.E6.m1.2.2.2.2.2.3.2.cmml" xref="S3.E6.m1.2.2.2.2.2.3.2">𝑒</ci><ci id="S3.E6.m1.2.2.2.2.2.3.3.cmml" xref="S3.E6.m1.2.2.2.2.2.3.3">ℰ</ci></apply></apply><apply id="S3.E6.m1.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.1.2.cmml" xref="S3.E6.m1.2.2.2.2.1">superscript</csymbol><apply id="S3.E6.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1"><minus id="S3.E6.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.2"></minus><apply id="S3.E6.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1"><times id="S3.E6.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.2"></times><ci id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3">𝑆</ci><apply id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.1.1.3">𝑒</ci></apply></apply><apply id="S3.E6.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.3"><ci id="S3.E6.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.3.1">¯</ci><ci id="S3.E6.m1.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.3.2">𝑆</ci></apply></apply><cn id="S3.E6.m1.2.2.2.2.1.3.cmml" type="integer" xref="S3.E6.m1.2.2.2.2.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\displaystyle\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}%
S_{h}=\sqrt{\frac{1}{|\mathcal{E}|-1}\sum_{e\in\mathcal{E}}(S(\mathcal{D}_{e})%
-{\bar{S}})^{2}},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.3d">italic_S start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = square-root start_ARG divide start_ARG 1 end_ARG start_ARG | caligraphic_E | - 1 end_ARG ∑ start_POSTSUBSCRIPT italic_e ∈ caligraphic_E end_POSTSUBSCRIPT ( italic_S ( caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ) - over¯ start_ARG italic_S end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.5"><span class="ltx_text" id="S3.SS1.p2.5.4">where <math alttext="S(\mathcal{D}^{e})" class="ltx_Math" display="inline" id="S3.SS1.p2.2.1.m1.1"><semantics id="S3.SS1.p2.2.1.m1.1a"><mrow id="S3.SS1.p2.2.1.m1.1.1" xref="S3.SS1.p2.2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.2.1.m1.1.1.3" xref="S3.SS1.p2.2.1.m1.1.1.3.cmml">S</mi><mo id="S3.SS1.p2.2.1.m1.1.1.2" xref="S3.SS1.p2.2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.2.1.m1.1.1.1.1" xref="S3.SS1.p2.2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.2.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS1.p2.2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.2.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.2.1.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.2.1.m1.1.1.1.1.1.3.cmml">e</mi></msup><mo id="S3.SS1.p2.2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.1.m1.1b"><apply id="S3.SS1.p2.2.1.m1.1.1.cmml" xref="S3.SS1.p2.2.1.m1.1.1"><times id="S3.SS1.p2.2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.2.1.m1.1.1.2"></times><ci id="S3.SS1.p2.2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.2.1.m1.1.1.3">𝑆</ci><apply id="S3.SS1.p2.2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.1.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.SS1.p2.2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.1.m1.1.1.1.1.1.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.1.m1.1c">S(\mathcal{D}^{e})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.1.m1.1d">italic_S ( caligraphic_D start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT )</annotation></semantics></math> denotes the recommendation performance on the <math alttext="\mathcal{D}^{e}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.2.m2.1"><semantics id="S3.SS1.p2.3.2.m2.1a"><msup id="S3.SS1.p2.3.2.m2.1.1" xref="S3.SS1.p2.3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.2.m2.1.1.2" xref="S3.SS1.p2.3.2.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.3.2.m2.1.1.3" xref="S3.SS1.p2.3.2.m2.1.1.3.cmml">e</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.2.m2.1b"><apply id="S3.SS1.p2.3.2.m2.1.1.cmml" xref="S3.SS1.p2.3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.2.m2.1.1.1.cmml" xref="S3.SS1.p2.3.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p2.3.2.m2.1.1.2.cmml" xref="S3.SS1.p2.3.2.m2.1.1.2">𝒟</ci><ci id="S3.SS1.p2.3.2.m2.1.1.3.cmml" xref="S3.SS1.p2.3.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.2.m2.1c">\mathcal{D}^{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.2.m2.1d">caligraphic_D start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT</annotation></semantics></math> dataset and <math alttext="{\bar{S}}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.3.m3.1"><semantics id="S3.SS1.p2.4.3.m3.1a"><mover accent="true" id="S3.SS1.p2.4.3.m3.1.1" xref="S3.SS1.p2.4.3.m3.1.1.cmml"><mi id="S3.SS1.p2.4.3.m3.1.1.2" xref="S3.SS1.p2.4.3.m3.1.1.2.cmml">S</mi><mo id="S3.SS1.p2.4.3.m3.1.1.1" xref="S3.SS1.p2.4.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.3.m3.1b"><apply id="S3.SS1.p2.4.3.m3.1.1.cmml" xref="S3.SS1.p2.4.3.m3.1.1"><ci id="S3.SS1.p2.4.3.m3.1.1.1.cmml" xref="S3.SS1.p2.4.3.m3.1.1.1">¯</ci><ci id="S3.SS1.p2.4.3.m3.1.1.2.cmml" xref="S3.SS1.p2.4.3.m3.1.1.2">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.3.m3.1c">{\bar{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.3.m3.1d">over¯ start_ARG italic_S end_ARG</annotation></semantics></math> denotes the average performance on all datasets. Such performance heterogeneity includes the natural heterogeneity due to data imbalance across user groups, and the model bias that amplifies the natural heterogeneity and hurts the performance of unprivileged user groups. We define the natural performance heterogeneity as the standard deviation of recommendation performances on different user groups’ datasets under <span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS1.p2.5.4.1" style="color:#000000;">group-wise training</span>. Specifically, we independently train and evaluate one model per group where the performance is denoted as <math alttext="S^{*}(\mathcal{D}_{e})" class="ltx_Math" display="inline" id="S3.SS1.p2.5.4.m4.1"><semantics id="S3.SS1.p2.5.4.m4.1a"><mrow id="S3.SS1.p2.5.4.m4.1.1" xref="S3.SS1.p2.5.4.m4.1.1.cmml"><msup id="S3.SS1.p2.5.4.m4.1.1.3" xref="S3.SS1.p2.5.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.5.4.m4.1.1.3.2" xref="S3.SS1.p2.5.4.m4.1.1.3.2.cmml">S</mi><mo id="S3.SS1.p2.5.4.m4.1.1.3.3" xref="S3.SS1.p2.5.4.m4.1.1.3.3.cmml">∗</mo></msup><mo id="S3.SS1.p2.5.4.m4.1.1.2" xref="S3.SS1.p2.5.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.5.4.m4.1.1.1.1" xref="S3.SS1.p2.5.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.5.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.5.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.5.4.m4.1.1.1.1.1" xref="S3.SS1.p2.5.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.4.m4.1.1.1.1.1.2" xref="S3.SS1.p2.5.4.m4.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.5.4.m4.1.1.1.1.1.3" xref="S3.SS1.p2.5.4.m4.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.SS1.p2.5.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.5.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.4.m4.1b"><apply id="S3.SS1.p2.5.4.m4.1.1.cmml" xref="S3.SS1.p2.5.4.m4.1.1"><times id="S3.SS1.p2.5.4.m4.1.1.2.cmml" xref="S3.SS1.p2.5.4.m4.1.1.2"></times><apply id="S3.SS1.p2.5.4.m4.1.1.3.cmml" xref="S3.SS1.p2.5.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.5.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.5.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.5.4.m4.1.1.3.2">𝑆</ci><times id="S3.SS1.p2.5.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.5.4.m4.1.1.3.3"></times></apply><apply id="S3.SS1.p2.5.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.5.4.m4.1.1.1.1.1.2">𝒟</ci><ci id="S3.SS1.p2.5.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.5.4.m4.1.1.1.1.1.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.4.m4.1c">S^{*}(\mathcal{D}_{e})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.4.m4.1d">italic_S start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT )</annotation></semantics></math>. The natural performance heterogeneity can be written as: <span class="ltx_text" id="S3.SS1.p2.5.4.2"></span></span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx4">
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}%
S_{h}^{*}=\sqrt{\frac{1}{|\mathcal{E}|-1}\sum_{e\in\mathcal{E}}(S^{*}(\mathcal%
{D}_{e})-{\bar{S}}^{*})^{2}}," class="ltx_Math" display="inline" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><msubsup id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2.2" mathcolor="#000000" xref="S3.E7.m1.3.3.1.1.2.2.2.cmml">S</mi><mi id="S3.E7.m1.3.3.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">h</mi><mo id="S3.E7.m1.3.3.1.1.2.3" xref="S3.E7.m1.3.3.1.1.2.3.cmml">∗</mo></msubsup><mo id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.1.cmml">=</mo><msqrt id="S3.E7.m1.2.2" mathcolor="#000000" xref="S3.E7.m1.2.2.cmml"><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mfrac id="S3.E7.m1.1.1.1.1a" mathcolor="#000000" xref="S3.E7.m1.1.1.1.1.cmml"><mn id="S3.E7.m1.1.1.1.1.3" mathcolor="#000000" xref="S3.E7.m1.1.1.1.1.3.cmml">1</mn><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.3.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.3.2.1" mathcolor="#000000" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.1" mathcolor="#000000" xref="S3.E7.m1.1.1.1.1.1.1.cmml">ℰ</mi><mo id="S3.E7.m1.1.1.1.1.1.3.2.2" mathcolor="#000000" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.E7.m1.1.1.1.1.1.2" mathcolor="#000000" xref="S3.E7.m1.1.1.1.1.1.2.cmml">−</mo><mn id="S3.E7.m1.1.1.1.1.1.4" mathcolor="#000000" xref="S3.E7.m1.1.1.1.1.1.4.cmml">1</mn></mrow></mfrac></mstyle><mo id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><munder id="S3.E7.m1.2.2.2.2.2a" xref="S3.E7.m1.2.2.2.2.2.cmml"><mo id="S3.E7.m1.2.2.2.2.2.2" mathcolor="#000000" movablelimits="false" xref="S3.E7.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.3.2" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.2.3.2.cmml">e</mi><mo id="S3.E7.m1.2.2.2.2.2.3.1" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.2.2.2.3.3" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.2.3.3.cmml">ℰ</mi></mrow></munder></mstyle><msup id="S3.E7.m1.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.1.cmml"><mrow id="S3.E7.m1.2.2.2.2.1.1.1" xref="S3.E7.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E7.m1.2.2.2.2.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S3.E7.m1.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.2.2.2.2.1.1.1.1" xref="S3.E7.m1.2.2.2.2.1.1.1.1.cmml"><mrow id="S3.E7.m1.2.2.2.2.1.1.1.1.1" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.cmml"><msup id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.2" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.2.cmml">S</mi><mo id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.3" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.3.cmml">∗</mo></msup><mo id="S3.E7.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.2.2.2.2.1.1.1.1.2" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.1.1.1.2.cmml">−</mo><msup id="S3.E7.m1.2.2.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.2.2.2.2.1.1.1.1.3.2" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.2" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.2.cmml">S</mi><mo id="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.1" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.1.cmml">¯</mo></mover><mo id="S3.E7.m1.2.2.2.2.1.1.1.1.3.3" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.3.cmml">∗</mo></msup></mrow><mo id="S3.E7.m1.2.2.2.2.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S3.E7.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E7.m1.2.2.2.2.1.3" mathcolor="#000000" xref="S3.E7.m1.2.2.2.2.1.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><mo id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><eq id="S3.E7.m1.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1"></eq><apply id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2">𝑆</ci><ci id="S3.E7.m1.3.3.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.3">ℎ</ci></apply><times id="S3.E7.m1.3.3.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.3"></times></apply><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><root id="S3.E7.m1.2.2a.cmml" xref="S3.E7.m1.2.2"></root><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><times id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3"></times><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><divide id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1"></divide><cn id="S3.E7.m1.1.1.1.1.3.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.3">1</cn><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><minus id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2"></minus><apply id="S3.E7.m1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.3.2"><abs id="S3.E7.m1.1.1.1.1.1.3.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.3.2.1"></abs><ci id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">ℰ</ci></apply><cn id="S3.E7.m1.1.1.1.1.1.4.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.1.4">1</cn></apply></apply><apply id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2"><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2">subscript</csymbol><sum id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2"></sum><apply id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3"><in id="S3.E7.m1.2.2.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.3.1"></in><ci id="S3.E7.m1.2.2.2.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.3.2">𝑒</ci><ci id="S3.E7.m1.2.2.2.2.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3.3">ℰ</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.2.cmml" xref="S3.E7.m1.2.2.2.2.1">superscript</csymbol><apply id="S3.E7.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1"><minus id="S3.E7.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.2"></minus><apply id="S3.E7.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1"><times id="S3.E7.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.2"></times><apply id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.2">𝑆</ci><times id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.3"></times></apply><apply id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.1.3">𝑒</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3">superscript</csymbol><apply id="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.2"><ci id="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.1">¯</ci><ci id="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.2.2">𝑆</ci></apply><times id="S3.E7.m1.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.3.3"></times></apply></apply><cn id="S3.E7.m1.2.2.2.2.1.3.cmml" type="integer" xref="S3.E7.m1.2.2.2.2.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\displaystyle\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}%
S_{h}^{*}=\sqrt{\frac{1}{|\mathcal{E}|-1}\sum_{e\in\mathcal{E}}(S^{*}(\mathcal%
{D}_{e})-{\bar{S}}^{*})^{2}},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">italic_S start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = square-root start_ARG divide start_ARG 1 end_ARG start_ARG | caligraphic_E | - 1 end_ARG ∑ start_POSTSUBSCRIPT italic_e ∈ caligraphic_E end_POSTSUBSCRIPT ( italic_S start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ) - over¯ start_ARG italic_S end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.6"><span class="ltx_text" id="S3.SS1.p2.6.1">We define the performance heterogeneity brought by the model bias, <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.6.1.1">i</span>.<span class="ltx_text ltx_font_italic" id="S3.SS1.p2.6.1.2">e</span>., bias-amplified performance heterogeneity as:<span class="ltx_text" id="S3.SS1.p2.6.1.3"></span></span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx5">
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}%
S_{h}^{\circ}=S_{h}-S_{h}^{*}." class="ltx_Math" display="inline" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><msubsup id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2" mathcolor="#000000" xref="S3.E8.m1.1.1.1.1.2.2.2.cmml">S</mi><mi id="S3.E8.m1.1.1.1.1.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.3.cmml">h</mi><mo id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.2.3.cmml">∘</mo></msubsup><mo id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><msub id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2" mathcolor="#000000" xref="S3.E8.m1.1.1.1.1.3.2.2.cmml">S</mi><mi id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.cmml">h</mi></msub><mo id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">−</mo><msubsup id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.2.2" mathcolor="#000000" xref="S3.E8.m1.1.1.1.1.3.3.2.2.cmml">S</mi><mi id="S3.E8.m1.1.1.1.1.3.3.2.3" xref="S3.E8.m1.1.1.1.1.3.3.2.3.cmml">h</mi><mo id="S3.E8.m1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.cmml">∗</mo></msubsup></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" lspace="0em" xref="S3.E8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2">𝑆</ci><ci id="S3.E8.m1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3">ℎ</ci></apply><compose id="S3.E8.m1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3"></compose></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><minus id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"></minus><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2">𝑆</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3">ℎ</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.2">𝑆</ci><ci id="S3.E8.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3">ℎ</ci></apply><times id="S3.E8.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}%
S_{h}^{\circ}=S_{h}-S_{h}^{*}.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">italic_S start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT = italic_S start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT - italic_S start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.3">In this paper, we use capital letters (<math alttext="\textit{e}.\textit{g}.,X" class="ltx_math_unparsed" display="inline" id="S3.SS1.p3.1.m1.2"><semantics id="S3.SS1.p3.1.m1.2a"><mrow id="S3.SS1.p3.1.m1.2b"><mtext class="ltx_mathvariant_italic" id="S3.SS1.p3.1.m1.1.1">e</mtext><mo id="S3.SS1.p3.1.m1.2.3" lspace="0em" rspace="0.167em">.</mo><mtext class="ltx_mathvariant_italic" id="S3.SS1.p3.1.m1.2.2">g</mtext><mo id="S3.SS1.p3.1.m1.2.4" lspace="0em" rspace="0.167em">.</mo><mo id="S3.SS1.p3.1.m1.2.5">,</mo><mi id="S3.SS1.p3.1.m1.2.6">X</mi></mrow><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.2c">\textit{e}.\textit{g}.,X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.2d">e . g . , italic_X</annotation></semantics></math>) to denote variables, lowercase letters (<math alttext="\textit{e}.\textit{g}.,x" class="ltx_math_unparsed" display="inline" id="S3.SS1.p3.2.m2.2"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2b"><mtext class="ltx_mathvariant_italic" id="S3.SS1.p3.2.m2.1.1">e</mtext><mo id="S3.SS1.p3.2.m2.2.3" lspace="0em" rspace="0.167em">.</mo><mtext class="ltx_mathvariant_italic" id="S3.SS1.p3.2.m2.2.2">g</mtext><mo id="S3.SS1.p3.2.m2.2.4" lspace="0em" rspace="0.167em">.</mo><mo id="S3.SS1.p3.2.m2.2.5">,</mo><mi id="S3.SS1.p3.2.m2.2.6">x</mi></mrow><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">\textit{e}.\textit{g}.,x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.2d">e . g . , italic_x</annotation></semantics></math>) to denote particular values of variables, and bold ones (<math alttext="\textit{e}.\textit{g}.,\mathbf{x}" class="ltx_math_unparsed" display="inline" id="S3.SS1.p3.3.m3.2"><semantics id="S3.SS1.p3.3.m3.2a"><mrow id="S3.SS1.p3.3.m3.2b"><mtext class="ltx_mathvariant_italic" id="S3.SS1.p3.3.m3.1.1">e</mtext><mo id="S3.SS1.p3.3.m3.2.3" lspace="0em" rspace="0.167em">.</mo><mtext class="ltx_mathvariant_italic" id="S3.SS1.p3.3.m3.2.2">g</mtext><mo id="S3.SS1.p3.3.m3.2.4" lspace="0em" rspace="0.167em">.</mo><mo id="S3.SS1.p3.3.m3.2.5">,</mo><mi id="S3.SS1.p3.3.m3.2.6">𝐱</mi></mrow><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.2c">\textit{e}.\textit{g}.,\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.2d">e . g . , bold_x</annotation></semantics></math>) to denote the vectorial representations.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span class="ltx_text ltx_font_italic" id="S3.SS2.1.1">Front-door Adjustment in Recommendation</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.8">In this subsection, we analyze the critical challenges in satisfying the three requirements of FDA and implementing FDA in deep recommendation models. Recall that in recommendation, <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_X</annotation></semantics></math> refers to the historical behaviors while <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_Y</annotation></semantics></math> refers to the next behavior (<span class="ltx_text ltx_font_italic" id="S3.SS2.p1.8.1">c.f.</span> Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.F3" title="Figure 3 ‣ 2.1 Back-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">3</span></a>). Many recommendation models follow the encoder-predictor structure where the encoder transforms <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_X</annotation></semantics></math> into latent factors, and the predictor determines the correlations between <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_Y</annotation></semantics></math> based on the latent factors and the target-item feature. As such, it is intuitive to view the latent factors obtained from <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_X</annotation></semantics></math> as the mediator <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_M</annotation></semantics></math>, and the representation of latent factors as the mediator feature. We analyze whether such <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_M</annotation></semantics></math> satisfies the requirements one by one:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.18"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.18.14">Requirement (i). </span> <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_M</annotation></semantics></math> should intercept all directed paths from <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_X</annotation></semantics></math> to <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_Y</annotation></semantics></math>. This means that there is no other information of <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_X</annotation></semantics></math> that could contribute to the recommendation prediction but is not encoded in <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_M</annotation></semantics></math>. <span class="ltx_text" id="S3.SS2.p2.18.13">Intuitively, if this requirement is not satisfied, there are other direct or indirect effect of <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p2.6.1.m1.1"><semantics id="S3.SS2.p2.6.1.m1.1a"><mi id="S3.SS2.p2.6.1.m1.1.1" xref="S3.SS2.p2.6.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.1.m1.1b"><ci id="S3.SS2.p2.6.1.m1.1.1.cmml" xref="S3.SS2.p2.6.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.1.m1.1d">italic_X</annotation></semantics></math> on <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS2.p2.7.2.m2.1"><semantics id="S3.SS2.p2.7.2.m2.1a"><mi id="S3.SS2.p2.7.2.m2.1.1" xref="S3.SS2.p2.7.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.2.m2.1b"><ci id="S3.SS2.p2.7.2.m2.1.1.cmml" xref="S3.SS2.p2.7.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.2.m2.1d">italic_Y</annotation></semantics></math> besides <math alttext="X\rightarrow M\rightarrow Y" class="ltx_Math" display="inline" id="S3.SS2.p2.8.3.m3.1"><semantics id="S3.SS2.p2.8.3.m3.1a"><mrow id="S3.SS2.p2.8.3.m3.1.1" xref="S3.SS2.p2.8.3.m3.1.1.cmml"><mi id="S3.SS2.p2.8.3.m3.1.1.2" xref="S3.SS2.p2.8.3.m3.1.1.2.cmml">X</mi><mo id="S3.SS2.p2.8.3.m3.1.1.3" stretchy="false" xref="S3.SS2.p2.8.3.m3.1.1.3.cmml">→</mo><mi id="S3.SS2.p2.8.3.m3.1.1.4" xref="S3.SS2.p2.8.3.m3.1.1.4.cmml">M</mi><mo id="S3.SS2.p2.8.3.m3.1.1.5" stretchy="false" xref="S3.SS2.p2.8.3.m3.1.1.5.cmml">→</mo><mi id="S3.SS2.p2.8.3.m3.1.1.6" xref="S3.SS2.p2.8.3.m3.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.3.m3.1b"><apply id="S3.SS2.p2.8.3.m3.1.1.cmml" xref="S3.SS2.p2.8.3.m3.1.1"><and id="S3.SS2.p2.8.3.m3.1.1a.cmml" xref="S3.SS2.p2.8.3.m3.1.1"></and><apply id="S3.SS2.p2.8.3.m3.1.1b.cmml" xref="S3.SS2.p2.8.3.m3.1.1"><ci id="S3.SS2.p2.8.3.m3.1.1.3.cmml" xref="S3.SS2.p2.8.3.m3.1.1.3">→</ci><ci id="S3.SS2.p2.8.3.m3.1.1.2.cmml" xref="S3.SS2.p2.8.3.m3.1.1.2">𝑋</ci><ci id="S3.SS2.p2.8.3.m3.1.1.4.cmml" xref="S3.SS2.p2.8.3.m3.1.1.4">𝑀</ci></apply><apply id="S3.SS2.p2.8.3.m3.1.1c.cmml" xref="S3.SS2.p2.8.3.m3.1.1"><ci id="S3.SS2.p2.8.3.m3.1.1.5.cmml" xref="S3.SS2.p2.8.3.m3.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S3.SS2.p2.8.3.m3.1.1.4.cmml" id="S3.SS2.p2.8.3.m3.1.1d.cmml" xref="S3.SS2.p2.8.3.m3.1.1"></share><ci id="S3.SS2.p2.8.3.m3.1.1.6.cmml" xref="S3.SS2.p2.8.3.m3.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.3.m3.1c">X\rightarrow M\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.3.m3.1d">italic_X → italic_M → italic_Y</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.18.13.4">e</span>.<span class="ltx_text ltx_font_italic" id="S3.SS2.p2.18.13.5">g</span>., <math alttext="X\rightarrow M^{*}\rightarrow Y" class="ltx_Math" display="inline" id="S3.SS2.p2.9.4.m4.1"><semantics id="S3.SS2.p2.9.4.m4.1a"><mrow id="S3.SS2.p2.9.4.m4.1.1" xref="S3.SS2.p2.9.4.m4.1.1.cmml"><mi id="S3.SS2.p2.9.4.m4.1.1.2" xref="S3.SS2.p2.9.4.m4.1.1.2.cmml">X</mi><mo id="S3.SS2.p2.9.4.m4.1.1.3" stretchy="false" xref="S3.SS2.p2.9.4.m4.1.1.3.cmml">→</mo><msup id="S3.SS2.p2.9.4.m4.1.1.4" xref="S3.SS2.p2.9.4.m4.1.1.4.cmml"><mi id="S3.SS2.p2.9.4.m4.1.1.4.2" xref="S3.SS2.p2.9.4.m4.1.1.4.2.cmml">M</mi><mo id="S3.SS2.p2.9.4.m4.1.1.4.3" xref="S3.SS2.p2.9.4.m4.1.1.4.3.cmml">∗</mo></msup><mo id="S3.SS2.p2.9.4.m4.1.1.5" stretchy="false" xref="S3.SS2.p2.9.4.m4.1.1.5.cmml">→</mo><mi id="S3.SS2.p2.9.4.m4.1.1.6" xref="S3.SS2.p2.9.4.m4.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.4.m4.1b"><apply id="S3.SS2.p2.9.4.m4.1.1.cmml" xref="S3.SS2.p2.9.4.m4.1.1"><and id="S3.SS2.p2.9.4.m4.1.1a.cmml" xref="S3.SS2.p2.9.4.m4.1.1"></and><apply id="S3.SS2.p2.9.4.m4.1.1b.cmml" xref="S3.SS2.p2.9.4.m4.1.1"><ci id="S3.SS2.p2.9.4.m4.1.1.3.cmml" xref="S3.SS2.p2.9.4.m4.1.1.3">→</ci><ci id="S3.SS2.p2.9.4.m4.1.1.2.cmml" xref="S3.SS2.p2.9.4.m4.1.1.2">𝑋</ci><apply id="S3.SS2.p2.9.4.m4.1.1.4.cmml" xref="S3.SS2.p2.9.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p2.9.4.m4.1.1.4.1.cmml" xref="S3.SS2.p2.9.4.m4.1.1.4">superscript</csymbol><ci id="S3.SS2.p2.9.4.m4.1.1.4.2.cmml" xref="S3.SS2.p2.9.4.m4.1.1.4.2">𝑀</ci><times id="S3.SS2.p2.9.4.m4.1.1.4.3.cmml" xref="S3.SS2.p2.9.4.m4.1.1.4.3"></times></apply></apply><apply id="S3.SS2.p2.9.4.m4.1.1c.cmml" xref="S3.SS2.p2.9.4.m4.1.1"><ci id="S3.SS2.p2.9.4.m4.1.1.5.cmml" xref="S3.SS2.p2.9.4.m4.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S3.SS2.p2.9.4.m4.1.1.4.cmml" id="S3.SS2.p2.9.4.m4.1.1d.cmml" xref="S3.SS2.p2.9.4.m4.1.1"></share><ci id="S3.SS2.p2.9.4.m4.1.1.6.cmml" xref="S3.SS2.p2.9.4.m4.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.4.m4.1c">X\rightarrow M^{*}\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.4.m4.1d">italic_X → italic_M start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT → italic_Y</annotation></semantics></math> or <math alttext="X\rightarrow Y" class="ltx_Math" display="inline" id="S3.SS2.p2.10.5.m5.1"><semantics id="S3.SS2.p2.10.5.m5.1a"><mrow id="S3.SS2.p2.10.5.m5.1.1" xref="S3.SS2.p2.10.5.m5.1.1.cmml"><mi id="S3.SS2.p2.10.5.m5.1.1.2" xref="S3.SS2.p2.10.5.m5.1.1.2.cmml">X</mi><mo id="S3.SS2.p2.10.5.m5.1.1.1" stretchy="false" xref="S3.SS2.p2.10.5.m5.1.1.1.cmml">→</mo><mi id="S3.SS2.p2.10.5.m5.1.1.3" xref="S3.SS2.p2.10.5.m5.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.5.m5.1b"><apply id="S3.SS2.p2.10.5.m5.1.1.cmml" xref="S3.SS2.p2.10.5.m5.1.1"><ci id="S3.SS2.p2.10.5.m5.1.1.1.cmml" xref="S3.SS2.p2.10.5.m5.1.1.1">→</ci><ci id="S3.SS2.p2.10.5.m5.1.1.2.cmml" xref="S3.SS2.p2.10.5.m5.1.1.2">𝑋</ci><ci id="S3.SS2.p2.10.5.m5.1.1.3.cmml" xref="S3.SS2.p2.10.5.m5.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.5.m5.1c">X\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.5.m5.1d">italic_X → italic_Y</annotation></semantics></math>. Then, front-door adjustment over each path (<span class="ltx_text ltx_font_italic" id="S3.SS2.p2.18.13.6">e</span>.<span class="ltx_text ltx_font_italic" id="S3.SS2.p2.18.13.7">g</span>., cutting <math alttext="X\rightarrow M" class="ltx_Math" display="inline" id="S3.SS2.p2.11.6.m6.1"><semantics id="S3.SS2.p2.11.6.m6.1a"><mrow id="S3.SS2.p2.11.6.m6.1.1" xref="S3.SS2.p2.11.6.m6.1.1.cmml"><mi id="S3.SS2.p2.11.6.m6.1.1.2" xref="S3.SS2.p2.11.6.m6.1.1.2.cmml">X</mi><mo id="S3.SS2.p2.11.6.m6.1.1.1" stretchy="false" xref="S3.SS2.p2.11.6.m6.1.1.1.cmml">→</mo><mi id="S3.SS2.p2.11.6.m6.1.1.3" xref="S3.SS2.p2.11.6.m6.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.6.m6.1b"><apply id="S3.SS2.p2.11.6.m6.1.1.cmml" xref="S3.SS2.p2.11.6.m6.1.1"><ci id="S3.SS2.p2.11.6.m6.1.1.1.cmml" xref="S3.SS2.p2.11.6.m6.1.1.1">→</ci><ci id="S3.SS2.p2.11.6.m6.1.1.2.cmml" xref="S3.SS2.p2.11.6.m6.1.1.2">𝑋</ci><ci id="S3.SS2.p2.11.6.m6.1.1.3.cmml" xref="S3.SS2.p2.11.6.m6.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.6.m6.1c">X\rightarrow M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.11.6.m6.1d">italic_X → italic_M</annotation></semantics></math> for <math alttext="X\rightarrow M\rightarrow Y" class="ltx_Math" display="inline" id="S3.SS2.p2.12.7.m7.1"><semantics id="S3.SS2.p2.12.7.m7.1a"><mrow id="S3.SS2.p2.12.7.m7.1.1" xref="S3.SS2.p2.12.7.m7.1.1.cmml"><mi id="S3.SS2.p2.12.7.m7.1.1.2" xref="S3.SS2.p2.12.7.m7.1.1.2.cmml">X</mi><mo id="S3.SS2.p2.12.7.m7.1.1.3" stretchy="false" xref="S3.SS2.p2.12.7.m7.1.1.3.cmml">→</mo><mi id="S3.SS2.p2.12.7.m7.1.1.4" xref="S3.SS2.p2.12.7.m7.1.1.4.cmml">M</mi><mo id="S3.SS2.p2.12.7.m7.1.1.5" stretchy="false" xref="S3.SS2.p2.12.7.m7.1.1.5.cmml">→</mo><mi id="S3.SS2.p2.12.7.m7.1.1.6" xref="S3.SS2.p2.12.7.m7.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.7.m7.1b"><apply id="S3.SS2.p2.12.7.m7.1.1.cmml" xref="S3.SS2.p2.12.7.m7.1.1"><and id="S3.SS2.p2.12.7.m7.1.1a.cmml" xref="S3.SS2.p2.12.7.m7.1.1"></and><apply id="S3.SS2.p2.12.7.m7.1.1b.cmml" xref="S3.SS2.p2.12.7.m7.1.1"><ci id="S3.SS2.p2.12.7.m7.1.1.3.cmml" xref="S3.SS2.p2.12.7.m7.1.1.3">→</ci><ci id="S3.SS2.p2.12.7.m7.1.1.2.cmml" xref="S3.SS2.p2.12.7.m7.1.1.2">𝑋</ci><ci id="S3.SS2.p2.12.7.m7.1.1.4.cmml" xref="S3.SS2.p2.12.7.m7.1.1.4">𝑀</ci></apply><apply id="S3.SS2.p2.12.7.m7.1.1c.cmml" xref="S3.SS2.p2.12.7.m7.1.1"><ci id="S3.SS2.p2.12.7.m7.1.1.5.cmml" xref="S3.SS2.p2.12.7.m7.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S3.SS2.p2.12.7.m7.1.1.4.cmml" id="S3.SS2.p2.12.7.m7.1.1d.cmml" xref="S3.SS2.p2.12.7.m7.1.1"></share><ci id="S3.SS2.p2.12.7.m7.1.1.6.cmml" xref="S3.SS2.p2.12.7.m7.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.7.m7.1c">X\rightarrow M\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.12.7.m7.1d">italic_X → italic_M → italic_Y</annotation></semantics></math> in step 2) would leave other paths <math alttext="X\rightarrow M^{*}\rightarrow Y" class="ltx_Math" display="inline" id="S3.SS2.p2.13.8.m8.1"><semantics id="S3.SS2.p2.13.8.m8.1a"><mrow id="S3.SS2.p2.13.8.m8.1.1" xref="S3.SS2.p2.13.8.m8.1.1.cmml"><mi id="S3.SS2.p2.13.8.m8.1.1.2" xref="S3.SS2.p2.13.8.m8.1.1.2.cmml">X</mi><mo id="S3.SS2.p2.13.8.m8.1.1.3" stretchy="false" xref="S3.SS2.p2.13.8.m8.1.1.3.cmml">→</mo><msup id="S3.SS2.p2.13.8.m8.1.1.4" xref="S3.SS2.p2.13.8.m8.1.1.4.cmml"><mi id="S3.SS2.p2.13.8.m8.1.1.4.2" xref="S3.SS2.p2.13.8.m8.1.1.4.2.cmml">M</mi><mo id="S3.SS2.p2.13.8.m8.1.1.4.3" xref="S3.SS2.p2.13.8.m8.1.1.4.3.cmml">∗</mo></msup><mo id="S3.SS2.p2.13.8.m8.1.1.5" stretchy="false" xref="S3.SS2.p2.13.8.m8.1.1.5.cmml">→</mo><mi id="S3.SS2.p2.13.8.m8.1.1.6" xref="S3.SS2.p2.13.8.m8.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.8.m8.1b"><apply id="S3.SS2.p2.13.8.m8.1.1.cmml" xref="S3.SS2.p2.13.8.m8.1.1"><and id="S3.SS2.p2.13.8.m8.1.1a.cmml" xref="S3.SS2.p2.13.8.m8.1.1"></and><apply id="S3.SS2.p2.13.8.m8.1.1b.cmml" xref="S3.SS2.p2.13.8.m8.1.1"><ci id="S3.SS2.p2.13.8.m8.1.1.3.cmml" xref="S3.SS2.p2.13.8.m8.1.1.3">→</ci><ci id="S3.SS2.p2.13.8.m8.1.1.2.cmml" xref="S3.SS2.p2.13.8.m8.1.1.2">𝑋</ci><apply id="S3.SS2.p2.13.8.m8.1.1.4.cmml" xref="S3.SS2.p2.13.8.m8.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p2.13.8.m8.1.1.4.1.cmml" xref="S3.SS2.p2.13.8.m8.1.1.4">superscript</csymbol><ci id="S3.SS2.p2.13.8.m8.1.1.4.2.cmml" xref="S3.SS2.p2.13.8.m8.1.1.4.2">𝑀</ci><times id="S3.SS2.p2.13.8.m8.1.1.4.3.cmml" xref="S3.SS2.p2.13.8.m8.1.1.4.3"></times></apply></apply><apply id="S3.SS2.p2.13.8.m8.1.1c.cmml" xref="S3.SS2.p2.13.8.m8.1.1"><ci id="S3.SS2.p2.13.8.m8.1.1.5.cmml" xref="S3.SS2.p2.13.8.m8.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S3.SS2.p2.13.8.m8.1.1.4.cmml" id="S3.SS2.p2.13.8.m8.1.1d.cmml" xref="S3.SS2.p2.13.8.m8.1.1"></share><ci id="S3.SS2.p2.13.8.m8.1.1.6.cmml" xref="S3.SS2.p2.13.8.m8.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.8.m8.1c">X\rightarrow M^{*}\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.13.8.m8.1d">italic_X → italic_M start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT → italic_Y</annotation></semantics></math> or <math alttext="X\rightarrow Y" class="ltx_Math" display="inline" id="S3.SS2.p2.14.9.m9.1"><semantics id="S3.SS2.p2.14.9.m9.1a"><mrow id="S3.SS2.p2.14.9.m9.1.1" xref="S3.SS2.p2.14.9.m9.1.1.cmml"><mi id="S3.SS2.p2.14.9.m9.1.1.2" xref="S3.SS2.p2.14.9.m9.1.1.2.cmml">X</mi><mo id="S3.SS2.p2.14.9.m9.1.1.1" stretchy="false" xref="S3.SS2.p2.14.9.m9.1.1.1.cmml">→</mo><mi id="S3.SS2.p2.14.9.m9.1.1.3" xref="S3.SS2.p2.14.9.m9.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.9.m9.1b"><apply id="S3.SS2.p2.14.9.m9.1.1.cmml" xref="S3.SS2.p2.14.9.m9.1.1"><ci id="S3.SS2.p2.14.9.m9.1.1.1.cmml" xref="S3.SS2.p2.14.9.m9.1.1.1">→</ci><ci id="S3.SS2.p2.14.9.m9.1.1.2.cmml" xref="S3.SS2.p2.14.9.m9.1.1.2">𝑋</ci><ci id="S3.SS2.p2.14.9.m9.1.1.3.cmml" xref="S3.SS2.p2.14.9.m9.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.9.m9.1c">X\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.14.9.m9.1d">italic_X → italic_Y</annotation></semantics></math> still confounded by <math alttext="U" class="ltx_Math" display="inline" id="S3.SS2.p2.15.10.m10.1"><semantics id="S3.SS2.p2.15.10.m10.1a"><mi id="S3.SS2.p2.15.10.m10.1.1" xref="S3.SS2.p2.15.10.m10.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.10.m10.1b"><ci id="S3.SS2.p2.15.10.m10.1.1.cmml" xref="S3.SS2.p2.15.10.m10.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.10.m10.1c">U</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.15.10.m10.1d">italic_U</annotation></semantics></math>, thus failing to estimate the causal effects.<span class="ltx_text" id="S3.SS2.p2.18.13.3"> In the encoder-predictor recommendation architecture, the latent factors <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.16.11.1.m1.1"><semantics id="S3.SS2.p2.16.11.1.m1.1a"><mi id="S3.SS2.p2.16.11.1.m1.1.1" xref="S3.SS2.p2.16.11.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.16.11.1.m1.1b"><ci id="S3.SS2.p2.16.11.1.m1.1.1.cmml" xref="S3.SS2.p2.16.11.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.16.11.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.16.11.1.m1.1d">italic_M</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.18.13.3.1">as a whole</span> contain all the information of the historical behaviors <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p2.17.12.2.m2.1"><semantics id="S3.SS2.p2.17.12.2.m2.1a"><mi id="S3.SS2.p2.17.12.2.m2.1.1" xref="S3.SS2.p2.17.12.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.17.12.2.m2.1b"><ci id="S3.SS2.p2.17.12.2.m2.1.1.cmml" xref="S3.SS2.p2.17.12.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.17.12.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.17.12.2.m2.1d">italic_X</annotation></semantics></math> which are used to make predictions.
As such, the latent factors <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.18.13.3.m3.1"><semantics id="S3.SS2.p2.18.13.3.m3.1a"><mi id="S3.SS2.p2.18.13.3.m3.1.1" xref="S3.SS2.p2.18.13.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.18.13.3.m3.1b"><ci id="S3.SS2.p2.18.13.3.m3.1.1.cmml" xref="S3.SS2.p2.18.13.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.18.13.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.18.13.3.m3.1d">italic_M</annotation></semantics></math> as a whole obtained from the encoder satisfy the requirement.</span></span></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.11"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.11.1">Requirement (ii) &amp; (iii). </span> These requirements indicate that there are no confounders affecting <math alttext="(X,M)" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.2"><semantics id="S3.SS2.p3.1.m1.2a"><mrow id="S3.SS2.p3.1.m1.2.3.2" xref="S3.SS2.p3.1.m1.2.3.1.cmml"><mo id="S3.SS2.p3.1.m1.2.3.2.1" stretchy="false" xref="S3.SS2.p3.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">X</mi><mo id="S3.SS2.p3.1.m1.2.3.2.2" xref="S3.SS2.p3.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.p3.1.m1.2.2" xref="S3.SS2.p3.1.m1.2.2.cmml">M</mi><mo id="S3.SS2.p3.1.m1.2.3.2.3" stretchy="false" xref="S3.SS2.p3.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.2b"><interval closure="open" id="S3.SS2.p3.1.m1.2.3.1.cmml" xref="S3.SS2.p3.1.m1.2.3.2"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑋</ci><ci id="S3.SS2.p3.1.m1.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2">𝑀</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.2c">(X,M)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.2d">( italic_X , italic_M )</annotation></semantics></math> and no confounders other than <math alttext="U" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">U</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_U</annotation></semantics></math> affecting <math alttext="(M,Y)" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.2"><semantics id="S3.SS2.p3.3.m3.2a"><mrow id="S3.SS2.p3.3.m3.2.3.2" xref="S3.SS2.p3.3.m3.2.3.1.cmml"><mo id="S3.SS2.p3.3.m3.2.3.2.1" stretchy="false" xref="S3.SS2.p3.3.m3.2.3.1.cmml">(</mo><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">M</mi><mo id="S3.SS2.p3.3.m3.2.3.2.2" xref="S3.SS2.p3.3.m3.2.3.1.cmml">,</mo><mi id="S3.SS2.p3.3.m3.2.2" xref="S3.SS2.p3.3.m3.2.2.cmml">Y</mi><mo id="S3.SS2.p3.3.m3.2.3.2.3" stretchy="false" xref="S3.SS2.p3.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.2b"><interval closure="open" id="S3.SS2.p3.3.m3.2.3.1.cmml" xref="S3.SS2.p3.3.m3.2.3.2"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑀</ci><ci id="S3.SS2.p3.3.m3.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.2c">(M,Y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.2d">( italic_M , italic_Y )</annotation></semantics></math>, which are mostly satisfied if we use the latent factors obtained by the encoder as the mediator. Specifically, the parameters of the encoder and the predictor are randomly initialized, thus containing no confounder-related information before training. During training, the parameters are learned from <math alttext="(X,Y)" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.2"><semantics id="S3.SS2.p3.4.m4.2a"><mrow id="S3.SS2.p3.4.m4.2.3.2" xref="S3.SS2.p3.4.m4.2.3.1.cmml"><mo id="S3.SS2.p3.4.m4.2.3.2.1" stretchy="false" xref="S3.SS2.p3.4.m4.2.3.1.cmml">(</mo><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">X</mi><mo id="S3.SS2.p3.4.m4.2.3.2.2" xref="S3.SS2.p3.4.m4.2.3.1.cmml">,</mo><mi id="S3.SS2.p3.4.m4.2.2" xref="S3.SS2.p3.4.m4.2.2.cmml">Y</mi><mo id="S3.SS2.p3.4.m4.2.3.2.3" stretchy="false" xref="S3.SS2.p3.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.2b"><interval closure="open" id="S3.SS2.p3.4.m4.2.3.1.cmml" xref="S3.SS2.p3.4.m4.2.3.2"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝑋</ci><ci id="S3.SS2.p3.4.m4.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.2c">(X,Y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.2d">( italic_X , italic_Y )</annotation></semantics></math> pairs from the recommendation datasets, and can only encode confounders that affect <math alttext="(X,Y)" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.2"><semantics id="S3.SS2.p3.5.m5.2a"><mrow id="S3.SS2.p3.5.m5.2.3.2" xref="S3.SS2.p3.5.m5.2.3.1.cmml"><mo id="S3.SS2.p3.5.m5.2.3.2.1" stretchy="false" xref="S3.SS2.p3.5.m5.2.3.1.cmml">(</mo><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">X</mi><mo id="S3.SS2.p3.5.m5.2.3.2.2" xref="S3.SS2.p3.5.m5.2.3.1.cmml">,</mo><mi id="S3.SS2.p3.5.m5.2.2" xref="S3.SS2.p3.5.m5.2.2.cmml">Y</mi><mo id="S3.SS2.p3.5.m5.2.3.2.3" stretchy="false" xref="S3.SS2.p3.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.2b"><interval closure="open" id="S3.SS2.p3.5.m5.2.3.1.cmml" xref="S3.SS2.p3.5.m5.2.3.2"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑋</ci><ci id="S3.SS2.p3.5.m5.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.2c">(X,Y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.2d">( italic_X , italic_Y )</annotation></semantics></math>, which are all included in <math alttext="U" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">U</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_U</annotation></semantics></math> of the back-door path <math alttext="X\leftarrow U\rightarrow Y" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><mrow id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">X</mi><mo id="S3.SS2.p3.7.m7.1.1.3" stretchy="false" xref="S3.SS2.p3.7.m7.1.1.3.cmml">←</mo><mi id="S3.SS2.p3.7.m7.1.1.4" xref="S3.SS2.p3.7.m7.1.1.4.cmml">U</mi><mo id="S3.SS2.p3.7.m7.1.1.5" stretchy="false" xref="S3.SS2.p3.7.m7.1.1.5.cmml">→</mo><mi id="S3.SS2.p3.7.m7.1.1.6" xref="S3.SS2.p3.7.m7.1.1.6.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><and id="S3.SS2.p3.7.m7.1.1a.cmml" xref="S3.SS2.p3.7.m7.1.1"></and><apply id="S3.SS2.p3.7.m7.1.1b.cmml" xref="S3.SS2.p3.7.m7.1.1"><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">←</ci><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝑋</ci><ci id="S3.SS2.p3.7.m7.1.1.4.cmml" xref="S3.SS2.p3.7.m7.1.1.4">𝑈</ci></apply><apply id="S3.SS2.p3.7.m7.1.1c.cmml" xref="S3.SS2.p3.7.m7.1.1"><ci id="S3.SS2.p3.7.m7.1.1.5.cmml" xref="S3.SS2.p3.7.m7.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S3.SS2.p3.7.m7.1.1.4.cmml" id="S3.SS2.p3.7.m7.1.1d.cmml" xref="S3.SS2.p3.7.m7.1.1"></share><ci id="S3.SS2.p3.7.m7.1.1.6.cmml" xref="S3.SS2.p3.7.m7.1.1.6">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">X\leftarrow U\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_X ← italic_U → italic_Y</annotation></semantics></math>. As such, there are no confounders other than <math alttext="U" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">U</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_U</annotation></semantics></math> affecting <math alttext="(M,Y)" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.2"><semantics id="S3.SS2.p3.9.m9.2a"><mrow id="S3.SS2.p3.9.m9.2.3.2" xref="S3.SS2.p3.9.m9.2.3.1.cmml"><mo id="S3.SS2.p3.9.m9.2.3.2.1" stretchy="false" xref="S3.SS2.p3.9.m9.2.3.1.cmml">(</mo><mi id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml">M</mi><mo id="S3.SS2.p3.9.m9.2.3.2.2" xref="S3.SS2.p3.9.m9.2.3.1.cmml">,</mo><mi id="S3.SS2.p3.9.m9.2.2" xref="S3.SS2.p3.9.m9.2.2.cmml">Y</mi><mo id="S3.SS2.p3.9.m9.2.3.2.3" stretchy="false" xref="S3.SS2.p3.9.m9.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.2b"><interval closure="open" id="S3.SS2.p3.9.m9.2.3.1.cmml" xref="S3.SS2.p3.9.m9.2.3.2"><ci id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">𝑀</ci><ci id="S3.SS2.p3.9.m9.2.2.cmml" xref="S3.SS2.p3.9.m9.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.2c">(M,Y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.2d">( italic_M , italic_Y )</annotation></semantics></math>. <math alttext="(X,M)" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.2"><semantics id="S3.SS2.p3.10.m10.2a"><mrow id="S3.SS2.p3.10.m10.2.3.2" xref="S3.SS2.p3.10.m10.2.3.1.cmml"><mo id="S3.SS2.p3.10.m10.2.3.2.1" stretchy="false" xref="S3.SS2.p3.10.m10.2.3.1.cmml">(</mo><mi id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml">X</mi><mo id="S3.SS2.p3.10.m10.2.3.2.2" xref="S3.SS2.p3.10.m10.2.3.1.cmml">,</mo><mi id="S3.SS2.p3.10.m10.2.2" xref="S3.SS2.p3.10.m10.2.2.cmml">M</mi><mo id="S3.SS2.p3.10.m10.2.3.2.3" stretchy="false" xref="S3.SS2.p3.10.m10.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.2b"><interval closure="open" id="S3.SS2.p3.10.m10.2.3.1.cmml" xref="S3.SS2.p3.10.m10.2.3.2"><ci id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">𝑋</ci><ci id="S3.SS2.p3.10.m10.2.2.cmml" xref="S3.SS2.p3.10.m10.2.2">𝑀</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.2c">(X,M)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m10.2d">( italic_X , italic_M )</annotation></semantics></math> are not affected by the back-door path <math alttext="X\leftarrow U\rightarrow Y\leftarrow M" class="ltx_Math" display="inline" id="S3.SS2.p3.11.m11.1"><semantics id="S3.SS2.p3.11.m11.1a"><mrow id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml"><mi id="S3.SS2.p3.11.m11.1.1.2" xref="S3.SS2.p3.11.m11.1.1.2.cmml">X</mi><mo id="S3.SS2.p3.11.m11.1.1.3" stretchy="false" xref="S3.SS2.p3.11.m11.1.1.3.cmml">←</mo><mi id="S3.SS2.p3.11.m11.1.1.4" xref="S3.SS2.p3.11.m11.1.1.4.cmml">U</mi><mo id="S3.SS2.p3.11.m11.1.1.5" stretchy="false" xref="S3.SS2.p3.11.m11.1.1.5.cmml">→</mo><mi id="S3.SS2.p3.11.m11.1.1.6" xref="S3.SS2.p3.11.m11.1.1.6.cmml">Y</mi><mo id="S3.SS2.p3.11.m11.1.1.7" stretchy="false" xref="S3.SS2.p3.11.m11.1.1.7.cmml">←</mo><mi id="S3.SS2.p3.11.m11.1.1.8" xref="S3.SS2.p3.11.m11.1.1.8.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.1b"><apply id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1"><and id="S3.SS2.p3.11.m11.1.1a.cmml" xref="S3.SS2.p3.11.m11.1.1"></and><apply id="S3.SS2.p3.11.m11.1.1b.cmml" xref="S3.SS2.p3.11.m11.1.1"><ci id="S3.SS2.p3.11.m11.1.1.3.cmml" xref="S3.SS2.p3.11.m11.1.1.3">←</ci><ci id="S3.SS2.p3.11.m11.1.1.2.cmml" xref="S3.SS2.p3.11.m11.1.1.2">𝑋</ci><ci id="S3.SS2.p3.11.m11.1.1.4.cmml" xref="S3.SS2.p3.11.m11.1.1.4">𝑈</ci></apply><apply id="S3.SS2.p3.11.m11.1.1c.cmml" xref="S3.SS2.p3.11.m11.1.1"><ci id="S3.SS2.p3.11.m11.1.1.5.cmml" xref="S3.SS2.p3.11.m11.1.1.5">→</ci><share href="https://arxiv.org/html/2405.20626v1#S3.SS2.p3.11.m11.1.1.4.cmml" id="S3.SS2.p3.11.m11.1.1d.cmml" xref="S3.SS2.p3.11.m11.1.1"></share><ci id="S3.SS2.p3.11.m11.1.1.6.cmml" xref="S3.SS2.p3.11.m11.1.1.6">𝑌</ci></apply><apply id="S3.SS2.p3.11.m11.1.1e.cmml" xref="S3.SS2.p3.11.m11.1.1"><ci id="S3.SS2.p3.11.m11.1.1.7.cmml" xref="S3.SS2.p3.11.m11.1.1.7">←</ci><share href="https://arxiv.org/html/2405.20626v1#S3.SS2.p3.11.m11.1.1.6.cmml" id="S3.SS2.p3.11.m11.1.1f.cmml" xref="S3.SS2.p3.11.m11.1.1"></share><ci id="S3.SS2.p3.11.m11.1.1.8.cmml" xref="S3.SS2.p3.11.m11.1.1.8">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.1c">X\leftarrow U\rightarrow Y\leftarrow M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.11.m11.1d">italic_X ← italic_U → italic_Y ← italic_M</annotation></semantics></math> thanks to the colliding effect (<span class="ltx_text ltx_font_italic" id="S3.SS2.p3.11.2">c.f.</span> Section <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.SS2" title="2.2 Front-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">2.2</span></a>). In addition, we show that we can improve the satisfaction of Requirement (ii) with causal feature distillation in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS3.SSS3" title="3.3.3 Feature Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">3.3.3</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.12">With the mediator, Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E5" title="In 2.2 Front-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5</span></a>) is an expectation over the conditional distribution <math alttext="P(m\mid X)" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">P</mi><mo id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p4.1.m1.1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p4.1.m1.1.1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.1.1.1.2.cmml">m</mi><mo id="S3.SS2.p4.1.m1.1.1.1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.SS2.p4.1.m1.1.1.1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.SS2.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><times id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2"></times><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝑃</ci><apply id="S3.SS2.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.2">𝑚</ci><ci id="S3.SS2.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">P(m\mid X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_P ( italic_m ∣ italic_X )</annotation></semantics></math>, and the prior distribution <math alttext="P(x)" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mrow id="S3.SS2.p4.2.m2.1.2" xref="S3.SS2.p4.2.m2.1.2.cmml"><mi id="S3.SS2.p4.2.m2.1.2.2" xref="S3.SS2.p4.2.m2.1.2.2.cmml">P</mi><mo id="S3.SS2.p4.2.m2.1.2.1" xref="S3.SS2.p4.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p4.2.m2.1.2.3.2" xref="S3.SS2.p4.2.m2.1.2.cmml"><mo id="S3.SS2.p4.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">x</mi><mo id="S3.SS2.p4.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.2.cmml" xref="S3.SS2.p4.2.m2.1.2"><times id="S3.SS2.p4.2.m2.1.2.1.cmml" xref="S3.SS2.p4.2.m2.1.2.1"></times><ci id="S3.SS2.p4.2.m2.1.2.2.cmml" xref="S3.SS2.p4.2.m2.1.2.2">𝑃</ci><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">P(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_P ( italic_x )</annotation></semantics></math>. First, we should sample different values <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_m</annotation></semantics></math> of <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">italic_M</annotation></semantics></math> given <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">italic_X</annotation></semantics></math> while a deterministic encoder can only output one <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><mi id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><ci id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">italic_m</annotation></semantics></math> given user data <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m7.1"><semantics id="S3.SS2.p4.7.m7.1a"><mi id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><ci id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m7.1d">italic_x</annotation></semantics></math>. Therefore, the sampling of <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p4.8.m8.1"><semantics id="S3.SS2.p4.8.m8.1a"><mi id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><ci id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.8.m8.1d">italic_M</annotation></semantics></math> given <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p4.9.m9.1"><semantics id="S3.SS2.p4.9.m9.1a"><mi id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><ci id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.9.m9.1d">italic_X</annotation></semantics></math> remains a challenge (<span class="ltx_text ltx_font_bold" id="S3.SS2.p4.12.1">Challenge 1</span>).
Second, the sample spaces of these two distributions are infinite, which makes the expectation calculation intractable. Moreover, the calculation of <math alttext="P(Y\mid m,x)" class="ltx_Math" display="inline" id="S3.SS2.p4.10.m10.3"><semantics id="S3.SS2.p4.10.m10.3a"><mrow id="S3.SS2.p4.10.m10.3.3" xref="S3.SS2.p4.10.m10.3.3.cmml"><mi id="S3.SS2.p4.10.m10.3.3.3" xref="S3.SS2.p4.10.m10.3.3.3.cmml">P</mi><mo id="S3.SS2.p4.10.m10.3.3.2" xref="S3.SS2.p4.10.m10.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.p4.10.m10.3.3.1.1" xref="S3.SS2.p4.10.m10.3.3.1.1.1.cmml"><mo id="S3.SS2.p4.10.m10.3.3.1.1.2" stretchy="false" xref="S3.SS2.p4.10.m10.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p4.10.m10.3.3.1.1.1" xref="S3.SS2.p4.10.m10.3.3.1.1.1.cmml"><mi id="S3.SS2.p4.10.m10.3.3.1.1.1.2" xref="S3.SS2.p4.10.m10.3.3.1.1.1.2.cmml">Y</mi><mo id="S3.SS2.p4.10.m10.3.3.1.1.1.1" xref="S3.SS2.p4.10.m10.3.3.1.1.1.1.cmml">∣</mo><mrow id="S3.SS2.p4.10.m10.3.3.1.1.1.3.2" xref="S3.SS2.p4.10.m10.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.p4.10.m10.1.1" xref="S3.SS2.p4.10.m10.1.1.cmml">m</mi><mo id="S3.SS2.p4.10.m10.3.3.1.1.1.3.2.1" xref="S3.SS2.p4.10.m10.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p4.10.m10.2.2" xref="S3.SS2.p4.10.m10.2.2.cmml">x</mi></mrow></mrow><mo id="S3.SS2.p4.10.m10.3.3.1.1.3" stretchy="false" xref="S3.SS2.p4.10.m10.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m10.3b"><apply id="S3.SS2.p4.10.m10.3.3.cmml" xref="S3.SS2.p4.10.m10.3.3"><times id="S3.SS2.p4.10.m10.3.3.2.cmml" xref="S3.SS2.p4.10.m10.3.3.2"></times><ci id="S3.SS2.p4.10.m10.3.3.3.cmml" xref="S3.SS2.p4.10.m10.3.3.3">𝑃</ci><apply id="S3.SS2.p4.10.m10.3.3.1.1.1.cmml" xref="S3.SS2.p4.10.m10.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p4.10.m10.3.3.1.1.1.1.cmml" xref="S3.SS2.p4.10.m10.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p4.10.m10.3.3.1.1.1.2.cmml" xref="S3.SS2.p4.10.m10.3.3.1.1.1.2">𝑌</ci><list id="S3.SS2.p4.10.m10.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p4.10.m10.3.3.1.1.1.3.2"><ci id="S3.SS2.p4.10.m10.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1">𝑚</ci><ci id="S3.SS2.p4.10.m10.2.2.cmml" xref="S3.SS2.p4.10.m10.2.2">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m10.3c">P(Y\mid m,x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.10.m10.3d">italic_P ( italic_Y ∣ italic_m , italic_x )</annotation></semantics></math> for each <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.p4.11.m11.1"><semantics id="S3.SS2.p4.11.m11.1a"><mi id="S3.SS2.p4.11.m11.1.1" xref="S3.SS2.p4.11.m11.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m11.1b"><ci id="S3.SS2.p4.11.m11.1.1.cmml" xref="S3.SS2.p4.11.m11.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m11.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.11.m11.1d">italic_m</annotation></semantics></math> and <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p4.12.m12.1"><semantics id="S3.SS2.p4.12.m12.1a"><mi id="S3.SS2.p4.12.m12.1.1" xref="S3.SS2.p4.12.m12.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.12.m12.1b"><ci id="S3.SS2.p4.12.m12.1.1.cmml" xref="S3.SS2.p4.12.m12.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.12.m12.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.12.m12.1d">italic_x</annotation></semantics></math> is computationally expensive.
Therefore, how to derive a proper approximation for expectation calculation, while preserving the <span class="ltx_text ltx_font_bold" id="S3.SS2.p4.12.2">inference efficiency</span> due to the latency restrictions in recommender systems, presents the second challenge (<span class="ltx_text ltx_font_bold" id="S3.SS2.p4.12.3">Challenge 2</span>).</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span class="ltx_text ltx_font_italic" id="S3.SS3.1.1">Causal Multi-teacher Distillation</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.3">The ultimate goal of our method is to learn a recommendation model that could efficiently estimate the causal effect of user historical behaviors on the next behavior by handling unobserved confounders with FDA. The implementation of FDA faces the above two challenges in recommendation. To address <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.3.3">Challenge 1</span>, we propose to incorporate heterogeneous recommendation models where each model yields one mediator value <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_m</annotation></semantics></math>.
<span class="ltx_text" id="S3.SS3.p1.3.2">As for <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.3.2.1">challenge 2</span>, we approximate the computationally expensive expectation calculation (<span class="ltx_text ltx_font_italic" id="S3.SS3.p1.3.2.2">cf</span>. Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E5" title="In 2.2 Front-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5</span></a>)), which enumerates each sampled <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.p1.2.1.m1.1"><semantics id="S3.SS3.p1.2.1.m1.1a"><mi id="S3.SS3.p1.2.1.m1.1.1" xref="S3.SS3.p1.2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.1.m1.1b"><ci id="S3.SS3.p1.2.1.m1.1.1.cmml" xref="S3.SS3.p1.2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.1.m1.1d">italic_m</annotation></semantics></math> and <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p1.3.2.m2.1"><semantics id="S3.SS3.p1.3.2.m2.1a"><mi id="S3.SS3.p1.3.2.m2.1.1" xref="S3.SS3.p1.3.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.2.m2.1b"><ci id="S3.SS3.p1.3.2.m2.1.1.cmml" xref="S3.SS3.p1.3.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.2.m2.1d">italic_x</annotation></semantics></math> with knowledge distillation. That is, we first estimates the causal effects using heterogeneous teacher models (computationally expensive), and transfer the knowledge into an efficient student model (computationally light-weight). The student directly estimates the effect while trying to approaching the causal effect estimated by teachers via distillation losses.<span class="ltx_text" id="S3.SS3.p1.3.2.3">
By unifying heterogeneous teachers and knowledge distillation, we propose the causal multi-teacher distillation framework, namely <span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS3.p1.3.2.3.1" style="color:#000000;">CausalD</span>.
In the following, we dive into the technical details of constructing heterogeneous teachers, performing FDA with heterogeneous teachers, and how we define the distillation losses. Key notations are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.T1" title="TABLE I ‣ 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">I</span></a>.</span></span></p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Constructing Heterogeneous Teachers</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.4">We can split training recommendation data samples <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">caligraphic_D</annotation></semantics></math> into non-IID subsets <math alttext="\{\mathcal{D}_{1},\mathcal{D}_{2},\dots,\mathcal{D}_{K}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.4"><semantics id="S3.SS3.SSS1.p1.2.m2.4a"><mrow id="S3.SS3.SSS1.p1.2.m2.4.4.3" xref="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml"><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.4" stretchy="false" xref="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml">{</mo><msub id="S3.SS3.SSS1.p1.2.m2.2.2.1.1" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.2" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.3" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.5" xref="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.SSS1.p1.2.m2.3.3.2.2" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.cmml">𝒟</mi><mn id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.3" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.6" xref="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml">,</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.7" xref="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.SSS1.p1.2.m2.4.4.3.3" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.2" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.2.cmml">𝒟</mi><mi id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.cmml">K</mi></msub><mo id="S3.SS3.SSS1.p1.2.m2.4.4.3.8" stretchy="false" xref="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.4b"><set id="S3.SS3.SSS1.p1.2.m2.4.4.4.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3"><apply id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.2">𝒟</ci><cn id="S3.SS3.SSS1.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.2">𝒟</ci><cn id="S3.SS3.SSS1.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">…</ci><apply id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.2">𝒟</ci><ci id="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.4c">\{\mathcal{D}_{1},\mathcal{D}_{2},\dots,\mathcal{D}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.4d">{ caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , caligraphic_D start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> via biased selection <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.4.1">w</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.4.2">r</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.4.3">t</span>. some user attributes or unsupervised clustering. For example, we can select data samples linked with male and female users into two subsets, which have different data distributions due to the interest discrepancy between male and female users. In an extreme case, the user attribute is the user ID where each subset corresponds to a particular user.
In practice, we choose the attribute related to an observed confounder of interest, such as user activeness or user behavior consistency. We illustrate that such a split could improve feature distillation in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS3.SSS3" title="3.3.3 Feature Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">3.3.3</span></a>.
We train one teacher model per subset, resulting in <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m3.1"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><mi id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><ci id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.1d">italic_K</annotation></semantics></math> heterogeneous teacher models that encode different data information.
Each teacher contains an encoder, which extracts latent factors (mediator) from user historical behaviors, and a predictor, which makes recommendation predictions based on the latent factors and the target-item feature. We denote the encoders of pre-trained heterogeneous teacher models as <math alttext="\Phi=\{\phi_{k}\}_{k=1,\dots,K}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.4.m4.4"><semantics id="S3.SS3.SSS1.p1.4.m4.4a"><mrow id="S3.SS3.SSS1.p1.4.m4.4.4" xref="S3.SS3.SSS1.p1.4.m4.4.4.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.4.4.3" mathvariant="normal" xref="S3.SS3.SSS1.p1.4.m4.4.4.3.cmml">Φ</mi><mo id="S3.SS3.SSS1.p1.4.m4.4.4.2" xref="S3.SS3.SSS1.p1.4.m4.4.4.2.cmml">=</mo><msub id="S3.SS3.SSS1.p1.4.m4.4.4.1" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.cmml"><mrow id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.2.cmml"><mo id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.2.cmml">{</mo><msub id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.2" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.3" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS1.p1.4.m4.3.3.3" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.3.3.3.5" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.5.cmml">k</mi><mo id="S3.SS3.SSS1.p1.4.m4.3.3.3.4" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.4.m4.3.3.3.6.2" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.6.1.cmml"><mn id="S3.SS3.SSS1.p1.4.m4.1.1.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.1.1.cmml">1</mn><mo id="S3.SS3.SSS1.p1.4.m4.3.3.3.6.2.1" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.6.1.cmml">,</mo><mi id="S3.SS3.SSS1.p1.4.m4.2.2.2.2" mathvariant="normal" xref="S3.SS3.SSS1.p1.4.m4.2.2.2.2.cmml">…</mi><mo id="S3.SS3.SSS1.p1.4.m4.3.3.3.6.2.2" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.6.1.cmml">,</mo><mi id="S3.SS3.SSS1.p1.4.m4.3.3.3.3" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.3.cmml">K</mi></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.4b"><apply id="S3.SS3.SSS1.p1.4.m4.4.4.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4"><eq id="S3.SS3.SSS1.p1.4.m4.4.4.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.2"></eq><ci id="S3.SS3.SSS1.p1.4.m4.4.4.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.3">Φ</ci><apply id="S3.SS3.SSS1.p1.4.m4.4.4.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.4.4.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.1">subscript</csymbol><set id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1"><apply id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.2">italic-ϕ</ci><ci id="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.4.4.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS3.SSS1.p1.4.m4.3.3.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.3.3.3"><eq id="S3.SS3.SSS1.p1.4.m4.3.3.3.4.cmml" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.4"></eq><ci id="S3.SS3.SSS1.p1.4.m4.3.3.3.5.cmml" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.5">𝑘</ci><list id="S3.SS3.SSS1.p1.4.m4.3.3.3.6.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.6.2"><cn id="S3.SS3.SSS1.p1.4.m4.1.1.1.1.cmml" type="integer" xref="S3.SS3.SSS1.p1.4.m4.1.1.1.1">1</cn><ci id="S3.SS3.SSS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.2.2.2.2">…</ci><ci id="S3.SS3.SSS1.p1.4.m4.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.3.3.3.3">𝐾</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.4c">\Phi=\{\phi_{k}\}_{k=1,\dots,K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.4.m4.4d">roman_Φ = { italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 , … , italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, which will be used for obtaining mediator values. In the experiments (<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.4.4">cf</span>. Section <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.SS4" title="5.4 In-depth Model Analysis (RQ3) ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5.4</span></a>), we show that the CausalD framework significantly benefits more from heterogeneous teachers than homogeneous teachers trained on IID subsets, validating the rationality of constructing heterogeneous teachers for sampling mediator values.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.1">The model architecture of each teacher remains the same as the student model.
Therefore, the models are <span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS3.SSS1.p2.1.1" style="color:#000000;">unprivileged</span> teachers <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p2.1.2">w</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p2.1.3">r</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p2.1.4">t</span>. the student. A teacher is unprivileged if it has the same model architecture as the student and is trained on a subset of the dataset used to train the student.
In other words, unprivileged teachers will bring no additional dataset knowledge nor model structure knowledge during distillation. This design permits a fair comparison with baseline models trained without distillation. In practice, incorporating additional features or higher-capacity model architectures <span class="ltx_text" id="S3.SS3.SSS1.p2.1.5">are<span class="ltx_text" id="S3.SS3.SSS1.p2.1.5.1"> acceptable for FDA and might further improve the recommendation performance, which is beyond the scope of this paper.</span></span></p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Front-door Adjustment for Causal Label Distillation</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.5">To estimate the causal effect with FDA, we sample multiple mediator values <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mi id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><ci id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_m</annotation></semantics></math> with heterogeneous teachers and multiple <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m2.1"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m2.1d">italic_x</annotation></semantics></math> using the in-batch sampling strategy. We then calculate the causal effect as the expectation of <math alttext="P(Y\mid M=m,X=x)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.3.m3.1"><semantics id="S3.SS3.SSS2.p1.3.m3.1a"><mrow id="S3.SS3.SSS2.p1.3.m3.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p1.3.m3.1.1.3" xref="S3.SS3.SSS2.p1.3.m3.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS2.p1.3.m3.1.1.2" xref="S3.SS3.SSS2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml"><mo id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.3.cmml"><mrow id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.1.cmml">∣</mo><mi id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.3.cmml">M</mi></mrow><mo id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.3" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.2" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.2.cmml">X</mi><mo id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.1.cmml">=</mo><mi id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.3" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.3.cmml">x</mi></mrow></mrow><mo id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m3.1b"><apply id="S3.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1"><times id="S3.SS3.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.2"></times><ci id="S3.SS3.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.3">𝑃</ci><apply id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.3a.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1"><eq id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.1"></eq><apply id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.2">𝑌</ci><ci id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.3">𝑀</ci></apply><ci id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2"><eq id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.1"></eq><ci id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.2">𝑋</ci><ci id="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.1.1.2.2.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m3.1c">P(Y\mid M=m,X=x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.3.m3.1d">italic_P ( italic_Y ∣ italic_M = italic_m , italic_X = italic_x )</annotation></semantics></math>, which is modeled as a neural network, over sampled <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.4.m4.1"><semantics id="S3.SS3.SSS2.p1.4.m4.1a"><mi id="S3.SS3.SSS2.p1.4.m4.1.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.4.m4.1b"><ci id="S3.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.4.m4.1d">italic_m</annotation></semantics></math> and <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.5.m5.1"><semantics id="S3.SS3.SSS2.p1.5.m5.1a"><mi id="S3.SS3.SSS2.p1.5.m5.1.1" xref="S3.SS3.SSS2.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.5.m5.1b"><ci id="S3.SS3.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.5.m5.1d">italic_x</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p1.5.1">c.f.</span> Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E5" title="In 2.2 Front-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5</span></a>)). The causal effect is the distillation label for training the student recommendation model.
Specifically, the expectation calculation in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E5" title="In 2.2 Front-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5</span></a>) can be decomposed into the following sub-processes:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.p2.6"><span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p2.1.1">Sampling of <math alttext="M=m" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.1.m1.1"><semantics id="S3.SS3.SSS2.p2.1.1.m1.1a"><mrow id="S3.SS3.SSS2.p2.1.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.1.1.m1.1.1.2" xref="S3.SS3.SSS2.p2.1.1.m1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS2.p2.1.1.m1.1.1.1" xref="S3.SS3.SSS2.p2.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.SS3.SSS2.p2.1.1.m1.1.1.3" xref="S3.SS3.SSS2.p2.1.1.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.1.m1.1b"><apply id="S3.SS3.SSS2.p2.1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.1.m1.1.1"><eq id="S3.SS3.SSS2.p2.1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.1.m1.1.1.1"></eq><ci id="S3.SS3.SSS2.p2.1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.1.m1.1.1.2">𝑀</ci><ci id="S3.SS3.SSS2.p2.1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.1.m1.1c">M=m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.1.1.m1.1d">italic_M = italic_m</annotation></semantics></math>. </span> We use heterogeneous teacher recommendation models to do the sampling <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m1.1"><semantics id="S3.SS3.SSS2.p2.2.m1.1a"><mi id="S3.SS3.SSS2.p2.2.m1.1.1" xref="S3.SS3.SSS2.p2.2.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m1.1b"><ci id="S3.SS3.SSS2.p2.2.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.2.m1.1d">italic_M</annotation></semantics></math> given <math alttext="X" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.3.m2.1"><semantics id="S3.SS3.SSS2.p2.3.m2.1a"><mi id="S3.SS3.SSS2.p2.3.m2.1.1" xref="S3.SS3.SSS2.p2.3.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m2.1b"><ci id="S3.SS3.SSS2.p2.3.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.3.m2.1d">italic_X</annotation></semantics></math>. Given input <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.4.m3.1"><semantics id="S3.SS3.SSS2.p2.4.m3.1a"><msub id="S3.SS3.SSS2.p2.4.m3.1.1" xref="S3.SS3.SSS2.p2.4.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p2.4.m3.1.1.2" xref="S3.SS3.SSS2.p2.4.m3.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p2.4.m3.1.1.3" xref="S3.SS3.SSS2.p2.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m3.1b"><apply id="S3.SS3.SSS2.p2.4.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.4.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.4.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.4.m3.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p2.4.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m3.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.4.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, the encoders <math alttext="\Phi=\{\phi_{k}\}_{k=1,\dots,K}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.5.m4.4"><semantics id="S3.SS3.SSS2.p2.5.m4.4a"><mrow id="S3.SS3.SSS2.p2.5.m4.4.4" xref="S3.SS3.SSS2.p2.5.m4.4.4.cmml"><mi id="S3.SS3.SSS2.p2.5.m4.4.4.3" mathvariant="normal" xref="S3.SS3.SSS2.p2.5.m4.4.4.3.cmml">Φ</mi><mo id="S3.SS3.SSS2.p2.5.m4.4.4.2" xref="S3.SS3.SSS2.p2.5.m4.4.4.2.cmml">=</mo><msub id="S3.SS3.SSS2.p2.5.m4.4.4.1" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.cmml"><mrow id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.2.cmml"><mo id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.2.cmml">{</mo><msub id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.2" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.3" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS2.p2.5.m4.3.3.3" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.5.m4.3.3.3.5" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.5.cmml">k</mi><mo id="S3.SS3.SSS2.p2.5.m4.3.3.3.4" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.4.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.5.m4.3.3.3.6.2" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.6.1.cmml"><mn id="S3.SS3.SSS2.p2.5.m4.1.1.1.1" xref="S3.SS3.SSS2.p2.5.m4.1.1.1.1.cmml">1</mn><mo id="S3.SS3.SSS2.p2.5.m4.3.3.3.6.2.1" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.6.1.cmml">,</mo><mi id="S3.SS3.SSS2.p2.5.m4.2.2.2.2" mathvariant="normal" xref="S3.SS3.SSS2.p2.5.m4.2.2.2.2.cmml">…</mi><mo id="S3.SS3.SSS2.p2.5.m4.3.3.3.6.2.2" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.6.1.cmml">,</mo><mi id="S3.SS3.SSS2.p2.5.m4.3.3.3.3" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.3.cmml">K</mi></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m4.4b"><apply id="S3.SS3.SSS2.p2.5.m4.4.4.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4"><eq id="S3.SS3.SSS2.p2.5.m4.4.4.2.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.2"></eq><ci id="S3.SS3.SSS2.p2.5.m4.4.4.3.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.3">Φ</ci><apply id="S3.SS3.SSS2.p2.5.m4.4.4.1.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m4.4.4.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.1">subscript</csymbol><set id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1"><apply id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.2">italic-ϕ</ci><ci id="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m4.4.4.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS3.SSS2.p2.5.m4.3.3.3.cmml" xref="S3.SS3.SSS2.p2.5.m4.3.3.3"><eq id="S3.SS3.SSS2.p2.5.m4.3.3.3.4.cmml" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.4"></eq><ci id="S3.SS3.SSS2.p2.5.m4.3.3.3.5.cmml" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.5">𝑘</ci><list id="S3.SS3.SSS2.p2.5.m4.3.3.3.6.1.cmml" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.6.2"><cn id="S3.SS3.SSS2.p2.5.m4.1.1.1.1.cmml" type="integer" xref="S3.SS3.SSS2.p2.5.m4.1.1.1.1">1</cn><ci id="S3.SS3.SSS2.p2.5.m4.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.5.m4.2.2.2.2">…</ci><ci id="S3.SS3.SSS2.p2.5.m4.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.5.m4.3.3.3.3">𝐾</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m4.4c">\Phi=\{\phi_{k}\}_{k=1,\dots,K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.5.m4.4d">roman_Φ = { italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 , … , italic_K end_POSTSUBSCRIPT</annotation></semantics></math> of heterogeneous teacher models yield heterogeneous <math alttext="M=m" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.6.m5.1"><semantics id="S3.SS3.SSS2.p2.6.m5.1a"><mrow id="S3.SS3.SSS2.p2.6.m5.1.1" xref="S3.SS3.SSS2.p2.6.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p2.6.m5.1.1.2" xref="S3.SS3.SSS2.p2.6.m5.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS2.p2.6.m5.1.1.1" xref="S3.SS3.SSS2.p2.6.m5.1.1.1.cmml">=</mo><mi id="S3.SS3.SSS2.p2.6.m5.1.1.3" xref="S3.SS3.SSS2.p2.6.m5.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m5.1b"><apply id="S3.SS3.SSS2.p2.6.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m5.1.1"><eq id="S3.SS3.SSS2.p2.6.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m5.1.1.1"></eq><ci id="S3.SS3.SSS2.p2.6.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m5.1.1.2">𝑀</ci><ci id="S3.SS3.SSS2.p2.6.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m5.1c">M=m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.6.m5.1d">italic_M = italic_m</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx6">
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\tilde{m}}_{k,i}=\phi_{k}(x_{i}),\quad k=1,\dots,K," class="ltx_Math" display="inline" id="S3.E9.m1.6"><semantics id="S3.E9.m1.6a"><mrow id="S3.E9.m1.6.6.1"><mrow id="S3.E9.m1.6.6.1.1.2" xref="S3.E9.m1.6.6.1.1.3.cmml"><mrow id="S3.E9.m1.6.6.1.1.1.1" xref="S3.E9.m1.6.6.1.1.1.1.cmml"><msub id="S3.E9.m1.6.6.1.1.1.1.3" xref="S3.E9.m1.6.6.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.6.6.1.1.1.1.3.2" xref="S3.E9.m1.6.6.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.6.6.1.1.1.1.3.2.2" xref="S3.E9.m1.6.6.1.1.1.1.3.2.2.cmml">𝐦</mi><mo id="S3.E9.m1.6.6.1.1.1.1.3.2.1" xref="S3.E9.m1.6.6.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="S3.E9.m1.2.2.2.4" xref="S3.E9.m1.2.2.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">k</mi><mo id="S3.E9.m1.2.2.2.4.1" xref="S3.E9.m1.2.2.2.3.cmml">,</mo><mi id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E9.m1.6.6.1.1.1.1.2" xref="S3.E9.m1.6.6.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.6.6.1.1.1.1.1" xref="S3.E9.m1.6.6.1.1.1.1.1.cmml"><msub id="S3.E9.m1.6.6.1.1.1.1.1.3" xref="S3.E9.m1.6.6.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.6.6.1.1.1.1.1.3.2" xref="S3.E9.m1.6.6.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S3.E9.m1.6.6.1.1.1.1.1.3.3" xref="S3.E9.m1.6.6.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E9.m1.6.6.1.1.1.1.1.2" xref="S3.E9.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.6.6.1.1.1.1.1.1.1" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m1.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m1.6.6.1.1.2.3" rspace="1.167em" xref="S3.E9.m1.6.6.1.1.3a.cmml">,</mo><mrow id="S3.E9.m1.6.6.1.1.2.2" xref="S3.E9.m1.6.6.1.1.2.2.cmml"><mi id="S3.E9.m1.6.6.1.1.2.2.2" mathcolor="#000000" xref="S3.E9.m1.6.6.1.1.2.2.2.cmml">k</mi><mo id="S3.E9.m1.6.6.1.1.2.2.1" xref="S3.E9.m1.6.6.1.1.2.2.1.cmml">=</mo><mrow id="S3.E9.m1.6.6.1.1.2.2.3.2" xref="S3.E9.m1.6.6.1.1.2.2.3.1.cmml"><mn id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">1</mn><mo id="S3.E9.m1.6.6.1.1.2.2.3.2.1" xref="S3.E9.m1.6.6.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E9.m1.4.4" mathvariant="normal" xref="S3.E9.m1.4.4.cmml">…</mi><mo id="S3.E9.m1.6.6.1.1.2.2.3.2.2" xref="S3.E9.m1.6.6.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E9.m1.5.5" mathcolor="#000000" xref="S3.E9.m1.5.5.cmml">K</mi></mrow></mrow></mrow><mo id="S3.E9.m1.6.6.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.6b"><apply id="S3.E9.m1.6.6.1.1.3.cmml" xref="S3.E9.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.1.1.3a.cmml" xref="S3.E9.m1.6.6.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E9.m1.6.6.1.1.1.1.cmml" xref="S3.E9.m1.6.6.1.1.1.1"><eq id="S3.E9.m1.6.6.1.1.1.1.2.cmml" xref="S3.E9.m1.6.6.1.1.1.1.2"></eq><apply id="S3.E9.m1.6.6.1.1.1.1.3.cmml" xref="S3.E9.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.E9.m1.6.6.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.6.6.1.1.1.1.3.2.cmml" xref="S3.E9.m1.6.6.1.1.1.1.3.2"><ci id="S3.E9.m1.6.6.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.6.6.1.1.1.1.3.2.1">~</ci><ci id="S3.E9.m1.6.6.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.6.6.1.1.1.1.3.2.2">𝐦</ci></apply><list id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.4"><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝑘</ci><ci id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E9.m1.6.6.1.1.1.1.1.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1"><times id="S3.E9.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.2"></times><apply id="S3.E9.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.E9.m1.6.6.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.6.6.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E9.m1.6.6.1.1.2.2.cmml" xref="S3.E9.m1.6.6.1.1.2.2"><eq id="S3.E9.m1.6.6.1.1.2.2.1.cmml" xref="S3.E9.m1.6.6.1.1.2.2.1"></eq><ci id="S3.E9.m1.6.6.1.1.2.2.2.cmml" xref="S3.E9.m1.6.6.1.1.2.2.2">𝑘</ci><list id="S3.E9.m1.6.6.1.1.2.2.3.1.cmml" xref="S3.E9.m1.6.6.1.1.2.2.3.2"><cn id="S3.E9.m1.3.3.cmml" type="integer" xref="S3.E9.m1.3.3">1</cn><ci id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4">…</ci><ci id="S3.E9.m1.5.5.cmml" xref="S3.E9.m1.5.5">𝐾</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.6c">\displaystyle\mathbf{\tilde{m}}_{k,i}=\phi_{k}(x_{i}),\quad k=1,\dots,K,</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.6d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT = italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_k = 1 , … , italic_K ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.13">where <math alttext="\mathbf{\tilde{m}}_{k,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.7.m1.2"><semantics id="S3.SS3.SSS2.p2.7.m1.2a"><msub id="S3.SS3.SSS2.p2.7.m1.2.3" xref="S3.SS3.SSS2.p2.7.m1.2.3.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.7.m1.2.3.2" xref="S3.SS3.SSS2.p2.7.m1.2.3.2.cmml"><mi id="S3.SS3.SSS2.p2.7.m1.2.3.2.2" xref="S3.SS3.SSS2.p2.7.m1.2.3.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p2.7.m1.2.3.2.1" xref="S3.SS3.SSS2.p2.7.m1.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.SSS2.p2.7.m1.2.2.2.4" xref="S3.SS3.SSS2.p2.7.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.7.m1.1.1.1.1" xref="S3.SS3.SSS2.p2.7.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p2.7.m1.2.2.2.4.1" xref="S3.SS3.SSS2.p2.7.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p2.7.m1.2.2.2.2" xref="S3.SS3.SSS2.p2.7.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m1.2b"><apply id="S3.SS3.SSS2.p2.7.m1.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.2.3">subscript</csymbol><apply id="S3.SS3.SSS2.p2.7.m1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m1.2.3.2"><ci id="S3.SS3.SSS2.p2.7.m1.2.3.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.2.3.2.1">~</ci><ci id="S3.SS3.SSS2.p2.7.m1.2.3.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m1.2.3.2.2">𝐦</ci></apply><list id="S3.SS3.SSS2.p2.7.m1.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m1.2.2.2.4"><ci id="S3.SS3.SSS2.p2.7.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m1.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p2.7.m1.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m1.2c">\mathbf{\tilde{m}}_{k,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.7.m1.2d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the feature of mediator value <math alttext="{m}_{k,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.8.m2.2"><semantics id="S3.SS3.SSS2.p2.8.m2.2a"><msub id="S3.SS3.SSS2.p2.8.m2.2.3" xref="S3.SS3.SSS2.p2.8.m2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.8.m2.2.3.2" xref="S3.SS3.SSS2.p2.8.m2.2.3.2.cmml">m</mi><mrow id="S3.SS3.SSS2.p2.8.m2.2.2.2.4" xref="S3.SS3.SSS2.p2.8.m2.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.8.m2.1.1.1.1" xref="S3.SS3.SSS2.p2.8.m2.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p2.8.m2.2.2.2.4.1" xref="S3.SS3.SSS2.p2.8.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p2.8.m2.2.2.2.2" xref="S3.SS3.SSS2.p2.8.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m2.2b"><apply id="S3.SS3.SSS2.p2.8.m2.2.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.8.m2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.2.3.2">𝑚</ci><list id="S3.SS3.SSS2.p2.8.m2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.8.m2.2.2.2.4"><ci id="S3.SS3.SSS2.p2.8.m2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m2.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p2.8.m2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.8.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m2.2c">{m}_{k,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.8.m2.2d">italic_m start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> encoded by <math alttext="\phi_{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.9.m3.1"><semantics id="S3.SS3.SSS2.p2.9.m3.1a"><msub id="S3.SS3.SSS2.p2.9.m3.1.1" xref="S3.SS3.SSS2.p2.9.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p2.9.m3.1.1.2" xref="S3.SS3.SSS2.p2.9.m3.1.1.2.cmml">ϕ</mi><mi id="S3.SS3.SSS2.p2.9.m3.1.1.3" xref="S3.SS3.SSS2.p2.9.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.9.m3.1b"><apply id="S3.SS3.SSS2.p2.9.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.2">italic-ϕ</ci><ci id="S3.SS3.SSS2.p2.9.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.9.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.9.m3.1c">\phi_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.9.m3.1d">italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> given the input <math alttext="X=x_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.10.m4.1"><semantics id="S3.SS3.SSS2.p2.10.m4.1a"><mrow id="S3.SS3.SSS2.p2.10.m4.1.1" xref="S3.SS3.SSS2.p2.10.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p2.10.m4.1.1.2" xref="S3.SS3.SSS2.p2.10.m4.1.1.2.cmml">X</mi><mo id="S3.SS3.SSS2.p2.10.m4.1.1.1" xref="S3.SS3.SSS2.p2.10.m4.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS2.p2.10.m4.1.1.3" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.10.m4.1.1.3.2" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.2.cmml">x</mi><mi id="S3.SS3.SSS2.p2.10.m4.1.1.3.3" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.10.m4.1b"><apply id="S3.SS3.SSS2.p2.10.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1"><eq id="S3.SS3.SSS2.p2.10.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.1"></eq><ci id="S3.SS3.SSS2.p2.10.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.2">𝑋</ci><apply id="S3.SS3.SSS2.p2.10.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m4.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m4.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.2">𝑥</ci><ci id="S3.SS3.SSS2.p2.10.m4.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.10.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.10.m4.1c">X=x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.10.m4.1d">italic_X = italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
As for the modeling of <math alttext="P(M=m_{k,i}\mid X)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.11.m5.3"><semantics id="S3.SS3.SSS2.p2.11.m5.3a"><mrow id="S3.SS3.SSS2.p2.11.m5.3.3" xref="S3.SS3.SSS2.p2.11.m5.3.3.cmml"><mi id="S3.SS3.SSS2.p2.11.m5.3.3.3" xref="S3.SS3.SSS2.p2.11.m5.3.3.3.cmml">P</mi><mo id="S3.SS3.SSS2.p2.11.m5.3.3.2" xref="S3.SS3.SSS2.p2.11.m5.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p2.11.m5.3.3.1.1" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.cmml"><mo id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.2" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.1" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.cmml"><msub id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2.cmml"><mi id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2.2" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2.2.cmml">m</mi><mrow id="S3.SS3.SSS2.p2.11.m5.2.2.2.4" xref="S3.SS3.SSS2.p2.11.m5.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.11.m5.1.1.1.1" xref="S3.SS3.SSS2.p2.11.m5.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p2.11.m5.2.2.2.4.1" xref="S3.SS3.SSS2.p2.11.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p2.11.m5.2.2.2.2" xref="S3.SS3.SSS2.p2.11.m5.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.1" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.1.cmml">∣</mo><mi id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.3" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.11.m5.3b"><apply id="S3.SS3.SSS2.p2.11.m5.3.3.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3"><times id="S3.SS3.SSS2.p2.11.m5.3.3.2.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.2"></times><ci id="S3.SS3.SSS2.p2.11.m5.3.3.3.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.3">𝑃</ci><apply id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1"><eq id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.1"></eq><ci id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.2">𝑀</ci><apply id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3"><csymbol cd="latexml" id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.1">conditional</csymbol><apply id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2.1.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2.2.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.2.2">𝑚</ci><list id="S3.SS3.SSS2.p2.11.m5.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.11.m5.2.2.2.4"><ci id="S3.SS3.SSS2.p2.11.m5.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m5.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p2.11.m5.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.11.m5.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.11.m5.3.3.1.1.1.3.3">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.11.m5.3c">P(M=m_{k,i}\mid X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.11.m5.3d">italic_P ( italic_M = italic_m start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ∣ italic_X )</annotation></semantics></math>, we take a parametric solution, <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p2.13.1">i</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p2.13.2">e</span>., attention mechanism, and view the attention weights of <math alttext="X" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.12.m6.1"><semantics id="S3.SS3.SSS2.p2.12.m6.1a"><mi id="S3.SS3.SSS2.p2.12.m6.1.1" xref="S3.SS3.SSS2.p2.12.m6.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.12.m6.1b"><ci id="S3.SS3.SSS2.p2.12.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m6.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.12.m6.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.12.m6.1d">italic_X</annotation></semantics></math> on multiple <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.13.m7.1"><semantics id="S3.SS3.SSS2.p2.13.m7.1a"><mi id="S3.SS3.SSS2.p2.13.m7.1.1" xref="S3.SS3.SSS2.p2.13.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.13.m7.1b"><ci id="S3.SS3.SSS2.p2.13.m7.1.1.cmml" xref="S3.SS3.SSS2.p2.13.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.13.m7.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.13.m7.1d">italic_m</annotation></semantics></math> as the conditional probability.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx7">
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha_{k,i}=\frac{\exp(\mathbf{W}_{1}\mathbf{\tilde{m}}_{k,i}%
\cdot\mathbf{W}_{2}\mathbf{\hat{m}}_{i})}{\sum_{k}\exp(\mathbf{W}_{1}\mathbf{%
\tilde{m}}_{k,i}\cdot\mathbf{W}_{2}\mathbf{\hat{m}}_{i})},\quad\mathbf{\hat{m}%
}_{i}=\phi^{*}(x_{i})," class="ltx_Math" display="inline" id="S3.E10.m1.11"><semantics id="S3.E10.m1.11a"><mrow id="S3.E10.m1.11.11.1"><mrow id="S3.E10.m1.11.11.1.1.2" xref="S3.E10.m1.11.11.1.1.3.cmml"><mrow id="S3.E10.m1.11.11.1.1.1.1" xref="S3.E10.m1.11.11.1.1.1.1.cmml"><msub id="S3.E10.m1.11.11.1.1.1.1.2" xref="S3.E10.m1.11.11.1.1.1.1.2.cmml"><mi id="S3.E10.m1.11.11.1.1.1.1.2.2" xref="S3.E10.m1.11.11.1.1.1.1.2.2.cmml">α</mi><mrow id="S3.E10.m1.2.2.2.4" xref="S3.E10.m1.2.2.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">k</mi><mo id="S3.E10.m1.2.2.2.4.1" xref="S3.E10.m1.2.2.2.3.cmml">,</mo><mi id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E10.m1.11.11.1.1.1.1.1" xref="S3.E10.m1.11.11.1.1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E10.m1.10.10" xref="S3.E10.m1.10.10.cmml"><mfrac id="S3.E10.m1.10.10a" mathcolor="#000000" xref="S3.E10.m1.10.10.cmml"><mrow id="S3.E10.m1.6.6.4.4" xref="S3.E10.m1.6.6.4.5.cmml"><mi id="S3.E10.m1.5.5.3.3" mathcolor="#000000" xref="S3.E10.m1.5.5.3.3.cmml">exp</mi><mo id="S3.E10.m1.6.6.4.4a" xref="S3.E10.m1.6.6.4.5.cmml">⁡</mo><mrow id="S3.E10.m1.6.6.4.4.1" xref="S3.E10.m1.6.6.4.5.cmml"><mo id="S3.E10.m1.6.6.4.4.1.2" mathcolor="#000000" stretchy="false" xref="S3.E10.m1.6.6.4.5.cmml">(</mo><mrow id="S3.E10.m1.6.6.4.4.1.1" xref="S3.E10.m1.6.6.4.4.1.1.cmml"><mrow id="S3.E10.m1.6.6.4.4.1.1.2" xref="S3.E10.m1.6.6.4.4.1.1.2.cmml"><mrow id="S3.E10.m1.6.6.4.4.1.1.2.2" xref="S3.E10.m1.6.6.4.4.1.1.2.2.cmml"><msub id="S3.E10.m1.6.6.4.4.1.1.2.2.2" xref="S3.E10.m1.6.6.4.4.1.1.2.2.2.cmml"><mi id="S3.E10.m1.6.6.4.4.1.1.2.2.2.2" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.2.2.2.2.cmml">𝐖</mi><mn id="S3.E10.m1.6.6.4.4.1.1.2.2.2.3" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S3.E10.m1.6.6.4.4.1.1.2.2.1" xref="S3.E10.m1.6.6.4.4.1.1.2.2.1.cmml">⁢</mo><msub id="S3.E10.m1.6.6.4.4.1.1.2.2.3" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3.cmml"><mover accent="true" id="S3.E10.m1.6.6.4.4.1.1.2.2.3.2" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.cmml"><mi id="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.2" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.2.cmml">𝐦</mi><mo id="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.1" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.1.cmml">~</mo></mover><mrow id="S3.E10.m1.4.4.2.2.2.4" xref="S3.E10.m1.4.4.2.2.2.3.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1" mathcolor="#000000" xref="S3.E10.m1.3.3.1.1.1.1.cmml">k</mi><mo id="S3.E10.m1.4.4.2.2.2.4.1" mathcolor="#000000" xref="S3.E10.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S3.E10.m1.4.4.2.2.2.2" mathcolor="#000000" xref="S3.E10.m1.4.4.2.2.2.2.cmml">i</mi></mrow></msub></mrow><mo id="S3.E10.m1.6.6.4.4.1.1.2.1" lspace="0.222em" mathcolor="#000000" rspace="0.222em" xref="S3.E10.m1.6.6.4.4.1.1.2.1.cmml">⋅</mo><msub id="S3.E10.m1.6.6.4.4.1.1.2.3" xref="S3.E10.m1.6.6.4.4.1.1.2.3.cmml"><mi id="S3.E10.m1.6.6.4.4.1.1.2.3.2" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.2.3.2.cmml">𝐖</mi><mn id="S3.E10.m1.6.6.4.4.1.1.2.3.3" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="S3.E10.m1.6.6.4.4.1.1.1" xref="S3.E10.m1.6.6.4.4.1.1.1.cmml">⁢</mo><msub id="S3.E10.m1.6.6.4.4.1.1.3" xref="S3.E10.m1.6.6.4.4.1.1.3.cmml"><mover accent="true" id="S3.E10.m1.6.6.4.4.1.1.3.2" xref="S3.E10.m1.6.6.4.4.1.1.3.2.cmml"><mi id="S3.E10.m1.6.6.4.4.1.1.3.2.2" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.3.2.2.cmml">𝐦</mi><mo id="S3.E10.m1.6.6.4.4.1.1.3.2.1" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E10.m1.6.6.4.4.1.1.3.3" mathcolor="#000000" xref="S3.E10.m1.6.6.4.4.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E10.m1.6.6.4.4.1.3" mathcolor="#000000" stretchy="false" xref="S3.E10.m1.6.6.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E10.m1.10.10.8" xref="S3.E10.m1.10.10.8.cmml"><msub id="S3.E10.m1.10.10.8.5" xref="S3.E10.m1.10.10.8.5.cmml"><mo id="S3.E10.m1.10.10.8.5.2" mathcolor="#000000" xref="S3.E10.m1.10.10.8.5.2.cmml">∑</mo><mi id="S3.E10.m1.10.10.8.5.3" mathcolor="#000000" xref="S3.E10.m1.10.10.8.5.3.cmml">k</mi></msub><mrow id="S3.E10.m1.10.10.8.4.1" xref="S3.E10.m1.10.10.8.4.2.cmml"><mi id="S3.E10.m1.9.9.7.3" mathcolor="#000000" xref="S3.E10.m1.9.9.7.3.cmml">exp</mi><mo id="S3.E10.m1.10.10.8.4.1a" xref="S3.E10.m1.10.10.8.4.2.cmml">⁡</mo><mrow id="S3.E10.m1.10.10.8.4.1.1" xref="S3.E10.m1.10.10.8.4.2.cmml"><mo id="S3.E10.m1.10.10.8.4.1.1.2" mathcolor="#000000" stretchy="false" xref="S3.E10.m1.10.10.8.4.2.cmml">(</mo><mrow id="S3.E10.m1.10.10.8.4.1.1.1" xref="S3.E10.m1.10.10.8.4.1.1.1.cmml"><mrow id="S3.E10.m1.10.10.8.4.1.1.1.2" xref="S3.E10.m1.10.10.8.4.1.1.1.2.cmml"><mrow id="S3.E10.m1.10.10.8.4.1.1.1.2.2" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.cmml"><msub id="S3.E10.m1.10.10.8.4.1.1.1.2.2.2" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.cmml"><mi id="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.2" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.2.cmml">𝐖</mi><mn id="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.3" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S3.E10.m1.10.10.8.4.1.1.1.2.2.1" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.1.cmml">⁢</mo><msub id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.cmml"><mover accent="true" id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.cmml"><mi id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.2" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.2.cmml">𝐦</mi><mo id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.1" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.1.cmml">~</mo></mover><mrow id="S3.E10.m1.8.8.6.2.2.4" xref="S3.E10.m1.8.8.6.2.2.3.cmml"><mi id="S3.E10.m1.7.7.5.1.1.1" mathcolor="#000000" xref="S3.E10.m1.7.7.5.1.1.1.cmml">k</mi><mo id="S3.E10.m1.8.8.6.2.2.4.1" mathcolor="#000000" xref="S3.E10.m1.8.8.6.2.2.3.cmml">,</mo><mi id="S3.E10.m1.8.8.6.2.2.2" mathcolor="#000000" xref="S3.E10.m1.8.8.6.2.2.2.cmml">i</mi></mrow></msub></mrow><mo id="S3.E10.m1.10.10.8.4.1.1.1.2.1" lspace="0.222em" mathcolor="#000000" rspace="0.222em" xref="S3.E10.m1.10.10.8.4.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E10.m1.10.10.8.4.1.1.1.2.3" xref="S3.E10.m1.10.10.8.4.1.1.1.2.3.cmml"><mi id="S3.E10.m1.10.10.8.4.1.1.1.2.3.2" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.2.3.2.cmml">𝐖</mi><mn id="S3.E10.m1.10.10.8.4.1.1.1.2.3.3" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="S3.E10.m1.10.10.8.4.1.1.1.1" xref="S3.E10.m1.10.10.8.4.1.1.1.1.cmml">⁢</mo><msub id="S3.E10.m1.10.10.8.4.1.1.1.3" xref="S3.E10.m1.10.10.8.4.1.1.1.3.cmml"><mover accent="true" id="S3.E10.m1.10.10.8.4.1.1.1.3.2" xref="S3.E10.m1.10.10.8.4.1.1.1.3.2.cmml"><mi id="S3.E10.m1.10.10.8.4.1.1.1.3.2.2" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.3.2.2.cmml">𝐦</mi><mo id="S3.E10.m1.10.10.8.4.1.1.1.3.2.1" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E10.m1.10.10.8.4.1.1.1.3.3" mathcolor="#000000" xref="S3.E10.m1.10.10.8.4.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E10.m1.10.10.8.4.1.1.3" mathcolor="#000000" stretchy="false" xref="S3.E10.m1.10.10.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="S3.E10.m1.11.11.1.1.2.3" rspace="1.167em" xref="S3.E10.m1.11.11.1.1.3a.cmml">,</mo><mrow id="S3.E10.m1.11.11.1.1.2.2" xref="S3.E10.m1.11.11.1.1.2.2.cmml"><msub id="S3.E10.m1.11.11.1.1.2.2.3" xref="S3.E10.m1.11.11.1.1.2.2.3.cmml"><mover accent="true" id="S3.E10.m1.11.11.1.1.2.2.3.2" xref="S3.E10.m1.11.11.1.1.2.2.3.2.cmml"><mi id="S3.E10.m1.11.11.1.1.2.2.3.2.2" xref="S3.E10.m1.11.11.1.1.2.2.3.2.2.cmml">𝐦</mi><mo id="S3.E10.m1.11.11.1.1.2.2.3.2.1" xref="S3.E10.m1.11.11.1.1.2.2.3.2.1.cmml">^</mo></mover><mi id="S3.E10.m1.11.11.1.1.2.2.3.3" xref="S3.E10.m1.11.11.1.1.2.2.3.3.cmml">i</mi></msub><mo id="S3.E10.m1.11.11.1.1.2.2.2" xref="S3.E10.m1.11.11.1.1.2.2.2.cmml">=</mo><mrow id="S3.E10.m1.11.11.1.1.2.2.1" xref="S3.E10.m1.11.11.1.1.2.2.1.cmml"><msup id="S3.E10.m1.11.11.1.1.2.2.1.3" xref="S3.E10.m1.11.11.1.1.2.2.1.3.cmml"><mi id="S3.E10.m1.11.11.1.1.2.2.1.3.2" xref="S3.E10.m1.11.11.1.1.2.2.1.3.2.cmml">ϕ</mi><mo id="S3.E10.m1.11.11.1.1.2.2.1.3.3" xref="S3.E10.m1.11.11.1.1.2.2.1.3.3.cmml">∗</mo></msup><mo id="S3.E10.m1.11.11.1.1.2.2.1.2" xref="S3.E10.m1.11.11.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.11.11.1.1.2.2.1.1.1" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E10.m1.11.11.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.11.11.1.1.2.2.1.1.1.1" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.2" mathcolor="#000000" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.2.cmml">x</mi><mi id="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.3" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E10.m1.11.11.1.1.2.2.1.1.1.3" stretchy="false" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E10.m1.11.11.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.11b"><apply id="S3.E10.m1.11.11.1.1.3.cmml" xref="S3.E10.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.1.1.3a.cmml" xref="S3.E10.m1.11.11.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E10.m1.11.11.1.1.1.1.cmml" xref="S3.E10.m1.11.11.1.1.1.1"><eq id="S3.E10.m1.11.11.1.1.1.1.1.cmml" xref="S3.E10.m1.11.11.1.1.1.1.1"></eq><apply id="S3.E10.m1.11.11.1.1.1.1.2.cmml" xref="S3.E10.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.1.1.1.1.2.1.cmml" xref="S3.E10.m1.11.11.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.11.11.1.1.1.1.2.2.cmml" xref="S3.E10.m1.11.11.1.1.1.1.2.2">𝛼</ci><list id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.4"><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑘</ci><ci id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E10.m1.10.10.cmml" xref="S3.E10.m1.10.10"><divide id="S3.E10.m1.10.10.9.cmml" xref="S3.E10.m1.10.10"></divide><apply id="S3.E10.m1.6.6.4.5.cmml" xref="S3.E10.m1.6.6.4.4"><exp id="S3.E10.m1.5.5.3.3.cmml" xref="S3.E10.m1.5.5.3.3"></exp><apply id="S3.E10.m1.6.6.4.4.1.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1"><times id="S3.E10.m1.6.6.4.4.1.1.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.1"></times><apply id="S3.E10.m1.6.6.4.4.1.1.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2"><ci id="S3.E10.m1.6.6.4.4.1.1.2.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.1">⋅</ci><apply id="S3.E10.m1.6.6.4.4.1.1.2.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2"><times id="S3.E10.m1.6.6.4.4.1.1.2.2.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.1"></times><apply id="S3.E10.m1.6.6.4.4.1.1.2.2.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.4.4.1.1.2.2.2.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.2">subscript</csymbol><ci id="S3.E10.m1.6.6.4.4.1.1.2.2.2.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.2.2">𝐖</ci><cn id="S3.E10.m1.6.6.4.4.1.1.2.2.2.3.cmml" type="integer" xref="S3.E10.m1.6.6.4.4.1.1.2.2.2.3">1</cn></apply><apply id="S3.E10.m1.6.6.4.4.1.1.2.2.3.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.4.4.1.1.2.2.3.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3">subscript</csymbol><apply id="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3.2"><ci id="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.1">~</ci><ci id="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.2.3.2.2">𝐦</ci></apply><list id="S3.E10.m1.4.4.2.2.2.3.cmml" xref="S3.E10.m1.4.4.2.2.2.4"><ci id="S3.E10.m1.3.3.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1">𝑘</ci><ci id="S3.E10.m1.4.4.2.2.2.2.cmml" xref="S3.E10.m1.4.4.2.2.2.2">𝑖</ci></list></apply></apply><apply id="S3.E10.m1.6.6.4.4.1.1.2.3.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.4.4.1.1.2.3.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.3">subscript</csymbol><ci id="S3.E10.m1.6.6.4.4.1.1.2.3.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.2.3.2">𝐖</ci><cn id="S3.E10.m1.6.6.4.4.1.1.2.3.3.cmml" type="integer" xref="S3.E10.m1.6.6.4.4.1.1.2.3.3">2</cn></apply></apply><apply id="S3.E10.m1.6.6.4.4.1.1.3.cmml" xref="S3.E10.m1.6.6.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.4.4.1.1.3.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.3">subscript</csymbol><apply id="S3.E10.m1.6.6.4.4.1.1.3.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.3.2"><ci id="S3.E10.m1.6.6.4.4.1.1.3.2.1.cmml" xref="S3.E10.m1.6.6.4.4.1.1.3.2.1">^</ci><ci id="S3.E10.m1.6.6.4.4.1.1.3.2.2.cmml" xref="S3.E10.m1.6.6.4.4.1.1.3.2.2">𝐦</ci></apply><ci id="S3.E10.m1.6.6.4.4.1.1.3.3.cmml" xref="S3.E10.m1.6.6.4.4.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E10.m1.10.10.8.cmml" xref="S3.E10.m1.10.10.8"><apply id="S3.E10.m1.10.10.8.5.cmml" xref="S3.E10.m1.10.10.8.5"><csymbol cd="ambiguous" id="S3.E10.m1.10.10.8.5.1.cmml" xref="S3.E10.m1.10.10.8.5">subscript</csymbol><sum id="S3.E10.m1.10.10.8.5.2.cmml" xref="S3.E10.m1.10.10.8.5.2"></sum><ci id="S3.E10.m1.10.10.8.5.3.cmml" xref="S3.E10.m1.10.10.8.5.3">𝑘</ci></apply><apply id="S3.E10.m1.10.10.8.4.2.cmml" xref="S3.E10.m1.10.10.8.4.1"><exp id="S3.E10.m1.9.9.7.3.cmml" xref="S3.E10.m1.9.9.7.3"></exp><apply id="S3.E10.m1.10.10.8.4.1.1.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1"><times id="S3.E10.m1.10.10.8.4.1.1.1.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.1"></times><apply id="S3.E10.m1.10.10.8.4.1.1.1.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2"><ci id="S3.E10.m1.10.10.8.4.1.1.1.2.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.1">⋅</ci><apply id="S3.E10.m1.10.10.8.4.1.1.1.2.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2"><times id="S3.E10.m1.10.10.8.4.1.1.1.2.2.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.1"></times><apply id="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.2">𝐖</ci><cn id="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.2.3">1</cn></apply><apply id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3">subscript</csymbol><apply id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2"><ci id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.1">~</ci><ci id="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.2.3.2.2">𝐦</ci></apply><list id="S3.E10.m1.8.8.6.2.2.3.cmml" xref="S3.E10.m1.8.8.6.2.2.4"><ci id="S3.E10.m1.7.7.5.1.1.1.cmml" xref="S3.E10.m1.7.7.5.1.1.1">𝑘</ci><ci id="S3.E10.m1.8.8.6.2.2.2.cmml" xref="S3.E10.m1.8.8.6.2.2.2">𝑖</ci></list></apply></apply><apply id="S3.E10.m1.10.10.8.4.1.1.1.2.3.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.10.10.8.4.1.1.1.2.3.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.3">subscript</csymbol><ci id="S3.E10.m1.10.10.8.4.1.1.1.2.3.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.2.3.2">𝐖</ci><cn id="S3.E10.m1.10.10.8.4.1.1.1.2.3.3.cmml" type="integer" xref="S3.E10.m1.10.10.8.4.1.1.1.2.3.3">2</cn></apply></apply><apply id="S3.E10.m1.10.10.8.4.1.1.1.3.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.10.10.8.4.1.1.1.3.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.3">subscript</csymbol><apply id="S3.E10.m1.10.10.8.4.1.1.1.3.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.3.2"><ci id="S3.E10.m1.10.10.8.4.1.1.1.3.2.1.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.3.2.1">^</ci><ci id="S3.E10.m1.10.10.8.4.1.1.1.3.2.2.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.3.2.2">𝐦</ci></apply><ci id="S3.E10.m1.10.10.8.4.1.1.1.3.3.cmml" xref="S3.E10.m1.10.10.8.4.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E10.m1.11.11.1.1.2.2.cmml" xref="S3.E10.m1.11.11.1.1.2.2"><eq id="S3.E10.m1.11.11.1.1.2.2.2.cmml" xref="S3.E10.m1.11.11.1.1.2.2.2"></eq><apply id="S3.E10.m1.11.11.1.1.2.2.3.cmml" xref="S3.E10.m1.11.11.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.1.1.2.2.3.1.cmml" xref="S3.E10.m1.11.11.1.1.2.2.3">subscript</csymbol><apply id="S3.E10.m1.11.11.1.1.2.2.3.2.cmml" xref="S3.E10.m1.11.11.1.1.2.2.3.2"><ci id="S3.E10.m1.11.11.1.1.2.2.3.2.1.cmml" xref="S3.E10.m1.11.11.1.1.2.2.3.2.1">^</ci><ci id="S3.E10.m1.11.11.1.1.2.2.3.2.2.cmml" xref="S3.E10.m1.11.11.1.1.2.2.3.2.2">𝐦</ci></apply><ci id="S3.E10.m1.11.11.1.1.2.2.3.3.cmml" xref="S3.E10.m1.11.11.1.1.2.2.3.3">𝑖</ci></apply><apply id="S3.E10.m1.11.11.1.1.2.2.1.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1"><times id="S3.E10.m1.11.11.1.1.2.2.1.2.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.2"></times><apply id="S3.E10.m1.11.11.1.1.2.2.1.3.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.1.1.2.2.1.3.1.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.3">superscript</csymbol><ci id="S3.E10.m1.11.11.1.1.2.2.1.3.2.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.3.2">italic-ϕ</ci><times id="S3.E10.m1.11.11.1.1.2.2.1.3.3.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.3.3"></times></apply><apply id="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.2">𝑥</ci><ci id="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E10.m1.11.11.1.1.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.11c">\displaystyle\alpha_{k,i}=\frac{\exp(\mathbf{W}_{1}\mathbf{\tilde{m}}_{k,i}%
\cdot\mathbf{W}_{2}\mathbf{\hat{m}}_{i})}{\sum_{k}\exp(\mathbf{W}_{1}\mathbf{%
\tilde{m}}_{k,i}\cdot\mathbf{W}_{2}\mathbf{\hat{m}}_{i})},\quad\mathbf{\hat{m}%
}_{i}=\phi^{*}(x_{i}),</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.11d">italic_α start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT = divide start_ARG roman_exp ( bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT roman_exp ( bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG , over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.19">where <math alttext="\mathbf{\tilde{m}}_{k,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.14.m1.2"><semantics id="S3.SS3.SSS2.p2.14.m1.2a"><msub id="S3.SS3.SSS2.p2.14.m1.2.3" xref="S3.SS3.SSS2.p2.14.m1.2.3.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.14.m1.2.3.2" xref="S3.SS3.SSS2.p2.14.m1.2.3.2.cmml"><mi id="S3.SS3.SSS2.p2.14.m1.2.3.2.2" xref="S3.SS3.SSS2.p2.14.m1.2.3.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p2.14.m1.2.3.2.1" xref="S3.SS3.SSS2.p2.14.m1.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.SSS2.p2.14.m1.2.2.2.4" xref="S3.SS3.SSS2.p2.14.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.14.m1.1.1.1.1" xref="S3.SS3.SSS2.p2.14.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p2.14.m1.2.2.2.4.1" xref="S3.SS3.SSS2.p2.14.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p2.14.m1.2.2.2.2" xref="S3.SS3.SSS2.p2.14.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.14.m1.2b"><apply id="S3.SS3.SSS2.p2.14.m1.2.3.cmml" xref="S3.SS3.SSS2.p2.14.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.14.m1.2.3">subscript</csymbol><apply id="S3.SS3.SSS2.p2.14.m1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.14.m1.2.3.2"><ci id="S3.SS3.SSS2.p2.14.m1.2.3.2.1.cmml" xref="S3.SS3.SSS2.p2.14.m1.2.3.2.1">~</ci><ci id="S3.SS3.SSS2.p2.14.m1.2.3.2.2.cmml" xref="S3.SS3.SSS2.p2.14.m1.2.3.2.2">𝐦</ci></apply><list id="S3.SS3.SSS2.p2.14.m1.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.14.m1.2.2.2.4"><ci id="S3.SS3.SSS2.p2.14.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.14.m1.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p2.14.m1.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.14.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.14.m1.2c">\mathbf{\tilde{m}}_{k,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.14.m1.2d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the mediator feature for the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.15.m2.1"><semantics id="S3.SS3.SSS2.p2.15.m2.1a"><mi id="S3.SS3.SSS2.p2.15.m2.1.1" xref="S3.SS3.SSS2.p2.15.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.15.m2.1b"><ci id="S3.SS3.SSS2.p2.15.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.15.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.15.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.15.m2.1d">italic_i</annotation></semantics></math>-th data extracted by the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.16.m3.1"><semantics id="S3.SS3.SSS2.p2.16.m3.1a"><mi id="S3.SS3.SSS2.p2.16.m3.1.1" xref="S3.SS3.SSS2.p2.16.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.16.m3.1b"><ci id="S3.SS3.SSS2.p2.16.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.16.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.16.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.16.m3.1d">italic_k</annotation></semantics></math>-th teacher model and is computed by Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E9" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">9</span></a>). <math alttext="\mathbf{\hat{m}}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.17.m4.1"><semantics id="S3.SS3.SSS2.p2.17.m4.1a"><msub id="S3.SS3.SSS2.p2.17.m4.1.1" xref="S3.SS3.SSS2.p2.17.m4.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.17.m4.1.1.2" xref="S3.SS3.SSS2.p2.17.m4.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.17.m4.1.1.2.2" xref="S3.SS3.SSS2.p2.17.m4.1.1.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p2.17.m4.1.1.2.1" xref="S3.SS3.SSS2.p2.17.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.17.m4.1.1.3" xref="S3.SS3.SSS2.p2.17.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.17.m4.1b"><apply id="S3.SS3.SSS2.p2.17.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.17.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.17.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p2.17.m4.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.17.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.17.m4.1.1.2"><ci id="S3.SS3.SSS2.p2.17.m4.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.17.m4.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p2.17.m4.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.17.m4.1.1.2.2">𝐦</ci></apply><ci id="S3.SS3.SSS2.p2.17.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p2.17.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.17.m4.1c">\mathbf{\hat{m}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.17.m4.1d">over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the mediator feature of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.18.m5.1"><semantics id="S3.SS3.SSS2.p2.18.m5.1a"><mi id="S3.SS3.SSS2.p2.18.m5.1.1" xref="S3.SS3.SSS2.p2.18.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.18.m5.1b"><ci id="S3.SS3.SSS2.p2.18.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.18.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.18.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.18.m5.1d">italic_i</annotation></semantics></math>-th data computed by the encoder of the student model, <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p2.19.1">i</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p2.19.2">e</span>., <math alttext="\phi^{*}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.19.m6.1"><semantics id="S3.SS3.SSS2.p2.19.m6.1a"><msup id="S3.SS3.SSS2.p2.19.m6.1.1" xref="S3.SS3.SSS2.p2.19.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p2.19.m6.1.1.2" xref="S3.SS3.SSS2.p2.19.m6.1.1.2.cmml">ϕ</mi><mo id="S3.SS3.SSS2.p2.19.m6.1.1.3" xref="S3.SS3.SSS2.p2.19.m6.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.19.m6.1b"><apply id="S3.SS3.SSS2.p2.19.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.19.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.19.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p2.19.m6.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p2.19.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.19.m6.1.1.2">italic-ϕ</ci><times id="S3.SS3.SSS2.p2.19.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.19.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.19.m6.1c">\phi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.19.m6.1d">italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.6"><span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p3.1.1">Sampling of <math alttext="X=x" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.1.1.m1.1"><semantics id="S3.SS3.SSS2.p3.1.1.m1.1a"><mrow id="S3.SS3.SSS2.p3.1.1.m1.1.1" xref="S3.SS3.SSS2.p3.1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.1.1.m1.1.1.2" xref="S3.SS3.SSS2.p3.1.1.m1.1.1.2.cmml">X</mi><mo id="S3.SS3.SSS2.p3.1.1.m1.1.1.1" xref="S3.SS3.SSS2.p3.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.SS3.SSS2.p3.1.1.m1.1.1.3" xref="S3.SS3.SSS2.p3.1.1.m1.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.1.1.m1.1b"><apply id="S3.SS3.SSS2.p3.1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.1.m1.1.1"><eq id="S3.SS3.SSS2.p3.1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.1.m1.1.1.1"></eq><ci id="S3.SS3.SSS2.p3.1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.1.1.m1.1.1.2">𝑋</ci><ci id="S3.SS3.SSS2.p3.1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.1.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.1.1.m1.1c">X=x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.1.1.m1.1d">italic_X = italic_x</annotation></semantics></math>. </span>
We take the in-batch sampling strategy for efficiency. Specifically, for a given training sample <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.2.m1.1"><semantics id="S3.SS3.SSS2.p3.2.m1.1a"><msub id="S3.SS3.SSS2.p3.2.m1.1.1" xref="S3.SS3.SSS2.p3.2.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.2.m1.1.1.2" xref="S3.SS3.SSS2.p3.2.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p3.2.m1.1.1.3" xref="S3.SS3.SSS2.p3.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.2.m1.1b"><apply id="S3.SS3.SSS2.p3.2.m1.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.2.m1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p3.2.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.2.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.2.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we take other training samples <math alttext="\{x_{j}\}_{j\neq i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.3.m2.1"><semantics id="S3.SS3.SSS2.p3.3.m2.1a"><msub id="S3.SS3.SSS2.p3.3.m2.1.1" xref="S3.SS3.SSS2.p3.3.m2.1.1.cmml"><mrow id="S3.SS3.SSS2.p3.3.m2.1.1.1.1" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.2.cmml"><mo id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.2.cmml">{</mo><msub id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.2" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.3" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS2.p3.3.m2.1.1.3" xref="S3.SS3.SSS2.p3.3.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p3.3.m2.1.1.3.2" xref="S3.SS3.SSS2.p3.3.m2.1.1.3.2.cmml">j</mi><mo id="S3.SS3.SSS2.p3.3.m2.1.1.3.1" xref="S3.SS3.SSS2.p3.3.m2.1.1.3.1.cmml">≠</mo><mi id="S3.SS3.SSS2.p3.3.m2.1.1.3.3" xref="S3.SS3.SSS2.p3.3.m2.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.3.m2.1b"><apply id="S3.SS3.SSS2.p3.3.m2.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.3.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1">subscript</csymbol><set id="S3.SS3.SSS2.p3.3.m2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.1"><apply id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S3.SS3.SSS2.p3.3.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.3"><neq id="S3.SS3.SSS2.p3.3.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.3.1"></neq><ci id="S3.SS3.SSS2.p3.3.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.3.2">𝑗</ci><ci id="S3.SS3.SSS2.p3.3.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p3.3.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.3.m2.1c">\{x_{j}\}_{j\neq i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.3.m2.1d">{ italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j ≠ italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in the batch as the sampled <math alttext="X" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.4.m3.1"><semantics id="S3.SS3.SSS2.p3.4.m3.1a"><mi id="S3.SS3.SSS2.p3.4.m3.1.1" xref="S3.SS3.SSS2.p3.4.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.4.m3.1b"><ci id="S3.SS3.SSS2.p3.4.m3.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.4.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.4.m3.1d">italic_X</annotation></semantics></math>. For the prior probability of <math alttext="X=x_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.5.m4.1"><semantics id="S3.SS3.SSS2.p3.5.m4.1a"><mrow id="S3.SS3.SSS2.p3.5.m4.1.1" xref="S3.SS3.SSS2.p3.5.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p3.5.m4.1.1.2" xref="S3.SS3.SSS2.p3.5.m4.1.1.2.cmml">X</mi><mo id="S3.SS3.SSS2.p3.5.m4.1.1.1" xref="S3.SS3.SSS2.p3.5.m4.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS2.p3.5.m4.1.1.3" xref="S3.SS3.SSS2.p3.5.m4.1.1.3.cmml"><mi id="S3.SS3.SSS2.p3.5.m4.1.1.3.2" xref="S3.SS3.SSS2.p3.5.m4.1.1.3.2.cmml">x</mi><mi id="S3.SS3.SSS2.p3.5.m4.1.1.3.3" xref="S3.SS3.SSS2.p3.5.m4.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.5.m4.1b"><apply id="S3.SS3.SSS2.p3.5.m4.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m4.1.1"><eq id="S3.SS3.SSS2.p3.5.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m4.1.1.1"></eq><ci id="S3.SS3.SSS2.p3.5.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p3.5.m4.1.1.2">𝑋</ci><apply id="S3.SS3.SSS2.p3.5.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p3.5.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.5.m4.1.1.3.1.cmml" xref="S3.SS3.SSS2.p3.5.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p3.5.m4.1.1.3.2.cmml" xref="S3.SS3.SSS2.p3.5.m4.1.1.3.2">𝑥</ci><ci id="S3.SS3.SSS2.p3.5.m4.1.1.3.3.cmml" xref="S3.SS3.SSS2.p3.5.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.5.m4.1c">X=x_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.5.m4.1d">italic_X = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, we have no access to the data generation process in the real world. Alternatively, since each sample is randomly taken into the batch, we take the uniform distribution for <math alttext="P(X=x_{j})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.6.m5.1"><semantics id="S3.SS3.SSS2.p3.6.m5.1a"><mrow id="S3.SS3.SSS2.p3.6.m5.1.1" xref="S3.SS3.SSS2.p3.6.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p3.6.m5.1.1.3" xref="S3.SS3.SSS2.p3.6.m5.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS2.p3.6.m5.1.1.2" xref="S3.SS3.SSS2.p3.6.m5.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.6.m5.1.1.1.1" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.2" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.2.cmml">X</mi><mo id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.1" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.2" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.2.cmml">x</mi><mi id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.3" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.6.m5.1b"><apply id="S3.SS3.SSS2.p3.6.m5.1.1.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1"><times id="S3.SS3.SSS2.p3.6.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.2"></times><ci id="S3.SS3.SSS2.p3.6.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.3">𝑃</ci><apply id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1"><eq id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.1"></eq><ci id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.2">𝑋</ci><apply id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p3.6.m5.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.6.m5.1c">P(X=x_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.6.m5.1d">italic_P ( italic_X = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.27.1.1" style="font-size:90%;">TABLE I</span>: </span><span class="ltx_text" id="S3.T1.28.2" style="font-size:90%;">
Notations
</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.25">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.25.26.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.25.26.1.1">
<span class="ltx_text" id="S3.T1.25.26.1.1.1" style="font-size:90%;"></span><span class="ltx_text ltx_font_bold" id="S3.T1.25.26.1.1.2" style="font-size:90%;">Notation</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S3.T1.25.26.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.25.26.1.2.1" style="font-size:90%;">Description</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.1"><math alttext="X,Y,Z,M" class="ltx_Math" display="inline" id="S3.T1.1.1.1.m1.4"><semantics id="S3.T1.1.1.1.m1.4a"><mrow id="S3.T1.1.1.1.m1.4.5.2" xref="S3.T1.1.1.1.m1.4.5.1.cmml"><mi id="S3.T1.1.1.1.m1.1.1" mathsize="90%" xref="S3.T1.1.1.1.m1.1.1.cmml">X</mi><mo id="S3.T1.1.1.1.m1.4.5.2.1" mathsize="90%" xref="S3.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.1.1.1.m1.2.2" mathsize="90%" xref="S3.T1.1.1.1.m1.2.2.cmml">Y</mi><mo id="S3.T1.1.1.1.m1.4.5.2.2" mathsize="90%" xref="S3.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.1.1.1.m1.3.3" mathsize="90%" xref="S3.T1.1.1.1.m1.3.3.cmml">Z</mi><mo id="S3.T1.1.1.1.m1.4.5.2.3" mathsize="90%" xref="S3.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.1.1.1.m1.4.4" mathsize="90%" xref="S3.T1.1.1.1.m1.4.4.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.4b"><list id="S3.T1.1.1.1.m1.4.5.1.cmml" xref="S3.T1.1.1.1.m1.4.5.2"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝑋</ci><ci id="S3.T1.1.1.1.m1.2.2.cmml" xref="S3.T1.1.1.1.m1.2.2">𝑌</ci><ci id="S3.T1.1.1.1.m1.3.3.cmml" xref="S3.T1.1.1.1.m1.3.3">𝑍</ci><ci id="S3.T1.1.1.1.m1.4.4.cmml" xref="S3.T1.1.1.1.m1.4.4">𝑀</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.4c">X,Y,Z,M</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.4d">italic_X , italic_Y , italic_Z , italic_M</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.1.2.1">
<span class="ltx_p" id="S3.T1.1.1.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.1.1.2.1.1.1" style="font-size:90%;">variables denoting the historical behaviors, next behavior, confounder, mediator</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.2.2.1"><math alttext="x,y,z,m" class="ltx_Math" display="inline" id="S3.T1.2.2.1.m1.4"><semantics id="S3.T1.2.2.1.m1.4a"><mrow id="S3.T1.2.2.1.m1.4.5.2" xref="S3.T1.2.2.1.m1.4.5.1.cmml"><mi id="S3.T1.2.2.1.m1.1.1" mathsize="90%" xref="S3.T1.2.2.1.m1.1.1.cmml">x</mi><mo id="S3.T1.2.2.1.m1.4.5.2.1" mathsize="90%" xref="S3.T1.2.2.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.2.2.1.m1.2.2" mathsize="90%" xref="S3.T1.2.2.1.m1.2.2.cmml">y</mi><mo id="S3.T1.2.2.1.m1.4.5.2.2" mathsize="90%" xref="S3.T1.2.2.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.2.2.1.m1.3.3" mathsize="90%" xref="S3.T1.2.2.1.m1.3.3.cmml">z</mi><mo id="S3.T1.2.2.1.m1.4.5.2.3" mathsize="90%" xref="S3.T1.2.2.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.2.2.1.m1.4.4" mathsize="90%" xref="S3.T1.2.2.1.m1.4.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.4b"><list id="S3.T1.2.2.1.m1.4.5.1.cmml" xref="S3.T1.2.2.1.m1.4.5.2"><ci id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">𝑥</ci><ci id="S3.T1.2.2.1.m1.2.2.cmml" xref="S3.T1.2.2.1.m1.2.2">𝑦</ci><ci id="S3.T1.2.2.1.m1.3.3.cmml" xref="S3.T1.2.2.1.m1.3.3">𝑧</ci><ci id="S3.T1.2.2.1.m1.4.4.cmml" xref="S3.T1.2.2.1.m1.4.4">𝑚</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.4c">x,y,z,m</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.1.m1.4d">italic_x , italic_y , italic_z , italic_m</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.3.3.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.3.3.2.1">
<span class="ltx_p" id="S3.T1.3.3.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.3.3.2.1.1.1" style="font-size:90%;">particular values of </span><math alttext="X,Y,Z,M" class="ltx_Math" display="inline" id="S3.T1.3.3.2.1.1.m1.4"><semantics id="S3.T1.3.3.2.1.1.m1.4a"><mrow id="S3.T1.3.3.2.1.1.m1.4.5.2" xref="S3.T1.3.3.2.1.1.m1.4.5.1.cmml"><mi id="S3.T1.3.3.2.1.1.m1.1.1" mathsize="90%" xref="S3.T1.3.3.2.1.1.m1.1.1.cmml">X</mi><mo id="S3.T1.3.3.2.1.1.m1.4.5.2.1" mathsize="90%" xref="S3.T1.3.3.2.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.3.3.2.1.1.m1.2.2" mathsize="90%" xref="S3.T1.3.3.2.1.1.m1.2.2.cmml">Y</mi><mo id="S3.T1.3.3.2.1.1.m1.4.5.2.2" mathsize="90%" xref="S3.T1.3.3.2.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.3.3.2.1.1.m1.3.3" mathsize="90%" xref="S3.T1.3.3.2.1.1.m1.3.3.cmml">Z</mi><mo id="S3.T1.3.3.2.1.1.m1.4.5.2.3" mathsize="90%" xref="S3.T1.3.3.2.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.3.3.2.1.1.m1.4.4" mathsize="90%" xref="S3.T1.3.3.2.1.1.m1.4.4.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.2.1.1.m1.4b"><list id="S3.T1.3.3.2.1.1.m1.4.5.1.cmml" xref="S3.T1.3.3.2.1.1.m1.4.5.2"><ci id="S3.T1.3.3.2.1.1.m1.1.1.cmml" xref="S3.T1.3.3.2.1.1.m1.1.1">𝑋</ci><ci id="S3.T1.3.3.2.1.1.m1.2.2.cmml" xref="S3.T1.3.3.2.1.1.m1.2.2">𝑌</ci><ci id="S3.T1.3.3.2.1.1.m1.3.3.cmml" xref="S3.T1.3.3.2.1.1.m1.3.3">𝑍</ci><ci id="S3.T1.3.3.2.1.1.m1.4.4.cmml" xref="S3.T1.3.3.2.1.1.m1.4.4">𝑀</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.2.1.1.m1.4c">X,Y,Z,M</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.2.1.1.m1.4d">italic_X , italic_Y , italic_Z , italic_M</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.4.4.1"><math alttext="\mathbf{x},\mathbf{y},\mathbf{z},\mathbf{m}" class="ltx_Math" display="inline" id="S3.T1.4.4.1.m1.4"><semantics id="S3.T1.4.4.1.m1.4a"><mrow id="S3.T1.4.4.1.m1.4.5.2" xref="S3.T1.4.4.1.m1.4.5.1.cmml"><mi id="S3.T1.4.4.1.m1.1.1" mathsize="90%" xref="S3.T1.4.4.1.m1.1.1.cmml">𝐱</mi><mo id="S3.T1.4.4.1.m1.4.5.2.1" mathsize="90%" xref="S3.T1.4.4.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.4.4.1.m1.2.2" mathsize="90%" xref="S3.T1.4.4.1.m1.2.2.cmml">𝐲</mi><mo id="S3.T1.4.4.1.m1.4.5.2.2" mathsize="90%" xref="S3.T1.4.4.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.4.4.1.m1.3.3" mathsize="90%" xref="S3.T1.4.4.1.m1.3.3.cmml">𝐳</mi><mo id="S3.T1.4.4.1.m1.4.5.2.3" mathsize="90%" xref="S3.T1.4.4.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.4.4.1.m1.4.4" mathsize="90%" xref="S3.T1.4.4.1.m1.4.4.cmml">𝐦</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.4b"><list id="S3.T1.4.4.1.m1.4.5.1.cmml" xref="S3.T1.4.4.1.m1.4.5.2"><ci id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">𝐱</ci><ci id="S3.T1.4.4.1.m1.2.2.cmml" xref="S3.T1.4.4.1.m1.2.2">𝐲</ci><ci id="S3.T1.4.4.1.m1.3.3.cmml" xref="S3.T1.4.4.1.m1.3.3">𝐳</ci><ci id="S3.T1.4.4.1.m1.4.4.cmml" xref="S3.T1.4.4.1.m1.4.4">𝐦</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.4c">\mathbf{x},\mathbf{y},\mathbf{z},\mathbf{m}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.1.m1.4d">bold_x , bold_y , bold_z , bold_m</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.5.5.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.5.5.2.1">
<span class="ltx_p" id="S3.T1.5.5.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.5.5.2.1.1.1" style="font-size:90%;">vectorial representation of </span><math alttext="x,y,z,m" class="ltx_Math" display="inline" id="S3.T1.5.5.2.1.1.m1.4"><semantics id="S3.T1.5.5.2.1.1.m1.4a"><mrow id="S3.T1.5.5.2.1.1.m1.4.5.2" xref="S3.T1.5.5.2.1.1.m1.4.5.1.cmml"><mi id="S3.T1.5.5.2.1.1.m1.1.1" mathsize="90%" xref="S3.T1.5.5.2.1.1.m1.1.1.cmml">x</mi><mo id="S3.T1.5.5.2.1.1.m1.4.5.2.1" mathsize="90%" xref="S3.T1.5.5.2.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.5.5.2.1.1.m1.2.2" mathsize="90%" xref="S3.T1.5.5.2.1.1.m1.2.2.cmml">y</mi><mo id="S3.T1.5.5.2.1.1.m1.4.5.2.2" mathsize="90%" xref="S3.T1.5.5.2.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.5.5.2.1.1.m1.3.3" mathsize="90%" xref="S3.T1.5.5.2.1.1.m1.3.3.cmml">z</mi><mo id="S3.T1.5.5.2.1.1.m1.4.5.2.3" mathsize="90%" xref="S3.T1.5.5.2.1.1.m1.4.5.1.cmml">,</mo><mi id="S3.T1.5.5.2.1.1.m1.4.4" mathsize="90%" xref="S3.T1.5.5.2.1.1.m1.4.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.2.1.1.m1.4b"><list id="S3.T1.5.5.2.1.1.m1.4.5.1.cmml" xref="S3.T1.5.5.2.1.1.m1.4.5.2"><ci id="S3.T1.5.5.2.1.1.m1.1.1.cmml" xref="S3.T1.5.5.2.1.1.m1.1.1">𝑥</ci><ci id="S3.T1.5.5.2.1.1.m1.2.2.cmml" xref="S3.T1.5.5.2.1.1.m1.2.2">𝑦</ci><ci id="S3.T1.5.5.2.1.1.m1.3.3.cmml" xref="S3.T1.5.5.2.1.1.m1.3.3">𝑧</ci><ci id="S3.T1.5.5.2.1.1.m1.4.4.cmml" xref="S3.T1.5.5.2.1.1.m1.4.4">𝑚</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.2.1.1.m1.4c">x,y,z,m</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.2.1.1.m1.4d">italic_x , italic_y , italic_z , italic_m</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.6.6.1"><math alttext="\phi_{k},\phi^{*}" class="ltx_Math" display="inline" id="S3.T1.6.6.1.m1.2"><semantics id="S3.T1.6.6.1.m1.2a"><mrow id="S3.T1.6.6.1.m1.2.2.2" xref="S3.T1.6.6.1.m1.2.2.3.cmml"><msub id="S3.T1.6.6.1.m1.1.1.1.1" xref="S3.T1.6.6.1.m1.1.1.1.1.cmml"><mi id="S3.T1.6.6.1.m1.1.1.1.1.2" mathsize="90%" xref="S3.T1.6.6.1.m1.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.T1.6.6.1.m1.1.1.1.1.3" mathsize="90%" xref="S3.T1.6.6.1.m1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.T1.6.6.1.m1.2.2.2.3" mathsize="90%" xref="S3.T1.6.6.1.m1.2.2.3.cmml">,</mo><msup id="S3.T1.6.6.1.m1.2.2.2.2" xref="S3.T1.6.6.1.m1.2.2.2.2.cmml"><mi id="S3.T1.6.6.1.m1.2.2.2.2.2" mathsize="90%" xref="S3.T1.6.6.1.m1.2.2.2.2.2.cmml">ϕ</mi><mo id="S3.T1.6.6.1.m1.2.2.2.2.3" mathsize="90%" xref="S3.T1.6.6.1.m1.2.2.2.2.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.1.m1.2b"><list id="S3.T1.6.6.1.m1.2.2.3.cmml" xref="S3.T1.6.6.1.m1.2.2.2"><apply id="S3.T1.6.6.1.m1.1.1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.6.6.1.m1.1.1.1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.6.6.1.m1.1.1.1.1.2.cmml" xref="S3.T1.6.6.1.m1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.T1.6.6.1.m1.1.1.1.1.3.cmml" xref="S3.T1.6.6.1.m1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.T1.6.6.1.m1.2.2.2.2.cmml" xref="S3.T1.6.6.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.6.6.1.m1.2.2.2.2.1.cmml" xref="S3.T1.6.6.1.m1.2.2.2.2">superscript</csymbol><ci id="S3.T1.6.6.1.m1.2.2.2.2.2.cmml" xref="S3.T1.6.6.1.m1.2.2.2.2.2">italic-ϕ</ci><times id="S3.T1.6.6.1.m1.2.2.2.2.3.cmml" xref="S3.T1.6.6.1.m1.2.2.2.2.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.1.m1.2c">\phi_{k},\phi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.1.m1.2d">italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.7.7.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.7.7.2.1">
<span class="ltx_p" id="S3.T1.7.7.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.7.7.2.1.1.1" style="font-size:90%;">encoder of the </span><math alttext="k" class="ltx_Math" display="inline" id="S3.T1.7.7.2.1.1.m1.1"><semantics id="S3.T1.7.7.2.1.1.m1.1a"><mi id="S3.T1.7.7.2.1.1.m1.1.1" mathsize="90%" xref="S3.T1.7.7.2.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.2.1.1.m1.1b"><ci id="S3.T1.7.7.2.1.1.m1.1.1.cmml" xref="S3.T1.7.7.2.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.2.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.2.1.1.m1.1d">italic_k</annotation></semantics></math><span class="ltx_text" id="S3.T1.7.7.2.1.1.2" style="font-size:90%;">-th teacher / student recommendation model</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.8.8.1"><math alttext="\mathbf{\tilde{m}}_{k,i},\mathbf{\hat{m}}_{i}" class="ltx_Math" display="inline" id="S3.T1.8.8.1.m1.4"><semantics id="S3.T1.8.8.1.m1.4a"><mrow id="S3.T1.8.8.1.m1.4.4.2" xref="S3.T1.8.8.1.m1.4.4.3.cmml"><msub id="S3.T1.8.8.1.m1.3.3.1.1" xref="S3.T1.8.8.1.m1.3.3.1.1.cmml"><mover accent="true" id="S3.T1.8.8.1.m1.3.3.1.1.2" xref="S3.T1.8.8.1.m1.3.3.1.1.2.cmml"><mi id="S3.T1.8.8.1.m1.3.3.1.1.2.2" mathsize="90%" xref="S3.T1.8.8.1.m1.3.3.1.1.2.2.cmml">𝐦</mi><mo id="S3.T1.8.8.1.m1.3.3.1.1.2.1" mathsize="90%" xref="S3.T1.8.8.1.m1.3.3.1.1.2.1.cmml">~</mo></mover><mrow id="S3.T1.8.8.1.m1.2.2.2.4" xref="S3.T1.8.8.1.m1.2.2.2.3.cmml"><mi id="S3.T1.8.8.1.m1.1.1.1.1" mathsize="90%" xref="S3.T1.8.8.1.m1.1.1.1.1.cmml">k</mi><mo id="S3.T1.8.8.1.m1.2.2.2.4.1" mathsize="90%" xref="S3.T1.8.8.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.T1.8.8.1.m1.2.2.2.2" mathsize="90%" xref="S3.T1.8.8.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.T1.8.8.1.m1.4.4.2.3" mathsize="90%" xref="S3.T1.8.8.1.m1.4.4.3.cmml">,</mo><msub id="S3.T1.8.8.1.m1.4.4.2.2" xref="S3.T1.8.8.1.m1.4.4.2.2.cmml"><mover accent="true" id="S3.T1.8.8.1.m1.4.4.2.2.2" xref="S3.T1.8.8.1.m1.4.4.2.2.2.cmml"><mi id="S3.T1.8.8.1.m1.4.4.2.2.2.2" mathsize="90%" xref="S3.T1.8.8.1.m1.4.4.2.2.2.2.cmml">𝐦</mi><mo id="S3.T1.8.8.1.m1.4.4.2.2.2.1" mathsize="90%" xref="S3.T1.8.8.1.m1.4.4.2.2.2.1.cmml">^</mo></mover><mi id="S3.T1.8.8.1.m1.4.4.2.2.3" mathsize="90%" xref="S3.T1.8.8.1.m1.4.4.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.1.m1.4b"><list id="S3.T1.8.8.1.m1.4.4.3.cmml" xref="S3.T1.8.8.1.m1.4.4.2"><apply id="S3.T1.8.8.1.m1.3.3.1.1.cmml" xref="S3.T1.8.8.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.3.3.1.1.1.cmml" xref="S3.T1.8.8.1.m1.3.3.1.1">subscript</csymbol><apply id="S3.T1.8.8.1.m1.3.3.1.1.2.cmml" xref="S3.T1.8.8.1.m1.3.3.1.1.2"><ci id="S3.T1.8.8.1.m1.3.3.1.1.2.1.cmml" xref="S3.T1.8.8.1.m1.3.3.1.1.2.1">~</ci><ci id="S3.T1.8.8.1.m1.3.3.1.1.2.2.cmml" xref="S3.T1.8.8.1.m1.3.3.1.1.2.2">𝐦</ci></apply><list id="S3.T1.8.8.1.m1.2.2.2.3.cmml" xref="S3.T1.8.8.1.m1.2.2.2.4"><ci id="S3.T1.8.8.1.m1.1.1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1.1.1">𝑘</ci><ci id="S3.T1.8.8.1.m1.2.2.2.2.cmml" xref="S3.T1.8.8.1.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.T1.8.8.1.m1.4.4.2.2.cmml" xref="S3.T1.8.8.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.4.4.2.2.1.cmml" xref="S3.T1.8.8.1.m1.4.4.2.2">subscript</csymbol><apply id="S3.T1.8.8.1.m1.4.4.2.2.2.cmml" xref="S3.T1.8.8.1.m1.4.4.2.2.2"><ci id="S3.T1.8.8.1.m1.4.4.2.2.2.1.cmml" xref="S3.T1.8.8.1.m1.4.4.2.2.2.1">^</ci><ci id="S3.T1.8.8.1.m1.4.4.2.2.2.2.cmml" xref="S3.T1.8.8.1.m1.4.4.2.2.2.2">𝐦</ci></apply><ci id="S3.T1.8.8.1.m1.4.4.2.2.3.cmml" xref="S3.T1.8.8.1.m1.4.4.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.1.m1.4c">\mathbf{\tilde{m}}_{k,i},\mathbf{\hat{m}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.1.m1.4d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT , over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.11.11.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.11.11.4.3">
<span class="ltx_p" id="S3.T1.11.11.4.3.3" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.11.11.4.3.3.1" style="font-size:90%;">mediator feature extracted by </span><math alttext="\phi_{k}" class="ltx_Math" display="inline" id="S3.T1.9.9.2.1.1.m1.1"><semantics id="S3.T1.9.9.2.1.1.m1.1a"><msub id="S3.T1.9.9.2.1.1.m1.1.1" xref="S3.T1.9.9.2.1.1.m1.1.1.cmml"><mi id="S3.T1.9.9.2.1.1.m1.1.1.2" mathsize="90%" xref="S3.T1.9.9.2.1.1.m1.1.1.2.cmml">ϕ</mi><mi id="S3.T1.9.9.2.1.1.m1.1.1.3" mathsize="90%" xref="S3.T1.9.9.2.1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.2.1.1.m1.1b"><apply id="S3.T1.9.9.2.1.1.m1.1.1.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.9.2.1.1.m1.1.1.1.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.9.9.2.1.1.m1.1.1.2.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1.2">italic-ϕ</ci><ci id="S3.T1.9.9.2.1.1.m1.1.1.3.cmml" xref="S3.T1.9.9.2.1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.2.1.1.m1.1c">\phi_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.2.1.1.m1.1d">italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.T1.11.11.4.3.3.2" style="font-size:90%;"> and </span><math alttext="\phi^{*}" class="ltx_Math" display="inline" id="S3.T1.10.10.3.2.2.m2.1"><semantics id="S3.T1.10.10.3.2.2.m2.1a"><msup id="S3.T1.10.10.3.2.2.m2.1.1" xref="S3.T1.10.10.3.2.2.m2.1.1.cmml"><mi id="S3.T1.10.10.3.2.2.m2.1.1.2" mathsize="90%" xref="S3.T1.10.10.3.2.2.m2.1.1.2.cmml">ϕ</mi><mo id="S3.T1.10.10.3.2.2.m2.1.1.3" mathsize="90%" xref="S3.T1.10.10.3.2.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.3.2.2.m2.1b"><apply id="S3.T1.10.10.3.2.2.m2.1.1.cmml" xref="S3.T1.10.10.3.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.3.2.2.m2.1.1.1.cmml" xref="S3.T1.10.10.3.2.2.m2.1.1">superscript</csymbol><ci id="S3.T1.10.10.3.2.2.m2.1.1.2.cmml" xref="S3.T1.10.10.3.2.2.m2.1.1.2">italic-ϕ</ci><times id="S3.T1.10.10.3.2.2.m2.1.1.3.cmml" xref="S3.T1.10.10.3.2.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.3.2.2.m2.1c">\phi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.3.2.2.m2.1d">italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.T1.11.11.4.3.3.3" style="font-size:90%;"> that take </span><math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.T1.11.11.4.3.3.m3.1"><semantics id="S3.T1.11.11.4.3.3.m3.1a"><msub id="S3.T1.11.11.4.3.3.m3.1.1" xref="S3.T1.11.11.4.3.3.m3.1.1.cmml"><mi id="S3.T1.11.11.4.3.3.m3.1.1.2" mathsize="90%" xref="S3.T1.11.11.4.3.3.m3.1.1.2.cmml">x</mi><mi id="S3.T1.11.11.4.3.3.m3.1.1.3" mathsize="90%" xref="S3.T1.11.11.4.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.4.3.3.m3.1b"><apply id="S3.T1.11.11.4.3.3.m3.1.1.cmml" xref="S3.T1.11.11.4.3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.4.3.3.m3.1.1.1.cmml" xref="S3.T1.11.11.4.3.3.m3.1.1">subscript</csymbol><ci id="S3.T1.11.11.4.3.3.m3.1.1.2.cmml" xref="S3.T1.11.11.4.3.3.m3.1.1.2">𝑥</ci><ci id="S3.T1.11.11.4.3.3.m3.1.1.3.cmml" xref="S3.T1.11.11.4.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.4.3.3.m3.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.11.4.3.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.T1.11.11.4.3.3.4" style="font-size:90%;"> as input</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.12.12.1"><math alttext="\mathbf{\tilde{m}}^{\circ}_{i}" class="ltx_Math" display="inline" id="S3.T1.12.12.1.m1.1"><semantics id="S3.T1.12.12.1.m1.1a"><msubsup id="S3.T1.12.12.1.m1.1.1" xref="S3.T1.12.12.1.m1.1.1.cmml"><mover accent="true" id="S3.T1.12.12.1.m1.1.1.2.2" xref="S3.T1.12.12.1.m1.1.1.2.2.cmml"><mi id="S3.T1.12.12.1.m1.1.1.2.2.2" mathsize="90%" xref="S3.T1.12.12.1.m1.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.T1.12.12.1.m1.1.1.2.2.1" mathsize="90%" xref="S3.T1.12.12.1.m1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.T1.12.12.1.m1.1.1.3" mathsize="90%" xref="S3.T1.12.12.1.m1.1.1.3.cmml">i</mi><mo id="S3.T1.12.12.1.m1.1.1.2.3" mathsize="90%" xref="S3.T1.12.12.1.m1.1.1.2.3.cmml">∘</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.1.m1.1b"><apply id="S3.T1.12.12.1.m1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.1.m1.1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1">subscript</csymbol><apply id="S3.T1.12.12.1.m1.1.1.2.cmml" xref="S3.T1.12.12.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.1.m1.1.1.2.1.cmml" xref="S3.T1.12.12.1.m1.1.1">superscript</csymbol><apply id="S3.T1.12.12.1.m1.1.1.2.2.cmml" xref="S3.T1.12.12.1.m1.1.1.2.2"><ci id="S3.T1.12.12.1.m1.1.1.2.2.1.cmml" xref="S3.T1.12.12.1.m1.1.1.2.2.1">~</ci><ci id="S3.T1.12.12.1.m1.1.1.2.2.2.cmml" xref="S3.T1.12.12.1.m1.1.1.2.2.2">𝐦</ci></apply><compose id="S3.T1.12.12.1.m1.1.1.2.3.cmml" xref="S3.T1.12.12.1.m1.1.1.2.3"></compose></apply><ci id="S3.T1.12.12.1.m1.1.1.3.cmml" xref="S3.T1.12.12.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.1.m1.1c">\mathbf{\tilde{m}}^{\circ}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.12.1.m1.1d">over~ start_ARG bold_m end_ARG start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.12.12.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.12.12.2.1">
<span class="ltx_p" id="S3.T1.12.12.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.12.12.2.1.1.1" style="font-size:90%;">mediator feature estimated by teachers with back-door adjustment</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.13.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.13.13.1"><math alttext="o,{\tilde{o}},{\hat{o}}" class="ltx_Math" display="inline" id="S3.T1.13.13.1.m1.3"><semantics id="S3.T1.13.13.1.m1.3a"><mrow id="S3.T1.13.13.1.m1.3.4.2" xref="S3.T1.13.13.1.m1.3.4.1.cmml"><mi id="S3.T1.13.13.1.m1.1.1" mathsize="90%" xref="S3.T1.13.13.1.m1.1.1.cmml">o</mi><mo id="S3.T1.13.13.1.m1.3.4.2.1" mathsize="90%" xref="S3.T1.13.13.1.m1.3.4.1.cmml">,</mo><mover accent="true" id="S3.T1.13.13.1.m1.2.2" xref="S3.T1.13.13.1.m1.2.2.cmml"><mi id="S3.T1.13.13.1.m1.2.2.2" mathsize="90%" xref="S3.T1.13.13.1.m1.2.2.2.cmml">o</mi><mo id="S3.T1.13.13.1.m1.2.2.1" mathsize="90%" xref="S3.T1.13.13.1.m1.2.2.1.cmml">~</mo></mover><mo id="S3.T1.13.13.1.m1.3.4.2.2" mathsize="90%" xref="S3.T1.13.13.1.m1.3.4.1.cmml">,</mo><mover accent="true" id="S3.T1.13.13.1.m1.3.3" xref="S3.T1.13.13.1.m1.3.3.cmml"><mi id="S3.T1.13.13.1.m1.3.3.2" mathsize="90%" xref="S3.T1.13.13.1.m1.3.3.2.cmml">o</mi><mo id="S3.T1.13.13.1.m1.3.3.1" mathsize="90%" xref="S3.T1.13.13.1.m1.3.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.1.m1.3b"><list id="S3.T1.13.13.1.m1.3.4.1.cmml" xref="S3.T1.13.13.1.m1.3.4.2"><ci id="S3.T1.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1">𝑜</ci><apply id="S3.T1.13.13.1.m1.2.2.cmml" xref="S3.T1.13.13.1.m1.2.2"><ci id="S3.T1.13.13.1.m1.2.2.1.cmml" xref="S3.T1.13.13.1.m1.2.2.1">~</ci><ci id="S3.T1.13.13.1.m1.2.2.2.cmml" xref="S3.T1.13.13.1.m1.2.2.2">𝑜</ci></apply><apply id="S3.T1.13.13.1.m1.3.3.cmml" xref="S3.T1.13.13.1.m1.3.3"><ci id="S3.T1.13.13.1.m1.3.3.1.cmml" xref="S3.T1.13.13.1.m1.3.3.1">^</ci><ci id="S3.T1.13.13.1.m1.3.3.2.cmml" xref="S3.T1.13.13.1.m1.3.3.2">𝑜</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.1.m1.3c">o,{\tilde{o}},{\hat{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.13.13.1.m1.3d">italic_o , over~ start_ARG italic_o end_ARG , over^ start_ARG italic_o end_ARG</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.13.13.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.13.13.2.1">
<span class="ltx_p" id="S3.T1.13.13.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.13.13.2.1.1.1" style="font-size:90%;">recommendation label (</span><span class="ltx_text ltx_font_italic" id="S3.T1.13.13.2.1.1.2" style="font-size:90%;">e</span><span class="ltx_text" id="S3.T1.13.13.2.1.1.3" style="font-size:90%;">.</span><span class="ltx_text ltx_font_italic" id="S3.T1.13.13.2.1.1.4" style="font-size:90%;">g</span><span class="ltx_text" id="S3.T1.13.13.2.1.1.5" style="font-size:90%;">., CTR), prediction estimated by teachers with front-door adjustment, prediction made by the student</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.14.14.1"><math alttext="\psi_{FDA}" class="ltx_Math" display="inline" id="S3.T1.14.14.1.m1.1"><semantics id="S3.T1.14.14.1.m1.1a"><msub id="S3.T1.14.14.1.m1.1.1" xref="S3.T1.14.14.1.m1.1.1.cmml"><mi id="S3.T1.14.14.1.m1.1.1.2" mathsize="90%" xref="S3.T1.14.14.1.m1.1.1.2.cmml">ψ</mi><mrow id="S3.T1.14.14.1.m1.1.1.3" xref="S3.T1.14.14.1.m1.1.1.3.cmml"><mi id="S3.T1.14.14.1.m1.1.1.3.2" mathsize="90%" xref="S3.T1.14.14.1.m1.1.1.3.2.cmml">F</mi><mo id="S3.T1.14.14.1.m1.1.1.3.1" xref="S3.T1.14.14.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.14.14.1.m1.1.1.3.3" mathsize="90%" xref="S3.T1.14.14.1.m1.1.1.3.3.cmml">D</mi><mo id="S3.T1.14.14.1.m1.1.1.3.1a" xref="S3.T1.14.14.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.14.14.1.m1.1.1.3.4" mathsize="90%" xref="S3.T1.14.14.1.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.1.m1.1b"><apply id="S3.T1.14.14.1.m1.1.1.cmml" xref="S3.T1.14.14.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.14.14.1.m1.1.1.1.cmml" xref="S3.T1.14.14.1.m1.1.1">subscript</csymbol><ci id="S3.T1.14.14.1.m1.1.1.2.cmml" xref="S3.T1.14.14.1.m1.1.1.2">𝜓</ci><apply id="S3.T1.14.14.1.m1.1.1.3.cmml" xref="S3.T1.14.14.1.m1.1.1.3"><times id="S3.T1.14.14.1.m1.1.1.3.1.cmml" xref="S3.T1.14.14.1.m1.1.1.3.1"></times><ci id="S3.T1.14.14.1.m1.1.1.3.2.cmml" xref="S3.T1.14.14.1.m1.1.1.3.2">𝐹</ci><ci id="S3.T1.14.14.1.m1.1.1.3.3.cmml" xref="S3.T1.14.14.1.m1.1.1.3.3">𝐷</ci><ci id="S3.T1.14.14.1.m1.1.1.3.4.cmml" xref="S3.T1.14.14.1.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.1.m1.1c">\psi_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.14.14.1.m1.1d">italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.15.15.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.15.15.2.1">
<span class="ltx_p" id="S3.T1.15.15.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.15.15.2.1.1.1" style="font-size:90%;">fully-connected layers for estimating </span><math alttext="{\tilde{o}}" class="ltx_Math" display="inline" id="S3.T1.15.15.2.1.1.m1.1"><semantics id="S3.T1.15.15.2.1.1.m1.1a"><mover accent="true" id="S3.T1.15.15.2.1.1.m1.1.1" xref="S3.T1.15.15.2.1.1.m1.1.1.cmml"><mi id="S3.T1.15.15.2.1.1.m1.1.1.2" mathsize="90%" xref="S3.T1.15.15.2.1.1.m1.1.1.2.cmml">o</mi><mo id="S3.T1.15.15.2.1.1.m1.1.1.1" mathsize="90%" xref="S3.T1.15.15.2.1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.2.1.1.m1.1b"><apply id="S3.T1.15.15.2.1.1.m1.1.1.cmml" xref="S3.T1.15.15.2.1.1.m1.1.1"><ci id="S3.T1.15.15.2.1.1.m1.1.1.1.cmml" xref="S3.T1.15.15.2.1.1.m1.1.1.1">~</ci><ci id="S3.T1.15.15.2.1.1.m1.1.1.2.cmml" xref="S3.T1.15.15.2.1.1.m1.1.1.2">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.2.1.1.m1.1c">{\tilde{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.15.15.2.1.1.m1.1d">over~ start_ARG italic_o end_ARG</annotation></semantics></math><span class="ltx_text" id="S3.T1.15.15.2.1.1.2" style="font-size:90%;"> with front-door adjustment</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.16.16.1"><math alttext="\psi^{*}" class="ltx_Math" display="inline" id="S3.T1.16.16.1.m1.1"><semantics id="S3.T1.16.16.1.m1.1a"><msup id="S3.T1.16.16.1.m1.1.1" xref="S3.T1.16.16.1.m1.1.1.cmml"><mi id="S3.T1.16.16.1.m1.1.1.2" mathsize="90%" xref="S3.T1.16.16.1.m1.1.1.2.cmml">ψ</mi><mo id="S3.T1.16.16.1.m1.1.1.3" mathsize="90%" xref="S3.T1.16.16.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.1.m1.1b"><apply id="S3.T1.16.16.1.m1.1.1.cmml" xref="S3.T1.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.16.16.1.m1.1.1.1.cmml" xref="S3.T1.16.16.1.m1.1.1">superscript</csymbol><ci id="S3.T1.16.16.1.m1.1.1.2.cmml" xref="S3.T1.16.16.1.m1.1.1.2">𝜓</ci><times id="S3.T1.16.16.1.m1.1.1.3.cmml" xref="S3.T1.16.16.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.1.m1.1c">\psi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.16.16.1.m1.1d">italic_ψ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.17.17.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.17.17.2.1">
<span class="ltx_p" id="S3.T1.17.17.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.17.17.2.1.1.1" style="font-size:90%;">fully-connected layers for estimating </span><math alttext="{\hat{o}}" class="ltx_Math" display="inline" id="S3.T1.17.17.2.1.1.m1.1"><semantics id="S3.T1.17.17.2.1.1.m1.1a"><mover accent="true" id="S3.T1.17.17.2.1.1.m1.1.1" xref="S3.T1.17.17.2.1.1.m1.1.1.cmml"><mi id="S3.T1.17.17.2.1.1.m1.1.1.2" mathsize="90%" xref="S3.T1.17.17.2.1.1.m1.1.1.2.cmml">o</mi><mo id="S3.T1.17.17.2.1.1.m1.1.1.1" mathsize="90%" xref="S3.T1.17.17.2.1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.2.1.1.m1.1b"><apply id="S3.T1.17.17.2.1.1.m1.1.1.cmml" xref="S3.T1.17.17.2.1.1.m1.1.1"><ci id="S3.T1.17.17.2.1.1.m1.1.1.1.cmml" xref="S3.T1.17.17.2.1.1.m1.1.1.1">^</ci><ci id="S3.T1.17.17.2.1.1.m1.1.1.2.cmml" xref="S3.T1.17.17.2.1.1.m1.1.1.2">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.2.1.1.m1.1c">{\hat{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.17.17.2.1.1.m1.1d">over^ start_ARG italic_o end_ARG</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.19.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.18.18.1"><math alttext="\mathbf{W}_{1},\mathbf{W}_{2}" class="ltx_Math" display="inline" id="S3.T1.18.18.1.m1.2"><semantics id="S3.T1.18.18.1.m1.2a"><mrow id="S3.T1.18.18.1.m1.2.2.2" xref="S3.T1.18.18.1.m1.2.2.3.cmml"><msub id="S3.T1.18.18.1.m1.1.1.1.1" xref="S3.T1.18.18.1.m1.1.1.1.1.cmml"><mi id="S3.T1.18.18.1.m1.1.1.1.1.2" mathsize="90%" xref="S3.T1.18.18.1.m1.1.1.1.1.2.cmml">𝐖</mi><mn id="S3.T1.18.18.1.m1.1.1.1.1.3" mathsize="90%" xref="S3.T1.18.18.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.T1.18.18.1.m1.2.2.2.3" mathsize="90%" xref="S3.T1.18.18.1.m1.2.2.3.cmml">,</mo><msub id="S3.T1.18.18.1.m1.2.2.2.2" xref="S3.T1.18.18.1.m1.2.2.2.2.cmml"><mi id="S3.T1.18.18.1.m1.2.2.2.2.2" mathsize="90%" xref="S3.T1.18.18.1.m1.2.2.2.2.2.cmml">𝐖</mi><mn id="S3.T1.18.18.1.m1.2.2.2.2.3" mathsize="90%" xref="S3.T1.18.18.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.1.m1.2b"><list id="S3.T1.18.18.1.m1.2.2.3.cmml" xref="S3.T1.18.18.1.m1.2.2.2"><apply id="S3.T1.18.18.1.m1.1.1.1.1.cmml" xref="S3.T1.18.18.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.18.18.1.m1.1.1.1.1.1.cmml" xref="S3.T1.18.18.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.18.18.1.m1.1.1.1.1.2.cmml" xref="S3.T1.18.18.1.m1.1.1.1.1.2">𝐖</ci><cn id="S3.T1.18.18.1.m1.1.1.1.1.3.cmml" type="integer" xref="S3.T1.18.18.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.18.18.1.m1.2.2.2.2.cmml" xref="S3.T1.18.18.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.18.18.1.m1.2.2.2.2.1.cmml" xref="S3.T1.18.18.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.18.18.1.m1.2.2.2.2.2.cmml" xref="S3.T1.18.18.1.m1.2.2.2.2.2">𝐖</ci><cn id="S3.T1.18.18.1.m1.2.2.2.2.3.cmml" type="integer" xref="S3.T1.18.18.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.1.m1.2c">\mathbf{W}_{1},\mathbf{W}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.18.18.1.m1.2d">bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.19.19.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.19.19.2.1">
<span class="ltx_p" id="S3.T1.19.19.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.19.19.2.1.1.1" style="font-size:90%;">trainable matrices for estimating the conditional probability </span><math alttext="P(M=m\mid X)" class="ltx_Math" display="inline" id="S3.T1.19.19.2.1.1.m1.1"><semantics id="S3.T1.19.19.2.1.1.m1.1a"><mrow id="S3.T1.19.19.2.1.1.m1.1.1" xref="S3.T1.19.19.2.1.1.m1.1.1.cmml"><mi id="S3.T1.19.19.2.1.1.m1.1.1.3" mathsize="90%" xref="S3.T1.19.19.2.1.1.m1.1.1.3.cmml">P</mi><mo id="S3.T1.19.19.2.1.1.m1.1.1.2" xref="S3.T1.19.19.2.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.19.19.2.1.1.m1.1.1.1.1" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.cmml"><mo id="S3.T1.19.19.2.1.1.m1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.2" mathsize="90%" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.2.cmml">M</mi><mo id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.1" mathsize="90%" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.2" mathsize="90%" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.2.cmml">m</mi><mo id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.1" mathsize="90%" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.1.cmml">∣</mo><mi id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.3" mathsize="90%" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S3.T1.19.19.2.1.1.m1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.19.19.2.1.1.m1.1b"><apply id="S3.T1.19.19.2.1.1.m1.1.1.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1"><times id="S3.T1.19.19.2.1.1.m1.1.1.2.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.2"></times><ci id="S3.T1.19.19.2.1.1.m1.1.1.3.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.3">𝑃</ci><apply id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1"><eq id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.1"></eq><ci id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.2">𝑀</ci><apply id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.2">𝑚</ci><ci id="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.T1.19.19.2.1.1.m1.1.1.1.1.1.3.3">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.19.2.1.1.m1.1c">P(M=m\mid X)</annotation><annotation encoding="application/x-llamapun" id="S3.T1.19.19.2.1.1.m1.1d">italic_P ( italic_M = italic_m ∣ italic_X )</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.20.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.20.20.1"><math alttext="\mathcal{L}_{BDA}" class="ltx_Math" display="inline" id="S3.T1.20.20.1.m1.1"><semantics id="S3.T1.20.20.1.m1.1a"><msub id="S3.T1.20.20.1.m1.1.1" xref="S3.T1.20.20.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.20.20.1.m1.1.1.2" mathsize="90%" xref="S3.T1.20.20.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T1.20.20.1.m1.1.1.3" xref="S3.T1.20.20.1.m1.1.1.3.cmml"><mi id="S3.T1.20.20.1.m1.1.1.3.2" mathsize="90%" xref="S3.T1.20.20.1.m1.1.1.3.2.cmml">B</mi><mo id="S3.T1.20.20.1.m1.1.1.3.1" xref="S3.T1.20.20.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.20.20.1.m1.1.1.3.3" mathsize="90%" xref="S3.T1.20.20.1.m1.1.1.3.3.cmml">D</mi><mo id="S3.T1.20.20.1.m1.1.1.3.1a" xref="S3.T1.20.20.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.20.20.1.m1.1.1.3.4" mathsize="90%" xref="S3.T1.20.20.1.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.1.m1.1b"><apply id="S3.T1.20.20.1.m1.1.1.cmml" xref="S3.T1.20.20.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.20.20.1.m1.1.1.1.cmml" xref="S3.T1.20.20.1.m1.1.1">subscript</csymbol><ci id="S3.T1.20.20.1.m1.1.1.2.cmml" xref="S3.T1.20.20.1.m1.1.1.2">ℒ</ci><apply id="S3.T1.20.20.1.m1.1.1.3.cmml" xref="S3.T1.20.20.1.m1.1.1.3"><times id="S3.T1.20.20.1.m1.1.1.3.1.cmml" xref="S3.T1.20.20.1.m1.1.1.3.1"></times><ci id="S3.T1.20.20.1.m1.1.1.3.2.cmml" xref="S3.T1.20.20.1.m1.1.1.3.2">𝐵</ci><ci id="S3.T1.20.20.1.m1.1.1.3.3.cmml" xref="S3.T1.20.20.1.m1.1.1.3.3">𝐷</ci><ci id="S3.T1.20.20.1.m1.1.1.3.4.cmml" xref="S3.T1.20.20.1.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.1.m1.1c">\mathcal{L}_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.20.20.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.20.20.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.20.20.2.1">
<span class="ltx_p" id="S3.T1.20.20.2.1.1" style="width:170.7pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.20.20.2.1.1.1" style="font-size:90%;">feature</span><span class="ltx_text" id="S3.T1.20.20.2.1.1.2" style="font-size:90%;"> distillation loss with back-door adjustment</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.21.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.21.21.1"><math alttext="\mathcal{L}_{FDA}" class="ltx_Math" display="inline" id="S3.T1.21.21.1.m1.1"><semantics id="S3.T1.21.21.1.m1.1a"><msub id="S3.T1.21.21.1.m1.1.1" xref="S3.T1.21.21.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.21.21.1.m1.1.1.2" mathsize="90%" xref="S3.T1.21.21.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T1.21.21.1.m1.1.1.3" xref="S3.T1.21.21.1.m1.1.1.3.cmml"><mi id="S3.T1.21.21.1.m1.1.1.3.2" mathsize="90%" xref="S3.T1.21.21.1.m1.1.1.3.2.cmml">F</mi><mo id="S3.T1.21.21.1.m1.1.1.3.1" xref="S3.T1.21.21.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.21.21.1.m1.1.1.3.3" mathsize="90%" xref="S3.T1.21.21.1.m1.1.1.3.3.cmml">D</mi><mo id="S3.T1.21.21.1.m1.1.1.3.1a" xref="S3.T1.21.21.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.21.21.1.m1.1.1.3.4" mathsize="90%" xref="S3.T1.21.21.1.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.21.21.1.m1.1b"><apply id="S3.T1.21.21.1.m1.1.1.cmml" xref="S3.T1.21.21.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.21.21.1.m1.1.1.1.cmml" xref="S3.T1.21.21.1.m1.1.1">subscript</csymbol><ci id="S3.T1.21.21.1.m1.1.1.2.cmml" xref="S3.T1.21.21.1.m1.1.1.2">ℒ</ci><apply id="S3.T1.21.21.1.m1.1.1.3.cmml" xref="S3.T1.21.21.1.m1.1.1.3"><times id="S3.T1.21.21.1.m1.1.1.3.1.cmml" xref="S3.T1.21.21.1.m1.1.1.3.1"></times><ci id="S3.T1.21.21.1.m1.1.1.3.2.cmml" xref="S3.T1.21.21.1.m1.1.1.3.2">𝐹</ci><ci id="S3.T1.21.21.1.m1.1.1.3.3.cmml" xref="S3.T1.21.21.1.m1.1.1.3.3">𝐷</ci><ci id="S3.T1.21.21.1.m1.1.1.3.4.cmml" xref="S3.T1.21.21.1.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.21.1.m1.1c">\mathcal{L}_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.21.21.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.21.21.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.21.21.2.1">
<span class="ltx_p" id="S3.T1.21.21.2.1.1" style="width:170.7pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.21.21.2.1.1.1" style="font-size:90%;">label</span><span class="ltx_text" id="S3.T1.21.21.2.1.1.2" style="font-size:90%;"> distillation loss with front-door adjustment</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.22">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.22.22.1"><math alttext="\mathcal{L}_{Rec}" class="ltx_Math" display="inline" id="S3.T1.22.22.1.m1.1"><semantics id="S3.T1.22.22.1.m1.1a"><msub id="S3.T1.22.22.1.m1.1.1" xref="S3.T1.22.22.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.22.22.1.m1.1.1.2" mathsize="90%" xref="S3.T1.22.22.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T1.22.22.1.m1.1.1.3" xref="S3.T1.22.22.1.m1.1.1.3.cmml"><mi id="S3.T1.22.22.1.m1.1.1.3.2" mathsize="90%" xref="S3.T1.22.22.1.m1.1.1.3.2.cmml">R</mi><mo id="S3.T1.22.22.1.m1.1.1.3.1" xref="S3.T1.22.22.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.22.22.1.m1.1.1.3.3" mathsize="90%" xref="S3.T1.22.22.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.T1.22.22.1.m1.1.1.3.1a" xref="S3.T1.22.22.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.22.22.1.m1.1.1.3.4" mathsize="90%" xref="S3.T1.22.22.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.22.22.1.m1.1b"><apply id="S3.T1.22.22.1.m1.1.1.cmml" xref="S3.T1.22.22.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.22.22.1.m1.1.1.1.cmml" xref="S3.T1.22.22.1.m1.1.1">subscript</csymbol><ci id="S3.T1.22.22.1.m1.1.1.2.cmml" xref="S3.T1.22.22.1.m1.1.1.2">ℒ</ci><apply id="S3.T1.22.22.1.m1.1.1.3.cmml" xref="S3.T1.22.22.1.m1.1.1.3"><times id="S3.T1.22.22.1.m1.1.1.3.1.cmml" xref="S3.T1.22.22.1.m1.1.1.3.1"></times><ci id="S3.T1.22.22.1.m1.1.1.3.2.cmml" xref="S3.T1.22.22.1.m1.1.1.3.2">𝑅</ci><ci id="S3.T1.22.22.1.m1.1.1.3.3.cmml" xref="S3.T1.22.22.1.m1.1.1.3.3">𝑒</ci><ci id="S3.T1.22.22.1.m1.1.1.3.4.cmml" xref="S3.T1.22.22.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.22.22.1.m1.1c">\mathcal{L}_{Rec}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.22.22.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S3.T1.22.22.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.22.22.2.1">
<span class="ltx_p" id="S3.T1.22.22.2.1.1" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.22.22.2.1.1.1" style="font-size:90%;">original recommendation loss (</span><span class="ltx_text ltx_font_italic" id="S3.T1.22.22.2.1.1.2" style="font-size:90%;">e</span><span class="ltx_text" id="S3.T1.22.22.2.1.1.3" style="font-size:90%;">.</span><span class="ltx_text ltx_font_italic" id="S3.T1.22.22.2.1.1.4" style="font-size:90%;">g</span><span class="ltx_text" id="S3.T1.22.22.2.1.1.5" style="font-size:90%;">., BPR loss, Sampled Softmax loss)</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.25.25">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S3.T1.23.23.1"><math alttext="\lambda_{BDA},\lambda_{FDA}" class="ltx_Math" display="inline" id="S3.T1.23.23.1.m1.2"><semantics id="S3.T1.23.23.1.m1.2a"><mrow id="S3.T1.23.23.1.m1.2.2.2" xref="S3.T1.23.23.1.m1.2.2.3.cmml"><msub id="S3.T1.23.23.1.m1.1.1.1.1" xref="S3.T1.23.23.1.m1.1.1.1.1.cmml"><mi id="S3.T1.23.23.1.m1.1.1.1.1.2" mathsize="90%" xref="S3.T1.23.23.1.m1.1.1.1.1.2.cmml">λ</mi><mrow id="S3.T1.23.23.1.m1.1.1.1.1.3" xref="S3.T1.23.23.1.m1.1.1.1.1.3.cmml"><mi id="S3.T1.23.23.1.m1.1.1.1.1.3.2" mathsize="90%" xref="S3.T1.23.23.1.m1.1.1.1.1.3.2.cmml">B</mi><mo id="S3.T1.23.23.1.m1.1.1.1.1.3.1" xref="S3.T1.23.23.1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.23.23.1.m1.1.1.1.1.3.3" mathsize="90%" xref="S3.T1.23.23.1.m1.1.1.1.1.3.3.cmml">D</mi><mo id="S3.T1.23.23.1.m1.1.1.1.1.3.1a" xref="S3.T1.23.23.1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.23.23.1.m1.1.1.1.1.3.4" mathsize="90%" xref="S3.T1.23.23.1.m1.1.1.1.1.3.4.cmml">A</mi></mrow></msub><mo id="S3.T1.23.23.1.m1.2.2.2.3" mathsize="90%" xref="S3.T1.23.23.1.m1.2.2.3.cmml">,</mo><msub id="S3.T1.23.23.1.m1.2.2.2.2" xref="S3.T1.23.23.1.m1.2.2.2.2.cmml"><mi id="S3.T1.23.23.1.m1.2.2.2.2.2" mathsize="90%" xref="S3.T1.23.23.1.m1.2.2.2.2.2.cmml">λ</mi><mrow id="S3.T1.23.23.1.m1.2.2.2.2.3" xref="S3.T1.23.23.1.m1.2.2.2.2.3.cmml"><mi id="S3.T1.23.23.1.m1.2.2.2.2.3.2" mathsize="90%" xref="S3.T1.23.23.1.m1.2.2.2.2.3.2.cmml">F</mi><mo id="S3.T1.23.23.1.m1.2.2.2.2.3.1" xref="S3.T1.23.23.1.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.T1.23.23.1.m1.2.2.2.2.3.3" mathsize="90%" xref="S3.T1.23.23.1.m1.2.2.2.2.3.3.cmml">D</mi><mo id="S3.T1.23.23.1.m1.2.2.2.2.3.1a" xref="S3.T1.23.23.1.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.T1.23.23.1.m1.2.2.2.2.3.4" mathsize="90%" xref="S3.T1.23.23.1.m1.2.2.2.2.3.4.cmml">A</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.23.23.1.m1.2b"><list id="S3.T1.23.23.1.m1.2.2.3.cmml" xref="S3.T1.23.23.1.m1.2.2.2"><apply id="S3.T1.23.23.1.m1.1.1.1.1.cmml" xref="S3.T1.23.23.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.23.23.1.m1.1.1.1.1.1.cmml" xref="S3.T1.23.23.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.23.23.1.m1.1.1.1.1.2.cmml" xref="S3.T1.23.23.1.m1.1.1.1.1.2">𝜆</ci><apply id="S3.T1.23.23.1.m1.1.1.1.1.3.cmml" xref="S3.T1.23.23.1.m1.1.1.1.1.3"><times id="S3.T1.23.23.1.m1.1.1.1.1.3.1.cmml" xref="S3.T1.23.23.1.m1.1.1.1.1.3.1"></times><ci id="S3.T1.23.23.1.m1.1.1.1.1.3.2.cmml" xref="S3.T1.23.23.1.m1.1.1.1.1.3.2">𝐵</ci><ci id="S3.T1.23.23.1.m1.1.1.1.1.3.3.cmml" xref="S3.T1.23.23.1.m1.1.1.1.1.3.3">𝐷</ci><ci id="S3.T1.23.23.1.m1.1.1.1.1.3.4.cmml" xref="S3.T1.23.23.1.m1.1.1.1.1.3.4">𝐴</ci></apply></apply><apply id="S3.T1.23.23.1.m1.2.2.2.2.cmml" xref="S3.T1.23.23.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.23.23.1.m1.2.2.2.2.1.cmml" xref="S3.T1.23.23.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.23.23.1.m1.2.2.2.2.2.cmml" xref="S3.T1.23.23.1.m1.2.2.2.2.2">𝜆</ci><apply id="S3.T1.23.23.1.m1.2.2.2.2.3.cmml" xref="S3.T1.23.23.1.m1.2.2.2.2.3"><times id="S3.T1.23.23.1.m1.2.2.2.2.3.1.cmml" xref="S3.T1.23.23.1.m1.2.2.2.2.3.1"></times><ci id="S3.T1.23.23.1.m1.2.2.2.2.3.2.cmml" xref="S3.T1.23.23.1.m1.2.2.2.2.3.2">𝐹</ci><ci id="S3.T1.23.23.1.m1.2.2.2.2.3.3.cmml" xref="S3.T1.23.23.1.m1.2.2.2.2.3.3">𝐷</ci><ci id="S3.T1.23.23.1.m1.2.2.2.2.3.4.cmml" xref="S3.T1.23.23.1.m1.2.2.2.2.3.4">𝐴</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.23.23.1.m1.2c">\lambda_{BDA},\lambda_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.23.23.1.m1.2d">italic_λ start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S3.T1.25.25.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.25.25.3.2">
<span class="ltx_p" id="S3.T1.25.25.3.2.2" style="width:170.7pt;"><span class="ltx_text" id="S3.T1.25.25.3.2.2.3" style="font-size:90%;">coefficients to </span><span class="ltx_text" id="S3.T1.25.25.3.2.2.2" style="font-size:90%;">control<span class="ltx_text" id="S3.T1.25.25.3.2.2.2.2"> <math alttext="\mathcal{L}_{BDA}" class="ltx_Math" display="inline" id="S3.T1.24.24.2.1.1.1.1.m1.1"><semantics id="S3.T1.24.24.2.1.1.1.1.m1.1a"><msub id="S3.T1.24.24.2.1.1.1.1.m1.1.1" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.24.24.2.1.1.1.1.m1.1.1.2" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.cmml"><mi id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.2" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.2.cmml">B</mi><mo id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.1" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.3" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.3.cmml">D</mi><mo id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.1a" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.4" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.24.24.2.1.1.1.1.m1.1b"><apply id="S3.T1.24.24.2.1.1.1.1.m1.1.1.cmml" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.24.24.2.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.24.24.2.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.2">ℒ</ci><apply id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3"><times id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.1"></times><ci id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.2">𝐵</ci><ci id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.3.cmml" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.3">𝐷</ci><ci id="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.4.cmml" xref="S3.T1.24.24.2.1.1.1.1.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.24.24.2.1.1.1.1.m1.1c">\mathcal{L}_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.24.24.2.1.1.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{L}_{FDA}" class="ltx_Math" display="inline" id="S3.T1.25.25.3.2.2.2.2.m2.1"><semantics id="S3.T1.25.25.3.2.2.2.2.m2.1a"><msub id="S3.T1.25.25.3.2.2.2.2.m2.1.1" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.25.25.3.2.2.2.2.m2.1.1.2" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.cmml"><mi id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.2" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.2.cmml">F</mi><mo id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.1" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.3" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.3.cmml">D</mi><mo id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.1a" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.4" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.25.25.3.2.2.2.2.m2.1b"><apply id="S3.T1.25.25.3.2.2.2.2.m2.1.1.cmml" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.25.25.3.2.2.2.2.m2.1.1.1.cmml" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1">subscript</csymbol><ci id="S3.T1.25.25.3.2.2.2.2.m2.1.1.2.cmml" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.2">ℒ</ci><apply id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.cmml" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3"><times id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.1.cmml" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.1"></times><ci id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.2.cmml" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.2">𝐹</ci><ci id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.3.cmml" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.3">𝐷</ci><ci id="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.4.cmml" xref="S3.T1.25.25.3.2.2.2.2.m2.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.25.25.3.2.2.2.2.m2.1c">\mathcal{L}_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.25.25.3.2.2.2.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math></span></span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p4">
<p class="ltx_p" id="S3.SS3.SSS2.p4.7"><span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p4.1.1">Modeling of <math alttext="P(Y\mid M=m_{k,i},X=x_{j})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.1.1.m1.3"><semantics id="S3.SS3.SSS2.p4.1.1.m1.3a"><mrow id="S3.SS3.SSS2.p4.1.1.m1.3.3" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.cmml"><mi id="S3.SS3.SSS2.p4.1.1.m1.3.3.3" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.3.cmml">P</mi><mo id="S3.SS3.SSS2.p4.1.1.m1.3.3.2" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.cmml"><mo id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.cmml">(</mo><mrow id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.3.cmml"><mrow id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.2" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.1" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.1.cmml">∣</mo><mi id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.3" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.3.cmml">M</mi></mrow><mo id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3.2" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3.2.cmml">m</mi><mrow id="S3.SS3.SSS2.p4.1.1.m1.2.2.2.4" xref="S3.SS3.SSS2.p4.1.1.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p4.1.1.m1.1.1.1.1" xref="S3.SS3.SSS2.p4.1.1.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p4.1.1.m1.2.2.2.4.1" xref="S3.SS3.SSS2.p4.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p4.1.1.m1.2.2.2.2" xref="S3.SS3.SSS2.p4.1.1.m1.2.2.2.2.cmml">i</mi></mrow></msub></mrow><mo id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.3" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.3a.cmml">,</mo><mrow id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.2" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.2.cmml">X</mi><mo id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.1" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.1.cmml">=</mo><msub id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.2" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.2.cmml">x</mi><mi id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.3" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.1.1.m1.3b"><apply id="S3.SS3.SSS2.p4.1.1.m1.3.3.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3"><times id="S3.SS3.SSS2.p4.1.1.m1.3.3.2.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.2"></times><ci id="S3.SS3.SSS2.p4.1.1.m1.3.3.3.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.3">𝑃</ci><apply id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.3a.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1"><eq id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.1"></eq><apply id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.1">conditional</csymbol><ci id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.2">𝑌</ci><ci id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.1.1.3.2">𝑚</ci><list id="S3.SS3.SSS2.p4.1.1.m1.2.2.2.3.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.2.2.2.4"><ci id="S3.SS3.SSS2.p4.1.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p4.1.1.m1.2.2.2.2.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.2.2.2.2">𝑖</ci></list></apply></apply><apply id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2"><eq id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.1"></eq><ci id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.2">𝑋</ci><apply id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.2">𝑥</ci><ci id="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.SS3.SSS2.p4.1.1.m1.3.3.1.1.1.2.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.1.1.m1.3c">P(Y\mid M=m_{k,i},X=x_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.1.1.m1.3d">italic_P ( italic_Y ∣ italic_M = italic_m start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT , italic_X = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>. </span> In recommender systems, the final prediction is generally pair-wise matching. For a user input <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.2.m1.1"><semantics id="S3.SS3.SSS2.p4.2.m1.1a"><msub id="S3.SS3.SSS2.p4.2.m1.1.1" xref="S3.SS3.SSS2.p4.2.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p4.2.m1.1.1.2" xref="S3.SS3.SSS2.p4.2.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p4.2.m1.1.1.3" xref="S3.SS3.SSS2.p4.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.2.m1.1b"><apply id="S3.SS3.SSS2.p4.2.m1.1.1.cmml" xref="S3.SS3.SSS2.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.2.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.2.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.2.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p4.2.m1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p4.2.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p4.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.2.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.2.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and a target item <math alttext="Y=y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.3.m2.1"><semantics id="S3.SS3.SSS2.p4.3.m2.1a"><mrow id="S3.SS3.SSS2.p4.3.m2.1.1" xref="S3.SS3.SSS2.p4.3.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p4.3.m2.1.1.2" xref="S3.SS3.SSS2.p4.3.m2.1.1.2.cmml">Y</mi><mo id="S3.SS3.SSS2.p4.3.m2.1.1.1" xref="S3.SS3.SSS2.p4.3.m2.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS2.p4.3.m2.1.1.3" xref="S3.SS3.SSS2.p4.3.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p4.3.m2.1.1.3.2" xref="S3.SS3.SSS2.p4.3.m2.1.1.3.2.cmml">y</mi><mi id="S3.SS3.SSS2.p4.3.m2.1.1.3.3" xref="S3.SS3.SSS2.p4.3.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.3.m2.1b"><apply id="S3.SS3.SSS2.p4.3.m2.1.1.cmml" xref="S3.SS3.SSS2.p4.3.m2.1.1"><eq id="S3.SS3.SSS2.p4.3.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p4.3.m2.1.1.1"></eq><ci id="S3.SS3.SSS2.p4.3.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p4.3.m2.1.1.2">𝑌</ci><apply id="S3.SS3.SSS2.p4.3.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p4.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.3.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p4.3.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p4.3.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p4.3.m2.1.1.3.2">𝑦</ci><ci id="S3.SS3.SSS2.p4.3.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p4.3.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.3.m2.1c">Y=y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.3.m2.1d">italic_Y = italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, the recommendation prediction is mostly a binary classification where the output <math alttext="{\hat{o}}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.4.m3.1"><semantics id="S3.SS3.SSS2.p4.4.m3.1a"><msub id="S3.SS3.SSS2.p4.4.m3.1.1" xref="S3.SS3.SSS2.p4.4.m3.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p4.4.m3.1.1.2" xref="S3.SS3.SSS2.p4.4.m3.1.1.2.cmml"><mi id="S3.SS3.SSS2.p4.4.m3.1.1.2.2" xref="S3.SS3.SSS2.p4.4.m3.1.1.2.2.cmml">o</mi><mo id="S3.SS3.SSS2.p4.4.m3.1.1.2.1" xref="S3.SS3.SSS2.p4.4.m3.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p4.4.m3.1.1.3" xref="S3.SS3.SSS2.p4.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.4.m3.1b"><apply id="S3.SS3.SSS2.p4.4.m3.1.1.cmml" xref="S3.SS3.SSS2.p4.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.4.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p4.4.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p4.4.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p4.4.m3.1.1.2"><ci id="S3.SS3.SSS2.p4.4.m3.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.4.m3.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p4.4.m3.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.4.m3.1.1.2.2">𝑜</ci></apply><ci id="S3.SS3.SSS2.p4.4.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p4.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.4.m3.1c">{\hat{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.4.m3.1d">over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> indicates whether the user will interact with the item (<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p4.7.2">e</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p4.7.3">g</span>., click or purchase).
Therefore, we can parameterize <math alttext="P(Y=y\mid M=m_{k,i},X=x_{j})" class="ltx_math_unparsed" display="inline" id="S3.SS3.SSS2.p4.5.m4.2"><semantics id="S3.SS3.SSS2.p4.5.m4.2a"><mrow id="S3.SS3.SSS2.p4.5.m4.2b"><mi id="S3.SS3.SSS2.p4.5.m4.2.3">P</mi><mrow id="S3.SS3.SSS2.p4.5.m4.2.4"><mo id="S3.SS3.SSS2.p4.5.m4.2.4.1" stretchy="false">(</mo><mi id="S3.SS3.SSS2.p4.5.m4.2.4.2">Y</mi><mo id="S3.SS3.SSS2.p4.5.m4.2.4.3">=</mo><mi id="S3.SS3.SSS2.p4.5.m4.2.4.4">y</mi><mo id="S3.SS3.SSS2.p4.5.m4.2.4.5" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.SS3.SSS2.p4.5.m4.2.4.6">M</mi><mo id="S3.SS3.SSS2.p4.5.m4.2.4.7">=</mo><msub id="S3.SS3.SSS2.p4.5.m4.2.4.8"><mi id="S3.SS3.SSS2.p4.5.m4.2.4.8.2">m</mi><mrow id="S3.SS3.SSS2.p4.5.m4.2.2.2.4"><mi id="S3.SS3.SSS2.p4.5.m4.1.1.1.1">k</mi><mo id="S3.SS3.SSS2.p4.5.m4.2.2.2.4.1">,</mo><mi id="S3.SS3.SSS2.p4.5.m4.2.2.2.2">i</mi></mrow></msub><mo id="S3.SS3.SSS2.p4.5.m4.2.4.9">,</mo><mi id="S3.SS3.SSS2.p4.5.m4.2.4.10">X</mi><mo id="S3.SS3.SSS2.p4.5.m4.2.4.11">=</mo><msub id="S3.SS3.SSS2.p4.5.m4.2.4.12"><mi id="S3.SS3.SSS2.p4.5.m4.2.4.12.2">x</mi><mi id="S3.SS3.SSS2.p4.5.m4.2.4.12.3">j</mi></msub><mo id="S3.SS3.SSS2.p4.5.m4.2.4.13" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.5.m4.2c">P(Y=y\mid M=m_{k,i},X=x_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.5.m4.2d">italic_P ( italic_Y = italic_y ∣ italic_M = italic_m start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT , italic_X = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> as a neural network <math alttext="\varphi(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.6.m5.1"><semantics id="S3.SS3.SSS2.p4.6.m5.1a"><mrow id="S3.SS3.SSS2.p4.6.m5.1.2" xref="S3.SS3.SSS2.p4.6.m5.1.2.cmml"><mi id="S3.SS3.SSS2.p4.6.m5.1.2.2" xref="S3.SS3.SSS2.p4.6.m5.1.2.2.cmml">φ</mi><mo id="S3.SS3.SSS2.p4.6.m5.1.2.1" xref="S3.SS3.SSS2.p4.6.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p4.6.m5.1.2.3.2" xref="S3.SS3.SSS2.p4.6.m5.1.2.cmml"><mo id="S3.SS3.SSS2.p4.6.m5.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p4.6.m5.1.2.cmml">(</mo><mo id="S3.SS3.SSS2.p4.6.m5.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p4.6.m5.1.1.cmml">⋅</mo><mo id="S3.SS3.SSS2.p4.6.m5.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS2.p4.6.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.6.m5.1b"><apply id="S3.SS3.SSS2.p4.6.m5.1.2.cmml" xref="S3.SS3.SSS2.p4.6.m5.1.2"><times id="S3.SS3.SSS2.p4.6.m5.1.2.1.cmml" xref="S3.SS3.SSS2.p4.6.m5.1.2.1"></times><ci id="S3.SS3.SSS2.p4.6.m5.1.2.2.cmml" xref="S3.SS3.SSS2.p4.6.m5.1.2.2">𝜑</ci><ci id="S3.SS3.SSS2.p4.6.m5.1.1.cmml" xref="S3.SS3.SSS2.p4.6.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.6.m5.1c">\varphi(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.6.m5.1d">italic_φ ( ⋅ )</annotation></semantics></math> followed by a sigmoid layer <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.7.m6.1"><semantics id="S3.SS3.SSS2.p4.7.m6.1a"><mi id="S3.SS3.SSS2.p4.7.m6.1.1" xref="S3.SS3.SSS2.p4.7.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.7.m6.1b"><ci id="S3.SS3.SSS2.p4.7.m6.1.1.cmml" xref="S3.SS3.SSS2.p4.7.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.7.m6.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.7.m6.1d">italic_σ</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx8">
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle P(Y=y_{i}\mid X=x_{j},M=m_{k,i})=\sigma(\varphi(x_{j},\mathbf{%
\tilde{m}}_{k,i},\mathbf{y}_{i}))," class="ltx_math_unparsed" display="inline" id="S3.E11.m1.4"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4b"><mi id="S3.E11.m1.4.5" mathcolor="#000000">P</mi><mrow id="S3.E11.m1.4.6"><mo id="S3.E11.m1.4.6.1" stretchy="false">(</mo><mi id="S3.E11.m1.4.6.2" mathcolor="#000000">Y</mi><mo id="S3.E11.m1.4.6.3">=</mo><msub id="S3.E11.m1.4.6.4"><mi id="S3.E11.m1.4.6.4.2" mathcolor="#000000">y</mi><mi id="S3.E11.m1.4.6.4.3">i</mi></msub><mo id="S3.E11.m1.4.6.5" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.E11.m1.4.6.6" mathcolor="#000000">X</mi><mo id="S3.E11.m1.4.6.7">=</mo><msub id="S3.E11.m1.4.6.8"><mi id="S3.E11.m1.4.6.8.2" mathcolor="#000000">x</mi><mi id="S3.E11.m1.4.6.8.3">j</mi></msub><mo id="S3.E11.m1.4.6.9">,</mo><mi id="S3.E11.m1.4.6.10" mathcolor="#000000">M</mi><mo id="S3.E11.m1.4.6.11">=</mo><msub id="S3.E11.m1.4.6.12"><mi id="S3.E11.m1.4.6.12.2" mathcolor="#000000">m</mi><mrow id="S3.E11.m1.2.2.2.4"><mi id="S3.E11.m1.1.1.1.1">k</mi><mo id="S3.E11.m1.2.2.2.4.1">,</mo><mi id="S3.E11.m1.2.2.2.2">i</mi></mrow></msub><mo id="S3.E11.m1.4.6.13" stretchy="false">)</mo></mrow><mo id="S3.E11.m1.4.7">=</mo><mi id="S3.E11.m1.4.8">σ</mi><mrow id="S3.E11.m1.4.9"><mo id="S3.E11.m1.4.9.1" stretchy="false">(</mo><mi id="S3.E11.m1.4.9.2">φ</mi><mrow id="S3.E11.m1.4.9.3"><mo id="S3.E11.m1.4.9.3.1" stretchy="false">(</mo><msub id="S3.E11.m1.4.9.3.2"><mi id="S3.E11.m1.4.9.3.2.2" mathcolor="#000000">x</mi><mi id="S3.E11.m1.4.9.3.2.3">j</mi></msub><mo id="S3.E11.m1.4.9.3.3">,</mo><msub id="S3.E11.m1.4.9.3.4"><mover accent="true" id="S3.E11.m1.4.9.3.4.2"><mi id="S3.E11.m1.4.9.3.4.2.2">𝐦</mi><mo id="S3.E11.m1.4.9.3.4.2.1">~</mo></mover><mrow id="S3.E11.m1.4.4.2.4"><mi id="S3.E11.m1.3.3.1.1">k</mi><mo id="S3.E11.m1.4.4.2.4.1">,</mo><mi id="S3.E11.m1.4.4.2.2">i</mi></mrow></msub><mo id="S3.E11.m1.4.9.3.5">,</mo><msub id="S3.E11.m1.4.9.3.6"><mi id="S3.E11.m1.4.9.3.6.2">𝐲</mi><mi id="S3.E11.m1.4.9.3.6.3">i</mi></msub><mo id="S3.E11.m1.4.9.3.7" stretchy="false">)</mo></mrow><mo id="S3.E11.m1.4.9.4" stretchy="false">)</mo></mrow><mo id="S3.E11.m1.4.10">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E11.m1.4c">\displaystyle P(Y=y_{i}\mid X=x_{j},M=m_{k,i})=\sigma(\varphi(x_{j},\mathbf{%
\tilde{m}}_{k,i},\mathbf{y}_{i})),</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.4d">italic_P ( italic_Y = italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∣ italic_X = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_M = italic_m start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ) = italic_σ ( italic_φ ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p4.23">where <math alttext="\mathbf{\tilde{m}}_{k,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.8.m1.2"><semantics id="S3.SS3.SSS2.p4.8.m1.2a"><msub id="S3.SS3.SSS2.p4.8.m1.2.3" xref="S3.SS3.SSS2.p4.8.m1.2.3.cmml"><mover accent="true" id="S3.SS3.SSS2.p4.8.m1.2.3.2" xref="S3.SS3.SSS2.p4.8.m1.2.3.2.cmml"><mi id="S3.SS3.SSS2.p4.8.m1.2.3.2.2" xref="S3.SS3.SSS2.p4.8.m1.2.3.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p4.8.m1.2.3.2.1" xref="S3.SS3.SSS2.p4.8.m1.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.SSS2.p4.8.m1.2.2.2.4" xref="S3.SS3.SSS2.p4.8.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p4.8.m1.1.1.1.1" xref="S3.SS3.SSS2.p4.8.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p4.8.m1.2.2.2.4.1" xref="S3.SS3.SSS2.p4.8.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p4.8.m1.2.2.2.2" xref="S3.SS3.SSS2.p4.8.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.8.m1.2b"><apply id="S3.SS3.SSS2.p4.8.m1.2.3.cmml" xref="S3.SS3.SSS2.p4.8.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.8.m1.2.3.1.cmml" xref="S3.SS3.SSS2.p4.8.m1.2.3">subscript</csymbol><apply id="S3.SS3.SSS2.p4.8.m1.2.3.2.cmml" xref="S3.SS3.SSS2.p4.8.m1.2.3.2"><ci id="S3.SS3.SSS2.p4.8.m1.2.3.2.1.cmml" xref="S3.SS3.SSS2.p4.8.m1.2.3.2.1">~</ci><ci id="S3.SS3.SSS2.p4.8.m1.2.3.2.2.cmml" xref="S3.SS3.SSS2.p4.8.m1.2.3.2.2">𝐦</ci></apply><list id="S3.SS3.SSS2.p4.8.m1.2.2.2.3.cmml" xref="S3.SS3.SSS2.p4.8.m1.2.2.2.4"><ci id="S3.SS3.SSS2.p4.8.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.8.m1.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p4.8.m1.2.2.2.2.cmml" xref="S3.SS3.SSS2.p4.8.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.8.m1.2c">\mathbf{\tilde{m}}_{k,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.8.m1.2d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\textbf{y}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.9.m2.1"><semantics id="S3.SS3.SSS2.p4.9.m2.1a"><msub id="S3.SS3.SSS2.p4.9.m2.1.1" xref="S3.SS3.SSS2.p4.9.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS2.p4.9.m2.1.1.2" xref="S3.SS3.SSS2.p4.9.m2.1.1.2a.cmml">y</mtext><mi id="S3.SS3.SSS2.p4.9.m2.1.1.3" xref="S3.SS3.SSS2.p4.9.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.9.m2.1b"><apply id="S3.SS3.SSS2.p4.9.m2.1.1.cmml" xref="S3.SS3.SSS2.p4.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.9.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p4.9.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.9.m2.1.1.2a.cmml" xref="S3.SS3.SSS2.p4.9.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS2.p4.9.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p4.9.m2.1.1.2">y</mtext></ci><ci id="S3.SS3.SSS2.p4.9.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p4.9.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.9.m2.1c">\textbf{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.9.m2.1d">y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are the vectorial representations of <math alttext="m_{k,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.10.m3.2"><semantics id="S3.SS3.SSS2.p4.10.m3.2a"><msub id="S3.SS3.SSS2.p4.10.m3.2.3" xref="S3.SS3.SSS2.p4.10.m3.2.3.cmml"><mi id="S3.SS3.SSS2.p4.10.m3.2.3.2" xref="S3.SS3.SSS2.p4.10.m3.2.3.2.cmml">m</mi><mrow id="S3.SS3.SSS2.p4.10.m3.2.2.2.4" xref="S3.SS3.SSS2.p4.10.m3.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p4.10.m3.1.1.1.1" xref="S3.SS3.SSS2.p4.10.m3.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p4.10.m3.2.2.2.4.1" xref="S3.SS3.SSS2.p4.10.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p4.10.m3.2.2.2.2" xref="S3.SS3.SSS2.p4.10.m3.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.10.m3.2b"><apply id="S3.SS3.SSS2.p4.10.m3.2.3.cmml" xref="S3.SS3.SSS2.p4.10.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.10.m3.2.3.1.cmml" xref="S3.SS3.SSS2.p4.10.m3.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p4.10.m3.2.3.2.cmml" xref="S3.SS3.SSS2.p4.10.m3.2.3.2">𝑚</ci><list id="S3.SS3.SSS2.p4.10.m3.2.2.2.3.cmml" xref="S3.SS3.SSS2.p4.10.m3.2.2.2.4"><ci id="S3.SS3.SSS2.p4.10.m3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.10.m3.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p4.10.m3.2.2.2.2.cmml" xref="S3.SS3.SSS2.p4.10.m3.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.10.m3.2c">m_{k,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.10.m3.2d">italic_m start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.11.m4.1"><semantics id="S3.SS3.SSS2.p4.11.m4.1a"><msub id="S3.SS3.SSS2.p4.11.m4.1.1" xref="S3.SS3.SSS2.p4.11.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p4.11.m4.1.1.2" xref="S3.SS3.SSS2.p4.11.m4.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS2.p4.11.m4.1.1.3" xref="S3.SS3.SSS2.p4.11.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.11.m4.1b"><apply id="S3.SS3.SSS2.p4.11.m4.1.1.cmml" xref="S3.SS3.SSS2.p4.11.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.11.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p4.11.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.11.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p4.11.m4.1.1.2">𝑦</ci><ci id="S3.SS3.SSS2.p4.11.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p4.11.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.11.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.11.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\mathbf{\tilde{m}}_{k,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.12.m5.2"><semantics id="S3.SS3.SSS2.p4.12.m5.2a"><msub id="S3.SS3.SSS2.p4.12.m5.2.3" xref="S3.SS3.SSS2.p4.12.m5.2.3.cmml"><mover accent="true" id="S3.SS3.SSS2.p4.12.m5.2.3.2" xref="S3.SS3.SSS2.p4.12.m5.2.3.2.cmml"><mi id="S3.SS3.SSS2.p4.12.m5.2.3.2.2" xref="S3.SS3.SSS2.p4.12.m5.2.3.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p4.12.m5.2.3.2.1" xref="S3.SS3.SSS2.p4.12.m5.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.SSS2.p4.12.m5.2.2.2.4" xref="S3.SS3.SSS2.p4.12.m5.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p4.12.m5.1.1.1.1" xref="S3.SS3.SSS2.p4.12.m5.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p4.12.m5.2.2.2.4.1" xref="S3.SS3.SSS2.p4.12.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p4.12.m5.2.2.2.2" xref="S3.SS3.SSS2.p4.12.m5.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.12.m5.2b"><apply id="S3.SS3.SSS2.p4.12.m5.2.3.cmml" xref="S3.SS3.SSS2.p4.12.m5.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.12.m5.2.3.1.cmml" xref="S3.SS3.SSS2.p4.12.m5.2.3">subscript</csymbol><apply id="S3.SS3.SSS2.p4.12.m5.2.3.2.cmml" xref="S3.SS3.SSS2.p4.12.m5.2.3.2"><ci id="S3.SS3.SSS2.p4.12.m5.2.3.2.1.cmml" xref="S3.SS3.SSS2.p4.12.m5.2.3.2.1">~</ci><ci id="S3.SS3.SSS2.p4.12.m5.2.3.2.2.cmml" xref="S3.SS3.SSS2.p4.12.m5.2.3.2.2">𝐦</ci></apply><list id="S3.SS3.SSS2.p4.12.m5.2.2.2.3.cmml" xref="S3.SS3.SSS2.p4.12.m5.2.2.2.4"><ci id="S3.SS3.SSS2.p4.12.m5.1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.12.m5.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p4.12.m5.2.2.2.2.cmml" xref="S3.SS3.SSS2.p4.12.m5.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.12.m5.2c">\mathbf{\tilde{m}}_{k,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.12.m5.2d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is extracted by the encoder of the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.13.m6.1"><semantics id="S3.SS3.SSS2.p4.13.m6.1a"><mi id="S3.SS3.SSS2.p4.13.m6.1.1" xref="S3.SS3.SSS2.p4.13.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.13.m6.1b"><ci id="S3.SS3.SSS2.p4.13.m6.1.1.cmml" xref="S3.SS3.SSS2.p4.13.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.13.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.13.m6.1d">italic_k</annotation></semantics></math>-th teacher recommendation model.
In recommendation models, <math alttext="\mathbf{\tilde{m}}_{k,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.14.m7.2"><semantics id="S3.SS3.SSS2.p4.14.m7.2a"><msub id="S3.SS3.SSS2.p4.14.m7.2.3" xref="S3.SS3.SSS2.p4.14.m7.2.3.cmml"><mover accent="true" id="S3.SS3.SSS2.p4.14.m7.2.3.2" xref="S3.SS3.SSS2.p4.14.m7.2.3.2.cmml"><mi id="S3.SS3.SSS2.p4.14.m7.2.3.2.2" xref="S3.SS3.SSS2.p4.14.m7.2.3.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p4.14.m7.2.3.2.1" xref="S3.SS3.SSS2.p4.14.m7.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.SSS2.p4.14.m7.2.2.2.4" xref="S3.SS3.SSS2.p4.14.m7.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p4.14.m7.1.1.1.1" xref="S3.SS3.SSS2.p4.14.m7.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p4.14.m7.2.2.2.4.1" xref="S3.SS3.SSS2.p4.14.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p4.14.m7.2.2.2.2" xref="S3.SS3.SSS2.p4.14.m7.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.14.m7.2b"><apply id="S3.SS3.SSS2.p4.14.m7.2.3.cmml" xref="S3.SS3.SSS2.p4.14.m7.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.14.m7.2.3.1.cmml" xref="S3.SS3.SSS2.p4.14.m7.2.3">subscript</csymbol><apply id="S3.SS3.SSS2.p4.14.m7.2.3.2.cmml" xref="S3.SS3.SSS2.p4.14.m7.2.3.2"><ci id="S3.SS3.SSS2.p4.14.m7.2.3.2.1.cmml" xref="S3.SS3.SSS2.p4.14.m7.2.3.2.1">~</ci><ci id="S3.SS3.SSS2.p4.14.m7.2.3.2.2.cmml" xref="S3.SS3.SSS2.p4.14.m7.2.3.2.2">𝐦</ci></apply><list id="S3.SS3.SSS2.p4.14.m7.2.2.2.3.cmml" xref="S3.SS3.SSS2.p4.14.m7.2.2.2.4"><ci id="S3.SS3.SSS2.p4.14.m7.1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.14.m7.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p4.14.m7.2.2.2.2.cmml" xref="S3.SS3.SSS2.p4.14.m7.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.14.m7.2c">\mathbf{\tilde{m}}_{k,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.14.m7.2d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> can be the user representation extracted from the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.15.m8.1"><semantics id="S3.SS3.SSS2.p4.15.m8.1a"><mi id="S3.SS3.SSS2.p4.15.m8.1.1" xref="S3.SS3.SSS2.p4.15.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.15.m8.1b"><ci id="S3.SS3.SSS2.p4.15.m8.1.1.cmml" xref="S3.SS3.SSS2.p4.15.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.15.m8.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.15.m8.1d">italic_i</annotation></semantics></math>-th user input data <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.16.m9.1"><semantics id="S3.SS3.SSS2.p4.16.m9.1a"><msub id="S3.SS3.SSS2.p4.16.m9.1.1" xref="S3.SS3.SSS2.p4.16.m9.1.1.cmml"><mi id="S3.SS3.SSS2.p4.16.m9.1.1.2" xref="S3.SS3.SSS2.p4.16.m9.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p4.16.m9.1.1.3" xref="S3.SS3.SSS2.p4.16.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.16.m9.1b"><apply id="S3.SS3.SSS2.p4.16.m9.1.1.cmml" xref="S3.SS3.SSS2.p4.16.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.16.m9.1.1.1.cmml" xref="S3.SS3.SSS2.p4.16.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.16.m9.1.1.2.cmml" xref="S3.SS3.SSS2.p4.16.m9.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p4.16.m9.1.1.3.cmml" xref="S3.SS3.SSS2.p4.16.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.16.m9.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.16.m9.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p4.23.1">e</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p4.23.2">g</span>., user historical behavior sequence), and
<math alttext="\mathbf{y}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.17.m10.1"><semantics id="S3.SS3.SSS2.p4.17.m10.1a"><msub id="S3.SS3.SSS2.p4.17.m10.1.1" xref="S3.SS3.SSS2.p4.17.m10.1.1.cmml"><mi id="S3.SS3.SSS2.p4.17.m10.1.1.2" xref="S3.SS3.SSS2.p4.17.m10.1.1.2.cmml">𝐲</mi><mi id="S3.SS3.SSS2.p4.17.m10.1.1.3" xref="S3.SS3.SSS2.p4.17.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.17.m10.1b"><apply id="S3.SS3.SSS2.p4.17.m10.1.1.cmml" xref="S3.SS3.SSS2.p4.17.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.17.m10.1.1.1.cmml" xref="S3.SS3.SSS2.p4.17.m10.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.17.m10.1.1.2.cmml" xref="S3.SS3.SSS2.p4.17.m10.1.1.2">𝐲</ci><ci id="S3.SS3.SSS2.p4.17.m10.1.1.3.cmml" xref="S3.SS3.SSS2.p4.17.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.17.m10.1c">\mathbf{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.17.m10.1d">bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> can be the embedding of item <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.18.m11.1"><semantics id="S3.SS3.SSS2.p4.18.m11.1a"><msub id="S3.SS3.SSS2.p4.18.m11.1.1" xref="S3.SS3.SSS2.p4.18.m11.1.1.cmml"><mi id="S3.SS3.SSS2.p4.18.m11.1.1.2" xref="S3.SS3.SSS2.p4.18.m11.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS2.p4.18.m11.1.1.3" xref="S3.SS3.SSS2.p4.18.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.18.m11.1b"><apply id="S3.SS3.SSS2.p4.18.m11.1.1.cmml" xref="S3.SS3.SSS2.p4.18.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.18.m11.1.1.1.cmml" xref="S3.SS3.SSS2.p4.18.m11.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.18.m11.1.1.2.cmml" xref="S3.SS3.SSS2.p4.18.m11.1.1.2">𝑦</ci><ci id="S3.SS3.SSS2.p4.18.m11.1.1.3.cmml" xref="S3.SS3.SSS2.p4.18.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.18.m11.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.18.m11.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> obtained from a trainable embedding look-up table.
Since <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.19.m12.1"><semantics id="S3.SS3.SSS2.p4.19.m12.1a"><mi id="S3.SS3.SSS2.p4.19.m12.1.1" xref="S3.SS3.SSS2.p4.19.m12.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.19.m12.1b"><ci id="S3.SS3.SSS2.p4.19.m12.1.1.cmml" xref="S3.SS3.SSS2.p4.19.m12.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.19.m12.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.19.m12.1d">italic_M</annotation></semantics></math> intercepts all the direct effects from <math alttext="X\rightarrow Y" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.20.m13.1"><semantics id="S3.SS3.SSS2.p4.20.m13.1a"><mrow id="S3.SS3.SSS2.p4.20.m13.1.1" xref="S3.SS3.SSS2.p4.20.m13.1.1.cmml"><mi id="S3.SS3.SSS2.p4.20.m13.1.1.2" xref="S3.SS3.SSS2.p4.20.m13.1.1.2.cmml">X</mi><mo id="S3.SS3.SSS2.p4.20.m13.1.1.1" stretchy="false" xref="S3.SS3.SSS2.p4.20.m13.1.1.1.cmml">→</mo><mi id="S3.SS3.SSS2.p4.20.m13.1.1.3" xref="S3.SS3.SSS2.p4.20.m13.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.20.m13.1b"><apply id="S3.SS3.SSS2.p4.20.m13.1.1.cmml" xref="S3.SS3.SSS2.p4.20.m13.1.1"><ci id="S3.SS3.SSS2.p4.20.m13.1.1.1.cmml" xref="S3.SS3.SSS2.p4.20.m13.1.1.1">→</ci><ci id="S3.SS3.SSS2.p4.20.m13.1.1.2.cmml" xref="S3.SS3.SSS2.p4.20.m13.1.1.2">𝑋</ci><ci id="S3.SS3.SSS2.p4.20.m13.1.1.3.cmml" xref="S3.SS3.SSS2.p4.20.m13.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.20.m13.1c">X\rightarrow Y</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.20.m13.1d">italic_X → italic_Y</annotation></semantics></math>, we can use the mediator <math alttext="m_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.21.m14.1"><semantics id="S3.SS3.SSS2.p4.21.m14.1a"><msub id="S3.SS3.SSS2.p4.21.m14.1.1" xref="S3.SS3.SSS2.p4.21.m14.1.1.cmml"><mi id="S3.SS3.SSS2.p4.21.m14.1.1.2" xref="S3.SS3.SSS2.p4.21.m14.1.1.2.cmml">m</mi><mi id="S3.SS3.SSS2.p4.21.m14.1.1.3" xref="S3.SS3.SSS2.p4.21.m14.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.21.m14.1b"><apply id="S3.SS3.SSS2.p4.21.m14.1.1.cmml" xref="S3.SS3.SSS2.p4.21.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.21.m14.1.1.1.cmml" xref="S3.SS3.SSS2.p4.21.m14.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.21.m14.1.1.2.cmml" xref="S3.SS3.SSS2.p4.21.m14.1.1.2">𝑚</ci><ci id="S3.SS3.SSS2.p4.21.m14.1.1.3.cmml" xref="S3.SS3.SSS2.p4.21.m14.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.21.m14.1c">m_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.21.m14.1d">italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to replace <math alttext="x_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.22.m15.1"><semantics id="S3.SS3.SSS2.p4.22.m15.1a"><msub id="S3.SS3.SSS2.p4.22.m15.1.1" xref="S3.SS3.SSS2.p4.22.m15.1.1.cmml"><mi id="S3.SS3.SSS2.p4.22.m15.1.1.2" xref="S3.SS3.SSS2.p4.22.m15.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p4.22.m15.1.1.3" xref="S3.SS3.SSS2.p4.22.m15.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.22.m15.1b"><apply id="S3.SS3.SSS2.p4.22.m15.1.1.cmml" xref="S3.SS3.SSS2.p4.22.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.22.m15.1.1.1.cmml" xref="S3.SS3.SSS2.p4.22.m15.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.22.m15.1.1.2.cmml" xref="S3.SS3.SSS2.p4.22.m15.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p4.22.m15.1.1.3.cmml" xref="S3.SS3.SSS2.p4.22.m15.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.22.m15.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.22.m15.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and use the vectorial representation <math alttext="\mathbf{\tilde{m}}_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.23.m16.1"><semantics id="S3.SS3.SSS2.p4.23.m16.1a"><msub id="S3.SS3.SSS2.p4.23.m16.1.1" xref="S3.SS3.SSS2.p4.23.m16.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p4.23.m16.1.1.2" xref="S3.SS3.SSS2.p4.23.m16.1.1.2.cmml"><mi id="S3.SS3.SSS2.p4.23.m16.1.1.2.2" xref="S3.SS3.SSS2.p4.23.m16.1.1.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p4.23.m16.1.1.2.1" xref="S3.SS3.SSS2.p4.23.m16.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS2.p4.23.m16.1.1.3" xref="S3.SS3.SSS2.p4.23.m16.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.23.m16.1b"><apply id="S3.SS3.SSS2.p4.23.m16.1.1.cmml" xref="S3.SS3.SSS2.p4.23.m16.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.23.m16.1.1.1.cmml" xref="S3.SS3.SSS2.p4.23.m16.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p4.23.m16.1.1.2.cmml" xref="S3.SS3.SSS2.p4.23.m16.1.1.2"><ci id="S3.SS3.SSS2.p4.23.m16.1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.23.m16.1.1.2.1">~</ci><ci id="S3.SS3.SSS2.p4.23.m16.1.1.2.2.cmml" xref="S3.SS3.SSS2.p4.23.m16.1.1.2.2">𝐦</ci></apply><ci id="S3.SS3.SSS2.p4.23.m16.1.1.3.cmml" xref="S3.SS3.SSS2.p4.23.m16.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.23.m16.1c">\mathbf{\tilde{m}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.23.m16.1d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in the modeling:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx9">
<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle P(Y=y_{i}\mid X=x_{j},M=m_{k,i})=\sigma(\varphi(\mathbf{\tilde{m%
}}_{j},\mathbf{\tilde{m}}_{k,i},\mathbf{y}_{i}))," class="ltx_math_unparsed" display="inline" id="S3.E12.m1.4"><semantics id="S3.E12.m1.4a"><mrow id="S3.E12.m1.4b"><mi id="S3.E12.m1.4.5" mathcolor="#000000">P</mi><mrow id="S3.E12.m1.4.6"><mo id="S3.E12.m1.4.6.1" stretchy="false">(</mo><mi id="S3.E12.m1.4.6.2" mathcolor="#000000">Y</mi><mo id="S3.E12.m1.4.6.3">=</mo><msub id="S3.E12.m1.4.6.4"><mi id="S3.E12.m1.4.6.4.2" mathcolor="#000000">y</mi><mi id="S3.E12.m1.4.6.4.3">i</mi></msub><mo id="S3.E12.m1.4.6.5" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.E12.m1.4.6.6" mathcolor="#000000">X</mi><mo id="S3.E12.m1.4.6.7">=</mo><msub id="S3.E12.m1.4.6.8"><mi id="S3.E12.m1.4.6.8.2" mathcolor="#000000">x</mi><mi id="S3.E12.m1.4.6.8.3">j</mi></msub><mo id="S3.E12.m1.4.6.9">,</mo><mi id="S3.E12.m1.4.6.10" mathcolor="#000000">M</mi><mo id="S3.E12.m1.4.6.11">=</mo><msub id="S3.E12.m1.4.6.12"><mi id="S3.E12.m1.4.6.12.2" mathcolor="#000000">m</mi><mrow id="S3.E12.m1.2.2.2.4"><mi id="S3.E12.m1.1.1.1.1">k</mi><mo id="S3.E12.m1.2.2.2.4.1">,</mo><mi id="S3.E12.m1.2.2.2.2">i</mi></mrow></msub><mo id="S3.E12.m1.4.6.13" stretchy="false">)</mo></mrow><mo id="S3.E12.m1.4.7">=</mo><mi id="S3.E12.m1.4.8">σ</mi><mrow id="S3.E12.m1.4.9"><mo id="S3.E12.m1.4.9.1" stretchy="false">(</mo><mi id="S3.E12.m1.4.9.2">φ</mi><mrow id="S3.E12.m1.4.9.3"><mo id="S3.E12.m1.4.9.3.1" stretchy="false">(</mo><msub id="S3.E12.m1.4.9.3.2"><mover accent="true" id="S3.E12.m1.4.9.3.2.2"><mi id="S3.E12.m1.4.9.3.2.2.2">𝐦</mi><mo id="S3.E12.m1.4.9.3.2.2.1">~</mo></mover><mi id="S3.E12.m1.4.9.3.2.3">j</mi></msub><mo id="S3.E12.m1.4.9.3.3">,</mo><msub id="S3.E12.m1.4.9.3.4"><mover accent="true" id="S3.E12.m1.4.9.3.4.2"><mi id="S3.E12.m1.4.9.3.4.2.2">𝐦</mi><mo id="S3.E12.m1.4.9.3.4.2.1">~</mo></mover><mrow id="S3.E12.m1.4.4.2.4"><mi id="S3.E12.m1.3.3.1.1">k</mi><mo id="S3.E12.m1.4.4.2.4.1">,</mo><mi id="S3.E12.m1.4.4.2.2">i</mi></mrow></msub><mo id="S3.E12.m1.4.9.3.5">,</mo><msub id="S3.E12.m1.4.9.3.6"><mi id="S3.E12.m1.4.9.3.6.2">𝐲</mi><mi id="S3.E12.m1.4.9.3.6.3">i</mi></msub><mo id="S3.E12.m1.4.9.3.7" stretchy="false">)</mo></mrow><mo id="S3.E12.m1.4.9.4" stretchy="false">)</mo></mrow><mo id="S3.E12.m1.4.10">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E12.m1.4c">\displaystyle P(Y=y_{i}\mid X=x_{j},M=m_{k,i})=\sigma(\varphi(\mathbf{\tilde{m%
}}_{j},\mathbf{\tilde{m}}_{k,i},\mathbf{y}_{i})),</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.4d">italic_P ( italic_Y = italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∣ italic_X = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_M = italic_m start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ) = italic_σ ( italic_φ ( over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p4.28">where <math alttext="\mathbf{\tilde{m}}_{j}=1/K\sum_{k}\mathbf{\tilde{m}}_{k,j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.24.m1.2"><semantics id="S3.SS3.SSS2.p4.24.m1.2a"><mrow id="S3.SS3.SSS2.p4.24.m1.2.3" xref="S3.SS3.SSS2.p4.24.m1.2.3.cmml"><msub id="S3.SS3.SSS2.p4.24.m1.2.3.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.cmml"><mover accent="true" id="S3.SS3.SSS2.p4.24.m1.2.3.2.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.2.cmml"><mi id="S3.SS3.SSS2.p4.24.m1.2.3.2.2.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p4.24.m1.2.3.2.2.1" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS2.p4.24.m1.2.3.2.3" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.3.cmml">j</mi></msub><mo id="S3.SS3.SSS2.p4.24.m1.2.3.1" xref="S3.SS3.SSS2.p4.24.m1.2.3.1.cmml">=</mo><mrow id="S3.SS3.SSS2.p4.24.m1.2.3.3" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.cmml"><mrow id="S3.SS3.SSS2.p4.24.m1.2.3.3.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.2.cmml"><mn id="S3.SS3.SSS2.p4.24.m1.2.3.3.2.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.2.2.cmml">1</mn><mo id="S3.SS3.SSS2.p4.24.m1.2.3.3.2.1" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.2.1.cmml">/</mo><mi id="S3.SS3.SSS2.p4.24.m1.2.3.3.2.3" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.2.3.cmml">K</mi></mrow><mo id="S3.SS3.SSS2.p4.24.m1.2.3.3.1" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p4.24.m1.2.3.3.3" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.cmml"><msub id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.cmml"><mo id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.2.cmml">∑</mo><mi id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.3" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.3.cmml">k</mi></msub><msub id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.cmml"><mover accent="true" id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.cmml"><mi id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.2" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.1" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.1.cmml">~</mo></mover><mrow id="S3.SS3.SSS2.p4.24.m1.2.2.2.4" xref="S3.SS3.SSS2.p4.24.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p4.24.m1.1.1.1.1" xref="S3.SS3.SSS2.p4.24.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p4.24.m1.2.2.2.4.1" xref="S3.SS3.SSS2.p4.24.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p4.24.m1.2.2.2.2" xref="S3.SS3.SSS2.p4.24.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.24.m1.2b"><apply id="S3.SS3.SSS2.p4.24.m1.2.3.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3"><eq id="S3.SS3.SSS2.p4.24.m1.2.3.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.1"></eq><apply id="S3.SS3.SSS2.p4.24.m1.2.3.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.24.m1.2.3.2.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.2">subscript</csymbol><apply id="S3.SS3.SSS2.p4.24.m1.2.3.2.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.2"><ci id="S3.SS3.SSS2.p4.24.m1.2.3.2.2.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.2.1">~</ci><ci id="S3.SS3.SSS2.p4.24.m1.2.3.2.2.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.2.2">𝐦</ci></apply><ci id="S3.SS3.SSS2.p4.24.m1.2.3.2.3.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.2.3">𝑗</ci></apply><apply id="S3.SS3.SSS2.p4.24.m1.2.3.3.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3"><times id="S3.SS3.SSS2.p4.24.m1.2.3.3.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.1"></times><apply id="S3.SS3.SSS2.p4.24.m1.2.3.3.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.2"><divide id="S3.SS3.SSS2.p4.24.m1.2.3.3.2.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.2.1"></divide><cn id="S3.SS3.SSS2.p4.24.m1.2.3.3.2.2.cmml" type="integer" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.2.2">1</cn><ci id="S3.SS3.SSS2.p4.24.m1.2.3.3.2.3.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.2.3">𝐾</ci></apply><apply id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3"><apply id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1">subscript</csymbol><sum id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.2"></sum><ci id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.3.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.1.3">𝑘</ci></apply><apply id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2">subscript</csymbol><apply id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2"><ci id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.1">~</ci><ci id="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.3.3.3.2.2.2">𝐦</ci></apply><list id="S3.SS3.SSS2.p4.24.m1.2.2.2.3.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.2.2.4"><ci id="S3.SS3.SSS2.p4.24.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.24.m1.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p4.24.m1.2.2.2.2.cmml" xref="S3.SS3.SSS2.p4.24.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.24.m1.2c">\mathbf{\tilde{m}}_{j}=1/K\sum_{k}\mathbf{\tilde{m}}_{k,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.24.m1.2d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 1 / italic_K ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the mediator feature of data <math alttext="x_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.25.m2.1"><semantics id="S3.SS3.SSS2.p4.25.m2.1a"><msub id="S3.SS3.SSS2.p4.25.m2.1.1" xref="S3.SS3.SSS2.p4.25.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p4.25.m2.1.1.2" xref="S3.SS3.SSS2.p4.25.m2.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p4.25.m2.1.1.3" xref="S3.SS3.SSS2.p4.25.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.25.m2.1b"><apply id="S3.SS3.SSS2.p4.25.m2.1.1.cmml" xref="S3.SS3.SSS2.p4.25.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.25.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p4.25.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.25.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p4.25.m2.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p4.25.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p4.25.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.25.m2.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.25.m2.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> by taking the average of the mediator features of all teachers.
Function <math alttext="\varphi" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.26.m3.1"><semantics id="S3.SS3.SSS2.p4.26.m3.1a"><mi id="S3.SS3.SSS2.p4.26.m3.1.1" xref="S3.SS3.SSS2.p4.26.m3.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.26.m3.1b"><ci id="S3.SS3.SSS2.p4.26.m3.1.1.cmml" xref="S3.SS3.SSS2.p4.26.m3.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.26.m3.1c">\varphi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.26.m3.1d">italic_φ</annotation></semantics></math> can be modeled by any neural network architecture that makes recommendation predictions. Taking DIN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib1" title="">1</a>]</cite> as an example, DIN uses fully-connected layers (FCL) to make click-through-rate predictions with concatenated user-item representations as input. Following this work, we use a FCL network <math alttext="\psi_{FDA}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.27.m4.1"><semantics id="S3.SS3.SSS2.p4.27.m4.1a"><msub id="S3.SS3.SSS2.p4.27.m4.1.1" xref="S3.SS3.SSS2.p4.27.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p4.27.m4.1.1.2" xref="S3.SS3.SSS2.p4.27.m4.1.1.2.cmml">ψ</mi><mrow id="S3.SS3.SSS2.p4.27.m4.1.1.3" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.cmml"><mi id="S3.SS3.SSS2.p4.27.m4.1.1.3.2" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.2.cmml">F</mi><mo id="S3.SS3.SSS2.p4.27.m4.1.1.3.1" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.27.m4.1.1.3.3" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.3.cmml">D</mi><mo id="S3.SS3.SSS2.p4.27.m4.1.1.3.1a" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p4.27.m4.1.1.3.4" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.27.m4.1b"><apply id="S3.SS3.SSS2.p4.27.m4.1.1.cmml" xref="S3.SS3.SSS2.p4.27.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.27.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p4.27.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.27.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p4.27.m4.1.1.2">𝜓</ci><apply id="S3.SS3.SSS2.p4.27.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p4.27.m4.1.1.3"><times id="S3.SS3.SSS2.p4.27.m4.1.1.3.1.cmml" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.1"></times><ci id="S3.SS3.SSS2.p4.27.m4.1.1.3.2.cmml" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.2">𝐹</ci><ci id="S3.SS3.SSS2.p4.27.m4.1.1.3.3.cmml" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.3">𝐷</ci><ci id="S3.SS3.SSS2.p4.27.m4.1.1.3.4.cmml" xref="S3.SS3.SSS2.p4.27.m4.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.27.m4.1c">\psi_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.27.m4.1d">italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> to model <math alttext="\varphi" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.28.m5.1"><semantics id="S3.SS3.SSS2.p4.28.m5.1a"><mi id="S3.SS3.SSS2.p4.28.m5.1.1" xref="S3.SS3.SSS2.p4.28.m5.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.28.m5.1b"><ci id="S3.SS3.SSS2.p4.28.m5.1.1.cmml" xref="S3.SS3.SSS2.p4.28.m5.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.28.m5.1c">\varphi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.28.m5.1d">italic_φ</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx10">
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\varphi(\mathbf{\tilde{m}}_{j},\mathbf{\tilde{m}},\mathbf{y})=%
\psi_{FDA}\left(\left[\mathbf{\tilde{m}}_{j},\mathbf{\tilde{m}}_{k,i},\mathbf{%
y}_{i}\right]\right)," class="ltx_Math" display="inline" id="S3.E13.m1.5"><semantics id="S3.E13.m1.5a"><mrow id="S3.E13.m1.5.5.1" xref="S3.E13.m1.5.5.1.1.cmml"><mrow id="S3.E13.m1.5.5.1.1" xref="S3.E13.m1.5.5.1.1.cmml"><mrow id="S3.E13.m1.5.5.1.1.1" xref="S3.E13.m1.5.5.1.1.1.cmml"><mi id="S3.E13.m1.5.5.1.1.1.3" xref="S3.E13.m1.5.5.1.1.1.3.cmml">φ</mi><mo id="S3.E13.m1.5.5.1.1.1.2" xref="S3.E13.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E13.m1.5.5.1.1.1.1.1" xref="S3.E13.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E13.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.5.5.1.1.1.1.2.cmml">(</mo><msub id="S3.E13.m1.5.5.1.1.1.1.1.1" xref="S3.E13.m1.5.5.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E13.m1.5.5.1.1.1.1.1.1.2" xref="S3.E13.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E13.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝐦</mi><mo id="S3.E13.m1.5.5.1.1.1.1.1.1.2.1" xref="S3.E13.m1.5.5.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E13.m1.5.5.1.1.1.1.1.1.3" xref="S3.E13.m1.5.5.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E13.m1.5.5.1.1.1.1.1.3" xref="S3.E13.m1.5.5.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.E13.m1.3.3" xref="S3.E13.m1.3.3.cmml"><mi id="S3.E13.m1.3.3.2" xref="S3.E13.m1.3.3.2.cmml">𝐦</mi><mo id="S3.E13.m1.3.3.1" xref="S3.E13.m1.3.3.1.cmml">~</mo></mover><mo id="S3.E13.m1.5.5.1.1.1.1.1.4" xref="S3.E13.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E13.m1.4.4" xref="S3.E13.m1.4.4.cmml">𝐲</mi><mo id="S3.E13.m1.5.5.1.1.1.1.1.5" stretchy="false" xref="S3.E13.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.5.5.1.1.3" xref="S3.E13.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E13.m1.5.5.1.1.2" xref="S3.E13.m1.5.5.1.1.2.cmml"><msub id="S3.E13.m1.5.5.1.1.2.3" xref="S3.E13.m1.5.5.1.1.2.3.cmml"><mi id="S3.E13.m1.5.5.1.1.2.3.2" xref="S3.E13.m1.5.5.1.1.2.3.2.cmml">ψ</mi><mrow id="S3.E13.m1.5.5.1.1.2.3.3" xref="S3.E13.m1.5.5.1.1.2.3.3.cmml"><mi id="S3.E13.m1.5.5.1.1.2.3.3.2" xref="S3.E13.m1.5.5.1.1.2.3.3.2.cmml">F</mi><mo id="S3.E13.m1.5.5.1.1.2.3.3.1" xref="S3.E13.m1.5.5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E13.m1.5.5.1.1.2.3.3.3" xref="S3.E13.m1.5.5.1.1.2.3.3.3.cmml">D</mi><mo id="S3.E13.m1.5.5.1.1.2.3.3.1a" xref="S3.E13.m1.5.5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E13.m1.5.5.1.1.2.3.3.4" xref="S3.E13.m1.5.5.1.1.2.3.3.4.cmml">A</mi></mrow></msub><mo id="S3.E13.m1.5.5.1.1.2.2" xref="S3.E13.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S3.E13.m1.5.5.1.1.2.1.1" xref="S3.E13.m1.5.5.1.1.2.cmml"><mo id="S3.E13.m1.5.5.1.1.2.1.1.2" xref="S3.E13.m1.5.5.1.1.2.cmml">(</mo><mrow id="S3.E13.m1.5.5.1.1.2.1.1.1.3" xref="S3.E13.m1.5.5.1.1.2.1.1.1.4.cmml"><mo id="S3.E13.m1.5.5.1.1.2.1.1.1.3.4" xref="S3.E13.m1.5.5.1.1.2.1.1.1.4.cmml">[</mo><msub id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.cmml"><mover accent="true" id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.2" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.2.cmml">𝐦</mi><mo id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.1" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.3" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E13.m1.5.5.1.1.2.1.1.1.3.5" xref="S3.E13.m1.5.5.1.1.2.1.1.1.4.cmml">,</mo><msub id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.cmml"><mover accent="true" id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.cmml"><mi id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.2" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.2.cmml">𝐦</mi><mo id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.1" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.1.cmml">~</mo></mover><mrow id="S3.E13.m1.2.2.2.4" xref="S3.E13.m1.2.2.2.3.cmml"><mi id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml">k</mi><mo id="S3.E13.m1.2.2.2.4.1" xref="S3.E13.m1.2.2.2.3.cmml">,</mo><mi id="S3.E13.m1.2.2.2.2" xref="S3.E13.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E13.m1.5.5.1.1.2.1.1.1.3.6" xref="S3.E13.m1.5.5.1.1.2.1.1.1.4.cmml">,</mo><msub id="S3.E13.m1.5.5.1.1.2.1.1.1.3.3" xref="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.cmml"><mi id="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.2" xref="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.2.cmml">𝐲</mi><mi id="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.3" xref="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S3.E13.m1.5.5.1.1.2.1.1.1.3.7" xref="S3.E13.m1.5.5.1.1.2.1.1.1.4.cmml">]</mo></mrow><mo id="S3.E13.m1.5.5.1.1.2.1.1.3" xref="S3.E13.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E13.m1.5.5.1.2" xref="S3.E13.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.5b"><apply id="S3.E13.m1.5.5.1.1.cmml" xref="S3.E13.m1.5.5.1"><eq id="S3.E13.m1.5.5.1.1.3.cmml" xref="S3.E13.m1.5.5.1.1.3"></eq><apply id="S3.E13.m1.5.5.1.1.1.cmml" xref="S3.E13.m1.5.5.1.1.1"><times id="S3.E13.m1.5.5.1.1.1.2.cmml" xref="S3.E13.m1.5.5.1.1.1.2"></times><ci id="S3.E13.m1.5.5.1.1.1.3.cmml" xref="S3.E13.m1.5.5.1.1.1.3">𝜑</ci><vector id="S3.E13.m1.5.5.1.1.1.1.2.cmml" xref="S3.E13.m1.5.5.1.1.1.1.1"><apply id="S3.E13.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E13.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.5.5.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E13.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.5.5.1.1.1.1.1.1.2"><ci id="S3.E13.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.5.5.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E13.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.5.5.1.1.1.1.1.1.2.2">𝐦</ci></apply><ci id="S3.E13.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.5.5.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E13.m1.3.3.cmml" xref="S3.E13.m1.3.3"><ci id="S3.E13.m1.3.3.1.cmml" xref="S3.E13.m1.3.3.1">~</ci><ci id="S3.E13.m1.3.3.2.cmml" xref="S3.E13.m1.3.3.2">𝐦</ci></apply><ci id="S3.E13.m1.4.4.cmml" xref="S3.E13.m1.4.4">𝐲</ci></vector></apply><apply id="S3.E13.m1.5.5.1.1.2.cmml" xref="S3.E13.m1.5.5.1.1.2"><times id="S3.E13.m1.5.5.1.1.2.2.cmml" xref="S3.E13.m1.5.5.1.1.2.2"></times><apply id="S3.E13.m1.5.5.1.1.2.3.cmml" xref="S3.E13.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S3.E13.m1.5.5.1.1.2.3.1.cmml" xref="S3.E13.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S3.E13.m1.5.5.1.1.2.3.2.cmml" xref="S3.E13.m1.5.5.1.1.2.3.2">𝜓</ci><apply id="S3.E13.m1.5.5.1.1.2.3.3.cmml" xref="S3.E13.m1.5.5.1.1.2.3.3"><times id="S3.E13.m1.5.5.1.1.2.3.3.1.cmml" xref="S3.E13.m1.5.5.1.1.2.3.3.1"></times><ci id="S3.E13.m1.5.5.1.1.2.3.3.2.cmml" xref="S3.E13.m1.5.5.1.1.2.3.3.2">𝐹</ci><ci id="S3.E13.m1.5.5.1.1.2.3.3.3.cmml" xref="S3.E13.m1.5.5.1.1.2.3.3.3">𝐷</ci><ci id="S3.E13.m1.5.5.1.1.2.3.3.4.cmml" xref="S3.E13.m1.5.5.1.1.2.3.3.4">𝐴</ci></apply></apply><list id="S3.E13.m1.5.5.1.1.2.1.1.1.4.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.3"><apply id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1">subscript</csymbol><apply id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2"><ci id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.1">~</ci><ci id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.2.2">𝐦</ci></apply><ci id="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.1.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2">subscript</csymbol><apply id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2"><ci id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.1">~</ci><ci id="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.2.2.2.2">𝐦</ci></apply><list id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.4"><ci id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1">𝑘</ci><ci id="S3.E13.m1.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.1.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.2.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.2">𝐲</ci><ci id="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.3.cmml" xref="S3.E13.m1.5.5.1.1.2.1.1.1.3.3.3">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.5c">\displaystyle\varphi(\mathbf{\tilde{m}}_{j},\mathbf{\tilde{m}},\mathbf{y})=%
\psi_{FDA}\left(\left[\mathbf{\tilde{m}}_{j},\mathbf{\tilde{m}}_{k,i},\mathbf{%
y}_{i}\right]\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.5d">italic_φ ( over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , over~ start_ARG bold_m end_ARG , bold_y ) = italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT ( [ over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p4.29">where <math alttext="[\cdot]" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.29.m1.1"><semantics id="S3.SS3.SSS2.p4.29.m1.1a"><mrow id="S3.SS3.SSS2.p4.29.m1.1.2.2" xref="S3.SS3.SSS2.p4.29.m1.1.2.1.cmml"><mo id="S3.SS3.SSS2.p4.29.m1.1.2.2.1" stretchy="false" xref="S3.SS3.SSS2.p4.29.m1.1.2.1.1.cmml">[</mo><mo id="S3.SS3.SSS2.p4.29.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p4.29.m1.1.1.cmml">⋅</mo><mo id="S3.SS3.SSS2.p4.29.m1.1.2.2.2" stretchy="false" xref="S3.SS3.SSS2.p4.29.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.29.m1.1b"><apply id="S3.SS3.SSS2.p4.29.m1.1.2.1.cmml" xref="S3.SS3.SSS2.p4.29.m1.1.2.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p4.29.m1.1.2.1.1.cmml" xref="S3.SS3.SSS2.p4.29.m1.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS3.SSS2.p4.29.m1.1.1.cmml" xref="S3.SS3.SSS2.p4.29.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.29.m1.1c">[\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.29.m1.1d">[ ⋅ ]</annotation></semantics></math> denotes vector concatenation operation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p5">
<p class="ltx_p" id="S3.SS3.SSS2.p5.6"><span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p5.1.1">Estimating <math alttext="P(Y|do(X))" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.1.1.m1.2"><semantics id="S3.SS3.SSS2.p5.1.1.m1.2a"><mrow id="S3.SS3.SSS2.p5.1.1.m1.2.2" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.cmml"><mi id="S3.SS3.SSS2.p5.1.1.m1.2.2.3" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.3.cmml">P</mi><mo id="S3.SS3.SSS2.p5.1.1.m1.2.2.2" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.cmml"><mo id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.2" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.2.cmml">Y</mi><mo fence="false" id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.1" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.2" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.2.cmml">d</mi><mo id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.1" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.3" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.3.cmml">o</mi><mo id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.1a" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.4.2" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.cmml"><mo id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.4.2.1" stretchy="false" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.cmml">(</mo><mi id="S3.SS3.SSS2.p5.1.1.m1.1.1" xref="S3.SS3.SSS2.p5.1.1.m1.1.1.cmml">X</mi><mo id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.4.2.2" stretchy="false" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.1.1.m1.2b"><apply id="S3.SS3.SSS2.p5.1.1.m1.2.2.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2"><times id="S3.SS3.SSS2.p5.1.1.m1.2.2.2.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.2"></times><ci id="S3.SS3.SSS2.p5.1.1.m1.2.2.3.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.3">𝑃</ci><apply id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.2">𝑌</ci><apply id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3"><times id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.2.2.1.1.1.3.3">𝑜</ci><ci id="S3.SS3.SSS2.p5.1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p5.1.1.m1.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.1.1.m1.2c">P(Y|do(X))</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.1.1.m1.2d">italic_P ( italic_Y | italic_d italic_o ( italic_X ) )</annotation></semantics></math>. </span> <span class="ltx_text" id="S3.SS3.SSS2.p5.6.6">With the sampling of <math alttext="M=m" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.2.2.m1.1"><semantics id="S3.SS3.SSS2.p5.2.2.m1.1a"><mrow id="S3.SS3.SSS2.p5.2.2.m1.1.1" xref="S3.SS3.SSS2.p5.2.2.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p5.2.2.m1.1.1.2" xref="S3.SS3.SSS2.p5.2.2.m1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS2.p5.2.2.m1.1.1.1" xref="S3.SS3.SSS2.p5.2.2.m1.1.1.1.cmml">=</mo><mi id="S3.SS3.SSS2.p5.2.2.m1.1.1.3" xref="S3.SS3.SSS2.p5.2.2.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.2.2.m1.1b"><apply id="S3.SS3.SSS2.p5.2.2.m1.1.1.cmml" xref="S3.SS3.SSS2.p5.2.2.m1.1.1"><eq id="S3.SS3.SSS2.p5.2.2.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.2.2.m1.1.1.1"></eq><ci id="S3.SS3.SSS2.p5.2.2.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p5.2.2.m1.1.1.2">𝑀</ci><ci id="S3.SS3.SSS2.p5.2.2.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p5.2.2.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.2.2.m1.1c">M=m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.2.2.m1.1d">italic_M = italic_m</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p5.6.6.3">cf</span>. Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E9" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">9</span></a>) - (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E10" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">10</span></a>)), the sampling of <math alttext="X=x" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.3.3.m2.1"><semantics id="S3.SS3.SSS2.p5.3.3.m2.1a"><mrow id="S3.SS3.SSS2.p5.3.3.m2.1.1" xref="S3.SS3.SSS2.p5.3.3.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p5.3.3.m2.1.1.2" xref="S3.SS3.SSS2.p5.3.3.m2.1.1.2.cmml">X</mi><mo id="S3.SS3.SSS2.p5.3.3.m2.1.1.1" xref="S3.SS3.SSS2.p5.3.3.m2.1.1.1.cmml">=</mo><mi id="S3.SS3.SSS2.p5.3.3.m2.1.1.3" xref="S3.SS3.SSS2.p5.3.3.m2.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.3.3.m2.1b"><apply id="S3.SS3.SSS2.p5.3.3.m2.1.1.cmml" xref="S3.SS3.SSS2.p5.3.3.m2.1.1"><eq id="S3.SS3.SSS2.p5.3.3.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p5.3.3.m2.1.1.1"></eq><ci id="S3.SS3.SSS2.p5.3.3.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p5.3.3.m2.1.1.2">𝑋</ci><ci id="S3.SS3.SSS2.p5.3.3.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p5.3.3.m2.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.3.3.m2.1c">X=x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.3.3.m2.1d">italic_X = italic_x</annotation></semantics></math>, the modeling of <math alttext="P(Y\mid M=m_{k,i},X=x_{j})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.4.4.m3.3"><semantics id="S3.SS3.SSS2.p5.4.4.m3.3a"><mrow id="S3.SS3.SSS2.p5.4.4.m3.3.3" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.cmml"><mi id="S3.SS3.SSS2.p5.4.4.m3.3.3.3" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.3.cmml">P</mi><mo id="S3.SS3.SSS2.p5.4.4.m3.3.3.2" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.cmml"><mo id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.cmml">(</mo><mrow id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.3.cmml"><mrow id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.cmml"><mrow id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.2" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.2.cmml">Y</mi><mo id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.1" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.1.cmml">∣</mo><mi id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.3" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.3.cmml">M</mi></mrow><mo id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.1" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3.2" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3.2.cmml">m</mi><mrow id="S3.SS3.SSS2.p5.4.4.m3.2.2.2.4" xref="S3.SS3.SSS2.p5.4.4.m3.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p5.4.4.m3.1.1.1.1" xref="S3.SS3.SSS2.p5.4.4.m3.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p5.4.4.m3.2.2.2.4.1" xref="S3.SS3.SSS2.p5.4.4.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p5.4.4.m3.2.2.2.2" xref="S3.SS3.SSS2.p5.4.4.m3.2.2.2.2.cmml">i</mi></mrow></msub></mrow><mo id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.3" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.3a.cmml">,</mo><mrow id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.2" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.2.cmml">X</mi><mo id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.1" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.1.cmml">=</mo><msub id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.cmml"><mi id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.2" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.2.cmml">x</mi><mi id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.3" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.4.4.m3.3b"><apply id="S3.SS3.SSS2.p5.4.4.m3.3.3.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3"><times id="S3.SS3.SSS2.p5.4.4.m3.3.3.2.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.2"></times><ci id="S3.SS3.SSS2.p5.4.4.m3.3.3.3.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.3">𝑃</ci><apply id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.3a.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1"><eq id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.1"></eq><apply id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.1">conditional</csymbol><ci id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.2">𝑌</ci><ci id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.1.1.3.2">𝑚</ci><list id="S3.SS3.SSS2.p5.4.4.m3.2.2.2.3.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.2.2.2.4"><ci id="S3.SS3.SSS2.p5.4.4.m3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p5.4.4.m3.2.2.2.2.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.2.2.2.2">𝑖</ci></list></apply></apply><apply id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2"><eq id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.1"></eq><ci id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.2">𝑋</ci><apply id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.1.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.2.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.2">𝑥</ci><ci id="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.3.cmml" xref="S3.SS3.SSS2.p5.4.4.m3.3.3.1.1.1.2.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.4.4.m3.3c">P(Y\mid M=m_{k,i},X=x_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.4.4.m3.3d">italic_P ( italic_Y ∣ italic_M = italic_m start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT , italic_X = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p5.6.6.4">cf</span>. Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E11" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">11</span></a>) - Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E13" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">13</span></a>))<span class="ltx_text" id="S3.SS3.SSS2.p5.6.6.2">, we can estimate the causal effect of user data <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.5.5.1.m1.1"><semantics id="S3.SS3.SSS2.p5.5.5.1.m1.1a"><msub id="S3.SS3.SSS2.p5.5.5.1.m1.1.1" xref="S3.SS3.SSS2.p5.5.5.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p5.5.5.1.m1.1.1.2" xref="S3.SS3.SSS2.p5.5.5.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p5.5.5.1.m1.1.1.3" xref="S3.SS3.SSS2.p5.5.5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.5.5.1.m1.1b"><apply id="S3.SS3.SSS2.p5.5.5.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.5.5.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.5.5.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p5.5.5.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p5.5.5.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p5.5.5.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p5.5.5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.5.5.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.5.5.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> on the next item <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.6.6.2.m2.1"><semantics id="S3.SS3.SSS2.p5.6.6.2.m2.1a"><msub id="S3.SS3.SSS2.p5.6.6.2.m2.1.1" xref="S3.SS3.SSS2.p5.6.6.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p5.6.6.2.m2.1.1.2" xref="S3.SS3.SSS2.p5.6.6.2.m2.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS2.p5.6.6.2.m2.1.1.3" xref="S3.SS3.SSS2.p5.6.6.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.6.6.2.m2.1b"><apply id="S3.SS3.SSS2.p5.6.6.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p5.6.6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.6.6.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p5.6.6.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p5.6.6.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p5.6.6.2.m2.1.1.2">𝑦</ci><ci id="S3.SS3.SSS2.p5.6.6.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p5.6.6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.6.6.2.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.6.6.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="S3.SS3.SSS2.p5.6.6.2.1">by implementing FDA (<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p5.6.6.2.1.1">cf</span>. Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E5" title="In 2.2 Front-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5</span></a>))<span class="ltx_text" id="S3.SS3.SSS2.p5.6.6.2.1.2"> as follows:</span></span></span></span></p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx1.EGx11">
<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle{\tilde{o}}_{i}=\sum_{k}\alpha_{k,i}\sum_{j}\frac{1}{N_{b}}\sigma%
(\psi_{FDA}\left(\left[\mathbf{\tilde{m}}_{j},\mathbf{\tilde{m}}_{k,i},\mathbf%
{y}_{i}\right]\right))," class="ltx_Math" display="block" id="S3.E14.m1.5"><semantics id="S3.E14.m1.5a"><mrow id="S3.E14.m1.5.5.1" xref="S3.E14.m1.5.5.1.1.cmml"><mrow id="S3.E14.m1.5.5.1.1" xref="S3.E14.m1.5.5.1.1.cmml"><msub id="S3.E14.m1.5.5.1.1.3" xref="S3.E14.m1.5.5.1.1.3.cmml"><mover accent="true" id="S3.E14.m1.5.5.1.1.3.2" xref="S3.E14.m1.5.5.1.1.3.2.cmml"><mi id="S3.E14.m1.5.5.1.1.3.2.2" mathcolor="#000000" xref="S3.E14.m1.5.5.1.1.3.2.2.cmml">o</mi><mo id="S3.E14.m1.5.5.1.1.3.2.1" xref="S3.E14.m1.5.5.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.E14.m1.5.5.1.1.3.3" xref="S3.E14.m1.5.5.1.1.3.3.cmml">i</mi></msub><mo id="S3.E14.m1.5.5.1.1.2" rspace="0.111em" xref="S3.E14.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.5.5.1.1.1" xref="S3.E14.m1.5.5.1.1.1.cmml"><munder id="S3.E14.m1.5.5.1.1.1.2" xref="S3.E14.m1.5.5.1.1.1.2.cmml"><mo id="S3.E14.m1.5.5.1.1.1.2.2" movablelimits="false" xref="S3.E14.m1.5.5.1.1.1.2.2.cmml">∑</mo><mi id="S3.E14.m1.5.5.1.1.1.2.3" xref="S3.E14.m1.5.5.1.1.1.2.3.cmml">k</mi></munder><mrow id="S3.E14.m1.5.5.1.1.1.1" xref="S3.E14.m1.5.5.1.1.1.1.cmml"><msub id="S3.E14.m1.5.5.1.1.1.1.3" xref="S3.E14.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.E14.m1.5.5.1.1.1.1.3.2" xref="S3.E14.m1.5.5.1.1.1.1.3.2.cmml">α</mi><mrow id="S3.E14.m1.2.2.2.4" xref="S3.E14.m1.2.2.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml">k</mi><mo id="S3.E14.m1.2.2.2.4.1" xref="S3.E14.m1.2.2.2.3.cmml">,</mo><mi id="S3.E14.m1.2.2.2.2" xref="S3.E14.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E14.m1.5.5.1.1.1.1.2" xref="S3.E14.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.5.5.1.1.1.1.1" xref="S3.E14.m1.5.5.1.1.1.1.1.cmml"><munder id="S3.E14.m1.5.5.1.1.1.1.1.2" xref="S3.E14.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E14.m1.5.5.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E14.m1.5.5.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E14.m1.5.5.1.1.1.1.1.2.3" xref="S3.E14.m1.5.5.1.1.1.1.1.2.3.cmml">j</mi></munder><mrow id="S3.E14.m1.5.5.1.1.1.1.1.1" xref="S3.E14.m1.5.5.1.1.1.1.1.1.cmml"><mfrac id="S3.E14.m1.5.5.1.1.1.1.1.1.3" mathcolor="#000000" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.cmml"><mn id="S3.E14.m1.5.5.1.1.1.1.1.1.3.2" mathcolor="#000000" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.2.cmml">1</mn><msub id="S3.E14.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.2" mathcolor="#000000" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.2.cmml">N</mi><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.3" mathcolor="#000000" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.3.cmml">b</mi></msub></mfrac><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.4" xref="S3.E14.m1.5.5.1.1.1.1.1.1.4.cmml">σ</mi><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.2a" xref="S3.E14.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">ψ</mi><mrow id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.cmml">F</mi><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3.cmml">D</mi><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.4.cmml">A</mi></mrow></msub><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">[</mo><msub id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐦</mi><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.5" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐦</mi><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">~</mo></mover><mrow id="S3.E14.m1.4.4.2.4" xref="S3.E14.m1.4.4.2.3.cmml"><mi id="S3.E14.m1.3.3.1.1" xref="S3.E14.m1.3.3.1.1.cmml">k</mi><mo id="S3.E14.m1.4.4.2.4.1" xref="S3.E14.m1.4.4.2.3.cmml">,</mo><mi id="S3.E14.m1.4.4.2.2" xref="S3.E14.m1.4.4.2.2.cmml">i</mi></mrow></msub><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.6" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐲</mi><mi id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.7" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">]</mo></mrow><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E14.m1.5.5.1.2" xref="S3.E14.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.5b"><apply id="S3.E14.m1.5.5.1.1.cmml" xref="S3.E14.m1.5.5.1"><eq id="S3.E14.m1.5.5.1.1.2.cmml" xref="S3.E14.m1.5.5.1.1.2"></eq><apply id="S3.E14.m1.5.5.1.1.3.cmml" xref="S3.E14.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.3.1.cmml" xref="S3.E14.m1.5.5.1.1.3">subscript</csymbol><apply id="S3.E14.m1.5.5.1.1.3.2.cmml" xref="S3.E14.m1.5.5.1.1.3.2"><ci id="S3.E14.m1.5.5.1.1.3.2.1.cmml" xref="S3.E14.m1.5.5.1.1.3.2.1">~</ci><ci id="S3.E14.m1.5.5.1.1.3.2.2.cmml" xref="S3.E14.m1.5.5.1.1.3.2.2">𝑜</ci></apply><ci id="S3.E14.m1.5.5.1.1.3.3.cmml" xref="S3.E14.m1.5.5.1.1.3.3">𝑖</ci></apply><apply id="S3.E14.m1.5.5.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1"><apply id="S3.E14.m1.5.5.1.1.1.2.cmml" xref="S3.E14.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.1.2.1.cmml" xref="S3.E14.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S3.E14.m1.5.5.1.1.1.2.2.cmml" xref="S3.E14.m1.5.5.1.1.1.2.2"></sum><ci id="S3.E14.m1.5.5.1.1.1.2.3.cmml" xref="S3.E14.m1.5.5.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E14.m1.5.5.1.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1"><times id="S3.E14.m1.5.5.1.1.1.1.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.2"></times><apply id="S3.E14.m1.5.5.1.1.1.1.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.3.2">𝛼</ci><list id="S3.E14.m1.2.2.2.3.cmml" xref="S3.E14.m1.2.2.2.4"><ci id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1">𝑘</ci><ci id="S3.E14.m1.2.2.2.2.cmml" xref="S3.E14.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E14.m1.5.5.1.1.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1"><apply id="S3.E14.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E14.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.2.2"></sum><ci id="S3.E14.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1"><times id="S3.E14.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.2"></times><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3"><divide id="S3.E14.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3"></divide><cn id="S3.E14.m1.5.5.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.2">1</cn><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.2">𝑁</ci><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.3.3.3">𝑏</ci></apply></apply><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.4">𝜎</ci><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1"><times id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">𝜓</ci><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2">𝐹</ci><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3">𝐷</ci><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.4">𝐴</ci></apply></apply><list id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3"><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐦</ci></apply><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1">~</ci><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐦</ci></apply><list id="S3.E14.m1.4.4.2.3.cmml" xref="S3.E14.m1.4.4.2.4"><ci id="S3.E14.m1.3.3.1.1.cmml" xref="S3.E14.m1.3.3.1.1">𝑘</ci><ci id="S3.E14.m1.4.4.2.2.cmml" xref="S3.E14.m1.4.4.2.2">𝑖</ci></list></apply><apply id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝐲</ci><ci id="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.5c">\displaystyle{\tilde{o}}_{i}=\sum_{k}\alpha_{k,i}\sum_{j}\frac{1}{N_{b}}\sigma%
(\psi_{FDA}\left(\left[\mathbf{\tilde{m}}_{j},\mathbf{\tilde{m}}_{k,i},\mathbf%
{y}_{i}\right]\right)),</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.5d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_ARG italic_σ ( italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT ( [ over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p5.10">where <math alttext="\alpha_{k,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.7.m1.2"><semantics id="S3.SS3.SSS2.p5.7.m1.2a"><msub id="S3.SS3.SSS2.p5.7.m1.2.3" xref="S3.SS3.SSS2.p5.7.m1.2.3.cmml"><mi id="S3.SS3.SSS2.p5.7.m1.2.3.2" xref="S3.SS3.SSS2.p5.7.m1.2.3.2.cmml">α</mi><mrow id="S3.SS3.SSS2.p5.7.m1.2.2.2.4" xref="S3.SS3.SSS2.p5.7.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p5.7.m1.1.1.1.1" xref="S3.SS3.SSS2.p5.7.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p5.7.m1.2.2.2.4.1" xref="S3.SS3.SSS2.p5.7.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p5.7.m1.2.2.2.2" xref="S3.SS3.SSS2.p5.7.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.7.m1.2b"><apply id="S3.SS3.SSS2.p5.7.m1.2.3.cmml" xref="S3.SS3.SSS2.p5.7.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.7.m1.2.3.1.cmml" xref="S3.SS3.SSS2.p5.7.m1.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p5.7.m1.2.3.2.cmml" xref="S3.SS3.SSS2.p5.7.m1.2.3.2">𝛼</ci><list id="S3.SS3.SSS2.p5.7.m1.2.2.2.3.cmml" xref="S3.SS3.SSS2.p5.7.m1.2.2.2.4"><ci id="S3.SS3.SSS2.p5.7.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p5.7.m1.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p5.7.m1.2.2.2.2.cmml" xref="S3.SS3.SSS2.p5.7.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.7.m1.2c">\alpha_{k,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.7.m1.2d">italic_α start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is computed with Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E10" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">10</span></a>), and <math alttext="{\tilde{o}}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.8.m2.1"><semantics id="S3.SS3.SSS2.p5.8.m2.1a"><msub id="S3.SS3.SSS2.p5.8.m2.1.1" xref="S3.SS3.SSS2.p5.8.m2.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p5.8.m2.1.1.2" xref="S3.SS3.SSS2.p5.8.m2.1.1.2.cmml"><mi id="S3.SS3.SSS2.p5.8.m2.1.1.2.2" xref="S3.SS3.SSS2.p5.8.m2.1.1.2.2.cmml">o</mi><mo id="S3.SS3.SSS2.p5.8.m2.1.1.2.1" xref="S3.SS3.SSS2.p5.8.m2.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS2.p5.8.m2.1.1.3" xref="S3.SS3.SSS2.p5.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.8.m2.1b"><apply id="S3.SS3.SSS2.p5.8.m2.1.1.cmml" xref="S3.SS3.SSS2.p5.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.8.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p5.8.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p5.8.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p5.8.m2.1.1.2"><ci id="S3.SS3.SSS2.p5.8.m2.1.1.2.1.cmml" xref="S3.SS3.SSS2.p5.8.m2.1.1.2.1">~</ci><ci id="S3.SS3.SSS2.p5.8.m2.1.1.2.2.cmml" xref="S3.SS3.SSS2.p5.8.m2.1.1.2.2">𝑜</ci></apply><ci id="S3.SS3.SSS2.p5.8.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p5.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.8.m2.1c">{\tilde{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.8.m2.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the causal recommendation prediction indicating the probability of the interaction between <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.9.m3.1"><semantics id="S3.SS3.SSS2.p5.9.m3.1a"><msub id="S3.SS3.SSS2.p5.9.m3.1.1" xref="S3.SS3.SSS2.p5.9.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p5.9.m3.1.1.2" xref="S3.SS3.SSS2.p5.9.m3.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS2.p5.9.m3.1.1.3" xref="S3.SS3.SSS2.p5.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.9.m3.1b"><apply id="S3.SS3.SSS2.p5.9.m3.1.1.cmml" xref="S3.SS3.SSS2.p5.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.9.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p5.9.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p5.9.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p5.9.m3.1.1.2">𝑥</ci><ci id="S3.SS3.SSS2.p5.9.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p5.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.9.m3.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.9.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.10.m4.1"><semantics id="S3.SS3.SSS2.p5.10.m4.1a"><msub id="S3.SS3.SSS2.p5.10.m4.1.1" xref="S3.SS3.SSS2.p5.10.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p5.10.m4.1.1.2" xref="S3.SS3.SSS2.p5.10.m4.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS2.p5.10.m4.1.1.3" xref="S3.SS3.SSS2.p5.10.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.10.m4.1b"><apply id="S3.SS3.SSS2.p5.10.m4.1.1.cmml" xref="S3.SS3.SSS2.p5.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p5.10.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p5.10.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p5.10.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p5.10.m4.1.1.2">𝑦</ci><ci id="S3.SS3.SSS2.p5.10.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p5.10.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.10.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.10.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p6">
<p class="ltx_p" id="S3.SS3.SSS2.p6.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p6.1.1">Causal Label Distillation. </span> <math alttext="{\tilde{o}}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.1.m1.1"><semantics id="S3.SS3.SSS2.p6.1.m1.1a"><msub id="S3.SS3.SSS2.p6.1.m1.1.1" xref="S3.SS3.SSS2.p6.1.m1.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p6.1.m1.1.1.2" xref="S3.SS3.SSS2.p6.1.m1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p6.1.m1.1.1.2.2" xref="S3.SS3.SSS2.p6.1.m1.1.1.2.2.cmml">o</mi><mo id="S3.SS3.SSS2.p6.1.m1.1.1.2.1" xref="S3.SS3.SSS2.p6.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS2.p6.1.m1.1.1.3" xref="S3.SS3.SSS2.p6.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.1.m1.1b"><apply id="S3.SS3.SSS2.p6.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p6.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.2"><ci id="S3.SS3.SSS2.p6.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.2.1">~</ci><ci id="S3.SS3.SSS2.p6.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.2.2">𝑜</ci></apply><ci id="S3.SS3.SSS2.p6.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.1.m1.1c">{\tilde{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.1.m1.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is predicted by all teacher recommendation models, and serves as the <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS2.p6.1.2">causal label guidance</span> for training the student recommendation model. The prediction of the student model is obtained as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx12">
<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\hat{o}}_{i}=\psi^{*}(\left[\mathbf{\hat{m}}_{i},\mathbf{y}_{i}%
\right])," class="ltx_Math" display="inline" id="S3.E15.m1.1"><semantics id="S3.E15.m1.1a"><mrow id="S3.E15.m1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml"><mrow id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml"><msub id="S3.E15.m1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E15.m1.1.1.1.1.3.2" xref="S3.E15.m1.1.1.1.1.3.2.cmml"><mi id="S3.E15.m1.1.1.1.1.3.2.2" mathcolor="#000000" xref="S3.E15.m1.1.1.1.1.3.2.2.cmml">o</mi><mo id="S3.E15.m1.1.1.1.1.3.2.1" xref="S3.E15.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E15.m1.1.1.1.1.3.3" xref="S3.E15.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E15.m1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E15.m1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.cmml"><msup id="S3.E15.m1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.3.cmml"><mi id="S3.E15.m1.1.1.1.1.1.3.2" xref="S3.E15.m1.1.1.1.1.1.3.2.cmml">ψ</mi><mo id="S3.E15.m1.1.1.1.1.1.3.3" xref="S3.E15.m1.1.1.1.1.1.3.3.cmml">∗</mo></msup><mo id="S3.E15.m1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E15.m1.1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.cmml"><mo id="S3.E15.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E15.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E15.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml">[</mo><msub id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐦</mi><mo id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E15.m1.1.1.1.1.1.1.1.1.2.4" xref="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐲</mi><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E15.m1.1.1.1.1.1.1.1.1.2.5" xref="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.E15.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E15.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E15.m1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.1b"><apply id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1"><eq id="S3.E15.m1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.2"></eq><apply id="S3.E15.m1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E15.m1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2"><ci id="S3.E15.m1.1.1.1.1.3.2.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.1">^</ci><ci id="S3.E15.m1.1.1.1.1.3.2.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2">𝑜</ci></apply><ci id="S3.E15.m1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E15.m1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1"><times id="S3.E15.m1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.1.2"></times><apply id="S3.E15.m1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E15.m1.1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.1.1.1.1.1.3.2">𝜓</ci><times id="S3.E15.m1.1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.1.1.1.1.1.3.3"></times></apply><interval closure="closed" id="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2"><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐦</ci></apply><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2">𝐲</ci><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.1c">\displaystyle{\hat{o}}_{i}=\psi^{*}(\left[\mathbf{\hat{m}}_{i},\mathbf{y}_{i}%
\right]),</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.1d">over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_ψ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( [ over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p6.8">where <math alttext="\psi^{*}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.2.m1.1"><semantics id="S3.SS3.SSS2.p6.2.m1.1a"><msup id="S3.SS3.SSS2.p6.2.m1.1.1" xref="S3.SS3.SSS2.p6.2.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p6.2.m1.1.1.2" xref="S3.SS3.SSS2.p6.2.m1.1.1.2.cmml">ψ</mi><mo id="S3.SS3.SSS2.p6.2.m1.1.1.3" xref="S3.SS3.SSS2.p6.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.2.m1.1b"><apply id="S3.SS3.SSS2.p6.2.m1.1.1.cmml" xref="S3.SS3.SSS2.p6.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.2.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.2.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p6.2.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.2.m1.1.1.2">𝜓</ci><times id="S3.SS3.SSS2.p6.2.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p6.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.2.m1.1c">\psi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.2.m1.1d">italic_ψ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the predictor of the student recommendation model, which is modeled as another FCL network. <math alttext="\mathbf{\hat{m}}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.3.m2.1"><semantics id="S3.SS3.SSS2.p6.3.m2.1a"><msub id="S3.SS3.SSS2.p6.3.m2.1.1" xref="S3.SS3.SSS2.p6.3.m2.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p6.3.m2.1.1.2" xref="S3.SS3.SSS2.p6.3.m2.1.1.2.cmml"><mi id="S3.SS3.SSS2.p6.3.m2.1.1.2.2" xref="S3.SS3.SSS2.p6.3.m2.1.1.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS2.p6.3.m2.1.1.2.1" xref="S3.SS3.SSS2.p6.3.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p6.3.m2.1.1.3" xref="S3.SS3.SSS2.p6.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.3.m2.1b"><apply id="S3.SS3.SSS2.p6.3.m2.1.1.cmml" xref="S3.SS3.SSS2.p6.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.3.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p6.3.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p6.3.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p6.3.m2.1.1.2"><ci id="S3.SS3.SSS2.p6.3.m2.1.1.2.1.cmml" xref="S3.SS3.SSS2.p6.3.m2.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p6.3.m2.1.1.2.2.cmml" xref="S3.SS3.SSS2.p6.3.m2.1.1.2.2">𝐦</ci></apply><ci id="S3.SS3.SSS2.p6.3.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p6.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.3.m2.1c">\mathbf{\hat{m}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.3.m2.1d">over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the mediator feature extracted by the student encoder <math alttext="\phi^{*}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.4.m3.1"><semantics id="S3.SS3.SSS2.p6.4.m3.1a"><msup id="S3.SS3.SSS2.p6.4.m3.1.1" xref="S3.SS3.SSS2.p6.4.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p6.4.m3.1.1.2" xref="S3.SS3.SSS2.p6.4.m3.1.1.2.cmml">ϕ</mi><mo id="S3.SS3.SSS2.p6.4.m3.1.1.3" xref="S3.SS3.SSS2.p6.4.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.4.m3.1b"><apply id="S3.SS3.SSS2.p6.4.m3.1.1.cmml" xref="S3.SS3.SSS2.p6.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.4.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p6.4.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p6.4.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p6.4.m3.1.1.2">italic-ϕ</ci><times id="S3.SS3.SSS2.p6.4.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p6.4.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.4.m3.1c">\phi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.4.m3.1d">italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. Since the Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E14" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">14</span></a>) introduces trainable parameters <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p6.8.1">i</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p6.8.2">e</span>., <math alttext="\mathbf{W}_{1}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.5.m4.1"><semantics id="S3.SS3.SSS2.p6.5.m4.1a"><msub id="S3.SS3.SSS2.p6.5.m4.1.1" xref="S3.SS3.SSS2.p6.5.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p6.5.m4.1.1.2" xref="S3.SS3.SSS2.p6.5.m4.1.1.2.cmml">𝐖</mi><mn id="S3.SS3.SSS2.p6.5.m4.1.1.3" xref="S3.SS3.SSS2.p6.5.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.5.m4.1b"><apply id="S3.SS3.SSS2.p6.5.m4.1.1.cmml" xref="S3.SS3.SSS2.p6.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.5.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p6.5.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.5.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p6.5.m4.1.1.2">𝐖</ci><cn id="S3.SS3.SSS2.p6.5.m4.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p6.5.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.5.m4.1c">\mathbf{W}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.5.m4.1d">bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.6.m5.1"><semantics id="S3.SS3.SSS2.p6.6.m5.1a"><msub id="S3.SS3.SSS2.p6.6.m5.1.1" xref="S3.SS3.SSS2.p6.6.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p6.6.m5.1.1.2" xref="S3.SS3.SSS2.p6.6.m5.1.1.2.cmml">𝐖</mi><mn id="S3.SS3.SSS2.p6.6.m5.1.1.3" xref="S3.SS3.SSS2.p6.6.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.6.m5.1b"><apply id="S3.SS3.SSS2.p6.6.m5.1.1.cmml" xref="S3.SS3.SSS2.p6.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.6.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p6.6.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.6.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p6.6.m5.1.1.2">𝐖</ci><cn id="S3.SS3.SSS2.p6.6.m5.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p6.6.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.6.m5.1c">\mathbf{W}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.6.m5.1d">bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.7.m6.1"><semantics id="S3.SS3.SSS2.p6.7.m6.1a"><mi id="S3.SS3.SSS2.p6.7.m6.1.1" xref="S3.SS3.SSS2.p6.7.m6.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.7.m6.1b"><ci id="S3.SS3.SSS2.p6.7.m6.1.1.cmml" xref="S3.SS3.SSS2.p6.7.m6.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.7.m6.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.7.m6.1d">italic_ϕ</annotation></semantics></math>, we try to pull the prediction closer to the ground-truth label <math alttext="o_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.8.m7.1"><semantics id="S3.SS3.SSS2.p6.8.m7.1a"><msub id="S3.SS3.SSS2.p6.8.m7.1.1" xref="S3.SS3.SSS2.p6.8.m7.1.1.cmml"><mi id="S3.SS3.SSS2.p6.8.m7.1.1.2" xref="S3.SS3.SSS2.p6.8.m7.1.1.2.cmml">o</mi><mi id="S3.SS3.SSS2.p6.8.m7.1.1.3" xref="S3.SS3.SSS2.p6.8.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.8.m7.1b"><apply id="S3.SS3.SSS2.p6.8.m7.1.1.cmml" xref="S3.SS3.SSS2.p6.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.8.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p6.8.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.8.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p6.8.m7.1.1.2">𝑜</ci><ci id="S3.SS3.SSS2.p6.8.m7.1.1.3.cmml" xref="S3.SS3.SSS2.p6.8.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.8.m7.1c">o_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.8.m7.1d">italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
Then, the loss function of FDA can be:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx13">
<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{FDA}=\sum_{i}(\underbrace{L_{kd}({\tilde{o}}_{i},{%
\hat{o}}_{i})}_{\text{Distillation}}+\underbrace{L_{ce}({\tilde{o}}_{i},{o}_{i%
})}_{\text{Consistency}})," class="ltx_Math" display="inline" id="S3.E16.m1.5"><semantics id="S3.E16.m1.5a"><mrow id="S3.E16.m1.5.5.1" xref="S3.E16.m1.5.5.1.1.cmml"><mrow id="S3.E16.m1.5.5.1.1" xref="S3.E16.m1.5.5.1.1.cmml"><msub id="S3.E16.m1.5.5.1.1.3" xref="S3.E16.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m1.5.5.1.1.3.2" xref="S3.E16.m1.5.5.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E16.m1.5.5.1.1.3.3" xref="S3.E16.m1.5.5.1.1.3.3.cmml"><mi id="S3.E16.m1.5.5.1.1.3.3.2" xref="S3.E16.m1.5.5.1.1.3.3.2.cmml">F</mi><mo id="S3.E16.m1.5.5.1.1.3.3.1" xref="S3.E16.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E16.m1.5.5.1.1.3.3.3" xref="S3.E16.m1.5.5.1.1.3.3.3.cmml">D</mi><mo id="S3.E16.m1.5.5.1.1.3.3.1a" xref="S3.E16.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E16.m1.5.5.1.1.3.3.4" xref="S3.E16.m1.5.5.1.1.3.3.4.cmml">A</mi></mrow></msub><mo id="S3.E16.m1.5.5.1.1.2" xref="S3.E16.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E16.m1.5.5.1.1.1" xref="S3.E16.m1.5.5.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E16.m1.5.5.1.1.1.2" xref="S3.E16.m1.5.5.1.1.1.2.cmml"><munder id="S3.E16.m1.5.5.1.1.1.2a" xref="S3.E16.m1.5.5.1.1.1.2.cmml"><mo id="S3.E16.m1.5.5.1.1.1.2.2" movablelimits="false" xref="S3.E16.m1.5.5.1.1.1.2.2.cmml">∑</mo><mi id="S3.E16.m1.5.5.1.1.1.2.3" xref="S3.E16.m1.5.5.1.1.1.2.3.cmml">i</mi></munder></mstyle><mrow id="S3.E16.m1.5.5.1.1.1.1.1" xref="S3.E16.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E16.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E16.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m1.5.5.1.1.1.1.1.1" xref="S3.E16.m1.5.5.1.1.1.1.1.1.cmml"><munder id="S3.E16.m1.5.5.1.1.1.1.1.1.2" xref="S3.E16.m1.5.5.1.1.1.1.1.1.2.cmml"><munder accentunder="true" id="S3.E16.m1.2.2" xref="S3.E16.m1.2.2.cmml"><mrow id="S3.E16.m1.2.2.2" xref="S3.E16.m1.2.2.2.cmml"><msub id="S3.E16.m1.2.2.2.4" xref="S3.E16.m1.2.2.2.4.cmml"><mi id="S3.E16.m1.2.2.2.4.2" mathcolor="#000000" xref="S3.E16.m1.2.2.2.4.2.cmml">L</mi><mrow id="S3.E16.m1.2.2.2.4.3" xref="S3.E16.m1.2.2.2.4.3.cmml"><mi id="S3.E16.m1.2.2.2.4.3.2" xref="S3.E16.m1.2.2.2.4.3.2.cmml">k</mi><mo id="S3.E16.m1.2.2.2.4.3.1" xref="S3.E16.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S3.E16.m1.2.2.2.4.3.3" xref="S3.E16.m1.2.2.2.4.3.3.cmml">d</mi></mrow></msub><mo id="S3.E16.m1.2.2.2.3" xref="S3.E16.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E16.m1.2.2.2.2.2" xref="S3.E16.m1.2.2.2.2.3.cmml"><mo id="S3.E16.m1.2.2.2.2.2.3" stretchy="false" xref="S3.E16.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.E16.m1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E16.m1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E16.m1.1.1.1.1.1.1.2.2" mathcolor="#000000" xref="S3.E16.m1.1.1.1.1.1.1.2.2.cmml">o</mi><mo id="S3.E16.m1.1.1.1.1.1.1.2.1" xref="S3.E16.m1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E16.m1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E16.m1.2.2.2.2.2.4" xref="S3.E16.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.E16.m1.2.2.2.2.2.2" xref="S3.E16.m1.2.2.2.2.2.2.cmml"><mover accent="true" id="S3.E16.m1.2.2.2.2.2.2.2" xref="S3.E16.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E16.m1.2.2.2.2.2.2.2.2" mathcolor="#000000" xref="S3.E16.m1.2.2.2.2.2.2.2.2.cmml">o</mi><mo id="S3.E16.m1.2.2.2.2.2.2.2.1" xref="S3.E16.m1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E16.m1.2.2.2.2.2.2.3" xref="S3.E16.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E16.m1.2.2.2.2.2.5" stretchy="false" xref="S3.E16.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E16.m1.2.2.3" xref="S3.E16.m1.2.2.3.cmml">⏟</mo></munder><mtext id="S3.E16.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E16.m1.5.5.1.1.1.1.1.1.2.2a.cmml">Distillation</mtext></munder><mo id="S3.E16.m1.5.5.1.1.1.1.1.1.1" xref="S3.E16.m1.5.5.1.1.1.1.1.1.1.cmml">+</mo><munder id="S3.E16.m1.5.5.1.1.1.1.1.1.3" xref="S3.E16.m1.5.5.1.1.1.1.1.1.3.cmml"><munder accentunder="true" id="S3.E16.m1.4.4" xref="S3.E16.m1.4.4.cmml"><mrow id="S3.E16.m1.4.4.2" xref="S3.E16.m1.4.4.2.cmml"><msub id="S3.E16.m1.4.4.2.4" xref="S3.E16.m1.4.4.2.4.cmml"><mi id="S3.E16.m1.4.4.2.4.2" mathcolor="#000000" xref="S3.E16.m1.4.4.2.4.2.cmml">L</mi><mrow id="S3.E16.m1.4.4.2.4.3" xref="S3.E16.m1.4.4.2.4.3.cmml"><mi id="S3.E16.m1.4.4.2.4.3.2" xref="S3.E16.m1.4.4.2.4.3.2.cmml">c</mi><mo id="S3.E16.m1.4.4.2.4.3.1" xref="S3.E16.m1.4.4.2.4.3.1.cmml">⁢</mo><mi id="S3.E16.m1.4.4.2.4.3.3" xref="S3.E16.m1.4.4.2.4.3.3.cmml">e</mi></mrow></msub><mo id="S3.E16.m1.4.4.2.3" xref="S3.E16.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.E16.m1.4.4.2.2.2" xref="S3.E16.m1.4.4.2.2.3.cmml"><mo id="S3.E16.m1.4.4.2.2.2.3" stretchy="false" xref="S3.E16.m1.4.4.2.2.3.cmml">(</mo><msub id="S3.E16.m1.3.3.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.cmml"><mover accent="true" id="S3.E16.m1.3.3.1.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.2.2" mathcolor="#000000" xref="S3.E16.m1.3.3.1.1.1.1.2.2.cmml">o</mi><mo id="S3.E16.m1.3.3.1.1.1.1.2.1" xref="S3.E16.m1.3.3.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E16.m1.3.3.1.1.1.1.3" xref="S3.E16.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E16.m1.4.4.2.2.2.4" xref="S3.E16.m1.4.4.2.2.3.cmml">,</mo><msub id="S3.E16.m1.4.4.2.2.2.2" xref="S3.E16.m1.4.4.2.2.2.2.cmml"><mi id="S3.E16.m1.4.4.2.2.2.2.2" mathcolor="#000000" xref="S3.E16.m1.4.4.2.2.2.2.2.cmml">o</mi><mi id="S3.E16.m1.4.4.2.2.2.2.3" xref="S3.E16.m1.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E16.m1.4.4.2.2.2.5" stretchy="false" xref="S3.E16.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E16.m1.4.4.3" xref="S3.E16.m1.4.4.3.cmml">⏟</mo></munder><mtext id="S3.E16.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E16.m1.5.5.1.1.1.1.1.1.3.2a.cmml">Consistency</mtext></munder></mrow><mo id="S3.E16.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E16.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E16.m1.5.5.1.2" xref="S3.E16.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.5b"><apply id="S3.E16.m1.5.5.1.1.cmml" xref="S3.E16.m1.5.5.1"><eq id="S3.E16.m1.5.5.1.1.2.cmml" xref="S3.E16.m1.5.5.1.1.2"></eq><apply id="S3.E16.m1.5.5.1.1.3.cmml" xref="S3.E16.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.5.5.1.1.3.1.cmml" xref="S3.E16.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E16.m1.5.5.1.1.3.2.cmml" xref="S3.E16.m1.5.5.1.1.3.2">ℒ</ci><apply id="S3.E16.m1.5.5.1.1.3.3.cmml" xref="S3.E16.m1.5.5.1.1.3.3"><times id="S3.E16.m1.5.5.1.1.3.3.1.cmml" xref="S3.E16.m1.5.5.1.1.3.3.1"></times><ci id="S3.E16.m1.5.5.1.1.3.3.2.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2">𝐹</ci><ci id="S3.E16.m1.5.5.1.1.3.3.3.cmml" xref="S3.E16.m1.5.5.1.1.3.3.3">𝐷</ci><ci id="S3.E16.m1.5.5.1.1.3.3.4.cmml" xref="S3.E16.m1.5.5.1.1.3.3.4">𝐴</ci></apply></apply><apply id="S3.E16.m1.5.5.1.1.1.cmml" xref="S3.E16.m1.5.5.1.1.1"><apply id="S3.E16.m1.5.5.1.1.1.2.cmml" xref="S3.E16.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.5.5.1.1.1.2.1.cmml" xref="S3.E16.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S3.E16.m1.5.5.1.1.1.2.2.cmml" xref="S3.E16.m1.5.5.1.1.1.2.2"></sum><ci id="S3.E16.m1.5.5.1.1.1.2.3.cmml" xref="S3.E16.m1.5.5.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E16.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E16.m1.5.5.1.1.1.1.1"><plus id="S3.E16.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.5.5.1.1.1.1.1.1.1"></plus><apply id="S3.E16.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E16.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E16.m1.2.2.cmml" xref="S3.E16.m1.2.2"><ci id="S3.E16.m1.2.2.3.cmml" xref="S3.E16.m1.2.2.3">⏟</ci><apply id="S3.E16.m1.2.2.2.cmml" xref="S3.E16.m1.2.2.2"><times id="S3.E16.m1.2.2.2.3.cmml" xref="S3.E16.m1.2.2.2.3"></times><apply id="S3.E16.m1.2.2.2.4.cmml" xref="S3.E16.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.2.4.1.cmml" xref="S3.E16.m1.2.2.2.4">subscript</csymbol><ci id="S3.E16.m1.2.2.2.4.2.cmml" xref="S3.E16.m1.2.2.2.4.2">𝐿</ci><apply id="S3.E16.m1.2.2.2.4.3.cmml" xref="S3.E16.m1.2.2.2.4.3"><times id="S3.E16.m1.2.2.2.4.3.1.cmml" xref="S3.E16.m1.2.2.2.4.3.1"></times><ci id="S3.E16.m1.2.2.2.4.3.2.cmml" xref="S3.E16.m1.2.2.2.4.3.2">𝑘</ci><ci id="S3.E16.m1.2.2.2.4.3.3.cmml" xref="S3.E16.m1.2.2.2.4.3.3">𝑑</ci></apply></apply><interval closure="open" id="S3.E16.m1.2.2.2.2.3.cmml" xref="S3.E16.m1.2.2.2.2.2"><apply id="S3.E16.m1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E16.m1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.2"><ci id="S3.E16.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E16.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.2.2">𝑜</ci></apply><ci id="S3.E16.m1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E16.m1.2.2.2.2.2.2.cmml" xref="S3.E16.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.2.2.2.2.1.cmml" xref="S3.E16.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E16.m1.2.2.2.2.2.2.2.cmml" xref="S3.E16.m1.2.2.2.2.2.2.2"><ci id="S3.E16.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E16.m1.2.2.2.2.2.2.2.1">^</ci><ci id="S3.E16.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E16.m1.2.2.2.2.2.2.2.2">𝑜</ci></apply><ci id="S3.E16.m1.2.2.2.2.2.2.3.cmml" xref="S3.E16.m1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><ci id="S3.E16.m1.5.5.1.1.1.1.1.1.2.2a.cmml" xref="S3.E16.m1.5.5.1.1.1.1.1.1.2.2"><mtext id="S3.E16.m1.5.5.1.1.1.1.1.1.2.2.cmml" mathsize="70%" xref="S3.E16.m1.5.5.1.1.1.1.1.1.2.2">Distillation</mtext></ci></apply><apply id="S3.E16.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E16.m1.4.4.cmml" xref="S3.E16.m1.4.4"><ci id="S3.E16.m1.4.4.3.cmml" xref="S3.E16.m1.4.4.3">⏟</ci><apply id="S3.E16.m1.4.4.2.cmml" xref="S3.E16.m1.4.4.2"><times id="S3.E16.m1.4.4.2.3.cmml" xref="S3.E16.m1.4.4.2.3"></times><apply id="S3.E16.m1.4.4.2.4.cmml" xref="S3.E16.m1.4.4.2.4"><csymbol cd="ambiguous" id="S3.E16.m1.4.4.2.4.1.cmml" xref="S3.E16.m1.4.4.2.4">subscript</csymbol><ci id="S3.E16.m1.4.4.2.4.2.cmml" xref="S3.E16.m1.4.4.2.4.2">𝐿</ci><apply id="S3.E16.m1.4.4.2.4.3.cmml" xref="S3.E16.m1.4.4.2.4.3"><times id="S3.E16.m1.4.4.2.4.3.1.cmml" xref="S3.E16.m1.4.4.2.4.3.1"></times><ci id="S3.E16.m1.4.4.2.4.3.2.cmml" xref="S3.E16.m1.4.4.2.4.3.2">𝑐</ci><ci id="S3.E16.m1.4.4.2.4.3.3.cmml" xref="S3.E16.m1.4.4.2.4.3.3">𝑒</ci></apply></apply><interval closure="open" id="S3.E16.m1.4.4.2.2.3.cmml" xref="S3.E16.m1.4.4.2.2.2"><apply id="S3.E16.m1.3.3.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1">subscript</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2"><ci id="S3.E16.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.1">~</ci><ci id="S3.E16.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.2">𝑜</ci></apply><ci id="S3.E16.m1.3.3.1.1.1.1.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E16.m1.4.4.2.2.2.2.cmml" xref="S3.E16.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.4.4.2.2.2.2.1.cmml" xref="S3.E16.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S3.E16.m1.4.4.2.2.2.2.2.cmml" xref="S3.E16.m1.4.4.2.2.2.2.2">𝑜</ci><ci id="S3.E16.m1.4.4.2.2.2.2.3.cmml" xref="S3.E16.m1.4.4.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><ci id="S3.E16.m1.5.5.1.1.1.1.1.1.3.2a.cmml" xref="S3.E16.m1.5.5.1.1.1.1.1.1.3.2"><mtext id="S3.E16.m1.5.5.1.1.1.1.1.1.3.2.cmml" mathsize="70%" xref="S3.E16.m1.5.5.1.1.1.1.1.1.3.2">Consistency</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.5c">\displaystyle\mathcal{L}_{FDA}=\sum_{i}(\underbrace{L_{kd}({\tilde{o}}_{i},{%
\hat{o}}_{i})}_{\text{Distillation}}+\underbrace{L_{ce}({\tilde{o}}_{i},{o}_{i%
})}_{\text{Consistency}}),</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m1.5d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( under⏟ start_ARG italic_L start_POSTSUBSCRIPT italic_k italic_d end_POSTSUBSCRIPT ( over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT Distillation end_POSTSUBSCRIPT + under⏟ start_ARG italic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT ( over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT Consistency end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p6.16">where <math alttext="L_{kd}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.9.m1.1"><semantics id="S3.SS3.SSS2.p6.9.m1.1a"><msub id="S3.SS3.SSS2.p6.9.m1.1.1" xref="S3.SS3.SSS2.p6.9.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p6.9.m1.1.1.2" xref="S3.SS3.SSS2.p6.9.m1.1.1.2.cmml">L</mi><mrow id="S3.SS3.SSS2.p6.9.m1.1.1.3" xref="S3.SS3.SSS2.p6.9.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p6.9.m1.1.1.3.2" xref="S3.SS3.SSS2.p6.9.m1.1.1.3.2.cmml">k</mi><mo id="S3.SS3.SSS2.p6.9.m1.1.1.3.1" xref="S3.SS3.SSS2.p6.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.9.m1.1.1.3.3" xref="S3.SS3.SSS2.p6.9.m1.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.9.m1.1b"><apply id="S3.SS3.SSS2.p6.9.m1.1.1.cmml" xref="S3.SS3.SSS2.p6.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.9.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p6.9.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.9.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p6.9.m1.1.1.2">𝐿</ci><apply id="S3.SS3.SSS2.p6.9.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p6.9.m1.1.1.3"><times id="S3.SS3.SSS2.p6.9.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p6.9.m1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p6.9.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p6.9.m1.1.1.3.2">𝑘</ci><ci id="S3.SS3.SSS2.p6.9.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p6.9.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.9.m1.1c">L_{kd}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.9.m1.1d">italic_L start_POSTSUBSCRIPT italic_k italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is the knowledge distillation criterion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib21" title="">21</a>]</cite>. <math alttext="L_{ce}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.10.m2.1"><semantics id="S3.SS3.SSS2.p6.10.m2.1a"><msub id="S3.SS3.SSS2.p6.10.m2.1.1" xref="S3.SS3.SSS2.p6.10.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p6.10.m2.1.1.2" xref="S3.SS3.SSS2.p6.10.m2.1.1.2.cmml">L</mi><mrow id="S3.SS3.SSS2.p6.10.m2.1.1.3" xref="S3.SS3.SSS2.p6.10.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p6.10.m2.1.1.3.2" xref="S3.SS3.SSS2.p6.10.m2.1.1.3.2.cmml">c</mi><mo id="S3.SS3.SSS2.p6.10.m2.1.1.3.1" xref="S3.SS3.SSS2.p6.10.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.10.m2.1.1.3.3" xref="S3.SS3.SSS2.p6.10.m2.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.10.m2.1b"><apply id="S3.SS3.SSS2.p6.10.m2.1.1.cmml" xref="S3.SS3.SSS2.p6.10.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.10.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p6.10.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.10.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p6.10.m2.1.1.2">𝐿</ci><apply id="S3.SS3.SSS2.p6.10.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p6.10.m2.1.1.3"><times id="S3.SS3.SSS2.p6.10.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p6.10.m2.1.1.3.1"></times><ci id="S3.SS3.SSS2.p6.10.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p6.10.m2.1.1.3.2">𝑐</ci><ci id="S3.SS3.SSS2.p6.10.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p6.10.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.10.m2.1c">L_{ce}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.10.m2.1d">italic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math> is the cross-entropy loss. It is noteworthy that the consistency loss solely affects <math alttext="\mathbf{W}_{1}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.11.m3.1"><semantics id="S3.SS3.SSS2.p6.11.m3.1a"><msub id="S3.SS3.SSS2.p6.11.m3.1.1" xref="S3.SS3.SSS2.p6.11.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p6.11.m3.1.1.2" xref="S3.SS3.SSS2.p6.11.m3.1.1.2.cmml">𝐖</mi><mn id="S3.SS3.SSS2.p6.11.m3.1.1.3" xref="S3.SS3.SSS2.p6.11.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.11.m3.1b"><apply id="S3.SS3.SSS2.p6.11.m3.1.1.cmml" xref="S3.SS3.SSS2.p6.11.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.11.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p6.11.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.11.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p6.11.m3.1.1.2">𝐖</ci><cn id="S3.SS3.SSS2.p6.11.m3.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p6.11.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.11.m3.1c">\mathbf{W}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.11.m3.1d">bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.12.m4.1"><semantics id="S3.SS3.SSS2.p6.12.m4.1a"><msub id="S3.SS3.SSS2.p6.12.m4.1.1" xref="S3.SS3.SSS2.p6.12.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p6.12.m4.1.1.2" xref="S3.SS3.SSS2.p6.12.m4.1.1.2.cmml">𝐖</mi><mn id="S3.SS3.SSS2.p6.12.m4.1.1.3" xref="S3.SS3.SSS2.p6.12.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.12.m4.1b"><apply id="S3.SS3.SSS2.p6.12.m4.1.1.cmml" xref="S3.SS3.SSS2.p6.12.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.12.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p6.12.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.12.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p6.12.m4.1.1.2">𝐖</ci><cn id="S3.SS3.SSS2.p6.12.m4.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p6.12.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.12.m4.1c">\mathbf{W}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.12.m4.1d">bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\psi_{FDA}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.13.m5.1"><semantics id="S3.SS3.SSS2.p6.13.m5.1a"><msub id="S3.SS3.SSS2.p6.13.m5.1.1" xref="S3.SS3.SSS2.p6.13.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p6.13.m5.1.1.2" xref="S3.SS3.SSS2.p6.13.m5.1.1.2.cmml">ψ</mi><mrow id="S3.SS3.SSS2.p6.13.m5.1.1.3" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.cmml"><mi id="S3.SS3.SSS2.p6.13.m5.1.1.3.2" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.2.cmml">F</mi><mo id="S3.SS3.SSS2.p6.13.m5.1.1.3.1" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.13.m5.1.1.3.3" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.3.cmml">D</mi><mo id="S3.SS3.SSS2.p6.13.m5.1.1.3.1a" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.13.m5.1.1.3.4" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.13.m5.1b"><apply id="S3.SS3.SSS2.p6.13.m5.1.1.cmml" xref="S3.SS3.SSS2.p6.13.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.13.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p6.13.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.13.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p6.13.m5.1.1.2">𝜓</ci><apply id="S3.SS3.SSS2.p6.13.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p6.13.m5.1.1.3"><times id="S3.SS3.SSS2.p6.13.m5.1.1.3.1.cmml" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.1"></times><ci id="S3.SS3.SSS2.p6.13.m5.1.1.3.2.cmml" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.2">𝐹</ci><ci id="S3.SS3.SSS2.p6.13.m5.1.1.3.3.cmml" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.3">𝐷</ci><ci id="S3.SS3.SSS2.p6.13.m5.1.1.3.4.cmml" xref="S3.SS3.SSS2.p6.13.m5.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.13.m5.1c">\psi_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.13.m5.1d">italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math>. The distillation loss is computed when <math alttext="\mathbf{W}_{1}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.14.m6.1"><semantics id="S3.SS3.SSS2.p6.14.m6.1a"><msub id="S3.SS3.SSS2.p6.14.m6.1.1" xref="S3.SS3.SSS2.p6.14.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p6.14.m6.1.1.2" xref="S3.SS3.SSS2.p6.14.m6.1.1.2.cmml">𝐖</mi><mn id="S3.SS3.SSS2.p6.14.m6.1.1.3" xref="S3.SS3.SSS2.p6.14.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.14.m6.1b"><apply id="S3.SS3.SSS2.p6.14.m6.1.1.cmml" xref="S3.SS3.SSS2.p6.14.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.14.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p6.14.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.14.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p6.14.m6.1.1.2">𝐖</ci><cn id="S3.SS3.SSS2.p6.14.m6.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p6.14.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.14.m6.1c">\mathbf{W}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.14.m6.1d">bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.15.m7.1"><semantics id="S3.SS3.SSS2.p6.15.m7.1a"><msub id="S3.SS3.SSS2.p6.15.m7.1.1" xref="S3.SS3.SSS2.p6.15.m7.1.1.cmml"><mi id="S3.SS3.SSS2.p6.15.m7.1.1.2" xref="S3.SS3.SSS2.p6.15.m7.1.1.2.cmml">𝐖</mi><mn id="S3.SS3.SSS2.p6.15.m7.1.1.3" xref="S3.SS3.SSS2.p6.15.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.15.m7.1b"><apply id="S3.SS3.SSS2.p6.15.m7.1.1.cmml" xref="S3.SS3.SSS2.p6.15.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.15.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p6.15.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.15.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p6.15.m7.1.1.2">𝐖</ci><cn id="S3.SS3.SSS2.p6.15.m7.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p6.15.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.15.m7.1c">\mathbf{W}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.15.m7.1d">bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\psi_{FDA}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p6.16.m8.1"><semantics id="S3.SS3.SSS2.p6.16.m8.1a"><msub id="S3.SS3.SSS2.p6.16.m8.1.1" xref="S3.SS3.SSS2.p6.16.m8.1.1.cmml"><mi id="S3.SS3.SSS2.p6.16.m8.1.1.2" xref="S3.SS3.SSS2.p6.16.m8.1.1.2.cmml">ψ</mi><mrow id="S3.SS3.SSS2.p6.16.m8.1.1.3" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.cmml"><mi id="S3.SS3.SSS2.p6.16.m8.1.1.3.2" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.2.cmml">F</mi><mo id="S3.SS3.SSS2.p6.16.m8.1.1.3.1" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.16.m8.1.1.3.3" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.3.cmml">D</mi><mo id="S3.SS3.SSS2.p6.16.m8.1.1.3.1a" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p6.16.m8.1.1.3.4" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.16.m8.1b"><apply id="S3.SS3.SSS2.p6.16.m8.1.1.cmml" xref="S3.SS3.SSS2.p6.16.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p6.16.m8.1.1.1.cmml" xref="S3.SS3.SSS2.p6.16.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p6.16.m8.1.1.2.cmml" xref="S3.SS3.SSS2.p6.16.m8.1.1.2">𝜓</ci><apply id="S3.SS3.SSS2.p6.16.m8.1.1.3.cmml" xref="S3.SS3.SSS2.p6.16.m8.1.1.3"><times id="S3.SS3.SSS2.p6.16.m8.1.1.3.1.cmml" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.1"></times><ci id="S3.SS3.SSS2.p6.16.m8.1.1.3.2.cmml" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.2">𝐹</ci><ci id="S3.SS3.SSS2.p6.16.m8.1.1.3.3.cmml" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.3">𝐷</ci><ci id="S3.SS3.SSS2.p6.16.m8.1.1.3.4.cmml" xref="S3.SS3.SSS2.p6.16.m8.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.16.m8.1c">\psi_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p6.16.m8.1d">italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> are fixed.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Feature Distillation</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.1">Besides label distillation, we also incorporate the feature distillation loss for training the student recommendation model. Note that the mediator values <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><mi id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><ci id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.1.m1.1d">italic_m</annotation></semantics></math> extracted by teachers are intermediate features, which can serve as the feature guidance. The feature distillation loss can be defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx14">
<tbody id="S3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{FT}=\sum_{i}d(\pi(\{\mathbf{\tilde{m}}_{k,i}\}_{k=1}%
^{K}),\mathbf{\hat{m}}_{i})," class="ltx_Math" display="inline" id="S3.E17.m1.3"><semantics id="S3.E17.m1.3a"><mrow id="S3.E17.m1.3.3.1" xref="S3.E17.m1.3.3.1.1.cmml"><mrow id="S3.E17.m1.3.3.1.1" xref="S3.E17.m1.3.3.1.1.cmml"><msub id="S3.E17.m1.3.3.1.1.4" xref="S3.E17.m1.3.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E17.m1.3.3.1.1.4.2" xref="S3.E17.m1.3.3.1.1.4.2.cmml">ℒ</mi><mrow id="S3.E17.m1.3.3.1.1.4.3" xref="S3.E17.m1.3.3.1.1.4.3.cmml"><mi id="S3.E17.m1.3.3.1.1.4.3.2" xref="S3.E17.m1.3.3.1.1.4.3.2.cmml">F</mi><mo id="S3.E17.m1.3.3.1.1.4.3.1" xref="S3.E17.m1.3.3.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E17.m1.3.3.1.1.4.3.3" xref="S3.E17.m1.3.3.1.1.4.3.3.cmml">T</mi></mrow></msub><mo id="S3.E17.m1.3.3.1.1.3" xref="S3.E17.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E17.m1.3.3.1.1.2" xref="S3.E17.m1.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E17.m1.3.3.1.1.2.3" xref="S3.E17.m1.3.3.1.1.2.3.cmml"><munder id="S3.E17.m1.3.3.1.1.2.3a" xref="S3.E17.m1.3.3.1.1.2.3.cmml"><mo id="S3.E17.m1.3.3.1.1.2.3.2" movablelimits="false" xref="S3.E17.m1.3.3.1.1.2.3.2.cmml">∑</mo><mi id="S3.E17.m1.3.3.1.1.2.3.3" xref="S3.E17.m1.3.3.1.1.2.3.3.cmml">i</mi></munder></mstyle><mrow id="S3.E17.m1.3.3.1.1.2.2" xref="S3.E17.m1.3.3.1.1.2.2.cmml"><mi id="S3.E17.m1.3.3.1.1.2.2.4" mathcolor="#000000" xref="S3.E17.m1.3.3.1.1.2.2.4.cmml">d</mi><mo id="S3.E17.m1.3.3.1.1.2.2.3" xref="S3.E17.m1.3.3.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E17.m1.3.3.1.1.2.2.2.2" xref="S3.E17.m1.3.3.1.1.2.2.2.3.cmml"><mo id="S3.E17.m1.3.3.1.1.2.2.2.2.3" stretchy="false" xref="S3.E17.m1.3.3.1.1.2.2.2.3.cmml">(</mo><mrow id="S3.E17.m1.3.3.1.1.1.1.1.1.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E17.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.3.cmml">π</mi><mo id="S3.E17.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐦</mi><mo id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.E17.m1.2.2.2.4" xref="S3.E17.m1.2.2.2.3.cmml"><mi id="S3.E17.m1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.cmml">k</mi><mo id="S3.E17.m1.2.2.2.4.1" xref="S3.E17.m1.2.2.2.3.cmml">,</mo><mi id="S3.E17.m1.2.2.2.2" xref="S3.E17.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">K</mi></msubsup><mo id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E17.m1.3.3.1.1.2.2.2.2.4" xref="S3.E17.m1.3.3.1.1.2.2.2.3.cmml">,</mo><msub id="S3.E17.m1.3.3.1.1.2.2.2.2.2" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.cmml"><mover accent="true" id="S3.E17.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">𝐦</mi><mo id="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.1" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E17.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E17.m1.3.3.1.1.2.2.2.2.5" stretchy="false" xref="S3.E17.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E17.m1.3.3.1.2" xref="S3.E17.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.3b"><apply id="S3.E17.m1.3.3.1.1.cmml" xref="S3.E17.m1.3.3.1"><eq id="S3.E17.m1.3.3.1.1.3.cmml" xref="S3.E17.m1.3.3.1.1.3"></eq><apply id="S3.E17.m1.3.3.1.1.4.cmml" xref="S3.E17.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.1.1.4.1.cmml" xref="S3.E17.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E17.m1.3.3.1.1.4.2.cmml" xref="S3.E17.m1.3.3.1.1.4.2">ℒ</ci><apply id="S3.E17.m1.3.3.1.1.4.3.cmml" xref="S3.E17.m1.3.3.1.1.4.3"><times id="S3.E17.m1.3.3.1.1.4.3.1.cmml" xref="S3.E17.m1.3.3.1.1.4.3.1"></times><ci id="S3.E17.m1.3.3.1.1.4.3.2.cmml" xref="S3.E17.m1.3.3.1.1.4.3.2">𝐹</ci><ci id="S3.E17.m1.3.3.1.1.4.3.3.cmml" xref="S3.E17.m1.3.3.1.1.4.3.3">𝑇</ci></apply></apply><apply id="S3.E17.m1.3.3.1.1.2.cmml" xref="S3.E17.m1.3.3.1.1.2"><apply id="S3.E17.m1.3.3.1.1.2.3.cmml" xref="S3.E17.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.1.1.2.3.1.cmml" xref="S3.E17.m1.3.3.1.1.2.3">subscript</csymbol><sum id="S3.E17.m1.3.3.1.1.2.3.2.cmml" xref="S3.E17.m1.3.3.1.1.2.3.2"></sum><ci id="S3.E17.m1.3.3.1.1.2.3.3.cmml" xref="S3.E17.m1.3.3.1.1.2.3.3">𝑖</ci></apply><apply id="S3.E17.m1.3.3.1.1.2.2.cmml" xref="S3.E17.m1.3.3.1.1.2.2"><times id="S3.E17.m1.3.3.1.1.2.2.3.cmml" xref="S3.E17.m1.3.3.1.1.2.2.3"></times><ci id="S3.E17.m1.3.3.1.1.2.2.4.cmml" xref="S3.E17.m1.3.3.1.1.2.2.4">𝑑</ci><interval closure="open" id="S3.E17.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2"><apply id="S3.E17.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1"><times id="S3.E17.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S3.E17.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.3">𝜋</ci><apply id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><set id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐦</ci></apply><list id="S3.E17.m1.2.2.2.3.cmml" xref="S3.E17.m1.2.2.2.4"><ci id="S3.E17.m1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1">𝑘</ci><ci id="S3.E17.m1.2.2.2.2.cmml" xref="S3.E17.m1.2.2.2.2">𝑖</ci></list></apply></set><apply id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><eq id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑘</ci><cn id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝐾</ci></apply></apply><apply id="S3.E17.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><apply id="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.2"><ci id="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.1">^</ci><ci id="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.2">𝐦</ci></apply><ci id="S3.E17.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.3c">\displaystyle\mathcal{L}_{FT}=\sum_{i}d(\pi(\{\mathbf{\tilde{m}}_{k,i}\}_{k=1}%
^{K}),\mathbf{\hat{m}}_{i}),</annotation><annotation encoding="application/x-llamapun" id="S3.E17.m1.3d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_T end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_d ( italic_π ( { over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ) , over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p1.4">where <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.2.m1.1"><semantics id="S3.SS3.SSS3.p1.2.m1.1a"><mi id="S3.SS3.SSS3.p1.2.m1.1.1" xref="S3.SS3.SSS3.p1.2.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m1.1b"><ci id="S3.SS3.SSS3.p1.2.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.2.m1.1d">italic_π</annotation></semantics></math> denotes the function that aggregates the intermediate features of teachers. <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.3.m2.1"><semantics id="S3.SS3.SSS3.p1.3.m2.1a"><mi id="S3.SS3.SSS3.p1.3.m2.1.1" xref="S3.SS3.SSS3.p1.3.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.3.m2.1b"><ci id="S3.SS3.SSS3.p1.3.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.3.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.3.m2.1d">italic_d</annotation></semantics></math> denotes a distance function such as Euclidean distance. <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.4.m3.1"><semantics id="S3.SS3.SSS3.p1.4.m3.1a"><mi id="S3.SS3.SSS3.p1.4.m3.1.1" xref="S3.SS3.SSS3.p1.4.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.4.m3.1b"><ci id="S3.SS3.SSS3.p1.4.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.4.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.4.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.4.m3.1d">italic_π</annotation></semantics></math> is decided according to whether we can observe the confounder of interest. That is, if the confounder of interest is not observed, we take the vanilla feature distillation. If the confounder of interest is observed, we employ back-door adjustment to improve deconfounding in the feature level, namely causal feature distillation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS3.p2">
<p class="ltx_p" id="S3.SS3.SSS3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p2.1.1">Vanilla Feature Distillation. </span> The aggregation function in the vanilla feature distillation takes the average of all teacher features, which can be written as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx15">
<tbody id="S3.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\pi(\{\mathbf{\tilde{m}}_{k,i}\}_{k=1}^{K})=\frac{1}{K}\sum_{k}%
\mathbf{\tilde{m}}_{k,i}." class="ltx_Math" display="inline" id="S3.E18.m1.5"><semantics id="S3.E18.m1.5a"><mrow id="S3.E18.m1.5.5.1" xref="S3.E18.m1.5.5.1.1.cmml"><mrow id="S3.E18.m1.5.5.1.1" xref="S3.E18.m1.5.5.1.1.cmml"><mrow id="S3.E18.m1.5.5.1.1.1" xref="S3.E18.m1.5.5.1.1.1.cmml"><mi id="S3.E18.m1.5.5.1.1.1.3" xref="S3.E18.m1.5.5.1.1.1.3.cmml">π</mi><mo id="S3.E18.m1.5.5.1.1.1.2" xref="S3.E18.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E18.m1.5.5.1.1.1.1.1" xref="S3.E18.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E18.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E18.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E18.m1.5.5.1.1.1.1.1.1" xref="S3.E18.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐦</mi><mo id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.E18.m1.2.2.2.4" xref="S3.E18.m1.2.2.2.3.cmml"><mi id="S3.E18.m1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.cmml">k</mi><mo id="S3.E18.m1.2.2.2.4.1" xref="S3.E18.m1.2.2.2.3.cmml">,</mo><mi id="S3.E18.m1.2.2.2.2" xref="S3.E18.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E18.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.1" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E18.m1.5.5.1.1.1.1.1.1.3" xref="S3.E18.m1.5.5.1.1.1.1.1.1.3.cmml">K</mi></msubsup><mo id="S3.E18.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E18.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E18.m1.5.5.1.1.2" xref="S3.E18.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E18.m1.5.5.1.1.3" xref="S3.E18.m1.5.5.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E18.m1.5.5.1.1.3.2" xref="S3.E18.m1.5.5.1.1.3.2.cmml"><mfrac id="S3.E18.m1.5.5.1.1.3.2a" mathcolor="#000000" xref="S3.E18.m1.5.5.1.1.3.2.cmml"><mn id="S3.E18.m1.5.5.1.1.3.2.2" mathcolor="#000000" xref="S3.E18.m1.5.5.1.1.3.2.2.cmml">1</mn><mi id="S3.E18.m1.5.5.1.1.3.2.3" mathcolor="#000000" xref="S3.E18.m1.5.5.1.1.3.2.3.cmml">K</mi></mfrac></mstyle><mo id="S3.E18.m1.5.5.1.1.3.1" xref="S3.E18.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E18.m1.5.5.1.1.3.3" xref="S3.E18.m1.5.5.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E18.m1.5.5.1.1.3.3.1" xref="S3.E18.m1.5.5.1.1.3.3.1.cmml"><munder id="S3.E18.m1.5.5.1.1.3.3.1a" xref="S3.E18.m1.5.5.1.1.3.3.1.cmml"><mo id="S3.E18.m1.5.5.1.1.3.3.1.2" movablelimits="false" xref="S3.E18.m1.5.5.1.1.3.3.1.2.cmml">∑</mo><mi id="S3.E18.m1.5.5.1.1.3.3.1.3" xref="S3.E18.m1.5.5.1.1.3.3.1.3.cmml">k</mi></munder></mstyle><msub id="S3.E18.m1.5.5.1.1.3.3.2" xref="S3.E18.m1.5.5.1.1.3.3.2.cmml"><mover accent="true" id="S3.E18.m1.5.5.1.1.3.3.2.2" xref="S3.E18.m1.5.5.1.1.3.3.2.2.cmml"><mi id="S3.E18.m1.5.5.1.1.3.3.2.2.2" xref="S3.E18.m1.5.5.1.1.3.3.2.2.2.cmml">𝐦</mi><mo id="S3.E18.m1.5.5.1.1.3.3.2.2.1" xref="S3.E18.m1.5.5.1.1.3.3.2.2.1.cmml">~</mo></mover><mrow id="S3.E18.m1.4.4.2.4" xref="S3.E18.m1.4.4.2.3.cmml"><mi id="S3.E18.m1.3.3.1.1" xref="S3.E18.m1.3.3.1.1.cmml">k</mi><mo id="S3.E18.m1.4.4.2.4.1" xref="S3.E18.m1.4.4.2.3.cmml">,</mo><mi id="S3.E18.m1.4.4.2.2" xref="S3.E18.m1.4.4.2.2.cmml">i</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E18.m1.5.5.1.2" lspace="0em" xref="S3.E18.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.5b"><apply id="S3.E18.m1.5.5.1.1.cmml" xref="S3.E18.m1.5.5.1"><eq id="S3.E18.m1.5.5.1.1.2.cmml" xref="S3.E18.m1.5.5.1.1.2"></eq><apply id="S3.E18.m1.5.5.1.1.1.cmml" xref="S3.E18.m1.5.5.1.1.1"><times id="S3.E18.m1.5.5.1.1.1.2.cmml" xref="S3.E18.m1.5.5.1.1.1.2"></times><ci id="S3.E18.m1.5.5.1.1.1.3.cmml" xref="S3.E18.m1.5.5.1.1.1.3">𝜋</ci><apply id="S3.E18.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E18.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1">superscript</csymbol><apply id="S3.E18.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E18.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1">subscript</csymbol><set id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1"><apply id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2">𝐦</ci></apply><list id="S3.E18.m1.2.2.2.3.cmml" xref="S3.E18.m1.2.2.2.4"><ci id="S3.E18.m1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1">𝑘</ci><ci id="S3.E18.m1.2.2.2.2.cmml" xref="S3.E18.m1.2.2.2.2">𝑖</ci></list></apply></set><apply id="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.3"><eq id="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.1"></eq><ci id="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.2">𝑘</ci><cn id="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E18.m1.5.5.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E18.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E18.m1.5.5.1.1.1.1.1.1.3">𝐾</ci></apply></apply><apply id="S3.E18.m1.5.5.1.1.3.cmml" xref="S3.E18.m1.5.5.1.1.3"><times id="S3.E18.m1.5.5.1.1.3.1.cmml" xref="S3.E18.m1.5.5.1.1.3.1"></times><apply id="S3.E18.m1.5.5.1.1.3.2.cmml" xref="S3.E18.m1.5.5.1.1.3.2"><divide id="S3.E18.m1.5.5.1.1.3.2.1.cmml" xref="S3.E18.m1.5.5.1.1.3.2"></divide><cn id="S3.E18.m1.5.5.1.1.3.2.2.cmml" type="integer" xref="S3.E18.m1.5.5.1.1.3.2.2">1</cn><ci id="S3.E18.m1.5.5.1.1.3.2.3.cmml" xref="S3.E18.m1.5.5.1.1.3.2.3">𝐾</ci></apply><apply id="S3.E18.m1.5.5.1.1.3.3.cmml" xref="S3.E18.m1.5.5.1.1.3.3"><apply id="S3.E18.m1.5.5.1.1.3.3.1.cmml" xref="S3.E18.m1.5.5.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E18.m1.5.5.1.1.3.3.1.1.cmml" xref="S3.E18.m1.5.5.1.1.3.3.1">subscript</csymbol><sum id="S3.E18.m1.5.5.1.1.3.3.1.2.cmml" xref="S3.E18.m1.5.5.1.1.3.3.1.2"></sum><ci id="S3.E18.m1.5.5.1.1.3.3.1.3.cmml" xref="S3.E18.m1.5.5.1.1.3.3.1.3">𝑘</ci></apply><apply id="S3.E18.m1.5.5.1.1.3.3.2.cmml" xref="S3.E18.m1.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E18.m1.5.5.1.1.3.3.2.1.cmml" xref="S3.E18.m1.5.5.1.1.3.3.2">subscript</csymbol><apply id="S3.E18.m1.5.5.1.1.3.3.2.2.cmml" xref="S3.E18.m1.5.5.1.1.3.3.2.2"><ci id="S3.E18.m1.5.5.1.1.3.3.2.2.1.cmml" xref="S3.E18.m1.5.5.1.1.3.3.2.2.1">~</ci><ci id="S3.E18.m1.5.5.1.1.3.3.2.2.2.cmml" xref="S3.E18.m1.5.5.1.1.3.3.2.2.2">𝐦</ci></apply><list id="S3.E18.m1.4.4.2.3.cmml" xref="S3.E18.m1.4.4.2.4"><ci id="S3.E18.m1.3.3.1.1.cmml" xref="S3.E18.m1.3.3.1.1">𝑘</ci><ci id="S3.E18.m1.4.4.2.2.cmml" xref="S3.E18.m1.4.4.2.2">𝑖</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.5c">\displaystyle\pi(\{\mathbf{\tilde{m}}_{k,i}\}_{k=1}^{K})=\frac{1}{K}\sum_{k}%
\mathbf{\tilde{m}}_{k,i}.</annotation><annotation encoding="application/x-llamapun" id="S3.E18.m1.5d">italic_π ( { over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ) = divide start_ARG 1 end_ARG start_ARG italic_K end_ARG ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS3.p3">
<p class="ltx_p" id="S3.SS3.SSS3.p3.6"><span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p3.6.1">Causal Feature Distillation. </span> Besides the vanilla feature distillation, we propose an optional causal feature distillation to handle some confounders <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.1.m1.1"><semantics id="S3.SS3.SSS3.p3.1.m1.1a"><mi id="S3.SS3.SSS3.p3.1.m1.1.1" xref="S3.SS3.SSS3.p3.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.1.m1.1b"><ci id="S3.SS3.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.1.m1.1d">italic_Z</annotation></semantics></math> of interest that can be observed in recommender systems with back-door adjustment (<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS3.p3.6.2">c.f.</span> Section <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.SS1" title="2.1 Back-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">2.1</span></a>). First, we can split the data <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS3.p3.6.3">w</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS3.p3.6.4">r</span>.<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS3.p3.6.5">t</span>. different confounder values. By taking user activeness as an example, we can count the number of interactions and accordingly split users into several groups. Since data samples in the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.2.m2.1"><semantics id="S3.SS3.SSS3.p3.2.m2.1a"><mi id="S3.SS3.SSS3.p3.2.m2.1.1" xref="S3.SS3.SSS3.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.2.m2.1b"><ci id="S3.SS3.SSS3.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.2.m2.1d">italic_k</annotation></semantics></math>-th group are selected when the confounder variable is set to a particular value <math alttext="Z=z_{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.3.m3.1"><semantics id="S3.SS3.SSS3.p3.3.m3.1a"><mrow id="S3.SS3.SSS3.p3.3.m3.1.1" xref="S3.SS3.SSS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p3.3.m3.1.1.2" xref="S3.SS3.SSS3.p3.3.m3.1.1.2.cmml">Z</mi><mo id="S3.SS3.SSS3.p3.3.m3.1.1.1" xref="S3.SS3.SSS3.p3.3.m3.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS3.p3.3.m3.1.1.3" xref="S3.SS3.SSS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS3.p3.3.m3.1.1.3.2" xref="S3.SS3.SSS3.p3.3.m3.1.1.3.2.cmml">z</mi><mi id="S3.SS3.SSS3.p3.3.m3.1.1.3.3" xref="S3.SS3.SSS3.p3.3.m3.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.3.m3.1b"><apply id="S3.SS3.SSS3.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1"><eq id="S3.SS3.SSS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.1"></eq><ci id="S3.SS3.SSS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.2">𝑍</ci><apply id="S3.SS3.SSS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.3.2">𝑧</ci><ci id="S3.SS3.SSS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS3.p3.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.3.m3.1c">Z=z_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.3.m3.1d">italic_Z = italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, the parameters of the corresponding models learn the knowledge under <math alttext="Z=z_{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.4.m4.1"><semantics id="S3.SS3.SSS3.p3.4.m4.1a"><mrow id="S3.SS3.SSS3.p3.4.m4.1.1" xref="S3.SS3.SSS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.SSS3.p3.4.m4.1.1.2" xref="S3.SS3.SSS3.p3.4.m4.1.1.2.cmml">Z</mi><mo id="S3.SS3.SSS3.p3.4.m4.1.1.1" xref="S3.SS3.SSS3.p3.4.m4.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS3.p3.4.m4.1.1.3" xref="S3.SS3.SSS3.p3.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS3.p3.4.m4.1.1.3.2" xref="S3.SS3.SSS3.p3.4.m4.1.1.3.2.cmml">z</mi><mi id="S3.SS3.SSS3.p3.4.m4.1.1.3.3" xref="S3.SS3.SSS3.p3.4.m4.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.4.m4.1b"><apply id="S3.SS3.SSS3.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.1"><eq id="S3.SS3.SSS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.1.1"></eq><ci id="S3.SS3.SSS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.1.2">𝑍</ci><apply id="S3.SS3.SSS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p3.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.1.3.2">𝑧</ci><ci id="S3.SS3.SSS3.p3.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS3.p3.4.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.4.m4.1c">Z=z_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.4.m4.1d">italic_Z = italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. Then, teachers can be regarded as the estimators <math alttext="P(M\mid X,Z=z_{k})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.5.m5.3"><semantics id="S3.SS3.SSS3.p3.5.m5.3a"><mrow id="S3.SS3.SSS3.p3.5.m5.3.3" xref="S3.SS3.SSS3.p3.5.m5.3.3.cmml"><mi id="S3.SS3.SSS3.p3.5.m5.3.3.3" xref="S3.SS3.SSS3.p3.5.m5.3.3.3.cmml">P</mi><mo id="S3.SS3.SSS3.p3.5.m5.3.3.2" xref="S3.SS3.SSS3.p3.5.m5.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p3.5.m5.3.3.1.1" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.cmml"><mo id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.cmml"><mrow id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.cmml"><mi id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.2" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.2.cmml">M</mi><mo id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.1" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.1.cmml">∣</mo><mrow id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.3.2" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.3.1.cmml"><mi id="S3.SS3.SSS3.p3.5.m5.1.1" xref="S3.SS3.SSS3.p3.5.m5.1.1.cmml">X</mi><mo id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.3.2.1" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS3.p3.5.m5.2.2" xref="S3.SS3.SSS3.p3.5.m5.2.2.cmml">Z</mi></mrow></mrow><mo id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.1" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.2" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.2.cmml">z</mi><mi id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.3" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.5.m5.3b"><apply id="S3.SS3.SSS3.p3.5.m5.3.3.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3"><times id="S3.SS3.SSS3.p3.5.m5.3.3.2.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.2"></times><ci id="S3.SS3.SSS3.p3.5.m5.3.3.3.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.3">𝑃</ci><apply id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1"><eq id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.1"></eq><apply id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.1">conditional</csymbol><ci id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.2">𝑀</ci><list id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.2.3.2"><ci id="S3.SS3.SSS3.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.1.1">𝑋</ci><ci id="S3.SS3.SSS3.p3.5.m5.2.2.cmml" xref="S3.SS3.SSS3.p3.5.m5.2.2">𝑍</ci></list></apply><apply id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.2">𝑧</ci><ci id="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p3.5.m5.3.3.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.5.m5.3c">P(M\mid X,Z=z_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.5.m5.3d">italic_P ( italic_M ∣ italic_X , italic_Z = italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>, and together approximate <math alttext="P(M\mid do(X))" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.6.m6.2"><semantics id="S3.SS3.SSS3.p3.6.m6.2a"><mrow id="S3.SS3.SSS3.p3.6.m6.2.2" xref="S3.SS3.SSS3.p3.6.m6.2.2.cmml"><mi id="S3.SS3.SSS3.p3.6.m6.2.2.3" xref="S3.SS3.SSS3.p3.6.m6.2.2.3.cmml">P</mi><mo id="S3.SS3.SSS3.p3.6.m6.2.2.2" xref="S3.SS3.SSS3.p3.6.m6.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p3.6.m6.2.2.1.1" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.cmml"><mo id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.2" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.2.cmml">M</mi><mo id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.1" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.1.cmml">∣</mo><mrow id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.2" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.2.cmml">d</mi><mo id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.1" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.3" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.3.cmml">o</mi><mo id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.1a" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.4.2" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.cmml"><mo id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.4.2.1" stretchy="false" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.cmml">(</mo><mi id="S3.SS3.SSS3.p3.6.m6.1.1" xref="S3.SS3.SSS3.p3.6.m6.1.1.cmml">X</mi><mo id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.4.2.2" stretchy="false" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.6.m6.2b"><apply id="S3.SS3.SSS3.p3.6.m6.2.2.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2"><times id="S3.SS3.SSS3.p3.6.m6.2.2.2.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.2"></times><ci id="S3.SS3.SSS3.p3.6.m6.2.2.3.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.3">𝑃</ci><apply id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.2">𝑀</ci><apply id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3"><times id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.1"></times><ci id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.2">𝑑</ci><ci id="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p3.6.m6.2.2.1.1.1.3.3">𝑜</ci><ci id="S3.SS3.SSS3.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p3.6.m6.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.6.m6.2c">P(M\mid do(X))</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.6.m6.2d">italic_P ( italic_M ∣ italic_d italic_o ( italic_X ) )</annotation></semantics></math> as the weighted sum of the estimation of different models according to Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E2" title="In 2.1 Back-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">2</span></a>). Formally, we have:
</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx16">
<tbody id="S3.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{\tilde{m}}^{\circ}_{i}=\mathbb{E}_{z_{k}}\left[\phi_{k}(x%
_{i})\right]=\sum_{k}\mathbf{\tilde{m}}_{k,i}P(z_{k})." class="ltx_Math" display="inline" id="S3.E19.m1.3"><semantics id="S3.E19.m1.3a"><mrow id="S3.E19.m1.3.3.1" xref="S3.E19.m1.3.3.1.1.cmml"><mrow id="S3.E19.m1.3.3.1.1" xref="S3.E19.m1.3.3.1.1.cmml"><msubsup id="S3.E19.m1.3.3.1.1.4" xref="S3.E19.m1.3.3.1.1.4.cmml"><mover accent="true" id="S3.E19.m1.3.3.1.1.4.2.2" xref="S3.E19.m1.3.3.1.1.4.2.2.cmml"><mi id="S3.E19.m1.3.3.1.1.4.2.2.2" xref="S3.E19.m1.3.3.1.1.4.2.2.2.cmml">𝐦</mi><mo id="S3.E19.m1.3.3.1.1.4.2.2.1" xref="S3.E19.m1.3.3.1.1.4.2.2.1.cmml">~</mo></mover><mi id="S3.E19.m1.3.3.1.1.4.3" xref="S3.E19.m1.3.3.1.1.4.3.cmml">i</mi><mo id="S3.E19.m1.3.3.1.1.4.2.3" xref="S3.E19.m1.3.3.1.1.4.2.3.cmml">∘</mo></msubsup><mo id="S3.E19.m1.3.3.1.1.5" xref="S3.E19.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E19.m1.3.3.1.1.1" xref="S3.E19.m1.3.3.1.1.1.cmml"><msub id="S3.E19.m1.3.3.1.1.1.3" xref="S3.E19.m1.3.3.1.1.1.3.cmml"><mi id="S3.E19.m1.3.3.1.1.1.3.2" xref="S3.E19.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><msub id="S3.E19.m1.3.3.1.1.1.3.3" xref="S3.E19.m1.3.3.1.1.1.3.3.cmml"><mi id="S3.E19.m1.3.3.1.1.1.3.3.2" xref="S3.E19.m1.3.3.1.1.1.3.3.2.cmml">z</mi><mi id="S3.E19.m1.3.3.1.1.1.3.3.3" xref="S3.E19.m1.3.3.1.1.1.3.3.3.cmml">k</mi></msub></msub><mo id="S3.E19.m1.3.3.1.1.1.2" xref="S3.E19.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E19.m1.3.3.1.1.1.1.1" xref="S3.E19.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E19.m1.3.3.1.1.1.1.1.2" xref="S3.E19.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E19.m1.3.3.1.1.1.1.1.1" xref="S3.E19.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E19.m1.3.3.1.1.1.1.1.1.3" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E19.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S3.E19.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E19.m1.3.3.1.1.1.1.1.1.2" xref="S3.E19.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2" mathcolor="#000000" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E19.m1.3.3.1.1.1.1.1.3" xref="S3.E19.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E19.m1.3.3.1.1.6" xref="S3.E19.m1.3.3.1.1.6.cmml">=</mo><mrow id="S3.E19.m1.3.3.1.1.2" xref="S3.E19.m1.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E19.m1.3.3.1.1.2.2" xref="S3.E19.m1.3.3.1.1.2.2.cmml"><munder id="S3.E19.m1.3.3.1.1.2.2a" xref="S3.E19.m1.3.3.1.1.2.2.cmml"><mo id="S3.E19.m1.3.3.1.1.2.2.2" movablelimits="false" xref="S3.E19.m1.3.3.1.1.2.2.2.cmml">∑</mo><mi id="S3.E19.m1.3.3.1.1.2.2.3" xref="S3.E19.m1.3.3.1.1.2.2.3.cmml">k</mi></munder></mstyle><mrow id="S3.E19.m1.3.3.1.1.2.1" xref="S3.E19.m1.3.3.1.1.2.1.cmml"><msub id="S3.E19.m1.3.3.1.1.2.1.3" xref="S3.E19.m1.3.3.1.1.2.1.3.cmml"><mover accent="true" id="S3.E19.m1.3.3.1.1.2.1.3.2" xref="S3.E19.m1.3.3.1.1.2.1.3.2.cmml"><mi id="S3.E19.m1.3.3.1.1.2.1.3.2.2" xref="S3.E19.m1.3.3.1.1.2.1.3.2.2.cmml">𝐦</mi><mo id="S3.E19.m1.3.3.1.1.2.1.3.2.1" xref="S3.E19.m1.3.3.1.1.2.1.3.2.1.cmml">~</mo></mover><mrow id="S3.E19.m1.2.2.2.4" xref="S3.E19.m1.2.2.2.3.cmml"><mi id="S3.E19.m1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.cmml">k</mi><mo id="S3.E19.m1.2.2.2.4.1" xref="S3.E19.m1.2.2.2.3.cmml">,</mo><mi id="S3.E19.m1.2.2.2.2" xref="S3.E19.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E19.m1.3.3.1.1.2.1.2" xref="S3.E19.m1.3.3.1.1.2.1.2.cmml">⁢</mo><mi id="S3.E19.m1.3.3.1.1.2.1.4" mathcolor="#000000" xref="S3.E19.m1.3.3.1.1.2.1.4.cmml">P</mi><mo id="S3.E19.m1.3.3.1.1.2.1.2a" xref="S3.E19.m1.3.3.1.1.2.1.2.cmml">⁢</mo><mrow id="S3.E19.m1.3.3.1.1.2.1.1.1" xref="S3.E19.m1.3.3.1.1.2.1.1.1.1.cmml"><mo id="S3.E19.m1.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S3.E19.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><msub id="S3.E19.m1.3.3.1.1.2.1.1.1.1" xref="S3.E19.m1.3.3.1.1.2.1.1.1.1.cmml"><mi id="S3.E19.m1.3.3.1.1.2.1.1.1.1.2" mathcolor="#000000" xref="S3.E19.m1.3.3.1.1.2.1.1.1.1.2.cmml">z</mi><mi id="S3.E19.m1.3.3.1.1.2.1.1.1.1.3" xref="S3.E19.m1.3.3.1.1.2.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E19.m1.3.3.1.1.2.1.1.1.3" stretchy="false" xref="S3.E19.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E19.m1.3.3.1.2" lspace="0em" xref="S3.E19.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E19.m1.3b"><apply id="S3.E19.m1.3.3.1.1.cmml" xref="S3.E19.m1.3.3.1"><and id="S3.E19.m1.3.3.1.1a.cmml" xref="S3.E19.m1.3.3.1"></and><apply id="S3.E19.m1.3.3.1.1b.cmml" xref="S3.E19.m1.3.3.1"><eq id="S3.E19.m1.3.3.1.1.5.cmml" xref="S3.E19.m1.3.3.1.1.5"></eq><apply id="S3.E19.m1.3.3.1.1.4.cmml" xref="S3.E19.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.4.1.cmml" xref="S3.E19.m1.3.3.1.1.4">subscript</csymbol><apply id="S3.E19.m1.3.3.1.1.4.2.cmml" xref="S3.E19.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.4.2.1.cmml" xref="S3.E19.m1.3.3.1.1.4">superscript</csymbol><apply id="S3.E19.m1.3.3.1.1.4.2.2.cmml" xref="S3.E19.m1.3.3.1.1.4.2.2"><ci id="S3.E19.m1.3.3.1.1.4.2.2.1.cmml" xref="S3.E19.m1.3.3.1.1.4.2.2.1">~</ci><ci id="S3.E19.m1.3.3.1.1.4.2.2.2.cmml" xref="S3.E19.m1.3.3.1.1.4.2.2.2">𝐦</ci></apply><compose id="S3.E19.m1.3.3.1.1.4.2.3.cmml" xref="S3.E19.m1.3.3.1.1.4.2.3"></compose></apply><ci id="S3.E19.m1.3.3.1.1.4.3.cmml" xref="S3.E19.m1.3.3.1.1.4.3">𝑖</ci></apply><apply id="S3.E19.m1.3.3.1.1.1.cmml" xref="S3.E19.m1.3.3.1.1.1"><times id="S3.E19.m1.3.3.1.1.1.2.cmml" xref="S3.E19.m1.3.3.1.1.1.2"></times><apply id="S3.E19.m1.3.3.1.1.1.3.cmml" xref="S3.E19.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.1.3.1.cmml" xref="S3.E19.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E19.m1.3.3.1.1.1.3.2.cmml" xref="S3.E19.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="S3.E19.m1.3.3.1.1.1.3.3.cmml" xref="S3.E19.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E19.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.E19.m1.3.3.1.1.1.3.3.2.cmml" xref="S3.E19.m1.3.3.1.1.1.3.3.2">𝑧</ci><ci id="S3.E19.m1.3.3.1.1.1.3.3.3.cmml" xref="S3.E19.m1.3.3.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.E19.m1.3.3.1.1.1.1.2.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E19.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E19.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1"><times id="S3.E19.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S3.E19.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E19.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.E19.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.E19.m1.3.3.1.1c.cmml" xref="S3.E19.m1.3.3.1"><eq id="S3.E19.m1.3.3.1.1.6.cmml" xref="S3.E19.m1.3.3.1.1.6"></eq><share href="https://arxiv.org/html/2405.20626v1#S3.E19.m1.3.3.1.1.1.cmml" id="S3.E19.m1.3.3.1.1d.cmml" xref="S3.E19.m1.3.3.1"></share><apply id="S3.E19.m1.3.3.1.1.2.cmml" xref="S3.E19.m1.3.3.1.1.2"><apply id="S3.E19.m1.3.3.1.1.2.2.cmml" xref="S3.E19.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.2.2.1.cmml" xref="S3.E19.m1.3.3.1.1.2.2">subscript</csymbol><sum id="S3.E19.m1.3.3.1.1.2.2.2.cmml" xref="S3.E19.m1.3.3.1.1.2.2.2"></sum><ci id="S3.E19.m1.3.3.1.1.2.2.3.cmml" xref="S3.E19.m1.3.3.1.1.2.2.3">𝑘</ci></apply><apply id="S3.E19.m1.3.3.1.1.2.1.cmml" xref="S3.E19.m1.3.3.1.1.2.1"><times id="S3.E19.m1.3.3.1.1.2.1.2.cmml" xref="S3.E19.m1.3.3.1.1.2.1.2"></times><apply id="S3.E19.m1.3.3.1.1.2.1.3.cmml" xref="S3.E19.m1.3.3.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.2.1.3.1.cmml" xref="S3.E19.m1.3.3.1.1.2.1.3">subscript</csymbol><apply id="S3.E19.m1.3.3.1.1.2.1.3.2.cmml" xref="S3.E19.m1.3.3.1.1.2.1.3.2"><ci id="S3.E19.m1.3.3.1.1.2.1.3.2.1.cmml" xref="S3.E19.m1.3.3.1.1.2.1.3.2.1">~</ci><ci id="S3.E19.m1.3.3.1.1.2.1.3.2.2.cmml" xref="S3.E19.m1.3.3.1.1.2.1.3.2.2">𝐦</ci></apply><list id="S3.E19.m1.2.2.2.3.cmml" xref="S3.E19.m1.2.2.2.4"><ci id="S3.E19.m1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1">𝑘</ci><ci id="S3.E19.m1.2.2.2.2.cmml" xref="S3.E19.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S3.E19.m1.3.3.1.1.2.1.4.cmml" xref="S3.E19.m1.3.3.1.1.2.1.4">𝑃</ci><apply id="S3.E19.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E19.m1.3.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E19.m1.3.3.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E19.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S3.E19.m1.3.3.1.1.2.1.1.1.1.2">𝑧</ci><ci id="S3.E19.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S3.E19.m1.3.3.1.1.2.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E19.m1.3c">\displaystyle\mathbf{\tilde{m}}^{\circ}_{i}=\mathbb{E}_{z_{k}}\left[\phi_{k}(x%
_{i})\right]=\sum_{k}\mathbf{\tilde{m}}_{k,i}P(z_{k}).</annotation><annotation encoding="application/x-llamapun" id="S3.E19.m1.3d">over~ start_ARG bold_m end_ARG start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] = ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_k , italic_i end_POSTSUBSCRIPT italic_P ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p3.9">We set <math alttext="P(z_{k})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.7.m1.1"><semantics id="S3.SS3.SSS3.p3.7.m1.1a"><mrow id="S3.SS3.SSS3.p3.7.m1.1.1" xref="S3.SS3.SSS3.p3.7.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p3.7.m1.1.1.3" xref="S3.SS3.SSS3.p3.7.m1.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS3.p3.7.m1.1.1.2" xref="S3.SS3.SSS3.p3.7.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p3.7.m1.1.1.1.1" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.2" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.7.m1.1b"><apply id="S3.SS3.SSS3.p3.7.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1"><times id="S3.SS3.SSS3.p3.7.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1.2"></times><ci id="S3.SS3.SSS3.p3.7.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1.3">𝑃</ci><apply id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p3.7.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.7.m1.1c">P(z_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.7.m1.1d">italic_P ( italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> to be proportional to the number of users of the group where <math alttext="\phi_{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.8.m2.1"><semantics id="S3.SS3.SSS3.p3.8.m2.1a"><msub id="S3.SS3.SSS3.p3.8.m2.1.1" xref="S3.SS3.SSS3.p3.8.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p3.8.m2.1.1.2" xref="S3.SS3.SSS3.p3.8.m2.1.1.2.cmml">ϕ</mi><mi id="S3.SS3.SSS3.p3.8.m2.1.1.3" xref="S3.SS3.SSS3.p3.8.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.8.m2.1b"><apply id="S3.SS3.SSS3.p3.8.m2.1.1.cmml" xref="S3.SS3.SSS3.p3.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.8.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p3.8.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p3.8.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p3.8.m2.1.1.2">italic-ϕ</ci><ci id="S3.SS3.SSS3.p3.8.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p3.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.8.m2.1c">\phi_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.8.m2.1d">italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is trained.
We take <math alttext="\mathbf{\tilde{m}}_{i}^{\circ}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.9.m3.1"><semantics id="S3.SS3.SSS3.p3.9.m3.1a"><msubsup id="S3.SS3.SSS3.p3.9.m3.1.1" xref="S3.SS3.SSS3.p3.9.m3.1.1.cmml"><mover accent="true" id="S3.SS3.SSS3.p3.9.m3.1.1.2.2" xref="S3.SS3.SSS3.p3.9.m3.1.1.2.2.cmml"><mi id="S3.SS3.SSS3.p3.9.m3.1.1.2.2.2" xref="S3.SS3.SSS3.p3.9.m3.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS3.p3.9.m3.1.1.2.2.1" xref="S3.SS3.SSS3.p3.9.m3.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS3.p3.9.m3.1.1.2.3" xref="S3.SS3.SSS3.p3.9.m3.1.1.2.3.cmml">i</mi><mo id="S3.SS3.SSS3.p3.9.m3.1.1.3" xref="S3.SS3.SSS3.p3.9.m3.1.1.3.cmml">∘</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.9.m3.1b"><apply id="S3.SS3.SSS3.p3.9.m3.1.1.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.9.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p3.9.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.9.m3.1.1.2.1.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p3.9.m3.1.1.2.2.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1.2.2"><ci id="S3.SS3.SSS3.p3.9.m3.1.1.2.2.1.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1.2.2.1">~</ci><ci id="S3.SS3.SSS3.p3.9.m3.1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1.2.2.2">𝐦</ci></apply><ci id="S3.SS3.SSS3.p3.9.m3.1.1.2.3.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1.2.3">𝑖</ci></apply><compose id="S3.SS3.SSS3.p3.9.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p3.9.m3.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.9.m3.1c">\mathbf{\tilde{m}}_{i}^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.9.m3.1d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math> as the <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p3.9.1">causal feature guidance</span> for training the student as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx17">
<tbody id="S3.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{BDA}=\sum_{i}d(\mathbf{\tilde{m}}^{\circ}_{i},%
\mathbf{\hat{m}}_{i})." class="ltx_Math" display="inline" id="S3.E20.m1.1"><semantics id="S3.E20.m1.1a"><mrow id="S3.E20.m1.1.1.1" xref="S3.E20.m1.1.1.1.1.cmml"><mrow id="S3.E20.m1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.cmml"><msub id="S3.E20.m1.1.1.1.1.4" xref="S3.E20.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E20.m1.1.1.1.1.4.2" xref="S3.E20.m1.1.1.1.1.4.2.cmml">ℒ</mi><mrow id="S3.E20.m1.1.1.1.1.4.3" xref="S3.E20.m1.1.1.1.1.4.3.cmml"><mi id="S3.E20.m1.1.1.1.1.4.3.2" xref="S3.E20.m1.1.1.1.1.4.3.2.cmml">B</mi><mo id="S3.E20.m1.1.1.1.1.4.3.1" xref="S3.E20.m1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E20.m1.1.1.1.1.4.3.3" xref="S3.E20.m1.1.1.1.1.4.3.3.cmml">D</mi><mo id="S3.E20.m1.1.1.1.1.4.3.1a" xref="S3.E20.m1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E20.m1.1.1.1.1.4.3.4" xref="S3.E20.m1.1.1.1.1.4.3.4.cmml">A</mi></mrow></msub><mo id="S3.E20.m1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E20.m1.1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E20.m1.1.1.1.1.2.3" xref="S3.E20.m1.1.1.1.1.2.3.cmml"><munder id="S3.E20.m1.1.1.1.1.2.3a" xref="S3.E20.m1.1.1.1.1.2.3.cmml"><mo id="S3.E20.m1.1.1.1.1.2.3.2" movablelimits="false" xref="S3.E20.m1.1.1.1.1.2.3.2.cmml">∑</mo><mi id="S3.E20.m1.1.1.1.1.2.3.3" xref="S3.E20.m1.1.1.1.1.2.3.3.cmml">i</mi></munder></mstyle><mrow id="S3.E20.m1.1.1.1.1.2.2" xref="S3.E20.m1.1.1.1.1.2.2.cmml"><mi id="S3.E20.m1.1.1.1.1.2.2.4" mathcolor="#000000" xref="S3.E20.m1.1.1.1.1.2.2.4.cmml">d</mi><mo id="S3.E20.m1.1.1.1.1.2.2.3" xref="S3.E20.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E20.m1.1.1.1.1.2.2.2.2" xref="S3.E20.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E20.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S3.E20.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E20.m1.1.1.1.1.1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mo id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">∘</mo></msubsup><mo id="S3.E20.m1.1.1.1.1.2.2.2.2.4" xref="S3.E20.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="S3.E20.m1.1.1.1.1.2.2.2.2.2" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="S3.E20.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝐦</mi><mo id="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.1" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E20.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E20.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S3.E20.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E20.m1.1.1.1.2" lspace="0em" xref="S3.E20.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E20.m1.1b"><apply id="S3.E20.m1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1"><eq id="S3.E20.m1.1.1.1.1.3.cmml" xref="S3.E20.m1.1.1.1.1.3"></eq><apply id="S3.E20.m1.1.1.1.1.4.cmml" xref="S3.E20.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.4.1.cmml" xref="S3.E20.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E20.m1.1.1.1.1.4.2.cmml" xref="S3.E20.m1.1.1.1.1.4.2">ℒ</ci><apply id="S3.E20.m1.1.1.1.1.4.3.cmml" xref="S3.E20.m1.1.1.1.1.4.3"><times id="S3.E20.m1.1.1.1.1.4.3.1.cmml" xref="S3.E20.m1.1.1.1.1.4.3.1"></times><ci id="S3.E20.m1.1.1.1.1.4.3.2.cmml" xref="S3.E20.m1.1.1.1.1.4.3.2">𝐵</ci><ci id="S3.E20.m1.1.1.1.1.4.3.3.cmml" xref="S3.E20.m1.1.1.1.1.4.3.3">𝐷</ci><ci id="S3.E20.m1.1.1.1.1.4.3.4.cmml" xref="S3.E20.m1.1.1.1.1.4.3.4">𝐴</ci></apply></apply><apply id="S3.E20.m1.1.1.1.1.2.cmml" xref="S3.E20.m1.1.1.1.1.2"><apply id="S3.E20.m1.1.1.1.1.2.3.cmml" xref="S3.E20.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.2.3.1.cmml" xref="S3.E20.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S3.E20.m1.1.1.1.1.2.3.2.cmml" xref="S3.E20.m1.1.1.1.1.2.3.2"></sum><ci id="S3.E20.m1.1.1.1.1.2.3.3.cmml" xref="S3.E20.m1.1.1.1.1.2.3.3">𝑖</ci></apply><apply id="S3.E20.m1.1.1.1.1.2.2.cmml" xref="S3.E20.m1.1.1.1.1.2.2"><times id="S3.E20.m1.1.1.1.1.2.2.3.cmml" xref="S3.E20.m1.1.1.1.1.2.2.3"></times><ci id="S3.E20.m1.1.1.1.1.2.2.4.cmml" xref="S3.E20.m1.1.1.1.1.2.2.4">𝑑</ci><interval closure="open" id="S3.E20.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2"><apply id="S3.E20.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝐦</ci></apply><compose id="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.2.3"></compose></apply><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E20.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.2"><ci id="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.1">^</ci><ci id="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.2.2">𝐦</ci></apply><ci id="S3.E20.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E20.m1.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E20.m1.1c">\displaystyle\mathcal{L}_{BDA}=\sum_{i}d(\mathbf{\tilde{m}}^{\circ}_{i},%
\mathbf{\hat{m}}_{i}).</annotation><annotation encoding="application/x-llamapun" id="S3.E20.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_d ( over~ start_ARG bold_m end_ARG start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p3.14">This modeling can better satisfy Requirement (ii) in FDA by actively blocking back-door paths from <math alttext="X" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.10.m1.1"><semantics id="S3.SS3.SSS3.p3.10.m1.1a"><mi id="S3.SS3.SSS3.p3.10.m1.1.1" xref="S3.SS3.SSS3.p3.10.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.10.m1.1b"><ci id="S3.SS3.SSS3.p3.10.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.10.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.10.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.10.m1.1d">italic_X</annotation></semantics></math> to <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.11.m2.1"><semantics id="S3.SS3.SSS3.p3.11.m2.1a"><mi id="S3.SS3.SSS3.p3.11.m2.1.1" xref="S3.SS3.SSS3.p3.11.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.11.m2.1b"><ci id="S3.SS3.SSS3.p3.11.m2.1.1.cmml" xref="S3.SS3.SSS3.p3.11.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.11.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.11.m2.1d">italic_M</annotation></semantics></math>, to meet the complex environments in real-world recommender systems.
We also replace the average mediator feature <math alttext="\mathbf{\tilde{m}}_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.12.m3.1"><semantics id="S3.SS3.SSS3.p3.12.m3.1a"><msub id="S3.SS3.SSS3.p3.12.m3.1.1" xref="S3.SS3.SSS3.p3.12.m3.1.1.cmml"><mover accent="true" id="S3.SS3.SSS3.p3.12.m3.1.1.2" xref="S3.SS3.SSS3.p3.12.m3.1.1.2.cmml"><mi id="S3.SS3.SSS3.p3.12.m3.1.1.2.2" xref="S3.SS3.SSS3.p3.12.m3.1.1.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS3.p3.12.m3.1.1.2.1" xref="S3.SS3.SSS3.p3.12.m3.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS3.p3.12.m3.1.1.3" xref="S3.SS3.SSS3.p3.12.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.12.m3.1b"><apply id="S3.SS3.SSS3.p3.12.m3.1.1.cmml" xref="S3.SS3.SSS3.p3.12.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.12.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p3.12.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p3.12.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p3.12.m3.1.1.2"><ci id="S3.SS3.SSS3.p3.12.m3.1.1.2.1.cmml" xref="S3.SS3.SSS3.p3.12.m3.1.1.2.1">~</ci><ci id="S3.SS3.SSS3.p3.12.m3.1.1.2.2.cmml" xref="S3.SS3.SSS3.p3.12.m3.1.1.2.2">𝐦</ci></apply><ci id="S3.SS3.SSS3.p3.12.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p3.12.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.12.m3.1c">\mathbf{\tilde{m}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.12.m3.1d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E13" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">13</span></a>) - (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E14" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">14</span></a>) with <math alttext="\mathbf{\tilde{m}}^{\circ}_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.13.m4.1"><semantics id="S3.SS3.SSS3.p3.13.m4.1a"><msubsup id="S3.SS3.SSS3.p3.13.m4.1.1" xref="S3.SS3.SSS3.p3.13.m4.1.1.cmml"><mover accent="true" id="S3.SS3.SSS3.p3.13.m4.1.1.2.2" xref="S3.SS3.SSS3.p3.13.m4.1.1.2.2.cmml"><mi id="S3.SS3.SSS3.p3.13.m4.1.1.2.2.2" xref="S3.SS3.SSS3.p3.13.m4.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS3.p3.13.m4.1.1.2.2.1" xref="S3.SS3.SSS3.p3.13.m4.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS3.p3.13.m4.1.1.3" xref="S3.SS3.SSS3.p3.13.m4.1.1.3.cmml">j</mi><mo id="S3.SS3.SSS3.p3.13.m4.1.1.2.3" xref="S3.SS3.SSS3.p3.13.m4.1.1.2.3.cmml">∘</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.13.m4.1b"><apply id="S3.SS3.SSS3.p3.13.m4.1.1.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.13.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p3.13.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.13.m4.1.1.2.1.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p3.13.m4.1.1.2.2.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1.2.2"><ci id="S3.SS3.SSS3.p3.13.m4.1.1.2.2.1.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1.2.2.1">~</ci><ci id="S3.SS3.SSS3.p3.13.m4.1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1.2.2.2">𝐦</ci></apply><compose id="S3.SS3.SSS3.p3.13.m4.1.1.2.3.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1.2.3"></compose></apply><ci id="S3.SS3.SSS3.p3.13.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p3.13.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.13.m4.1c">\mathbf{\tilde{m}}^{\circ}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.13.m4.1d">over~ start_ARG bold_m end_ARG start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to improve deconfounding since <math alttext="\mathbf{\tilde{m}}^{\circ}_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.14.m5.1"><semantics id="S3.SS3.SSS3.p3.14.m5.1a"><msubsup id="S3.SS3.SSS3.p3.14.m5.1.1" xref="S3.SS3.SSS3.p3.14.m5.1.1.cmml"><mover accent="true" id="S3.SS3.SSS3.p3.14.m5.1.1.2.2" xref="S3.SS3.SSS3.p3.14.m5.1.1.2.2.cmml"><mi id="S3.SS3.SSS3.p3.14.m5.1.1.2.2.2" xref="S3.SS3.SSS3.p3.14.m5.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.SS3.SSS3.p3.14.m5.1.1.2.2.1" xref="S3.SS3.SSS3.p3.14.m5.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS3.p3.14.m5.1.1.3" xref="S3.SS3.SSS3.p3.14.m5.1.1.3.cmml">j</mi><mo id="S3.SS3.SSS3.p3.14.m5.1.1.2.3" xref="S3.SS3.SSS3.p3.14.m5.1.1.2.3.cmml">∘</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.14.m5.1b"><apply id="S3.SS3.SSS3.p3.14.m5.1.1.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.14.m5.1.1.1.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p3.14.m5.1.1.2.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p3.14.m5.1.1.2.1.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p3.14.m5.1.1.2.2.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1.2.2"><ci id="S3.SS3.SSS3.p3.14.m5.1.1.2.2.1.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1.2.2.1">~</ci><ci id="S3.SS3.SSS3.p3.14.m5.1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1.2.2.2">𝐦</ci></apply><compose id="S3.SS3.SSS3.p3.14.m5.1.1.2.3.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1.2.3"></compose></apply><ci id="S3.SS3.SSS3.p3.14.m5.1.1.3.cmml" xref="S3.SS3.SSS3.p3.14.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.14.m5.1c">\mathbf{\tilde{m}}^{\circ}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.14.m5.1d">over~ start_ARG bold_m end_ARG start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the debiased mediator feature.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span><span class="ltx_text ltx_font_italic" id="S3.SS4.1.1">Model Training</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.11">In summary, we first split the recommendation dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">caligraphic_D</annotation></semantics></math> into non-IID subsets <math alttext="\{\mathcal{D}_{1},\mathcal{D}_{2},\dots,\mathcal{D}_{K}\}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.4"><semantics id="S3.SS4.p1.2.m2.4a"><mrow id="S3.SS4.p1.2.m2.4.4.3" xref="S3.SS4.p1.2.m2.4.4.4.cmml"><mo id="S3.SS4.p1.2.m2.4.4.3.4" stretchy="false" xref="S3.SS4.p1.2.m2.4.4.4.cmml">{</mo><msub id="S3.SS4.p1.2.m2.2.2.1.1" xref="S3.SS4.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.2.2.1.1.2" xref="S3.SS4.p1.2.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.SS4.p1.2.m2.2.2.1.1.3" xref="S3.SS4.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p1.2.m2.4.4.3.5" xref="S3.SS4.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS4.p1.2.m2.3.3.2.2" xref="S3.SS4.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.3.3.2.2.2" xref="S3.SS4.p1.2.m2.3.3.2.2.2.cmml">𝒟</mi><mn id="S3.SS4.p1.2.m2.3.3.2.2.3" xref="S3.SS4.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.p1.2.m2.4.4.3.6" xref="S3.SS4.p1.2.m2.4.4.4.cmml">,</mo><mi id="S3.SS4.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS4.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS4.p1.2.m2.4.4.3.7" xref="S3.SS4.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS4.p1.2.m2.4.4.3.3" xref="S3.SS4.p1.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.4.4.3.3.2" xref="S3.SS4.p1.2.m2.4.4.3.3.2.cmml">𝒟</mi><mi id="S3.SS4.p1.2.m2.4.4.3.3.3" xref="S3.SS4.p1.2.m2.4.4.3.3.3.cmml">K</mi></msub><mo id="S3.SS4.p1.2.m2.4.4.3.8" stretchy="false" xref="S3.SS4.p1.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.4b"><set id="S3.SS4.p1.2.m2.4.4.4.cmml" xref="S3.SS4.p1.2.m2.4.4.3"><apply id="S3.SS4.p1.2.m2.2.2.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.2">𝒟</ci><cn id="S3.SS4.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS4.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS4.p1.2.m2.3.3.2.2.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS4.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2.2">𝒟</ci><cn id="S3.SS4.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.SS4.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">…</ci><apply id="S3.SS4.p1.2.m2.4.4.3.3.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS4.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3.2">𝒟</ci><ci id="S3.SS4.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS4.p1.2.m2.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.4c">\{\mathcal{D}_{1},\mathcal{D}_{2},\dots,\mathcal{D}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.4d">{ caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , caligraphic_D start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> with biased section <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.11.1">w</span>.<span class="ltx_text ltx_font_italic" id="S3.SS4.p1.11.2">r</span>.<span class="ltx_text ltx_font_italic" id="S3.SS4.p1.11.3">t</span>. some user attributes.
If we aim to address the model bias caused by a particular confounder, we can split the data according to the confounder values.
We train one recommendation model per subset as one teacher, and obtain their encoders <math alttext="\{\phi_{1},\phi_{2},\dots,\phi_{K}\}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.4"><semantics id="S3.SS4.p1.3.m3.4a"><mrow id="S3.SS4.p1.3.m3.4.4.3" xref="S3.SS4.p1.3.m3.4.4.4.cmml"><mo id="S3.SS4.p1.3.m3.4.4.3.4" stretchy="false" xref="S3.SS4.p1.3.m3.4.4.4.cmml">{</mo><msub id="S3.SS4.p1.3.m3.2.2.1.1" xref="S3.SS4.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS4.p1.3.m3.2.2.1.1.2" xref="S3.SS4.p1.3.m3.2.2.1.1.2.cmml">ϕ</mi><mn id="S3.SS4.p1.3.m3.2.2.1.1.3" xref="S3.SS4.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p1.3.m3.4.4.3.5" xref="S3.SS4.p1.3.m3.4.4.4.cmml">,</mo><msub id="S3.SS4.p1.3.m3.3.3.2.2" xref="S3.SS4.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS4.p1.3.m3.3.3.2.2.2" xref="S3.SS4.p1.3.m3.3.3.2.2.2.cmml">ϕ</mi><mn id="S3.SS4.p1.3.m3.3.3.2.2.3" xref="S3.SS4.p1.3.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.p1.3.m3.4.4.3.6" xref="S3.SS4.p1.3.m3.4.4.4.cmml">,</mo><mi id="S3.SS4.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS4.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS4.p1.3.m3.4.4.3.7" xref="S3.SS4.p1.3.m3.4.4.4.cmml">,</mo><msub id="S3.SS4.p1.3.m3.4.4.3.3" xref="S3.SS4.p1.3.m3.4.4.3.3.cmml"><mi id="S3.SS4.p1.3.m3.4.4.3.3.2" xref="S3.SS4.p1.3.m3.4.4.3.3.2.cmml">ϕ</mi><mi id="S3.SS4.p1.3.m3.4.4.3.3.3" xref="S3.SS4.p1.3.m3.4.4.3.3.3.cmml">K</mi></msub><mo id="S3.SS4.p1.3.m3.4.4.3.8" stretchy="false" xref="S3.SS4.p1.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.4b"><set id="S3.SS4.p1.3.m3.4.4.4.cmml" xref="S3.SS4.p1.3.m3.4.4.3"><apply id="S3.SS4.p1.3.m3.2.2.1.1.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.2">italic-ϕ</ci><cn id="S3.SS4.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S3.SS4.p1.3.m3.2.2.1.1.3">1</cn></apply><apply id="S3.SS4.p1.3.m3.3.3.2.2.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS4.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.2">italic-ϕ</ci><cn id="S3.SS4.p1.3.m3.3.3.2.2.3.cmml" type="integer" xref="S3.SS4.p1.3.m3.3.3.2.2.3">2</cn></apply><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">…</ci><apply id="S3.SS4.p1.3.m3.4.4.3.3.cmml" xref="S3.SS4.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.4.4.3.3.1.cmml" xref="S3.SS4.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS4.p1.3.m3.4.4.3.3.2.cmml" xref="S3.SS4.p1.3.m3.4.4.3.3.2">italic-ϕ</ci><ci id="S3.SS4.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS4.p1.3.m3.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.4c">\{\phi_{1},\phi_{2},\dots,\phi_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.4d">{ italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_ϕ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math>. Given <math alttext="(x_{i},y_{i},o_{i})" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.3"><semantics id="S3.SS4.p1.4.m4.3a"><mrow id="S3.SS4.p1.4.m4.3.3.3" xref="S3.SS4.p1.4.m4.3.3.4.cmml"><mo id="S3.SS4.p1.4.m4.3.3.3.4" stretchy="false" xref="S3.SS4.p1.4.m4.3.3.4.cmml">(</mo><msub id="S3.SS4.p1.4.m4.1.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.1.1.2" xref="S3.SS4.p1.4.m4.1.1.1.1.2.cmml">x</mi><mi id="S3.SS4.p1.4.m4.1.1.1.1.3" xref="S3.SS4.p1.4.m4.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p1.4.m4.3.3.3.5" xref="S3.SS4.p1.4.m4.3.3.4.cmml">,</mo><msub id="S3.SS4.p1.4.m4.2.2.2.2" xref="S3.SS4.p1.4.m4.2.2.2.2.cmml"><mi id="S3.SS4.p1.4.m4.2.2.2.2.2" xref="S3.SS4.p1.4.m4.2.2.2.2.2.cmml">y</mi><mi id="S3.SS4.p1.4.m4.2.2.2.2.3" xref="S3.SS4.p1.4.m4.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.4.m4.3.3.3.6" xref="S3.SS4.p1.4.m4.3.3.4.cmml">,</mo><msub id="S3.SS4.p1.4.m4.3.3.3.3" xref="S3.SS4.p1.4.m4.3.3.3.3.cmml"><mi id="S3.SS4.p1.4.m4.3.3.3.3.2" xref="S3.SS4.p1.4.m4.3.3.3.3.2.cmml">o</mi><mi id="S3.SS4.p1.4.m4.3.3.3.3.3" xref="S3.SS4.p1.4.m4.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS4.p1.4.m4.3.3.3.7" stretchy="false" xref="S3.SS4.p1.4.m4.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.3b"><vector id="S3.SS4.p1.4.m4.3.3.4.cmml" xref="S3.SS4.p1.4.m4.3.3.3"><apply id="S3.SS4.p1.4.m4.1.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1.2">𝑥</ci><ci id="S3.SS4.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS4.p1.4.m4.2.2.2.2.cmml" xref="S3.SS4.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS4.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS4.p1.4.m4.2.2.2.2.2">𝑦</ci><ci id="S3.SS4.p1.4.m4.2.2.2.2.3.cmml" xref="S3.SS4.p1.4.m4.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS4.p1.4.m4.3.3.3.3.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.3.3.3.3.1.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3">subscript</csymbol><ci id="S3.SS4.p1.4.m4.3.3.3.3.2.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3.2">𝑜</ci><ci id="S3.SS4.p1.4.m4.3.3.3.3.3.cmml" xref="S3.SS4.p1.4.m4.3.3.3.3.3">𝑖</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.3c">(x_{i},y_{i},o_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.3d">( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, we first obtain causal feature guidance <math alttext="\mathbf{\tilde{m}}_{i}^{\circ}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1"><semantics id="S3.SS4.p1.5.m5.1a"><msubsup id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mover accent="true" id="S3.SS4.p1.5.m5.1.1.2.2" xref="S3.SS4.p1.5.m5.1.1.2.2.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2.2.2" xref="S3.SS4.p1.5.m5.1.1.2.2.2.cmml">𝐦</mi><mo id="S3.SS4.p1.5.m5.1.1.2.2.1" xref="S3.SS4.p1.5.m5.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS4.p1.5.m5.1.1.2.3" xref="S3.SS4.p1.5.m5.1.1.2.3.cmml">i</mi><mo id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">∘</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.2.1.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS4.p1.5.m5.1.1.2.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2.2"><ci id="S3.SS4.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS4.p1.5.m5.1.1.2.2.1">~</ci><ci id="S3.SS4.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2.2.2">𝐦</ci></apply><ci id="S3.SS4.p1.5.m5.1.1.2.3.cmml" xref="S3.SS4.p1.5.m5.1.1.2.3">𝑖</ci></apply><compose id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">\mathbf{\tilde{m}}_{i}^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.1d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math> from all teachers with Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E19" title="In 3.3.3 Feature Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">19</span></a>), and the mediator feature <math alttext="\mathbf{\tilde{m}}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m6.1"><semantics id="S3.SS4.p1.6.m6.1a"><msub id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml"><mover accent="true" id="S3.SS4.p1.6.m6.1.1.2" xref="S3.SS4.p1.6.m6.1.1.2.cmml"><mi id="S3.SS4.p1.6.m6.1.1.2.2" xref="S3.SS4.p1.6.m6.1.1.2.2.cmml">𝐦</mi><mo id="S3.SS4.p1.6.m6.1.1.2.1" xref="S3.SS4.p1.6.m6.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS4.p1.6.m6.1.1.3" xref="S3.SS4.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS4.p1.6.m6.1.1.2.cmml" xref="S3.SS4.p1.6.m6.1.1.2"><ci id="S3.SS4.p1.6.m6.1.1.2.1.cmml" xref="S3.SS4.p1.6.m6.1.1.2.1">~</ci><ci id="S3.SS4.p1.6.m6.1.1.2.2.cmml" xref="S3.SS4.p1.6.m6.1.1.2.2">𝐦</ci></apply><ci id="S3.SS4.p1.6.m6.1.1.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">\mathbf{\tilde{m}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m6.1d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> extracted by the student encoder <math alttext="\phi^{*}" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m7.1"><semantics id="S3.SS4.p1.7.m7.1a"><msup id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><mi id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml">ϕ</mi><mo id="S3.SS4.p1.7.m7.1.1.3" xref="S3.SS4.p1.7.m7.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2">italic-ϕ</ci><times id="S3.SS4.p1.7.m7.1.1.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">\phi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m7.1d">italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. As such, the <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.11.4">causal feature distillation</span> loss <math alttext="\mathcal{L}_{BDA}" class="ltx_Math" display="inline" id="S3.SS4.p1.8.m8.1"><semantics id="S3.SS4.p1.8.m8.1a"><msub id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.8.m8.1.1.2" xref="S3.SS4.p1.8.m8.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.8.m8.1.1.3" xref="S3.SS4.p1.8.m8.1.1.3.cmml"><mi id="S3.SS4.p1.8.m8.1.1.3.2" xref="S3.SS4.p1.8.m8.1.1.3.2.cmml">B</mi><mo id="S3.SS4.p1.8.m8.1.1.3.1" xref="S3.SS4.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.8.m8.1.1.3.3" xref="S3.SS4.p1.8.m8.1.1.3.3.cmml">D</mi><mo id="S3.SS4.p1.8.m8.1.1.3.1a" xref="S3.SS4.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.8.m8.1.1.3.4" xref="S3.SS4.p1.8.m8.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m8.1.1.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2">ℒ</ci><apply id="S3.SS4.p1.8.m8.1.1.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3"><times id="S3.SS4.p1.8.m8.1.1.3.1.cmml" xref="S3.SS4.p1.8.m8.1.1.3.1"></times><ci id="S3.SS4.p1.8.m8.1.1.3.2.cmml" xref="S3.SS4.p1.8.m8.1.1.3.2">𝐵</ci><ci id="S3.SS4.p1.8.m8.1.1.3.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3.3">𝐷</ci><ci id="S3.SS4.p1.8.m8.1.1.3.4.cmml" xref="S3.SS4.p1.8.m8.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">\mathcal{L}_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.8.m8.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> is computed with Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E20" title="In 3.3.3 Feature Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">20</span></a>). We then obtain the causal label guidance <math alttext="{\tilde{o}}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.9.m9.1"><semantics id="S3.SS4.p1.9.m9.1a"><msub id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><mover accent="true" id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2.2" xref="S3.SS4.p1.9.m9.1.1.2.2.cmml">o</mi><mo id="S3.SS4.p1.9.m9.1.1.2.1" xref="S3.SS4.p1.9.m9.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">subscript</csymbol><apply id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2"><ci id="S3.SS4.p1.9.m9.1.1.2.1.cmml" xref="S3.SS4.p1.9.m9.1.1.2.1">~</ci><ci id="S3.SS4.p1.9.m9.1.1.2.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2.2">𝑜</ci></apply><ci id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">{\tilde{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.9.m9.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from all teachers with Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E14" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">14</span></a>), and the prediction <math alttext="{\hat{o}}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.10.m10.1"><semantics id="S3.SS4.p1.10.m10.1a"><msub id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml"><mover accent="true" id="S3.SS4.p1.10.m10.1.1.2" xref="S3.SS4.p1.10.m10.1.1.2.cmml"><mi id="S3.SS4.p1.10.m10.1.1.2.2" xref="S3.SS4.p1.10.m10.1.1.2.2.cmml">o</mi><mo id="S3.SS4.p1.10.m10.1.1.2.1" xref="S3.SS4.p1.10.m10.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.10.m10.1.1.3" xref="S3.SS4.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><apply id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">subscript</csymbol><apply id="S3.SS4.p1.10.m10.1.1.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2"><ci id="S3.SS4.p1.10.m10.1.1.2.1.cmml" xref="S3.SS4.p1.10.m10.1.1.2.1">^</ci><ci id="S3.SS4.p1.10.m10.1.1.2.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2.2">𝑜</ci></apply><ci id="S3.SS4.p1.10.m10.1.1.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">{\hat{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.10.m10.1d">over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of the student recommendation model with Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E15" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">15</span></a>). The <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.11.5">label distillation</span> loss and the consistency loss are given in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E16" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">16</span></a>). Besides two distillation losses, we also employ a widely used recommendation objective <math alttext="\mathcal{L}_{Rec}" class="ltx_Math" display="inline" id="S3.SS4.p1.11.m11.1"><semantics id="S3.SS4.p1.11.m11.1a"><msub id="S3.SS4.p1.11.m11.1.1" xref="S3.SS4.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.11.m11.1.1.2" xref="S3.SS4.p1.11.m11.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.11.m11.1.1.3" xref="S3.SS4.p1.11.m11.1.1.3.cmml"><mi id="S3.SS4.p1.11.m11.1.1.3.2" xref="S3.SS4.p1.11.m11.1.1.3.2.cmml">R</mi><mo id="S3.SS4.p1.11.m11.1.1.3.1" xref="S3.SS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m11.1.1.3.3" xref="S3.SS4.p1.11.m11.1.1.3.3.cmml">e</mi><mo id="S3.SS4.p1.11.m11.1.1.3.1a" xref="S3.SS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.11.m11.1.1.3.4" xref="S3.SS4.p1.11.m11.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><apply id="S3.SS4.p1.11.m11.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.2">ℒ</ci><apply id="S3.SS4.p1.11.m11.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3"><times id="S3.SS4.p1.11.m11.1.1.3.1.cmml" xref="S3.SS4.p1.11.m11.1.1.3.1"></times><ci id="S3.SS4.p1.11.m11.1.1.3.2.cmml" xref="S3.SS4.p1.11.m11.1.1.3.2">𝑅</ci><ci id="S3.SS4.p1.11.m11.1.1.3.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3.3">𝑒</ci><ci id="S3.SS4.p1.11.m11.1.1.3.4.cmml" xref="S3.SS4.p1.11.m11.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">\mathcal{L}_{Rec}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.11.m11.1d">caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, such as BPR loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib22" title="">22</a>]</cite> or the sampled softmax loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib23" title="">23</a>]</cite>, to train the student recommendation model, <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.11.6">e</span>.<span class="ltx_text ltx_font_italic" id="S3.SS4.p1.11.7">g</span>.,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx18">
<tbody id="S3.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}%
\mathcal{L}_{Rec}=\sum_{(x_{i},y_{i},o_{i})\in\mathcal{D}}-\ln\sigma\left({%
\hat{o}}_{i}-{o}_{i}\right)+\lambda\|\Theta\|_{2}^{2}," class="ltx_Math" display="inline" id="S3.E21.m1.5"><semantics id="S3.E21.m1.5a"><mrow id="S3.E21.m1.5.5.1" xref="S3.E21.m1.5.5.1.1.cmml"><mrow id="S3.E21.m1.5.5.1.1" xref="S3.E21.m1.5.5.1.1.cmml"><msub id="S3.E21.m1.5.5.1.1.3" xref="S3.E21.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E21.m1.5.5.1.1.3.2" xref="S3.E21.m1.5.5.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E21.m1.5.5.1.1.3.3" xref="S3.E21.m1.5.5.1.1.3.3.cmml"><mi id="S3.E21.m1.5.5.1.1.3.3.2" xref="S3.E21.m1.5.5.1.1.3.3.2.cmml">R</mi><mo id="S3.E21.m1.5.5.1.1.3.3.1" xref="S3.E21.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E21.m1.5.5.1.1.3.3.3" xref="S3.E21.m1.5.5.1.1.3.3.3.cmml">e</mi><mo id="S3.E21.m1.5.5.1.1.3.3.1a" xref="S3.E21.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E21.m1.5.5.1.1.3.3.4" xref="S3.E21.m1.5.5.1.1.3.3.4.cmml">c</mi></mrow></msub><mo id="S3.E21.m1.5.5.1.1.2" xref="S3.E21.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E21.m1.5.5.1.1.1" xref="S3.E21.m1.5.5.1.1.1.cmml"><mrow id="S3.E21.m1.5.5.1.1.1.1" xref="S3.E21.m1.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E21.m1.5.5.1.1.1.1.3" xref="S3.E21.m1.5.5.1.1.1.1.3.cmml"><munder id="S3.E21.m1.5.5.1.1.1.1.3a" xref="S3.E21.m1.5.5.1.1.1.1.3.cmml"><mo id="S3.E21.m1.5.5.1.1.1.1.3.2" movablelimits="false" xref="S3.E21.m1.5.5.1.1.1.1.3.2.cmml">∑</mo><mrow id="S3.E21.m1.3.3.3" xref="S3.E21.m1.3.3.3.cmml"><mrow id="S3.E21.m1.3.3.3.3.3" xref="S3.E21.m1.3.3.3.3.4.cmml"><mo id="S3.E21.m1.3.3.3.3.3.4" stretchy="false" xref="S3.E21.m1.3.3.3.3.4.cmml">(</mo><msub id="S3.E21.m1.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.1.cmml"><mi id="S3.E21.m1.1.1.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E21.m1.1.1.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E21.m1.3.3.3.3.3.5" xref="S3.E21.m1.3.3.3.3.4.cmml">,</mo><msub id="S3.E21.m1.2.2.2.2.2.2" xref="S3.E21.m1.2.2.2.2.2.2.cmml"><mi id="S3.E21.m1.2.2.2.2.2.2.2" xref="S3.E21.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E21.m1.2.2.2.2.2.2.3" xref="S3.E21.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E21.m1.3.3.3.3.3.6" xref="S3.E21.m1.3.3.3.3.4.cmml">,</mo><msub id="S3.E21.m1.3.3.3.3.3.3" xref="S3.E21.m1.3.3.3.3.3.3.cmml"><mi id="S3.E21.m1.3.3.3.3.3.3.2" xref="S3.E21.m1.3.3.3.3.3.3.2.cmml">o</mi><mi id="S3.E21.m1.3.3.3.3.3.3.3" xref="S3.E21.m1.3.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.E21.m1.3.3.3.3.3.7" stretchy="false" xref="S3.E21.m1.3.3.3.3.4.cmml">)</mo></mrow><mo id="S3.E21.m1.3.3.3.4" xref="S3.E21.m1.3.3.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E21.m1.3.3.3.5" mathcolor="#000000" xref="S3.E21.m1.3.3.3.5.cmml">𝒟</mi></mrow></munder></mstyle><mo id="S3.E21.m1.5.5.1.1.1.1.2" xref="S3.E21.m1.5.5.1.1.1.1.2.cmml">−</mo><mrow id="S3.E21.m1.5.5.1.1.1.1.1" xref="S3.E21.m1.5.5.1.1.1.1.1.cmml"><mrow id="S3.E21.m1.5.5.1.1.1.1.1.3" xref="S3.E21.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S3.E21.m1.5.5.1.1.1.1.1.3.1" xref="S3.E21.m1.5.5.1.1.1.1.1.3.1.cmml">ln</mi><mo id="S3.E21.m1.5.5.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E21.m1.5.5.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E21.m1.5.5.1.1.1.1.1.3.2" xref="S3.E21.m1.5.5.1.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E21.m1.5.5.1.1.1.1.1.2" xref="S3.E21.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E21.m1.5.5.1.1.1.1.1.1.1" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E21.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.2" mathcolor="#000000" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml">o</mi><mo id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.3" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.2" mathcolor="#000000" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">o</mi><mi id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.3" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E21.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E21.m1.5.5.1.1.1.2" xref="S3.E21.m1.5.5.1.1.1.2.cmml">+</mo><mrow id="S3.E21.m1.5.5.1.1.1.3" xref="S3.E21.m1.5.5.1.1.1.3.cmml"><mi id="S3.E21.m1.5.5.1.1.1.3.2" xref="S3.E21.m1.5.5.1.1.1.3.2.cmml">λ</mi><mo id="S3.E21.m1.5.5.1.1.1.3.1" xref="S3.E21.m1.5.5.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.E21.m1.5.5.1.1.1.3.3" xref="S3.E21.m1.5.5.1.1.1.3.3.cmml"><mrow id="S3.E21.m1.5.5.1.1.1.3.3.2.2.2" xref="S3.E21.m1.5.5.1.1.1.3.3.2.2.1.cmml"><mo id="S3.E21.m1.5.5.1.1.1.3.3.2.2.2.1" stretchy="false" xref="S3.E21.m1.5.5.1.1.1.3.3.2.2.1.1.cmml">‖</mo><mi id="S3.E21.m1.4.4" mathvariant="normal" xref="S3.E21.m1.4.4.cmml">Θ</mi><mo id="S3.E21.m1.5.5.1.1.1.3.3.2.2.2.2" stretchy="false" xref="S3.E21.m1.5.5.1.1.1.3.3.2.2.1.1.cmml">‖</mo></mrow><mn id="S3.E21.m1.5.5.1.1.1.3.3.2.3" xref="S3.E21.m1.5.5.1.1.1.3.3.2.3.cmml">2</mn><mn id="S3.E21.m1.5.5.1.1.1.3.3.3" xref="S3.E21.m1.5.5.1.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S3.E21.m1.5.5.1.2" xref="S3.E21.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E21.m1.5b"><apply id="S3.E21.m1.5.5.1.1.cmml" xref="S3.E21.m1.5.5.1"><eq id="S3.E21.m1.5.5.1.1.2.cmml" xref="S3.E21.m1.5.5.1.1.2"></eq><apply id="S3.E21.m1.5.5.1.1.3.cmml" xref="S3.E21.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m1.5.5.1.1.3.1.cmml" xref="S3.E21.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E21.m1.5.5.1.1.3.2.cmml" xref="S3.E21.m1.5.5.1.1.3.2">ℒ</ci><apply id="S3.E21.m1.5.5.1.1.3.3.cmml" xref="S3.E21.m1.5.5.1.1.3.3"><times id="S3.E21.m1.5.5.1.1.3.3.1.cmml" xref="S3.E21.m1.5.5.1.1.3.3.1"></times><ci id="S3.E21.m1.5.5.1.1.3.3.2.cmml" xref="S3.E21.m1.5.5.1.1.3.3.2">𝑅</ci><ci id="S3.E21.m1.5.5.1.1.3.3.3.cmml" xref="S3.E21.m1.5.5.1.1.3.3.3">𝑒</ci><ci id="S3.E21.m1.5.5.1.1.3.3.4.cmml" xref="S3.E21.m1.5.5.1.1.3.3.4">𝑐</ci></apply></apply><apply id="S3.E21.m1.5.5.1.1.1.cmml" xref="S3.E21.m1.5.5.1.1.1"><plus id="S3.E21.m1.5.5.1.1.1.2.cmml" xref="S3.E21.m1.5.5.1.1.1.2"></plus><apply id="S3.E21.m1.5.5.1.1.1.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1"><minus id="S3.E21.m1.5.5.1.1.1.1.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.2"></minus><apply id="S3.E21.m1.5.5.1.1.1.1.3.cmml" xref="S3.E21.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.3">subscript</csymbol><sum id="S3.E21.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.3.2"></sum><apply id="S3.E21.m1.3.3.3.cmml" xref="S3.E21.m1.3.3.3"><in id="S3.E21.m1.3.3.3.4.cmml" xref="S3.E21.m1.3.3.3.4"></in><vector id="S3.E21.m1.3.3.3.3.4.cmml" xref="S3.E21.m1.3.3.3.3.3"><apply id="S3.E21.m1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E21.m1.1.1.1.1.1.1.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E21.m1.2.2.2.2.2.2.cmml" xref="S3.E21.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E21.m1.2.2.2.2.2.2.1.cmml" xref="S3.E21.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E21.m1.2.2.2.2.2.2.2.cmml" xref="S3.E21.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E21.m1.2.2.2.2.2.2.3.cmml" xref="S3.E21.m1.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E21.m1.3.3.3.3.3.3.cmml" xref="S3.E21.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E21.m1.3.3.3.3.3.3.1.cmml" xref="S3.E21.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E21.m1.3.3.3.3.3.3.2.cmml" xref="S3.E21.m1.3.3.3.3.3.3.2">𝑜</ci><ci id="S3.E21.m1.3.3.3.3.3.3.3.cmml" xref="S3.E21.m1.3.3.3.3.3.3.3">𝑖</ci></apply></vector><ci id="S3.E21.m1.3.3.3.5.cmml" xref="S3.E21.m1.3.3.3.5">𝒟</ci></apply></apply><apply id="S3.E21.m1.5.5.1.1.1.1.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1"><times id="S3.E21.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.2"></times><apply id="S3.E21.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.3"><ln id="S3.E21.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.3.1"></ln><ci id="S3.E21.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1"><minus id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.2.2">𝑜</ci></apply><ci id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝑜</ci><ci id="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E21.m1.5.5.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E21.m1.5.5.1.1.1.3.cmml" xref="S3.E21.m1.5.5.1.1.1.3"><times id="S3.E21.m1.5.5.1.1.1.3.1.cmml" xref="S3.E21.m1.5.5.1.1.1.3.1"></times><ci id="S3.E21.m1.5.5.1.1.1.3.2.cmml" xref="S3.E21.m1.5.5.1.1.1.3.2">𝜆</ci><apply id="S3.E21.m1.5.5.1.1.1.3.3.cmml" xref="S3.E21.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E21.m1.5.5.1.1.1.3.3.1.cmml" xref="S3.E21.m1.5.5.1.1.1.3.3">superscript</csymbol><apply id="S3.E21.m1.5.5.1.1.1.3.3.2.cmml" xref="S3.E21.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E21.m1.5.5.1.1.1.3.3.2.1.cmml" xref="S3.E21.m1.5.5.1.1.1.3.3">subscript</csymbol><apply id="S3.E21.m1.5.5.1.1.1.3.3.2.2.1.cmml" xref="S3.E21.m1.5.5.1.1.1.3.3.2.2.2"><csymbol cd="latexml" id="S3.E21.m1.5.5.1.1.1.3.3.2.2.1.1.cmml" xref="S3.E21.m1.5.5.1.1.1.3.3.2.2.2.1">norm</csymbol><ci id="S3.E21.m1.4.4.cmml" xref="S3.E21.m1.4.4">Θ</ci></apply><cn id="S3.E21.m1.5.5.1.1.1.3.3.2.3.cmml" type="integer" xref="S3.E21.m1.5.5.1.1.1.3.3.2.3">2</cn></apply><cn id="S3.E21.m1.5.5.1.1.1.3.3.3.cmml" type="integer" xref="S3.E21.m1.5.5.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m1.5c">\displaystyle\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}%
\mathcal{L}_{Rec}=\sum_{(x_{i},y_{i},o_{i})\in\mathcal{D}}-\ln\sigma\left({%
\hat{o}}_{i}-{o}_{i}\right)+\lambda\|\Theta\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E21.m1.5d">caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ caligraphic_D end_POSTSUBSCRIPT - roman_ln italic_σ ( over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_λ ∥ roman_Θ ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.16"><span class="ltx_text" id="S3.SS4.p1.16.5">where <math alttext="{\hat{o}}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.12.1.m1.1"><semantics id="S3.SS4.p1.12.1.m1.1a"><msub id="S3.SS4.p1.12.1.m1.1.1" xref="S3.SS4.p1.12.1.m1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.12.1.m1.1.1.2" xref="S3.SS4.p1.12.1.m1.1.1.2.cmml"><mi id="S3.SS4.p1.12.1.m1.1.1.2.2" xref="S3.SS4.p1.12.1.m1.1.1.2.2.cmml">o</mi><mo id="S3.SS4.p1.12.1.m1.1.1.2.1" xref="S3.SS4.p1.12.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.12.1.m1.1.1.3" xref="S3.SS4.p1.12.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.1.m1.1b"><apply id="S3.SS4.p1.12.1.m1.1.1.cmml" xref="S3.SS4.p1.12.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.1.m1.1.1.1.cmml" xref="S3.SS4.p1.12.1.m1.1.1">subscript</csymbol><apply id="S3.SS4.p1.12.1.m1.1.1.2.cmml" xref="S3.SS4.p1.12.1.m1.1.1.2"><ci id="S3.SS4.p1.12.1.m1.1.1.2.1.cmml" xref="S3.SS4.p1.12.1.m1.1.1.2.1">^</ci><ci id="S3.SS4.p1.12.1.m1.1.1.2.2.cmml" xref="S3.SS4.p1.12.1.m1.1.1.2.2">𝑜</ci></apply><ci id="S3.SS4.p1.12.1.m1.1.1.3.cmml" xref="S3.SS4.p1.12.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.1.m1.1c">{\hat{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.12.1.m1.1d">over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the prediction of the student model. <math alttext="{\hat{o}}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.13.2.m2.1"><semantics id="S3.SS4.p1.13.2.m2.1a"><msub id="S3.SS4.p1.13.2.m2.1.1" xref="S3.SS4.p1.13.2.m2.1.1.cmml"><mover accent="true" id="S3.SS4.p1.13.2.m2.1.1.2" xref="S3.SS4.p1.13.2.m2.1.1.2.cmml"><mi id="S3.SS4.p1.13.2.m2.1.1.2.2" xref="S3.SS4.p1.13.2.m2.1.1.2.2.cmml">o</mi><mo id="S3.SS4.p1.13.2.m2.1.1.2.1" xref="S3.SS4.p1.13.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.13.2.m2.1.1.3" xref="S3.SS4.p1.13.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.2.m2.1b"><apply id="S3.SS4.p1.13.2.m2.1.1.cmml" xref="S3.SS4.p1.13.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.13.2.m2.1.1.1.cmml" xref="S3.SS4.p1.13.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p1.13.2.m2.1.1.2.cmml" xref="S3.SS4.p1.13.2.m2.1.1.2"><ci id="S3.SS4.p1.13.2.m2.1.1.2.1.cmml" xref="S3.SS4.p1.13.2.m2.1.1.2.1">^</ci><ci id="S3.SS4.p1.13.2.m2.1.1.2.2.cmml" xref="S3.SS4.p1.13.2.m2.1.1.2.2">𝑜</ci></apply><ci id="S3.SS4.p1.13.2.m2.1.1.3.cmml" xref="S3.SS4.p1.13.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.2.m2.1c">{\hat{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.13.2.m2.1d">over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is basically <math alttext="P(Y\mid X)" class="ltx_Math" display="inline" id="S3.SS4.p1.14.3.m3.1"><semantics id="S3.SS4.p1.14.3.m3.1a"><mrow id="S3.SS4.p1.14.3.m3.1.1" xref="S3.SS4.p1.14.3.m3.1.1.cmml"><mi id="S3.SS4.p1.14.3.m3.1.1.3" xref="S3.SS4.p1.14.3.m3.1.1.3.cmml">P</mi><mo id="S3.SS4.p1.14.3.m3.1.1.2" xref="S3.SS4.p1.14.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p1.14.3.m3.1.1.1.1" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS4.p1.14.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.14.3.m3.1.1.1.1.1" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.14.3.m3.1.1.1.1.1.2" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.2.cmml">Y</mi><mo id="S3.SS4.p1.14.3.m3.1.1.1.1.1.1" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.SS4.p1.14.3.m3.1.1.1.1.1.3" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S3.SS4.p1.14.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.14.3.m3.1b"><apply id="S3.SS4.p1.14.3.m3.1.1.cmml" xref="S3.SS4.p1.14.3.m3.1.1"><times id="S3.SS4.p1.14.3.m3.1.1.2.cmml" xref="S3.SS4.p1.14.3.m3.1.1.2"></times><ci id="S3.SS4.p1.14.3.m3.1.1.3.cmml" xref="S3.SS4.p1.14.3.m3.1.1.3">𝑃</ci><apply id="S3.SS4.p1.14.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.p1.14.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.p1.14.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS4.p1.14.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.2">𝑌</ci><ci id="S3.SS4.p1.14.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.14.3.m3.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.14.3.m3.1c">P(Y\mid X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.14.3.m3.1d">italic_P ( italic_Y ∣ italic_X )</annotation></semantics></math> but approximates <math alttext="P(Y\mid do(X))" class="ltx_Math" display="inline" id="S3.SS4.p1.15.4.m4.2"><semantics id="S3.SS4.p1.15.4.m4.2a"><mrow id="S3.SS4.p1.15.4.m4.2.2" xref="S3.SS4.p1.15.4.m4.2.2.cmml"><mi id="S3.SS4.p1.15.4.m4.2.2.3" xref="S3.SS4.p1.15.4.m4.2.2.3.cmml">P</mi><mo id="S3.SS4.p1.15.4.m4.2.2.2" xref="S3.SS4.p1.15.4.m4.2.2.2.cmml">⁢</mo><mrow id="S3.SS4.p1.15.4.m4.2.2.1.1" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.cmml"><mo id="S3.SS4.p1.15.4.m4.2.2.1.1.2" stretchy="false" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.15.4.m4.2.2.1.1.1" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS4.p1.15.4.m4.2.2.1.1.1.2" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.2.cmml">Y</mi><mo id="S3.SS4.p1.15.4.m4.2.2.1.1.1.1" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.1.cmml">∣</mo><mrow id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.cmml"><mi id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.2" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.2.cmml">d</mi><mo id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.1" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.3" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.3.cmml">o</mi><mo id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.1a" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.4.2" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.cmml"><mo id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.4.2.1" stretchy="false" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.cmml">(</mo><mi id="S3.SS4.p1.15.4.m4.1.1" xref="S3.SS4.p1.15.4.m4.1.1.cmml">X</mi><mo id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.4.2.2" stretchy="false" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS4.p1.15.4.m4.2.2.1.1.3" stretchy="false" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.15.4.m4.2b"><apply id="S3.SS4.p1.15.4.m4.2.2.cmml" xref="S3.SS4.p1.15.4.m4.2.2"><times id="S3.SS4.p1.15.4.m4.2.2.2.cmml" xref="S3.SS4.p1.15.4.m4.2.2.2"></times><ci id="S3.SS4.p1.15.4.m4.2.2.3.cmml" xref="S3.SS4.p1.15.4.m4.2.2.3">𝑃</ci><apply id="S3.SS4.p1.15.4.m4.2.2.1.1.1.cmml" xref="S3.SS4.p1.15.4.m4.2.2.1.1"><csymbol cd="latexml" id="S3.SS4.p1.15.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS4.p1.15.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.2">𝑌</ci><apply id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3"><times id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.1.cmml" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.1"></times><ci id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.2.cmml" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.2">𝑑</ci><ci id="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.3.cmml" xref="S3.SS4.p1.15.4.m4.2.2.1.1.1.3.3">𝑜</ci><ci id="S3.SS4.p1.15.4.m4.1.1.cmml" xref="S3.SS4.p1.15.4.m4.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.15.4.m4.2c">P(Y\mid do(X))</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.15.4.m4.2d">italic_P ( italic_Y ∣ italic_d italic_o ( italic_X ) )</annotation></semantics></math> with causal label distillation (<span class="ltx_text ltx_font_italic" id="S3.SS4.p1.16.5.2">cf</span>. Section <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.SS3.SSS2" title="3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">3.3.2</span></a>).<span class="ltx_text" id="S3.SS4.p1.16.5.1"> During inference, we use the prediction <math alttext="{\hat{o}}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.16.5.1.m1.1"><semantics id="S3.SS4.p1.16.5.1.m1.1a"><msub id="S3.SS4.p1.16.5.1.m1.1.1" xref="S3.SS4.p1.16.5.1.m1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.16.5.1.m1.1.1.2" xref="S3.SS4.p1.16.5.1.m1.1.1.2.cmml"><mi id="S3.SS4.p1.16.5.1.m1.1.1.2.2" xref="S3.SS4.p1.16.5.1.m1.1.1.2.2.cmml">o</mi><mo id="S3.SS4.p1.16.5.1.m1.1.1.2.1" xref="S3.SS4.p1.16.5.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.16.5.1.m1.1.1.3" xref="S3.SS4.p1.16.5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.16.5.1.m1.1b"><apply id="S3.SS4.p1.16.5.1.m1.1.1.cmml" xref="S3.SS4.p1.16.5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.16.5.1.m1.1.1.1.cmml" xref="S3.SS4.p1.16.5.1.m1.1.1">subscript</csymbol><apply id="S3.SS4.p1.16.5.1.m1.1.1.2.cmml" xref="S3.SS4.p1.16.5.1.m1.1.1.2"><ci id="S3.SS4.p1.16.5.1.m1.1.1.2.1.cmml" xref="S3.SS4.p1.16.5.1.m1.1.1.2.1">^</ci><ci id="S3.SS4.p1.16.5.1.m1.1.1.2.2.cmml" xref="S3.SS4.p1.16.5.1.m1.1.1.2.2">𝑜</ci></apply><ci id="S3.SS4.p1.16.5.1.m1.1.1.3.cmml" xref="S3.SS4.p1.16.5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.16.5.1.m1.1c">{\hat{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.16.5.1.m1.1d">over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of the student model for recommendation.
Overall, the training objective can be written as:</span></span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx19">
<tbody id="S3.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{CausalD}=\mathcal{L}_{Rec}+\lambda_{BDA}\mathcal{L}_%
{BDA}+\lambda_{FDA}\mathcal{L}_{FDA}." class="ltx_Math" display="inline" id="S3.E22.m1.1"><semantics id="S3.E22.m1.1a"><mrow id="S3.E22.m1.1.1.1" xref="S3.E22.m1.1.1.1.1.cmml"><mrow id="S3.E22.m1.1.1.1.1" xref="S3.E22.m1.1.1.1.1.cmml"><msub id="S3.E22.m1.1.1.1.1.2" xref="S3.E22.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E22.m1.1.1.1.1.2.2" xref="S3.E22.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E22.m1.1.1.1.1.2.3" xref="S3.E22.m1.1.1.1.1.2.3.cmml"><mi id="S3.E22.m1.1.1.1.1.2.3.2" xref="S3.E22.m1.1.1.1.1.2.3.2.cmml">C</mi><mo id="S3.E22.m1.1.1.1.1.2.3.1" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.2.3.3" xref="S3.E22.m1.1.1.1.1.2.3.3.cmml">a</mi><mo id="S3.E22.m1.1.1.1.1.2.3.1a" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.2.3.4" xref="S3.E22.m1.1.1.1.1.2.3.4.cmml">u</mi><mo id="S3.E22.m1.1.1.1.1.2.3.1b" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.2.3.5" xref="S3.E22.m1.1.1.1.1.2.3.5.cmml">s</mi><mo id="S3.E22.m1.1.1.1.1.2.3.1c" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.2.3.6" xref="S3.E22.m1.1.1.1.1.2.3.6.cmml">a</mi><mo id="S3.E22.m1.1.1.1.1.2.3.1d" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.2.3.7" xref="S3.E22.m1.1.1.1.1.2.3.7.cmml">l</mi><mo id="S3.E22.m1.1.1.1.1.2.3.1e" xref="S3.E22.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.2.3.8" xref="S3.E22.m1.1.1.1.1.2.3.8.cmml">D</mi></mrow></msub><mo id="S3.E22.m1.1.1.1.1.1" xref="S3.E22.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E22.m1.1.1.1.1.3" xref="S3.E22.m1.1.1.1.1.3.cmml"><msub id="S3.E22.m1.1.1.1.1.3.2" xref="S3.E22.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E22.m1.1.1.1.1.3.2.2" xref="S3.E22.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E22.m1.1.1.1.1.3.2.3" xref="S3.E22.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E22.m1.1.1.1.1.3.2.3.2" xref="S3.E22.m1.1.1.1.1.3.2.3.2.cmml">R</mi><mo id="S3.E22.m1.1.1.1.1.3.2.3.1" xref="S3.E22.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.2.3.3" xref="S3.E22.m1.1.1.1.1.3.2.3.3.cmml">e</mi><mo id="S3.E22.m1.1.1.1.1.3.2.3.1a" xref="S3.E22.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.2.3.4" xref="S3.E22.m1.1.1.1.1.3.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.E22.m1.1.1.1.1.3.1" xref="S3.E22.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E22.m1.1.1.1.1.3.3" xref="S3.E22.m1.1.1.1.1.3.3.cmml"><msub id="S3.E22.m1.1.1.1.1.3.3.2" xref="S3.E22.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.E22.m1.1.1.1.1.3.3.2.2" xref="S3.E22.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mrow id="S3.E22.m1.1.1.1.1.3.3.2.3" xref="S3.E22.m1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E22.m1.1.1.1.1.3.3.2.3.2" xref="S3.E22.m1.1.1.1.1.3.3.2.3.2.cmml">B</mi><mo id="S3.E22.m1.1.1.1.1.3.3.2.3.1" xref="S3.E22.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.3.2.3.3" xref="S3.E22.m1.1.1.1.1.3.3.2.3.3.cmml">D</mi><mo id="S3.E22.m1.1.1.1.1.3.3.2.3.1a" xref="S3.E22.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.3.2.3.4" xref="S3.E22.m1.1.1.1.1.3.3.2.3.4.cmml">A</mi></mrow></msub><mo id="S3.E22.m1.1.1.1.1.3.3.1" xref="S3.E22.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E22.m1.1.1.1.1.3.3.3" xref="S3.E22.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E22.m1.1.1.1.1.3.3.3.2" xref="S3.E22.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E22.m1.1.1.1.1.3.3.3.3" xref="S3.E22.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E22.m1.1.1.1.1.3.3.3.3.2" xref="S3.E22.m1.1.1.1.1.3.3.3.3.2.cmml">B</mi><mo id="S3.E22.m1.1.1.1.1.3.3.3.3.1" xref="S3.E22.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.3.3.3.3" xref="S3.E22.m1.1.1.1.1.3.3.3.3.3.cmml">D</mi><mo id="S3.E22.m1.1.1.1.1.3.3.3.3.1a" xref="S3.E22.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.3.3.3.4" xref="S3.E22.m1.1.1.1.1.3.3.3.3.4.cmml">A</mi></mrow></msub></mrow><mo id="S3.E22.m1.1.1.1.1.3.1a" xref="S3.E22.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E22.m1.1.1.1.1.3.4" xref="S3.E22.m1.1.1.1.1.3.4.cmml"><msub id="S3.E22.m1.1.1.1.1.3.4.2" xref="S3.E22.m1.1.1.1.1.3.4.2.cmml"><mi id="S3.E22.m1.1.1.1.1.3.4.2.2" xref="S3.E22.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mrow id="S3.E22.m1.1.1.1.1.3.4.2.3" xref="S3.E22.m1.1.1.1.1.3.4.2.3.cmml"><mi id="S3.E22.m1.1.1.1.1.3.4.2.3.2" xref="S3.E22.m1.1.1.1.1.3.4.2.3.2.cmml">F</mi><mo id="S3.E22.m1.1.1.1.1.3.4.2.3.1" xref="S3.E22.m1.1.1.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.4.2.3.3" xref="S3.E22.m1.1.1.1.1.3.4.2.3.3.cmml">D</mi><mo id="S3.E22.m1.1.1.1.1.3.4.2.3.1a" xref="S3.E22.m1.1.1.1.1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.4.2.3.4" xref="S3.E22.m1.1.1.1.1.3.4.2.3.4.cmml">A</mi></mrow></msub><mo id="S3.E22.m1.1.1.1.1.3.4.1" xref="S3.E22.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E22.m1.1.1.1.1.3.4.3" xref="S3.E22.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E22.m1.1.1.1.1.3.4.3.2" xref="S3.E22.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="S3.E22.m1.1.1.1.1.3.4.3.3" xref="S3.E22.m1.1.1.1.1.3.4.3.3.cmml"><mi id="S3.E22.m1.1.1.1.1.3.4.3.3.2" xref="S3.E22.m1.1.1.1.1.3.4.3.3.2.cmml">F</mi><mo id="S3.E22.m1.1.1.1.1.3.4.3.3.1" xref="S3.E22.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.4.3.3.3" xref="S3.E22.m1.1.1.1.1.3.4.3.3.3.cmml">D</mi><mo id="S3.E22.m1.1.1.1.1.3.4.3.3.1a" xref="S3.E22.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.E22.m1.1.1.1.1.3.4.3.3.4" xref="S3.E22.m1.1.1.1.1.3.4.3.3.4.cmml">A</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E22.m1.1.1.1.2" lspace="0em" xref="S3.E22.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E22.m1.1b"><apply id="S3.E22.m1.1.1.1.1.cmml" xref="S3.E22.m1.1.1.1"><eq id="S3.E22.m1.1.1.1.1.1.cmml" xref="S3.E22.m1.1.1.1.1.1"></eq><apply id="S3.E22.m1.1.1.1.1.2.cmml" xref="S3.E22.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.2.1.cmml" xref="S3.E22.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.2.2.cmml" xref="S3.E22.m1.1.1.1.1.2.2">ℒ</ci><apply id="S3.E22.m1.1.1.1.1.2.3.cmml" xref="S3.E22.m1.1.1.1.1.2.3"><times id="S3.E22.m1.1.1.1.1.2.3.1.cmml" xref="S3.E22.m1.1.1.1.1.2.3.1"></times><ci id="S3.E22.m1.1.1.1.1.2.3.2.cmml" xref="S3.E22.m1.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.E22.m1.1.1.1.1.2.3.3.cmml" xref="S3.E22.m1.1.1.1.1.2.3.3">𝑎</ci><ci id="S3.E22.m1.1.1.1.1.2.3.4.cmml" xref="S3.E22.m1.1.1.1.1.2.3.4">𝑢</ci><ci id="S3.E22.m1.1.1.1.1.2.3.5.cmml" xref="S3.E22.m1.1.1.1.1.2.3.5">𝑠</ci><ci id="S3.E22.m1.1.1.1.1.2.3.6.cmml" xref="S3.E22.m1.1.1.1.1.2.3.6">𝑎</ci><ci id="S3.E22.m1.1.1.1.1.2.3.7.cmml" xref="S3.E22.m1.1.1.1.1.2.3.7">𝑙</ci><ci id="S3.E22.m1.1.1.1.1.2.3.8.cmml" xref="S3.E22.m1.1.1.1.1.2.3.8">𝐷</ci></apply></apply><apply id="S3.E22.m1.1.1.1.1.3.cmml" xref="S3.E22.m1.1.1.1.1.3"><plus id="S3.E22.m1.1.1.1.1.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.1"></plus><apply id="S3.E22.m1.1.1.1.1.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.3.2.1.cmml" xref="S3.E22.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.3.2.2.cmml" xref="S3.E22.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E22.m1.1.1.1.1.3.2.3.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3"><times id="S3.E22.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E22.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3.2">𝑅</ci><ci id="S3.E22.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3.3">𝑒</ci><ci id="S3.E22.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E22.m1.1.1.1.1.3.2.3.4">𝑐</ci></apply></apply><apply id="S3.E22.m1.1.1.1.1.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.3"><times id="S3.E22.m1.1.1.1.1.3.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.3.1"></times><apply id="S3.E22.m1.1.1.1.1.3.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2.2">𝜆</ci><apply id="S3.E22.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2.3"><times id="S3.E22.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2.3.1"></times><ci id="S3.E22.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2.3.2">𝐵</ci><ci id="S3.E22.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2.3.3">𝐷</ci><ci id="S3.E22.m1.1.1.1.1.3.3.2.3.4.cmml" xref="S3.E22.m1.1.1.1.1.3.3.2.3.4">𝐴</ci></apply></apply><apply id="S3.E22.m1.1.1.1.1.3.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S3.E22.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3.3"><times id="S3.E22.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E22.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3.3.2">𝐵</ci><ci id="S3.E22.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3.3.3">𝐷</ci><ci id="S3.E22.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E22.m1.1.1.1.1.3.3.3.3.4">𝐴</ci></apply></apply></apply><apply id="S3.E22.m1.1.1.1.1.3.4.cmml" xref="S3.E22.m1.1.1.1.1.3.4"><times id="S3.E22.m1.1.1.1.1.3.4.1.cmml" xref="S3.E22.m1.1.1.1.1.3.4.1"></times><apply id="S3.E22.m1.1.1.1.1.3.4.2.cmml" xref="S3.E22.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.E22.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.E22.m1.1.1.1.1.3.4.2.2">𝜆</ci><apply id="S3.E22.m1.1.1.1.1.3.4.2.3.cmml" xref="S3.E22.m1.1.1.1.1.3.4.2.3"><times id="S3.E22.m1.1.1.1.1.3.4.2.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.4.2.3.1"></times><ci id="S3.E22.m1.1.1.1.1.3.4.2.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.4.2.3.2">𝐹</ci><ci id="S3.E22.m1.1.1.1.1.3.4.2.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.4.2.3.3">𝐷</ci><ci id="S3.E22.m1.1.1.1.1.3.4.2.3.4.cmml" xref="S3.E22.m1.1.1.1.1.3.4.2.3.4">𝐴</ci></apply></apply><apply id="S3.E22.m1.1.1.1.1.3.4.3.cmml" xref="S3.E22.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E22.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E22.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.4.3.2">ℒ</ci><apply id="S3.E22.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.4.3.3"><times id="S3.E22.m1.1.1.1.1.3.4.3.3.1.cmml" xref="S3.E22.m1.1.1.1.1.3.4.3.3.1"></times><ci id="S3.E22.m1.1.1.1.1.3.4.3.3.2.cmml" xref="S3.E22.m1.1.1.1.1.3.4.3.3.2">𝐹</ci><ci id="S3.E22.m1.1.1.1.1.3.4.3.3.3.cmml" xref="S3.E22.m1.1.1.1.1.3.4.3.3.3">𝐷</ci><ci id="S3.E22.m1.1.1.1.1.3.4.3.3.4.cmml" xref="S3.E22.m1.1.1.1.1.3.4.3.3.4">𝐴</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E22.m1.1c">\displaystyle\mathcal{L}_{CausalD}=\mathcal{L}_{Rec}+\lambda_{BDA}\mathcal{L}_%
{BDA}+\lambda_{FDA}\mathcal{L}_{FDA}.</annotation><annotation encoding="application/x-llamapun" id="S3.E22.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_C italic_a italic_u italic_s italic_a italic_l italic_D end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.17">The training algorithm of the causal multi-teacher distillation is summarized in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#alg1" title="In 3.4 Model Training ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.27">
<div class="ltx_listingline" id="alg1.27.28">
</div>
<div class="ltx_listingline" id="alg1.1.1">
<span class="ltx_text" id="alg1.1.1.1"><span class="ltx_text ltx_font_bold" id="alg1.1.1.1.1">Input:</span> </span> Recommendation data <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.1.1.m1.1"><semantics id="alg1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b"><ci id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.m1.1d">caligraphic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.2.2">
<span class="ltx_text" id="alg1.2.2.1"><span class="ltx_text ltx_font_bold" id="alg1.2.2.1.1">Output:</span> </span> Student recommendation model <math alttext="\{\phi^{*},\psi^{*}\}" class="ltx_Math" display="inline" id="alg1.2.2.m1.2"><semantics id="alg1.2.2.m1.2a"><mrow id="alg1.2.2.m1.2.2.2" xref="alg1.2.2.m1.2.2.3.cmml"><mo id="alg1.2.2.m1.2.2.2.3" stretchy="false" xref="alg1.2.2.m1.2.2.3.cmml">{</mo><msup id="alg1.2.2.m1.1.1.1.1" xref="alg1.2.2.m1.1.1.1.1.cmml"><mi id="alg1.2.2.m1.1.1.1.1.2" xref="alg1.2.2.m1.1.1.1.1.2.cmml">ϕ</mi><mo id="alg1.2.2.m1.1.1.1.1.3" xref="alg1.2.2.m1.1.1.1.1.3.cmml">∗</mo></msup><mo id="alg1.2.2.m1.2.2.2.4" xref="alg1.2.2.m1.2.2.3.cmml">,</mo><msup id="alg1.2.2.m1.2.2.2.2" xref="alg1.2.2.m1.2.2.2.2.cmml"><mi id="alg1.2.2.m1.2.2.2.2.2" xref="alg1.2.2.m1.2.2.2.2.2.cmml">ψ</mi><mo id="alg1.2.2.m1.2.2.2.2.3" xref="alg1.2.2.m1.2.2.2.2.3.cmml">∗</mo></msup><mo id="alg1.2.2.m1.2.2.2.5" stretchy="false" xref="alg1.2.2.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.2.m1.2b"><set id="alg1.2.2.m1.2.2.3.cmml" xref="alg1.2.2.m1.2.2.2"><apply id="alg1.2.2.m1.1.1.1.1.cmml" xref="alg1.2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.1.1.1.cmml" xref="alg1.2.2.m1.1.1.1.1">superscript</csymbol><ci id="alg1.2.2.m1.1.1.1.1.2.cmml" xref="alg1.2.2.m1.1.1.1.1.2">italic-ϕ</ci><times id="alg1.2.2.m1.1.1.1.1.3.cmml" xref="alg1.2.2.m1.1.1.1.1.3"></times></apply><apply id="alg1.2.2.m1.2.2.2.2.cmml" xref="alg1.2.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.2.2.m1.2.2.2.2.1.cmml" xref="alg1.2.2.m1.2.2.2.2">superscript</csymbol><ci id="alg1.2.2.m1.2.2.2.2.2.cmml" xref="alg1.2.2.m1.2.2.2.2.2">𝜓</ci><times id="alg1.2.2.m1.2.2.2.2.3.cmml" xref="alg1.2.2.m1.2.2.2.2.3"></times></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m1.2c">\{\phi^{*},\psi^{*}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.m1.2d">{ italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_ψ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.27.29">
</div>
<div class="ltx_listingline" id="alg1.4.4">Split <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.3.3.m1.1"><semantics id="alg1.3.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.3.3.m1.1.1" xref="alg1.3.3.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.1b"><ci id="alg1.3.3.m1.1.1.cmml" xref="alg1.3.3.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.m1.1d">caligraphic_D</annotation></semantics></math> into non-IID subsets <math alttext="\{\mathcal{D}_{1},\mathcal{D}_{2},\dots,\mathcal{D}_{K}\}" class="ltx_Math" display="inline" id="alg1.4.4.m2.4"><semantics id="alg1.4.4.m2.4a"><mrow id="alg1.4.4.m2.4.4.3" xref="alg1.4.4.m2.4.4.4.cmml"><mo id="alg1.4.4.m2.4.4.3.4" stretchy="false" xref="alg1.4.4.m2.4.4.4.cmml">{</mo><msub id="alg1.4.4.m2.2.2.1.1" xref="alg1.4.4.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.4.4.m2.2.2.1.1.2" xref="alg1.4.4.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="alg1.4.4.m2.2.2.1.1.3" xref="alg1.4.4.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.4.4.m2.4.4.3.5" xref="alg1.4.4.m2.4.4.4.cmml">,</mo><msub id="alg1.4.4.m2.3.3.2.2" xref="alg1.4.4.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.4.4.m2.3.3.2.2.2" xref="alg1.4.4.m2.3.3.2.2.2.cmml">𝒟</mi><mn id="alg1.4.4.m2.3.3.2.2.3" xref="alg1.4.4.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="alg1.4.4.m2.4.4.3.6" xref="alg1.4.4.m2.4.4.4.cmml">,</mo><mi id="alg1.4.4.m2.1.1" mathvariant="normal" xref="alg1.4.4.m2.1.1.cmml">…</mi><mo id="alg1.4.4.m2.4.4.3.7" xref="alg1.4.4.m2.4.4.4.cmml">,</mo><msub id="alg1.4.4.m2.4.4.3.3" xref="alg1.4.4.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.4.4.m2.4.4.3.3.2" xref="alg1.4.4.m2.4.4.3.3.2.cmml">𝒟</mi><mi id="alg1.4.4.m2.4.4.3.3.3" xref="alg1.4.4.m2.4.4.3.3.3.cmml">K</mi></msub><mo id="alg1.4.4.m2.4.4.3.8" stretchy="false" xref="alg1.4.4.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.4.m2.4b"><set id="alg1.4.4.m2.4.4.4.cmml" xref="alg1.4.4.m2.4.4.3"><apply id="alg1.4.4.m2.2.2.1.1.cmml" xref="alg1.4.4.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.4.4.m2.2.2.1.1.1.cmml" xref="alg1.4.4.m2.2.2.1.1">subscript</csymbol><ci id="alg1.4.4.m2.2.2.1.1.2.cmml" xref="alg1.4.4.m2.2.2.1.1.2">𝒟</ci><cn id="alg1.4.4.m2.2.2.1.1.3.cmml" type="integer" xref="alg1.4.4.m2.2.2.1.1.3">1</cn></apply><apply id="alg1.4.4.m2.3.3.2.2.cmml" xref="alg1.4.4.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.4.4.m2.3.3.2.2.1.cmml" xref="alg1.4.4.m2.3.3.2.2">subscript</csymbol><ci id="alg1.4.4.m2.3.3.2.2.2.cmml" xref="alg1.4.4.m2.3.3.2.2.2">𝒟</ci><cn id="alg1.4.4.m2.3.3.2.2.3.cmml" type="integer" xref="alg1.4.4.m2.3.3.2.2.3">2</cn></apply><ci id="alg1.4.4.m2.1.1.cmml" xref="alg1.4.4.m2.1.1">…</ci><apply id="alg1.4.4.m2.4.4.3.3.cmml" xref="alg1.4.4.m2.4.4.3.3"><csymbol cd="ambiguous" id="alg1.4.4.m2.4.4.3.3.1.cmml" xref="alg1.4.4.m2.4.4.3.3">subscript</csymbol><ci id="alg1.4.4.m2.4.4.3.3.2.cmml" xref="alg1.4.4.m2.4.4.3.3.2">𝒟</ci><ci id="alg1.4.4.m2.4.4.3.3.3.cmml" xref="alg1.4.4.m2.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m2.4c">\{\mathcal{D}_{1},\mathcal{D}_{2},\dots,\mathcal{D}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.m2.4d">{ caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , caligraphic_D start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.7.7">
<span class="ltx_text ltx_font_bold" id="alg1.7.7.4">for (</span> <em class="ltx_emph ltx_font_italic" id="alg1.6.6.2"><math alttext="k=1" class="ltx_Math" display="inline" id="alg1.5.5.1.m1.1"><semantics id="alg1.5.5.1.m1.1a"><mrow id="alg1.5.5.1.m1.1.1" xref="alg1.5.5.1.m1.1.1.cmml"><mi id="alg1.5.5.1.m1.1.1.2" xref="alg1.5.5.1.m1.1.1.2.cmml">k</mi><mo id="alg1.5.5.1.m1.1.1.1" xref="alg1.5.5.1.m1.1.1.1.cmml">=</mo><mn id="alg1.5.5.1.m1.1.1.3" xref="alg1.5.5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.5.1.m1.1b"><apply id="alg1.5.5.1.m1.1.1.cmml" xref="alg1.5.5.1.m1.1.1"><eq id="alg1.5.5.1.m1.1.1.1.cmml" xref="alg1.5.5.1.m1.1.1.1"></eq><ci id="alg1.5.5.1.m1.1.1.2.cmml" xref="alg1.5.5.1.m1.1.1.2">𝑘</ci><cn id="alg1.5.5.1.m1.1.1.3.cmml" type="integer" xref="alg1.5.5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.1.m1.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.1.m1.1d">italic_k = 1</annotation></semantics></math> to <math alttext="K" class="ltx_Math" display="inline" id="alg1.6.6.2.m2.1"><semantics id="alg1.6.6.2.m2.1a"><mi id="alg1.6.6.2.m2.1.1" xref="alg1.6.6.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.6.6.2.m2.1b"><ci id="alg1.6.6.2.m2.1.1.cmml" xref="alg1.6.6.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.2.m2.1d">italic_K</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.7.7.3">) <math alttext="\{" class="ltx_Math" display="inline" id="alg1.7.7.3.m1.1"><semantics id="alg1.7.7.3.m1.1a"><mo id="alg1.7.7.3.m1.1.1" stretchy="false" xref="alg1.7.7.3.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="alg1.7.7.3.m1.1b"><ci id="alg1.7.7.3.m1.1.1.cmml" xref="alg1.7.7.3.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.3.m1.1c">\{</annotation><annotation encoding="application/x-llamapun" id="alg1.7.7.3.m1.1d">{</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg1.9.9">     
Train one teacher on <math alttext="\mathcal{D}_{k}" class="ltx_Math" display="inline" id="alg1.8.8.m1.1"><semantics id="alg1.8.8.m1.1a"><msub id="alg1.8.8.m1.1.1" xref="alg1.8.8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.8.8.m1.1.1.2" xref="alg1.8.8.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.8.8.m1.1.1.3" xref="alg1.8.8.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.8.8.m1.1b"><apply id="alg1.8.8.m1.1.1.cmml" xref="alg1.8.8.m1.1.1"><csymbol cd="ambiguous" id="alg1.8.8.m1.1.1.1.cmml" xref="alg1.8.8.m1.1.1">subscript</csymbol><ci id="alg1.8.8.m1.1.1.2.cmml" xref="alg1.8.8.m1.1.1.2">𝒟</ci><ci id="alg1.8.8.m1.1.1.3.cmml" xref="alg1.8.8.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.m1.1c">\mathcal{D}_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.8.8.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and obtain encoder <math alttext="\phi_{k}" class="ltx_Math" display="inline" id="alg1.9.9.m2.1"><semantics id="alg1.9.9.m2.1a"><msub id="alg1.9.9.m2.1.1" xref="alg1.9.9.m2.1.1.cmml"><mi id="alg1.9.9.m2.1.1.2" xref="alg1.9.9.m2.1.1.2.cmml">ϕ</mi><mi id="alg1.9.9.m2.1.1.3" xref="alg1.9.9.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.9.9.m2.1b"><apply id="alg1.9.9.m2.1.1.cmml" xref="alg1.9.9.m2.1.1"><csymbol cd="ambiguous" id="alg1.9.9.m2.1.1.1.cmml" xref="alg1.9.9.m2.1.1">subscript</csymbol><ci id="alg1.9.9.m2.1.1.2.cmml" xref="alg1.9.9.m2.1.1.2">italic-ϕ</ci><ci id="alg1.9.9.m2.1.1.3.cmml" xref="alg1.9.9.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.m2.1c">\phi_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.9.9.m2.1d">italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.10.10">       <math alttext="\}" class="ltx_Math" display="inline" id="alg1.10.10.m1.1"><semantics id="alg1.10.10.m1.1a"><mo id="alg1.10.10.m1.1.1" stretchy="false" xref="alg1.10.10.m1.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><ci id="alg1.10.10.m1.1.1.cmml" xref="alg1.10.10.m1.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">\}</annotation><annotation encoding="application/x-llamapun" id="alg1.10.10.m1.1d">}</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.27.30">     
</div>
<div class="ltx_listingline" id="alg1.11.11">     Initialize <math alttext="\Theta=\{\phi^{*},\psi^{*},\mathbf{W}_{1},\mathbf{W}_{2},\psi_{FDA}\}" class="ltx_Math" display="inline" id="alg1.11.11.m1.5"><semantics id="alg1.11.11.m1.5a"><mrow id="alg1.11.11.m1.5.5" xref="alg1.11.11.m1.5.5.cmml"><mi id="alg1.11.11.m1.5.5.7" mathvariant="normal" xref="alg1.11.11.m1.5.5.7.cmml">Θ</mi><mo id="alg1.11.11.m1.5.5.6" xref="alg1.11.11.m1.5.5.6.cmml">=</mo><mrow id="alg1.11.11.m1.5.5.5.5" xref="alg1.11.11.m1.5.5.5.6.cmml"><mo id="alg1.11.11.m1.5.5.5.5.6" stretchy="false" xref="alg1.11.11.m1.5.5.5.6.cmml">{</mo><msup id="alg1.11.11.m1.1.1.1.1.1" xref="alg1.11.11.m1.1.1.1.1.1.cmml"><mi id="alg1.11.11.m1.1.1.1.1.1.2" xref="alg1.11.11.m1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="alg1.11.11.m1.1.1.1.1.1.3" xref="alg1.11.11.m1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="alg1.11.11.m1.5.5.5.5.7" xref="alg1.11.11.m1.5.5.5.6.cmml">,</mo><msup id="alg1.11.11.m1.2.2.2.2.2" xref="alg1.11.11.m1.2.2.2.2.2.cmml"><mi id="alg1.11.11.m1.2.2.2.2.2.2" xref="alg1.11.11.m1.2.2.2.2.2.2.cmml">ψ</mi><mo id="alg1.11.11.m1.2.2.2.2.2.3" xref="alg1.11.11.m1.2.2.2.2.2.3.cmml">∗</mo></msup><mo id="alg1.11.11.m1.5.5.5.5.8" xref="alg1.11.11.m1.5.5.5.6.cmml">,</mo><msub id="alg1.11.11.m1.3.3.3.3.3" xref="alg1.11.11.m1.3.3.3.3.3.cmml"><mi id="alg1.11.11.m1.3.3.3.3.3.2" xref="alg1.11.11.m1.3.3.3.3.3.2.cmml">𝐖</mi><mn id="alg1.11.11.m1.3.3.3.3.3.3" xref="alg1.11.11.m1.3.3.3.3.3.3.cmml">1</mn></msub><mo id="alg1.11.11.m1.5.5.5.5.9" xref="alg1.11.11.m1.5.5.5.6.cmml">,</mo><msub id="alg1.11.11.m1.4.4.4.4.4" xref="alg1.11.11.m1.4.4.4.4.4.cmml"><mi id="alg1.11.11.m1.4.4.4.4.4.2" xref="alg1.11.11.m1.4.4.4.4.4.2.cmml">𝐖</mi><mn id="alg1.11.11.m1.4.4.4.4.4.3" xref="alg1.11.11.m1.4.4.4.4.4.3.cmml">2</mn></msub><mo id="alg1.11.11.m1.5.5.5.5.10" xref="alg1.11.11.m1.5.5.5.6.cmml">,</mo><msub id="alg1.11.11.m1.5.5.5.5.5" xref="alg1.11.11.m1.5.5.5.5.5.cmml"><mi id="alg1.11.11.m1.5.5.5.5.5.2" xref="alg1.11.11.m1.5.5.5.5.5.2.cmml">ψ</mi><mrow id="alg1.11.11.m1.5.5.5.5.5.3" xref="alg1.11.11.m1.5.5.5.5.5.3.cmml"><mi id="alg1.11.11.m1.5.5.5.5.5.3.2" xref="alg1.11.11.m1.5.5.5.5.5.3.2.cmml">F</mi><mo id="alg1.11.11.m1.5.5.5.5.5.3.1" xref="alg1.11.11.m1.5.5.5.5.5.3.1.cmml">⁢</mo><mi id="alg1.11.11.m1.5.5.5.5.5.3.3" xref="alg1.11.11.m1.5.5.5.5.5.3.3.cmml">D</mi><mo id="alg1.11.11.m1.5.5.5.5.5.3.1a" xref="alg1.11.11.m1.5.5.5.5.5.3.1.cmml">⁢</mo><mi id="alg1.11.11.m1.5.5.5.5.5.3.4" xref="alg1.11.11.m1.5.5.5.5.5.3.4.cmml">A</mi></mrow></msub><mo id="alg1.11.11.m1.5.5.5.5.11" stretchy="false" xref="alg1.11.11.m1.5.5.5.6.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.11.m1.5b"><apply id="alg1.11.11.m1.5.5.cmml" xref="alg1.11.11.m1.5.5"><eq id="alg1.11.11.m1.5.5.6.cmml" xref="alg1.11.11.m1.5.5.6"></eq><ci id="alg1.11.11.m1.5.5.7.cmml" xref="alg1.11.11.m1.5.5.7">Θ</ci><set id="alg1.11.11.m1.5.5.5.6.cmml" xref="alg1.11.11.m1.5.5.5.5"><apply id="alg1.11.11.m1.1.1.1.1.1.cmml" xref="alg1.11.11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.m1.1.1.1.1.1.1.cmml" xref="alg1.11.11.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.11.11.m1.1.1.1.1.1.2.cmml" xref="alg1.11.11.m1.1.1.1.1.1.2">italic-ϕ</ci><times id="alg1.11.11.m1.1.1.1.1.1.3.cmml" xref="alg1.11.11.m1.1.1.1.1.1.3"></times></apply><apply id="alg1.11.11.m1.2.2.2.2.2.cmml" xref="alg1.11.11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.11.11.m1.2.2.2.2.2.1.cmml" xref="alg1.11.11.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.11.11.m1.2.2.2.2.2.2.cmml" xref="alg1.11.11.m1.2.2.2.2.2.2">𝜓</ci><times id="alg1.11.11.m1.2.2.2.2.2.3.cmml" xref="alg1.11.11.m1.2.2.2.2.2.3"></times></apply><apply id="alg1.11.11.m1.3.3.3.3.3.cmml" xref="alg1.11.11.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.11.11.m1.3.3.3.3.3.1.cmml" xref="alg1.11.11.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.11.11.m1.3.3.3.3.3.2.cmml" xref="alg1.11.11.m1.3.3.3.3.3.2">𝐖</ci><cn id="alg1.11.11.m1.3.3.3.3.3.3.cmml" type="integer" xref="alg1.11.11.m1.3.3.3.3.3.3">1</cn></apply><apply id="alg1.11.11.m1.4.4.4.4.4.cmml" xref="alg1.11.11.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.11.11.m1.4.4.4.4.4.1.cmml" xref="alg1.11.11.m1.4.4.4.4.4">subscript</csymbol><ci id="alg1.11.11.m1.4.4.4.4.4.2.cmml" xref="alg1.11.11.m1.4.4.4.4.4.2">𝐖</ci><cn id="alg1.11.11.m1.4.4.4.4.4.3.cmml" type="integer" xref="alg1.11.11.m1.4.4.4.4.4.3">2</cn></apply><apply id="alg1.11.11.m1.5.5.5.5.5.cmml" xref="alg1.11.11.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="alg1.11.11.m1.5.5.5.5.5.1.cmml" xref="alg1.11.11.m1.5.5.5.5.5">subscript</csymbol><ci id="alg1.11.11.m1.5.5.5.5.5.2.cmml" xref="alg1.11.11.m1.5.5.5.5.5.2">𝜓</ci><apply id="alg1.11.11.m1.5.5.5.5.5.3.cmml" xref="alg1.11.11.m1.5.5.5.5.5.3"><times id="alg1.11.11.m1.5.5.5.5.5.3.1.cmml" xref="alg1.11.11.m1.5.5.5.5.5.3.1"></times><ci id="alg1.11.11.m1.5.5.5.5.5.3.2.cmml" xref="alg1.11.11.m1.5.5.5.5.5.3.2">𝐹</ci><ci id="alg1.11.11.m1.5.5.5.5.5.3.3.cmml" xref="alg1.11.11.m1.5.5.5.5.5.3.3">𝐷</ci><ci id="alg1.11.11.m1.5.5.5.5.5.3.4.cmml" xref="alg1.11.11.m1.5.5.5.5.5.3.4">𝐴</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m1.5c">\Theta=\{\phi^{*},\psi^{*},\mathbf{W}_{1},\mathbf{W}_{2},\psi_{FDA}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.11.11.m1.5d">roman_Θ = { italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_ψ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.27.31">     <span class="ltx_text ltx_font_bold" id="alg1.27.31.1">while</span> <em class="ltx_emph ltx_font_italic" id="alg1.27.31.2">not converged</em> <span class="ltx_text ltx_font_bold" id="alg1.27.31.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.27.32">          

</div>
<div class="ltx_listingline" id="alg1.13.13">          Sample a batch <math alttext="\{(x_{i},y_{i},o_{i})\}_{i=1,\dots,N_{b}}" class="ltx_Math" display="inline" id="alg1.12.12.m1.4"><semantics id="alg1.12.12.m1.4a"><msub id="alg1.12.12.m1.4.4" xref="alg1.12.12.m1.4.4.cmml"><mrow id="alg1.12.12.m1.4.4.1.1" xref="alg1.12.12.m1.4.4.1.2.cmml"><mo id="alg1.12.12.m1.4.4.1.1.2" stretchy="false" xref="alg1.12.12.m1.4.4.1.2.cmml">{</mo><mrow id="alg1.12.12.m1.4.4.1.1.1.3" xref="alg1.12.12.m1.4.4.1.1.1.4.cmml"><mo id="alg1.12.12.m1.4.4.1.1.1.3.4" stretchy="false" xref="alg1.12.12.m1.4.4.1.1.1.4.cmml">(</mo><msub id="alg1.12.12.m1.4.4.1.1.1.1.1" xref="alg1.12.12.m1.4.4.1.1.1.1.1.cmml"><mi id="alg1.12.12.m1.4.4.1.1.1.1.1.2" xref="alg1.12.12.m1.4.4.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.12.12.m1.4.4.1.1.1.1.1.3" xref="alg1.12.12.m1.4.4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.12.12.m1.4.4.1.1.1.3.5" xref="alg1.12.12.m1.4.4.1.1.1.4.cmml">,</mo><msub id="alg1.12.12.m1.4.4.1.1.1.2.2" xref="alg1.12.12.m1.4.4.1.1.1.2.2.cmml"><mi id="alg1.12.12.m1.4.4.1.1.1.2.2.2" xref="alg1.12.12.m1.4.4.1.1.1.2.2.2.cmml">y</mi><mi id="alg1.12.12.m1.4.4.1.1.1.2.2.3" xref="alg1.12.12.m1.4.4.1.1.1.2.2.3.cmml">i</mi></msub><mo id="alg1.12.12.m1.4.4.1.1.1.3.6" xref="alg1.12.12.m1.4.4.1.1.1.4.cmml">,</mo><msub id="alg1.12.12.m1.4.4.1.1.1.3.3" xref="alg1.12.12.m1.4.4.1.1.1.3.3.cmml"><mi id="alg1.12.12.m1.4.4.1.1.1.3.3.2" xref="alg1.12.12.m1.4.4.1.1.1.3.3.2.cmml">o</mi><mi id="alg1.12.12.m1.4.4.1.1.1.3.3.3" xref="alg1.12.12.m1.4.4.1.1.1.3.3.3.cmml">i</mi></msub><mo id="alg1.12.12.m1.4.4.1.1.1.3.7" stretchy="false" xref="alg1.12.12.m1.4.4.1.1.1.4.cmml">)</mo></mrow><mo id="alg1.12.12.m1.4.4.1.1.3" stretchy="false" xref="alg1.12.12.m1.4.4.1.2.cmml">}</mo></mrow><mrow id="alg1.12.12.m1.3.3.3" xref="alg1.12.12.m1.3.3.3.cmml"><mi id="alg1.12.12.m1.3.3.3.5" xref="alg1.12.12.m1.3.3.3.5.cmml">i</mi><mo id="alg1.12.12.m1.3.3.3.4" xref="alg1.12.12.m1.3.3.3.4.cmml">=</mo><mrow id="alg1.12.12.m1.3.3.3.3.1" xref="alg1.12.12.m1.3.3.3.3.2.cmml"><mn id="alg1.12.12.m1.1.1.1.1" xref="alg1.12.12.m1.1.1.1.1.cmml">1</mn><mo id="alg1.12.12.m1.3.3.3.3.1.2" xref="alg1.12.12.m1.3.3.3.3.2.cmml">,</mo><mi id="alg1.12.12.m1.2.2.2.2" mathvariant="normal" xref="alg1.12.12.m1.2.2.2.2.cmml">…</mi><mo id="alg1.12.12.m1.3.3.3.3.1.3" xref="alg1.12.12.m1.3.3.3.3.2.cmml">,</mo><msub id="alg1.12.12.m1.3.3.3.3.1.1" xref="alg1.12.12.m1.3.3.3.3.1.1.cmml"><mi id="alg1.12.12.m1.3.3.3.3.1.1.2" xref="alg1.12.12.m1.3.3.3.3.1.1.2.cmml">N</mi><mi id="alg1.12.12.m1.3.3.3.3.1.1.3" xref="alg1.12.12.m1.3.3.3.3.1.1.3.cmml">b</mi></msub></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.12.12.m1.4b"><apply id="alg1.12.12.m1.4.4.cmml" xref="alg1.12.12.m1.4.4"><csymbol cd="ambiguous" id="alg1.12.12.m1.4.4.2.cmml" xref="alg1.12.12.m1.4.4">subscript</csymbol><set id="alg1.12.12.m1.4.4.1.2.cmml" xref="alg1.12.12.m1.4.4.1.1"><vector id="alg1.12.12.m1.4.4.1.1.1.4.cmml" xref="alg1.12.12.m1.4.4.1.1.1.3"><apply id="alg1.12.12.m1.4.4.1.1.1.1.1.cmml" xref="alg1.12.12.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.12.12.m1.4.4.1.1.1.1.1.1.cmml" xref="alg1.12.12.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="alg1.12.12.m1.4.4.1.1.1.1.1.2.cmml" xref="alg1.12.12.m1.4.4.1.1.1.1.1.2">𝑥</ci><ci id="alg1.12.12.m1.4.4.1.1.1.1.1.3.cmml" xref="alg1.12.12.m1.4.4.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.12.12.m1.4.4.1.1.1.2.2.cmml" xref="alg1.12.12.m1.4.4.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.12.12.m1.4.4.1.1.1.2.2.1.cmml" xref="alg1.12.12.m1.4.4.1.1.1.2.2">subscript</csymbol><ci id="alg1.12.12.m1.4.4.1.1.1.2.2.2.cmml" xref="alg1.12.12.m1.4.4.1.1.1.2.2.2">𝑦</ci><ci id="alg1.12.12.m1.4.4.1.1.1.2.2.3.cmml" xref="alg1.12.12.m1.4.4.1.1.1.2.2.3">𝑖</ci></apply><apply id="alg1.12.12.m1.4.4.1.1.1.3.3.cmml" xref="alg1.12.12.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.12.12.m1.4.4.1.1.1.3.3.1.cmml" xref="alg1.12.12.m1.4.4.1.1.1.3.3">subscript</csymbol><ci id="alg1.12.12.m1.4.4.1.1.1.3.3.2.cmml" xref="alg1.12.12.m1.4.4.1.1.1.3.3.2">𝑜</ci><ci id="alg1.12.12.m1.4.4.1.1.1.3.3.3.cmml" xref="alg1.12.12.m1.4.4.1.1.1.3.3.3">𝑖</ci></apply></vector></set><apply id="alg1.12.12.m1.3.3.3.cmml" xref="alg1.12.12.m1.3.3.3"><eq id="alg1.12.12.m1.3.3.3.4.cmml" xref="alg1.12.12.m1.3.3.3.4"></eq><ci id="alg1.12.12.m1.3.3.3.5.cmml" xref="alg1.12.12.m1.3.3.3.5">𝑖</ci><list id="alg1.12.12.m1.3.3.3.3.2.cmml" xref="alg1.12.12.m1.3.3.3.3.1"><cn id="alg1.12.12.m1.1.1.1.1.cmml" type="integer" xref="alg1.12.12.m1.1.1.1.1">1</cn><ci id="alg1.12.12.m1.2.2.2.2.cmml" xref="alg1.12.12.m1.2.2.2.2">…</ci><apply id="alg1.12.12.m1.3.3.3.3.1.1.cmml" xref="alg1.12.12.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.12.12.m1.3.3.3.3.1.1.1.cmml" xref="alg1.12.12.m1.3.3.3.3.1.1">subscript</csymbol><ci id="alg1.12.12.m1.3.3.3.3.1.1.2.cmml" xref="alg1.12.12.m1.3.3.3.3.1.1.2">𝑁</ci><ci id="alg1.12.12.m1.3.3.3.3.1.1.3.cmml" xref="alg1.12.12.m1.3.3.3.3.1.1.3">𝑏</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m1.4c">\{(x_{i},y_{i},o_{i})\}_{i=1,\dots,N_{b}}</annotation><annotation encoding="application/x-llamapun" id="alg1.12.12.m1.4d">{ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 , … , italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.13.13.m2.1"><semantics id="alg1.13.13.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.13.13.m2.1.1" xref="alg1.13.13.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.13.13.m2.1b"><ci id="alg1.13.13.m2.1.1.cmml" xref="alg1.13.13.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.13.13.m2.1d">caligraphic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.15.15">          
<span class="ltx_text ltx_font_bold" id="alg1.15.15.3">for (</span> <em class="ltx_emph ltx_font_italic" id="alg1.14.14.1">i = 1 to <math alttext="N_{b}" class="ltx_Math" display="inline" id="alg1.14.14.1.m1.1"><semantics id="alg1.14.14.1.m1.1a"><msub id="alg1.14.14.1.m1.1.1" xref="alg1.14.14.1.m1.1.1.cmml"><mi id="alg1.14.14.1.m1.1.1.2" xref="alg1.14.14.1.m1.1.1.2.cmml">N</mi><mi id="alg1.14.14.1.m1.1.1.3" xref="alg1.14.14.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.14.14.1.m1.1b"><apply id="alg1.14.14.1.m1.1.1.cmml" xref="alg1.14.14.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.14.14.1.m1.1.1.1.cmml" xref="alg1.14.14.1.m1.1.1">subscript</csymbol><ci id="alg1.14.14.1.m1.1.1.2.cmml" xref="alg1.14.14.1.m1.1.1.2">𝑁</ci><ci id="alg1.14.14.1.m1.1.1.3.cmml" xref="alg1.14.14.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.1.m1.1c">N_{b}</annotation><annotation encoding="application/x-llamapun" id="alg1.14.14.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.15.15.2">) <math alttext="\{" class="ltx_Math" display="inline" id="alg1.15.15.2.m1.1"><semantics id="alg1.15.15.2.m1.1a"><mo id="alg1.15.15.2.m1.1.1" stretchy="false" xref="alg1.15.15.2.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="alg1.15.15.2.m1.1b"><ci id="alg1.15.15.2.m1.1.1.cmml" xref="alg1.15.15.2.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.2.m1.1c">\{</annotation><annotation encoding="application/x-llamapun" id="alg1.15.15.2.m1.1d">{</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg1.16.16">               
<math alttext="\mathbf{\hat{m}}_{i}=\phi^{*}(x_{i})" class="ltx_Math" display="inline" id="alg1.16.16.m1.1"><semantics id="alg1.16.16.m1.1a"><mrow id="alg1.16.16.m1.1.1" xref="alg1.16.16.m1.1.1.cmml"><msub id="alg1.16.16.m1.1.1.3" xref="alg1.16.16.m1.1.1.3.cmml"><mover accent="true" id="alg1.16.16.m1.1.1.3.2" xref="alg1.16.16.m1.1.1.3.2.cmml"><mi id="alg1.16.16.m1.1.1.3.2.2" xref="alg1.16.16.m1.1.1.3.2.2.cmml">𝐦</mi><mo id="alg1.16.16.m1.1.1.3.2.1" xref="alg1.16.16.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="alg1.16.16.m1.1.1.3.3" xref="alg1.16.16.m1.1.1.3.3.cmml">i</mi></msub><mo id="alg1.16.16.m1.1.1.2" xref="alg1.16.16.m1.1.1.2.cmml">=</mo><mrow id="alg1.16.16.m1.1.1.1" xref="alg1.16.16.m1.1.1.1.cmml"><msup id="alg1.16.16.m1.1.1.1.3" xref="alg1.16.16.m1.1.1.1.3.cmml"><mi id="alg1.16.16.m1.1.1.1.3.2" xref="alg1.16.16.m1.1.1.1.3.2.cmml">ϕ</mi><mo id="alg1.16.16.m1.1.1.1.3.3" xref="alg1.16.16.m1.1.1.1.3.3.cmml">∗</mo></msup><mo id="alg1.16.16.m1.1.1.1.2" xref="alg1.16.16.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.16.16.m1.1.1.1.1.1" xref="alg1.16.16.m1.1.1.1.1.1.1.cmml"><mo id="alg1.16.16.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.16.16.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.16.16.m1.1.1.1.1.1.1" xref="alg1.16.16.m1.1.1.1.1.1.1.cmml"><mi id="alg1.16.16.m1.1.1.1.1.1.1.2" xref="alg1.16.16.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.16.16.m1.1.1.1.1.1.1.3" xref="alg1.16.16.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.16.16.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.16.16.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.16.16.m1.1b"><apply id="alg1.16.16.m1.1.1.cmml" xref="alg1.16.16.m1.1.1"><eq id="alg1.16.16.m1.1.1.2.cmml" xref="alg1.16.16.m1.1.1.2"></eq><apply id="alg1.16.16.m1.1.1.3.cmml" xref="alg1.16.16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.16.16.m1.1.1.3.1.cmml" xref="alg1.16.16.m1.1.1.3">subscript</csymbol><apply id="alg1.16.16.m1.1.1.3.2.cmml" xref="alg1.16.16.m1.1.1.3.2"><ci id="alg1.16.16.m1.1.1.3.2.1.cmml" xref="alg1.16.16.m1.1.1.3.2.1">^</ci><ci id="alg1.16.16.m1.1.1.3.2.2.cmml" xref="alg1.16.16.m1.1.1.3.2.2">𝐦</ci></apply><ci id="alg1.16.16.m1.1.1.3.3.cmml" xref="alg1.16.16.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.16.16.m1.1.1.1.cmml" xref="alg1.16.16.m1.1.1.1"><times id="alg1.16.16.m1.1.1.1.2.cmml" xref="alg1.16.16.m1.1.1.1.2"></times><apply id="alg1.16.16.m1.1.1.1.3.cmml" xref="alg1.16.16.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.16.16.m1.1.1.1.3.1.cmml" xref="alg1.16.16.m1.1.1.1.3">superscript</csymbol><ci id="alg1.16.16.m1.1.1.1.3.2.cmml" xref="alg1.16.16.m1.1.1.1.3.2">italic-ϕ</ci><times id="alg1.16.16.m1.1.1.1.3.3.cmml" xref="alg1.16.16.m1.1.1.1.3.3"></times></apply><apply id="alg1.16.16.m1.1.1.1.1.1.1.cmml" xref="alg1.16.16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.16.16.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.16.16.m1.1.1.1.1.1.1.2.cmml" xref="alg1.16.16.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.16.16.m1.1.1.1.1.1.1.3.cmml" xref="alg1.16.16.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m1.1c">\mathbf{\hat{m}}_{i}=\phi^{*}(x_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.16.16.m1.1d">over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.17.17">               <math alttext="\mathbf{\tilde{m}}_{i}^{\circ}=\mathbb{E}_{z_{k}}\left[\phi_{k}(x_{i})\right]" class="ltx_Math" display="inline" id="alg1.17.17.m1.1"><semantics id="alg1.17.17.m1.1a"><mrow id="alg1.17.17.m1.1.1" xref="alg1.17.17.m1.1.1.cmml"><msubsup id="alg1.17.17.m1.1.1.3" xref="alg1.17.17.m1.1.1.3.cmml"><mover accent="true" id="alg1.17.17.m1.1.1.3.2.2" xref="alg1.17.17.m1.1.1.3.2.2.cmml"><mi id="alg1.17.17.m1.1.1.3.2.2.2" xref="alg1.17.17.m1.1.1.3.2.2.2.cmml">𝐦</mi><mo id="alg1.17.17.m1.1.1.3.2.2.1" xref="alg1.17.17.m1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="alg1.17.17.m1.1.1.3.2.3" xref="alg1.17.17.m1.1.1.3.2.3.cmml">i</mi><mo id="alg1.17.17.m1.1.1.3.3" xref="alg1.17.17.m1.1.1.3.3.cmml">∘</mo></msubsup><mo id="alg1.17.17.m1.1.1.2" xref="alg1.17.17.m1.1.1.2.cmml">=</mo><mrow id="alg1.17.17.m1.1.1.1" xref="alg1.17.17.m1.1.1.1.cmml"><msub id="alg1.17.17.m1.1.1.1.3" xref="alg1.17.17.m1.1.1.1.3.cmml"><mi id="alg1.17.17.m1.1.1.1.3.2" xref="alg1.17.17.m1.1.1.1.3.2.cmml">𝔼</mi><msub id="alg1.17.17.m1.1.1.1.3.3" xref="alg1.17.17.m1.1.1.1.3.3.cmml"><mi id="alg1.17.17.m1.1.1.1.3.3.2" xref="alg1.17.17.m1.1.1.1.3.3.2.cmml">z</mi><mi id="alg1.17.17.m1.1.1.1.3.3.3" xref="alg1.17.17.m1.1.1.1.3.3.3.cmml">k</mi></msub></msub><mo id="alg1.17.17.m1.1.1.1.2" xref="alg1.17.17.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.17.17.m1.1.1.1.1.1" xref="alg1.17.17.m1.1.1.1.1.2.cmml"><mo id="alg1.17.17.m1.1.1.1.1.1.2" xref="alg1.17.17.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.17.17.m1.1.1.1.1.1.1" xref="alg1.17.17.m1.1.1.1.1.1.1.cmml"><msub id="alg1.17.17.m1.1.1.1.1.1.1.3" xref="alg1.17.17.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.17.17.m1.1.1.1.1.1.1.3.2" xref="alg1.17.17.m1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.17.17.m1.1.1.1.1.1.1.3.3" xref="alg1.17.17.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="alg1.17.17.m1.1.1.1.1.1.1.2" xref="alg1.17.17.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.17.17.m1.1.1.1.1.1.1.1.1" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.17.17.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.17.17.m1.1.1.1.1.1.1.1.1.1" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.17.17.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.17.17.m1.1.1.1.1.1.3" xref="alg1.17.17.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.17.m1.1b"><apply id="alg1.17.17.m1.1.1.cmml" xref="alg1.17.17.m1.1.1"><eq id="alg1.17.17.m1.1.1.2.cmml" xref="alg1.17.17.m1.1.1.2"></eq><apply id="alg1.17.17.m1.1.1.3.cmml" xref="alg1.17.17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.17.17.m1.1.1.3.1.cmml" xref="alg1.17.17.m1.1.1.3">superscript</csymbol><apply id="alg1.17.17.m1.1.1.3.2.cmml" xref="alg1.17.17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.17.17.m1.1.1.3.2.1.cmml" xref="alg1.17.17.m1.1.1.3">subscript</csymbol><apply id="alg1.17.17.m1.1.1.3.2.2.cmml" xref="alg1.17.17.m1.1.1.3.2.2"><ci id="alg1.17.17.m1.1.1.3.2.2.1.cmml" xref="alg1.17.17.m1.1.1.3.2.2.1">~</ci><ci id="alg1.17.17.m1.1.1.3.2.2.2.cmml" xref="alg1.17.17.m1.1.1.3.2.2.2">𝐦</ci></apply><ci id="alg1.17.17.m1.1.1.3.2.3.cmml" xref="alg1.17.17.m1.1.1.3.2.3">𝑖</ci></apply><compose id="alg1.17.17.m1.1.1.3.3.cmml" xref="alg1.17.17.m1.1.1.3.3"></compose></apply><apply id="alg1.17.17.m1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1"><times id="alg1.17.17.m1.1.1.1.2.cmml" xref="alg1.17.17.m1.1.1.1.2"></times><apply id="alg1.17.17.m1.1.1.1.3.cmml" xref="alg1.17.17.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.17.17.m1.1.1.1.3.1.cmml" xref="alg1.17.17.m1.1.1.1.3">subscript</csymbol><ci id="alg1.17.17.m1.1.1.1.3.2.cmml" xref="alg1.17.17.m1.1.1.1.3.2">𝔼</ci><apply id="alg1.17.17.m1.1.1.1.3.3.cmml" xref="alg1.17.17.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.17.17.m1.1.1.1.3.3.1.cmml" xref="alg1.17.17.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.17.17.m1.1.1.1.3.3.2.cmml" xref="alg1.17.17.m1.1.1.1.3.3.2">𝑧</ci><ci id="alg1.17.17.m1.1.1.1.3.3.3.cmml" xref="alg1.17.17.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="alg1.17.17.m1.1.1.1.1.2.cmml" xref="alg1.17.17.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.17.17.m1.1.1.1.1.2.1.cmml" xref="alg1.17.17.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.17.17.m1.1.1.1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1"><times id="alg1.17.17.m1.1.1.1.1.1.1.2.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.2"></times><apply id="alg1.17.17.m1.1.1.1.1.1.1.3.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.17.17.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.17.17.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="alg1.17.17.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.17.17.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m1.1c">\mathbf{\tilde{m}}_{i}^{\circ}=\mathbb{E}_{z_{k}}\left[\phi_{k}(x_{i})\right]</annotation><annotation encoding="application/x-llamapun" id="alg1.17.17.m1.1d">over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.18.18">                 <span class="ltx_text ltx_font_typewriter" id="alg1.18.18.1"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.18.18.1.1.m1.1"><semantics id="alg1.18.18.1.1.m1.1a"><mo id="alg1.18.18.1.1.m1.1.1" xref="alg1.18.18.1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.18.18.1.1.m1.1b"><ci id="alg1.18.18.1.1.m1.1.1.cmml" xref="alg1.18.18.1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.18.18.1.1.m1.1d">▷</annotation></semantics></math> </span><span class="ltx_text ltx_font_typewriter" id="alg1.18.18.2">Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E19" title="In 3.3.3 Feature Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">19</span></a>)</span>
</div>
<div class="ltx_listingline" id="alg1.27.33">               

</div>
<div class="ltx_listingline" id="alg1.19.19">               Obtain <math alttext="{\tilde{o}}_{i}" class="ltx_Math" display="inline" id="alg1.19.19.m1.1"><semantics id="alg1.19.19.m1.1a"><msub id="alg1.19.19.m1.1.1" xref="alg1.19.19.m1.1.1.cmml"><mover accent="true" id="alg1.19.19.m1.1.1.2" xref="alg1.19.19.m1.1.1.2.cmml"><mi id="alg1.19.19.m1.1.1.2.2" xref="alg1.19.19.m1.1.1.2.2.cmml">o</mi><mo id="alg1.19.19.m1.1.1.2.1" xref="alg1.19.19.m1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.19.19.m1.1.1.3" xref="alg1.19.19.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.1b"><apply id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.1.cmml" xref="alg1.19.19.m1.1.1">subscript</csymbol><apply id="alg1.19.19.m1.1.1.2.cmml" xref="alg1.19.19.m1.1.1.2"><ci id="alg1.19.19.m1.1.1.2.1.cmml" xref="alg1.19.19.m1.1.1.2.1">~</ci><ci id="alg1.19.19.m1.1.1.2.2.cmml" xref="alg1.19.19.m1.1.1.2.2">𝑜</ci></apply><ci id="alg1.19.19.m1.1.1.3.cmml" xref="alg1.19.19.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.1c">{\tilde{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.19.19.m1.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E14" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">14</span></a>)

</div>
<div class="ltx_listingline" id="alg1.20.20">               Obtain <math alttext="{\hat{o}}_{i}" class="ltx_Math" display="inline" id="alg1.20.20.m1.1"><semantics id="alg1.20.20.m1.1a"><msub id="alg1.20.20.m1.1.1" xref="alg1.20.20.m1.1.1.cmml"><mover accent="true" id="alg1.20.20.m1.1.1.2" xref="alg1.20.20.m1.1.1.2.cmml"><mi id="alg1.20.20.m1.1.1.2.2" xref="alg1.20.20.m1.1.1.2.2.cmml">o</mi><mo id="alg1.20.20.m1.1.1.2.1" xref="alg1.20.20.m1.1.1.2.1.cmml">^</mo></mover><mi id="alg1.20.20.m1.1.1.3" xref="alg1.20.20.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.20.20.m1.1b"><apply id="alg1.20.20.m1.1.1.cmml" xref="alg1.20.20.m1.1.1"><csymbol cd="ambiguous" id="alg1.20.20.m1.1.1.1.cmml" xref="alg1.20.20.m1.1.1">subscript</csymbol><apply id="alg1.20.20.m1.1.1.2.cmml" xref="alg1.20.20.m1.1.1.2"><ci id="alg1.20.20.m1.1.1.2.1.cmml" xref="alg1.20.20.m1.1.1.2.1">^</ci><ci id="alg1.20.20.m1.1.1.2.2.cmml" xref="alg1.20.20.m1.1.1.2.2">𝑜</ci></apply><ci id="alg1.20.20.m1.1.1.3.cmml" xref="alg1.20.20.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m1.1c">{\hat{o}}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.20.20.m1.1d">over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E15" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">15</span></a>)

</div>
<div class="ltx_listingline" id="alg1.21.21">                 <math alttext="\}" class="ltx_Math" display="inline" id="alg1.21.21.m1.1"><semantics id="alg1.21.21.m1.1a"><mo id="alg1.21.21.m1.1.1" stretchy="false" xref="alg1.21.21.m1.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="alg1.21.21.m1.1b"><ci id="alg1.21.21.m1.1.1.cmml" xref="alg1.21.21.m1.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m1.1c">\}</annotation><annotation encoding="application/x-llamapun" id="alg1.21.21.m1.1d">}</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.27.34">               
</div>
<div class="ltx_listingline" id="alg1.22.22">               <math alttext="\mathcal{L}_{BDA}=\sum_{i}d(\mathbf{\tilde{m}}_{i}^{\circ},\mathbf{\hat{m}}_{i})" class="ltx_Math" display="inline" id="alg1.22.22.m1.2"><semantics id="alg1.22.22.m1.2a"><mrow id="alg1.22.22.m1.2.2" xref="alg1.22.22.m1.2.2.cmml"><msub id="alg1.22.22.m1.2.2.4" xref="alg1.22.22.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.22.22.m1.2.2.4.2" xref="alg1.22.22.m1.2.2.4.2.cmml">ℒ</mi><mrow id="alg1.22.22.m1.2.2.4.3" xref="alg1.22.22.m1.2.2.4.3.cmml"><mi id="alg1.22.22.m1.2.2.4.3.2" xref="alg1.22.22.m1.2.2.4.3.2.cmml">B</mi><mo id="alg1.22.22.m1.2.2.4.3.1" xref="alg1.22.22.m1.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.22.22.m1.2.2.4.3.3" xref="alg1.22.22.m1.2.2.4.3.3.cmml">D</mi><mo id="alg1.22.22.m1.2.2.4.3.1a" xref="alg1.22.22.m1.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.22.22.m1.2.2.4.3.4" xref="alg1.22.22.m1.2.2.4.3.4.cmml">A</mi></mrow></msub><mo id="alg1.22.22.m1.2.2.3" rspace="0.111em" xref="alg1.22.22.m1.2.2.3.cmml">=</mo><mrow id="alg1.22.22.m1.2.2.2" xref="alg1.22.22.m1.2.2.2.cmml"><msub id="alg1.22.22.m1.2.2.2.3" xref="alg1.22.22.m1.2.2.2.3.cmml"><mo id="alg1.22.22.m1.2.2.2.3.2" xref="alg1.22.22.m1.2.2.2.3.2.cmml">∑</mo><mi id="alg1.22.22.m1.2.2.2.3.3" xref="alg1.22.22.m1.2.2.2.3.3.cmml">i</mi></msub><mrow id="alg1.22.22.m1.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.cmml"><mi id="alg1.22.22.m1.2.2.2.2.4" xref="alg1.22.22.m1.2.2.2.2.4.cmml">d</mi><mo id="alg1.22.22.m1.2.2.2.2.3" xref="alg1.22.22.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="alg1.22.22.m1.2.2.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.2.3.cmml"><mo id="alg1.22.22.m1.2.2.2.2.2.2.3" stretchy="false" xref="alg1.22.22.m1.2.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.22.22.m1.1.1.1.1.1.1.1" xref="alg1.22.22.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.22.22.m1.1.1.1.1.1.1.1.2.2" xref="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.2.cmml">𝐦</mi><mo id="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.1" xref="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="alg1.22.22.m1.1.1.1.1.1.1.1.2.3" xref="alg1.22.22.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mo id="alg1.22.22.m1.1.1.1.1.1.1.1.3" xref="alg1.22.22.m1.1.1.1.1.1.1.1.3.cmml">∘</mo></msubsup><mo id="alg1.22.22.m1.2.2.2.2.2.2.4" xref="alg1.22.22.m1.2.2.2.2.2.3.cmml">,</mo><msub id="alg1.22.22.m1.2.2.2.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.2.2.2.cmml"><mover accent="true" id="alg1.22.22.m1.2.2.2.2.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.2.2.2.2.cmml"><mi id="alg1.22.22.m1.2.2.2.2.2.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.2.2.2.2.2.cmml">𝐦</mi><mo id="alg1.22.22.m1.2.2.2.2.2.2.2.2.1" xref="alg1.22.22.m1.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.22.22.m1.2.2.2.2.2.2.2.3" xref="alg1.22.22.m1.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.22.22.m1.2.2.2.2.2.2.5" stretchy="false" xref="alg1.22.22.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.22.m1.2b"><apply id="alg1.22.22.m1.2.2.cmml" xref="alg1.22.22.m1.2.2"><eq id="alg1.22.22.m1.2.2.3.cmml" xref="alg1.22.22.m1.2.2.3"></eq><apply id="alg1.22.22.m1.2.2.4.cmml" xref="alg1.22.22.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.22.22.m1.2.2.4.1.cmml" xref="alg1.22.22.m1.2.2.4">subscript</csymbol><ci id="alg1.22.22.m1.2.2.4.2.cmml" xref="alg1.22.22.m1.2.2.4.2">ℒ</ci><apply id="alg1.22.22.m1.2.2.4.3.cmml" xref="alg1.22.22.m1.2.2.4.3"><times id="alg1.22.22.m1.2.2.4.3.1.cmml" xref="alg1.22.22.m1.2.2.4.3.1"></times><ci id="alg1.22.22.m1.2.2.4.3.2.cmml" xref="alg1.22.22.m1.2.2.4.3.2">𝐵</ci><ci id="alg1.22.22.m1.2.2.4.3.3.cmml" xref="alg1.22.22.m1.2.2.4.3.3">𝐷</ci><ci id="alg1.22.22.m1.2.2.4.3.4.cmml" xref="alg1.22.22.m1.2.2.4.3.4">𝐴</ci></apply></apply><apply id="alg1.22.22.m1.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2"><apply id="alg1.22.22.m1.2.2.2.3.cmml" xref="alg1.22.22.m1.2.2.2.3"><csymbol cd="ambiguous" id="alg1.22.22.m1.2.2.2.3.1.cmml" xref="alg1.22.22.m1.2.2.2.3">subscript</csymbol><sum id="alg1.22.22.m1.2.2.2.3.2.cmml" xref="alg1.22.22.m1.2.2.2.3.2"></sum><ci id="alg1.22.22.m1.2.2.2.3.3.cmml" xref="alg1.22.22.m1.2.2.2.3.3">𝑖</ci></apply><apply id="alg1.22.22.m1.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2"><times id="alg1.22.22.m1.2.2.2.2.3.cmml" xref="alg1.22.22.m1.2.2.2.2.3"></times><ci id="alg1.22.22.m1.2.2.2.2.4.cmml" xref="alg1.22.22.m1.2.2.2.2.4">𝑑</ci><interval closure="open" id="alg1.22.22.m1.2.2.2.2.2.3.cmml" xref="alg1.22.22.m1.2.2.2.2.2.2"><apply id="alg1.22.22.m1.1.1.1.1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.22.22.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1.2.2"><ci id="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1.2.2.2">𝐦</ci></apply><ci id="alg1.22.22.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><compose id="alg1.22.22.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.22.22.m1.1.1.1.1.1.1.1.3"></compose></apply><apply id="alg1.22.22.m1.2.2.2.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.22.22.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.22.22.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="alg1.22.22.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2.2.2.2.2"><ci id="alg1.22.22.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.22.22.m1.2.2.2.2.2.2.2.2.1">^</ci><ci id="alg1.22.22.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2.2.2.2.2.2">𝐦</ci></apply><ci id="alg1.22.22.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.22.22.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.m1.2c">\mathcal{L}_{BDA}=\sum_{i}d(\mathbf{\tilde{m}}_{i}^{\circ},\mathbf{\hat{m}}_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.22.22.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_d ( over~ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT , over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.23.23">                 <span class="ltx_text ltx_font_typewriter" id="alg1.23.23.1"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.23.23.1.1.m1.1"><semantics id="alg1.23.23.1.1.m1.1a"><mo id="alg1.23.23.1.1.m1.1.1" xref="alg1.23.23.1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.23.23.1.1.m1.1b"><ci id="alg1.23.23.1.1.m1.1.1.cmml" xref="alg1.23.23.1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.23.23.1.1.m1.1d">▷</annotation></semantics></math> </span><span class="ltx_text ltx_font_typewriter" id="alg1.23.23.2">Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E20" title="In 3.3.3 Feature Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">20</span></a>)</span>
</div>
<div class="ltx_listingline" id="alg1.27.35">               

</div>
<div class="ltx_listingline" id="alg1.24.24">               <math alttext="\mathcal{L}_{FDA}=\sum_{i}\left(L_{kd}({\tilde{o}}_{i},{\hat{o}}_{i})+L_{ce}({%
\tilde{o}}_{i},{o}_{i})\right)" class="ltx_Math" display="inline" id="alg1.24.24.m1.1"><semantics id="alg1.24.24.m1.1a"><mrow id="alg1.24.24.m1.1.1" xref="alg1.24.24.m1.1.1.cmml"><msub id="alg1.24.24.m1.1.1.3" xref="alg1.24.24.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.24.m1.1.1.3.2" xref="alg1.24.24.m1.1.1.3.2.cmml">ℒ</mi><mrow id="alg1.24.24.m1.1.1.3.3" xref="alg1.24.24.m1.1.1.3.3.cmml"><mi id="alg1.24.24.m1.1.1.3.3.2" xref="alg1.24.24.m1.1.1.3.3.2.cmml">F</mi><mo id="alg1.24.24.m1.1.1.3.3.1" xref="alg1.24.24.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.24.24.m1.1.1.3.3.3" xref="alg1.24.24.m1.1.1.3.3.3.cmml">D</mi><mo id="alg1.24.24.m1.1.1.3.3.1a" xref="alg1.24.24.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.24.24.m1.1.1.3.3.4" xref="alg1.24.24.m1.1.1.3.3.4.cmml">A</mi></mrow></msub><mo id="alg1.24.24.m1.1.1.2" rspace="0.111em" xref="alg1.24.24.m1.1.1.2.cmml">=</mo><mrow id="alg1.24.24.m1.1.1.1" xref="alg1.24.24.m1.1.1.1.cmml"><msub id="alg1.24.24.m1.1.1.1.2" xref="alg1.24.24.m1.1.1.1.2.cmml"><mo id="alg1.24.24.m1.1.1.1.2.2" rspace="0em" xref="alg1.24.24.m1.1.1.1.2.2.cmml">∑</mo><mi id="alg1.24.24.m1.1.1.1.2.3" xref="alg1.24.24.m1.1.1.1.2.3.cmml">i</mi></msub><mrow id="alg1.24.24.m1.1.1.1.1.1" xref="alg1.24.24.m1.1.1.1.1.1.1.cmml"><mo id="alg1.24.24.m1.1.1.1.1.1.2" xref="alg1.24.24.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.24.24.m1.1.1.1.1.1.1" xref="alg1.24.24.m1.1.1.1.1.1.1.cmml"><mrow id="alg1.24.24.m1.1.1.1.1.1.1.2" xref="alg1.24.24.m1.1.1.1.1.1.1.2.cmml"><msub id="alg1.24.24.m1.1.1.1.1.1.1.2.4" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.cmml"><mi id="alg1.24.24.m1.1.1.1.1.1.1.2.4.2" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.2.cmml">L</mi><mrow id="alg1.24.24.m1.1.1.1.1.1.1.2.4.3" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.cmml"><mi id="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.2" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.2.cmml">k</mi><mo id="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.1" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi id="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.3" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.3.cmml">d</mi></mrow></msub><mo id="alg1.24.24.m1.1.1.1.1.1.1.2.3" xref="alg1.24.24.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.3.cmml"><mo id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mo id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.1" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.4" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">o</mi><mo id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.1" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.3" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.24.24.m1.1.1.1.1.1.1.5" xref="alg1.24.24.m1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="alg1.24.24.m1.1.1.1.1.1.1.4" xref="alg1.24.24.m1.1.1.1.1.1.1.4.cmml"><msub id="alg1.24.24.m1.1.1.1.1.1.1.4.4" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.cmml"><mi id="alg1.24.24.m1.1.1.1.1.1.1.4.4.2" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.2.cmml">L</mi><mrow id="alg1.24.24.m1.1.1.1.1.1.1.4.4.3" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.cmml"><mi id="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.2" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.2.cmml">c</mi><mo id="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.1" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.1.cmml">⁢</mo><mi id="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.3" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.3.cmml">e</mi></mrow></msub><mo id="alg1.24.24.m1.1.1.1.1.1.1.4.3" xref="alg1.24.24.m1.1.1.1.1.1.1.4.3.cmml">⁢</mo><mrow id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.3.cmml"><mo id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.3" stretchy="false" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msub id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.cmml"><mover accent="true" id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.cmml"><mi id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.2.cmml">o</mi><mo id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.1" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.3" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.3.cmml">i</mi></msub><mo id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.4" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.3.cmml">,</mo><msub id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.cmml"><mi id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.2" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.2.cmml">o</mi><mi id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.3" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.3.cmml">i</mi></msub><mo id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.5" stretchy="false" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.24.24.m1.1.1.1.1.1.3" xref="alg1.24.24.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.24.24.m1.1b"><apply id="alg1.24.24.m1.1.1.cmml" xref="alg1.24.24.m1.1.1"><eq id="alg1.24.24.m1.1.1.2.cmml" xref="alg1.24.24.m1.1.1.2"></eq><apply id="alg1.24.24.m1.1.1.3.cmml" xref="alg1.24.24.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.3.1.cmml" xref="alg1.24.24.m1.1.1.3">subscript</csymbol><ci id="alg1.24.24.m1.1.1.3.2.cmml" xref="alg1.24.24.m1.1.1.3.2">ℒ</ci><apply id="alg1.24.24.m1.1.1.3.3.cmml" xref="alg1.24.24.m1.1.1.3.3"><times id="alg1.24.24.m1.1.1.3.3.1.cmml" xref="alg1.24.24.m1.1.1.3.3.1"></times><ci id="alg1.24.24.m1.1.1.3.3.2.cmml" xref="alg1.24.24.m1.1.1.3.3.2">𝐹</ci><ci id="alg1.24.24.m1.1.1.3.3.3.cmml" xref="alg1.24.24.m1.1.1.3.3.3">𝐷</ci><ci id="alg1.24.24.m1.1.1.3.3.4.cmml" xref="alg1.24.24.m1.1.1.3.3.4">𝐴</ci></apply></apply><apply id="alg1.24.24.m1.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1"><apply id="alg1.24.24.m1.1.1.1.2.cmml" xref="alg1.24.24.m1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.2.1.cmml" xref="alg1.24.24.m1.1.1.1.2">subscript</csymbol><sum id="alg1.24.24.m1.1.1.1.2.2.cmml" xref="alg1.24.24.m1.1.1.1.2.2"></sum><ci id="alg1.24.24.m1.1.1.1.2.3.cmml" xref="alg1.24.24.m1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.24.24.m1.1.1.1.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1"><plus id="alg1.24.24.m1.1.1.1.1.1.1.5.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.5"></plus><apply id="alg1.24.24.m1.1.1.1.1.1.1.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2"><times id="alg1.24.24.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.3"></times><apply id="alg1.24.24.m1.1.1.1.1.1.1.2.4.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.1.1.1.2.4.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="alg1.24.24.m1.1.1.1.1.1.1.2.4.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.2">𝐿</ci><apply id="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.3"><times id="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.1"></times><ci id="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.2">𝑘</ci><ci id="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.4.3.3">𝑑</ci></apply></apply><interval closure="open" id="alg1.24.24.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2"><apply id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2"><ci id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑜</ci></apply><ci id="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2"><ci id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.1">^</ci><ci id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.2.2">𝑜</ci></apply><ci id="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="alg1.24.24.m1.1.1.1.1.1.1.4.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4"><times id="alg1.24.24.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.3"></times><apply id="alg1.24.24.m1.1.1.1.1.1.1.4.4.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.1.1.1.4.4.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="alg1.24.24.m1.1.1.1.1.1.1.4.4.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.2">𝐿</ci><apply id="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.3"><times id="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.1"></times><ci id="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.2">𝑐</ci><ci id="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.4.3.3">𝑒</ci></apply></apply><interval closure="open" id="alg1.24.24.m1.1.1.1.1.1.1.4.2.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.2"><apply id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><apply id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2"><ci id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.1">~</ci><ci id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.2.2">𝑜</ci></apply><ci id="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.3.1.1.1.3">𝑖</ci></apply><apply id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.2">𝑜</ci><ci id="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.4.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m1.1c">\mathcal{L}_{FDA}=\sum_{i}\left(L_{kd}({\tilde{o}}_{i},{\hat{o}}_{i})+L_{ce}({%
\tilde{o}}_{i},{o}_{i})\right)</annotation><annotation encoding="application/x-llamapun" id="alg1.24.24.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_L start_POSTSUBSCRIPT italic_k italic_d end_POSTSUBSCRIPT ( over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT ( over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.25.25">                 <span class="ltx_text ltx_font_typewriter" id="alg1.25.25.1"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.25.25.1.1.m1.1"><semantics id="alg1.25.25.1.1.m1.1a"><mo id="alg1.25.25.1.1.m1.1.1" xref="alg1.25.25.1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.25.25.1.1.m1.1b"><ci id="alg1.25.25.1.1.m1.1.1.cmml" xref="alg1.25.25.1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.25.25.1.1.m1.1d">▷</annotation></semantics></math> </span><span class="ltx_text ltx_font_typewriter" id="alg1.25.25.2">Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E16" title="In 3.3.2 Front-door Adjustment for Causal Label Distillation ‣ 3.3 Causal Multi-teacher Distillation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">16</span></a>) </span>
</div>
<div class="ltx_listingline" id="alg1.27.36">               

</div>
<div class="ltx_listingline" id="alg1.26.26">               Obtain <math alttext="\mathcal{L}_{Rec}" class="ltx_Math" display="inline" id="alg1.26.26.m1.1"><semantics id="alg1.26.26.m1.1a"><msub id="alg1.26.26.m1.1.1" xref="alg1.26.26.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.26.26.m1.1.1.2" xref="alg1.26.26.m1.1.1.2.cmml">ℒ</mi><mrow id="alg1.26.26.m1.1.1.3" xref="alg1.26.26.m1.1.1.3.cmml"><mi id="alg1.26.26.m1.1.1.3.2" xref="alg1.26.26.m1.1.1.3.2.cmml">R</mi><mo id="alg1.26.26.m1.1.1.3.1" xref="alg1.26.26.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.26.26.m1.1.1.3.3" xref="alg1.26.26.m1.1.1.3.3.cmml">e</mi><mo id="alg1.26.26.m1.1.1.3.1a" xref="alg1.26.26.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.26.26.m1.1.1.3.4" xref="alg1.26.26.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.26.26.m1.1b"><apply id="alg1.26.26.m1.1.1.cmml" xref="alg1.26.26.m1.1.1"><csymbol cd="ambiguous" id="alg1.26.26.m1.1.1.1.cmml" xref="alg1.26.26.m1.1.1">subscript</csymbol><ci id="alg1.26.26.m1.1.1.2.cmml" xref="alg1.26.26.m1.1.1.2">ℒ</ci><apply id="alg1.26.26.m1.1.1.3.cmml" xref="alg1.26.26.m1.1.1.3"><times id="alg1.26.26.m1.1.1.3.1.cmml" xref="alg1.26.26.m1.1.1.3.1"></times><ci id="alg1.26.26.m1.1.1.3.2.cmml" xref="alg1.26.26.m1.1.1.3.2">𝑅</ci><ci id="alg1.26.26.m1.1.1.3.3.cmml" xref="alg1.26.26.m1.1.1.3.3">𝑒</ci><ci id="alg1.26.26.m1.1.1.3.4.cmml" xref="alg1.26.26.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.26.m1.1c">\mathcal{L}_{Rec}</annotation><annotation encoding="application/x-llamapun" id="alg1.26.26.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> with BPR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib22" title="">22</a>]</cite>, etc.

</div>
<div class="ltx_listingline" id="alg1.27.27">               Optimize <math alttext="\Theta" class="ltx_Math" display="inline" id="alg1.27.27.m1.1"><semantics id="alg1.27.27.m1.1a"><mi id="alg1.27.27.m1.1.1" mathvariant="normal" xref="alg1.27.27.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="alg1.27.27.m1.1b"><ci id="alg1.27.27.m1.1.1.cmml" xref="alg1.27.27.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.27.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="alg1.27.27.m1.1d">roman_Θ</annotation></semantics></math> over Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E22" title="In 3.4 Model Training ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">22</span></a>)

</div>
<div class="ltx_listingline" id="alg1.27.37">                 end while
</div>
<div class="ltx_listingline" id="alg1.27.38">               
</div>
<div class="ltx_listingline" id="alg1.27.39">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.29.1.1">Algorithm 1</span> </span>Causal Multi-teacher Distillation</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span><span class="ltx_text ltx_font_italic" id="S3.SS5.1.1">Method Analysis</span>
</h3>
<section class="ltx_subsubsection" id="S3.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.1 </span>Training Complexity</h4>
<div class="ltx_para" id="S3.SS5.SSS1.p1">
<p class="ltx_p" id="S3.SS5.SSS1.p1.8">The computation complexity of CausalD mainly comes from the following processes:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S3.I1.i1.p1.1.1">Teacher Pre-training.</span> Teachers are trained on non-overlapping subsets of the whole recommendation dataset. Each teacher is with the same neural network architecture as the student. As such, supposing the number of epochs in training the teachers and the student remains the same, the complexity of training all teachers approximates the complexity of training the student.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.3"><span class="ltx_text ltx_font_italic" id="S3.I1.i2.p1.3.1">Feature encoding.</span> Supposing that the encoding complexity of the student is <math alttext="O(E)" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><mrow id="S3.I1.i2.p1.1.m1.1.2" xref="S3.I1.i2.p1.1.m1.1.2.cmml"><mi id="S3.I1.i2.p1.1.m1.1.2.2" xref="S3.I1.i2.p1.1.m1.1.2.2.cmml">O</mi><mo id="S3.I1.i2.p1.1.m1.1.2.1" xref="S3.I1.i2.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.I1.i2.p1.1.m1.1.2.3.2" xref="S3.I1.i2.p1.1.m1.1.2.cmml"><mo id="S3.I1.i2.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.I1.i2.p1.1.m1.1.2.cmml">(</mo><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">E</mi><mo id="S3.I1.i2.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.I1.i2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2"><times id="S3.I1.i2.p1.1.m1.1.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.2.1"></times><ci id="S3.I1.i2.p1.1.m1.1.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2">𝑂</ci><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">O(E)</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_O ( italic_E )</annotation></semantics></math>, the encoding complexity of the causal distillation framework will be <math alttext="O(KE+E)" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1"><semantics id="S3.I1.i2.p1.2.m2.1a"><mrow id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml">O</mi><mo id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.I1.i2.p1.2.m2.1.1.1.1" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.I1.i2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.2.m2.1.1.1.1.1" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.cmml"><mrow id="S3.I1.i2.p1.2.m2.1.1.1.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.2" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.2.cmml">K</mi><mo id="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.1" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.3" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.3.cmml">E</mi></mrow><mo id="S3.I1.i2.p1.2.m2.1.1.1.1.1.1" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml">+</mo><mi id="S3.I1.i2.p1.2.m2.1.1.1.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.3.cmml">E</mi></mrow><mo id="S3.I1.i2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><times id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2"></times><ci id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3">𝑂</ci><apply id="S3.I1.i2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1.1"><plus id="S3.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.1"></plus><apply id="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.2"><times id="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.1"></times><ci id="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.2">𝐾</ci><ci id="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.2.3">𝐸</ci></apply><ci id="S3.I1.i2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1.1.1.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">O(KE+E)</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.1d">italic_O ( italic_K italic_E + italic_E )</annotation></semantics></math> where <math alttext="K" class="ltx_Math" display="inline" id="S3.I1.i2.p1.3.m3.1"><semantics id="S3.I1.i2.p1.3.m3.1a"><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.3.m3.1d">italic_K</annotation></semantics></math> denotes the number of teachers. Note that the teacher encoder and the student encoder have the same structure.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.10"><span class="ltx_text ltx_font_italic" id="S3.I1.i3.p1.10.1">Prediction.</span> Supposing that there are <math alttext="L^{*}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.1.m1.1"><semantics id="S3.I1.i3.p1.1.m1.1a"><msup id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml">L</mi><mo id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">𝐿</ci><times id="S3.I1.i3.p1.1.m1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">L^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.1.m1.1d">italic_L start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> layers in <math alttext="\psi^{*}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.2.m2.1"><semantics id="S3.I1.i3.p1.2.m2.1a"><msup id="S3.I1.i3.p1.2.m2.1.1" xref="S3.I1.i3.p1.2.m2.1.1.cmml"><mi id="S3.I1.i3.p1.2.m2.1.1.2" xref="S3.I1.i3.p1.2.m2.1.1.2.cmml">ψ</mi><mo id="S3.I1.i3.p1.2.m2.1.1.3" xref="S3.I1.i3.p1.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.1b"><apply id="S3.I1.i3.p1.2.m2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.2.m2.1.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.I1.i3.p1.2.m2.1.1.2.cmml" xref="S3.I1.i3.p1.2.m2.1.1.2">𝜓</ci><times id="S3.I1.i3.p1.2.m2.1.1.3.cmml" xref="S3.I1.i3.p1.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.1c">\psi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.2.m2.1d">italic_ψ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> and the number of hidden units in the <math alttext="l" class="ltx_Math" display="inline" id="S3.I1.i3.p1.3.m3.1"><semantics id="S3.I1.i3.p1.3.m3.1a"><mi id="S3.I1.i3.p1.3.m3.1.1" xref="S3.I1.i3.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.3.m3.1b"><ci id="S3.I1.i3.p1.3.m3.1.1.cmml" xref="S3.I1.i3.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.3.m3.1d">italic_l</annotation></semantics></math>-th layer is <math alttext="d_{l}^{*}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.4.m4.1"><semantics id="S3.I1.i3.p1.4.m4.1a"><msubsup id="S3.I1.i3.p1.4.m4.1.1" xref="S3.I1.i3.p1.4.m4.1.1.cmml"><mi id="S3.I1.i3.p1.4.m4.1.1.2.2" xref="S3.I1.i3.p1.4.m4.1.1.2.2.cmml">d</mi><mi id="S3.I1.i3.p1.4.m4.1.1.2.3" xref="S3.I1.i3.p1.4.m4.1.1.2.3.cmml">l</mi><mo id="S3.I1.i3.p1.4.m4.1.1.3" xref="S3.I1.i3.p1.4.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.4.m4.1b"><apply id="S3.I1.i3.p1.4.m4.1.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.4.m4.1.1.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1">superscript</csymbol><apply id="S3.I1.i3.p1.4.m4.1.1.2.cmml" xref="S3.I1.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.4.m4.1.1.2.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.4.m4.1.1.2.2.cmml" xref="S3.I1.i3.p1.4.m4.1.1.2.2">𝑑</ci><ci id="S3.I1.i3.p1.4.m4.1.1.2.3.cmml" xref="S3.I1.i3.p1.4.m4.1.1.2.3">𝑙</ci></apply><times id="S3.I1.i3.p1.4.m4.1.1.3.cmml" xref="S3.I1.i3.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.4.m4.1c">d_{l}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, the prediction complexity of the student can be <math alttext="O(\sum_{l=1}^{L^{*}}d_{l}^{*}d_{l-1}^{*})" class="ltx_Math" display="inline" id="S3.I1.i3.p1.5.m5.1"><semantics id="S3.I1.i3.p1.5.m5.1a"><mrow id="S3.I1.i3.p1.5.m5.1.1" xref="S3.I1.i3.p1.5.m5.1.1.cmml"><mi id="S3.I1.i3.p1.5.m5.1.1.3" xref="S3.I1.i3.p1.5.m5.1.1.3.cmml">O</mi><mo id="S3.I1.i3.p1.5.m5.1.1.2" xref="S3.I1.i3.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.I1.i3.p1.5.m5.1.1.1.1" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.cmml"><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i3.p1.5.m5.1.1.1.1.1" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.cmml"><msubsup id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.2" lspace="0em" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.cmml"><mi id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.2" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.2.cmml">l</mi><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.1" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><msup id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.2" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.2.cmml">L</mi><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.3.cmml">∗</mo></msup></msubsup><mrow id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.cmml"><msubsup id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.cmml"><mi id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.2" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.2.cmml">d</mi><mi id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.3.cmml">l</mi><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.3.cmml">∗</mo></msubsup><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.1" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.cmml"><mi id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.2" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.2.cmml">d</mi><mrow id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.cmml"><mi id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.2" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.2.cmml">l</mi><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.1" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.1.cmml">−</mo><mn id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.3" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.3.cmml">∗</mo></msubsup></mrow></mrow><mo id="S3.I1.i3.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.5.m5.1b"><apply id="S3.I1.i3.p1.5.m5.1.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1"><times id="S3.I1.i3.p1.5.m5.1.1.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.2"></times><ci id="S3.I1.i3.p1.5.m5.1.1.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.3">𝑂</ci><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1"><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1">subscript</csymbol><sum id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.2"></sum><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3"><eq id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.2">𝑙</ci><cn id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.2">𝐿</ci><times id="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.1.3.3"></times></apply></apply><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2"><times id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.1"></times><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.2">𝑑</ci><ci id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.2.3">𝑙</ci></apply><times id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.2.3"></times></apply><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.2">𝑑</ci><apply id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3"><minus id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.1"></minus><ci id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.2.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.2">𝑙</ci><cn id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.3.cmml" type="integer" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><times id="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.3.cmml" xref="S3.I1.i3.p1.5.m5.1.1.1.1.1.2.3.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.5.m5.1c">O(\sum_{l=1}^{L^{*}}d_{l}^{*}d_{l-1}^{*})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.5.m5.1d">italic_O ( ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math>. Supposing that there are <math alttext="\tilde{L}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.6.m6.1"><semantics id="S3.I1.i3.p1.6.m6.1a"><mover accent="true" id="S3.I1.i3.p1.6.m6.1.1" xref="S3.I1.i3.p1.6.m6.1.1.cmml"><mi id="S3.I1.i3.p1.6.m6.1.1.2" xref="S3.I1.i3.p1.6.m6.1.1.2.cmml">L</mi><mo id="S3.I1.i3.p1.6.m6.1.1.1" xref="S3.I1.i3.p1.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.6.m6.1b"><apply id="S3.I1.i3.p1.6.m6.1.1.cmml" xref="S3.I1.i3.p1.6.m6.1.1"><ci id="S3.I1.i3.p1.6.m6.1.1.1.cmml" xref="S3.I1.i3.p1.6.m6.1.1.1">~</ci><ci id="S3.I1.i3.p1.6.m6.1.1.2.cmml" xref="S3.I1.i3.p1.6.m6.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.6.m6.1c">\tilde{L}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.6.m6.1d">over~ start_ARG italic_L end_ARG</annotation></semantics></math> layers in <math alttext="\psi_{FDA}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.7.m7.1"><semantics id="S3.I1.i3.p1.7.m7.1a"><msub id="S3.I1.i3.p1.7.m7.1.1" xref="S3.I1.i3.p1.7.m7.1.1.cmml"><mi id="S3.I1.i3.p1.7.m7.1.1.2" xref="S3.I1.i3.p1.7.m7.1.1.2.cmml">ψ</mi><mrow id="S3.I1.i3.p1.7.m7.1.1.3" xref="S3.I1.i3.p1.7.m7.1.1.3.cmml"><mi id="S3.I1.i3.p1.7.m7.1.1.3.2" xref="S3.I1.i3.p1.7.m7.1.1.3.2.cmml">F</mi><mo id="S3.I1.i3.p1.7.m7.1.1.3.1" xref="S3.I1.i3.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.i3.p1.7.m7.1.1.3.3" xref="S3.I1.i3.p1.7.m7.1.1.3.3.cmml">D</mi><mo id="S3.I1.i3.p1.7.m7.1.1.3.1a" xref="S3.I1.i3.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.i3.p1.7.m7.1.1.3.4" xref="S3.I1.i3.p1.7.m7.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.7.m7.1b"><apply id="S3.I1.i3.p1.7.m7.1.1.cmml" xref="S3.I1.i3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.7.m7.1.1.1.cmml" xref="S3.I1.i3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.7.m7.1.1.2.cmml" xref="S3.I1.i3.p1.7.m7.1.1.2">𝜓</ci><apply id="S3.I1.i3.p1.7.m7.1.1.3.cmml" xref="S3.I1.i3.p1.7.m7.1.1.3"><times id="S3.I1.i3.p1.7.m7.1.1.3.1.cmml" xref="S3.I1.i3.p1.7.m7.1.1.3.1"></times><ci id="S3.I1.i3.p1.7.m7.1.1.3.2.cmml" xref="S3.I1.i3.p1.7.m7.1.1.3.2">𝐹</ci><ci id="S3.I1.i3.p1.7.m7.1.1.3.3.cmml" xref="S3.I1.i3.p1.7.m7.1.1.3.3">𝐷</ci><ci id="S3.I1.i3.p1.7.m7.1.1.3.4.cmml" xref="S3.I1.i3.p1.7.m7.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.7.m7.1c">\psi_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.7.m7.1d">italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> and the number of hidden units in the <math alttext="l" class="ltx_Math" display="inline" id="S3.I1.i3.p1.8.m8.1"><semantics id="S3.I1.i3.p1.8.m8.1a"><mi id="S3.I1.i3.p1.8.m8.1.1" xref="S3.I1.i3.p1.8.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.8.m8.1b"><ci id="S3.I1.i3.p1.8.m8.1.1.cmml" xref="S3.I1.i3.p1.8.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.8.m8.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.8.m8.1d">italic_l</annotation></semantics></math>-th layer is <math alttext="{\tilde{d}}_{l}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.9.m9.1"><semantics id="S3.I1.i3.p1.9.m9.1a"><msub id="S3.I1.i3.p1.9.m9.1.1" xref="S3.I1.i3.p1.9.m9.1.1.cmml"><mover accent="true" id="S3.I1.i3.p1.9.m9.1.1.2" xref="S3.I1.i3.p1.9.m9.1.1.2.cmml"><mi id="S3.I1.i3.p1.9.m9.1.1.2.2" xref="S3.I1.i3.p1.9.m9.1.1.2.2.cmml">d</mi><mo id="S3.I1.i3.p1.9.m9.1.1.2.1" xref="S3.I1.i3.p1.9.m9.1.1.2.1.cmml">~</mo></mover><mi id="S3.I1.i3.p1.9.m9.1.1.3" xref="S3.I1.i3.p1.9.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.9.m9.1b"><apply id="S3.I1.i3.p1.9.m9.1.1.cmml" xref="S3.I1.i3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.9.m9.1.1.1.cmml" xref="S3.I1.i3.p1.9.m9.1.1">subscript</csymbol><apply id="S3.I1.i3.p1.9.m9.1.1.2.cmml" xref="S3.I1.i3.p1.9.m9.1.1.2"><ci id="S3.I1.i3.p1.9.m9.1.1.2.1.cmml" xref="S3.I1.i3.p1.9.m9.1.1.2.1">~</ci><ci id="S3.I1.i3.p1.9.m9.1.1.2.2.cmml" xref="S3.I1.i3.p1.9.m9.1.1.2.2">𝑑</ci></apply><ci id="S3.I1.i3.p1.9.m9.1.1.3.cmml" xref="S3.I1.i3.p1.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.9.m9.1c">{\tilde{d}}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.9.m9.1d">over~ start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, the prediction complexity of the teachers can be <math alttext="O(\sum_{l=1}^{{\tilde{L}}^{*}}N_{b}K{\tilde{d}}_{l}{\tilde{d}}_{l-1})" class="ltx_Math" display="inline" id="S3.I1.i3.p1.10.m10.1"><semantics id="S3.I1.i3.p1.10.m10.1a"><mrow id="S3.I1.i3.p1.10.m10.1.1" xref="S3.I1.i3.p1.10.m10.1.1.cmml"><mi id="S3.I1.i3.p1.10.m10.1.1.3" xref="S3.I1.i3.p1.10.m10.1.1.3.cmml">O</mi><mo id="S3.I1.i3.p1.10.m10.1.1.2" xref="S3.I1.i3.p1.10.m10.1.1.2.cmml">⁢</mo><mrow id="S3.I1.i3.p1.10.m10.1.1.1.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.cmml"><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.2" stretchy="false" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i3.p1.10.m10.1.1.1.1.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.cmml"><msubsup id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.cmml"><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.2" lspace="0em" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.cmml"><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.2.cmml">l</mi><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><msup id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.cmml"><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.2.cmml">L</mi><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.3.cmml">∗</mo></msup></msubsup><mrow id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.cmml"><msub id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.cmml"><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.2.cmml">N</mi><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.3.cmml">b</mi></msub><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.3.cmml">K</mi><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.1a" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.cmml"><mover accent="true" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.cmml"><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.2.cmml">d</mi><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.1.cmml">~</mo></mover><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.3.cmml">l</mi></msub><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.1b" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.cmml"><mover accent="true" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.cmml"><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.2.cmml">d</mi><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.1.cmml">~</mo></mover><mrow id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.cmml"><mi id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.2" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.2.cmml">l</mi><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.1" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.1.cmml">−</mo><mn id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.3" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.I1.i3.p1.10.m10.1.1.1.1.3" stretchy="false" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.10.m10.1b"><apply id="S3.I1.i3.p1.10.m10.1.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1"><times id="S3.I1.i3.p1.10.m10.1.1.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.2"></times><ci id="S3.I1.i3.p1.10.m10.1.1.3.cmml" xref="S3.I1.i3.p1.10.m10.1.1.3">𝑂</ci><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1"><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1">superscript</csymbol><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1">subscript</csymbol><sum id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.2"></sum><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3"><eq id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.2">𝑙</ci><cn id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2"><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.1">~</ci><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><times id="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.3.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.1.3.3"></times></apply></apply><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2"><times id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.1"></times><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.2">𝑁</ci><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.3.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.2.3">𝑏</ci></apply><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.3.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.3">𝐾</ci><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4">subscript</csymbol><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2"><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.1">~</ci><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.2.2">𝑑</ci></apply><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.3.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.4.3">𝑙</ci></apply><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5">subscript</csymbol><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2"><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.1">~</ci><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.2.2">𝑑</ci></apply><apply id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3"><minus id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.1.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.1"></minus><ci id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.2.cmml" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.2">𝑙</ci><cn id="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.3.cmml" type="integer" xref="S3.I1.i3.p1.10.m10.1.1.1.1.1.2.5.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.10.m10.1c">O(\sum_{l=1}^{{\tilde{L}}^{*}}N_{b}K{\tilde{d}}_{l}{\tilde{d}}_{l-1})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.10.m10.1d">italic_O ( ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over~ start_ARG italic_L end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT italic_K over~ start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT over~ start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.SS5.SSS1.p1.7">In summary, the computation complexity in causal distillation training can be <math alttext="O(KE+E+2\sum_{l=1}^{{\tilde{L}}^{*}}N_{b}K{\tilde{d}}_{l}{\tilde{d}}_{l-1}+%
\sum_{l=1}^{L^{*}}d_{l}^{*}d_{l-1}^{*})" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.1.m1.1"><semantics id="S3.SS5.SSS1.p1.1.m1.1a"><mrow id="S3.SS5.SSS1.p1.1.m1.1.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.3.cmml">O</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.2.cmml">K</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.3.cmml">E</mi></mrow><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.3.cmml">E</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.1a" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.cmml"><mn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.2.cmml">2</mn><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.cmml"><msubsup id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.cmml"><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.2.cmml">∑</mo><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.2.cmml">l</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.1.cmml">=</mo><mn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.3.cmml">1</mn></mrow><msup id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.cmml"><mover accent="true" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.2.cmml">L</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.1.cmml">~</mo></mover><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.3.cmml">∗</mo></msup></msubsup><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.cmml"><msub id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.2.cmml">N</mi><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.3.cmml">b</mi></msub><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.1.cmml">⁢</mo><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.3.cmml">K</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.1a" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.1.cmml">⁢</mo><msub id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.cmml"><mover accent="true" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.2.cmml">d</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.1.cmml">~</mo></mover><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.3.cmml">l</mi></msub><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.1b" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.1.cmml">⁢</mo><msub id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.cmml"><mover accent="true" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.2.cmml">d</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.1.cmml">~</mo></mover><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.2.cmml">l</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.1.cmml">−</mo><mn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.1b" rspace="0.055em" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.cmml"><msubsup id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.cmml"><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.2.cmml">∑</mo><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.2.cmml">l</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.1.cmml">=</mo><mn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.3.cmml">1</mn></mrow><msup id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.2.cmml">L</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.3.cmml">∗</mo></msup></msubsup><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.cmml"><msubsup id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.2.cmml">d</mi><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.3.cmml">l</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.3.cmml">∗</mo></msubsup><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.1.cmml">⁢</mo><msubsup id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.2.cmml">d</mi><mrow id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.cmml"><mi id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.2" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.2.cmml">l</mi><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.1.cmml">−</mo><mn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.3.cmml">1</mn></mrow><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.3" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.3.cmml">∗</mo></msubsup></mrow></mrow></mrow><mo id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.1.m1.1b"><apply id="S3.SS5.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1"><times id="S3.SS5.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.2"></times><ci id="S3.SS5.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.3">𝑂</ci><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1"><plus id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.1"></plus><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2"><times id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.1"></times><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.2">𝐾</ci><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.2.3">𝐸</ci></apply><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.3">𝐸</ci><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4"><times id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.1"></times><cn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.2.cmml" type="integer" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.2">2</cn><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3"><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1">superscript</csymbol><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1">subscript</csymbol><sum id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.2"></sum><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3"><eq id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.1"></eq><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.2">𝑙</ci><cn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.3.cmml" type="integer" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.2.3.3">1</cn></apply></apply><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3">superscript</csymbol><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2"><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.1">~</ci><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.2.2">𝐿</ci></apply><times id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.1.3.3"></times></apply></apply><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2"><times id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.1"></times><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2">subscript</csymbol><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.2">𝑁</ci><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.2.3">𝑏</ci></apply><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.3">𝐾</ci><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4">subscript</csymbol><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2"><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.1">~</ci><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.2.2">𝑑</ci></apply><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.4.3">𝑙</ci></apply><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5">subscript</csymbol><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2"><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.1">~</ci><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.2.2">𝑑</ci></apply><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3"><minus id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.1"></minus><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.2">𝑙</ci><cn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.3.cmml" type="integer" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.4.3.2.5.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5"><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1">superscript</csymbol><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1">subscript</csymbol><sum id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.2"></sum><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3"><eq id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.1"></eq><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.2">𝑙</ci><cn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.3.cmml" type="integer" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.2.3.3">1</cn></apply></apply><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3">superscript</csymbol><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.2">𝐿</ci><times id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.1.3.3"></times></apply></apply><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2"><times id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.1"></times><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2">superscript</csymbol><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2">subscript</csymbol><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.2">𝑑</ci><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.2.3">𝑙</ci></apply><times id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.2.3"></times></apply><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3">superscript</csymbol><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3">subscript</csymbol><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.2">𝑑</ci><apply id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3"><minus id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.1"></minus><ci id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.2.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.2">𝑙</ci><cn id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.3.cmml" type="integer" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.2.3.3">1</cn></apply></apply><times id="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.3.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1.1.1.1.5.2.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.1.m1.1c">O(KE+E+2\sum_{l=1}^{{\tilde{L}}^{*}}N_{b}K{\tilde{d}}_{l}{\tilde{d}}_{l-1}+%
\sum_{l=1}^{L^{*}}d_{l}^{*}d_{l-1}^{*})</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.1.m1.1d">italic_O ( italic_K italic_E + italic_E + 2 ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over~ start_ARG italic_L end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT italic_K over~ start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT over~ start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math>. In practice, <math alttext="N_{b}" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.2.m2.1"><semantics id="S3.SS5.SSS1.p1.2.m2.1a"><msub id="S3.SS5.SSS1.p1.2.m2.1.1" xref="S3.SS5.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS5.SSS1.p1.2.m2.1.1.2" xref="S3.SS5.SSS1.p1.2.m2.1.1.2.cmml">N</mi><mi id="S3.SS5.SSS1.p1.2.m2.1.1.3" xref="S3.SS5.SSS1.p1.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.2.m2.1b"><apply id="S3.SS5.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS5.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS5.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS5.SSS1.p1.2.m2.1.1.2">𝑁</ci><ci id="S3.SS5.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS5.SSS1.p1.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.2.m2.1c">N_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> samples can be processed in parallel, and <math alttext="\sum_{l=1}^{{\tilde{L}}^{*}}N_{b}K{\tilde{d}}_{l}{\tilde{d}}_{l-1}" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.3.m3.1"><semantics id="S3.SS5.SSS1.p1.3.m3.1a"><mrow id="S3.SS5.SSS1.p1.3.m3.1.1" xref="S3.SS5.SSS1.p1.3.m3.1.1.cmml"><msubsup id="S3.SS5.SSS1.p1.3.m3.1.1.1" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.cmml"><mo id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.cmml"><mi id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.2.cmml">l</mi><mo id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.1" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.3.cmml">1</mn></mrow><msup id="S3.SS5.SSS1.p1.3.m3.1.1.1.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.cmml"><mover accent="true" id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.cmml"><mi id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.2.cmml">L</mi><mo id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.1" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.1.cmml">~</mo></mover><mo id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.3.cmml">∗</mo></msup></msubsup><mrow id="S3.SS5.SSS1.p1.3.m3.1.1.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.cmml"><msub id="S3.SS5.SSS1.p1.3.m3.1.1.2.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.2.cmml"><mi id="S3.SS5.SSS1.p1.3.m3.1.1.2.2.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.2.2.cmml">N</mi><mi id="S3.SS5.SSS1.p1.3.m3.1.1.2.2.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.2.3.cmml">b</mi></msub><mo id="S3.SS5.SSS1.p1.3.m3.1.1.2.1" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S3.SS5.SSS1.p1.3.m3.1.1.2.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.3.cmml">K</mi><mo id="S3.SS5.SSS1.p1.3.m3.1.1.2.1a" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.1.cmml">⁢</mo><msub id="S3.SS5.SSS1.p1.3.m3.1.1.2.4" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.cmml"><mover accent="true" id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.cmml"><mi id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.2.cmml">d</mi><mo id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.1" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.1.cmml">~</mo></mover><mi id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.3.cmml">l</mi></msub><mo id="S3.SS5.SSS1.p1.3.m3.1.1.2.1b" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.1.cmml">⁢</mo><msub id="S3.SS5.SSS1.p1.3.m3.1.1.2.5" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.cmml"><mover accent="true" id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.cmml"><mi id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.2.cmml">d</mi><mo id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.1" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.1.cmml">~</mo></mover><mrow id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.cmml"><mi id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.2" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.2.cmml">l</mi><mo id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.1" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.1.cmml">−</mo><mn id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.3" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.3.m3.1b"><apply id="S3.SS5.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1"><apply id="S3.SS5.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1">superscript</csymbol><apply id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1">subscript</csymbol><sum id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.2"></sum><apply id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3"><eq id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.1"></eq><ci id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.2">𝑙</ci><cn id="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3">superscript</csymbol><apply id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2"><ci id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.1">~</ci><ci id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.2.2">𝐿</ci></apply><times id="S3.SS5.SSS1.p1.3.m3.1.1.1.3.3.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.1.3.3"></times></apply></apply><apply id="S3.SS5.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2"><times id="S3.SS5.SSS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.1"></times><apply id="S3.SS5.SSS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.3.m3.1.1.2.2.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.2">subscript</csymbol><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.2.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.2.2">𝑁</ci><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.2.3.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.2.3">𝑏</ci></apply><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.3">𝐾</ci><apply id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4">subscript</csymbol><apply id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2"><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.1">~</ci><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.2.2">𝑑</ci></apply><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.4.3.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.4.3">𝑙</ci></apply><apply id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5">subscript</csymbol><apply id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2"><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.1">~</ci><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.2.2">𝑑</ci></apply><apply id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3"><minus id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.1.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.1"></minus><ci id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.2.cmml" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.2">𝑙</ci><cn id="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.3.cmml" type="integer" xref="S3.SS5.SSS1.p1.3.m3.1.1.2.5.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.3.m3.1c">\sum_{l=1}^{{\tilde{L}}^{*}}N_{b}K{\tilde{d}}_{l}{\tilde{d}}_{l-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.3.m3.1d">∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over~ start_ARG italic_L end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT italic_K over~ start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT over~ start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT</annotation></semantics></math> introduces acceptable complexity when <math alttext="{\tilde{d}}_{l}" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.4.m4.1"><semantics id="S3.SS5.SSS1.p1.4.m4.1a"><msub id="S3.SS5.SSS1.p1.4.m4.1.1" xref="S3.SS5.SSS1.p1.4.m4.1.1.cmml"><mover accent="true" id="S3.SS5.SSS1.p1.4.m4.1.1.2" xref="S3.SS5.SSS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS5.SSS1.p1.4.m4.1.1.2.2" xref="S3.SS5.SSS1.p1.4.m4.1.1.2.2.cmml">d</mi><mo id="S3.SS5.SSS1.p1.4.m4.1.1.2.1" xref="S3.SS5.SSS1.p1.4.m4.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS5.SSS1.p1.4.m4.1.1.3" xref="S3.SS5.SSS1.p1.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.4.m4.1b"><apply id="S3.SS5.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS5.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS5.SSS1.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS5.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS5.SSS1.p1.4.m4.1.1.2"><ci id="S3.SS5.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS5.SSS1.p1.4.m4.1.1.2.1">~</ci><ci id="S3.SS5.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS5.SSS1.p1.4.m4.1.1.2.2">𝑑</ci></apply><ci id="S3.SS5.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS5.SSS1.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.4.m4.1c">{\tilde{d}}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.4.m4.1d">over~ start_ARG italic_d end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\tilde{L}}" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.5.m5.1"><semantics id="S3.SS5.SSS1.p1.5.m5.1a"><mover accent="true" id="S3.SS5.SSS1.p1.5.m5.1.1" xref="S3.SS5.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS5.SSS1.p1.5.m5.1.1.2" xref="S3.SS5.SSS1.p1.5.m5.1.1.2.cmml">L</mi><mo id="S3.SS5.SSS1.p1.5.m5.1.1.1" xref="S3.SS5.SSS1.p1.5.m5.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.5.m5.1b"><apply id="S3.SS5.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS5.SSS1.p1.5.m5.1.1"><ci id="S3.SS5.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS5.SSS1.p1.5.m5.1.1.1">~</ci><ci id="S3.SS5.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS5.SSS1.p1.5.m5.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.5.m5.1c">{\tilde{L}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.5.m5.1d">over~ start_ARG italic_L end_ARG</annotation></semantics></math> are small, <span class="ltx_text ltx_font_italic" id="S3.SS5.SSS1.p1.7.1">i</span>.<span class="ltx_text ltx_font_italic" id="S3.SS5.SSS1.p1.7.2">e</span>., <math alttext="\psi_{FDA}" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.6.m6.1"><semantics id="S3.SS5.SSS1.p1.6.m6.1a"><msub id="S3.SS5.SSS1.p1.6.m6.1.1" xref="S3.SS5.SSS1.p1.6.m6.1.1.cmml"><mi id="S3.SS5.SSS1.p1.6.m6.1.1.2" xref="S3.SS5.SSS1.p1.6.m6.1.1.2.cmml">ψ</mi><mrow id="S3.SS5.SSS1.p1.6.m6.1.1.3" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS5.SSS1.p1.6.m6.1.1.3.2" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.2.cmml">F</mi><mo id="S3.SS5.SSS1.p1.6.m6.1.1.3.1" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.SSS1.p1.6.m6.1.1.3.3" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.3.cmml">D</mi><mo id="S3.SS5.SSS1.p1.6.m6.1.1.3.1a" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.SSS1.p1.6.m6.1.1.3.4" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.6.m6.1b"><apply id="S3.SS5.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS5.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.6.m6.1.1.1.cmml" xref="S3.SS5.SSS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS5.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS5.SSS1.p1.6.m6.1.1.2">𝜓</ci><apply id="S3.SS5.SSS1.p1.6.m6.1.1.3.cmml" xref="S3.SS5.SSS1.p1.6.m6.1.1.3"><times id="S3.SS5.SSS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS5.SSS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.2">𝐹</ci><ci id="S3.SS5.SSS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.3">𝐷</ci><ci id="S3.SS5.SSS1.p1.6.m6.1.1.3.4.cmml" xref="S3.SS5.SSS1.p1.6.m6.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.6.m6.1c">\psi_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.6.m6.1d">italic_ψ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> is a light-weight network compared to <math alttext="\psi^{*}" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.7.m7.1"><semantics id="S3.SS5.SSS1.p1.7.m7.1a"><msup id="S3.SS5.SSS1.p1.7.m7.1.1" xref="S3.SS5.SSS1.p1.7.m7.1.1.cmml"><mi id="S3.SS5.SSS1.p1.7.m7.1.1.2" xref="S3.SS5.SSS1.p1.7.m7.1.1.2.cmml">ψ</mi><mo id="S3.SS5.SSS1.p1.7.m7.1.1.3" xref="S3.SS5.SSS1.p1.7.m7.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.7.m7.1b"><apply id="S3.SS5.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS5.SSS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p1.7.m7.1.1.1.cmml" xref="S3.SS5.SSS1.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS5.SSS1.p1.7.m7.1.1.2.cmml" xref="S3.SS5.SSS1.p1.7.m7.1.1.2">𝜓</ci><times id="S3.SS5.SSS1.p1.7.m7.1.1.3.cmml" xref="S3.SS5.SSS1.p1.7.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.7.m7.1c">\psi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.7.m7.1d">italic_ψ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>.
Empirically, with DIN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib1" title="">1</a>]</cite> as the Base model, the multi-teacher pre-training costs around 72s per epoch on the MovieLens dataset. The causal multi-teacher distillation training costs around 157s per epoch. The Base model without distillation costs 64s per epoch under the same experimental setting.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.2 </span>Inference Complexity</h4>
<div class="ltx_para" id="S3.SS5.SSS2.p1">
<p class="ltx_p" id="S3.SS5.SSS2.p1.1">At inference, solely the student recommendation model is used, and all teachers are discarded. Items are ranked according to the student predictions <math alttext="{\hat{o}}" class="ltx_Math" display="inline" id="S3.SS5.SSS2.p1.1.m1.1"><semantics id="S3.SS5.SSS2.p1.1.m1.1a"><mover accent="true" id="S3.SS5.SSS2.p1.1.m1.1.1" xref="S3.SS5.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS5.SSS2.p1.1.m1.1.1.2" xref="S3.SS5.SSS2.p1.1.m1.1.1.2.cmml">o</mi><mo id="S3.SS5.SSS2.p1.1.m1.1.1.1" xref="S3.SS5.SSS2.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.p1.1.m1.1b"><apply id="S3.SS5.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS5.SSS2.p1.1.m1.1.1"><ci id="S3.SS5.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS5.SSS2.p1.1.m1.1.1.1">^</ci><ci id="S3.SS5.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS5.SSS2.p1.1.m1.1.1.2">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.p1.1.m1.1c">{\hat{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.p1.1.m1.1d">over^ start_ARG italic_o end_ARG</annotation></semantics></math>. Therefore, the inference complexity remains the same with the Base model without distillation. Note that the Base model can be any recommendation model with an encoder-predictor architecture. In other words, the causal distillation framework can be plugged into existing recommendation models without affecting the inference efficiency.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.3 </span><span class="ltx_text" id="S3.SS5.SSS3.1.1">Connection between causal label distillation and causal feature distillation</span>
</h4>
<div class="ltx_para" id="S3.SS5.SSS3.p1">
<p class="ltx_p" id="S3.SS5.SSS3.p1.1">The underlying connections between causal label distillation and causal feature distillation can be two-fold:<span class="ltx_text" id="S3.SS5.SSS3.p1.1.1"></span></p>
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1"><span class="ltx_text" id="S3.I2.i1.p1.1.1">Front-door adjustment and back-door adjustment are two representative causal techniques for deconfounding with unobserved and observed confounders, respectively. We instantiate these two techniques in one unified neural model by identifying mediators and observed confounders. We empirically find that the joint modeling contributes to the overall effectiveness.<span class="ltx_text" id="S3.I2.i1.p1.1.1.1"></span></span></p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.4"><span class="ltx_text" id="S3.I2.i2.p1.4.4">As described in Section 3.2, the requirement (ii) of applying front-door adjustment is that no confounders simultaneously affect <math alttext="X" class="ltx_Math" display="inline" id="S3.I2.i2.p1.1.1.m1.1"><semantics id="S3.I2.i2.p1.1.1.m1.1a"><mi id="S3.I2.i2.p1.1.1.m1.1.1" xref="S3.I2.i2.p1.1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.1.m1.1b"><ci id="S3.I2.i2.p1.1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.1.1.m1.1d">italic_X</annotation></semantics></math> and <math alttext="M" class="ltx_Math" display="inline" id="S3.I2.i2.p1.2.2.m2.1"><semantics id="S3.I2.i2.p1.2.2.m2.1a"><mi id="S3.I2.i2.p1.2.2.m2.1.1" xref="S3.I2.i2.p1.2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.2.2.m2.1b"><ci id="S3.I2.i2.p1.2.2.m2.1.1.cmml" xref="S3.I2.i2.p1.2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.2.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.2.2.m2.1d">italic_M</annotation></semantics></math>. We further apply the back-door adjustment for deconfounding the estimation of causal effects of <math alttext="X" class="ltx_Math" display="inline" id="S3.I2.i2.p1.3.3.m3.1"><semantics id="S3.I2.i2.p1.3.3.m3.1a"><mi id="S3.I2.i2.p1.3.3.m3.1.1" xref="S3.I2.i2.p1.3.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.3.3.m3.1b"><ci id="S3.I2.i2.p1.3.3.m3.1.1.cmml" xref="S3.I2.i2.p1.3.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.3.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.3.3.m3.1d">italic_X</annotation></semantics></math> on <math alttext="M" class="ltx_Math" display="inline" id="S3.I2.i2.p1.4.4.m4.1"><semantics id="S3.I2.i2.p1.4.4.m4.1a"><mi id="S3.I2.i2.p1.4.4.m4.1.1" xref="S3.I2.i2.p1.4.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.4.4.m4.1b"><ci id="S3.I2.i2.p1.4.4.m4.1.1.cmml" xref="S3.I2.i2.p1.4.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.4.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.4.4.m4.1d">italic_M</annotation></semantics></math> (cf. Figure 3 Back-door Adjustment). <span class="ltx_text" id="S3.I2.i2.p1.4.4.1"></span></span></p>
</div>
</li>
</ul>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Related Works</span>
</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span class="ltx_text ltx_font_italic" id="S4.SS1.1.1">Debiased Recommendation</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.3">Biases are ubiquitous in the feedback loop (User <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">→</annotation></semantics></math> Data <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mo id="S4.SS1.p1.2.m2.1.1" stretchy="false" xref="S4.SS1.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">→</annotation></semantics></math> Model <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mo id="S4.SS1.p1.3.m3.1.1" stretchy="false" xref="S4.SS1.p1.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">→</annotation></semantics></math> User) of recommender systems, including (but are not limited to) exposure bias <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib25" title="">25</a>]</cite>, popularity bias <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib26" title="">26</a>]</cite>, conformity bias <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib27" title="">27</a>]</cite>, position bias <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib28" title="">28</a>]</cite>, and selection bias <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib29" title="">29</a>]</cite>.
One representative line of research to alleviate these biases is to explicitly model or utilize these biases <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib30" title="">30</a>]</cite>. Typically, they construct auxiliary models like exposure models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib31" title="">31</a>]</cite>, click models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib32" title="">32</a>]</cite>, and temporal popularity models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib33" title="">33</a>]</cite>. Another representative direction is to leverage unbiased data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib34" title="">34</a>]</cite>. For example, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib19" title="">19</a>]</cite> collect uniform data by exposing randomly sampled items to each user with a uniform distribution. Undoubtedly, random exposure might hurt users’ experiences and the uniform data is expensive to collect. More recently, there is substantial and rapidly-growing research literature studying embracing causal theory in bias alleviation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib38" title="">38</a>]</cite>.
Among these, Inverse Propensity Score <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib39" title="">39</a>]</cite> is one of the most general and representative methods in reducing confounding effects. In essence, IPS re-weights training samples based on the estimated bias-aware propensity scores. However, most existing deconfounding works (including IPS) assume unconfoundedness <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib20" title="">20</a>]</cite>, which means the confounders are observable to the model. However, in real-world recommender systems, confounders are too various to be modeled in one model, and a considerable portion of them are even unobserved by the system.
Different from these works, we leverage front-door adjustment technique from causality to handle unobserved confounders, and derive an efficient approximation of it using causal multi-teacher distillation.
</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">It is noteworthy that we differ from fairness-related works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib9" title="">9</a>]</cite> both in motivation and technique. Our major focus is the model training bias that enlarges the performance heterogeneity of different user groups. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">1</span></a>, when users in different groups are trained all together, and trained independently, a small portion of users benefit more during the co-training of all users. Note that performance heterogeneity still exists without co-training, and such heterogeneity is <span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS1.p2.1.1" style="color:#000000;">not</span> our major focus. Fairness-related works typically penalize the prediction expectation (such as the positive prediction rate) of different user groups, ensuring the universal equality. For example, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib9" title="">9</a>]</cite> work in a post-processing manner with recommended Top-K items and their ranking scores as input. They try to ensure equal performance of different user groups by solving a 0–1 integer programming problem. Different from existing works, we use causal techniques to deconfound model training.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span class="ltx_text ltx_font_italic" id="S4.SS2.1.1">Knowledge Distillation</span>
</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">Multi-teacher Distillation. </span>
Knowledge distillation is a powerful tool for transferring knowledge between networks. The transferred knowledge takes the form of soft labels <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib21" title="">21</a>]</cite>, intermediate features <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib41" title="">41</a>]</cite>, and relations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib43" title="">43</a>]</cite>. More recently, there is a rapidly-growing research literature studying on multi-teacher distillation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib45" title="">45</a>]</cite>. Among them, MEAL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib44" title="">44</a>]</cite> is one of the early works that train multiple teachers. It measures the consistency between the selected teacher and the student using adversarial learning. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib45" title="">45</a>]</cite> encapsulates multi-teacher distillation into multi-task learning, and trains one teacher per task. EnsCTR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib46" title="">46</a>]</cite> makes the first attempt to ensemble multiple teachers for click-through-rate prediction. They devise the Teacher Gating network to assign weights to different teachers based on their predictions. To the best of our knowledge, our work is the first to consolidate causality into multi-teacher distillation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Knowledge Distillation in Recommendation. </span> In recommender systems, there are some works that exploit a privileged teacher to enhance the student that is used for serving/inference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib48" title="">48</a>]</cite>. The privilege of teachers mainly falls into two groups: 1) high-capacity in model’s architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib50" title="">50</a>]</cite> where related works typically train a lighter-weight student for efficiency; and 2) external knowledge such as user reviews <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib51" title="">51</a>]</cite>, on-device features <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib52" title="">52</a>]</cite>, and unbiased uniform data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib19" title="">19</a>]</cite>. Largely different from these works, we construct unprivileged teachers, which have the same architecture as the student, and each of them is solely on a subset of the training data used to train the student. Though these teachers are unprivileged, we distill causal effects from them and accordingly train a debiased student without external unbiased data, which constitutes a novel paradigm for leveraging distillation in recommender systems.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.2.1.1" style="font-size:90%;">TABLE II</span>: </span><span class="ltx_text" id="S4.T2.3.2" style="font-size:90%;">Statistics of the datasets.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.4.1.1.1"><span class="ltx_text" id="S4.T2.4.1.1.1.1" style="font-size:90%;">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.2"><span class="ltx_text" id="S4.T2.4.1.1.2.1" style="font-size:90%;">#Users</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.3"><span class="ltx_text" id="S4.T2.4.1.1.3.1" style="font-size:90%;">#Items</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.4"><span class="ltx_text" id="S4.T2.4.1.1.4.1" style="font-size:90%;">#Interactions</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.5"><span class="ltx_text" id="S4.T2.4.1.1.5.1" style="font-size:90%;">#Density</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.4.2.1.1"><span class="ltx_text" id="S4.T2.4.2.1.1.1" style="font-size:90%;">MovieLens</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.1.2"><span class="ltx_text" id="S4.T2.4.2.1.2.1" style="font-size:90%;">6, 040</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.1.3"><span class="ltx_text" id="S4.T2.4.2.1.3.1" style="font-size:90%;">3, 900</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.1.4"><span class="ltx_text" id="S4.T2.4.2.1.4.1" style="font-size:90%;">1, 000, 209</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.1.5"><span class="ltx_text" id="S4.T2.4.2.1.5.1" style="font-size:90%;">0.04246</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.4.3.2.1"><span class="ltx_text" id="S4.T2.4.3.2.1.1" style="font-size:90%;">Amazon</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.2"><span class="ltx_text" id="S4.T2.4.3.2.2.1" style="font-size:90%;">459, 133</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.3"><span class="ltx_text" id="S4.T2.4.3.2.3.1" style="font-size:90%;">313, 966</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.4"><span class="ltx_text" id="S4.T2.4.3.2.4.1" style="font-size:90%;">8, 898, 041</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.5"><span class="ltx_text" id="S4.T2.4.3.2.5.1" style="font-size:90%;">0.00063</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.4.4.3.1"><span class="ltx_text" id="S4.T2.4.4.3.1.1" style="font-size:90%;">Alipay</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.2"><span class="ltx_text" id="S4.T2.4.4.3.2.1" style="font-size:90%;">400, 594</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.3"><span class="ltx_text" id="S4.T2.4.4.3.3.1" style="font-size:90%;">19, 503</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.4"><span class="ltx_text" id="S4.T2.4.4.3.4.1" style="font-size:90%;">38, 710, 494</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.5"><span class="ltx_text" id="S4.T2.4.4.3.5.1" style="font-size:90%;">0.00495</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.8.2.1" style="font-size:90%;">TABLE III</span>: </span><span class="ltx_text" id="S4.T3.2.1" style="font-size:90%;">Overall performance and performance heterogeneity comparison with DIN as the base model.
<math alttext="p" class="ltx_Math" display="inline" id="S4.T3.2.1.m1.1"><semantics id="S4.T3.2.1.m1.1b"><mi id="S4.T3.2.1.m1.1.1" xref="S4.T3.2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T3.2.1.m1.1c"><ci id="S4.T3.2.1.m1.1.1.cmml" xref="S4.T3.2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.1.m1.1d">p</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.1.m1.1e">italic_p</annotation></semantics></math>-value is from the two-sided test between CausalD and the best-performing baseline.
Higher values are better except for Heterogeneity.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.3.1.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.2.1" style="font-size:90%;">Datasets</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.3.1.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.3.1" style="font-size:90%;">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.3.1.4.1" style="font-size:90%;">DIN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.5.1" style="font-size:90%;">KD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.6.1" style="font-size:90%;">IPS</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.7.1" style="font-size:90%;">CausalRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.8.1" style="font-size:90%;">DeRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.9.1" style="font-size:90%;">DebiasD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.10.1" style="font-size:90%;">EnsCTR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.11.1" style="font-size:90%;">MEAL</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.12" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.3.1.12.1" style="font-size:90%;">CausalD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.1.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<math alttext="p" class="ltx_Math" display="inline" id="S4.T3.3.1.1.m1.1"><semantics id="S4.T3.3.1.1.m1.1a"><mi id="S4.T3.3.1.1.m1.1.1" mathsize="90%" xref="S4.T3.3.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T3.3.1.1.m1.1b"><ci id="S4.T3.3.1.1.m1.1.1.cmml" xref="S4.T3.3.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.1.1.m1.1d">italic_p</annotation></semantics></math><span class="ltx_text" id="S4.T3.3.1.1.1" style="font-size:90%;">-value</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.6.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.6.5.1.1" rowspan="6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.1.1" style="font-size:90%;">MovieLens</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.6.5.1.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.2.1" style="font-size:90%;">AUC</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.3.1" style="font-size:90%;">0.8185</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.4.1" style="font-size:90%;">0.8187</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.5.1" style="font-size:90%;">0.8034</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.6.1" style="font-size:90%;">0.8176</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.7.1" style="font-size:90%;">0.8227</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.8.1" style="font-size:90%;">0.8227</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.5.1.9.1" style="font-size:90%;">0.8257</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.10.1" style="font-size:90%;">0.8233</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.5.1.11.1" style="font-size:90%;">0.8329</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.5.1.12" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.5.1.12.1" style="font-size:90%;">1.36e-07</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.6.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.6.2.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.1.1" style="font-size:90%;">R@5</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.2.1" style="font-size:90%;">0.3102</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.3.1" style="font-size:90%;">0.3104</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.4.1" style="font-size:90%;">0.3066</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.5.1" style="font-size:90%;">0.3112</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.6.1" style="font-size:90%;">0.3260</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.7.1" style="font-size:90%;">0.3231</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.6.2.8.1" style="font-size:90%;">0.3354</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.9.1" style="font-size:90%;">0.3213</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.6.2.10.1" style="font-size:90%;">0.3556</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.6.2.11.1" style="font-size:90%;">3.55e-06</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.7.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.7.3.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.1.1" style="font-size:90%;">R@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.2.1" style="font-size:90%;">0.4682</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.3.1" style="font-size:90%;">0.4763</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.4.1" style="font-size:90%;">0.4652</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.5.1" style="font-size:90%;">0.4751</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.6.1" style="font-size:90%;">0.4892</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.7.1" style="font-size:90%;">0.4831</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.7.3.8.1" style="font-size:90%;">0.4930</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.9.1" style="font-size:90%;">0.4837</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.7.3.10.1" style="font-size:90%;">0.5170</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.7.3.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.7.3.11.1" style="font-size:90%;">4.67e-05</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.8.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.8.4.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.1.1" style="font-size:90%;">NDCG@5</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.2.1" style="font-size:90%;">0.2378</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.3.1" style="font-size:90%;">0.2382</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.4.1" style="font-size:90%;">0.2362</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.5.1" style="font-size:90%;">0.2400</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.6.1" style="font-size:90%;">0.2507</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.7.1" style="font-size:90%;">0.2485</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.8.4.8.1" style="font-size:90%;">0.2589</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.9.1" style="font-size:90%;">0.2492</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.8.4.10.1" style="font-size:90%;">0.2755</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.4.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.8.4.11.1" style="font-size:90%;">1.15e-06</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.9.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.9.5.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.2.1" style="font-size:90%;">0.3145</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.3.1" style="font-size:90%;">0.3187</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.4.1" style="font-size:90%;">0.3136</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.5.1" style="font-size:90%;">0.3192</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.6.1" style="font-size:90%;">0.3300</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.7.1" style="font-size:90%;">0.3258</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.9.5.8.1" style="font-size:90%;">0.3355</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.9.1" style="font-size:90%;">0.3281</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.9.5.10.1" style="font-size:90%;">0.3538</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.5.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.9.5.11.1" style="font-size:90%;">5.53e-06</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.2.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text" id="S4.T3.4.2.1.1" style="font-size:90%;">Heterogeneity </span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.4.2.1.m1.1"><semantics id="S4.T3.4.2.1.m1.1a"><mo id="S4.T3.4.2.1.m1.1.1" mathsize="90%" stretchy="false" xref="S4.T3.4.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.2.1.m1.1b"><ci id="S4.T3.4.2.1.m1.1.1.cmml" xref="S4.T3.4.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.2.1.m1.1d">↓</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.4.2.2.1" style="font-size:90%;">0.7291</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.4.2.3.1" style="font-size:90%;">0.4533</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.2.4.1" style="font-size:90%;">0.3056</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.4.2.5.1" style="font-size:90%;">0.7529</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.4.2.6.1" style="font-size:90%;">0.7893</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.4.2.7.1" style="font-size:90%;">0.6889</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.4.2.8.1" style="font-size:90%;">0.9531</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.4.2.9.1" style="font-size:90%;">0.7773</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.2.10.1" style="font-size:90%;">0.1086</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.2.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.4.2.11.1" style="font-size:90%;">1.54e-03</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.10.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.6.10.6.1" rowspan="6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.1.1" style="font-size:90%;">Amazon</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.6.10.6.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.2.1" style="font-size:90%;">AUC</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.3.1" style="font-size:90%;">0.8873</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.4.1" style="font-size:90%;">0.8704</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.5.1" style="font-size:90%;">0.8788</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.6.1" style="font-size:90%;">0.8899</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.7.1" style="font-size:90%;">0.8908</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.8.1" style="font-size:90%;">0.8954</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.10.6.9.1" style="font-size:90%;">0.8983</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.10.1" style="font-size:90%;">0.8867</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.10.6.11.1" style="font-size:90%;">0.9027</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.6.12" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.10.6.12.1" style="font-size:90%;">2.30e-07</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.11.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.11.7.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.1.1" style="font-size:90%;">R@5</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.2.1" style="font-size:90%;">0.5644</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.3.1" style="font-size:90%;">0.5336</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.4.1" style="font-size:90%;">0.5555</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.5.1" style="font-size:90%;">0.5790</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.6.1" style="font-size:90%;">0.5795</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.7.1" style="font-size:90%;">0.5886</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.11.7.8.1" style="font-size:90%;">0.5911</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.9.1" style="font-size:90%;">0.5698</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.11.7.10.1" style="font-size:90%;">0.6069</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.7.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.11.7.11.1" style="font-size:90%;">3.24e-04</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.12.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.12.8.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.1.1" style="font-size:90%;">R@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.2.1" style="font-size:90%;">0.6854</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.3.1" style="font-size:90%;">0.6515</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.4.1" style="font-size:90%;">0.6760</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.5.1" style="font-size:90%;">0.6956</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.6.1" style="font-size:90%;">0.6956</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.7.1" style="font-size:90%;">0.7060</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.12.8.8.1" style="font-size:90%;">0.7087</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.9.1" style="font-size:90%;">0.6863</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.12.8.10.1" style="font-size:90%;">0.7216</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.12.8.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.12.8.11.1" style="font-size:90%;">1.52e-05</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.13.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.13.9.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.1.1" style="font-size:90%;">NDCG@5</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.2.1" style="font-size:90%;">0.4794</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.3.1" style="font-size:90%;">0.4516</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.4.1" style="font-size:90%;">0.4706</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.5.1" style="font-size:90%;">0.4934</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.6.1" style="font-size:90%;">0.4939</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.7.1" style="font-size:90%;">0.5007</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.13.9.8.1" style="font-size:90%;">0.5038</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.9.1" style="font-size:90%;">0.4857</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.13.9.10.1" style="font-size:90%;">0.5190</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.13.9.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.13.9.11.1" style="font-size:90%;">3.71e-05</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.14.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.14.10.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.2.1" style="font-size:90%;">0.5384</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.3.1" style="font-size:90%;">0.5092</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.4.1" style="font-size:90%;">0.5294</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.5.1" style="font-size:90%;">0.5503</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.6.1" style="font-size:90%;">0.5506</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.7.1" style="font-size:90%;">0.5580</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.14.10.8.1" style="font-size:90%;">0.5612</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.9.1" style="font-size:90%;">0.5426</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.14.10.10.1" style="font-size:90%;">0.5751</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.14.10.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.14.10.11.1" style="font-size:90%;">2.58e-05</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.5.3.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text" id="S4.T3.5.3.1.1" style="font-size:90%;">Heterogeneity </span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.5.3.1.m1.1"><semantics id="S4.T3.5.3.1.m1.1a"><mo id="S4.T3.5.3.1.m1.1.1" mathsize="90%" stretchy="false" xref="S4.T3.5.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.3.1.m1.1b"><ci id="S4.T3.5.3.1.m1.1.1.cmml" xref="S4.T3.5.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.3.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.3.1.m1.1d">↓</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.5.3.2.1" style="font-size:90%;">2.4567</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.5.3.3.1" style="font-size:90%;">1.6847</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.5.3.4.1" style="font-size:90%;">1.4277</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.5.3.5.1" style="font-size:90%;">1.8765</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.5.3.6.1" style="font-size:90%;">1.6241</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.5.3.7.1" style="font-size:90%;">1.4747</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.5.3.8.1" style="font-size:90%;">1.5169</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.5.3.9.1" style="font-size:90%;">2.2083</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.5.3.10.1" style="font-size:90%;">1.3803</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.3.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.5.3.11.1" style="font-size:90%;">1.89e-02</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.15.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T3.6.15.11.1" rowspan="6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.1.1" style="font-size:90%;">Alipay</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.6.15.11.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.2.1" style="font-size:90%;">AUC</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.3.1" style="font-size:90%;">0.7691</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.4.1" style="font-size:90%;">0.7615</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.5.1" style="font-size:90%;">0.7623</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.6.1" style="font-size:90%;">0.7603</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.7.1" style="font-size:90%;">0.7738</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.8.1" style="font-size:90%;">0.7712</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.9.1" style="font-size:90%;">0.7700</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.15.11.10.1" style="font-size:90%;">0.7749</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.15.11.11.1" style="font-size:90%;">0.7777</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.15.11.12" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.15.11.12.1" style="font-size:90%;">3.08e-05</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.16.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.16.12.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.1.1" style="font-size:90%;">R@5</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.2.1" style="font-size:90%;">0.1669</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.3.1" style="font-size:90%;">0.1727</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.4.1" style="font-size:90%;">0.1778</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.5.1" style="font-size:90%;">0.1792</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.6.1" style="font-size:90%;">0.2039</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.7.1" style="font-size:90%;">0.2057</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.8.1" style="font-size:90%;">0.1831</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.16.12.9.1" style="font-size:90%;">0.2343</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.16.12.10.1" style="font-size:90%;">0.2547</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.16.12.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.16.12.11.1" style="font-size:90%;">5.73e-08</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.17.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.17.13.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.1.1" style="font-size:90%;">R@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.2.1" style="font-size:90%;">0.3518</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.3.1" style="font-size:90%;">0.3682</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.17.13.4.1" style="font-size:90%;">0.3953</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.5.1" style="font-size:90%;">0.3772</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.6.1" style="font-size:90%;">0.3947</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.7.1" style="font-size:90%;">0.3675</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.8.1" style="font-size:90%;">0.3689</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.9.1" style="font-size:90%;">0.3938</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.17.13.10.1" style="font-size:90%;">0.4457</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.17.13.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.17.13.11.1" style="font-size:90%;">2.22e-06</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.18.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.18.14.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.1.1" style="font-size:90%;">NDCG@5</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.2.1" style="font-size:90%;">0.1186</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.3.1" style="font-size:90%;">0.1221</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.4.1" style="font-size:90%;">0.1237</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.5.1" style="font-size:90%;">0.1255</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.6.1" style="font-size:90%;">0.1474</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.7.1" style="font-size:90%;">0.1532</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.8.1" style="font-size:90%;">0.1307</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.18.14.9.1" style="font-size:90%;">0.1745</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.18.14.10.1" style="font-size:90%;">0.1851</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.18.14.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.18.14.11.1" style="font-size:90%;">1.53e-06</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.19.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.19.15.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.2.1" style="font-size:90%;">0.2076</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.3.1" style="font-size:90%;">0.2165</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.4.1" style="font-size:90%;">0.2289</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.5.1" style="font-size:90%;">0.2214</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.6.1" style="font-size:90%;">0.2407</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.7.1" style="font-size:90%;">0.2314</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.8.1" style="font-size:90%;">0.2204</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.19.15.9.1" style="font-size:90%;">0.2517</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.19.15.10.1" style="font-size:90%;">0.2779</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.19.15.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.19.15.11.1" style="font-size:90%;">1.86e-05</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T3.6.4.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text" id="S4.T3.6.4.1.1" style="font-size:90%;">Heterogeneity </span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.6.4.1.m1.1"><semantics id="S4.T3.6.4.1.m1.1a"><mo id="S4.T3.6.4.1.m1.1.1" mathsize="90%" stretchy="false" xref="S4.T3.6.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.4.1.m1.1b"><ci id="S4.T3.6.4.1.m1.1.1.cmml" xref="S4.T3.6.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.4.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.4.1.m1.1d">↓</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.4.2.1" style="font-size:90%;">2.3419</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.4.3.1" style="font-size:90%;">2.3383</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.4.4.1" style="font-size:90%;">1.8455</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.4.5.1" style="font-size:90%;">1.5405</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.6" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.4.6.1" style="font-size:90%;">2.4671</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.7" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.4.7.1" style="font-size:90%;">2.1373</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.8" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.4.8.1" style="font-size:90%;">2.4441</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.9" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.4.9.1" style="font-size:90%;">2.1125</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.10" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.6.4.10.1" style="font-size:90%;">1.0207</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.4.11" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T3.6.4.11.1" style="font-size:90%;">3.39e-03</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Experiments</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We conduct experiments on three real-world datasets to answer the following research questions:</p>
</div>
<div class="ltx_para" id="S5.p2">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">RQ1:</span> How does <span class="ltx_text ltx_font_italic" id="S5.I1.i1.p1.1.2">CausalD</span> perform as compared to baselines concerning multi-teacher distillation, debiased distillation, and debiased recommendation?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">RQ2:</span> Does <span class="ltx_text ltx_font_italic" id="S5.I1.i2.p1.1.2">CausalD</span> mitigate the performance heterogeneity problem amplified by confounders that are observed or unobserved by the model?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">RQ3:</span> How do different components (the back-door and front-door adjustment loss) and different hyper-parameter settings (<span class="ltx_text ltx_font_italic" id="S5.I1.i3.p1.1.2">e</span>.<span class="ltx_text ltx_font_italic" id="S5.I1.i3.p1.1.3">g</span>., loss coefficients, number of teachers) affect the performance of CausalD?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span><span class="ltx_text ltx_font_italic" id="S5.SS1.1.1">Experimental Setup</span>
</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Dataset Description. </span> We use two public benchmark datasets, <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.2">i</span>.<span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.3">e</span>., MovieLens and Amazon Product Review, and a challenging large-scale industrial dataset, <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.4">i</span>.<span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.5">e</span>., AliPay. Dataset statistics are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S4.T2" title="TABLE II ‣ 4.2 Knowledge Distillation ‣ 4 Related Works ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i1.p1.1.1">Amazon.</span> We take the Book category from the Amazon product review dataset<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>http://jmcauley.ucsd.edu/data/amazon/</span></span></span> for evaluation. We follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib53" title="">53</a>]</cite> to regard the interacted items for a given user as positive items and pair the user with randomly sampled negatives that the user did not consume before for training models.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i2.p1.1.1">MovieLens.</span> We use the widely used MovieLens-1M<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://grouplens.org/datasets/movielens/1m/</span></span></span> version for evaluation. We generate positive and negative pairs in a similar manner as the Amazon dataset.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i3.p1">
<p class="ltx_p" id="S5.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i3.p1.1.1">AliPay.</span> AliPay dataset is collected from one of the world’s largest mobile payment platforms, <span class="ltx_text ltx_font_italic" id="S5.I2.i3.p1.1.2">i</span>.<span class="ltx_text ltx_font_italic" id="S5.I2.i3.p1.1.3">e</span>., AliPay. Wherein, the applets like mobile recharge services and government services are viewed as items. In AliPay, we regard the items that have been clicked as positives. Items that are observed but not clicked are treated as negatives.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.SS1.p1.2">To ensure data quality, we take the 16-core setting where each user/item has at least sixteen interactions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Baselines. </span> To demonstrate the effectiveness, we compare CausalD with the following baselines:</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<ul class="ltx_itemize" id="S5.I3">
<li class="ltx_item" id="S5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i1.p1">
<p class="ltx_p" id="S5.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i1.p1.1.1">KD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib21" title="">21</a>]</cite>: </span> This model denotes the oracle knowledge distillation. We train a single teacher on all users.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i2.p1">
<p class="ltx_p" id="S5.I3.i2.p1.6"><span class="ltx_text ltx_font_bold" id="S5.I3.i2.p1.6.1">IPS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib39" title="">39</a>]</cite>:</span>. It is a representative causal recommendation method. In this work, we firstly measure <math alttext="P(ug|i)" class="ltx_Math" display="inline" id="S5.I3.i2.p1.1.m1.1"><semantics id="S5.I3.i2.p1.1.m1.1a"><mrow id="S5.I3.i2.p1.1.m1.1.1" xref="S5.I3.i2.p1.1.m1.1.1.cmml"><mi id="S5.I3.i2.p1.1.m1.1.1.3" xref="S5.I3.i2.p1.1.m1.1.1.3.cmml">P</mi><mo id="S5.I3.i2.p1.1.m1.1.1.2" xref="S5.I3.i2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S5.I3.i2.p1.1.m1.1.1.1.1" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S5.I3.i2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.I3.i2.p1.1.m1.1.1.1.1.1" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.cmml"><mrow id="S5.I3.i2.p1.1.m1.1.1.1.1.1.2" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.2" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.2.cmml">u</mi><mo id="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.1" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.3" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.3.cmml">g</mi></mrow><mo fence="false" id="S5.I3.i2.p1.1.m1.1.1.1.1.1.1" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S5.I3.i2.p1.1.m1.1.1.1.1.1.3" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.3.cmml">i</mi></mrow><mo id="S5.I3.i2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.I3.i2.p1.1.m1.1b"><apply id="S5.I3.i2.p1.1.m1.1.1.cmml" xref="S5.I3.i2.p1.1.m1.1.1"><times id="S5.I3.i2.p1.1.m1.1.1.2.cmml" xref="S5.I3.i2.p1.1.m1.1.1.2"></times><ci id="S5.I3.i2.p1.1.m1.1.1.3.cmml" xref="S5.I3.i2.p1.1.m1.1.1.3">𝑃</ci><apply id="S5.I3.i2.p1.1.m1.1.1.1.1.1.cmml" xref="S5.I3.i2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S5.I3.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.2"><times id="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.1"></times><ci id="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.2">𝑢</ci><ci id="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.2.3">𝑔</ci></apply><ci id="S5.I3.i2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S5.I3.i2.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I3.i2.p1.1.m1.1c">P(ug|i)</annotation><annotation encoding="application/x-llamapun" id="S5.I3.i2.p1.1.m1.1d">italic_P ( italic_u italic_g | italic_i )</annotation></semantics></math> which denotes the conditional probability of heterogeneous user groups <math alttext="ug" class="ltx_Math" display="inline" id="S5.I3.i2.p1.2.m2.1"><semantics id="S5.I3.i2.p1.2.m2.1a"><mrow id="S5.I3.i2.p1.2.m2.1.1" xref="S5.I3.i2.p1.2.m2.1.1.cmml"><mi id="S5.I3.i2.p1.2.m2.1.1.2" xref="S5.I3.i2.p1.2.m2.1.1.2.cmml">u</mi><mo id="S5.I3.i2.p1.2.m2.1.1.1" xref="S5.I3.i2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I3.i2.p1.2.m2.1.1.3" xref="S5.I3.i2.p1.2.m2.1.1.3.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I3.i2.p1.2.m2.1b"><apply id="S5.I3.i2.p1.2.m2.1.1.cmml" xref="S5.I3.i2.p1.2.m2.1.1"><times id="S5.I3.i2.p1.2.m2.1.1.1.cmml" xref="S5.I3.i2.p1.2.m2.1.1.1"></times><ci id="S5.I3.i2.p1.2.m2.1.1.2.cmml" xref="S5.I3.i2.p1.2.m2.1.1.2">𝑢</ci><ci id="S5.I3.i2.p1.2.m2.1.1.3.cmml" xref="S5.I3.i2.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I3.i2.p1.2.m2.1c">ug</annotation><annotation encoding="application/x-llamapun" id="S5.I3.i2.p1.2.m2.1d">italic_u italic_g</annotation></semantics></math> given items <math alttext="i" class="ltx_Math" display="inline" id="S5.I3.i2.p1.3.m3.1"><semantics id="S5.I3.i2.p1.3.m3.1a"><mi id="S5.I3.i2.p1.3.m3.1.1" xref="S5.I3.i2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.I3.i2.p1.3.m3.1b"><ci id="S5.I3.i2.p1.3.m3.1.1.cmml" xref="S5.I3.i2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I3.i2.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S5.I3.i2.p1.3.m3.1d">italic_i</annotation></semantics></math>. Then, for a given data sample <math alttext="(u,i)" class="ltx_Math" display="inline" id="S5.I3.i2.p1.4.m4.2"><semantics id="S5.I3.i2.p1.4.m4.2a"><mrow id="S5.I3.i2.p1.4.m4.2.3.2" xref="S5.I3.i2.p1.4.m4.2.3.1.cmml"><mo id="S5.I3.i2.p1.4.m4.2.3.2.1" stretchy="false" xref="S5.I3.i2.p1.4.m4.2.3.1.cmml">(</mo><mi id="S5.I3.i2.p1.4.m4.1.1" xref="S5.I3.i2.p1.4.m4.1.1.cmml">u</mi><mo id="S5.I3.i2.p1.4.m4.2.3.2.2" xref="S5.I3.i2.p1.4.m4.2.3.1.cmml">,</mo><mi id="S5.I3.i2.p1.4.m4.2.2" xref="S5.I3.i2.p1.4.m4.2.2.cmml">i</mi><mo id="S5.I3.i2.p1.4.m4.2.3.2.3" stretchy="false" xref="S5.I3.i2.p1.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.I3.i2.p1.4.m4.2b"><interval closure="open" id="S5.I3.i2.p1.4.m4.2.3.1.cmml" xref="S5.I3.i2.p1.4.m4.2.3.2"><ci id="S5.I3.i2.p1.4.m4.1.1.cmml" xref="S5.I3.i2.p1.4.m4.1.1">𝑢</ci><ci id="S5.I3.i2.p1.4.m4.2.2.cmml" xref="S5.I3.i2.p1.4.m4.2.2">𝑖</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.I3.i2.p1.4.m4.2c">(u,i)</annotation><annotation encoding="application/x-llamapun" id="S5.I3.i2.p1.4.m4.2d">( italic_u , italic_i )</annotation></semantics></math>, we use the corresponding <math alttext="p(ug|i)" class="ltx_Math" display="inline" id="S5.I3.i2.p1.5.m5.1"><semantics id="S5.I3.i2.p1.5.m5.1a"><mrow id="S5.I3.i2.p1.5.m5.1.1" xref="S5.I3.i2.p1.5.m5.1.1.cmml"><mi id="S5.I3.i2.p1.5.m5.1.1.3" xref="S5.I3.i2.p1.5.m5.1.1.3.cmml">p</mi><mo id="S5.I3.i2.p1.5.m5.1.1.2" xref="S5.I3.i2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S5.I3.i2.p1.5.m5.1.1.1.1" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S5.I3.i2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S5.I3.i2.p1.5.m5.1.1.1.1.1" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.cmml"><mrow id="S5.I3.i2.p1.5.m5.1.1.1.1.1.2" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.cmml"><mi id="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.2" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.2.cmml">u</mi><mo id="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.1" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.3" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.3.cmml">g</mi></mrow><mo fence="false" id="S5.I3.i2.p1.5.m5.1.1.1.1.1.1" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.1.cmml">|</mo><mi id="S5.I3.i2.p1.5.m5.1.1.1.1.1.3" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.3.cmml">i</mi></mrow><mo id="S5.I3.i2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.I3.i2.p1.5.m5.1b"><apply id="S5.I3.i2.p1.5.m5.1.1.cmml" xref="S5.I3.i2.p1.5.m5.1.1"><times id="S5.I3.i2.p1.5.m5.1.1.2.cmml" xref="S5.I3.i2.p1.5.m5.1.1.2"></times><ci id="S5.I3.i2.p1.5.m5.1.1.3.cmml" xref="S5.I3.i2.p1.5.m5.1.1.3">𝑝</ci><apply id="S5.I3.i2.p1.5.m5.1.1.1.1.1.cmml" xref="S5.I3.i2.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="S5.I3.i2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.1">conditional</csymbol><apply id="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.2"><times id="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.1"></times><ci id="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.2">𝑢</ci><ci id="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.2.3">𝑔</ci></apply><ci id="S5.I3.i2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S5.I3.i2.p1.5.m5.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I3.i2.p1.5.m5.1c">p(ug|i)</annotation><annotation encoding="application/x-llamapun" id="S5.I3.i2.p1.5.m5.1d">italic_p ( italic_u italic_g | italic_i )</annotation></semantics></math> as the propensity score. We follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib39" title="">39</a>]</cite> to reduce propensity variance using the propensity clipping technique. The clipping threshold is searched in <math alttext="\{1/2,1/3,...,1/10\}" class="ltx_Math" display="inline" id="S5.I3.i2.p1.6.m6.4"><semantics id="S5.I3.i2.p1.6.m6.4a"><mrow id="S5.I3.i2.p1.6.m6.4.4.3" xref="S5.I3.i2.p1.6.m6.4.4.4.cmml"><mo id="S5.I3.i2.p1.6.m6.4.4.3.4" stretchy="false" xref="S5.I3.i2.p1.6.m6.4.4.4.cmml">{</mo><mrow id="S5.I3.i2.p1.6.m6.2.2.1.1" xref="S5.I3.i2.p1.6.m6.2.2.1.1.cmml"><mn id="S5.I3.i2.p1.6.m6.2.2.1.1.2" xref="S5.I3.i2.p1.6.m6.2.2.1.1.2.cmml">1</mn><mo id="S5.I3.i2.p1.6.m6.2.2.1.1.1" xref="S5.I3.i2.p1.6.m6.2.2.1.1.1.cmml">/</mo><mn id="S5.I3.i2.p1.6.m6.2.2.1.1.3" xref="S5.I3.i2.p1.6.m6.2.2.1.1.3.cmml">2</mn></mrow><mo id="S5.I3.i2.p1.6.m6.4.4.3.5" xref="S5.I3.i2.p1.6.m6.4.4.4.cmml">,</mo><mrow id="S5.I3.i2.p1.6.m6.3.3.2.2" xref="S5.I3.i2.p1.6.m6.3.3.2.2.cmml"><mn id="S5.I3.i2.p1.6.m6.3.3.2.2.2" xref="S5.I3.i2.p1.6.m6.3.3.2.2.2.cmml">1</mn><mo id="S5.I3.i2.p1.6.m6.3.3.2.2.1" xref="S5.I3.i2.p1.6.m6.3.3.2.2.1.cmml">/</mo><mn id="S5.I3.i2.p1.6.m6.3.3.2.2.3" xref="S5.I3.i2.p1.6.m6.3.3.2.2.3.cmml">3</mn></mrow><mo id="S5.I3.i2.p1.6.m6.4.4.3.6" xref="S5.I3.i2.p1.6.m6.4.4.4.cmml">,</mo><mi id="S5.I3.i2.p1.6.m6.1.1" mathvariant="normal" xref="S5.I3.i2.p1.6.m6.1.1.cmml">…</mi><mo id="S5.I3.i2.p1.6.m6.4.4.3.7" xref="S5.I3.i2.p1.6.m6.4.4.4.cmml">,</mo><mrow id="S5.I3.i2.p1.6.m6.4.4.3.3" xref="S5.I3.i2.p1.6.m6.4.4.3.3.cmml"><mn id="S5.I3.i2.p1.6.m6.4.4.3.3.2" xref="S5.I3.i2.p1.6.m6.4.4.3.3.2.cmml">1</mn><mo id="S5.I3.i2.p1.6.m6.4.4.3.3.1" xref="S5.I3.i2.p1.6.m6.4.4.3.3.1.cmml">/</mo><mn id="S5.I3.i2.p1.6.m6.4.4.3.3.3" xref="S5.I3.i2.p1.6.m6.4.4.3.3.3.cmml">10</mn></mrow><mo id="S5.I3.i2.p1.6.m6.4.4.3.8" stretchy="false" xref="S5.I3.i2.p1.6.m6.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.I3.i2.p1.6.m6.4b"><set id="S5.I3.i2.p1.6.m6.4.4.4.cmml" xref="S5.I3.i2.p1.6.m6.4.4.3"><apply id="S5.I3.i2.p1.6.m6.2.2.1.1.cmml" xref="S5.I3.i2.p1.6.m6.2.2.1.1"><divide id="S5.I3.i2.p1.6.m6.2.2.1.1.1.cmml" xref="S5.I3.i2.p1.6.m6.2.2.1.1.1"></divide><cn id="S5.I3.i2.p1.6.m6.2.2.1.1.2.cmml" type="integer" xref="S5.I3.i2.p1.6.m6.2.2.1.1.2">1</cn><cn id="S5.I3.i2.p1.6.m6.2.2.1.1.3.cmml" type="integer" xref="S5.I3.i2.p1.6.m6.2.2.1.1.3">2</cn></apply><apply id="S5.I3.i2.p1.6.m6.3.3.2.2.cmml" xref="S5.I3.i2.p1.6.m6.3.3.2.2"><divide id="S5.I3.i2.p1.6.m6.3.3.2.2.1.cmml" xref="S5.I3.i2.p1.6.m6.3.3.2.2.1"></divide><cn id="S5.I3.i2.p1.6.m6.3.3.2.2.2.cmml" type="integer" xref="S5.I3.i2.p1.6.m6.3.3.2.2.2">1</cn><cn id="S5.I3.i2.p1.6.m6.3.3.2.2.3.cmml" type="integer" xref="S5.I3.i2.p1.6.m6.3.3.2.2.3">3</cn></apply><ci id="S5.I3.i2.p1.6.m6.1.1.cmml" xref="S5.I3.i2.p1.6.m6.1.1">…</ci><apply id="S5.I3.i2.p1.6.m6.4.4.3.3.cmml" xref="S5.I3.i2.p1.6.m6.4.4.3.3"><divide id="S5.I3.i2.p1.6.m6.4.4.3.3.1.cmml" xref="S5.I3.i2.p1.6.m6.4.4.3.3.1"></divide><cn id="S5.I3.i2.p1.6.m6.4.4.3.3.2.cmml" type="integer" xref="S5.I3.i2.p1.6.m6.4.4.3.3.2">1</cn><cn id="S5.I3.i2.p1.6.m6.4.4.3.3.3.cmml" type="integer" xref="S5.I3.i2.p1.6.m6.4.4.3.3.3">10</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S5.I3.i2.p1.6.m6.4c">\{1/2,1/3,...,1/10\}</annotation><annotation encoding="application/x-llamapun" id="S5.I3.i2.p1.6.m6.4d">{ 1 / 2 , 1 / 3 , … , 1 / 10 }</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i3.p1">
<p class="ltx_p" id="S5.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i3.p1.1.1">CausalRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib54" title="">54</a>]</cite>:</span> This method employs causal inference to correct the exposure bias and technically constructs an exposure model such that each click is weighted by the inverse exposure probability predicted by the model.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i4.p1">
<p class="ltx_p" id="S5.I3.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i4.p1.1.1">Deconfounded Rec (DeRec) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib14" title="">14</a>]</cite>:</span> The deconfounded recommendation technique uses Poisson factorization to infer confounders, and augments the base recommendation model to correct the confounding.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i5.p1">
<p class="ltx_p" id="S5.I3.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i5.p1.1.1">DebiasD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib55" title="">55</a>]</cite>:</span> It is one state-of-the-art method that debiases single-teacher distillation at the class level. We extend the framework to the multi-teacher distillation by assigning adaptive mixing weights to multiple teachers.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i6.p1">
<p class="ltx_p" id="S5.I3.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i6.p1.1.1">EnsCTR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib46" title="">46</a>]</cite>:</span> It is one state-of-the-art multi-teacher distillation framework in the literature of recommendation.
</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i7.p1">
<p class="ltx_p" id="S5.I3.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i7.p1.1.1">MEAL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib44" title="">44</a>]</cite>:</span> This baseline is a state-of-the-art ensemble distillation in the generic domain. It incorporates discriminators to evaluate to what extent the student’s output differs from multiple teachers.
</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.6.1.1" style="font-size:90%;">TABLE IV</span>: </span><span class="ltx_text" id="S5.T4.7.2" style="font-size:90%;">Recommendation performance and performance heterogeneity comparison with DeepFM as the base model.
</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T4.1.1.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.2.1" style="font-size:90%;">Datasets</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T4.1.1.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.3.1" style="font-size:90%;">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.4.1" style="font-size:90%;">DeepFM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.5.1" style="font-size:90%;">KD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.6.1" style="font-size:90%;">IPS</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.7.1" style="font-size:90%;">CausalRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.8.1" style="font-size:90%;">DeRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.9.1" style="font-size:90%;">DebiasD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.10.1" style="font-size:90%;">EnsCTR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.11.1" style="font-size:90%;">MEAL</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.12" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.1.1.12.1" style="font-size:90%;">CausalD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1" style="padding-left:3.6pt;padding-right:3.6pt;">
<math alttext="p" class="ltx_Math" display="inline" id="S5.T4.1.1.1.m1.1"><semantics id="S5.T4.1.1.1.m1.1a"><mi id="S5.T4.1.1.1.m1.1.1" mathsize="90%" xref="S5.T4.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.m1.1b"><ci id="S5.T4.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S5.T4.1.1.1.m1.1d">italic_p</annotation></semantics></math><span class="ltx_text" id="S5.T4.1.1.1.1" style="font-size:90%;">-value</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.4.5.1.1" rowspan="6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.1.1" style="font-size:90%;">MovieLens</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.4.5.1.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.2.1" style="font-size:90%;">AUC</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.3.1" style="font-size:90%;">0.8142</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.4.1" style="font-size:90%;">0.8234</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.5.1" style="font-size:90%;">0.8113</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.6.1" style="font-size:90%;">0.8172</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.7.1" style="font-size:90%;">0.8142</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.8.1" style="font-size:90%;">0.8231</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.5.1.9.1" style="font-size:90%;">0.8241</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.10.1" style="font-size:90%;">0.8210</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.5.1.11.1" style="font-size:90%;">0.8320</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.5.1.12" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.5.1.12.1" style="font-size:90%;">4.68e-03</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.6.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.6.2.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.1.1" style="font-size:90%;">R@5</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.2.1" style="font-size:90%;">0.2867</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.3.1" style="font-size:90%;">0.3047</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.4.1" style="font-size:90%;">0.2867</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.5.1" style="font-size:90%;">0.3021</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.6.1" style="font-size:90%;">0.2902</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.7.1" style="font-size:90%;">0.3064</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.6.2.8.1" style="font-size:90%;">0.3142</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.9.1" style="font-size:90%;">0.3039</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.6.2.10.1" style="font-size:90%;">0.3249</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.6.2.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.6.2.11.1" style="font-size:90%;">3.88e-02</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.7.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.7.3.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.1.1" style="font-size:90%;">R@10</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.2.1" style="font-size:90%;">0.4463</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.3.1" style="font-size:90%;">0.4633</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.4.1" style="font-size:90%;">0.4469</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.5.1" style="font-size:90%;">0.4537</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.6.1" style="font-size:90%;">0.4509</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.7.1" style="font-size:90%;">0.4685</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.7.3.8.1" style="font-size:90%;">0.4787</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.9.1" style="font-size:90%;">0.4691</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.7.3.10.1" style="font-size:90%;">0.4916</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.7.3.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.7.3.11.1" style="font-size:90%;">2.66e-02</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.8.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.8.4.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.1.1" style="font-size:90%;">NDCG@5</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.2.1" style="font-size:90%;">0.2230</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.3.1" style="font-size:90%;">0.2362</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.4.1" style="font-size:90%;">0.2188</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.5.1" style="font-size:90%;">0.2338</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.6.1" style="font-size:90%;">0.2241</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.7.1" style="font-size:90%;">0.2348</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.8.4.8.1" style="font-size:90%;">0.2420</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.9.1" style="font-size:90%;">0.2354</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.8.4.10.1" style="font-size:90%;">0.2481</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.8.4.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.8.4.11.1" style="font-size:90%;">1.47e-02</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.9.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.9.5.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.2.1" style="font-size:90%;">0.3005</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.3.1" style="font-size:90%;">0.3129</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.4.1" style="font-size:90%;">0.2967</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.5.1" style="font-size:90%;">0.3072</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.6.1" style="font-size:90%;">0.3019</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.7.1" style="font-size:90%;">0.3134</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.9.5.8.1" style="font-size:90%;">0.3216</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.9.1" style="font-size:90%;">0.3152</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.9.5.10.1" style="font-size:90%;">0.3290</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.9.5.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.9.5.11.1" style="font-size:90%;">2.62e-02</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.2.1" style="padding-left:3.6pt;padding-right:3.6pt;">
<span class="ltx_text" id="S5.T4.2.2.1.1" style="font-size:90%;">Heterogeneity </span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T4.2.2.1.m1.1"><semantics id="S5.T4.2.2.1.m1.1a"><mo id="S5.T4.2.2.1.m1.1.1" mathsize="90%" stretchy="false" xref="S5.T4.2.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.1.m1.1b"><ci id="S5.T4.2.2.1.m1.1.1.cmml" xref="S5.T4.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.2.2.1.m1.1d">↓</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.2.2.2.1" style="font-size:90%;">7.1753</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.2.2.3.1" style="font-size:90%;">5.8783</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.2.2.4.1" style="font-size:90%;">5.4983</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.2.2.5.1" style="font-size:90%;">5.7853</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.2.2.6.1" style="font-size:90%;">5.7893</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.2.2.7.1" style="font-size:90%;">6.4233</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.2.2.8.1" style="font-size:90%;">6.1513</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.2.2.9.1" style="font-size:90%;">5.9233</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.2.2.10.1" style="font-size:90%;">5.6333</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.2.2.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.2.2.11.1" style="font-size:90%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.10.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.4.10.6.1" rowspan="6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.1.1" style="font-size:90%;">Amazon</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.4.10.6.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.2.1" style="font-size:90%;">AUC</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.3.1" style="font-size:90%;">0.8941</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.4.1" style="font-size:90%;">0.8827</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.5.1" style="font-size:90%;">0.8886</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.6.1" style="font-size:90%;">0.8957</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.7.1" style="font-size:90%;">0.8956</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.8.1" style="font-size:90%;">0.8953</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.9.1" style="font-size:90%;">0.8913</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.10.6.10.1" style="font-size:90%;">0.8963</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.10.6.11.1" style="font-size:90%;">0.8977</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.10.6.12" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.10.6.12.1" style="font-size:90%;">3.39e-03</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.11.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.11.7.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.1.1" style="font-size:90%;">R@5</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.2.1" style="font-size:90%;">0.5693</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.3.1" style="font-size:90%;">0.5723</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.4.1" style="font-size:90%;">0.5568</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.5.1" style="font-size:90%;">0.5730</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.6.1" style="font-size:90%;">0.5718</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.7.1" style="font-size:90%;">0.5743</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.11.7.8.1" style="font-size:90%;">0.5855</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.9.1" style="font-size:90%;">0.5760</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.11.7.10.1" style="font-size:90%;">0.6039</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.11.7.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.11.7.11.1" style="font-size:90%;">6.62e-06</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.12.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.12.8.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.1.1" style="font-size:90%;">R@10</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.2.1" style="font-size:90%;">0.6877</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.3.1" style="font-size:90%;">0.6880</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.4.1" style="font-size:90%;">0.6775</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.5.1" style="font-size:90%;">0.6918</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.6.1" style="font-size:90%;">0.6904</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.7.1" style="font-size:90%;">0.6923</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.8.1" style="font-size:90%;">0.6934</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.12.8.9.1" style="font-size:90%;">0.6947</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.12.8.10.1" style="font-size:90%;">0.7087</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.12.8.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.12.8.11.1" style="font-size:90%;">1.89e-03</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.13.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.13.9.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.1.1" style="font-size:90%;">NDCG@5</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.2.1" style="font-size:90%;">0.4838</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.3.1" style="font-size:90%;">0.4876</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.4.1" style="font-size:90%;">0.4721</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.5.1" style="font-size:90%;">0.4869</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.6.1" style="font-size:90%;">0.4865</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.7.1" style="font-size:90%;">0.4886</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.13.9.8.1" style="font-size:90%;">0.5018</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.9.1" style="font-size:90%;">0.4904</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.13.9.10.1" style="font-size:90%;">0.5191</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.13.9.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.13.9.11.1" style="font-size:90%;">1.49e-04</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.14.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.14.10.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.2.1" style="font-size:90%;">0.5416</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.3.1" style="font-size:90%;">0.5440</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.4.1" style="font-size:90%;">0.5310</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.5.1" style="font-size:90%;">0.5449</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.6.1" style="font-size:90%;">0.5444</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.7.1" style="font-size:90%;">0.5461</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.14.10.8.1" style="font-size:90%;">0.5544</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.9.1" style="font-size:90%;">0.5483</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.14.10.10.1" style="font-size:90%;">0.5716</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.14.10.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.14.10.11.1" style="font-size:90%;">6.94e-03</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.3.3.1" style="padding-left:3.6pt;padding-right:3.6pt;">
<span class="ltx_text" id="S5.T4.3.3.1.1" style="font-size:90%;">Heterogeneity </span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T4.3.3.1.m1.1"><semantics id="S5.T4.3.3.1.m1.1a"><mo id="S5.T4.3.3.1.m1.1.1" mathsize="90%" stretchy="false" xref="S5.T4.3.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.1.m1.1b"><ci id="S5.T4.3.3.1.m1.1.1.cmml" xref="S5.T4.3.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.3.3.1.m1.1d">↓</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.3.3.2.1" style="font-size:90%;">0.2224</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.3.3.3.1" style="font-size:90%;">0.1422</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.3.3.4.1" style="font-size:90%;">0.1082</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.3.3.5.1" style="font-size:90%;">0.1840</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.3.3.6.1" style="font-size:90%;">0.2350</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.3.3.7.1" style="font-size:90%;">0.1988</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.3.3.8.1" style="font-size:90%;">0.2376</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.3.3.9.1" style="font-size:90%;">0.1414</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.3.3.10.1" style="font-size:90%;">0.0762</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.3.3.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.3.3.11.1" style="font-size:90%;">5.10e-04</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.15.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T4.4.15.11.1" rowspan="6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.1.1" style="font-size:90%;">Alipay</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.4.15.11.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.2.1" style="font-size:90%;">AUC</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.3.1" style="font-size:90%;">0.8018</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.4.1" style="font-size:90%;">0.8006</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.15.11.5.1" style="font-size:90%;">0.8058</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.15.11.6.1" style="font-size:90%;">0.8058</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.7.1" style="font-size:90%;">0.8016</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.8.1" style="font-size:90%;">0.8017</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.15.11.9.1" style="font-size:90%;">0.8077</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.10.1" style="font-size:90%;">0.8016</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.11.1" style="font-size:90%;">0.8031</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.15.11.12" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.15.11.12.1" style="font-size:90%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.16.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.16.12.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.1.1" style="font-size:90%;">R@5</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.2.1" style="font-size:90%;">0.2094</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.3.1" style="font-size:90%;">0.2227</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.4.1" style="font-size:90%;">0.2253</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.5.1" style="font-size:90%;">0.2326</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.6.1" style="font-size:90%;">0.2281</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.7.1" style="font-size:90%;">0.2274</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.16.12.8.1" style="font-size:90%;">0.2612</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.9.1" style="font-size:90%;">0.2292</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.16.12.10.1" style="font-size:90%;">0.2909</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.16.12.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.16.12.11.1" style="font-size:90%;">2.61e-04</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.17.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.17.13.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.1.1" style="font-size:90%;">R@10</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.2.1" style="font-size:90%;">0.4177</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.3.1" style="font-size:90%;">0.4263</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.4.1" style="font-size:90%;">0.4276</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.5.1" style="font-size:90%;">0.4314</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.6.1" style="font-size:90%;">0.4298</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.7.1" style="font-size:90%;">0.4313</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.17.13.8.1" style="font-size:90%;">0.4492</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.9.1" style="font-size:90%;">0.4257</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.17.13.10.1" style="font-size:90%;">0.4657</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.17.13.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.17.13.11.1" style="font-size:90%;">2.16e-02</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.18.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.18.14.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.1.1" style="font-size:90%;">NDCG@5</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.2.1" style="font-size:90%;">0.1491</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.3.1" style="font-size:90%;">0.1615</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.4.1" style="font-size:90%;">0.1626</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.5.1" style="font-size:90%;">0.1674</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.6.1" style="font-size:90%;">0.1633</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.7.1" style="font-size:90%;">0.1637</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.18.14.8.1" style="font-size:90%;">0.1939</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.9.1" style="font-size:90%;">0.1661</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.18.14.10.1" style="font-size:90%;">0.2207</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.18.14.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.18.14.11.1" style="font-size:90%;">1.63e-05</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.19.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.4.19.15.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.1.1" style="font-size:90%;">NDCG@10</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.2.1" style="font-size:90%;">0.2501</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.3.1" style="font-size:90%;">0.2603</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.4.1" style="font-size:90%;">0.2607</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.5.1" style="font-size:90%;">0.2639</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.6.1" style="font-size:90%;">0.2614</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.7.1" style="font-size:90%;">0.2626</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.19.15.8.1" style="font-size:90%;">0.2848</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.9.1" style="font-size:90%;">0.2614</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.19.15.10.1" style="font-size:90%;">0.3053</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.19.15.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.19.15.11.1" style="font-size:90%;">1.06e-02</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T4.4.4.1" style="padding-left:3.6pt;padding-right:3.6pt;">
<span class="ltx_text" id="S5.T4.4.4.1.1" style="font-size:90%;">Heterogeneity </span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T4.4.4.1.m1.1"><semantics id="S5.T4.4.4.1.m1.1a"><mo id="S5.T4.4.4.1.m1.1.1" mathsize="90%" stretchy="false" xref="S5.T4.4.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.1.m1.1b"><ci id="S5.T4.4.4.1.m1.1.1.cmml" xref="S5.T4.4.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.4.4.1.m1.1d">↓</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.4.2.1" style="font-size:90%;">2.0041</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.4.3.1" style="font-size:90%;">2.0877</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.4.4.1" style="font-size:90%;">1.6609</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.4.5.1" style="font-size:90%;">1.6577</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.4.6.1" style="font-size:90%;">1.8715</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.4.7.1" style="font-size:90%;">1.6355</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.8" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.4.8.1" style="font-size:90%;">2.3579</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.9" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T4.4.4.9.1" style="font-size:90%;">1.5945</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.10" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.4.4.10.1" style="font-size:90%;">1.5747</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.4.11" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T4.4.4.11.1" style="font-size:90%;">2.31e-02</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.4"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.4.1">Implementation Details and Evaluation. </span> Since <span class="ltx_text ltx_font_italic" id="S5.SS1.p4.4.2">CausalD</span> is designed as model-agnostic, we instantiate CausalD and baselines on two representative base recommenders, <span class="ltx_text ltx_font_italic" id="S5.SS1.p4.4.3">i</span>.<span class="ltx_text ltx_font_italic" id="S5.SS1.p4.4.4">e</span>., Deep Interest Network (DIN) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib1" title="">1</a>]</cite> and DeepFM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib56" title="">56</a>]</cite>. All models except for KD, which is a single-teacher distillation baseline, share the same pre-trained multiple teachers. We optimize all models with Adagrad <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib57" title="">57</a>]</cite> as the optimizer and with the default choice of learning rate (<span class="ltx_text ltx_font_italic" id="S5.SS1.p4.4.5">i</span>.<span class="ltx_text ltx_font_italic" id="S5.SS1.p4.4.6">e</span>., <math alttext="0.01" class="ltx_Math" display="inline" id="S5.SS1.p4.1.m1.1"><semantics id="S5.SS1.p4.1.m1.1a"><mn id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><cn id="S5.SS1.p4.1.m1.1.1.cmml" type="float" xref="S5.SS1.p4.1.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">0.01</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.1.m1.1d">0.01</annotation></semantics></math>). All models are with batch size 4096, and user/item embedding size 8. For DIN and models constructed upon it, we consider the last 50 items interacted to form the user sequence. For loss coefficients of all models that introduce additional loss functions (including <math alttext="\mathcal{L}_{BDA}" class="ltx_Math" display="inline" id="S5.SS1.p4.2.m2.1"><semantics id="S5.SS1.p4.2.m2.1a"><msub id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p4.2.m2.1.1.2" xref="S5.SS1.p4.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S5.SS1.p4.2.m2.1.1.3" xref="S5.SS1.p4.2.m2.1.1.3.cmml"><mi id="S5.SS1.p4.2.m2.1.1.3.2" xref="S5.SS1.p4.2.m2.1.1.3.2.cmml">B</mi><mo id="S5.SS1.p4.2.m2.1.1.3.1" xref="S5.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p4.2.m2.1.1.3.3" xref="S5.SS1.p4.2.m2.1.1.3.3.cmml">D</mi><mo id="S5.SS1.p4.2.m2.1.1.3.1a" xref="S5.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p4.2.m2.1.1.3.4" xref="S5.SS1.p4.2.m2.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.1b"><apply id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.2.m2.1.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p4.2.m2.1.1.2.cmml" xref="S5.SS1.p4.2.m2.1.1.2">ℒ</ci><apply id="S5.SS1.p4.2.m2.1.1.3.cmml" xref="S5.SS1.p4.2.m2.1.1.3"><times id="S5.SS1.p4.2.m2.1.1.3.1.cmml" xref="S5.SS1.p4.2.m2.1.1.3.1"></times><ci id="S5.SS1.p4.2.m2.1.1.3.2.cmml" xref="S5.SS1.p4.2.m2.1.1.3.2">𝐵</ci><ci id="S5.SS1.p4.2.m2.1.1.3.3.cmml" xref="S5.SS1.p4.2.m2.1.1.3.3">𝐷</ci><ci id="S5.SS1.p4.2.m2.1.1.3.4.cmml" xref="S5.SS1.p4.2.m2.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.1c">\mathcal{L}_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{FDA}" class="ltx_Math" display="inline" id="S5.SS1.p4.3.m3.1"><semantics id="S5.SS1.p4.3.m3.1a"><msub id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p4.3.m3.1.1.2" xref="S5.SS1.p4.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S5.SS1.p4.3.m3.1.1.3" xref="S5.SS1.p4.3.m3.1.1.3.cmml"><mi id="S5.SS1.p4.3.m3.1.1.3.2" xref="S5.SS1.p4.3.m3.1.1.3.2.cmml">F</mi><mo id="S5.SS1.p4.3.m3.1.1.3.1" xref="S5.SS1.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p4.3.m3.1.1.3.3" xref="S5.SS1.p4.3.m3.1.1.3.3.cmml">D</mi><mo id="S5.SS1.p4.3.m3.1.1.3.1a" xref="S5.SS1.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p4.3.m3.1.1.3.4" xref="S5.SS1.p4.3.m3.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><apply id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.3.m3.1.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p4.3.m3.1.1.2.cmml" xref="S5.SS1.p4.3.m3.1.1.2">ℒ</ci><apply id="S5.SS1.p4.3.m3.1.1.3.cmml" xref="S5.SS1.p4.3.m3.1.1.3"><times id="S5.SS1.p4.3.m3.1.1.3.1.cmml" xref="S5.SS1.p4.3.m3.1.1.3.1"></times><ci id="S5.SS1.p4.3.m3.1.1.3.2.cmml" xref="S5.SS1.p4.3.m3.1.1.3.2">𝐹</ci><ci id="S5.SS1.p4.3.m3.1.1.3.3.cmml" xref="S5.SS1.p4.3.m3.1.1.3.3">𝐷</ci><ci id="S5.SS1.p4.3.m3.1.1.3.4.cmml" xref="S5.SS1.p4.3.m3.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">\mathcal{L}_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> in CausalD), we search in the range of <math alttext="\{0.01,0.1,1,10\}" class="ltx_Math" display="inline" id="S5.SS1.p4.4.m4.4"><semantics id="S5.SS1.p4.4.m4.4a"><mrow id="S5.SS1.p4.4.m4.4.5.2" xref="S5.SS1.p4.4.m4.4.5.1.cmml"><mo id="S5.SS1.p4.4.m4.4.5.2.1" stretchy="false" xref="S5.SS1.p4.4.m4.4.5.1.cmml">{</mo><mn id="S5.SS1.p4.4.m4.1.1" xref="S5.SS1.p4.4.m4.1.1.cmml">0.01</mn><mo id="S5.SS1.p4.4.m4.4.5.2.2" xref="S5.SS1.p4.4.m4.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.4.m4.2.2" xref="S5.SS1.p4.4.m4.2.2.cmml">0.1</mn><mo id="S5.SS1.p4.4.m4.4.5.2.3" xref="S5.SS1.p4.4.m4.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.4.m4.3.3" xref="S5.SS1.p4.4.m4.3.3.cmml">1</mn><mo id="S5.SS1.p4.4.m4.4.5.2.4" xref="S5.SS1.p4.4.m4.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.4.m4.4.4" xref="S5.SS1.p4.4.m4.4.4.cmml">10</mn><mo id="S5.SS1.p4.4.m4.4.5.2.5" stretchy="false" xref="S5.SS1.p4.4.m4.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.4.m4.4b"><set id="S5.SS1.p4.4.m4.4.5.1.cmml" xref="S5.SS1.p4.4.m4.4.5.2"><cn id="S5.SS1.p4.4.m4.1.1.cmml" type="float" xref="S5.SS1.p4.4.m4.1.1">0.01</cn><cn id="S5.SS1.p4.4.m4.2.2.cmml" type="float" xref="S5.SS1.p4.4.m4.2.2">0.1</cn><cn id="S5.SS1.p4.4.m4.3.3.cmml" type="integer" xref="S5.SS1.p4.4.m4.3.3">1</cn><cn id="S5.SS1.p4.4.m4.4.4.cmml" type="integer" xref="S5.SS1.p4.4.m4.4.4">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.4.m4.4c">\{0.01,0.1,1,10\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.4.m4.4d">{ 0.01 , 0.1 , 1 , 10 }</annotation></semantics></math>. We run CausalD and the best-performing baseline for five times independently, and conduct two-sided tests.</p>
</div>
<div class="ltx_para" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.1">It is known that industrial recommender systems typically consist of two phases, <span class="ltx_text ltx_font_italic" id="S5.SS1.p5.1.1">i</span>.<span class="ltx_text ltx_font_italic" id="S5.SS1.p5.1.2">e</span>., the matching phase (also known as deep candidate generation) and the ranking phase. In the literature, evaluation strategies for these two lines of works are different.
For example, ranking models solely sort a small group of candidates rather than the whole item gallery. Therefore, ranking models can incorporate complex feature interactions between items and users.
In this paper, we focus on the ranking phase and obey the next-item recommendation protocol to evaluate the performance of models, which has been widely used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib2" title="">2</a>]</cite>. Specifically, we chronologically order the interacted items for each user to have a behavior sequence, and leave the last element of the behavior sequence for testing. The testing target item is paired with 100 randomly sampled negative items that the user has not consumed.
To have a comprehensive analysis of models, we employ various <span class="ltx_text ltx_font_italic" id="S5.SS1.p5.1.3">evaluation metrics</span>, including Area Under the ROC Curve (AUC), Normalized Discounted Cumulative Gain (NDCG), and Recall. We report metrics computed on the top 5/10 items. Besides these widely used metrics, we also evaluate the performance heterogeneity of different users. <span class="ltx_text" id="S5.SS1.p5.1.4">The <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.p5.1.4.1" style="color:#000000;">Heterogeneity</span> metric is the mean of five bias-amplified performance heterogeneity scores computed according to Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E8" title="In 3.1 Problem Formulation ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">8</span></a> over five metrics (AUC, R@5, R@10, NDCG@5, NDCG10).<span class="ltx_text" id="S5.SS1.p5.1.4.2">
The lower values, the better.
</span></span></p>
</div>
<figure class="ltx_figure" id="S5.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="726" id="S5.F4.sf1.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.sf1.3.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F4.sf1.4.2" style="font-size:90%;">
Observed confounder: <span class="ltx_text ltx_font_italic" id="S5.F4.sf1.4.2.1">user activeness</span>.
</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="726" id="S5.F4.sf2.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.sf2.3.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F4.sf2.4.2" style="font-size:90%;">
Unobserved confounder: user <span class="ltx_text ltx_font_italic" id="S5.F4.sf2.4.2.1">behavior consistency</span>.
</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.7.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S5.F4.8.2" style="font-size:90%;">
Performance heterogeneity across different user groups <span class="ltx_text ltx_font_italic" id="S5.F4.8.2.1">w</span>.<span class="ltx_text ltx_font_italic" id="S5.F4.8.2.2">r</span>.<span class="ltx_text ltx_font_italic" id="S5.F4.8.2.3">t</span>. two confounders, <span class="ltx_text ltx_font_italic" id="S5.F4.8.2.4">i</span>.<span class="ltx_text ltx_font_italic" id="S5.F4.8.2.5">e</span>., user activeness, and behavior consistency. The performance heterogeneity over user groups is largely reduced compared to the base model DIN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib1" title="">1</a>]</cite>.
</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span><span class="ltx_text ltx_font_italic" id="S5.SS2.1.1">Overall Performance (RQ1)</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We run CausalD and all baselines on three datasets. For each model, we run it five times and take the average averaged results. The results with DIN and DeepFM as base models are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S4.T3" title="TABLE III ‣ 4.2 Knowledge Distillation ‣ 4 Related Works ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">III</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.T4" title="TABLE IV ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">IV</span></a>, respectively. Higher values are better for AUC, NDCG, and Recall except for Heterogeneity. From the comprehensive results, we have the following observations:</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<ul class="ltx_itemize" id="S5.I4">
<li class="ltx_item" id="S5.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i1.p1">
<p class="ltx_p" id="S5.I4.i1.p1.2">In summary, CausalD achieves the best performance and the least performance heterogeneity in most cases. For example, CausalD outperforms DIN and the best performing baseline EnsCTR by 15.85% and 6.41% (NDCG@5), and reduces the performance heterogeneity by 8.14% and 11.09% on the MovieLens dataset. The performance gains are statistically significant with <math alttext="p" class="ltx_Math" display="inline" id="S5.I4.i1.p1.1.m1.1"><semantics id="S5.I4.i1.p1.1.m1.1a"><mi id="S5.I4.i1.p1.1.m1.1.1" xref="S5.I4.i1.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.I4.i1.p1.1.m1.1b"><ci id="S5.I4.i1.p1.1.m1.1.1.cmml" xref="S5.I4.i1.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I4.i1.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S5.I4.i1.p1.1.m1.1d">italic_p</annotation></semantics></math>-value <math alttext="&lt;0.05" class="ltx_Math" display="inline" id="S5.I4.i1.p1.2.m2.1"><semantics id="S5.I4.i1.p1.2.m2.1a"><mrow id="S5.I4.i1.p1.2.m2.1.1" xref="S5.I4.i1.p1.2.m2.1.1.cmml"><mi id="S5.I4.i1.p1.2.m2.1.1.2" xref="S5.I4.i1.p1.2.m2.1.1.2.cmml"></mi><mo id="S5.I4.i1.p1.2.m2.1.1.1" xref="S5.I4.i1.p1.2.m2.1.1.1.cmml">&lt;</mo><mn id="S5.I4.i1.p1.2.m2.1.1.3" xref="S5.I4.i1.p1.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.I4.i1.p1.2.m2.1b"><apply id="S5.I4.i1.p1.2.m2.1.1.cmml" xref="S5.I4.i1.p1.2.m2.1.1"><lt id="S5.I4.i1.p1.2.m2.1.1.1.cmml" xref="S5.I4.i1.p1.2.m2.1.1.1"></lt><csymbol cd="latexml" id="S5.I4.i1.p1.2.m2.1.1.2.cmml" xref="S5.I4.i1.p1.2.m2.1.1.2">absent</csymbol><cn id="S5.I4.i1.p1.2.m2.1.1.3.cmml" type="float" xref="S5.I4.i1.p1.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I4.i1.p1.2.m2.1c">&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S5.I4.i1.p1.2.m2.1d">&lt; 0.05</annotation></semantics></math> under two-sided tests<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html</span></span></span></span>. Improving the overall performance while reducing the heterogeneity probably indicates that tail users benefit more with CausalD compared to other baselines. We further reveal the rationality of this analysis in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.SS3" title="5.3 Deconfounding Analysis (RQ2) ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5.3</span></a>. On the contrary, some other baselines (such as IPS) achieve low heterogeneity and low performance at the same time, which means that they might hurt the performance of head users. The improvements are consistent across different recommendation architectures and different datasets, showing the merits of CausalD being model-agnostic and domain-agnostic.
On the larger-scale dataset, Alipay, the improvements are even more substantial. In essence, these results demonstrate the necessity of reducing confounding effects for recommender systems, and the effectiveness of the causal distillation framework.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i2.p1">
<p class="ltx_p" id="S5.I4.i2.p1.1">The oracle distillation framework (KD) obtains almost no gains <span class="ltx_text ltx_font_italic" id="S5.I4.i2.p1.1.1">w</span>.<span class="ltx_text ltx_font_italic" id="S5.I4.i2.p1.1.2">r</span>.<span class="ltx_text ltx_font_italic" id="S5.I4.i2.p1.1.3">t</span>. the base models. This indicates that when the model capacity and the training data remain the same, the unprivileged teacher might not be very useful in recommender systems. This method can reduce the heterogeneity to a limited extent. We attribute this result to that soft labels produced by the teacher can probably convey some confidence judgments on the predictions for different users. For example, active users might get smoother soft labels than inactive ones.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i3.p1">
<p class="ltx_p" id="S5.I4.i3.p1.1">IPS reduces the performance heterogeneity in many cases by considering user-specific propensity scores. However, it obtains almost no gains on recommendation performance and sometimes does harm on MovieLens and Amazon with DIN as the base model. One reasonable explanation is that IPS largely sacrifices the performance of head users for the performance of long-tail users. Compared to IPS, exposure-aware causal baselines CausalRec and DeRec can consistently improve the Base model. By correcting the exposure bias, these models are potentially less affected by the spurious correlations between users and frequently exposed items. Tail users could benefit from the correction since they suffer more from spurious correlations as illustrated in the Introduction. However, they might not effectively handle other ubiquitous confounders (<span class="ltx_text ltx_font_italic" id="S5.I4.i3.p1.1.1">e</span>.<span class="ltx_text ltx_font_italic" id="S5.I4.i3.p1.1.2">g</span>., user activeness, item popularity) beyond exposure.
The debiased distillation baseline DebiasD can also obtain some performance gains and reduces the performance heterogeneity to some extent. It learns whether we should trust teachers and how differently we should trust different teachers in distillation. But still, its results are inferior to CausalD in most cases.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i4.p1">
<p class="ltx_p" id="S5.I4.i4.p1.1">Muti-teacher distillation baseline EnsCTR achieves good performance compared to other baselines. It leverages multi-teachers to maximize the recommendation performance. However, the heterogeneity is mostly worse than other baselines and even worse than the base model in some cases, which probably means EnsCTR further sacrifices the performance of tail users. The performance of MEAL seems to be less consistent in different experimental settings. Unstable training caused by adversarial learning is also found in many other research fields <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#bib.bib58" title="">58</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i5.p1">
<p class="ltx_p" id="S5.I4.i5.p1.1"><span class="ltx_text" id="S5.I4.i5.p1.1.1">We also notice that with DeepFM as the base model, CausalD cannot beat other baselines in a few cases while CausalD with DIN as the base model could consistently achieve the best results. We attribute this phenomenon to the two parallel components, <span class="ltx_text ltx_font_italic" id="S5.I4.i5.p1.1.1.1">i</span>.<span class="ltx_text ltx_font_italic" id="S5.I4.i5.p1.1.1.2">e</span>., the FM component and the DNN component, of DeepFM. On the one hand, the causal feature distillation that operates on intermediate representations is mostly affecting the DNN component while the FM component might still suffer from training biases. On the other hand, two parallel components would result in two independent predictions while their relative importance might be hard to determine under causal label distillation. Still, we observe that CausalD over DeepFM could achieve the best results in most cases, demonstrating the model-agnostic effectiveness of CausalD. <span class="ltx_text" id="S5.I4.i5.p1.1.1.3"></span></span></p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="199" id="S5.F5.1.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.9.4.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S5.F5.7.6.3" style="font-size:90%;">
Recommendation performance with loss coefficients (<math alttext="\lambda_{BDA}" class="ltx_Math" display="inline" id="S5.F5.5.4.1.m1.1"><semantics id="S5.F5.5.4.1.m1.1b"><msub id="S5.F5.5.4.1.m1.1.1" xref="S5.F5.5.4.1.m1.1.1.cmml"><mi id="S5.F5.5.4.1.m1.1.1.2" xref="S5.F5.5.4.1.m1.1.1.2.cmml">λ</mi><mrow id="S5.F5.5.4.1.m1.1.1.3" xref="S5.F5.5.4.1.m1.1.1.3.cmml"><mi id="S5.F5.5.4.1.m1.1.1.3.2" xref="S5.F5.5.4.1.m1.1.1.3.2.cmml">B</mi><mo id="S5.F5.5.4.1.m1.1.1.3.1" xref="S5.F5.5.4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.F5.5.4.1.m1.1.1.3.3" xref="S5.F5.5.4.1.m1.1.1.3.3.cmml">D</mi><mo id="S5.F5.5.4.1.m1.1.1.3.1b" xref="S5.F5.5.4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.F5.5.4.1.m1.1.1.3.4" xref="S5.F5.5.4.1.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F5.5.4.1.m1.1c"><apply id="S5.F5.5.4.1.m1.1.1.cmml" xref="S5.F5.5.4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F5.5.4.1.m1.1.1.1.cmml" xref="S5.F5.5.4.1.m1.1.1">subscript</csymbol><ci id="S5.F5.5.4.1.m1.1.1.2.cmml" xref="S5.F5.5.4.1.m1.1.1.2">𝜆</ci><apply id="S5.F5.5.4.1.m1.1.1.3.cmml" xref="S5.F5.5.4.1.m1.1.1.3"><times id="S5.F5.5.4.1.m1.1.1.3.1.cmml" xref="S5.F5.5.4.1.m1.1.1.3.1"></times><ci id="S5.F5.5.4.1.m1.1.1.3.2.cmml" xref="S5.F5.5.4.1.m1.1.1.3.2">𝐵</ci><ci id="S5.F5.5.4.1.m1.1.1.3.3.cmml" xref="S5.F5.5.4.1.m1.1.1.3.3">𝐷</ci><ci id="S5.F5.5.4.1.m1.1.1.3.4.cmml" xref="S5.F5.5.4.1.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.5.4.1.m1.1d">\lambda_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S5.F5.5.4.1.m1.1e">italic_λ start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{FDA}" class="ltx_Math" display="inline" id="S5.F5.6.5.2.m2.1"><semantics id="S5.F5.6.5.2.m2.1b"><msub id="S5.F5.6.5.2.m2.1.1" xref="S5.F5.6.5.2.m2.1.1.cmml"><mi id="S5.F5.6.5.2.m2.1.1.2" xref="S5.F5.6.5.2.m2.1.1.2.cmml">λ</mi><mrow id="S5.F5.6.5.2.m2.1.1.3" xref="S5.F5.6.5.2.m2.1.1.3.cmml"><mi id="S5.F5.6.5.2.m2.1.1.3.2" xref="S5.F5.6.5.2.m2.1.1.3.2.cmml">F</mi><mo id="S5.F5.6.5.2.m2.1.1.3.1" xref="S5.F5.6.5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.F5.6.5.2.m2.1.1.3.3" xref="S5.F5.6.5.2.m2.1.1.3.3.cmml">D</mi><mo id="S5.F5.6.5.2.m2.1.1.3.1b" xref="S5.F5.6.5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.F5.6.5.2.m2.1.1.3.4" xref="S5.F5.6.5.2.m2.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F5.6.5.2.m2.1c"><apply id="S5.F5.6.5.2.m2.1.1.cmml" xref="S5.F5.6.5.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F5.6.5.2.m2.1.1.1.cmml" xref="S5.F5.6.5.2.m2.1.1">subscript</csymbol><ci id="S5.F5.6.5.2.m2.1.1.2.cmml" xref="S5.F5.6.5.2.m2.1.1.2">𝜆</ci><apply id="S5.F5.6.5.2.m2.1.1.3.cmml" xref="S5.F5.6.5.2.m2.1.1.3"><times id="S5.F5.6.5.2.m2.1.1.3.1.cmml" xref="S5.F5.6.5.2.m2.1.1.3.1"></times><ci id="S5.F5.6.5.2.m2.1.1.3.2.cmml" xref="S5.F5.6.5.2.m2.1.1.3.2">𝐹</ci><ci id="S5.F5.6.5.2.m2.1.1.3.3.cmml" xref="S5.F5.6.5.2.m2.1.1.3.3">𝐷</ci><ci id="S5.F5.6.5.2.m2.1.1.3.4.cmml" xref="S5.F5.6.5.2.m2.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.6.5.2.m2.1d">\lambda_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S5.F5.6.5.2.m2.1e">italic_λ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math>) varying in range <math alttext="\{0.01,0.1,1,10\}" class="ltx_Math" display="inline" id="S5.F5.7.6.3.m3.4"><semantics id="S5.F5.7.6.3.m3.4b"><mrow id="S5.F5.7.6.3.m3.4.5.2" xref="S5.F5.7.6.3.m3.4.5.1.cmml"><mo id="S5.F5.7.6.3.m3.4.5.2.1" stretchy="false" xref="S5.F5.7.6.3.m3.4.5.1.cmml">{</mo><mn id="S5.F5.7.6.3.m3.1.1" xref="S5.F5.7.6.3.m3.1.1.cmml">0.01</mn><mo id="S5.F5.7.6.3.m3.4.5.2.2" xref="S5.F5.7.6.3.m3.4.5.1.cmml">,</mo><mn id="S5.F5.7.6.3.m3.2.2" xref="S5.F5.7.6.3.m3.2.2.cmml">0.1</mn><mo id="S5.F5.7.6.3.m3.4.5.2.3" xref="S5.F5.7.6.3.m3.4.5.1.cmml">,</mo><mn id="S5.F5.7.6.3.m3.3.3" xref="S5.F5.7.6.3.m3.3.3.cmml">1</mn><mo id="S5.F5.7.6.3.m3.4.5.2.4" xref="S5.F5.7.6.3.m3.4.5.1.cmml">,</mo><mn id="S5.F5.7.6.3.m3.4.4" xref="S5.F5.7.6.3.m3.4.4.cmml">10</mn><mo id="S5.F5.7.6.3.m3.4.5.2.5" stretchy="false" xref="S5.F5.7.6.3.m3.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.7.6.3.m3.4c"><set id="S5.F5.7.6.3.m3.4.5.1.cmml" xref="S5.F5.7.6.3.m3.4.5.2"><cn id="S5.F5.7.6.3.m3.1.1.cmml" type="float" xref="S5.F5.7.6.3.m3.1.1">0.01</cn><cn id="S5.F5.7.6.3.m3.2.2.cmml" type="float" xref="S5.F5.7.6.3.m3.2.2">0.1</cn><cn id="S5.F5.7.6.3.m3.3.3.cmml" type="integer" xref="S5.F5.7.6.3.m3.3.3">1</cn><cn id="S5.F5.7.6.3.m3.4.4.cmml" type="integer" xref="S5.F5.7.6.3.m3.4.4">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.7.6.3.m3.4d">\{0.01,0.1,1,10\}</annotation><annotation encoding="application/x-llamapun" id="S5.F5.7.6.3.m3.4e">{ 0.01 , 0.1 , 1 , 10 }</annotation></semantics></math>.
</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span><span class="ltx_text ltx_font_italic" id="S5.SS3.1.1">Deconfounding Analysis (RQ2)</span>
</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We are interested in whether CausalD reduces the performance heterogeneity of users by deconfounding and improving the performance of tail users with minor performance sacrifice of head users. In this regard, we report the recommendation performance of models on different user groups split <span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.1">w</span>.<span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.2">r</span>.<span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.3">t</span>. two confounders, <span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.4">i</span>.<span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.5">e</span>., 1) <span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.6">user activeness</span>, which is observed by the model, and 2) users’ <span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.7">behavior consistency</span> on popular items, which is unobserved by the model. We evaluate CausalD, a variant of CausalD without loss <math alttext="\mathcal{L}_{FDA}" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml"><mi id="S5.SS3.p1.1.m1.1.1.3.2" xref="S5.SS3.p1.1.m1.1.1.3.2.cmml">F</mi><mo id="S5.SS3.p1.1.m1.1.1.3.1" xref="S5.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p1.1.m1.1.1.3.3" xref="S5.SS3.p1.1.m1.1.1.3.3.cmml">D</mi><mo id="S5.SS3.p1.1.m1.1.1.3.1a" xref="S5.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p1.1.m1.1.1.3.4" xref="S5.SS3.p1.1.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">ℒ</ci><apply id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3"><times id="S5.SS3.p1.1.m1.1.1.3.1.cmml" xref="S5.SS3.p1.1.m1.1.1.3.1"></times><ci id="S5.SS3.p1.1.m1.1.1.3.2.cmml" xref="S5.SS3.p1.1.m1.1.1.3.2">𝐹</ci><ci id="S5.SS3.p1.1.m1.1.1.3.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3.3">𝐷</ci><ci id="S5.SS3.p1.1.m1.1.1.3.4.cmml" xref="S5.SS3.p1.1.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\mathcal{L}_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> (w.o. FDA), and the Base DIN model.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.F4.sf1" title="In Figure 4 ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">4(a)</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.F4.sf2" title="In Figure 4 ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">4(b)</span></a> show the results. We plot both the recommendation performance (the lines) and the values of confounders (the bars), including user activeness and behavior inconsistency. According to the results, we have the following observations:</p>
<ul class="ltx_itemize" id="S5.I5">
<li class="ltx_item" id="S5.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I5.i1.p1">
<p class="ltx_p" id="S5.I5.i1.p1.1">Overall, these results further show the effectiveness of CausalD on improving recommendation performance and reducing performance heterogeneity of different users.</p>
</div>
</li>
<li class="ltx_item" id="S5.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I5.i2.p1">
<p class="ltx_p" id="S5.I5.i2.p1.1">By analyzing the performance over different groups in detail, we observe that CausalD improves the recommendation performance by mainly and largely improving the results of tail users that suffer from low-quality recommendation while mostly preserving the recommendation quality of head users. These results basically demonstrate that CausalD reaches the major goal of this work, <span class="ltx_text ltx_font_italic" id="S5.I5.i2.p1.1.1">i</span>.<span class="ltx_text ltx_font_italic" id="S5.I5.i2.p1.1.2">e</span>., to alleviate model training bias that is in favor of head users, and to reduce performance heterogeneity by mainly improving the performance of tail users that originally benefit little from the co-training of all users. This merit can be potentially of great value in real-world recommender systems where tail users are the majority and cold-start problems are ubiquitous.</p>
</div>
</li>
<li class="ltx_item" id="S5.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I5.i3.p1">
<p class="ltx_p" id="S5.I5.i3.p1.1"><span class="ltx_text" id="S5.I5.i3.p1.1.1">Although the DeRec causal recommendation baseline and the DebiasD debiased distillation baseline can provide some relief for performance heterogeneity issues in certain scenarios, there remains a significant disparity in bias alleviation performance compared to causalD. These results are consistent with those outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.SS2" title="5.2 Overall Performance (RQ1) ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5.2</span></a> and the analytical observations was comparable.<span class="ltx_text" id="S5.I5.i3.p1.1.1.1"></span></span></p>
</div>
</li>
<li class="ltx_item" id="S5.I5.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I5.i4.p1">
<p class="ltx_p" id="S5.I5.i4.p1.1">CausalD can successfully handle confounders (<span class="ltx_text ltx_font_italic" id="S5.I5.i4.p1.1.1">e</span>.<span class="ltx_text ltx_font_italic" id="S5.I5.i4.p1.1.2">g</span>., behavior consistency) that are unobserved to the model. This is technically critical merit of the CausalD framework. In real-world scenarios, we cannot observe all confounders that cause the spurious correlations of historical behaviors and the next behaviors, resulting in inevitable performance heterogeneity and non-robustness. Dealing with unobserved confounders is enticing but challenging, and this work demonstrates the front-door adjustment might be a promising technique for recommender systems.</p>
</div>
</li>
<li class="ltx_item" id="S5.I5.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I5.i5.p1">
<p class="ltx_p" id="S5.I5.i5.p1.1"><span class="ltx_text" id="S5.I5.i5.p1.1.1">We also notice that, in some cases, the performance of CausalD on head users becomes worse than the Base model. This phenomenon can be intuitive since by alleviating training bias brought by potential confounders, the model might capture less biased prediction shortcuts that are in favor of the majority user group. For example, some active users might click a lot of popular items disregarding their inherent interests, leading to biased records. Debiased models might recommend items that are less affected by the item popularities, and thus probably hurting the performance of the above users. Still, CausalD achieves consistently better performance for all user groups in most cases. We leave user-wise bias exploitation as a potential future work. <span class="ltx_text" id="S5.I5.i5.p1.1.1.1"></span></span></p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">esults of causal recommendation baseline DeRec and debiased distillation baseline DebiaseD in Figure 4</p>
</div>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T5.11.4.1" style="font-size:90%;">TABLE V</span>: </span><span class="ltx_text" id="S5.T5.6.3" style="font-size:90%;">Ablation study with DIN as the base model <span class="ltx_text ltx_font_italic" id="S5.T5.6.3.1">w</span>.<span class="ltx_text ltx_font_italic" id="S5.T5.6.3.2">r</span>.<span class="ltx_text ltx_font_italic" id="S5.T5.6.3.3">t</span>. three critical components: 1) front-door adjustment (w.o. FDA <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T5.4.1.m1.1"><semantics id="S5.T5.4.1.m1.1b"><mo id="S5.T5.4.1.m1.1.1" stretchy="false" xref="S5.T5.4.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T5.4.1.m1.1c"><ci id="S5.T5.4.1.m1.1.1.cmml" xref="S5.T5.4.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.1.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.4.1.m1.1e">→</annotation></semantics></math> CausalD); 2) back-door adjustment (Base <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T5.5.2.m2.1"><semantics id="S5.T5.5.2.m2.1b"><mo id="S5.T5.5.2.m2.1.1" stretchy="false" xref="S5.T5.5.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T5.5.2.m2.1c"><ci id="S5.T5.5.2.m2.1.1.cmml" xref="S5.T5.5.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.5.2.m2.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.5.2.m2.1e">→</annotation></semantics></math> w.o. FDA); and 3) heterogeneous teachers (Homogeneous (Ho) Teachers <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T5.6.3.m3.1"><semantics id="S5.T5.6.3.m3.1b"><mo id="S5.T5.6.3.m3.1.1" stretchy="false" xref="S5.T5.6.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T5.6.3.m3.1c"><ci id="S5.T5.6.3.m3.1.1.cmml" xref="S5.T5.6.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.6.3.m3.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.6.3.m3.1e">→</annotation></semantics></math> CausalD).</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.12.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T5.12.1.1.1" style="padding-left:3.6pt;padding-right:3.6pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T5.12.1.1.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.1.1.2.1" style="font-size:90%;">Amazon</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T5.12.1.1.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.1.1.3.1" style="font-size:90%;">Alipay</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.12.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T5.12.2.2.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.2.2.1.1" style="font-size:90%;">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.2.2.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.2.2.2.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.2.2.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.2.2.3.1" style="font-size:90%;">NDCG</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.2.2.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.2.2.4.1" style="font-size:90%;">Recall</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.2.2.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.2.2.5.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.2.2.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.2.2.6.1" style="font-size:90%;">NDCG</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.2.2.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.2.2.7.1" style="font-size:90%;">Recall</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.12.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T5.12.3.3.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.3.3.1.1" style="font-size:90%;">DIN (Base)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.3.3.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.3.3.2.1" style="font-size:90%;">0.8873</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.3.3.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.3.3.3.1" style="font-size:90%;">0.5384</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.3.3.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.3.3.4.1" style="font-size:90%;">0.6877</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.3.3.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.3.3.5.1" style="font-size:90%;">0.7691</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.3.3.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.3.3.6.1" style="font-size:90%;">0.2076</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.3.3.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.3.3.7.1" style="font-size:90%;">0.3518</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.12.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T5.12.4.4.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.4.4.1.1" style="font-size:90%;">Ho Teachers</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.4.4.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.4.4.2.1" style="font-size:90%;">0.8869</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.4.4.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.4.4.3.1" style="font-size:90%;">0.5429</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.4.4.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.4.4.4.1" style="font-size:90%;">0.6883</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.4.4.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.4.4.5.1" style="font-size:90%;">0.7723</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.4.4.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.4.4.6.1" style="font-size:90%;">0.2289</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.12.4.4.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.4.4.7.1" style="font-size:90%;">0.3953</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.12.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T5.12.5.5.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.5.5.1.1" style="font-size:90%;">w.o. FDA</span></th>
<td class="ltx_td ltx_align_center" id="S5.T5.12.5.5.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.5.5.2.1" style="font-size:90%;">0.8952</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.12.5.5.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.5.5.3.1" style="font-size:90%;">0.5527</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.12.5.5.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.5.5.4.1" style="font-size:90%;">0.7008</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.12.5.5.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.5.5.5.1" style="font-size:90%;">0.7727</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.12.5.5.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.5.5.6.1" style="font-size:90%;">0.2238</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.12.5.5.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.5.5.7.1" style="font-size:90%;">0.4168</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.12.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T5.12.6.6.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T5.12.6.6.1.1" style="font-size:90%;">CausalD</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.12.6.6.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.12.6.6.2.1" style="font-size:90%;">0.9027</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.12.6.6.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.12.6.6.3.1" style="font-size:90%;">0.5751</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.12.6.6.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.12.6.6.4.1" style="font-size:90%;">0.7216</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.12.6.6.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.12.6.6.5.1" style="font-size:90%;">0.7777</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.12.6.6.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.12.6.6.6.1" style="font-size:90%;">0.2779</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.12.6.6.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.12.6.6.7.1" style="font-size:90%;">0.4457</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T6.2.1.1" style="font-size:90%;">TABLE VI</span>: </span><span class="ltx_text" id="S5.T6.3.2" style="font-size:90%;">Ablation study with DeepFM as the base model.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T6.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.4.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T6.4.1.1.1" style="padding-left:2.7pt;padding-right:2.7pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T6.4.1.1.2" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.1.1.2.1" style="font-size:90%;">Amazon</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T6.4.1.1.3" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.1.1.3.1" style="font-size:90%;">Alipay</span></td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T6.4.2.2.1" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.2.2.1.1" style="font-size:90%;">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.2" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.2.2.2.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.3" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.2.2.3.1" style="font-size:90%;">NDCG</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.4" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.2.2.4.1" style="font-size:90%;">Recall</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.5" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.2.2.5.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.6" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.2.2.6.1" style="font-size:90%;">NDCG</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.7" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.2.2.7.1" style="font-size:90%;">Recall</span></td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T6.4.3.3.1" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.3.3.1.1" style="font-size:90%;">DeepFM (Base)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.3.3.2" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.3.3.2.1" style="font-size:90%;">0.8941</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.3.3.3" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.3.3.3.1" style="font-size:90%;">0.5416</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.3.3.4" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.3.3.4.1" style="font-size:90%;">0.6877</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.3.3.5" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.3.3.5.1" style="font-size:90%;">0.8018</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.3.3.6" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.3.3.6.1" style="font-size:90%;">0.2501</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.3.3.7" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.3.3.7.1" style="font-size:90%;">0.4177</span></td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T6.4.4.4.1" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.4.4.1.1" style="font-size:90%;">Ho Teachers</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.4.4.2" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.4.4.2.1" style="font-size:90%;">0.8550</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.4.4.3" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.4.4.3.1" style="font-size:90%;">0.4371</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.4.4.4" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.4.4.4.1" style="font-size:90%;">0.5817</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.4.4.5" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.4.4.5.1" style="font-size:90%;">0.7797</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.4.4.6" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.4.4.6.1" style="font-size:90%;">0.2669</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.4.4.7" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.4.4.7.1" style="font-size:90%;">0.4265</span></td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T6.4.5.5.1" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.5.5.1.1" style="font-size:90%;">w.o. FDA</span></th>
<td class="ltx_td ltx_align_center" id="S5.T6.4.5.5.2" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.5.5.2.1" style="font-size:90%;">0.8860</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.5.5.3" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.5.5.3.1" style="font-size:90%;">0.5528</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.5.5.4" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.5.5.4.1" style="font-size:90%;">0.6953</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.5.5.5" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.5.5.5.1" style="font-size:90%;">0.7811</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.5.5.6" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.5.5.6.1" style="font-size:90%;">0.2817</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.5.5.7" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.5.5.7.1" style="font-size:90%;">0.4444</span></td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T6.4.6.6.1" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text" id="S5.T6.4.6.6.1.1" style="font-size:90%;">CausalD</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.6.6.2" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.6.6.2.1" style="font-size:90%;">0.8948</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.6.6.3" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.6.6.3.1" style="font-size:90%;">0.5638</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.6.6.4" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.6.6.4.1" style="font-size:90%;">0.7016</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.6.6.5" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.6.6.5.1" style="font-size:90%;">0.8031</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.6.6.6" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.6.6.6.1" style="font-size:90%;">0.3053</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.6.6.7" style="padding-left:2.7pt;padding-right:2.7pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.6.6.7.1" style="font-size:90%;">0.4657</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S5.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T7.2.1.1" style="font-size:90%;">TABLE VII</span>: </span><span class="ltx_text" id="S5.T7.3.2" style="font-size:90%;">Recommendation performance of CausalD as changing the number of heterogeneous teachers.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T7.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T7.4.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T7.4.1.1.1" style="padding-left:3.6pt;padding-right:3.6pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S5.T7.4.1.1.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.1.1.2.1" style="font-size:90%;">Amazon</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S5.T7.4.1.1.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.1.1.3.1" style="font-size:90%;">Alipay</span></th>
</tr>
<tr class="ltx_tr" id="S5.T7.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T7.4.2.2.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.2.2.1.1" style="font-size:90%;">#Teachers</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.4.2.2.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.2.2.2.1" style="font-size:90%;">AUC</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.4.2.2.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.2.2.3.1" style="font-size:90%;">NDCG</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.4.2.2.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.2.2.4.1" style="font-size:90%;">Recall</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.4.2.2.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.2.2.5.1" style="font-size:90%;">AUC</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.4.2.2.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.2.2.6.1" style="font-size:90%;">NDCG</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.4.2.2.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.2.2.7.1" style="font-size:90%;">Recall</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T7.4.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T7.4.3.1.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.3.1.1.1" style="font-size:90%;">2</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.4.3.1.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.3.1.2.1" style="font-size:90%;">0.8910</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.4.3.1.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.3.1.3.1" style="font-size:90%;">0.5304</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.4.3.1.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.3.1.4.1" style="font-size:90%;">0.6806</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.4.3.1.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.4.3.1.5.1" style="font-size:90%;">0.7866</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.4.3.1.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.3.1.6.1" style="font-size:90%;">0.2682</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.4.3.1.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.3.1.7.1" style="font-size:90%;">0.4171</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T7.4.4.2.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.4.2.1.1" style="font-size:90%;">4</span></th>
<td class="ltx_td ltx_align_center" id="S5.T7.4.4.2.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.4.2.2.1" style="font-size:90%;">0.8869</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.4.2.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.4.2.3.1" style="font-size:90%;">0.5429</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.4.2.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.4.2.4.1" style="font-size:90%;">0.6883</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.4.2.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.4.2.5.1" style="font-size:90%;">0.7775</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.4.2.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.4.2.6.1" style="font-size:90%;">0.2812</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.4.2.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.4.2.7.1" style="font-size:90%;">0.4351</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T7.4.5.3.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.5.3.1.1" style="font-size:90%;">8</span></th>
<td class="ltx_td ltx_align_center" id="S5.T7.4.5.3.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.4.5.3.2.1" style="font-size:90%;">0.8965</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.5.3.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.4.5.3.3.1" style="font-size:90%;">0.5652</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.5.3.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.4.5.3.4.1" style="font-size:90%;">0.7114</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.5.3.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.5.3.5.1" style="font-size:90%;">0.7834</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.5.3.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.4.5.3.6.1" style="font-size:90%;">0.2902</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.5.3.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.5.3.7.1" style="font-size:90%;">0.4498</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T7.4.6.4.1" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.6.4.1.1" style="font-size:90%;">16</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.4.6.4.2" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.6.4.2.1" style="font-size:90%;">0.8931</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.4.6.4.3" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.6.4.3.1" style="font-size:90%;">0.5615</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.4.6.4.4" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.6.4.4.1" style="font-size:90%;">0.7062</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.4.6.4.5" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.6.4.5.1" style="font-size:90%;">0.7723</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.4.6.4.6" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text" id="S5.T7.4.6.4.6.1" style="font-size:90%;">0.2832</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.4.6.4.7" style="padding-left:3.6pt;padding-right:3.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.4.6.4.7.1" style="font-size:90%;">0.4514</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span><span class="ltx_text ltx_font_italic" id="S5.SS4.1.1">In-depth Model Analysis (RQ3)</span>
</h3>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p1.1.1">Ablation Studies. </span> We are interested in whether the critical components in CausalD all contribute to its effectiveness. In this regard, we evaluate whether 1) heterogeneous teachers outperform homogeneous teachers; and 2) whether the back-door adjustment loss and the front-door adjustment loss improve the performance. Specifically,
we construct <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.SS4.p1.1.2">w.o. FDA</span> which denotes CausalD trained without front-door adjustment loss. By removing the back-door adjustment loss from <span class="ltx_text ltx_font_typewriter" id="S5.SS4.p1.1.3">w.o. FDA</span>, we obtain the <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.SS4.p1.1.4">Base</span> (DIN) model. Model <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.SS4.p1.1.5">Ho Teachers</span> means replacing the heterogeneous teachers in CausalD with homogeneous teachers, which are pre-trained on randomly split data.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.3">According to the results shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.T5" title="TABLE V ‣ 5.3 Deconfounding Analysis (RQ2) ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">V</span></a>, we observe that removing any of these three components (heterogeneous teachers, BDA loss, FDA loss) will incur a performance degradation. Notably, removing FDA loss (<span class="ltx_text ltx_font_typewriter" id="S5.SS4.p2.3.1">CausalD</span> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.SS4.p2.1.m1.1"><semantics id="S5.SS4.p2.1.m1.1a"><mo id="S5.SS4.p2.1.m1.1.1" stretchy="false" xref="S5.SS4.p2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><ci id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.1.m1.1d">→</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="S5.SS4.p2.3.2">w.o FDA</span>) leads to NDCG <math alttext="-19.5\%" class="ltx_Math" display="inline" id="S5.SS4.p2.2.m2.1"><semantics id="S5.SS4.p2.2.m2.1a"><mrow id="S5.SS4.p2.2.m2.1.1" xref="S5.SS4.p2.2.m2.1.1.cmml"><mo id="S5.SS4.p2.2.m2.1.1a" xref="S5.SS4.p2.2.m2.1.1.cmml">−</mo><mrow id="S5.SS4.p2.2.m2.1.1.2" xref="S5.SS4.p2.2.m2.1.1.2.cmml"><mn id="S5.SS4.p2.2.m2.1.1.2.2" xref="S5.SS4.p2.2.m2.1.1.2.2.cmml">19.5</mn><mo id="S5.SS4.p2.2.m2.1.1.2.1" xref="S5.SS4.p2.2.m2.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.2.m2.1b"><apply id="S5.SS4.p2.2.m2.1.1.cmml" xref="S5.SS4.p2.2.m2.1.1"><minus id="S5.SS4.p2.2.m2.1.1.1.cmml" xref="S5.SS4.p2.2.m2.1.1"></minus><apply id="S5.SS4.p2.2.m2.1.1.2.cmml" xref="S5.SS4.p2.2.m2.1.1.2"><csymbol cd="latexml" id="S5.SS4.p2.2.m2.1.1.2.1.cmml" xref="S5.SS4.p2.2.m2.1.1.2.1">percent</csymbol><cn id="S5.SS4.p2.2.m2.1.1.2.2.cmml" type="float" xref="S5.SS4.p2.2.m2.1.1.2.2">19.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.2.m2.1c">-19.5\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.2.m2.1d">- 19.5 %</annotation></semantics></math> relatively on the AliPay dataset. We attribute the result to the effective capability of front-door adjustment in reducing confounding effects. The performance drop caused by removing BDA loss (<span class="ltx_text ltx_font_typewriter" id="S5.SS4.p2.3.3">w.o FDA</span> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.SS4.p2.3.m3.1"><semantics id="S5.SS4.p2.3.m3.1a"><mo id="S5.SS4.p2.3.m3.1.1" stretchy="false" xref="S5.SS4.p2.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.3.m3.1b"><ci id="S5.SS4.p2.3.m3.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.3.m3.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.3.m3.1d">→</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="S5.SS4.p2.3.4">Base</span>) demonstrates that the back-door adjustment loss is helpful for causal intervention. Not surprisingly, CausalD trained with homogeneous teachers achieves inferior results, which show sampling heterogeneous mediator values given the input is essential for FDA. These results jointly demonstrate the rationality of our framework design. <span class="ltx_text" id="S5.SS4.p2.3.5">We have mostly similar observations with DeeFM as the base model, according to the results listed in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.T6" title="TABLE VI ‣ 5.3 Deconfounding Analysis (RQ2) ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">VI</span></a>.<span class="ltx_text" id="S5.SS4.p2.3.5.1"></span></span></p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p3.1.1">Effect of the Teacher Number. </span> To investigate how the number of teachers affects the performance, we consider some variants of CausalD trained with <math alttext="\{2,4,8,16\}" class="ltx_Math" display="inline" id="S5.SS4.p3.1.m1.4"><semantics id="S5.SS4.p3.1.m1.4a"><mrow id="S5.SS4.p3.1.m1.4.5.2" xref="S5.SS4.p3.1.m1.4.5.1.cmml"><mo id="S5.SS4.p3.1.m1.4.5.2.1" stretchy="false" xref="S5.SS4.p3.1.m1.4.5.1.cmml">{</mo><mn id="S5.SS4.p3.1.m1.1.1" xref="S5.SS4.p3.1.m1.1.1.cmml">2</mn><mo id="S5.SS4.p3.1.m1.4.5.2.2" xref="S5.SS4.p3.1.m1.4.5.1.cmml">,</mo><mn id="S5.SS4.p3.1.m1.2.2" xref="S5.SS4.p3.1.m1.2.2.cmml">4</mn><mo id="S5.SS4.p3.1.m1.4.5.2.3" xref="S5.SS4.p3.1.m1.4.5.1.cmml">,</mo><mn id="S5.SS4.p3.1.m1.3.3" xref="S5.SS4.p3.1.m1.3.3.cmml">8</mn><mo id="S5.SS4.p3.1.m1.4.5.2.4" xref="S5.SS4.p3.1.m1.4.5.1.cmml">,</mo><mn id="S5.SS4.p3.1.m1.4.4" xref="S5.SS4.p3.1.m1.4.4.cmml">16</mn><mo id="S5.SS4.p3.1.m1.4.5.2.5" stretchy="false" xref="S5.SS4.p3.1.m1.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.1.m1.4b"><set id="S5.SS4.p3.1.m1.4.5.1.cmml" xref="S5.SS4.p3.1.m1.4.5.2"><cn id="S5.SS4.p3.1.m1.1.1.cmml" type="integer" xref="S5.SS4.p3.1.m1.1.1">2</cn><cn id="S5.SS4.p3.1.m1.2.2.cmml" type="integer" xref="S5.SS4.p3.1.m1.2.2">4</cn><cn id="S5.SS4.p3.1.m1.3.3.cmml" type="integer" xref="S5.SS4.p3.1.m1.3.3">8</cn><cn id="S5.SS4.p3.1.m1.4.4.cmml" type="integer" xref="S5.SS4.p3.1.m1.4.4">16</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.1.m1.4c">\{2,4,8,16\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.1.m1.4d">{ 2 , 4 , 8 , 16 }</annotation></semantics></math> teachers, respectively. Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.T7" title="TABLE VII ‣ 5.3 Deconfounding Analysis (RQ2) ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">VII</span></a> summarizes the results. By jointly analyzing Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.T7" title="TABLE VII ‣ 5.3 Deconfounding Analysis (RQ2) ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">VII</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S4.T3" title="TABLE III ‣ 4.2 Knowledge Distillation ‣ 4 Related Works ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">III</span></a>, we have the following findings:</p>
<ul class="ltx_itemize" id="S5.I6">
<li class="ltx_item" id="S5.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I6.i1.p1">
<p class="ltx_p" id="S5.I6.i1.p1.1">Increasing the number of teachers mostly leads to performance gain. A larger number of teachers means that CausalD conducts more comprehensive sampling on the counterfactual space and thus estimates the causal effect in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S2.E5" title="In 2.2 Front-door Adjustment ‣ 2 Preliminaries ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5</span></a>) more accurately.</p>
</div>
</li>
<li class="ltx_item" id="S5.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I6.i2.p1">
<p class="ltx_p" id="S5.I6.i2.p1.1">When further increasing the number of teachers from 8 to 16, we observe little performance gain in many cases. We attribute this phenomenon to that teachers themselves might become less effective with smaller training datasets. In larger dataset Alipay, CausalD achieves the best Recall.</p>
</div>
</li>
<li class="ltx_item" id="S5.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I6.i3.p1">
<p class="ltx_p" id="S5.I6.i3.p1.1">When varying the number of teachers, CausalD consistently outperforms the base model DIN. These results demonstrate that the front-door adjustment and the causal distillation can facilitate recommendation.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS4.p4">
<p class="ltx_p" id="S5.SS4.p4.13"><span class="ltx_text ltx_font_bold" id="S5.SS4.p4.13.1">Effect of the Loss Coefficients. </span> CausalD introduces two losses, <span class="ltx_text ltx_font_italic" id="S5.SS4.p4.13.2">i</span>.<span class="ltx_text ltx_font_italic" id="S5.SS4.p4.13.3">e</span>., the back-door adjustment loss, and the front-door adjustment loss. To investigate how the loss coefficients (<math alttext="\lambda_{BDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.1.m1.1"><semantics id="S5.SS4.p4.1.m1.1a"><msub id="S5.SS4.p4.1.m1.1.1" xref="S5.SS4.p4.1.m1.1.1.cmml"><mi id="S5.SS4.p4.1.m1.1.1.2" xref="S5.SS4.p4.1.m1.1.1.2.cmml">λ</mi><mrow id="S5.SS4.p4.1.m1.1.1.3" xref="S5.SS4.p4.1.m1.1.1.3.cmml"><mi id="S5.SS4.p4.1.m1.1.1.3.2" xref="S5.SS4.p4.1.m1.1.1.3.2.cmml">B</mi><mo id="S5.SS4.p4.1.m1.1.1.3.1" xref="S5.SS4.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.1.m1.1.1.3.3" xref="S5.SS4.p4.1.m1.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.1.m1.1.1.3.1a" xref="S5.SS4.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.1.m1.1.1.3.4" xref="S5.SS4.p4.1.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.1.m1.1b"><apply id="S5.SS4.p4.1.m1.1.1.cmml" xref="S5.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.1.m1.1.1.1.cmml" xref="S5.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p4.1.m1.1.1.2.cmml" xref="S5.SS4.p4.1.m1.1.1.2">𝜆</ci><apply id="S5.SS4.p4.1.m1.1.1.3.cmml" xref="S5.SS4.p4.1.m1.1.1.3"><times id="S5.SS4.p4.1.m1.1.1.3.1.cmml" xref="S5.SS4.p4.1.m1.1.1.3.1"></times><ci id="S5.SS4.p4.1.m1.1.1.3.2.cmml" xref="S5.SS4.p4.1.m1.1.1.3.2">𝐵</ci><ci id="S5.SS4.p4.1.m1.1.1.3.3.cmml" xref="S5.SS4.p4.1.m1.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.1.m1.1.1.3.4.cmml" xref="S5.SS4.p4.1.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.1.m1.1c">\lambda_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{FDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.2.m2.1"><semantics id="S5.SS4.p4.2.m2.1a"><msub id="S5.SS4.p4.2.m2.1.1" xref="S5.SS4.p4.2.m2.1.1.cmml"><mi id="S5.SS4.p4.2.m2.1.1.2" xref="S5.SS4.p4.2.m2.1.1.2.cmml">λ</mi><mrow id="S5.SS4.p4.2.m2.1.1.3" xref="S5.SS4.p4.2.m2.1.1.3.cmml"><mi id="S5.SS4.p4.2.m2.1.1.3.2" xref="S5.SS4.p4.2.m2.1.1.3.2.cmml">F</mi><mo id="S5.SS4.p4.2.m2.1.1.3.1" xref="S5.SS4.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.2.m2.1.1.3.3" xref="S5.SS4.p4.2.m2.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.2.m2.1.1.3.1a" xref="S5.SS4.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.2.m2.1.1.3.4" xref="S5.SS4.p4.2.m2.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.2.m2.1b"><apply id="S5.SS4.p4.2.m2.1.1.cmml" xref="S5.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.2.m2.1.1.1.cmml" xref="S5.SS4.p4.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p4.2.m2.1.1.2.cmml" xref="S5.SS4.p4.2.m2.1.1.2">𝜆</ci><apply id="S5.SS4.p4.2.m2.1.1.3.cmml" xref="S5.SS4.p4.2.m2.1.1.3"><times id="S5.SS4.p4.2.m2.1.1.3.1.cmml" xref="S5.SS4.p4.2.m2.1.1.3.1"></times><ci id="S5.SS4.p4.2.m2.1.1.3.2.cmml" xref="S5.SS4.p4.2.m2.1.1.3.2">𝐹</ci><ci id="S5.SS4.p4.2.m2.1.1.3.3.cmml" xref="S5.SS4.p4.2.m2.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.2.m2.1.1.3.4.cmml" xref="S5.SS4.p4.2.m2.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.2.m2.1c">\lambda_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S3.E22" title="In 3.4 Model Training ‣ 3 Method ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">22</span></a>)) affect the performance, we vary <math alttext="\lambda_{BDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.3.m3.1"><semantics id="S5.SS4.p4.3.m3.1a"><msub id="S5.SS4.p4.3.m3.1.1" xref="S5.SS4.p4.3.m3.1.1.cmml"><mi id="S5.SS4.p4.3.m3.1.1.2" xref="S5.SS4.p4.3.m3.1.1.2.cmml">λ</mi><mrow id="S5.SS4.p4.3.m3.1.1.3" xref="S5.SS4.p4.3.m3.1.1.3.cmml"><mi id="S5.SS4.p4.3.m3.1.1.3.2" xref="S5.SS4.p4.3.m3.1.1.3.2.cmml">B</mi><mo id="S5.SS4.p4.3.m3.1.1.3.1" xref="S5.SS4.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.3.m3.1.1.3.3" xref="S5.SS4.p4.3.m3.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.3.m3.1.1.3.1a" xref="S5.SS4.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.3.m3.1.1.3.4" xref="S5.SS4.p4.3.m3.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.3.m3.1b"><apply id="S5.SS4.p4.3.m3.1.1.cmml" xref="S5.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.3.m3.1.1.1.cmml" xref="S5.SS4.p4.3.m3.1.1">subscript</csymbol><ci id="S5.SS4.p4.3.m3.1.1.2.cmml" xref="S5.SS4.p4.3.m3.1.1.2">𝜆</ci><apply id="S5.SS4.p4.3.m3.1.1.3.cmml" xref="S5.SS4.p4.3.m3.1.1.3"><times id="S5.SS4.p4.3.m3.1.1.3.1.cmml" xref="S5.SS4.p4.3.m3.1.1.3.1"></times><ci id="S5.SS4.p4.3.m3.1.1.3.2.cmml" xref="S5.SS4.p4.3.m3.1.1.3.2">𝐵</ci><ci id="S5.SS4.p4.3.m3.1.1.3.3.cmml" xref="S5.SS4.p4.3.m3.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.3.m3.1.1.3.4.cmml" xref="S5.SS4.p4.3.m3.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.3.m3.1c">\lambda_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.3.m3.1d">italic_λ start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{FDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.4.m4.1"><semantics id="S5.SS4.p4.4.m4.1a"><msub id="S5.SS4.p4.4.m4.1.1" xref="S5.SS4.p4.4.m4.1.1.cmml"><mi id="S5.SS4.p4.4.m4.1.1.2" xref="S5.SS4.p4.4.m4.1.1.2.cmml">λ</mi><mrow id="S5.SS4.p4.4.m4.1.1.3" xref="S5.SS4.p4.4.m4.1.1.3.cmml"><mi id="S5.SS4.p4.4.m4.1.1.3.2" xref="S5.SS4.p4.4.m4.1.1.3.2.cmml">F</mi><mo id="S5.SS4.p4.4.m4.1.1.3.1" xref="S5.SS4.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.4.m4.1.1.3.3" xref="S5.SS4.p4.4.m4.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.4.m4.1.1.3.1a" xref="S5.SS4.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.4.m4.1.1.3.4" xref="S5.SS4.p4.4.m4.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.4.m4.1b"><apply id="S5.SS4.p4.4.m4.1.1.cmml" xref="S5.SS4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.4.m4.1.1.1.cmml" xref="S5.SS4.p4.4.m4.1.1">subscript</csymbol><ci id="S5.SS4.p4.4.m4.1.1.2.cmml" xref="S5.SS4.p4.4.m4.1.1.2">𝜆</ci><apply id="S5.SS4.p4.4.m4.1.1.3.cmml" xref="S5.SS4.p4.4.m4.1.1.3"><times id="S5.SS4.p4.4.m4.1.1.3.1.cmml" xref="S5.SS4.p4.4.m4.1.1.3.1"></times><ci id="S5.SS4.p4.4.m4.1.1.3.2.cmml" xref="S5.SS4.p4.4.m4.1.1.3.2">𝐹</ci><ci id="S5.SS4.p4.4.m4.1.1.3.3.cmml" xref="S5.SS4.p4.4.m4.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.4.m4.1.1.3.4.cmml" xref="S5.SS4.p4.4.m4.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.4.m4.1c">\lambda_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.4.m4.1d">italic_λ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> among <math alttext="\{0.01,0.1,1,10\}" class="ltx_Math" display="inline" id="S5.SS4.p4.5.m5.4"><semantics id="S5.SS4.p4.5.m5.4a"><mrow id="S5.SS4.p4.5.m5.4.5.2" xref="S5.SS4.p4.5.m5.4.5.1.cmml"><mo id="S5.SS4.p4.5.m5.4.5.2.1" stretchy="false" xref="S5.SS4.p4.5.m5.4.5.1.cmml">{</mo><mn id="S5.SS4.p4.5.m5.1.1" xref="S5.SS4.p4.5.m5.1.1.cmml">0.01</mn><mo id="S5.SS4.p4.5.m5.4.5.2.2" xref="S5.SS4.p4.5.m5.4.5.1.cmml">,</mo><mn id="S5.SS4.p4.5.m5.2.2" xref="S5.SS4.p4.5.m5.2.2.cmml">0.1</mn><mo id="S5.SS4.p4.5.m5.4.5.2.3" xref="S5.SS4.p4.5.m5.4.5.1.cmml">,</mo><mn id="S5.SS4.p4.5.m5.3.3" xref="S5.SS4.p4.5.m5.3.3.cmml">1</mn><mo id="S5.SS4.p4.5.m5.4.5.2.4" xref="S5.SS4.p4.5.m5.4.5.1.cmml">,</mo><mn id="S5.SS4.p4.5.m5.4.4" xref="S5.SS4.p4.5.m5.4.4.cmml">10</mn><mo id="S5.SS4.p4.5.m5.4.5.2.5" stretchy="false" xref="S5.SS4.p4.5.m5.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.5.m5.4b"><set id="S5.SS4.p4.5.m5.4.5.1.cmml" xref="S5.SS4.p4.5.m5.4.5.2"><cn id="S5.SS4.p4.5.m5.1.1.cmml" type="float" xref="S5.SS4.p4.5.m5.1.1">0.01</cn><cn id="S5.SS4.p4.5.m5.2.2.cmml" type="float" xref="S5.SS4.p4.5.m5.2.2">0.1</cn><cn id="S5.SS4.p4.5.m5.3.3.cmml" type="integer" xref="S5.SS4.p4.5.m5.3.3">1</cn><cn id="S5.SS4.p4.5.m5.4.4.cmml" type="integer" xref="S5.SS4.p4.5.m5.4.4">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.5.m5.4c">\{0.01,0.1,1,10\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.5.m5.4d">{ 0.01 , 0.1 , 1 , 10 }</annotation></semantics></math>, and test the performance. According to Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20626v1#S5.F5" title="Figure 5 ‣ 5.2 Overall Performance (RQ1) ‣ 5 Experiments ‣ Causal Distillation for Alleviating Performance Heterogeneity in Recommender Systems"><span class="ltx_text ltx_ref_tag">5</span></a>, we can find that 1) the recommendation performance is mostly insensitive to these hyper-parameters. Directly leaving them as <math alttext="\lambda_{BDA}=\lambda_{FDA}=1" class="ltx_Math" display="inline" id="S5.SS4.p4.6.m6.1"><semantics id="S5.SS4.p4.6.m6.1a"><mrow id="S5.SS4.p4.6.m6.1.1" xref="S5.SS4.p4.6.m6.1.1.cmml"><msub id="S5.SS4.p4.6.m6.1.1.2" xref="S5.SS4.p4.6.m6.1.1.2.cmml"><mi id="S5.SS4.p4.6.m6.1.1.2.2" xref="S5.SS4.p4.6.m6.1.1.2.2.cmml">λ</mi><mrow id="S5.SS4.p4.6.m6.1.1.2.3" xref="S5.SS4.p4.6.m6.1.1.2.3.cmml"><mi id="S5.SS4.p4.6.m6.1.1.2.3.2" xref="S5.SS4.p4.6.m6.1.1.2.3.2.cmml">B</mi><mo id="S5.SS4.p4.6.m6.1.1.2.3.1" xref="S5.SS4.p4.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.6.m6.1.1.2.3.3" xref="S5.SS4.p4.6.m6.1.1.2.3.3.cmml">D</mi><mo id="S5.SS4.p4.6.m6.1.1.2.3.1a" xref="S5.SS4.p4.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.6.m6.1.1.2.3.4" xref="S5.SS4.p4.6.m6.1.1.2.3.4.cmml">A</mi></mrow></msub><mo id="S5.SS4.p4.6.m6.1.1.3" xref="S5.SS4.p4.6.m6.1.1.3.cmml">=</mo><msub id="S5.SS4.p4.6.m6.1.1.4" xref="S5.SS4.p4.6.m6.1.1.4.cmml"><mi id="S5.SS4.p4.6.m6.1.1.4.2" xref="S5.SS4.p4.6.m6.1.1.4.2.cmml">λ</mi><mrow id="S5.SS4.p4.6.m6.1.1.4.3" xref="S5.SS4.p4.6.m6.1.1.4.3.cmml"><mi id="S5.SS4.p4.6.m6.1.1.4.3.2" xref="S5.SS4.p4.6.m6.1.1.4.3.2.cmml">F</mi><mo id="S5.SS4.p4.6.m6.1.1.4.3.1" xref="S5.SS4.p4.6.m6.1.1.4.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.6.m6.1.1.4.3.3" xref="S5.SS4.p4.6.m6.1.1.4.3.3.cmml">D</mi><mo id="S5.SS4.p4.6.m6.1.1.4.3.1a" xref="S5.SS4.p4.6.m6.1.1.4.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.6.m6.1.1.4.3.4" xref="S5.SS4.p4.6.m6.1.1.4.3.4.cmml">A</mi></mrow></msub><mo id="S5.SS4.p4.6.m6.1.1.5" xref="S5.SS4.p4.6.m6.1.1.5.cmml">=</mo><mn id="S5.SS4.p4.6.m6.1.1.6" xref="S5.SS4.p4.6.m6.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.6.m6.1b"><apply id="S5.SS4.p4.6.m6.1.1.cmml" xref="S5.SS4.p4.6.m6.1.1"><and id="S5.SS4.p4.6.m6.1.1a.cmml" xref="S5.SS4.p4.6.m6.1.1"></and><apply id="S5.SS4.p4.6.m6.1.1b.cmml" xref="S5.SS4.p4.6.m6.1.1"><eq id="S5.SS4.p4.6.m6.1.1.3.cmml" xref="S5.SS4.p4.6.m6.1.1.3"></eq><apply id="S5.SS4.p4.6.m6.1.1.2.cmml" xref="S5.SS4.p4.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p4.6.m6.1.1.2.1.cmml" xref="S5.SS4.p4.6.m6.1.1.2">subscript</csymbol><ci id="S5.SS4.p4.6.m6.1.1.2.2.cmml" xref="S5.SS4.p4.6.m6.1.1.2.2">𝜆</ci><apply id="S5.SS4.p4.6.m6.1.1.2.3.cmml" xref="S5.SS4.p4.6.m6.1.1.2.3"><times id="S5.SS4.p4.6.m6.1.1.2.3.1.cmml" xref="S5.SS4.p4.6.m6.1.1.2.3.1"></times><ci id="S5.SS4.p4.6.m6.1.1.2.3.2.cmml" xref="S5.SS4.p4.6.m6.1.1.2.3.2">𝐵</ci><ci id="S5.SS4.p4.6.m6.1.1.2.3.3.cmml" xref="S5.SS4.p4.6.m6.1.1.2.3.3">𝐷</ci><ci id="S5.SS4.p4.6.m6.1.1.2.3.4.cmml" xref="S5.SS4.p4.6.m6.1.1.2.3.4">𝐴</ci></apply></apply><apply id="S5.SS4.p4.6.m6.1.1.4.cmml" xref="S5.SS4.p4.6.m6.1.1.4"><csymbol cd="ambiguous" id="S5.SS4.p4.6.m6.1.1.4.1.cmml" xref="S5.SS4.p4.6.m6.1.1.4">subscript</csymbol><ci id="S5.SS4.p4.6.m6.1.1.4.2.cmml" xref="S5.SS4.p4.6.m6.1.1.4.2">𝜆</ci><apply id="S5.SS4.p4.6.m6.1.1.4.3.cmml" xref="S5.SS4.p4.6.m6.1.1.4.3"><times id="S5.SS4.p4.6.m6.1.1.4.3.1.cmml" xref="S5.SS4.p4.6.m6.1.1.4.3.1"></times><ci id="S5.SS4.p4.6.m6.1.1.4.3.2.cmml" xref="S5.SS4.p4.6.m6.1.1.4.3.2">𝐹</ci><ci id="S5.SS4.p4.6.m6.1.1.4.3.3.cmml" xref="S5.SS4.p4.6.m6.1.1.4.3.3">𝐷</ci><ci id="S5.SS4.p4.6.m6.1.1.4.3.4.cmml" xref="S5.SS4.p4.6.m6.1.1.4.3.4">𝐴</ci></apply></apply></apply><apply id="S5.SS4.p4.6.m6.1.1c.cmml" xref="S5.SS4.p4.6.m6.1.1"><eq id="S5.SS4.p4.6.m6.1.1.5.cmml" xref="S5.SS4.p4.6.m6.1.1.5"></eq><share href="https://arxiv.org/html/2405.20626v1#S5.SS4.p4.6.m6.1.1.4.cmml" id="S5.SS4.p4.6.m6.1.1d.cmml" xref="S5.SS4.p4.6.m6.1.1"></share><cn id="S5.SS4.p4.6.m6.1.1.6.cmml" type="integer" xref="S5.SS4.p4.6.m6.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.6.m6.1c">\lambda_{BDA}=\lambda_{FDA}=1</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.6.m6.1d">italic_λ start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT = 1</annotation></semantics></math> will achieve substantial improvements over the base model; 2) increasing <math alttext="\lambda_{FDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.7.m7.1"><semantics id="S5.SS4.p4.7.m7.1a"><msub id="S5.SS4.p4.7.m7.1.1" xref="S5.SS4.p4.7.m7.1.1.cmml"><mi id="S5.SS4.p4.7.m7.1.1.2" xref="S5.SS4.p4.7.m7.1.1.2.cmml">λ</mi><mrow id="S5.SS4.p4.7.m7.1.1.3" xref="S5.SS4.p4.7.m7.1.1.3.cmml"><mi id="S5.SS4.p4.7.m7.1.1.3.2" xref="S5.SS4.p4.7.m7.1.1.3.2.cmml">F</mi><mo id="S5.SS4.p4.7.m7.1.1.3.1" xref="S5.SS4.p4.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.7.m7.1.1.3.3" xref="S5.SS4.p4.7.m7.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.7.m7.1.1.3.1a" xref="S5.SS4.p4.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.7.m7.1.1.3.4" xref="S5.SS4.p4.7.m7.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.7.m7.1b"><apply id="S5.SS4.p4.7.m7.1.1.cmml" xref="S5.SS4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.7.m7.1.1.1.cmml" xref="S5.SS4.p4.7.m7.1.1">subscript</csymbol><ci id="S5.SS4.p4.7.m7.1.1.2.cmml" xref="S5.SS4.p4.7.m7.1.1.2">𝜆</ci><apply id="S5.SS4.p4.7.m7.1.1.3.cmml" xref="S5.SS4.p4.7.m7.1.1.3"><times id="S5.SS4.p4.7.m7.1.1.3.1.cmml" xref="S5.SS4.p4.7.m7.1.1.3.1"></times><ci id="S5.SS4.p4.7.m7.1.1.3.2.cmml" xref="S5.SS4.p4.7.m7.1.1.3.2">𝐹</ci><ci id="S5.SS4.p4.7.m7.1.1.3.3.cmml" xref="S5.SS4.p4.7.m7.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.7.m7.1.1.3.4.cmml" xref="S5.SS4.p4.7.m7.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.7.m7.1c">\lambda_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.7.m7.1d">italic_λ start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> consistently leads to performance gains, which again shows the merits of front-door adjustment for recommender systems; and 3) increasing <math alttext="\lambda_{BDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.8.m8.1"><semantics id="S5.SS4.p4.8.m8.1a"><msub id="S5.SS4.p4.8.m8.1.1" xref="S5.SS4.p4.8.m8.1.1.cmml"><mi id="S5.SS4.p4.8.m8.1.1.2" xref="S5.SS4.p4.8.m8.1.1.2.cmml">λ</mi><mrow id="S5.SS4.p4.8.m8.1.1.3" xref="S5.SS4.p4.8.m8.1.1.3.cmml"><mi id="S5.SS4.p4.8.m8.1.1.3.2" xref="S5.SS4.p4.8.m8.1.1.3.2.cmml">B</mi><mo id="S5.SS4.p4.8.m8.1.1.3.1" xref="S5.SS4.p4.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.8.m8.1.1.3.3" xref="S5.SS4.p4.8.m8.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.8.m8.1.1.3.1a" xref="S5.SS4.p4.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.8.m8.1.1.3.4" xref="S5.SS4.p4.8.m8.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.8.m8.1b"><apply id="S5.SS4.p4.8.m8.1.1.cmml" xref="S5.SS4.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.8.m8.1.1.1.cmml" xref="S5.SS4.p4.8.m8.1.1">subscript</csymbol><ci id="S5.SS4.p4.8.m8.1.1.2.cmml" xref="S5.SS4.p4.8.m8.1.1.2">𝜆</ci><apply id="S5.SS4.p4.8.m8.1.1.3.cmml" xref="S5.SS4.p4.8.m8.1.1.3"><times id="S5.SS4.p4.8.m8.1.1.3.1.cmml" xref="S5.SS4.p4.8.m8.1.1.3.1"></times><ci id="S5.SS4.p4.8.m8.1.1.3.2.cmml" xref="S5.SS4.p4.8.m8.1.1.3.2">𝐵</ci><ci id="S5.SS4.p4.8.m8.1.1.3.3.cmml" xref="S5.SS4.p4.8.m8.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.8.m8.1.1.3.4.cmml" xref="S5.SS4.p4.8.m8.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.8.m8.1c">\lambda_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.8.m8.1d">italic_λ start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> are mostly helpful while relatively large <math alttext="\lambda_{BDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.9.m9.1"><semantics id="S5.SS4.p4.9.m9.1a"><msub id="S5.SS4.p4.9.m9.1.1" xref="S5.SS4.p4.9.m9.1.1.cmml"><mi id="S5.SS4.p4.9.m9.1.1.2" xref="S5.SS4.p4.9.m9.1.1.2.cmml">λ</mi><mrow id="S5.SS4.p4.9.m9.1.1.3" xref="S5.SS4.p4.9.m9.1.1.3.cmml"><mi id="S5.SS4.p4.9.m9.1.1.3.2" xref="S5.SS4.p4.9.m9.1.1.3.2.cmml">B</mi><mo id="S5.SS4.p4.9.m9.1.1.3.1" xref="S5.SS4.p4.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.9.m9.1.1.3.3" xref="S5.SS4.p4.9.m9.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.9.m9.1.1.3.1a" xref="S5.SS4.p4.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.9.m9.1.1.3.4" xref="S5.SS4.p4.9.m9.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.9.m9.1b"><apply id="S5.SS4.p4.9.m9.1.1.cmml" xref="S5.SS4.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.9.m9.1.1.1.cmml" xref="S5.SS4.p4.9.m9.1.1">subscript</csymbol><ci id="S5.SS4.p4.9.m9.1.1.2.cmml" xref="S5.SS4.p4.9.m9.1.1.2">𝜆</ci><apply id="S5.SS4.p4.9.m9.1.1.3.cmml" xref="S5.SS4.p4.9.m9.1.1.3"><times id="S5.SS4.p4.9.m9.1.1.3.1.cmml" xref="S5.SS4.p4.9.m9.1.1.3.1"></times><ci id="S5.SS4.p4.9.m9.1.1.3.2.cmml" xref="S5.SS4.p4.9.m9.1.1.3.2">𝐵</ci><ci id="S5.SS4.p4.9.m9.1.1.3.3.cmml" xref="S5.SS4.p4.9.m9.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.9.m9.1.1.3.4.cmml" xref="S5.SS4.p4.9.m9.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.9.m9.1c">\lambda_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.9.m9.1d">italic_λ start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> might be inferior. This is reasonable since <math alttext="\mathcal{L}_{BDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.10.m10.1"><semantics id="S5.SS4.p4.10.m10.1a"><msub id="S5.SS4.p4.10.m10.1.1" xref="S5.SS4.p4.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p4.10.m10.1.1.2" xref="S5.SS4.p4.10.m10.1.1.2.cmml">ℒ</mi><mrow id="S5.SS4.p4.10.m10.1.1.3" xref="S5.SS4.p4.10.m10.1.1.3.cmml"><mi id="S5.SS4.p4.10.m10.1.1.3.2" xref="S5.SS4.p4.10.m10.1.1.3.2.cmml">B</mi><mo id="S5.SS4.p4.10.m10.1.1.3.1" xref="S5.SS4.p4.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.10.m10.1.1.3.3" xref="S5.SS4.p4.10.m10.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.10.m10.1.1.3.1a" xref="S5.SS4.p4.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.10.m10.1.1.3.4" xref="S5.SS4.p4.10.m10.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.10.m10.1b"><apply id="S5.SS4.p4.10.m10.1.1.cmml" xref="S5.SS4.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.10.m10.1.1.1.cmml" xref="S5.SS4.p4.10.m10.1.1">subscript</csymbol><ci id="S5.SS4.p4.10.m10.1.1.2.cmml" xref="S5.SS4.p4.10.m10.1.1.2">ℒ</ci><apply id="S5.SS4.p4.10.m10.1.1.3.cmml" xref="S5.SS4.p4.10.m10.1.1.3"><times id="S5.SS4.p4.10.m10.1.1.3.1.cmml" xref="S5.SS4.p4.10.m10.1.1.3.1"></times><ci id="S5.SS4.p4.10.m10.1.1.3.2.cmml" xref="S5.SS4.p4.10.m10.1.1.3.2">𝐵</ci><ci id="S5.SS4.p4.10.m10.1.1.3.3.cmml" xref="S5.SS4.p4.10.m10.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.10.m10.1.1.3.4.cmml" xref="S5.SS4.p4.10.m10.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.10.m10.1c">\mathcal{L}_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.10.m10.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> is an auxiliary loss for <math alttext="\mathcal{L}_{FDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.11.m11.1"><semantics id="S5.SS4.p4.11.m11.1a"><msub id="S5.SS4.p4.11.m11.1.1" xref="S5.SS4.p4.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p4.11.m11.1.1.2" xref="S5.SS4.p4.11.m11.1.1.2.cmml">ℒ</mi><mrow id="S5.SS4.p4.11.m11.1.1.3" xref="S5.SS4.p4.11.m11.1.1.3.cmml"><mi id="S5.SS4.p4.11.m11.1.1.3.2" xref="S5.SS4.p4.11.m11.1.1.3.2.cmml">F</mi><mo id="S5.SS4.p4.11.m11.1.1.3.1" xref="S5.SS4.p4.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.11.m11.1.1.3.3" xref="S5.SS4.p4.11.m11.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.11.m11.1.1.3.1a" xref="S5.SS4.p4.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.11.m11.1.1.3.4" xref="S5.SS4.p4.11.m11.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.11.m11.1b"><apply id="S5.SS4.p4.11.m11.1.1.cmml" xref="S5.SS4.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.11.m11.1.1.1.cmml" xref="S5.SS4.p4.11.m11.1.1">subscript</csymbol><ci id="S5.SS4.p4.11.m11.1.1.2.cmml" xref="S5.SS4.p4.11.m11.1.1.2">ℒ</ci><apply id="S5.SS4.p4.11.m11.1.1.3.cmml" xref="S5.SS4.p4.11.m11.1.1.3"><times id="S5.SS4.p4.11.m11.1.1.3.1.cmml" xref="S5.SS4.p4.11.m11.1.1.3.1"></times><ci id="S5.SS4.p4.11.m11.1.1.3.2.cmml" xref="S5.SS4.p4.11.m11.1.1.3.2">𝐹</ci><ci id="S5.SS4.p4.11.m11.1.1.3.3.cmml" xref="S5.SS4.p4.11.m11.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.11.m11.1.1.3.4.cmml" xref="S5.SS4.p4.11.m11.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.11.m11.1c">\mathcal{L}_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.11.m11.1d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math>. Larger <math alttext="\mathcal{L}_{BDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.12.m12.1"><semantics id="S5.SS4.p4.12.m12.1a"><msub id="S5.SS4.p4.12.m12.1.1" xref="S5.SS4.p4.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p4.12.m12.1.1.2" xref="S5.SS4.p4.12.m12.1.1.2.cmml">ℒ</mi><mrow id="S5.SS4.p4.12.m12.1.1.3" xref="S5.SS4.p4.12.m12.1.1.3.cmml"><mi id="S5.SS4.p4.12.m12.1.1.3.2" xref="S5.SS4.p4.12.m12.1.1.3.2.cmml">B</mi><mo id="S5.SS4.p4.12.m12.1.1.3.1" xref="S5.SS4.p4.12.m12.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.12.m12.1.1.3.3" xref="S5.SS4.p4.12.m12.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.12.m12.1.1.3.1a" xref="S5.SS4.p4.12.m12.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.12.m12.1.1.3.4" xref="S5.SS4.p4.12.m12.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.12.m12.1b"><apply id="S5.SS4.p4.12.m12.1.1.cmml" xref="S5.SS4.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.12.m12.1.1.1.cmml" xref="S5.SS4.p4.12.m12.1.1">subscript</csymbol><ci id="S5.SS4.p4.12.m12.1.1.2.cmml" xref="S5.SS4.p4.12.m12.1.1.2">ℒ</ci><apply id="S5.SS4.p4.12.m12.1.1.3.cmml" xref="S5.SS4.p4.12.m12.1.1.3"><times id="S5.SS4.p4.12.m12.1.1.3.1.cmml" xref="S5.SS4.p4.12.m12.1.1.3.1"></times><ci id="S5.SS4.p4.12.m12.1.1.3.2.cmml" xref="S5.SS4.p4.12.m12.1.1.3.2">𝐵</ci><ci id="S5.SS4.p4.12.m12.1.1.3.3.cmml" xref="S5.SS4.p4.12.m12.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.12.m12.1.1.3.4.cmml" xref="S5.SS4.p4.12.m12.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.12.m12.1c">\mathcal{L}_{BDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.12.m12.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math> might incur less model optimization on <math alttext="\mathcal{L}_{FDA}" class="ltx_Math" display="inline" id="S5.SS4.p4.13.m13.1"><semantics id="S5.SS4.p4.13.m13.1a"><msub id="S5.SS4.p4.13.m13.1.1" xref="S5.SS4.p4.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p4.13.m13.1.1.2" xref="S5.SS4.p4.13.m13.1.1.2.cmml">ℒ</mi><mrow id="S5.SS4.p4.13.m13.1.1.3" xref="S5.SS4.p4.13.m13.1.1.3.cmml"><mi id="S5.SS4.p4.13.m13.1.1.3.2" xref="S5.SS4.p4.13.m13.1.1.3.2.cmml">F</mi><mo id="S5.SS4.p4.13.m13.1.1.3.1" xref="S5.SS4.p4.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.13.m13.1.1.3.3" xref="S5.SS4.p4.13.m13.1.1.3.3.cmml">D</mi><mo id="S5.SS4.p4.13.m13.1.1.3.1a" xref="S5.SS4.p4.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p4.13.m13.1.1.3.4" xref="S5.SS4.p4.13.m13.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.13.m13.1b"><apply id="S5.SS4.p4.13.m13.1.1.cmml" xref="S5.SS4.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S5.SS4.p4.13.m13.1.1.1.cmml" xref="S5.SS4.p4.13.m13.1.1">subscript</csymbol><ci id="S5.SS4.p4.13.m13.1.1.2.cmml" xref="S5.SS4.p4.13.m13.1.1.2">ℒ</ci><apply id="S5.SS4.p4.13.m13.1.1.3.cmml" xref="S5.SS4.p4.13.m13.1.1.3"><times id="S5.SS4.p4.13.m13.1.1.3.1.cmml" xref="S5.SS4.p4.13.m13.1.1.3.1"></times><ci id="S5.SS4.p4.13.m13.1.1.3.2.cmml" xref="S5.SS4.p4.13.m13.1.1.3.2">𝐹</ci><ci id="S5.SS4.p4.13.m13.1.1.3.3.cmml" xref="S5.SS4.p4.13.m13.1.1.3.3">𝐷</ci><ci id="S5.SS4.p4.13.m13.1.1.3.4.cmml" xref="S5.SS4.p4.13.m13.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.13.m13.1c">\mathcal{L}_{FDA}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.13.m13.1d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_D italic_A end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">Conclusion and Future Work</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we study how to alleviate the performance heterogeneity problem in recommender systems. Though the <span class="ltx_text ltx_font_italic" id="S6.p1.1.1">natural source</span> of this problem, <span class="ltx_text ltx_font_italic" id="S6.p1.1.2">i</span>.<span class="ltx_text ltx_font_italic" id="S6.p1.1.3">e</span>., imbalance of training data distribution over users, is inevitable, we find that model training enlarges the heterogeneity, <span class="ltx_text ltx_font_italic" id="S6.p1.1.4">i</span>.<span class="ltx_text ltx_font_italic" id="S6.p1.1.5">e</span>., a <span class="ltx_text ltx_font_italic" id="S6.p1.1.6">model source</span>. By analyzing the recommendation data generation process with the causal graph, we find that there are unobserved confounders that mainly mislead the estimation <math alttext="P(Y\mid X)" class="ltx_Math" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mrow id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml"><mi id="S6.p1.1.m1.1.1.3" xref="S6.p1.1.m1.1.1.3.cmml">P</mi><mo id="S6.p1.1.m1.1.1.2" xref="S6.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.p1.1.m1.1.1.1.1" xref="S6.p1.1.m1.1.1.1.1.1.cmml"><mo id="S6.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S6.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.p1.1.m1.1.1.1.1.1" xref="S6.p1.1.m1.1.1.1.1.1.cmml"><mi id="S6.p1.1.m1.1.1.1.1.1.2" xref="S6.p1.1.m1.1.1.1.1.1.2.cmml">Y</mi><mo id="S6.p1.1.m1.1.1.1.1.1.1" xref="S6.p1.1.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S6.p1.1.m1.1.1.1.1.1.3" xref="S6.p1.1.m1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S6.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S6.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><apply id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1"><times id="S6.p1.1.m1.1.1.2.cmml" xref="S6.p1.1.m1.1.1.2"></times><ci id="S6.p1.1.m1.1.1.3.cmml" xref="S6.p1.1.m1.1.1.3">𝑃</ci><apply id="S6.p1.1.m1.1.1.1.1.1.cmml" xref="S6.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S6.p1.1.m1.1.1.1.1.1.1.cmml" xref="S6.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S6.p1.1.m1.1.1.1.1.1.2.cmml" xref="S6.p1.1.m1.1.1.1.1.1.2">𝑌</ci><ci id="S6.p1.1.m1.1.1.1.1.1.3.cmml" xref="S6.p1.1.m1.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">P(Y\mid X)</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">italic_P ( italic_Y ∣ italic_X )</annotation></semantics></math> of tail users. Different from existing works that require unbiased data or assume unconfoundedness, we handle unobserved confounders using FDA. We propose the causal multi-teacher distillation framework (CausalD) as an efficient approximation of FDA by distilling causal effects estimated by heterogeneous teachers into a recommendation model. We conduct experiments on three public datasets, validating the effectiveness of CausalD on improving recommendation and alleviating performance heterogeneity.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">To the best of our knowledge, this work takes the initiative to incorporate FDA into recommendation models. FDA has the enticing merit to deal with observed confounders that cause the spurious correlation of historical behaviors and next behaviors. Bias is ubiquitous and various in kind, and we believe this new paradigm is general for alleviating model training biases in a unified framework. There are many research directions remaining for exploration. Apart from performance heterogeneity, there are more issues caused by biased model training, such as filter bubble. We are interested in whether CausalD can alleviate these issues in the future. Another future direction relates to performing FDA on causally discovered causal graphs. Lastly, we plan to extend CausalD to state-of-the-art recommendation models that leverage various content features and side information.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work was supported in part by National Natural Science Foundation of China (62006207, U20A20387, 62037001), Key R &amp; D Projects of the Ministry of Science and Technology (2020YFC0832500), Young Elite Scientists Sponsorship Program by CAST (2021QNRC001), Zhejiang Province Natural Science Foundation (LR19F020006, LQ21F020020), Project by Shanghai AI Laboratory (P22KS00111), Program of Zhejiang Province Science and Technology (2022C01044), the StarryNight Science Fund of Zhejiang University Shanghai Institute for Advanced Study (SN-ZJU-SIAS-0010).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
G. Zhou, X. Zhu, C. Song, Y. Fan, H. Zhu, X. Ma, Y. Yan, J. Jin, H. Li, and
K. Gai, “Deep interest network for click-through rate prediction.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the 24th ACM SIGKDD International Conference on
Knowledge Discovery &amp; Data Mining, KDD</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
X. He, L. Liao, H. Zhang, L. Nie, X. Hu, and T.-S. Chua, “Neural collaborative
filtering.” in <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 26th International Conference on
World Wide Web, WWW</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
H. Yin, Q. Wang, K. Zheng, Z. Li, and X. Zhou, “Overcoming data sparsity in
group recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">IEEE Trans. Knowl. Data Eng.</em>, vol. 34,
no. 7, pp. 3447–3460, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
C. Gao, N. Li, T. Lin, D. Lin, J. Zhang, Y. Li, and D. Jin, “Social
recommendation with characterized regularization,” <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">IEEE Trans.
Knowl. Data Eng.</em>, vol. 34, no. 6, pp. 2921–2933, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
M. Unger and A. Tuzhilin, “Hierarchical latent context representation for
context-aware recommendations,” <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">IEEE Trans. Knowl. Data Eng.</em>,
vol. 34, no. 7, pp. 3322–3334, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. McAuley, C. Targett, Q. Shi, and A. van den Hengel, “Image-based
recommendations on styles and substitutes,” in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 38th
International ACM SIGIR Conference on Research and Development in
Information Retrieval</em>.   ACM, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
H. Steck, “Calibrated recommendations.” in <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 12th ACM
Conference on Recommender Systems, RecSys</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Y. Wang, X. Wang, A. Beutel, F. Prost, J. Chen, and E. H. Chi, “Understanding
and improving fairness-accuracy trade-offs in multi-task learning,” in
<em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 27th ACM SIGKDD Conference on Knowledge
Discovery &amp; Data Mining</em>.   ACM,
2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Y. Li, H. Chen, Z. Fu, Y. Ge, and Y. Zhang, “User-oriented fairness in
recommendation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">WWW ’21: The Web Conference</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
J. Pearl, M. Glymour, and N. P. Jewell, <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Causal inference in statistics: A
primer</em>.   John Wiley &amp; Sons, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
X. Zheng, M. Wang, R. Xu, J. Li, and Y. Wang, “Modeling dynamic missingness of
implicit feedback for sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">IEEE Trans. Knowl.
Data Eng.</em>, vol. 34, no. 1, pp. 405–418, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Q. Cui, S. Wu, Q. Liu, W. Zhong, and L. Wang, “MV-RNN: A multi-view
recurrent neural network for sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">IEEE Trans.
Knowl. Data Eng.</em>, vol. 32, no. 2, pp. 317–331, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
W. Fan, Y. Ma, Q. Li, J. Wang, G. Cai, J. Tang, and D. Yin, “A graph neural
network framework for social recommendations,” <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">IEEE Trans. Knowl.
Data Eng.</em>, vol. 34, no. 5, pp. 2033–2047, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y. Wang, D. Liang, L. Charlin, and D. M. Blei, “The deconfounded recommender:
A causal inference approach to recommendation.” <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">CoRR</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. Agarwal, K. Takatsu, I. Zaitsev, and T. Joachims, “A general framework for
counterfactual learning-to-rank.” in <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 42nd
International ACM SIGIR Conference on Research and Development in Information
Retrieval, SIGIR</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
W. Wang, F. Feng, X. He, X. Wang, and T.-S. Chua, “Deconfounded recommendation
for alleviating bias amplification,” in <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 27th ACM
SIGKDD Conference on Knowledge Discovery &amp; Data Mining</em>.   ACM, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y. Zhang, F. Feng, X. He, T. Wei, C. Song, G. Ling, and Y. Zhang, “Causal
intervention for leveraging popularity bias in recommendation.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">SIGIR ’21: The 44th International ACM SIGIR Conference on Research
and Development in Information Retrieval</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
W. Wang, F. Feng, X. He, H. Zhang, and T.-S. Chua, “Clicks can be cheating:
Counterfactual recommendation for mitigating clickbait issue.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">SIGIR ’21: The 44th International ACM SIGIR Conference on Research
and Development in Information Retrieval</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
D. Liu, P. Cheng, Z. Dong, X. He, W. Pan, and Z. Ming, “A general knowledge
distillation framework for counterfactual recommendation via uniform data.”
in <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 43rd International ACM SIGIR conference on
research and development in Information Retrieval, SIGIR</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
D. B. Rubin, “Bayesian inference for causal effects: The role of
randomization,” <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">The Annals of statistics</em>, 1978.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
G. E. Hinton, O. Vinyals, and J. Dean, “Distilling the knowledge in a neural
network,” <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">CoRR</em>, vol. abs/1503.02531. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://arxiv.org/abs/1503.02531</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
S. Rendle, C. Freudenthaler, Z. Gantner, and L. Schmidt-Thieme, “Bpr: Bayesian
personalized ranking from implicit feedback.” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the
Twenty-Fifth Conference on Uncertainty in Artificial Intelligence, UAI</em>,
2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Bengio and J.-S. Senecal, “Adaptive importance sampling to accelerate
training of a neural probabilistic language model.” <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">IEEE Trans. Neural
Networks</em>, 2008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
J. Chen, Y. Feng, M. Ester, S. Zhou, C. Chen, and C. Wang, “Modeling users’
exposure with social knowledge influence and consumption influence for
recommendation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 27th ACM International
Conference on Information and Knowledge Management, CIKM</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
D. Liang, L. Charlin, J. McInerney, and D. M. Blei, “Modeling user exposure in
recommendation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the 25th International Conference
on World Wide Web, WWW</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
T. Schnabel, A. Swaminathan, A. Singh, N. Chandak, and T. Joachims,
“Recommendations as treatments: Debiasing learning and evaluation.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 33nd International Conference on Machine Learning,
ICML</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Y. Zheng, C. Gao, X. Li, X. He, Y. Li, and D. Jin, “Disentangling user
interest and conformity for recommendation with causal embedding.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">WWW ’21: The Web Conference</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
A. Agarwal, I. Zaitsev, X. Wang, C. Li, M. Najork, and T. Joachims,
“Estimating position bias without intrusive interventions.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the Twelfth ACM International Conference on Web Search
and Data Mining, WSDM</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
X. Wang, R. Zhang, Y. Sun, and J. Qi, “Doubly robust joint learning for
recommendation on data missing not at random.” in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the
36th International Conference on Machine Learning, ICML</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Z. Zhao, J. Chen, S. Zhou, X. He, X. Cao, F. Zhang, and W. Wu, “Popularity
bias is not always evil: Disentangling benign and harmful bias for
recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">CoRR</em>, vol. abs/2109.07946, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Y. Wang, D. Liang, L. Charlin, and D. M. Blei, “Causal inference for
recommender systems.” in <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">RecSys 2020: Fourteenth ACM Conference on
Recommender Systems</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
J. Jin, Y. Fang, W. Zhang, K. Ren, G. Zhou, J. Xu, Y. Yu, J. Wang, X. Zhu, and
K. Gai, “A deep recurrent survival model for unbiased ranking.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 43rd International ACM SIGIR conference on research
and development in Information Retrieval, SIGIR</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
K. Nagatani and M. Sato, “Accurate and diverse recommendation based on
users’ tendencies toward temporal item popularity.” in <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings
of the 1st Workshop on Temporal Reasoning in Recommender Systems co-located
with 11th International Conference on Recommender Systems</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
S. Bonner and F. Vasile, “Causal embeddings for recommendation.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 12th ACM Conference on Recommender Systems, RecSys</em>,
2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
T. Wei, F. Feng, J. Chen, Z. Wu, J. Yi, and X. He, “Model-agnostic
counterfactual reasoning for eliminating popularity bias in recommender
system,” in <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">KDD ’21: The 27th ACM SIGKDD Conference on Knowledge
Discovery and Data Mining, Virtual Event, Singapore, August 14-18,
2021</em>.   ACM, 2021, pp. 1791–1800.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
D. Liu, P. Cheng, H. Zhu, Z. Dong, X. He, W. Pan, and Z. Ming, “Mitigating
confounding bias in recommendation via information bottleneck.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">RecSys ’21: Fifteenth ACM Conference on Recommender Systems</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Y. He, Z. Wang, P. Cui, H. Zou, Y. Zhang, Q. Cui, and Y. Jiang, “Causpref:
Causal preference learning for out-of-distribution recommendation,” in
<em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">WWW ’22: The ACM Web Conference 2022</em>.   ACM, 2022, pp. 410–421.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Y. Wang, H. Guo, B. Chen, W. Liu, Z. Liu, Q. Zhang, Z. He, H. Zheng, W. Yao,
M. Zhang, Z. Dong, and R. Tang, “Causalint: Causal inspired intervention for
multi-scenario recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">KDD ’22: The 28th ACM SIGKDD
Conference on Knowledge Discovery and Data Mining, Washington, DC, USA,
August 14 - 18, 2022</em>.   ACM, 2022,
pp. 4090–4099.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
L. Yang, Y. Cui, Y. Xuan, C. Wang, S. J. Belongie, and D. Estrin, “Unbiased
offline recommender evaluation for missing-not-at-random implicit feedback.”
in <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the 12th ACM Conference on Recommender Systems,
RecSys</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
“Paying more attention to attention: Improving the performance of
convolutional neural networks via attention transfer.” in <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">5th
International Conference on Learning Representations, ICLR</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
B. Heo, J. Kim, S. Yun, H. Park, N. Kwak, and J. Y. Choi, “A comprehensive
overhaul of feature distillation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">2019 IEEE/CVF International
Conference on Computer Vision, ICCV</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
W. Park, D. Kim, Y. Lu, and M. Cho, “Relational knowledge distillation.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">IEEE Conference on Computer Vision and Pattern Recognition, CVPR</em>,
2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
B. Peng, X. Jin, D. Li, S. Zhou, Y. Wu, J. Liu, Z. Zhang, and Y. Liu,
“Correlation congruence for knowledge distillation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">2019 IEEE/CVF
International Conference on Computer Vision, ICCV</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Z. Shen, Z. He, and X. Xue, “Meal: Multi-model ensemble via adversarial
learning.” in <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">The Thirty-Third AAAI Conference on Artificial
Intelligence, AAAI</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
X. Tan, Y. Ren, D. He, T. Qin, Z. Zhao, and T.-Y. Liu, “Multilingual neural
machine translation with knowledge distillation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">7th International
Conference on Learning Representations, ICLR</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
J. Zhu, J. Liu, W. Li, J. Lai, X. He, L. Chen, and Z. Zheng, “Ensembled ctr
prediction via knowledge distillation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">CIKM ’20: The 29th ACM
International Conference on Information and Knowledge Management</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
S. Wang, K. Zhang, L. Wu, H. Ma, R. Hong, and M. Wang, “Privileged graph
distillation for cold start recommendation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">SIGIR ’21: The 44th
International ACM SIGIR Conference on Research and Development in Information
Retrieval</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
J.-w. Lee, M. Choi, J. Lee, and H. Shim, “Collaborative distillation for top-n
recommendation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">2019 IEEE International Conference on Data Mining,
ICDM</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
S. Kang, J. Hwang, W. Kweon, and H. Yu, “Topology distillation for recommender
system.” in <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">KDD ’21: The 27th ACM SIGKDD Conference on Knowledge
Discovery and Data Mining</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Q. Wang, H. Yin, T. Chen, Z. Huang, H. Wang, Y. Zhao, and N. Q. V. Hung, “Next
point-of-interest recommendation on resource-constrained mobile devices.” in
<em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">WWW ’20: The Web Conference</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
X. Chen, Y. Zhang, H. Xu, Z. Qin, and H. Zha, “Adversarial distillation for
efficient recommendation with external knowledge.” <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">ACM Trans. Inf.
Syst.</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
J. Yao, F. Wang, K. Jia, B. Han, J. Zhou, and H. Yang, “Device-cloud
collaborative learning for recommendation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">KDD ’21: The 27th ACM
SIGKDD Conference on Knowledge Discovery and Data Mining, Virtual Event,
Singapore, August 14-18, 2021</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
X. Wang, X. He, M. Wang, F. Feng, and T.-S. Chua, “Neural graph collaborative
filtering.” in <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Proceedings of the 42nd International ACM SIGIR
Conference on Research and Development in Information Retrieval, SIGIR</em>,
2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
D. Liang, L. Charlin, and D. M. Blei, “Causal inference for recommendation,”
in <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Causation: Foundation to Application, Workshop at UAI. AUAI</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
M. Lukasik, S. Bhojanapalli, A. K. Menon, and S. Kumar, “Teacher’s pet:
understanding and mitigating biases in distillation.” <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">CoRR</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
H. Guo, R. Tang, Y. Ye, Z. Li, and X. He, “Deepfm: A factorization-machine
based neural network for ctr prediction.” in <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Proceedings of the
Twenty-Sixth International Joint Conference on Artificial Intelligence,
IJCAI</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
J. C. Duchi, E. Hazan, and Y. Singer, “Adaptive subgradient methods for online
learning and stochastic optimization.” <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">J. Mach. Learn. Res.</em>, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
T. Salimans, I. J. Goodfellow, W. Zaremba, V. Cheung, A. Radford, and X. Chen,
“Improved techniques for training gans.” in <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Advances in Neural
Information Processing Systems</em>, 2016.

</span>
</li>
</ul>
</section>
<figure class="ltx_float biography" id="id1">
<table class="ltx_tabular" id="id1.1">
<tr class="ltx_tr" id="id1.1.1">
<td class="ltx_td" id="id1.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id1.1.1.1.g1" src="extracted/5634026/thumbnails/syzU-min.png" width="94"/></td>
<td class="ltx_td" id="id1.1.1.2">
<span class="ltx_inline-block" id="id1.1.1.2.1">
<span class="ltx_p" id="id1.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id1.1.1.2.1.1.1">Shengyu Zhang</span> 
is currently a Ph.D. student at Zhejiang University, Hangzhou, China. He got the China Scholarship Council Fellowship in 2020 and visited National University of Singapore, Singapore, as a visiting research scholar from 2021 to 2022 (expected). His current research interests are in information retrieval, and causally reguarlized machine learning. Until now, he has published more than 20 papers in major international journals and conferences such as SIGKDD, SIGIR, ACM MM, WWW, CVPR, AAAI, and TKDE, etc. He also serves as Reviewer of several high-level international journals such as TKDE, TCYB, TNNLS, etc.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id2">
<table class="ltx_tabular" id="id2.1">
<tr class="ltx_tr" id="id2.1.1">
<td class="ltx_td" id="id2.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="121" id="id2.1.1.1.g1" src="extracted/5634026/thumbnails/ziqi.png" width="100"/></td>
<td class="ltx_td" id="id2.1.1.2">
<span class="ltx_inline-block" id="id2.1.1.2.1">
<span class="ltx_p" id="id2.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id2.1.1.2.1.1.1">Ziqi Jiang</span> 
is currently an undergraduate student at the College of Computer Science, Zhejiang University, advised by Prof. Fei Wu. His research interests lie at the intersection of multimedia, AI security, and causal inference, with the goal to build socially efficient and robust machine learning systems. He has published papers in ACM MM.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id3">
<table class="ltx_tabular" id="id3.1">
<tr class="ltx_tr" id="id3.1.1">
<td class="ltx_td" id="id3.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id3.1.1.1.g1" src="extracted/5634026/thumbnails/yjc.png" width="88"/></td>
<td class="ltx_td" id="id3.1.1.2">
<span class="ltx_inline-block" id="id3.1.1.2.1">
<span class="ltx_p" id="id3.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id3.1.1.2.1.1.1">Jiangchao Yao</span> 
is an Assistant Professor at Shanghai Jiao Tong University. He got his dual Ph.D. degree under the supervision of Ya Zhang in Shanghai Jiao Tong University and Ivor W. Tsang in University of Technology Sydney in 2019. His research interests lie on Trustworthty Machine Learning and Reasoning, making machine learning robust, interpretable and scalable. He has published over 20 papers in major international journals and conferences such as ICML, ICLR, NeurIPS, KDD, TPAMI, TIP, TKDE, etc..</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id4">
<table class="ltx_tabular" id="id4.1">
<tr class="ltx_tr" id="id4.1.1">
<td class="ltx_td" id="id4.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id4.1.1.1.g1" src="extracted/5634026/thumbnails/ffl.png" width="90"/></td>
<td class="ltx_td" id="id4.1.1.2">
<span class="ltx_inline-block" id="id4.1.1.2.1">
<span class="ltx_p" id="id4.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id4.1.1.2.1.1.1">Fuli Feng</span> 
is a professor at the University of Science and Technology of China (USTC). He received Ph.D. in Computer Science from NUS in 2019. His research interests include information retrieval, data mining, and multi-media processing. He has over 30 publications appeared in several top conferences such as SIGIR, WWW, and MM, and journals including TKDE and TOIS. His work on Bayesian Personalized Ranking has received the Best Poster Award of WWW 2018. Moreover, he has been served as the PC member for several top conferences including SIGIR, WWW, WSDM, NeurIPS, AAAI, ACL, MM, and invited reviewer for prestigious journals such as TOIS, TKDE, TNNLS, TPAMI, and TMM.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id5">
<table class="ltx_tabular" id="id5.1">
<tr class="ltx_tr" id="id5.1.1">
<td class="ltx_td" id="id5.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="124" id="id5.1.1.1.g1" src="extracted/5634026/thumbnails/kunkuang.png" width="100"/></td>
<td class="ltx_td" id="id5.1.1.2">
<span class="ltx_inline-block" id="id5.1.1.2.1">
<span class="ltx_p" id="id5.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id5.1.1.2.1.1.1">Kun Kuang</span> 
received his Ph.D. degree from Tsinghua University in 2019. He is now an Associate Professor in the College of Computer Science and Technology, Zhejiang University. He was a visiting scholar with Prof. Susan Athey’s Group at Stanford University. His main research interests include Causal Inference, Artificial Intelligence, and Causally Regularized Machine Learning. He has published over 40 papers in major international journals and conferences, including SIGKDD, ICML, ACM MM, AAAI, IJCAI, TKDE, TKDD, Engineering, and ICDM, etc.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id6">
<table class="ltx_tabular" id="id6.1">
<tr class="ltx_tr" id="id6.1.1">
<td class="ltx_td" id="id6.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="124" id="id6.1.1.1.g1" src="extracted/5634026/thumbnails/zhouzhao.png" width="100"/></td>
<td class="ltx_td" id="id6.1.1.2">
<span class="ltx_inline-block" id="id6.1.1.2.1">
<span class="ltx_p" id="id6.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id6.1.1.2.1.1.1">Zhou Zhao</span> 
(Member, IEEE) received the B.S.
and Ph.D. degrees in computer science from The
Hong Kong University of Science and Technology,
in 2010 and 2015, respectively. He is currently an
Associate Professor with the College of Computer
Science, Zhejiang University. His research interests
include machine learning and data mining.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id7">
<table class="ltx_tabular" id="id7.1">
<tr class="ltx_tr" id="id7.1.1">
<td class="ltx_td" id="id7.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id7.1.1.1.g1" src="extracted/5634026/thumbnails/shuoli.png" width="94"/></td>
<td class="ltx_td" id="id7.1.1.2">
<span class="ltx_inline-block" id="id7.1.1.2.1">
<span class="ltx_p" id="id7.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id7.1.1.2.1.1.1">Shuo Li</span>  is an undergraduate at School of Computing, National University of Singapore (NUS), and works as an research intern at Lazada data science team. His research interests include multi-modal learning and natural language processing.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id8">
<table class="ltx_tabular" id="id8.1">
<tr class="ltx_tr" id="id8.1.1">
<td class="ltx_td" id="id8.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="97" id="id8.1.1.1.g1" src="extracted/5634026/thumbnails/hongxiayang.png" width="100"/></td>
<td class="ltx_td" id="id8.1.1.2">
<span class="ltx_inline-block" id="id8.1.1.2.1">
<span class="ltx_p" id="id8.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id8.1.1.2.1.1.1">Hongxia Yang</span>  received the PhD degree in statistics from Duke University, in 2010. She is working
as a senior staff data scientist and director with
the Alibaba Group. She has published more than
60 papers and held nine filed/to be filed US patents and is serving as the associate editor of
Applied Stochastic Models in Business and Industry.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id9">
<table class="ltx_tabular" id="id9.1">
<tr class="ltx_tr" id="id9.1.1">
<td class="ltx_td" id="id9.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id9.1.1.1.g1" src="extracted/5634026/thumbnails/tatsengchua.png" width="89"/></td>
<td class="ltx_td" id="id9.1.1.2">
<span class="ltx_inline-block" id="id9.1.1.2.1">
<span class="ltx_p" id="id9.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id9.1.1.2.1.1.1">Tat-Seng Chua</span>  is the KITHCT Chair Professor
at the School of Computing, National University
of Singapore. He was the Acting and Founding
Dean of the School during 1998-2000. Dr
Chua‘s main research interest is in multimedia
information retrieval and social media analytics.
In particular, his research focuses on the
extraction, retrieval and question-answering
(QA) of text and rich media arising from the
Web and multiple social networks. He is the
co-Director of NExT, a joint Center between
NUS and Tsinghua University to develop technologies for live social
media search. Dr Chua is the 2015 winner of the prestigious ACM
SIGMM award for Outstanding Technical Contributions to Multimedia
Computing, Communications and Applications. He is the Chair of
steering committee of ACM International Conference on Multimedia
Retrieval (ICMR) and Multimedia Modeling (MMM) conference series. Dr
Chua is also the General Co-Chair of ACM Multimedia 2005, ACM CIVR
(now ACM ICMR) 2005, ACM SIGIR 2008, and ACM Web Science 2015.
He serves in the editorial boards of four international journals. Dr. Chua
is the co-Founder of two technology startup companies in Singapore.
He holds a PhD from the University of Leeds, UK.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id10">
<table class="ltx_tabular" id="id10.1">
<tr class="ltx_tr" id="id10.1.1">
<td class="ltx_td" id="id10.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_portrait" height="125" id="id10.1.1.1.g1" src="extracted/5634026/thumbnails/feiwu.png" width="100"/></td>
<td class="ltx_td" id="id10.1.1.2">
<span class="ltx_inline-block" id="id10.1.1.2.1">
<span class="ltx_p" id="id10.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id10.1.1.2.1.1.1">Fei Wu</span> 
(Senior Member, IEEE) received the Ph.D. degree from Zhejiang
University, Hangzhou, China. He was a Visiting
Scholar with the Prof. B. Yu’s Group, University of
California at Berkeley, Berkeley, from 2009 to 2010.
He is currently a Full Professor with the College of
Computer Science and Technology, Zhejiang University. His current research interests include multimedia retrieval, sparse representation, and machine
learning.</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri May 31 05:23:02 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
