<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Towards Model-Agnostic Dataset Condensation by Heterogeneous Models</title>
<!--Generated on Sun Sep 22 17:10:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Dataset condensation Model agnostic Heterogeneous" lang="en" name="keywords"/>
<base href="/html/2409.14538v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S1" title="In Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S2" title="In Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S2.SS1" title="In 2 Related Work ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Dataset Condensation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S2.SS2" title="In 2 Related Work ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Knowledge Distillation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S2.SS3" title="In 2 Related Work ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Utilization of Heterogeneity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3" title="In Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.SS1" title="In 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.SS2" title="In 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Heterogeneous Model Dataset Condensation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.SS3" title="In 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Gradient Balance Module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.SS4" title="In 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Mutual Distillation with Spatial-Semantic Decomposition</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4" title="In Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.SS1" title="In 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.SS2" title="In 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.SS3" title="In 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Studies</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.SS4" title="In 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Qualitative Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.SS5" title="In 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S5" title="In Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Kyung Hee University, Yongin, Republic of Korea 
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id1.1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{moonjunyyy, ju.kim, gmpark}@khu.ac.kr</span></span></span></span></span></span>
<h1 class="ltx_title ltx_title_document">Towards Model-Agnostic Dataset Condensation by Heterogeneous Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jun-Yeong Moon<span class="ltx_ERROR undefined" id="id1.1.id1">\orcidlink</span>0000-0002-0543-2588
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jung Uk Kim<span class="ltx_ERROR undefined" id="id2.1.id1">\orcidlink</span>0000-0003-4533-4875
</span><span class="ltx_author_notes">Corresponding authors</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Gyeong-Moon Park<span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span><span class="ltx_ERROR undefined" id="id3.1.id1">\orcidlink</span>0000-0003-4011-9981
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id4.id1">The advancement of deep learning has coincided with the proliferation of both models and available data.
The surge in dataset sizes and the subsequent surge in computational requirements have led to the development of the Dataset Condensation (DC).
While prior studies have delved into generating synthetic images through methods like distribution alignment and training trajectory tracking for more efficient model training, a significant challenge arises when employing these condensed images practically.
Notably, these condensed images tend to be specific to particular models, constraining their versatility and practicality.
In response to this limitation, we introduce a novel method, Heterogeneous Model Dataset Condensation (HMDC), designed to produce universally applicable condensed images through cross-model interactions.
To address the issues of gradient magnitude difference and semantic distance in models when utilizing heterogeneous models, we propose the Gradient Balance Module (GBM) and Mutual Distillation (MD) with the Spatial-Semantic Decomposition method.
By balancing the contribution of each model and maintaining their semantic meaning closely, our approach overcomes the limitations associated with model-specific condensed images and enhances the broader utility.
The source code is available in <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/KHU-AGI/HMDC" title="">https://github.com/KHU-AGI/HMDC</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Dataset condensation Model agnostic Heterogeneous
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, deep learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib25" title="">25</a>]</cite> has demonstrated a remarkable surge in both effectiveness and applicability across diverse domains <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib17" title="">17</a>]</cite>.
With the increasing depth and complexity of models, the need for substantial datasets has become imperative to sustain their performance and forestall overfitting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib19" title="">19</a>]</cite>.
Yet, the challenges extend beyond the mere acquisition of huge datasets to management and efficient utilization.
In this context, techniques such as dataset distillation (DD) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib35" title="">35</a>]</cite> or dataset condensation (DC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib38" title="">38</a>]</cite> have emerged, aiming to address these challenges by offering more efficient data management strategies.
These methods not only enable the selection of core-sets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib9" title="">9</a>]</cite> capable of maintaining the original performance using a whole dataset but also facilitate a dramatic reduction in dataset size through the creation of synthetic data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite> that accurately represents the original dataset.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Accuracy plots illustrating the performance of different models trained using images generated by recent dataset condensation methods on the CIFAR-10 dataset with an IPC10 setting. Each bar signifies a performance comparison relative to randomly selected images on 10 images per class, with the initial state of each method identical to that of the random image. Notably, the methods exhibit over-condensation on ConvNet, resulting in performance degradation on other models.</span></figcaption><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="406" id="S1.F1.g1" src="x1.png" width="830"/>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Traditionally, dataset condensation methods have employed a compact 3-layered model named ConvNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib38" title="">38</a>]</cite> for the condensation process <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite>.
The standard evaluation method for assessing the performance of condensed images has been the <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">ConvNet-to-ConvNet</span> test, where condensation and evaluation are conducted on ConvNet.
Some studies have delved into assessing the general performance of condensed images on other shallow models, such as 3-layered MLP or AlexNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib24" title="">24</a>]</cite>.
However, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">1</span></a>, the effectiveness of generated images diminishes when applied to widely used models like ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib13" title="">13</a>]</cite> and Vision Transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib8" title="">8</a>]</cite>.
This indicates that synthetic images are over-condensed on ConvNet, showing a high model dependence.
This dependency significantly constrains the versatility of condensed images.
Introducing a completely new model necessitates training a new model and generating a new condensed image, implying that training data must be stored in some way.
Consequently, there is a need for a model-agnostic benchmark, not limited to <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">ConvNet-to-ConvNet</span>, that operates independently of the specific model.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The primary challenge in achieving model-agnostic dataset condensation lies in identifying the common characteristics within a model and devising an effective method for their extraction.
It is difficult to distinguish between features with general recognition information and those excessively tailored to a particular model.
To address this challenge, for the first time, we introduce a novel approach that utilizes two models to extract generalized knowledge without bias towards any specific model. To this end, we propose a novel dataset condensation method, Heterogeneous Model Dataset Condensation (HMDC), leveraging heterogeneous models to extract common features that are more universally applicable.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">When naively employing two heterogeneous models simultaneously for dataset condensation, two difficult issues arise.
Firstly, there is a problem of gradient magnitude difference, characterized by significant differences in the size of the gradient provided to the synthetic image due to structural or depth variations between the two models.
This discrepancy can lead to the disregard of one model or the failure of the image to converge.
To alleviate this, we present a Gradient Balance Module (GBM), which accumulates the gradient magnitude of each optimization target, to control the magnitude of the loss.
Thus, even if two models have different structures, they can have a similar impact on the synthetic image.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Another challenge arises in the semantic distance resulting from different knowledge between models.
As the two models undergo learning, they converge towards optimal points specific to other models, leading to a growing of semantic distance and instability in image convergence.
To tackle this, we propose a Mutual Distillation (MD) by Spatial-Semantic Decomposition of the two models and feature matching throughout the process.
This process enables consistent updates of synthetic images regardless of the model, avoiding over-condensation on any particular model by obtaining information from different models.
This characteristic makes our method effective in a model-agnostic setting.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our main contributions can be summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">For the first time, we present Heterogeneous Model Dataset Condensation (HMDC) for model-agnostic dataset condensation, which resolves the over-condensation issue to a specific model.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">To facilitate the convergence of synthetic images, we propose the Gradient Balance Module to control a gap between the gradient magnitudes of heterogeneous models.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We propose Mutual Distillation by Spatial-Semantic Decomposition feature matching of heterogeneous models to fill in the semantic distance between models.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">From the extensive experiments, we demonstrate that our condensed images consistently show great performances from shallow models to widely used large models.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Dataset Condensation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Through the exploration of various core-set selection methodologies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib9" title="">9</a>]</cite>, it has become evident that synthesized images generated through optimization procedures exhibit greater efficacy compared to direct utilization of real images.
Optimization techniques for generating synthetic images primarily fall into two categories: those concerned with tracking training trajectories and those focused on aligning feature distributions.
The trajectory tracking approach involves aligning the gradients <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite> between real and synthetic images during the training process, or adapting the weights of the model trained on synthetic images to resemble the model trained on real images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib2" title="">2</a>]</cite>.
These techniques aim to generate synthetic images based on their influence on the model’s learning process.
Another stream of condensation methods emphasizes feature distribution matching at intermediate layers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib34" title="">34</a>]</cite>, or output distribution alignment with the synthetic images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>]</cite>.
These approaches aim to generate synthetic images by emphasizing feature similarity within the synthetic image but they still depend on utilizing an intermediate training state of the model.
In this work, we use the gradient matching method, which has shown better performance in previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite>.
In the existing studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite>, synthetic images were typically generated using small 3-layer models, resulting in images that exhibited limited compatibility with other models.
In contrast to conventional approaches, our method employs two distinct models to generate a balanced condensed image that avoids being overly biased toward either model, addressing limitations observed in earlier approaches.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Knowledge Distillation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Knowledge Distillation (KD), as introduced by Hinton et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib16" title="">16</a>]</cite>, is a technique in machine learning where a smaller model known as the student model trains to replicate the behavior of a larger model which is the teacher model. This process is done to transfer the knowledge and generalization capabilities of the teacher model to the smaller and more efficient student model. This transfer of knowledge in KD is achieved by aligning what is often referred to as dark knowledge, which can manifest as either logits <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib39" title="">39</a>]</cite> or features <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib22" title="">22</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">While the primary objective of KD is to create a more efficient smaller model that performs similarly to a larger one, in this study, we leverage KD to specifically reduce the semantic distance between models. This approach enables learning from a single image through the knowledge of two distinct models, thereby ensuring stable learning without the risk of collapse.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Utilization of Heterogeneity</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Previous methods for adjusting loss or gradient have primarily focused on using the uncertainty <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib20" title="">20</a>]</cite> or norm of the gradient <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib4" title="">4</a>]</cite> to balance multi-task learning or employing multiple adaptors for domain-robust models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib27" title="">27</a>]</cite>. In this work, we claim that while there is a single task, heterogeneity is necessary to solve it effectively. We decompose the features of the image model into spatial and semantic information, allowing us to simultaneously leverage the knowledge of two models with distinct features. By accumulating the gradient norm, we can identify differences in the average gradient and appropriately scale it to inject more general features into the synthetic images, thereby compensating for the imbalance in learning caused by the structures of models.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<figure class="ltx_figure" id="S3.F2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">Diagram of Heterogeneous Model Dataset Condensation (HMDC), where two distinct models are employed for feature extraction. These features undergo dimension adjustment through Spatial-Semantic Decomposition, a critical step facilitating Mutual Distillation, and enhancing knowledge sharing between the two models. Throughout the dataset condensation process, the compensatory Gradient Balance Module comes into play, mitigating gradient variations inherent to different models. This module ensures the extraction of general knowledge by harmonizing gradient magnitudes, thus contributing to a more universally applicable condensation process.</span></figcaption><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="300" id="S3.F2.g1" src="x2.png" width="830"/>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Formulation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.8">Dataset Condensation (DC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib38" title="">38</a>]</cite> is an approach that aims at creating a synthetic dataset denoted as <math alttext="\mathcal{S}={(\textbf{x}_{i},y_{i})}^{|\mathcal{S}|}_{i=1}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.3"><semantics id="S3.SS1.p1.1.m1.3a"><mrow id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3.4" xref="S3.SS1.p1.1.m1.3.3.4.cmml">𝒮</mi><mo id="S3.SS1.p1.1.m1.3.3.3" xref="S3.SS1.p1.1.m1.3.3.3.cmml">=</mo><msubsup id="S3.SS1.p1.1.m1.3.3.2" xref="S3.SS1.p1.1.m1.3.3.2.cmml"><mrow id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml"><mo id="S3.SS1.p1.1.m1.3.3.2.2.2.2.3" stretchy="false" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.2a.cmml">x</mtext><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.2.2.4" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.2.2.5" stretchy="false" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">)</mo></mrow><mrow id="S3.SS1.p1.1.m1.3.3.2.4" xref="S3.SS1.p1.1.m1.3.3.2.4.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.4.2" xref="S3.SS1.p1.1.m1.3.3.2.4.2.cmml">i</mi><mo id="S3.SS1.p1.1.m1.3.3.2.4.1" xref="S3.SS1.p1.1.m1.3.3.2.4.1.cmml">=</mo><mn id="S3.SS1.p1.1.m1.3.3.2.4.3" xref="S3.SS1.p1.1.m1.3.3.2.4.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml">𝒮</mi><mo id="S3.SS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b"><apply id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3"><eq id="S3.SS1.p1.1.m1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.3"></eq><ci id="S3.SS1.p1.1.m1.3.3.4.cmml" xref="S3.SS1.p1.1.m1.3.3.4">𝒮</ci><apply id="S3.SS1.p1.1.m1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2">subscript</csymbol><apply id="S3.SS1.p1.1.m1.3.3.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2">superscript</csymbol><interval closure="open" id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.2a.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.2">x</mtext></ci><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3"><abs id="S3.SS1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3.1"></abs><ci id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">𝒮</ci></apply></apply><apply id="S3.SS1.p1.1.m1.3.3.2.4.cmml" xref="S3.SS1.p1.1.m1.3.3.2.4"><eq id="S3.SS1.p1.1.m1.3.3.2.4.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.4.1"></eq><ci id="S3.SS1.p1.1.m1.3.3.2.4.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.4.2">𝑖</ci><cn id="S3.SS1.p1.1.m1.3.3.2.4.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.2.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">\mathcal{S}={(\textbf{x}_{i},y_{i})}^{|\mathcal{S}|}_{i=1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.3d">caligraphic_S = ( x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT | caligraphic_S | end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT</annotation></semantics></math> from the complete training data <math alttext="\mathcal{T}={(\textbf{x}_{i},y_{i})}^{|\mathcal{T}|}_{i=1}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.3"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.3.3.4" xref="S3.SS1.p1.2.m2.3.3.4.cmml">𝒯</mi><mo id="S3.SS1.p1.2.m2.3.3.3" xref="S3.SS1.p1.2.m2.3.3.3.cmml">=</mo><msubsup id="S3.SS1.p1.2.m2.3.3.2" xref="S3.SS1.p1.2.m2.3.3.2.cmml"><mrow id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml"><mo id="S3.SS1.p1.2.m2.3.3.2.2.2.2.3" stretchy="false" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.2a.cmml">x</mtext><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.3.3.2.2.2.2.4" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.3.3.2.2.2.2.5" stretchy="false" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">)</mo></mrow><mrow id="S3.SS1.p1.2.m2.3.3.2.4" xref="S3.SS1.p1.2.m2.3.3.2.4.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.4.2" xref="S3.SS1.p1.2.m2.3.3.2.4.2.cmml">i</mi><mo id="S3.SS1.p1.2.m2.3.3.2.4.1" xref="S3.SS1.p1.2.m2.3.3.2.4.1.cmml">=</mo><mn id="S3.SS1.p1.2.m2.3.3.2.4.3" xref="S3.SS1.p1.2.m2.3.3.2.4.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">𝒯</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><apply id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3"><eq id="S3.SS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.3"></eq><ci id="S3.SS1.p1.2.m2.3.3.4.cmml" xref="S3.SS1.p1.2.m2.3.3.4">𝒯</ci><apply id="S3.SS1.p1.2.m2.3.3.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2">subscript</csymbol><apply id="S3.SS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2">superscript</csymbol><interval closure="open" id="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.2a.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.2">x</mtext></ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><abs id="S3.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝒯</ci></apply></apply><apply id="S3.SS1.p1.2.m2.3.3.2.4.cmml" xref="S3.SS1.p1.2.m2.3.3.2.4"><eq id="S3.SS1.p1.2.m2.3.3.2.4.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.4.1"></eq><ci id="S3.SS1.p1.2.m2.3.3.2.4.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.4.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.3.3.2.4.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.2.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">\mathcal{T}={(\textbf{x}_{i},y_{i})}^{|\mathcal{T}|}_{i=1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.3d">caligraphic_T = ( x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT | caligraphic_T | end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="|\mathcal{S}|\ll|\mathcal{T}|" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.2"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.3" xref="S3.SS1.p1.3.m3.2.3.cmml"><mrow id="S3.SS1.p1.3.m3.2.3.2.2" xref="S3.SS1.p1.3.m3.2.3.2.1.cmml"><mo id="S3.SS1.p1.3.m3.2.3.2.2.1" stretchy="false" xref="S3.SS1.p1.3.m3.2.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒮</mi><mo id="S3.SS1.p1.3.m3.2.3.2.2.2" stretchy="false" xref="S3.SS1.p1.3.m3.2.3.2.1.1.cmml">|</mo></mrow><mo id="S3.SS1.p1.3.m3.2.3.1" xref="S3.SS1.p1.3.m3.2.3.1.cmml">≪</mo><mrow id="S3.SS1.p1.3.m3.2.3.3.2" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml"><mo id="S3.SS1.p1.3.m3.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.3.m3.2.3.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml">𝒯</mi><mo id="S3.SS1.p1.3.m3.2.3.3.2.2" stretchy="false" xref="S3.SS1.p1.3.m3.2.3.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.2.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.1">much-less-than</csymbol><apply id="S3.SS1.p1.3.m3.2.3.2.1.cmml" xref="S3.SS1.p1.3.m3.2.3.2.2"><abs id="S3.SS1.p1.3.m3.2.3.2.1.1.cmml" xref="S3.SS1.p1.3.m3.2.3.2.2.1"></abs><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒮</ci></apply><apply id="S3.SS1.p1.3.m3.2.3.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.3.2"><abs id="S3.SS1.p1.3.m3.2.3.3.1.1.cmml" xref="S3.SS1.p1.3.m3.2.3.3.2.1"></abs><ci id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2">𝒯</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">|\mathcal{S}|\ll|\mathcal{T}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.2d">| caligraphic_S | ≪ | caligraphic_T |</annotation></semantics></math>. This synthetic dataset, <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">caligraphic_S</annotation></semantics></math>, is designed to train a model to a performance level comparable to what could be achieved with the original data. The dataset <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">caligraphic_S</annotation></semantics></math> can encompass a subset of <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">caligraphic_T</annotation></semantics></math>. However, recent research has unveiled that the utilization of synthetic data yields superior performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite>. In many cases, the central challenge in dataset condensation revolves around the determination of the optimization target, denoted as <math alttext="\phi(\textbf{x},y)" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.2"><semantics id="S3.SS1.p1.7.m7.2a"><mrow id="S3.SS1.p1.7.m7.2.3" xref="S3.SS1.p1.7.m7.2.3.cmml"><mi id="S3.SS1.p1.7.m7.2.3.2" xref="S3.SS1.p1.7.m7.2.3.2.cmml">ϕ</mi><mo id="S3.SS1.p1.7.m7.2.3.1" xref="S3.SS1.p1.7.m7.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m7.2.3.3.2" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml"><mo id="S3.SS1.p1.7.m7.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1a.cmml">x</mtext><mo id="S3.SS1.p1.7.m7.2.3.3.2.2" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.7.m7.2.2" xref="S3.SS1.p1.7.m7.2.2.cmml">y</mi><mo id="S3.SS1.p1.7.m7.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.2b"><apply id="S3.SS1.p1.7.m7.2.3.cmml" xref="S3.SS1.p1.7.m7.2.3"><times id="S3.SS1.p1.7.m7.2.3.1.cmml" xref="S3.SS1.p1.7.m7.2.3.1"></times><ci id="S3.SS1.p1.7.m7.2.3.2.cmml" xref="S3.SS1.p1.7.m7.2.3.2">italic-ϕ</ci><interval closure="open" id="S3.SS1.p1.7.m7.2.3.3.1.cmml" xref="S3.SS1.p1.7.m7.2.3.3.2"><ci id="S3.SS1.p1.7.m7.1.1a.cmml" xref="S3.SS1.p1.7.m7.1.1"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">x</mtext></ci><ci id="S3.SS1.p1.7.m7.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.2c">\phi(\textbf{x},y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.2d">italic_ϕ ( x , italic_y )</annotation></semantics></math>, for the condensed image set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">caligraphic_S</annotation></semantics></math>. This can be formally expressed as an optimization problem:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{S}=\arg\underset{\mathcal{S}}{\mathrm{min}}\sum_{i=1}^{|%
\mathcal{B}|}\,\mathcal{D}(\phi(\textbf{x}^{t}_{i},y^{t}_{i}),\phi(\textbf{x}^%
{s}_{i},y^{s}_{i})),~{}{(\textbf{x}^{t}_{i},y^{t}_{i})}^{|\mathcal{B}|}_{i=1}%
\sim\mathcal{T},\;{(\textbf{x}^{s}_{i},y^{s}_{i})}^{|\mathcal{B}|}_{i=1}\sim%
\mathcal{S}," class="ltx_Math" display="inline" id="S3.E1.m1.4"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1"><mrow id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.3.cmml"><mrow id="S3.E1.m1.4.4.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.1.1.4" xref="S3.E1.m1.4.4.1.1.1.1.4.cmml">𝒮</mi><mo id="S3.E1.m1.4.4.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.2.cmml"><mrow id="S3.E1.m1.4.4.1.1.1.1.2.4" xref="S3.E1.m1.4.4.1.1.1.1.2.4.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.4.1" xref="S3.E1.m1.4.4.1.1.1.1.2.4.1.cmml">arg</mi><mo id="S3.E1.m1.4.4.1.1.1.1.2.4a" lspace="0.167em" xref="S3.E1.m1.4.4.1.1.1.1.2.4.cmml">⁡</mo><munder accentunder="true" id="S3.E1.m1.4.4.1.1.1.1.2.4.2" xref="S3.E1.m1.4.4.1.1.1.1.2.4.2.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.4.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.4.2.2.cmml">min</mi><mo class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.1.1.2.4.2.1" xref="S3.E1.m1.4.4.1.1.1.1.2.4.2.1.cmml">𝒮</mo></munder></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E1.m1.4.4.1.1.1.1.2.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.cmml"><munderover id="S3.E1.m1.4.4.1.1.1.1.2.2.3a" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.2" movablelimits="false" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.1" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">ℬ</mi><mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S3.E1.m1.4.4.1.1.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.4" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.4.cmml">𝒟</mi><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.3.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.cmml">ϕ</mi><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">x</mtext><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.3.cmml">,</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.4.cmml">ϕ</mi><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.2a.cmml">x</mtext><mi id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.3.cmml">i</mi><mi id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.3.cmml">s</mi></msubsup><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.2.3" rspace="0.497em" xref="S3.E1.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.4.4.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml"><mrow id="S3.E1.m1.4.4.1.1.2.2.1.1" xref="S3.E1.m1.4.4.1.1.2.2.1.1.cmml"><msubsup id="S3.E1.m1.4.4.1.1.2.2.1.1.2" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.cmml"><mrow id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.3.cmml"><mo id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.2a.cmml">x</mtext><mi id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.3.cmml">)</mo></mrow><mrow id="S3.E1.m1.4.4.1.1.2.2.1.1.2.4" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.2" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.2.cmml">i</mi><mo id="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.1" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.1.cmml">=</mo><mn id="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.3" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.2.2.1.3" xref="S3.E1.m1.2.2.1.2.cmml"><mo id="S3.E1.m1.2.2.1.3.1" stretchy="false" xref="S3.E1.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml">ℬ</mi><mo id="S3.E1.m1.2.2.1.3.2" stretchy="false" xref="S3.E1.m1.2.2.1.2.1.cmml">|</mo></mrow></msubsup><mo id="S3.E1.m1.4.4.1.1.2.2.1.1.3" xref="S3.E1.m1.4.4.1.1.2.2.1.1.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.2.2.1.1.4" xref="S3.E1.m1.4.4.1.1.2.2.1.1.4.cmml">𝒯</mi></mrow><mo id="S3.E1.m1.4.4.1.1.2.2.2.3" rspace="0.447em" xref="S3.E1.m1.4.4.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E1.m1.4.4.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.cmml"><msubsup id="S3.E1.m1.4.4.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml"><mrow id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.3.cmml"><mo id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.2a.cmml">x</mtext><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.3.cmml">i</mi><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.3.cmml">s</mi></msubsup><mo id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow><mrow id="S3.E1.m1.4.4.1.1.2.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.2.cmml">i</mi><mo id="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.1" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.1.cmml">=</mo><mn id="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.3.3.1.3" xref="S3.E1.m1.3.3.1.2.cmml"><mo id="S3.E1.m1.3.3.1.3.1" stretchy="false" xref="S3.E1.m1.3.3.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml">ℬ</mi><mo id="S3.E1.m1.3.3.1.3.2" stretchy="false" xref="S3.E1.m1.3.3.1.2.1.cmml">|</mo></mrow></msubsup><mo id="S3.E1.m1.4.4.1.1.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.2.2.4.cmml">𝒮</mi></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3a.cmml" xref="S3.E1.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1"><eq id="S3.E1.m1.4.4.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3"></eq><ci id="S3.E1.m1.4.4.1.1.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.1.1.4">𝒮</ci><apply id="S3.E1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2"><times id="S3.E1.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.3"></times><apply id="S3.E1.m1.4.4.1.1.1.1.2.4.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.4"><arg id="S3.E1.m1.4.4.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.4.1"></arg><apply id="S3.E1.m1.4.4.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.4.2"><ci id="S3.E1.m1.4.4.1.1.1.1.2.4.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.4.2.1">𝒮</ci><ci id="S3.E1.m1.4.4.1.1.1.1.2.4.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.4.2.2">min</ci></apply></apply><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2"><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3"><eq id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.2">𝑖</ci><cn id="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.3"><abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.3.1"></abs><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">ℬ</ci></apply></apply><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2"><times id="S3.E1.m1.4.4.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.3"></times><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.2.4.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.4">𝒟</ci><interval closure="open" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2"><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"></times><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4">italic-ϕ</ci><interval closure="open" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">x</mtext></ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2"><times id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.3"></times><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.4.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.4">italic-ϕ</ci><interval closure="open" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2"><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.2a.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.2">x</mtext></ci><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.2.3">𝑠</ci></apply><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></interval></apply></apply></apply></apply><apply id="S3.E1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.3a.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.1.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.2.2.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.3">similar-to</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2">superscript</csymbol><interval closure="open" id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2"><apply id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.2">x</mtext></ci><ci id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S3.E1.m1.2.2.1.2.cmml" xref="S3.E1.m1.2.2.1.3"><abs id="S3.E1.m1.2.2.1.2.1.cmml" xref="S3.E1.m1.2.2.1.3.1"></abs><ci id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1">ℬ</ci></apply></apply><apply id="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.4"><eq id="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.1"></eq><ci id="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.2">𝑖</ci><cn id="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.2.2.1.1.2.4.3">1</cn></apply></apply><ci id="S3.E1.m1.4.4.1.1.2.2.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.2.2.1.1.4">𝒯</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.3">similar-to</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2">superscript</csymbol><interval closure="open" id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2"><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.2a.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.2">x</mtext></ci><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.2.3">𝑠</ci></apply><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.3"><abs id="S3.E1.m1.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.1.3.1"></abs><ci id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1">ℬ</ci></apply></apply><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.4"><eq id="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.1"></eq><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.2">𝑖</ci><cn id="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.4.3">1</cn></apply></apply><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.4.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.4">𝒮</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\displaystyle\mathcal{S}=\arg\underset{\mathcal{S}}{\mathrm{min}}\sum_{i=1}^{|%
\mathcal{B}|}\,\mathcal{D}(\phi(\textbf{x}^{t}_{i},y^{t}_{i}),\phi(\textbf{x}^%
{s}_{i},y^{s}_{i})),~{}{(\textbf{x}^{t}_{i},y^{t}_{i})}^{|\mathcal{B}|}_{i=1}%
\sim\mathcal{T},\;{(\textbf{x}^{s}_{i},y^{s}_{i})}^{|\mathcal{B}|}_{i=1}\sim%
\mathcal{S},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.4d">caligraphic_S = roman_arg undercaligraphic_S start_ARG roman_min end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_B | end_POSTSUPERSCRIPT caligraphic_D ( italic_ϕ ( x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϕ ( x start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) , ( x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT | caligraphic_B | end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT ∼ caligraphic_T , ( x start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT | caligraphic_B | end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT ∼ caligraphic_S ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.11">where <math alttext="\mathcal{D}(\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m1.2"><semantics id="S3.SS1.p1.9.m1.2a"><mrow id="S3.SS1.p1.9.m1.2.3" xref="S3.SS1.p1.9.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m1.2.3.2" xref="S3.SS1.p1.9.m1.2.3.2.cmml">𝒟</mi><mo id="S3.SS1.p1.9.m1.2.3.1" xref="S3.SS1.p1.9.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.9.m1.2.3.3.2" xref="S3.SS1.p1.9.m1.2.3.3.1.cmml"><mo id="S3.SS1.p1.9.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.9.m1.2.3.3.1.cmml">(</mo><mo id="S3.SS1.p1.9.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.9.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.9.m1.2.3.3.2.2" rspace="0em" xref="S3.SS1.p1.9.m1.2.3.3.1.cmml">,</mo><mo id="S3.SS1.p1.9.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.9.m1.2.2.cmml">⋅</mo><mo id="S3.SS1.p1.9.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.9.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m1.2b"><apply id="S3.SS1.p1.9.m1.2.3.cmml" xref="S3.SS1.p1.9.m1.2.3"><times id="S3.SS1.p1.9.m1.2.3.1.cmml" xref="S3.SS1.p1.9.m1.2.3.1"></times><ci id="S3.SS1.p1.9.m1.2.3.2.cmml" xref="S3.SS1.p1.9.m1.2.3.2">𝒟</ci><interval closure="open" id="S3.SS1.p1.9.m1.2.3.3.1.cmml" xref="S3.SS1.p1.9.m1.2.3.3.2"><ci id="S3.SS1.p1.9.m1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1">⋅</ci><ci id="S3.SS1.p1.9.m1.2.2.cmml" xref="S3.SS1.p1.9.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m1.2c">\mathcal{D}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m1.2d">caligraphic_D ( ⋅ , ⋅ )</annotation></semantics></math> represents a matching function, such as Euclidean or cosine distance; commonly, Mean Squared Error (MSE) is used, and <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m2.1"><semantics id="S3.SS1.p1.10.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m2.1.1" xref="S3.SS1.p1.10.m2.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m2.1b"><ci id="S3.SS1.p1.10.m2.1.1.cmml" xref="S3.SS1.p1.10.m2.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m2.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m2.1d">caligraphic_B</annotation></semantics></math> represents a mini-batch. <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m3.1"><semantics id="S3.SS1.p1.11.m3.1a"><mi id="S3.SS1.p1.11.m3.1.1" xref="S3.SS1.p1.11.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m3.1b"><ci id="S3.SS1.p1.11.m3.1.1.cmml" xref="S3.SS1.p1.11.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m3.1d">italic_ϕ</annotation></semantics></math> is typically associated with features, gradients, or weights of the model.
For model-agnostic DC, we utilize a gradient-based method that involves two heterogeneous models, enabling the condensed image to acquire more generalized knowledge.
In the following sections, we introduce Heterogeneous Model Dataset Condensation (HMDC) along with methods to find an appropriate optimization target.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Heterogeneous Model Dataset Condensation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Traditional methods for gradient-based dataset condensation typically utilize the gradient of the model’s cross-entropy loss as the optimization target <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>]</cite>, denoted as <math alttext="\phi(\textbf{x},y)" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.3" xref="S3.SS2.p1.1.m1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml">ϕ</mi><mo id="S3.SS2.p1.1.m1.2.3.1" xref="S3.SS2.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.1.m1.2.3.3.2" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml"><mo id="S3.SS2.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1a.cmml">x</mtext><mo id="S3.SS2.p1.1.m1.2.3.3.2.2" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">y</mi><mo id="S3.SS2.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3"><times id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.1"></times><ci id="S3.SS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2">italic-ϕ</ci><interval closure="open" id="S3.SS2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2"><ci id="S3.SS2.p1.1.m1.1.1a.cmml" xref="S3.SS2.p1.1.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">x</mtext></ci><ci id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">\phi(\textbf{x},y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">italic_ϕ ( x , italic_y )</annotation></semantics></math>. This is expressed mathematically as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx2">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\phi(\textbf{x},y)=\nabla\mathcal{L}_{\mathrm{CE}}(f_{\theta}(%
\textbf{x}),y)." class="ltx_Math" display="inline" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.3.2" xref="S3.E2.m1.5.5.1.1.3.2.cmml">ϕ</mi><mo id="S3.E2.m1.5.5.1.1.3.1" xref="S3.E2.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.3.3.2" xref="S3.E2.m1.5.5.1.1.3.3.1.cmml"><mo id="S3.E2.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.1.1.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1a.cmml">x</mtext><mo id="S3.E2.m1.5.5.1.1.3.3.2.2" xref="S3.E2.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">y</mi><mo id="S3.E2.m1.5.5.1.1.3.3.2.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.1" xref="S3.E2.m1.5.5.1.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.3.cmml"><mo id="S3.E2.m1.5.5.1.1.1.3.1" rspace="0.167em" xref="S3.E2.m1.5.5.1.1.1.3.1.cmml">∇</mo><msub id="S3.E2.m1.5.5.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.1.3.2.2" xref="S3.E2.m1.5.5.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E2.m1.5.5.1.1.1.3.2.3" xref="S3.E2.m1.5.5.1.1.1.3.2.3.cmml">CE</mi></msub></mrow><mo id="S3.E2.m1.5.5.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3a.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E2.m1.3.3a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">x</mtext><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E2.m1.3.3a.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">y</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.4" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" lspace="0em" xref="S3.E2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"></eq><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"><times id="S3.E2.m1.5.5.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1"></times><ci id="S3.E2.m1.5.5.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2">italic-ϕ</ci><interval closure="open" id="S3.E2.m1.5.5.1.1.3.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2"><ci id="S3.E2.m1.1.1a.cmml" xref="S3.E2.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">x</mtext></ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E2.m1.5.5.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.2"></times><apply id="S3.E2.m1.5.5.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.3"><ci id="S3.E2.m1.5.5.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.3.1">∇</ci><apply id="S3.E2.m1.5.5.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.3.2.2">ℒ</ci><ci id="S3.E2.m1.5.5.1.1.1.3.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.3.2.3">CE</ci></apply></apply><interval closure="open" id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1"><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1"></times><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3">𝜃</ci></apply><ci id="S3.E2.m1.3.3a.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">x</mtext></ci></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\displaystyle\phi(\textbf{x},y)=\nabla\mathcal{L}_{\mathrm{CE}}(f_{\theta}(%
\textbf{x}),y).</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">italic_ϕ ( x , italic_y ) = ∇ caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( x ) , italic_y ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.6">Here, <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m1.1"><semantics id="S3.SS2.p1.2.m1.1a"><msub id="S3.SS2.p1.2.m1.1.1" xref="S3.SS2.p1.2.m1.1.1.cmml"><mi id="S3.SS2.p1.2.m1.1.1.2" xref="S3.SS2.p1.2.m1.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.2.m1.1.1.3" xref="S3.SS2.p1.2.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m1.1b"><apply id="S3.SS2.p1.2.m1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m1.1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m1.1.1.2.cmml" xref="S3.SS2.p1.2.m1.1.1.2">𝑓</ci><ci id="S3.SS2.p1.2.m1.1.1.3.cmml" xref="S3.SS2.p1.2.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> represents a model parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m2.1"><semantics id="S3.SS2.p1.3.m2.1a"><mi id="S3.SS2.p1.3.m2.1.1" xref="S3.SS2.p1.3.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m2.1b"><ci id="S3.SS2.p1.3.m2.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m2.1d">italic_θ</annotation></semantics></math> and <math alttext="\mathcal{L}_{\mathrm{CE}}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m3.1"><semantics id="S3.SS2.p1.4.m3.1a"><msub id="S3.SS2.p1.4.m3.1.1" xref="S3.SS2.p1.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m3.1.1.2" xref="S3.SS2.p1.4.m3.1.1.2.cmml">ℒ</mi><mi id="S3.SS2.p1.4.m3.1.1.3" xref="S3.SS2.p1.4.m3.1.1.3.cmml">CE</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m3.1b"><apply id="S3.SS2.p1.4.m3.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m3.1.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m3.1.1.2.cmml" xref="S3.SS2.p1.4.m3.1.1.2">ℒ</ci><ci id="S3.SS2.p1.4.m3.1.1.3.cmml" xref="S3.SS2.p1.4.m3.1.1.3">CE</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m3.1c">\mathcal{L}_{\mathrm{CE}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT</annotation></semantics></math> is the cross-entropy loss. However, these approaches exhibit a model-dependent nature since they focus on training the model’s path on the image. In contrast, our HMDC seeks to extract the common features by concurrently considering the training paths of two models, <math alttext="f_{\theta_{1}}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m4.1"><semantics id="S3.SS2.p1.5.m4.1a"><msub id="S3.SS2.p1.5.m4.1.1" xref="S3.SS2.p1.5.m4.1.1.cmml"><mi id="S3.SS2.p1.5.m4.1.1.2" xref="S3.SS2.p1.5.m4.1.1.2.cmml">f</mi><msub id="S3.SS2.p1.5.m4.1.1.3" xref="S3.SS2.p1.5.m4.1.1.3.cmml"><mi id="S3.SS2.p1.5.m4.1.1.3.2" xref="S3.SS2.p1.5.m4.1.1.3.2.cmml">θ</mi><mn id="S3.SS2.p1.5.m4.1.1.3.3" xref="S3.SS2.p1.5.m4.1.1.3.3.cmml">1</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m4.1b"><apply id="S3.SS2.p1.5.m4.1.1.cmml" xref="S3.SS2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m4.1.1.1.cmml" xref="S3.SS2.p1.5.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m4.1.1.2.cmml" xref="S3.SS2.p1.5.m4.1.1.2">𝑓</ci><apply id="S3.SS2.p1.5.m4.1.1.3.cmml" xref="S3.SS2.p1.5.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m4.1.1.3.1.cmml" xref="S3.SS2.p1.5.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.5.m4.1.1.3.2.cmml" xref="S3.SS2.p1.5.m4.1.1.3.2">𝜃</ci><cn id="S3.SS2.p1.5.m4.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.5.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m4.1c">f_{\theta_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m4.1d">italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{\theta_{2}}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m5.1"><semantics id="S3.SS2.p1.6.m5.1a"><msub id="S3.SS2.p1.6.m5.1.1" xref="S3.SS2.p1.6.m5.1.1.cmml"><mi id="S3.SS2.p1.6.m5.1.1.2" xref="S3.SS2.p1.6.m5.1.1.2.cmml">f</mi><msub id="S3.SS2.p1.6.m5.1.1.3" xref="S3.SS2.p1.6.m5.1.1.3.cmml"><mi id="S3.SS2.p1.6.m5.1.1.3.2" xref="S3.SS2.p1.6.m5.1.1.3.2.cmml">θ</mi><mn id="S3.SS2.p1.6.m5.1.1.3.3" xref="S3.SS2.p1.6.m5.1.1.3.3.cmml">2</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m5.1b"><apply id="S3.SS2.p1.6.m5.1.1.cmml" xref="S3.SS2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m5.1.1.1.cmml" xref="S3.SS2.p1.6.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m5.1.1.2.cmml" xref="S3.SS2.p1.6.m5.1.1.2">𝑓</ci><apply id="S3.SS2.p1.6.m5.1.1.3.cmml" xref="S3.SS2.p1.6.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m5.1.1.3.1.cmml" xref="S3.SS2.p1.6.m5.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.6.m5.1.1.3.2.cmml" xref="S3.SS2.p1.6.m5.1.1.3.2">𝜃</ci><cn id="S3.SS2.p1.6.m5.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.6.m5.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m5.1c">f_{\theta_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m5.1d">italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, where two models complement their features each other as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">2</span></a>. This is expressed mathematically as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx3">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{S}=\arg\underset{\mathcal{S}}{\mathrm{min}}" class="ltx_Math" display="inline" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">𝒮</mi><mo id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.3.1" xref="S3.Ex1.m1.1.1.3.1.cmml">arg</mi><mo id="S3.Ex1.m1.1.1.3a" lspace="0.167em" xref="S3.Ex1.m1.1.1.3.cmml">⁡</mo><munder accentunder="true" id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml"><mi id="S3.Ex1.m1.1.1.3.2.2" xref="S3.Ex1.m1.1.1.3.2.2.cmml">min</mi><mo class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.3.2.1" xref="S3.Ex1.m1.1.1.3.2.1.cmml">𝒮</mo></munder></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><eq id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"></eq><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">𝒮</ci><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><arg id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3.1"></arg><apply id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2"><ci id="S3.Ex1.m1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.1.1.3.2.1">𝒮</ci><ci id="S3.Ex1.m1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.1.1.3.2.2">min</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\mathcal{S}=\arg\underset{\mathcal{S}}{\mathrm{min}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">caligraphic_S = roman_arg undercaligraphic_S start_ARG roman_min end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\left\{\sum_{i=1}^{|\mathcal{B}|}\,\mathcal{D}\left(\nabla%
\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{1}}\left(\textbf{x}^{t}_{i}\right),y%
^{t}_{i}\right),\nabla\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{1}}\left(%
\textbf{x}^{s}_{i}\right),y^{s}_{i}\right)\right)\right." class="ltx_math_unparsed" display="inline" id="S3.Ex1.m2.1"><semantics id="S3.Ex1.m2.1a"><mrow id="S3.Ex1.m2.1b"><mo id="S3.Ex1.m2.1.2">{</mo><mstyle displaystyle="true" id="S3.Ex1.m2.1.3"><munderover id="S3.Ex1.m2.1.3a"><mo id="S3.Ex1.m2.1.3.2.2" movablelimits="false">∑</mo><mrow id="S3.Ex1.m2.1.3.2.3"><mi id="S3.Ex1.m2.1.3.2.3.2">i</mi><mo id="S3.Ex1.m2.1.3.2.3.1">=</mo><mn id="S3.Ex1.m2.1.3.2.3.3">1</mn></mrow><mrow id="S3.Ex1.m2.1.1.1.3"><mo id="S3.Ex1.m2.1.1.1.3.1" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.1.1.1.1">ℬ</mi><mo id="S3.Ex1.m2.1.1.1.3.2" stretchy="false">|</mo></mrow></munderover></mstyle><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.1.4">𝒟</mi><mrow id="S3.Ex1.m2.1.5"><mo id="S3.Ex1.m2.1.5.1">(</mo><mo id="S3.Ex1.m2.1.5.2" rspace="0.167em">∇</mo><msub id="S3.Ex1.m2.1.5.3"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.1.5.3.2">ℒ</mi><mi id="S3.Ex1.m2.1.5.3.3">CE</mi></msub><mrow id="S3.Ex1.m2.1.5.4"><mo id="S3.Ex1.m2.1.5.4.1">(</mo><msub id="S3.Ex1.m2.1.5.4.2"><mi id="S3.Ex1.m2.1.5.4.2.2">f</mi><msub id="S3.Ex1.m2.1.5.4.2.3"><mi id="S3.Ex1.m2.1.5.4.2.3.2">θ</mi><mn id="S3.Ex1.m2.1.5.4.2.3.3">1</mn></msub></msub><mrow id="S3.Ex1.m2.1.5.4.3"><mo id="S3.Ex1.m2.1.5.4.3.1">(</mo><msubsup id="S3.Ex1.m2.1.5.4.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex1.m2.1.5.4.3.2.2.2">x</mtext><mi id="S3.Ex1.m2.1.5.4.3.2.3">i</mi><mi id="S3.Ex1.m2.1.5.4.3.2.2.3">t</mi></msubsup><mo id="S3.Ex1.m2.1.5.4.3.3">)</mo></mrow><mo id="S3.Ex1.m2.1.5.4.4">,</mo><msubsup id="S3.Ex1.m2.1.5.4.5"><mi id="S3.Ex1.m2.1.5.4.5.2.2">y</mi><mi id="S3.Ex1.m2.1.5.4.5.3">i</mi><mi id="S3.Ex1.m2.1.5.4.5.2.3">t</mi></msubsup><mo id="S3.Ex1.m2.1.5.4.6">)</mo></mrow><mo id="S3.Ex1.m2.1.5.5">,</mo><mo id="S3.Ex1.m2.1.5.6" rspace="0.167em">∇</mo><msub id="S3.Ex1.m2.1.5.7"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.1.5.7.2">ℒ</mi><mi id="S3.Ex1.m2.1.5.7.3">CE</mi></msub><mrow id="S3.Ex1.m2.1.5.8"><mo id="S3.Ex1.m2.1.5.8.1">(</mo><msub id="S3.Ex1.m2.1.5.8.2"><mi id="S3.Ex1.m2.1.5.8.2.2">f</mi><msub id="S3.Ex1.m2.1.5.8.2.3"><mi id="S3.Ex1.m2.1.5.8.2.3.2">θ</mi><mn id="S3.Ex1.m2.1.5.8.2.3.3">1</mn></msub></msub><mrow id="S3.Ex1.m2.1.5.8.3"><mo id="S3.Ex1.m2.1.5.8.3.1">(</mo><msubsup id="S3.Ex1.m2.1.5.8.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex1.m2.1.5.8.3.2.2.2">x</mtext><mi id="S3.Ex1.m2.1.5.8.3.2.3">i</mi><mi id="S3.Ex1.m2.1.5.8.3.2.2.3">s</mi></msubsup><mo id="S3.Ex1.m2.1.5.8.3.3">)</mo></mrow><mo id="S3.Ex1.m2.1.5.8.4">,</mo><msubsup id="S3.Ex1.m2.1.5.8.5"><mi id="S3.Ex1.m2.1.5.8.5.2.2">y</mi><mi id="S3.Ex1.m2.1.5.8.5.3">i</mi><mi id="S3.Ex1.m2.1.5.8.5.2.3">s</mi></msubsup><mo id="S3.Ex1.m2.1.5.8.6">)</mo></mrow><mo id="S3.Ex1.m2.1.5.9">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex1.m2.1c">\displaystyle\left\{\sum_{i=1}^{|\mathcal{B}|}\,\mathcal{D}\left(\nabla%
\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{1}}\left(\textbf{x}^{t}_{i}\right),y%
^{t}_{i}\right),\nabla\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{1}}\left(%
\textbf{x}^{s}_{i}\right),y^{s}_{i}\right)\right)\right.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.1d">{ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_B | end_POSTSUPERSCRIPT caligraphic_D ( ∇ caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , ∇ caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\left.+\sum_{i=1}^{|\mathcal{B}|}\,\mathcal{D}\left(\nabla%
\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{2}}\left(\textbf{x}^{t}_{i}\right),y%
^{t}_{i}\right),\nabla\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{2}}\left(%
\textbf{x}^{s}_{i}\right),y^{s}_{i}\right)\right)\right\}" class="ltx_math_unparsed" display="inline" id="S3.Ex2.m1.1"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1b"><mo id="S3.Ex2.m1.1.2">+</mo><mstyle displaystyle="true" id="S3.Ex2.m1.1.3"><munderover id="S3.Ex2.m1.1.3a"><mo id="S3.Ex2.m1.1.3.2.2" movablelimits="false">∑</mo><mrow id="S3.Ex2.m1.1.3.2.3"><mi id="S3.Ex2.m1.1.3.2.3.2">i</mi><mo id="S3.Ex2.m1.1.3.2.3.1">=</mo><mn id="S3.Ex2.m1.1.3.2.3.3">1</mn></mrow><mrow id="S3.Ex2.m1.1.1.1.3"><mo id="S3.Ex2.m1.1.1.1.3.1" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.1.1.1">ℬ</mi><mo id="S3.Ex2.m1.1.1.1.3.2" stretchy="false">|</mo></mrow></munderover></mstyle><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.4">𝒟</mi><mrow id="S3.Ex2.m1.1.5"><mo id="S3.Ex2.m1.1.5.1">(</mo><mo id="S3.Ex2.m1.1.5.2" rspace="0.167em">∇</mo><msub id="S3.Ex2.m1.1.5.3"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.5.3.2">ℒ</mi><mi id="S3.Ex2.m1.1.5.3.3">CE</mi></msub><mrow id="S3.Ex2.m1.1.5.4"><mo id="S3.Ex2.m1.1.5.4.1">(</mo><msub id="S3.Ex2.m1.1.5.4.2"><mi id="S3.Ex2.m1.1.5.4.2.2">f</mi><msub id="S3.Ex2.m1.1.5.4.2.3"><mi id="S3.Ex2.m1.1.5.4.2.3.2">θ</mi><mn id="S3.Ex2.m1.1.5.4.2.3.3">2</mn></msub></msub><mrow id="S3.Ex2.m1.1.5.4.3"><mo id="S3.Ex2.m1.1.5.4.3.1">(</mo><msubsup id="S3.Ex2.m1.1.5.4.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex2.m1.1.5.4.3.2.2.2">x</mtext><mi id="S3.Ex2.m1.1.5.4.3.2.3">i</mi><mi id="S3.Ex2.m1.1.5.4.3.2.2.3">t</mi></msubsup><mo id="S3.Ex2.m1.1.5.4.3.3">)</mo></mrow><mo id="S3.Ex2.m1.1.5.4.4">,</mo><msubsup id="S3.Ex2.m1.1.5.4.5"><mi id="S3.Ex2.m1.1.5.4.5.2.2">y</mi><mi id="S3.Ex2.m1.1.5.4.5.3">i</mi><mi id="S3.Ex2.m1.1.5.4.5.2.3">t</mi></msubsup><mo id="S3.Ex2.m1.1.5.4.6">)</mo></mrow><mo id="S3.Ex2.m1.1.5.5">,</mo><mo id="S3.Ex2.m1.1.5.6" rspace="0.167em">∇</mo><msub id="S3.Ex2.m1.1.5.7"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.5.7.2">ℒ</mi><mi id="S3.Ex2.m1.1.5.7.3">CE</mi></msub><mrow id="S3.Ex2.m1.1.5.8"><mo id="S3.Ex2.m1.1.5.8.1">(</mo><msub id="S3.Ex2.m1.1.5.8.2"><mi id="S3.Ex2.m1.1.5.8.2.2">f</mi><msub id="S3.Ex2.m1.1.5.8.2.3"><mi id="S3.Ex2.m1.1.5.8.2.3.2">θ</mi><mn id="S3.Ex2.m1.1.5.8.2.3.3">2</mn></msub></msub><mrow id="S3.Ex2.m1.1.5.8.3"><mo id="S3.Ex2.m1.1.5.8.3.1">(</mo><msubsup id="S3.Ex2.m1.1.5.8.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex2.m1.1.5.8.3.2.2.2">x</mtext><mi id="S3.Ex2.m1.1.5.8.3.2.3">i</mi><mi id="S3.Ex2.m1.1.5.8.3.2.2.3">s</mi></msubsup><mo id="S3.Ex2.m1.1.5.8.3.3">)</mo></mrow><mo id="S3.Ex2.m1.1.5.8.4">,</mo><msubsup id="S3.Ex2.m1.1.5.8.5"><mi id="S3.Ex2.m1.1.5.8.5.2.2">y</mi><mi id="S3.Ex2.m1.1.5.8.5.3">i</mi><mi id="S3.Ex2.m1.1.5.8.5.2.3">s</mi></msubsup><mo id="S3.Ex2.m1.1.5.8.6">)</mo></mrow><mo id="S3.Ex2.m1.1.5.9">)</mo></mrow><mo id="S3.Ex2.m1.1.6">}</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle\left.+\sum_{i=1}^{|\mathcal{B}|}\,\mathcal{D}\left(\nabla%
\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{2}}\left(\textbf{x}^{t}_{i}\right),y%
^{t}_{i}\right),\nabla\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{2}}\left(%
\textbf{x}^{s}_{i}\right),y^{s}_{i}\right)\right)\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.1d">+ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_B | end_POSTSUPERSCRIPT caligraphic_D ( ∇ caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , ∇ caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle=\arg\underset{\mathcal{S}}{\mathrm{min}}" class="ltx_Math" display="inline" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"></mi><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">arg</mi><mo id="S3.E3.m1.1.1.3a" lspace="0.167em" xref="S3.E3.m1.1.1.3.cmml">⁡</mo><munder accentunder="true" id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml"><mi id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml">min</mi><mo class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.3.2.1" xref="S3.E3.m1.1.1.3.2.1.cmml">𝒮</mo></munder></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2">absent</csymbol><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><arg id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></arg><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2"><ci id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2.1">𝒮</ci><ci id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2">min</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle=\arg\underset{\mathcal{S}}{\mathrm{min}}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">= roman_arg undercaligraphic_S start_ARG roman_min end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\left\{\sum_{i=1}^{|\mathcal{B}|}\mathcal{L}^{1}+\sum_{i=1}^{|%
\mathcal{B}|}\mathcal{L}^{2}\right\}," class="ltx_Math" display="inline" id="S3.E3.m2.3"><semantics id="S3.E3.m2.3a"><mrow id="S3.E3.m2.3.3.1"><mrow id="S3.E3.m2.3.3.1.1.1" xref="S3.E3.m2.3.3.1.1.2.cmml"><mo id="S3.E3.m2.3.3.1.1.1.2" xref="S3.E3.m2.3.3.1.1.2.cmml">{</mo><mrow id="S3.E3.m2.3.3.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.cmml"><mrow id="S3.E3.m2.3.3.1.1.1.1.2" xref="S3.E3.m2.3.3.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E3.m2.3.3.1.1.1.1.2.1" xref="S3.E3.m2.3.3.1.1.1.1.2.1.cmml"><munderover id="S3.E3.m2.3.3.1.1.1.1.2.1a" xref="S3.E3.m2.3.3.1.1.1.1.2.1.cmml"><mo id="S3.E3.m2.3.3.1.1.1.1.2.1.2.2" movablelimits="false" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.2.1.2.3" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.2" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.2.cmml">i</mi><mo id="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.1" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.3" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m2.1.1.1.3" xref="S3.E3.m2.1.1.1.2.cmml"><mo id="S3.E3.m2.1.1.1.3.1" stretchy="false" xref="S3.E3.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m2.1.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml">ℬ</mi><mo id="S3.E3.m2.1.1.1.3.2" stretchy="false" xref="S3.E3.m2.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><msup id="S3.E3.m2.3.3.1.1.1.1.2.2" xref="S3.E3.m2.3.3.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m2.3.3.1.1.1.1.2.2.2" xref="S3.E3.m2.3.3.1.1.1.1.2.2.2.cmml">ℒ</mi><mn id="S3.E3.m2.3.3.1.1.1.1.2.2.3" xref="S3.E3.m2.3.3.1.1.1.1.2.2.3.cmml">1</mn></msup></mrow><mo id="S3.E3.m2.3.3.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.cmml">+</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E3.m2.3.3.1.1.1.1.3.1" xref="S3.E3.m2.3.3.1.1.1.1.3.1.cmml"><munderover id="S3.E3.m2.3.3.1.1.1.1.3.1a" xref="S3.E3.m2.3.3.1.1.1.1.3.1.cmml"><mo id="S3.E3.m2.3.3.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.3.1.2.3" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.2" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.1" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.3" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m2.2.2.1.3" xref="S3.E3.m2.2.2.1.2.cmml"><mo id="S3.E3.m2.2.2.1.3.1" stretchy="false" xref="S3.E3.m2.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m2.2.2.1.1" xref="S3.E3.m2.2.2.1.1.cmml">ℬ</mi><mo id="S3.E3.m2.2.2.1.3.2" stretchy="false" xref="S3.E3.m2.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><msup id="S3.E3.m2.3.3.1.1.1.1.3.2" xref="S3.E3.m2.3.3.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m2.3.3.1.1.1.1.3.2.2" xref="S3.E3.m2.3.3.1.1.1.1.3.2.2.cmml">ℒ</mi><mn id="S3.E3.m2.3.3.1.1.1.1.3.2.3" xref="S3.E3.m2.3.3.1.1.1.1.3.2.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E3.m2.3.3.1.1.1.3" xref="S3.E3.m2.3.3.1.1.2.cmml">}</mo></mrow><mo id="S3.E3.m2.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.3b"><set id="S3.E3.m2.3.3.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1"><apply id="S3.E3.m2.3.3.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1"><plus id="S3.E3.m2.3.3.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1"></plus><apply id="S3.E3.m2.3.3.1.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2"><apply id="S3.E3.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.2.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.1">superscript</csymbol><apply id="S3.E3.m2.3.3.1.1.1.1.2.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.2.1.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.1">subscript</csymbol><sum id="S3.E3.m2.3.3.1.1.1.1.2.1.2.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.2"></sum><apply id="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.3"><eq id="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.1"></eq><ci id="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.2">𝑖</ci><cn id="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="S3.E3.m2.3.3.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m2.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.3"><abs id="S3.E3.m2.1.1.1.2.1.cmml" xref="S3.E3.m2.1.1.1.3.1"></abs><ci id="S3.E3.m2.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1">ℬ</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E3.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2.2.2">ℒ</ci><cn id="S3.E3.m2.3.3.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.E3.m2.3.3.1.1.1.1.2.2.3">1</cn></apply></apply><apply id="S3.E3.m2.3.3.1.1.1.1.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3"><apply id="S3.E3.m2.3.3.1.1.1.1.3.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.3.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E3.m2.3.3.1.1.1.1.3.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.3.1.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E3.m2.3.3.1.1.1.1.3.1.2.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.2"></sum><apply id="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.3"><eq id="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E3.m2.3.3.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m2.2.2.1.2.cmml" xref="S3.E3.m2.2.2.1.3"><abs id="S3.E3.m2.2.2.1.2.1.cmml" xref="S3.E3.m2.2.2.1.3.1"></abs><ci id="S3.E3.m2.2.2.1.1.cmml" xref="S3.E3.m2.2.2.1.1">ℬ</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.1.1.3.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E3.m2.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.3.2.2">ℒ</ci><cn id="S3.E3.m2.3.3.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E3.m2.3.3.1.1.1.1.3.2.3">2</cn></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.3c">\displaystyle\left\{\sum_{i=1}^{|\mathcal{B}|}\mathcal{L}^{1}+\sum_{i=1}^{|%
\mathcal{B}|}\mathcal{L}^{2}\right\},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m2.3d">{ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_B | end_POSTSUPERSCRIPT caligraphic_L start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_B | end_POSTSUPERSCRIPT caligraphic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.11">where <math alttext="\mathcal{L}^{1}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m1.1"><semantics id="S3.SS2.p1.7.m1.1a"><msup id="S3.SS2.p1.7.m1.1.1" xref="S3.SS2.p1.7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m1.1.1.2" xref="S3.SS2.p1.7.m1.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.7.m1.1.1.3" xref="S3.SS2.p1.7.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m1.1b"><apply id="S3.SS2.p1.7.m1.1.1.cmml" xref="S3.SS2.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m1.1.1.1.cmml" xref="S3.SS2.p1.7.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.7.m1.1.1.2.cmml" xref="S3.SS2.p1.7.m1.1.1.2">ℒ</ci><cn id="S3.SS2.p1.7.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m1.1c">\mathcal{L}^{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m1.1d">caligraphic_L start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}^{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m2.1"><semantics id="S3.SS2.p1.8.m2.1a"><msup id="S3.SS2.p1.8.m2.1.1" xref="S3.SS2.p1.8.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m2.1.1.2" xref="S3.SS2.p1.8.m2.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.8.m2.1.1.3" xref="S3.SS2.p1.8.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m2.1b"><apply id="S3.SS2.p1.8.m2.1.1.cmml" xref="S3.SS2.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m2.1.1.1.cmml" xref="S3.SS2.p1.8.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.8.m2.1.1.2.cmml" xref="S3.SS2.p1.8.m2.1.1.2">ℒ</ci><cn id="S3.SS2.p1.8.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.8.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m2.1c">\mathcal{L}^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m2.1d">caligraphic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> mean the optimization target about <math alttext="f_{\theta_{1}}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m3.1"><semantics id="S3.SS2.p1.9.m3.1a"><msub id="S3.SS2.p1.9.m3.1.1" xref="S3.SS2.p1.9.m3.1.1.cmml"><mi id="S3.SS2.p1.9.m3.1.1.2" xref="S3.SS2.p1.9.m3.1.1.2.cmml">f</mi><msub id="S3.SS2.p1.9.m3.1.1.3" xref="S3.SS2.p1.9.m3.1.1.3.cmml"><mi id="S3.SS2.p1.9.m3.1.1.3.2" xref="S3.SS2.p1.9.m3.1.1.3.2.cmml">θ</mi><mn id="S3.SS2.p1.9.m3.1.1.3.3" xref="S3.SS2.p1.9.m3.1.1.3.3.cmml">1</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m3.1b"><apply id="S3.SS2.p1.9.m3.1.1.cmml" xref="S3.SS2.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m3.1.1.1.cmml" xref="S3.SS2.p1.9.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m3.1.1.2.cmml" xref="S3.SS2.p1.9.m3.1.1.2">𝑓</ci><apply id="S3.SS2.p1.9.m3.1.1.3.cmml" xref="S3.SS2.p1.9.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m3.1.1.3.1.cmml" xref="S3.SS2.p1.9.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.9.m3.1.1.3.2.cmml" xref="S3.SS2.p1.9.m3.1.1.3.2">𝜃</ci><cn id="S3.SS2.p1.9.m3.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.9.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m3.1c">f_{\theta_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{\theta_{2}}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m4.1"><semantics id="S3.SS2.p1.10.m4.1a"><msub id="S3.SS2.p1.10.m4.1.1" xref="S3.SS2.p1.10.m4.1.1.cmml"><mi id="S3.SS2.p1.10.m4.1.1.2" xref="S3.SS2.p1.10.m4.1.1.2.cmml">f</mi><msub id="S3.SS2.p1.10.m4.1.1.3" xref="S3.SS2.p1.10.m4.1.1.3.cmml"><mi id="S3.SS2.p1.10.m4.1.1.3.2" xref="S3.SS2.p1.10.m4.1.1.3.2.cmml">θ</mi><mn id="S3.SS2.p1.10.m4.1.1.3.3" xref="S3.SS2.p1.10.m4.1.1.3.3.cmml">2</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m4.1b"><apply id="S3.SS2.p1.10.m4.1.1.cmml" xref="S3.SS2.p1.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m4.1.1.1.cmml" xref="S3.SS2.p1.10.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m4.1.1.2.cmml" xref="S3.SS2.p1.10.m4.1.1.2">𝑓</ci><apply id="S3.SS2.p1.10.m4.1.1.3.cmml" xref="S3.SS2.p1.10.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m4.1.1.3.1.cmml" xref="S3.SS2.p1.10.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.10.m4.1.1.3.2.cmml" xref="S3.SS2.p1.10.m4.1.1.3.2">𝜃</ci><cn id="S3.SS2.p1.10.m4.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.10.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m4.1c">f_{\theta_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m4.1d">italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> respectively, in this case, the mean squared error between gradients generated by synthetic and real images in each model. To enhance performance, additional regularization terms can be introduced as <math alttext="\mathcal{L}^{3},...,\mathcal{L}^{k}" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m5.3"><semantics id="S3.SS2.p1.11.m5.3a"><mrow id="S3.SS2.p1.11.m5.3.3.2" xref="S3.SS2.p1.11.m5.3.3.3.cmml"><msup id="S3.SS2.p1.11.m5.2.2.1.1" xref="S3.SS2.p1.11.m5.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.11.m5.2.2.1.1.2" xref="S3.SS2.p1.11.m5.2.2.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.11.m5.2.2.1.1.3" xref="S3.SS2.p1.11.m5.2.2.1.1.3.cmml">3</mn></msup><mo id="S3.SS2.p1.11.m5.3.3.2.3" xref="S3.SS2.p1.11.m5.3.3.3.cmml">,</mo><mi id="S3.SS2.p1.11.m5.1.1" mathvariant="normal" xref="S3.SS2.p1.11.m5.1.1.cmml">…</mi><mo id="S3.SS2.p1.11.m5.3.3.2.4" xref="S3.SS2.p1.11.m5.3.3.3.cmml">,</mo><msup id="S3.SS2.p1.11.m5.3.3.2.2" xref="S3.SS2.p1.11.m5.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.11.m5.3.3.2.2.2" xref="S3.SS2.p1.11.m5.3.3.2.2.2.cmml">ℒ</mi><mi id="S3.SS2.p1.11.m5.3.3.2.2.3" xref="S3.SS2.p1.11.m5.3.3.2.2.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m5.3b"><list id="S3.SS2.p1.11.m5.3.3.3.cmml" xref="S3.SS2.p1.11.m5.3.3.2"><apply id="S3.SS2.p1.11.m5.2.2.1.1.cmml" xref="S3.SS2.p1.11.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m5.2.2.1.1.1.cmml" xref="S3.SS2.p1.11.m5.2.2.1.1">superscript</csymbol><ci id="S3.SS2.p1.11.m5.2.2.1.1.2.cmml" xref="S3.SS2.p1.11.m5.2.2.1.1.2">ℒ</ci><cn id="S3.SS2.p1.11.m5.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.11.m5.2.2.1.1.3">3</cn></apply><ci id="S3.SS2.p1.11.m5.1.1.cmml" xref="S3.SS2.p1.11.m5.1.1">…</ci><apply id="S3.SS2.p1.11.m5.3.3.2.2.cmml" xref="S3.SS2.p1.11.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m5.3.3.2.2.1.cmml" xref="S3.SS2.p1.11.m5.3.3.2.2">superscript</csymbol><ci id="S3.SS2.p1.11.m5.3.3.2.2.2.cmml" xref="S3.SS2.p1.11.m5.3.3.2.2.2">ℒ</ci><ci id="S3.SS2.p1.11.m5.3.3.2.2.3.cmml" xref="S3.SS2.p1.11.m5.3.3.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m5.3c">\mathcal{L}^{3},...,\mathcal{L}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m5.3d">caligraphic_L start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT , … , caligraphic_L start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>. This formulation envisions a dataset condensation method that straightforwardly utilizes two models. However, two key challenges arise the gradient magnitude difference and semantic distance between the models. We address these challenges with our novel Gradient Balance Module (GBM) and Mutual Distillation (MD) with Spatial-Semantic Decomposition (SSD), which are described next.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Gradient Balance Module</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The optimization of Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.E3" title="Equation 3 ‣ 3.2 Heterogeneous Model Dataset Condensation ‣ 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">3</span></a> faces new challenges due to a significant disparity in the gradient magnitude among <math alttext="\nabla\mathcal{L}^{1},\nabla\mathcal{L}^{2},...,\nabla\mathcal{L}^{k}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.4"><semantics id="S3.SS3.p1.1.m1.4a"><mrow id="S3.SS3.p1.1.m1.4.4.3" xref="S3.SS3.p1.1.m1.4.4.4.cmml"><mrow id="S3.SS3.p1.1.m1.2.2.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.cmml"><mo id="S3.SS3.p1.1.m1.2.2.1.1.1" rspace="0.167em" xref="S3.SS3.p1.1.m1.2.2.1.1.1.cmml">∇</mo><msup id="S3.SS3.p1.1.m1.2.2.1.1.2" xref="S3.SS3.p1.1.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.2.2.1.1.2.2" xref="S3.SS3.p1.1.m1.2.2.1.1.2.2.cmml">ℒ</mi><mn id="S3.SS3.p1.1.m1.2.2.1.1.2.3" xref="S3.SS3.p1.1.m1.2.2.1.1.2.3.cmml">1</mn></msup></mrow><mo id="S3.SS3.p1.1.m1.4.4.3.4" xref="S3.SS3.p1.1.m1.4.4.4.cmml">,</mo><mrow id="S3.SS3.p1.1.m1.3.3.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.cmml"><mo id="S3.SS3.p1.1.m1.3.3.2.2.1" rspace="0.167em" xref="S3.SS3.p1.1.m1.3.3.2.2.1.cmml">∇</mo><msup id="S3.SS3.p1.1.m1.3.3.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.3.3.2.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.cmml">ℒ</mi><mn id="S3.SS3.p1.1.m1.3.3.2.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msup></mrow><mo id="S3.SS3.p1.1.m1.4.4.3.5" xref="S3.SS3.p1.1.m1.4.4.4.cmml">,</mo><mi id="S3.SS3.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS3.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p1.1.m1.4.4.3.6" xref="S3.SS3.p1.1.m1.4.4.4.cmml">,</mo><mrow id="S3.SS3.p1.1.m1.4.4.3.3" xref="S3.SS3.p1.1.m1.4.4.3.3.cmml"><mo id="S3.SS3.p1.1.m1.4.4.3.3.1" rspace="0.167em" xref="S3.SS3.p1.1.m1.4.4.3.3.1.cmml">∇</mo><msup id="S3.SS3.p1.1.m1.4.4.3.3.2" xref="S3.SS3.p1.1.m1.4.4.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.4.4.3.3.2.2" xref="S3.SS3.p1.1.m1.4.4.3.3.2.2.cmml">ℒ</mi><mi id="S3.SS3.p1.1.m1.4.4.3.3.2.3" xref="S3.SS3.p1.1.m1.4.4.3.3.2.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.4b"><list id="S3.SS3.p1.1.m1.4.4.4.cmml" xref="S3.SS3.p1.1.m1.4.4.3"><apply id="S3.SS3.p1.1.m1.2.2.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1"><ci id="S3.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">∇</ci><apply id="S3.SS3.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.2">superscript</csymbol><ci id="S3.SS3.p1.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.2.2">ℒ</ci><cn id="S3.SS3.p1.1.m1.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS3.p1.1.m1.2.2.1.1.2.3">1</cn></apply></apply><apply id="S3.SS3.p1.1.m1.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2"><ci id="S3.SS3.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.1">∇</ci><apply id="S3.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2">ℒ</ci><cn id="S3.SS3.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3">2</cn></apply></apply><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">…</ci><apply id="S3.SS3.p1.1.m1.4.4.3.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3"><ci id="S3.SS3.p1.1.m1.4.4.3.3.1.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.1">∇</ci><apply id="S3.SS3.p1.1.m1.4.4.3.3.2.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.3.3.2.1.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.2">superscript</csymbol><ci id="S3.SS3.p1.1.m1.4.4.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.2.2">ℒ</ci><ci id="S3.SS3.p1.1.m1.4.4.3.3.2.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.2.3">𝑘</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.4c">\nabla\mathcal{L}^{1},\nabla\mathcal{L}^{2},...,\nabla\mathcal{L}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.4d">∇ caligraphic_L start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , ∇ caligraphic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , ∇ caligraphic_L start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>.
This discrepancy can stem from various factors, such as differences in model structure, depth, and feature dimensionality.
Furthermore, if there are additional optimization targets, a hyperparameter search becomes necessary.
The varying magnitudes in these gradients could potentially lead to the neglect of one side or hinder convergence.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">To address this, we propose the gradient balance module as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">2</span></a>, which sets up an accumulator to store the size of the gradient from each optimization target. The accumulator <math alttext="\mathcal{A}=\left\{a_{1},a_{2},...,a_{k}\right\}\in\mathbb{R}^{k}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.4"><semantics id="S3.SS3.p2.1.m1.4a"><mrow id="S3.SS3.p2.1.m1.4.4" xref="S3.SS3.p2.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.4.4.5" xref="S3.SS3.p2.1.m1.4.4.5.cmml">𝒜</mi><mo id="S3.SS3.p2.1.m1.4.4.6" xref="S3.SS3.p2.1.m1.4.4.6.cmml">=</mo><mrow id="S3.SS3.p2.1.m1.4.4.3.3" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml"><mo id="S3.SS3.p2.1.m1.4.4.3.3.4" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml">a</mi><mn id="S3.SS3.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p2.1.m1.4.4.3.3.5" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p2.1.m1.3.3.2.2.2" xref="S3.SS3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.p2.1.m1.3.3.2.2.2.2" xref="S3.SS3.p2.1.m1.3.3.2.2.2.2.cmml">a</mi><mn id="S3.SS3.p2.1.m1.3.3.2.2.2.3" xref="S3.SS3.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p2.1.m1.4.4.3.3.6" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS3.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS3.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p2.1.m1.4.4.3.3.7" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p2.1.m1.4.4.3.3.3" xref="S3.SS3.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.p2.1.m1.4.4.3.3.3.2" xref="S3.SS3.p2.1.m1.4.4.3.3.3.2.cmml">a</mi><mi id="S3.SS3.p2.1.m1.4.4.3.3.3.3" xref="S3.SS3.p2.1.m1.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S3.SS3.p2.1.m1.4.4.3.3.8" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">}</mo></mrow><mo id="S3.SS3.p2.1.m1.4.4.7" xref="S3.SS3.p2.1.m1.4.4.7.cmml">∈</mo><msup id="S3.SS3.p2.1.m1.4.4.8" xref="S3.SS3.p2.1.m1.4.4.8.cmml"><mi id="S3.SS3.p2.1.m1.4.4.8.2" xref="S3.SS3.p2.1.m1.4.4.8.2.cmml">ℝ</mi><mi id="S3.SS3.p2.1.m1.4.4.8.3" xref="S3.SS3.p2.1.m1.4.4.8.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.4b"><apply id="S3.SS3.p2.1.m1.4.4.cmml" xref="S3.SS3.p2.1.m1.4.4"><and id="S3.SS3.p2.1.m1.4.4a.cmml" xref="S3.SS3.p2.1.m1.4.4"></and><apply id="S3.SS3.p2.1.m1.4.4b.cmml" xref="S3.SS3.p2.1.m1.4.4"><eq id="S3.SS3.p2.1.m1.4.4.6.cmml" xref="S3.SS3.p2.1.m1.4.4.6"></eq><ci id="S3.SS3.p2.1.m1.4.4.5.cmml" xref="S3.SS3.p2.1.m1.4.4.5">𝒜</ci><set id="S3.SS3.p2.1.m1.4.4.3.4.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3"><apply id="S3.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2">𝑎</ci><cn id="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2.2">𝑎</ci><cn id="S3.SS3.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">…</ci><apply id="S3.SS3.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3.3.2">𝑎</ci><ci id="S3.SS3.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3.3.3">𝑘</ci></apply></set></apply><apply id="S3.SS3.p2.1.m1.4.4c.cmml" xref="S3.SS3.p2.1.m1.4.4"><in id="S3.SS3.p2.1.m1.4.4.7.cmml" xref="S3.SS3.p2.1.m1.4.4.7"></in><share href="https://arxiv.org/html/2409.14538v1#S3.SS3.p2.1.m1.4.4.3.cmml" id="S3.SS3.p2.1.m1.4.4d.cmml" xref="S3.SS3.p2.1.m1.4.4"></share><apply id="S3.SS3.p2.1.m1.4.4.8.cmml" xref="S3.SS3.p2.1.m1.4.4.8"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.4.4.8.1.cmml" xref="S3.SS3.p2.1.m1.4.4.8">superscript</csymbol><ci id="S3.SS3.p2.1.m1.4.4.8.2.cmml" xref="S3.SS3.p2.1.m1.4.4.8.2">ℝ</ci><ci id="S3.SS3.p2.1.m1.4.4.8.3.cmml" xref="S3.SS3.p2.1.m1.4.4.8.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.4c">\mathcal{A}=\left\{a_{1},a_{2},...,a_{k}\right\}\in\mathbb{R}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.4d">caligraphic_A = { italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } ∈ blackboard_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> is expressed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx4">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{A}=\left[\sum_{s=1}^{S}\max\left(\left|\nabla\mathcal{L}%
^{1}(s)\right|\right),\sum_{s=1}^{S}\max\left(\left|\nabla\mathcal{L}^{2}(s)%
\right|\right),...,\sum_{s=1}^{S}\max\left(\left|\nabla\mathcal{L}^{k}(s)%
\right|\right)\right]," class="ltx_Math" display="inline" id="S3.E4.m1.8"><semantics id="S3.E4.m1.8a"><mrow id="S3.E4.m1.8.8.1" xref="S3.E4.m1.8.8.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1" xref="S3.E4.m1.8.8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.8.8.1.1.5" xref="S3.E4.m1.8.8.1.1.5.cmml">𝒜</mi><mo id="S3.E4.m1.8.8.1.1.4" xref="S3.E4.m1.8.8.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.8.8.1.1.3.3" xref="S3.E4.m1.8.8.1.1.3.4.cmml"><mo id="S3.E4.m1.8.8.1.1.3.3.4" xref="S3.E4.m1.8.8.1.1.3.4.cmml">[</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E4.m1.8.8.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.2.cmml"><munderover id="S3.E4.m1.8.8.1.1.1.1.1.2a" xref="S3.E4.m1.8.8.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.2.2.3" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.1" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.8.8.1.1.1.1.1.2.3" xref="S3.E4.m1.8.8.1.1.1.1.1.2.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">max</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1a" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.1" rspace="0.167em" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">∇</mo><msup id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mn id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">1</mn></msup></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">s</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.3.3.5" xref="S3.E4.m1.8.8.1.1.3.4.cmml">,</mo><mrow id="S3.E4.m1.8.8.1.1.2.2.2" xref="S3.E4.m1.8.8.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E4.m1.8.8.1.1.2.2.2.2" xref="S3.E4.m1.8.8.1.1.2.2.2.2.cmml"><munderover id="S3.E4.m1.8.8.1.1.2.2.2.2a" xref="S3.E4.m1.8.8.1.1.2.2.2.2.cmml"><mo id="S3.E4.m1.8.8.1.1.2.2.2.2.2.2" movablelimits="false" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.8.8.1.1.2.2.2.2.2.3" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.2" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.2.cmml">s</mi><mo id="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.1" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.3" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.8.8.1.1.2.2.2.2.3" xref="S3.E4.m1.8.8.1.1.2.2.2.2.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E4.m1.8.8.1.1.2.2.2.1.1" xref="S3.E4.m1.8.8.1.1.2.2.2.1.2.cmml"><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">max</mi><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1a" xref="S3.E4.m1.8.8.1.1.2.2.2.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1" xref="S3.E4.m1.8.8.1.1.2.2.2.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.2" xref="S3.E4.m1.8.8.1.1.2.2.2.1.2.cmml">(</mo><mrow id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.1" rspace="0.167em" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.1.cmml">∇</mo><msup id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mn id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.3.cmml">2</mn></msup></mrow><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">s</mi><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.3" xref="S3.E4.m1.8.8.1.1.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.3.3.6" xref="S3.E4.m1.8.8.1.1.3.4.cmml">,</mo><mi id="S3.E4.m1.7.7" mathvariant="normal" xref="S3.E4.m1.7.7.cmml">…</mi><mo id="S3.E4.m1.8.8.1.1.3.3.7" xref="S3.E4.m1.8.8.1.1.3.4.cmml">,</mo><mrow id="S3.E4.m1.8.8.1.1.3.3.3" xref="S3.E4.m1.8.8.1.1.3.3.3.cmml"><mstyle displaystyle="true" id="S3.E4.m1.8.8.1.1.3.3.3.2" xref="S3.E4.m1.8.8.1.1.3.3.3.2.cmml"><munderover id="S3.E4.m1.8.8.1.1.3.3.3.2a" xref="S3.E4.m1.8.8.1.1.3.3.3.2.cmml"><mo id="S3.E4.m1.8.8.1.1.3.3.3.2.2.2" movablelimits="false" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.8.8.1.1.3.3.3.2.2.3" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.cmml"><mi id="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.2" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.2.cmml">s</mi><mo id="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.1" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.3" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.8.8.1.1.3.3.3.2.3" xref="S3.E4.m1.8.8.1.1.3.3.3.2.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E4.m1.8.8.1.1.3.3.3.1.1" xref="S3.E4.m1.8.8.1.1.3.3.3.1.2.cmml"><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">max</mi><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1a" xref="S3.E4.m1.8.8.1.1.3.3.3.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1" xref="S3.E4.m1.8.8.1.1.3.3.3.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.2" xref="S3.E4.m1.8.8.1.1.3.3.3.1.2.cmml">(</mo><mrow id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.1" rspace="0.167em" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.1.cmml">∇</mo><msup id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.3.cmml">k</mi></msup></mrow><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">s</mi><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.3" xref="S3.E4.m1.8.8.1.1.3.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.3.3.8" xref="S3.E4.m1.8.8.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.8.8.1.2" xref="S3.E4.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.8b"><apply id="S3.E4.m1.8.8.1.1.cmml" xref="S3.E4.m1.8.8.1"><eq id="S3.E4.m1.8.8.1.1.4.cmml" xref="S3.E4.m1.8.8.1.1.4"></eq><ci id="S3.E4.m1.8.8.1.1.5.cmml" xref="S3.E4.m1.8.8.1.1.5">𝒜</ci><list id="S3.E4.m1.8.8.1.1.3.4.cmml" xref="S3.E4.m1.8.8.1.1.3.3"><apply id="S3.E4.m1.8.8.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1"><apply id="S3.E4.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.8.8.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.8.8.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.3"><eq id="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.2">𝑠</ci><cn id="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.8.8.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.8.8.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.2.3">𝑆</ci></apply><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1"><max id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"></max><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1"><abs id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.1">∇</ci><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.2">ℒ</ci><cn id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.2.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑠</ci></apply></apply></apply></apply><apply id="S3.E4.m1.8.8.1.1.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2"><apply id="S3.E4.m1.8.8.1.1.2.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E4.m1.8.8.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2">subscript</csymbol><sum id="S3.E4.m1.8.8.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.2"></sum><apply id="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.3"><eq id="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.1"></eq><ci id="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.2">𝑠</ci><cn id="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.8.8.1.1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.8.8.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.2.3">𝑆</ci></apply><apply id="S3.E4.m1.8.8.1.1.2.2.2.1.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1"><max id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"></max><apply id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1"><abs id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.2"></abs><apply id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1"><times id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2"><ci id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.1">∇</ci><apply id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.2">ℒ</ci><cn id="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.E4.m1.8.8.1.1.2.2.2.1.1.1.1.1.1.2.2.3">2</cn></apply></apply><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝑠</ci></apply></apply></apply></apply><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">…</ci><apply id="S3.E4.m1.8.8.1.1.3.3.3.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3"><apply id="S3.E4.m1.8.8.1.1.3.3.3.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.3.3.3.2.1.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2">superscript</csymbol><apply id="S3.E4.m1.8.8.1.1.3.3.3.2.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.3.3.3.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2">subscript</csymbol><sum id="S3.E4.m1.8.8.1.1.3.3.3.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.2"></sum><apply id="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.3"><eq id="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.1.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.1"></eq><ci id="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.2">𝑠</ci><cn id="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.8.8.1.1.3.3.3.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.8.8.1.1.3.3.3.2.3.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.2.3">𝑆</ci></apply><apply id="S3.E4.m1.8.8.1.1.3.3.3.1.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1"><max id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"></max><apply id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1"><abs id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.2"></abs><apply id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1"><times id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.1"></times><apply id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2"><ci id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.1">∇</ci><apply id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.2">ℒ</ci><ci id="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.8.8.1.1.3.3.3.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></apply><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">𝑠</ci></apply></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.8c">\displaystyle\mathcal{A}=\left[\sum_{s=1}^{S}\max\left(\left|\nabla\mathcal{L}%
^{1}(s)\right|\right),\sum_{s=1}^{S}\max\left(\left|\nabla\mathcal{L}^{2}(s)%
\right|\right),...,\sum_{s=1}^{S}\max\left(\left|\nabla\mathcal{L}^{k}(s)%
\right|\right)\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.8d">caligraphic_A = [ ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT roman_max ( | ∇ caligraphic_L start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ( italic_s ) | ) , ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT roman_max ( | ∇ caligraphic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_s ) | ) , … , ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT roman_max ( | ∇ caligraphic_L start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( italic_s ) | ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.5">where <math alttext="S" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m1.1"><semantics id="S3.SS3.p2.2.m1.1a"><mi id="S3.SS3.p2.2.m1.1.1" xref="S3.SS3.p2.2.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m1.1b"><ci id="S3.SS3.p2.2.m1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m1.1d">italic_S</annotation></semantics></math> represents the total number of optimization steps, an aforementioned <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m2.1"><semantics id="S3.SS3.p2.3.m2.1a"><mi id="S3.SS3.p2.3.m2.1.1" xref="S3.SS3.p2.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m2.1b"><ci id="S3.SS3.p2.3.m2.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m2.1d">italic_k</annotation></semantics></math> is the number of the optimization targets, <math alttext="\mathrm{max}\left(\cdot\right)" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m3.1"><semantics id="S3.SS3.p2.4.m3.1a"><mrow id="S3.SS3.p2.4.m3.1.2" xref="S3.SS3.p2.4.m3.1.2.cmml"><mi id="S3.SS3.p2.4.m3.1.2.2" xref="S3.SS3.p2.4.m3.1.2.2.cmml">max</mi><mo id="S3.SS3.p2.4.m3.1.2.1" xref="S3.SS3.p2.4.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m3.1.2.3.2" xref="S3.SS3.p2.4.m3.1.2.cmml"><mo id="S3.SS3.p2.4.m3.1.2.3.2.1" xref="S3.SS3.p2.4.m3.1.2.cmml">(</mo><mo id="S3.SS3.p2.4.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p2.4.m3.1.1.cmml">⋅</mo><mo id="S3.SS3.p2.4.m3.1.2.3.2.2" xref="S3.SS3.p2.4.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m3.1b"><apply id="S3.SS3.p2.4.m3.1.2.cmml" xref="S3.SS3.p2.4.m3.1.2"><times id="S3.SS3.p2.4.m3.1.2.1.cmml" xref="S3.SS3.p2.4.m3.1.2.1"></times><ci id="S3.SS3.p2.4.m3.1.2.2.cmml" xref="S3.SS3.p2.4.m3.1.2.2">max</ci><ci id="S3.SS3.p2.4.m3.1.1.cmml" xref="S3.SS3.p2.4.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m3.1c">\mathrm{max}\left(\cdot\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m3.1d">roman_max ( ⋅ )</annotation></semantics></math> represents the maximum scalar value in a given tensor, and there are <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m4.1"><semantics id="S3.SS3.p2.5.m4.1a"><mi id="S3.SS3.p2.5.m4.1.1" xref="S3.SS3.p2.5.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m4.1b"><ci id="S3.SS3.p2.5.m4.1.1.cmml" xref="S3.SS3.p2.5.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m4.1d">italic_k</annotation></semantics></math> optimization targets. During the optimization, the reciprocal of the normalized accumulator is multiplied to ensure a similar gradient amplitude for each element:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx5">
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{S}=\arg\underset{\mathcal{S}}{\mathrm{min}}\left\{\left[%
\mathcal{L}^{1},\mathcal{L}^{2},...,\mathcal{L}^{k}\right]\cdot\min(\mathcal{A%
})\mathcal{A}^{\mathrm{R}}\right\}," class="ltx_Math" display="inline" id="S3.E5.m1.4"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.4.1" xref="S3.E5.m1.4.4.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.1.1.3" xref="S3.E5.m1.4.4.1.1.3.cmml">𝒮</mi><mo id="S3.E5.m1.4.4.1.1.2" xref="S3.E5.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.3.cmml"><mi id="S3.E5.m1.4.4.1.1.1.3.1" xref="S3.E5.m1.4.4.1.1.1.3.1.cmml">arg</mi><mo id="S3.E5.m1.4.4.1.1.1.3a" lspace="0.167em" xref="S3.E5.m1.4.4.1.1.1.3.cmml">⁡</mo><munder accentunder="true" id="S3.E5.m1.4.4.1.1.1.3.2" xref="S3.E5.m1.4.4.1.1.1.3.2.cmml"><mi id="S3.E5.m1.4.4.1.1.1.3.2.2" xref="S3.E5.m1.4.4.1.1.1.3.2.2.cmml">min</mi><mo class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.1.1.1.3.2.1" xref="S3.E5.m1.4.4.1.1.1.3.2.1.cmml">𝒮</mo></munder></mrow><mo id="S3.E5.m1.4.4.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.2.cmml"><mo id="S3.E5.m1.4.4.1.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.2.cmml">{</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.cmml"><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.4.cmml"><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.4" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.4.cmml">[</mo><msup id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">ℒ</mi><mn id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.5" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml">ℒ</mi><mn id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml">2</mn></msup><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.6" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.4.cmml">,</mo><mi id="S3.E5.m1.1.1" mathvariant="normal" xref="S3.E5.m1.1.1.cmml">…</mi><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.7" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.2.cmml">ℒ</mi><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.3.cmml">k</mi></msup><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.8" rspace="0.055em" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.4.cmml">]</mo></mrow><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.4" rspace="0.222em" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.4.cmml">⋅</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.1.cmml"><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">min</mi><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.2a" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.1.cmml">⁡</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.2.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.1.cmml"><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.2.1.1" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">𝒜</mi><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.2.1.2" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.4" xref="S3.E5.m1.4.4.1.1.1.1.1.1.4.cmml">⁢</mo><msup id="S3.E5.m1.4.4.1.1.1.1.1.1.5" xref="S3.E5.m1.4.4.1.1.1.1.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.1.1.1.1.1.1.5.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.5.2.cmml">𝒜</mi><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.5.3" mathvariant="normal" xref="S3.E5.m1.4.4.1.1.1.1.1.1.5.3.cmml">R</mi></msup></mrow><mo id="S3.E5.m1.4.4.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E5.m1.4.4.1.2" xref="S3.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1"><eq id="S3.E5.m1.4.4.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.2"></eq><ci id="S3.E5.m1.4.4.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.3">𝒮</ci><apply id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1"><times id="S3.E5.m1.4.4.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2"></times><apply id="S3.E5.m1.4.4.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3"><arg id="S3.E5.m1.4.4.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.1"></arg><apply id="S3.E5.m1.4.4.1.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2"><ci id="S3.E5.m1.4.4.1.1.1.3.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2.1">𝒮</ci><ci id="S3.E5.m1.4.4.1.1.1.3.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2.2">min</ci></apply></apply><set id="S3.E5.m1.4.4.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1"><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1"><times id="S3.E5.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.4"></times><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3"><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.3.4.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.4">⋅</ci><list id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3"><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">ℒ</ci><cn id="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.2">ℒ</ci><cn id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">…</ci><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3">superscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.2">ℒ</ci><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.3.3.3.3">𝑘</ci></apply></list><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.5.2"><min id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"></min><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝒜</ci></apply></apply><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.5.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.5.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.5">superscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.5.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.5.2">𝒜</ci><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.5.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.5.3">R</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\displaystyle\mathcal{S}=\arg\underset{\mathcal{S}}{\mathrm{min}}\left\{\left[%
\mathcal{L}^{1},\mathcal{L}^{2},...,\mathcal{L}^{k}\right]\cdot\min(\mathcal{A%
})\mathcal{A}^{\mathrm{R}}\right\},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.4d">caligraphic_S = roman_arg undercaligraphic_S start_ARG roman_min end_ARG { [ caligraphic_L start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , caligraphic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , caligraphic_L start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ] ⋅ roman_min ( caligraphic_A ) caligraphic_A start_POSTSUPERSCRIPT roman_R end_POSTSUPERSCRIPT } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.8">where <math alttext="\mathrm{min}\left(\cdot\right)" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m1.1"><semantics id="S3.SS3.p2.6.m1.1a"><mrow id="S3.SS3.p2.6.m1.1.2" xref="S3.SS3.p2.6.m1.1.2.cmml"><mi id="S3.SS3.p2.6.m1.1.2.2" xref="S3.SS3.p2.6.m1.1.2.2.cmml">min</mi><mo id="S3.SS3.p2.6.m1.1.2.1" xref="S3.SS3.p2.6.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.6.m1.1.2.3.2" xref="S3.SS3.p2.6.m1.1.2.cmml"><mo id="S3.SS3.p2.6.m1.1.2.3.2.1" xref="S3.SS3.p2.6.m1.1.2.cmml">(</mo><mo id="S3.SS3.p2.6.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p2.6.m1.1.1.cmml">⋅</mo><mo id="S3.SS3.p2.6.m1.1.2.3.2.2" xref="S3.SS3.p2.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m1.1b"><apply id="S3.SS3.p2.6.m1.1.2.cmml" xref="S3.SS3.p2.6.m1.1.2"><times id="S3.SS3.p2.6.m1.1.2.1.cmml" xref="S3.SS3.p2.6.m1.1.2.1"></times><ci id="S3.SS3.p2.6.m1.1.2.2.cmml" xref="S3.SS3.p2.6.m1.1.2.2">min</ci><ci id="S3.SS3.p2.6.m1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m1.1c">\mathrm{min}\left(\cdot\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m1.1d">roman_min ( ⋅ )</annotation></semantics></math> represents the minimum scalar value in a given tensor, <math alttext="\mathcal{A}^{\mathrm{R}}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m2.1"><semantics id="S3.SS3.p2.7.m2.1a"><msup id="S3.SS3.p2.7.m2.1.1" xref="S3.SS3.p2.7.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.7.m2.1.1.2" xref="S3.SS3.p2.7.m2.1.1.2.cmml">𝒜</mi><mi id="S3.SS3.p2.7.m2.1.1.3" mathvariant="normal" xref="S3.SS3.p2.7.m2.1.1.3.cmml">R</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m2.1b"><apply id="S3.SS3.p2.7.m2.1.1.cmml" xref="S3.SS3.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.1.1.1.cmml" xref="S3.SS3.p2.7.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.7.m2.1.1.2.cmml" xref="S3.SS3.p2.7.m2.1.1.2">𝒜</ci><ci id="S3.SS3.p2.7.m2.1.1.3.cmml" xref="S3.SS3.p2.7.m2.1.1.3">R</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m2.1c">\mathcal{A}^{\mathrm{R}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m2.1d">caligraphic_A start_POSTSUPERSCRIPT roman_R end_POSTSUPERSCRIPT</annotation></semantics></math> represents element-wise reciprocal of vector <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m3.1"><semantics id="S3.SS3.p2.8.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.8.m3.1.1" xref="S3.SS3.p2.8.m3.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m3.1b"><ci id="S3.SS3.p2.8.m3.1.1.cmml" xref="S3.SS3.p2.8.m3.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m3.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m3.1d">caligraphic_A</annotation></semantics></math>.
In our study, we utilize three distinct losses as optimization targets.
To address the imbalance between images in the update and prevent image collapse, we normalize the gradient of each synthetic image.
To manage the computational intensity associated with additional gradient computations, we apply an accumulation strategy once in a while, <span class="ltx_text ltx_font_italic" id="S3.SS3.p2.8.1">e.g.</span>, by sampling once every 10 steps.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Mutual Distillation with Spatial-Semantic Decomposition</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.E3" title="Equation 3 ‣ 3.2 Heterogeneous Model Dataset Condensation ‣ 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">3</span></a> designed to track the learning path of each model through the gradient matching.
However, if the meanings of the two features differ significantly, it impedes the effective learning of synthetic images and hinders their convergence.
To mitigate this, we propose a new mutual distillation loss that restricts the semantic divergence between the two models in training processes.
On top of that, since two different models vary in depth, dimensionality, and the number of features, effective distillation between them requires careful consideration.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">To address this challenge, we introduce a Spatial-Semantic Decomposition (SSD) to preserve the semantics of the features to the maximum extent possible.
It decomposes the features of a model into spatial and semantic parts and transforms them accordingly, allowing you to compare the semantics of two models with a linear projection.
We designate the features related to classification as semantic features, representing the entire image, and those characterizing each spatial location as spatial features.
As spatial features can be represented in an image-like form, features of varying sizes can be aligned using bilinear interpolation, simplifying the alignment process without requiring complex transformations.
For easy understanding, here we explain our proposed method using two example models below Vision Transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib8" title="">8</a>]</cite> and Convolutional Neural Network (CNN) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib26" title="">26</a>]</cite>. Note that two heterogeneous models can vary, not limited to them.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p3.1.1">ViT Architecture.</span> First, in the ViT architecture, we utilize a class token (CLS) attached to the front of input tokens as semantic features, and the other image tokens as spatial features. Given the feature from every layer of ViT in the dimension of <math alttext="\mathcal{F}_{\mathrm{ViT}}\in\mathbb{R}^{n\times(w_{\mathrm{ViT}}h_{\mathrm{%
ViT}}+1)\times d_{\mathrm{ViT}}}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mrow id="S3.SS4.p3.1.m1.1.2" xref="S3.SS4.p3.1.m1.1.2.cmml"><msub id="S3.SS4.p3.1.m1.1.2.2" xref="S3.SS4.p3.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.1.m1.1.2.2.2" xref="S3.SS4.p3.1.m1.1.2.2.2.cmml">ℱ</mi><mi id="S3.SS4.p3.1.m1.1.2.2.3" xref="S3.SS4.p3.1.m1.1.2.2.3.cmml">ViT</mi></msub><mo id="S3.SS4.p3.1.m1.1.2.1" xref="S3.SS4.p3.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS4.p3.1.m1.1.2.3" xref="S3.SS4.p3.1.m1.1.2.3.cmml"><mi id="S3.SS4.p3.1.m1.1.2.3.2" xref="S3.SS4.p3.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.1.m1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.1.3.cmml">n</mi><mo id="S3.SS4.p3.1.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.1.m1.1.1.1.2.cmml">×</mo><mrow id="S3.SS4.p3.1.m1.1.1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p3.1.m1.1.1.1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.2" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.2.cmml">w</mi><mi id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.3" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.3.cmml">ViT</mi></msub><mo id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.1" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.2" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mi id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.3" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.3.cmml">ViT</mi></msub></mrow><mo id="S3.SS4.p3.1.m1.1.1.1.1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p3.1.m1.1.1.1.1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p3.1.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p3.1.m1.1.1.1.2a" rspace="0.222em" xref="S3.SS4.p3.1.m1.1.1.1.2.cmml">×</mo><msub id="S3.SS4.p3.1.m1.1.1.1.4" xref="S3.SS4.p3.1.m1.1.1.1.4.cmml"><mi id="S3.SS4.p3.1.m1.1.1.1.4.2" xref="S3.SS4.p3.1.m1.1.1.1.4.2.cmml">d</mi><mi id="S3.SS4.p3.1.m1.1.1.1.4.3" xref="S3.SS4.p3.1.m1.1.1.1.4.3.cmml">ViT</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.2"><in id="S3.SS4.p3.1.m1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.2.1"></in><apply id="S3.SS4.p3.1.m1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.2.2.1.cmml" xref="S3.SS4.p3.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.2.2.2.cmml" xref="S3.SS4.p3.1.m1.1.2.2.2">ℱ</ci><ci id="S3.SS4.p3.1.m1.1.2.2.3.cmml" xref="S3.SS4.p3.1.m1.1.2.2.3">ViT</ci></apply><apply id="S3.SS4.p3.1.m1.1.2.3.cmml" xref="S3.SS4.p3.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.2.3.1.cmml" xref="S3.SS4.p3.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS4.p3.1.m1.1.2.3.2.cmml" xref="S3.SS4.p3.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1"><times id="S3.SS4.p3.1.m1.1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.1.2"></times><ci id="S3.SS4.p3.1.m1.1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.1.3">𝑛</ci><apply id="S3.SS4.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1"><plus id="S3.SS4.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2"><times id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.2">𝑤</ci><ci id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.2.3">ViT</ci></apply><apply id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.2">ℎ</ci><ci id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.3.3">ViT</ci></apply></apply><cn id="S3.SS4.p3.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS4.p3.1.m1.1.1.1.4.cmml" xref="S3.SS4.p3.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.4.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.4">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.1.4.2.cmml" xref="S3.SS4.p3.1.m1.1.1.1.4.2">𝑑</ci><ci id="S3.SS4.p3.1.m1.1.1.1.4.3.cmml" xref="S3.SS4.p3.1.m1.1.1.1.4.3">ViT</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\mathcal{F}_{\mathrm{ViT}}\in\mathbb{R}^{n\times(w_{\mathrm{ViT}}h_{\mathrm{%
ViT}}+1)\times d_{\mathrm{ViT}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × ( italic_w start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT + 1 ) × italic_d start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx6">
<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{\mathrm{ViT}}^{\mathrm{sementic}}" class="ltx_Math" display="inline" id="S3.Ex3.m1.1"><semantics id="S3.Ex3.m1.1a"><msubsup id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.1.1.2.2" xref="S3.Ex3.m1.1.1.2.2.cmml">ℱ</mi><mi id="S3.Ex3.m1.1.1.2.3" xref="S3.Ex3.m1.1.1.2.3.cmml">ViT</mi><mi id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml">sementic</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1">superscript</csymbol><apply id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1">subscript</csymbol><ci id="S3.Ex3.m1.1.1.2.2.cmml" xref="S3.Ex3.m1.1.1.2.2">ℱ</ci><ci id="S3.Ex3.m1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.2.3">ViT</ci></apply><ci id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3">sementic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle\mathcal{F}_{\mathrm{ViT}}^{\mathrm{sementic}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1d">caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_sementic end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{F}_{\mathrm{ViT}}\left[\,:,0,:\,\right]\;\;\in\mathbb{R%
}^{n\times 1\times d_{\mathrm{ViT}}}," class="ltx_Math" display="inline" id="S3.Ex3.m2.4"><semantics id="S3.Ex3.m2.4a"><mrow id="S3.Ex3.m2.4.4.1" xref="S3.Ex3.m2.4.4.1.1.cmml"><mrow id="S3.Ex3.m2.4.4.1.1" xref="S3.Ex3.m2.4.4.1.1.cmml"><mi id="S3.Ex3.m2.4.4.1.1.2" xref="S3.Ex3.m2.4.4.1.1.2.cmml"></mi><mo id="S3.Ex3.m2.4.4.1.1.3" xref="S3.Ex3.m2.4.4.1.1.3.cmml">=</mo><mrow id="S3.Ex3.m2.4.4.1.1.4" xref="S3.Ex3.m2.4.4.1.1.4.cmml"><msub id="S3.Ex3.m2.4.4.1.1.4.2" xref="S3.Ex3.m2.4.4.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m2.4.4.1.1.4.2.2" xref="S3.Ex3.m2.4.4.1.1.4.2.2.cmml">ℱ</mi><mi id="S3.Ex3.m2.4.4.1.1.4.2.3" xref="S3.Ex3.m2.4.4.1.1.4.2.3.cmml">ViT</mi></msub><mo id="S3.Ex3.m2.4.4.1.1.4.1" xref="S3.Ex3.m2.4.4.1.1.4.1.cmml">⁢</mo><mrow id="S3.Ex3.m2.4.4.1.1.4.3.2" xref="S3.Ex3.m2.4.4.1.1.4.3.1.cmml"><mo id="S3.Ex3.m2.4.4.1.1.4.3.2.1" rspace="0.170em" xref="S3.Ex3.m2.4.4.1.1.4.3.1.cmml">[</mo><mo id="S3.Ex3.m2.1.1" rspace="0em" xref="S3.Ex3.m2.1.1.cmml">:</mo><mo id="S3.Ex3.m2.4.4.1.1.4.3.2.2" xref="S3.Ex3.m2.4.4.1.1.4.3.1.cmml">,</mo><mn id="S3.Ex3.m2.2.2" xref="S3.Ex3.m2.2.2.cmml">0</mn><mo id="S3.Ex3.m2.4.4.1.1.4.3.2.3" xref="S3.Ex3.m2.4.4.1.1.4.3.1.cmml">,</mo><mo id="S3.Ex3.m2.3.3" xref="S3.Ex3.m2.3.3.cmml">:</mo><mo id="S3.Ex3.m2.4.4.1.1.4.3.2.4" rspace="0.560em" xref="S3.Ex3.m2.4.4.1.1.4.3.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex3.m2.4.4.1.1.5" xref="S3.Ex3.m2.4.4.1.1.5.cmml">∈</mo><msup id="S3.Ex3.m2.4.4.1.1.6" xref="S3.Ex3.m2.4.4.1.1.6.cmml"><mi id="S3.Ex3.m2.4.4.1.1.6.2" xref="S3.Ex3.m2.4.4.1.1.6.2.cmml">ℝ</mi><mrow id="S3.Ex3.m2.4.4.1.1.6.3" xref="S3.Ex3.m2.4.4.1.1.6.3.cmml"><mi id="S3.Ex3.m2.4.4.1.1.6.3.2" xref="S3.Ex3.m2.4.4.1.1.6.3.2.cmml">n</mi><mo id="S3.Ex3.m2.4.4.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex3.m2.4.4.1.1.6.3.1.cmml">×</mo><mn id="S3.Ex3.m2.4.4.1.1.6.3.3" xref="S3.Ex3.m2.4.4.1.1.6.3.3.cmml">1</mn><mo id="S3.Ex3.m2.4.4.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.Ex3.m2.4.4.1.1.6.3.1.cmml">×</mo><msub id="S3.Ex3.m2.4.4.1.1.6.3.4" xref="S3.Ex3.m2.4.4.1.1.6.3.4.cmml"><mi id="S3.Ex3.m2.4.4.1.1.6.3.4.2" xref="S3.Ex3.m2.4.4.1.1.6.3.4.2.cmml">d</mi><mi id="S3.Ex3.m2.4.4.1.1.6.3.4.3" xref="S3.Ex3.m2.4.4.1.1.6.3.4.3.cmml">ViT</mi></msub></mrow></msup></mrow><mo id="S3.Ex3.m2.4.4.1.2" xref="S3.Ex3.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m2.4b"><apply id="S3.Ex3.m2.4.4.1.1.cmml" xref="S3.Ex3.m2.4.4.1"><and id="S3.Ex3.m2.4.4.1.1a.cmml" xref="S3.Ex3.m2.4.4.1"></and><apply id="S3.Ex3.m2.4.4.1.1b.cmml" xref="S3.Ex3.m2.4.4.1"><eq id="S3.Ex3.m2.4.4.1.1.3.cmml" xref="S3.Ex3.m2.4.4.1.1.3"></eq><csymbol cd="latexml" id="S3.Ex3.m2.4.4.1.1.2.cmml" xref="S3.Ex3.m2.4.4.1.1.2">absent</csymbol><apply id="S3.Ex3.m2.4.4.1.1.4.cmml" xref="S3.Ex3.m2.4.4.1.1.4"><times id="S3.Ex3.m2.4.4.1.1.4.1.cmml" xref="S3.Ex3.m2.4.4.1.1.4.1"></times><apply id="S3.Ex3.m2.4.4.1.1.4.2.cmml" xref="S3.Ex3.m2.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S3.Ex3.m2.4.4.1.1.4.2.1.cmml" xref="S3.Ex3.m2.4.4.1.1.4.2">subscript</csymbol><ci id="S3.Ex3.m2.4.4.1.1.4.2.2.cmml" xref="S3.Ex3.m2.4.4.1.1.4.2.2">ℱ</ci><ci id="S3.Ex3.m2.4.4.1.1.4.2.3.cmml" xref="S3.Ex3.m2.4.4.1.1.4.2.3">ViT</ci></apply><list id="S3.Ex3.m2.4.4.1.1.4.3.1.cmml" xref="S3.Ex3.m2.4.4.1.1.4.3.2"><ci id="S3.Ex3.m2.1.1.cmml" xref="S3.Ex3.m2.1.1">:</ci><cn id="S3.Ex3.m2.2.2.cmml" type="integer" xref="S3.Ex3.m2.2.2">0</cn><ci id="S3.Ex3.m2.3.3.cmml" xref="S3.Ex3.m2.3.3">:</ci></list></apply></apply><apply id="S3.Ex3.m2.4.4.1.1c.cmml" xref="S3.Ex3.m2.4.4.1"><in id="S3.Ex3.m2.4.4.1.1.5.cmml" xref="S3.Ex3.m2.4.4.1.1.5"></in><share href="https://arxiv.org/html/2409.14538v1#S3.Ex3.m2.4.4.1.1.4.cmml" id="S3.Ex3.m2.4.4.1.1d.cmml" xref="S3.Ex3.m2.4.4.1"></share><apply id="S3.Ex3.m2.4.4.1.1.6.cmml" xref="S3.Ex3.m2.4.4.1.1.6"><csymbol cd="ambiguous" id="S3.Ex3.m2.4.4.1.1.6.1.cmml" xref="S3.Ex3.m2.4.4.1.1.6">superscript</csymbol><ci id="S3.Ex3.m2.4.4.1.1.6.2.cmml" xref="S3.Ex3.m2.4.4.1.1.6.2">ℝ</ci><apply id="S3.Ex3.m2.4.4.1.1.6.3.cmml" xref="S3.Ex3.m2.4.4.1.1.6.3"><times id="S3.Ex3.m2.4.4.1.1.6.3.1.cmml" xref="S3.Ex3.m2.4.4.1.1.6.3.1"></times><ci id="S3.Ex3.m2.4.4.1.1.6.3.2.cmml" xref="S3.Ex3.m2.4.4.1.1.6.3.2">𝑛</ci><cn id="S3.Ex3.m2.4.4.1.1.6.3.3.cmml" type="integer" xref="S3.Ex3.m2.4.4.1.1.6.3.3">1</cn><apply id="S3.Ex3.m2.4.4.1.1.6.3.4.cmml" xref="S3.Ex3.m2.4.4.1.1.6.3.4"><csymbol cd="ambiguous" id="S3.Ex3.m2.4.4.1.1.6.3.4.1.cmml" xref="S3.Ex3.m2.4.4.1.1.6.3.4">subscript</csymbol><ci id="S3.Ex3.m2.4.4.1.1.6.3.4.2.cmml" xref="S3.Ex3.m2.4.4.1.1.6.3.4.2">𝑑</ci><ci id="S3.Ex3.m2.4.4.1.1.6.3.4.3.cmml" xref="S3.Ex3.m2.4.4.1.1.6.3.4.3">ViT</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m2.4c">\displaystyle=\mathcal{F}_{\mathrm{ViT}}\left[\,:,0,:\,\right]\;\;\in\mathbb{R%
}^{n\times 1\times d_{\mathrm{ViT}}},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m2.4d">= caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT [ : , 0 , : ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × 1 × italic_d start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{\mathrm{ViT}}^{\mathrm{spatial}}" class="ltx_Math" display="inline" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><msubsup id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml">ℱ</mi><mi id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml">ViT</mi><mi id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">spatial</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">ℱ</ci><ci id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3">ViT</ci></apply><ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">spatial</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\mathcal{F}_{\mathrm{ViT}}^{\mathrm{spatial}}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_spatial end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{F}_{\mathrm{ViT}}\left[\,:,1:,:\,\right]\in\mathbb{R}^{%
n\times(w_{\mathrm{ViT}}\times h_{\mathrm{ViT}})\times d_{\mathrm{ViT}}}," class="ltx_math_unparsed" display="inline" id="S3.E6.m2.3"><semantics id="S3.E6.m2.3a"><mrow id="S3.E6.m2.3b"><mo id="S3.E6.m2.3.4">=</mo><msub id="S3.E6.m2.3.5"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m2.3.5.2">ℱ</mi><mi id="S3.E6.m2.3.5.3">ViT</mi></msub><mrow id="S3.E6.m2.3.6"><mo id="S3.E6.m2.3.6.1" rspace="0.170em">[</mo><mo id="S3.E6.m2.2.2" rspace="0em">:</mo><mo id="S3.E6.m2.3.6.2">,</mo><mn id="S3.E6.m2.3.3">1</mn><mo id="S3.E6.m2.3.6.3" lspace="0.278em" rspace="0em">:</mo><mo id="S3.E6.m2.3.6.4">,</mo><mo id="S3.E6.m2.3.6.5">:</mo><mo id="S3.E6.m2.3.6.6">]</mo></mrow><mo id="S3.E6.m2.3.7">∈</mo><msup id="S3.E6.m2.3.8"><mi id="S3.E6.m2.3.8.2">ℝ</mi><mrow id="S3.E6.m2.1.1.1"><mi id="S3.E6.m2.1.1.1.3">n</mi><mo id="S3.E6.m2.1.1.1.2" lspace="0.222em" rspace="0.222em">×</mo><mrow id="S3.E6.m2.1.1.1.1.1"><mo id="S3.E6.m2.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E6.m2.1.1.1.1.1.1"><msub id="S3.E6.m2.1.1.1.1.1.1.2"><mi id="S3.E6.m2.1.1.1.1.1.1.2.2">w</mi><mi id="S3.E6.m2.1.1.1.1.1.1.2.3">ViT</mi></msub><mo id="S3.E6.m2.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em">×</mo><msub id="S3.E6.m2.1.1.1.1.1.1.3"><mi id="S3.E6.m2.1.1.1.1.1.1.3.2">h</mi><mi id="S3.E6.m2.1.1.1.1.1.1.3.3">ViT</mi></msub></mrow><mo id="S3.E6.m2.1.1.1.1.1.3" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="S3.E6.m2.1.1.1.2a" rspace="0.222em">×</mo><msub id="S3.E6.m2.1.1.1.4"><mi id="S3.E6.m2.1.1.1.4.2">d</mi><mi id="S3.E6.m2.1.1.1.4.3">ViT</mi></msub></mrow></msup><mo id="S3.E6.m2.3.9">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E6.m2.3c">\displaystyle=\mathcal{F}_{\mathrm{ViT}}\left[\,:,1:,:\,\right]\in\mathbb{R}^{%
n\times(w_{\mathrm{ViT}}\times h_{\mathrm{ViT}})\times d_{\mathrm{ViT}}},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m2.3d">= caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT [ : , 1 : , : ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × ( italic_w start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT × italic_h start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT ) × italic_d start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p3.5">where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m1.1"><semantics id="S3.SS4.p3.2.m1.1a"><mi id="S3.SS4.p3.2.m1.1.1" xref="S3.SS4.p3.2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m1.1b"><ci id="S3.SS4.p3.2.m1.1.1.cmml" xref="S3.SS4.p3.2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m1.1d">italic_n</annotation></semantics></math> means the number of layers, <math alttext="w_{\mathrm{ViT}}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m2.1"><semantics id="S3.SS4.p3.3.m2.1a"><msub id="S3.SS4.p3.3.m2.1.1" xref="S3.SS4.p3.3.m2.1.1.cmml"><mi id="S3.SS4.p3.3.m2.1.1.2" xref="S3.SS4.p3.3.m2.1.1.2.cmml">w</mi><mi id="S3.SS4.p3.3.m2.1.1.3" xref="S3.SS4.p3.3.m2.1.1.3.cmml">ViT</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m2.1b"><apply id="S3.SS4.p3.3.m2.1.1.cmml" xref="S3.SS4.p3.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m2.1.1.1.cmml" xref="S3.SS4.p3.3.m2.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m2.1.1.2.cmml" xref="S3.SS4.p3.3.m2.1.1.2">𝑤</ci><ci id="S3.SS4.p3.3.m2.1.1.3.cmml" xref="S3.SS4.p3.3.m2.1.1.3">ViT</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m2.1c">w_{\mathrm{ViT}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m2.1d">italic_w start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h_{\mathrm{ViT}}" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m3.1"><semantics id="S3.SS4.p3.4.m3.1a"><msub id="S3.SS4.p3.4.m3.1.1" xref="S3.SS4.p3.4.m3.1.1.cmml"><mi id="S3.SS4.p3.4.m3.1.1.2" xref="S3.SS4.p3.4.m3.1.1.2.cmml">h</mi><mi id="S3.SS4.p3.4.m3.1.1.3" xref="S3.SS4.p3.4.m3.1.1.3.cmml">ViT</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m3.1b"><apply id="S3.SS4.p3.4.m3.1.1.cmml" xref="S3.SS4.p3.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m3.1.1.1.cmml" xref="S3.SS4.p3.4.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.4.m3.1.1.2.cmml" xref="S3.SS4.p3.4.m3.1.1.2">ℎ</ci><ci id="S3.SS4.p3.4.m3.1.1.3.cmml" xref="S3.SS4.p3.4.m3.1.1.3">ViT</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m3.1c">h_{\mathrm{ViT}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m3.1d">italic_h start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT</annotation></semantics></math> means the number of tokens generated by the ViT when it performs patch embedding to generate image tokens in the horizontal and vertical directions, respectively. The CLS token is attached to the front, and <math alttext="d_{\mathrm{ViT}}" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m4.1"><semantics id="S3.SS4.p3.5.m4.1a"><msub id="S3.SS4.p3.5.m4.1.1" xref="S3.SS4.p3.5.m4.1.1.cmml"><mi id="S3.SS4.p3.5.m4.1.1.2" xref="S3.SS4.p3.5.m4.1.1.2.cmml">d</mi><mi id="S3.SS4.p3.5.m4.1.1.3" xref="S3.SS4.p3.5.m4.1.1.3.cmml">ViT</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m4.1b"><apply id="S3.SS4.p3.5.m4.1.1.cmml" xref="S3.SS4.p3.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.5.m4.1.1.1.cmml" xref="S3.SS4.p3.5.m4.1.1">subscript</csymbol><ci id="S3.SS4.p3.5.m4.1.1.2.cmml" xref="S3.SS4.p3.5.m4.1.1.2">𝑑</ci><ci id="S3.SS4.p3.5.m4.1.1.3.cmml" xref="S3.SS4.p3.5.m4.1.1.3">ViT</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m4.1c">d_{\mathrm{ViT}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m4.1d">italic_d start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT</annotation></semantics></math> is the dimension of each token. Given the variations in the size of spatial features across layers and models, standardization is achieved through bilinear interpolation. To address differences in feature dimensionality, we apply a learnable affine transformation. The dimension-aligned feature is expressed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx7">
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{\mathrm{1}}=" class="ltx_Math" display="inline" id="S3.Ex4.m1.1"><semantics id="S3.Ex4.m1.1a"><mrow id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml"><msub id="S3.Ex4.m1.1.1.2" xref="S3.Ex4.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex4.m1.1.1.2.2" xref="S3.Ex4.m1.1.1.2.2.cmml">ℱ</mi><mn id="S3.Ex4.m1.1.1.2.3" xref="S3.Ex4.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.Ex4.m1.1.1.1" xref="S3.Ex4.m1.1.1.1.cmml">=</mo><mi id="S3.Ex4.m1.1.1.3" xref="S3.Ex4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.1b"><apply id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1"><eq id="S3.Ex4.m1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1"></eq><apply id="S3.Ex4.m1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.2.1.cmml" xref="S3.Ex4.m1.1.1.2">subscript</csymbol><ci id="S3.Ex4.m1.1.1.2.2.cmml" xref="S3.Ex4.m1.1.1.2.2">ℱ</ci><cn id="S3.Ex4.m1.1.1.2.3.cmml" type="integer" xref="S3.Ex4.m1.1.1.2.3">1</cn></apply><csymbol cd="latexml" id="S3.Ex4.m1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.1c">\displaystyle\mathcal{F}_{\mathrm{1}}=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.1d">caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\left[W_{1}^{1}\left[\mathcal{F}_{\mathrm{ViT}}^{\mathrm{sementic%
}}[1];\underset{w\times h}{\mathrm{I}}\left(\mathcal{F}_{\mathrm{ViT}}^{%
\mathrm{spatial}}[1]\right)\right]+\textbf{b}^{1}_{1};\right." class="ltx_math_unparsed" display="inline" id="S3.Ex4.m2.2"><semantics id="S3.Ex4.m2.2a"><mrow id="S3.Ex4.m2.2b"><mo id="S3.Ex4.m2.2.3">[</mo><msubsup id="S3.Ex4.m2.2.4"><mi id="S3.Ex4.m2.2.4.2.2">W</mi><mn id="S3.Ex4.m2.2.4.2.3">1</mn><mn id="S3.Ex4.m2.2.4.3">1</mn></msubsup><mrow id="S3.Ex4.m2.2.5"><mo id="S3.Ex4.m2.2.5.1">[</mo><msubsup id="S3.Ex4.m2.2.5.2"><mi class="ltx_font_mathcaligraphic" id="S3.Ex4.m2.2.5.2.2.2">ℱ</mi><mi id="S3.Ex4.m2.2.5.2.2.3">ViT</mi><mi id="S3.Ex4.m2.2.5.2.3">sementic</mi></msubsup><mrow id="S3.Ex4.m2.2.5.3"><mo id="S3.Ex4.m2.2.5.3.1" stretchy="false">[</mo><mn id="S3.Ex4.m2.1.1">1</mn><mo id="S3.Ex4.m2.2.5.3.2" stretchy="false">]</mo></mrow><mo id="S3.Ex4.m2.2.5.4">;</mo><munder accentunder="true" id="S3.Ex4.m2.2.5.5"><mi id="S3.Ex4.m2.2.5.5.2" mathvariant="normal">I</mi><mrow id="S3.Ex4.m2.2.5.5.1"><mi id="S3.Ex4.m2.2.5.5.1.2">w</mi><mo id="S3.Ex4.m2.2.5.5.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.Ex4.m2.2.5.5.1.3">h</mi></mrow></munder><mrow id="S3.Ex4.m2.2.5.6"><mo id="S3.Ex4.m2.2.5.6.1">(</mo><msubsup id="S3.Ex4.m2.2.5.6.2"><mi class="ltx_font_mathcaligraphic" id="S3.Ex4.m2.2.5.6.2.2.2">ℱ</mi><mi id="S3.Ex4.m2.2.5.6.2.2.3">ViT</mi><mi id="S3.Ex4.m2.2.5.6.2.3">spatial</mi></msubsup><mrow id="S3.Ex4.m2.2.5.6.3"><mo id="S3.Ex4.m2.2.5.6.3.1" stretchy="false">[</mo><mn id="S3.Ex4.m2.2.2">1</mn><mo id="S3.Ex4.m2.2.5.6.3.2" stretchy="false">]</mo></mrow><mo id="S3.Ex4.m2.2.5.6.4">)</mo></mrow><mo id="S3.Ex4.m2.2.5.7">]</mo></mrow><mo id="S3.Ex4.m2.2.6">+</mo><msubsup id="S3.Ex4.m2.2.7"><mtext class="ltx_mathvariant_bold" id="S3.Ex4.m2.2.7.2.2">b</mtext><mn id="S3.Ex4.m2.2.7.3">1</mn><mn id="S3.Ex4.m2.2.7.2.3">1</mn></msubsup><mo id="S3.Ex4.m2.2.8">;</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex4.m2.2c">\displaystyle\left[W_{1}^{1}\left[\mathcal{F}_{\mathrm{ViT}}^{\mathrm{sementic%
}}[1];\underset{w\times h}{\mathrm{I}}\left(\mathcal{F}_{\mathrm{ViT}}^{%
\mathrm{spatial}}[1]\right)\right]+\textbf{b}^{1}_{1};\right.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m2.2d">[ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT [ caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_sementic end_POSTSUPERSCRIPT [ 1 ] ; start_UNDERACCENT italic_w × italic_h end_UNDERACCENT start_ARG roman_I end_ARG ( caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_spatial end_POSTSUPERSCRIPT [ 1 ] ) ] + b start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ;</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\left....;W_{n}^{1}\left[\mathcal{F}_{\mathrm{ViT}}^{\mathrm{%
sementic}}[n];\underset{w\times h}{\mathrm{I}}\left(\mathcal{F}_{\mathrm{ViT}}%
^{\mathrm{spatial}}[n]\right)\right]+\textbf{b}^{1}_{n}\right]," class="ltx_math_unparsed" display="inline" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3b"><mi id="S3.E7.m1.3.3" mathvariant="normal">…</mi><mo id="S3.E7.m1.3.4">;</mo><msubsup id="S3.E7.m1.3.5"><mi id="S3.E7.m1.3.5.2.2">W</mi><mi id="S3.E7.m1.3.5.2.3">n</mi><mn id="S3.E7.m1.3.5.3">1</mn></msubsup><mrow id="S3.E7.m1.3.6"><mo id="S3.E7.m1.3.6.1">[</mo><msubsup id="S3.E7.m1.3.6.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.6.2.2.2">ℱ</mi><mi id="S3.E7.m1.3.6.2.2.3">ViT</mi><mi id="S3.E7.m1.3.6.2.3">sementic</mi></msubsup><mrow id="S3.E7.m1.3.6.3"><mo id="S3.E7.m1.3.6.3.1" stretchy="false">[</mo><mi id="S3.E7.m1.1.1">n</mi><mo id="S3.E7.m1.3.6.3.2" stretchy="false">]</mo></mrow><mo id="S3.E7.m1.3.6.4">;</mo><munder accentunder="true" id="S3.E7.m1.3.6.5"><mi id="S3.E7.m1.3.6.5.2" mathvariant="normal">I</mi><mrow id="S3.E7.m1.3.6.5.1"><mi id="S3.E7.m1.3.6.5.1.2">w</mi><mo id="S3.E7.m1.3.6.5.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.E7.m1.3.6.5.1.3">h</mi></mrow></munder><mrow id="S3.E7.m1.3.6.6"><mo id="S3.E7.m1.3.6.6.1">(</mo><msubsup id="S3.E7.m1.3.6.6.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.6.6.2.2.2">ℱ</mi><mi id="S3.E7.m1.3.6.6.2.2.3">ViT</mi><mi id="S3.E7.m1.3.6.6.2.3">spatial</mi></msubsup><mrow id="S3.E7.m1.3.6.6.3"><mo id="S3.E7.m1.3.6.6.3.1" stretchy="false">[</mo><mi id="S3.E7.m1.2.2">n</mi><mo id="S3.E7.m1.3.6.6.3.2" stretchy="false">]</mo></mrow><mo id="S3.E7.m1.3.6.6.4">)</mo></mrow><mo id="S3.E7.m1.3.6.7">]</mo></mrow><mo id="S3.E7.m1.3.7">+</mo><msubsup id="S3.E7.m1.3.8"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.3.8.2.2">b</mtext><mi id="S3.E7.m1.3.8.3">n</mi><mn id="S3.E7.m1.3.8.2.3">1</mn></msubsup><mo id="S3.E7.m1.3.9">]</mo><mo id="S3.E7.m1.3.10">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\displaystyle\left....;W_{n}^{1}\left[\mathcal{F}_{\mathrm{ViT}}^{\mathrm{%
sementic}}[n];\underset{w\times h}{\mathrm{I}}\left(\mathcal{F}_{\mathrm{ViT}}%
^{\mathrm{spatial}}[n]\right)\right]+\textbf{b}^{1}_{n}\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">… ; italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT [ caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_sementic end_POSTSUPERSCRIPT [ italic_n ] ; start_UNDERACCENT italic_w × italic_h end_UNDERACCENT start_ARG roman_I end_ARG ( caligraphic_F start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_spatial end_POSTSUPERSCRIPT [ italic_n ] ) ] + b start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p3.15">where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS4.p3.6.m1.1"><semantics id="S3.SS4.p3.6.m1.1a"><mi id="S3.SS4.p3.6.m1.1.1" xref="S3.SS4.p3.6.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m1.1b"><ci id="S3.SS4.p3.6.m1.1.1.cmml" xref="S3.SS4.p3.6.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.6.m1.1d">italic_n</annotation></semantics></math> is the number of layers in ViT, <math alttext="W^{1}_{1},...,W^{1}_{n}\in\mathbb{R}^{d\times{d}_{\mathrm{ViT}}}" class="ltx_Math" display="inline" id="S3.SS4.p3.7.m2.3"><semantics id="S3.SS4.p3.7.m2.3a"><mrow id="S3.SS4.p3.7.m2.3.3" xref="S3.SS4.p3.7.m2.3.3.cmml"><mrow id="S3.SS4.p3.7.m2.3.3.2.2" xref="S3.SS4.p3.7.m2.3.3.2.3.cmml"><msubsup id="S3.SS4.p3.7.m2.2.2.1.1.1" xref="S3.SS4.p3.7.m2.2.2.1.1.1.cmml"><mi id="S3.SS4.p3.7.m2.2.2.1.1.1.2.2" xref="S3.SS4.p3.7.m2.2.2.1.1.1.2.2.cmml">W</mi><mn id="S3.SS4.p3.7.m2.2.2.1.1.1.3" xref="S3.SS4.p3.7.m2.2.2.1.1.1.3.cmml">1</mn><mn id="S3.SS4.p3.7.m2.2.2.1.1.1.2.3" xref="S3.SS4.p3.7.m2.2.2.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.SS4.p3.7.m2.3.3.2.2.3" xref="S3.SS4.p3.7.m2.3.3.2.3.cmml">,</mo><mi id="S3.SS4.p3.7.m2.1.1" mathvariant="normal" xref="S3.SS4.p3.7.m2.1.1.cmml">…</mi><mo id="S3.SS4.p3.7.m2.3.3.2.2.4" xref="S3.SS4.p3.7.m2.3.3.2.3.cmml">,</mo><msubsup id="S3.SS4.p3.7.m2.3.3.2.2.2" xref="S3.SS4.p3.7.m2.3.3.2.2.2.cmml"><mi id="S3.SS4.p3.7.m2.3.3.2.2.2.2.2" xref="S3.SS4.p3.7.m2.3.3.2.2.2.2.2.cmml">W</mi><mi id="S3.SS4.p3.7.m2.3.3.2.2.2.3" xref="S3.SS4.p3.7.m2.3.3.2.2.2.3.cmml">n</mi><mn id="S3.SS4.p3.7.m2.3.3.2.2.2.2.3" xref="S3.SS4.p3.7.m2.3.3.2.2.2.2.3.cmml">1</mn></msubsup></mrow><mo id="S3.SS4.p3.7.m2.3.3.3" xref="S3.SS4.p3.7.m2.3.3.3.cmml">∈</mo><msup id="S3.SS4.p3.7.m2.3.3.4" xref="S3.SS4.p3.7.m2.3.3.4.cmml"><mi id="S3.SS4.p3.7.m2.3.3.4.2" xref="S3.SS4.p3.7.m2.3.3.4.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.7.m2.3.3.4.3" xref="S3.SS4.p3.7.m2.3.3.4.3.cmml"><mi id="S3.SS4.p3.7.m2.3.3.4.3.2" xref="S3.SS4.p3.7.m2.3.3.4.3.2.cmml">d</mi><mo id="S3.SS4.p3.7.m2.3.3.4.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.7.m2.3.3.4.3.1.cmml">×</mo><msub id="S3.SS4.p3.7.m2.3.3.4.3.3" xref="S3.SS4.p3.7.m2.3.3.4.3.3.cmml"><mi id="S3.SS4.p3.7.m2.3.3.4.3.3.2" xref="S3.SS4.p3.7.m2.3.3.4.3.3.2.cmml">d</mi><mi id="S3.SS4.p3.7.m2.3.3.4.3.3.3" xref="S3.SS4.p3.7.m2.3.3.4.3.3.3.cmml">ViT</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m2.3b"><apply id="S3.SS4.p3.7.m2.3.3.cmml" xref="S3.SS4.p3.7.m2.3.3"><in id="S3.SS4.p3.7.m2.3.3.3.cmml" xref="S3.SS4.p3.7.m2.3.3.3"></in><list id="S3.SS4.p3.7.m2.3.3.2.3.cmml" xref="S3.SS4.p3.7.m2.3.3.2.2"><apply id="S3.SS4.p3.7.m2.2.2.1.1.1.cmml" xref="S3.SS4.p3.7.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m2.2.2.1.1.1.1.cmml" xref="S3.SS4.p3.7.m2.2.2.1.1.1">subscript</csymbol><apply id="S3.SS4.p3.7.m2.2.2.1.1.1.2.cmml" xref="S3.SS4.p3.7.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS4.p3.7.m2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS4.p3.7.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS4.p3.7.m2.2.2.1.1.1.2.2">𝑊</ci><cn id="S3.SS4.p3.7.m2.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS4.p3.7.m2.2.2.1.1.1.2.3">1</cn></apply><cn id="S3.SS4.p3.7.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS4.p3.7.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS4.p3.7.m2.1.1.cmml" xref="S3.SS4.p3.7.m2.1.1">…</ci><apply id="S3.SS4.p3.7.m2.3.3.2.2.2.cmml" xref="S3.SS4.p3.7.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m2.3.3.2.2.2.1.cmml" xref="S3.SS4.p3.7.m2.3.3.2.2.2">subscript</csymbol><apply id="S3.SS4.p3.7.m2.3.3.2.2.2.2.cmml" xref="S3.SS4.p3.7.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS4.p3.7.m2.3.3.2.2.2">superscript</csymbol><ci id="S3.SS4.p3.7.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS4.p3.7.m2.3.3.2.2.2.2.2">𝑊</ci><cn id="S3.SS4.p3.7.m2.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p3.7.m2.3.3.2.2.2.2.3">1</cn></apply><ci id="S3.SS4.p3.7.m2.3.3.2.2.2.3.cmml" xref="S3.SS4.p3.7.m2.3.3.2.2.2.3">𝑛</ci></apply></list><apply id="S3.SS4.p3.7.m2.3.3.4.cmml" xref="S3.SS4.p3.7.m2.3.3.4"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m2.3.3.4.1.cmml" xref="S3.SS4.p3.7.m2.3.3.4">superscript</csymbol><ci id="S3.SS4.p3.7.m2.3.3.4.2.cmml" xref="S3.SS4.p3.7.m2.3.3.4.2">ℝ</ci><apply id="S3.SS4.p3.7.m2.3.3.4.3.cmml" xref="S3.SS4.p3.7.m2.3.3.4.3"><times id="S3.SS4.p3.7.m2.3.3.4.3.1.cmml" xref="S3.SS4.p3.7.m2.3.3.4.3.1"></times><ci id="S3.SS4.p3.7.m2.3.3.4.3.2.cmml" xref="S3.SS4.p3.7.m2.3.3.4.3.2">𝑑</ci><apply id="S3.SS4.p3.7.m2.3.3.4.3.3.cmml" xref="S3.SS4.p3.7.m2.3.3.4.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m2.3.3.4.3.3.1.cmml" xref="S3.SS4.p3.7.m2.3.3.4.3.3">subscript</csymbol><ci id="S3.SS4.p3.7.m2.3.3.4.3.3.2.cmml" xref="S3.SS4.p3.7.m2.3.3.4.3.3.2">𝑑</ci><ci id="S3.SS4.p3.7.m2.3.3.4.3.3.3.cmml" xref="S3.SS4.p3.7.m2.3.3.4.3.3.3">ViT</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m2.3c">W^{1}_{1},...,W^{1}_{n}\in\mathbb{R}^{d\times{d}_{\mathrm{ViT}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.7.m2.3d">italic_W start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_W start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT roman_ViT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\textbf{b}^{1}_{1},...,\textbf{b}^{1}_{n}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS4.p3.8.m3.3"><semantics id="S3.SS4.p3.8.m3.3a"><mrow id="S3.SS4.p3.8.m3.3.3" xref="S3.SS4.p3.8.m3.3.3.cmml"><mrow id="S3.SS4.p3.8.m3.3.3.2.2" xref="S3.SS4.p3.8.m3.3.3.2.3.cmml"><msubsup id="S3.SS4.p3.8.m3.2.2.1.1.1" xref="S3.SS4.p3.8.m3.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.8.m3.2.2.1.1.1.2.2" xref="S3.SS4.p3.8.m3.2.2.1.1.1.2.2a.cmml">b</mtext><mn id="S3.SS4.p3.8.m3.2.2.1.1.1.3" xref="S3.SS4.p3.8.m3.2.2.1.1.1.3.cmml">1</mn><mn id="S3.SS4.p3.8.m3.2.2.1.1.1.2.3" xref="S3.SS4.p3.8.m3.2.2.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.SS4.p3.8.m3.3.3.2.2.3" xref="S3.SS4.p3.8.m3.3.3.2.3.cmml">,</mo><mi id="S3.SS4.p3.8.m3.1.1" mathvariant="normal" xref="S3.SS4.p3.8.m3.1.1.cmml">…</mi><mo id="S3.SS4.p3.8.m3.3.3.2.2.4" xref="S3.SS4.p3.8.m3.3.3.2.3.cmml">,</mo><msubsup id="S3.SS4.p3.8.m3.3.3.2.2.2" xref="S3.SS4.p3.8.m3.3.3.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.8.m3.3.3.2.2.2.2.2" xref="S3.SS4.p3.8.m3.3.3.2.2.2.2.2a.cmml">b</mtext><mi id="S3.SS4.p3.8.m3.3.3.2.2.2.3" xref="S3.SS4.p3.8.m3.3.3.2.2.2.3.cmml">n</mi><mn id="S3.SS4.p3.8.m3.3.3.2.2.2.2.3" xref="S3.SS4.p3.8.m3.3.3.2.2.2.2.3.cmml">1</mn></msubsup></mrow><mo id="S3.SS4.p3.8.m3.3.3.3" xref="S3.SS4.p3.8.m3.3.3.3.cmml">∈</mo><msup id="S3.SS4.p3.8.m3.3.3.4" xref="S3.SS4.p3.8.m3.3.3.4.cmml"><mi id="S3.SS4.p3.8.m3.3.3.4.2" xref="S3.SS4.p3.8.m3.3.3.4.2.cmml">ℝ</mi><mi id="S3.SS4.p3.8.m3.3.3.4.3" xref="S3.SS4.p3.8.m3.3.3.4.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.8.m3.3b"><apply id="S3.SS4.p3.8.m3.3.3.cmml" xref="S3.SS4.p3.8.m3.3.3"><in id="S3.SS4.p3.8.m3.3.3.3.cmml" xref="S3.SS4.p3.8.m3.3.3.3"></in><list id="S3.SS4.p3.8.m3.3.3.2.3.cmml" xref="S3.SS4.p3.8.m3.3.3.2.2"><apply id="S3.SS4.p3.8.m3.2.2.1.1.1.cmml" xref="S3.SS4.p3.8.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m3.2.2.1.1.1.1.cmml" xref="S3.SS4.p3.8.m3.2.2.1.1.1">subscript</csymbol><apply id="S3.SS4.p3.8.m3.2.2.1.1.1.2.cmml" xref="S3.SS4.p3.8.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m3.2.2.1.1.1.2.1.cmml" xref="S3.SS4.p3.8.m3.2.2.1.1.1">superscript</csymbol><ci id="S3.SS4.p3.8.m3.2.2.1.1.1.2.2a.cmml" xref="S3.SS4.p3.8.m3.2.2.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.8.m3.2.2.1.1.1.2.2.cmml" xref="S3.SS4.p3.8.m3.2.2.1.1.1.2.2">b</mtext></ci><cn id="S3.SS4.p3.8.m3.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS4.p3.8.m3.2.2.1.1.1.2.3">1</cn></apply><cn id="S3.SS4.p3.8.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS4.p3.8.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS4.p3.8.m3.1.1.cmml" xref="S3.SS4.p3.8.m3.1.1">…</ci><apply id="S3.SS4.p3.8.m3.3.3.2.2.2.cmml" xref="S3.SS4.p3.8.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m3.3.3.2.2.2.1.cmml" xref="S3.SS4.p3.8.m3.3.3.2.2.2">subscript</csymbol><apply id="S3.SS4.p3.8.m3.3.3.2.2.2.2.cmml" xref="S3.SS4.p3.8.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m3.3.3.2.2.2.2.1.cmml" xref="S3.SS4.p3.8.m3.3.3.2.2.2">superscript</csymbol><ci id="S3.SS4.p3.8.m3.3.3.2.2.2.2.2a.cmml" xref="S3.SS4.p3.8.m3.3.3.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.8.m3.3.3.2.2.2.2.2.cmml" xref="S3.SS4.p3.8.m3.3.3.2.2.2.2.2">b</mtext></ci><cn id="S3.SS4.p3.8.m3.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p3.8.m3.3.3.2.2.2.2.3">1</cn></apply><ci id="S3.SS4.p3.8.m3.3.3.2.2.2.3.cmml" xref="S3.SS4.p3.8.m3.3.3.2.2.2.3">𝑛</ci></apply></list><apply id="S3.SS4.p3.8.m3.3.3.4.cmml" xref="S3.SS4.p3.8.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m3.3.3.4.1.cmml" xref="S3.SS4.p3.8.m3.3.3.4">superscript</csymbol><ci id="S3.SS4.p3.8.m3.3.3.4.2.cmml" xref="S3.SS4.p3.8.m3.3.3.4.2">ℝ</ci><ci id="S3.SS4.p3.8.m3.3.3.4.3.cmml" xref="S3.SS4.p3.8.m3.3.3.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.8.m3.3c">\textbf{b}^{1}_{1},...,\textbf{b}^{1}_{n}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.8.m3.3d">b start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , b start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\underset{w\times h}{\mathrm{I}}" class="ltx_Math" display="inline" id="S3.SS4.p3.9.m4.1"><semantics id="S3.SS4.p3.9.m4.1a"><munder accentunder="true" id="S3.SS4.p3.9.m4.1.1" xref="S3.SS4.p3.9.m4.1.1.cmml"><mi id="S3.SS4.p3.9.m4.1.1.2" mathvariant="normal" xref="S3.SS4.p3.9.m4.1.1.2.cmml">I</mi><mrow id="S3.SS4.p3.9.m4.1.1.1" xref="S3.SS4.p3.9.m4.1.1.1.cmml"><mi id="S3.SS4.p3.9.m4.1.1.1.2" xref="S3.SS4.p3.9.m4.1.1.1.2.cmml">w</mi><mo id="S3.SS4.p3.9.m4.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.9.m4.1.1.1.1.cmml">×</mo><mi id="S3.SS4.p3.9.m4.1.1.1.3" xref="S3.SS4.p3.9.m4.1.1.1.3.cmml">h</mi></mrow></munder><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.9.m4.1b"><apply id="S3.SS4.p3.9.m4.1.1.cmml" xref="S3.SS4.p3.9.m4.1.1"><apply id="S3.SS4.p3.9.m4.1.1.1.cmml" xref="S3.SS4.p3.9.m4.1.1.1"><times id="S3.SS4.p3.9.m4.1.1.1.1.cmml" xref="S3.SS4.p3.9.m4.1.1.1.1"></times><ci id="S3.SS4.p3.9.m4.1.1.1.2.cmml" xref="S3.SS4.p3.9.m4.1.1.1.2">𝑤</ci><ci id="S3.SS4.p3.9.m4.1.1.1.3.cmml" xref="S3.SS4.p3.9.m4.1.1.1.3">ℎ</ci></apply><ci id="S3.SS4.p3.9.m4.1.1.2.cmml" xref="S3.SS4.p3.9.m4.1.1.2">I</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.9.m4.1c">\underset{w\times h}{\mathrm{I}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.9.m4.1d">start_UNDERACCENT italic_w × italic_h end_UNDERACCENT start_ARG roman_I end_ARG</annotation></semantics></math> refers to bilinear interpolation into the size of <math alttext="w\times h" class="ltx_Math" display="inline" id="S3.SS4.p3.10.m5.1"><semantics id="S3.SS4.p3.10.m5.1a"><mrow id="S3.SS4.p3.10.m5.1.1" xref="S3.SS4.p3.10.m5.1.1.cmml"><mi id="S3.SS4.p3.10.m5.1.1.2" xref="S3.SS4.p3.10.m5.1.1.2.cmml">w</mi><mo id="S3.SS4.p3.10.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.10.m5.1.1.1.cmml">×</mo><mi id="S3.SS4.p3.10.m5.1.1.3" xref="S3.SS4.p3.10.m5.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.10.m5.1b"><apply id="S3.SS4.p3.10.m5.1.1.cmml" xref="S3.SS4.p3.10.m5.1.1"><times id="S3.SS4.p3.10.m5.1.1.1.cmml" xref="S3.SS4.p3.10.m5.1.1.1"></times><ci id="S3.SS4.p3.10.m5.1.1.2.cmml" xref="S3.SS4.p3.10.m5.1.1.2">𝑤</ci><ci id="S3.SS4.p3.10.m5.1.1.3.cmml" xref="S3.SS4.p3.10.m5.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.10.m5.1c">w\times h</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.10.m5.1d">italic_w × italic_h</annotation></semantics></math>.
As a result, we get the feature of <math alttext="\mathbb{R}^{n\times(wh+1)\times d}" class="ltx_Math" display="inline" id="S3.SS4.p3.11.m6.1"><semantics id="S3.SS4.p3.11.m6.1a"><msup id="S3.SS4.p3.11.m6.1.2" xref="S3.SS4.p3.11.m6.1.2.cmml"><mi id="S3.SS4.p3.11.m6.1.2.2" xref="S3.SS4.p3.11.m6.1.2.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.11.m6.1.1.1" xref="S3.SS4.p3.11.m6.1.1.1.cmml"><mi id="S3.SS4.p3.11.m6.1.1.1.3" xref="S3.SS4.p3.11.m6.1.1.1.3.cmml">n</mi><mo id="S3.SS4.p3.11.m6.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.11.m6.1.1.1.2.cmml">×</mo><mrow id="S3.SS4.p3.11.m6.1.1.1.1.1" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p3.11.m6.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p3.11.m6.1.1.1.1.1.1" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p3.11.m6.1.1.1.1.1.1.2" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.2" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.2.cmml">w</mi><mo id="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.1" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.3" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.3.cmml">h</mi></mrow><mo id="S3.SS4.p3.11.m6.1.1.1.1.1.1.1" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p3.11.m6.1.1.1.1.1.1.3" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p3.11.m6.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p3.11.m6.1.1.1.2a" rspace="0.222em" xref="S3.SS4.p3.11.m6.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p3.11.m6.1.1.1.4" xref="S3.SS4.p3.11.m6.1.1.1.4.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.11.m6.1b"><apply id="S3.SS4.p3.11.m6.1.2.cmml" xref="S3.SS4.p3.11.m6.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.11.m6.1.2.1.cmml" xref="S3.SS4.p3.11.m6.1.2">superscript</csymbol><ci id="S3.SS4.p3.11.m6.1.2.2.cmml" xref="S3.SS4.p3.11.m6.1.2.2">ℝ</ci><apply id="S3.SS4.p3.11.m6.1.1.1.cmml" xref="S3.SS4.p3.11.m6.1.1.1"><times id="S3.SS4.p3.11.m6.1.1.1.2.cmml" xref="S3.SS4.p3.11.m6.1.1.1.2"></times><ci id="S3.SS4.p3.11.m6.1.1.1.3.cmml" xref="S3.SS4.p3.11.m6.1.1.1.3">𝑛</ci><apply id="S3.SS4.p3.11.m6.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.11.m6.1.1.1.1.1"><plus id="S3.SS4.p3.11.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.2"><times id="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.p3.11.m6.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p3.11.m6.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS4.p3.11.m6.1.1.1.4.cmml" xref="S3.SS4.p3.11.m6.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.11.m6.1c">\mathbb{R}^{n\times(wh+1)\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.11.m6.1d">blackboard_R start_POSTSUPERSCRIPT italic_n × ( italic_w italic_h + 1 ) × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
<math alttext="w" class="ltx_Math" display="inline" id="S3.SS4.p3.12.m7.1"><semantics id="S3.SS4.p3.12.m7.1a"><mi id="S3.SS4.p3.12.m7.1.1" xref="S3.SS4.p3.12.m7.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.12.m7.1b"><ci id="S3.SS4.p3.12.m7.1.1.cmml" xref="S3.SS4.p3.12.m7.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.12.m7.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.12.m7.1d">italic_w</annotation></semantics></math>, <math alttext="h" class="ltx_Math" display="inline" id="S3.SS4.p3.13.m8.1"><semantics id="S3.SS4.p3.13.m8.1a"><mi id="S3.SS4.p3.13.m8.1.1" xref="S3.SS4.p3.13.m8.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.13.m8.1b"><ci id="S3.SS4.p3.13.m8.1.1.cmml" xref="S3.SS4.p3.13.m8.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.13.m8.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.13.m8.1d">italic_h</annotation></semantics></math>, and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS4.p3.14.m9.1"><semantics id="S3.SS4.p3.14.m9.1a"><mi id="S3.SS4.p3.14.m9.1.1" xref="S3.SS4.p3.14.m9.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.14.m9.1b"><ci id="S3.SS4.p3.14.m9.1.1.cmml" xref="S3.SS4.p3.14.m9.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.14.m9.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.14.m9.1d">italic_d</annotation></semantics></math> mean a target interpolation width, height, and dimension respectively. We use dimension and interpolation size into smaller values between two models, which is found to be empirically better.
For computational convenience, it is transposed to <math alttext="\mathbb{R}^{(wh+1)\times d\times n}" class="ltx_Math" display="inline" id="S3.SS4.p3.15.m10.1"><semantics id="S3.SS4.p3.15.m10.1a"><msup id="S3.SS4.p3.15.m10.1.2" xref="S3.SS4.p3.15.m10.1.2.cmml"><mi id="S3.SS4.p3.15.m10.1.2.2" xref="S3.SS4.p3.15.m10.1.2.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.15.m10.1.1.1" xref="S3.SS4.p3.15.m10.1.1.1.cmml"><mrow id="S3.SS4.p3.15.m10.1.1.1.1.1" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p3.15.m10.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p3.15.m10.1.1.1.1.1.1" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p3.15.m10.1.1.1.1.1.1.2" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.2" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.2.cmml">w</mi><mo id="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.1" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.3" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.3.cmml">h</mi></mrow><mo id="S3.SS4.p3.15.m10.1.1.1.1.1.1.1" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p3.15.m10.1.1.1.1.1.1.3" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p3.15.m10.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p3.15.m10.1.1.1.2" rspace="0.222em" xref="S3.SS4.p3.15.m10.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p3.15.m10.1.1.1.3" xref="S3.SS4.p3.15.m10.1.1.1.3.cmml">d</mi><mo id="S3.SS4.p3.15.m10.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.15.m10.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p3.15.m10.1.1.1.4" xref="S3.SS4.p3.15.m10.1.1.1.4.cmml">n</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.15.m10.1b"><apply id="S3.SS4.p3.15.m10.1.2.cmml" xref="S3.SS4.p3.15.m10.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.15.m10.1.2.1.cmml" xref="S3.SS4.p3.15.m10.1.2">superscript</csymbol><ci id="S3.SS4.p3.15.m10.1.2.2.cmml" xref="S3.SS4.p3.15.m10.1.2.2">ℝ</ci><apply id="S3.SS4.p3.15.m10.1.1.1.cmml" xref="S3.SS4.p3.15.m10.1.1.1"><times id="S3.SS4.p3.15.m10.1.1.1.2.cmml" xref="S3.SS4.p3.15.m10.1.1.1.2"></times><apply id="S3.SS4.p3.15.m10.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.15.m10.1.1.1.1.1"><plus id="S3.SS4.p3.15.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.2"><times id="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.p3.15.m10.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p3.15.m10.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS4.p3.15.m10.1.1.1.3.cmml" xref="S3.SS4.p3.15.m10.1.1.1.3">𝑑</ci><ci id="S3.SS4.p3.15.m10.1.1.1.4.cmml" xref="S3.SS4.p3.15.m10.1.1.1.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.15.m10.1c">\mathbb{R}^{(wh+1)\times d\times n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.15.m10.1d">blackboard_R start_POSTSUPERSCRIPT ( italic_w italic_h + 1 ) × italic_d × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>.

<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.5"><span class="ltx_text ltx_font_bold" id="S3.SS4.p4.5.1">CNN Architecture.</span> In the case of CNN features, inherently semantic features can be generated through mean pooling of spatial features. This process is mathematically expressed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx8">
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{\mathrm{CNN}}" class="ltx_Math" display="inline" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><msub id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">ℱ</mi><mi id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml">CNN</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2">ℱ</ci><ci id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3">CNN</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle\mathcal{F}_{\mathrm{CNN}}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\{\mathcal{F}_{\mathrm{CNN}}^{1},...,\mathcal{F}_{\mathrm{CNN}}^%
{m}\},\quad\mathcal{F}_{\mathrm{CNN}}^{l}\in\mathbb{R}^{d_{l}\times w_{l}%
\times h_{l}}." class="ltx_Math" display="inline" id="S3.E8.m2.2"><semantics id="S3.E8.m2.2a"><mrow id="S3.E8.m2.2.2.1"><mrow id="S3.E8.m2.2.2.1.1.2" xref="S3.E8.m2.2.2.1.1.3.cmml"><mrow id="S3.E8.m2.2.2.1.1.1.1" xref="S3.E8.m2.2.2.1.1.1.1.cmml"><mi id="S3.E8.m2.2.2.1.1.1.1.4" xref="S3.E8.m2.2.2.1.1.1.1.4.cmml"></mi><mo id="S3.E8.m2.2.2.1.1.1.1.3" xref="S3.E8.m2.2.2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E8.m2.2.2.1.1.1.1.2.2" xref="S3.E8.m2.2.2.1.1.1.1.2.3.cmml"><mo id="S3.E8.m2.2.2.1.1.1.1.2.2.3" stretchy="false" xref="S3.E8.m2.2.2.1.1.1.1.2.3.cmml">{</mo><msubsup id="S3.E8.m2.2.2.1.1.1.1.1.1.1" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">ℱ</mi><mi id="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">CNN</mi><mn id="S3.E8.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.E8.m2.2.2.1.1.1.1.2.2.4" xref="S3.E8.m2.2.2.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E8.m2.1.1" mathvariant="normal" xref="S3.E8.m2.1.1.cmml">…</mi><mo id="S3.E8.m2.2.2.1.1.1.1.2.2.5" xref="S3.E8.m2.2.2.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E8.m2.2.2.1.1.1.1.2.2.2" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.2" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.2.cmml">ℱ</mi><mi id="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.3" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.3.cmml">CNN</mi><mi id="S3.E8.m2.2.2.1.1.1.1.2.2.2.3" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2.3.cmml">m</mi></msubsup><mo id="S3.E8.m2.2.2.1.1.1.1.2.2.6" stretchy="false" xref="S3.E8.m2.2.2.1.1.1.1.2.3.cmml">}</mo></mrow></mrow><mo id="S3.E8.m2.2.2.1.1.2.3" rspace="1.167em" xref="S3.E8.m2.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E8.m2.2.2.1.1.2.2" xref="S3.E8.m2.2.2.1.1.2.2.cmml"><msubsup id="S3.E8.m2.2.2.1.1.2.2.2" xref="S3.E8.m2.2.2.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m2.2.2.1.1.2.2.2.2.2" xref="S3.E8.m2.2.2.1.1.2.2.2.2.2.cmml">ℱ</mi><mi id="S3.E8.m2.2.2.1.1.2.2.2.2.3" xref="S3.E8.m2.2.2.1.1.2.2.2.2.3.cmml">CNN</mi><mi id="S3.E8.m2.2.2.1.1.2.2.2.3" xref="S3.E8.m2.2.2.1.1.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.E8.m2.2.2.1.1.2.2.1" xref="S3.E8.m2.2.2.1.1.2.2.1.cmml">∈</mo><msup id="S3.E8.m2.2.2.1.1.2.2.3" xref="S3.E8.m2.2.2.1.1.2.2.3.cmml"><mi id="S3.E8.m2.2.2.1.1.2.2.3.2" xref="S3.E8.m2.2.2.1.1.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E8.m2.2.2.1.1.2.2.3.3" xref="S3.E8.m2.2.2.1.1.2.2.3.3.cmml"><msub id="S3.E8.m2.2.2.1.1.2.2.3.3.2" xref="S3.E8.m2.2.2.1.1.2.2.3.3.2.cmml"><mi id="S3.E8.m2.2.2.1.1.2.2.3.3.2.2" xref="S3.E8.m2.2.2.1.1.2.2.3.3.2.2.cmml">d</mi><mi id="S3.E8.m2.2.2.1.1.2.2.3.3.2.3" xref="S3.E8.m2.2.2.1.1.2.2.3.3.2.3.cmml">l</mi></msub><mo id="S3.E8.m2.2.2.1.1.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8.m2.2.2.1.1.2.2.3.3.1.cmml">×</mo><msub id="S3.E8.m2.2.2.1.1.2.2.3.3.3" xref="S3.E8.m2.2.2.1.1.2.2.3.3.3.cmml"><mi id="S3.E8.m2.2.2.1.1.2.2.3.3.3.2" xref="S3.E8.m2.2.2.1.1.2.2.3.3.3.2.cmml">w</mi><mi id="S3.E8.m2.2.2.1.1.2.2.3.3.3.3" xref="S3.E8.m2.2.2.1.1.2.2.3.3.3.3.cmml">l</mi></msub><mo id="S3.E8.m2.2.2.1.1.2.2.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.E8.m2.2.2.1.1.2.2.3.3.1.cmml">×</mo><msub id="S3.E8.m2.2.2.1.1.2.2.3.3.4" xref="S3.E8.m2.2.2.1.1.2.2.3.3.4.cmml"><mi id="S3.E8.m2.2.2.1.1.2.2.3.3.4.2" xref="S3.E8.m2.2.2.1.1.2.2.3.3.4.2.cmml">h</mi><mi id="S3.E8.m2.2.2.1.1.2.2.3.3.4.3" xref="S3.E8.m2.2.2.1.1.2.2.3.3.4.3.cmml">l</mi></msub></mrow></msup></mrow></mrow><mo id="S3.E8.m2.2.2.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.2b"><apply id="S3.E8.m2.2.2.1.1.3.cmml" xref="S3.E8.m2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.3a.cmml" xref="S3.E8.m2.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E8.m2.2.2.1.1.1.1.cmml" xref="S3.E8.m2.2.2.1.1.1.1"><eq id="S3.E8.m2.2.2.1.1.1.1.3.cmml" xref="S3.E8.m2.2.2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E8.m2.2.2.1.1.1.1.4.cmml" xref="S3.E8.m2.2.2.1.1.1.1.4">absent</csymbol><set id="S3.E8.m2.2.2.1.1.1.1.2.3.cmml" xref="S3.E8.m2.2.2.1.1.1.1.2.2"><apply id="S3.E8.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.2">ℱ</ci><ci id="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1.2.3">CNN</ci></apply><cn id="S3.E8.m2.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m2.2.2.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E8.m2.1.1.cmml" xref="S3.E8.m2.1.1">…</ci><apply id="S3.E8.m2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.2">ℱ</ci><ci id="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2.2.3">CNN</ci></apply><ci id="S3.E8.m2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E8.m2.2.2.1.1.1.1.2.2.2.3">𝑚</ci></apply></set></apply><apply id="S3.E8.m2.2.2.1.1.2.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2"><in id="S3.E8.m2.2.2.1.1.2.2.1.cmml" xref="S3.E8.m2.2.2.1.1.2.2.1"></in><apply id="S3.E8.m2.2.2.1.1.2.2.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.2.2.2.1.cmml" xref="S3.E8.m2.2.2.1.1.2.2.2">superscript</csymbol><apply id="S3.E8.m2.2.2.1.1.2.2.2.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E8.m2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E8.m2.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2.2.2.2">ℱ</ci><ci id="S3.E8.m2.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E8.m2.2.2.1.1.2.2.2.2.3">CNN</ci></apply><ci id="S3.E8.m2.2.2.1.1.2.2.2.3.cmml" xref="S3.E8.m2.2.2.1.1.2.2.2.3">𝑙</ci></apply><apply id="S3.E8.m2.2.2.1.1.2.2.3.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.2.2.3.1.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3">superscript</csymbol><ci id="S3.E8.m2.2.2.1.1.2.2.3.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.2">ℝ</ci><apply id="S3.E8.m2.2.2.1.1.2.2.3.3.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3"><times id="S3.E8.m2.2.2.1.1.2.2.3.3.1.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.1"></times><apply id="S3.E8.m2.2.2.1.1.2.2.3.3.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.2.2.3.3.2.1.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.2">subscript</csymbol><ci id="S3.E8.m2.2.2.1.1.2.2.3.3.2.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.2.2">𝑑</ci><ci id="S3.E8.m2.2.2.1.1.2.2.3.3.2.3.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.2.3">𝑙</ci></apply><apply id="S3.E8.m2.2.2.1.1.2.2.3.3.3.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.2.2.3.3.3.1.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.3">subscript</csymbol><ci id="S3.E8.m2.2.2.1.1.2.2.3.3.3.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.3.2">𝑤</ci><ci id="S3.E8.m2.2.2.1.1.2.2.3.3.3.3.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.3.3">𝑙</ci></apply><apply id="S3.E8.m2.2.2.1.1.2.2.3.3.4.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.4"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.1.1.2.2.3.3.4.1.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.4">subscript</csymbol><ci id="S3.E8.m2.2.2.1.1.2.2.3.3.4.2.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.4.2">ℎ</ci><ci id="S3.E8.m2.2.2.1.1.2.2.3.3.4.3.cmml" xref="S3.E8.m2.2.2.1.1.2.2.3.3.4.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.2c">\displaystyle=\{\mathcal{F}_{\mathrm{CNN}}^{1},...,\mathcal{F}_{\mathrm{CNN}}^%
{m}\},\quad\mathcal{F}_{\mathrm{CNN}}^{l}\in\mathbb{R}^{d_{l}\times w_{l}%
\times h_{l}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m2.2d">= { caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT } , caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT × italic_w start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT × italic_h start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{\mathrm{CNN}}^{\mathrm{sementic}}" class="ltx_Math" display="inline" id="S3.Ex5.m1.1"><semantics id="S3.Ex5.m1.1a"><msubsup id="S3.Ex5.m1.1.1" xref="S3.Ex5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.1.1.2.2" xref="S3.Ex5.m1.1.1.2.2.cmml">ℱ</mi><mi id="S3.Ex5.m1.1.1.2.3" xref="S3.Ex5.m1.1.1.2.3.cmml">CNN</mi><mi id="S3.Ex5.m1.1.1.3" xref="S3.Ex5.m1.1.1.3.cmml">sementic</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.1b"><apply id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.cmml" xref="S3.Ex5.m1.1.1">superscript</csymbol><apply id="S3.Ex5.m1.1.1.2.cmml" xref="S3.Ex5.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.2.1.cmml" xref="S3.Ex5.m1.1.1">subscript</csymbol><ci id="S3.Ex5.m1.1.1.2.2.cmml" xref="S3.Ex5.m1.1.1.2.2">ℱ</ci><ci id="S3.Ex5.m1.1.1.2.3.cmml" xref="S3.Ex5.m1.1.1.2.3">CNN</ci></apply><ci id="S3.Ex5.m1.1.1.3.cmml" xref="S3.Ex5.m1.1.1.3">sementic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.1c">\displaystyle\mathcal{F}_{\mathrm{CNN}}^{\mathrm{sementic}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.1d">caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_sementic end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\{\frac{1}{w_{1}h_{1}}\sum^{w_{1}}_{w=1}\sum^{h_{1}}_{h=1}%
\mathcal{F}_{\mathrm{CNN}}^{1}\left[\,:,w,h\,\right],...,\frac{1}{w_{m}h_{m}}%
\sum^{w_{m}}_{w=1}\sum^{h_{m}}_{h=1}\mathcal{F}_{\mathrm{CNN}}^{m}\left[\,:,w,%
h\,\right]\right\}," class="ltx_Math" display="inline" id="S3.Ex5.m2.8"><semantics id="S3.Ex5.m2.8a"><mrow id="S3.Ex5.m2.8.8.1" xref="S3.Ex5.m2.8.8.1.1.cmml"><mrow id="S3.Ex5.m2.8.8.1.1" xref="S3.Ex5.m2.8.8.1.1.cmml"><mi id="S3.Ex5.m2.8.8.1.1.4" xref="S3.Ex5.m2.8.8.1.1.4.cmml"></mi><mo id="S3.Ex5.m2.8.8.1.1.3" xref="S3.Ex5.m2.8.8.1.1.3.cmml">=</mo><mrow id="S3.Ex5.m2.8.8.1.1.2.2" xref="S3.Ex5.m2.8.8.1.1.2.3.cmml"><mo id="S3.Ex5.m2.8.8.1.1.2.2.3" xref="S3.Ex5.m2.8.8.1.1.2.3.cmml">{</mo><mrow id="S3.Ex5.m2.8.8.1.1.1.1.1" xref="S3.Ex5.m2.8.8.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex5.m2.8.8.1.1.1.1.1.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.cmml"><mfrac id="S3.Ex5.m2.8.8.1.1.1.1.1.2a" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.cmml"><mn id="S3.Ex5.m2.8.8.1.1.1.1.1.2.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.2.cmml">1</mn><mrow id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.cmml"><msub id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.cmml"><mi id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.2.cmml">w</mi><mn id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.3.cmml">1</mn></msub><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.1" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.2.cmml">h</mi><mn id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.3.cmml">1</mn></msub></mrow></mfrac></mstyle><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.1" xref="S3.Ex5.m2.8.8.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex5.m2.8.8.1.1.1.1.1.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.cmml"><munderover id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1a" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.cmml"><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.2.cmml">w</mi><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.1" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.1.cmml">=</mo><mn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.3.cmml">1</mn></mrow><msub id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.2.cmml">w</mi><mn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></msub></munderover></mstyle><mrow id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.cmml"><munderover id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1a" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.cmml"><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.2" movablelimits="false" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.2.cmml">h</mi><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.1" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.1.cmml">=</mo><mn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.3.cmml">1</mn></mrow><msub id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.2.cmml">h</mi><mn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.3.cmml">1</mn></msub></munderover></mstyle><mrow id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.cmml"><msubsup id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.2.cmml">ℱ</mi><mi id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.3.cmml">CNN</mi><mn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.3.cmml">1</mn></msubsup><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.1" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.1.cmml">⁢</mo><mrow id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.1.cmml"><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.2.1" rspace="0.170em" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.1.cmml">[</mo><mo id="S3.Ex5.m2.1.1" rspace="0em" xref="S3.Ex5.m2.1.1.cmml">:</mo><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.2.2" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.1.cmml">,</mo><mi id="S3.Ex5.m2.2.2" xref="S3.Ex5.m2.2.2.cmml">w</mi><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.2.3" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.1.cmml">,</mo><mi id="S3.Ex5.m2.3.3" xref="S3.Ex5.m2.3.3.cmml">h</mi><mo id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.2.4" lspace="0.170em" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex5.m2.8.8.1.1.2.2.4" xref="S3.Ex5.m2.8.8.1.1.2.3.cmml">,</mo><mi id="S3.Ex5.m2.7.7" mathvariant="normal" xref="S3.Ex5.m2.7.7.cmml">…</mi><mo id="S3.Ex5.m2.8.8.1.1.2.2.5" xref="S3.Ex5.m2.8.8.1.1.2.3.cmml">,</mo><mrow id="S3.Ex5.m2.8.8.1.1.2.2.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.Ex5.m2.8.8.1.1.2.2.2.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.cmml"><mfrac id="S3.Ex5.m2.8.8.1.1.2.2.2.2a" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.cmml"><mn id="S3.Ex5.m2.8.8.1.1.2.2.2.2.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.2.cmml">1</mn><mrow id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.cmml"><msub id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.cmml"><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.2.cmml">w</mi><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.3.cmml">m</mi></msub><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.1" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.1.cmml">⁢</mo><msub id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.2.cmml">h</mi><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.3.cmml">m</mi></msub></mrow></mfrac></mstyle><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.1" xref="S3.Ex5.m2.8.8.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.Ex5.m2.8.8.1.1.2.2.2.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.cmml"><mstyle displaystyle="true" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.cmml"><munderover id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1a" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.cmml"><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.2" movablelimits="false" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.2.cmml">w</mi><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.1" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.1.cmml">=</mo><mn id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.3.cmml">1</mn></mrow><msub id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.2.cmml">w</mi><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.cmml"><mstyle displaystyle="true" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.cmml"><munderover id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1a" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.cmml"><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.2" movablelimits="false" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.2.cmml">∑</mo><mrow id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.2.cmml">h</mi><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.1" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.1.cmml">=</mo><mn id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.3.cmml">1</mn></mrow><msub id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.cmml"><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.2.cmml">h</mi><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.cmml"><msubsup id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.2.cmml">ℱ</mi><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.3.cmml">CNN</mi><mi id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.3.cmml">m</mi></msubsup><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.1" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.1.cmml">⁢</mo><mrow id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.1.cmml"><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.2.1" rspace="0.170em" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.1.cmml">[</mo><mo id="S3.Ex5.m2.4.4" rspace="0em" xref="S3.Ex5.m2.4.4.cmml">:</mo><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.2.2" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.1.cmml">,</mo><mi id="S3.Ex5.m2.5.5" xref="S3.Ex5.m2.5.5.cmml">w</mi><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.2.3" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.1.cmml">,</mo><mi id="S3.Ex5.m2.6.6" xref="S3.Ex5.m2.6.6.cmml">h</mi><mo id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.2.4" lspace="0.170em" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex5.m2.8.8.1.1.2.2.6" xref="S3.Ex5.m2.8.8.1.1.2.3.cmml">}</mo></mrow></mrow><mo id="S3.Ex5.m2.8.8.1.2" xref="S3.Ex5.m2.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m2.8b"><apply id="S3.Ex5.m2.8.8.1.1.cmml" xref="S3.Ex5.m2.8.8.1"><eq id="S3.Ex5.m2.8.8.1.1.3.cmml" xref="S3.Ex5.m2.8.8.1.1.3"></eq><csymbol cd="latexml" id="S3.Ex5.m2.8.8.1.1.4.cmml" xref="S3.Ex5.m2.8.8.1.1.4">absent</csymbol><set id="S3.Ex5.m2.8.8.1.1.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2"><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1"><times id="S3.Ex5.m2.8.8.1.1.1.1.1.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.1"></times><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2"><divide id="S3.Ex5.m2.8.8.1.1.1.1.1.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2"></divide><cn id="S3.Ex5.m2.8.8.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.2">1</cn><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3"><times id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.1"></times><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.2">𝑤</ci><cn id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.2.3">1</cn></apply><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.2">ℎ</ci><cn id="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3"><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1">subscript</csymbol><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1">superscript</csymbol><sum id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.2">𝑤</ci><cn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3"><eq id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.1"></eq><ci id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.2">𝑤</ci><cn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.1.3.3">1</cn></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2"><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1">subscript</csymbol><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1">superscript</csymbol><sum id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.2"></sum><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.2">ℎ</ci><cn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3"><eq id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.1"></eq><ci id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.2">ℎ</ci><cn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.1.3.3">1</cn></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2"><times id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.1"></times><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2">superscript</csymbol><apply id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.2">ℱ</ci><ci id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.2.3">CNN</ci></apply><cn id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.2.3">1</cn></apply><list id="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.1.1.1.3.2.2.3.2"><ci id="S3.Ex5.m2.1.1.cmml" xref="S3.Ex5.m2.1.1">:</ci><ci id="S3.Ex5.m2.2.2.cmml" xref="S3.Ex5.m2.2.2">𝑤</ci><ci id="S3.Ex5.m2.3.3.cmml" xref="S3.Ex5.m2.3.3">ℎ</ci></list></apply></apply></apply></apply><ci id="S3.Ex5.m2.7.7.cmml" xref="S3.Ex5.m2.7.7">…</ci><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2"><times id="S3.Ex5.m2.8.8.1.1.2.2.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.1"></times><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2"><divide id="S3.Ex5.m2.8.8.1.1.2.2.2.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2"></divide><cn id="S3.Ex5.m2.8.8.1.1.2.2.2.2.2.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.2">1</cn><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3"><times id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.1"></times><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.2">𝑤</ci><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.2.3">𝑚</ci></apply><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.2">ℎ</ci><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.2.3.3.3">𝑚</ci></apply></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3"><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1">subscript</csymbol><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1">superscript</csymbol><sum id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.2"></sum><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.2">𝑤</ci><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.2.3.3">𝑚</ci></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3"><eq id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.1"></eq><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.2">𝑤</ci><cn id="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.1.3.3">1</cn></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2"><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1">subscript</csymbol><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1">superscript</csymbol><sum id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.2"></sum><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.2">ℎ</ci><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.2.3.3">𝑚</ci></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3"><eq id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.1"></eq><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.2">ℎ</ci><cn id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.3.cmml" type="integer" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.1.3.3">1</cn></apply></apply><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2"><times id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.1"></times><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2">superscript</csymbol><apply id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2">subscript</csymbol><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.2.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.2">ℱ</ci><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.2.3">CNN</ci></apply><ci id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.3.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.2.3">𝑚</ci></apply><list id="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.1.cmml" xref="S3.Ex5.m2.8.8.1.1.2.2.2.3.2.2.3.2"><ci id="S3.Ex5.m2.4.4.cmml" xref="S3.Ex5.m2.4.4">:</ci><ci id="S3.Ex5.m2.5.5.cmml" xref="S3.Ex5.m2.5.5">𝑤</ci><ci id="S3.Ex5.m2.6.6.cmml" xref="S3.Ex5.m2.6.6">ℎ</ci></list></apply></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m2.8c">\displaystyle=\left\{\frac{1}{w_{1}h_{1}}\sum^{w_{1}}_{w=1}\sum^{h_{1}}_{h=1}%
\mathcal{F}_{\mathrm{CNN}}^{1}\left[\,:,w,h\,\right],...,\frac{1}{w_{m}h_{m}}%
\sum^{w_{m}}_{w=1}\sum^{h_{m}}_{h=1}\mathcal{F}_{\mathrm{CNN}}^{m}\left[\,:,w,%
h\,\right]\right\},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m2.8d">= { divide start_ARG 1 end_ARG start_ARG italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w = 1 end_POSTSUBSCRIPT ∑ start_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h = 1 end_POSTSUBSCRIPT caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT [ : , italic_w , italic_h ] , … , divide start_ARG 1 end_ARG start_ARG italic_w start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w = 1 end_POSTSUBSCRIPT ∑ start_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h = 1 end_POSTSUBSCRIPT caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT [ : , italic_w , italic_h ] } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{\mathrm{CNN}}^{\mathrm{spatial}}" class="ltx_Math" display="inline" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><msubsup id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2.cmml">ℱ</mi><mi id="S3.E9.m1.1.1.2.3" xref="S3.E9.m1.1.1.2.3.cmml">CNN</mi><mi id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">spatial</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1">superscript</csymbol><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2">ℱ</ci><ci id="S3.E9.m1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.2.3">CNN</ci></apply><ci id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">spatial</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\mathcal{F}_{\mathrm{CNN}}^{\mathrm{spatial}}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_spatial end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{F}_{\mathrm{CNN}},\qquad\qquad\qquad\qquad\qquad\quad\," class="ltx_Math" display="inline" id="S3.E9.m2.1"><semantics id="S3.E9.m2.1a"><mrow id="S3.E9.m2.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml"><mrow id="S3.E9.m2.1.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml"><mi id="S3.E9.m2.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E9.m2.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.cmml">=</mo><msub id="S3.E9.m2.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m2.1.1.1.1.3.2" xref="S3.E9.m2.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E9.m2.1.1.1.1.3.3" xref="S3.E9.m2.1.1.1.1.3.3.cmml">CNN</mi></msub></mrow><mo id="S3.E9.m2.1.1.1.2" xref="S3.E9.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.1b"><apply id="S3.E9.m2.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1"><eq id="S3.E9.m2.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E9.m2.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E9.m2.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.3.1.cmml" xref="S3.E9.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m2.1.1.1.1.3.2.cmml" xref="S3.E9.m2.1.1.1.1.3.2">ℱ</ci><ci id="S3.E9.m2.1.1.1.1.3.3.cmml" xref="S3.E9.m2.1.1.1.1.3.3">CNN</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.1c">\displaystyle=\mathcal{F}_{\mathrm{CNN}},\qquad\qquad\qquad\qquad\qquad\quad\,</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m2.1d">= caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p4.6">where m is the number of layers in CNN. As observed in the case of ViT, we standardize dimension and feature size via bilinear interpolation and affine transformation. This process is expressed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx9">
<tbody id="S3.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{\mathrm{2}}=\left[W_{1}^{2}\left[\mathcal{F}_{%
\mathrm{CNN}}^{\mathrm{sementic}}[1];\underset{w\times h}{\mathrm{I}}\left(%
\mathcal{F}_{\mathrm{CNN}}^{\mathrm{spatial}}[1]\right)\right]+\textbf{b}^{2}_%
{1};\right." class="ltx_math_unparsed" display="inline" id="S3.Ex6.m1.2"><semantics id="S3.Ex6.m1.2a"><mrow id="S3.Ex6.m1.2b"><msub id="S3.Ex6.m1.2.3"><mi class="ltx_font_mathcaligraphic" id="S3.Ex6.m1.2.3.2">ℱ</mi><mn id="S3.Ex6.m1.2.3.3">2</mn></msub><mo id="S3.Ex6.m1.2.4">=</mo><mrow id="S3.Ex6.m1.2.5"><mo id="S3.Ex6.m1.2.5.1">[</mo><msubsup id="S3.Ex6.m1.2.5.2"><mi id="S3.Ex6.m1.2.5.2.2.2">W</mi><mn id="S3.Ex6.m1.2.5.2.2.3">1</mn><mn id="S3.Ex6.m1.2.5.2.3">2</mn></msubsup><mrow id="S3.Ex6.m1.2.5.3"><mo id="S3.Ex6.m1.2.5.3.1">[</mo><msubsup id="S3.Ex6.m1.2.5.3.2"><mi class="ltx_font_mathcaligraphic" id="S3.Ex6.m1.2.5.3.2.2.2">ℱ</mi><mi id="S3.Ex6.m1.2.5.3.2.2.3">CNN</mi><mi id="S3.Ex6.m1.2.5.3.2.3">sementic</mi></msubsup><mrow id="S3.Ex6.m1.2.5.3.3"><mo id="S3.Ex6.m1.2.5.3.3.1" stretchy="false">[</mo><mn id="S3.Ex6.m1.1.1">1</mn><mo id="S3.Ex6.m1.2.5.3.3.2" stretchy="false">]</mo></mrow><mo id="S3.Ex6.m1.2.5.3.4">;</mo><munder accentunder="true" id="S3.Ex6.m1.2.5.3.5"><mi id="S3.Ex6.m1.2.5.3.5.2" mathvariant="normal">I</mi><mrow id="S3.Ex6.m1.2.5.3.5.1"><mi id="S3.Ex6.m1.2.5.3.5.1.2">w</mi><mo id="S3.Ex6.m1.2.5.3.5.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.Ex6.m1.2.5.3.5.1.3">h</mi></mrow></munder><mrow id="S3.Ex6.m1.2.5.3.6"><mo id="S3.Ex6.m1.2.5.3.6.1">(</mo><msubsup id="S3.Ex6.m1.2.5.3.6.2"><mi class="ltx_font_mathcaligraphic" id="S3.Ex6.m1.2.5.3.6.2.2.2">ℱ</mi><mi id="S3.Ex6.m1.2.5.3.6.2.2.3">CNN</mi><mi id="S3.Ex6.m1.2.5.3.6.2.3">spatial</mi></msubsup><mrow id="S3.Ex6.m1.2.5.3.6.3"><mo id="S3.Ex6.m1.2.5.3.6.3.1" stretchy="false">[</mo><mn id="S3.Ex6.m1.2.2">1</mn><mo id="S3.Ex6.m1.2.5.3.6.3.2" stretchy="false">]</mo></mrow><mo id="S3.Ex6.m1.2.5.3.6.4">)</mo></mrow><mo id="S3.Ex6.m1.2.5.3.7">]</mo></mrow><mo id="S3.Ex6.m1.2.5.4">+</mo><msubsup id="S3.Ex6.m1.2.5.5"><mtext class="ltx_mathvariant_bold" id="S3.Ex6.m1.2.5.5.2.2">b</mtext><mn id="S3.Ex6.m1.2.5.5.3">1</mn><mn id="S3.Ex6.m1.2.5.5.2.3">2</mn></msubsup><mo id="S3.Ex6.m1.2.5.6">;</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex6.m1.2c">\displaystyle\mathcal{F}_{\mathrm{2}}=\left[W_{1}^{2}\left[\mathcal{F}_{%
\mathrm{CNN}}^{\mathrm{sementic}}[1];\underset{w\times h}{\mathrm{I}}\left(%
\mathcal{F}_{\mathrm{CNN}}^{\mathrm{spatial}}[1]\right)\right]+\textbf{b}^{2}_%
{1};\right.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6.m1.2d">caligraphic_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = [ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT [ caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_sementic end_POSTSUPERSCRIPT [ 1 ] ; start_UNDERACCENT italic_w × italic_h end_UNDERACCENT start_ARG roman_I end_ARG ( caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_spatial end_POSTSUPERSCRIPT [ 1 ] ) ] + b start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ;</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle...;\left.W_{m}^{2}\left[\mathcal{F}_{\mathrm{CNN}}^{\mathrm{%
sementic}}[m];\underset{w\times h}{\mathrm{I}}\left(\mathcal{F}_{\mathrm{CNN}}%
^{\mathrm{spatial}}[m]\right)\right]+\textbf{b}^{2}_{m}\right]," class="ltx_math_unparsed" display="inline" id="S3.E10.m1.3"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3b"><mi id="S3.E10.m1.3.3" mathvariant="normal">…</mi><mo id="S3.E10.m1.3.4">;</mo><msubsup id="S3.E10.m1.3.5"><mi id="S3.E10.m1.3.5.2.2">W</mi><mi id="S3.E10.m1.3.5.2.3">m</mi><mn id="S3.E10.m1.3.5.3">2</mn></msubsup><mrow id="S3.E10.m1.3.6"><mo id="S3.E10.m1.3.6.1">[</mo><msubsup id="S3.E10.m1.3.6.2"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.3.6.2.2.2">ℱ</mi><mi id="S3.E10.m1.3.6.2.2.3">CNN</mi><mi id="S3.E10.m1.3.6.2.3">sementic</mi></msubsup><mrow id="S3.E10.m1.3.6.3"><mo id="S3.E10.m1.3.6.3.1" stretchy="false">[</mo><mi id="S3.E10.m1.1.1">m</mi><mo id="S3.E10.m1.3.6.3.2" stretchy="false">]</mo></mrow><mo id="S3.E10.m1.3.6.4">;</mo><munder accentunder="true" id="S3.E10.m1.3.6.5"><mi id="S3.E10.m1.3.6.5.2" mathvariant="normal">I</mi><mrow id="S3.E10.m1.3.6.5.1"><mi id="S3.E10.m1.3.6.5.1.2">w</mi><mo id="S3.E10.m1.3.6.5.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.E10.m1.3.6.5.1.3">h</mi></mrow></munder><mrow id="S3.E10.m1.3.6.6"><mo id="S3.E10.m1.3.6.6.1">(</mo><msubsup id="S3.E10.m1.3.6.6.2"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.3.6.6.2.2.2">ℱ</mi><mi id="S3.E10.m1.3.6.6.2.2.3">CNN</mi><mi id="S3.E10.m1.3.6.6.2.3">spatial</mi></msubsup><mrow id="S3.E10.m1.3.6.6.3"><mo id="S3.E10.m1.3.6.6.3.1" stretchy="false">[</mo><mi id="S3.E10.m1.2.2">m</mi><mo id="S3.E10.m1.3.6.6.3.2" stretchy="false">]</mo></mrow><mo id="S3.E10.m1.3.6.6.4">)</mo></mrow><mo id="S3.E10.m1.3.6.7">]</mo></mrow><mo id="S3.E10.m1.3.7">+</mo><msubsup id="S3.E10.m1.3.8"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.8.2.2">b</mtext><mi id="S3.E10.m1.3.8.3">m</mi><mn id="S3.E10.m1.3.8.2.3">2</mn></msubsup><mo id="S3.E10.m1.3.9">]</mo><mo id="S3.E10.m1.3.10">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E10.m1.3c">\displaystyle...;\left.W_{m}^{2}\left[\mathcal{F}_{\mathrm{CNN}}^{\mathrm{%
sementic}}[m];\underset{w\times h}{\mathrm{I}}\left(\mathcal{F}_{\mathrm{CNN}}%
^{\mathrm{spatial}}[m]\right)\right]+\textbf{b}^{2}_{m}\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.3d">… ; italic_W start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT [ caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_sementic end_POSTSUPERSCRIPT [ italic_m ] ; start_UNDERACCENT italic_w × italic_h end_UNDERACCENT start_ARG roman_I end_ARG ( caligraphic_F start_POSTSUBSCRIPT roman_CNN end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_spatial end_POSTSUPERSCRIPT [ italic_m ] ) ] + b start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p4.4">where <math alttext="W^{2}_{1}\in\mathbb{R}^{d\times{d_{1}}},...,W^{2}_{m}\in\mathbb{R}^{d\times{d_%
{m}}}" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.3"><semantics id="S3.SS4.p4.1.m1.3a"><mrow id="S3.SS4.p4.1.m1.3.3.2" xref="S3.SS4.p4.1.m1.3.3.3.cmml"><mrow id="S3.SS4.p4.1.m1.2.2.1.1" xref="S3.SS4.p4.1.m1.2.2.1.1.cmml"><msubsup id="S3.SS4.p4.1.m1.2.2.1.1.3" xref="S3.SS4.p4.1.m1.2.2.1.1.3.cmml"><mi id="S3.SS4.p4.1.m1.2.2.1.1.3.2.2" xref="S3.SS4.p4.1.m1.2.2.1.1.3.2.2.cmml">W</mi><mn id="S3.SS4.p4.1.m1.2.2.1.1.3.3" xref="S3.SS4.p4.1.m1.2.2.1.1.3.3.cmml">1</mn><mn id="S3.SS4.p4.1.m1.2.2.1.1.3.2.3" xref="S3.SS4.p4.1.m1.2.2.1.1.3.2.3.cmml">2</mn></msubsup><mo id="S3.SS4.p4.1.m1.2.2.1.1.2" xref="S3.SS4.p4.1.m1.2.2.1.1.2.cmml">∈</mo><mrow id="S3.SS4.p4.1.m1.2.2.1.1.1.1" xref="S3.SS4.p4.1.m1.2.2.1.1.1.2.cmml"><msup id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.2" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.2.cmml">ℝ</mi><mrow id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.2" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.2.cmml">d</mi><mo id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.1.cmml">×</mo><msub id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.2" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.2.cmml">d</mi><mn id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.3" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.3.cmml">1</mn></msub></mrow></msup><mo id="S3.SS4.p4.1.m1.2.2.1.1.1.1.2" xref="S3.SS4.p4.1.m1.2.2.1.1.1.2.cmml">,</mo><mi id="S3.SS4.p4.1.m1.1.1" mathvariant="normal" xref="S3.SS4.p4.1.m1.1.1.cmml">…</mi></mrow></mrow><mo id="S3.SS4.p4.1.m1.3.3.2.3" xref="S3.SS4.p4.1.m1.3.3.3a.cmml">,</mo><mrow id="S3.SS4.p4.1.m1.3.3.2.2" xref="S3.SS4.p4.1.m1.3.3.2.2.cmml"><msubsup id="S3.SS4.p4.1.m1.3.3.2.2.2" xref="S3.SS4.p4.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS4.p4.1.m1.3.3.2.2.2.2.2" xref="S3.SS4.p4.1.m1.3.3.2.2.2.2.2.cmml">W</mi><mi id="S3.SS4.p4.1.m1.3.3.2.2.2.3" xref="S3.SS4.p4.1.m1.3.3.2.2.2.3.cmml">m</mi><mn id="S3.SS4.p4.1.m1.3.3.2.2.2.2.3" xref="S3.SS4.p4.1.m1.3.3.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS4.p4.1.m1.3.3.2.2.1" xref="S3.SS4.p4.1.m1.3.3.2.2.1.cmml">∈</mo><msup id="S3.SS4.p4.1.m1.3.3.2.2.3" xref="S3.SS4.p4.1.m1.3.3.2.2.3.cmml"><mi id="S3.SS4.p4.1.m1.3.3.2.2.3.2" xref="S3.SS4.p4.1.m1.3.3.2.2.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p4.1.m1.3.3.2.2.3.3" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.cmml"><mi id="S3.SS4.p4.1.m1.3.3.2.2.3.3.2" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.2.cmml">d</mi><mo id="S3.SS4.p4.1.m1.3.3.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.1.cmml">×</mo><msub id="S3.SS4.p4.1.m1.3.3.2.2.3.3.3" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.cmml"><mi id="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.2" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.2.cmml">d</mi><mi id="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.3" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.3.cmml">m</mi></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.3b"><apply id="S3.SS4.p4.1.m1.3.3.3.cmml" xref="S3.SS4.p4.1.m1.3.3.2"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.3.3.3a.cmml" xref="S3.SS4.p4.1.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.SS4.p4.1.m1.2.2.1.1.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1"><in id="S3.SS4.p4.1.m1.2.2.1.1.2.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.2"></in><apply id="S3.SS4.p4.1.m1.2.2.1.1.3.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.2.2.1.1.3.1.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.SS4.p4.1.m1.2.2.1.1.3.2.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.2.2.1.1.3.2.1.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.SS4.p4.1.m1.2.2.1.1.3.2.2.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.3.2.2">𝑊</ci><cn id="S3.SS4.p4.1.m1.2.2.1.1.3.2.3.cmml" type="integer" xref="S3.SS4.p4.1.m1.2.2.1.1.3.2.3">2</cn></apply><cn id="S3.SS4.p4.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS4.p4.1.m1.2.2.1.1.3.3">1</cn></apply><list id="S3.SS4.p4.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1"><apply id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.2">ℝ</ci><apply id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3"><times id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.1"></times><ci id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.2">𝑑</ci><apply id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.2">𝑑</ci><cn id="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p4.1.m1.2.2.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">…</ci></list></apply><apply id="S3.SS4.p4.1.m1.3.3.2.2.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2"><in id="S3.SS4.p4.1.m1.3.3.2.2.1.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.1"></in><apply id="S3.SS4.p4.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS4.p4.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS4.p4.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.2.2.2">𝑊</ci><cn id="S3.SS4.p4.1.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p4.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS4.p4.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.2.3">𝑚</ci></apply><apply id="S3.SS4.p4.1.m1.3.3.2.2.3.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.3.3.2.2.3.1.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3">superscript</csymbol><ci id="S3.SS4.p4.1.m1.3.3.2.2.3.2.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3.2">ℝ</ci><apply id="S3.SS4.p4.1.m1.3.3.2.2.3.3.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3"><times id="S3.SS4.p4.1.m1.3.3.2.2.3.3.1.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.1"></times><ci id="S3.SS4.p4.1.m1.3.3.2.2.3.3.2.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.2">𝑑</ci><apply id="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.1.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.3">subscript</csymbol><ci id="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.2.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.2">𝑑</ci><ci id="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.3.cmml" xref="S3.SS4.p4.1.m1.3.3.2.2.3.3.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.3c">W^{2}_{1}\in\mathbb{R}^{d\times{d_{1}}},...,W^{2}_{m}\in\mathbb{R}^{d\times{d_%
{m}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.1.m1.3d">italic_W start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , … , italic_W start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\textbf{b}^{2}_{1},...,\textbf{b}^{2}_{m}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS4.p4.2.m2.3"><semantics id="S3.SS4.p4.2.m2.3a"><mrow id="S3.SS4.p4.2.m2.3.3" xref="S3.SS4.p4.2.m2.3.3.cmml"><mrow id="S3.SS4.p4.2.m2.3.3.2.2" xref="S3.SS4.p4.2.m2.3.3.2.3.cmml"><msubsup id="S3.SS4.p4.2.m2.2.2.1.1.1" xref="S3.SS4.p4.2.m2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p4.2.m2.2.2.1.1.1.2.2" xref="S3.SS4.p4.2.m2.2.2.1.1.1.2.2a.cmml">b</mtext><mn id="S3.SS4.p4.2.m2.2.2.1.1.1.3" xref="S3.SS4.p4.2.m2.2.2.1.1.1.3.cmml">1</mn><mn id="S3.SS4.p4.2.m2.2.2.1.1.1.2.3" xref="S3.SS4.p4.2.m2.2.2.1.1.1.2.3.cmml">2</mn></msubsup><mo id="S3.SS4.p4.2.m2.3.3.2.2.3" xref="S3.SS4.p4.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.SS4.p4.2.m2.1.1" mathvariant="normal" xref="S3.SS4.p4.2.m2.1.1.cmml">…</mi><mo id="S3.SS4.p4.2.m2.3.3.2.2.4" xref="S3.SS4.p4.2.m2.3.3.2.3.cmml">,</mo><msubsup id="S3.SS4.p4.2.m2.3.3.2.2.2" xref="S3.SS4.p4.2.m2.3.3.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p4.2.m2.3.3.2.2.2.2.2" xref="S3.SS4.p4.2.m2.3.3.2.2.2.2.2a.cmml">b</mtext><mi id="S3.SS4.p4.2.m2.3.3.2.2.2.3" xref="S3.SS4.p4.2.m2.3.3.2.2.2.3.cmml">m</mi><mn id="S3.SS4.p4.2.m2.3.3.2.2.2.2.3" xref="S3.SS4.p4.2.m2.3.3.2.2.2.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.SS4.p4.2.m2.3.3.3" xref="S3.SS4.p4.2.m2.3.3.3.cmml">∈</mo><msup id="S3.SS4.p4.2.m2.3.3.4" xref="S3.SS4.p4.2.m2.3.3.4.cmml"><mi id="S3.SS4.p4.2.m2.3.3.4.2" xref="S3.SS4.p4.2.m2.3.3.4.2.cmml">ℝ</mi><mi id="S3.SS4.p4.2.m2.3.3.4.3" xref="S3.SS4.p4.2.m2.3.3.4.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.3b"><apply id="S3.SS4.p4.2.m2.3.3.cmml" xref="S3.SS4.p4.2.m2.3.3"><in id="S3.SS4.p4.2.m2.3.3.3.cmml" xref="S3.SS4.p4.2.m2.3.3.3"></in><list id="S3.SS4.p4.2.m2.3.3.2.3.cmml" xref="S3.SS4.p4.2.m2.3.3.2.2"><apply id="S3.SS4.p4.2.m2.2.2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS4.p4.2.m2.2.2.1.1.1">subscript</csymbol><apply id="S3.SS4.p4.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS4.p4.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS4.p4.2.m2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS4.p4.2.m2.2.2.1.1.1.2.2a.cmml" xref="S3.SS4.p4.2.m2.2.2.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p4.2.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS4.p4.2.m2.2.2.1.1.1.2.2">b</mtext></ci><cn id="S3.SS4.p4.2.m2.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS4.p4.2.m2.2.2.1.1.1.2.3">2</cn></apply><cn id="S3.SS4.p4.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS4.p4.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">…</ci><apply id="S3.SS4.p4.2.m2.3.3.2.2.2.cmml" xref="S3.SS4.p4.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS4.p4.2.m2.3.3.2.2.2">subscript</csymbol><apply id="S3.SS4.p4.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS4.p4.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS4.p4.2.m2.3.3.2.2.2">superscript</csymbol><ci id="S3.SS4.p4.2.m2.3.3.2.2.2.2.2a.cmml" xref="S3.SS4.p4.2.m2.3.3.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p4.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS4.p4.2.m2.3.3.2.2.2.2.2">b</mtext></ci><cn id="S3.SS4.p4.2.m2.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p4.2.m2.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS4.p4.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS4.p4.2.m2.3.3.2.2.2.3">𝑚</ci></apply></list><apply id="S3.SS4.p4.2.m2.3.3.4.cmml" xref="S3.SS4.p4.2.m2.3.3.4"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.3.3.4.1.cmml" xref="S3.SS4.p4.2.m2.3.3.4">superscript</csymbol><ci id="S3.SS4.p4.2.m2.3.3.4.2.cmml" xref="S3.SS4.p4.2.m2.3.3.4.2">ℝ</ci><ci id="S3.SS4.p4.2.m2.3.3.4.3.cmml" xref="S3.SS4.p4.2.m2.3.3.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.3c">\textbf{b}^{2}_{1},...,\textbf{b}^{2}_{m}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.2.m2.3d">b start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , b start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Finally we get the feature of <math alttext="\mathbb{R}^{m\times(wh+1)\times d}" class="ltx_Math" display="inline" id="S3.SS4.p4.3.m3.1"><semantics id="S3.SS4.p4.3.m3.1a"><msup id="S3.SS4.p4.3.m3.1.2" xref="S3.SS4.p4.3.m3.1.2.cmml"><mi id="S3.SS4.p4.3.m3.1.2.2" xref="S3.SS4.p4.3.m3.1.2.2.cmml">ℝ</mi><mrow id="S3.SS4.p4.3.m3.1.1.1" xref="S3.SS4.p4.3.m3.1.1.1.cmml"><mi id="S3.SS4.p4.3.m3.1.1.1.3" xref="S3.SS4.p4.3.m3.1.1.1.3.cmml">m</mi><mo id="S3.SS4.p4.3.m3.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p4.3.m3.1.1.1.2.cmml">×</mo><mrow id="S3.SS4.p4.3.m3.1.1.1.1.1" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p4.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p4.3.m3.1.1.1.1.1.1" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p4.3.m3.1.1.1.1.1.1.2" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.2" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.2.cmml">w</mi><mo id="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.1" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.3" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.3.cmml">h</mi></mrow><mo id="S3.SS4.p4.3.m3.1.1.1.1.1.1.1" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p4.3.m3.1.1.1.1.1.1.3" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p4.3.m3.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p4.3.m3.1.1.1.2a" rspace="0.222em" xref="S3.SS4.p4.3.m3.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p4.3.m3.1.1.1.4" xref="S3.SS4.p4.3.m3.1.1.1.4.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><apply id="S3.SS4.p4.3.m3.1.2.cmml" xref="S3.SS4.p4.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m3.1.2.1.cmml" xref="S3.SS4.p4.3.m3.1.2">superscript</csymbol><ci id="S3.SS4.p4.3.m3.1.2.2.cmml" xref="S3.SS4.p4.3.m3.1.2.2">ℝ</ci><apply id="S3.SS4.p4.3.m3.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1.1"><times id="S3.SS4.p4.3.m3.1.1.1.2.cmml" xref="S3.SS4.p4.3.m3.1.1.1.2"></times><ci id="S3.SS4.p4.3.m3.1.1.1.3.cmml" xref="S3.SS4.p4.3.m3.1.1.1.3">𝑚</ci><apply id="S3.SS4.p4.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1.1.1.1"><plus id="S3.SS4.p4.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.2"><times id="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.p4.3.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p4.3.m3.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS4.p4.3.m3.1.1.1.4.cmml" xref="S3.SS4.p4.3.m3.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">\mathbb{R}^{m\times(wh+1)\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.3.m3.1d">blackboard_R start_POSTSUPERSCRIPT italic_m × ( italic_w italic_h + 1 ) × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. And, it is transposed to <math alttext="\mathbb{R}^{(wh+1)\times d\times m}" class="ltx_Math" display="inline" id="S3.SS4.p4.4.m4.1"><semantics id="S3.SS4.p4.4.m4.1a"><msup id="S3.SS4.p4.4.m4.1.2" xref="S3.SS4.p4.4.m4.1.2.cmml"><mi id="S3.SS4.p4.4.m4.1.2.2" xref="S3.SS4.p4.4.m4.1.2.2.cmml">ℝ</mi><mrow id="S3.SS4.p4.4.m4.1.1.1" xref="S3.SS4.p4.4.m4.1.1.1.cmml"><mrow id="S3.SS4.p4.4.m4.1.1.1.1.1" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p4.4.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p4.4.m4.1.1.1.1.1.1" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.2" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.2.cmml">w</mi><mo id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.1" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.3" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.3.cmml">h</mi></mrow><mo id="S3.SS4.p4.4.m4.1.1.1.1.1.1.1" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p4.4.m4.1.1.1.1.1.1.3" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p4.4.m4.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p4.4.m4.1.1.1.2" rspace="0.222em" xref="S3.SS4.p4.4.m4.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p4.4.m4.1.1.1.3" xref="S3.SS4.p4.4.m4.1.1.1.3.cmml">d</mi><mo id="S3.SS4.p4.4.m4.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p4.4.m4.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p4.4.m4.1.1.1.4" xref="S3.SS4.p4.4.m4.1.1.1.4.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.1b"><apply id="S3.SS4.p4.4.m4.1.2.cmml" xref="S3.SS4.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.1.2.1.cmml" xref="S3.SS4.p4.4.m4.1.2">superscript</csymbol><ci id="S3.SS4.p4.4.m4.1.2.2.cmml" xref="S3.SS4.p4.4.m4.1.2.2">ℝ</ci><apply id="S3.SS4.p4.4.m4.1.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1"><times id="S3.SS4.p4.4.m4.1.1.1.2.cmml" xref="S3.SS4.p4.4.m4.1.1.1.2"></times><apply id="S3.SS4.p4.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1"><plus id="S3.SS4.p4.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2"><times id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.p4.4.m4.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS4.p4.4.m4.1.1.1.3.cmml" xref="S3.SS4.p4.4.m4.1.1.1.3">𝑑</ci><ci id="S3.SS4.p4.4.m4.1.1.1.4.cmml" xref="S3.SS4.p4.4.m4.1.1.1.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.1c">\mathbb{R}^{(wh+1)\times d\times m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.4.m4.1d">blackboard_R start_POSTSUPERSCRIPT ( italic_w italic_h + 1 ) × italic_d × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p5">
<p class="ltx_p" id="S3.SS4.p5.6">The aligned dimensionality and the number of features are currently the same, but the number of layers in the two models is still different, <span class="ltx_text ltx_font_italic" id="S3.SS4.p5.6.1">i.e.</span>,
<math alttext="\mathcal{F}_{\mathrm{1}}\in\mathbb{R}^{(wh+1)\times d\times n}" class="ltx_Math" display="inline" id="S3.SS4.p5.1.m1.1"><semantics id="S3.SS4.p5.1.m1.1a"><mrow id="S3.SS4.p5.1.m1.1.2" xref="S3.SS4.p5.1.m1.1.2.cmml"><msub id="S3.SS4.p5.1.m1.1.2.2" xref="S3.SS4.p5.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.1.m1.1.2.2.2" xref="S3.SS4.p5.1.m1.1.2.2.2.cmml">ℱ</mi><mn id="S3.SS4.p5.1.m1.1.2.2.3" xref="S3.SS4.p5.1.m1.1.2.2.3.cmml">1</mn></msub><mo id="S3.SS4.p5.1.m1.1.2.1" xref="S3.SS4.p5.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS4.p5.1.m1.1.2.3" xref="S3.SS4.p5.1.m1.1.2.3.cmml"><mi id="S3.SS4.p5.1.m1.1.2.3.2" xref="S3.SS4.p5.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p5.1.m1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.cmml"><mrow id="S3.SS4.p5.1.m1.1.1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p5.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p5.1.m1.1.1.1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p5.1.m1.1.1.1.1.1.1.2" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.2.cmml">w</mi><mo id="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.1" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.3.cmml">h</mi></mrow><mo id="S3.SS4.p5.1.m1.1.1.1.1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p5.1.m1.1.1.1.1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p5.1.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p5.1.m1.1.1.1.2" rspace="0.222em" xref="S3.SS4.p5.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p5.1.m1.1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.1.3.cmml">d</mi><mo id="S3.SS4.p5.1.m1.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p5.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p5.1.m1.1.1.1.4" xref="S3.SS4.p5.1.m1.1.1.1.4.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><apply id="S3.SS4.p5.1.m1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.2"><in id="S3.SS4.p5.1.m1.1.2.1.cmml" xref="S3.SS4.p5.1.m1.1.2.1"></in><apply id="S3.SS4.p5.1.m1.1.2.2.cmml" xref="S3.SS4.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p5.1.m1.1.2.2.1.cmml" xref="S3.SS4.p5.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS4.p5.1.m1.1.2.2.2.cmml" xref="S3.SS4.p5.1.m1.1.2.2.2">ℱ</ci><cn id="S3.SS4.p5.1.m1.1.2.2.3.cmml" type="integer" xref="S3.SS4.p5.1.m1.1.2.2.3">1</cn></apply><apply id="S3.SS4.p5.1.m1.1.2.3.cmml" xref="S3.SS4.p5.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p5.1.m1.1.2.3.1.cmml" xref="S3.SS4.p5.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS4.p5.1.m1.1.2.3.2.cmml" xref="S3.SS4.p5.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS4.p5.1.m1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1"><times id="S3.SS4.p5.1.m1.1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.1.2"></times><apply id="S3.SS4.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1"><plus id="S3.SS4.p5.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.2"><times id="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.p5.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS4.p5.1.m1.1.1.1.3.cmml" xref="S3.SS4.p5.1.m1.1.1.1.3">𝑑</ci><ci id="S3.SS4.p5.1.m1.1.1.1.4.cmml" xref="S3.SS4.p5.1.m1.1.1.1.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">\mathcal{F}_{\mathrm{1}}\in\mathbb{R}^{(wh+1)\times d\times n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_w italic_h + 1 ) × italic_d × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{F}_{\mathrm{2}}\in\mathbb{R}^{(wh+1)\times d\times m}" class="ltx_Math" display="inline" id="S3.SS4.p5.2.m2.1"><semantics id="S3.SS4.p5.2.m2.1a"><mrow id="S3.SS4.p5.2.m2.1.2" xref="S3.SS4.p5.2.m2.1.2.cmml"><msub id="S3.SS4.p5.2.m2.1.2.2" xref="S3.SS4.p5.2.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.2.m2.1.2.2.2" xref="S3.SS4.p5.2.m2.1.2.2.2.cmml">ℱ</mi><mn id="S3.SS4.p5.2.m2.1.2.2.3" xref="S3.SS4.p5.2.m2.1.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.p5.2.m2.1.2.1" xref="S3.SS4.p5.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS4.p5.2.m2.1.2.3" xref="S3.SS4.p5.2.m2.1.2.3.cmml"><mi id="S3.SS4.p5.2.m2.1.2.3.2" xref="S3.SS4.p5.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p5.2.m2.1.1.1" xref="S3.SS4.p5.2.m2.1.1.1.cmml"><mrow id="S3.SS4.p5.2.m2.1.1.1.1.1" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p5.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p5.2.m2.1.1.1.1.1.1" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p5.2.m2.1.1.1.1.1.1.2" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.2" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.2.cmml">w</mi><mo id="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.1" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.3" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.3.cmml">h</mi></mrow><mo id="S3.SS4.p5.2.m2.1.1.1.1.1.1.1" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p5.2.m2.1.1.1.1.1.1.3" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p5.2.m2.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p5.2.m2.1.1.1.2" rspace="0.222em" xref="S3.SS4.p5.2.m2.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p5.2.m2.1.1.1.3" xref="S3.SS4.p5.2.m2.1.1.1.3.cmml">d</mi><mo id="S3.SS4.p5.2.m2.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p5.2.m2.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p5.2.m2.1.1.1.4" xref="S3.SS4.p5.2.m2.1.1.1.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b"><apply id="S3.SS4.p5.2.m2.1.2.cmml" xref="S3.SS4.p5.2.m2.1.2"><in id="S3.SS4.p5.2.m2.1.2.1.cmml" xref="S3.SS4.p5.2.m2.1.2.1"></in><apply id="S3.SS4.p5.2.m2.1.2.2.cmml" xref="S3.SS4.p5.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.1.2.2.1.cmml" xref="S3.SS4.p5.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS4.p5.2.m2.1.2.2.2.cmml" xref="S3.SS4.p5.2.m2.1.2.2.2">ℱ</ci><cn id="S3.SS4.p5.2.m2.1.2.2.3.cmml" type="integer" xref="S3.SS4.p5.2.m2.1.2.2.3">2</cn></apply><apply id="S3.SS4.p5.2.m2.1.2.3.cmml" xref="S3.SS4.p5.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.1.2.3.1.cmml" xref="S3.SS4.p5.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS4.p5.2.m2.1.2.3.2.cmml" xref="S3.SS4.p5.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS4.p5.2.m2.1.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1.1"><times id="S3.SS4.p5.2.m2.1.1.1.2.cmml" xref="S3.SS4.p5.2.m2.1.1.1.2"></times><apply id="S3.SS4.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1.1.1.1"><plus id="S3.SS4.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.2"><times id="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.p5.2.m2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p5.2.m2.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS4.p5.2.m2.1.1.1.3.cmml" xref="S3.SS4.p5.2.m2.1.1.1.3">𝑑</ci><ci id="S3.SS4.p5.2.m2.1.1.1.4.cmml" xref="S3.SS4.p5.2.m2.1.1.1.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">\mathcal{F}_{\mathrm{2}}\in\mathbb{R}^{(wh+1)\times d\times m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.2.m2.1d">caligraphic_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_w italic_h + 1 ) × italic_d × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>. We further match the number of layers by using an <math alttext="{n\times m}" class="ltx_Math" display="inline" id="S3.SS4.p5.3.m3.1"><semantics id="S3.SS4.p5.3.m3.1a"><mrow id="S3.SS4.p5.3.m3.1.1" xref="S3.SS4.p5.3.m3.1.1.cmml"><mi id="S3.SS4.p5.3.m3.1.1.2" xref="S3.SS4.p5.3.m3.1.1.2.cmml">n</mi><mo id="S3.SS4.p5.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p5.3.m3.1.1.1.cmml">×</mo><mi id="S3.SS4.p5.3.m3.1.1.3" xref="S3.SS4.p5.3.m3.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.m3.1b"><apply id="S3.SS4.p5.3.m3.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1"><times id="S3.SS4.p5.3.m3.1.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1.1"></times><ci id="S3.SS4.p5.3.m3.1.1.2.cmml" xref="S3.SS4.p5.3.m3.1.1.2">𝑛</ci><ci id="S3.SS4.p5.3.m3.1.1.3.cmml" xref="S3.SS4.p5.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.3.m3.1c">{n\times m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.3.m3.1d">italic_n × italic_m</annotation></semantics></math> matrix <math alttext="M_{\mathrm{layer}}\in\mathbb{R}^{n\times m}" class="ltx_Math" display="inline" id="S3.SS4.p5.4.m4.1"><semantics id="S3.SS4.p5.4.m4.1a"><mrow id="S3.SS4.p5.4.m4.1.1" xref="S3.SS4.p5.4.m4.1.1.cmml"><msub id="S3.SS4.p5.4.m4.1.1.2" xref="S3.SS4.p5.4.m4.1.1.2.cmml"><mi id="S3.SS4.p5.4.m4.1.1.2.2" xref="S3.SS4.p5.4.m4.1.1.2.2.cmml">M</mi><mi id="S3.SS4.p5.4.m4.1.1.2.3" xref="S3.SS4.p5.4.m4.1.1.2.3.cmml">layer</mi></msub><mo id="S3.SS4.p5.4.m4.1.1.1" xref="S3.SS4.p5.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS4.p5.4.m4.1.1.3" xref="S3.SS4.p5.4.m4.1.1.3.cmml"><mi id="S3.SS4.p5.4.m4.1.1.3.2" xref="S3.SS4.p5.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p5.4.m4.1.1.3.3" xref="S3.SS4.p5.4.m4.1.1.3.3.cmml"><mi id="S3.SS4.p5.4.m4.1.1.3.3.2" xref="S3.SS4.p5.4.m4.1.1.3.3.2.cmml">n</mi><mo id="S3.SS4.p5.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p5.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p5.4.m4.1.1.3.3.3" xref="S3.SS4.p5.4.m4.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.4.m4.1b"><apply id="S3.SS4.p5.4.m4.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1"><in id="S3.SS4.p5.4.m4.1.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1.1"></in><apply id="S3.SS4.p5.4.m4.1.1.2.cmml" xref="S3.SS4.p5.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p5.4.m4.1.1.2.1.cmml" xref="S3.SS4.p5.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.p5.4.m4.1.1.2.2.cmml" xref="S3.SS4.p5.4.m4.1.1.2.2">𝑀</ci><ci id="S3.SS4.p5.4.m4.1.1.2.3.cmml" xref="S3.SS4.p5.4.m4.1.1.2.3">layer</ci></apply><apply id="S3.SS4.p5.4.m4.1.1.3.cmml" xref="S3.SS4.p5.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p5.4.m4.1.1.3.1.cmml" xref="S3.SS4.p5.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.p5.4.m4.1.1.3.2.cmml" xref="S3.SS4.p5.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS4.p5.4.m4.1.1.3.3.cmml" xref="S3.SS4.p5.4.m4.1.1.3.3"><times id="S3.SS4.p5.4.m4.1.1.3.3.1.cmml" xref="S3.SS4.p5.4.m4.1.1.3.3.1"></times><ci id="S3.SS4.p5.4.m4.1.1.3.3.2.cmml" xref="S3.SS4.p5.4.m4.1.1.3.3.2">𝑛</ci><ci id="S3.SS4.p5.4.m4.1.1.3.3.3.cmml" xref="S3.SS4.p5.4.m4.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.4.m4.1c">M_{\mathrm{layer}}\in\mathbb{R}^{n\times m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.4.m4.1d">italic_M start_POSTSUBSCRIPT roman_layer end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS4.p5.5.m5.1"><semantics id="S3.SS4.p5.5.m5.1a"><mi id="S3.SS4.p5.5.m5.1.1" xref="S3.SS4.p5.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.5.m5.1b"><ci id="S3.SS4.p5.5.m5.1.1.cmml" xref="S3.SS4.p5.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.5.m5.1d">italic_n</annotation></semantics></math> represents the number of layers in one model and <math alttext="m" class="ltx_Math" display="inline" id="S3.SS4.p5.6.m6.1"><semantics id="S3.SS4.p5.6.m6.1a"><mi id="S3.SS4.p5.6.m6.1.1" xref="S3.SS4.p5.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.6.m6.1b"><ci id="S3.SS4.p5.6.m6.1.1.cmml" xref="S3.SS4.p5.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.6.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.6.m6.1d">italic_m</annotation></semantics></math> denotes the number of layers in the other. Softmax is applied to this matrix for layer selection. We call this matching process as Spatial-Semantic Decomposition (SSD), where the matched features can be expressed as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx10">
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\left\{\begin{array}[]{ c l }\mathcal{F}_{1},\mathcal{F}_{2}\,%
\cdot\mathrm{softmax}(M^{\mathrm{T}}_{\mathrm{layer}})&amp;\quad m&gt;n\\
\mathcal{F}_{1}\,\cdot\mathrm{softmax}(M_{\mathrm{layer}}),\mathcal{F}_{2}&amp;%
\quad\textrm{otherwise}\end{array}\right.\;." class="ltx_Math" display="inline" id="S3.E13.m1.2"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2.1"><mrow id="S3.E13.m1.2.2.1.1.2" xref="S3.E13.m1.2.2.1.1.1.cmml"><mo id="S3.E13.m1.2.2.1.1.2.1" xref="S3.E13.m1.2.2.1.1.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S3.E13.m1.1.1" rowspacing="0pt" xref="S3.E13.m1.1.1.cmml"><mtr id="S3.E13.m1.1.1a" xref="S3.E13.m1.1.1.cmml"><mtd id="S3.E13.m1.1.1b" xref="S3.E13.m1.1.1.cmml"><mrow id="S3.E11.2.2.2" xref="S3.E11.2.2.3.cmml"><msub id="S3.E11.1.1.1.1" xref="S3.E11.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.1.1.1.1.2" xref="S3.E11.1.1.1.1.2.cmml">ℱ</mi><mn id="S3.E11.1.1.1.1.3" xref="S3.E11.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E11.2.2.2.3" xref="S3.E11.2.2.3.cmml">,</mo><mrow id="S3.E11.2.2.2.2" xref="S3.E11.2.2.2.2.cmml"><mrow id="S3.E11.2.2.2.2.3" xref="S3.E11.2.2.2.2.3.cmml"><msub id="S3.E11.2.2.2.2.3.2" xref="S3.E11.2.2.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.2.2.2.2.3.2.2" xref="S3.E11.2.2.2.2.3.2.2.cmml">ℱ</mi><mn id="S3.E11.2.2.2.2.3.2.3" xref="S3.E11.2.2.2.2.3.2.3.cmml">2</mn></msub><mo id="S3.E11.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E11.2.2.2.2.3.1.cmml">⋅</mo><mi id="S3.E11.2.2.2.2.3.3" xref="S3.E11.2.2.2.2.3.3.cmml">softmax</mi></mrow><mo id="S3.E11.2.2.2.2.2" xref="S3.E11.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E11.2.2.2.2.1.1" xref="S3.E11.2.2.2.2.1.1.1.cmml"><mo id="S3.E11.2.2.2.2.1.1.2" stretchy="false" xref="S3.E11.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S3.E11.2.2.2.2.1.1.1" xref="S3.E11.2.2.2.2.1.1.1.cmml"><mi id="S3.E11.2.2.2.2.1.1.1.2.2" xref="S3.E11.2.2.2.2.1.1.1.2.2.cmml">M</mi><mi id="S3.E11.2.2.2.2.1.1.1.3" xref="S3.E11.2.2.2.2.1.1.1.3.cmml">layer</mi><mi id="S3.E11.2.2.2.2.1.1.1.2.3" mathvariant="normal" xref="S3.E11.2.2.2.2.1.1.1.2.3.cmml">T</mi></msubsup><mo id="S3.E11.2.2.2.2.1.1.3" stretchy="false" xref="S3.E11.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.1.1c" xref="S3.E13.m1.1.1.cmml"><mrow id="S3.E11.3.1" xref="S3.E11.3.1.cmml"><mi id="S3.E11.3.1.2" xref="S3.E11.3.1.2.cmml">m</mi><mo id="S3.E11.3.1.1" xref="S3.E11.3.1.1.cmml">&gt;</mo><mi id="S3.E11.3.1.3" xref="S3.E11.3.1.3.cmml">n</mi></mrow></mtd></mtr><mtr id="S3.E13.m1.1.1d" xref="S3.E13.m1.1.1.cmml"><mtd id="S3.E13.m1.1.1e" xref="S3.E13.m1.1.1.cmml"><mrow id="S3.E12.2.2.2" xref="S3.E12.2.2.3.cmml"><mrow id="S3.E12.1.1.1.1" xref="S3.E12.1.1.1.1.cmml"><mrow id="S3.E12.1.1.1.1.3" xref="S3.E12.1.1.1.1.3.cmml"><msub id="S3.E12.1.1.1.1.3.2" xref="S3.E12.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.1.1.1.1.3.2.2" xref="S3.E12.1.1.1.1.3.2.2.cmml">ℱ</mi><mn id="S3.E12.1.1.1.1.3.2.3" xref="S3.E12.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.E12.1.1.1.1.3.1" lspace="0.392em" rspace="0.222em" xref="S3.E12.1.1.1.1.3.1.cmml">⋅</mo><mi id="S3.E12.1.1.1.1.3.3" xref="S3.E12.1.1.1.1.3.3.cmml">softmax</mi></mrow><mo id="S3.E12.1.1.1.1.2" xref="S3.E12.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.1.1.1.1.1.1" xref="S3.E12.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.1.1.1.1.1.1.2" stretchy="false" xref="S3.E12.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E12.1.1.1.1.1.1.1" xref="S3.E12.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.1.1.1.1.1.1.1.2" xref="S3.E12.1.1.1.1.1.1.1.2.cmml">M</mi><mi id="S3.E12.1.1.1.1.1.1.1.3" xref="S3.E12.1.1.1.1.1.1.1.3.cmml">layer</mi></msub><mo id="S3.E12.1.1.1.1.1.1.3" stretchy="false" xref="S3.E12.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.2.2.2.3" xref="S3.E12.2.2.3.cmml">,</mo><msub id="S3.E12.2.2.2.2" xref="S3.E12.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.2.2.2.2.2" xref="S3.E12.2.2.2.2.2.cmml">ℱ</mi><mn id="S3.E12.2.2.2.2.3" xref="S3.E12.2.2.2.2.3.cmml">2</mn></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.1.1f" xref="S3.E13.m1.1.1.cmml"><mtext id="S3.E12.3.1" xref="S3.E12.3.1a.cmml">otherwise</mtext></mtd></mtr></mtable><mi id="S3.E13.m1.2.2.1.1.2.2" xref="S3.E13.m1.2.2.1.1.1.1.cmml"></mi></mrow><mo id="S3.E13.m1.2.2.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.2"><csymbol cd="latexml" id="S3.E13.m1.2.2.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.2.1">cases</csymbol><matrix id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><matrixrow id="S3.E13.m1.1.1a.cmml" xref="S3.E13.m1.1.1"><list id="S3.E11.2.2.3.cmml" xref="S3.E11.2.2.2"><apply id="S3.E11.1.1.1.1.cmml" xref="S3.E11.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.1.1.1.1.1.cmml" xref="S3.E11.1.1.1.1">subscript</csymbol><ci id="S3.E11.1.1.1.1.2.cmml" xref="S3.E11.1.1.1.1.2">ℱ</ci><cn id="S3.E11.1.1.1.1.3.cmml" type="integer" xref="S3.E11.1.1.1.1.3">1</cn></apply><apply id="S3.E11.2.2.2.2.cmml" xref="S3.E11.2.2.2.2"><times id="S3.E11.2.2.2.2.2.cmml" xref="S3.E11.2.2.2.2.2"></times><apply id="S3.E11.2.2.2.2.3.cmml" xref="S3.E11.2.2.2.2.3"><ci id="S3.E11.2.2.2.2.3.1.cmml" xref="S3.E11.2.2.2.2.3.1">⋅</ci><apply id="S3.E11.2.2.2.2.3.2.cmml" xref="S3.E11.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E11.2.2.2.2.3.2.1.cmml" xref="S3.E11.2.2.2.2.3.2">subscript</csymbol><ci id="S3.E11.2.2.2.2.3.2.2.cmml" xref="S3.E11.2.2.2.2.3.2.2">ℱ</ci><cn id="S3.E11.2.2.2.2.3.2.3.cmml" type="integer" xref="S3.E11.2.2.2.2.3.2.3">2</cn></apply><ci id="S3.E11.2.2.2.2.3.3.cmml" xref="S3.E11.2.2.2.2.3.3">softmax</ci></apply><apply id="S3.E11.2.2.2.2.1.1.1.cmml" xref="S3.E11.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E11.2.2.2.2.1.1.1.1.cmml" xref="S3.E11.2.2.2.2.1.1">subscript</csymbol><apply id="S3.E11.2.2.2.2.1.1.1.2.cmml" xref="S3.E11.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E11.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E11.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E11.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E11.2.2.2.2.1.1.1.2.2">𝑀</ci><ci id="S3.E11.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E11.2.2.2.2.1.1.1.2.3">T</ci></apply><ci id="S3.E11.2.2.2.2.1.1.1.3.cmml" xref="S3.E11.2.2.2.2.1.1.1.3">layer</ci></apply></apply></list><apply id="S3.E11.3.1.cmml" xref="S3.E11.3.1"><gt id="S3.E11.3.1.1.cmml" xref="S3.E11.3.1.1"></gt><ci id="S3.E11.3.1.2.cmml" xref="S3.E11.3.1.2">𝑚</ci><ci id="S3.E11.3.1.3.cmml" xref="S3.E11.3.1.3">𝑛</ci></apply></matrixrow><matrixrow id="S3.E13.m1.1.1b.cmml" xref="S3.E13.m1.1.1"><list id="S3.E12.2.2.3.cmml" xref="S3.E12.2.2.2"><apply id="S3.E12.1.1.1.1.cmml" xref="S3.E12.1.1.1.1"><times id="S3.E12.1.1.1.1.2.cmml" xref="S3.E12.1.1.1.1.2"></times><apply id="S3.E12.1.1.1.1.3.cmml" xref="S3.E12.1.1.1.1.3"><ci id="S3.E12.1.1.1.1.3.1.cmml" xref="S3.E12.1.1.1.1.3.1">⋅</ci><apply id="S3.E12.1.1.1.1.3.2.cmml" xref="S3.E12.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.1.1.1.1.3.2.1.cmml" xref="S3.E12.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E12.1.1.1.1.3.2.2.cmml" xref="S3.E12.1.1.1.1.3.2.2">ℱ</ci><cn id="S3.E12.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E12.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.E12.1.1.1.1.3.3.cmml" xref="S3.E12.1.1.1.1.3.3">softmax</ci></apply><apply id="S3.E12.1.1.1.1.1.1.1.cmml" xref="S3.E12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S3.E12.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.1.1.1.1.1.1.1.3">layer</ci></apply></apply><apply id="S3.E12.2.2.2.2.cmml" xref="S3.E12.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.2.2.2.2.1.cmml" xref="S3.E12.2.2.2.2">subscript</csymbol><ci id="S3.E12.2.2.2.2.2.cmml" xref="S3.E12.2.2.2.2.2">ℱ</ci><cn id="S3.E12.2.2.2.2.3.cmml" type="integer" xref="S3.E12.2.2.2.2.3">2</cn></apply></list><ci id="S3.E12.3.1a.cmml" xref="S3.E12.3.1"><mtext id="S3.E12.3.1.cmml" xref="S3.E12.3.1">otherwise</mtext></ci></matrixrow></matrix></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">\displaystyle\left\{\begin{array}[]{ c l }\mathcal{F}_{1},\mathcal{F}_{2}\,%
\cdot\mathrm{softmax}(M^{\mathrm{T}}_{\mathrm{layer}})&amp;\quad m&gt;n\\
\mathcal{F}_{1}\,\cdot\mathrm{softmax}(M_{\mathrm{layer}}),\mathcal{F}_{2}&amp;%
\quad\textrm{otherwise}\end{array}\right.\;.</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.2d">{ start_ARRAY start_ROW start_CELL caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⋅ roman_softmax ( italic_M start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_layer end_POSTSUBSCRIPT ) end_CELL start_CELL italic_m &gt; italic_n end_CELL end_ROW start_ROW start_CELL caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋅ roman_softmax ( italic_M start_POSTSUBSCRIPT roman_layer end_POSTSUBSCRIPT ) , caligraphic_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL start_CELL otherwise end_CELL end_ROW end_ARRAY .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p5.12">Here, we align the number of layers to the smaller one, which is found to be empirically better.
This gives us two <math alttext="\mathbb{R}^{(wh+1)\times d\times n}" class="ltx_Math" display="inline" id="S3.SS4.p5.7.m1.1"><semantics id="S3.SS4.p5.7.m1.1a"><msup id="S3.SS4.p5.7.m1.1.2" xref="S3.SS4.p5.7.m1.1.2.cmml"><mi id="S3.SS4.p5.7.m1.1.2.2" xref="S3.SS4.p5.7.m1.1.2.2.cmml">ℝ</mi><mrow id="S3.SS4.p5.7.m1.1.1.1" xref="S3.SS4.p5.7.m1.1.1.1.cmml"><mrow id="S3.SS4.p5.7.m1.1.1.1.1.1" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p5.7.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p5.7.m1.1.1.1.1.1.1" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p5.7.m1.1.1.1.1.1.1.2" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.2" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.2.cmml">w</mi><mo id="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.1" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.3" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.3.cmml">h</mi></mrow><mo id="S3.SS4.p5.7.m1.1.1.1.1.1.1.1" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p5.7.m1.1.1.1.1.1.1.3" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p5.7.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p5.7.m1.1.1.1.2" rspace="0.222em" xref="S3.SS4.p5.7.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p5.7.m1.1.1.1.3" xref="S3.SS4.p5.7.m1.1.1.1.3.cmml">d</mi><mo id="S3.SS4.p5.7.m1.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p5.7.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p5.7.m1.1.1.1.4" xref="S3.SS4.p5.7.m1.1.1.1.4.cmml">n</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.7.m1.1b"><apply id="S3.SS4.p5.7.m1.1.2.cmml" xref="S3.SS4.p5.7.m1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p5.7.m1.1.2.1.cmml" xref="S3.SS4.p5.7.m1.1.2">superscript</csymbol><ci id="S3.SS4.p5.7.m1.1.2.2.cmml" xref="S3.SS4.p5.7.m1.1.2.2">ℝ</ci><apply id="S3.SS4.p5.7.m1.1.1.1.cmml" xref="S3.SS4.p5.7.m1.1.1.1"><times id="S3.SS4.p5.7.m1.1.1.1.2.cmml" xref="S3.SS4.p5.7.m1.1.1.1.2"></times><apply id="S3.SS4.p5.7.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.7.m1.1.1.1.1.1"><plus id="S3.SS4.p5.7.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.2"><times id="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.p5.7.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p5.7.m1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS4.p5.7.m1.1.1.1.3.cmml" xref="S3.SS4.p5.7.m1.1.1.1.3">𝑑</ci><ci id="S3.SS4.p5.7.m1.1.1.1.4.cmml" xref="S3.SS4.p5.7.m1.1.1.1.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.7.m1.1c">\mathbb{R}^{(wh+1)\times d\times n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.7.m1.1d">blackboard_R start_POSTSUPERSCRIPT ( italic_w italic_h + 1 ) × italic_d × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> of dimension-aligned features when <math alttext="m&gt;n" class="ltx_Math" display="inline" id="S3.SS4.p5.8.m2.1"><semantics id="S3.SS4.p5.8.m2.1a"><mrow id="S3.SS4.p5.8.m2.1.1" xref="S3.SS4.p5.8.m2.1.1.cmml"><mi id="S3.SS4.p5.8.m2.1.1.2" xref="S3.SS4.p5.8.m2.1.1.2.cmml">m</mi><mo id="S3.SS4.p5.8.m2.1.1.1" xref="S3.SS4.p5.8.m2.1.1.1.cmml">&gt;</mo><mi id="S3.SS4.p5.8.m2.1.1.3" xref="S3.SS4.p5.8.m2.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.8.m2.1b"><apply id="S3.SS4.p5.8.m2.1.1.cmml" xref="S3.SS4.p5.8.m2.1.1"><gt id="S3.SS4.p5.8.m2.1.1.1.cmml" xref="S3.SS4.p5.8.m2.1.1.1"></gt><ci id="S3.SS4.p5.8.m2.1.1.2.cmml" xref="S3.SS4.p5.8.m2.1.1.2">𝑚</ci><ci id="S3.SS4.p5.8.m2.1.1.3.cmml" xref="S3.SS4.p5.8.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.8.m2.1c">m&gt;n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.8.m2.1d">italic_m &gt; italic_n</annotation></semantics></math> or <math alttext="\mathbb{R}^{(wh+1)\times d\times m}" class="ltx_Math" display="inline" id="S3.SS4.p5.9.m3.1"><semantics id="S3.SS4.p5.9.m3.1a"><msup id="S3.SS4.p5.9.m3.1.2" xref="S3.SS4.p5.9.m3.1.2.cmml"><mi id="S3.SS4.p5.9.m3.1.2.2" xref="S3.SS4.p5.9.m3.1.2.2.cmml">ℝ</mi><mrow id="S3.SS4.p5.9.m3.1.1.1" xref="S3.SS4.p5.9.m3.1.1.1.cmml"><mrow id="S3.SS4.p5.9.m3.1.1.1.1.1" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p5.9.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p5.9.m3.1.1.1.1.1.1" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p5.9.m3.1.1.1.1.1.1.2" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.2" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.2.cmml">w</mi><mo id="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.1" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.3" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.3.cmml">h</mi></mrow><mo id="S3.SS4.p5.9.m3.1.1.1.1.1.1.1" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS4.p5.9.m3.1.1.1.1.1.1.3" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p5.9.m3.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.p5.9.m3.1.1.1.2" rspace="0.222em" xref="S3.SS4.p5.9.m3.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p5.9.m3.1.1.1.3" xref="S3.SS4.p5.9.m3.1.1.1.3.cmml">d</mi><mo id="S3.SS4.p5.9.m3.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p5.9.m3.1.1.1.2.cmml">×</mo><mi id="S3.SS4.p5.9.m3.1.1.1.4" xref="S3.SS4.p5.9.m3.1.1.1.4.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.9.m3.1b"><apply id="S3.SS4.p5.9.m3.1.2.cmml" xref="S3.SS4.p5.9.m3.1.2"><csymbol cd="ambiguous" id="S3.SS4.p5.9.m3.1.2.1.cmml" xref="S3.SS4.p5.9.m3.1.2">superscript</csymbol><ci id="S3.SS4.p5.9.m3.1.2.2.cmml" xref="S3.SS4.p5.9.m3.1.2.2">ℝ</ci><apply id="S3.SS4.p5.9.m3.1.1.1.cmml" xref="S3.SS4.p5.9.m3.1.1.1"><times id="S3.SS4.p5.9.m3.1.1.1.2.cmml" xref="S3.SS4.p5.9.m3.1.1.1.2"></times><apply id="S3.SS4.p5.9.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.9.m3.1.1.1.1.1"><plus id="S3.SS4.p5.9.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.2"><times id="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.1"></times><ci id="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.p5.9.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p5.9.m3.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS4.p5.9.m3.1.1.1.3.cmml" xref="S3.SS4.p5.9.m3.1.1.1.3">𝑑</ci><ci id="S3.SS4.p5.9.m3.1.1.1.4.cmml" xref="S3.SS4.p5.9.m3.1.1.1.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.9.m3.1c">\mathbb{R}^{(wh+1)\times d\times m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.9.m3.1d">blackboard_R start_POSTSUPERSCRIPT ( italic_w italic_h + 1 ) × italic_d × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> dimension of feature otherwise.
Both the feature affine matrixes (<math alttext="W^{1}" class="ltx_Math" display="inline" id="S3.SS4.p5.10.m4.1"><semantics id="S3.SS4.p5.10.m4.1a"><msup id="S3.SS4.p5.10.m4.1.1" xref="S3.SS4.p5.10.m4.1.1.cmml"><mi id="S3.SS4.p5.10.m4.1.1.2" xref="S3.SS4.p5.10.m4.1.1.2.cmml">W</mi><mn id="S3.SS4.p5.10.m4.1.1.3" xref="S3.SS4.p5.10.m4.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.10.m4.1b"><apply id="S3.SS4.p5.10.m4.1.1.cmml" xref="S3.SS4.p5.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.10.m4.1.1.1.cmml" xref="S3.SS4.p5.10.m4.1.1">superscript</csymbol><ci id="S3.SS4.p5.10.m4.1.1.2.cmml" xref="S3.SS4.p5.10.m4.1.1.2">𝑊</ci><cn id="S3.SS4.p5.10.m4.1.1.3.cmml" type="integer" xref="S3.SS4.p5.10.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.10.m4.1c">W^{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.10.m4.1d">italic_W start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W^{2}" class="ltx_Math" display="inline" id="S3.SS4.p5.11.m5.1"><semantics id="S3.SS4.p5.11.m5.1a"><msup id="S3.SS4.p5.11.m5.1.1" xref="S3.SS4.p5.11.m5.1.1.cmml"><mi id="S3.SS4.p5.11.m5.1.1.2" xref="S3.SS4.p5.11.m5.1.1.2.cmml">W</mi><mn id="S3.SS4.p5.11.m5.1.1.3" xref="S3.SS4.p5.11.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.11.m5.1b"><apply id="S3.SS4.p5.11.m5.1.1.cmml" xref="S3.SS4.p5.11.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.11.m5.1.1.1.cmml" xref="S3.SS4.p5.11.m5.1.1">superscript</csymbol><ci id="S3.SS4.p5.11.m5.1.1.2.cmml" xref="S3.SS4.p5.11.m5.1.1.2">𝑊</ci><cn id="S3.SS4.p5.11.m5.1.1.3.cmml" type="integer" xref="S3.SS4.p5.11.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.11.m5.1c">W^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.11.m5.1d">italic_W start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>) and the layer matching matrix (<math alttext="M_{\mathrm{layer}}" class="ltx_Math" display="inline" id="S3.SS4.p5.12.m6.1"><semantics id="S3.SS4.p5.12.m6.1a"><msub id="S3.SS4.p5.12.m6.1.1" xref="S3.SS4.p5.12.m6.1.1.cmml"><mi id="S3.SS4.p5.12.m6.1.1.2" xref="S3.SS4.p5.12.m6.1.1.2.cmml">M</mi><mi id="S3.SS4.p5.12.m6.1.1.3" xref="S3.SS4.p5.12.m6.1.1.3.cmml">layer</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.12.m6.1b"><apply id="S3.SS4.p5.12.m6.1.1.cmml" xref="S3.SS4.p5.12.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.12.m6.1.1.1.cmml" xref="S3.SS4.p5.12.m6.1.1">subscript</csymbol><ci id="S3.SS4.p5.12.m6.1.1.2.cmml" xref="S3.SS4.p5.12.m6.1.1.2">𝑀</ci><ci id="S3.SS4.p5.12.m6.1.1.3.cmml" xref="S3.SS4.p5.12.m6.1.1.3">layer</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.12.m6.1c">M_{\mathrm{layer}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.12.m6.1d">italic_M start_POSTSUBSCRIPT roman_layer end_POSTSUBSCRIPT</annotation></semantics></math>) undergo training to ensure feature alignment between the models at each step.
Note again that we give an example using CNN and ViT, but our method can be extended to any model with spatial features.</p>
</div>
<div class="ltx_para" id="S3.SS4.p6">
<p class="ltx_p" id="S3.SS4.p6.2">The Spatial-Semantic Decomposition method enables a comparison of the distinct features of two models.
Throughout the training process, we propose Mutual Distillation (MD) to align the meanings of these features, aiming to make them similar knowledge across both models.
The training loss for each model <math alttext="f_{1}" class="ltx_Math" display="inline" id="S3.SS4.p6.1.m1.1"><semantics id="S3.SS4.p6.1.m1.1a"><msub id="S3.SS4.p6.1.m1.1.1" xref="S3.SS4.p6.1.m1.1.1.cmml"><mi id="S3.SS4.p6.1.m1.1.1.2" xref="S3.SS4.p6.1.m1.1.1.2.cmml">f</mi><mn id="S3.SS4.p6.1.m1.1.1.3" xref="S3.SS4.p6.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.1.m1.1b"><apply id="S3.SS4.p6.1.m1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.1.m1.1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p6.1.m1.1.1.2.cmml" xref="S3.SS4.p6.1.m1.1.1.2">𝑓</ci><cn id="S3.SS4.p6.1.m1.1.1.3.cmml" type="integer" xref="S3.SS4.p6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.1.m1.1c">f_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.1.m1.1d">italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{2}" class="ltx_Math" display="inline" id="S3.SS4.p6.2.m2.1"><semantics id="S3.SS4.p6.2.m2.1a"><msub id="S3.SS4.p6.2.m2.1.1" xref="S3.SS4.p6.2.m2.1.1.cmml"><mi id="S3.SS4.p6.2.m2.1.1.2" xref="S3.SS4.p6.2.m2.1.1.2.cmml">f</mi><mn id="S3.SS4.p6.2.m2.1.1.3" xref="S3.SS4.p6.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.2.m2.1b"><apply id="S3.SS4.p6.2.m2.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.2.m2.1.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p6.2.m2.1.1.2.cmml" xref="S3.SS4.p6.2.m2.1.1.2">𝑓</ci><cn id="S3.SS4.p6.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p6.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.2.m2.1c">f_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.2.m2.1d">italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is expressed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx11">
<tbody id="S3.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\mathrm{MD}}\left(\textbf{x}\right)=\mathrm{MSE}(%
\mathrm{SSD}\left(f_{\theta_{1}}\left(\textbf{x}\right),f_{\theta_{2}}\left(%
\textbf{x}\right)\right))," class="ltx_Math" display="inline" id="S3.Ex7.m1.4"><semantics id="S3.Ex7.m1.4a"><mrow id="S3.Ex7.m1.4.4.1" xref="S3.Ex7.m1.4.4.1.1.cmml"><mrow id="S3.Ex7.m1.4.4.1.1" xref="S3.Ex7.m1.4.4.1.1.cmml"><mrow id="S3.Ex7.m1.4.4.1.1.3" xref="S3.Ex7.m1.4.4.1.1.3.cmml"><msub id="S3.Ex7.m1.4.4.1.1.3.2" xref="S3.Ex7.m1.4.4.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.4.4.1.1.3.2.2" xref="S3.Ex7.m1.4.4.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.Ex7.m1.4.4.1.1.3.2.3" xref="S3.Ex7.m1.4.4.1.1.3.2.3.cmml">MD</mi></msub><mo id="S3.Ex7.m1.4.4.1.1.3.1" xref="S3.Ex7.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.4.4.1.1.3.3.2" xref="S3.Ex7.m1.1.1a.cmml"><mo id="S3.Ex7.m1.4.4.1.1.3.3.2.1" xref="S3.Ex7.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml">x</mtext><mo id="S3.Ex7.m1.4.4.1.1.3.3.2.2" xref="S3.Ex7.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.4.4.1.1.2" xref="S3.Ex7.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.Ex7.m1.4.4.1.1.1" xref="S3.Ex7.m1.4.4.1.1.1.cmml"><mi id="S3.Ex7.m1.4.4.1.1.1.3" xref="S3.Ex7.m1.4.4.1.1.1.3.cmml">MSE</mi><mo id="S3.Ex7.m1.4.4.1.1.1.2" xref="S3.Ex7.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.4.4.1.1.1.1.1" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex7.m1.4.4.1.1.1.1.1.1" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.4.4.1.1.1.1.1.1.4" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.4.cmml">SSD</mi><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.3" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.3.cmml"><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><msub id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2.cmml">θ</mi><mn id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex7.m1.2.2a.cmml"><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.Ex7.m1.2.2a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.Ex7.m1.2.2" xref="S3.Ex7.m1.2.2.cmml">x</mtext><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex7.m1.2.2a.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.4" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.cmml"><msub id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.2" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml">f</mi><msub id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.2.cmml">θ</mi><mn id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.1" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.3.2" xref="S3.Ex7.m1.3.3a.cmml"><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.3.2.1" xref="S3.Ex7.m1.3.3a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.Ex7.m1.3.3" xref="S3.Ex7.m1.3.3.cmml">x</mtext><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.3.2.2" xref="S3.Ex7.m1.3.3a.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.5" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex7.m1.4.4.1.2" xref="S3.Ex7.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.4b"><apply id="S3.Ex7.m1.4.4.1.1.cmml" xref="S3.Ex7.m1.4.4.1"><eq id="S3.Ex7.m1.4.4.1.1.2.cmml" xref="S3.Ex7.m1.4.4.1.1.2"></eq><apply id="S3.Ex7.m1.4.4.1.1.3.cmml" xref="S3.Ex7.m1.4.4.1.1.3"><times id="S3.Ex7.m1.4.4.1.1.3.1.cmml" xref="S3.Ex7.m1.4.4.1.1.3.1"></times><apply id="S3.Ex7.m1.4.4.1.1.3.2.cmml" xref="S3.Ex7.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.1.1.3.2.1.cmml" xref="S3.Ex7.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S3.Ex7.m1.4.4.1.1.3.2.2.cmml" xref="S3.Ex7.m1.4.4.1.1.3.2.2">ℒ</ci><ci id="S3.Ex7.m1.4.4.1.1.3.2.3.cmml" xref="S3.Ex7.m1.4.4.1.1.3.2.3">MD</ci></apply><ci id="S3.Ex7.m1.1.1a.cmml" xref="S3.Ex7.m1.4.4.1.1.3.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1">x</mtext></ci></apply><apply id="S3.Ex7.m1.4.4.1.1.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1"><times id="S3.Ex7.m1.4.4.1.1.1.2.cmml" xref="S3.Ex7.m1.4.4.1.1.1.2"></times><ci id="S3.Ex7.m1.4.4.1.1.1.3.cmml" xref="S3.Ex7.m1.4.4.1.1.1.3">MSE</ci><apply id="S3.Ex7.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1"><times id="S3.Ex7.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.3"></times><ci id="S3.Ex7.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.4">SSD</ci><interval closure="open" id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2"><apply id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1"><times id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2">𝜃</ci><cn id="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex7.m1.2.2a.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex7.m1.2.2.cmml" xref="S3.Ex7.m1.2.2">x</mtext></ci></apply><apply id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2"><times id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.1"></times><apply id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.2">𝑓</ci><apply id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.2">𝜃</ci><cn id="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.2.3.3">2</cn></apply></apply><ci id="S3.Ex7.m1.3.3a.cmml" xref="S3.Ex7.m1.4.4.1.1.1.1.1.1.2.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex7.m1.3.3.cmml" xref="S3.Ex7.m1.3.3">x</mtext></ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.4c">\displaystyle\mathcal{L}_{\mathrm{MD}}\left(\textbf{x}\right)=\mathrm{MSE}(%
\mathrm{SSD}\left(f_{\theta_{1}}\left(\textbf{x}\right),f_{\theta_{2}}\left(%
\textbf{x}\right)\right)),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.4d">caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT ( x ) = roman_MSE ( roman_SSD ( italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( x ) , italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( x ) ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{f_{1}}=\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{1}}%
\left(\textbf{x}\right),y\right)+\mathcal{L}_{\mathrm{MD}}(\textbf{x}),\;\," class="ltx_Math" display="inline" id="S3.Ex8.m1.4"><semantics id="S3.Ex8.m1.4a"><mrow id="S3.Ex8.m1.4.4.1" xref="S3.Ex8.m1.4.4.1.1.cmml"><mrow id="S3.Ex8.m1.4.4.1.1" xref="S3.Ex8.m1.4.4.1.1.cmml"><msub id="S3.Ex8.m1.4.4.1.1.3" xref="S3.Ex8.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex8.m1.4.4.1.1.3.2" xref="S3.Ex8.m1.4.4.1.1.3.2.cmml">ℒ</mi><msub id="S3.Ex8.m1.4.4.1.1.3.3" xref="S3.Ex8.m1.4.4.1.1.3.3.cmml"><mi id="S3.Ex8.m1.4.4.1.1.3.3.2" xref="S3.Ex8.m1.4.4.1.1.3.3.2.cmml">f</mi><mn id="S3.Ex8.m1.4.4.1.1.3.3.3" xref="S3.Ex8.m1.4.4.1.1.3.3.3.cmml">1</mn></msub></msub><mo id="S3.Ex8.m1.4.4.1.1.2" xref="S3.Ex8.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.Ex8.m1.4.4.1.1.1" xref="S3.Ex8.m1.4.4.1.1.1.cmml"><mrow id="S3.Ex8.m1.4.4.1.1.1.1" xref="S3.Ex8.m1.4.4.1.1.1.1.cmml"><msub id="S3.Ex8.m1.4.4.1.1.1.1.3" xref="S3.Ex8.m1.4.4.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex8.m1.4.4.1.1.1.1.3.2" xref="S3.Ex8.m1.4.4.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S3.Ex8.m1.4.4.1.1.1.1.3.3" xref="S3.Ex8.m1.4.4.1.1.1.1.3.3.cmml">CE</mi></msub><mo id="S3.Ex8.m1.4.4.1.1.1.1.2" xref="S3.Ex8.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex8.m1.4.4.1.1.1.1.1.1" xref="S3.Ex8.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.Ex8.m1.4.4.1.1.1.1.1.1.2" xref="S3.Ex8.m1.4.4.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">f</mi><msub id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml">θ</mi><mn id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.Ex8.m1.1.1a.cmml"><mo id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2.1" xref="S3.Ex8.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.Ex8.m1.1.1" xref="S3.Ex8.m1.1.1.cmml">x</mtext><mo id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex8.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="S3.Ex8.m1.4.4.1.1.1.1.1.1.3" xref="S3.Ex8.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex8.m1.2.2" xref="S3.Ex8.m1.2.2.cmml">y</mi><mo id="S3.Ex8.m1.4.4.1.1.1.1.1.1.4" xref="S3.Ex8.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex8.m1.4.4.1.1.1.2" xref="S3.Ex8.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S3.Ex8.m1.4.4.1.1.1.3" xref="S3.Ex8.m1.4.4.1.1.1.3.cmml"><msub id="S3.Ex8.m1.4.4.1.1.1.3.2" xref="S3.Ex8.m1.4.4.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex8.m1.4.4.1.1.1.3.2.2" xref="S3.Ex8.m1.4.4.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.Ex8.m1.4.4.1.1.1.3.2.3" xref="S3.Ex8.m1.4.4.1.1.1.3.2.3.cmml">MD</mi></msub><mo id="S3.Ex8.m1.4.4.1.1.1.3.1" xref="S3.Ex8.m1.4.4.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.Ex8.m1.4.4.1.1.1.3.3.2" xref="S3.Ex8.m1.3.3a.cmml"><mo id="S3.Ex8.m1.4.4.1.1.1.3.3.2.1" stretchy="false" xref="S3.Ex8.m1.3.3a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.Ex8.m1.3.3" xref="S3.Ex8.m1.3.3.cmml">x</mtext><mo id="S3.Ex8.m1.4.4.1.1.1.3.3.2.2" stretchy="false" xref="S3.Ex8.m1.3.3a.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex8.m1.4.4.1.2" xref="S3.Ex8.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8.m1.4b"><apply id="S3.Ex8.m1.4.4.1.1.cmml" xref="S3.Ex8.m1.4.4.1"><eq id="S3.Ex8.m1.4.4.1.1.2.cmml" xref="S3.Ex8.m1.4.4.1.1.2"></eq><apply id="S3.Ex8.m1.4.4.1.1.3.cmml" xref="S3.Ex8.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.4.4.1.1.3.1.cmml" xref="S3.Ex8.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.Ex8.m1.4.4.1.1.3.2.cmml" xref="S3.Ex8.m1.4.4.1.1.3.2">ℒ</ci><apply id="S3.Ex8.m1.4.4.1.1.3.3.cmml" xref="S3.Ex8.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.4.4.1.1.3.3.1.cmml" xref="S3.Ex8.m1.4.4.1.1.3.3">subscript</csymbol><ci id="S3.Ex8.m1.4.4.1.1.3.3.2.cmml" xref="S3.Ex8.m1.4.4.1.1.3.3.2">𝑓</ci><cn id="S3.Ex8.m1.4.4.1.1.3.3.3.cmml" type="integer" xref="S3.Ex8.m1.4.4.1.1.3.3.3">1</cn></apply></apply><apply id="S3.Ex8.m1.4.4.1.1.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1"><plus id="S3.Ex8.m1.4.4.1.1.1.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.2"></plus><apply id="S3.Ex8.m1.4.4.1.1.1.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1"><times id="S3.Ex8.m1.4.4.1.1.1.1.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.2"></times><apply id="S3.Ex8.m1.4.4.1.1.1.1.3.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex8.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.3.2">ℒ</ci><ci id="S3.Ex8.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.3.3">CE</ci></apply><interval closure="open" id="S3.Ex8.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1"><apply id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1"><times id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.2">𝜃</ci><cn id="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex8.m1.1.1a.cmml" xref="S3.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex8.m1.1.1.cmml" xref="S3.Ex8.m1.1.1">x</mtext></ci></apply><ci id="S3.Ex8.m1.2.2.cmml" xref="S3.Ex8.m1.2.2">𝑦</ci></interval></apply><apply id="S3.Ex8.m1.4.4.1.1.1.3.cmml" xref="S3.Ex8.m1.4.4.1.1.1.3"><times id="S3.Ex8.m1.4.4.1.1.1.3.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1.3.1"></times><apply id="S3.Ex8.m1.4.4.1.1.1.3.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.4.4.1.1.1.3.2.1.cmml" xref="S3.Ex8.m1.4.4.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex8.m1.4.4.1.1.1.3.2.2.cmml" xref="S3.Ex8.m1.4.4.1.1.1.3.2.2">ℒ</ci><ci id="S3.Ex8.m1.4.4.1.1.1.3.2.3.cmml" xref="S3.Ex8.m1.4.4.1.1.1.3.2.3">MD</ci></apply><ci id="S3.Ex8.m1.3.3a.cmml" xref="S3.Ex8.m1.4.4.1.1.1.3.3.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex8.m1.3.3.cmml" xref="S3.Ex8.m1.3.3">x</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8.m1.4c">\displaystyle\mathcal{L}_{f_{1}}=\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{1}}%
\left(\textbf{x}\right),y\right)+\mathcal{L}_{\mathrm{MD}}(\textbf{x}),\;\,</annotation><annotation encoding="application/x-llamapun" id="S3.Ex8.m1.4d">caligraphic_L start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( x ) , italic_y ) + caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT ( x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{f_{2}}=\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{2}}%
\left(\textbf{x}\right),y\right)+\mathcal{L}_{\mathrm{MD}}(\textbf{x}).\;\," class="ltx_Math" display="inline" id="S3.E14.m1.4"><semantics id="S3.E14.m1.4a"><mrow id="S3.E14.m1.4.4.1" xref="S3.E14.m1.4.4.1.1.cmml"><mrow id="S3.E14.m1.4.4.1.1" xref="S3.E14.m1.4.4.1.1.cmml"><msub id="S3.E14.m1.4.4.1.1.3" xref="S3.E14.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.4.4.1.1.3.2" xref="S3.E14.m1.4.4.1.1.3.2.cmml">ℒ</mi><msub id="S3.E14.m1.4.4.1.1.3.3" xref="S3.E14.m1.4.4.1.1.3.3.cmml"><mi id="S3.E14.m1.4.4.1.1.3.3.2" xref="S3.E14.m1.4.4.1.1.3.3.2.cmml">f</mi><mn id="S3.E14.m1.4.4.1.1.3.3.3" xref="S3.E14.m1.4.4.1.1.3.3.3.cmml">2</mn></msub></msub><mo id="S3.E14.m1.4.4.1.1.2" xref="S3.E14.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.4.4.1.1.1" xref="S3.E14.m1.4.4.1.1.1.cmml"><mrow id="S3.E14.m1.4.4.1.1.1.1" xref="S3.E14.m1.4.4.1.1.1.1.cmml"><msub id="S3.E14.m1.4.4.1.1.1.1.3" xref="S3.E14.m1.4.4.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.4.4.1.1.1.1.3.2" xref="S3.E14.m1.4.4.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S3.E14.m1.4.4.1.1.1.1.3.3" xref="S3.E14.m1.4.4.1.1.1.1.3.3.cmml">CE</mi></msub><mo id="S3.E14.m1.4.4.1.1.1.1.2" xref="S3.E14.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.4.4.1.1.1.1.1.1" xref="S3.E14.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.E14.m1.4.4.1.1.1.1.1.1.2" xref="S3.E14.m1.4.4.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E14.m1.4.4.1.1.1.1.1.1.1" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">f</mi><msub id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml">θ</mi><mn id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.3" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml">2</mn></msub></msub><mo id="S3.E14.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E14.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.1.1a.cmml"><mo id="S3.E14.m1.4.4.1.1.1.1.1.1.1.3.2.1" xref="S3.E14.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml">x</mtext><mo id="S3.E14.m1.4.4.1.1.1.1.1.1.1.3.2.2" xref="S3.E14.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.4.4.1.1.1.1.1.1.3" xref="S3.E14.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E14.m1.2.2" xref="S3.E14.m1.2.2.cmml">y</mi><mo id="S3.E14.m1.4.4.1.1.1.1.1.1.4" xref="S3.E14.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.4.4.1.1.1.2" xref="S3.E14.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S3.E14.m1.4.4.1.1.1.3" xref="S3.E14.m1.4.4.1.1.1.3.cmml"><msub id="S3.E14.m1.4.4.1.1.1.3.2" xref="S3.E14.m1.4.4.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.4.4.1.1.1.3.2.2" xref="S3.E14.m1.4.4.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E14.m1.4.4.1.1.1.3.2.3" xref="S3.E14.m1.4.4.1.1.1.3.2.3.cmml">MD</mi></msub><mo id="S3.E14.m1.4.4.1.1.1.3.1" xref="S3.E14.m1.4.4.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E14.m1.4.4.1.1.1.3.3.2" xref="S3.E14.m1.3.3a.cmml"><mo id="S3.E14.m1.4.4.1.1.1.3.3.2.1" stretchy="false" xref="S3.E14.m1.3.3a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.3.3" xref="S3.E14.m1.3.3.cmml">x</mtext><mo id="S3.E14.m1.4.4.1.1.1.3.3.2.2" stretchy="false" xref="S3.E14.m1.3.3a.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E14.m1.4.4.1.2" lspace="0em" xref="S3.E14.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.4b"><apply id="S3.E14.m1.4.4.1.1.cmml" xref="S3.E14.m1.4.4.1"><eq id="S3.E14.m1.4.4.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.2"></eq><apply id="S3.E14.m1.4.4.1.1.3.cmml" xref="S3.E14.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.3.1.cmml" xref="S3.E14.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.3.2.cmml" xref="S3.E14.m1.4.4.1.1.3.2">ℒ</ci><apply id="S3.E14.m1.4.4.1.1.3.3.cmml" xref="S3.E14.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.3.3.1.cmml" xref="S3.E14.m1.4.4.1.1.3.3">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.3.3.2.cmml" xref="S3.E14.m1.4.4.1.1.3.3.2">𝑓</ci><cn id="S3.E14.m1.4.4.1.1.3.3.3.cmml" type="integer" xref="S3.E14.m1.4.4.1.1.3.3.3">2</cn></apply></apply><apply id="S3.E14.m1.4.4.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1"><plus id="S3.E14.m1.4.4.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.1.2"></plus><apply id="S3.E14.m1.4.4.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1"><times id="S3.E14.m1.4.4.1.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.1.1.2"></times><apply id="S3.E14.m1.4.4.1.1.1.1.3.cmml" xref="S3.E14.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E14.m1.4.4.1.1.1.1.3.2">ℒ</ci><ci id="S3.E14.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E14.m1.4.4.1.1.1.1.3.3">CE</ci></apply><interval closure="open" id="S3.E14.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1"><apply id="S3.E14.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1"><times id="S3.E14.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.1"></times><apply id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.2">𝜃</ci><cn id="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><ci id="S3.E14.m1.1.1a.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1">x</mtext></ci></apply><ci id="S3.E14.m1.2.2.cmml" xref="S3.E14.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E14.m1.4.4.1.1.1.3.cmml" xref="S3.E14.m1.4.4.1.1.1.3"><times id="S3.E14.m1.4.4.1.1.1.3.1.cmml" xref="S3.E14.m1.4.4.1.1.1.3.1"></times><apply id="S3.E14.m1.4.4.1.1.1.3.2.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.1.3.2.1.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.1.3.2.2.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2.2">ℒ</ci><ci id="S3.E14.m1.4.4.1.1.1.3.2.3.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2.3">MD</ci></apply><ci id="S3.E14.m1.3.3a.cmml" xref="S3.E14.m1.4.4.1.1.1.3.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.3.3.cmml" xref="S3.E14.m1.3.3">x</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.4c">\displaystyle\mathcal{L}_{f_{2}}=\mathcal{L}_{\mathrm{CE}}\left(f_{\theta_{2}}%
\left(\textbf{x}\right),y\right)+\mathcal{L}_{\mathrm{MD}}(\textbf{x}).\;\,</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.4d">caligraphic_L start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( x ) , italic_y ) + caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT ( x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p6.4">To guide the image in learning intermediate information, the Mutual Distillation loss serves as an additional regularization term for the synthetic image. Through this process, each semantic aspect of the model and the learning path of the synthetic image are guided, achieving a balance between the two models and enhancing generality in the results. Consequently, the number of optimization target <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p6.3.m1.1"><semantics id="S3.SS4.p6.3.m1.1a"><mi id="S3.SS4.p6.3.m1.1.1" xref="S3.SS4.p6.3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.3.m1.1b"><ci id="S3.SS4.p6.3.m1.1.1.cmml" xref="S3.SS4.p6.3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.3.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.3.m1.1d">italic_k</annotation></semantics></math> for condensed images is <math alttext="3" class="ltx_Math" display="inline" id="S3.SS4.p6.4.m2.1"><semantics id="S3.SS4.p6.4.m2.1a"><mn id="S3.SS4.p6.4.m2.1.1" xref="S3.SS4.p6.4.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.4.m2.1b"><cn id="S3.SS4.p6.4.m2.1.1.cmml" type="integer" xref="S3.SS4.p6.4.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.4.m2.1c">3</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.4.m2.1d">3</annotation></semantics></math> in this case. Total loss function for condensed images can be defined as a vector inner product as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx12">
<tbody id="S3.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.Ex9.2.1.1.1">L</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left[\mathcal{L}^{1},\mathcal{L}^{2},\mathrm{MSE}\left(\nabla%
\mathcal{L}_{\mathrm{MD}}(\textbf{x}^{t}),\nabla\mathcal{L}_{\mathrm{MD}}(%
\textbf{x}^{s})\right)\right]," class="ltx_Math" display="inline" id="S3.Ex9.m2.1"><semantics id="S3.Ex9.m2.1a"><mrow id="S3.Ex9.m2.1.1.1" xref="S3.Ex9.m2.1.1.1.1.cmml"><mrow id="S3.Ex9.m2.1.1.1.1" xref="S3.Ex9.m2.1.1.1.1.cmml"><mi id="S3.Ex9.m2.1.1.1.1.5" xref="S3.Ex9.m2.1.1.1.1.5.cmml"></mi><mo id="S3.Ex9.m2.1.1.1.1.4" xref="S3.Ex9.m2.1.1.1.1.4.cmml">=</mo><mrow id="S3.Ex9.m2.1.1.1.1.3.3" xref="S3.Ex9.m2.1.1.1.1.3.4.cmml"><mo id="S3.Ex9.m2.1.1.1.1.3.3.4" xref="S3.Ex9.m2.1.1.1.1.3.4.cmml">[</mo><msup id="S3.Ex9.m2.1.1.1.1.1.1.1" xref="S3.Ex9.m2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex9.m2.1.1.1.1.1.1.1.2" xref="S3.Ex9.m2.1.1.1.1.1.1.1.2.cmml">ℒ</mi><mn id="S3.Ex9.m2.1.1.1.1.1.1.1.3" xref="S3.Ex9.m2.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S3.Ex9.m2.1.1.1.1.3.3.5" xref="S3.Ex9.m2.1.1.1.1.3.4.cmml">,</mo><msup id="S3.Ex9.m2.1.1.1.1.2.2.2" xref="S3.Ex9.m2.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex9.m2.1.1.1.1.2.2.2.2" xref="S3.Ex9.m2.1.1.1.1.2.2.2.2.cmml">ℒ</mi><mn id="S3.Ex9.m2.1.1.1.1.2.2.2.3" xref="S3.Ex9.m2.1.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="S3.Ex9.m2.1.1.1.1.3.3.6" xref="S3.Ex9.m2.1.1.1.1.3.4.cmml">,</mo><mrow id="S3.Ex9.m2.1.1.1.1.3.3.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.cmml"><mi id="S3.Ex9.m2.1.1.1.1.3.3.3.4" xref="S3.Ex9.m2.1.1.1.1.3.3.3.4.cmml">MSE</mi><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.3.cmml">⁢</mo><mrow id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.3.cmml"><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.3.cmml">(</mo><mrow id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.cmml"><mrow id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.cmml"><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.1" rspace="0.167em" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.1.cmml">∇</mo><msub id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.3.cmml">MD</mi></msub></mrow><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml"><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.2a.cmml">x</mtext><mi id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.4" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.3.cmml">,</mo><mrow id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.cmml"><mrow id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.cmml"><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.1" rspace="0.167em" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.1.cmml">∇</mo><msub id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.2.cmml">ℒ</mi><mi id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.3.cmml">MD</mi></msub></mrow><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.2.cmml">⁢</mo><mrow id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.cmml"><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.2" stretchy="false" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.cmml">(</mo><msup id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.2" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.2a.cmml">x</mtext><mi id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.3" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.3.cmml">s</mi></msup><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.3" stretchy="false" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.5" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex9.m2.1.1.1.1.3.3.7" xref="S3.Ex9.m2.1.1.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="S3.Ex9.m2.1.1.1.2" xref="S3.Ex9.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m2.1b"><apply id="S3.Ex9.m2.1.1.1.1.cmml" xref="S3.Ex9.m2.1.1.1"><eq id="S3.Ex9.m2.1.1.1.1.4.cmml" xref="S3.Ex9.m2.1.1.1.1.4"></eq><csymbol cd="latexml" id="S3.Ex9.m2.1.1.1.1.5.cmml" xref="S3.Ex9.m2.1.1.1.1.5">absent</csymbol><list id="S3.Ex9.m2.1.1.1.1.3.4.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3"><apply id="S3.Ex9.m2.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex9.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex9.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m2.1.1.1.1.1.1.1.2">ℒ</ci><cn id="S3.Ex9.m2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex9.m2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex9.m2.1.1.1.1.2.2.2.cmml" xref="S3.Ex9.m2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex9.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex9.m2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.Ex9.m2.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex9.m2.1.1.1.1.2.2.2.2">ℒ</ci><cn id="S3.Ex9.m2.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.Ex9.m2.1.1.1.1.2.2.2.3">2</cn></apply><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3"><times id="S3.Ex9.m2.1.1.1.1.3.3.3.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.3"></times><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.4.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.4">MSE</ci><interval closure="open" id="S3.Ex9.m2.1.1.1.1.3.3.3.2.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2"><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1"><times id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.2"></times><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3"><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.1">∇</ci><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.2">ℒ</ci><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.3.2.3">MD</ci></apply></apply><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.2a.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.2">x</mtext></ci><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2"><times id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.2"></times><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3"><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.1">∇</ci><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2">subscript</csymbol><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.2">ℒ</ci><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.3.2.3">MD</ci></apply></apply><apply id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.1.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1">superscript</csymbol><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.2a.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.2.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.2">x</mtext></ci><ci id="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.3.cmml" xref="S3.Ex9.m2.1.1.1.1.3.3.3.2.2.2.1.1.1.3">𝑠</ci></apply></apply></interval></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m2.1c">\displaystyle=\left[\mathcal{L}^{1},\mathcal{L}^{2},\mathrm{MSE}\left(\nabla%
\mathcal{L}_{\mathrm{MD}}(\textbf{x}^{t}),\nabla\mathcal{L}_{\mathrm{MD}}(%
\textbf{x}^{s})\right)\right],</annotation><annotation encoding="application/x-llamapun" id="S3.Ex9.m2.1d">= [ caligraphic_L start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , caligraphic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , roman_MSE ( ∇ caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) , ∇ caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ) ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\mathrm{target}}" class="ltx_Math" display="inline" id="S3.Ex10.m1.1"><semantics id="S3.Ex10.m1.1a"><msub id="S3.Ex10.m1.1.1" xref="S3.Ex10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex10.m1.1.1.2" xref="S3.Ex10.m1.1.1.2.cmml">ℒ</mi><mi id="S3.Ex10.m1.1.1.3" xref="S3.Ex10.m1.1.1.3.cmml">target</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Ex10.m1.1b"><apply id="S3.Ex10.m1.1.1.cmml" xref="S3.Ex10.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex10.m1.1.1.1.cmml" xref="S3.Ex10.m1.1.1">subscript</csymbol><ci id="S3.Ex10.m1.1.1.2.cmml" xref="S3.Ex10.m1.1.1.2">ℒ</ci><ci id="S3.Ex10.m1.1.1.3.cmml" xref="S3.Ex10.m1.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex10.m1.1c">\displaystyle\mathcal{L}_{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex10.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_target end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\textbf{L}\cdot\min\left(\mathcal{A}\right)\mathcal{A}^{\mathrm{%
R}}" class="ltx_Math" display="inline" id="S3.Ex10.m2.2"><semantics id="S3.Ex10.m2.2a"><mrow id="S3.Ex10.m2.2.3" xref="S3.Ex10.m2.2.3.cmml"><mi id="S3.Ex10.m2.2.3.2" xref="S3.Ex10.m2.2.3.2.cmml"></mi><mo id="S3.Ex10.m2.2.3.1" xref="S3.Ex10.m2.2.3.1.cmml">=</mo><mrow id="S3.Ex10.m2.2.3.3" xref="S3.Ex10.m2.2.3.3.cmml"><mrow id="S3.Ex10.m2.2.3.3.2" xref="S3.Ex10.m2.2.3.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.Ex10.m2.2.3.3.2.2" xref="S3.Ex10.m2.2.3.3.2.2a.cmml">L</mtext><mo id="S3.Ex10.m2.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex10.m2.2.3.3.2.1.cmml">⋅</mo><mrow id="S3.Ex10.m2.2.3.3.2.3.2" xref="S3.Ex10.m2.2.3.3.2.3.1.cmml"><mi id="S3.Ex10.m2.1.1" xref="S3.Ex10.m2.1.1.cmml">min</mi><mo id="S3.Ex10.m2.2.3.3.2.3.2a" xref="S3.Ex10.m2.2.3.3.2.3.1.cmml">⁡</mo><mrow id="S3.Ex10.m2.2.3.3.2.3.2.1" xref="S3.Ex10.m2.2.3.3.2.3.1.cmml"><mo id="S3.Ex10.m2.2.3.3.2.3.2.1.1" xref="S3.Ex10.m2.2.3.3.2.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex10.m2.2.2" xref="S3.Ex10.m2.2.2.cmml">𝒜</mi><mo id="S3.Ex10.m2.2.3.3.2.3.2.1.2" xref="S3.Ex10.m2.2.3.3.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex10.m2.2.3.3.1" xref="S3.Ex10.m2.2.3.3.1.cmml">⁢</mo><msup id="S3.Ex10.m2.2.3.3.3" xref="S3.Ex10.m2.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex10.m2.2.3.3.3.2" xref="S3.Ex10.m2.2.3.3.3.2.cmml">𝒜</mi><mi id="S3.Ex10.m2.2.3.3.3.3" mathvariant="normal" xref="S3.Ex10.m2.2.3.3.3.3.cmml">R</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex10.m2.2b"><apply id="S3.Ex10.m2.2.3.cmml" xref="S3.Ex10.m2.2.3"><eq id="S3.Ex10.m2.2.3.1.cmml" xref="S3.Ex10.m2.2.3.1"></eq><csymbol cd="latexml" id="S3.Ex10.m2.2.3.2.cmml" xref="S3.Ex10.m2.2.3.2">absent</csymbol><apply id="S3.Ex10.m2.2.3.3.cmml" xref="S3.Ex10.m2.2.3.3"><times id="S3.Ex10.m2.2.3.3.1.cmml" xref="S3.Ex10.m2.2.3.3.1"></times><apply id="S3.Ex10.m2.2.3.3.2.cmml" xref="S3.Ex10.m2.2.3.3.2"><ci id="S3.Ex10.m2.2.3.3.2.1.cmml" xref="S3.Ex10.m2.2.3.3.2.1">⋅</ci><ci id="S3.Ex10.m2.2.3.3.2.2a.cmml" xref="S3.Ex10.m2.2.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.Ex10.m2.2.3.3.2.2.cmml" xref="S3.Ex10.m2.2.3.3.2.2">L</mtext></ci><apply id="S3.Ex10.m2.2.3.3.2.3.1.cmml" xref="S3.Ex10.m2.2.3.3.2.3.2"><min id="S3.Ex10.m2.1.1.cmml" xref="S3.Ex10.m2.1.1"></min><ci id="S3.Ex10.m2.2.2.cmml" xref="S3.Ex10.m2.2.2">𝒜</ci></apply></apply><apply id="S3.Ex10.m2.2.3.3.3.cmml" xref="S3.Ex10.m2.2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex10.m2.2.3.3.3.1.cmml" xref="S3.Ex10.m2.2.3.3.3">superscript</csymbol><ci id="S3.Ex10.m2.2.3.3.3.2.cmml" xref="S3.Ex10.m2.2.3.3.3.2">𝒜</ci><ci id="S3.Ex10.m2.2.3.3.3.3.cmml" xref="S3.Ex10.m2.2.3.3.3.3">R</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex10.m2.2c">\displaystyle=\textbf{L}\cdot\min\left(\mathcal{A}\right)\mathcal{A}^{\mathrm{%
R}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex10.m2.2d">= L ⋅ roman_min ( caligraphic_A ) caligraphic_A start_POSTSUPERSCRIPT roman_R end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\min\left(\mathcal{A}\right)}{a_{1}}\mathcal{L}_{1}+\frac{%
\min\left(\mathcal{A}\right)}{a_{2}}\mathcal{L}_{2}+\frac{\min\left(\mathcal{A%
}\right)}{a_{3}}\mathrm{MSE}\left(\nabla\mathcal{L}_{\mathrm{MD}}(\textbf{x}^{%
t}),\nabla\mathcal{L}_{\mathrm{MD}}(\textbf{x}^{s})\right)," class="ltx_Math" display="inline" id="S3.E15.m1.7"><semantics id="S3.E15.m1.7a"><mrow id="S3.E15.m1.7.7.1" xref="S3.E15.m1.7.7.1.1.cmml"><mrow id="S3.E15.m1.7.7.1.1" xref="S3.E15.m1.7.7.1.1.cmml"><mi id="S3.E15.m1.7.7.1.1.4" xref="S3.E15.m1.7.7.1.1.4.cmml"></mi><mo id="S3.E15.m1.7.7.1.1.3" xref="S3.E15.m1.7.7.1.1.3.cmml">=</mo><mrow id="S3.E15.m1.7.7.1.1.2" xref="S3.E15.m1.7.7.1.1.2.cmml"><mrow id="S3.E15.m1.7.7.1.1.2.4" xref="S3.E15.m1.7.7.1.1.2.4.cmml"><mstyle displaystyle="true" id="S3.E15.m1.2.2" xref="S3.E15.m1.2.2.cmml"><mfrac id="S3.E15.m1.2.2a" xref="S3.E15.m1.2.2.cmml"><mrow id="S3.E15.m1.2.2.2.4" xref="S3.E15.m1.2.2.2.3.cmml"><mi id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml">min</mi><mo id="S3.E15.m1.2.2.2.4a" xref="S3.E15.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E15.m1.2.2.2.4.1" xref="S3.E15.m1.2.2.2.3.cmml"><mo id="S3.E15.m1.2.2.2.4.1.1" xref="S3.E15.m1.2.2.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.2.2.2.2" xref="S3.E15.m1.2.2.2.2.cmml">𝒜</mi><mo id="S3.E15.m1.2.2.2.4.1.2" xref="S3.E15.m1.2.2.2.3.cmml">)</mo></mrow></mrow><msub id="S3.E15.m1.2.2.4" xref="S3.E15.m1.2.2.4.cmml"><mi id="S3.E15.m1.2.2.4.2" xref="S3.E15.m1.2.2.4.2.cmml">a</mi><mn id="S3.E15.m1.2.2.4.3" xref="S3.E15.m1.2.2.4.3.cmml">1</mn></msub></mfrac></mstyle><mo id="S3.E15.m1.7.7.1.1.2.4.1" xref="S3.E15.m1.7.7.1.1.2.4.1.cmml">⁢</mo><msub id="S3.E15.m1.7.7.1.1.2.4.2" xref="S3.E15.m1.7.7.1.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.7.7.1.1.2.4.2.2" xref="S3.E15.m1.7.7.1.1.2.4.2.2.cmml">ℒ</mi><mn id="S3.E15.m1.7.7.1.1.2.4.2.3" xref="S3.E15.m1.7.7.1.1.2.4.2.3.cmml">1</mn></msub></mrow><mo id="S3.E15.m1.7.7.1.1.2.3" xref="S3.E15.m1.7.7.1.1.2.3.cmml">+</mo><mrow id="S3.E15.m1.7.7.1.1.2.5" xref="S3.E15.m1.7.7.1.1.2.5.cmml"><mstyle displaystyle="true" id="S3.E15.m1.4.4" xref="S3.E15.m1.4.4.cmml"><mfrac id="S3.E15.m1.4.4a" xref="S3.E15.m1.4.4.cmml"><mrow id="S3.E15.m1.4.4.2.4" xref="S3.E15.m1.4.4.2.3.cmml"><mi id="S3.E15.m1.3.3.1.1" xref="S3.E15.m1.3.3.1.1.cmml">min</mi><mo id="S3.E15.m1.4.4.2.4a" xref="S3.E15.m1.4.4.2.3.cmml">⁡</mo><mrow id="S3.E15.m1.4.4.2.4.1" xref="S3.E15.m1.4.4.2.3.cmml"><mo id="S3.E15.m1.4.4.2.4.1.1" xref="S3.E15.m1.4.4.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.4.4.2.2" xref="S3.E15.m1.4.4.2.2.cmml">𝒜</mi><mo id="S3.E15.m1.4.4.2.4.1.2" xref="S3.E15.m1.4.4.2.3.cmml">)</mo></mrow></mrow><msub id="S3.E15.m1.4.4.4" xref="S3.E15.m1.4.4.4.cmml"><mi id="S3.E15.m1.4.4.4.2" xref="S3.E15.m1.4.4.4.2.cmml">a</mi><mn id="S3.E15.m1.4.4.4.3" xref="S3.E15.m1.4.4.4.3.cmml">2</mn></msub></mfrac></mstyle><mo id="S3.E15.m1.7.7.1.1.2.5.1" xref="S3.E15.m1.7.7.1.1.2.5.1.cmml">⁢</mo><msub id="S3.E15.m1.7.7.1.1.2.5.2" xref="S3.E15.m1.7.7.1.1.2.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.7.7.1.1.2.5.2.2" xref="S3.E15.m1.7.7.1.1.2.5.2.2.cmml">ℒ</mi><mn id="S3.E15.m1.7.7.1.1.2.5.2.3" xref="S3.E15.m1.7.7.1.1.2.5.2.3.cmml">2</mn></msub></mrow><mo id="S3.E15.m1.7.7.1.1.2.3a" xref="S3.E15.m1.7.7.1.1.2.3.cmml">+</mo><mrow id="S3.E15.m1.7.7.1.1.2.2" xref="S3.E15.m1.7.7.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E15.m1.6.6" xref="S3.E15.m1.6.6.cmml"><mfrac id="S3.E15.m1.6.6a" xref="S3.E15.m1.6.6.cmml"><mrow id="S3.E15.m1.6.6.2.4" xref="S3.E15.m1.6.6.2.3.cmml"><mi id="S3.E15.m1.5.5.1.1" xref="S3.E15.m1.5.5.1.1.cmml">min</mi><mo id="S3.E15.m1.6.6.2.4a" xref="S3.E15.m1.6.6.2.3.cmml">⁡</mo><mrow id="S3.E15.m1.6.6.2.4.1" xref="S3.E15.m1.6.6.2.3.cmml"><mo id="S3.E15.m1.6.6.2.4.1.1" xref="S3.E15.m1.6.6.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.6.6.2.2" xref="S3.E15.m1.6.6.2.2.cmml">𝒜</mi><mo id="S3.E15.m1.6.6.2.4.1.2" xref="S3.E15.m1.6.6.2.3.cmml">)</mo></mrow></mrow><msub id="S3.E15.m1.6.6.4" xref="S3.E15.m1.6.6.4.cmml"><mi id="S3.E15.m1.6.6.4.2" xref="S3.E15.m1.6.6.4.2.cmml">a</mi><mn id="S3.E15.m1.6.6.4.3" xref="S3.E15.m1.6.6.4.3.cmml">3</mn></msub></mfrac></mstyle><mo id="S3.E15.m1.7.7.1.1.2.2.3" xref="S3.E15.m1.7.7.1.1.2.2.3.cmml">⁢</mo><mi id="S3.E15.m1.7.7.1.1.2.2.4" xref="S3.E15.m1.7.7.1.1.2.2.4.cmml">MSE</mi><mo id="S3.E15.m1.7.7.1.1.2.2.3a" xref="S3.E15.m1.7.7.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E15.m1.7.7.1.1.2.2.2.2" xref="S3.E15.m1.7.7.1.1.2.2.2.3.cmml"><mo id="S3.E15.m1.7.7.1.1.2.2.2.2.3" xref="S3.E15.m1.7.7.1.1.2.2.2.3.cmml">(</mo><mrow id="S3.E15.m1.7.7.1.1.1.1.1.1.1" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.1" rspace="0.167em" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">∇</mo><msub id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.2" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.3" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.3.cmml">MD</mi></msub></mrow><mo id="S3.E15.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.2a.cmml">x</mtext><mi id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E15.m1.7.7.1.1.2.2.2.2.4" xref="S3.E15.m1.7.7.1.1.2.2.2.3.cmml">,</mo><mrow id="S3.E15.m1.7.7.1.1.2.2.2.2.2" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.cmml"><mrow id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.cmml"><mo id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.1" rspace="0.167em" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.1.cmml">∇</mo><msub id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.2" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.2.cmml">ℒ</mi><mi id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.3" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.3.cmml">MD</mi></msub></mrow><mo id="S3.E15.m1.7.7.1.1.2.2.2.2.2.2" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.cmml"><mo id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.2" stretchy="false" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.cmml">(</mo><msup id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.2" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.2a.cmml">x</mtext><mi id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.3" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.3.cmml">s</mi></msup><mo id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.3" stretchy="false" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E15.m1.7.7.1.1.2.2.2.2.5" xref="S3.E15.m1.7.7.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E15.m1.7.7.1.2" xref="S3.E15.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.7b"><apply id="S3.E15.m1.7.7.1.1.cmml" xref="S3.E15.m1.7.7.1"><eq id="S3.E15.m1.7.7.1.1.3.cmml" xref="S3.E15.m1.7.7.1.1.3"></eq><csymbol cd="latexml" id="S3.E15.m1.7.7.1.1.4.cmml" xref="S3.E15.m1.7.7.1.1.4">absent</csymbol><apply id="S3.E15.m1.7.7.1.1.2.cmml" xref="S3.E15.m1.7.7.1.1.2"><plus id="S3.E15.m1.7.7.1.1.2.3.cmml" xref="S3.E15.m1.7.7.1.1.2.3"></plus><apply id="S3.E15.m1.7.7.1.1.2.4.cmml" xref="S3.E15.m1.7.7.1.1.2.4"><times id="S3.E15.m1.7.7.1.1.2.4.1.cmml" xref="S3.E15.m1.7.7.1.1.2.4.1"></times><apply id="S3.E15.m1.2.2.cmml" xref="S3.E15.m1.2.2"><divide id="S3.E15.m1.2.2.3.cmml" xref="S3.E15.m1.2.2"></divide><apply id="S3.E15.m1.2.2.2.3.cmml" xref="S3.E15.m1.2.2.2.4"><min id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1"></min><ci id="S3.E15.m1.2.2.2.2.cmml" xref="S3.E15.m1.2.2.2.2">𝒜</ci></apply><apply id="S3.E15.m1.2.2.4.cmml" xref="S3.E15.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.4.1.cmml" xref="S3.E15.m1.2.2.4">subscript</csymbol><ci id="S3.E15.m1.2.2.4.2.cmml" xref="S3.E15.m1.2.2.4.2">𝑎</ci><cn id="S3.E15.m1.2.2.4.3.cmml" type="integer" xref="S3.E15.m1.2.2.4.3">1</cn></apply></apply><apply id="S3.E15.m1.7.7.1.1.2.4.2.cmml" xref="S3.E15.m1.7.7.1.1.2.4.2"><csymbol cd="ambiguous" id="S3.E15.m1.7.7.1.1.2.4.2.1.cmml" xref="S3.E15.m1.7.7.1.1.2.4.2">subscript</csymbol><ci id="S3.E15.m1.7.7.1.1.2.4.2.2.cmml" xref="S3.E15.m1.7.7.1.1.2.4.2.2">ℒ</ci><cn id="S3.E15.m1.7.7.1.1.2.4.2.3.cmml" type="integer" xref="S3.E15.m1.7.7.1.1.2.4.2.3">1</cn></apply></apply><apply id="S3.E15.m1.7.7.1.1.2.5.cmml" xref="S3.E15.m1.7.7.1.1.2.5"><times id="S3.E15.m1.7.7.1.1.2.5.1.cmml" xref="S3.E15.m1.7.7.1.1.2.5.1"></times><apply id="S3.E15.m1.4.4.cmml" xref="S3.E15.m1.4.4"><divide id="S3.E15.m1.4.4.3.cmml" xref="S3.E15.m1.4.4"></divide><apply id="S3.E15.m1.4.4.2.3.cmml" xref="S3.E15.m1.4.4.2.4"><min id="S3.E15.m1.3.3.1.1.cmml" xref="S3.E15.m1.3.3.1.1"></min><ci id="S3.E15.m1.4.4.2.2.cmml" xref="S3.E15.m1.4.4.2.2">𝒜</ci></apply><apply id="S3.E15.m1.4.4.4.cmml" xref="S3.E15.m1.4.4.4"><csymbol cd="ambiguous" id="S3.E15.m1.4.4.4.1.cmml" xref="S3.E15.m1.4.4.4">subscript</csymbol><ci id="S3.E15.m1.4.4.4.2.cmml" xref="S3.E15.m1.4.4.4.2">𝑎</ci><cn id="S3.E15.m1.4.4.4.3.cmml" type="integer" xref="S3.E15.m1.4.4.4.3">2</cn></apply></apply><apply id="S3.E15.m1.7.7.1.1.2.5.2.cmml" xref="S3.E15.m1.7.7.1.1.2.5.2"><csymbol cd="ambiguous" id="S3.E15.m1.7.7.1.1.2.5.2.1.cmml" xref="S3.E15.m1.7.7.1.1.2.5.2">subscript</csymbol><ci id="S3.E15.m1.7.7.1.1.2.5.2.2.cmml" xref="S3.E15.m1.7.7.1.1.2.5.2.2">ℒ</ci><cn id="S3.E15.m1.7.7.1.1.2.5.2.3.cmml" type="integer" xref="S3.E15.m1.7.7.1.1.2.5.2.3">2</cn></apply></apply><apply id="S3.E15.m1.7.7.1.1.2.2.cmml" xref="S3.E15.m1.7.7.1.1.2.2"><times id="S3.E15.m1.7.7.1.1.2.2.3.cmml" xref="S3.E15.m1.7.7.1.1.2.2.3"></times><apply id="S3.E15.m1.6.6.cmml" xref="S3.E15.m1.6.6"><divide id="S3.E15.m1.6.6.3.cmml" xref="S3.E15.m1.6.6"></divide><apply id="S3.E15.m1.6.6.2.3.cmml" xref="S3.E15.m1.6.6.2.4"><min id="S3.E15.m1.5.5.1.1.cmml" xref="S3.E15.m1.5.5.1.1"></min><ci id="S3.E15.m1.6.6.2.2.cmml" xref="S3.E15.m1.6.6.2.2">𝒜</ci></apply><apply id="S3.E15.m1.6.6.4.cmml" xref="S3.E15.m1.6.6.4"><csymbol cd="ambiguous" id="S3.E15.m1.6.6.4.1.cmml" xref="S3.E15.m1.6.6.4">subscript</csymbol><ci id="S3.E15.m1.6.6.4.2.cmml" xref="S3.E15.m1.6.6.4.2">𝑎</ci><cn id="S3.E15.m1.6.6.4.3.cmml" type="integer" xref="S3.E15.m1.6.6.4.3">3</cn></apply></apply><ci id="S3.E15.m1.7.7.1.1.2.2.4.cmml" xref="S3.E15.m1.7.7.1.1.2.2.4">MSE</ci><interval closure="open" id="S3.E15.m1.7.7.1.1.2.2.2.3.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2"><apply id="S3.E15.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1"><times id="S3.E15.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.2"></times><apply id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3"><ci id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.1">∇</ci><apply id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.2">ℒ</ci><ci id="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.3.2.3">MD</ci></apply></apply><apply id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">x</mtext></ci><ci id="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E15.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2"><times id="S3.E15.m1.7.7.1.1.2.2.2.2.2.2.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.2"></times><apply id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3"><ci id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.1">∇</ci><apply id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.1.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2">subscript</csymbol><ci id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.2.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.2">ℒ</ci><ci id="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.3.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.3.2.3">MD</ci></apply></apply><apply id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.2a.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.2">x</mtext></ci><ci id="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E15.m1.7.7.1.1.2.2.2.2.2.1.1.1.3">𝑠</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.7c">\displaystyle=\frac{\min\left(\mathcal{A}\right)}{a_{1}}\mathcal{L}_{1}+\frac{%
\min\left(\mathcal{A}\right)}{a_{2}}\mathcal{L}_{2}+\frac{\min\left(\mathcal{A%
}\right)}{a_{3}}\mathrm{MSE}\left(\nabla\mathcal{L}_{\mathrm{MD}}(\textbf{x}^{%
t}),\nabla\mathcal{L}_{\mathrm{MD}}(\textbf{x}^{s})\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.7d">= divide start_ARG roman_min ( caligraphic_A ) end_ARG start_ARG italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + divide start_ARG roman_min ( caligraphic_A ) end_ARG start_ARG italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + divide start_ARG roman_min ( caligraphic_A ) end_ARG start_ARG italic_a start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT end_ARG roman_MSE ( ∇ caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) , ∇ caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p6.7">where <math alttext="a_{1},a_{2}," class="ltx_Math" display="inline" id="S3.SS4.p6.5.m1.1"><semantics id="S3.SS4.p6.5.m1.1a"><mrow id="S3.SS4.p6.5.m1.1.1.1"><mrow id="S3.SS4.p6.5.m1.1.1.1.1.2" xref="S3.SS4.p6.5.m1.1.1.1.1.3.cmml"><msub id="S3.SS4.p6.5.m1.1.1.1.1.1.1" xref="S3.SS4.p6.5.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p6.5.m1.1.1.1.1.1.1.2" xref="S3.SS4.p6.5.m1.1.1.1.1.1.1.2.cmml">a</mi><mn id="S3.SS4.p6.5.m1.1.1.1.1.1.1.3" xref="S3.SS4.p6.5.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p6.5.m1.1.1.1.1.2.3" xref="S3.SS4.p6.5.m1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS4.p6.5.m1.1.1.1.1.2.2" xref="S3.SS4.p6.5.m1.1.1.1.1.2.2.cmml"><mi id="S3.SS4.p6.5.m1.1.1.1.1.2.2.2" xref="S3.SS4.p6.5.m1.1.1.1.1.2.2.2.cmml">a</mi><mn id="S3.SS4.p6.5.m1.1.1.1.1.2.2.3" xref="S3.SS4.p6.5.m1.1.1.1.1.2.2.3.cmml">2</mn></msub></mrow><mo id="S3.SS4.p6.5.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.5.m1.1b"><list id="S3.SS4.p6.5.m1.1.1.1.1.3.cmml" xref="S3.SS4.p6.5.m1.1.1.1.1.2"><apply id="S3.SS4.p6.5.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.5.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p6.5.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.5.m1.1.1.1.1.1.1.2">𝑎</ci><cn id="S3.SS4.p6.5.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p6.5.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS4.p6.5.m1.1.1.1.1.2.2.cmml" xref="S3.SS4.p6.5.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p6.5.m1.1.1.1.1.2.2.1.cmml" xref="S3.SS4.p6.5.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS4.p6.5.m1.1.1.1.1.2.2.2.cmml" xref="S3.SS4.p6.5.m1.1.1.1.1.2.2.2">𝑎</ci><cn id="S3.SS4.p6.5.m1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.SS4.p6.5.m1.1.1.1.1.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.5.m1.1c">a_{1},a_{2},</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.5.m1.1d">italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math> and <math alttext="a_{3}" class="ltx_Math" display="inline" id="S3.SS4.p6.6.m2.1"><semantics id="S3.SS4.p6.6.m2.1a"><msub id="S3.SS4.p6.6.m2.1.1" xref="S3.SS4.p6.6.m2.1.1.cmml"><mi id="S3.SS4.p6.6.m2.1.1.2" xref="S3.SS4.p6.6.m2.1.1.2.cmml">a</mi><mn id="S3.SS4.p6.6.m2.1.1.3" xref="S3.SS4.p6.6.m2.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.6.m2.1b"><apply id="S3.SS4.p6.6.m2.1.1.cmml" xref="S3.SS4.p6.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p6.6.m2.1.1.1.cmml" xref="S3.SS4.p6.6.m2.1.1">subscript</csymbol><ci id="S3.SS4.p6.6.m2.1.1.2.cmml" xref="S3.SS4.p6.6.m2.1.1.2">𝑎</ci><cn id="S3.SS4.p6.6.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p6.6.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.6.m2.1c">a_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.6.m2.1d">italic_a start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> is current value in the accumulator <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS4.p6.7.m3.1"><semantics id="S3.SS4.p6.7.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.7.m3.1.1" xref="S3.SS4.p6.7.m3.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p6.7.m3.1b"><ci id="S3.SS4.p6.7.m3.1.1.cmml" xref="S3.SS4.p6.7.m3.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p6.7.m3.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p6.7.m3.1d">caligraphic_A</annotation></semantics></math> part of the Gradient Balance Module. This allows us to learn by considering the semantic distance between two models when training a model and when training an image, and to extract more general knowledge from it.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Implementation Details</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In this study, we performed a comprehensive comparative analysis, assessing the effectiveness of our proposed method against cutting-edge gradient matching techniques, IDC <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib21" title="">21</a>]</cite> and DREAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite>. To broaden our evaluation scope to distribution matching, we selected CAFE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib34" title="">34</a>]</cite> and IDM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>]</cite> as benchmark methodologies.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">To ensure a fair and standardized comparison, we employed a consistent augmentation strategy across all methods. This strategy encompassed a sequence of color modifications, cropping, and either Cutout <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib7" title="">7</a>]</cite> or CutMix <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib37" title="">37</a>]</cite>, aligning with the recommended practices outlined in IDC <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>]</cite>.
Also, we use multi-formation which is used in IDC and IDM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib40" title="">40</a>]</cite> for every method.
Nonetheless, it appears that while this robust augmentation technique enhances the performance of the gradient-based method, it adversely affects the distribution matching method, resulting in a decline in performance. In the images generated during the process, a noticeable inclination to produce corrupted images under intense augmentation was observed.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.7">To measure how the condensed image effectively trains the large model, We conducted experiments on CIFAR10 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib23" title="">23</a>]</cite> on Images Per Class (IPC) 1, 10, 50.
Our assessment followed the experimental procedures detailed in each referenced paper.
For evaluation, we utilized ConvNet, ViT-tiny <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib8" title="">8</a>]</cite>, ResNet18 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib13" title="">13</a>]</cite>, ViT-small, ResNet50, ResNet101, and ViT-base models, each with specific learning rates (<math alttext="0.01" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><cn id="S4.SS1.p3.1.m1.1.1.cmml" type="float" xref="S4.SS1.p3.1.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">0.01</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">0.01</annotation></semantics></math>, <math alttext="0.001" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><cn id="S4.SS1.p3.2.m2.1.1.cmml" type="float" xref="S4.SS1.p3.2.m2.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">0.001</annotation></semantics></math>, <math alttext="0.001" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mn id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><cn id="S4.SS1.p3.3.m3.1.1.cmml" type="float" xref="S4.SS1.p3.3.m3.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">0.001</annotation></semantics></math>, <math alttext="0.001" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mn id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><cn id="S4.SS1.p3.4.m4.1.1.cmml" type="float" xref="S4.SS1.p3.4.m4.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">0.001</annotation></semantics></math>, <math alttext="0.001" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><mn id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><cn id="S4.SS1.p3.5.m5.1.1.cmml" type="float" xref="S4.SS1.p3.5.m5.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">0.001</annotation></semantics></math>, <math alttext="0.0001" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><mn id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><cn id="S4.SS1.p3.6.m6.1.1.cmml" type="float" xref="S4.SS1.p3.6.m6.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">0.0001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">0.0001</annotation></semantics></math>, and <math alttext="0.0001" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.1"><semantics id="S4.SS1.p3.7.m7.1a"><mn id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><cn id="S4.SS1.p3.7.m7.1.1.cmml" type="float" xref="S4.SS1.p3.7.m7.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">0.0001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.1d">0.0001</annotation></semantics></math>, respectively).
The best scores were measured as performance metrics during the training of the models for a consistent duration of 2,000 epochs. Because training a large model on a small dataset makes it difficult to compare performance, every model in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.T1" title="Table 1 ‣ 4.1 Implementation Details ‣ 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">1</span></a> except ConvNet was pre-trained on the ImagiNet-1K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib6" title="">6</a>]</cite> dataset.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.3.2" style="font-size:90%;">Experimental results of dataset condensation methods on CIFAR-10. HMDC is the best or second-best performer in most cases.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.4" style="width:397.5pt;height:219.1pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-149.9pt,82.4pt) scale(0.57,0.57) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T1.4.1.1.1.1.1">IPC</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.1.1.1.2" rowspan="2"><span class="ltx_text" id="S4.T1.4.1.1.1.2.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="10" id="S4.T1.4.1.1.1.3">Models (#Params)</th>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.1"><span class="ltx_text" id="S4.T1.4.1.2.2.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.1.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.1.1.1.1.1">ConvNet</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.1.1.1.2.1">(0.3M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.2"><span class="ltx_text" id="S4.T1.4.1.2.2.2.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.2.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.2.1.1.1.1">ResNet18</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.2.1.1.2.1">(11M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.3"><span class="ltx_text" id="S4.T1.4.1.2.2.3.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.3.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.3.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.3.1.1.1.1">ResNet50</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.3.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.3.1.1.2.1">(22M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.4"><span class="ltx_text" id="S4.T1.4.1.2.2.4.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.4.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.4.1.1.1.1">ResNet101</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.4.1.1.2.1">(43M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.5"><span class="ltx_text" id="S4.T1.4.1.2.2.5.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.5.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.5.1.1.1.1">CNN</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.5.1.1.2.1">Average</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.6"><span class="ltx_text" id="S4.T1.4.1.2.2.6.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.6.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.6.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.6.1.1.1.1">ViT-tiny</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.6.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.6.1.1.2.1">(5.5M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.7"><span class="ltx_text" id="S4.T1.4.1.2.2.7.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.7.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.7.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.7.1.1.1.1">ViT-small</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.7.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.7.1.1.2.1">(21M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.8"><span class="ltx_text" id="S4.T1.4.1.2.2.8.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.8.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.8.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.8.1.1.1.1">ViT-base</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.8.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.8.1.1.2.1">(86M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.9"><span class="ltx_text" id="S4.T1.4.1.2.2.9.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.9.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.9.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.9.1.1.1.1">ViT</span></span>
<span class="ltx_tr" id="S4.T1.4.1.2.2.9.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.9.1.1.2.1">Average</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.4.1.2.2.10"><span class="ltx_text" id="S4.T1.4.1.2.2.10.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.4.1.2.2.10.1.1">
<span class="ltx_tr" id="S4.T1.4.1.2.2.10.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.1.2.2.10.1.1.1.1">Average</span></span>
</span></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.4.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.1.3.1.1" rowspan="6"><span class="ltx_text" id="S4.T1.4.1.3.1.1.1">1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.1.3.1.2">Random</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.3">22.51±0.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.3.1.4.1">39.39±3.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.3.1.5.1">40.43±8.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.3.1.6.1">51.17±1.04</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.3.1.7.1">38.38±3.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.3.1.8.1">32.49±3.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.9"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.3.1.9.1">58.33±1.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.3.1.10.1">41.05±5.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.3.1.11.1">43.96±3.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.3.1.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.3.1.12.1">40.77±3.39</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.4.2.1">CAFE</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.2">27.16±0.74</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.3">22.65±4.08</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.4">24.83±1.87</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.5">24.09±1.54</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.6">24.68±2.06</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.7">16.53±2.71</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.8">19.35±3.71</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.9">22.11±7.67</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.10">19.33±4.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.4.2.11">22.39±3.19</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.5.3.1">IDM</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.2">37.51±0.32</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.3">17.50±2.36</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.4">16.07±1.20</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.5">11.47±0.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.6">20.64±1.11</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.7">12.85±0.74</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.8">11.40±1.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.9">12.12±4.27</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.10">12.12±2.19</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3.11">16.99±1.57</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.6.4.1">IDC</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.2">32.86±0.24</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.3">18.71±1.51</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.4">20.53±2.80</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.5">18.69±2.05</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.6">22.70±1.65</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.7">18.53±0.87</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.8">15.90±2.79</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.9">12.46±4.05</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.10">15.63±2.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.4.11">19.67±2.04</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.7.5.1">DREAM</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.7.5.2.1">38.76±0.47</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.3">29.75±2.40</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.4">28.99±2.45</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.5">33.24±8.03</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.6">32.68±3.33</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.7">19.86±1.00</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.8">21.82±1.96</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.9">22.00±4.50</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.10">21.23±2.49</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.7.5.11">27.77±2.97</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.8.6.1"><span class="ltx_text" id="S4.T1.4.1.8.6.1.1" style="background-color:#BFBFBF;">HMDC</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.2"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.2.1" style="background-color:#BFBFBF;">38.74±0.37</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.3"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.3.1" style="background-color:#BFBFBF;">52.76±2.45</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.4"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.4.1" style="background-color:#BFBFBF;">57.40±4.40</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.5"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.5.1" style="background-color:#BFBFBF;">51.70±0.81</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.6"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.6.1" style="background-color:#BFBFBF;">50.15±2.01</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.7"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.7.1" style="background-color:#BFBFBF;">39.27±6.08</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.8.6.8.1" style="background-color:#BFBFBF;">56.21±8.00</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.9"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.9.1" style="background-color:#BFBFBF;">49.46±10.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.10"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.10.1" style="background-color:#BFBFBF;">48.31±8.31</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.8.6.11"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.8.6.11.1" style="background-color:#BFBFBF;">49.36±4.71</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.1.9.7.1" rowspan="6"><span class="ltx_text" id="S4.T1.4.1.9.7.1.1">10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.1.9.7.2">Random</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.3">36.45±0.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.4">56.59±4.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.9.7.5.1">69.55±9.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.9.7.6.1">82.03±2.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.9.7.7.1">61.15±4.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.9.7.8.1">59.41±9.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.9"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.9.7.9.1">90.11±1.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.9.7.10.1">81.26±5.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.9.7.11.1">76.93±5.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.9.7.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.9.7.12.1">67.91±4.69</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.10.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.10.8.1">CAFE</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.2">34.89±0.60</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.3">49.85±4.85</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.4">61.52±10.8</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.5">65.73±6.24</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.6">53.00±5.63</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.7">47.94±5.20</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.8">88.70±2.86</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.9">75.07±11.91</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.10">70.57±6.66</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8.11">60.53±6.07</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.11.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.11.9.1">IDM</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.11.9.2.1">48.22±0.34</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.3">31.12±2.02</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.4">30.91±4.06</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.5">25.78±2.46</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.6">34.01±2.22</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.7">21.87±2.01</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.8">28.41±2.88</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.9">26.74±4.90</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.10">25.67±3.27</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9.11">30.44±2.67</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.12.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.12.10.1">IDC</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.2">46.67±0.15</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.3">56.35±1.92</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.4">67.53±2.77</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.5">60.94±4.48</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.6">57.87±2.33</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.7">50.23±8.38</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.8">68.67±8.50</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.9">64.32±12.32</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.10">61.07±9.73</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.10.11">59.24±5.50</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.13.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.13.11.1">DREAM</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.2"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.13.11.2.1">49.23±0.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.13.11.3.1">57.97±2.77</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.4">67.85±2.54</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.5">64.12±3.95</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.6">59.79±2.36</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.7">55.40±6.06</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.8">71.77±8.74</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.9">68.88±8.16</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.10">65.35±7.65</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.13.11.11">62.18±4.63</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.14.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.14.12.1"><span class="ltx_text" id="S4.T1.4.1.14.12.1.1" style="background-color:#BFBFBF;">HMDC</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.2"><span class="ltx_text" id="S4.T1.4.1.14.12.2.1" style="background-color:#BFBFBF;">47.54±0.73</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.3"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.12.3.1" style="background-color:#BFBFBF;">69.75±0.34</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.4"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.12.4.1" style="background-color:#BFBFBF;">77.99±1.53</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.5"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.12.5.1" style="background-color:#BFBFBF;">82.25±0.93</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.6"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.12.6.1" style="background-color:#BFBFBF;">69.38±0.88</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.7"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.12.7.1" style="background-color:#BFBFBF;">73.60±4.20</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.14.12.8.1" style="background-color:#BFBFBF;">89.02±1.42</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.9"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.12.9.1" style="background-color:#BFBFBF;">85.58±1.77</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.10"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.12.10.1" style="background-color:#BFBFBF;">82.73±2.46</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.14.12.11"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.12.11.1" style="background-color:#BFBFBF;">75.10±1.56</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.15.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.4.1.15.13.1" rowspan="6"><span class="ltx_text" id="S4.T1.4.1.15.13.1.1">50</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.1.15.13.2">Random</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.3">45.47±0.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.15.13.4.1">73.55±1.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.5">80.96±6.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.6">91.33±0.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.7">72.83±2.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.8">69.84±6.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.9"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.15.13.9.1">96.14±0.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.10"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.15.13.10.1">93.98±1.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.11"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.15.13.11.1">86.65±2.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.15.13.12">78.75±2.44</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.16.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.16.14.1">CAFE</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.2">44.32±0.13</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.3">75.06±1.33</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.16.14.4.1">83.45±3.46</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.5"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.16.14.5.1">91.92±0.35</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.16.14.6.1">73.69±1.32</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.7">67.84±3.05</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.16.14.8.1">95.81±0.87</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.16.14.9.1">92.86±2.92</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.10">85.50±2.28</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.16.14.11">78.75±1.73</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.17.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.17.15.1">IDM</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.17.15.2.1">52.82±0.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.3">64.01±0.47</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.4">72.60±0.49</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.5">67.15±12.6</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.6">64.14±3.45</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.7">53.55±4.13</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.8">77.52±15.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.9">74.56±11.6</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.10">68.54±10.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.17.15.11">66.03±6.42</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.18.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.18.16.1">IDC</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.2">49.75±0.22</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.3">71.16±1.26</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.4">82.82±3.23</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.18.16.5.1">91.45±0.50</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.6">73.80±1.30</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.18.16.7.1">70.37±1.52</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.8">95.44±0.29</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.9">92.65±1.56</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.18.16.10.1">86.16±1.12</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.18.16.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.1.18.16.11.1">79.09±1.22</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.19.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.1.19.17.1">DREAM</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.2"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.19.17.2.1">52.90±0.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.3">72.47±0.91</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.4">79.56±0.73</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.5">86.74±2.31</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.6">72.92±1.02</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.7">67.27±4.36</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.8">91.41±0.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.9">90.03±3.71</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.10">82.90±2.95</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.19.17.11">77.20±1.85</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.20.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T1.4.1.20.18.1"><span class="ltx_text" id="S4.T1.4.1.20.18.1.1" style="background-color:#BFBFBF;">HMDC</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.2"><span class="ltx_text" id="S4.T1.4.1.20.18.2.1" style="background-color:#BFBFBF;">52.40±0.04</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.3"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.20.18.3.1" style="background-color:#BFBFBF;">75.78±0.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.4"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.20.18.4.1" style="background-color:#BFBFBF;">84.06±0.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.5"><span class="ltx_text" id="S4.T1.4.1.20.18.5.1" style="background-color:#BFBFBF;">89.08±0.30</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.6"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.20.18.6.1" style="background-color:#BFBFBF;">75.33±0.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.7"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.20.18.7.1" style="background-color:#BFBFBF;">76.04±5.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.8"><span class="ltx_text" id="S4.T1.4.1.20.18.8.1" style="background-color:#BFBFBF;">90.91±0.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.9"><span class="ltx_text" id="S4.T1.4.1.20.18.9.1" style="background-color:#BFBFBF;">91.45±0.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.10"><span class="ltx_text" id="S4.T1.4.1.20.18.10.1" style="background-color:#BFBFBF;">86.13±2.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.4.1.20.18.11"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.20.18.11.1" style="background-color:#BFBFBF;">79.96±1.18</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.4">In our approach, we adopt ConvNet and ViT-tiny as heterogeneous models. We configure the iteration parameter to <math alttext="100" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mn id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><cn id="S4.SS1.p4.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">100</annotation></semantics></math> and set the loop to iterate <math alttext="100" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mn id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><cn id="S4.SS1.p4.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p4.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">100</annotation></semantics></math> times for each iteration. Within each iteration, we perform updates to the image, update the model, and adjust the affine layer along with the layer-matching matrix. The learning rate of each model is <math alttext="0.001" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><mn id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><cn id="S4.SS1.p4.3.m3.1.1.cmml" type="float" xref="S4.SS1.p4.3.m3.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">0.001</annotation></semantics></math>, and the affine layer and layer-matching matrix are <math alttext="0.01" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mn id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><cn id="S4.SS1.p4.4.m4.1.1.cmml" type="float" xref="S4.SS1.p4.4.m4.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">0.01</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">0.01</annotation></semantics></math>. Both use SGD optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib31" title="">31</a>]</cite> as follows prior works. We set the batch size to 128.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.T1" title="Table 1 ‣ 4.1 Implementation Details ‣ 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">1</span></a> presents a comprehensive performance comparison of the condensed images generated by each technique on CIFAR10. The proposed HMDC demonstrates commendable performance across most models, except ConvNet.
Notably, other techniques generally exhibit inferior performance compared to Random across all models, except for ConvNet. The described methods collaboratively yield a condensed image that is impactful without inducing over-condensation, particularly evident in the case of ConvNet. This trend becomes more pronounced as IPC decreases. Simultaneously, our method competes favorably with other methods on ConvNet. Noteworthy is that HMDC performs the best on IPC 1 for all models. This suggests that the proposed HMDC effectively captures general features and incorporates them into a limited synthetic image. Unlike previous methods, HMDC shows promise for training large models from images compressed from relatively small models, aligning with the goal of dataset condensation. Despite utilizing two models, HMDC requires only 100 iterations and consumes less time than other models, typically using 1,200 to 20,000 iterations.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Studies</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We conducted an ablation study to evaluate the impact of the proposed features on performance. Specifically, we examined performance by removing Mutual Distillation by Spatial-Sementic Decomposition and the Gradient Balance Module. Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.T2" title="Table 2 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">2</span></a> presents the experimental result of ablation. The experimental results demonstrate that each element contributes to performance, and when both methods are employed, they exhibit synergy.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">In the Ablation Study, the results demonstrate that the isolated application of the Gradient Balance Module (GBM) and Mutual Distillation (MD) can be beneficial in certain scenarios, though they tend to favor either Convolutional Neural Network (CNN) model. This leads to good performance on certain models and poor performance on others. The isolated use of the GBM tends to favor smaller models because the semantic distance between the two models fails to encapsulate the complex patterns necessary for larger models. Conversely, when only MD is employed, it extracts more generalized features, performing well with larger models. However, the results are biased due to the gradient difference in the condensed model. By combining these methods, a balanced gradient is achieved for each model, significantly reducing the semantic distance between them. This synergy not only enhances the overall performance but also ensures a more model-agnostic improvement.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.2.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.3.2" style="font-size:90%;">Table illustrating the outcomes of the ablation study. GBM means Gradient Balance Module and MD means Mutual Distillation by Spatial-Semantic Decomposition. The results demonstrate the individual contributions of the presented factors to performance enhancements, revealing a synergistic effect when employing them simultaneously.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.4" style="width:407.4pt;height:88.7pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-141.5pt,30.6pt) scale(0.59,0.59) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T2.4.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.4.1.1.1.1.1">GBM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.1.1.2" rowspan="2"><span class="ltx_text" id="S4.T2.4.1.1.1.2.1">MD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="10" id="S4.T2.4.1.1.1.3">CIFAR-10 (IPC 10)</th>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.1"><span class="ltx_text" id="S4.T2.4.1.2.2.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.1.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.1.1.1.1.1">ConvNet</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.1.1.1.2.1">(0.3M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.2"><span class="ltx_text" id="S4.T2.4.1.2.2.2.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.2.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.2.1.1.1.1">ResNet18</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.2.1.1.2.1">(11M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.3"><span class="ltx_text" id="S4.T2.4.1.2.2.3.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.3.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.3.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.3.1.1.1.1">ResNet50</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.3.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.3.1.1.2.1">(22M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.4"><span class="ltx_text" id="S4.T2.4.1.2.2.4.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.4.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.4.1.1.1.1">ResNet101</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.4.1.1.2.1">(43M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.5"><span class="ltx_text" id="S4.T2.4.1.2.2.5.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.5.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.5.1.1.1.1">CNN</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.5.1.1.2.1">Average</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.6"><span class="ltx_text" id="S4.T2.4.1.2.2.6.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.6.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.6.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.6.1.1.1.1">ViT-tiny</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.6.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.6.1.1.2.1">(5.5M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.7"><span class="ltx_text" id="S4.T2.4.1.2.2.7.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.7.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.7.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.7.1.1.1.1">ViT-small</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.7.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.7.1.1.2.1">(21M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.8"><span class="ltx_text" id="S4.T2.4.1.2.2.8.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.8.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.8.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.8.1.1.1.1">ViT-base</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.8.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.8.1.1.2.1">(86M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.9"><span class="ltx_text" id="S4.T2.4.1.2.2.9.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.9.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.9.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.9.1.1.1.1">ViT</span></span>
<span class="ltx_tr" id="S4.T2.4.1.2.2.9.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.9.1.1.2.1">Average</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.2.2.10"><span class="ltx_text" id="S4.T2.4.1.2.2.10.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.2.2.10.1.1">
<span class="ltx_tr" id="S4.T2.4.1.2.2.10.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.2.2.10.1.1.1.1">Average</span></span>
</span></span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T2.4.1.3.3.1">DREAM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.2"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.3.3.2.1">49.23±0.16</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.3">57.97±2.77</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.4">67.85±2.54</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.5">64.12±3.95</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.6">59.79±2.36</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.7">55.40±6.06</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.8">71.77±8.74</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.9">68.88±8.16</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.10">65.35±7.65</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.3.3.11">62.18±4.63</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.1.4.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S4.T2.4.1.4.1.1"></th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.4.1.2"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.3">46.42±0.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.4.1.4.1">72.11±0.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.5">76.46±1.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.6">76.85±0.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.7">67.96±0.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.4.1.8.1">74.09±4.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.4.1.9.1">90.01±1.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.4.1.10.1">82.71±0.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.4.1.11.1">82.27±2.04</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.1.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.4.1.12.1">74.09±1.22</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.4.1.5.2.1">✓</th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.5.2.2"></th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.3">47.43±0.46</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.4">71.62±1.25</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.5">76.92±0.36</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.6">77.70±1.77</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.7">68.41±0.96</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.8">73.67±2.38</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.9">86.62±3.11</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.10">78.53±6.77</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.11">79.61±4.08</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.5.2.12">73.21±2.30</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.6.3">
<th class="ltx_td ltx_th ltx_th_row" id="S4.T2.4.1.6.3.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.1.6.3.2">✓</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.3">47.30±0.41</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.6.3.4.1">72.01±1.46</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.5"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.6.3.5.1">78.05±2.23</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.6.3.6.1">79.07±1.69</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.6.3.7.1">69.11±1.45</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.8">70.96±4.02</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.9">86.25±5.25</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.10">80.16±5.36</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.11">79.12±4.88</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.1.6.3.12">73.40±2.92</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.7.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.1">✓</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.4.1.7.4.2">✓</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.7.4.3.1">47.54±82.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.4">69.75±75.10</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.7.4.5.1">77.99±0.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.6"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.7.4.6.1">82.25±0.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.7"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.7.4.7.1">69.38±1.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.7.4.8.1">73.60±0.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.1.7.4.9.1">89.02±0.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.10"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.7.4.10.1">85.58±4.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.11"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.7.4.11.1">82.73±1.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.7.4.12"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.7.4.12.1">75.10±1.77</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.2.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.3.2" style="font-size:90%;">
The performance variations across model combinations, depicting results for pairs of identical models (CNN + CNN) and pairs involving larger models than those employed in the experiment.
</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T3.4" style="width:433.6pt;height:68.3pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-203.4pt,31.8pt) scale(0.515906199493369,0.515906199493369) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T3.4.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.4.1.1.1.1.1">ConvNet</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T3.4.1.1.1.2" rowspan="2"><span class="ltx_text" id="S4.T3.4.1.1.1.2.1">ResNet18</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T3.4.1.1.1.3" rowspan="2"><span class="ltx_text" id="S4.T3.4.1.1.1.3.1">ViT-tiny</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T3.4.1.1.1.4" rowspan="2"><span class="ltx_text" id="S4.T3.4.1.1.1.4.1">ViT-small</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_t" colspan="10" id="S4.T3.4.1.1.1.5">CIFAR-10 (IPC 10)</th>
</tr>
<tr class="ltx_tr" id="S4.T3.4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.1"><span class="ltx_text" id="S4.T3.4.1.2.2.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.1.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.1.1.1.1.1">ConvNet</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.1.1.1.2.1">(0.3M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.2"><span class="ltx_text" id="S4.T3.4.1.2.2.2.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.2.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.2.1.1.1.1">ResNet18</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.2.1.1.2.1">(11M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.3"><span class="ltx_text" id="S4.T3.4.1.2.2.3.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.3.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.3.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.3.1.1.1.1">ResNet50</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.3.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.3.1.1.2.1">(22M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.4"><span class="ltx_text" id="S4.T3.4.1.2.2.4.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.4.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.4.1.1.1.1">ResNet101</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.4.1.1.2.1">(43M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.5"><span class="ltx_text" id="S4.T3.4.1.2.2.5.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.5.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.5.1.1.1.1">CNN</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.5.1.1.2.1">Average</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.6"><span class="ltx_text" id="S4.T3.4.1.2.2.6.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.6.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.6.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.6.1.1.1.1">ViT-tiny</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.6.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.6.1.1.2.1">(5.5M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.7"><span class="ltx_text" id="S4.T3.4.1.2.2.7.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.7.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.7.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.7.1.1.1.1">ViT-small</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.7.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.7.1.1.2.1">(21M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.8"><span class="ltx_text" id="S4.T3.4.1.2.2.8.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.8.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.8.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.8.1.1.1.1">ViT-base</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.8.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.8.1.1.2.1">(86M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.9"><span class="ltx_text" id="S4.T3.4.1.2.2.9.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.9.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.9.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.9.1.1.1.1">ViT</span></span>
<span class="ltx_tr" id="S4.T3.4.1.2.2.9.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.9.1.1.2.1">Average</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.2.2.10"><span class="ltx_text" id="S4.T3.4.1.2.2.10.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.4.1.2.2.10.1.1">
<span class="ltx_tr" id="S4.T3.4.1.2.2.10.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.1.2.2.10.1.1.1.1">Average</span></span>
</span></span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.4.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" colspan="4" id="S4.T3.4.1.3.3.1">Random</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.2">36.45±0.12</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.3">56.59±4.86</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.4">69.55±9.69</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.5">82.03±2.06</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.6">61.15±4.18</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.7">59.41±9.20</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.3.3.8.1">90.11±1.25</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.9">81.26±5.66</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.10">76.93±5.37</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.4.1.3.3.11">67.91±4.69</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.4.1.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.1.4.1.1">✓</th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.1.4.1.2"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.1.4.1.3">✓</th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.4.1.4.1.4"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.5"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.4.1.5.1">47.54±0.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.4.1.6.1">69.75±0.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.4.1.7.1">77.99±1.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.4.1.8.1">82.25±0.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.9"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.4.1.9.1">69.38±0.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.4.1.10.1">73.60±4.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.11">89.02±1.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.4.1.12.1">85.58±1.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.4.1.13.1">82.73±2.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.4.1.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.4.1.14.1">75.10±1.56</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.1.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.1.5.2.1">✓</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.1.5.2.2">✓</th>
<th class="ltx_td ltx_th ltx_th_row" id="S4.T3.4.1.5.2.3"></th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.1.5.2.4"></th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.5.2.5.1">45.85±0.71</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.6">44.09±4.33</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.7">47.32±1.06</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.8">32.91±2.31</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.9">42.54±2.10</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.10">33.79±1.90</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.11">34.93±5.55</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.12">34.58±14.63</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.13">34.43±7.36</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.1.5.2.14">39.07±4.35</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.1.6.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b" id="S4.T3.4.1.6.3.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="S4.T3.4.1.6.3.2">✓</th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_b" id="S4.T3.4.1.6.3.3"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T3.4.1.6.3.4">✓</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.5">38.10±0.40</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.6"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.6.3.6.1">70.67±0.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.7"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.6.3.7.1">79.85±1.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.8"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.6.3.8.1">83.82±1.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.4.1.6.3.9.1">68.11±1.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.10"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.6.3.10.1">75.80±2.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.11"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.6.3.11.1">92.42±0.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.12"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.6.3.12.1">88.60±4.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.13"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.6.3.13.1">85.61±2.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.4.1.6.3.14"><span class="ltx_text ltx_font_bold" id="S4.T3.4.1.6.3.14.1">75.61±1.64</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.2.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S4.T4.3.2" style="font-size:90%;">Comparison table between simply using ViT-Tiny and using the presented method.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.4" style="width:398.4pt;height:68.8pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-183.9pt,31.5pt) scale(0.52,0.52) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.4.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T4.4.1.1.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.1.1.2" rowspan="2"><span class="ltx_text" id="S4.T4.4.1.1.1.2.1">ConvNet</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.4.1.1.1.3" rowspan="2"><span class="ltx_text" id="S4.T4.4.1.1.1.3.1">ViT-tiny</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="10" id="S4.T4.4.1.1.1.4">CIFAR-10 (IPC 10)</th>
</tr>
<tr class="ltx_tr" id="S4.T4.4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.1"><span class="ltx_text" id="S4.T4.4.1.2.2.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.1.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.1.1.1.1.1">ConvNet</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.1.1.1.2.1">(0.3M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.2"><span class="ltx_text" id="S4.T4.4.1.2.2.2.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.2.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.2.1.1.1.1">ResNet18</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.2.1.1.2.1">(11M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.3"><span class="ltx_text" id="S4.T4.4.1.2.2.3.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.3.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.3.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.3.1.1.1.1">ResNet50</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.3.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.3.1.1.2.1">(22M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.4"><span class="ltx_text" id="S4.T4.4.1.2.2.4.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.4.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.4.1.1.1.1">ResNet101</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.4.1.1.2.1">(43M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.5"><span class="ltx_text" id="S4.T4.4.1.2.2.5.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.5.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.5.1.1.1.1">CNN</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.5.1.1.2.1">Average</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.6"><span class="ltx_text" id="S4.T4.4.1.2.2.6.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.6.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.6.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.6.1.1.1.1">ViT-tiny</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.6.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.6.1.1.2.1">(5.5M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.7"><span class="ltx_text" id="S4.T4.4.1.2.2.7.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.7.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.7.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.7.1.1.1.1">ViT-small</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.7.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.7.1.1.2.1">(21M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.8"><span class="ltx_text" id="S4.T4.4.1.2.2.8.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.8.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.8.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.8.1.1.1.1">ViT-base</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.8.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.8.1.1.2.1">(86M)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.9"><span class="ltx_text" id="S4.T4.4.1.2.2.9.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.9.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.9.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.9.1.1.1.1">ViT</span></span>
<span class="ltx_tr" id="S4.T4.4.1.2.2.9.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.9.1.1.2.1">Average</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.4.1.2.2.10"><span class="ltx_text" id="S4.T4.4.1.2.2.10.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.4.1.2.2.10.1.1">
<span class="ltx_tr" id="S4.T4.4.1.2.2.10.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.4.1.2.2.10.1.1.1.1">Average</span></span>
</span></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.4.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.1.3.1.1">Random</td>
<td class="ltx_td ltx_border_t" id="S4.T4.4.1.3.1.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T4.4.1.3.1.3"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.4">36.45±0.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.5">56.59±4.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.3.1.6.1">69.55±9.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.7"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.3.1.7.1">82.66±1.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.3.1.8.1">61.31±4.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.9">59.36±9.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.10"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.3.1.10.1">90.11±1.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.3.1.11.1">81.26±5.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.3.1.12.1">76.91±5.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.1.3.1.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.3.1.13.1">68.00±4.66</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.1.4.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.1.4.2.1">Dream</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.2">✓</td>
<td class="ltx_td ltx_border_r" id="S4.T4.4.1.4.2.3"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.4.2.4.1">49.23±0.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.4.2.5.1">57.97±2.77</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.6">67.85±2.54</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.7">64.12±3.95</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.8">59.79±2.36</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.9">55.40±6.06</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.10">71.77±8.74</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.11">68.88±8.16</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.12">65.35±7.65</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.4.2.13">62.18±4.63</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.1.5.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.1.5.3.1">Dream</td>
<td class="ltx_td" id="S4.T4.4.1.5.3.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.1.5.3.3">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.4">25.77±0.57</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.5">49.28±2.70</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.6">56.65±4.37</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.7">62.26±4.08</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.8">48.49±2.93</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.5.3.9.1">60.26±3.78</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.10">62.68±10.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.11">51.77±22.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.12">58.24±12.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.1.5.3.13">52.67±6.91</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.1.6.4">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.4.1.6.4.1">HMDC</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.4.1.6.4.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.6.4.4.1">47.54±0.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.6.4.5.1">69.75±0.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.6.4.6.1">77.99±1.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.6.4.7.1">82.25±0.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.8"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.6.4.8.1">69.38±0.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.9"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.6.4.9.1">73.60±4.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.4.1.6.4.10.1">89.02±1.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.11"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.6.4.11.1">85.58±1.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.12"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.6.4.12.1">82.73±2.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.4.1.6.4.13"><span class="ltx_text ltx_font_bold" id="S4.T4.4.1.6.4.13.1">75.10±1.56</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Comparision of condensed images between DREAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite> and HMDC(Ours)</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F3.sf1.g1" src="extracted/5871621/figure/Dream.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F3.sf1.3.2" style="font-size:90%;">Condensed image generated by DREAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite> method, with CIFAR10, 10 images per class.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F3.sf2.g1" src="extracted/5871621/figure/Ours.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F3.sf2.3.2" style="font-size:90%;">Condensed image generated by Heterogeneous Model Dataset Condensation (HMDC) method, with CIFAR10, 10 images per class.</span></figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Qualitative Results</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.F3.sf1" title="Figure 3(a) ‣ Figure 3 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">3(a)</span></a> presents a condensed image generated using the DREAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#bib.bib28" title="">28</a>]</cite> method.
In contrast, Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.F3.sf2" title="Figure 3(b) ‣ Figure 3 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">3(b)</span></a> depicts a condensed image created using the Heterogeneous Model Dataset Condensation approach.
Overall, we observe that objects exhibit the same characteristics, such as increased contrast and sharpened edges.
While the visual disparities are minimal, it is noteworthy that the image generated by our method exhibits fewer artifacts and distortions compared to DREAM.
These distortions appear to be caused by over-condensation, improving performance on certain models but degrading performance on others.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Analysis</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.T3" title="Table 3 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the performance outcomes of Heterogeneous Model Dataset Condensation across various model combinations.
Significantly, there is an evident decrease in overall performance when the CNN is used uniformly, contrary to the intended objective of the method.
In the third row, we adjusted the learning rate of the affine layer and layer-matching matrix to <math alttext="0.001" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mn id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><cn id="S4.SS5.p1.1.m1.1.1.cmml" type="float" xref="S4.SS5.p1.1.m1.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">0.001</annotation></semantics></math>. This suggests that with minimal modification, larger models can be accommodated using HMDC. We can also see that the use of larger models shows an overall benefit.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.T4" title="Table 4 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">4</span></a> presents a comparative analysis of our experimental results with the state-of-the-art method, DREAM, changing the model into ViT-Tiny.
The results reveal an overall enhancement in performance for ViT-Tiny attributed to an increased understanding of the model.
However, overall performance drops, especially in the ConvNet and it is notably worse compared to using random images. This trend is further emphasized by the large gap between HMDC in combination with ConvNet.
Conversely, in ConvNet, overall performance is diminished due to the model’s limited capacity, with a pronounced decline in the ViT series. This observation underscores the model dependency of the condensed image and the condensed image is over-condensed.</p>
</div>
<div class="ltx_para" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S4.F4" title="Figure 4 ‣ 4.5 Analysis ‣ 4 Experiments ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">4</span></a> depicts the maximum gradient magnitude of the synthetic image after the learning step.
On the left, before integrating the Gradient Balance Module, there is a substantial disparity in the gradient magnitudes, leading to the neglect of other losses.
Following the inclusion of the Gradient Balance Module, the gradient magnitudes from each loss function become uniform.
This ensures balanced dataset condensation irrespective of the model, underscoring the essential role of the Gradient Balance Module in Heterogeneous Model Dataset Condensation.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.4.2.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.2.1" style="font-size:90%;">A logarithmic plot depicting the gradient magnitude evolution of a synthetic image throughout the training process. L1 and L2 refer to the optimization targets in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.14538v1#S3.E3" title="Equation 3 ‣ 3.2 Heterogeneous Model Dataset Condensation ‣ 3 Method ‣ Towards Model-Agnostic Dataset Condensation by Heterogeneous Models"><span class="ltx_text ltx_ref_tag">3</span></a>. L3 is <math alttext="\mathrm{MSE}\left(\nabla\mathcal{L}_{\mathrm{MD}}(\textbf{x}^{t}),\nabla%
\mathcal{L}_{\mathrm{MD}}\right)" class="ltx_Math" display="inline" id="S4.F4.2.1.m1.2"><semantics id="S4.F4.2.1.m1.2b"><mrow id="S4.F4.2.1.m1.2.2" xref="S4.F4.2.1.m1.2.2.cmml"><mi id="S4.F4.2.1.m1.2.2.4" xref="S4.F4.2.1.m1.2.2.4.cmml">MSE</mi><mo id="S4.F4.2.1.m1.2.2.3" xref="S4.F4.2.1.m1.2.2.3.cmml">⁢</mo><mrow id="S4.F4.2.1.m1.2.2.2.2" xref="S4.F4.2.1.m1.2.2.2.3.cmml"><mo id="S4.F4.2.1.m1.2.2.2.2.3" xref="S4.F4.2.1.m1.2.2.2.3.cmml">(</mo><mrow id="S4.F4.2.1.m1.1.1.1.1.1" xref="S4.F4.2.1.m1.1.1.1.1.1.cmml"><mrow id="S4.F4.2.1.m1.1.1.1.1.1.3" xref="S4.F4.2.1.m1.1.1.1.1.1.3.cmml"><mo id="S4.F4.2.1.m1.1.1.1.1.1.3.1" rspace="0.167em" xref="S4.F4.2.1.m1.1.1.1.1.1.3.1.cmml">∇</mo><msub id="S4.F4.2.1.m1.1.1.1.1.1.3.2" xref="S4.F4.2.1.m1.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F4.2.1.m1.1.1.1.1.1.3.2.2" xref="S4.F4.2.1.m1.1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S4.F4.2.1.m1.1.1.1.1.1.3.2.3" xref="S4.F4.2.1.m1.1.1.1.1.1.3.2.3.cmml">MD</mi></msub></mrow><mo id="S4.F4.2.1.m1.1.1.1.1.1.2" xref="S4.F4.2.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.F4.2.1.m1.1.1.1.1.1.1.1" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.F4.2.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.F4.2.1.m1.1.1.1.1.1.1.1.1" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.2a.cmml">x</mtext><mi id="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S4.F4.2.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.F4.2.1.m1.2.2.2.2.4" xref="S4.F4.2.1.m1.2.2.2.3.cmml">,</mo><mrow id="S4.F4.2.1.m1.2.2.2.2.2" xref="S4.F4.2.1.m1.2.2.2.2.2.cmml"><mo id="S4.F4.2.1.m1.2.2.2.2.2.1" rspace="0.167em" xref="S4.F4.2.1.m1.2.2.2.2.2.1.cmml">∇</mo><msub id="S4.F4.2.1.m1.2.2.2.2.2.2" xref="S4.F4.2.1.m1.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F4.2.1.m1.2.2.2.2.2.2.2" xref="S4.F4.2.1.m1.2.2.2.2.2.2.2.cmml">ℒ</mi><mi id="S4.F4.2.1.m1.2.2.2.2.2.2.3" xref="S4.F4.2.1.m1.2.2.2.2.2.2.3.cmml">MD</mi></msub></mrow><mo id="S4.F4.2.1.m1.2.2.2.2.5" xref="S4.F4.2.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.2.1.m1.2c"><apply id="S4.F4.2.1.m1.2.2.cmml" xref="S4.F4.2.1.m1.2.2"><times id="S4.F4.2.1.m1.2.2.3.cmml" xref="S4.F4.2.1.m1.2.2.3"></times><ci id="S4.F4.2.1.m1.2.2.4.cmml" xref="S4.F4.2.1.m1.2.2.4">MSE</ci><interval closure="open" id="S4.F4.2.1.m1.2.2.2.3.cmml" xref="S4.F4.2.1.m1.2.2.2.2"><apply id="S4.F4.2.1.m1.1.1.1.1.1.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1"><times id="S4.F4.2.1.m1.1.1.1.1.1.2.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.2"></times><apply id="S4.F4.2.1.m1.1.1.1.1.1.3.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.3"><ci id="S4.F4.2.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.3.1">∇</ci><apply id="S4.F4.2.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.F4.2.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.F4.2.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.3.2.2">ℒ</ci><ci id="S4.F4.2.1.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.3.2.3">MD</ci></apply></apply><apply id="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.2">x</mtext></ci><ci id="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.F4.2.1.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S4.F4.2.1.m1.2.2.2.2.2.cmml" xref="S4.F4.2.1.m1.2.2.2.2.2"><ci id="S4.F4.2.1.m1.2.2.2.2.2.1.cmml" xref="S4.F4.2.1.m1.2.2.2.2.2.1">∇</ci><apply id="S4.F4.2.1.m1.2.2.2.2.2.2.cmml" xref="S4.F4.2.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.F4.2.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.F4.2.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.F4.2.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.F4.2.1.m1.2.2.2.2.2.2.2">ℒ</ci><ci id="S4.F4.2.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.F4.2.1.m1.2.2.2.2.2.2.3">MD</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.1.m1.2d">\mathrm{MSE}\left(\nabla\mathcal{L}_{\mathrm{MD}}(\textbf{x}^{t}),\nabla%
\mathcal{L}_{\mathrm{MD}}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.F4.2.1.m1.2e">roman_MSE ( ∇ caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT ( x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) , ∇ caligraphic_L start_POSTSUBSCRIPT roman_MD end_POSTSUBSCRIPT )</annotation></semantics></math>. </span></figcaption><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="230" id="S4.F4.g1" src="x3.png" width="664"/>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We identified a model dependency issue in existing dataset condensation methods and proposed a remedy by balancing different heterogeneous models. However, employing two distinct models for dataset condensation introduces two challenges: bias arising from differences in gradient magnitude between the models and semantic distance resulting from the models converging to their respective optimal points. To address the gradient magnitude disparity, we introduced the Gradient Balance Module. To tackle the semantic distance issue, we proposed Mutual Distillation by Spatial-Semantic Decomposition. The combination of these components effectively alleviated the model dependency problem.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">However, there are still some limitations. Firstly, it is impossible to surpass the model’s capacity limits, as evidenced by the performance gap for ViT-Base due to a fifteenfold difference in parameter number. Furthermore, due to the continued use of floating points in condensed images, they occupy four times the capacity of the equivalent number of real images. From this standpoint, there is a need for quantization-aware condensation that enables the synthetic image to be treated like a real image.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work was supported by MSIT (Ministry of Science and ICT), Korea, under the ITRC (Information Technology Research Center) support program (IITP-2024-RS-2023-00258649) supervised by the IITP (Institute for Information &amp; Communications Technology Planning &amp; Evaluation), and in part by the IITP grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068, and by the IITP grant funded by the Korea government (MSIT) (No.RS-2022-00155911, Artificial Intelligence Convergence Innovation Human Resources Development (Kyung Hee University)).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Agarwal, P.K., Har-Peled, S., Varadarajan, K.R.: Approximating extent measures of points. J. ACM <span class="ltx_text ltx_font_bold" id="bib.bib1.1.1">51</span>(4), 606–635 (jul 2004). https://doi.org/10.1145/1008731.1008736, <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1008731.1008736" title="">https://doi.org/10.1145/1008731.1008736</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Cazenavette, G., Wang, T., Torralba, A., Efros, A.A., Zhu, J.Y.: Dataset distillation by matching training trajectories. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 4750–4759 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Cazenavette, G., Wang, T., Torralba, A., Efros, A.A., Zhu, J.Y.: Generalizing dataset distillation via deep generative prior. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 3739–3748 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Chen, Z., Badrinarayanan, V., Lee, C.Y., Rabinovich, A.: Gradnorm: Gradient normalization for adaptive loss balancing in deep multitask networks. In: International conference on machine learning. pp. 794–803. PMLR (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Cubuk, E.D., Zoph, B., Mane, D., Vasudevan, V., Le, Q.V.: Autoaugment: Learning augmentation policies from data. arXiv e-prints p. arXiv preprint arXiv:1805.09501 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Deng, J., Dong, W., Socher, R., Li, L.J., Li, K., Fei-Fei, L.: Imagenet: A large-scale hierarchical image database. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 248–255. Ieee (2009)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
DeVries, T., Taylor, G.W.: Improved regularization of convolutional neural networks with cutout. arXiv preprint arXiv:1708.04552 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., et al.: An image is worth 16x16 words: Transformers for image recognition at scale. In: International Conference on Learning Representations (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Feldman, D., Schmidt, M., Sohler, C.: Turning big data into tiny data: Constant-size coresets for k-means, pca, and projective clustering. SIAM Journal on Computing <span class="ltx_text ltx_font_bold" id="bib.bib9.1.1">49</span>(3), 601–657 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Furlanello, T., Lipton, Z., Tschannen, M., Itti, L., Anandkumar, A.: Born again neural networks. In: International Conference on Machine Learning. pp. 1607–1616. PMLR (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Goodfellow, I., Pouget-Abadie, J., Mirza, M., Xu, B., Warde-Farley, D., Ozair, S., Courville, A., Bengio, Y.: Generative adversarial nets. Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bib11.1.1">27</span> (2014)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Har-Peled, S., Mazumdar, S.: On coresets for k-means and k-median clustering. In: Proceedings of the Thirty-Sixth Annual ACM Symposium on Theory of Computing. p. 291–300. STOC ’04, Association for Computing Machinery, New York, NY, USA (2004). https://doi.org/10.1145/1007352.1007400, <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1007352.1007400" title="">https://doi.org/10.1145/1007352.1007400</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image recognition. In: Proceedings of the IEEE conference on computer vision and pattern recognition. pp. 770–778 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Heo, B., Kim, J., Yun, S., Park, H., Kwak, N., Choi, J.Y.: A comprehensive overhaul of feature distillation. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 1921–1930 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Heo, B., Lee, M., Yun, S., Choi, J.Y.: Knowledge transfer via distillation of activation boundaries formed by hidden neurons. In: Proceedings of the AAAI Conference on Artificial Intelligence. vol. 33, pp. 3779–3787 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Hinton, G., Vinyals, O., Dean, J.: Distilling the knowledge in a neural network. arXiv preprint arXiv:1503.02531 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Ho, J., Jain, A., Abbeel, P.: Denoising diffusion probabilistic models. Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bib17.1.1">33</span>, 6840–6851 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Huang, Z., Wang, N.: Like what you like: Knowledge distill via neuron selectivity transfer. arXiv preprint arXiv:1707.01219 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Karystinos, G.N., Pados, D.A.: On overfitting, generalization, and randomly expanded training sets. IEEE Transactions on Neural Networks <span class="ltx_text ltx_font_bold" id="bib.bib19.1.1">11</span>(5), 1050–1057 (2000)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Kendall, A., Gal, Y., Cipolla, R.: Multi-task learning using uncertainty to weigh losses for scene geometry and semantics. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 7482–7491 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Kim, J.H., Kim, J., Oh, S.J., Yun, S., Song, H., Jeong, J., Ha, J.W., Song, H.O.: Dataset condensation via efficient synthetic-data parameterization. In: International Conference on Machine Learning. pp. 11102–11118. PMLR (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Kim, J., Park, S., Kwak, N.: Paraphrasing complex network: Network compression via factor transfer. Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bib22.1.1">31</span> (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.: Learning multiple layers of features from tiny images (2009)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Krizhevsky, A., Sutskever, I., Hinton, G.E.: Imagenet classification with deep convolutional neural networks. Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bib24.1.1">25</span> (2012)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
LeCun, Y., Bengio, Y., Hinton, G.: Deep learning. nature <span class="ltx_text ltx_font_bold" id="bib.bib25.1.1">521</span>(7553), 436–444 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
LeCun, Y., Bottou, L., Bengio, Y., Haffner, P.: Gradient-based learning applied to document recognition. Proceedings of the IEEE <span class="ltx_text ltx_font_bold" id="bib.bib26.1.1">86</span>(11), 2278–2324 (1998)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Li, W.H., Liu, X., Bilen, H.: Universal representation learning from multiple domains for few-shot classification. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 9526–9535 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Liu, Y., Gu, J., Wang, K., Zhu, Z., Jiang, W., You, Y.: Dream: Efficient dataset distillation by representative matching. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 17314–17324 (October 2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Mirzadeh, S.I., Farajtabar, M., Li, A., Levine, N., Matsukawa, A., Ghasemzadeh, H.: Improved knowledge distillation via teacher assistant. In: Proceedings of the AAAI conference on artificial intelligence. vol. 34, pp. 5191–5198 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Nguyen, T., Novak, R., Xiao, L., Lee, J.: Dataset distillation with infinitely wide convolutional networks. Advances in Neural Information Processing Systems <span class="ltx_text ltx_font_bold" id="bib.bib30.1.1">34</span>, 5186–5198 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Robbins, H., Monro, S.: A stochastic approximation method. The annals of mathematical statistics pp. 400–407 (1951)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Rumelhart, D.E., Hinton, G.E., Williams, R.J., et al.: Learning internal representations by error propagation (1985)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A.N., Kaiser, Ł., Polosukhin, I.: Attention is all you need. Advances in neural information processing systems <span class="ltx_text ltx_font_bold" id="bib.bib33.1.1">30</span> (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Wang, K., Zhao, B., Peng, X., Zhu, Z., Yang, S., Wang, S., Huang, G., Bilen, H., Wang, X., You, Y.: Cafe: Learning to condense dataset by aligning features. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 12196–12205 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Wang, T., Zhu, J.Y., Torralba, A., Efros, A.A.: Dataset distillation. arXiv preprint arXiv:1811.10959 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Yang, C., Xie, L., Su, C., Yuille, A.L.: Snapshot distillation: Teacher-student optimization in one generation. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 2859–2868 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Yun, S., Han, D., Oh, S.J., Chun, S., Choe, J., Yoo, Y.: Cutmix: Regularization strategy to train strong classifiers with localizable features. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 6023–6032 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Zhao, B., Mopuri, K.R., Bilen, H.: Dataset condensation with gradient matching. In: International Conference on Learning Representations (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Zhao, B., Cui, Q., Song, R., Qiu, Y., Liang, J.: Decoupled knowledge distillation. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 11953–11962 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Zhao, G., Li, G., Qin, Y., Yu, Y.: Improved distribution matching for dataset condensation. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 7856–7865 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Zhou, Y., Nezhadarya, E., Ba, J.: Dataset distillation using neural feature regression. Advances in Neural Information Processing Systems <span class="ltx_text ltx_font_bold" id="bib.bib41.1.1">35</span>, 9813–9827 (2022)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Sep 22 17:10:28 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
