<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever</title>
<!--Generated on Wed Jun 19 23:24:52 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.13885v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S1" title="In Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S2" title="In Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3" title="In Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.SS1" title="In 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>An Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.SS2" title="In 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Zero-shot and Few-shot Pipelines of KnowTS</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.SS3" title="In 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Flexible Sequential Demonstration Retriever (FlexSDR)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.SS3.SSS1" title="In 3.3 Flexible Sequential Demonstration Retriever (FlexSDR) ‣ 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Policy Network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.SS3.SSS2" title="In 3.3 Flexible Sequential Demonstration Retriever (FlexSDR) ‣ 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Learning Rewards</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4" title="In Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS1" title="In 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Dataset Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS2" title="In 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS3" title="In 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>LLMs Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS4" title="In 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>FlexSDR Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS5" title="In 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Zero-Shot and Naive Few-Shot Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS6" title="In 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Demonstration Retriever Enhanced Few-shot Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS7" title="In 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Ablation Studies</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS8" title="In 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.8 </span>Case Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S5" title="In Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A1" title="In Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>MathKnowCT Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A2" title="In Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Return Function of FlexRetICR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A3" title="In Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>LLMs Implementation Details</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hang Li<sup class="ltx_sup" id="id7.7.id1"><span class="ltx_text ltx_font_italic" id="id7.7.id1.1">1,2</span></sup>  Tianlong Xu<sup class="ltx_sup" id="id8.8.id2"><span class="ltx_text ltx_font_italic" id="id8.8.id2.1">2</span></sup>  Jiliang Tang<sup class="ltx_sup" id="id9.9.id3">2</sup>  Qingsong Wen<sup class="ltx_sup" id="id10.10.id4"><span class="ltx_text ltx_font_italic" id="id10.10.id4.1">1</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id11.11.id5">1</sup>Squirrel AI  <sup class="ltx_sup" id="id12.12.id6">2</sup>Michigan State University
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id13.13.id7">{tianlongxu, qingsongwen}@squirrelai.com
<br class="ltx_break"/>{lihang4, tangjili}@msu.edu</span>
</span><span class="ltx_author_notes">Corresponding author</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id14.id1">Knowledge tagging for questions plays a crucial role in contemporary intelligent educational applications, including learning progress diagnosis, practice question recommendations, and course content organization.
Traditionally, these annotations are always conducted by pedagogical experts, as the task requires not only a strong semantic understanding of both question stems and knowledge definitions but also deep insights into connecting question-solving logic with corresponding knowledge concepts.
With the recent emergence of advanced text encoding algorithms, such as pre-trained language models, many researchers have developed automatic knowledge tagging systems based on calculating the semantic similarity between the knowledge and question embeddings.
In this paper, we explore automating the task using Large Language Models (LLMs), in response to the inability of prior encoding-based methods to deal with the hard cases which involve strong domain knowledge and complicated concept definitions.
By showing the strong performance of zero- and few-shot results over math questions knowledge tagging tasks, we demonstrate LLMs’ great potential in conquering the challenges faced by prior methods.
Furthermore, by proposing a reinforcement learning-based demonstration retriever, we successfully exploit the great potential of different-sized LLMs in achieving better performance results while keeping the in-context demonstration usage efficiency high. Data and code is available in <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://anonymous.4open.science/r/KnowTS-0563" title="">https://anonymous.4open.science/r/KnowTS-0563</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Knowledge concept tagging aims to generate a precise knowledge index to educational materials. It has been recognized as an important factor of current intelligent education systems in providing high-quality educational content to educators and learners during the practice <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib1" title="">1</a>]</cite>. For example, with well-annotated education materials, teachers can enjoy great conveniences in organizing coursing content through searching concept keywords index <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib2" title="">2</a>]</cite>. Among the tagging objects, concept tagging over math questions has attracted greatly attention because of the recent successes of applying intelligent tutoring systems (ITS) in mathematical education <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib3" title="">3</a>]</cite>. Traditionally, the questions’ concept tags are annotated by the pedagogical experts. However, the rapid growth of the Internet has caused conventional manual methods to be insufficient to meet the demand for handling large volumes of online question data or updating existing concept tags in a timely fashion.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To solve the above issues, existing works <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib4" title="">4</a>]</cite> have tried to automate the tagging process with different natural language processing (NLP) algorithms.
For example, Du et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib5" title="">5</a>]</cite> use text embedding techniques to convert the knowledge definitions and question stems into dense vectors, and then train machine learning classifiers based on the embedding similarities. However, such practice focuses only on comparing the explicit text semantic information but dismisses the implicit relationship in question solutions and knowledge concepts. It can cause unsatisfactory performance when faced with complicated knowledge descriptions and questions. One recent study attempts to improve the tagging performance by leveraging pre-trained language models (PLMs) and fusing external information, such as solution text and conceptual ontology, with original question contents during the judging process <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib6" title="">6</a>]</cite>. Although this new trial demonstrates its effectiveness in solving the challenges faced by prior embedding-based methods, it introduces additional data requirements, e.g., complementary solution text to questions and conceptual ontology information between knowledge concepts, to the knowledge tagging model, which restrict the wide applications of the algorithm to questions with limited external resources.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this work, we propose a novel knowledge-tagging framework KnowTS. It can leverage the advanced mathematical and logical inference capabilities <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib7" title="">7</a>]</cite> of LLMs to enable knowledge tagging with only knowledge definition text. In addition, owing to the strong in-context learning ability of LLMs, KnowTS has the potential to be swiftly applied with a few annotation samples, setting it apart from all previous training-based algorithms. This feature allows KnowTS to be rapidly adapted for annotating works encompassing nearly all knowledge concepts and questions. Furthermore, due to the huge performance gap among using different sets of demonstration samples <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib8" title="">8</a>]</cite>, we propose a novel reinforcement learning (RL) based demonstration retriever focusing on dynamically providing flexible lengths of demonstration samples to every question knowledge matching queries. To validate the effectiveness of KnowTS, we experiment with an expert-annotated knowledge concept question dataset collected from a public K-12 education platform. Experimental results demonstrate that KnowTS can achieve the best in-context learning performance while using fewer demonstrations.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="260" id="S1.F1.g1" src="x1.png" width="748"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">An overview of the workflow of the proposed KnowTS system.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.1.1">Knowledge Concept Tagging</span>:
The major challenge of knowledge tagging tasks is how to construct a meaningful link in between the knowledge concepts and the problems, either through the description of the problem themselves or through solutions. The task formulation can primarily be categorized into two directions: retrieval and matrix decomposition. The former relies heavily on training a semantic representation. Sun et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib9" title="">9</a>]</cite> employs simple backbone models such as long short-term memory (LSTM) and some attention mechanisms to learn short-range dependency embeddings, where the questions are fed into LSTM layers and are ultimately connected to cross-entropy functions that indicate whether or not a tagging concept belongs to a given problem. Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib10" title="">10</a>]</cite> devised an exercise-enhanced recurrent neural network with Markov property and Attention mechanism to extract rich knowledge concepts information in the exercise’s content. Similarly but with enriched data source such as text, multi-modal data <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yin2019quesnet</span>]</cite> as well as latex formula combined data <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib11" title="">11</a>]</cite>, semantic representations learned with LSTM have been improved to capture more implicit contexts. Huang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib12" title="">12</a>]</cite> fills knowledge graph information into the embedding layers and achieves better mathematical semantic understanding. To take advantage of the robust transformers framework, Zemlyanskiy et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib13" title="">13</a>]</cite> pretrained a BERT model to learn jointly predicting words and entities as movie tags given the reviews of movies. Huang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib14" title="">14</a>]</cite> proposes an improved pretrained bidirectional encoder representation from transformers (BERT) for concept tagging with both questions and solutions.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.1.1">In-context Learning Retriever</span>:
Few-shot in-context learning (ICL) is the ability of large language models (LLMs) to perform a new task when a few input-output examples or demonstrations for the new task are given alongside the actual task input <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib15" title="">15</a>]</cite>. Importantly, the model parameters do not have to be fine-tuned towards the new task. However, the performance of ICL varies significantly based on the choice of demonstrations <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib8" title="">8</a>]</cite>. In order to keep the stability of ICL performance and exploit the potential of LLMs, many ICL methods have been proposed in recent studies. Rubin et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib16" title="">16</a>]</cite> investigated using SBERT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib17" title="">17</a>]</cite> embeddings for demonstration retrieval and show that retrieving demonstrations based on SBERT embeddings often provides a boost in performance compared to zero-shot or random few-shot selection. Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib18" title="">18</a>]</cite> found that fine-tuning pre-trrained language models on task-related datasets offered further empirical gains. Besides using embedding to recall relevant demonstrations, recent works tried to build a proxy scoring model to score each candidate demonstration. Then, a retriever is trained, which separates top-score examples from bottom-score examples <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib16" title="">16</a>]</cite>. At last, Scarlatos and Lan <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib19" title="">19</a>]</cite> and Lu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib20" title="">20</a>]</cite> directly use response correctness as the reward function and train policy network with RL-method to decide the best demonstration for different samples dynamically.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.5">Before diving into the details of the method, we first give a formal problem definition to the knowledge tagging task as follows: Given a pair of knowledge definition text <math alttext="k" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_k</annotation></semantics></math> and a question’s stem text <math alttext="q" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_q</annotation></semantics></math>, the objective of a concept tagging model is to produce a binary judgment <math alttext="y\in\{0,1\}" class="ltx_Math" display="inline" id="S3.p1.3.m3.2"><semantics id="S3.p1.3.m3.2a"><mrow id="S3.p1.3.m3.2.3" xref="S3.p1.3.m3.2.3.cmml"><mi id="S3.p1.3.m3.2.3.2" xref="S3.p1.3.m3.2.3.2.cmml">y</mi><mo id="S3.p1.3.m3.2.3.1" xref="S3.p1.3.m3.2.3.1.cmml">∈</mo><mrow id="S3.p1.3.m3.2.3.3.2" xref="S3.p1.3.m3.2.3.3.1.cmml"><mo id="S3.p1.3.m3.2.3.3.2.1" stretchy="false" xref="S3.p1.3.m3.2.3.3.1.cmml">{</mo><mn id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">0</mn><mo id="S3.p1.3.m3.2.3.3.2.2" xref="S3.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S3.p1.3.m3.2.2" xref="S3.p1.3.m3.2.2.cmml">1</mn><mo id="S3.p1.3.m3.2.3.3.2.3" stretchy="false" xref="S3.p1.3.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.2b"><apply id="S3.p1.3.m3.2.3.cmml" xref="S3.p1.3.m3.2.3"><in id="S3.p1.3.m3.2.3.1.cmml" xref="S3.p1.3.m3.2.3.1"></in><ci id="S3.p1.3.m3.2.3.2.cmml" xref="S3.p1.3.m3.2.3.2">𝑦</ci><set id="S3.p1.3.m3.2.3.3.1.cmml" xref="S3.p1.3.m3.2.3.3.2"><cn id="S3.p1.3.m3.1.1.cmml" type="integer" xref="S3.p1.3.m3.1.1">0</cn><cn id="S3.p1.3.m3.2.2.cmml" type="integer" xref="S3.p1.3.m3.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.2c">y\in\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.2d">italic_y ∈ { 0 , 1 }</annotation></semantics></math>, where 1 means <math alttext="k" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_k</annotation></semantics></math> and <math alttext="q" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_q</annotation></semantics></math> are matching, 0 otherwise. In the following subsections, we first present an overview of our proposed framework, KnowTS. Then, we introduce details about the implementations of KnowTS with zero-shot and few-shot inference pipelines. Lastly, to further boost the performance of KnowTS with demonstration samples, we propose FlexSDR, an RL-based retriever algorithm, to achieve efficient and high-performance knowledge tagging.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>An Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">An overview of KnowTS is demonstrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">1</span></a>. It consists of three key components: (1) zero-shot inference pipeline, (2) few-shot inference pipeline, and (3) adaptive demonstration retriever. Each component in KnowTS plays different roles to accommodate different knowledge tagging scenarios. When there is no available annotated data, KnowTS will leverage a zero-shot pipeline to generate the judgment directly. And, when there are limited available demonstration examples, KnowTS will use the few-shot inference via its in-context learning capability. When the demonstration samples are needed to select for demonstration, KnowTS will utilize a demonstration retriever to adaptively select effective demonstrations for different <math alttext="(k,q)" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.2"><semantics id="S3.SS1.p1.1.m1.2a"><mrow id="S3.SS1.p1.1.m1.2.3.2" xref="S3.SS1.p1.1.m1.2.3.1.cmml"><mo id="S3.SS1.p1.1.m1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">k</mi><mo id="S3.SS1.p1.1.m1.2.3.2.2" xref="S3.SS1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">q</mi><mo id="S3.SS1.p1.1.m1.2.3.2.3" stretchy="false" xref="S3.SS1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><interval closure="open" id="S3.SS1.p1.1.m1.2.3.1.cmml" xref="S3.SS1.p1.1.m1.2.3.2"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑘</ci><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">(k,q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.2d">( italic_k , italic_q )</annotation></semantics></math> pairs.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Zero-shot and Few-shot Pipelines of KnowTS</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">One key difference between KnowTS and other prior machine learning models is its strong performance while facing limited or even no annotated data for each knowledge <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_k</annotation></semantics></math>. Such advantages contribute to the powerful zero-shot inference capability of LLMs, which is empowered by its huge size model parameter and the extensive pre-training on diverse and vast datasets. Prior studies by Wei et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib21" title="">21</a>]</cite> demonstrate that LLMs have strengths in comprehending instructions in natural language and applying learned knowledge to new problems with limited or even no training data specific to these tasks. In our problem, we leverage this capability by composing a zero-shot prompt as follows: we first describe the goal of the tagging task as <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.1">"You are a knowledge concept annotator. Your job is to judge whether the &lt;Question&gt; is concerning the &lt;Knowledge&gt;."</em> Then, for the convenience of the processing procedure, we add a response format instruction in the prompt: <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.2">"The judgment token: &lt;Yes&gt; or &lt;No&gt; should be provided at the end of the response."</em> At last, as the prior studies like Chain-of-Thought (COT) <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib22" title="">22</a>]</cite> have discovered, instructing LLMs to generate step-by-step problem-solving solutions will be helpful for the LLMs to draw the correct conclusions, especially when faced with complicated problems, we ask LLMs to not only provide their positive or negative predictions but also present the reason at first: <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.3">"You should first provide the reasons before giving your judgement."</em> Overall, the zero-shot task instruction prompt is presented as follows:</p>
<blockquote class="ltx_quote" id="S3.SS2.p1.5">
<p class="ltx_p" id="S3.SS2.p1.5.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S3.SS2.p1.5.1.1">Instruction</em>: You are a knowledge concept annotator.
Your job is to judge whether the &lt;Question&gt; is concerning the &lt;Knowledge&gt;.
You should first provide the reasons before giving your judgment.
The judgment token: &lt;Yes&gt; or &lt;No&gt; should be provided at the end of the response.</p>
<p class="ltx_p" id="S3.SS2.p1.5.2"><em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.5.2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.2.1.1">Knowledge</span>:</em> <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS2.p1.5.2.2">&lt;Knowledge&gt;: The composition of numbers within 20.</span></p>
<p class="ltx_p" id="S3.SS2.p1.5.3"><em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.5.3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.3.1.1">Question</span>:</em> <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS2.p1.5.3.2">&lt;Question&gt;: There are ( ) tens and ( ) ones in 14.</span></p>
<p class="ltx_p" id="S3.SS2.p1.5.4"><em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.5.4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.4.1.1">Judgement</span>:</em> (Generated by LLMs)</p>
</blockquote>
<p class="ltx_p" id="S3.SS2.p1.4">Although the zero-shot prompt provides a promising solution without using any annotated samples, the knowledge definition text <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m1.1"><semantics id="S3.SS2.p1.2.m1.1a"><mi id="S3.SS2.p1.2.m1.1.1" xref="S3.SS2.p1.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m1.1b"><ci id="S3.SS2.p1.2.m1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m1.1d">italic_k</annotation></semantics></math> may sometimes not be specific enough for complicated judgments. For example, there is a knowledge concept named <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.4.1">consecutive carry in multiplication</em>, which occurs when the product of two digits, along with any carry from the previous calculation, results in a number greater than 9, thus requiring another carry to be added to the next column in the calculation. It is hard for many LLMs to catch that key point during the judging process without any hints. To overcome this problem, KnowTS can leverage a few-shot inference pipeline when there are available demonstration samples associated with the given knowledge <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m2.1"><semantics id="S3.SS2.p1.3.m2.1a"><mi id="S3.SS2.p1.3.m2.1.1" xref="S3.SS2.p1.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m2.1b"><ci id="S3.SS2.p1.3.m2.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m2.1d">italic_k</annotation></semantics></math>. Contributing to LLMs’ strong in-context learning (ICL) capability, KnowTS can imitate the judging logic of the given demonstrations and achieve significant performance gain even with limited samples provided. Detailed comparisons between zero-shot and few-shot responses are shown in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS6" title="4.6 Demonstration Retriever Enhanced Few-shot Results ‣ 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">4.6</span></a>. Below, we give a demonstration example, which interprets the "consecutive carry" to LLMs with an example judgment written by experts <math alttext="38\times 9" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m3.1"><semantics id="S3.SS2.p1.4.m3.1a"><mrow id="S3.SS2.p1.4.m3.1.1" xref="S3.SS2.p1.4.m3.1.1.cmml"><mn id="S3.SS2.p1.4.m3.1.1.2" xref="S3.SS2.p1.4.m3.1.1.2.cmml">38</mn><mo id="S3.SS2.p1.4.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.4.m3.1.1.1.cmml">×</mo><mn id="S3.SS2.p1.4.m3.1.1.3" xref="S3.SS2.p1.4.m3.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m3.1b"><apply id="S3.SS2.p1.4.m3.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1"><times id="S3.SS2.p1.4.m3.1.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1.1"></times><cn id="S3.SS2.p1.4.m3.1.1.2.cmml" type="integer" xref="S3.SS2.p1.4.m3.1.1.2">38</cn><cn id="S3.SS2.p1.4.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p1.4.m3.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m3.1c">38\times 9</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m3.1d">38 × 9</annotation></semantics></math>:</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<blockquote class="ltx_quote" id="S3.SS2.p2.4">
<p class="ltx_p" id="S3.SS2.p2.4.4">There is a consecutive carry start from multiplication of the one’s place (<math alttext="8\times 9=72" class="ltx_Math" display="inline" id="S3.SS2.p2.1.1.m1.1"><semantics id="S3.SS2.p2.1.1.m1.1a"><mrow id="S3.SS2.p2.1.1.m1.1.1" xref="S3.SS2.p2.1.1.m1.1.1.cmml"><mrow id="S3.SS2.p2.1.1.m1.1.1.2" xref="S3.SS2.p2.1.1.m1.1.1.2.cmml"><mn id="S3.SS2.p2.1.1.m1.1.1.2.2" xref="S3.SS2.p2.1.1.m1.1.1.2.2.cmml">8</mn><mo id="S3.SS2.p2.1.1.m1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.1.1.m1.1.1.2.1.cmml">×</mo><mn id="S3.SS2.p2.1.1.m1.1.1.2.3" xref="S3.SS2.p2.1.1.m1.1.1.2.3.cmml">9</mn></mrow><mo id="S3.SS2.p2.1.1.m1.1.1.1" xref="S3.SS2.p2.1.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.1.1.m1.1.1.3" xref="S3.SS2.p2.1.1.m1.1.1.3.cmml">72</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.1.m1.1b"><apply id="S3.SS2.p2.1.1.m1.1.1.cmml" xref="S3.SS2.p2.1.1.m1.1.1"><eq id="S3.SS2.p2.1.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.1.m1.1.1.1"></eq><apply id="S3.SS2.p2.1.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.1.m1.1.1.2"><times id="S3.SS2.p2.1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p2.1.1.m1.1.1.2.1"></times><cn id="S3.SS2.p2.1.1.m1.1.1.2.2.cmml" type="integer" xref="S3.SS2.p2.1.1.m1.1.1.2.2">8</cn><cn id="S3.SS2.p2.1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.SS2.p2.1.1.m1.1.1.2.3">9</cn></apply><cn id="S3.SS2.p2.1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.1.1.m1.1.1.3">72</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.1.m1.1c">8\times 9=72</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.1.m1.1d">8 × 9 = 72</annotation></semantics></math>, carry <math alttext="7" class="ltx_Math" display="inline" id="S3.SS2.p2.2.2.m2.1"><semantics id="S3.SS2.p2.2.2.m2.1a"><mn id="S3.SS2.p2.2.2.m2.1.1" xref="S3.SS2.p2.2.2.m2.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.2.m2.1b"><cn id="S3.SS2.p2.2.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p2.2.2.m2.1.1">7</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.2.m2.1c">7</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.2.m2.1d">7</annotation></semantics></math>), and then a carry from the tens place operation (<math alttext="3\times 9+7=34" class="ltx_Math" display="inline" id="S3.SS2.p2.3.3.m3.1"><semantics id="S3.SS2.p2.3.3.m3.1a"><mrow id="S3.SS2.p2.3.3.m3.1.1" xref="S3.SS2.p2.3.3.m3.1.1.cmml"><mrow id="S3.SS2.p2.3.3.m3.1.1.2" xref="S3.SS2.p2.3.3.m3.1.1.2.cmml"><mrow id="S3.SS2.p2.3.3.m3.1.1.2.2" xref="S3.SS2.p2.3.3.m3.1.1.2.2.cmml"><mn id="S3.SS2.p2.3.3.m3.1.1.2.2.2" xref="S3.SS2.p2.3.3.m3.1.1.2.2.2.cmml">3</mn><mo id="S3.SS2.p2.3.3.m3.1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.3.3.m3.1.1.2.2.1.cmml">×</mo><mn id="S3.SS2.p2.3.3.m3.1.1.2.2.3" xref="S3.SS2.p2.3.3.m3.1.1.2.2.3.cmml">9</mn></mrow><mo id="S3.SS2.p2.3.3.m3.1.1.2.1" xref="S3.SS2.p2.3.3.m3.1.1.2.1.cmml">+</mo><mn id="S3.SS2.p2.3.3.m3.1.1.2.3" xref="S3.SS2.p2.3.3.m3.1.1.2.3.cmml">7</mn></mrow><mo id="S3.SS2.p2.3.3.m3.1.1.1" xref="S3.SS2.p2.3.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.3.3.m3.1.1.3" xref="S3.SS2.p2.3.3.m3.1.1.3.cmml">34</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.3.m3.1b"><apply id="S3.SS2.p2.3.3.m3.1.1.cmml" xref="S3.SS2.p2.3.3.m3.1.1"><eq id="S3.SS2.p2.3.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.3.m3.1.1.1"></eq><apply id="S3.SS2.p2.3.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.3.m3.1.1.2"><plus id="S3.SS2.p2.3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.3.m3.1.1.2.1"></plus><apply id="S3.SS2.p2.3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.3.m3.1.1.2.2"><times id="S3.SS2.p2.3.3.m3.1.1.2.2.1.cmml" xref="S3.SS2.p2.3.3.m3.1.1.2.2.1"></times><cn id="S3.SS2.p2.3.3.m3.1.1.2.2.2.cmml" type="integer" xref="S3.SS2.p2.3.3.m3.1.1.2.2.2">3</cn><cn id="S3.SS2.p2.3.3.m3.1.1.2.2.3.cmml" type="integer" xref="S3.SS2.p2.3.3.m3.1.1.2.2.3">9</cn></apply><cn id="S3.SS2.p2.3.3.m3.1.1.2.3.cmml" type="integer" xref="S3.SS2.p2.3.3.m3.1.1.2.3">7</cn></apply><cn id="S3.SS2.p2.3.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p2.3.3.m3.1.1.3">34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.3.m3.1c">3\times 9+7=34</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.3.m3.1d">3 × 9 + 7 = 34</annotation></semantics></math>, carry <math alttext="3" class="ltx_Math" display="inline" id="S3.SS2.p2.4.4.m4.1"><semantics id="S3.SS2.p2.4.4.m4.1a"><mn id="S3.SS2.p2.4.4.m4.1.1" xref="S3.SS2.p2.4.4.m4.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.4.m4.1b"><cn id="S3.SS2.p2.4.4.m4.1.1.cmml" type="integer" xref="S3.SS2.p2.4.4.m4.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.4.m4.1c">3</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.4.m4.1d">3</annotation></semantics></math>). Thus, the question matches the given knowledge descriptions. &lt;Yes&gt;</p>
</blockquote>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">Finally, by presenting the example answers as inputs and instructing LLMs to generate similar responses, LLMs will learn and follow the judging steps of demonstrations, which will also help them output more relevant responses.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Flexible Sequential Demonstration Retriever (FlexSDR)</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.15">Although incorporating available demonstrations has the potential to bring LLMs performance gain compared to the zero-shot setting, the effectiveness of each demonstration varies <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib18" title="">18</a>]</cite>. Moreover, different input pairs <math alttext="(k,q)" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.2"><semantics id="S3.SS3.p1.1.m1.2a"><mrow id="S3.SS3.p1.1.m1.2.3.2" xref="S3.SS3.p1.1.m1.2.3.1.cmml"><mo id="S3.SS3.p1.1.m1.2.3.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">k</mi><mo id="S3.SS3.p1.1.m1.2.3.2.2" xref="S3.SS3.p1.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.1.m1.2.2" xref="S3.SS3.p1.1.m1.2.2.cmml">q</mi><mo id="S3.SS3.p1.1.m1.2.3.2.3" stretchy="false" xref="S3.SS3.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.2b"><interval closure="open" id="S3.SS3.p1.1.m1.2.3.1.cmml" xref="S3.SS3.p1.1.m1.2.3.2"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑘</ci><ci id="S3.SS3.p1.1.m1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.2c">(k,q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.2d">( italic_k , italic_q )</annotation></semantics></math> may prefer to different combinations of demonstrations. To fully exploit the potential of KnowTS, we propose a reinforcement learning (RL) based demonstration selection method, termed Flexible Sequential Demonstration Retriever (FlexSDR), aiming to help LLMs exploit their potential from the demonstration samples while keeping only the necessary demonstrations as input for each input query. Formally, we define the key components of Markov Decision Process (MDP) in our problem as follows: Given the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_t</annotation></semantics></math> step’s status <math alttext="s_{t}=\{k,q,e_{1},..,e_{t-1}\}" class="ltx_math_unparsed" display="inline" id="S3.SS3.p1.3.m3.2"><semantics id="S3.SS3.p1.3.m3.2a"><mrow id="S3.SS3.p1.3.m3.2b"><msub id="S3.SS3.p1.3.m3.2.3"><mi id="S3.SS3.p1.3.m3.2.3.2">s</mi><mi id="S3.SS3.p1.3.m3.2.3.3">t</mi></msub><mo id="S3.SS3.p1.3.m3.2.4">=</mo><mrow id="S3.SS3.p1.3.m3.2.5"><mo id="S3.SS3.p1.3.m3.2.5.1" stretchy="false">{</mo><mi id="S3.SS3.p1.3.m3.1.1">k</mi><mo id="S3.SS3.p1.3.m3.2.5.2">,</mo><mi id="S3.SS3.p1.3.m3.2.2">q</mi><mo id="S3.SS3.p1.3.m3.2.5.3">,</mo><msub id="S3.SS3.p1.3.m3.2.5.4"><mi id="S3.SS3.p1.3.m3.2.5.4.2">e</mi><mn id="S3.SS3.p1.3.m3.2.5.4.3">1</mn></msub><mo id="S3.SS3.p1.3.m3.2.5.5">,</mo><mo id="S3.SS3.p1.3.m3.2.5.6" lspace="0em" rspace="0.0835em">.</mo><mo id="S3.SS3.p1.3.m3.2.5.7" lspace="0.0835em" rspace="0.167em">.</mo><mo id="S3.SS3.p1.3.m3.2.5.8">,</mo><msub id="S3.SS3.p1.3.m3.2.5.9"><mi id="S3.SS3.p1.3.m3.2.5.9.2">e</mi><mrow id="S3.SS3.p1.3.m3.2.5.9.3"><mi id="S3.SS3.p1.3.m3.2.5.9.3.2">t</mi><mo id="S3.SS3.p1.3.m3.2.5.9.3.1">−</mo><mn id="S3.SS3.p1.3.m3.2.5.9.3.3">1</mn></mrow></msub><mo id="S3.SS3.p1.3.m3.2.5.10" stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.2c">s_{t}=\{k,q,e_{1},..,e_{t-1}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.2d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { italic_k , italic_q , italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , . . , italic_e start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="(k,q)" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.2"><semantics id="S3.SS3.p1.4.m4.2a"><mrow id="S3.SS3.p1.4.m4.2.3.2" xref="S3.SS3.p1.4.m4.2.3.1.cmml"><mo id="S3.SS3.p1.4.m4.2.3.2.1" stretchy="false" xref="S3.SS3.p1.4.m4.2.3.1.cmml">(</mo><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">k</mi><mo id="S3.SS3.p1.4.m4.2.3.2.2" xref="S3.SS3.p1.4.m4.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.4.m4.2.2" xref="S3.SS3.p1.4.m4.2.2.cmml">q</mi><mo id="S3.SS3.p1.4.m4.2.3.2.3" stretchy="false" xref="S3.SS3.p1.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.2b"><interval closure="open" id="S3.SS3.p1.4.m4.2.3.1.cmml" xref="S3.SS3.p1.4.m4.2.3.2"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑘</ci><ci id="S3.SS3.p1.4.m4.2.2.cmml" xref="S3.SS3.p1.4.m4.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.2c">(k,q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.2d">( italic_k , italic_q )</annotation></semantics></math> are the input knowledge and question pair and <math alttext="e_{i|1\leq i\leq t-1}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">e</mi><mrow id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml"><mrow id="S3.SS3.p1.5.m5.1.1.3.2" xref="S3.SS3.p1.5.m5.1.1.3.2.cmml"><mi id="S3.SS3.p1.5.m5.1.1.3.2.2" xref="S3.SS3.p1.5.m5.1.1.3.2.2.cmml">i</mi><mo fence="false" id="S3.SS3.p1.5.m5.1.1.3.2.1" xref="S3.SS3.p1.5.m5.1.1.3.2.1.cmml">|</mo><mn id="S3.SS3.p1.5.m5.1.1.3.2.3" xref="S3.SS3.p1.5.m5.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS3.p1.5.m5.1.1.3.3" xref="S3.SS3.p1.5.m5.1.1.3.3.cmml">≤</mo><mi id="S3.SS3.p1.5.m5.1.1.3.4" xref="S3.SS3.p1.5.m5.1.1.3.4.cmml">i</mi><mo id="S3.SS3.p1.5.m5.1.1.3.5" xref="S3.SS3.p1.5.m5.1.1.3.5.cmml">≤</mo><mrow id="S3.SS3.p1.5.m5.1.1.3.6" xref="S3.SS3.p1.5.m5.1.1.3.6.cmml"><mi id="S3.SS3.p1.5.m5.1.1.3.6.2" xref="S3.SS3.p1.5.m5.1.1.3.6.2.cmml">t</mi><mo id="S3.SS3.p1.5.m5.1.1.3.6.1" xref="S3.SS3.p1.5.m5.1.1.3.6.1.cmml">−</mo><mn id="S3.SS3.p1.5.m5.1.1.3.6.3" xref="S3.SS3.p1.5.m5.1.1.3.6.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝑒</ci><apply id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3"><and id="S3.SS3.p1.5.m5.1.1.3a.cmml" xref="S3.SS3.p1.5.m5.1.1.3"></and><apply id="S3.SS3.p1.5.m5.1.1.3b.cmml" xref="S3.SS3.p1.5.m5.1.1.3"><leq id="S3.SS3.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3.3"></leq><apply id="S3.SS3.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.p1.5.m5.1.1.3.2"><csymbol cd="latexml" id="S3.SS3.p1.5.m5.1.1.3.2.1.cmml" xref="S3.SS3.p1.5.m5.1.1.3.2.1">conditional</csymbol><ci id="S3.SS3.p1.5.m5.1.1.3.2.2.cmml" xref="S3.SS3.p1.5.m5.1.1.3.2.2">𝑖</ci><cn id="S3.SS3.p1.5.m5.1.1.3.2.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.1.1.3.2.3">1</cn></apply><ci id="S3.SS3.p1.5.m5.1.1.3.4.cmml" xref="S3.SS3.p1.5.m5.1.1.3.4">𝑖</ci></apply><apply id="S3.SS3.p1.5.m5.1.1.3c.cmml" xref="S3.SS3.p1.5.m5.1.1.3"><leq id="S3.SS3.p1.5.m5.1.1.3.5.cmml" xref="S3.SS3.p1.5.m5.1.1.3.5"></leq><share href="https://arxiv.org/html/2406.13885v1#S3.SS3.p1.5.m5.1.1.3.4.cmml" id="S3.SS3.p1.5.m5.1.1.3d.cmml" xref="S3.SS3.p1.5.m5.1.1.3"></share><apply id="S3.SS3.p1.5.m5.1.1.3.6.cmml" xref="S3.SS3.p1.5.m5.1.1.3.6"><minus id="S3.SS3.p1.5.m5.1.1.3.6.1.cmml" xref="S3.SS3.p1.5.m5.1.1.3.6.1"></minus><ci id="S3.SS3.p1.5.m5.1.1.3.6.2.cmml" xref="S3.SS3.p1.5.m5.1.1.3.6.2">𝑡</ci><cn id="S3.SS3.p1.5.m5.1.1.3.6.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.1.1.3.6.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">e_{i|1\leq i\leq t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_e start_POSTSUBSCRIPT italic_i | 1 ≤ italic_i ≤ italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> are the demonstrations selected in prior <math alttext="t-1" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mrow id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">t</mi><mo id="S3.SS3.p1.6.m6.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.cmml">−</mo><mn id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><minus id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1"></minus><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">𝑡</ci><cn id="S3.SS3.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS3.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_t - 1</annotation></semantics></math> steps, we hope to use the policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.1d">italic_π</annotation></semantics></math> to generate the subsequent action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1"><semantics id="S3.SS3.p1.8.m8.1a"><msub id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml">a</mi><mi id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2">𝑎</ci><ci id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which selects one demonstration sample <math alttext="e_{t}\in E_{\mathcal{D}}" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1"><semantics id="S3.SS3.p1.9.m9.1a"><mrow id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><msub id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2.2" xref="S3.SS3.p1.9.m9.1.1.2.2.cmml">e</mi><mi id="S3.SS3.p1.9.m9.1.1.2.3" xref="S3.SS3.p1.9.m9.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS3.p1.9.m9.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.cmml">∈</mo><msub id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml"><mi id="S3.SS3.p1.9.m9.1.1.3.2" xref="S3.SS3.p1.9.m9.1.1.3.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.9.m9.1.1.3.3" xref="S3.SS3.p1.9.m9.1.1.3.3.cmml">𝒟</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><in id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1"></in><apply id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.2.1.cmml" xref="S3.SS3.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.2.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2.2">𝑒</ci><ci id="S3.SS3.p1.9.m9.1.1.2.3.cmml" xref="S3.SS3.p1.9.m9.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.3.1.cmml" xref="S3.SS3.p1.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.3.2.cmml" xref="S3.SS3.p1.9.m9.1.1.3.2">𝐸</ci><ci id="S3.SS3.p1.9.m9.1.1.3.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3.3">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">e_{t}\in E_{\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m9.1d">italic_e start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ italic_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="E_{\mathcal{D}}" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.1"><semantics id="S3.SS3.p1.10.m10.1a"><msub id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml"><mi id="S3.SS3.p1.10.m10.1.1.2" xref="S3.SS3.p1.10.m10.1.1.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.10.m10.1.1.3" xref="S3.SS3.p1.10.m10.1.1.3.cmml">𝒟</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2">𝐸</ci><ci id="S3.SS3.p1.10.m10.1.1.3.cmml" xref="S3.SS3.p1.10.m10.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">E_{\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m10.1d">italic_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math> is the demonstration bank or choose the stop signal <math alttext="e_{\mathcal{E}}" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m11.1"><semantics id="S3.SS3.p1.11.m11.1a"><msub id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml"><mi id="S3.SS3.p1.11.m11.1.1.2" xref="S3.SS3.p1.11.m11.1.1.2.cmml">e</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.11.m11.1.1.3" xref="S3.SS3.p1.11.m11.1.1.3.cmml">ℰ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><apply id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m11.1.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.p1.11.m11.1.1.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2">𝑒</ci><ci id="S3.SS3.p1.11.m11.1.1.3.cmml" xref="S3.SS3.p1.11.m11.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">e_{\mathcal{E}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m11.1d">italic_e start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT</annotation></semantics></math>. This process’s reward is finding the best demonstration sequence (action trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m12.1"><semantics id="S3.SS3.p1.12.m12.1a"><mi id="S3.SS3.p1.12.m12.1.1" xref="S3.SS3.p1.12.m12.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m12.1b"><ci id="S3.SS3.p1.12.m12.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m12.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m12.1d">italic_τ</annotation></semantics></math>) which helps LLMs correctly judge the knowledge matching <math alttext="(k,q)" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m13.2"><semantics id="S3.SS3.p1.13.m13.2a"><mrow id="S3.SS3.p1.13.m13.2.3.2" xref="S3.SS3.p1.13.m13.2.3.1.cmml"><mo id="S3.SS3.p1.13.m13.2.3.2.1" stretchy="false" xref="S3.SS3.p1.13.m13.2.3.1.cmml">(</mo><mi id="S3.SS3.p1.13.m13.1.1" xref="S3.SS3.p1.13.m13.1.1.cmml">k</mi><mo id="S3.SS3.p1.13.m13.2.3.2.2" xref="S3.SS3.p1.13.m13.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.13.m13.2.2" xref="S3.SS3.p1.13.m13.2.2.cmml">q</mi><mo id="S3.SS3.p1.13.m13.2.3.2.3" stretchy="false" xref="S3.SS3.p1.13.m13.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m13.2b"><interval closure="open" id="S3.SS3.p1.13.m13.2.3.1.cmml" xref="S3.SS3.p1.13.m13.2.3.2"><ci id="S3.SS3.p1.13.m13.1.1.cmml" xref="S3.SS3.p1.13.m13.1.1">𝑘</ci><ci id="S3.SS3.p1.13.m13.2.2.cmml" xref="S3.SS3.p1.13.m13.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m13.2c">(k,q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.13.m13.2d">( italic_k , italic_q )</annotation></semantics></math> while keeping the <math alttext="|\tau|" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m14.1"><semantics id="S3.SS3.p1.14.m14.1a"><mrow id="S3.SS3.p1.14.m14.1.2.2" xref="S3.SS3.p1.14.m14.1.2.1.cmml"><mo id="S3.SS3.p1.14.m14.1.2.2.1" stretchy="false" xref="S3.SS3.p1.14.m14.1.2.1.1.cmml">|</mo><mi id="S3.SS3.p1.14.m14.1.1" xref="S3.SS3.p1.14.m14.1.1.cmml">τ</mi><mo id="S3.SS3.p1.14.m14.1.2.2.2" stretchy="false" xref="S3.SS3.p1.14.m14.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m14.1b"><apply id="S3.SS3.p1.14.m14.1.2.1.cmml" xref="S3.SS3.p1.14.m14.1.2.2"><abs id="S3.SS3.p1.14.m14.1.2.1.1.cmml" xref="S3.SS3.p1.14.m14.1.2.2.1"></abs><ci id="S3.SS3.p1.14.m14.1.1.cmml" xref="S3.SS3.p1.14.m14.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m14.1c">|\tau|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.14.m14.1d">| italic_τ |</annotation></semantics></math> small. To be noticed although there are several RL-based methods, we point out that FlexSDR has its novelty in two perspectives: (1) we introduce the "early stop" option to each interactive step and use the stop bonus reward to guide the policy network <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS3.p1.15.m15.1"><semantics id="S3.SS3.p1.15.m15.1a"><mi id="S3.SS3.p1.15.m15.1.1" xref="S3.SS3.p1.15.m15.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m15.1b"><ci id="S3.SS3.p1.15.m15.1.1.cmml" xref="S3.SS3.p1.15.m15.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m15.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.15.m15.1d">italic_π</annotation></semantics></math> to learn when to stop during the reinforcing process. With such design, FlexSDR avoids retrieving redundant demonstrations because of the prefixed demonstration size parameter and reduces the risk of sub-optimal few-shot inference performance <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib23" title="">23</a>]</cite>; and (2) We incorporate each intermediate step as an individual training sample and help the policy network learn to conduct the best action decision based on each step’s response correctness status. More details about the effectiveness of each design are discussed in Sec <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.SS7" title="4.7 Ablation Studies ‣ 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">4.7</span></a>. In the following subsections, we introduce both the policy network and reward design of FlexSDR in details.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="292" id="S3.F2.g1" src="x2.png" width="821"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">The framework of the proposed FlexSDR.</span></figcaption>
</figure>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Policy Network</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.21">Firstly, we define the policy network as <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><msub id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml">π</mi><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">𝜋</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, and the policy execution process is to select an action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><msub id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.1.1.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.2.cmml">a</mi><mi id="S3.SS3.SSS1.p1.2.m2.1.1.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><apply id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.2">𝑎</ci><ci id="S3.SS3.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> from the probability distribution calculated by <math alttext="\pi_{\theta}(a|s_{t})" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m3.1"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><mrow id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml"><msub id="S3.SS3.SSS1.p1.3.m3.1.1.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.1.3.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.3.2.cmml">π</mi><mi id="S3.SS3.SSS1.p1.3.m3.1.1.3.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.SSS1.p1.3.m3.1.1.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.2.cmml">s</mi><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><apply id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1"><times id="S3.SS3.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.2"></times><apply id="S3.SS3.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.3.2">𝜋</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.2">𝑎</ci><apply id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">\pi_{\theta}(a|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>. As the action space for our policy network is decided by the demonstration bank <math alttext="E_{\mathcal{D}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.4.m4.1"><semantics id="S3.SS3.SSS1.p1.4.m4.1a"><msub id="S3.SS3.SSS1.p1.4.m4.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.1.1.2" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.4.m4.1.1.3" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.cmml">𝒟</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.1b"><apply id="S3.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2">𝐸</ci><ci id="S3.SS3.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.1c">E_{\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.4.m4.1d">italic_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math>, we decompose <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.5.m5.1"><semantics id="S3.SS3.SSS1.p1.5.m5.1a"><msub id="S3.SS3.SSS1.p1.5.m5.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS1.p1.5.m5.1.1.2" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.cmml">π</mi><mi id="S3.SS3.SSS1.p1.5.m5.1.1.3" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m5.1b"><apply id="S3.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2">𝜋</ci><ci id="S3.SS3.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m5.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.5.m5.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> into two components <math alttext="\pi_{\theta}=\mathcal{G}(\mathcal{F}(s_{t}),[E_{\mathcal{D}}\|e_{\mathcal{E}}])" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.6.m6.2"><semantics id="S3.SS3.SSS1.p1.6.m6.2a"><mrow id="S3.SS3.SSS1.p1.6.m6.2.2" xref="S3.SS3.SSS1.p1.6.m6.2.2.cmml"><msub id="S3.SS3.SSS1.p1.6.m6.2.2.4" xref="S3.SS3.SSS1.p1.6.m6.2.2.4.cmml"><mi id="S3.SS3.SSS1.p1.6.m6.2.2.4.2" xref="S3.SS3.SSS1.p1.6.m6.2.2.4.2.cmml">π</mi><mi id="S3.SS3.SSS1.p1.6.m6.2.2.4.3" xref="S3.SS3.SSS1.p1.6.m6.2.2.4.3.cmml">θ</mi></msub><mo id="S3.SS3.SSS1.p1.6.m6.2.2.3" xref="S3.SS3.SSS1.p1.6.m6.2.2.3.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.6.m6.2.2.2" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.6.m6.2.2.2.4" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.4.cmml">𝒢</mi><mo id="S3.SS3.SSS1.p1.6.m6.2.2.2.3" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.3.cmml"><mo id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.3" stretchy="false" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.3.cmml">(</mo><mrow id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.3.cmml">ℱ</mi><mo id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.4" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.3.cmml">,</mo><mrow id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.2.cmml"><mo id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.2.1.cmml">[</mo><mrow id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.cmml"><msub id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.2" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.3" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.3.cmml">𝒟</mi></msub><mo id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.1" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.1.cmml">∥</mo><msub id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.2" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.2.cmml">e</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.3" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.3.cmml">ℰ</mi></msub></mrow><mo id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.3" stretchy="false" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.2.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.5" stretchy="false" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.6.m6.2b"><apply id="S3.SS3.SSS1.p1.6.m6.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2"><eq id="S3.SS3.SSS1.p1.6.m6.2.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.3"></eq><apply id="S3.SS3.SSS1.p1.6.m6.2.2.4.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m6.2.2.4.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.4">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m6.2.2.4.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.4.2">𝜋</ci><ci id="S3.SS3.SSS1.p1.6.m6.2.2.4.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.4.3">𝜃</ci></apply><apply id="S3.SS3.SSS1.p1.6.m6.2.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2"><times id="S3.SS3.SSS1.p1.6.m6.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.3"></times><ci id="S3.SS3.SSS1.p1.6.m6.2.2.2.4.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.4">𝒢</ci><interval closure="open" id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2"><apply id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1"><times id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.2"></times><ci id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.3">ℱ</ci><apply id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.1">conditional</csymbol><apply id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.2">𝐸</ci><ci id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.2.3">𝒟</ci></apply><apply id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.2">𝑒</ci><ci id="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.2.2.2.2.2.2.1.1.3.3">ℰ</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.6.m6.2c">\pi_{\theta}=\mathcal{G}(\mathcal{F}(s_{t}),[E_{\mathcal{D}}\|e_{\mathcal{E}}])</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.6.m6.2d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = caligraphic_G ( caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , [ italic_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT ∥ italic_e start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT ] )</annotation></semantics></math>, where <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.7.m7.1"><semantics id="S3.SS3.SSS1.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.7.m7.1.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.7.m7.1b"><ci id="S3.SS3.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.7.m7.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.7.m7.1d">caligraphic_F</annotation></semantics></math> is a status encoder function that converts the sequential based status variable <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.8.m8.1"><semantics id="S3.SS3.SSS1.p1.8.m8.1a"><msub id="S3.SS3.SSS1.p1.8.m8.1.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.1.1.2" xref="S3.SS3.SSS1.p1.8.m8.1.1.2.cmml">s</mi><mi id="S3.SS3.SSS1.p1.8.m8.1.1.3" xref="S3.SS3.SSS1.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.8.m8.1b"><apply id="S3.SS3.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m8.1.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m8.1.1.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.2">𝑠</ci><ci id="S3.SS3.SSS1.p1.8.m8.1.1.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.8.m8.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into a status vector <math alttext="h_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.9.m9.1"><semantics id="S3.SS3.SSS1.p1.9.m9.1a"><msub id="S3.SS3.SSS1.p1.9.m9.1.1" xref="S3.SS3.SSS1.p1.9.m9.1.1.cmml"><mi id="S3.SS3.SSS1.p1.9.m9.1.1.2" xref="S3.SS3.SSS1.p1.9.m9.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS1.p1.9.m9.1.1.3" xref="S3.SS3.SSS1.p1.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.9.m9.1b"><apply id="S3.SS3.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.9.m9.1.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.9.m9.1.1.2.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.2">ℎ</ci><ci id="S3.SS3.SSS1.p1.9.m9.1.1.3.cmml" xref="S3.SS3.SSS1.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.9.m9.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.9.m9.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.10.m10.1"><semantics id="S3.SS3.SSS1.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.10.m10.1.1" xref="S3.SS3.SSS1.p1.10.m10.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.10.m10.1b"><ci id="S3.SS3.SSS1.p1.10.m10.1.1.cmml" xref="S3.SS3.SSS1.p1.10.m10.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.10.m10.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.10.m10.1d">caligraphic_G</annotation></semantics></math> is an action function that calculates each action score for each available demonstration sample. <math alttext="[\cdot\|\cdot]" class="ltx_math_unparsed" display="inline" id="S3.SS3.SSS1.p1.11.m11.1"><semantics id="S3.SS3.SSS1.p1.11.m11.1a"><mrow id="S3.SS3.SSS1.p1.11.m11.1b"><mo id="S3.SS3.SSS1.p1.11.m11.1.1" stretchy="false">[</mo><mo id="S3.SS3.SSS1.p1.11.m11.1.2" lspace="0em" rspace="0em">⋅</mo><mo id="S3.SS3.SSS1.p1.11.m11.1.3" lspace="0em" rspace="0em">∥</mo><mo id="S3.SS3.SSS1.p1.11.m11.1.4" lspace="0em" rspace="0em">⋅</mo><mo id="S3.SS3.SSS1.p1.11.m11.1.5" stretchy="false">]</mo></mrow><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.11.m11.1c">[\cdot\|\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.11.m11.1d">[ ⋅ ∥ ⋅ ]</annotation></semantics></math> is the concatenation operation, and <math alttext="e_{\mathcal{E}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.12.m12.1"><semantics id="S3.SS3.SSS1.p1.12.m12.1a"><msub id="S3.SS3.SSS1.p1.12.m12.1.1" xref="S3.SS3.SSS1.p1.12.m12.1.1.cmml"><mi id="S3.SS3.SSS1.p1.12.m12.1.1.2" xref="S3.SS3.SSS1.p1.12.m12.1.1.2.cmml">e</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.12.m12.1.1.3" xref="S3.SS3.SSS1.p1.12.m12.1.1.3.cmml">ℰ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.12.m12.1b"><apply id="S3.SS3.SSS1.p1.12.m12.1.1.cmml" xref="S3.SS3.SSS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.12.m12.1.1.1.cmml" xref="S3.SS3.SSS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.12.m12.1.1.2.cmml" xref="S3.SS3.SSS1.p1.12.m12.1.1.2">𝑒</ci><ci id="S3.SS3.SSS1.p1.12.m12.1.1.3.cmml" xref="S3.SS3.SSS1.p1.12.m12.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.12.m12.1c">e_{\mathcal{E}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.12.m12.1d">italic_e start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT</annotation></semantics></math> is the early stop option. Following the prior work’s setting <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib19" title="">19</a>]</cite>, we choose to use the long short-term memory (LSTM) model <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib24" title="">24</a>]</cite> as <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.13.m13.1"><semantics id="S3.SS3.SSS1.p1.13.m13.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.13.m13.1.1" xref="S3.SS3.SSS1.p1.13.m13.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.13.m13.1b"><ci id="S3.SS3.SSS1.p1.13.m13.1.1.cmml" xref="S3.SS3.SSS1.p1.13.m13.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.13.m13.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.13.m13.1d">caligraphic_F</annotation></semantics></math> and a bilinear transformation as <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.14.m14.1"><semantics id="S3.SS3.SSS1.p1.14.m14.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.14.m14.1.1" xref="S3.SS3.SSS1.p1.14.m14.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.14.m14.1b"><ci id="S3.SS3.SSS1.p1.14.m14.1.1.cmml" xref="S3.SS3.SSS1.p1.14.m14.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.14.m14.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.14.m14.1d">caligraphic_G</annotation></semantics></math>. Overall, the policy execution process is shown as the right part of Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.F2" title="Figure 2 ‣ 3.3 Flexible Sequential Demonstration Retriever (FlexSDR) ‣ 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">2</span></a>, where the input <math alttext="(k,q)" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.15.m15.2"><semantics id="S3.SS3.SSS1.p1.15.m15.2a"><mrow id="S3.SS3.SSS1.p1.15.m15.2.3.2" xref="S3.SS3.SSS1.p1.15.m15.2.3.1.cmml"><mo id="S3.SS3.SSS1.p1.15.m15.2.3.2.1" stretchy="false" xref="S3.SS3.SSS1.p1.15.m15.2.3.1.cmml">(</mo><mi id="S3.SS3.SSS1.p1.15.m15.1.1" xref="S3.SS3.SSS1.p1.15.m15.1.1.cmml">k</mi><mo id="S3.SS3.SSS1.p1.15.m15.2.3.2.2" xref="S3.SS3.SSS1.p1.15.m15.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.p1.15.m15.2.2" xref="S3.SS3.SSS1.p1.15.m15.2.2.cmml">q</mi><mo id="S3.SS3.SSS1.p1.15.m15.2.3.2.3" stretchy="false" xref="S3.SS3.SSS1.p1.15.m15.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.15.m15.2b"><interval closure="open" id="S3.SS3.SSS1.p1.15.m15.2.3.1.cmml" xref="S3.SS3.SSS1.p1.15.m15.2.3.2"><ci id="S3.SS3.SSS1.p1.15.m15.1.1.cmml" xref="S3.SS3.SSS1.p1.15.m15.1.1">𝑘</ci><ci id="S3.SS3.SSS1.p1.15.m15.2.2.cmml" xref="S3.SS3.SSS1.p1.15.m15.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.15.m15.2c">(k,q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.15.m15.2d">( italic_k , italic_q )</annotation></semantics></math> pair is first encoded and used as the initial inputs for <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.16.m16.1"><semantics id="S3.SS3.SSS1.p1.16.m16.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.16.m16.1.1" xref="S3.SS3.SSS1.p1.16.m16.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.16.m16.1b"><ci id="S3.SS3.SSS1.p1.16.m16.1.1.cmml" xref="S3.SS3.SSS1.p1.16.m16.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.16.m16.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.16.m16.1d">caligraphic_F</annotation></semantics></math>. Then, the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.17.m17.1"><semantics id="S3.SS3.SSS1.p1.17.m17.1a"><mi id="S3.SS3.SSS1.p1.17.m17.1.1" xref="S3.SS3.SSS1.p1.17.m17.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.17.m17.1b"><ci id="S3.SS3.SSS1.p1.17.m17.1.1.cmml" xref="S3.SS3.SSS1.p1.17.m17.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.17.m17.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.17.m17.1d">italic_t</annotation></semantics></math>th-step hidden state output <math alttext="h_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.18.m18.1"><semantics id="S3.SS3.SSS1.p1.18.m18.1a"><msub id="S3.SS3.SSS1.p1.18.m18.1.1" xref="S3.SS3.SSS1.p1.18.m18.1.1.cmml"><mi id="S3.SS3.SSS1.p1.18.m18.1.1.2" xref="S3.SS3.SSS1.p1.18.m18.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS1.p1.18.m18.1.1.3" xref="S3.SS3.SSS1.p1.18.m18.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.18.m18.1b"><apply id="S3.SS3.SSS1.p1.18.m18.1.1.cmml" xref="S3.SS3.SSS1.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.18.m18.1.1.1.cmml" xref="S3.SS3.SSS1.p1.18.m18.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.18.m18.1.1.2.cmml" xref="S3.SS3.SSS1.p1.18.m18.1.1.2">ℎ</ci><ci id="S3.SS3.SSS1.p1.18.m18.1.1.3.cmml" xref="S3.SS3.SSS1.p1.18.m18.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.18.m18.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.18.m18.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is used by <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.19.m19.1"><semantics id="S3.SS3.SSS1.p1.19.m19.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.19.m19.1.1" xref="S3.SS3.SSS1.p1.19.m19.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.19.m19.1b"><ci id="S3.SS3.SSS1.p1.19.m19.1.1.cmml" xref="S3.SS3.SSS1.p1.19.m19.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.19.m19.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.19.m19.1d">caligraphic_G</annotation></semantics></math> to calculate the selection score for each available demonstration and the early stop option. After that, the action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.20.m20.1"><semantics id="S3.SS3.SSS1.p1.20.m20.1a"><msub id="S3.SS3.SSS1.p1.20.m20.1.1" xref="S3.SS3.SSS1.p1.20.m20.1.1.cmml"><mi id="S3.SS3.SSS1.p1.20.m20.1.1.2" xref="S3.SS3.SSS1.p1.20.m20.1.1.2.cmml">a</mi><mi id="S3.SS3.SSS1.p1.20.m20.1.1.3" xref="S3.SS3.SSS1.p1.20.m20.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.20.m20.1b"><apply id="S3.SS3.SSS1.p1.20.m20.1.1.cmml" xref="S3.SS3.SSS1.p1.20.m20.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.20.m20.1.1.1.cmml" xref="S3.SS3.SSS1.p1.20.m20.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.20.m20.1.1.2.cmml" xref="S3.SS3.SSS1.p1.20.m20.1.1.2">𝑎</ci><ci id="S3.SS3.SSS1.p1.20.m20.1.1.3.cmml" xref="S3.SS3.SSS1.p1.20.m20.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.20.m20.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.20.m20.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> will be selected based on the scores. If the demonstration is selected, it will be appended to the prompt and interact with LLMs to calculate the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.21.m21.1"><semantics id="S3.SS3.SSS1.p1.21.m21.1a"><mi id="S3.SS3.SSS1.p1.21.m21.1.1" xref="S3.SS3.SSS1.p1.21.m21.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.21.m21.1b"><ci id="S3.SS3.SSS1.p1.21.m21.1.1.cmml" xref="S3.SS3.SSS1.p1.21.m21.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.21.m21.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.21.m21.1d">italic_t</annotation></semantics></math>-th step reward score. The process ends whenever the early stop option is hit or reaches the max-allowed length. Formally, the procedure can be defined as follows:
</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle x_{e}=\mathcal{E}(e),\ \ x_{k}=\mathcal{E}(k),\ \ x_{q}=\mathcal%
{E}(q),X_{E_{\mathcal{D}}}=\mathcal{E}(E_{\mathcal{D}})" class="ltx_Math" display="inline" id="S3.E1.m1.5"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.2" xref="S3.E1.m1.5.5.3.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.4.4.1.1.2.3" xref="S3.E1.m1.4.4.1.1.2.3.cmml">e</mi></msub><mo id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml">ℰ</mi><mo id="S3.E1.m1.4.4.1.1.3.1" xref="S3.E1.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.3.cmml"><mo id="S3.E1.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.4.4.1.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">e</mi><mo id="S3.E1.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S3.E1.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.2.3" rspace="1.167em" xref="S3.E1.m1.5.5.3a.cmml">,</mo><mrow id="S3.E1.m1.5.5.2.2.2" xref="S3.E1.m1.5.5.2.2.3.cmml"><mrow id="S3.E1.m1.5.5.2.2.1.1" xref="S3.E1.m1.5.5.2.2.1.1.cmml"><msub id="S3.E1.m1.5.5.2.2.1.1.2" xref="S3.E1.m1.5.5.2.2.1.1.2.cmml"><mi id="S3.E1.m1.5.5.2.2.1.1.2.2" xref="S3.E1.m1.5.5.2.2.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.5.5.2.2.1.1.2.3" xref="S3.E1.m1.5.5.2.2.1.1.2.3.cmml">k</mi></msub><mo id="S3.E1.m1.5.5.2.2.1.1.1" xref="S3.E1.m1.5.5.2.2.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.2.2.1.1.3" xref="S3.E1.m1.5.5.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.2.2.1.1.3.2" xref="S3.E1.m1.5.5.2.2.1.1.3.2.cmml">ℰ</mi><mo id="S3.E1.m1.5.5.2.2.1.1.3.1" xref="S3.E1.m1.5.5.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.2.2.1.1.3.3.2" xref="S3.E1.m1.5.5.2.2.1.1.3.cmml"><mo id="S3.E1.m1.5.5.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.2.2.1.1.3.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">k</mi><mo id="S3.E1.m1.5.5.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E1.m1.5.5.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.2.2.2.3" rspace="1.167em" xref="S3.E1.m1.5.5.2.2.3a.cmml">,</mo><mrow id="S3.E1.m1.5.5.2.2.2.2.2" xref="S3.E1.m1.5.5.2.2.2.2.3.cmml"><mrow id="S3.E1.m1.5.5.2.2.2.2.1.1" xref="S3.E1.m1.5.5.2.2.2.2.1.1.cmml"><msub id="S3.E1.m1.5.5.2.2.2.2.1.1.2" xref="S3.E1.m1.5.5.2.2.2.2.1.1.2.cmml"><mi id="S3.E1.m1.5.5.2.2.2.2.1.1.2.2" xref="S3.E1.m1.5.5.2.2.2.2.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.5.5.2.2.2.2.1.1.2.3" xref="S3.E1.m1.5.5.2.2.2.2.1.1.2.3.cmml">q</mi></msub><mo id="S3.E1.m1.5.5.2.2.2.2.1.1.1" xref="S3.E1.m1.5.5.2.2.2.2.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.2.2.2.2.1.1.3" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.2.2.2.2.1.1.3.2" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3.2.cmml">ℰ</mi><mo id="S3.E1.m1.5.5.2.2.2.2.1.1.3.1" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.2.2.2.2.1.1.3.3.2" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3.cmml"><mo id="S3.E1.m1.5.5.2.2.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">q</mi><mo id="S3.E1.m1.5.5.2.2.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.2.2.2.2.2.3" xref="S3.E1.m1.5.5.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E1.m1.5.5.2.2.2.2.2.2" xref="S3.E1.m1.5.5.2.2.2.2.2.2.cmml"><msub id="S3.E1.m1.5.5.2.2.2.2.2.2.3" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.5.5.2.2.2.2.2.2.3.2" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.2.cmml">X</mi><msub id="S3.E1.m1.5.5.2.2.2.2.2.2.3.3" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.cmml"><mi id="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.2" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.3" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.3.cmml">𝒟</mi></msub></msub><mo id="S3.E1.m1.5.5.2.2.2.2.2.2.2" xref="S3.E1.m1.5.5.2.2.2.2.2.2.2.cmml">=</mo><mrow id="S3.E1.m1.5.5.2.2.2.2.2.2.1" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.2.2.2.2.2.2.1.3" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.3.cmml">ℰ</mi><mo id="S3.E1.m1.5.5.2.2.2.2.2.2.1.2" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.2" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.3" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.3.cmml">𝒟</mi></msub><mo id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3a.cmml" xref="S3.E1.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1"><eq id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"></eq><apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.4.4.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.3">𝑒</ci></apply><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><times id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1"></times><ci id="S3.E1.m1.4.4.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2">ℰ</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑒</ci></apply></apply><apply id="S3.E1.m1.5.5.2.2.3.cmml" xref="S3.E1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.3a.cmml" xref="S3.E1.m1.5.5.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.5.5.2.2.1.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1"><eq id="S3.E1.m1.5.5.2.2.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1"></eq><apply id="S3.E1.m1.5.5.2.2.1.1.2.cmml" xref="S3.E1.m1.5.5.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.1.1.2.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.1.1.2.2.cmml" xref="S3.E1.m1.5.5.2.2.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.5.5.2.2.1.1.2.3.cmml" xref="S3.E1.m1.5.5.2.2.1.1.2.3">𝑘</ci></apply><apply id="S3.E1.m1.5.5.2.2.1.1.3.cmml" xref="S3.E1.m1.5.5.2.2.1.1.3"><times id="S3.E1.m1.5.5.2.2.1.1.3.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1.3.1"></times><ci id="S3.E1.m1.5.5.2.2.1.1.3.2.cmml" xref="S3.E1.m1.5.5.2.2.1.1.3.2">ℰ</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑘</ci></apply></apply><apply id="S3.E1.m1.5.5.2.2.2.2.3.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.2.2.3a.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.5.5.2.2.2.2.1.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1"><eq id="S3.E1.m1.5.5.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1.1"></eq><apply id="S3.E1.m1.5.5.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.2.2.1.1.2.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.5.5.2.2.2.2.1.1.2.3.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1.2.3">𝑞</ci></apply><apply id="S3.E1.m1.5.5.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3"><times id="S3.E1.m1.5.5.2.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3.1"></times><ci id="S3.E1.m1.5.5.2.2.2.2.1.1.3.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.1.1.3.2">ℰ</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑞</ci></apply></apply><apply id="S3.E1.m1.5.5.2.2.2.2.2.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2"><eq id="S3.E1.m1.5.5.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.2"></eq><apply id="S3.E1.m1.5.5.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.2.2.2.2.3.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.2">𝑋</ci><apply id="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.2">𝐸</ci><ci id="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.3.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.3.3.3">𝒟</ci></apply></apply><apply id="S3.E1.m1.5.5.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1"><times id="S3.E1.m1.5.5.2.2.2.2.2.2.1.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.2"></times><ci id="S3.E1.m1.5.5.2.2.2.2.2.2.1.3.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.3">ℰ</ci><apply id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.2">𝐸</ci><ci id="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.2.2.2.2.2.2.1.1.1.1.3">𝒟</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\displaystyle x_{e}=\mathcal{E}(e),\ \ x_{k}=\mathcal{E}(k),\ \ x_{q}=\mathcal%
{E}(q),X_{E_{\mathcal{D}}}=\mathcal{E}(E_{\mathcal{D}})</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.5d">italic_x start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT = caligraphic_E ( italic_e ) , italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = caligraphic_E ( italic_k ) , italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = caligraphic_E ( italic_q ) , italic_X start_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT end_POSTSUBSCRIPT = caligraphic_E ( italic_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle h_{t}=\mathcal{F}(s_{t})=\mathrm{LSTM}(h_{0};x_{e_{1}},...,x_{e_%
{t-1}}),\ \ h_{0}=\mathrm{tanh}(W_{0}[x_{k}\|x_{q}]+b_{0})" class="ltx_Math" display="inline" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.3.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.6" xref="S3.E2.m1.2.2.1.1.6.cmml"><mi id="S3.E2.m1.2.2.1.1.6.2" xref="S3.E2.m1.2.2.1.1.6.2.cmml">h</mi><mi id="S3.E2.m1.2.2.1.1.6.3" xref="S3.E2.m1.2.2.1.1.6.3.cmml">t</mi></msub><mo id="S3.E2.m1.2.2.1.1.7" xref="S3.E2.m1.2.2.1.1.7.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml">ℱ</mi><mo id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.8" xref="S3.E2.m1.2.2.1.1.8.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.4" xref="S3.E2.m1.2.2.1.1.4.cmml"><mi id="S3.E2.m1.2.2.1.1.4.5" xref="S3.E2.m1.2.2.1.1.4.5.cmml">LSTM</mi><mo id="S3.E2.m1.2.2.1.1.4.4" xref="S3.E2.m1.2.2.1.1.4.4.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.1.1.4.3.3" xref="S3.E2.m1.2.2.1.1.4.3.4.cmml"><mo id="S3.E2.m1.2.2.1.1.4.3.3.4" stretchy="false" xref="S3.E2.m1.2.2.1.1.4.3.4.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.2.1.1.1" xref="S3.E2.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.2.1.1.1.2.cmml">h</mi><mn id="S3.E2.m1.2.2.1.1.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.E2.m1.2.2.1.1.4.3.3.5" xref="S3.E2.m1.2.2.1.1.4.3.4.cmml">;</mo><msub id="S3.E2.m1.2.2.1.1.3.2.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.2.2.cmml">x</mi><msub id="S3.E2.m1.2.2.1.1.3.2.2.2.3" xref="S3.E2.m1.2.2.1.1.3.2.2.2.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2.2.3.2" xref="S3.E2.m1.2.2.1.1.3.2.2.2.3.2.cmml">e</mi><mn id="S3.E2.m1.2.2.1.1.3.2.2.2.3.3" xref="S3.E2.m1.2.2.1.1.3.2.2.2.3.3.cmml">1</mn></msub></msub><mo id="S3.E2.m1.2.2.1.1.4.3.3.6" xref="S3.E2.m1.2.2.1.1.4.3.4.cmml">,</mo><mi id="S3.E2.m1.1.1" mathvariant="normal" xref="S3.E2.m1.1.1.cmml">…</mi><mo id="S3.E2.m1.2.2.1.1.4.3.3.7" xref="S3.E2.m1.2.2.1.1.4.3.4.cmml">,</mo><msub id="S3.E2.m1.2.2.1.1.4.3.3.3" xref="S3.E2.m1.2.2.1.1.4.3.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.4.3.3.3.2" xref="S3.E2.m1.2.2.1.1.4.3.3.3.2.cmml">x</mi><msub id="S3.E2.m1.2.2.1.1.4.3.3.3.3" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.4.3.3.3.3.2" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.2.cmml">e</mi><mrow id="S3.E2.m1.2.2.1.1.4.3.3.3.3.3" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.2" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.2.cmml">t</mi><mo id="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.1" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.1.cmml">−</mo><mn id="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.3" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="S3.E2.m1.2.2.1.1.4.3.3.8" stretchy="false" xref="S3.E2.m1.2.2.1.1.4.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.2.3" rspace="1.167em" xref="S3.E2.m1.3.3.3a.cmml">,</mo><mrow id="S3.E2.m1.3.3.2.2" xref="S3.E2.m1.3.3.2.2.cmml"><msub id="S3.E2.m1.3.3.2.2.3" xref="S3.E2.m1.3.3.2.2.3.cmml"><mi id="S3.E2.m1.3.3.2.2.3.2" xref="S3.E2.m1.3.3.2.2.3.2.cmml">h</mi><mn id="S3.E2.m1.3.3.2.2.3.3" xref="S3.E2.m1.3.3.2.2.3.3.cmml">0</mn></msub><mo id="S3.E2.m1.3.3.2.2.2" xref="S3.E2.m1.3.3.2.2.2.cmml">=</mo><mrow id="S3.E2.m1.3.3.2.2.1" xref="S3.E2.m1.3.3.2.2.1.cmml"><mi id="S3.E2.m1.3.3.2.2.1.3" xref="S3.E2.m1.3.3.2.2.1.3.cmml">tanh</mi><mo id="S3.E2.m1.3.3.2.2.1.2" xref="S3.E2.m1.3.3.2.2.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.2.2.1.1.1" xref="S3.E2.m1.3.3.2.2.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.2.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.3.3.2.2.1.1.1.1" xref="S3.E2.m1.3.3.2.2.1.1.1.1.cmml"><mrow id="S3.E2.m1.3.3.2.2.1.1.1.1.1" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.cmml"><msub id="S3.E2.m1.3.3.2.2.1.1.1.1.1.3" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.2.cmml">W</mi><mn id="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="S3.E2.m1.3.3.2.2.1.1.1.1.1.2" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.3.3.2.2.1.1.1.1.2" xref="S3.E2.m1.3.3.2.2.1.1.1.1.2.cmml">+</mo><msub id="S3.E2.m1.3.3.2.2.1.1.1.1.3" xref="S3.E2.m1.3.3.2.2.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.2.2.1.1.1.1.3.2" xref="S3.E2.m1.3.3.2.2.1.1.1.1.3.2.cmml">b</mi><mn id="S3.E2.m1.3.3.2.2.1.1.1.1.3.3" xref="S3.E2.m1.3.3.2.2.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E2.m1.3.3.2.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3a.cmml" xref="S3.E2.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1"><and id="S3.E2.m1.2.2.1.1a.cmml" xref="S3.E2.m1.2.2.1.1"></and><apply id="S3.E2.m1.2.2.1.1b.cmml" xref="S3.E2.m1.2.2.1.1"><eq id="S3.E2.m1.2.2.1.1.7.cmml" xref="S3.E2.m1.2.2.1.1.7"></eq><apply id="S3.E2.m1.2.2.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.6.1.cmml" xref="S3.E2.m1.2.2.1.1.6">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.6.2.cmml" xref="S3.E2.m1.2.2.1.1.6.2">ℎ</ci><ci id="S3.E2.m1.2.2.1.1.6.3.cmml" xref="S3.E2.m1.2.2.1.1.6.3">𝑡</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"></times><ci id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3">ℱ</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1c.cmml" xref="S3.E2.m1.2.2.1.1"><eq id="S3.E2.m1.2.2.1.1.8.cmml" xref="S3.E2.m1.2.2.1.1.8"></eq><share href="https://arxiv.org/html/2406.13885v1#S3.E2.m1.2.2.1.1.1.cmml" id="S3.E2.m1.2.2.1.1d.cmml" xref="S3.E2.m1.2.2.1.1"></share><apply id="S3.E2.m1.2.2.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.4"><times id="S3.E2.m1.2.2.1.1.4.4.cmml" xref="S3.E2.m1.2.2.1.1.4.4"></times><ci id="S3.E2.m1.2.2.1.1.4.5.cmml" xref="S3.E2.m1.2.2.1.1.4.5">LSTM</ci><list id="S3.E2.m1.2.2.1.1.4.3.4.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3"><apply id="S3.E2.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2.1.1.1.2">ℎ</ci><cn id="S3.E2.m1.2.2.1.1.2.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.2.1.1.1.3">0</cn></apply><apply id="S3.E2.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2.2">𝑥</ci><apply id="S3.E2.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2.3.2">𝑒</ci><cn id="S3.E2.m1.2.2.1.1.3.2.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.3.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">…</ci><apply id="S3.E2.m1.2.2.1.1.4.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.3.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.3.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3.2">𝑥</ci><apply id="S3.E2.m1.2.2.1.1.4.3.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.3.3.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.3.3.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.2">𝑒</ci><apply id="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.3"><minus id="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.1"></minus><ci id="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.2">𝑡</ci><cn id="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.4.3.3.3.3.3.3">1</cn></apply></apply></apply></list></apply></apply></apply><apply id="S3.E2.m1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.2.2"><eq id="S3.E2.m1.3.3.2.2.2.cmml" xref="S3.E2.m1.3.3.2.2.2"></eq><apply id="S3.E2.m1.3.3.2.2.3.cmml" xref="S3.E2.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.3.1.cmml" xref="S3.E2.m1.3.3.2.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.2.2.3.2.cmml" xref="S3.E2.m1.3.3.2.2.3.2">ℎ</ci><cn id="S3.E2.m1.3.3.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.3.3.2.2.3.3">0</cn></apply><apply id="S3.E2.m1.3.3.2.2.1.cmml" xref="S3.E2.m1.3.3.2.2.1"><times id="S3.E2.m1.3.3.2.2.1.2.cmml" xref="S3.E2.m1.3.3.2.2.1.2"></times><ci id="S3.E2.m1.3.3.2.2.1.3.cmml" xref="S3.E2.m1.3.3.2.2.1.3">tanh</ci><apply id="S3.E2.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1"><plus id="S3.E2.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.2"></plus><apply id="S3.E2.m1.3.3.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1"><times id="S3.E2.m1.3.3.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.2"></times><apply id="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.2">𝑊</ci><cn id="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.3.3">0</cn></apply><apply id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply><apply id="S3.E2.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.3.3.2.2.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.2.2.1.1.1.1.3.2">𝑏</ci><cn id="S3.E2.m1.3.3.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.3.3.2.2.1.1.1.1.3.3">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\displaystyle h_{t}=\mathcal{F}(s_{t})=\mathrm{LSTM}(h_{0};x_{e_{1}},...,x_{e_%
{t-1}}),\ \ h_{0}=\mathrm{tanh}(W_{0}[x_{k}\|x_{q}]+b_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = roman_LSTM ( italic_h start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ; italic_x start_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) , italic_h start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = roman_tanh ( italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT [ italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] + italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\pi_{\theta}(a|s_{t})=\mathrm{Softmax}(\mathcal{G}(\cdot)),\ \ %
\mathcal{G}(h_{t},[X_{E_{\mathcal{D}}}\|x_{x_{\mathcal{E}}}])=h_{t}W_{a}[X_{E_%
{\mathcal{D}}}\|x_{x_{\mathcal{E}}}]^{T}" class="ltx_Math" display="inline" id="S3.E3.m1.3"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.2" xref="S3.E3.m1.3.3.3.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.3.2.cmml">π</mi><mi id="S3.E3.m1.2.2.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.3" xref="S3.E3.m1.2.2.1.1.2.3.cmml">Softmax</mi><mo id="S3.E3.m1.2.2.1.1.2.2" xref="S3.E3.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.2.1.1" xref="S3.E3.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.2.1.1.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.2.1.1.1" xref="S3.E3.m1.2.2.1.1.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.1.1.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.2.1.1.1.2.cmml">𝒢</mi><mo id="S3.E3.m1.2.2.1.1.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.2.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.2.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mo id="S3.E3.m1.1.1" lspace="0em" rspace="0em" xref="S3.E3.m1.1.1.cmml">⋅</mo><mo id="S3.E3.m1.2.2.1.1.2.1.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.2.1.1.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.3.3.2.3" rspace="1.167em" xref="S3.E3.m1.3.3.3a.cmml">,</mo><mrow id="S3.E3.m1.3.3.2.2" xref="S3.E3.m1.3.3.2.2.cmml"><mrow id="S3.E3.m1.3.3.2.2.2" xref="S3.E3.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.2.2.2.4" xref="S3.E3.m1.3.3.2.2.2.4.cmml">𝒢</mi><mo id="S3.E3.m1.3.3.2.2.2.3" xref="S3.E3.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.2.2.2.2.2" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml"><mo id="S3.E3.m1.3.3.2.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml">(</mo><msub id="S3.E3.m1.3.3.2.2.1.1.1.1" xref="S3.E3.m1.3.3.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.2.2.1.1.1.1.2" xref="S3.E3.m1.3.3.2.2.1.1.1.1.2.cmml">h</mi><mi id="S3.E3.m1.3.3.2.2.1.1.1.1.3" xref="S3.E3.m1.3.3.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E3.m1.3.3.2.2.2.2.2.4" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.3.3.2.2.2.2.2.2.1" xref="S3.E3.m1.3.3.2.2.2.2.2.2.2.cmml"><mo id="S3.E3.m1.3.3.2.2.2.2.2.2.1.2" stretchy="false" xref="S3.E3.m1.3.3.2.2.2.2.2.2.2.1.cmml">[</mo><mrow id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.cmml"><msub id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.2.cmml">X</mi><msub id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.3" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.3.cmml">𝒟</mi></msub></msub><mo id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.1" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.1.cmml">∥</mo><msub id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.2.cmml">x</mi><msub id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.2.cmml">x</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.3" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.3.cmml">ℰ</mi></msub></msub></mrow><mo id="S3.E3.m1.3.3.2.2.2.2.2.2.1.3" stretchy="false" xref="S3.E3.m1.3.3.2.2.2.2.2.2.2.1.cmml">]</mo></mrow><mo id="S3.E3.m1.3.3.2.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.2.2.4" xref="S3.E3.m1.3.3.2.2.4.cmml">=</mo><mrow id="S3.E3.m1.3.3.2.2.3" xref="S3.E3.m1.3.3.2.2.3.cmml"><msub id="S3.E3.m1.3.3.2.2.3.3" xref="S3.E3.m1.3.3.2.2.3.3.cmml"><mi id="S3.E3.m1.3.3.2.2.3.3.2" xref="S3.E3.m1.3.3.2.2.3.3.2.cmml">h</mi><mi id="S3.E3.m1.3.3.2.2.3.3.3" xref="S3.E3.m1.3.3.2.2.3.3.3.cmml">t</mi></msub><mo id="S3.E3.m1.3.3.2.2.3.2" xref="S3.E3.m1.3.3.2.2.3.2.cmml">⁢</mo><msub id="S3.E3.m1.3.3.2.2.3.4" xref="S3.E3.m1.3.3.2.2.3.4.cmml"><mi id="S3.E3.m1.3.3.2.2.3.4.2" xref="S3.E3.m1.3.3.2.2.3.4.2.cmml">W</mi><mi id="S3.E3.m1.3.3.2.2.3.4.3" xref="S3.E3.m1.3.3.2.2.3.4.3.cmml">a</mi></msub><mo id="S3.E3.m1.3.3.2.2.3.2a" xref="S3.E3.m1.3.3.2.2.3.2.cmml">⁢</mo><msup id="S3.E3.m1.3.3.2.2.3.1" xref="S3.E3.m1.3.3.2.2.3.1.cmml"><mrow id="S3.E3.m1.3.3.2.2.3.1.1.1" xref="S3.E3.m1.3.3.2.2.3.1.1.2.cmml"><mo id="S3.E3.m1.3.3.2.2.3.1.1.1.2" stretchy="false" xref="S3.E3.m1.3.3.2.2.3.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.3.3.2.2.3.1.1.1.1" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.cmml"><msub id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.cmml"><mi id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.2" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.2.cmml">X</mi><msub id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.2" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.3" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.3.cmml">𝒟</mi></msub></msub><mo id="S3.E3.m1.3.3.2.2.3.1.1.1.1.1" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.1.cmml">∥</mo><msub id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.2" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.2.cmml">x</mi><msub id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.2" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.2.cmml">x</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.3" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.3.cmml">ℰ</mi></msub></msub></mrow><mo id="S3.E3.m1.3.3.2.2.3.1.1.1.3" stretchy="false" xref="S3.E3.m1.3.3.2.2.3.1.1.2.1.cmml">]</mo></mrow><mi id="S3.E3.m1.3.3.2.2.3.1.3" xref="S3.E3.m1.3.3.2.2.3.1.3.cmml">T</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3a.cmml" xref="S3.E3.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1"><eq id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"></eq><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"></times><apply id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.3.2">𝜋</ci><ci id="S3.E3.m1.2.2.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2">𝑎</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"><times id="S3.E3.m1.2.2.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2"></times><ci id="S3.E3.m1.2.2.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.3">Softmax</ci><apply id="S3.E3.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.2.1.1"><times id="S3.E3.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.2.1.1.1.1"></times><ci id="S3.E3.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2.1.1.1.2">𝒢</ci><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">⋅</ci></apply></apply></apply><apply id="S3.E3.m1.3.3.2.2.cmml" xref="S3.E3.m1.3.3.2.2"><eq id="S3.E3.m1.3.3.2.2.4.cmml" xref="S3.E3.m1.3.3.2.2.4"></eq><apply id="S3.E3.m1.3.3.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2"><times id="S3.E3.m1.3.3.2.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.3"></times><ci id="S3.E3.m1.3.3.2.2.2.4.cmml" xref="S3.E3.m1.3.3.2.2.2.4">𝒢</ci><interval closure="open" id="S3.E3.m1.3.3.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2"><apply id="S3.E3.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E3.m1.3.3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.2.2.1.1.1.1.2">ℎ</ci><ci id="S3.E3.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.1">conditional</csymbol><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.2">𝑋</ci><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.2">𝐸</ci><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.2.3.3">𝒟</ci></apply></apply><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.2">𝑥</ci><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.2">𝑥</ci><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.1.1.3.3.3">ℰ</ci></apply></apply></apply></apply></interval></apply><apply id="S3.E3.m1.3.3.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.3"><times id="S3.E3.m1.3.3.2.2.3.2.cmml" xref="S3.E3.m1.3.3.2.2.3.2"></times><apply id="S3.E3.m1.3.3.2.2.3.3.cmml" xref="S3.E3.m1.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.3.3.1.cmml" xref="S3.E3.m1.3.3.2.2.3.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.3.3.2.cmml" xref="S3.E3.m1.3.3.2.2.3.3.2">ℎ</ci><ci id="S3.E3.m1.3.3.2.2.3.3.3.cmml" xref="S3.E3.m1.3.3.2.2.3.3.3">𝑡</ci></apply><apply id="S3.E3.m1.3.3.2.2.3.4.cmml" xref="S3.E3.m1.3.3.2.2.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.3.4.1.cmml" xref="S3.E3.m1.3.3.2.2.3.4">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.3.4.2.cmml" xref="S3.E3.m1.3.3.2.2.3.4.2">𝑊</ci><ci id="S3.E3.m1.3.3.2.2.3.4.3.cmml" xref="S3.E3.m1.3.3.2.2.3.4.3">𝑎</ci></apply><apply id="S3.E3.m1.3.3.2.2.3.1.cmml" xref="S3.E3.m1.3.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.3.1.2.cmml" xref="S3.E3.m1.3.3.2.2.3.1">superscript</csymbol><apply id="S3.E3.m1.3.3.2.2.3.1.1.2.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.2.2.3.1.1.2.1.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.3.3.2.2.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.2.2.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.2">𝑋</ci><apply id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.2">𝐸</ci><ci id="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.2.3.3">𝒟</ci></apply></apply><apply id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.2">𝑥</ci><apply id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.2">𝑥</ci><ci id="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.3.3.2.2.3.1.1.1.1.3.3.3">ℰ</ci></apply></apply></apply></apply><ci id="S3.E3.m1.3.3.2.2.3.1.3.cmml" xref="S3.E3.m1.3.3.2.2.3.1.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\displaystyle\pi_{\theta}(a|s_{t})=\mathrm{Softmax}(\mathcal{G}(\cdot)),\ \ %
\mathcal{G}(h_{t},[X_{E_{\mathcal{D}}}\|x_{x_{\mathcal{E}}}])=h_{t}W_{a}[X_{E_%
{\mathcal{D}}}\|x_{x_{\mathcal{E}}}]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.3d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = roman_Softmax ( caligraphic_G ( ⋅ ) ) , caligraphic_G ( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , [ italic_X start_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ italic_x start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ) = italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT [ italic_X start_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ italic_x start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p1.26">where <math alttext="x_{e},x_{k},x_{q}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.22.m1.3"><semantics id="S3.SS3.SSS1.p1.22.m1.3a"><mrow id="S3.SS3.SSS1.p1.22.m1.3.3.3" xref="S3.SS3.SSS1.p1.22.m1.3.3.4.cmml"><msub id="S3.SS3.SSS1.p1.22.m1.1.1.1.1" xref="S3.SS3.SSS1.p1.22.m1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.22.m1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.22.m1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS1.p1.22.m1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.22.m1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.SS3.SSS1.p1.22.m1.3.3.3.4" xref="S3.SS3.SSS1.p1.22.m1.3.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p1.22.m1.2.2.2.2" xref="S3.SS3.SSS1.p1.22.m1.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.22.m1.2.2.2.2.2" xref="S3.SS3.SSS1.p1.22.m1.2.2.2.2.2.cmml">x</mi><mi id="S3.SS3.SSS1.p1.22.m1.2.2.2.2.3" xref="S3.SS3.SSS1.p1.22.m1.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS3.SSS1.p1.22.m1.3.3.3.5" xref="S3.SS3.SSS1.p1.22.m1.3.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p1.22.m1.3.3.3.3" xref="S3.SS3.SSS1.p1.22.m1.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.22.m1.3.3.3.3.2" xref="S3.SS3.SSS1.p1.22.m1.3.3.3.3.2.cmml">x</mi><mi id="S3.SS3.SSS1.p1.22.m1.3.3.3.3.3" xref="S3.SS3.SSS1.p1.22.m1.3.3.3.3.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.22.m1.3b"><list id="S3.SS3.SSS1.p1.22.m1.3.3.4.cmml" xref="S3.SS3.SSS1.p1.22.m1.3.3.3"><apply id="S3.SS3.SSS1.p1.22.m1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.22.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.22.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.22.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.22.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.22.m1.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS1.p1.22.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.22.m1.1.1.1.1.3">𝑒</ci></apply><apply id="S3.SS3.SSS1.p1.22.m1.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.22.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.22.m1.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.22.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.22.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.22.m1.2.2.2.2.2">𝑥</ci><ci id="S3.SS3.SSS1.p1.22.m1.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.22.m1.2.2.2.2.3">𝑘</ci></apply><apply id="S3.SS3.SSS1.p1.22.m1.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.22.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.22.m1.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.22.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.22.m1.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.22.m1.3.3.3.3.2">𝑥</ci><ci id="S3.SS3.SSS1.p1.22.m1.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.22.m1.3.3.3.3.3">𝑞</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.22.m1.3c">x_{e},x_{k},x_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.22.m1.3d">italic_x start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> are the encoding results of knowledge text, question text, and demonstration text. <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.23.m2.1"><semantics id="S3.SS3.SSS1.p1.23.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.23.m2.1.1" xref="S3.SS3.SSS1.p1.23.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.23.m2.1b"><ci id="S3.SS3.SSS1.p1.23.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.23.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.23.m2.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.23.m2.1d">caligraphic_E</annotation></semantics></math> is the pre-trained text encoding model. <math alttext="W_{0}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.24.m3.1"><semantics id="S3.SS3.SSS1.p1.24.m3.1a"><msub id="S3.SS3.SSS1.p1.24.m3.1.1" xref="S3.SS3.SSS1.p1.24.m3.1.1.cmml"><mi id="S3.SS3.SSS1.p1.24.m3.1.1.2" xref="S3.SS3.SSS1.p1.24.m3.1.1.2.cmml">W</mi><mn id="S3.SS3.SSS1.p1.24.m3.1.1.3" xref="S3.SS3.SSS1.p1.24.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.24.m3.1b"><apply id="S3.SS3.SSS1.p1.24.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.24.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.24.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p1.24.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.24.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p1.24.m3.1.1.2">𝑊</ci><cn id="S3.SS3.SSS1.p1.24.m3.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.24.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.24.m3.1c">W_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.24.m3.1d">italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="b_{0}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.25.m4.1"><semantics id="S3.SS3.SSS1.p1.25.m4.1a"><msub id="S3.SS3.SSS1.p1.25.m4.1.1" xref="S3.SS3.SSS1.p1.25.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p1.25.m4.1.1.2" xref="S3.SS3.SSS1.p1.25.m4.1.1.2.cmml">b</mi><mn id="S3.SS3.SSS1.p1.25.m4.1.1.3" xref="S3.SS3.SSS1.p1.25.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.25.m4.1b"><apply id="S3.SS3.SSS1.p1.25.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.25.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.25.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p1.25.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.25.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p1.25.m4.1.1.2">𝑏</ci><cn id="S3.SS3.SSS1.p1.25.m4.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.25.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.25.m4.1c">b_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.25.m4.1d">italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> are the parameters of knowledge and question information fusing layer, and <math alttext="W_{a}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.26.m5.1"><semantics id="S3.SS3.SSS1.p1.26.m5.1a"><msub id="S3.SS3.SSS1.p1.26.m5.1.1" xref="S3.SS3.SSS1.p1.26.m5.1.1.cmml"><mi id="S3.SS3.SSS1.p1.26.m5.1.1.2" xref="S3.SS3.SSS1.p1.26.m5.1.1.2.cmml">W</mi><mi id="S3.SS3.SSS1.p1.26.m5.1.1.3" xref="S3.SS3.SSS1.p1.26.m5.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.26.m5.1b"><apply id="S3.SS3.SSS1.p1.26.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.26.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.26.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p1.26.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.26.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p1.26.m5.1.1.2">𝑊</ci><ci id="S3.SS3.SSS1.p1.26.m5.1.1.3.cmml" xref="S3.SS3.SSS1.p1.26.m5.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.26.m5.1c">W_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.26.m5.1d">italic_W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> is the parameter of bilinear transformation.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Learning Rewards</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">To train the policy network <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><msub id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">π</mi><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2">𝜋</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, we use the proximal policy optimization (PPO) method  <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib25" title="">25</a>]</cite>. To be specific, we define the step-wised reward function of FlexSDR as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{t}=\mathrm{EVAL}(\hat{y}_{t},y),\ \ r_{t}\in\{-1,1\}" class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.3.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2" xref="S3.E4.m1.3.3.1.1.3.2.cmml">r</mi><mi id="S3.E4.m1.3.3.1.1.3.3" xref="S3.E4.m1.3.3.1.1.3.3.cmml">t</mi></msub><mo id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.3.cmml">EVAL</mi><mo id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E4.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml">(</mo><msub id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E4.m1.3.3.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">y</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.2.3" rspace="1.167em" xref="S3.E4.m1.4.4.3a.cmml">,</mo><mrow id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml"><msub id="S3.E4.m1.4.4.2.2.3" xref="S3.E4.m1.4.4.2.2.3.cmml"><mi id="S3.E4.m1.4.4.2.2.3.2" xref="S3.E4.m1.4.4.2.2.3.2.cmml">r</mi><mi id="S3.E4.m1.4.4.2.2.3.3" xref="S3.E4.m1.4.4.2.2.3.3.cmml">t</mi></msub><mo id="S3.E4.m1.4.4.2.2.2" xref="S3.E4.m1.4.4.2.2.2.cmml">∈</mo><mrow id="S3.E4.m1.4.4.2.2.1.1" xref="S3.E4.m1.4.4.2.2.1.2.cmml"><mo id="S3.E4.m1.4.4.2.2.1.1.2" stretchy="false" xref="S3.E4.m1.4.4.2.2.1.2.cmml">{</mo><mrow id="S3.E4.m1.4.4.2.2.1.1.1" xref="S3.E4.m1.4.4.2.2.1.1.1.cmml"><mo id="S3.E4.m1.4.4.2.2.1.1.1a" xref="S3.E4.m1.4.4.2.2.1.1.1.cmml">−</mo><mn id="S3.E4.m1.4.4.2.2.1.1.1.2" xref="S3.E4.m1.4.4.2.2.1.1.1.2.cmml">1</mn></mrow><mo id="S3.E4.m1.4.4.2.2.1.1.3" xref="S3.E4.m1.4.4.2.2.1.2.cmml">,</mo><mn id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">1</mn><mo id="S3.E4.m1.4.4.2.2.1.1.4" stretchy="false" xref="S3.E4.m1.4.4.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3a.cmml" xref="S3.E4.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1"><eq id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"></eq><apply id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2">𝑟</ci><ci id="S3.E4.m1.3.3.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3">𝑡</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2"></times><ci id="S3.E4.m1.3.3.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3">EVAL</ci><interval closure="open" id="S3.E4.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2"><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑦</ci></interval></apply></apply><apply id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2"><in id="S3.E4.m1.4.4.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2"></in><apply id="S3.E4.m1.4.4.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.3.1.cmml" xref="S3.E4.m1.4.4.2.2.3">subscript</csymbol><ci id="S3.E4.m1.4.4.2.2.3.2.cmml" xref="S3.E4.m1.4.4.2.2.3.2">𝑟</ci><ci id="S3.E4.m1.4.4.2.2.3.3.cmml" xref="S3.E4.m1.4.4.2.2.3.3">𝑡</ci></apply><set id="S3.E4.m1.4.4.2.2.1.2.cmml" xref="S3.E4.m1.4.4.2.2.1.1"><apply id="S3.E4.m1.4.4.2.2.1.1.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1"><minus id="S3.E4.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1.1"></minus><cn id="S3.E4.m1.4.4.2.2.1.1.1.2.cmml" type="integer" xref="S3.E4.m1.4.4.2.2.1.1.1.2">1</cn></apply><cn id="S3.E4.m1.2.2.cmml" type="integer" xref="S3.E4.m1.2.2">1</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">r_{t}=\mathrm{EVAL}(\hat{y}_{t},y),\ \ r_{t}\in\{-1,1\}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_EVAL ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y ) , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { - 1 , 1 }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p1.15">where <math alttext="\mathrm{EVAL}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m1.1"><semantics id="S3.SS3.SSS2.p1.2.m1.1a"><mi id="S3.SS3.SSS2.p1.2.m1.1.1" xref="S3.SS3.SSS2.p1.2.m1.1.1.cmml">EVAL</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m1.1b"><ci id="S3.SS3.SSS2.p1.2.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m1.1.1">EVAL</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m1.1c">\mathrm{EVAL}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m1.1d">roman_EVAL</annotation></semantics></math> is the evaluation function that compares the judgment response by LLMs <math alttext="\hat{y}=\mathrm{LLM}(k,q,e_{1},...,e_{t})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.3.m2.5"><semantics id="S3.SS3.SSS2.p1.3.m2.5a"><mrow id="S3.SS3.SSS2.p1.3.m2.5.5" xref="S3.SS3.SSS2.p1.3.m2.5.5.cmml"><mover accent="true" id="S3.SS3.SSS2.p1.3.m2.5.5.4" xref="S3.SS3.SSS2.p1.3.m2.5.5.4.cmml"><mi id="S3.SS3.SSS2.p1.3.m2.5.5.4.2" xref="S3.SS3.SSS2.p1.3.m2.5.5.4.2.cmml">y</mi><mo id="S3.SS3.SSS2.p1.3.m2.5.5.4.1" xref="S3.SS3.SSS2.p1.3.m2.5.5.4.1.cmml">^</mo></mover><mo id="S3.SS3.SSS2.p1.3.m2.5.5.3" xref="S3.SS3.SSS2.p1.3.m2.5.5.3.cmml">=</mo><mrow id="S3.SS3.SSS2.p1.3.m2.5.5.2" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.cmml"><mi id="S3.SS3.SSS2.p1.3.m2.5.5.2.4" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.4.cmml">LLM</mi><mo id="S3.SS3.SSS2.p1.3.m2.5.5.2.3" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.3.cmml"><mo id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.3.cmml">(</mo><mi id="S3.SS3.SSS2.p1.3.m2.1.1" xref="S3.SS3.SSS2.p1.3.m2.1.1.cmml">k</mi><mo id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.4" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p1.3.m2.2.2" xref="S3.SS3.SSS2.p1.3.m2.2.2.cmml">q</mi><mo id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.5" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1" xref="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.2" xref="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.2.cmml">e</mi><mn id="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.3" xref="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.6" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS2.p1.3.m2.3.3" mathvariant="normal" xref="S3.SS3.SSS2.p1.3.m2.3.3.cmml">…</mi><mo id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.7" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.2" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.2.cmml">e</mi><mi id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.3" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.8" stretchy="false" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m2.5b"><apply id="S3.SS3.SSS2.p1.3.m2.5.5.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5"><eq id="S3.SS3.SSS2.p1.3.m2.5.5.3.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.3"></eq><apply id="S3.SS3.SSS2.p1.3.m2.5.5.4.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.4"><ci id="S3.SS3.SSS2.p1.3.m2.5.5.4.1.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.4.1">^</ci><ci id="S3.SS3.SSS2.p1.3.m2.5.5.4.2.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.4.2">𝑦</ci></apply><apply id="S3.SS3.SSS2.p1.3.m2.5.5.2.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.2"><times id="S3.SS3.SSS2.p1.3.m2.5.5.2.3.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.3"></times><ci id="S3.SS3.SSS2.p1.3.m2.5.5.2.4.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.4">LLM</ci><vector id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.3.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2"><ci id="S3.SS3.SSS2.p1.3.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m2.1.1">𝑘</ci><ci id="S3.SS3.SSS2.p1.3.m2.2.2.cmml" xref="S3.SS3.SSS2.p1.3.m2.2.2">𝑞</ci><apply id="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.2">𝑒</ci><cn id="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p1.3.m2.4.4.1.1.1.1.3">1</cn></apply><ci id="S3.SS3.SSS2.p1.3.m2.3.3.cmml" xref="S3.SS3.SSS2.p1.3.m2.3.3">…</ci><apply id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.2">𝑒</ci><ci id="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.3.m2.5.5.2.2.2.2.3">𝑡</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m2.5c">\hat{y}=\mathrm{LLM}(k,q,e_{1},...,e_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.3.m2.5d">over^ start_ARG italic_y end_ARG = roman_LLM ( italic_k , italic_q , italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_e start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> with the expertise judgment <math alttext="y" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.4.m3.1"><semantics id="S3.SS3.SSS2.p1.4.m3.1a"><mi id="S3.SS3.SSS2.p1.4.m3.1.1" xref="S3.SS3.SSS2.p1.4.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.4.m3.1b"><ci id="S3.SS3.SSS2.p1.4.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.4.m3.1d">italic_y</annotation></semantics></math>. If the two judgments are the same, the reward for timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.5.m4.1"><semantics id="S3.SS3.SSS2.p1.5.m4.1a"><mi id="S3.SS3.SSS2.p1.5.m4.1.1" xref="S3.SS3.SSS2.p1.5.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.5.m4.1b"><ci id="S3.SS3.SSS2.p1.5.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.5.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.5.m4.1d">italic_t</annotation></semantics></math> will be <math alttext="+1" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.6.m5.1"><semantics id="S3.SS3.SSS2.p1.6.m5.1a"><mrow id="S3.SS3.SSS2.p1.6.m5.1.1" xref="S3.SS3.SSS2.p1.6.m5.1.1.cmml"><mo id="S3.SS3.SSS2.p1.6.m5.1.1a" xref="S3.SS3.SSS2.p1.6.m5.1.1.cmml">+</mo><mn id="S3.SS3.SSS2.p1.6.m5.1.1.2" xref="S3.SS3.SSS2.p1.6.m5.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.6.m5.1b"><apply id="S3.SS3.SSS2.p1.6.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1"><plus id="S3.SS3.SSS2.p1.6.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1"></plus><cn id="S3.SS3.SSS2.p1.6.m5.1.1.2.cmml" type="integer" xref="S3.SS3.SSS2.p1.6.m5.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.6.m5.1c">+1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.6.m5.1d">+ 1</annotation></semantics></math>. Otherwise, the reward value will be <math alttext="-1" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.7.m6.1"><semantics id="S3.SS3.SSS2.p1.7.m6.1a"><mrow id="S3.SS3.SSS2.p1.7.m6.1.1" xref="S3.SS3.SSS2.p1.7.m6.1.1.cmml"><mo id="S3.SS3.SSS2.p1.7.m6.1.1a" xref="S3.SS3.SSS2.p1.7.m6.1.1.cmml">−</mo><mn id="S3.SS3.SSS2.p1.7.m6.1.1.2" xref="S3.SS3.SSS2.p1.7.m6.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.7.m6.1b"><apply id="S3.SS3.SSS2.p1.7.m6.1.1.cmml" xref="S3.SS3.SSS2.p1.7.m6.1.1"><minus id="S3.SS3.SSS2.p1.7.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p1.7.m6.1.1"></minus><cn id="S3.SS3.SSS2.p1.7.m6.1.1.2.cmml" type="integer" xref="S3.SS3.SSS2.p1.7.m6.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.7.m6.1c">-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.7.m6.1d">- 1</annotation></semantics></math>. For early-stop actions <math alttext="e_{\mathcal{E}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.8.m7.1"><semantics id="S3.SS3.SSS2.p1.8.m7.1a"><msub id="S3.SS3.SSS2.p1.8.m7.1.1" xref="S3.SS3.SSS2.p1.8.m7.1.1.cmml"><mi id="S3.SS3.SSS2.p1.8.m7.1.1.2" xref="S3.SS3.SSS2.p1.8.m7.1.1.2.cmml">e</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p1.8.m7.1.1.3" xref="S3.SS3.SSS2.p1.8.m7.1.1.3.cmml">ℰ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.8.m7.1b"><apply id="S3.SS3.SSS2.p1.8.m7.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.8.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.8.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p1.8.m7.1.1.2">𝑒</ci><ci id="S3.SS3.SSS2.p1.8.m7.1.1.3.cmml" xref="S3.SS3.SSS2.p1.8.m7.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.8.m7.1c">e_{\mathcal{E}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.8.m7.1d">italic_e start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT</annotation></semantics></math>, we calculate its correctness based on its most recent step. This reward design differs from previous RL-based retriever training algorithms <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib19" title="">19</a>]</cite>, which calculate the reward only at the final timestep <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.9.m8.1"><semantics id="S3.SS3.SSS2.p1.9.m8.1a"><mi id="S3.SS3.SSS2.p1.9.m8.1.1" xref="S3.SS3.SSS2.p1.9.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.9.m8.1b"><ci id="S3.SS3.SSS2.p1.9.m8.1.1.cmml" xref="S3.SS3.SSS2.p1.9.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.9.m8.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.9.m8.1d">italic_T</annotation></semantics></math>. At this point, the size of the retrieved demonstration reaches its maximum allowable limit. For FlexSDR, we calculate rewards <math alttext="r_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.10.m9.1"><semantics id="S3.SS3.SSS2.p1.10.m9.1a"><msub id="S3.SS3.SSS2.p1.10.m9.1.1" xref="S3.SS3.SSS2.p1.10.m9.1.1.cmml"><mi id="S3.SS3.SSS2.p1.10.m9.1.1.2" xref="S3.SS3.SSS2.p1.10.m9.1.1.2.cmml">r</mi><mi id="S3.SS3.SSS2.p1.10.m9.1.1.3" xref="S3.SS3.SSS2.p1.10.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.10.m9.1b"><apply id="S3.SS3.SSS2.p1.10.m9.1.1.cmml" xref="S3.SS3.SSS2.p1.10.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.10.m9.1.1.1.cmml" xref="S3.SS3.SSS2.p1.10.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.10.m9.1.1.2.cmml" xref="S3.SS3.SSS2.p1.10.m9.1.1.2">𝑟</ci><ci id="S3.SS3.SSS2.p1.10.m9.1.1.3.cmml" xref="S3.SS3.SSS2.p1.10.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.10.m9.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.10.m9.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> for all the timesteps and use the discounted trajectory return <math alttext="R(s_{t},a_{t})=r_{t}+\gamma R(s_{t+1},a_{t+1})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.11.m10.4"><semantics id="S3.SS3.SSS2.p1.11.m10.4a"><mrow id="S3.SS3.SSS2.p1.11.m10.4.4" xref="S3.SS3.SSS2.p1.11.m10.4.4.cmml"><mrow id="S3.SS3.SSS2.p1.11.m10.2.2.2" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.2.2.2.4" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.4.cmml">R</mi><mo id="S3.SS3.SSS2.p1.11.m10.2.2.2.3" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.3.cmml"><mo id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.4" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.2.cmml">a</mi><mi id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS2.p1.11.m10.4.4.5" xref="S3.SS3.SSS2.p1.11.m10.4.4.5.cmml">=</mo><mrow id="S3.SS3.SSS2.p1.11.m10.4.4.4" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.cmml"><msub id="S3.SS3.SSS2.p1.11.m10.4.4.4.4" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.4.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.4.4.4.4.2" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.4.2.cmml">r</mi><mi id="S3.SS3.SSS2.p1.11.m10.4.4.4.4.3" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.4.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p1.11.m10.4.4.4.3" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.3.cmml">+</mo><mrow id="S3.SS3.SSS2.p1.11.m10.4.4.4.2" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.4" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.4.cmml">γ</mi><mo id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.3" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.3.cmml">⁢</mo><mi id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.5" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.5.cmml">R</mi><mo id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.3a" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.3.cmml"><mo id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.2" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.2" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.1" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.3" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.4" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.2" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.2.cmml">a</mi><mrow id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.2" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.1" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.3" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.11.m10.4b"><apply id="S3.SS3.SSS2.p1.11.m10.4.4.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4"><eq id="S3.SS3.SSS2.p1.11.m10.4.4.5.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.5"></eq><apply id="S3.SS3.SSS2.p1.11.m10.2.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.2.2.2"><times id="S3.SS3.SSS2.p1.11.m10.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.3"></times><ci id="S3.SS3.SSS2.p1.11.m10.2.2.2.4.cmml" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.4">𝑅</ci><interval closure="open" id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2"><apply id="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.2">𝑎</ci><ci id="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S3.SS3.SSS2.p1.11.m10.4.4.4.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4"><plus id="S3.SS3.SSS2.p1.11.m10.4.4.4.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.3"></plus><apply id="S3.SS3.SSS2.p1.11.m10.4.4.4.4.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m10.4.4.4.4.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.4">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m10.4.4.4.4.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.4.2">𝑟</ci><ci id="S3.SS3.SSS2.p1.11.m10.4.4.4.4.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.4.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2"><times id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.3"></times><ci id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.4.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.4">𝛾</ci><ci id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.5.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.5">𝑅</ci><interval closure="open" id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2"><apply id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.2">𝑠</ci><apply id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3"><plus id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.1"></plus><ci id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p1.11.m10.3.3.3.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.2">𝑎</ci><apply id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3"><plus id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.1"></plus><ci id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p1.11.m10.4.4.4.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.11.m10.4c">R(s_{t},a_{t})=r_{t}+\gamma R(s_{t+1},a_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.11.m10.4d">italic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ italic_R ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\gamma\in(0,1)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.12.m11.2"><semantics id="S3.SS3.SSS2.p1.12.m11.2a"><mrow id="S3.SS3.SSS2.p1.12.m11.2.3" xref="S3.SS3.SSS2.p1.12.m11.2.3.cmml"><mi id="S3.SS3.SSS2.p1.12.m11.2.3.2" xref="S3.SS3.SSS2.p1.12.m11.2.3.2.cmml">γ</mi><mo id="S3.SS3.SSS2.p1.12.m11.2.3.1" xref="S3.SS3.SSS2.p1.12.m11.2.3.1.cmml">∈</mo><mrow id="S3.SS3.SSS2.p1.12.m11.2.3.3.2" xref="S3.SS3.SSS2.p1.12.m11.2.3.3.1.cmml"><mo id="S3.SS3.SSS2.p1.12.m11.2.3.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.12.m11.2.3.3.1.cmml">(</mo><mn id="S3.SS3.SSS2.p1.12.m11.1.1" xref="S3.SS3.SSS2.p1.12.m11.1.1.cmml">0</mn><mo id="S3.SS3.SSS2.p1.12.m11.2.3.3.2.2" xref="S3.SS3.SSS2.p1.12.m11.2.3.3.1.cmml">,</mo><mn id="S3.SS3.SSS2.p1.12.m11.2.2" xref="S3.SS3.SSS2.p1.12.m11.2.2.cmml">1</mn><mo id="S3.SS3.SSS2.p1.12.m11.2.3.3.2.3" stretchy="false" xref="S3.SS3.SSS2.p1.12.m11.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.12.m11.2b"><apply id="S3.SS3.SSS2.p1.12.m11.2.3.cmml" xref="S3.SS3.SSS2.p1.12.m11.2.3"><in id="S3.SS3.SSS2.p1.12.m11.2.3.1.cmml" xref="S3.SS3.SSS2.p1.12.m11.2.3.1"></in><ci id="S3.SS3.SSS2.p1.12.m11.2.3.2.cmml" xref="S3.SS3.SSS2.p1.12.m11.2.3.2">𝛾</ci><interval closure="open" id="S3.SS3.SSS2.p1.12.m11.2.3.3.1.cmml" xref="S3.SS3.SSS2.p1.12.m11.2.3.3.2"><cn id="S3.SS3.SSS2.p1.12.m11.1.1.cmml" type="integer" xref="S3.SS3.SSS2.p1.12.m11.1.1">0</cn><cn id="S3.SS3.SSS2.p1.12.m11.2.2.cmml" type="integer" xref="S3.SS3.SSS2.p1.12.m11.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.12.m11.2c">\gamma\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.12.m11.2d">italic_γ ∈ ( 0 , 1 )</annotation></semantics></math> is the discount factor, to calculate the action returns along the trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.13.m12.1"><semantics id="S3.SS3.SSS2.p1.13.m12.1a"><mi id="S3.SS3.SSS2.p1.13.m12.1.1" xref="S3.SS3.SSS2.p1.13.m12.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.13.m12.1b"><ci id="S3.SS3.SSS2.p1.13.m12.1.1.cmml" xref="S3.SS3.SSS2.p1.13.m12.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.13.m12.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.13.m12.1d">italic_τ</annotation></semantics></math>, presented in left part of Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.F2" title="Figure 2 ‣ 3.3 Flexible Sequential Demonstration Retriever (FlexSDR) ‣ 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">2</span></a>. The final goal of our optimization is to maximize the expectation return of the trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.14.m13.1"><semantics id="S3.SS3.SSS2.p1.14.m13.1a"><mi id="S3.SS3.SSS2.p1.14.m13.1.1" xref="S3.SS3.SSS2.p1.14.m13.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.14.m13.1b"><ci id="S3.SS3.SSS2.p1.14.m13.1.1.cmml" xref="S3.SS3.SSS2.p1.14.m13.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.14.m13.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.14.m13.1d">italic_τ</annotation></semantics></math> generated by the iterative execution on the optimized policy network <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.15.m14.1"><semantics id="S3.SS3.SSS2.p1.15.m14.1a"><msub id="S3.SS3.SSS2.p1.15.m14.1.1" xref="S3.SS3.SSS2.p1.15.m14.1.1.cmml"><mi id="S3.SS3.SSS2.p1.15.m14.1.1.2" xref="S3.SS3.SSS2.p1.15.m14.1.1.2.cmml">π</mi><mi id="S3.SS3.SSS2.p1.15.m14.1.1.3" xref="S3.SS3.SSS2.p1.15.m14.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.15.m14.1b"><apply id="S3.SS3.SSS2.p1.15.m14.1.1.cmml" xref="S3.SS3.SSS2.p1.15.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.15.m14.1.1.1.cmml" xref="S3.SS3.SSS2.p1.15.m14.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.15.m14.1.1.2.cmml" xref="S3.SS3.SSS2.p1.15.m14.1.1.2">𝜋</ci><ci id="S3.SS3.SSS2.p1.15.m14.1.1.3.cmml" xref="S3.SS3.SSS2.p1.15.m14.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.15.m14.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.15.m14.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="J_{\theta}=E_{\tau\sim p_{\pi_{\theta}}(\tau)}[\Sigma_{t}R(s_{t},a_{t})]" class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><msub id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml"><mi id="S3.E5.m1.2.2.3.2" xref="S3.E5.m1.2.2.3.2.cmml">J</mi><mi id="S3.E5.m1.2.2.3.3" xref="S3.E5.m1.2.2.3.3.cmml">θ</mi></msub><mo id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.cmml"><msub id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.2.2.1.3.cmml"><mi id="S3.E5.m1.2.2.1.3.2" xref="S3.E5.m1.2.2.1.3.2.cmml">E</mi><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml">τ</mi><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">∼</mo><mrow id="S3.E5.m1.1.1.1.4" xref="S3.E5.m1.1.1.1.4.cmml"><msub id="S3.E5.m1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.4.2.cmml"><mi id="S3.E5.m1.1.1.1.4.2.2" xref="S3.E5.m1.1.1.1.4.2.2.cmml">p</mi><msub id="S3.E5.m1.1.1.1.4.2.3" xref="S3.E5.m1.1.1.1.4.2.3.cmml"><mi id="S3.E5.m1.1.1.1.4.2.3.2" xref="S3.E5.m1.1.1.1.4.2.3.2.cmml">π</mi><mi id="S3.E5.m1.1.1.1.4.2.3.3" xref="S3.E5.m1.1.1.1.4.2.3.3.cmml">θ</mi></msub></msub><mo id="S3.E5.m1.1.1.1.4.1" xref="S3.E5.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.4.3.2" xref="S3.E5.m1.1.1.1.4.cmml"><mo id="S3.E5.m1.1.1.1.4.3.2.1" stretchy="false" xref="S3.E5.m1.1.1.1.4.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">τ</mi><mo id="S3.E5.m1.1.1.1.4.3.2.2" stretchy="false" xref="S3.E5.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.4.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.4.2" mathvariant="normal" xref="S3.E5.m1.2.2.1.1.1.1.4.2.cmml">Σ</mi><mi id="S3.E5.m1.2.2.1.1.1.1.4.3" xref="S3.E5.m1.2.2.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.1.1.5" xref="S3.E5.m1.2.2.1.1.1.1.5.cmml">R</mi><mo id="S3.E5.m1.2.2.1.1.1.1.3a" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.2.3.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.2.2.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.2.2.4" xref="S3.E5.m1.2.2.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E5.m1.2.2.1.1.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.2.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.E5.m1.2.2.1.1.1.1.2.2.2.3" xref="S3.E5.m1.2.2.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.2.2.5" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"></eq><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.3.2">𝐽</ci><ci id="S3.E5.m1.2.2.3.3.cmml" xref="S3.E5.m1.2.2.3.3">𝜃</ci></apply><apply id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2.1"><times id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.2"></times><apply id="S3.E5.m1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.1.cmml" xref="S3.E5.m1.2.2.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.3.2">𝐸</ci><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2">similar-to</csymbol><ci id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">𝜏</ci><apply id="S3.E5.m1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.4"><times id="S3.E5.m1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.4.1"></times><apply id="S3.E5.m1.1.1.1.4.2.cmml" xref="S3.E5.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.4.2.1.cmml" xref="S3.E5.m1.1.1.1.4.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.4.2.2.cmml" xref="S3.E5.m1.1.1.1.4.2.2">𝑝</ci><apply id="S3.E5.m1.1.1.1.4.2.3.cmml" xref="S3.E5.m1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.4.2.3.1.cmml" xref="S3.E5.m1.1.1.1.4.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.4.2.3.2.cmml" xref="S3.E5.m1.1.1.1.4.2.3.2">𝜋</ci><ci id="S3.E5.m1.1.1.1.4.2.3.3.cmml" xref="S3.E5.m1.1.1.1.4.2.3.3">𝜃</ci></apply></apply><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝜏</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.2.2.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3"></times><apply id="S3.E5.m1.2.2.1.1.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.4.2">Σ</ci><ci id="S3.E5.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.4.3">𝑡</ci></apply><ci id="S3.E5.m1.2.2.1.1.1.1.5.cmml" xref="S3.E5.m1.2.2.1.1.1.1.5">𝑅</ci><interval closure="open" id="S3.E5.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2.2"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.E5.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">J_{\theta}=E_{\tau\sim p_{\pi_{\theta}}(\tau)}[\Sigma_{t}R(s_{t},a_{t})]</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">italic_J start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = italic_E start_POSTSUBSCRIPT italic_τ ∼ italic_p start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_τ ) end_POSTSUBSCRIPT [ roman_Σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p1.22">As the instant reward <math alttext="r_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.16.m1.1"><semantics id="S3.SS3.SSS2.p1.16.m1.1a"><msub id="S3.SS3.SSS2.p1.16.m1.1.1" xref="S3.SS3.SSS2.p1.16.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.16.m1.1.1.2" xref="S3.SS3.SSS2.p1.16.m1.1.1.2.cmml">r</mi><mi id="S3.SS3.SSS2.p1.16.m1.1.1.3" xref="S3.SS3.SSS2.p1.16.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.16.m1.1b"><apply id="S3.SS3.SSS2.p1.16.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.16.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.16.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.16.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.16.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.16.m1.1.1.2">𝑟</ci><ci id="S3.SS3.SSS2.p1.16.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.16.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.16.m1.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.16.m1.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> can only be two values -1 or +1, and the maximum length of allowed demonstration for RL-based retriever training is limited, we enumerate all the possible cases for different types of correctness status across the fixed length trajectory (<math alttext="T=2" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.17.m2.1"><semantics id="S3.SS3.SSS2.p1.17.m2.1a"><mrow id="S3.SS3.SSS2.p1.17.m2.1.1" xref="S3.SS3.SSS2.p1.17.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p1.17.m2.1.1.2" xref="S3.SS3.SSS2.p1.17.m2.1.1.2.cmml">T</mi><mo id="S3.SS3.SSS2.p1.17.m2.1.1.1" xref="S3.SS3.SSS2.p1.17.m2.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS2.p1.17.m2.1.1.3" xref="S3.SS3.SSS2.p1.17.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.17.m2.1b"><apply id="S3.SS3.SSS2.p1.17.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.17.m2.1.1"><eq id="S3.SS3.SSS2.p1.17.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.17.m2.1.1.1"></eq><ci id="S3.SS3.SSS2.p1.17.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p1.17.m2.1.1.2">𝑇</ci><cn id="S3.SS3.SSS2.p1.17.m2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS2.p1.17.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.17.m2.1c">T=2</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.17.m2.1d">italic_T = 2</annotation></semantics></math>) in Fig <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.F3.sf1" title="In Figure 3 ‣ 3.3.2 Learning Rewards ‣ 3.3 Flexible Sequential Demonstration Retriever (FlexSDR) ‣ 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">3(a)</span></a>. By viewing the corresponding rewards for different trajectories, we can have the following observation: (1) due to the existing discount factor <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.18.m3.1"><semantics id="S3.SS3.SSS2.p1.18.m3.1a"><mi id="S3.SS3.SSS2.p1.18.m3.1.1" xref="S3.SS3.SSS2.p1.18.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.18.m3.1b"><ci id="S3.SS3.SSS2.p1.18.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.18.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.18.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.18.m3.1d">italic_γ</annotation></semantics></math>, the trajectory with earlier steps approaching the correct response will tend to have a higher reward: <math alttext="([\times],\checkmark,\checkmark)&gt;([\times],\times,\checkmark)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.19.m4.8"><semantics id="S3.SS3.SSS2.p1.19.m4.8a"><mrow id="S3.SS3.SSS2.p1.19.m4.8.8" xref="S3.SS3.SSS2.p1.19.m4.8.8.cmml"><mrow id="S3.SS3.SSS2.p1.19.m4.7.7.1.1" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.2.cmml"><mo id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.2" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.1.1.cmml">[</mo><mo id="S3.SS3.SSS2.p1.19.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.19.m4.1.1.cmml">×</mo><mo id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.3" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.19.m4.2.2" mathvariant="normal" xref="S3.SS3.SSS2.p1.19.m4.2.2.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.4" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.19.m4.3.3" mathvariant="normal" xref="S3.SS3.SSS2.p1.19.m4.3.3.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.2.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p1.19.m4.8.8.3" xref="S3.SS3.SSS2.p1.19.m4.8.8.3.cmml">&gt;</mo><mrow id="S3.SS3.SSS2.p1.19.m4.8.8.2.1" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.2.cmml"><mo id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.2" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.1.1.cmml">[</mo><mo id="S3.SS3.SSS2.p1.19.m4.4.4" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.19.m4.4.4.cmml">×</mo><mo id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.3" rspace="0em" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.19.m4.5.5" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.19.m4.5.5.cmml">×</mo><mo id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.4" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.19.m4.6.6" mathvariant="normal" xref="S3.SS3.SSS2.p1.19.m4.6.6.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.19.m4.8b"><apply id="S3.SS3.SSS2.p1.19.m4.8.8.cmml" xref="S3.SS3.SSS2.p1.19.m4.8.8"><gt id="S3.SS3.SSS2.p1.19.m4.8.8.3.cmml" xref="S3.SS3.SSS2.p1.19.m4.8.8.3"></gt><vector id="S3.SS3.SSS2.p1.19.m4.7.7.1.2.cmml" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.1"><apply id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.19.m4.7.7.1.1.1.2.1">delimited-[]</csymbol><times id="S3.SS3.SSS2.p1.19.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.19.m4.1.1"></times></apply><ci id="S3.SS3.SSS2.p1.19.m4.2.2.cmml" xref="S3.SS3.SSS2.p1.19.m4.2.2">✓</ci><ci id="S3.SS3.SSS2.p1.19.m4.3.3.cmml" xref="S3.SS3.SSS2.p1.19.m4.3.3">✓</ci></vector><vector id="S3.SS3.SSS2.p1.19.m4.8.8.2.2.cmml" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.1"><apply id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.19.m4.8.8.2.1.1.2.1">delimited-[]</csymbol><times id="S3.SS3.SSS2.p1.19.m4.4.4.cmml" xref="S3.SS3.SSS2.p1.19.m4.4.4"></times></apply><times id="S3.SS3.SSS2.p1.19.m4.5.5.cmml" xref="S3.SS3.SSS2.p1.19.m4.5.5"></times><ci id="S3.SS3.SSS2.p1.19.m4.6.6.cmml" xref="S3.SS3.SSS2.p1.19.m4.6.6">✓</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.19.m4.8c">([\times],\checkmark,\checkmark)&gt;([\times],\times,\checkmark)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.19.m4.8d">( [ × ] , ✓ , ✓ ) &gt; ( [ × ] , × , ✓ )</annotation></semantics></math>, which encourages the policy network to find the most valid demonstration at each iteration; (2) when the policy makes an error attempt at the future steps, its return <math alttext="R(\tau)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.20.m5.1"><semantics id="S3.SS3.SSS2.p1.20.m5.1a"><mrow id="S3.SS3.SSS2.p1.20.m5.1.2" xref="S3.SS3.SSS2.p1.20.m5.1.2.cmml"><mi id="S3.SS3.SSS2.p1.20.m5.1.2.2" xref="S3.SS3.SSS2.p1.20.m5.1.2.2.cmml">R</mi><mo id="S3.SS3.SSS2.p1.20.m5.1.2.1" xref="S3.SS3.SSS2.p1.20.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.20.m5.1.2.3.2" xref="S3.SS3.SSS2.p1.20.m5.1.2.cmml"><mo id="S3.SS3.SSS2.p1.20.m5.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.20.m5.1.2.cmml">(</mo><mi id="S3.SS3.SSS2.p1.20.m5.1.1" xref="S3.SS3.SSS2.p1.20.m5.1.1.cmml">τ</mi><mo id="S3.SS3.SSS2.p1.20.m5.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.20.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.20.m5.1b"><apply id="S3.SS3.SSS2.p1.20.m5.1.2.cmml" xref="S3.SS3.SSS2.p1.20.m5.1.2"><times id="S3.SS3.SSS2.p1.20.m5.1.2.1.cmml" xref="S3.SS3.SSS2.p1.20.m5.1.2.1"></times><ci id="S3.SS3.SSS2.p1.20.m5.1.2.2.cmml" xref="S3.SS3.SSS2.p1.20.m5.1.2.2">𝑅</ci><ci id="S3.SS3.SSS2.p1.20.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.20.m5.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.20.m5.1c">R(\tau)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.20.m5.1d">italic_R ( italic_τ )</annotation></semantics></math> will be decreased, e.g., <math alttext="([\times],\checkmark,\checkmark)&gt;([\times],\checkmark,\times)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.21.m6.8"><semantics id="S3.SS3.SSS2.p1.21.m6.8a"><mrow id="S3.SS3.SSS2.p1.21.m6.8.8" xref="S3.SS3.SSS2.p1.21.m6.8.8.cmml"><mrow id="S3.SS3.SSS2.p1.21.m6.7.7.1.1" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.2.cmml"><mo id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.2" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.1.1.cmml">[</mo><mo id="S3.SS3.SSS2.p1.21.m6.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.21.m6.1.1.cmml">×</mo><mo id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.3" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.21.m6.2.2" mathvariant="normal" xref="S3.SS3.SSS2.p1.21.m6.2.2.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.4" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.21.m6.3.3" mathvariant="normal" xref="S3.SS3.SSS2.p1.21.m6.3.3.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.2.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p1.21.m6.8.8.3" xref="S3.SS3.SSS2.p1.21.m6.8.8.3.cmml">&gt;</mo><mrow id="S3.SS3.SSS2.p1.21.m6.8.8.2.1" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.2.cmml"><mo id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.2" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.1.1.cmml">[</mo><mo id="S3.SS3.SSS2.p1.21.m6.4.4" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.21.m6.4.4.cmml">×</mo><mo id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.3" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.21.m6.5.5" mathvariant="normal" xref="S3.SS3.SSS2.p1.21.m6.5.5.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.4" rspace="0em" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.21.m6.6.6" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.21.m6.6.6.cmml">×</mo><mo id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.21.m6.8b"><apply id="S3.SS3.SSS2.p1.21.m6.8.8.cmml" xref="S3.SS3.SSS2.p1.21.m6.8.8"><gt id="S3.SS3.SSS2.p1.21.m6.8.8.3.cmml" xref="S3.SS3.SSS2.p1.21.m6.8.8.3"></gt><vector id="S3.SS3.SSS2.p1.21.m6.7.7.1.2.cmml" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.1"><apply id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.21.m6.7.7.1.1.1.2.1">delimited-[]</csymbol><times id="S3.SS3.SSS2.p1.21.m6.1.1.cmml" xref="S3.SS3.SSS2.p1.21.m6.1.1"></times></apply><ci id="S3.SS3.SSS2.p1.21.m6.2.2.cmml" xref="S3.SS3.SSS2.p1.21.m6.2.2">✓</ci><ci id="S3.SS3.SSS2.p1.21.m6.3.3.cmml" xref="S3.SS3.SSS2.p1.21.m6.3.3">✓</ci></vector><vector id="S3.SS3.SSS2.p1.21.m6.8.8.2.2.cmml" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.1"><apply id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.21.m6.8.8.2.1.1.2.1">delimited-[]</csymbol><times id="S3.SS3.SSS2.p1.21.m6.4.4.cmml" xref="S3.SS3.SSS2.p1.21.m6.4.4"></times></apply><ci id="S3.SS3.SSS2.p1.21.m6.5.5.cmml" xref="S3.SS3.SSS2.p1.21.m6.5.5">✓</ci><times id="S3.SS3.SSS2.p1.21.m6.6.6.cmml" xref="S3.SS3.SSS2.p1.21.m6.6.6"></times></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.21.m6.8c">([\times],\checkmark,\checkmark)&gt;([\times],\checkmark,\times)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.21.m6.8d">( [ × ] , ✓ , ✓ ) &gt; ( [ × ] , ✓ , × )</annotation></semantics></math>, this instructs the policy network to avoid appending the inappropriate demonstrations. In addition to the correct reward, we introduce another "stop bonus" reward <math alttext="r^{\prime}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.22.m7.1"><semantics id="S3.SS3.SSS2.p1.22.m7.1a"><msubsup id="S3.SS3.SSS2.p1.22.m7.1.1" xref="S3.SS3.SSS2.p1.22.m7.1.1.cmml"><mi id="S3.SS3.SSS2.p1.22.m7.1.1.2.2" xref="S3.SS3.SSS2.p1.22.m7.1.1.2.2.cmml">r</mi><mi id="S3.SS3.SSS2.p1.22.m7.1.1.3" xref="S3.SS3.SSS2.p1.22.m7.1.1.3.cmml">t</mi><mo id="S3.SS3.SSS2.p1.22.m7.1.1.2.3" xref="S3.SS3.SSS2.p1.22.m7.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.22.m7.1b"><apply id="S3.SS3.SSS2.p1.22.m7.1.1.cmml" xref="S3.SS3.SSS2.p1.22.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.22.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p1.22.m7.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p1.22.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p1.22.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.22.m7.1.1.2.1.cmml" xref="S3.SS3.SSS2.p1.22.m7.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p1.22.m7.1.1.2.2.cmml" xref="S3.SS3.SSS2.p1.22.m7.1.1.2.2">𝑟</ci><ci id="S3.SS3.SSS2.p1.22.m7.1.1.2.3.cmml" xref="S3.SS3.SSS2.p1.22.m7.1.1.2.3">′</ci></apply><ci id="S3.SS3.SSS2.p1.22.m7.1.1.3.cmml" xref="S3.SS3.SSS2.p1.22.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.22.m7.1c">r^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.22.m7.1d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to each time step:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r^{\prime}_{t}=\begin{cases}0,\ \ \ \ \ \ a_{t}\neq e_{\mathcal{E}}\\
r_{t-1},\ a_{t}=e_{\mathcal{E}}\end{cases}" class="ltx_Math" display="block" id="S3.E6.m1.2"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.3" xref="S3.E6.m1.2.3.cmml"><msubsup id="S3.E6.m1.2.3.2" xref="S3.E6.m1.2.3.2.cmml"><mi id="S3.E6.m1.2.3.2.2.2" xref="S3.E6.m1.2.3.2.2.2.cmml">r</mi><mi id="S3.E6.m1.2.3.2.3" xref="S3.E6.m1.2.3.2.3.cmml">t</mi><mo id="S3.E6.m1.2.3.2.2.3" xref="S3.E6.m1.2.3.2.2.3.cmml">′</mo></msubsup><mo id="S3.E6.m1.2.3.1" xref="S3.E6.m1.2.3.1.cmml">=</mo><mrow id="S3.E6.m1.2.2" xref="S3.E6.m1.2.3.3.1.cmml"><mo id="S3.E6.m1.2.2.3" xref="S3.E6.m1.2.3.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E6.m1.2.2.2" rowspacing="0pt" xref="S3.E6.m1.2.3.3.1.cmml"><mtr id="S3.E6.m1.2.2.2a" xref="S3.E6.m1.2.3.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.2.2.2b" xref="S3.E6.m1.2.3.3.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.2.1" xref="S3.E6.m1.1.1.1.1.1.1.2.2.cmml"><mn id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">0</mn><mo id="S3.E6.m1.1.1.1.1.1.1.2.1.2" rspace="3.167em" xref="S3.E6.m1.1.1.1.1.1.1.2.2.cmml">,</mo><msub id="S3.E6.m1.1.1.1.1.1.1.2.1.1" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.2.cmml">a</mi><mi id="S3.E6.m1.1.1.1.1.1.1.2.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml">≠</mo><msub id="S3.E6.m1.1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.4.2" xref="S3.E6.m1.1.1.1.1.1.1.4.2.cmml">e</mi><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.1.1.4.3.cmml">ℰ</mi></msub></mrow></mtd><mtd id="S3.E6.m1.2.2.2c" xref="S3.E6.m1.2.3.3.1.1.cmml"></mtd></mtr><mtr id="S3.E6.m1.2.2.2d" xref="S3.E6.m1.2.3.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.2.2.2e" xref="S3.E6.m1.2.3.3.1.cmml"><mrow id="S3.E6.m1.2.2.2.2.1.1" xref="S3.E6.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.2.2.1.1.2.2" xref="S3.E6.m1.2.2.2.2.1.1.2.3.cmml"><msub id="S3.E6.m1.2.2.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.2.cmml">r</mi><mrow id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.1" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E6.m1.2.2.2.2.1.1.2.2.3" rspace="0.667em" xref="S3.E6.m1.2.2.2.2.1.1.2.3.cmml">,</mo><msub id="S3.E6.m1.2.2.2.2.1.1.2.2.2" xref="S3.E6.m1.2.2.2.2.1.1.2.2.2.cmml"><mi id="S3.E6.m1.2.2.2.2.1.1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.1.1.2.2.2.2.cmml">a</mi><mi id="S3.E6.m1.2.2.2.2.1.1.2.2.2.3" xref="S3.E6.m1.2.2.2.2.1.1.2.2.2.3.cmml">t</mi></msub></mrow><mo id="S3.E6.m1.2.2.2.2.1.1.3" xref="S3.E6.m1.2.2.2.2.1.1.3.cmml">=</mo><msub id="S3.E6.m1.2.2.2.2.1.1.4" xref="S3.E6.m1.2.2.2.2.1.1.4.cmml"><mi id="S3.E6.m1.2.2.2.2.1.1.4.2" xref="S3.E6.m1.2.2.2.2.1.1.4.2.cmml">e</mi><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.2.1.1.4.3" xref="S3.E6.m1.2.2.2.2.1.1.4.3.cmml">ℰ</mi></msub></mrow></mtd><mtd id="S3.E6.m1.2.2.2f" xref="S3.E6.m1.2.3.3.1.1.cmml"></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.3.cmml" xref="S3.E6.m1.2.3"><eq id="S3.E6.m1.2.3.1.cmml" xref="S3.E6.m1.2.3.1"></eq><apply id="S3.E6.m1.2.3.2.cmml" xref="S3.E6.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.3.2.1.cmml" xref="S3.E6.m1.2.3.2">subscript</csymbol><apply id="S3.E6.m1.2.3.2.2.cmml" xref="S3.E6.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.3.2.2.1.cmml" xref="S3.E6.m1.2.3.2">superscript</csymbol><ci id="S3.E6.m1.2.3.2.2.2.cmml" xref="S3.E6.m1.2.3.2.2.2">𝑟</ci><ci id="S3.E6.m1.2.3.2.2.3.cmml" xref="S3.E6.m1.2.3.2.2.3">′</ci></apply><ci id="S3.E6.m1.2.3.2.3.cmml" xref="S3.E6.m1.2.3.2.3">𝑡</ci></apply><apply id="S3.E6.m1.2.3.3.1.cmml" xref="S3.E6.m1.2.2"><csymbol cd="latexml" id="S3.E6.m1.2.3.3.1.1.cmml" xref="S3.E6.m1.2.2.3">cases</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><neq id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"></neq><list id="S3.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1"><cn id="S3.E6.m1.1.1.1.1.1.1.1.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.1.1">0</cn><apply id="S3.E6.m1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.2">𝑎</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.3">𝑡</ci></apply></list><apply id="S3.E6.m1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4.2">𝑒</ci><ci id="S3.E6.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4.3">ℰ</ci></apply></apply><ci id="S3.E6.m1.2.3.3.1.3a.cmml" xref="S3.E6.m1.2.2"><mtext class="ltx_mathvariant_italic" id="S3.E6.m1.2.3.3.1.3.cmml" xref="S3.E6.m1.2.2.3">otherwise</mtext></ci><apply id="S3.E6.m1.2.2.2.2.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1"><eq id="S3.E6.m1.2.2.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.3"></eq><list id="S3.E6.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.2"><apply id="S3.E6.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.2">𝑟</ci><apply id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3"><minus id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.1"></minus><ci id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E6.m1.2.2.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E6.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.1.1.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E6.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.2.2.2">𝑎</ci><ci id="S3.E6.m1.2.2.2.2.1.1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.2.2.3">𝑡</ci></apply></list><apply id="S3.E6.m1.2.2.2.2.1.1.4.cmml" xref="S3.E6.m1.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.1.1.4.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.4">subscript</csymbol><ci id="S3.E6.m1.2.2.2.2.1.1.4.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.4.2">𝑒</ci><ci id="S3.E6.m1.2.2.2.2.1.1.4.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.4.3">ℰ</ci></apply></apply><ci id="S3.E6.m1.2.3.3.1.5a.cmml" xref="S3.E6.m1.2.2"><mtext class="ltx_mathvariant_italic" id="S3.E6.m1.2.3.3.1.5.cmml" xref="S3.E6.m1.2.2.3">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">r^{\prime}_{t}=\begin{cases}0,\ \ \ \ \ \ a_{t}\neq e_{\mathcal{E}}\\
r_{t-1},\ a_{t}=e_{\mathcal{E}}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.2d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { start_ROW start_CELL 0 , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ≠ italic_e start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL italic_r start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_e start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT end_CELL start_CELL end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p1.28">The bonus added trajectory return can be written as <math alttext="R^{\prime}(s_{t},a_{t})=(r_{t}+\omega*r^{\prime}_{t})+\gamma R^{\prime}(s_{t+1%
},a_{t+1})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.23.m1.5"><semantics id="S3.SS3.SSS2.p1.23.m1.5a"><mrow id="S3.SS3.SSS2.p1.23.m1.5.5" xref="S3.SS3.SSS2.p1.23.m1.5.5.cmml"><mrow id="S3.SS3.SSS2.p1.23.m1.2.2.2" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.cmml"><msup id="S3.SS3.SSS2.p1.23.m1.2.2.2.4" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.4.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.2.2.2.4.2" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.4.2.cmml">R</mi><mo id="S3.SS3.SSS2.p1.23.m1.2.2.2.4.3" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.4.3.cmml">′</mo></msup><mo id="S3.SS3.SSS2.p1.23.m1.2.2.2.3" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.3.cmml"><mo id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.4" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.2.cmml">a</mi><mi id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS2.p1.23.m1.5.5.6" xref="S3.SS3.SSS2.p1.23.m1.5.5.6.cmml">=</mo><mrow id="S3.SS3.SSS2.p1.23.m1.5.5.5" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.cmml"><mrow id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.cmml"><msub id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.2" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.2.cmml">r</mi><mi id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.3" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.1" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.1.cmml">+</mo><mrow id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.2" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.2.cmml">ω</mi><mo id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.1.cmml">∗</mo><msubsup id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.2" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.2.cmml">r</mi><mi id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.3" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.3.cmml">t</mi><mo id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.3" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p1.23.m1.5.5.5.4" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.4.cmml">+</mo><mrow id="S3.SS3.SSS2.p1.23.m1.5.5.5.3" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.4" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.4.cmml">γ</mi><mo id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.3" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.3.cmml">⁢</mo><msup id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.2" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.2.cmml">R</mi><mo id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.3" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.3.cmml">′</mo></msup><mo id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.3a" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.3.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.3.cmml"><mo id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.3.cmml">(</mo><msub id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.2" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.2" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.1" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.3" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.4" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.2" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.2.cmml">a</mi><mrow id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.2" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.1" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.1.cmml">+</mo><mn id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.3" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.23.m1.5b"><apply id="S3.SS3.SSS2.p1.23.m1.5.5.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5"><eq id="S3.SS3.SSS2.p1.23.m1.5.5.6.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.6"></eq><apply id="S3.SS3.SSS2.p1.23.m1.2.2.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2"><times id="S3.SS3.SSS2.p1.23.m1.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.3"></times><apply id="S3.SS3.SSS2.p1.23.m1.2.2.2.4.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.2.2.2.4.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.4">superscript</csymbol><ci id="S3.SS3.SSS2.p1.23.m1.2.2.2.4.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.4.2">𝑅</ci><ci id="S3.SS3.SSS2.p1.23.m1.2.2.2.4.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.4.3">′</ci></apply><interval closure="open" id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2"><apply id="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.2">𝑎</ci><ci id="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S3.SS3.SSS2.p1.23.m1.5.5.5.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5"><plus id="S3.SS3.SSS2.p1.23.m1.5.5.5.4.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.4"></plus><apply id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1"><plus id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.1"></plus><apply id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.2">𝑟</ci><ci id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3"><times id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.2">𝜔</ci><apply id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3">subscript</csymbol><apply id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3">superscript</csymbol><ci id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.2">𝑟</ci><ci id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.2.3">′</ci></apply><ci id="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.3.3.3.1.1.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3"><times id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.3"></times><ci id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.4.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.4">𝛾</ci><apply id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5">superscript</csymbol><ci id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.2">𝑅</ci><ci id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.5.3">′</ci></apply><interval closure="open" id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2"><apply id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.2">𝑠</ci><apply id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3"><plus id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.1"></plus><ci id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p1.23.m1.4.4.4.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.2">𝑎</ci><apply id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3"><plus id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.1"></plus><ci id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.2.cmml" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p1.23.m1.5.5.5.3.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.23.m1.5c">R^{\prime}(s_{t},a_{t})=(r_{t}+\omega*r^{\prime}_{t})+\gamma R^{\prime}(s_{t+1%
},a_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.23.m1.5d">italic_R start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = ( italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_ω ∗ italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + italic_γ italic_R start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\omega" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.24.m2.1"><semantics id="S3.SS3.SSS2.p1.24.m2.1a"><mi id="S3.SS3.SSS2.p1.24.m2.1.1" xref="S3.SS3.SSS2.p1.24.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.24.m2.1b"><ci id="S3.SS3.SSS2.p1.24.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.24.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.24.m2.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.24.m2.1d">italic_ω</annotation></semantics></math> is a weight parameter balancing the influence of the stop bonus to the final returns. The stop bonus trajectory reward function is plotted in Fig <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S3.F3.sf2" title="In Figure 3 ‣ 3.3.2 Learning Rewards ‣ 3.3 Flexible Sequential Demonstration Retriever (FlexSDR) ‣ 3 Method ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">3(b)</span></a>. From the plot, we can observe that <math alttext="R^{\prime}(\tau)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.25.m3.1"><semantics id="S3.SS3.SSS2.p1.25.m3.1a"><mrow id="S3.SS3.SSS2.p1.25.m3.1.2" xref="S3.SS3.SSS2.p1.25.m3.1.2.cmml"><msup id="S3.SS3.SSS2.p1.25.m3.1.2.2" xref="S3.SS3.SSS2.p1.25.m3.1.2.2.cmml"><mi id="S3.SS3.SSS2.p1.25.m3.1.2.2.2" xref="S3.SS3.SSS2.p1.25.m3.1.2.2.2.cmml">R</mi><mo id="S3.SS3.SSS2.p1.25.m3.1.2.2.3" xref="S3.SS3.SSS2.p1.25.m3.1.2.2.3.cmml">′</mo></msup><mo id="S3.SS3.SSS2.p1.25.m3.1.2.1" xref="S3.SS3.SSS2.p1.25.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.25.m3.1.2.3.2" xref="S3.SS3.SSS2.p1.25.m3.1.2.cmml"><mo id="S3.SS3.SSS2.p1.25.m3.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.25.m3.1.2.cmml">(</mo><mi id="S3.SS3.SSS2.p1.25.m3.1.1" xref="S3.SS3.SSS2.p1.25.m3.1.1.cmml">τ</mi><mo id="S3.SS3.SSS2.p1.25.m3.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.25.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.25.m3.1b"><apply id="S3.SS3.SSS2.p1.25.m3.1.2.cmml" xref="S3.SS3.SSS2.p1.25.m3.1.2"><times id="S3.SS3.SSS2.p1.25.m3.1.2.1.cmml" xref="S3.SS3.SSS2.p1.25.m3.1.2.1"></times><apply id="S3.SS3.SSS2.p1.25.m3.1.2.2.cmml" xref="S3.SS3.SSS2.p1.25.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.25.m3.1.2.2.1.cmml" xref="S3.SS3.SSS2.p1.25.m3.1.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p1.25.m3.1.2.2.2.cmml" xref="S3.SS3.SSS2.p1.25.m3.1.2.2.2">𝑅</ci><ci id="S3.SS3.SSS2.p1.25.m3.1.2.2.3.cmml" xref="S3.SS3.SSS2.p1.25.m3.1.2.2.3">′</ci></apply><ci id="S3.SS3.SSS2.p1.25.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.25.m3.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.25.m3.1c">R^{\prime}(\tau)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.25.m3.1d">italic_R start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_τ )</annotation></semantics></math> with the earlier correct stop action <math alttext="(T,S)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.26.m4.2"><semantics id="S3.SS3.SSS2.p1.26.m4.2a"><mrow id="S3.SS3.SSS2.p1.26.m4.2.3.2" xref="S3.SS3.SSS2.p1.26.m4.2.3.1.cmml"><mo id="S3.SS3.SSS2.p1.26.m4.2.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.26.m4.2.3.1.cmml">(</mo><mi id="S3.SS3.SSS2.p1.26.m4.1.1" xref="S3.SS3.SSS2.p1.26.m4.1.1.cmml">T</mi><mo id="S3.SS3.SSS2.p1.26.m4.2.3.2.2" xref="S3.SS3.SSS2.p1.26.m4.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS2.p1.26.m4.2.2" xref="S3.SS3.SSS2.p1.26.m4.2.2.cmml">S</mi><mo id="S3.SS3.SSS2.p1.26.m4.2.3.2.3" stretchy="false" xref="S3.SS3.SSS2.p1.26.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.26.m4.2b"><interval closure="open" id="S3.SS3.SSS2.p1.26.m4.2.3.1.cmml" xref="S3.SS3.SSS2.p1.26.m4.2.3.2"><ci id="S3.SS3.SSS2.p1.26.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.26.m4.1.1">𝑇</ci><ci id="S3.SS3.SSS2.p1.26.m4.2.2.cmml" xref="S3.SS3.SSS2.p1.26.m4.2.2">𝑆</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.26.m4.2c">(T,S)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.26.m4.2d">( italic_T , italic_S )</annotation></semantics></math> will receive a higher return compared to the ones with keeping selecting the demonstrations: <math alttext="([\checkmark],-,-)&gt;([\checkmark],\checkmark,-)&gt;([\checkmark],\checkmark,\checkmark)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.27.m5.12"><semantics id="S3.SS3.SSS2.p1.27.m5.12a"><mrow id="S3.SS3.SSS2.p1.27.m5.12.12" xref="S3.SS3.SSS2.p1.27.m5.12.12.cmml"><mrow id="S3.SS3.SSS2.p1.27.m5.10.10.1.1" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.2.cmml"><mo id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.2" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.1.1.cmml">[</mo><mi id="S3.SS3.SSS2.p1.27.m5.1.1" mathvariant="normal" xref="S3.SS3.SSS2.p1.27.m5.1.1.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.3" rspace="0em" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.27.m5.2.2" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.27.m5.2.2.cmml">−</mo><mo id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.4" rspace="0em" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.27.m5.3.3" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.27.m5.3.3.cmml">−</mo><mo id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.2.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p1.27.m5.12.12.5" xref="S3.SS3.SSS2.p1.27.m5.12.12.5.cmml">&gt;</mo><mrow id="S3.SS3.SSS2.p1.27.m5.11.11.2.1" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.2.cmml"><mo id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.2" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.1.1.cmml">[</mo><mi id="S3.SS3.SSS2.p1.27.m5.4.4" mathvariant="normal" xref="S3.SS3.SSS2.p1.27.m5.4.4.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.3" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.27.m5.5.5" mathvariant="normal" xref="S3.SS3.SSS2.p1.27.m5.5.5.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.4" rspace="0em" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.27.m5.6.6" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.27.m5.6.6.cmml">−</mo><mo id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.2.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p1.27.m5.12.12.6" xref="S3.SS3.SSS2.p1.27.m5.12.12.6.cmml">&gt;</mo><mrow id="S3.SS3.SSS2.p1.27.m5.12.12.3.1" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.2.cmml"><mo id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.2" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.1.1.cmml">[</mo><mi id="S3.SS3.SSS2.p1.27.m5.7.7" mathvariant="normal" xref="S3.SS3.SSS2.p1.27.m5.7.7.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.3" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.27.m5.8.8" mathvariant="normal" xref="S3.SS3.SSS2.p1.27.m5.8.8.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.4" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.2.cmml">,</mo><mi id="S3.SS3.SSS2.p1.27.m5.9.9" mathvariant="normal" xref="S3.SS3.SSS2.p1.27.m5.9.9.cmml">✓</mi><mo id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.27.m5.12b"><apply id="S3.SS3.SSS2.p1.27.m5.12.12.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12"><and id="S3.SS3.SSS2.p1.27.m5.12.12a.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12"></and><apply id="S3.SS3.SSS2.p1.27.m5.12.12b.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12"><gt id="S3.SS3.SSS2.p1.27.m5.12.12.5.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12.5"></gt><vector id="S3.SS3.SSS2.p1.27.m5.10.10.1.2.cmml" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.1"><apply id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.27.m5.10.10.1.1.1.2.1">delimited-[]</csymbol><ci id="S3.SS3.SSS2.p1.27.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.27.m5.1.1">✓</ci></apply><minus id="S3.SS3.SSS2.p1.27.m5.2.2.cmml" xref="S3.SS3.SSS2.p1.27.m5.2.2"></minus><minus id="S3.SS3.SSS2.p1.27.m5.3.3.cmml" xref="S3.SS3.SSS2.p1.27.m5.3.3"></minus></vector><vector id="S3.SS3.SSS2.p1.27.m5.11.11.2.2.cmml" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.1"><apply id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.27.m5.11.11.2.1.1.2.1">delimited-[]</csymbol><ci id="S3.SS3.SSS2.p1.27.m5.4.4.cmml" xref="S3.SS3.SSS2.p1.27.m5.4.4">✓</ci></apply><ci id="S3.SS3.SSS2.p1.27.m5.5.5.cmml" xref="S3.SS3.SSS2.p1.27.m5.5.5">✓</ci><minus id="S3.SS3.SSS2.p1.27.m5.6.6.cmml" xref="S3.SS3.SSS2.p1.27.m5.6.6"></minus></vector></apply><apply id="S3.SS3.SSS2.p1.27.m5.12.12c.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12"><gt id="S3.SS3.SSS2.p1.27.m5.12.12.6.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12.6"></gt><share href="https://arxiv.org/html/2406.13885v1#S3.SS3.SSS2.p1.27.m5.11.11.2.cmml" id="S3.SS3.SSS2.p1.27.m5.12.12d.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12"></share><vector id="S3.SS3.SSS2.p1.27.m5.12.12.3.2.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.1"><apply id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.27.m5.12.12.3.1.1.2.1">delimited-[]</csymbol><ci id="S3.SS3.SSS2.p1.27.m5.7.7.cmml" xref="S3.SS3.SSS2.p1.27.m5.7.7">✓</ci></apply><ci id="S3.SS3.SSS2.p1.27.m5.8.8.cmml" xref="S3.SS3.SSS2.p1.27.m5.8.8">✓</ci><ci id="S3.SS3.SSS2.p1.27.m5.9.9.cmml" xref="S3.SS3.SSS2.p1.27.m5.9.9">✓</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.27.m5.12c">([\checkmark],-,-)&gt;([\checkmark],\checkmark,-)&gt;([\checkmark],\checkmark,\checkmark)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.27.m5.12d">( [ ✓ ] , - , - ) &gt; ( [ ✓ ] , ✓ , - ) &gt; ( [ ✓ ] , ✓ , ✓ )</annotation></semantics></math>. This reward design will encourage the policy network to stop early when the correct response is met. For the case when the stop action is given after an error attempt, the return will be penalized: <math alttext="([\times],-,-)&lt;([\times],\times,-)&lt;([\times],\times,\times)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.28.m6.12"><semantics id="S3.SS3.SSS2.p1.28.m6.12a"><mrow id="S3.SS3.SSS2.p1.28.m6.12.12" xref="S3.SS3.SSS2.p1.28.m6.12.12.cmml"><mrow id="S3.SS3.SSS2.p1.28.m6.10.10.1.1" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.2.cmml"><mo id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.2" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.1.1.cmml">[</mo><mo id="S3.SS3.SSS2.p1.28.m6.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.1.1.cmml">×</mo><mo id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.3" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.28.m6.2.2" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.2.2.cmml">−</mo><mo id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.4" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.28.m6.3.3" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.3.3.cmml">−</mo><mo id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.2.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p1.28.m6.12.12.5" xref="S3.SS3.SSS2.p1.28.m6.12.12.5.cmml">&lt;</mo><mrow id="S3.SS3.SSS2.p1.28.m6.11.11.2.1" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.2.cmml"><mo id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.2" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.1.1.cmml">[</mo><mo id="S3.SS3.SSS2.p1.28.m6.4.4" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.4.4.cmml">×</mo><mo id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.3" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.28.m6.5.5" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.5.5.cmml">×</mo><mo id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.4" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.28.m6.6.6" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.6.6.cmml">−</mo><mo id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.2.cmml">)</mo></mrow><mo id="S3.SS3.SSS2.p1.28.m6.12.12.6" xref="S3.SS3.SSS2.p1.28.m6.12.12.6.cmml">&lt;</mo><mrow id="S3.SS3.SSS2.p1.28.m6.12.12.3.1" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.2.cmml"><mo id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.2.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.2" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.1.1.cmml">[</mo><mo id="S3.SS3.SSS2.p1.28.m6.7.7" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.7.7.cmml">×</mo><mo id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.3" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.28.m6.8.8" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.8.8.cmml">×</mo><mo id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.4" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.2.cmml">,</mo><mo id="S3.SS3.SSS2.p1.28.m6.9.9" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p1.28.m6.9.9.cmml">×</mo><mo id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.5" stretchy="false" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.28.m6.12b"><apply id="S3.SS3.SSS2.p1.28.m6.12.12.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12"><and id="S3.SS3.SSS2.p1.28.m6.12.12a.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12"></and><apply id="S3.SS3.SSS2.p1.28.m6.12.12b.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12"><lt id="S3.SS3.SSS2.p1.28.m6.12.12.5.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12.5"></lt><vector id="S3.SS3.SSS2.p1.28.m6.10.10.1.2.cmml" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.1"><apply id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.28.m6.10.10.1.1.1.2.1">delimited-[]</csymbol><times id="S3.SS3.SSS2.p1.28.m6.1.1.cmml" xref="S3.SS3.SSS2.p1.28.m6.1.1"></times></apply><minus id="S3.SS3.SSS2.p1.28.m6.2.2.cmml" xref="S3.SS3.SSS2.p1.28.m6.2.2"></minus><minus id="S3.SS3.SSS2.p1.28.m6.3.3.cmml" xref="S3.SS3.SSS2.p1.28.m6.3.3"></minus></vector><vector id="S3.SS3.SSS2.p1.28.m6.11.11.2.2.cmml" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.1"><apply id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.28.m6.11.11.2.1.1.2.1">delimited-[]</csymbol><times id="S3.SS3.SSS2.p1.28.m6.4.4.cmml" xref="S3.SS3.SSS2.p1.28.m6.4.4"></times></apply><times id="S3.SS3.SSS2.p1.28.m6.5.5.cmml" xref="S3.SS3.SSS2.p1.28.m6.5.5"></times><minus id="S3.SS3.SSS2.p1.28.m6.6.6.cmml" xref="S3.SS3.SSS2.p1.28.m6.6.6"></minus></vector></apply><apply id="S3.SS3.SSS2.p1.28.m6.12.12c.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12"><lt id="S3.SS3.SSS2.p1.28.m6.12.12.6.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12.6"></lt><share href="https://arxiv.org/html/2406.13885v1#S3.SS3.SSS2.p1.28.m6.11.11.2.cmml" id="S3.SS3.SSS2.p1.28.m6.12.12d.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12"></share><vector id="S3.SS3.SSS2.p1.28.m6.12.12.3.2.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.1"><apply id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.28.m6.12.12.3.1.1.2.1">delimited-[]</csymbol><times id="S3.SS3.SSS2.p1.28.m6.7.7.cmml" xref="S3.SS3.SSS2.p1.28.m6.7.7"></times></apply><times id="S3.SS3.SSS2.p1.28.m6.8.8.cmml" xref="S3.SS3.SSS2.p1.28.m6.8.8"></times><times id="S3.SS3.SSS2.p1.28.m6.9.9.cmml" xref="S3.SS3.SSS2.p1.28.m6.9.9"></times></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.28.m6.12c">([\times],-,-)&lt;([\times],\times,-)&lt;([\times],\times,\times)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.28.m6.12d">( [ × ] , - , - ) &lt; ( [ × ] , × , - ) &lt; ( [ × ] , × , × )</annotation></semantics></math>, since it stops exploring the other possibility for finding the correct response.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="397" id="S3.F3.sf1.g1" src="extracted/5679404/figure/R.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.sf1.6.2.1" style="font-size:90%;">(a)</span> </span><math alttext="R(\tau)" class="ltx_Math" display="inline" id="S3.F3.sf1.3.m1.1"><semantics id="S3.F3.sf1.3.m1.1b"><mrow id="S3.F3.sf1.3.m1.1.2" xref="S3.F3.sf1.3.m1.1.2.cmml"><mi id="S3.F3.sf1.3.m1.1.2.2" mathsize="90%" xref="S3.F3.sf1.3.m1.1.2.2.cmml">R</mi><mo id="S3.F3.sf1.3.m1.1.2.1" xref="S3.F3.sf1.3.m1.1.2.1.cmml">⁢</mo><mrow id="S3.F3.sf1.3.m1.1.2.3.2" xref="S3.F3.sf1.3.m1.1.2.cmml"><mo id="S3.F3.sf1.3.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S3.F3.sf1.3.m1.1.2.cmml">(</mo><mi id="S3.F3.sf1.3.m1.1.1" mathsize="90%" xref="S3.F3.sf1.3.m1.1.1.cmml">τ</mi><mo id="S3.F3.sf1.3.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="S3.F3.sf1.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.3.m1.1c"><apply id="S3.F3.sf1.3.m1.1.2.cmml" xref="S3.F3.sf1.3.m1.1.2"><times id="S3.F3.sf1.3.m1.1.2.1.cmml" xref="S3.F3.sf1.3.m1.1.2.1"></times><ci id="S3.F3.sf1.3.m1.1.2.2.cmml" xref="S3.F3.sf1.3.m1.1.2.2">𝑅</ci><ci id="S3.F3.sf1.3.m1.1.1.cmml" xref="S3.F3.sf1.3.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.3.m1.1d">R(\tau)</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf1.3.m1.1e">italic_R ( italic_τ )</annotation></semantics></math><span class="ltx_text" id="S3.F3.sf1.4.1" style="font-size:90%;"> with <math alttext="\gamma\in(0,1)" class="ltx_Math" display="inline" id="S3.F3.sf1.4.1.m1.2"><semantics id="S3.F3.sf1.4.1.m1.2b"><mrow id="S3.F3.sf1.4.1.m1.2.3" xref="S3.F3.sf1.4.1.m1.2.3.cmml"><mi id="S3.F3.sf1.4.1.m1.2.3.2" xref="S3.F3.sf1.4.1.m1.2.3.2.cmml">γ</mi><mo id="S3.F3.sf1.4.1.m1.2.3.1" xref="S3.F3.sf1.4.1.m1.2.3.1.cmml">∈</mo><mrow id="S3.F3.sf1.4.1.m1.2.3.3.2" xref="S3.F3.sf1.4.1.m1.2.3.3.1.cmml"><mo id="S3.F3.sf1.4.1.m1.2.3.3.2.1" stretchy="false" xref="S3.F3.sf1.4.1.m1.2.3.3.1.cmml">(</mo><mn id="S3.F3.sf1.4.1.m1.1.1" xref="S3.F3.sf1.4.1.m1.1.1.cmml">0</mn><mo id="S3.F3.sf1.4.1.m1.2.3.3.2.2" xref="S3.F3.sf1.4.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.F3.sf1.4.1.m1.2.2" xref="S3.F3.sf1.4.1.m1.2.2.cmml">1</mn><mo id="S3.F3.sf1.4.1.m1.2.3.3.2.3" stretchy="false" xref="S3.F3.sf1.4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.4.1.m1.2c"><apply id="S3.F3.sf1.4.1.m1.2.3.cmml" xref="S3.F3.sf1.4.1.m1.2.3"><in id="S3.F3.sf1.4.1.m1.2.3.1.cmml" xref="S3.F3.sf1.4.1.m1.2.3.1"></in><ci id="S3.F3.sf1.4.1.m1.2.3.2.cmml" xref="S3.F3.sf1.4.1.m1.2.3.2">𝛾</ci><interval closure="open" id="S3.F3.sf1.4.1.m1.2.3.3.1.cmml" xref="S3.F3.sf1.4.1.m1.2.3.3.2"><cn id="S3.F3.sf1.4.1.m1.1.1.cmml" type="integer" xref="S3.F3.sf1.4.1.m1.1.1">0</cn><cn id="S3.F3.sf1.4.1.m1.2.2.cmml" type="integer" xref="S3.F3.sf1.4.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.4.1.m1.2d">\gamma\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf1.4.1.m1.2e">italic_γ ∈ ( 0 , 1 )</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="405" id="S3.F3.sf2.g1" src="extracted/5679404/figure/R_prime.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.sf2.6.2.1" style="font-size:90%;">(b)</span> </span><math alttext="R^{\prime}(\tau)" class="ltx_Math" display="inline" id="S3.F3.sf2.3.m1.1"><semantics id="S3.F3.sf2.3.m1.1b"><mrow id="S3.F3.sf2.3.m1.1.2" xref="S3.F3.sf2.3.m1.1.2.cmml"><msup id="S3.F3.sf2.3.m1.1.2.2" xref="S3.F3.sf2.3.m1.1.2.2.cmml"><mi id="S3.F3.sf2.3.m1.1.2.2.2" mathsize="90%" xref="S3.F3.sf2.3.m1.1.2.2.2.cmml">R</mi><mo id="S3.F3.sf2.3.m1.1.2.2.3" mathsize="90%" xref="S3.F3.sf2.3.m1.1.2.2.3.cmml">′</mo></msup><mo id="S3.F3.sf2.3.m1.1.2.1" xref="S3.F3.sf2.3.m1.1.2.1.cmml">⁢</mo><mrow id="S3.F3.sf2.3.m1.1.2.3.2" xref="S3.F3.sf2.3.m1.1.2.cmml"><mo id="S3.F3.sf2.3.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S3.F3.sf2.3.m1.1.2.cmml">(</mo><mi id="S3.F3.sf2.3.m1.1.1" mathsize="90%" xref="S3.F3.sf2.3.m1.1.1.cmml">τ</mi><mo id="S3.F3.sf2.3.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="S3.F3.sf2.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.sf2.3.m1.1c"><apply id="S3.F3.sf2.3.m1.1.2.cmml" xref="S3.F3.sf2.3.m1.1.2"><times id="S3.F3.sf2.3.m1.1.2.1.cmml" xref="S3.F3.sf2.3.m1.1.2.1"></times><apply id="S3.F3.sf2.3.m1.1.2.2.cmml" xref="S3.F3.sf2.3.m1.1.2.2"><csymbol cd="ambiguous" id="S3.F3.sf2.3.m1.1.2.2.1.cmml" xref="S3.F3.sf2.3.m1.1.2.2">superscript</csymbol><ci id="S3.F3.sf2.3.m1.1.2.2.2.cmml" xref="S3.F3.sf2.3.m1.1.2.2.2">𝑅</ci><ci id="S3.F3.sf2.3.m1.1.2.2.3.cmml" xref="S3.F3.sf2.3.m1.1.2.2.3">′</ci></apply><ci id="S3.F3.sf2.3.m1.1.1.cmml" xref="S3.F3.sf2.3.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf2.3.m1.1d">R^{\prime}(\tau)</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf2.3.m1.1e">italic_R start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_τ )</annotation></semantics></math><span class="ltx_text" id="S3.F3.sf2.4.1" style="font-size:90%;"> with <math alttext="\omega=1,\ \gamma\in(0,1)" class="ltx_Math" display="inline" id="S3.F3.sf2.4.1.m1.4"><semantics id="S3.F3.sf2.4.1.m1.4b"><mrow id="S3.F3.sf2.4.1.m1.4.4.2" xref="S3.F3.sf2.4.1.m1.4.4.3.cmml"><mrow id="S3.F3.sf2.4.1.m1.3.3.1.1" xref="S3.F3.sf2.4.1.m1.3.3.1.1.cmml"><mi id="S3.F3.sf2.4.1.m1.3.3.1.1.2" xref="S3.F3.sf2.4.1.m1.3.3.1.1.2.cmml">ω</mi><mo id="S3.F3.sf2.4.1.m1.3.3.1.1.1" xref="S3.F3.sf2.4.1.m1.3.3.1.1.1.cmml">=</mo><mn id="S3.F3.sf2.4.1.m1.3.3.1.1.3" xref="S3.F3.sf2.4.1.m1.3.3.1.1.3.cmml">1</mn></mrow><mo id="S3.F3.sf2.4.1.m1.4.4.2.3" rspace="0.617em" xref="S3.F3.sf2.4.1.m1.4.4.3a.cmml">,</mo><mrow id="S3.F3.sf2.4.1.m1.4.4.2.2" xref="S3.F3.sf2.4.1.m1.4.4.2.2.cmml"><mi id="S3.F3.sf2.4.1.m1.4.4.2.2.2" xref="S3.F3.sf2.4.1.m1.4.4.2.2.2.cmml">γ</mi><mo id="S3.F3.sf2.4.1.m1.4.4.2.2.1" xref="S3.F3.sf2.4.1.m1.4.4.2.2.1.cmml">∈</mo><mrow id="S3.F3.sf2.4.1.m1.4.4.2.2.3.2" xref="S3.F3.sf2.4.1.m1.4.4.2.2.3.1.cmml"><mo id="S3.F3.sf2.4.1.m1.4.4.2.2.3.2.1" stretchy="false" xref="S3.F3.sf2.4.1.m1.4.4.2.2.3.1.cmml">(</mo><mn id="S3.F3.sf2.4.1.m1.1.1" xref="S3.F3.sf2.4.1.m1.1.1.cmml">0</mn><mo id="S3.F3.sf2.4.1.m1.4.4.2.2.3.2.2" xref="S3.F3.sf2.4.1.m1.4.4.2.2.3.1.cmml">,</mo><mn id="S3.F3.sf2.4.1.m1.2.2" xref="S3.F3.sf2.4.1.m1.2.2.cmml">1</mn><mo id="S3.F3.sf2.4.1.m1.4.4.2.2.3.2.3" stretchy="false" xref="S3.F3.sf2.4.1.m1.4.4.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.sf2.4.1.m1.4c"><apply id="S3.F3.sf2.4.1.m1.4.4.3.cmml" xref="S3.F3.sf2.4.1.m1.4.4.2"><csymbol cd="ambiguous" id="S3.F3.sf2.4.1.m1.4.4.3a.cmml" xref="S3.F3.sf2.4.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.F3.sf2.4.1.m1.3.3.1.1.cmml" xref="S3.F3.sf2.4.1.m1.3.3.1.1"><eq id="S3.F3.sf2.4.1.m1.3.3.1.1.1.cmml" xref="S3.F3.sf2.4.1.m1.3.3.1.1.1"></eq><ci id="S3.F3.sf2.4.1.m1.3.3.1.1.2.cmml" xref="S3.F3.sf2.4.1.m1.3.3.1.1.2">𝜔</ci><cn id="S3.F3.sf2.4.1.m1.3.3.1.1.3.cmml" type="integer" xref="S3.F3.sf2.4.1.m1.3.3.1.1.3">1</cn></apply><apply id="S3.F3.sf2.4.1.m1.4.4.2.2.cmml" xref="S3.F3.sf2.4.1.m1.4.4.2.2"><in id="S3.F3.sf2.4.1.m1.4.4.2.2.1.cmml" xref="S3.F3.sf2.4.1.m1.4.4.2.2.1"></in><ci id="S3.F3.sf2.4.1.m1.4.4.2.2.2.cmml" xref="S3.F3.sf2.4.1.m1.4.4.2.2.2">𝛾</ci><interval closure="open" id="S3.F3.sf2.4.1.m1.4.4.2.2.3.1.cmml" xref="S3.F3.sf2.4.1.m1.4.4.2.2.3.2"><cn id="S3.F3.sf2.4.1.m1.1.1.cmml" type="integer" xref="S3.F3.sf2.4.1.m1.1.1">0</cn><cn id="S3.F3.sf2.4.1.m1.2.2.cmml" type="integer" xref="S3.F3.sf2.4.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf2.4.1.m1.4d">\omega=1,\ \gamma\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf2.4.1.m1.4e">italic_ω = 1 , italic_γ ∈ ( 0 , 1 )</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.4.2.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S3.F3.2.1" style="font-size:90%;">Return functions w/o and w/ stop bonus reward where <math alttext="T=2" class="ltx_Math" display="inline" id="S3.F3.2.1.m1.1"><semantics id="S3.F3.2.1.m1.1b"><mrow id="S3.F3.2.1.m1.1.1" xref="S3.F3.2.1.m1.1.1.cmml"><mi id="S3.F3.2.1.m1.1.1.2" xref="S3.F3.2.1.m1.1.1.2.cmml">T</mi><mo id="S3.F3.2.1.m1.1.1.1" xref="S3.F3.2.1.m1.1.1.1.cmml">=</mo><mn id="S3.F3.2.1.m1.1.1.3" xref="S3.F3.2.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.2.1.m1.1c"><apply id="S3.F3.2.1.m1.1.1.cmml" xref="S3.F3.2.1.m1.1.1"><eq id="S3.F3.2.1.m1.1.1.1.cmml" xref="S3.F3.2.1.m1.1.1.1"></eq><ci id="S3.F3.2.1.m1.1.1.2.cmml" xref="S3.F3.2.1.m1.1.1.2">𝑇</ci><cn id="S3.F3.2.1.m1.1.1.3.cmml" type="integer" xref="S3.F3.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.1.m1.1d">T=2</annotation><annotation encoding="application/x-llamapun" id="S3.F3.2.1.m1.1e">italic_T = 2</annotation></semantics></math>.</span></figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we conduct experiments to validate the effectiveness of each component in KnowTS. Through the experiments, we aim to answer the following research questions:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">RQ1: Can zero-shot and few-shot pipelines of KnowTS help it outperform prior machine learning models while facing limited or even no annotated data?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">RQ2: Can FlexSDR further boost the few-shot pipeline performance while using fewer demonstrations compared to the other RL-based Retrievers?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">RQ3: Which components of FlexSDR are effective?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1">RQ4: What’s the evidence supporting FlexSDR learns the correct stop time from the training?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset Overview</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">To answer the research questions above, we collect a knowledge concept tagging dataset, MathKnowCT, from an online K-12 math education platform. The dataset consists of 24 knowledge concepts, spreading from the math concept learning goal of Grade 1 to Grade 3 students. For each knowledge concept, we collect 100 candidate questions from an unlabeled question database with the highest text embedding similarity and then ask a pedagogical expert to conduct the matching annotations. The ratio between matching and mismatching categories of the whole dataset is around 1:4. More details about the dataset statistics and knowledge concept definitions can be found from Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A1.T4" title="Table 4 ‣ Appendix A MathKnowCT Details ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">4</span></a> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A1" title="Appendix A MathKnowCT Details ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">A</span></a>. Before the experiment, we first split 5 positive samples and 5 negative samples for each knowledge concept as the training (demonstration) set. For each sample in the training (demonstration) set, we ask a pedagogical expert to complete the reasons for the judgment.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Baselines</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To answer RQ1, we prepare baseline models as follows:</p>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.8"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.8.1">Embedding Similarity</span>: we first use two high-performed long text encoding models, sentence-BERT(S-BERT)  <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib17" title="">17</a>]</cite> and text-embedding-3-small <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://platform.openai.com/docs/guides/embeddings/embedding-models" title="">https://platform.openai.com/docs/guides/embeddings/embedding-models</a></span></span></span>, to encode both <math alttext="k" class="ltx_Math" display="inline" id="S4.I2.i1.p1.1.m1.1"><semantics id="S4.I2.i1.p1.1.m1.1a"><mi id="S4.I2.i1.p1.1.m1.1.1" xref="S4.I2.i1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.1.m1.1b"><ci id="S4.I2.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.1.m1.1d">italic_k</annotation></semantics></math> and <math alttext="q" class="ltx_Math" display="inline" id="S4.I2.i1.p1.2.m2.1"><semantics id="S4.I2.i1.p1.2.m2.1a"><mi id="S4.I2.i1.p1.2.m2.1.1" xref="S4.I2.i1.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.2.m2.1b"><ci id="S4.I2.i1.p1.2.m2.1.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.2.m2.1d">italic_q</annotation></semantics></math> into dense embedding vectors <math alttext="x_{k}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.3.m3.1"><semantics id="S4.I2.i1.p1.3.m3.1a"><msub id="S4.I2.i1.p1.3.m3.1.1" xref="S4.I2.i1.p1.3.m3.1.1.cmml"><mi id="S4.I2.i1.p1.3.m3.1.1.2" xref="S4.I2.i1.p1.3.m3.1.1.2.cmml">x</mi><mi id="S4.I2.i1.p1.3.m3.1.1.3" xref="S4.I2.i1.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.3.m3.1b"><apply id="S4.I2.i1.p1.3.m3.1.1.cmml" xref="S4.I2.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.3.m3.1.1.1.cmml" xref="S4.I2.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.3.m3.1.1.2.cmml" xref="S4.I2.i1.p1.3.m3.1.1.2">𝑥</ci><ci id="S4.I2.i1.p1.3.m3.1.1.3.cmml" xref="S4.I2.i1.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.3.m3.1c">x_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="x_{q}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.4.m4.1"><semantics id="S4.I2.i1.p1.4.m4.1a"><msub id="S4.I2.i1.p1.4.m4.1.1" xref="S4.I2.i1.p1.4.m4.1.1.cmml"><mi id="S4.I2.i1.p1.4.m4.1.1.2" xref="S4.I2.i1.p1.4.m4.1.1.2.cmml">x</mi><mi id="S4.I2.i1.p1.4.m4.1.1.3" xref="S4.I2.i1.p1.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.4.m4.1b"><apply id="S4.I2.i1.p1.4.m4.1.1.cmml" xref="S4.I2.i1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.4.m4.1.1.1.cmml" xref="S4.I2.i1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.4.m4.1.1.2.cmml" xref="S4.I2.i1.p1.4.m4.1.1.2">𝑥</ci><ci id="S4.I2.i1.p1.4.m4.1.1.3.cmml" xref="S4.I2.i1.p1.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.4.m4.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and we calculate the cosine similarity between them. The judgment of each test sample is determined by the top-<math alttext="K" class="ltx_Math" display="inline" id="S4.I2.i1.p1.5.m5.1"><semantics id="S4.I2.i1.p1.5.m5.1a"><mi id="S4.I2.i1.p1.5.m5.1.1" xref="S4.I2.i1.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.5.m5.1b"><ci id="S4.I2.i1.p1.5.m5.1.1.cmml" xref="S4.I2.i1.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.5.m5.1d">italic_K</annotation></semantics></math> selection or similarity threshold <math alttext="\eta" class="ltx_Math" display="inline" id="S4.I2.i1.p1.6.m6.1"><semantics id="S4.I2.i1.p1.6.m6.1a"><mi id="S4.I2.i1.p1.6.m6.1.1" xref="S4.I2.i1.p1.6.m6.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.6.m6.1b"><ci id="S4.I2.i1.p1.6.m6.1.1.cmml" xref="S4.I2.i1.p1.6.m6.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.6.m6.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.6.m6.1d">italic_η</annotation></semantics></math> comparisons. The value of hyper-parameter <math alttext="K" class="ltx_Math" display="inline" id="S4.I2.i1.p1.7.m7.1"><semantics id="S4.I2.i1.p1.7.m7.1a"><mi id="S4.I2.i1.p1.7.m7.1.1" xref="S4.I2.i1.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.7.m7.1b"><ci id="S4.I2.i1.p1.7.m7.1.1.cmml" xref="S4.I2.i1.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.7.m7.1d">italic_K</annotation></semantics></math> and <math alttext="\eta" class="ltx_Math" display="inline" id="S4.I2.i1.p1.8.m8.1"><semantics id="S4.I2.i1.p1.8.m8.1a"><mi id="S4.I2.i1.p1.8.m8.1.1" xref="S4.I2.i1.p1.8.m8.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.8.m8.1b"><ci id="S4.I2.i1.p1.8.m8.1.1.cmml" xref="S4.I2.i1.p1.8.m8.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.8.m8.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.8.m8.1d">italic_η</annotation></semantics></math> is determined by performing a grid search on test data.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">PLM Fine-tuning</span>: We add a binary classification layer to the top of &lt;BOS&gt; tokens outputs and fine-tune the parameter of the whole model with the binary entropy loss calculated on the samples in the training set. The PLMs we use in our experiment include BERT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib26" title="">26</a>]</cite>, T5 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib27" title="">27</a>]</cite>, and RoBERTa <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib28" title="">28</a>]</cite> and the learning rate during the fine-tuning process is tuned from 1e-3 to 1e-5.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">To answer RQ2, we compare it with two prior SOTA RL-retrievers.</p>
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.1.1">PromptPG</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib20" title="">20</a>]</cite>: We implement PromptPG from the public available source code <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/lupantech/PromptPG" title="">https://github.com/lupantech/PromptPG</a></span></span></span>, where the retrieval is set as a one-layer-MLP . During the retrieval process, we input the input question and demonstration question embedding into the retriever and optimize the policy network with the REINFORCE policy gradient algorithm <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib29" title="">29</a>]</cite> suggested by the paper.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.2.1">RetICL</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib19" title="">19</a>]</cite>: RetICL can be viewed as a special case of FlexSDR, where no early stop is added to the demonstration selection space, decay factor <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.I3.i2.p1.1.m1.1"><semantics id="S4.I3.i2.p1.1.m1.1a"><mi id="S4.I3.i2.p1.1.m1.1.1" xref="S4.I3.i2.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.I3.i2.p1.1.m1.1b"><ci id="S4.I3.i2.p1.1.m1.1.1.cmml" xref="S4.I3.i2.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i2.p1.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i2.p1.1.m1.1d">italic_γ</annotation></semantics></math> is set to 1 during the training, and the reward loss will only be calculated for the last step <math alttext="T" class="ltx_Math" display="inline" id="S4.I3.i2.p1.2.m2.1"><semantics id="S4.I3.i2.p1.2.m2.1a"><mi id="S4.I3.i2.p1.2.m2.1.1" xref="S4.I3.i2.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.I3.i2.p1.2.m2.1b"><ci id="S4.I3.i2.p1.2.m2.1.1.cmml" xref="S4.I3.i2.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i2.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i2.p1.2.m2.1d">italic_T</annotation></semantics></math>’s result, we implement the algorithm based on changing the setting parameter of FlexSDR. The other training settings, e.g., retriever parameter sizes, are kept the same as FlexSDR for fair comparisons.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>LLMs Settings</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To validate the generosity of our proposed algorithm, we experiment with 4 representative LLMs frameworks for both the zero-shot and naive few-shot inference experiment, including GPT  <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib15" title="">15</a>]</cite>, LLAMA3 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib30" title="">30</a>]</cite>, Mistral and Mixtral <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib31" title="">31</a>]</cite>, Qwen1.5 <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">bai2023qwen</span>]</cite>. More details about LLM’s implementation can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A3" title="Appendix C LLMs Implementation Details ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>FlexSDR Settings</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.5">To implement FlexSDR, we choose to use a 2-layer LSTM with 64 hidden neurons for each layer, and the text encoder <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">caligraphic_E</annotation></semantics></math> is text-embedding-3-small, the early-stop bonus weight <math alttext="\omega=1" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">ω</mi><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><eq id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1"></eq><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝜔</ci><cn id="S4.SS4.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\omega=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_ω = 1</annotation></semantics></math>. The discount factor <math alttext="\gamma=0.99" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">γ</mi><mo id="S4.SS4.p1.3.m3.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml">0.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><eq id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></eq><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝛾</ci><cn id="S4.SS4.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS4.p1.3.m3.1.1.3">0.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\gamma=0.99</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_γ = 0.99</annotation></semantics></math>. To improve the convergence of the whole training process, we employ the actor-critic optimization framework <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#bib.bib32" title="">32</a>]</cite> during training. We train the value function estimator using mean squared error (MSE) based on each step’s hidden state <math alttext="\mathcal{V}(h_{t})" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><mrow id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">𝒱</mi><mo id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.p1.4.m4.1.1.1.1" xref="S4.SS4.p1.4.m4.1.1.1.1.1.cmml"><mo id="S4.SS4.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S4.SS4.p1.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S4.SS4.p1.4.m4.1.1.1.1.1" xref="S4.SS4.p1.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.1.1.1.2" xref="S4.SS4.p1.4.m4.1.1.1.1.1.2.cmml">h</mi><mi id="S4.SS4.p1.4.m4.1.1.1.1.1.3" xref="S4.SS4.p1.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS4.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S4.SS4.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><times id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2"></times><ci id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">𝒱</ci><apply id="S4.SS4.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.1.1.1.2">ℎ</ci><ci id="S4.SS4.p1.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\mathcal{V}(h_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">caligraphic_V ( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, the weight for the loss of value function is set as 0.5. Besides, to further improve the data usage efficiency, we also incorporated off-policy learning epochs during the training, and the off-policy epochs we set in our experiment is 80. Finally, to encourage exploration during the reinforcement steps, we add the negative entropy of the policy to each time step’s loss, and the weight is set as 0.01. During the inference time, we use the greedy decoding method at each timestep <math alttext="t" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m5.1"><semantics id="S4.SS4.p1.5.m5.1a"><mi id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><ci id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m5.1d">italic_t</annotation></semantics></math>, and once the early stop option is hit, the demonstration retrieval procedure stops.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Zero-Shot and Naive Few-Shot Results</h3>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.4.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.5.2" style="font-size:90%;">Comparison between PLM Embedding Similarity, PLM Fine-tune, and LLM Zero-shot Inference. The best performance for each metric is marked with <span class="ltx_text ltx_font_bold" id="S4.T1.5.2.1">bold</span>, and the second best one is marked with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.5.2.2">underline</span>.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.6" style="width:433.6pt;height:143.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-91.1pt,30.1pt) scale(0.704022735069804,0.704022735069804) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.6.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.6.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T1.6.1.1.1.1.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.6.1.1.1.2" rowspan="2"><span class="ltx_text" id="S4.T1.6.1.1.1.2.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.6.1.1.1.2.1.1">
<span class="ltx_tr" id="S4.T1.6.1.1.1.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.2.1.1.1.1">Model</span></span>
<span class="ltx_tr" id="S4.T1.6.1.1.1.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.2.1.1.2.1">Size</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T1.6.1.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.1.1.1.3.1">
<tr class="ltx_tr" id="S4.T1.6.1.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.3.1.1.1">K / Q</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.3.1.2.1">Simularity</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T1.6.1.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.1.1.1.4.1">
<tr class="ltx_tr" id="S4.T1.6.1.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.4.1.1.1">Q / Q</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.4.1.2.1">Simularity</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T1.6.1.1.1.5">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.1.1.1.5.1">
<tr class="ltx_tr" id="S4.T1.6.1.1.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.5.1.1.1">PLM</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.1.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.5.1.2.1">Fine-tune</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T1.6.1.1.1.6">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.1.1.1.6.1">
<tr class="ltx_tr" id="S4.T1.6.1.1.1.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.6.1.1.1">LLM</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.1.1.6.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.1.1.6.1.2.1">Zero-Shot</td>
</tr>
</table>
</th>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.1">GPT-Embed</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.2">SBERT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.3">GPT-Embed</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.4">SBERT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.5">BERT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.6">RoBERTa</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.7">T5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.8">GPT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.9">Llama-3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.10">Mixtral</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.6.1.2.2.11">Qwen</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.6.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.1" rowspan="2"><span class="ltx_text" id="S4.T1.6.1.3.1.1.1">Accuracy</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.3">67.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.4">79.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.5">78.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.6">63.58</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.7">58.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.8">35.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.9">77.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.10">75.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.11">58.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.12">68.60</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T1.6.1.3.1.13">66.89</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.4.2">
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.1">Large</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.3">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.6">76.64</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.7">79.08</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.8">79.55</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.9"><span class="ltx_text ltx_font_bold" id="S4.T1.6.1.4.2.9.1">89.00</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.10">68.14</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.4.2.11">74.73</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.4.2.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.1.4.2.12.1">79.98</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.5.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.1" rowspan="2"><span class="ltx_text" id="S4.T1.6.1.5.3.1.1">Precision</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.3">52.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.4">67.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.5">67.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.6">49.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.7">44.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.8">35.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.9">64.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.10">60.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.11">46.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.12">53.87</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T1.6.1.5.3.13">52.58</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.6.4">
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.1">Large</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.3">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.6">63.02</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.1.6.4.7.1">72.61</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.8">71.45</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.9"><span class="ltx_text ltx_font_bold" id="S4.T1.6.1.6.4.9.1">78.38</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.10">52.58</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.6.4.11">59.89</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.6.4.12">65.34</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.7.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.1" rowspan="2"><span class="ltx_text" id="S4.T1.6.1.7.5.1.1">Recall</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.3">75.27</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.4">82.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.5">75.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.6">87.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.7">62.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.8"><span class="ltx_text ltx_font_bold" id="S4.T1.6.1.7.5.8.1">100.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.9">78.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.10">89.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.11">92.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.12">89.74</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T1.6.1.7.5.13">83.16</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.8.6">
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.1">Large</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.3">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.6">82.80</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.7">65.94</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.8">70.62</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.9">95.03</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.1.8.6.10.1">98.79</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.1.8.6.11">85.89</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.1.8.6.12">94.74</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.9.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.6.1.9.7.1" rowspan="2"><span class="ltx_text" id="S4.T1.6.1.9.7.1.1">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.3">61.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.4">74.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.5">71.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.6">62.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.7">51.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.8">52.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.9">70.99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.10">71.82</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.11">61.58</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.12">67.32</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T1.6.1.9.7.13">64.42</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.1.10.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.1">Large</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.6">71.57</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.7">69.12</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.8">71.03</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.9"><span class="ltx_text ltx_font_bold" id="S4.T1.6.1.10.8.9.1">85.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.10">68.63</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.11">70.57</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T1.6.1.10.8.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.1.10.8.12.1">77.34</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.4.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.5.2" style="font-size:90%;">Comparisons between LLM 2-Shot and 4-Shot Inference. The best performance for each metric is marked with <span class="ltx_text ltx_font_bold" id="S4.T2.5.2.1">bold</span>, and the second best one is marked with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.2.2">underline</span>.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.6" style="width:433.6pt;height:138.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-92.6pt,29.6pt) scale(0.70073576007092,0.70073576007092) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.6.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.6.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.6.1.1.1.1" rowspan="3"><span class="ltx_text" id="S4.T2.6.1.1.1.1.1">Metric</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.6.1.1.1.2" rowspan="3"><span class="ltx_text" id="S4.T2.6.1.1.1.2.1">Model Size</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S4.T2.6.1.1.1.3">2-Shot</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S4.T2.6.1.1.1.4">4-Shot</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T2.6.1.2.2.1">Random</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T2.6.1.2.2.2">Heuristic</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T2.6.1.2.2.3">Random</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T2.6.1.2.2.4">Heuristic</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.1">GPT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.2">Llama-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.3">Mixtral</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.4">GPT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.5">Llama-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.6">Mixtral</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.7">GPT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.8">Llama-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.9">Mixtral</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.10">GPT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.11">Llama-3</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.6.1.3.3.12">Mixtral</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.1" rowspan="2"><span class="ltx_text" id="S4.T2.6.1.4.4.1.1">Accuracy</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.3">76.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.4">75.64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.5">78.72</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.6">72.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.7">73.15</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.8">81.15</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.9">77.95</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.10">79.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.11">81.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.12">79.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.13">80.74</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.6.1.4.4.14">80.62</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.5.5">
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.1">Large</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.2">89.45</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.3">83.45</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.4">80.84</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.5">90.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.6">84.26</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.7">80.23</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.1.5.5.8.1">90.40</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.9">88.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.10">84.31</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.11"><span class="ltx_text ltx_font_bold" id="S4.T2.6.1.5.5.11.1">91.11</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.5.5.12">88.57</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.6.1.5.5.13">84.06</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.1" rowspan="2"><span class="ltx_text" id="S4.T2.6.1.6.6.1.1">Precision</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.3">60.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.4">60.59</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.5">65.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.6">57.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.7">58.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.8">68.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.9">62.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.10">64.91</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.11">68.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.12">64.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.13">67.52</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.6.1.6.6.14">67.94</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.7.7">
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.1">Large</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.2">79.86</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.3">69.16</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.4">67.67</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.5">81.86</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.6">70.98</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.7">67.64</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.1.7.7.8.1">82.56</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.9">76.03</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.10">73.18</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.11"><span class="ltx_text ltx_font_bold" id="S4.T2.6.1.7.7.11.1">83.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.7.7.12">77.91</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.6.1.7.7.13">73.35</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.1" rowspan="2"><span class="ltx_text" id="S4.T2.6.1.8.8.1.1">Recall</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.3">93.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.4">89.82</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.5">86.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.6">87.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.7">84.14</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.8">85.64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.9">92.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.10">90.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.11">87.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.12">91.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.13">88.15</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.6.1.8.8.14">85.98</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.9.9">
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.1">Large</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.2">93.99</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.1.9.9.3.1">95.83</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.4">87.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.5">92.65</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.6">93.68</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.7">84.27</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.8">92.49</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.9"><span class="ltx_text ltx_font_bold" id="S4.T2.6.1.9.9.9.1">96.37</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.10">87.63</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.11">92.82</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.1.9.9.12">94.35</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.6.1.9.9.13">87.63</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.10.10">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.6.1.10.10.1" rowspan="2"><span class="ltx_text" id="S4.T2.6.1.10.10.1.1">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.3">73.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.4">72.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.5">74.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.6">69.15</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.7">68.99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.8">76.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.9">74.82</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.10">75.59</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.11">76.99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.12">75.91</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.13">76.47</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.6.1.10.10.14">75.90</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.1.11.11">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.1">Large</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.2">86.35</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.3">80.34</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.4">76.32</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.5">86.92</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.6">80.76</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.7">75.04</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.1.11.11.8.1">87.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.9">85.00</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.10">79.76</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.11"><span class="ltx_text ltx_font_bold" id="S4.T2.6.1.11.11.11.1">88.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.12">85.35</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T2.6.1.11.11.13">79.86</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">In this section, we answer RQ1 with comparisons between prior machine learning algorithms, including embedding similarity, PLM fine-tuning, and LLM-based methods, e.g., zero-shot, 2-shot, 4-shot inference. From Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.T1" title="Table 1 ‣ 4.5 Zero-Shot and Naive Few-Shot Results ‣ 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">1</span></a>, we can observe that the prior methods present acceptable performance. However, the performance of most of these methods got trapped at around 71% F1-score. For LLM-based methods, we can find even under the zero-shot setting, some of the large-sized ones, e.g., GPT-4-turbo, present extremely strong task-solving capability and achieving 85.9% F1 results, outperforming the non-LLM methods by a great margin. This observation proves our hypothesis that contributes to the broad prior knowledge (math concepts) learned during the pre-training phase and strong problem-solving skills taught in the instruction tunning stages, LLMs are good tools for knowledge tagging tasks with limited or even no annotation data. The result presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.T2" title="Table 2 ‣ 4.5 Zero-Shot and Naive Few-Shot Results ‣ 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates the advantages of LLMs in-context learning capability. With the introduction of only 2 to 4 demonstration samples, most LLMs can achieve significantly better performance compared to the zero-shot cases, and LLMs with lower performance in zero-shot, e.g., Llama-3-70B, receive the performance boost by 10%. Such observation suggests the great potential of LLM-based algorithms in generating high-performed knowledge tagging results with sufficient demonstration samples.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Demonstration Retriever Enhanced Few-shot Results</h3>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.4.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.5.2" style="font-size:90%;">Comparisons between three RL-based retrievers on three LLMs. The best performance for each metric is marked with <span class="ltx_text ltx_font_bold" id="S4.T3.5.2.1">bold</span>, and the second best one is marked with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.5.2.2">underline</span>. The number in (parentheses) for FlexSDR is the mean demonstration size the retriever decides.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.6" style="width:433.6pt;height:126.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-91.4pt,26.7pt) scale(0.703372279819883,0.703372279819883) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.6.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.6.1.1.1.1.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.2" rowspan="2"><span class="ltx_text" id="S4.T3.6.1.1.1.2.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.6.1.1.1.2.1.1">
<span class="ltx_tr" id="S4.T3.6.1.1.1.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.6.1.1.1.2.1.1.1.1">Max-Shot</span></span>
<span class="ltx_tr" id="S4.T3.6.1.1.1.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.6.1.1.1.2.1.1.2.1">Size</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T3.6.1.1.1.3">GPT Base (GPT-3.5-turbo)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T3.6.1.1.1.4">Llama-3 Base (Llama-3-8B)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T3.6.1.1.1.5">Mixtral Base (Mistral-7B)</th>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.1">PromptPG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.2">RetICL</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.3">FlexSDR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.4">PromptPG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.5">RetICL</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.6">FlexSDR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.7">PromptPG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.8">RetICL</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.6.1.2.2.9">FlexSDR</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.6.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.6.1.3.1.1.1">Accuracy</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.2">2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.3">81.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.4">79.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.5">
<span class="ltx_text ltx_font_bold" id="S4.T3.6.1.3.1.5.1">83.87</span> (1.38)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.6">70.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.7">79.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.8">79.32 (1.55)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.9">72.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.10">80.08</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.1.3.1.11">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.1.3.1.11.1">83.68</span> (1.78)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.4.2">
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.1">4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.2">77.23</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.3">79.70</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.4">82.07 (2.10)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.5">73.15</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.6">77.89</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.7">80.65 (3.65)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.8">74.10</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.2.9">79.98</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.6.1.4.2.10">81.31 (2.82)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.5.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.1" rowspan="2"><span class="ltx_text" id="S4.T3.6.1.5.3.1.1">Precision</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.2">2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.3">71.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.4">65.46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.5">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.1.5.3.5.1">73.54</span> (1.38)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.6">55.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.7">66.87</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.8">66.01 (1.55)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.9">57.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.10">69.77</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.1.5.3.11">
<span class="ltx_text ltx_font_bold" id="S4.T3.6.1.5.3.11.1">77.81</span> (1.78)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.6.4">
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.1">4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.2">62.46</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.3">65.31</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.4">68.99 (2.10)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.5">57.96</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.6">63.15</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.7">66.67 (3.65)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.8">59.30</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.4.9">65.34</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.6.1.6.4.10">69.68 (2.82)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.7.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.1" rowspan="2"><span class="ltx_text" id="S4.T3.6.1.7.5.1.1">Recall</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.2">2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.3">81.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.4">90.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.5">86.32 (1.38)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.6">90.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.7">87.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.8">87.89 (1.55)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.9">85.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.10">78.95</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.1.7.5.11">76.58 (1.78)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.8.6">
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.1">4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.2">92.37</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.1.8.6.3.1">93.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.4">91.32 (2.10)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.5">92.89</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.6">92.89</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.7">92.63 (3.65)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.8">89.74</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.6.9"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.8.6.9.1">94.74</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.6.1.8.6.10">85.26 (2.82)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.9.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.6.1.9.7.1" rowspan="2"><span class="ltx_text" id="S4.T3.6.1.9.7.1.1">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.2">2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.3">76.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.4">75.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.5">
<span class="ltx_text ltx_font_bold" id="S4.T3.6.1.9.7.5.1">79.42</span> (1.38)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.6">68.94</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.7">75.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.8">75.40 (1.55)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.9">68.87</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.10">74.07</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.1.9.7.11">77.19 (1.78)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.10.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.1">4</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.2">74.52</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.3">76.79</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.4">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.1.10.8.4.1">78.60</span> (2.10)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.5">71.39</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.6">75.19</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.7">77.53 (3.65)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.8">71.41</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.9">77.34</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T3.6.1.10.8.10">76.69 (2.82)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">In this section, we answer RQ2 by presenting the comparisons between FlexSDR and other baselines in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.T3" title="Table 3 ‣ 4.6 Demonstration Retriever Enhanced Few-shot Results ‣ 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">3</span></a>. From the table, we observe that FlexSDR constantly bring further boosts to the few-shot learning performance compared to the naive few-shot learning results in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.T2" title="Table 2 ‣ 4.5 Zero-Shot and Naive Few-Shot Results ‣ 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">2</span></a>. However, the performance gain of the other two baselines is not stable, especially PromptPG, which sometimes performs much worse than naive selected few-shot demonstrations. We believe the discrepancy is mostly due to the simple optimization goal of PromptPG, which treats each demonstration as an independent item and oversimplifies the retrieving process in a one-shot manner. Apart from that, as FlexSDR is designed with the early stop mechanism, the average demonstration length used in few-shot learning FlexSDR is always less than the max-shot size. From the table, we find FlexSDR uses 25% less demonstrations for its few-shot learning inference, which achieves our goal of providing fewer demonstrations but better performance. At last, by observing the positive relationship between the proportional performance gain and length increase between 2 and 4 max shots scenarios, we conclude that FlexSDR learns the correct time to end the retrieval process and adaptive incorporates the best demonstration for a good marginal performance gain.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Ablation Studies</h3>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.5">To answer RQ3, we ablate the intermediate reward design from FlexSDR and name the new model as FlexRetICR since it is similar to RetICL but can perform the early stop action. We train FlexRetICR with both rewards <math alttext="r_{t}" class="ltx_Math" display="inline" id="S4.SS7.p1.1.m1.1"><semantics id="S4.SS7.p1.1.m1.1a"><msub id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml"><mi id="S4.SS7.p1.1.m1.1.1.2" xref="S4.SS7.p1.1.m1.1.1.2.cmml">r</mi><mi id="S4.SS7.p1.1.m1.1.1.3" xref="S4.SS7.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.1b"><apply id="S4.SS7.p1.1.m1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS7.p1.1.m1.1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS7.p1.1.m1.1.1.2.cmml" xref="S4.SS7.p1.1.m1.1.1.2">𝑟</ci><ci id="S4.SS7.p1.1.m1.1.1.3.cmml" xref="S4.SS7.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="r^{\prime}_{t}" class="ltx_Math" display="inline" id="S4.SS7.p1.2.m2.1"><semantics id="S4.SS7.p1.2.m2.1a"><msubsup id="S4.SS7.p1.2.m2.1.1" xref="S4.SS7.p1.2.m2.1.1.cmml"><mi id="S4.SS7.p1.2.m2.1.1.2.2" xref="S4.SS7.p1.2.m2.1.1.2.2.cmml">r</mi><mi id="S4.SS7.p1.2.m2.1.1.3" xref="S4.SS7.p1.2.m2.1.1.3.cmml">t</mi><mo id="S4.SS7.p1.2.m2.1.1.2.3" xref="S4.SS7.p1.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.2.m2.1b"><apply id="S4.SS7.p1.2.m2.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS7.p1.2.m2.1.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS7.p1.2.m2.1.1.2.cmml" xref="S4.SS7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS7.p1.2.m2.1.1.2.1.cmml" xref="S4.SS7.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS7.p1.2.m2.1.1.2.2.cmml" xref="S4.SS7.p1.2.m2.1.1.2.2">𝑟</ci><ci id="S4.SS7.p1.2.m2.1.1.2.3.cmml" xref="S4.SS7.p1.2.m2.1.1.2.3">′</ci></apply><ci id="S4.SS7.p1.2.m2.1.1.3.cmml" xref="S4.SS7.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.2.m2.1c">r^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.2.m2.1d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and set weight parameter <math alttext="\omega=\frac{1}{T}" class="ltx_Math" display="inline" id="S4.SS7.p1.3.m3.1"><semantics id="S4.SS7.p1.3.m3.1a"><mrow id="S4.SS7.p1.3.m3.1.1" xref="S4.SS7.p1.3.m3.1.1.cmml"><mi id="S4.SS7.p1.3.m3.1.1.2" xref="S4.SS7.p1.3.m3.1.1.2.cmml">ω</mi><mo id="S4.SS7.p1.3.m3.1.1.1" xref="S4.SS7.p1.3.m3.1.1.1.cmml">=</mo><mfrac id="S4.SS7.p1.3.m3.1.1.3" xref="S4.SS7.p1.3.m3.1.1.3.cmml"><mn id="S4.SS7.p1.3.m3.1.1.3.2" xref="S4.SS7.p1.3.m3.1.1.3.2.cmml">1</mn><mi id="S4.SS7.p1.3.m3.1.1.3.3" xref="S4.SS7.p1.3.m3.1.1.3.3.cmml">T</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.3.m3.1b"><apply id="S4.SS7.p1.3.m3.1.1.cmml" xref="S4.SS7.p1.3.m3.1.1"><eq id="S4.SS7.p1.3.m3.1.1.1.cmml" xref="S4.SS7.p1.3.m3.1.1.1"></eq><ci id="S4.SS7.p1.3.m3.1.1.2.cmml" xref="S4.SS7.p1.3.m3.1.1.2">𝜔</ci><apply id="S4.SS7.p1.3.m3.1.1.3.cmml" xref="S4.SS7.p1.3.m3.1.1.3"><divide id="S4.SS7.p1.3.m3.1.1.3.1.cmml" xref="S4.SS7.p1.3.m3.1.1.3"></divide><cn id="S4.SS7.p1.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS7.p1.3.m3.1.1.3.2">1</cn><ci id="S4.SS7.p1.3.m3.1.1.3.3.cmml" xref="S4.SS7.p1.3.m3.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.3.m3.1c">\omega=\frac{1}{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.3.m3.1d">italic_ω = divide start_ARG 1 end_ARG start_ARG italic_T end_ARG</annotation></semantics></math> since we do not want the accumulated stop bonus reward to become larger than the correctness reward. The return function <math alttext="R^{\prime\prime}(\tau)" class="ltx_Math" display="inline" id="S4.SS7.p1.4.m4.1"><semantics id="S4.SS7.p1.4.m4.1a"><mrow id="S4.SS7.p1.4.m4.1.2" xref="S4.SS7.p1.4.m4.1.2.cmml"><msup id="S4.SS7.p1.4.m4.1.2.2" xref="S4.SS7.p1.4.m4.1.2.2.cmml"><mi id="S4.SS7.p1.4.m4.1.2.2.2" xref="S4.SS7.p1.4.m4.1.2.2.2.cmml">R</mi><mo id="S4.SS7.p1.4.m4.1.2.2.3" xref="S4.SS7.p1.4.m4.1.2.2.3.cmml">′′</mo></msup><mo id="S4.SS7.p1.4.m4.1.2.1" xref="S4.SS7.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S4.SS7.p1.4.m4.1.2.3.2" xref="S4.SS7.p1.4.m4.1.2.cmml"><mo id="S4.SS7.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S4.SS7.p1.4.m4.1.2.cmml">(</mo><mi id="S4.SS7.p1.4.m4.1.1" xref="S4.SS7.p1.4.m4.1.1.cmml">τ</mi><mo id="S4.SS7.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S4.SS7.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.4.m4.1b"><apply id="S4.SS7.p1.4.m4.1.2.cmml" xref="S4.SS7.p1.4.m4.1.2"><times id="S4.SS7.p1.4.m4.1.2.1.cmml" xref="S4.SS7.p1.4.m4.1.2.1"></times><apply id="S4.SS7.p1.4.m4.1.2.2.cmml" xref="S4.SS7.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS7.p1.4.m4.1.2.2.1.cmml" xref="S4.SS7.p1.4.m4.1.2.2">superscript</csymbol><ci id="S4.SS7.p1.4.m4.1.2.2.2.cmml" xref="S4.SS7.p1.4.m4.1.2.2.2">𝑅</ci><ci id="S4.SS7.p1.4.m4.1.2.2.3.cmml" xref="S4.SS7.p1.4.m4.1.2.2.3">′′</ci></apply><ci id="S4.SS7.p1.4.m4.1.1.cmml" xref="S4.SS7.p1.4.m4.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.4.m4.1c">R^{\prime\prime}(\tau)</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.4.m4.1d">italic_R start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ( italic_τ )</annotation></semantics></math> for this model is shown as Fig <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A2.F6" title="Figure 6 ‣ Appendix B Return Function of FlexRetICR ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">6</span></a> in the Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A2" title="Appendix B Return Function of FlexRetICR ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">B</span></a>. For the fair comparison between FlexRetICR and RetICR, we set <math alttext="\gamma=1" class="ltx_Math" display="inline" id="S4.SS7.p1.5.m5.1"><semantics id="S4.SS7.p1.5.m5.1a"><mrow id="S4.SS7.p1.5.m5.1.1" xref="S4.SS7.p1.5.m5.1.1.cmml"><mi id="S4.SS7.p1.5.m5.1.1.2" xref="S4.SS7.p1.5.m5.1.1.2.cmml">γ</mi><mo id="S4.SS7.p1.5.m5.1.1.1" xref="S4.SS7.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS7.p1.5.m5.1.1.3" xref="S4.SS7.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.5.m5.1b"><apply id="S4.SS7.p1.5.m5.1.1.cmml" xref="S4.SS7.p1.5.m5.1.1"><eq id="S4.SS7.p1.5.m5.1.1.1.cmml" xref="S4.SS7.p1.5.m5.1.1.1"></eq><ci id="S4.SS7.p1.5.m5.1.1.2.cmml" xref="S4.SS7.p1.5.m5.1.1.2">𝛾</ci><cn id="S4.SS7.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS7.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.5.m5.1c">\gamma=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.5.m5.1d">italic_γ = 1</annotation></semantics></math> for FlexRetICR. The performance comparison between the three models is shown as Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.F4" title="Figure 4 ‣ 4.7 Ablation Studies ‣ 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">4</span></a>. From the figure, we can observe that FlexRetICR outperforms RetICR in 4 out of 6 cases, which indicates that introducing early stop rewards not only helps to use less demonstrations but also could be beneficial to the final performance. Finally, by comparing FlexSDR with the other two RL-Retrivers, we find that it achieves the best performance in 5 out of 6 scenarios, which proves the effectiveness of the step-wise reward design.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="446" id="S4.F4.sf1.g1" src="extracted/5679404/figure/gpt-ablation.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F4.sf1.3.2" style="font-size:90%;">GPT-3.5-turbo</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="446" id="S4.F4.sf2.g1" src="extracted/5679404/figure/llama3-ablation.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F4.sf2.3.2" style="font-size:90%;">Llama3-8B</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="446" id="S4.F4.sf3.g1" src="extracted/5679404/figure/mistral-ablation.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S4.F4.sf3.3.2" style="font-size:90%;">Mistral-7B</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.3.2" style="font-size:90%;">Performance of RetICL, FlexRetICL and FlexSDR with different LLMs.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8 </span>Case Studies</h3>
<div class="ltx_para" id="S4.SS8.p1">
<p class="ltx_p" id="S4.SS8.p1.1">In this section, we answer RQ4 by presenting the FlexSDR’s behavior when facing to knowledge concepts with different zero-shot accuracy. From Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#S4.F5" title="Figure 5 ‣ 4.8 Case Studies ‣ 4 Experiment ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">5</span></a>, we observe that there is a significant negative relationship between the knowledge-level accuracy at zero-shot performance and the number of demonstrations suggested by FlexSDR. This fact indicates that FlexSDR learns to retrieve fewer demonstrations for knowledge points that already perform well with no demonstration samples. Such a phenomenon provides evidence that FlexSDR learns how to provide an adaptive number of demonstrations to different knowledge concepts.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="445" id="S4.F5.sf1.g1" src="extracted/5679404/figure/gpt-3.5-maxlen-2.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F5.sf1.3.2" style="font-size:90%;">GPT-3.5-turbo</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="451" id="S4.F5.sf2.g1" src="extracted/5679404/figure/llama3-maxlen-2.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F5.sf2.3.2" style="font-size:90%;">Llama3-8B</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="451" id="S4.F5.sf3.g1" src="extracted/5679404/figure/mistral-maxlen-2.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S4.F5.sf3.3.2" style="font-size:90%;">Mistral-7B</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S4.F5.3.2" style="font-size:90%;">Zero-shot accuracy of different knowledge concepts with corresponding demonstration numbers on different LLMs. Each point in the figure represents a knowledge concept.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we present, KnowTS, a LLMs based knowledge-tagging system, which differs from prior machine learning models in its strong performance
while facing limited or even annotated data for knowledge-tagging tasks. Besides that, we further propose a novel RL-based demonstration retriever, FlexSDR, focusing on dynamically providing flexible lengths of demonstration samples to every question knowledge-matching query. To validate the effectiveness of KnowTS, we experiment with an expertly annotated knowledge concept question dataset, MathKnowCT. The experiment results demonstrate the effectiveness of FlexSDR, which enables KnowTS to achieve the best few-shot learning performance while using fewer demonstrations. At last, through the ablation study and case analyzing results, we demonstrate the effectiveness of each component in FlexSDR.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Jun-Ming Chen, Meng-Chang Chen, and Yeali S Sun.

</span>
<span class="ltx_bibblock">A tag based learning approach to knowledge acquisition for
constructing prior knowledge and enhancing student reading comprehension.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Computers &amp; Education</span>, 70:256–268, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Bo Sun, Yunzong Zhu, Yongkang Xiao, Rong Xiao, and Yungang Wei.

</span>
<span class="ltx_bibblock">Automatic question tagging with deep neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">IEEE Transactions on Learning Technologies</span>, 12(1):29–43, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Hugh L Burns and Charles G Capps.

</span>
<span class="ltx_bibblock">Intelligent tutoring systems: an introduction.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Foundations of intelligent tutoring systems</span>, 1, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Xiao Zhang, Meng Liu, Jianhua Yin, Zhaochun Ren, and Liqiang Nie.

</span>
<span class="ltx_bibblock">Question tagging via graph-guided ranking.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">ACM Transactions on Information Systems (TOIS)</span>, 40(1):1–23,
2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Wei Du, Haiyan Zhu, and Teeraporn Saeheaw.

</span>
<span class="ltx_bibblock">Application of the lda model to semantic annotation of web-based
english educational resources.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Journal of web engineering</span>, 20(4):1113–1136, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Tao Huang, Shengze Hu, Huali Yang, Jing Geng, Sannyuya Liu, Hao Zhang, and
Zongkai Yang.

</span>
<span class="ltx_bibblock">Pqsct: Pseudo-siamese bert for concept tagging with both questions
and solutions.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">IEEE Transactions on Learning Technologies</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya,
Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman,
Shyamal Anadkat, et al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2303.08774</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Xinyi Wang, Wanrong Zhu, Michael Saxon, Mark Steyvers, and William Yang Wang.

</span>
<span class="ltx_bibblock">Large language models are implicitly topic models: Explaining and
finding good demonstrations for in-context learning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Workshop on Efficient Systems for Foundation Models@
ICML2023</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Bo Sun, Yunzong Zhu, Yongkang Xiao, Rong Xiao, and Yungang Wei.

</span>
<span class="ltx_bibblock">Automatic question tagging with deep neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">IEEE Transactions on Learning Technologies</span>, 12(1):29–43, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Qi Liu, Zhenya Huang, Yu Yin, Enhong Chen, Hui Xiong, Yu Su, and Guoping Hu.

</span>
<span class="ltx_bibblock">Ekt: Exercise-aware knowledge tracing for student performance
prediction, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
T. Huang, M. Liang, H. Yang, Z. Li, T. Yu, and S. Hu.

</span>
<span class="ltx_bibblock">Context-aware knowledge tracing integrated with the exercise
representation and association in mathematics.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">Proceedings of the International Educational Data Mining
Society</span>, volume 1, pages 360–366, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Zhenya Huang, Qi Liu, Weibo Gao, Jinze Wu, Yu Yin, Hao Wang, and Enhong Chen.

</span>
<span class="ltx_bibblock">Neural mathematical solver with enhanced formula structure.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 43rd International ACM SIGIR Conference on
Research and Development in Information Retrieval</span>, SIGIR ’20, page
1729–1732, New York, NY, USA, 2020. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Yury Zemlyanskiy, Sudeep Gandhe, Ruining He, Bhargav Kanagal, Anirudh Ravula,
Juraj Gottweis, Fei Sha, and Ilya Eckstein.

</span>
<span class="ltx_bibblock">Docent: Learning self-supervised entity representations from large
document collections, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Tao Huang, Shengze Hu, Huali Yang, Jing Geng, Sannyuya Liu, Hao Zhang, and
Zongkai Yang.

</span>
<span class="ltx_bibblock">Pqsct: Pseudo-siamese bert for concept tagging with both questions
and solutions.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">IEEE Transactions on Learning Technologies</span>, 16(5):831–846,
2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Advances in neural information processing systems</span>,
33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Ohad Rubin, Jonathan Herzig, and Jonathan Berant.

</span>
<span class="ltx_bibblock">Learning to retrieve prompts for in-context learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2112.08633</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Nils Reimers and Iryna Gurevych.

</span>
<span class="ltx_bibblock">Sentence-bert: Sentence embeddings using siamese bert-networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:1908.10084</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Jiachang Liu, Dinghan Shen, Yizhe Zhang, Bill Dolan, Lawrence Carin, and Weizhu
Chen.

</span>
<span class="ltx_bibblock">What makes good in-context examples for gpt-<math alttext="3" class="ltx_Math" display="inline" id="bib.bib18.1.m1.1"><semantics id="bib.bib18.1.m1.1a"><mn id="bib.bib18.1.m1.1.1" xref="bib.bib18.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="bib.bib18.1.m1.1b"><cn id="bib.bib18.1.m1.1.1.cmml" type="integer" xref="bib.bib18.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="bib.bib18.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="bib.bib18.1.m1.1d">3</annotation></semantics></math>?

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.2.1">arXiv preprint arXiv:2101.06804</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Alexander Scarlatos and Andrew Lan.

</span>
<span class="ltx_bibblock">Reticl: Sequential retrieval of in-context examples with
reinforcement learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2305.14502</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Pan Lu, Liang Qiu, Kai-Wei Chang, Ying Nian Wu, Song-Chun Zhu, Tanmay
Rajpurohit, Peter Clark, and Ashwin Kalyan.

</span>
<span class="ltx_bibblock">Dynamic prompt learning via policy gradient for semi-structured
mathematical reasoning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2209.14610</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Jason Wei, Maarten Bosma, Vincent Y Zhao, Kelvin Guu, Adams Wei Yu, Brian
Lester, Nan Du, Andrew M Dai, and Quoc V Le.

</span>
<span class="ltx_bibblock">Finetuned language models are zero-shot learners.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2109.01652</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V
Le, Denny Zhou, et al.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language
models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Advances in Neural Information Processing Systems</span>,
35:24824–24837, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Fei Zhao, Taotian Pang, Zhen Wu, Zheng Ma, Shujian Huang, and Xinyu Dai.

</span>
<span class="ltx_bibblock">Dynamic demonstrations controller for in-context learning.

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Alex Graves and Alex Graves.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Supervised sequence labelling with recurrent neural networks</span>,
pages 37–45, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Richard S Sutton and Andrew G Barto.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Reinforcement learning: An introduction</span>.

</span>
<span class="ltx_bibblock">MIT press, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:1810.04805</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, and Peter J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Journal of machine learning research</span>, 21(140):1–67, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer
Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized bert pretraining approach.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:1907.11692</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Ronald J Williams.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following algorithms for connectionist
reinforcement learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">Machine learning</span>, 8:229–256, 1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2307.09288</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Albert Q Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch, Blanche
Savary, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Emma Bou
Hanna, Florian Bressand, et al.

</span>
<span class="ltx_bibblock">Mixtral of experts.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2401.04088</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Vijay Konda and John Tsitsiklis.

</span>
<span class="ltx_bibblock">Actor-critic algorithms.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Advances in neural information processing systems</span>, 12, 1999.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>MathKnowCT Details</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">The detailed statistics about MathKnowCT is shown in Tabel <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A1.T4" title="Table 4 ‣ Appendix A MathKnowCT Details ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">4</span></a>. Overall, there are 2,349 samples covering 24 knowledge concepts of math study for student from Grade 1 to Grade3. The example knowledge definitions and questions are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13885v1#A3.T6" title="Table 6 ‣ Appendix C LLMs Implementation Details ‣ Knowledge Tagging System on Math Questions via LLMs with Flexible Demonstration Retriever"><span class="ltx_text ltx_ref_tag">6</span></a>. More details can be found from the <a class="ltx_ref ltx_url ltx_font_typewriter" href="link" title="">link</a>.</p>
</div>
<figure class="ltx_table" id="A1.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T4.2.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="A1.T4.3.2" style="font-size:90%;">Detailed sample statistics for different knowledge concepts in MathKnowCT.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T4.4" style="width:433.6pt;height:190.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-49.1pt,21.6pt) scale(0.815414744403638,0.815414744403638) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T4.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T4.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A1.T4.4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T4.4.1.1.1.1.1">Knowledge ID</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.4.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.T4.4.1.1.1.2.1">Total Size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.4.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A1.T4.4.1.1.1.3.1">Positive Size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T4.4.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A1.T4.4.1.1.1.4.1">Negative Size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A1.T4.4.1.1.1.5"><span class="ltx_text ltx_font_bold" id="A1.T4.4.1.1.1.5.1">Knowledge ID</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.4.1.1.1.6"><span class="ltx_text ltx_font_bold" id="A1.T4.4.1.1.1.6.1">Total Size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.4.1.1.1.7"><span class="ltx_text ltx_font_bold" id="A1.T4.4.1.1.1.7.1">Positive Size</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.4.1.1.1.8"><span class="ltx_text ltx_font_bold" id="A1.T4.4.1.1.1.8.1">Negative Size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.4.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A1.T4.4.1.2.1.1">x02030701</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.4.1.2.1.2">100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.4.1.2.1.3">25</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T4.4.1.2.1.4">75</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A1.T4.4.1.2.1.5">x07020402</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.4.1.2.1.6">87</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.4.1.2.1.7">29</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T4.4.1.2.1.8">58</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.3.2.1">x02021101</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.3.2.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.3.2.3">40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.3.2.4">60</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.3.2.5">x07020502</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.3.2.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.3.2.7">50</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.3.2.8">50</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.4.3.1">x06020104</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.4.3.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.4.3.3">40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.4.3.4">60</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.4.3.5">x20050401</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.4.3.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.4.3.7">50</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.4.3.8">50</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.5.4.1">x02061003</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.5.4.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.5.4.3">16</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.5.4.4">84</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.5.4.5">x09020509</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.5.4.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.5.4.7">50</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.5.4.8">50</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.6.5.1">x48040202</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.6.5.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.6.5.3">29</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.6.5.4">71</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.6.5.5">x07020314</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.6.5.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.6.5.7">30</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.6.5.8">70</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.7.6.1">x11041602</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.7.6.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.7.6.3">24</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.7.6.4">76</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.7.6.5">x01010201</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.7.6.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.7.6.7">50</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.7.6.8">50</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.8.7.1">x04030501</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.8.7.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.8.7.3">48</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.8.7.4">52</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.8.7.5">x11040205</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.8.7.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.8.7.7">26</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.8.7.8">74</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.9.8.1">x04030601</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.9.8.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.9.8.3">23</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.9.8.4">77</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.9.8.5">x11040203</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.9.8.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.9.8.7">22</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.9.8.8">78</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.10.9.1">x07010103</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.10.9.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.10.9.3">50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.10.9.4">50</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.10.9.5">x11040202</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.10.9.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.10.9.7">25</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.10.9.8">75</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.11.10.1">x06030101</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.11.10.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.11.10.3">44</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.11.10.4">56</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.11.10.5">x02040502</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.11.10.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.11.10.7">44</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.11.10.8">56</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.12.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.12.11.1">x57130902</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.12.11.2">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.12.11.3">35</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.1.12.11.4">65</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A1.T4.4.1.12.11.5">x47060201</th>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.12.11.6">100</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.1.12.11.7">17</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T4.4.1.12.11.8">83</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.13.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A1.T4.4.1.13.12.1">x20041003</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.4.1.13.12.2">62</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.4.1.13.12.3">50</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A1.T4.4.1.13.12.4">12</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A1.T4.4.1.13.12.5">x20070401</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.4.1.13.12.6">100</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.4.1.13.12.7">47</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T4.4.1.13.12.8">53</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Return Function of FlexRetICR</h2>
<figure class="ltx_figure" id="A2.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="378" id="A2.F6.sf1.g1" src="extracted/5679404/figure/R_O.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F6.sf1.6.2.1" style="font-size:90%;">(a)</span> </span><math alttext="R(\tau)" class="ltx_Math" display="inline" id="A2.F6.sf1.3.m1.1"><semantics id="A2.F6.sf1.3.m1.1b"><mrow id="A2.F6.sf1.3.m1.1.2" xref="A2.F6.sf1.3.m1.1.2.cmml"><mi id="A2.F6.sf1.3.m1.1.2.2" mathsize="90%" xref="A2.F6.sf1.3.m1.1.2.2.cmml">R</mi><mo id="A2.F6.sf1.3.m1.1.2.1" xref="A2.F6.sf1.3.m1.1.2.1.cmml">⁢</mo><mrow id="A2.F6.sf1.3.m1.1.2.3.2" xref="A2.F6.sf1.3.m1.1.2.cmml"><mo id="A2.F6.sf1.3.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="A2.F6.sf1.3.m1.1.2.cmml">(</mo><mi id="A2.F6.sf1.3.m1.1.1" mathsize="90%" xref="A2.F6.sf1.3.m1.1.1.cmml">τ</mi><mo id="A2.F6.sf1.3.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="A2.F6.sf1.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.sf1.3.m1.1c"><apply id="A2.F6.sf1.3.m1.1.2.cmml" xref="A2.F6.sf1.3.m1.1.2"><times id="A2.F6.sf1.3.m1.1.2.1.cmml" xref="A2.F6.sf1.3.m1.1.2.1"></times><ci id="A2.F6.sf1.3.m1.1.2.2.cmml" xref="A2.F6.sf1.3.m1.1.2.2">𝑅</ci><ci id="A2.F6.sf1.3.m1.1.1.cmml" xref="A2.F6.sf1.3.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.sf1.3.m1.1d">R(\tau)</annotation><annotation encoding="application/x-llamapun" id="A2.F6.sf1.3.m1.1e">italic_R ( italic_τ )</annotation></semantics></math><span class="ltx_text" id="A2.F6.sf1.4.1" style="font-size:90%;"> with <math alttext="\gamma\in(0,1)" class="ltx_Math" display="inline" id="A2.F6.sf1.4.1.m1.2"><semantics id="A2.F6.sf1.4.1.m1.2b"><mrow id="A2.F6.sf1.4.1.m1.2.3" xref="A2.F6.sf1.4.1.m1.2.3.cmml"><mi id="A2.F6.sf1.4.1.m1.2.3.2" xref="A2.F6.sf1.4.1.m1.2.3.2.cmml">γ</mi><mo id="A2.F6.sf1.4.1.m1.2.3.1" xref="A2.F6.sf1.4.1.m1.2.3.1.cmml">∈</mo><mrow id="A2.F6.sf1.4.1.m1.2.3.3.2" xref="A2.F6.sf1.4.1.m1.2.3.3.1.cmml"><mo id="A2.F6.sf1.4.1.m1.2.3.3.2.1" stretchy="false" xref="A2.F6.sf1.4.1.m1.2.3.3.1.cmml">(</mo><mn id="A2.F6.sf1.4.1.m1.1.1" xref="A2.F6.sf1.4.1.m1.1.1.cmml">0</mn><mo id="A2.F6.sf1.4.1.m1.2.3.3.2.2" xref="A2.F6.sf1.4.1.m1.2.3.3.1.cmml">,</mo><mn id="A2.F6.sf1.4.1.m1.2.2" xref="A2.F6.sf1.4.1.m1.2.2.cmml">1</mn><mo id="A2.F6.sf1.4.1.m1.2.3.3.2.3" stretchy="false" xref="A2.F6.sf1.4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.sf1.4.1.m1.2c"><apply id="A2.F6.sf1.4.1.m1.2.3.cmml" xref="A2.F6.sf1.4.1.m1.2.3"><in id="A2.F6.sf1.4.1.m1.2.3.1.cmml" xref="A2.F6.sf1.4.1.m1.2.3.1"></in><ci id="A2.F6.sf1.4.1.m1.2.3.2.cmml" xref="A2.F6.sf1.4.1.m1.2.3.2">𝛾</ci><interval closure="open" id="A2.F6.sf1.4.1.m1.2.3.3.1.cmml" xref="A2.F6.sf1.4.1.m1.2.3.3.2"><cn id="A2.F6.sf1.4.1.m1.1.1.cmml" type="integer" xref="A2.F6.sf1.4.1.m1.1.1">0</cn><cn id="A2.F6.sf1.4.1.m1.2.2.cmml" type="integer" xref="A2.F6.sf1.4.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.sf1.4.1.m1.2d">\gamma\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="A2.F6.sf1.4.1.m1.2e">italic_γ ∈ ( 0 , 1 )</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="405" id="A2.F6.sf2.g1" src="extracted/5679404/figure/R_primeprime.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F6.sf2.6.2.1" style="font-size:90%;">(b)</span> </span><math alttext="R^{\prime\prime}(\tau)" class="ltx_Math" display="inline" id="A2.F6.sf2.3.m1.1"><semantics id="A2.F6.sf2.3.m1.1b"><mrow id="A2.F6.sf2.3.m1.1.2" xref="A2.F6.sf2.3.m1.1.2.cmml"><msup id="A2.F6.sf2.3.m1.1.2.2" xref="A2.F6.sf2.3.m1.1.2.2.cmml"><mi id="A2.F6.sf2.3.m1.1.2.2.2" mathsize="90%" xref="A2.F6.sf2.3.m1.1.2.2.2.cmml">R</mi><mo id="A2.F6.sf2.3.m1.1.2.2.3" mathsize="90%" xref="A2.F6.sf2.3.m1.1.2.2.3.cmml">′′</mo></msup><mo id="A2.F6.sf2.3.m1.1.2.1" xref="A2.F6.sf2.3.m1.1.2.1.cmml">⁢</mo><mrow id="A2.F6.sf2.3.m1.1.2.3.2" xref="A2.F6.sf2.3.m1.1.2.cmml"><mo id="A2.F6.sf2.3.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="A2.F6.sf2.3.m1.1.2.cmml">(</mo><mi id="A2.F6.sf2.3.m1.1.1" mathsize="90%" xref="A2.F6.sf2.3.m1.1.1.cmml">τ</mi><mo id="A2.F6.sf2.3.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="A2.F6.sf2.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.sf2.3.m1.1c"><apply id="A2.F6.sf2.3.m1.1.2.cmml" xref="A2.F6.sf2.3.m1.1.2"><times id="A2.F6.sf2.3.m1.1.2.1.cmml" xref="A2.F6.sf2.3.m1.1.2.1"></times><apply id="A2.F6.sf2.3.m1.1.2.2.cmml" xref="A2.F6.sf2.3.m1.1.2.2"><csymbol cd="ambiguous" id="A2.F6.sf2.3.m1.1.2.2.1.cmml" xref="A2.F6.sf2.3.m1.1.2.2">superscript</csymbol><ci id="A2.F6.sf2.3.m1.1.2.2.2.cmml" xref="A2.F6.sf2.3.m1.1.2.2.2">𝑅</ci><ci id="A2.F6.sf2.3.m1.1.2.2.3.cmml" xref="A2.F6.sf2.3.m1.1.2.2.3">′′</ci></apply><ci id="A2.F6.sf2.3.m1.1.1.cmml" xref="A2.F6.sf2.3.m1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.sf2.3.m1.1d">R^{\prime\prime}(\tau)</annotation><annotation encoding="application/x-llamapun" id="A2.F6.sf2.3.m1.1e">italic_R start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ( italic_τ )</annotation></semantics></math><span class="ltx_text" id="A2.F6.sf2.4.1" style="font-size:90%;"> with <math alttext="\omega=\frac{1}{2},\ \gamma\in(0,1)" class="ltx_Math" display="inline" id="A2.F6.sf2.4.1.m1.4"><semantics id="A2.F6.sf2.4.1.m1.4b"><mrow id="A2.F6.sf2.4.1.m1.4.4.2" xref="A2.F6.sf2.4.1.m1.4.4.3.cmml"><mrow id="A2.F6.sf2.4.1.m1.3.3.1.1" xref="A2.F6.sf2.4.1.m1.3.3.1.1.cmml"><mi id="A2.F6.sf2.4.1.m1.3.3.1.1.2" xref="A2.F6.sf2.4.1.m1.3.3.1.1.2.cmml">ω</mi><mo id="A2.F6.sf2.4.1.m1.3.3.1.1.1" xref="A2.F6.sf2.4.1.m1.3.3.1.1.1.cmml">=</mo><mfrac id="A2.F6.sf2.4.1.m1.3.3.1.1.3" xref="A2.F6.sf2.4.1.m1.3.3.1.1.3.cmml"><mn id="A2.F6.sf2.4.1.m1.3.3.1.1.3.2" xref="A2.F6.sf2.4.1.m1.3.3.1.1.3.2.cmml">1</mn><mn id="A2.F6.sf2.4.1.m1.3.3.1.1.3.3" xref="A2.F6.sf2.4.1.m1.3.3.1.1.3.3.cmml">2</mn></mfrac></mrow><mo id="A2.F6.sf2.4.1.m1.4.4.2.3" rspace="0.617em" xref="A2.F6.sf2.4.1.m1.4.4.3a.cmml">,</mo><mrow id="A2.F6.sf2.4.1.m1.4.4.2.2" xref="A2.F6.sf2.4.1.m1.4.4.2.2.cmml"><mi id="A2.F6.sf2.4.1.m1.4.4.2.2.2" xref="A2.F6.sf2.4.1.m1.4.4.2.2.2.cmml">γ</mi><mo id="A2.F6.sf2.4.1.m1.4.4.2.2.1" xref="A2.F6.sf2.4.1.m1.4.4.2.2.1.cmml">∈</mo><mrow id="A2.F6.sf2.4.1.m1.4.4.2.2.3.2" xref="A2.F6.sf2.4.1.m1.4.4.2.2.3.1.cmml"><mo id="A2.F6.sf2.4.1.m1.4.4.2.2.3.2.1" stretchy="false" xref="A2.F6.sf2.4.1.m1.4.4.2.2.3.1.cmml">(</mo><mn id="A2.F6.sf2.4.1.m1.1.1" xref="A2.F6.sf2.4.1.m1.1.1.cmml">0</mn><mo id="A2.F6.sf2.4.1.m1.4.4.2.2.3.2.2" xref="A2.F6.sf2.4.1.m1.4.4.2.2.3.1.cmml">,</mo><mn id="A2.F6.sf2.4.1.m1.2.2" xref="A2.F6.sf2.4.1.m1.2.2.cmml">1</mn><mo id="A2.F6.sf2.4.1.m1.4.4.2.2.3.2.3" stretchy="false" xref="A2.F6.sf2.4.1.m1.4.4.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.sf2.4.1.m1.4c"><apply id="A2.F6.sf2.4.1.m1.4.4.3.cmml" xref="A2.F6.sf2.4.1.m1.4.4.2"><csymbol cd="ambiguous" id="A2.F6.sf2.4.1.m1.4.4.3a.cmml" xref="A2.F6.sf2.4.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="A2.F6.sf2.4.1.m1.3.3.1.1.cmml" xref="A2.F6.sf2.4.1.m1.3.3.1.1"><eq id="A2.F6.sf2.4.1.m1.3.3.1.1.1.cmml" xref="A2.F6.sf2.4.1.m1.3.3.1.1.1"></eq><ci id="A2.F6.sf2.4.1.m1.3.3.1.1.2.cmml" xref="A2.F6.sf2.4.1.m1.3.3.1.1.2">𝜔</ci><apply id="A2.F6.sf2.4.1.m1.3.3.1.1.3.cmml" xref="A2.F6.sf2.4.1.m1.3.3.1.1.3"><divide id="A2.F6.sf2.4.1.m1.3.3.1.1.3.1.cmml" xref="A2.F6.sf2.4.1.m1.3.3.1.1.3"></divide><cn id="A2.F6.sf2.4.1.m1.3.3.1.1.3.2.cmml" type="integer" xref="A2.F6.sf2.4.1.m1.3.3.1.1.3.2">1</cn><cn id="A2.F6.sf2.4.1.m1.3.3.1.1.3.3.cmml" type="integer" xref="A2.F6.sf2.4.1.m1.3.3.1.1.3.3">2</cn></apply></apply><apply id="A2.F6.sf2.4.1.m1.4.4.2.2.cmml" xref="A2.F6.sf2.4.1.m1.4.4.2.2"><in id="A2.F6.sf2.4.1.m1.4.4.2.2.1.cmml" xref="A2.F6.sf2.4.1.m1.4.4.2.2.1"></in><ci id="A2.F6.sf2.4.1.m1.4.4.2.2.2.cmml" xref="A2.F6.sf2.4.1.m1.4.4.2.2.2">𝛾</ci><interval closure="open" id="A2.F6.sf2.4.1.m1.4.4.2.2.3.1.cmml" xref="A2.F6.sf2.4.1.m1.4.4.2.2.3.2"><cn id="A2.F6.sf2.4.1.m1.1.1.cmml" type="integer" xref="A2.F6.sf2.4.1.m1.1.1">0</cn><cn id="A2.F6.sf2.4.1.m1.2.2.cmml" type="integer" xref="A2.F6.sf2.4.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.sf2.4.1.m1.4d">\omega=\frac{1}{2},\ \gamma\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="A2.F6.sf2.4.1.m1.4e">italic_ω = divide start_ARG 1 end_ARG start_ARG 2 end_ARG , italic_γ ∈ ( 0 , 1 )</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F6.4.2.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="A2.F6.2.1" style="font-size:90%;">Return functions w/o and w/ stop bonus reward for FlexRetICR where <math alttext="T=2" class="ltx_Math" display="inline" id="A2.F6.2.1.m1.1"><semantics id="A2.F6.2.1.m1.1b"><mrow id="A2.F6.2.1.m1.1.1" xref="A2.F6.2.1.m1.1.1.cmml"><mi id="A2.F6.2.1.m1.1.1.2" xref="A2.F6.2.1.m1.1.1.2.cmml">T</mi><mo id="A2.F6.2.1.m1.1.1.1" xref="A2.F6.2.1.m1.1.1.1.cmml">=</mo><mn id="A2.F6.2.1.m1.1.1.3" xref="A2.F6.2.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.2.1.m1.1c"><apply id="A2.F6.2.1.m1.1.1.cmml" xref="A2.F6.2.1.m1.1.1"><eq id="A2.F6.2.1.m1.1.1.1.cmml" xref="A2.F6.2.1.m1.1.1.1"></eq><ci id="A2.F6.2.1.m1.1.1.2.cmml" xref="A2.F6.2.1.m1.1.1.2">𝑇</ci><cn id="A2.F6.2.1.m1.1.1.3.cmml" type="integer" xref="A2.F6.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.2.1.m1.1d">T=2</annotation><annotation encoding="application/x-llamapun" id="A2.F6.2.1.m1.1e">italic_T = 2</annotation></semantics></math>.</span></figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>LLMs Implementation Details</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">To be noticed in this paper, we choose to experiment only with each LLM’s instruct-tuned (chat-tuned) version as we observe that the instruct-tuned LLMs can better follow the given annotating instructions and generate the correct format responses. For each framework, we experiment with two-sized versions (small and large) and the prompt text is adjusted based on the preference of each LLM. We run our experiment with 8 * Nvidia A100 80G GPUs.</p>
</div>
<figure class="ltx_table" id="A3.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T5.2.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="A3.T5.3.2" style="font-size:90%;">Details about LLM implementation in this paper and source file links.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="A3.T5.4" style="width:433.6pt;height:139.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-34.2pt,11.0pt) scale(0.863735151841291,0.863735151841291) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T5.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T5.4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A3.T5.4.1.1.1.1">LLM</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A3.T5.4.1.1.1.2">Model ID</th>
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A3.T5.4.1.1.1.3">Details</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T5.4.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T5.4.1.2.1.1">GPT-Large</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T5.4.1.2.1.2">gpt-4-turbo-2024-04-09</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="A3.T5.4.1.2.1.3"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://platform.openai.com/docs/models/gpt-4-turbo-and-gpt-4" title="">https://platform.openai.com/docs/models/gpt-4-turbo-and-gpt-4</a></td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.1.3.2">
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.3.2.1">GPT-Base</td>
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.3.2.2">gpt-3.5-turbo-0125</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.4.1.3.2.3"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://platform.openai.com/docs/models/gpt-3-5-turbo" title="">https://platform.openai.com/docs/models/gpt-3-5-turbo</a></td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.1.4.3">
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.4.3.1">Llama3-Large</td>
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.4.3.2">Llama-3-70B-Instruct</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.4.1.4.3.3"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/meta-llama/Meta-Llama-3-70B-Instruct" title="">https://huggingface.co/meta-llama/Meta-Llama-3-70B-Instruct</a></td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.1.5.4">
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.5.4.1">Llama3-Base</td>
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.5.4.2">Llama-3-8B-Instruct</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.4.1.5.4.3"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct" title="">https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct</a></td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.1.6.5">
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.6.5.1">Mixtral-Large</td>
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.6.5.2">Mixtral-8x7B-Instruct-v0.1</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.4.1.6.5.3"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/mistralai/Mixtral-8x7B-Instruct-v0.1" title="">https://huggingface.co/mistralai/Mixtral-8x7B-Instruct-v0.1</a></td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.1.7.6">
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.7.6.1">Mixtral-Base</td>
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.7.6.2">Mistral-7B-Instruct-v0.2</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.4.1.7.6.3">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/mistralai/Mistral-7B-Instruct-v0." title="">https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.</a>2</td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.1.8.7">
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.8.7.1">Qwen1.5-Large</td>
<td class="ltx_td ltx_align_left" id="A3.T5.4.1.8.7.2">Qwen1.5-72B-Chat</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.4.1.8.7.3"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/Qwen/Qwen1.5-72B-Chat" title="">https://huggingface.co/Qwen/Qwen1.5-72B-Chat</a></td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.1.9.8">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T5.4.1.9.8.1">Qwen1.5-Base</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T5.4.1.9.8.2">Qwen1.5-7B-Chat</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" id="A3.T5.4.1.9.8.3"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/Qwen/Qwen1.5-7B-Chat" title="">https://huggingface.co/Qwen/Qwen1.5-7B-Chat</a></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="A3.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T6.2.1.1" style="font-size:90%;">Table 6</span>: </span><span class="ltx_text" id="A3.T6.3.2" style="font-size:90%;">Example knowledge definitions</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T6.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T6.4.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_tt" id="A3.T6.4.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.1.1.1.1">
<span class="ltx_p" id="A3.T6.4.1.1.1.1.1" style="width:86.7pt;">Knowledge ID</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A3.T6.4.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.1.1.2.1">
<span class="ltx_p" id="A3.T6.4.1.1.2.1.1" style="width:346.9pt;">Knowledge Definition</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T6.4.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A3.T6.4.2.1.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.2.1.1.1">
<span class="ltx_p" id="A3.T6.4.2.1.1.1.1" style="width:86.7pt;">x01010201</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T6.4.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.2.1.2.1">
<span class="ltx_p" id="A3.T6.4.2.1.2.1.1" style="width:346.9pt;">Learn the definitions of the following types of numbers, including integers, odd numbers, even numbers, fractions, decimals, positive numbers, negative numbers, and natural numbers. Common related question types include the following: (1) Select a number of a specified type from a given set of numbers; (2) Determine whether a number is within the defined range; (3) Determine whether a proposition about the classification of numbers is true or false.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T6.4.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A3.T6.4.3.2.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.3.2.1.1">
<span class="ltx_p" id="A3.T6.4.3.2.1.1.1" style="width:86.7pt;">x02021101</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T6.4.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.3.2.2.1">
<span class="ltx_p" id="A3.T6.4.3.2.2.1.1" style="width:346.9pt;">Learn the relationship between natural numbers within 5. Common related question types include the following: (1) Sorting numbers by size; (2) Comparing numbers. Also note: the question stem does not contain addition, subtraction, multiplication, or division formulas.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T6.4.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A3.T6.4.4.3.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.4.3.1.1">
<span class="ltx_p" id="A3.T6.4.4.3.1.1.1" style="width:86.7pt;">x02040502</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T6.4.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.4.3.2.1">
<span class="ltx_p" id="A3.T6.4.4.3.2.1.1" style="width:346.9pt;">Learn the composition of two-digit numbers less than or equal to 100 (how many tens and how many ones). Common related question types include the following: (1) Convert a two-digit number into a combination of tens and ones; (2) Fill in the corresponding two-digit number based on the combination of tens and ones.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T6.4.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A3.T6.4.5.4.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.5.4.1.1">
<span class="ltx_p" id="A3.T6.4.5.4.1.1.1" style="width:86.7pt;">x02061003</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T6.4.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.5.4.2.1">
<span class="ltx_p" id="A3.T6.4.5.4.2.1.1" style="width:346.9pt;">Learn to use 3 or 4 digits to form a three-digit or four-digit number, and judge the size relationship between the digits. Related question types are limited to the following: (1) Use 3 digits to form a three-digit number smaller than a certain number. Find the total number of such three-digit numbers, the largest number, and the smallest number. Each digit can only be used once in the combination process. (2) Knowing that the sum of the digits in each digit of a four-digit number is a certain number, find the largest number and the smallest number of this four-digit number.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T6.4.6.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A3.T6.4.6.5.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.6.5.1.1">
<span class="ltx_p" id="A3.T6.4.6.5.1.1.1" style="width:86.7pt;">x04030501</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T6.4.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.6.5.2.1">
<span class="ltx_p" id="A3.T6.4.6.5.2.1.1" style="width:346.9pt;">Learn to calculate the reciprocal of a number. Common related question types include the following: (1) Calculate the reciprocal of one or more given numbers; (2) Given an equation where the product of a number and a blank is 1, find the value of the number that can be filled in the blank.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T6.4.7.6">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A3.T6.4.7.6.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.7.6.1.1">
<span class="ltx_p" id="A3.T6.4.7.6.1.1.1" style="width:86.7pt;">x48040202</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T6.4.7.6.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.7.6.2.1">
<span class="ltx_p" id="A3.T6.4.7.6.2.1.1" style="width:346.9pt;">Learn how to estimate the total purchase price of three items in a shopping scenario. Common related question types include the following: (1) Given the prices of three items (each item can be a three-digit or two-digit price), but at least one of the items has a three-digit price, calculate the approximate total purchase price of the three items; (2) Calculate both the approximate and exact total purchase price of the three items;</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T6.4.8.7">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="A3.T6.4.8.7.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.8.7.1.1">
<span class="ltx_p" id="A3.T6.4.8.7.1.1.1" style="width:86.7pt;">x57130902</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="A3.T6.4.8.7.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T6.4.8.7.2.1">
<span class="ltx_p" id="A3.T6.4.8.7.2.1.1" style="width:346.9pt;">Learn to solve feasible combinations by enumeration. Common related question types include the following: (1) Given a numerical value of a total quantity demanded (e.g., total quantity of goods transported, total price), and the numerical value that each option can provide (e.g., the loading capacity of trucks of different sizes, coins of different denominations), solve the option combination that just meets the total quantity demanded. Also note that the numbers in the question stem are all integers, and the numerical value of each option in the combination cannot be wasted (e.g., each truck must be fully loaded, and no change is given for the currency). In the problem-solving process, no more than 15 feasible combinations should be enumerated.</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Jun 19 23:24:52 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
