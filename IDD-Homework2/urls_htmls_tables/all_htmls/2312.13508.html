<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2312.13508] Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast</title><meta property="og:description" content="In real-world scenarios, the challenge of random modality missing in multimodal federated learning (mFL) hampers the development of federated frameworks and significantly diminishes model inference accuracy.
However, e…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2312.13508">

<!--Generated on Tue Feb 27 12:30:26 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Learning,  Multimodal Learning,  Prototype Learning">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Multimodal Federated Learning with Missing Modality 
<br class="ltx_break">via Prototype Mask and Contrast</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Guangyin Bao
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qi Zhang
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Duoqian Miao
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zixuan Gong
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Liang Hu
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ke Liu
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yang Liu
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chongyang Shi
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In real-world scenarios, the challenge of random modality missing in multimodal federated learning (mFL) hampers the development of federated frameworks and significantly diminishes model inference accuracy.
However, existing mFL methods are predominantly limited to specific scenarios with either unimodal clients or complete multimodal clients. They typically create modality-specific encoders on clients and train modality fusion modules on servers, suffering from severe task drift between clients and servers and struggling to generalize effectively in intricate modality-missing scenarios.
In this paper, we introduce a prototype library into the FedAvg-based Federated Learning framework, thereby enabling mFL to alleviate the task drift and performance degradation resulting from modality missing during both training and inference.
The proposed method utilizes prototypes as masks representing missing modalities to formulate a task-calibrated training loss and a model-agnostic uni-modality inference strategy.
In addition, a proximal term based on prototypes is constructed to enhance local training.
Extensive experiments demonstrate the state-of-the-art performance of our approach across a series of missingness settings.
Code is available at <a target="_blank" href="https://github.com/BaoGuangYin/PmcmFL" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/BaoGuangYin/PmcmFL</a>.</p>
</div>
<div class="ltx_keywords">Federated Learning, Multimodal Learning, Prototype Learning
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Multimodal pre-trained models have exhibited superior performance in various downstream tasks <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib32" title="" class="ltx_ref">2023b</a>; Yu et al., <a href="#bib.bib34" title="" class="ltx_ref">2022</a>; Chen et al., <a href="#bib.bib4" title="" class="ltx_ref">2023b</a>)</cite>, with the availability of large-scale data being a major contributing factor.
However, collecting large-scale data in practical applications may result in privacy leakage.
An alternative approach is to adopt a decentralized machine learning paradigm, such as federated learning (FL).
In FL <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite>, distributed clients collaborate to train a global model without sharing their private datasets.
However, it faces practical challenges when dealing with complex real-world multimodal data.
One such challenge is the widely-existing issue of missing modalities.
The presence of missing modalities on each client poses constraints on local training thereby leading to a significant drop in global model inference accuracy.
Furthermore, the non-independent and identically distributed (non-IID) nature of data among clients <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib39" title="" class="ltx_ref">2021</a>; Mendieta et al., <a href="#bib.bib23" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib16" title="" class="ltx_ref">2020</a>; Huang et al., <a href="#bib.bib11" title="" class="ltx_ref">2022</a>; Qu et al., <a href="#bib.bib25" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite> sharpens the challenges of modality missing, highlighting the urgent need to address the issue in practical multimodal data.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/figure1-1.png" id="S1.F1.sf1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="184" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S1.F1.sf1.3.2" class="ltx_text" style="font-size:80%;">Differences in task scenarios.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/figure1-2.png" id="S1.F1.sf2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="161" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S1.F1.sf2.3.2" class="ltx_text" style="font-size:80%;">Differences in model architectures.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
Illustration of differences between our work and previous works.
For <span id="S1.F1.3.1" class="ltx_text ltx_font_bold">task scenarios</span>, previous works consider unimodal clients and modality-complete multimodal clients.
In contrast, our task scenario involves the possibility of partial modalities being missing on each client.
In addition, the difference lies in whether the server includes a training set or not.
For <span id="S1.F1.4.2" class="ltx_text ltx_font_bold">model architectures</span>, previous works train modality-specific encoders for each modality and then train the modality fusion module on the server.
In contrast, we develop local models with the interactive-encoder architecture encompassing modality encoding and fusion.
</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Some pioneer works <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib35" title="" class="ltx_ref">2023</a>; Zhao et al., <a href="#bib.bib38" title="" class="ltx_ref">2022</a>; Chen &amp; Zhang, <a href="#bib.bib3" title="" class="ltx_ref">2022</a>; Feng et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite> attempt to carry out multimodal federated learning with missing modalities. These approaches employ modality-specific encoders for each modality, such as visual encoders for images and language encoders for text, and train them using unimodal or self-supervised training tasks. These local encoders are then either aggregated into a global encoder <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite>, or the global encoder is trained by aligning the local encoders through knowledge distillation (KD) on public data <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite>.
To perform downstream tasks that require modality fusion, the server needs additional training data to train a modality fusion module and a downstream task head.
These previous works focused on simple scenarios of modality missing, consisting of unimodal clients and modality-complete multimodal clients (as shown in Figure <a href="#S1.F1.sf1" title="Figure 1(a) ‣ Figure 1 ‣ 1 Introduction ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>).
However, it is common for each client to have partial data with missing modalities <cite class="ltx_cite ltx_citemacro_citep">(Feng et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>, leading to more intricate practical scenarios.
An example is observed in social media platforms where users generate three types of data: images only, text only, and image-text pairs.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Facing such intricate scenarios of modality missing, the existing multimodal FL frameworks encounter the following issues:
1) Clients cannot obtain fused representations due to only modality-specific encoders being deployed.
2) Severe task drift occurs between clients and server, e.g., image/text classification on clients but visual question answering (VQA) on the server, resulting in inconsistent optimization directions.
3) Lack of any strategy for addressing modality missing.
4) The availability of the server’s downstream task datasets has also been controversial in FL.
These motivate us to propose a new general multimodal FL framework for real-world modality missing and fused representations learning.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we aim to empower the FL framework with the ability to handle intricate modality-missing scenarios during both training and inference.
Moreover, we develop modality-interactive encoders and fusion modules for each client to avoid the necessity of training data on the server (cf. Figure <a href="#S1.F1.sf2" title="Figure 1(b) ‣ Figure 1 ‣ 1 Introduction ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>).
To this end, we need to address three challenges:
CH1. How to handle complex missing patterns for interactive encoder?
CH2. How to perform representation fusion when data is non-IID and modalities are missing?
CH3. How to ensure the performance of the global model when there are missing modalities during inference?</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Specifically, we innovatively utilize the flexible Multiway Transformers <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib32" title="" class="ltx_ref">2023b</a>; Peng et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>; Bao et al., <a href="#bib.bib1" title="" class="ltx_ref">2022</a>)</cite> to construct our multimodal encoders.
By selecting different modality expert networks, Multiway Transformers can serve as both modality-specific encoders and interactive encoders, thereby adapting to complex patterns of modality missing (CH1).
Inspired by prototype learning in FL <cite class="ltx_cite ltx_citemacro_citep">(Liao et al., <a href="#bib.bib17" title="" class="ltx_ref">2023</a>; Lyu et al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>; Huang et al., <a href="#bib.bib12" title="" class="ltx_ref">2023</a>; Dai et al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>; Xu et al., <a href="#bib.bib33" title="" class="ltx_ref">2023</a>; Chen et al., <a href="#bib.bib2" title="" class="ltx_ref">2023a</a>)</cite>, we propose a novel prototype-based multimodal FL framework, termed <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">PmcmFL</span> (<span id="S1.p5.1.2" class="ltx_text ltx_font_bold">P</span>rototype <span id="S1.p5.1.3" class="ltx_text ltx_font_bold">M</span>ask and <span id="S1.p5.1.4" class="ltx_text ltx_font_bold">C</span>ontrast for <span id="S1.p5.1.5" class="ltx_text ltx_font_bold">M</span>ultimodal <span id="S1.p5.1.6" class="ltx_text ltx_font_bold">FL</span>) to achieve fused representation learning with non-IID data and missing modalities (CH2).
In PmcmFL, we construct and maintain a prototype library.
During training, the prototypes act as global prior knowledge of the missing modality to compensate for cross-modal fusion and calibrate task drift.
The prototype library also introduces a proximal item based on prototypes to reduce heterogeneity among clients.
Consequently, we utilize prototypes for inference with missing modalities (CH3), where various matching algorithms are elaborately introduced to identify the prototype with the closest semantics.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Our experiments show that PmcmFL achieves state-of-the-art performance.
Notably, it brings 0.2-3.7% accuracy improvements across different modality missing rates.
Regarding inference with missing modalities, it achieves a remarkable 23.8% accuracy improvement.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">The main contributions are summarized below:</p>
</div>
<div id="S1.p8" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Our work stands out as the first attempt to empower our FL framework with the capability to alleviate the global model performance degradation resulting from modality missing during both training and inference.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose PmcmFL to achieve task-calibrated training and higher inference accuracy when dealing with modality-incomplete data.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">To the best of our knowledge, we are the first to adopt Multiway Transformer as a versatile encoder to address the complex patterns of modality missing.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<figure id="S2.F2" class="ltx_figure"><img src="/html/2312.13508/assets/pic/figure2.png" id="S2.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="509" height="285" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An overview of the proposed PmcmFL. We choose low-dimension representations to construct the prototype library (in Sec.<a href="#S3.SS2" title="3.2 Constructing Prototype Library ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>). Based on this, prototypes act as masks to aid training and inference with missing modalities (in Sec.<a href="#S3.SS3" title="3.3 Prototypes as Masks of Missing Modalities ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>). Besides, we utilize prototypes to construct contrastive loss for better learning of fused representations (in Sec.<a href="#S3.SS4" title="3.4 Prototypes as Learned Representation Targets ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>).</figcaption>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Multimodal Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Multimodal learning has attracted increasing attention from the research community.
The model with dual-encoder architecture <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite> uses separate encoders for each modality, with shallow modality interaction.
On the contrary, the models with interactive-encoder architecture <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib32" title="" class="ltx_ref">2023b</a>; Kim et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> process input from different modalities and concentrate on modeling modality interactions via fuse tokens without modality-specific encoders.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">In order to overcome the missing modality issue in multimodal learning, many methods have been developed.
Ma et al. <cite class="ltx_cite ltx_citemacro_citep">(Ma et al., <a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite> propose the SMIL to train a feature reconstruction network using a meta-learning algorithm.
Zhao et al. <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite> propose the MMIN to learn robust multimodal representations by training cascade residual autoencoders.
Ma et al. <cite class="ltx_cite ltx_citemacro_citep">(Ma et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite> enhance the robustness of Transformer through multi-task learning and optimal fusion strategy search.
Wang et al. <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib31" title="" class="ltx_ref">2023a</a>)</cite> propose the ShaSpec to generate features of missing modalities using a shared encoder.
These methods have introduced additional branches and complex training algorithms to the model, which are unsuitable for FL.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Federated Learning with Prototype</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Prototype refers to the centroid of the instances belonging to the identical class <cite class="ltx_cite ltx_citemacro_citep">(Snell et al., <a href="#bib.bib28" title="" class="ltx_ref">2017</a>)</cite>.
Due to its scalability, prototypes are widely used to solve various problems in FL <cite class="ltx_cite ltx_citemacro_citep">(Liao et al., <a href="#bib.bib17" title="" class="ltx_ref">2023</a>; Lyu et al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>; Liu et al., <a href="#bib.bib18" title="" class="ltx_ref">2023</a>; Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite>.
Tan et al. <cite class="ltx_cite ltx_citemacro_citep">(Tan et al., <a href="#bib.bib29" title="" class="ltx_ref">2022</a>)</cite> propose FedProto to conduct FL using prototypes rather than aggregation.
Huang et al. <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib12" title="" class="ltx_ref">2023</a>)</cite> utilize prototypes to solve domain shift in FL.
Dai et al. <cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite> utilize prototypes to alleviate the performance decline caused by heterogeneous data in FL.
Some other FL frameworks <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a href="#bib.bib33" title="" class="ltx_ref">2023</a>; Chen et al., <a href="#bib.bib2" title="" class="ltx_ref">2023a</a>)</cite>, while not explicitly mentioning prototypes, still leverage the concept of prototypes to address corresponding issues.
In this paper, we primarily utilize prototypes to address modality missing issues.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Multimodal Federated Learning</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Combining multimodal learning with federated learning is a novel research problem, with the key challenge being how to perform modality interactions when there are missing modalities for each client.
Zhao et al. <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite> propose FedIoT to train autoencoders for each modality on every client and give more aggregation weight to multimodal clients.
Chen et al. <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; Zhang, <a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite> propose FedMSplit to construct a dynamic graph for adaptively selecting multimodal client models where some modalities may be missing.
Yu et al. <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite> propose CreamFL to conduct cross-modal interaction using inter-modal and intra-modal contrast.
However, these studies only considered scenarios involving either unimodal or modality-complete multimodal clients.
Feng et al. <cite class="ltx_cite ltx_citemacro_citep">(Feng et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite> propose FedMultimodal as the first attempt to consider scenarios where modalities of partial data may be missing on each client.
They address this by masking the missing modalities using zero tensors.
In this paper, we consider scenarios similar to FedMultimodal, with a focus on an efficient and versatile method for addressing modality missing.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.13" class="ltx_p">We consider a federated learning setting including <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N</annotation></semantics></math> multimodal clients.
Without loss of generality, we take images and text as instances of multimodal data.
In Appendix <a href="#A1" title="Appendix A Extend to Other Multimodal Tasks ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>, we analyze how to generalize our framework to other multimodal tasks.
We decouple the model architecture into a representation encoder <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{E}</annotation></semantics></math>, a deep fusion layer <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{F}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{F}</annotation></semantics></math>, and a task head <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{G}</annotation></semantics></math>.
In each image-text pair, the image or text will be missing with a probability of <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\rho</annotation></semantics></math>.
In this case, all the images can be denoted as <math id="S3.SS1.p1.6.m6.2" class="ltx_Math" alttext="\mathcal{I}_{n}=\{(i_{nk},y_{nk})\}_{k=1}^{|\mathcal{I}_{n}|}" display="inline"><semantics id="S3.SS1.p1.6.m6.2a"><mrow id="S3.SS1.p1.6.m6.2.2" xref="S3.SS1.p1.6.m6.2.2.cmml"><msub id="S3.SS1.p1.6.m6.2.2.3" xref="S3.SS1.p1.6.m6.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.2.2.3.2" xref="S3.SS1.p1.6.m6.2.2.3.2.cmml">ℐ</mi><mi id="S3.SS1.p1.6.m6.2.2.3.3" xref="S3.SS1.p1.6.m6.2.2.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.6.m6.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.cmml">=</mo><msubsup id="S3.SS1.p1.6.m6.2.2.1" xref="S3.SS1.p1.6.m6.2.2.1.cmml"><mrow id="S3.SS1.p1.6.m6.2.2.1.1.1.1" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">i</mi><mrow id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.1" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.4" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.1" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.5" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.6.m6.2.2.1.1.3" xref="S3.SS1.p1.6.m6.2.2.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.3.2" xref="S3.SS1.p1.6.m6.2.2.1.1.3.2.cmml">k</mi><mo id="S3.SS1.p1.6.m6.2.2.1.1.3.1" xref="S3.SS1.p1.6.m6.2.2.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.6.m6.2.2.1.1.3.3" xref="S3.SS1.p1.6.m6.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.6.m6.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.1.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.6.m6.1.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2.cmml">ℐ</mi><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p1.6.m6.1.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.2b"><apply id="S3.SS1.p1.6.m6.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2"><eq id="S3.SS1.p1.6.m6.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2"></eq><apply id="S3.SS1.p1.6.m6.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.3.1.cmml" xref="S3.SS1.p1.6.m6.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.3.2.cmml" xref="S3.SS1.p1.6.m6.2.2.3.2">ℐ</ci><ci id="S3.SS1.p1.6.m6.2.2.3.3.cmml" xref="S3.SS1.p1.6.m6.2.2.3.3">𝑛</ci></apply><apply id="S3.SS1.p1.6.m6.2.2.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1">superscript</csymbol><apply id="S3.SS1.p1.6.m6.2.2.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1">subscript</csymbol><set id="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1"><interval closure="open" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2"><apply id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3"><times id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.2">𝑦</ci><apply id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3"><times id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.1"></times><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.2">𝑛</ci><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.1.1.2.2.3.3">𝑘</ci></apply></apply></interval></set><apply id="S3.SS1.p1.6.m6.2.2.1.1.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3"><eq id="S3.SS1.p1.6.m6.2.2.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3.1"></eq><ci id="S3.SS1.p1.6.m6.2.2.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.6.m6.2.2.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.6.m6.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1"><abs id="S3.SS1.p1.6.m6.1.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.2"></abs><apply id="S3.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2">ℐ</ci><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.2c">\mathcal{I}_{n}=\{(i_{nk},y_{nk})\}_{k=1}^{|\mathcal{I}_{n}|}</annotation></semantics></math>, where <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="i_{nk}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">i</mi><mrow id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.1.1.3.1" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑖</ci><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><times id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.1"></times><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">𝑛</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">i_{nk}</annotation></semantics></math> is the <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">k</annotation></semantics></math>-th image on the <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">n</annotation></semantics></math>-th client, <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="y_{nk}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">y</mi><mrow id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.m10.1.1.3.1" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑦</ci><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><times id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3.1"></times><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">𝑛</ci><ci id="S3.SS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">y_{nk}</annotation></semantics></math> is its corresponding label.
Similarly, all the text can be denoted as <math id="S3.SS1.p1.11.m11.2" class="ltx_Math" alttext="\mathcal{T}_{n}=\{(t_{nk},y_{nk})\}_{k=1}^{|\mathcal{T}_{n}|}" display="inline"><semantics id="S3.SS1.p1.11.m11.2a"><mrow id="S3.SS1.p1.11.m11.2.2" xref="S3.SS1.p1.11.m11.2.2.cmml"><msub id="S3.SS1.p1.11.m11.2.2.3" xref="S3.SS1.p1.11.m11.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m11.2.2.3.2" xref="S3.SS1.p1.11.m11.2.2.3.2.cmml">𝒯</mi><mi id="S3.SS1.p1.11.m11.2.2.3.3" xref="S3.SS1.p1.11.m11.2.2.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.11.m11.2.2.2" xref="S3.SS1.p1.11.m11.2.2.2.cmml">=</mo><msubsup id="S3.SS1.p1.11.m11.2.2.1" xref="S3.SS1.p1.11.m11.2.2.1.cmml"><mrow id="S3.SS1.p1.11.m11.2.2.1.1.1.1" xref="S3.SS1.p1.11.m11.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.2.cmml">t</mi><mrow id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.1" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.4" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.1" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.5" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.11.m11.2.2.1.1.3" xref="S3.SS1.p1.11.m11.2.2.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.2.2.1.1.3.2" xref="S3.SS1.p1.11.m11.2.2.1.1.3.2.cmml">k</mi><mo id="S3.SS1.p1.11.m11.2.2.1.1.3.1" xref="S3.SS1.p1.11.m11.2.2.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.11.m11.2.2.1.1.3.3" xref="S3.SS1.p1.11.m11.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.11.m11.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m11.1.1.1.1.2" xref="S3.SS1.p1.11.m11.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.11.m11.1.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m11.1.1.1.1.1.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.2.cmml">𝒯</mi><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p1.11.m11.1.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.2b"><apply id="S3.SS1.p1.11.m11.2.2.cmml" xref="S3.SS1.p1.11.m11.2.2"><eq id="S3.SS1.p1.11.m11.2.2.2.cmml" xref="S3.SS1.p1.11.m11.2.2.2"></eq><apply id="S3.SS1.p1.11.m11.2.2.3.cmml" xref="S3.SS1.p1.11.m11.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.2.3.1.cmml" xref="S3.SS1.p1.11.m11.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.2.2.3.2.cmml" xref="S3.SS1.p1.11.m11.2.2.3.2">𝒯</ci><ci id="S3.SS1.p1.11.m11.2.2.3.3.cmml" xref="S3.SS1.p1.11.m11.2.2.3.3">𝑛</ci></apply><apply id="S3.SS1.p1.11.m11.2.2.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.2.1.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1">superscript</csymbol><apply id="S3.SS1.p1.11.m11.2.2.1.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.2.1.1.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1">subscript</csymbol><set id="S3.SS1.p1.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1"><interval closure="open" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2"><apply id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.2">𝑡</ci><apply id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3"><times id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.2">𝑦</ci><apply id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3"><times id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.1"></times><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.2">𝑛</ci><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.3.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.1.1.2.2.3.3">𝑘</ci></apply></apply></interval></set><apply id="S3.SS1.p1.11.m11.2.2.1.1.3.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.3"><eq id="S3.SS1.p1.11.m11.2.2.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.3.1"></eq><ci id="S3.SS1.p1.11.m11.2.2.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.11.m11.2.2.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.11.m11.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1"><abs id="S3.SS1.p1.11.m11.1.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.2"></abs><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.2">𝒯</ci><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.2c">\mathcal{T}_{n}=\{(t_{nk},y_{nk})\}_{k=1}^{|\mathcal{T}_{n}|}</annotation></semantics></math>, and all the image-text pairs can be denoted as <math id="S3.SS1.p1.12.m12.2" class="ltx_Math" alttext="\mathcal{M}_{n}=\{(i_{nk},t_{nk},y_{nk})\}_{k=1}^{|\mathcal{M}_{n}|}" display="inline"><semantics id="S3.SS1.p1.12.m12.2a"><mrow id="S3.SS1.p1.12.m12.2.2" xref="S3.SS1.p1.12.m12.2.2.cmml"><msub id="S3.SS1.p1.12.m12.2.2.3" xref="S3.SS1.p1.12.m12.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.2.2.3.2" xref="S3.SS1.p1.12.m12.2.2.3.2.cmml">ℳ</mi><mi id="S3.SS1.p1.12.m12.2.2.3.3" xref="S3.SS1.p1.12.m12.2.2.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.12.m12.2.2.2" xref="S3.SS1.p1.12.m12.2.2.2.cmml">=</mo><msubsup id="S3.SS1.p1.12.m12.2.2.1" xref="S3.SS1.p1.12.m12.2.2.1.cmml"><mrow id="S3.SS1.p1.12.m12.2.2.1.1.1.1" xref="S3.SS1.p1.12.m12.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.4" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.4.cmml">(</mo><msub id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.2.cmml">i</mi><mrow id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.1" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.5" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.1" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.6" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.2.cmml">y</mi><mrow id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.1" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.7" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.4.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.12.m12.2.2.1.1.3" xref="S3.SS1.p1.12.m12.2.2.1.1.3.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.3.2" xref="S3.SS1.p1.12.m12.2.2.1.1.3.2.cmml">k</mi><mo id="S3.SS1.p1.12.m12.2.2.1.1.3.1" xref="S3.SS1.p1.12.m12.2.2.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.12.m12.2.2.1.1.3.3" xref="S3.SS1.p1.12.m12.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.12.m12.1.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.12.m12.1.1.1.1.2" xref="S3.SS1.p1.12.m12.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.12.m12.1.1.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.1.1.1.1.1.2" xref="S3.SS1.p1.12.m12.1.1.1.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.12.m12.1.1.1.1.1.3" xref="S3.SS1.p1.12.m12.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p1.12.m12.1.1.1.1.3" xref="S3.SS1.p1.12.m12.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.2b"><apply id="S3.SS1.p1.12.m12.2.2.cmml" xref="S3.SS1.p1.12.m12.2.2"><eq id="S3.SS1.p1.12.m12.2.2.2.cmml" xref="S3.SS1.p1.12.m12.2.2.2"></eq><apply id="S3.SS1.p1.12.m12.2.2.3.cmml" xref="S3.SS1.p1.12.m12.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.2.3.1.cmml" xref="S3.SS1.p1.12.m12.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.2.2.3.2.cmml" xref="S3.SS1.p1.12.m12.2.2.3.2">ℳ</ci><ci id="S3.SS1.p1.12.m12.2.2.3.3.cmml" xref="S3.SS1.p1.12.m12.2.2.3.3">𝑛</ci></apply><apply id="S3.SS1.p1.12.m12.2.2.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.2.1.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1">superscript</csymbol><apply id="S3.SS1.p1.12.m12.2.2.1.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.2.1.1.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1">subscript</csymbol><set id="S3.SS1.p1.12.m12.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1"><vector id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3"><apply id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3"><times id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3"><times id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.1"></times><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.2">𝑛</ci><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.2.2.3.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.2">𝑦</ci><apply id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3"><times id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.1"></times><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.1.1.3.3.3.3">𝑘</ci></apply></apply></vector></set><apply id="S3.SS1.p1.12.m12.2.2.1.1.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.3"><eq id="S3.SS1.p1.12.m12.2.2.1.1.3.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.3.1"></eq><ci id="S3.SS1.p1.12.m12.2.2.1.1.3.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.12.m12.2.2.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.12.m12.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1"><abs id="S3.SS1.p1.12.m12.1.1.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.2"></abs><apply id="S3.SS1.p1.12.m12.1.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1.2">ℳ</ci><ci id="S3.SS1.p1.12.m12.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.2c">\mathcal{M}_{n}=\{(i_{nk},t_{nk},y_{nk})\}_{k=1}^{|\mathcal{M}_{n}|}</annotation></semantics></math>.
Furthermore, each client develops a local model <math id="S3.SS1.p1.13.m13.3" class="ltx_Math" alttext="(\mathcal{E}_{n},\mathcal{F}_{n},\mathcal{G}_{n}),n\in[1\dots N]" display="inline"><semantics id="S3.SS1.p1.13.m13.3a"><mrow id="S3.SS1.p1.13.m13.3.3" xref="S3.SS1.p1.13.m13.3.3.cmml"><mrow id="S3.SS1.p1.13.m13.2.2.1.1" xref="S3.SS1.p1.13.m13.2.2.1.2.cmml"><mrow id="S3.SS1.p1.13.m13.2.2.1.1.1.3" xref="S3.SS1.p1.13.m13.2.2.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS1.p1.13.m13.2.2.1.1.1.3.4" xref="S3.SS1.p1.13.m13.2.2.1.1.1.4.cmml">(</mo><msub id="S3.SS1.p1.13.m13.2.2.1.1.1.1.1" xref="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.3" xref="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S3.SS1.p1.13.m13.2.2.1.1.1.3.5" xref="S3.SS1.p1.13.m13.2.2.1.1.1.4.cmml">,</mo><msub id="S3.SS1.p1.13.m13.2.2.1.1.1.2.2" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.2" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.2.cmml">ℱ</mi><mi id="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.3" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.3.cmml">n</mi></msub><mo id="S3.SS1.p1.13.m13.2.2.1.1.1.3.6" xref="S3.SS1.p1.13.m13.2.2.1.1.1.4.cmml">,</mo><msub id="S3.SS1.p1.13.m13.2.2.1.1.1.3.3" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.2" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.2.cmml">𝒢</mi><mi id="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.3" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p1.13.m13.2.2.1.1.1.3.7" xref="S3.SS1.p1.13.m13.2.2.1.1.1.4.cmml">)</mo></mrow><mo id="S3.SS1.p1.13.m13.2.2.1.1.2" xref="S3.SS1.p1.13.m13.2.2.1.2.cmml">,</mo><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">n</mi></mrow><mo id="S3.SS1.p1.13.m13.3.3.3" xref="S3.SS1.p1.13.m13.3.3.3.cmml">∈</mo><mrow id="S3.SS1.p1.13.m13.3.3.2.1" xref="S3.SS1.p1.13.m13.3.3.2.2.cmml"><mo stretchy="false" id="S3.SS1.p1.13.m13.3.3.2.1.2" xref="S3.SS1.p1.13.m13.3.3.2.2.1.cmml">[</mo><mrow id="S3.SS1.p1.13.m13.3.3.2.1.1" xref="S3.SS1.p1.13.m13.3.3.2.1.1.cmml"><mn id="S3.SS1.p1.13.m13.3.3.2.1.1.2" xref="S3.SS1.p1.13.m13.3.3.2.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.SS1.p1.13.m13.3.3.2.1.1.1" xref="S3.SS1.p1.13.m13.3.3.2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS1.p1.13.m13.3.3.2.1.1.3" xref="S3.SS1.p1.13.m13.3.3.2.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.13.m13.3.3.2.1.1.1a" xref="S3.SS1.p1.13.m13.3.3.2.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.13.m13.3.3.2.1.1.4" xref="S3.SS1.p1.13.m13.3.3.2.1.1.4.cmml">N</mi></mrow><mo stretchy="false" id="S3.SS1.p1.13.m13.3.3.2.1.3" xref="S3.SS1.p1.13.m13.3.3.2.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.3b"><apply id="S3.SS1.p1.13.m13.3.3.cmml" xref="S3.SS1.p1.13.m13.3.3"><in id="S3.SS1.p1.13.m13.3.3.3.cmml" xref="S3.SS1.p1.13.m13.3.3.3"></in><list id="S3.SS1.p1.13.m13.2.2.1.2.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1"><vector id="S3.SS1.p1.13.m13.2.2.1.1.1.4.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3"><apply id="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.2">ℰ</ci><ci id="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.2">ℱ</ci><ci id="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.2.2.3">𝑛</ci></apply><apply id="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.2">𝒢</ci><ci id="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.3.cmml" xref="S3.SS1.p1.13.m13.2.2.1.1.1.3.3.3">𝑛</ci></apply></vector><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝑛</ci></list><apply id="S3.SS1.p1.13.m13.3.3.2.2.cmml" xref="S3.SS1.p1.13.m13.3.3.2.1"><csymbol cd="latexml" id="S3.SS1.p1.13.m13.3.3.2.2.1.cmml" xref="S3.SS1.p1.13.m13.3.3.2.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.13.m13.3.3.2.1.1.cmml" xref="S3.SS1.p1.13.m13.3.3.2.1.1"><times id="S3.SS1.p1.13.m13.3.3.2.1.1.1.cmml" xref="S3.SS1.p1.13.m13.3.3.2.1.1.1"></times><cn type="integer" id="S3.SS1.p1.13.m13.3.3.2.1.1.2.cmml" xref="S3.SS1.p1.13.m13.3.3.2.1.1.2">1</cn><ci id="S3.SS1.p1.13.m13.3.3.2.1.1.3.cmml" xref="S3.SS1.p1.13.m13.3.3.2.1.1.3">…</ci><ci id="S3.SS1.p1.13.m13.3.3.2.1.1.4.cmml" xref="S3.SS1.p1.13.m13.3.3.2.1.1.4">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.3c">(\mathcal{E}_{n},\mathcal{F}_{n},\mathcal{G}_{n}),n\in[1\dots N]</annotation></semantics></math>, with the same architecture as the global model.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">As shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, PmcmFL constructs or updates the prototype library on the server (operation ①) at the beginning of each federated communication round.
Subsequently, the prototype library and the global model are broadcast to all participants.
Then, each participating client performs local training and then updates local prototypes.
Using prototypes as masks of missing modalities, a task-calibrated training loss will supervise the training (operation ②).
Additionally, to tackle the non-IID issue and the resulting client drift, a prototype-based contrastive loss is proposed (operation ④).
Finally, all participating clients transmit their local models and local prototypes back to the server, after which the global model is updated by aggregating those local models.
During inference, the prototype library also assists inference with missing modalities by transmitting prototypes to the global model (operation ③).
The complete algorithm is in Appendix <a href="#A2" title="Appendix B Algorithm of PmcmFL ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">For local training, We use Multiway Transformer as encoder <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathcal{E}</annotation></semantics></math>.
This encoder <cite class="ltx_cite ltx_citemacro_citep">(Bao et al., <a href="#bib.bib1" title="" class="ltx_ref">2022</a>; Peng et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>; Wang et al., <a href="#bib.bib32" title="" class="ltx_ref">2023b</a>)</cite> handles different missing patterns by switching among various encoding modes.
When only image or text input exists, the multiway encoder functions as a modality-specific encoder, like ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> or BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>.
When inputting an image-text pair, the multiway encoder functions as an interactive encoder, enabling the representation of one modality to fuse information from the other modality.
More details on the Multiway Transformer are in Appendix <a href="#A3" title="Appendix C Details on Multiway Transformer ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Constructing Prototype Library</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Prototypes compact the semantics of data within the same class.
Considering communication overhead in FL, low-dimension representations are used to construct the prototype library.
As for the compacting strategy, we naively use the class centroids as the prototypes.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.8" class="ltx_p"><span id="S3.SS2.p2.8.1" class="ltx_text ltx_font_bold">Selecting Hidden Representations.</span>  
For <math id="S3.SS2.p2.1.m1.2" class="ltx_Math" alttext="(i_{nk},t_{nk})\in\mathcal{M}_{n}" display="inline"><semantics id="S3.SS2.p2.1.m1.2a"><mrow id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml"><mrow id="S3.SS2.p2.1.m1.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.2.2.2.2.3" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml">i</mi><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.1.1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS2.p2.1.m1.2.2.2.2.4" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.1.m1.2.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.cmml">t</mi><mrow id="S3.SS2.p2.1.m1.2.2.2.2.2.3" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.3.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.2.2.2.2.2.3.1" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.3.3" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p2.1.m1.2.2.2.2.5" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">)</mo></mrow><mo id="S3.SS2.p2.1.m1.2.2.3" xref="S3.SS2.p2.1.m1.2.2.3.cmml">∈</mo><msub id="S3.SS2.p2.1.m1.2.2.4" xref="S3.SS2.p2.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.2.2.4.2" xref="S3.SS2.p2.1.m1.2.2.4.2.cmml">ℳ</mi><mi id="S3.SS2.p2.1.m1.2.2.4.3" xref="S3.SS2.p2.1.m1.2.2.4.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.2b"><apply id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2"><in id="S3.SS2.p2.1.m1.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.3"></in><interval closure="open" id="S3.SS2.p2.1.m1.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2"><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2">𝑖</ci><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3"><times id="S3.SS2.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.2">𝑛</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2">𝑡</ci><apply id="S3.SS2.p2.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3"><times id="S3.SS2.p2.1.m1.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.2">𝑛</ci><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.3">𝑘</ci></apply></apply></interval><apply id="S3.SS2.p2.1.m1.2.2.4.cmml" xref="S3.SS2.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.4.1.cmml" xref="S3.SS2.p2.1.m1.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.4.2.cmml" xref="S3.SS2.p2.1.m1.2.2.4.2">ℳ</ci><ci id="S3.SS2.p2.1.m1.2.2.4.3.cmml" xref="S3.SS2.p2.1.m1.2.2.4.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.2c">(i_{nk},t_{nk})\in\mathcal{M}_{n}</annotation></semantics></math>, we denote <math id="S3.SS2.p2.2.m2.2" class="ltx_Math" alttext="\mathbb{H}_{nk}=\mathcal{E}_{n}(i_{nk},t_{nk})\in\mathbb{R}^{m\times d}" display="inline"><semantics id="S3.SS2.p2.2.m2.2a"><mrow id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml"><msub id="S3.SS2.p2.2.m2.2.2.4" xref="S3.SS2.p2.2.m2.2.2.4.cmml"><mi id="S3.SS2.p2.2.m2.2.2.4.2" xref="S3.SS2.p2.2.m2.2.2.4.2.cmml">ℍ</mi><mrow id="S3.SS2.p2.2.m2.2.2.4.3" xref="S3.SS2.p2.2.m2.2.2.4.3.cmml"><mi id="S3.SS2.p2.2.m2.2.2.4.3.2" xref="S3.SS2.p2.2.m2.2.2.4.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.2.m2.2.2.4.3.1" xref="S3.SS2.p2.2.m2.2.2.4.3.1.cmml">​</mo><mi id="S3.SS2.p2.2.m2.2.2.4.3.3" xref="S3.SS2.p2.2.m2.2.2.4.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS2.p2.2.m2.2.2.5" xref="S3.SS2.p2.2.m2.2.2.5.cmml">=</mo><mrow id="S3.SS2.p2.2.m2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.cmml"><msub id="S3.SS2.p2.2.m2.2.2.2.4" xref="S3.SS2.p2.2.m2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.2.2.2.4.2" xref="S3.SS2.p2.2.m2.2.2.2.4.2.cmml">ℰ</mi><mi id="S3.SS2.p2.2.m2.2.2.2.4.3" xref="S3.SS2.p2.2.m2.2.2.2.4.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.2.m2.2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.2.3.cmml">​</mo><mrow id="S3.SS2.p2.2.m2.2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.2.m2.2.2.2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.2.m2.1.1.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.2.cmml">i</mi><mrow id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS2.p2.2.m2.2.2.2.2.2.4" xref="S3.SS2.p2.2.m2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.2.m2.2.2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.2.m2.2.2.2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.2.cmml">t</mi><mrow id="S3.SS2.p2.2.m2.2.2.2.2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.2" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.1" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.3" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p2.2.m2.2.2.2.2.2.5" xref="S3.SS2.p2.2.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.2.m2.2.2.6" xref="S3.SS2.p2.2.m2.2.2.6.cmml">∈</mo><msup id="S3.SS2.p2.2.m2.2.2.7" xref="S3.SS2.p2.2.m2.2.2.7.cmml"><mi id="S3.SS2.p2.2.m2.2.2.7.2" xref="S3.SS2.p2.2.m2.2.2.7.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.2.m2.2.2.7.3" xref="S3.SS2.p2.2.m2.2.2.7.3.cmml"><mi id="S3.SS2.p2.2.m2.2.2.7.3.2" xref="S3.SS2.p2.2.m2.2.2.7.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.2.m2.2.2.7.3.1" xref="S3.SS2.p2.2.m2.2.2.7.3.1.cmml">×</mo><mi id="S3.SS2.p2.2.m2.2.2.7.3.3" xref="S3.SS2.p2.2.m2.2.2.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.2b"><apply id="S3.SS2.p2.2.m2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2"><and id="S3.SS2.p2.2.m2.2.2a.cmml" xref="S3.SS2.p2.2.m2.2.2"></and><apply id="S3.SS2.p2.2.m2.2.2b.cmml" xref="S3.SS2.p2.2.m2.2.2"><eq id="S3.SS2.p2.2.m2.2.2.5.cmml" xref="S3.SS2.p2.2.m2.2.2.5"></eq><apply id="S3.SS2.p2.2.m2.2.2.4.cmml" xref="S3.SS2.p2.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.4.1.cmml" xref="S3.SS2.p2.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.4.2.cmml" xref="S3.SS2.p2.2.m2.2.2.4.2">ℍ</ci><apply id="S3.SS2.p2.2.m2.2.2.4.3.cmml" xref="S3.SS2.p2.2.m2.2.2.4.3"><times id="S3.SS2.p2.2.m2.2.2.4.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.4.3.1"></times><ci id="S3.SS2.p2.2.m2.2.2.4.3.2.cmml" xref="S3.SS2.p2.2.m2.2.2.4.3.2">𝑛</ci><ci id="S3.SS2.p2.2.m2.2.2.4.3.3.cmml" xref="S3.SS2.p2.2.m2.2.2.4.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.p2.2.m2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2"><times id="S3.SS2.p2.2.m2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.3"></times><apply id="S3.SS2.p2.2.m2.2.2.2.4.cmml" xref="S3.SS2.p2.2.m2.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.2.4.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.2.4.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.4.2">ℰ</ci><ci id="S3.SS2.p2.2.m2.2.2.2.4.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.4.3">𝑛</ci></apply><interval closure="open" id="S3.SS2.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2"><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.3"><times id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.2">𝑛</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.2">𝑡</ci><apply id="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.3"><times id="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.2">𝑛</ci><ci id="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></apply></apply><apply id="S3.SS2.p2.2.m2.2.2c.cmml" xref="S3.SS2.p2.2.m2.2.2"><in id="S3.SS2.p2.2.m2.2.2.6.cmml" xref="S3.SS2.p2.2.m2.2.2.6"></in><share href="#S3.SS2.p2.2.m2.2.2.2.cmml" id="S3.SS2.p2.2.m2.2.2d.cmml" xref="S3.SS2.p2.2.m2.2.2"></share><apply id="S3.SS2.p2.2.m2.2.2.7.cmml" xref="S3.SS2.p2.2.m2.2.2.7"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.7.1.cmml" xref="S3.SS2.p2.2.m2.2.2.7">superscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.7.2.cmml" xref="S3.SS2.p2.2.m2.2.2.7.2">ℝ</ci><apply id="S3.SS2.p2.2.m2.2.2.7.3.cmml" xref="S3.SS2.p2.2.m2.2.2.7.3"><times id="S3.SS2.p2.2.m2.2.2.7.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.7.3.1"></times><ci id="S3.SS2.p2.2.m2.2.2.7.3.2.cmml" xref="S3.SS2.p2.2.m2.2.2.7.3.2">𝑚</ci><ci id="S3.SS2.p2.2.m2.2.2.7.3.3.cmml" xref="S3.SS2.p2.2.m2.2.2.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.2c">\mathbb{H}_{nk}=\mathcal{E}_{n}(i_{nk},t_{nk})\in\mathbb{R}^{m\times d}</annotation></semantics></math> as the output of the multiway transformer encoder, where <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">m</annotation></semantics></math> is the number of output tokens, and <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">d</annotation></semantics></math> is the dimension of each token.
The image CLS token <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="h_{nk}^{(i)}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msubsup id="S3.SS2.p2.5.m5.1.2" xref="S3.SS2.p2.5.m5.1.2.cmml"><mi id="S3.SS2.p2.5.m5.1.2.2.2" xref="S3.SS2.p2.5.m5.1.2.2.2.cmml">h</mi><mrow id="S3.SS2.p2.5.m5.1.2.2.3" xref="S3.SS2.p2.5.m5.1.2.2.3.cmml"><mi id="S3.SS2.p2.5.m5.1.2.2.3.2" xref="S3.SS2.p2.5.m5.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m5.1.2.2.3.1" xref="S3.SS2.p2.5.m5.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.5.m5.1.2.2.3.3" xref="S3.SS2.p2.5.m5.1.2.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS2.p2.5.m5.1.1.1.3" xref="S3.SS2.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.5.m5.1.1.1.3.1" xref="S3.SS2.p2.5.m5.1.2.cmml">(</mo><mi id="S3.SS2.p2.5.m5.1.1.1.1" xref="S3.SS2.p2.5.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.p2.5.m5.1.1.1.3.2" xref="S3.SS2.p2.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.2.cmml" xref="S3.SS2.p2.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2">superscript</csymbol><apply id="S3.SS2.p2.5.m5.1.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.2.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.2.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2">ℎ</ci><apply id="S3.SS2.p2.5.m5.1.2.2.3.cmml" xref="S3.SS2.p2.5.m5.1.2.2.3"><times id="S3.SS2.p2.5.m5.1.2.2.3.1.cmml" xref="S3.SS2.p2.5.m5.1.2.2.3.1"></times><ci id="S3.SS2.p2.5.m5.1.2.2.3.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2.3.2">𝑛</ci><ci id="S3.SS2.p2.5.m5.1.2.2.3.3.cmml" xref="S3.SS2.p2.5.m5.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.p2.5.m5.1.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">h_{nk}^{(i)}</annotation></semantics></math> and the text CLS token <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="h_{nk}^{(t)}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><msubsup id="S3.SS2.p2.6.m6.1.2" xref="S3.SS2.p2.6.m6.1.2.cmml"><mi id="S3.SS2.p2.6.m6.1.2.2.2" xref="S3.SS2.p2.6.m6.1.2.2.2.cmml">h</mi><mrow id="S3.SS2.p2.6.m6.1.2.2.3" xref="S3.SS2.p2.6.m6.1.2.2.3.cmml"><mi id="S3.SS2.p2.6.m6.1.2.2.3.2" xref="S3.SS2.p2.6.m6.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m6.1.2.2.3.1" xref="S3.SS2.p2.6.m6.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.6.m6.1.2.2.3.3" xref="S3.SS2.p2.6.m6.1.2.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS2.p2.6.m6.1.1.1.3" xref="S3.SS2.p2.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m6.1.1.1.3.1" xref="S3.SS2.p2.6.m6.1.2.cmml">(</mo><mi id="S3.SS2.p2.6.m6.1.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p2.6.m6.1.1.1.3.2" xref="S3.SS2.p2.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.2.cmml" xref="S3.SS2.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.2.1.cmml" xref="S3.SS2.p2.6.m6.1.2">superscript</csymbol><apply id="S3.SS2.p2.6.m6.1.2.2.cmml" xref="S3.SS2.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.2.2.1.cmml" xref="S3.SS2.p2.6.m6.1.2">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.2.2.2.cmml" xref="S3.SS2.p2.6.m6.1.2.2.2">ℎ</ci><apply id="S3.SS2.p2.6.m6.1.2.2.3.cmml" xref="S3.SS2.p2.6.m6.1.2.2.3"><times id="S3.SS2.p2.6.m6.1.2.2.3.1.cmml" xref="S3.SS2.p2.6.m6.1.2.2.3.1"></times><ci id="S3.SS2.p2.6.m6.1.2.2.3.2.cmml" xref="S3.SS2.p2.6.m6.1.2.2.3.2">𝑛</ci><ci id="S3.SS2.p2.6.m6.1.2.2.3.3.cmml" xref="S3.SS2.p2.6.m6.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.p2.6.m6.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">h_{nk}^{(t)}</annotation></semantics></math> are extracted from <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="\mathbb{H}_{nk}" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><msub id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">ℍ</mi><mrow id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml"><mi id="S3.SS2.p2.7.m7.1.1.3.2" xref="S3.SS2.p2.7.m7.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.7.m7.1.1.3.1" xref="S3.SS2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.7.m7.1.1.3.3" xref="S3.SS2.p2.7.m7.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">ℍ</ci><apply id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3"><times id="S3.SS2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.1"></times><ci id="S3.SS2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2">𝑛</ci><ci id="S3.SS2.p2.7.m7.1.1.3.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\mathbb{H}_{nk}</annotation></semantics></math>.
We select the two CLS tokens along with the fused representation, i.e., <math id="S3.SS2.p2.8.m8.5" class="ltx_Math" alttext="h_{nk}^{(f)}=\mathcal{F}_{n}(h_{nk}^{(i)},h_{nk}^{(t)})" display="inline"><semantics id="S3.SS2.p2.8.m8.5a"><mrow id="S3.SS2.p2.8.m8.5.5" xref="S3.SS2.p2.8.m8.5.5.cmml"><msubsup id="S3.SS2.p2.8.m8.5.5.4" xref="S3.SS2.p2.8.m8.5.5.4.cmml"><mi id="S3.SS2.p2.8.m8.5.5.4.2.2" xref="S3.SS2.p2.8.m8.5.5.4.2.2.cmml">h</mi><mrow id="S3.SS2.p2.8.m8.5.5.4.2.3" xref="S3.SS2.p2.8.m8.5.5.4.2.3.cmml"><mi id="S3.SS2.p2.8.m8.5.5.4.2.3.2" xref="S3.SS2.p2.8.m8.5.5.4.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m8.5.5.4.2.3.1" xref="S3.SS2.p2.8.m8.5.5.4.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.8.m8.5.5.4.2.3.3" xref="S3.SS2.p2.8.m8.5.5.4.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS2.p2.8.m8.1.1.1.3" xref="S3.SS2.p2.8.m8.5.5.4.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m8.1.1.1.3.1" xref="S3.SS2.p2.8.m8.5.5.4.cmml">(</mo><mi id="S3.SS2.p2.8.m8.1.1.1.1" xref="S3.SS2.p2.8.m8.1.1.1.1.cmml">f</mi><mo stretchy="false" id="S3.SS2.p2.8.m8.1.1.1.3.2" xref="S3.SS2.p2.8.m8.5.5.4.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p2.8.m8.5.5.3" xref="S3.SS2.p2.8.m8.5.5.3.cmml">=</mo><mrow id="S3.SS2.p2.8.m8.5.5.2" xref="S3.SS2.p2.8.m8.5.5.2.cmml"><msub id="S3.SS2.p2.8.m8.5.5.2.4" xref="S3.SS2.p2.8.m8.5.5.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.8.m8.5.5.2.4.2" xref="S3.SS2.p2.8.m8.5.5.2.4.2.cmml">ℱ</mi><mi id="S3.SS2.p2.8.m8.5.5.2.4.3" xref="S3.SS2.p2.8.m8.5.5.2.4.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m8.5.5.2.3" xref="S3.SS2.p2.8.m8.5.5.2.3.cmml">​</mo><mrow id="S3.SS2.p2.8.m8.5.5.2.2.2" xref="S3.SS2.p2.8.m8.5.5.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m8.5.5.2.2.2.3" xref="S3.SS2.p2.8.m8.5.5.2.2.3.cmml">(</mo><msubsup id="S3.SS2.p2.8.m8.4.4.1.1.1.1" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.cmml"><mi id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.2" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.2" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.1" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.3" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS2.p2.8.m8.2.2.1.3" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m8.2.2.1.3.1" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.cmml">(</mo><mi id="S3.SS2.p2.8.m8.2.2.1.1" xref="S3.SS2.p2.8.m8.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.p2.8.m8.2.2.1.3.2" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p2.8.m8.5.5.2.2.2.4" xref="S3.SS2.p2.8.m8.5.5.2.2.3.cmml">,</mo><msubsup id="S3.SS2.p2.8.m8.5.5.2.2.2.2" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.cmml"><mi id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.2" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.2.cmml">h</mi><mrow id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.2" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.1" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.3" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS2.p2.8.m8.3.3.1.3" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m8.3.3.1.3.1" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.cmml">(</mo><mi id="S3.SS2.p2.8.m8.3.3.1.1" xref="S3.SS2.p2.8.m8.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p2.8.m8.3.3.1.3.2" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS2.p2.8.m8.5.5.2.2.2.5" xref="S3.SS2.p2.8.m8.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.5b"><apply id="S3.SS2.p2.8.m8.5.5.cmml" xref="S3.SS2.p2.8.m8.5.5"><eq id="S3.SS2.p2.8.m8.5.5.3.cmml" xref="S3.SS2.p2.8.m8.5.5.3"></eq><apply id="S3.SS2.p2.8.m8.5.5.4.cmml" xref="S3.SS2.p2.8.m8.5.5.4"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.5.5.4.1.cmml" xref="S3.SS2.p2.8.m8.5.5.4">superscript</csymbol><apply id="S3.SS2.p2.8.m8.5.5.4.2.cmml" xref="S3.SS2.p2.8.m8.5.5.4"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.5.5.4.2.1.cmml" xref="S3.SS2.p2.8.m8.5.5.4">subscript</csymbol><ci id="S3.SS2.p2.8.m8.5.5.4.2.2.cmml" xref="S3.SS2.p2.8.m8.5.5.4.2.2">ℎ</ci><apply id="S3.SS2.p2.8.m8.5.5.4.2.3.cmml" xref="S3.SS2.p2.8.m8.5.5.4.2.3"><times id="S3.SS2.p2.8.m8.5.5.4.2.3.1.cmml" xref="S3.SS2.p2.8.m8.5.5.4.2.3.1"></times><ci id="S3.SS2.p2.8.m8.5.5.4.2.3.2.cmml" xref="S3.SS2.p2.8.m8.5.5.4.2.3.2">𝑛</ci><ci id="S3.SS2.p2.8.m8.5.5.4.2.3.3.cmml" xref="S3.SS2.p2.8.m8.5.5.4.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.p2.8.m8.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1">𝑓</ci></apply><apply id="S3.SS2.p2.8.m8.5.5.2.cmml" xref="S3.SS2.p2.8.m8.5.5.2"><times id="S3.SS2.p2.8.m8.5.5.2.3.cmml" xref="S3.SS2.p2.8.m8.5.5.2.3"></times><apply id="S3.SS2.p2.8.m8.5.5.2.4.cmml" xref="S3.SS2.p2.8.m8.5.5.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.5.5.2.4.1.cmml" xref="S3.SS2.p2.8.m8.5.5.2.4">subscript</csymbol><ci id="S3.SS2.p2.8.m8.5.5.2.4.2.cmml" xref="S3.SS2.p2.8.m8.5.5.2.4.2">ℱ</ci><ci id="S3.SS2.p2.8.m8.5.5.2.4.3.cmml" xref="S3.SS2.p2.8.m8.5.5.2.4.3">𝑛</ci></apply><interval closure="open" id="S3.SS2.p2.8.m8.5.5.2.2.3.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2"><apply id="S3.SS2.p2.8.m8.4.4.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.4.4.1.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.2">ℎ</ci><apply id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3"><times id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.1"></times><ci id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p2.8.m8.4.4.1.1.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.p2.8.m8.2.2.1.1.cmml" xref="S3.SS2.p2.8.m8.2.2.1.1">𝑖</ci></apply><apply id="S3.SS2.p2.8.m8.5.5.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.5.5.2.2.2.2.1.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.2">ℎ</ci><apply id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3"><times id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.2">𝑛</ci><ci id="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.8.m8.5.5.2.2.2.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.p2.8.m8.3.3.1.1.cmml" xref="S3.SS2.p2.8.m8.3.3.1.1">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.5c">h_{nk}^{(f)}=\mathcal{F}_{n}(h_{nk}^{(i)},h_{nk}^{(t)})</annotation></semantics></math>, for constructing prototypes.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.3" class="ltx_p"><span id="S3.SS2.p3.3.1" class="ltx_text ltx_font_bold">Construction and Update</span>  
In the prototype library, we construct and maintain three types of prototypes: image prototypes <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{P_{I}}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">ℐ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝒫</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathcal{P_{I}}</annotation></semantics></math>, text prototypes <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{P_{T}}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">𝒯</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝒫</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\mathcal{P_{T}}</annotation></semantics></math>, and fusion prototypes <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{P_{F}}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">ℱ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝒫</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">ℱ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\mathcal{P_{F}}</annotation></semantics></math>.
All prototypes are initialized with zero tensors or random tensors.
Subsequently, after local training in each federated communication round, all participating clients construct local prototypes by computing class centroids.
Finally, the global prototypes are aggregated from the local prototypes with numbers of client samples as weights.
The construction process is formalized as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\mathcal{P_{I}}_{n}^{j}=\sum_{k\in C_{n}^{j}}\frac{h_{nk}^{(i)}}{|C_{n}^{j}|},\quad\mathcal{P_{I}}^{j}=\sum_{n\in P_{c}}\frac{|\mathcal{I}_{n}|}{|\mathcal{D}|}\mathcal{P_{I}}_{n}^{j}," display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1"><mrow id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.3.cmml"><mrow id="S3.E1.m1.5.5.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.cmml"><mmultiscripts id="S3.E1.m1.5.5.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.1.1.1.2.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.3.cmml">ℐ</mi><mrow id="S3.E1.m1.5.5.1.1.1.1.2a" xref="S3.E1.m1.5.5.1.1.1.1.2.cmml"></mrow><mi id="S3.E1.m1.5.5.1.1.1.1.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.2.3.cmml">n</mi><mi id="S3.E1.m1.5.5.1.1.1.1.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.3.cmml">j</mi></mmultiscripts><mo rspace="0.111em" id="S3.E1.m1.5.5.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.3.cmml"><munder id="S3.E1.m1.5.5.1.1.1.1.3.1" xref="S3.E1.m1.5.5.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.5.5.1.1.1.1.3.1.2" xref="S3.E1.m1.5.5.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.3.1.3" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.3.1.3.2" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.2.cmml">k</mi><mo id="S3.E1.m1.5.5.1.1.1.1.3.1.3.1" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.1.cmml">∈</mo><msubsup id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.2" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.2.cmml">C</mi><mi id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.3" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.3.cmml">n</mi><mi id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.3" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.3.cmml">j</mi></msubsup></mrow></munder><mfrac id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><msubsup id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.3.2.cmml">h</mi><mrow id="S3.E1.m1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.3.3.1" xref="S3.E1.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.3.3.3.cmml">k</mi></mrow><mrow id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.cmml">)</mo></mrow></msubsup><mrow id="S3.E1.m1.2.2.2.1" xref="S3.E1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo><msubsup id="S3.E1.m1.2.2.2.1.1" xref="S3.E1.m1.2.2.2.1.1.cmml"><mi id="S3.E1.m1.2.2.2.1.1.2.2" xref="S3.E1.m1.2.2.2.1.1.2.2.cmml">C</mi><mi id="S3.E1.m1.2.2.2.1.1.2.3" xref="S3.E1.m1.2.2.2.1.1.2.3.cmml">n</mi><mi id="S3.E1.m1.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.1.1.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E1.m1.2.2.2.1.3" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><mo rspace="1.167em" id="S3.E1.m1.5.5.1.1.2.3" xref="S3.E1.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.cmml"><mmultiscripts id="S3.E1.m1.5.5.1.1.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.1.2.2.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.1.2.2.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.2.2.3.cmml">ℐ</mi><mrow id="S3.E1.m1.5.5.1.1.2.2.2a" xref="S3.E1.m1.5.5.1.1.2.2.2.cmml"></mrow><mrow id="S3.E1.m1.5.5.1.1.2.2.2b" xref="S3.E1.m1.5.5.1.1.2.2.2.cmml"></mrow><mi id="S3.E1.m1.5.5.1.1.2.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.2.3.cmml">j</mi></mmultiscripts><mo rspace="0.111em" id="S3.E1.m1.5.5.1.1.2.2.1" xref="S3.E1.m1.5.5.1.1.2.2.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.3.cmml"><munder id="S3.E1.m1.5.5.1.1.2.2.3.1" xref="S3.E1.m1.5.5.1.1.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.5.5.1.1.2.2.3.1.2" xref="S3.E1.m1.5.5.1.1.2.2.3.1.2.cmml">∑</mo><mrow id="S3.E1.m1.5.5.1.1.2.2.3.1.3" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.2.2.3.1.3.2" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.2.cmml">n</mi><mo id="S3.E1.m1.5.5.1.1.2.2.3.1.3.1" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.1.cmml">∈</mo><msub id="S3.E1.m1.5.5.1.1.2.2.3.1.3.3" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.cmml"><mi id="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.2" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.2.cmml">P</mi><mi id="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.3" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.3.cmml">c</mi></msub></mrow></munder><mrow id="S3.E1.m1.5.5.1.1.2.2.3.2" xref="S3.E1.m1.5.5.1.1.2.2.3.2.cmml"><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.2.1.cmml">|</mo><msub id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">ℐ</mi><mi id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="S3.E1.m1.4.4.2.3" xref="S3.E1.m1.4.4.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.2.3.1" xref="S3.E1.m1.4.4.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.2.1" xref="S3.E1.m1.4.4.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E1.m1.4.4.2.3.2" xref="S3.E1.m1.4.4.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.2.3.2.1" xref="S3.E1.m1.5.5.1.1.2.2.3.2.1.cmml">​</mo><mmultiscripts id="S3.E1.m1.5.5.1.1.2.2.3.2.2" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.3.cmml">ℐ</mi><mrow id="S3.E1.m1.5.5.1.1.2.2.3.2.2a" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.cmml"></mrow><mi id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.3.cmml">n</mi><mi id="S3.E1.m1.5.5.1.1.2.2.3.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.3.cmml">j</mi></mmultiscripts></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.3a.cmml" xref="S3.E1.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1"><eq id="S3.E1.m1.5.5.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1"></eq><apply id="S3.E1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2">𝒫</ci><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.3">ℐ</ci></apply><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.3">𝑛</ci></apply><ci id="S3.E1.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E1.m1.5.5.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3"><apply id="S3.E1.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.3.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E1.m1.5.5.1.1.1.1.3.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.2"></sum><apply id="S3.E1.m1.5.5.1.1.1.1.3.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3"><in id="S3.E1.m1.5.5.1.1.1.1.3.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.1"></in><ci id="S3.E1.m1.5.5.1.1.1.1.3.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.2">𝑘</ci><apply id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.2">𝐶</ci><ci id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.2.3">𝑛</ci></apply><ci id="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><divide id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2"></divide><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.3.2">ℎ</ci><apply id="S3.E1.m1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3"><times id="S3.E1.m1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.3.3.1"></times><ci id="S3.E1.m1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.3.3.2">𝑛</ci><ci id="S3.E1.m1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝑖</ci></apply><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.1"><abs id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1.2"></abs><apply id="S3.E1.m1.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1">superscript</csymbol><apply id="S3.E1.m1.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.2.1.cmml" xref="S3.E1.m1.2.2.2.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.2.1.1.2.2">𝐶</ci><ci id="S3.E1.m1.2.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.2.1.1.2.3">𝑛</ci></apply><ci id="S3.E1.m1.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.E1.m1.5.5.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2"><eq id="S3.E1.m1.5.5.1.1.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1"></eq><apply id="S3.E1.m1.5.5.1.1.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.2.2">𝒫</ci><ci id="S3.E1.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.2.3">ℐ</ci></apply><ci id="S3.E1.m1.5.5.1.1.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.3">𝑗</ci></apply><apply id="S3.E1.m1.5.5.1.1.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3"><apply id="S3.E1.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.3.1.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1">subscript</csymbol><sum id="S3.E1.m1.5.5.1.1.2.2.3.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1.2"></sum><apply id="S3.E1.m1.5.5.1.1.2.2.3.1.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3"><in id="S3.E1.m1.5.5.1.1.2.2.3.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.1"></in><ci id="S3.E1.m1.5.5.1.1.2.2.3.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.2">𝑛</ci><apply id="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.2">𝑃</ci><ci id="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.1.3.3.3">𝑐</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2"><times id="S3.E1.m1.5.5.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.1"></times><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><divide id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4"></divide><apply id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.1"><abs id="S3.E1.m1.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2"></abs><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2">ℐ</ci><ci id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.3"><abs id="S3.E1.m1.4.4.2.2.1.cmml" xref="S3.E1.m1.4.4.2.3.1"></abs><ci id="S3.E1.m1.4.4.2.1.cmml" xref="S3.E1.m1.4.4.2.1">𝒟</ci></apply></apply><apply id="S3.E1.m1.5.5.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.3.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2">subscript</csymbol><apply id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.2">𝒫</ci><ci id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.2.3">ℐ</ci></apply><ci id="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.2.3">𝑛</ci></apply><ci id="S3.E1.m1.5.5.1.1.2.2.3.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2.2.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\mathcal{P_{I}}_{n}^{j}=\sum_{k\in C_{n}^{j}}\frac{h_{nk}^{(i)}}{|C_{n}^{j}|},\quad\mathcal{P_{I}}^{j}=\sum_{n\in P_{c}}\frac{|\mathcal{I}_{n}|}{|\mathcal{D}|}\mathcal{P_{I}}_{n}^{j},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.5" class="ltx_Math" alttext="\mathcal{P_{T}}_{n}^{j}=\sum_{k\in C_{n}^{j}}\frac{h_{nk}^{(t)}}{|C_{n}^{j}|},\quad\mathcal{P_{T}}^{j}=\sum_{n\in P_{c}}\frac{|\mathcal{T}_{n}|}{|\mathcal{D}|}\mathcal{P_{T}}_{n}^{j}," display="block"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1"><mrow id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.3.cmml"><mrow id="S3.E2.m1.5.5.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.cmml"><mmultiscripts id="S3.E2.m1.5.5.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.1.1.2.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.1.1.2.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.2.2.2.3.cmml">𝒯</mi><mrow id="S3.E2.m1.5.5.1.1.1.1.2a" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml"></mrow><mi id="S3.E2.m1.5.5.1.1.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.cmml">n</mi><mi id="S3.E2.m1.5.5.1.1.1.1.2.3" xref="S3.E2.m1.5.5.1.1.1.1.2.3.cmml">j</mi></mmultiscripts><mo rspace="0.111em" id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.3.cmml"><munder id="S3.E2.m1.5.5.1.1.1.1.3.1" xref="S3.E2.m1.5.5.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.5.5.1.1.1.1.3.1.2" xref="S3.E2.m1.5.5.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.3.1.3" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.3.1.3.2" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.2.cmml">k</mi><mo id="S3.E2.m1.5.5.1.1.1.1.3.1.3.1" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.1.cmml">∈</mo><msubsup id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.2" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.2.cmml">C</mi><mi id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.3" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.3.cmml">n</mi><mi id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.3" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.3.cmml">j</mi></msubsup></mrow></munder><mfrac id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><msubsup id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml">h</mi><mrow id="S3.E2.m1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.3.3.3.cmml">k</mi></mrow><mrow id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.cmml">)</mo></mrow></msubsup><mrow id="S3.E2.m1.2.2.2.1" xref="S3.E2.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.1.cmml">|</mo><msubsup id="S3.E2.m1.2.2.2.1.1" xref="S3.E2.m1.2.2.2.1.1.cmml"><mi id="S3.E2.m1.2.2.2.1.1.2.2" xref="S3.E2.m1.2.2.2.1.1.2.2.cmml">C</mi><mi id="S3.E2.m1.2.2.2.1.1.2.3" xref="S3.E2.m1.2.2.2.1.1.2.3.cmml">n</mi><mi id="S3.E2.m1.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.1.1.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E2.m1.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><mo rspace="1.167em" id="S3.E2.m1.5.5.1.1.2.3" xref="S3.E2.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.5.5.1.1.2.2" xref="S3.E2.m1.5.5.1.1.2.2.cmml"><mmultiscripts id="S3.E2.m1.5.5.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.2.2.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.2.2.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.2.2.3.cmml">𝒯</mi><mrow id="S3.E2.m1.5.5.1.1.2.2.2a" xref="S3.E2.m1.5.5.1.1.2.2.2.cmml"></mrow><mrow id="S3.E2.m1.5.5.1.1.2.2.2b" xref="S3.E2.m1.5.5.1.1.2.2.2.cmml"></mrow><mi id="S3.E2.m1.5.5.1.1.2.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.2.3.cmml">j</mi></mmultiscripts><mo rspace="0.111em" id="S3.E2.m1.5.5.1.1.2.2.1" xref="S3.E2.m1.5.5.1.1.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.3.cmml"><munder id="S3.E2.m1.5.5.1.1.2.2.3.1" xref="S3.E2.m1.5.5.1.1.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.5.5.1.1.2.2.3.1.2" xref="S3.E2.m1.5.5.1.1.2.2.3.1.2.cmml">∑</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.3.1.3" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2.3.1.3.2" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.2.cmml">n</mi><mo id="S3.E2.m1.5.5.1.1.2.2.3.1.3.1" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.1.cmml">∈</mo><msub id="S3.E2.m1.5.5.1.1.2.2.3.1.3.3" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.2" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.2.cmml">P</mi><mi id="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.3" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.3.cmml">c</mi></msub></mrow></munder><mrow id="S3.E2.m1.5.5.1.1.2.2.3.2" xref="S3.E2.m1.5.5.1.1.2.2.3.2.cmml"><mfrac id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.2.1.cmml">|</mo><msub id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.2.cmml">𝒯</mi><mi id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="S3.E2.m1.4.4.2.3" xref="S3.E2.m1.4.4.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.2.3.1" xref="S3.E2.m1.4.4.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.2.1" xref="S3.E2.m1.4.4.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E2.m1.4.4.2.3.2" xref="S3.E2.m1.4.4.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.2.2.3.2.1" xref="S3.E2.m1.5.5.1.1.2.2.3.2.1.cmml">​</mo><mmultiscripts id="S3.E2.m1.5.5.1.1.2.2.3.2.2" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.3.cmml">𝒯</mi><mrow id="S3.E2.m1.5.5.1.1.2.2.3.2.2a" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.cmml"></mrow><mi id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.3.cmml">n</mi><mi id="S3.E2.m1.5.5.1.1.2.2.3.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.3.cmml">j</mi></mmultiscripts></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3a.cmml" xref="S3.E2.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1"><eq id="S3.E2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1"></eq><apply id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2">subscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.2.2">𝒫</ci><ci id="S3.E2.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.2.3">𝒯</ci></apply><ci id="S3.E2.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3">𝑛</ci></apply><ci id="S3.E2.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3"><apply id="S3.E2.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.3.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E2.m1.5.5.1.1.1.1.3.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.2"></sum><apply id="S3.E2.m1.5.5.1.1.1.1.3.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3"><in id="S3.E2.m1.5.5.1.1.1.1.3.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.1"></in><ci id="S3.E2.m1.5.5.1.1.1.1.3.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.2">𝑘</ci><apply id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.2">𝐶</ci><ci id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.2.3">𝑛</ci></apply><ci id="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><divide id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2"></divide><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2">ℎ</ci><apply id="S3.E2.m1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3"><times id="S3.E2.m1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.3.3.2">𝑛</ci><ci id="S3.E2.m1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝑡</ci></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.1"><abs id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.1.2"></abs><apply id="S3.E2.m1.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1">superscript</csymbol><apply id="S3.E2.m1.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.2.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.2.1.1.2.2">𝐶</ci><ci id="S3.E2.m1.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.2.1.1.2.3">𝑛</ci></apply><ci id="S3.E2.m1.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.E2.m1.5.5.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2"><eq id="S3.E2.m1.5.5.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1"></eq><apply id="S3.E2.m1.5.5.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2.2.2">𝒫</ci><ci id="S3.E2.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2.2.3">𝒯</ci></apply><ci id="S3.E2.m1.5.5.1.1.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2.3">𝑗</ci></apply><apply id="S3.E2.m1.5.5.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3"><apply id="S3.E2.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.3.1.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1">subscript</csymbol><sum id="S3.E2.m1.5.5.1.1.2.2.3.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1.2"></sum><apply id="S3.E2.m1.5.5.1.1.2.2.3.1.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3"><in id="S3.E2.m1.5.5.1.1.2.2.3.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.1"></in><ci id="S3.E2.m1.5.5.1.1.2.2.3.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.2">𝑛</ci><apply id="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.2">𝑃</ci><ci id="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1.3.3.3">𝑐</ci></apply></apply></apply><apply id="S3.E2.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2"><times id="S3.E2.m1.5.5.1.1.2.2.3.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.1"></times><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><divide id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4"></divide><apply id="S3.E2.m1.3.3.1.2.cmml" xref="S3.E2.m1.3.3.1.1"><abs id="S3.E2.m1.3.3.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2"></abs><apply id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.2">𝒯</ci><ci id="S3.E2.m1.3.3.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.3"><abs id="S3.E2.m1.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.2.3.1"></abs><ci id="S3.E2.m1.4.4.2.1.cmml" xref="S3.E2.m1.4.4.2.1">𝒟</ci></apply></apply><apply id="S3.E2.m1.5.5.1.1.2.2.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.3.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2">subscript</csymbol><apply id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.2">𝒫</ci><ci id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.2.3">𝒯</ci></apply><ci id="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.2.3">𝑛</ci></apply><ci id="S3.E2.m1.5.5.1.1.2.2.3.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2.2.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\mathcal{P_{T}}_{n}^{j}=\sum_{k\in C_{n}^{j}}\frac{h_{nk}^{(t)}}{|C_{n}^{j}|},\quad\mathcal{P_{T}}^{j}=\sum_{n\in P_{c}}\frac{|\mathcal{T}_{n}|}{|\mathcal{D}|}\mathcal{P_{T}}_{n}^{j},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="\mathcal{P_{F}}_{n}^{j}=\sum_{k\in C_{n}^{j}}\frac{h_{nk}^{(f)}}{|C_{n}^{j}|},\quad\mathcal{P_{F}}^{j}=\sum_{n\in P_{c}}\frac{|\mathcal{M}_{n}|}{|\mathcal{D}|}\mathcal{P_{F}}_{n}^{j}," display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5.1"><mrow id="S3.E3.m1.5.5.1.1.2" xref="S3.E3.m1.5.5.1.1.3.cmml"><mrow id="S3.E3.m1.5.5.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.cmml"><mmultiscripts id="S3.E3.m1.5.5.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.1.1.2.2.2.2" xref="S3.E3.m1.5.5.1.1.1.1.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.1.1.2.2.2.3" xref="S3.E3.m1.5.5.1.1.1.1.2.2.2.3.cmml">ℱ</mi><mrow id="S3.E3.m1.5.5.1.1.1.1.2a" xref="S3.E3.m1.5.5.1.1.1.1.2.cmml"></mrow><mi id="S3.E3.m1.5.5.1.1.1.1.2.2.3" xref="S3.E3.m1.5.5.1.1.1.1.2.2.3.cmml">n</mi><mi id="S3.E3.m1.5.5.1.1.1.1.2.3" xref="S3.E3.m1.5.5.1.1.1.1.2.3.cmml">j</mi></mmultiscripts><mo rspace="0.111em" id="S3.E3.m1.5.5.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.3.cmml"><munder id="S3.E3.m1.5.5.1.1.1.1.3.1" xref="S3.E3.m1.5.5.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.5.5.1.1.1.1.3.1.2" xref="S3.E3.m1.5.5.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.3.1.3" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.3.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.2.cmml">k</mi><mo id="S3.E3.m1.5.5.1.1.1.1.3.1.3.1" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.1.cmml">∈</mo><msubsup id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.2" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.2.cmml">C</mi><mi id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.3" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.3.cmml">n</mi><mi id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.3" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.3.cmml">j</mi></msubsup></mrow></munder><mfrac id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msubsup id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.3.2.cmml">h</mi><mrow id="S3.E3.m1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.3.3.1" xref="S3.E3.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.3.3.3.cmml">k</mi></mrow><mrow id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">f</mi><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.cmml">)</mo></mrow></msubsup><mrow id="S3.E3.m1.2.2.2.1" xref="S3.E3.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.1.cmml">|</mo><msubsup id="S3.E3.m1.2.2.2.1.1" xref="S3.E3.m1.2.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.2.1.1.2.2" xref="S3.E3.m1.2.2.2.1.1.2.2.cmml">C</mi><mi id="S3.E3.m1.2.2.2.1.1.2.3" xref="S3.E3.m1.2.2.2.1.1.2.3.cmml">n</mi><mi id="S3.E3.m1.2.2.2.1.1.3" xref="S3.E3.m1.2.2.2.1.1.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E3.m1.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><mo rspace="1.167em" id="S3.E3.m1.5.5.1.1.2.3" xref="S3.E3.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S3.E3.m1.5.5.1.1.2.2" xref="S3.E3.m1.5.5.1.1.2.2.cmml"><mmultiscripts id="S3.E3.m1.5.5.1.1.2.2.2" xref="S3.E3.m1.5.5.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.2.2.2.2.2" xref="S3.E3.m1.5.5.1.1.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.2.2.2.2.3" xref="S3.E3.m1.5.5.1.1.2.2.2.2.3.cmml">ℱ</mi><mrow id="S3.E3.m1.5.5.1.1.2.2.2a" xref="S3.E3.m1.5.5.1.1.2.2.2.cmml"></mrow><mrow id="S3.E3.m1.5.5.1.1.2.2.2b" xref="S3.E3.m1.5.5.1.1.2.2.2.cmml"></mrow><mi id="S3.E3.m1.5.5.1.1.2.2.2.3" xref="S3.E3.m1.5.5.1.1.2.2.2.3.cmml">j</mi></mmultiscripts><mo rspace="0.111em" id="S3.E3.m1.5.5.1.1.2.2.1" xref="S3.E3.m1.5.5.1.1.2.2.1.cmml">=</mo><mrow id="S3.E3.m1.5.5.1.1.2.2.3" xref="S3.E3.m1.5.5.1.1.2.2.3.cmml"><munder id="S3.E3.m1.5.5.1.1.2.2.3.1" xref="S3.E3.m1.5.5.1.1.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.5.5.1.1.2.2.3.1.2" xref="S3.E3.m1.5.5.1.1.2.2.3.1.2.cmml">∑</mo><mrow id="S3.E3.m1.5.5.1.1.2.2.3.1.3" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.2.2.3.1.3.2" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.2.cmml">n</mi><mo id="S3.E3.m1.5.5.1.1.2.2.3.1.3.1" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.1.cmml">∈</mo><msub id="S3.E3.m1.5.5.1.1.2.2.3.1.3.3" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.cmml"><mi id="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.2" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.2.cmml">P</mi><mi id="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.3" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.3.cmml">c</mi></msub></mrow></munder><mrow id="S3.E3.m1.5.5.1.1.2.2.3.2" xref="S3.E3.m1.5.5.1.1.2.2.3.2.cmml"><mfrac id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.2.1.cmml">|</mo><msub id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml">ℳ</mi><mi id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="S3.E3.m1.4.4.2.3" xref="S3.E3.m1.4.4.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.2.3.1" xref="S3.E3.m1.4.4.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.2.1" xref="S3.E3.m1.4.4.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E3.m1.4.4.2.3.2" xref="S3.E3.m1.4.4.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.2.2.3.2.1" xref="S3.E3.m1.5.5.1.1.2.2.3.2.1.cmml">​</mo><mmultiscripts id="S3.E3.m1.5.5.1.1.2.2.3.2.2" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.2" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.3" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.3.cmml">ℱ</mi><mrow id="S3.E3.m1.5.5.1.1.2.2.3.2.2a" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.cmml"></mrow><mi id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.3" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.3.cmml">n</mi><mi id="S3.E3.m1.5.5.1.1.2.2.3.2.2.3" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.3.cmml">j</mi></mmultiscripts></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.3a.cmml" xref="S3.E3.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1"><eq id="S3.E3.m1.5.5.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1"></eq><apply id="S3.E3.m1.5.5.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.2.2.2">𝒫</ci><ci id="S3.E3.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.2.2.3">ℱ</ci></apply><ci id="S3.E3.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.2.3">𝑛</ci></apply><ci id="S3.E3.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3"><apply id="S3.E3.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.3.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E3.m1.5.5.1.1.1.1.3.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.2"></sum><apply id="S3.E3.m1.5.5.1.1.1.1.3.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3"><in id="S3.E3.m1.5.5.1.1.1.1.3.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.1"></in><ci id="S3.E3.m1.5.5.1.1.1.1.3.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.2">𝑘</ci><apply id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.2">𝐶</ci><ci id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.2.3">𝑛</ci></apply><ci id="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><divide id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2"></divide><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2">ℎ</ci><apply id="S3.E3.m1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3"><times id="S3.E3.m1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.3.3.1"></times><ci id="S3.E3.m1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.3.3.2">𝑛</ci><ci id="S3.E3.m1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝑓</ci></apply><apply id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.1"><abs id="S3.E3.m1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.1.2"></abs><apply id="S3.E3.m1.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.2.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.1.1.2.2.cmml" xref="S3.E3.m1.2.2.2.1.1.2.2">𝐶</ci><ci id="S3.E3.m1.2.2.2.1.1.2.3.cmml" xref="S3.E3.m1.2.2.2.1.1.2.3">𝑛</ci></apply><ci id="S3.E3.m1.2.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.E3.m1.5.5.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2"><eq id="S3.E3.m1.5.5.1.1.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.1"></eq><apply id="S3.E3.m1.5.5.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2.2.2">𝒫</ci><ci id="S3.E3.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2.2.3">ℱ</ci></apply><ci id="S3.E3.m1.5.5.1.1.2.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.2.3">𝑗</ci></apply><apply id="S3.E3.m1.5.5.1.1.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3"><apply id="S3.E3.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.3.1.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1">subscript</csymbol><sum id="S3.E3.m1.5.5.1.1.2.2.3.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1.2"></sum><apply id="S3.E3.m1.5.5.1.1.2.2.3.1.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3"><in id="S3.E3.m1.5.5.1.1.2.2.3.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.1"></in><ci id="S3.E3.m1.5.5.1.1.2.2.3.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.2">𝑛</ci><apply id="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.2">𝑃</ci><ci id="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.1.3.3.3">𝑐</ci></apply></apply></apply><apply id="S3.E3.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2"><times id="S3.E3.m1.5.5.1.1.2.2.3.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.1"></times><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4"><divide id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4"></divide><apply id="S3.E3.m1.3.3.1.2.cmml" xref="S3.E3.m1.3.3.1.1"><abs id="S3.E3.m1.3.3.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2"></abs><apply id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.2">ℳ</ci><ci id="S3.E3.m1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.3"><abs id="S3.E3.m1.4.4.2.2.1.cmml" xref="S3.E3.m1.4.4.2.3.1"></abs><ci id="S3.E3.m1.4.4.2.1.cmml" xref="S3.E3.m1.4.4.2.1">𝒟</ci></apply></apply><apply id="S3.E3.m1.5.5.1.1.2.2.3.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.3.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.2">𝒫</ci><ci id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.2.3">ℱ</ci></apply><ci id="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.2.3">𝑛</ci></apply><ci id="S3.E3.m1.5.5.1.1.2.2.3.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.2.2.3.2.2.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\mathcal{P_{F}}_{n}^{j}=\sum_{k\in C_{n}^{j}}\frac{h_{nk}^{(f)}}{|C_{n}^{j}|},\quad\mathcal{P_{F}}^{j}=\sum_{n\in P_{c}}\frac{|\mathcal{M}_{n}|}{|\mathcal{D}|}\mathcal{P_{F}}_{n}^{j},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.11" class="ltx_p">where <math id="S3.SS2.p3.4.m1.1" class="ltx_Math" alttext="C_{n}^{j}" display="inline"><semantics id="S3.SS2.p3.4.m1.1a"><msubsup id="S3.SS2.p3.4.m1.1.1" xref="S3.SS2.p3.4.m1.1.1.cmml"><mi id="S3.SS2.p3.4.m1.1.1.2.2" xref="S3.SS2.p3.4.m1.1.1.2.2.cmml">C</mi><mi id="S3.SS2.p3.4.m1.1.1.2.3" xref="S3.SS2.p3.4.m1.1.1.2.3.cmml">n</mi><mi id="S3.SS2.p3.4.m1.1.1.3" xref="S3.SS2.p3.4.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m1.1b"><apply id="S3.SS2.p3.4.m1.1.1.cmml" xref="S3.SS2.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m1.1.1.1.cmml" xref="S3.SS2.p3.4.m1.1.1">superscript</csymbol><apply id="S3.SS2.p3.4.m1.1.1.2.cmml" xref="S3.SS2.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m1.1.1.2.1.cmml" xref="S3.SS2.p3.4.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m1.1.1.2.2.cmml" xref="S3.SS2.p3.4.m1.1.1.2.2">𝐶</ci><ci id="S3.SS2.p3.4.m1.1.1.2.3.cmml" xref="S3.SS2.p3.4.m1.1.1.2.3">𝑛</ci></apply><ci id="S3.SS2.p3.4.m1.1.1.3.cmml" xref="S3.SS2.p3.4.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m1.1c">C_{n}^{j}</annotation></semantics></math> denotes the data of class <math id="S3.SS2.p3.5.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p3.5.m2.1a"><mi id="S3.SS2.p3.5.m2.1.1" xref="S3.SS2.p3.5.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m2.1b"><ci id="S3.SS2.p3.5.m2.1.1.cmml" xref="S3.SS2.p3.5.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m2.1c">j</annotation></semantics></math> on the <math id="S3.SS2.p3.6.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p3.6.m3.1a"><mi id="S3.SS2.p3.6.m3.1.1" xref="S3.SS2.p3.6.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m3.1b"><ci id="S3.SS2.p3.6.m3.1.1.cmml" xref="S3.SS2.p3.6.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m3.1c">n</annotation></semantics></math>-th client, <math id="S3.SS2.p3.7.m4.1" class="ltx_Math" alttext="P_{c}" display="inline"><semantics id="S3.SS2.p3.7.m4.1a"><msub id="S3.SS2.p3.7.m4.1.1" xref="S3.SS2.p3.7.m4.1.1.cmml"><mi id="S3.SS2.p3.7.m4.1.1.2" xref="S3.SS2.p3.7.m4.1.1.2.cmml">P</mi><mi id="S3.SS2.p3.7.m4.1.1.3" xref="S3.SS2.p3.7.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m4.1b"><apply id="S3.SS2.p3.7.m4.1.1.cmml" xref="S3.SS2.p3.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m4.1.1.1.cmml" xref="S3.SS2.p3.7.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m4.1.1.2.cmml" xref="S3.SS2.p3.7.m4.1.1.2">𝑃</ci><ci id="S3.SS2.p3.7.m4.1.1.3.cmml" xref="S3.SS2.p3.7.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m4.1c">P_{c}</annotation></semantics></math> denotes the set of participating clients, and <math id="S3.SS2.p3.8.m5.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS2.p3.8.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.8.m5.1.1" xref="S3.SS2.p3.8.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m5.1b"><ci id="S3.SS2.p3.8.m5.1.1.cmml" xref="S3.SS2.p3.8.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m5.1c">\mathcal{D}</annotation></semantics></math> denotes all data of participating clients.
For <math id="S3.SS2.p3.9.m6.2" class="ltx_math_unparsed" alttext="*\in[\mathcal{I,T,F}]" display="inline"><semantics id="S3.SS2.p3.9.m6.2a"><mrow id="S3.SS2.p3.9.m6.2b"><mo rspace="0em" id="S3.SS2.p3.9.m6.1.1">∗</mo><mo lspace="0em" id="S3.SS2.p3.9.m6.2.2">∈</mo><mrow id="S3.SS2.p3.9.m6.2.3"><mo stretchy="false" id="S3.SS2.p3.9.m6.2.3.1">[</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.9.m6.2.3.2">ℐ</mi><mo id="S3.SS2.p3.9.m6.2.3.3">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.9.m6.2.3.4">𝒯</mi><mo id="S3.SS2.p3.9.m6.2.3.5">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.9.m6.2.3.6">ℱ</mi><mo stretchy="false" id="S3.SS2.p3.9.m6.2.3.7">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m6.2c">*\in[\mathcal{I,T,F}]</annotation></semantics></math>, <math id="S3.SS2.p3.10.m7.1" class="ltx_Math" alttext="\mathcal{P_{*}}_{n}^{j}" display="inline"><semantics id="S3.SS2.p3.10.m7.1a"><mmultiscripts id="S3.SS2.p3.10.m7.1.1" xref="S3.SS2.p3.10.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.10.m7.1.1.2.2.2" xref="S3.SS2.p3.10.m7.1.1.2.2.2.cmml">𝒫</mi><mo id="S3.SS2.p3.10.m7.1.1.2.2.3" xref="S3.SS2.p3.10.m7.1.1.2.2.3.cmml">∗</mo><mrow id="S3.SS2.p3.10.m7.1.1a" xref="S3.SS2.p3.10.m7.1.1.cmml"></mrow><mi id="S3.SS2.p3.10.m7.1.1.2.3" xref="S3.SS2.p3.10.m7.1.1.2.3.cmml">n</mi><mi id="S3.SS2.p3.10.m7.1.1.3" xref="S3.SS2.p3.10.m7.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m7.1b"><apply id="S3.SS2.p3.10.m7.1.1.cmml" xref="S3.SS2.p3.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m7.1.1.1.cmml" xref="S3.SS2.p3.10.m7.1.1">superscript</csymbol><apply id="S3.SS2.p3.10.m7.1.1.2.cmml" xref="S3.SS2.p3.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m7.1.1.2.1.cmml" xref="S3.SS2.p3.10.m7.1.1">subscript</csymbol><apply id="S3.SS2.p3.10.m7.1.1.2.2.cmml" xref="S3.SS2.p3.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m7.1.1.2.2.1.cmml" xref="S3.SS2.p3.10.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m7.1.1.2.2.2.cmml" xref="S3.SS2.p3.10.m7.1.1.2.2.2">𝒫</ci><times id="S3.SS2.p3.10.m7.1.1.2.2.3.cmml" xref="S3.SS2.p3.10.m7.1.1.2.2.3"></times></apply><ci id="S3.SS2.p3.10.m7.1.1.2.3.cmml" xref="S3.SS2.p3.10.m7.1.1.2.3">𝑛</ci></apply><ci id="S3.SS2.p3.10.m7.1.1.3.cmml" xref="S3.SS2.p3.10.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m7.1c">\mathcal{P_{*}}_{n}^{j}</annotation></semantics></math> denotes the local prototypes and <math id="S3.SS2.p3.11.m8.1" class="ltx_Math" alttext="{P_{*}}^{j}" display="inline"><semantics id="S3.SS2.p3.11.m8.1a"><mmultiscripts id="S3.SS2.p3.11.m8.1.1" xref="S3.SS2.p3.11.m8.1.1.cmml"><mi id="S3.SS2.p3.11.m8.1.1.2.2" xref="S3.SS2.p3.11.m8.1.1.2.2.cmml">P</mi><mo id="S3.SS2.p3.11.m8.1.1.2.3" xref="S3.SS2.p3.11.m8.1.1.2.3.cmml">∗</mo><mrow id="S3.SS2.p3.11.m8.1.1a" xref="S3.SS2.p3.11.m8.1.1.cmml"></mrow><mrow id="S3.SS2.p3.11.m8.1.1b" xref="S3.SS2.p3.11.m8.1.1.cmml"></mrow><mi id="S3.SS2.p3.11.m8.1.1.3" xref="S3.SS2.p3.11.m8.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m8.1b"><apply id="S3.SS2.p3.11.m8.1.1.cmml" xref="S3.SS2.p3.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m8.1.1.1.cmml" xref="S3.SS2.p3.11.m8.1.1">superscript</csymbol><apply id="S3.SS2.p3.11.m8.1.1.2.cmml" xref="S3.SS2.p3.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m8.1.1.2.1.cmml" xref="S3.SS2.p3.11.m8.1.1">subscript</csymbol><ci id="S3.SS2.p3.11.m8.1.1.2.2.cmml" xref="S3.SS2.p3.11.m8.1.1.2.2">𝑃</ci><times id="S3.SS2.p3.11.m8.1.1.2.3.cmml" xref="S3.SS2.p3.11.m8.1.1.2.3"></times></apply><ci id="S3.SS2.p3.11.m8.1.1.3.cmml" xref="S3.SS2.p3.11.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m8.1c">{P_{*}}^{j}</annotation></semantics></math> denotes the global prototypes.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Prototypes as Masks of Missing Modalities</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">When missing modalities occur, previous work <cite class="ltx_cite ltx_citemacro_citep">(Feng et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite> masks missing data with zero tensors.
In PmcmFL, prototypes are employed as masks for missing modality representations, thereby incorporating global prior knowledge.
Based on this, a task-calibrated training loss and a model-agnostic unimodal inference strategy are proposed.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.4" class="ltx_p"><span id="S3.SS3.p2.4.1" class="ltx_text ltx_font_bold">Task-Calibrated Training Loss.</span>  
As shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, during local training with complete image-text pairs, the training loss is defined:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.3" class="ltx_Math" alttext="L_{task}=\mathcal{L}(\mathcal{G}_{n}(\mathcal{F}_{n}(h_{nk}^{(i)},h_{nk}^{(t)})),y_{nk})," display="block"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.4" xref="S3.E4.m1.3.3.1.1.4.cmml"><mi id="S3.E4.m1.3.3.1.1.4.2" xref="S3.E4.m1.3.3.1.1.4.2.cmml">L</mi><mrow id="S3.E4.m1.3.3.1.1.4.3" xref="S3.E4.m1.3.3.1.1.4.3.cmml"><mi id="S3.E4.m1.3.3.1.1.4.3.2" xref="S3.E4.m1.3.3.1.1.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.4.3.1" xref="S3.E4.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E4.m1.3.3.1.1.4.3.3" xref="S3.E4.m1.3.3.1.1.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.4.3.1a" xref="S3.E4.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E4.m1.3.3.1.1.4.3.4" xref="S3.E4.m1.3.3.1.1.4.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.4.3.1b" xref="S3.E4.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E4.m1.3.3.1.1.4.3.5" xref="S3.E4.m1.3.3.1.1.4.3.5.cmml">k</mi></mrow></msub><mo id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.1.2.4" xref="S3.E4.m1.3.3.1.1.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.2.3" xref="S3.E4.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.2.2.2.3" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml">𝒢</mi><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.cmml">ℱ</mi><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">k</mi></mrow><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">k</mi></mrow><mrow id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.3.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.E4.m1.2.2.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.2.2.2.4" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S3.E4.m1.3.3.1.1.2.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S3.E4.m1.3.3.1.1.2.2.2.2.3" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2.2.2.3.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.2.2.2.2.3.1" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E4.m1.3.3.1.1.2.2.2.2.3.3" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.3.3.1.1.2.2.2.5" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"></eq><apply id="S3.E4.m1.3.3.1.1.4.cmml" xref="S3.E4.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.4.1.cmml" xref="S3.E4.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.4.2.cmml" xref="S3.E4.m1.3.3.1.1.4.2">𝐿</ci><apply id="S3.E4.m1.3.3.1.1.4.3.cmml" xref="S3.E4.m1.3.3.1.1.4.3"><times id="S3.E4.m1.3.3.1.1.4.3.1.cmml" xref="S3.E4.m1.3.3.1.1.4.3.1"></times><ci id="S3.E4.m1.3.3.1.1.4.3.2.cmml" xref="S3.E4.m1.3.3.1.1.4.3.2">𝑡</ci><ci id="S3.E4.m1.3.3.1.1.4.3.3.cmml" xref="S3.E4.m1.3.3.1.1.4.3.3">𝑎</ci><ci id="S3.E4.m1.3.3.1.1.4.3.4.cmml" xref="S3.E4.m1.3.3.1.1.4.3.4">𝑠</ci><ci id="S3.E4.m1.3.3.1.1.4.3.5.cmml" xref="S3.E4.m1.3.3.1.1.4.3.5">𝑘</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><times id="S3.E4.m1.3.3.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3"></times><ci id="S3.E4.m1.3.3.1.1.2.4.cmml" xref="S3.E4.m1.3.3.1.1.2.4">ℒ</ci><interval closure="open" id="S3.E4.m1.3.3.1.1.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2"><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2">𝒢</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3"></times><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.2">ℱ</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.4.3">𝑛</ci></apply><interval closure="open" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.2">ℎ</ci><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3"><times id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2">𝑛</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑡</ci></apply></interval></apply></apply><apply id="S3.E4.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.2">𝑦</ci><apply id="S3.E4.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3"><times id="S3.E4.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.2.2.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.2">𝑛</ci><ci id="S3.E4.m1.3.3.1.1.2.2.2.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">L_{task}=\mathcal{L}(\mathcal{G}_{n}(\mathcal{F}_{n}(h_{nk}^{(i)},h_{nk}^{(t)})),y_{nk}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.1" class="ltx_p">where <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathcal{L}</annotation></semantics></math> denotes the task loss function. For classification tasks, cross-entropy is commonly used.
In the case of local training with text missing, a task-calibrated training loss is constructed using the text prototypes as masks:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="L_{task}=\mathcal{L}(\mathcal{G}_{n}(\mathcal{F}_{n}(h_{nk}^{(i)},\mathcal{P_{T}}^{j})),y_{nk})," display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.4" xref="S3.E5.m1.2.2.1.1.4.cmml"><mi id="S3.E5.m1.2.2.1.1.4.2" xref="S3.E5.m1.2.2.1.1.4.2.cmml">L</mi><mrow id="S3.E5.m1.2.2.1.1.4.3" xref="S3.E5.m1.2.2.1.1.4.3.cmml"><mi id="S3.E5.m1.2.2.1.1.4.3.2" xref="S3.E5.m1.2.2.1.1.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.4.3.1" xref="S3.E5.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.4.3.3" xref="S3.E5.m1.2.2.1.1.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.4.3.1a" xref="S3.E5.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.4.3.4" xref="S3.E5.m1.2.2.1.1.4.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.4.3.1b" xref="S3.E5.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.4.3.5" xref="S3.E5.m1.2.2.1.1.4.3.5.cmml">k</mi></mrow></msub><mo id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.2.4" xref="S3.E5.m1.2.2.1.1.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.2.3" xref="S3.E5.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.2.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.3.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝒢</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.2.cmml">ℱ</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">k</mi></mrow><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E5.m1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mmultiscripts id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">𝒯</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2a" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"></mrow><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2b" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"></mrow><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></mmultiscripts><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.2.2.2.4" xref="S3.E5.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E5.m1.2.2.1.1.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S3.E5.m1.2.2.1.1.2.2.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.3.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.2.2.2.2.3.1" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E5.m1.2.2.1.1.2.2.2.5" xref="S3.E5.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><eq id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3"></eq><apply id="S3.E5.m1.2.2.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.4.1.cmml" xref="S3.E5.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.4.2.cmml" xref="S3.E5.m1.2.2.1.1.4.2">𝐿</ci><apply id="S3.E5.m1.2.2.1.1.4.3.cmml" xref="S3.E5.m1.2.2.1.1.4.3"><times id="S3.E5.m1.2.2.1.1.4.3.1.cmml" xref="S3.E5.m1.2.2.1.1.4.3.1"></times><ci id="S3.E5.m1.2.2.1.1.4.3.2.cmml" xref="S3.E5.m1.2.2.1.1.4.3.2">𝑡</ci><ci id="S3.E5.m1.2.2.1.1.4.3.3.cmml" xref="S3.E5.m1.2.2.1.1.4.3.3">𝑎</ci><ci id="S3.E5.m1.2.2.1.1.4.3.4.cmml" xref="S3.E5.m1.2.2.1.1.4.3.4">𝑠</ci><ci id="S3.E5.m1.2.2.1.1.4.3.5.cmml" xref="S3.E5.m1.2.2.1.1.4.3.5">𝑘</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"><times id="S3.E5.m1.2.2.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.3"></times><ci id="S3.E5.m1.2.2.1.1.2.4.cmml" xref="S3.E5.m1.2.2.1.1.2.4">ℒ</ci><interval closure="open" id="S3.E5.m1.2.2.1.1.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2">𝒢</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3"></times><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.2">ℱ</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.3">𝑛</ci></apply><interval closure="open" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝒫</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝒯</ci></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2">𝑦</ci><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3"><times id="S3.E5.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.1"></times><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.2">𝑛</ci><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">L_{task}=\mathcal{L}(\mathcal{G}_{n}(\mathcal{F}_{n}(h_{nk}^{(i)},\mathcal{P_{T}}^{j})),y_{nk}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.3" class="ltx_p">where <math id="S3.SS3.p2.2.m1.1" class="ltx_Math" alttext="\mathcal{P_{T}}^{j}" display="inline"><semantics id="S3.SS3.p2.2.m1.1a"><mmultiscripts id="S3.SS3.p2.2.m1.1.1" xref="S3.SS3.p2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m1.1.1.2.2" xref="S3.SS3.p2.2.m1.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m1.1.1.2.3" xref="S3.SS3.p2.2.m1.1.1.2.3.cmml">𝒯</mi><mrow id="S3.SS3.p2.2.m1.1.1a" xref="S3.SS3.p2.2.m1.1.1.cmml"></mrow><mrow id="S3.SS3.p2.2.m1.1.1b" xref="S3.SS3.p2.2.m1.1.1.cmml"></mrow><mi id="S3.SS3.p2.2.m1.1.1.3" xref="S3.SS3.p2.2.m1.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m1.1b"><apply id="S3.SS3.p2.2.m1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1">superscript</csymbol><apply id="S3.SS3.p2.2.m1.1.1.2.cmml" xref="S3.SS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.1.1.2.1.cmml" xref="S3.SS3.p2.2.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m1.1.1.2.2.cmml" xref="S3.SS3.p2.2.m1.1.1.2.2">𝒫</ci><ci id="S3.SS3.p2.2.m1.1.1.2.3.cmml" xref="S3.SS3.p2.2.m1.1.1.2.3">𝒯</ci></apply><ci id="S3.SS3.p2.2.m1.1.1.3.cmml" xref="S3.SS3.p2.2.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m1.1c">\mathcal{P_{T}}^{j}</annotation></semantics></math> has the same class as <math id="S3.SS3.p2.3.m2.1" class="ltx_Math" alttext="y_{nk}" display="inline"><semantics id="S3.SS3.p2.3.m2.1a"><msub id="S3.SS3.p2.3.m2.1.1" xref="S3.SS3.p2.3.m2.1.1.cmml"><mi id="S3.SS3.p2.3.m2.1.1.2" xref="S3.SS3.p2.3.m2.1.1.2.cmml">y</mi><mrow id="S3.SS3.p2.3.m2.1.1.3" xref="S3.SS3.p2.3.m2.1.1.3.cmml"><mi id="S3.SS3.p2.3.m2.1.1.3.2" xref="S3.SS3.p2.3.m2.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m2.1.1.3.1" xref="S3.SS3.p2.3.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m2.1.1.3.3" xref="S3.SS3.p2.3.m2.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m2.1b"><apply id="S3.SS3.p2.3.m2.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m2.1.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m2.1.1.2.cmml" xref="S3.SS3.p2.3.m2.1.1.2">𝑦</ci><apply id="S3.SS3.p2.3.m2.1.1.3.cmml" xref="S3.SS3.p2.3.m2.1.1.3"><times id="S3.SS3.p2.3.m2.1.1.3.1.cmml" xref="S3.SS3.p2.3.m2.1.1.3.1"></times><ci id="S3.SS3.p2.3.m2.1.1.3.2.cmml" xref="S3.SS3.p2.3.m2.1.1.3.2">𝑛</ci><ci id="S3.SS3.p2.3.m2.1.1.3.3.cmml" xref="S3.SS3.p2.3.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m2.1c">y_{nk}</annotation></semantics></math>.
Similarly, the task-calibrated training loss is defined when images are missing:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.2" class="ltx_Math" alttext="L_{task}=\mathcal{L}(\mathcal{G}_{n}(\mathcal{F}_{n}(\mathcal{P_{I}}^{j},h_{nk}^{(t)})),y_{nk})." display="block"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.4" xref="S3.E6.m1.2.2.1.1.4.cmml"><mi id="S3.E6.m1.2.2.1.1.4.2" xref="S3.E6.m1.2.2.1.1.4.2.cmml">L</mi><mrow id="S3.E6.m1.2.2.1.1.4.3" xref="S3.E6.m1.2.2.1.1.4.3.cmml"><mi id="S3.E6.m1.2.2.1.1.4.3.2" xref="S3.E6.m1.2.2.1.1.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.4.3.1" xref="S3.E6.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.4.3.3" xref="S3.E6.m1.2.2.1.1.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.4.3.1a" xref="S3.E6.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.4.3.4" xref="S3.E6.m1.2.2.1.1.4.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.4.3.1b" xref="S3.E6.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.4.3.5" xref="S3.E6.m1.2.2.1.1.4.3.5.cmml">k</mi></mrow></msub><mo id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.2.4" xref="S3.E6.m1.2.2.1.1.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.2.2.2" xref="S3.E6.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.2.2.2.3" xref="S3.E6.m1.2.2.1.1.2.2.3.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝒢</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.2.cmml">ℱ</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mmultiscripts id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">ℐ</mi><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"></mrow><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1b" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"></mrow><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></mmultiscripts><mo id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">k</mi></mrow><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.3.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.2.2.1.1.2.2.2.4" xref="S3.E6.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E6.m1.2.2.1.1.2.2.2.2" xref="S3.E6.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E6.m1.2.2.1.1.2.2.2.2.2" xref="S3.E6.m1.2.2.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S3.E6.m1.2.2.1.1.2.2.2.2.3" xref="S3.E6.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.2.2.2.3.2" xref="S3.E6.m1.2.2.1.1.2.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.2.2.2.3.1" xref="S3.E6.m1.2.2.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.E6.m1.2.2.1.1.2.2.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E6.m1.2.2.1.1.2.2.2.5" xref="S3.E6.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1"><eq id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3"></eq><apply id="S3.E6.m1.2.2.1.1.4.cmml" xref="S3.E6.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.4.1.cmml" xref="S3.E6.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.4.2.cmml" xref="S3.E6.m1.2.2.1.1.4.2">𝐿</ci><apply id="S3.E6.m1.2.2.1.1.4.3.cmml" xref="S3.E6.m1.2.2.1.1.4.3"><times id="S3.E6.m1.2.2.1.1.4.3.1.cmml" xref="S3.E6.m1.2.2.1.1.4.3.1"></times><ci id="S3.E6.m1.2.2.1.1.4.3.2.cmml" xref="S3.E6.m1.2.2.1.1.4.3.2">𝑡</ci><ci id="S3.E6.m1.2.2.1.1.4.3.3.cmml" xref="S3.E6.m1.2.2.1.1.4.3.3">𝑎</ci><ci id="S3.E6.m1.2.2.1.1.4.3.4.cmml" xref="S3.E6.m1.2.2.1.1.4.3.4">𝑠</ci><ci id="S3.E6.m1.2.2.1.1.4.3.5.cmml" xref="S3.E6.m1.2.2.1.1.4.3.5">𝑘</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2"><times id="S3.E6.m1.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3"></times><ci id="S3.E6.m1.2.2.1.1.2.4.cmml" xref="S3.E6.m1.2.2.1.1.2.4">ℒ</ci><interval closure="open" id="S3.E6.m1.2.2.1.1.2.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2"><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1"><times id="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.2">𝒢</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3"></times><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.2">ℱ</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.4.3">𝑛</ci></apply><interval closure="open" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒫</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">ℐ</ci></apply><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2">ℎ</ci><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3"><times id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2">𝑛</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑡</ci></apply></interval></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.2.2">𝑦</ci><apply id="S3.E6.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.2.3"><times id="S3.E6.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.2.3.1"></times><ci id="S3.E6.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.2.3.2">𝑛</ci><ci id="S3.E6.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">L_{task}=\mathcal{L}(\mathcal{G}_{n}(\mathcal{F}_{n}(\mathcal{P_{I}}^{j},h_{nk}^{(t)})),y_{nk}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.3" class="ltx_p">With supervision from the task-calibrated loss, the entire model is trained on the original multimodal task, even when there are missing modalities on clients. On the contrary, using zero masks will result in a task-drifted loss.
For example, in the case where text is missing, the training loss with zero masks is denoted as <math id="S3.SS3.p3.1.m1.4" class="ltx_Math" alttext="\mathcal{L}(\mathcal{G}_{n}(\mathcal{F}_{n}(h_{nk}^{(i)},\mathbf{0})),y_{nk})" display="inline"><semantics id="S3.SS3.p3.1.m1.4a"><mrow id="S3.SS3.p3.1.m1.4.4" xref="S3.SS3.p3.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.4.4.4" xref="S3.SS3.p3.1.m1.4.4.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.4.4.3" xref="S3.SS3.p3.1.m1.4.4.3.cmml">​</mo><mrow id="S3.SS3.p3.1.m1.4.4.2.2" xref="S3.SS3.p3.1.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.4.4.2.2.3" xref="S3.SS3.p3.1.m1.4.4.2.3.cmml">(</mo><mrow id="S3.SS3.p3.1.m1.3.3.1.1.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.3.3.1.1.1.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.3.3.1.1.1.3.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3.2.cmml">𝒢</mi><mi id="S3.SS3.p3.1.m1.3.3.1.1.1.3.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.3.3.1.1.1.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS3.p3.1.m1.1.1.1.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.1.1.1.3.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.p3.1.m1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p3.1.m1.1.1.1.3.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mn id="S3.SS3.p3.1.m1.2.2" xref="S3.SS3.p3.1.m1.2.2.cmml">𝟎</mn><mo stretchy="false" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.3" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.1.m1.4.4.2.2.4" xref="S3.SS3.p3.1.m1.4.4.2.3.cmml">,</mo><msub id="S3.SS3.p3.1.m1.4.4.2.2.2" xref="S3.SS3.p3.1.m1.4.4.2.2.2.cmml"><mi id="S3.SS3.p3.1.m1.4.4.2.2.2.2" xref="S3.SS3.p3.1.m1.4.4.2.2.2.2.cmml">y</mi><mrow id="S3.SS3.p3.1.m1.4.4.2.2.2.3" xref="S3.SS3.p3.1.m1.4.4.2.2.2.3.cmml"><mi id="S3.SS3.p3.1.m1.4.4.2.2.2.3.2" xref="S3.SS3.p3.1.m1.4.4.2.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.4.4.2.2.2.3.1" xref="S3.SS3.p3.1.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.1.m1.4.4.2.2.2.3.3" xref="S3.SS3.p3.1.m1.4.4.2.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p3.1.m1.4.4.2.2.5" xref="S3.SS3.p3.1.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.4b"><apply id="S3.SS3.p3.1.m1.4.4.cmml" xref="S3.SS3.p3.1.m1.4.4"><times id="S3.SS3.p3.1.m1.4.4.3.cmml" xref="S3.SS3.p3.1.m1.4.4.3"></times><ci id="S3.SS3.p3.1.m1.4.4.4.cmml" xref="S3.SS3.p3.1.m1.4.4.4">ℒ</ci><interval closure="open" id="S3.SS3.p3.1.m1.4.4.2.3.cmml" xref="S3.SS3.p3.1.m1.4.4.2.2"><apply id="S3.SS3.p3.1.m1.3.3.1.1.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1"><times id="S3.SS3.p3.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.2"></times><apply id="S3.SS3.p3.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.1.m1.3.3.1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3.2">𝒢</ci><ci id="S3.SS3.p3.1.m1.3.3.1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3.3">𝑛</ci></apply><apply id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1"><times id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.2">ℱ</ci><ci id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.3.3">𝑛</ci></apply><interval closure="open" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p3.1.m1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1">𝑖</ci></apply><cn type="integer" id="S3.SS3.p3.1.m1.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2">0</cn></interval></apply></apply><apply id="S3.SS3.p3.1.m1.4.4.2.2.2.cmml" xref="S3.SS3.p3.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS3.p3.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS3.p3.1.m1.4.4.2.2.2.2">𝑦</ci><apply id="S3.SS3.p3.1.m1.4.4.2.2.2.3.cmml" xref="S3.SS3.p3.1.m1.4.4.2.2.2.3"><times id="S3.SS3.p3.1.m1.4.4.2.2.2.3.1.cmml" xref="S3.SS3.p3.1.m1.4.4.2.2.2.3.1"></times><ci id="S3.SS3.p3.1.m1.4.4.2.2.2.3.2.cmml" xref="S3.SS3.p3.1.m1.4.4.2.2.2.3.2">𝑛</ci><ci id="S3.SS3.p3.1.m1.4.4.2.2.2.3.3.cmml" xref="S3.SS3.p3.1.m1.4.4.2.2.2.3.3">𝑘</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.4c">\mathcal{L}(\mathcal{G}_{n}(\mathcal{F}_{n}(h_{nk}^{(i)},\mathbf{0})),y_{nk})</annotation></semantics></math>.
Essentially, this represents an unimodal training task that depicts the relationship between the unimodal representation <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="h_{nk}^{(i)}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msubsup id="S3.SS3.p3.2.m2.1.2" xref="S3.SS3.p3.2.m2.1.2.cmml"><mi id="S3.SS3.p3.2.m2.1.2.2.2" xref="S3.SS3.p3.2.m2.1.2.2.2.cmml">h</mi><mrow id="S3.SS3.p3.2.m2.1.2.2.3" xref="S3.SS3.p3.2.m2.1.2.2.3.cmml"><mi id="S3.SS3.p3.2.m2.1.2.2.3.2" xref="S3.SS3.p3.2.m2.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.2.2.3.1" xref="S3.SS3.p3.2.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.2.m2.1.2.2.3.3" xref="S3.SS3.p3.2.m2.1.2.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS3.p3.2.m2.1.1.1.3" xref="S3.SS3.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.1.1.1.3.1" xref="S3.SS3.p3.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p3.2.m2.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p3.2.m2.1.1.1.3.2" xref="S3.SS3.p3.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.2.cmml" xref="S3.SS3.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.2.1.cmml" xref="S3.SS3.p3.2.m2.1.2">superscript</csymbol><apply id="S3.SS3.p3.2.m2.1.2.2.cmml" xref="S3.SS3.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.2.2.1.cmml" xref="S3.SS3.p3.2.m2.1.2">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.2.2.2.cmml" xref="S3.SS3.p3.2.m2.1.2.2.2">ℎ</ci><apply id="S3.SS3.p3.2.m2.1.2.2.3.cmml" xref="S3.SS3.p3.2.m2.1.2.2.3"><times id="S3.SS3.p3.2.m2.1.2.2.3.1.cmml" xref="S3.SS3.p3.2.m2.1.2.2.3.1"></times><ci id="S3.SS3.p3.2.m2.1.2.2.3.2.cmml" xref="S3.SS3.p3.2.m2.1.2.2.3.2">𝑛</ci><ci id="S3.SS3.p3.2.m2.1.2.2.3.3.cmml" xref="S3.SS3.p3.2.m2.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p3.2.m2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">h_{nk}^{(i)}</annotation></semantics></math> and the ground truth <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="y_{nk}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msub id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">y</mi><mrow id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.1.1.3.1" xref="S3.SS3.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝑦</ci><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><times id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.1"></times><ci id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">𝑛</ci><ci id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">y_{nk}</annotation></semantics></math>,
which leads to inconsistent optimization directions for the model training.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.9" class="ltx_p"><span id="S3.SS3.p4.9.1" class="ltx_text ltx_font_bold">Model-Agnostic Unimodal Inference.</span>  
During inference with missing modalities, prototypes are employed as masks to assist the global model.
Unlike training, where labels are available, we must find corresponding cross-modal prototypes according to embedded representations.
To this end, a matching function <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="m(\cdot)" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.2" xref="S3.SS3.p4.1.m1.1.2.cmml"><mi id="S3.SS3.p4.1.m1.1.2.2" xref="S3.SS3.p4.1.m1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.2.1" xref="S3.SS3.p4.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p4.1.m1.1.2.3.2" xref="S3.SS3.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.1.m1.1.2.3.2.1" xref="S3.SS3.p4.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.p4.1.m1.1.2.3.2.2" xref="S3.SS3.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.2"><times id="S3.SS3.p4.1.m1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2.1"></times><ci id="S3.SS3.p4.1.m1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2">𝑚</ci><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">m(\cdot)</annotation></semantics></math> is established from hidden representations to prototypes.
We use an example to describe the matching process of cross-modal prototypes.
Without loss of generality, assume that the model only utilizes images for inference.
First, the image <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="i_{nk}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">i</mi><mrow id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.1" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝑖</ci><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><times id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.1"></times><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">𝑛</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">i_{nk}</annotation></semantics></math> is input for computing the image representation <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="h_{nk}^{(i)}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><msubsup id="S3.SS3.p4.3.m3.1.2" xref="S3.SS3.p4.3.m3.1.2.cmml"><mi id="S3.SS3.p4.3.m3.1.2.2.2" xref="S3.SS3.p4.3.m3.1.2.2.2.cmml">h</mi><mrow id="S3.SS3.p4.3.m3.1.2.2.3" xref="S3.SS3.p4.3.m3.1.2.2.3.cmml"><mi id="S3.SS3.p4.3.m3.1.2.2.3.2" xref="S3.SS3.p4.3.m3.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.2.2.3.1" xref="S3.SS3.p4.3.m3.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.2.2.3.3" xref="S3.SS3.p4.3.m3.1.2.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS3.p4.3.m3.1.1.1.3" xref="S3.SS3.p4.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.3.m3.1.1.1.3.1" xref="S3.SS3.p4.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.p4.3.m3.1.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p4.3.m3.1.1.1.3.2" xref="S3.SS3.p4.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.2.cmml" xref="S3.SS3.p4.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.2.1.cmml" xref="S3.SS3.p4.3.m3.1.2">superscript</csymbol><apply id="S3.SS3.p4.3.m3.1.2.2.cmml" xref="S3.SS3.p4.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.2.2.1.cmml" xref="S3.SS3.p4.3.m3.1.2">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.2.2.2.cmml" xref="S3.SS3.p4.3.m3.1.2.2.2">ℎ</ci><apply id="S3.SS3.p4.3.m3.1.2.2.3.cmml" xref="S3.SS3.p4.3.m3.1.2.2.3"><times id="S3.SS3.p4.3.m3.1.2.2.3.1.cmml" xref="S3.SS3.p4.3.m3.1.2.2.3.1"></times><ci id="S3.SS3.p4.3.m3.1.2.2.3.2.cmml" xref="S3.SS3.p4.3.m3.1.2.2.3.2">𝑛</ci><ci id="S3.SS3.p4.3.m3.1.2.2.3.3.cmml" xref="S3.SS3.p4.3.m3.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p4.3.m3.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">h_{nk}^{(i)}</annotation></semantics></math>.
Sequentially, the image prototype with the same class <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="\mathcal{P_{I}}^{j}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mmultiscripts id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.4.m4.1.1.2.2" xref="S3.SS3.p4.4.m4.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.4.m4.1.1.2.3" xref="S3.SS3.p4.4.m4.1.1.2.3.cmml">ℐ</mi><mrow id="S3.SS3.p4.4.m4.1.1a" xref="S3.SS3.p4.4.m4.1.1.cmml"></mrow><mrow id="S3.SS3.p4.4.m4.1.1b" xref="S3.SS3.p4.4.m4.1.1.cmml"></mrow><mi id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">superscript</csymbol><apply id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2">𝒫</ci><ci id="S3.SS3.p4.4.m4.1.1.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3">ℐ</ci></apply><ci id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\mathcal{P_{I}}^{j}</annotation></semantics></math> is determined using this matching function <math id="S3.SS3.p4.5.m5.2" class="ltx_Math" alttext="\mathcal{P_{I}}^{j}=m(h_{nk}^{(i)})" display="inline"><semantics id="S3.SS3.p4.5.m5.2a"><mrow id="S3.SS3.p4.5.m5.2.2" xref="S3.SS3.p4.5.m5.2.2.cmml"><mmultiscripts id="S3.SS3.p4.5.m5.2.2.3" xref="S3.SS3.p4.5.m5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.5.m5.2.2.3.2.2" xref="S3.SS3.p4.5.m5.2.2.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.5.m5.2.2.3.2.3" xref="S3.SS3.p4.5.m5.2.2.3.2.3.cmml">ℐ</mi><mrow id="S3.SS3.p4.5.m5.2.2.3a" xref="S3.SS3.p4.5.m5.2.2.3.cmml"></mrow><mrow id="S3.SS3.p4.5.m5.2.2.3b" xref="S3.SS3.p4.5.m5.2.2.3.cmml"></mrow><mi id="S3.SS3.p4.5.m5.2.2.3.3" xref="S3.SS3.p4.5.m5.2.2.3.3.cmml">j</mi></mmultiscripts><mo id="S3.SS3.p4.5.m5.2.2.2" xref="S3.SS3.p4.5.m5.2.2.2.cmml">=</mo><mrow id="S3.SS3.p4.5.m5.2.2.1" xref="S3.SS3.p4.5.m5.2.2.1.cmml"><mi id="S3.SS3.p4.5.m5.2.2.1.3" xref="S3.SS3.p4.5.m5.2.2.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.5.m5.2.2.1.2" xref="S3.SS3.p4.5.m5.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p4.5.m5.2.2.1.1.1" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p4.5.m5.2.2.1.1.1.2" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.p4.5.m5.2.2.1.1.1.1" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.2" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.2" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.1" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.3" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS3.p4.5.m5.1.1.1.3" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p4.5.m5.1.1.1.3.1" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.cmml">(</mo><mi id="S3.SS3.p4.5.m5.1.1.1.1" xref="S3.SS3.p4.5.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p4.5.m5.1.1.1.3.2" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS3.p4.5.m5.2.2.1.1.1.3" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.2b"><apply id="S3.SS3.p4.5.m5.2.2.cmml" xref="S3.SS3.p4.5.m5.2.2"><eq id="S3.SS3.p4.5.m5.2.2.2.cmml" xref="S3.SS3.p4.5.m5.2.2.2"></eq><apply id="S3.SS3.p4.5.m5.2.2.3.cmml" xref="S3.SS3.p4.5.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.2.2.3.1.cmml" xref="S3.SS3.p4.5.m5.2.2.3">superscript</csymbol><apply id="S3.SS3.p4.5.m5.2.2.3.2.cmml" xref="S3.SS3.p4.5.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.2.2.3.2.1.cmml" xref="S3.SS3.p4.5.m5.2.2.3">subscript</csymbol><ci id="S3.SS3.p4.5.m5.2.2.3.2.2.cmml" xref="S3.SS3.p4.5.m5.2.2.3.2.2">𝒫</ci><ci id="S3.SS3.p4.5.m5.2.2.3.2.3.cmml" xref="S3.SS3.p4.5.m5.2.2.3.2.3">ℐ</ci></apply><ci id="S3.SS3.p4.5.m5.2.2.3.3.cmml" xref="S3.SS3.p4.5.m5.2.2.3.3">𝑗</ci></apply><apply id="S3.SS3.p4.5.m5.2.2.1.cmml" xref="S3.SS3.p4.5.m5.2.2.1"><times id="S3.SS3.p4.5.m5.2.2.1.2.cmml" xref="S3.SS3.p4.5.m5.2.2.1.2"></times><ci id="S3.SS3.p4.5.m5.2.2.1.3.cmml" xref="S3.SS3.p4.5.m5.2.2.1.3">𝑚</ci><apply id="S3.SS3.p4.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.2">ℎ</ci><apply id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3"><times id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.1"></times><ci id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p4.5.m5.1.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.2c">\mathcal{P_{I}}^{j}=m(h_{nk}^{(i)})</annotation></semantics></math>.
Following this, the corresponding text prototype <math id="S3.SS3.p4.6.m6.1" class="ltx_Math" alttext="\mathcal{P_{T}}^{j}" display="inline"><semantics id="S3.SS3.p4.6.m6.1a"><mmultiscripts id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.6.m6.1.1.2.2" xref="S3.SS3.p4.6.m6.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.6.m6.1.1.2.3" xref="S3.SS3.p4.6.m6.1.1.2.3.cmml">𝒯</mi><mrow id="S3.SS3.p4.6.m6.1.1a" xref="S3.SS3.p4.6.m6.1.1.cmml"></mrow><mrow id="S3.SS3.p4.6.m6.1.1b" xref="S3.SS3.p4.6.m6.1.1.cmml"></mrow><mi id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">superscript</csymbol><apply id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.2.1.cmml" xref="S3.SS3.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p4.6.m6.1.1.2.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2.2">𝒫</ci><ci id="S3.SS3.p4.6.m6.1.1.2.3.cmml" xref="S3.SS3.p4.6.m6.1.1.2.3">𝒯</ci></apply><ci id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\mathcal{P_{T}}^{j}</annotation></semantics></math> is determined according to class <math id="S3.SS3.p4.7.m7.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p4.7.m7.1a"><mi id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><ci id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">j</annotation></semantics></math>.
Finally, the image representation <math id="S3.SS3.p4.8.m8.1" class="ltx_Math" alttext="h_{nk}^{(i)}" display="inline"><semantics id="S3.SS3.p4.8.m8.1a"><msubsup id="S3.SS3.p4.8.m8.1.2" xref="S3.SS3.p4.8.m8.1.2.cmml"><mi id="S3.SS3.p4.8.m8.1.2.2.2" xref="S3.SS3.p4.8.m8.1.2.2.2.cmml">h</mi><mrow id="S3.SS3.p4.8.m8.1.2.2.3" xref="S3.SS3.p4.8.m8.1.2.2.3.cmml"><mi id="S3.SS3.p4.8.m8.1.2.2.3.2" xref="S3.SS3.p4.8.m8.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.8.m8.1.2.2.3.1" xref="S3.SS3.p4.8.m8.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.8.m8.1.2.2.3.3" xref="S3.SS3.p4.8.m8.1.2.2.3.3.cmml">k</mi></mrow><mrow id="S3.SS3.p4.8.m8.1.1.1.3" xref="S3.SS3.p4.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.8.m8.1.1.1.3.1" xref="S3.SS3.p4.8.m8.1.2.cmml">(</mo><mi id="S3.SS3.p4.8.m8.1.1.1.1" xref="S3.SS3.p4.8.m8.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p4.8.m8.1.1.1.3.2" xref="S3.SS3.p4.8.m8.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m8.1b"><apply id="S3.SS3.p4.8.m8.1.2.cmml" xref="S3.SS3.p4.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.2.1.cmml" xref="S3.SS3.p4.8.m8.1.2">superscript</csymbol><apply id="S3.SS3.p4.8.m8.1.2.2.cmml" xref="S3.SS3.p4.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.2.2.1.cmml" xref="S3.SS3.p4.8.m8.1.2">subscript</csymbol><ci id="S3.SS3.p4.8.m8.1.2.2.2.cmml" xref="S3.SS3.p4.8.m8.1.2.2.2">ℎ</ci><apply id="S3.SS3.p4.8.m8.1.2.2.3.cmml" xref="S3.SS3.p4.8.m8.1.2.2.3"><times id="S3.SS3.p4.8.m8.1.2.2.3.1.cmml" xref="S3.SS3.p4.8.m8.1.2.2.3.1"></times><ci id="S3.SS3.p4.8.m8.1.2.2.3.2.cmml" xref="S3.SS3.p4.8.m8.1.2.2.3.2">𝑛</ci><ci id="S3.SS3.p4.8.m8.1.2.2.3.3.cmml" xref="S3.SS3.p4.8.m8.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p4.8.m8.1.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m8.1c">h_{nk}^{(i)}</annotation></semantics></math> and the text prototype <math id="S3.SS3.p4.9.m9.1" class="ltx_Math" alttext="\mathcal{P_{T}}^{j}" display="inline"><semantics id="S3.SS3.p4.9.m9.1a"><mmultiscripts id="S3.SS3.p4.9.m9.1.1" xref="S3.SS3.p4.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.9.m9.1.1.2.2" xref="S3.SS3.p4.9.m9.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.9.m9.1.1.2.3" xref="S3.SS3.p4.9.m9.1.1.2.3.cmml">𝒯</mi><mrow id="S3.SS3.p4.9.m9.1.1a" xref="S3.SS3.p4.9.m9.1.1.cmml"></mrow><mrow id="S3.SS3.p4.9.m9.1.1b" xref="S3.SS3.p4.9.m9.1.1.cmml"></mrow><mi id="S3.SS3.p4.9.m9.1.1.3" xref="S3.SS3.p4.9.m9.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m9.1b"><apply id="S3.SS3.p4.9.m9.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1">superscript</csymbol><apply id="S3.SS3.p4.9.m9.1.1.2.cmml" xref="S3.SS3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.2.1.cmml" xref="S3.SS3.p4.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p4.9.m9.1.1.2.2.cmml" xref="S3.SS3.p4.9.m9.1.1.2.2">𝒫</ci><ci id="S3.SS3.p4.9.m9.1.1.2.3.cmml" xref="S3.SS3.p4.9.m9.1.1.2.3">𝒯</ci></apply><ci id="S3.SS3.p4.9.m9.1.1.3.cmml" xref="S3.SS3.p4.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m9.1c">\mathcal{P_{T}}^{j}</annotation></semantics></math> are input into the subsequent modules.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.2" class="ltx_p">As for matching function <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="m(\cdot)" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.2" xref="S3.SS3.p5.1.m1.1.2.cmml"><mi id="S3.SS3.p5.1.m1.1.2.2" xref="S3.SS3.p5.1.m1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.2.1" xref="S3.SS3.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p5.1.m1.1.2.3.2" xref="S3.SS3.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p5.1.m1.1.2.3.2.1" xref="S3.SS3.p5.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.p5.1.m1.1.2.3.2.2" xref="S3.SS3.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.2"><times id="S3.SS3.p5.1.m1.1.2.1.cmml" xref="S3.SS3.p5.1.m1.1.2.1"></times><ci id="S3.SS3.p5.1.m1.1.2.2.cmml" xref="S3.SS3.p5.1.m1.1.2.2">𝑚</ci><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">m(\cdot)</annotation></semantics></math>, we propose both model-free and model-based matching.
Model-free matching involves matching the closest prototype for each representation using a distance metric, such as L1, L2 distance, or cosine similarity.
And model-based matching involves training tiny models, treating the search of cross-modal prototypes as either a classification or a retrieval task.
These tiny models are trained only in the final round of federated communication, incurring negligible overhead to the FL framework.
For the classification task, we train a shallow MLP-Classifier using cross-entropy loss.
For the retrieval task, inspired by DALLE<math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mo id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><ci id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">\cdot</annotation></semantics></math>2 <cite class="ltx_cite ltx_citemacro_citep">(Ramesh et al., <a href="#bib.bib27" title="" class="ltx_ref">2022</a>)</cite>, we sequentially use CLIP loss <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite> and MSE loss to train an MLP-Prior to achieve transfer and retrieval.
We attempt three aggregation strategies for tiny models from different clients: selecting the model with maximum client samples, model aggregation, and model ensemble.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.1" class="ltx_p">Inspired by MixUp <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2018</a>)</cite>, we propose ProtoMix to enrich the semantic information within prototypes used for inference. ProtoMix linearly combines the top-<math id="S3.SS3.p6.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p6.1.m1.1a"><mi id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><ci id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">k</annotation></semantics></math> related prototypes with weights derived from applying the Softmax function to distance metrics, classification probabilities, or retrieval match scores.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Prototypes as Learned Representation Targets</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">Due to the non-IID issue, the learned representation distributions in latent space significantly differ among clients (i.e., client drift), leading to an uncoordinated model aggregation.
To achieve model aggregation without conflicts, all clients must theoretically have similar local representation distributions.
In PmcmFL, prototypes are used as learned representation targets to guide clients in learning fused representation distributions clustered by class.
For this reason, we introduce a proximal term based on the unidirectional CLIP contrastive loss to regularize client training.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">Sampling a batch <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathcal{B}</annotation></semantics></math> from the local dataset, the proximal term can be denoted as:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.8" class="ltx_Math" alttext="L_{contr}=-\frac{1}{|\mathcal{B}|}\sum_{s=1}^{|\mathcal{B}|}\log\frac{\exp(h_{s}^{\top}\cdot\mathcal{P}_{s}/{\tau})}{\sum_{i=1}^{|\mathcal{B}|}\exp({h_{s}^{\top}\cdot\mathcal{P}_{i}}/{\tau})}," display="block"><semantics id="S3.E7.m1.8a"><mrow id="S3.E7.m1.8.8.1" xref="S3.E7.m1.8.8.1.1.cmml"><mrow id="S3.E7.m1.8.8.1.1" xref="S3.E7.m1.8.8.1.1.cmml"><msub id="S3.E7.m1.8.8.1.1.2" xref="S3.E7.m1.8.8.1.1.2.cmml"><mi id="S3.E7.m1.8.8.1.1.2.2" xref="S3.E7.m1.8.8.1.1.2.2.cmml">L</mi><mrow id="S3.E7.m1.8.8.1.1.2.3" xref="S3.E7.m1.8.8.1.1.2.3.cmml"><mi id="S3.E7.m1.8.8.1.1.2.3.2" xref="S3.E7.m1.8.8.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.1.1.2.3.1" xref="S3.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.8.8.1.1.2.3.3" xref="S3.E7.m1.8.8.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.1.1.2.3.1a" xref="S3.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.8.8.1.1.2.3.4" xref="S3.E7.m1.8.8.1.1.2.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.1.1.2.3.1b" xref="S3.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.8.8.1.1.2.3.5" xref="S3.E7.m1.8.8.1.1.2.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.1.1.2.3.1c" xref="S3.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.8.8.1.1.2.3.6" xref="S3.E7.m1.8.8.1.1.2.3.6.cmml">r</mi></mrow></msub><mo id="S3.E7.m1.8.8.1.1.1" xref="S3.E7.m1.8.8.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.8.8.1.1.3" xref="S3.E7.m1.8.8.1.1.3.cmml"><mo id="S3.E7.m1.8.8.1.1.3a" xref="S3.E7.m1.8.8.1.1.3.cmml">−</mo><mrow id="S3.E7.m1.8.8.1.1.3.2" xref="S3.E7.m1.8.8.1.1.3.2.cmml"><mfrac id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mn id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">1</mn><mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">ℬ</mi><mo stretchy="false" id="S3.E7.m1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.1.1.3.2.1" xref="S3.E7.m1.8.8.1.1.3.2.1.cmml">​</mo><mrow id="S3.E7.m1.8.8.1.1.3.2.2" xref="S3.E7.m1.8.8.1.1.3.2.2.cmml"><munderover id="S3.E7.m1.8.8.1.1.3.2.2.1" xref="S3.E7.m1.8.8.1.1.3.2.2.1.cmml"><mo movablelimits="false" id="S3.E7.m1.8.8.1.1.3.2.2.1.2.2" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.8.8.1.1.3.2.2.1.2.3" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.cmml"><mi id="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.2" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.2.cmml">s</mi><mo id="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.1" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.3" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.3.1" xref="S3.E7.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml">ℬ</mi><mo stretchy="false" id="S3.E7.m1.2.2.1.3.2" xref="S3.E7.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E7.m1.8.8.1.1.3.2.2.2" xref="S3.E7.m1.8.8.1.1.3.2.2.2.cmml"><mi id="S3.E7.m1.8.8.1.1.3.2.2.2.1" xref="S3.E7.m1.8.8.1.1.3.2.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E7.m1.8.8.1.1.3.2.2.2a" xref="S3.E7.m1.8.8.1.1.3.2.2.2.cmml">⁡</mo><mfrac id="S3.E7.m1.7.7" xref="S3.E7.m1.7.7.cmml"><mrow id="S3.E7.m1.4.4.2.2" xref="S3.E7.m1.4.4.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml">exp</mi><mo id="S3.E7.m1.4.4.2.2a" xref="S3.E7.m1.4.4.2.3.cmml">⁡</mo><mrow id="S3.E7.m1.4.4.2.2.1" xref="S3.E7.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.E7.m1.4.4.2.2.1.2" xref="S3.E7.m1.4.4.2.3.cmml">(</mo><mrow id="S3.E7.m1.4.4.2.2.1.1" xref="S3.E7.m1.4.4.2.2.1.1.cmml"><mrow id="S3.E7.m1.4.4.2.2.1.1.2" xref="S3.E7.m1.4.4.2.2.1.1.2.cmml"><msubsup id="S3.E7.m1.4.4.2.2.1.1.2.2" xref="S3.E7.m1.4.4.2.2.1.1.2.2.cmml"><mi id="S3.E7.m1.4.4.2.2.1.1.2.2.2.2" xref="S3.E7.m1.4.4.2.2.1.1.2.2.2.2.cmml">h</mi><mi id="S3.E7.m1.4.4.2.2.1.1.2.2.2.3" xref="S3.E7.m1.4.4.2.2.1.1.2.2.2.3.cmml">s</mi><mo id="S3.E7.m1.4.4.2.2.1.1.2.2.3" xref="S3.E7.m1.4.4.2.2.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.4.4.2.2.1.1.2.1" xref="S3.E7.m1.4.4.2.2.1.1.2.1.cmml">⋅</mo><msub id="S3.E7.m1.4.4.2.2.1.1.2.3" xref="S3.E7.m1.4.4.2.2.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.4.4.2.2.1.1.2.3.2" xref="S3.E7.m1.4.4.2.2.1.1.2.3.2.cmml">𝒫</mi><mi id="S3.E7.m1.4.4.2.2.1.1.2.3.3" xref="S3.E7.m1.4.4.2.2.1.1.2.3.3.cmml">s</mi></msub></mrow><mo id="S3.E7.m1.4.4.2.2.1.1.1" xref="S3.E7.m1.4.4.2.2.1.1.1.cmml">/</mo><mi id="S3.E7.m1.4.4.2.2.1.1.3" xref="S3.E7.m1.4.4.2.2.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E7.m1.4.4.2.2.1.3" xref="S3.E7.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E7.m1.7.7.5" xref="S3.E7.m1.7.7.5.cmml"><msubsup id="S3.E7.m1.7.7.5.4" xref="S3.E7.m1.7.7.5.4.cmml"><mo id="S3.E7.m1.7.7.5.4.2.2" xref="S3.E7.m1.7.7.5.4.2.2.cmml">∑</mo><mrow id="S3.E7.m1.7.7.5.4.2.3" xref="S3.E7.m1.7.7.5.4.2.3.cmml"><mi id="S3.E7.m1.7.7.5.4.2.3.2" xref="S3.E7.m1.7.7.5.4.2.3.2.cmml">i</mi><mo id="S3.E7.m1.7.7.5.4.2.3.1" xref="S3.E7.m1.7.7.5.4.2.3.1.cmml">=</mo><mn id="S3.E7.m1.7.7.5.4.2.3.3" xref="S3.E7.m1.7.7.5.4.2.3.3.cmml">1</mn></mrow><mrow id="S3.E7.m1.5.5.3.1.1.3" xref="S3.E7.m1.5.5.3.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.3.1.1.3.1" xref="S3.E7.m1.5.5.3.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.5.5.3.1.1.1" xref="S3.E7.m1.5.5.3.1.1.1.cmml">ℬ</mi><mo stretchy="false" id="S3.E7.m1.5.5.3.1.1.3.2" xref="S3.E7.m1.5.5.3.1.1.2.1.cmml">|</mo></mrow></msubsup><mrow id="S3.E7.m1.7.7.5.3.1" xref="S3.E7.m1.7.7.5.3.2.cmml"><mi id="S3.E7.m1.6.6.4.2" xref="S3.E7.m1.6.6.4.2.cmml">exp</mi><mo id="S3.E7.m1.7.7.5.3.1a" xref="S3.E7.m1.7.7.5.3.2.cmml">⁡</mo><mrow id="S3.E7.m1.7.7.5.3.1.1" xref="S3.E7.m1.7.7.5.3.2.cmml"><mo stretchy="false" id="S3.E7.m1.7.7.5.3.1.1.2" xref="S3.E7.m1.7.7.5.3.2.cmml">(</mo><mrow id="S3.E7.m1.7.7.5.3.1.1.1" xref="S3.E7.m1.7.7.5.3.1.1.1.cmml"><mrow id="S3.E7.m1.7.7.5.3.1.1.1.2" xref="S3.E7.m1.7.7.5.3.1.1.1.2.cmml"><msubsup id="S3.E7.m1.7.7.5.3.1.1.1.2.2" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2.cmml"><mi id="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.2" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.2.cmml">h</mi><mi id="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.3" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.3.cmml">s</mi><mo id="S3.E7.m1.7.7.5.3.1.1.1.2.2.3" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.7.7.5.3.1.1.1.2.1" xref="S3.E7.m1.7.7.5.3.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E7.m1.7.7.5.3.1.1.1.2.3" xref="S3.E7.m1.7.7.5.3.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.7.7.5.3.1.1.1.2.3.2" xref="S3.E7.m1.7.7.5.3.1.1.1.2.3.2.cmml">𝒫</mi><mi id="S3.E7.m1.7.7.5.3.1.1.1.2.3.3" xref="S3.E7.m1.7.7.5.3.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E7.m1.7.7.5.3.1.1.1.1" xref="S3.E7.m1.7.7.5.3.1.1.1.1.cmml">/</mo><mi id="S3.E7.m1.7.7.5.3.1.1.1.3" xref="S3.E7.m1.7.7.5.3.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E7.m1.7.7.5.3.1.1.3" xref="S3.E7.m1.7.7.5.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.8.8.1.2" xref="S3.E7.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.8b"><apply id="S3.E7.m1.8.8.1.1.cmml" xref="S3.E7.m1.8.8.1"><eq id="S3.E7.m1.8.8.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1"></eq><apply id="S3.E7.m1.8.8.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.2.1.cmml" xref="S3.E7.m1.8.8.1.1.2">subscript</csymbol><ci id="S3.E7.m1.8.8.1.1.2.2.cmml" xref="S3.E7.m1.8.8.1.1.2.2">𝐿</ci><apply id="S3.E7.m1.8.8.1.1.2.3.cmml" xref="S3.E7.m1.8.8.1.1.2.3"><times id="S3.E7.m1.8.8.1.1.2.3.1.cmml" xref="S3.E7.m1.8.8.1.1.2.3.1"></times><ci id="S3.E7.m1.8.8.1.1.2.3.2.cmml" xref="S3.E7.m1.8.8.1.1.2.3.2">𝑐</ci><ci id="S3.E7.m1.8.8.1.1.2.3.3.cmml" xref="S3.E7.m1.8.8.1.1.2.3.3">𝑜</ci><ci id="S3.E7.m1.8.8.1.1.2.3.4.cmml" xref="S3.E7.m1.8.8.1.1.2.3.4">𝑛</ci><ci id="S3.E7.m1.8.8.1.1.2.3.5.cmml" xref="S3.E7.m1.8.8.1.1.2.3.5">𝑡</ci><ci id="S3.E7.m1.8.8.1.1.2.3.6.cmml" xref="S3.E7.m1.8.8.1.1.2.3.6">𝑟</ci></apply></apply><apply id="S3.E7.m1.8.8.1.1.3.cmml" xref="S3.E7.m1.8.8.1.1.3"><minus id="S3.E7.m1.8.8.1.1.3.1.cmml" xref="S3.E7.m1.8.8.1.1.3"></minus><apply id="S3.E7.m1.8.8.1.1.3.2.cmml" xref="S3.E7.m1.8.8.1.1.3.2"><times id="S3.E7.m1.8.8.1.1.3.2.1.cmml" xref="S3.E7.m1.8.8.1.1.3.2.1"></times><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><divide id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1"></divide><cn type="integer" id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3">1</cn><apply id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.3"><abs id="S3.E7.m1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.3.1"></abs><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">ℬ</ci></apply></apply><apply id="S3.E7.m1.8.8.1.1.3.2.2.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2"><apply id="S3.E7.m1.8.8.1.1.3.2.2.1.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.3.2.2.1.1.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1">superscript</csymbol><apply id="S3.E7.m1.8.8.1.1.3.2.2.1.2.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.3.2.2.1.2.1.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1">subscript</csymbol><sum id="S3.E7.m1.8.8.1.1.3.2.2.1.2.2.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.2"></sum><apply id="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.3"><eq id="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.1.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.1"></eq><ci id="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.2.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.2">𝑠</ci><cn type="integer" id="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.3.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.3"><abs id="S3.E7.m1.2.2.1.2.1.cmml" xref="S3.E7.m1.2.2.1.3.1"></abs><ci id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1">ℬ</ci></apply></apply><apply id="S3.E7.m1.8.8.1.1.3.2.2.2.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.2"><log id="S3.E7.m1.8.8.1.1.3.2.2.2.1.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2.2.1"></log><apply id="S3.E7.m1.7.7.cmml" xref="S3.E7.m1.7.7"><divide id="S3.E7.m1.7.7.6.cmml" xref="S3.E7.m1.7.7"></divide><apply id="S3.E7.m1.4.4.2.3.cmml" xref="S3.E7.m1.4.4.2.2"><exp id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1"></exp><apply id="S3.E7.m1.4.4.2.2.1.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1"><divide id="S3.E7.m1.4.4.2.2.1.1.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1"></divide><apply id="S3.E7.m1.4.4.2.2.1.1.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2"><ci id="S3.E7.m1.4.4.2.2.1.1.2.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.1">⋅</ci><apply id="S3.E7.m1.4.4.2.2.1.1.2.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.2.2.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.2">superscript</csymbol><apply id="S3.E7.m1.4.4.2.2.1.1.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.2.2.2.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.1.1.2.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.2.2.2">ℎ</ci><ci id="S3.E7.m1.4.4.2.2.1.1.2.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.2.2.3">𝑠</ci></apply><csymbol cd="latexml" id="S3.E7.m1.4.4.2.2.1.1.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.2.3">top</csymbol></apply><apply id="S3.E7.m1.4.4.2.2.1.1.2.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.2.3.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.1.1.2.3.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.3.2">𝒫</ci><ci id="S3.E7.m1.4.4.2.2.1.1.2.3.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2.3.3">𝑠</ci></apply></apply><ci id="S3.E7.m1.4.4.2.2.1.1.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.3">𝜏</ci></apply></apply><apply id="S3.E7.m1.7.7.5.cmml" xref="S3.E7.m1.7.7.5"><apply id="S3.E7.m1.7.7.5.4.cmml" xref="S3.E7.m1.7.7.5.4"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.5.4.1.cmml" xref="S3.E7.m1.7.7.5.4">superscript</csymbol><apply id="S3.E7.m1.7.7.5.4.2.cmml" xref="S3.E7.m1.7.7.5.4"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.5.4.2.1.cmml" xref="S3.E7.m1.7.7.5.4">subscript</csymbol><sum id="S3.E7.m1.7.7.5.4.2.2.cmml" xref="S3.E7.m1.7.7.5.4.2.2"></sum><apply id="S3.E7.m1.7.7.5.4.2.3.cmml" xref="S3.E7.m1.7.7.5.4.2.3"><eq id="S3.E7.m1.7.7.5.4.2.3.1.cmml" xref="S3.E7.m1.7.7.5.4.2.3.1"></eq><ci id="S3.E7.m1.7.7.5.4.2.3.2.cmml" xref="S3.E7.m1.7.7.5.4.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.7.7.5.4.2.3.3.cmml" xref="S3.E7.m1.7.7.5.4.2.3.3">1</cn></apply></apply><apply id="S3.E7.m1.5.5.3.1.1.2.cmml" xref="S3.E7.m1.5.5.3.1.1.3"><abs id="S3.E7.m1.5.5.3.1.1.2.1.cmml" xref="S3.E7.m1.5.5.3.1.1.3.1"></abs><ci id="S3.E7.m1.5.5.3.1.1.1.cmml" xref="S3.E7.m1.5.5.3.1.1.1">ℬ</ci></apply></apply><apply id="S3.E7.m1.7.7.5.3.2.cmml" xref="S3.E7.m1.7.7.5.3.1"><exp id="S3.E7.m1.6.6.4.2.cmml" xref="S3.E7.m1.6.6.4.2"></exp><apply id="S3.E7.m1.7.7.5.3.1.1.1.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1"><divide id="S3.E7.m1.7.7.5.3.1.1.1.1.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.1"></divide><apply id="S3.E7.m1.7.7.5.3.1.1.1.2.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2"><ci id="S3.E7.m1.7.7.5.3.1.1.1.2.1.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.1">⋅</ci><apply id="S3.E7.m1.7.7.5.3.1.1.1.2.2.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.5.3.1.1.1.2.2.1.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2">superscript</csymbol><apply id="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.2">ℎ</ci><ci id="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2.2.3">𝑠</ci></apply><csymbol cd="latexml" id="S3.E7.m1.7.7.5.3.1.1.1.2.2.3.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.2.3">top</csymbol></apply><apply id="S3.E7.m1.7.7.5.3.1.1.1.2.3.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.5.3.1.1.1.2.3.1.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.7.7.5.3.1.1.1.2.3.2.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.3.2">𝒫</ci><ci id="S3.E7.m1.7.7.5.3.1.1.1.2.3.3.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.E7.m1.7.7.5.3.1.1.1.3.cmml" xref="S3.E7.m1.7.7.5.3.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.8c">L_{contr}=-\frac{1}{|\mathcal{B}|}\sum_{s=1}^{|\mathcal{B}|}\log\frac{\exp(h_{s}^{\top}\cdot\mathcal{P}_{s}/{\tau})}{\sum_{i=1}^{|\mathcal{B}|}\exp({h_{s}^{\top}\cdot\mathcal{P}_{i}}/{\tau})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.5" class="ltx_p">where <math id="S3.SS4.p2.2.m1.1" class="ltx_Math" alttext="h_{s}" display="inline"><semantics id="S3.SS4.p2.2.m1.1a"><msub id="S3.SS4.p2.2.m1.1.1" xref="S3.SS4.p2.2.m1.1.1.cmml"><mi id="S3.SS4.p2.2.m1.1.1.2" xref="S3.SS4.p2.2.m1.1.1.2.cmml">h</mi><mi id="S3.SS4.p2.2.m1.1.1.3" xref="S3.SS4.p2.2.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m1.1b"><apply id="S3.SS4.p2.2.m1.1.1.cmml" xref="S3.SS4.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m1.1.1.1.cmml" xref="S3.SS4.p2.2.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m1.1.1.2.cmml" xref="S3.SS4.p2.2.m1.1.1.2">ℎ</ci><ci id="S3.SS4.p2.2.m1.1.1.3.cmml" xref="S3.SS4.p2.2.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m1.1c">h_{s}</annotation></semantics></math> is the <math id="S3.SS4.p2.3.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS4.p2.3.m2.1a"><mi id="S3.SS4.p2.3.m2.1.1" xref="S3.SS4.p2.3.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m2.1b"><ci id="S3.SS4.p2.3.m2.1.1.cmml" xref="S3.SS4.p2.3.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m2.1c">s</annotation></semantics></math>-th representation in batch, <math id="S3.SS4.p2.4.m3.1" class="ltx_Math" alttext="\mathcal{P}_{s}" display="inline"><semantics id="S3.SS4.p2.4.m3.1a"><msub id="S3.SS4.p2.4.m3.1.1" xref="S3.SS4.p2.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.4.m3.1.1.2" xref="S3.SS4.p2.4.m3.1.1.2.cmml">𝒫</mi><mi id="S3.SS4.p2.4.m3.1.1.3" xref="S3.SS4.p2.4.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m3.1b"><apply id="S3.SS4.p2.4.m3.1.1.cmml" xref="S3.SS4.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m3.1.1.1.cmml" xref="S3.SS4.p2.4.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m3.1.1.2.cmml" xref="S3.SS4.p2.4.m3.1.1.2">𝒫</ci><ci id="S3.SS4.p2.4.m3.1.1.3.cmml" xref="S3.SS4.p2.4.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m3.1c">\mathcal{P}_{s}</annotation></semantics></math> is its corresponding prototype, and <math id="S3.SS4.p2.5.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS4.p2.5.m4.1a"><mi id="S3.SS4.p2.5.m4.1.1" xref="S3.SS4.p2.5.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m4.1b"><ci id="S3.SS4.p2.5.m4.1.1.cmml" xref="S3.SS4.p2.5.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m4.1c">\tau</annotation></semantics></math> is a temperature factor.
As the global model gradually converges, the prototypes converge step by step.
This proximal term works by pulling representations closer to the prototypes of the same class and pushing representations away from prototypes of different classes so that the learned representations are around the corresponding global prototypes.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.3" class="ltx_p">Since prototypes are the centroids of class representations, maintaining a certain distance (i.e., fine-grained semantic difference) from each representation, we use CLIP loss to constrain their similarities rather than relying on MSE to constrain their distances.
Although the prototype-based proximal term can theoretically be constructed on image representations, text representations, and fused representations separately, we only utilize the last one due to the difficulty in coordinating multiple proximal terms.
In this case, the total training loss for each client is the sum of task loss and contrastive loss of fused representations:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="L=L_{task}+\gamma L_{contr}^{f}," display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml">L</mi><mo id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><msub id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.cmml">L</mi><mrow id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.3.2" xref="S3.E8.m1.1.1.1.1.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.2.3.1" xref="S3.E8.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.2.3.3" xref="S3.E8.m1.1.1.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.2.3.1a" xref="S3.E8.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.2.3.4" xref="S3.E8.m1.1.1.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.2.3.1b" xref="S3.E8.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.2.3.5" xref="S3.E8.m1.1.1.1.1.3.2.3.5.cmml">k</mi></mrow></msub><mo id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.3.3.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.3.1" xref="S3.E8.m1.1.1.1.1.3.3.1.cmml">​</mo><msubsup id="S3.E8.m1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.3.2.2" xref="S3.E8.m1.1.1.1.1.3.3.3.2.2.cmml">L</mi><mrow id="S3.E8.m1.1.1.1.1.3.3.3.2.3" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.3.2.3.2" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.3.3.2.3.1" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.3.3.2.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.3.3.2.3.1a" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.3.3.2.3.4" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.3.3.2.3.1b" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.3.3.2.3.5" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.3.3.2.3.1c" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.3.3.3.2.3.6" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.6.cmml">r</mi></mrow><mi id="S3.E8.m1.1.1.1.1.3.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.3.cmml">f</mi></msubsup></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><ci id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2">𝐿</ci><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><plus id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2">𝐿</ci><apply id="S3.E8.m1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3"><times id="S3.E8.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2">𝑡</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.3">𝑎</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.4">𝑠</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.5.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.5">𝑘</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><times id="S3.E8.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.1"></times><ci id="S3.E8.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2">𝛾</ci><apply id="S3.E8.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.2">𝐿</ci><apply id="S3.E8.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3"><times id="S3.E8.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.2">𝑐</ci><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.3">𝑜</ci><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.3.4.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.4">𝑛</ci><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.3.5.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.5">𝑡</ci><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.3.6.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.6">𝑟</ci></apply></apply><ci id="S3.E8.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.3">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">L=L_{task}+\gamma L_{contr}^{f},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p3.2" class="ltx_p">where <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\gamma</annotation></semantics></math> is the weighting hyper parameter for <math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="L_{contr}^{f}" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><msubsup id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.2.2.cmml">L</mi><mrow id="S3.SS4.p3.2.m2.1.1.2.3" xref="S3.SS4.p3.2.m2.1.1.2.3.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.3.2" xref="S3.SS4.p3.2.m2.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.m2.1.1.2.3.1" xref="S3.SS4.p3.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p3.2.m2.1.1.2.3.3" xref="S3.SS4.p3.2.m2.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.m2.1.1.2.3.1a" xref="S3.SS4.p3.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p3.2.m2.1.1.2.3.4" xref="S3.SS4.p3.2.m2.1.1.2.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.m2.1.1.2.3.1b" xref="S3.SS4.p3.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p3.2.m2.1.1.2.3.5" xref="S3.SS4.p3.2.m2.1.1.2.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.m2.1.1.2.3.1c" xref="S3.SS4.p3.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p3.2.m2.1.1.2.3.6" xref="S3.SS4.p3.2.m2.1.1.2.3.6.cmml">r</mi></mrow><mi id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml">f</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">superscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.2">𝐿</ci><apply id="S3.SS4.p3.2.m2.1.1.2.3.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3"><times id="S3.SS4.p3.2.m2.1.1.2.3.1.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3.1"></times><ci id="S3.SS4.p3.2.m2.1.1.2.3.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3.2">𝑐</ci><ci id="S3.SS4.p3.2.m2.1.1.2.3.3.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3.3">𝑜</ci><ci id="S3.SS4.p3.2.m2.1.1.2.3.4.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3.4">𝑛</ci><ci id="S3.SS4.p3.2.m2.1.1.2.3.5.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3.5">𝑡</ci><ci id="S3.SS4.p3.2.m2.1.1.2.3.6.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3.6">𝑟</ci></apply></apply><ci id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">L_{contr}^{f}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>

<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of PmcmFL with baselines under various missing rates.
Modality missing occurs only in the training phase, and the data in the inference phase is modality-complete.
* denotes the PmcmFL’s performance is significantly better than existing baselines (paired t-test, <math id="S4.T1.2.m1.1" class="ltx_Math" alttext="p&lt;0.05" display="inline"><semantics id="S4.T1.2.m1.1b"><mrow id="S4.T1.2.m1.1.1" xref="S4.T1.2.m1.1.1.cmml"><mi id="S4.T1.2.m1.1.1.2" xref="S4.T1.2.m1.1.1.2.cmml">p</mi><mo id="S4.T1.2.m1.1.1.1" xref="S4.T1.2.m1.1.1.1.cmml">&lt;</mo><mn id="S4.T1.2.m1.1.1.3" xref="S4.T1.2.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.m1.1c"><apply id="S4.T1.2.m1.1.1.cmml" xref="S4.T1.2.m1.1.1"><lt id="S4.T1.2.m1.1.1.1.cmml" xref="S4.T1.2.m1.1.1.1"></lt><ci id="S4.T1.2.m1.1.1.2.cmml" xref="S4.T1.2.m1.1.1.2">𝑝</ci><cn type="float" id="S4.T1.2.m1.1.1.3.cmml" xref="S4.T1.2.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.m1.1d">p&lt;0.05</annotation></semantics></math>).
RM denotes Random Mask.</figcaption>
<div id="S4.T1.8.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:440.4pt;height:195.3pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-24.5pt,10.8pt) scale(0.9,0.9) ;">
<table id="S4.T1.8.6.6" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.3.1.1.1" class="ltx_tr">
<th id="S4.T1.3.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T1.3.1.1.1.2.1" class="ltx_text">Methods</span></th>
<td id="S4.T1.3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">Accuracy (%) on 5K Testing Samples (<math id="S4.T1.3.1.1.1.1.m1.1" class="ltx_Math" alttext="\rho_{test}=0" display="inline"><semantics id="S4.T1.3.1.1.1.1.m1.1a"><mrow id="S4.T1.3.1.1.1.1.m1.1.1" xref="S4.T1.3.1.1.1.1.m1.1.1.cmml"><msub id="S4.T1.3.1.1.1.1.m1.1.1.2" xref="S4.T1.3.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.T1.3.1.1.1.1.m1.1.1.2.2" xref="S4.T1.3.1.1.1.1.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T1.3.1.1.1.1.m1.1.1.2.3" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.cmml"><mi id="S4.T1.3.1.1.1.1.m1.1.1.2.3.2" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T1.3.1.1.1.1.m1.1.1.2.3.1" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.3.1.1.1.1.m1.1.1.2.3.3" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.T1.3.1.1.1.1.m1.1.1.2.3.1a" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.3.1.1.1.1.m1.1.1.2.3.4" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T1.3.1.1.1.1.m1.1.1.2.3.1b" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.3.1.1.1.1.m1.1.1.2.3.5" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.5.cmml">t</mi></mrow></msub><mo id="S4.T1.3.1.1.1.1.m1.1.1.1" xref="S4.T1.3.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.3.1.1.1.1.m1.1.1.3" xref="S4.T1.3.1.1.1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.1.1.m1.1b"><apply id="S4.T1.3.1.1.1.1.m1.1.1.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1"><eq id="S4.T1.3.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.1"></eq><apply id="S4.T1.3.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.3.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S4.T1.3.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2.2">𝜌</ci><apply id="S4.T1.3.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3"><times id="S4.T1.3.1.1.1.1.m1.1.1.2.3.1.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.1"></times><ci id="S4.T1.3.1.1.1.1.m1.1.1.2.3.2.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T1.3.1.1.1.1.m1.1.1.2.3.3.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.3">𝑒</ci><ci id="S4.T1.3.1.1.1.1.m1.1.1.2.3.4.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.4">𝑠</ci><ci id="S4.T1.3.1.1.1.1.m1.1.1.2.3.5.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.2.3.5">𝑡</ci></apply></apply><cn type="integer" id="S4.T1.3.1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.1.1.m1.1c">\rho_{test}=0</annotation></semantics></math>)</td>
<td id="S4.T1.3.1.1.1.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" rowspan="2"><span id="S4.T1.3.1.1.1.3.1" class="ltx_text"> Acc@sum</span></td>
</tr>
<tr id="S4.T1.8.6.6.6" class="ltx_tr">
<td id="S4.T1.4.2.2.2.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.4.2.2.2.1.m1.1" class="ltx_Math" alttext="\rho_{train}=10\%" display="inline"><semantics id="S4.T1.4.2.2.2.1.m1.1a"><mrow id="S4.T1.4.2.2.2.1.m1.1.1" xref="S4.T1.4.2.2.2.1.m1.1.1.cmml"><msub id="S4.T1.4.2.2.2.1.m1.1.1.2" xref="S4.T1.4.2.2.2.1.m1.1.1.2.cmml"><mi id="S4.T1.4.2.2.2.1.m1.1.1.2.2" xref="S4.T1.4.2.2.2.1.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T1.4.2.2.2.1.m1.1.1.2.3" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.cmml"><mi id="S4.T1.4.2.2.2.1.m1.1.1.2.3.2" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.2.2.2.1.m1.1.1.2.3.1" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.4.2.2.2.1.m1.1.1.2.3.3" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.2.2.2.1.m1.1.1.2.3.1a" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.4.2.2.2.1.m1.1.1.2.3.4" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.2.2.2.1.m1.1.1.2.3.1b" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.4.2.2.2.1.m1.1.1.2.3.5" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T1.4.2.2.2.1.m1.1.1.2.3.1c" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.4.2.2.2.1.m1.1.1.2.3.6" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T1.4.2.2.2.1.m1.1.1.1" xref="S4.T1.4.2.2.2.1.m1.1.1.1.cmml">=</mo><mrow id="S4.T1.4.2.2.2.1.m1.1.1.3" xref="S4.T1.4.2.2.2.1.m1.1.1.3.cmml"><mn id="S4.T1.4.2.2.2.1.m1.1.1.3.2" xref="S4.T1.4.2.2.2.1.m1.1.1.3.2.cmml">10</mn><mo id="S4.T1.4.2.2.2.1.m1.1.1.3.1" xref="S4.T1.4.2.2.2.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.2.2.2.1.m1.1b"><apply id="S4.T1.4.2.2.2.1.m1.1.1.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1"><eq id="S4.T1.4.2.2.2.1.m1.1.1.1.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.1"></eq><apply id="S4.T1.4.2.2.2.1.m1.1.1.2.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.4.2.2.2.1.m1.1.1.2.1.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2">subscript</csymbol><ci id="S4.T1.4.2.2.2.1.m1.1.1.2.2.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2.2">𝜌</ci><apply id="S4.T1.4.2.2.2.1.m1.1.1.2.3.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3"><times id="S4.T1.4.2.2.2.1.m1.1.1.2.3.1.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.1"></times><ci id="S4.T1.4.2.2.2.1.m1.1.1.2.3.2.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T1.4.2.2.2.1.m1.1.1.2.3.3.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T1.4.2.2.2.1.m1.1.1.2.3.4.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T1.4.2.2.2.1.m1.1.1.2.3.5.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T1.4.2.2.2.1.m1.1.1.2.3.6.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T1.4.2.2.2.1.m1.1.1.3.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T1.4.2.2.2.1.m1.1.1.3.1.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T1.4.2.2.2.1.m1.1.1.3.2.cmml" xref="S4.T1.4.2.2.2.1.m1.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.2.2.2.1.m1.1c">\rho_{train}=10\%</annotation></semantics></math></td>
<td id="S4.T1.5.3.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.5.3.3.3.2.m1.1" class="ltx_Math" alttext="\rho_{train}=20\%" display="inline"><semantics id="S4.T1.5.3.3.3.2.m1.1a"><mrow id="S4.T1.5.3.3.3.2.m1.1.1" xref="S4.T1.5.3.3.3.2.m1.1.1.cmml"><msub id="S4.T1.5.3.3.3.2.m1.1.1.2" xref="S4.T1.5.3.3.3.2.m1.1.1.2.cmml"><mi id="S4.T1.5.3.3.3.2.m1.1.1.2.2" xref="S4.T1.5.3.3.3.2.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T1.5.3.3.3.2.m1.1.1.2.3" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.cmml"><mi id="S4.T1.5.3.3.3.2.m1.1.1.2.3.2" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T1.5.3.3.3.2.m1.1.1.2.3.1" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.5.3.3.3.2.m1.1.1.2.3.3" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T1.5.3.3.3.2.m1.1.1.2.3.1a" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.5.3.3.3.2.m1.1.1.2.3.4" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T1.5.3.3.3.2.m1.1.1.2.3.1b" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.5.3.3.3.2.m1.1.1.2.3.5" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T1.5.3.3.3.2.m1.1.1.2.3.1c" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.5.3.3.3.2.m1.1.1.2.3.6" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T1.5.3.3.3.2.m1.1.1.1" xref="S4.T1.5.3.3.3.2.m1.1.1.1.cmml">=</mo><mrow id="S4.T1.5.3.3.3.2.m1.1.1.3" xref="S4.T1.5.3.3.3.2.m1.1.1.3.cmml"><mn id="S4.T1.5.3.3.3.2.m1.1.1.3.2" xref="S4.T1.5.3.3.3.2.m1.1.1.3.2.cmml">20</mn><mo id="S4.T1.5.3.3.3.2.m1.1.1.3.1" xref="S4.T1.5.3.3.3.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.3.3.3.2.m1.1b"><apply id="S4.T1.5.3.3.3.2.m1.1.1.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1"><eq id="S4.T1.5.3.3.3.2.m1.1.1.1.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.1"></eq><apply id="S4.T1.5.3.3.3.2.m1.1.1.2.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.5.3.3.3.2.m1.1.1.2.1.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2">subscript</csymbol><ci id="S4.T1.5.3.3.3.2.m1.1.1.2.2.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2.2">𝜌</ci><apply id="S4.T1.5.3.3.3.2.m1.1.1.2.3.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3"><times id="S4.T1.5.3.3.3.2.m1.1.1.2.3.1.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.1"></times><ci id="S4.T1.5.3.3.3.2.m1.1.1.2.3.2.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T1.5.3.3.3.2.m1.1.1.2.3.3.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T1.5.3.3.3.2.m1.1.1.2.3.4.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T1.5.3.3.3.2.m1.1.1.2.3.5.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T1.5.3.3.3.2.m1.1.1.2.3.6.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T1.5.3.3.3.2.m1.1.1.3.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.3"><csymbol cd="latexml" id="S4.T1.5.3.3.3.2.m1.1.1.3.1.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T1.5.3.3.3.2.m1.1.1.3.2.cmml" xref="S4.T1.5.3.3.3.2.m1.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.3.3.3.2.m1.1c">\rho_{train}=20\%</annotation></semantics></math></td>
<td id="S4.T1.6.4.4.4.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.6.4.4.4.3.m1.1" class="ltx_Math" alttext="\rho_{train}=30\%" display="inline"><semantics id="S4.T1.6.4.4.4.3.m1.1a"><mrow id="S4.T1.6.4.4.4.3.m1.1.1" xref="S4.T1.6.4.4.4.3.m1.1.1.cmml"><msub id="S4.T1.6.4.4.4.3.m1.1.1.2" xref="S4.T1.6.4.4.4.3.m1.1.1.2.cmml"><mi id="S4.T1.6.4.4.4.3.m1.1.1.2.2" xref="S4.T1.6.4.4.4.3.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T1.6.4.4.4.3.m1.1.1.2.3" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.cmml"><mi id="S4.T1.6.4.4.4.3.m1.1.1.2.3.2" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T1.6.4.4.4.3.m1.1.1.2.3.1" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.6.4.4.4.3.m1.1.1.2.3.3" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T1.6.4.4.4.3.m1.1.1.2.3.1a" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.6.4.4.4.3.m1.1.1.2.3.4" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T1.6.4.4.4.3.m1.1.1.2.3.1b" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.6.4.4.4.3.m1.1.1.2.3.5" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T1.6.4.4.4.3.m1.1.1.2.3.1c" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.6.4.4.4.3.m1.1.1.2.3.6" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T1.6.4.4.4.3.m1.1.1.1" xref="S4.T1.6.4.4.4.3.m1.1.1.1.cmml">=</mo><mrow id="S4.T1.6.4.4.4.3.m1.1.1.3" xref="S4.T1.6.4.4.4.3.m1.1.1.3.cmml"><mn id="S4.T1.6.4.4.4.3.m1.1.1.3.2" xref="S4.T1.6.4.4.4.3.m1.1.1.3.2.cmml">30</mn><mo id="S4.T1.6.4.4.4.3.m1.1.1.3.1" xref="S4.T1.6.4.4.4.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.4.4.4.3.m1.1b"><apply id="S4.T1.6.4.4.4.3.m1.1.1.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1"><eq id="S4.T1.6.4.4.4.3.m1.1.1.1.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.1"></eq><apply id="S4.T1.6.4.4.4.3.m1.1.1.2.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.6.4.4.4.3.m1.1.1.2.1.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2">subscript</csymbol><ci id="S4.T1.6.4.4.4.3.m1.1.1.2.2.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2.2">𝜌</ci><apply id="S4.T1.6.4.4.4.3.m1.1.1.2.3.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3"><times id="S4.T1.6.4.4.4.3.m1.1.1.2.3.1.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.1"></times><ci id="S4.T1.6.4.4.4.3.m1.1.1.2.3.2.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T1.6.4.4.4.3.m1.1.1.2.3.3.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T1.6.4.4.4.3.m1.1.1.2.3.4.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T1.6.4.4.4.3.m1.1.1.2.3.5.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T1.6.4.4.4.3.m1.1.1.2.3.6.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T1.6.4.4.4.3.m1.1.1.3.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T1.6.4.4.4.3.m1.1.1.3.1.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T1.6.4.4.4.3.m1.1.1.3.2.cmml" xref="S4.T1.6.4.4.4.3.m1.1.1.3.2">30</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.4.4.4.3.m1.1c">\rho_{train}=30\%</annotation></semantics></math></td>
<td id="S4.T1.7.5.5.5.4" class="ltx_td ltx_align_center ltx_border_t">
<math id="S4.T1.7.5.5.5.4.m1.1" class="ltx_Math" alttext="\rho_{train}=40\%" display="inline"><semantics id="S4.T1.7.5.5.5.4.m1.1a"><mrow id="S4.T1.7.5.5.5.4.m1.1.1" xref="S4.T1.7.5.5.5.4.m1.1.1.cmml"><msub id="S4.T1.7.5.5.5.4.m1.1.1.2" xref="S4.T1.7.5.5.5.4.m1.1.1.2.cmml"><mi id="S4.T1.7.5.5.5.4.m1.1.1.2.2" xref="S4.T1.7.5.5.5.4.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T1.7.5.5.5.4.m1.1.1.2.3" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.cmml"><mi id="S4.T1.7.5.5.5.4.m1.1.1.2.3.2" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T1.7.5.5.5.4.m1.1.1.2.3.1" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.7.5.5.5.4.m1.1.1.2.3.3" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T1.7.5.5.5.4.m1.1.1.2.3.1a" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.7.5.5.5.4.m1.1.1.2.3.4" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T1.7.5.5.5.4.m1.1.1.2.3.1b" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.7.5.5.5.4.m1.1.1.2.3.5" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T1.7.5.5.5.4.m1.1.1.2.3.1c" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.7.5.5.5.4.m1.1.1.2.3.6" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T1.7.5.5.5.4.m1.1.1.1" xref="S4.T1.7.5.5.5.4.m1.1.1.1.cmml">=</mo><mrow id="S4.T1.7.5.5.5.4.m1.1.1.3" xref="S4.T1.7.5.5.5.4.m1.1.1.3.cmml"><mn id="S4.T1.7.5.5.5.4.m1.1.1.3.2" xref="S4.T1.7.5.5.5.4.m1.1.1.3.2.cmml">40</mn><mo id="S4.T1.7.5.5.5.4.m1.1.1.3.1" xref="S4.T1.7.5.5.5.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.5.5.5.4.m1.1b"><apply id="S4.T1.7.5.5.5.4.m1.1.1.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1"><eq id="S4.T1.7.5.5.5.4.m1.1.1.1.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.1"></eq><apply id="S4.T1.7.5.5.5.4.m1.1.1.2.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.7.5.5.5.4.m1.1.1.2.1.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2">subscript</csymbol><ci id="S4.T1.7.5.5.5.4.m1.1.1.2.2.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2.2">𝜌</ci><apply id="S4.T1.7.5.5.5.4.m1.1.1.2.3.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3"><times id="S4.T1.7.5.5.5.4.m1.1.1.2.3.1.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.1"></times><ci id="S4.T1.7.5.5.5.4.m1.1.1.2.3.2.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T1.7.5.5.5.4.m1.1.1.2.3.3.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T1.7.5.5.5.4.m1.1.1.2.3.4.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T1.7.5.5.5.4.m1.1.1.2.3.5.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T1.7.5.5.5.4.m1.1.1.2.3.6.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T1.7.5.5.5.4.m1.1.1.3.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.3"><csymbol cd="latexml" id="S4.T1.7.5.5.5.4.m1.1.1.3.1.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T1.7.5.5.5.4.m1.1.1.3.2.cmml" xref="S4.T1.7.5.5.5.4.m1.1.1.3.2">40</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.5.5.5.4.m1.1c">\rho_{train}=40\%</annotation></semantics></math>g</td>
<td id="S4.T1.8.6.6.6.5" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.8.6.6.6.5.m1.1" class="ltx_Math" alttext="\rho_{train}=50\%" display="inline"><semantics id="S4.T1.8.6.6.6.5.m1.1a"><mrow id="S4.T1.8.6.6.6.5.m1.1.1" xref="S4.T1.8.6.6.6.5.m1.1.1.cmml"><msub id="S4.T1.8.6.6.6.5.m1.1.1.2" xref="S4.T1.8.6.6.6.5.m1.1.1.2.cmml"><mi id="S4.T1.8.6.6.6.5.m1.1.1.2.2" xref="S4.T1.8.6.6.6.5.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T1.8.6.6.6.5.m1.1.1.2.3" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.cmml"><mi id="S4.T1.8.6.6.6.5.m1.1.1.2.3.2" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T1.8.6.6.6.5.m1.1.1.2.3.1" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.8.6.6.6.5.m1.1.1.2.3.3" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T1.8.6.6.6.5.m1.1.1.2.3.1a" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.8.6.6.6.5.m1.1.1.2.3.4" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T1.8.6.6.6.5.m1.1.1.2.3.1b" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.8.6.6.6.5.m1.1.1.2.3.5" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T1.8.6.6.6.5.m1.1.1.2.3.1c" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T1.8.6.6.6.5.m1.1.1.2.3.6" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T1.8.6.6.6.5.m1.1.1.1" xref="S4.T1.8.6.6.6.5.m1.1.1.1.cmml">=</mo><mrow id="S4.T1.8.6.6.6.5.m1.1.1.3" xref="S4.T1.8.6.6.6.5.m1.1.1.3.cmml"><mn id="S4.T1.8.6.6.6.5.m1.1.1.3.2" xref="S4.T1.8.6.6.6.5.m1.1.1.3.2.cmml">50</mn><mo id="S4.T1.8.6.6.6.5.m1.1.1.3.1" xref="S4.T1.8.6.6.6.5.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.6.6.6.5.m1.1b"><apply id="S4.T1.8.6.6.6.5.m1.1.1.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1"><eq id="S4.T1.8.6.6.6.5.m1.1.1.1.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.1"></eq><apply id="S4.T1.8.6.6.6.5.m1.1.1.2.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.8.6.6.6.5.m1.1.1.2.1.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2">subscript</csymbol><ci id="S4.T1.8.6.6.6.5.m1.1.1.2.2.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2.2">𝜌</ci><apply id="S4.T1.8.6.6.6.5.m1.1.1.2.3.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3"><times id="S4.T1.8.6.6.6.5.m1.1.1.2.3.1.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.1"></times><ci id="S4.T1.8.6.6.6.5.m1.1.1.2.3.2.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T1.8.6.6.6.5.m1.1.1.2.3.3.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T1.8.6.6.6.5.m1.1.1.2.3.4.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T1.8.6.6.6.5.m1.1.1.2.3.5.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T1.8.6.6.6.5.m1.1.1.2.3.6.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T1.8.6.6.6.5.m1.1.1.3.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.3"><csymbol cd="latexml" id="S4.T1.8.6.6.6.5.m1.1.1.3.1.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T1.8.6.6.6.5.m1.1.1.3.2.cmml" xref="S4.T1.8.6.6.6.5.m1.1.1.3.2">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.6.6.6.5.m1.1c">\rho_{train}=50\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.8.6.6.7.1" class="ltx_tr">
<th id="S4.T1.8.6.6.7.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg + ignore</th>
<td id="S4.T1.8.6.6.7.1.2" class="ltx_td ltx_align_center ltx_border_t">56.444</td>
<td id="S4.T1.8.6.6.7.1.3" class="ltx_td ltx_align_center ltx_border_t">53.936</td>
<td id="S4.T1.8.6.6.7.1.4" class="ltx_td ltx_align_center ltx_border_t">49.990</td>
<td id="S4.T1.8.6.6.7.1.5" class="ltx_td ltx_align_center ltx_border_t">45.024</td>
<td id="S4.T1.8.6.6.7.1.6" class="ltx_td ltx_align_center ltx_border_t">38.898</td>
<td id="S4.T1.8.6.6.7.1.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">244.292</td>
</tr>
<tr id="S4.T1.8.6.6.8.2" class="ltx_tr">
<th id="S4.T1.8.6.6.8.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedMultimodal</th>
<td id="S4.T1.8.6.6.8.2.2" class="ltx_td ltx_align_center">55.360</td>
<td id="S4.T1.8.6.6.8.2.3" class="ltx_td ltx_align_center">52.804</td>
<td id="S4.T1.8.6.6.8.2.4" class="ltx_td ltx_align_center">49.246</td>
<td id="S4.T1.8.6.6.8.2.5" class="ltx_td ltx_align_center">46.378</td>
<td id="S4.T1.8.6.6.8.2.6" class="ltx_td ltx_align_center">41.034</td>
<td id="S4.T1.8.6.6.8.2.7" class="ltx_td ltx_nopad_r ltx_align_center">244.822</td>
</tr>
<tr id="S4.T1.8.6.6.9.3" class="ltx_tr">
<th id="S4.T1.8.6.6.9.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedMultimodal + RM</th>
<td id="S4.T1.8.6.6.9.3.2" class="ltx_td ltx_align_center">55.624</td>
<td id="S4.T1.8.6.6.9.3.3" class="ltx_td ltx_align_center">52.542</td>
<td id="S4.T1.8.6.6.9.3.4" class="ltx_td ltx_align_center">48.164</td>
<td id="S4.T1.8.6.6.9.3.5" class="ltx_td ltx_align_center">47.288</td>
<td id="S4.T1.8.6.6.9.3.6" class="ltx_td ltx_align_center">41.346</td>
<td id="S4.T1.8.6.6.9.3.7" class="ltx_td ltx_nopad_r ltx_align_center">244.964</td>
</tr>
<tr id="S4.T1.8.6.6.10.4" class="ltx_tr">
<th id="S4.T1.8.6.6.10.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx + Mask</th>
<td id="S4.T1.8.6.6.10.4.2" class="ltx_td ltx_align_center">52.506</td>
<td id="S4.T1.8.6.6.10.4.3" class="ltx_td ltx_align_center">49.546</td>
<td id="S4.T1.8.6.6.10.4.4" class="ltx_td ltx_align_center">46.502</td>
<td id="S4.T1.8.6.6.10.4.5" class="ltx_td ltx_align_center">46.862</td>
<td id="S4.T1.8.6.6.10.4.6" class="ltx_td ltx_align_center">41.140</td>
<td id="S4.T1.8.6.6.10.4.7" class="ltx_td ltx_nopad_r ltx_align_center">236.556</td>
</tr>
<tr id="S4.T1.8.6.6.11.5" class="ltx_tr">
<th id="S4.T1.8.6.6.11.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedIoT + Mask</th>
<td id="S4.T1.8.6.6.11.5.2" class="ltx_td ltx_align_center">55.010</td>
<td id="S4.T1.8.6.6.11.5.3" class="ltx_td ltx_align_center">52.180</td>
<td id="S4.T1.8.6.6.11.5.4" class="ltx_td ltx_align_center">47.558</td>
<td id="S4.T1.8.6.6.11.5.5" class="ltx_td ltx_align_center">47.582</td>
<td id="S4.T1.8.6.6.11.5.6" class="ltx_td ltx_align_center">41.838</td>
<td id="S4.T1.8.6.6.11.5.7" class="ltx_td ltx_nopad_r ltx_align_center">244.168</td>
</tr>
<tr id="S4.T1.8.6.6.12.6" class="ltx_tr">
<th id="S4.T1.8.6.6.12.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedPAC + Mask</th>
<td id="S4.T1.8.6.6.12.6.2" class="ltx_td ltx_align_center">55.028</td>
<td id="S4.T1.8.6.6.12.6.3" class="ltx_td ltx_align_center">50.742</td>
<td id="S4.T1.8.6.6.12.6.4" class="ltx_td ltx_align_center">46.916</td>
<td id="S4.T1.8.6.6.12.6.5" class="ltx_td ltx_align_center">45.930</td>
<td id="S4.T1.8.6.6.12.6.6" class="ltx_td ltx_align_center">40.242</td>
<td id="S4.T1.8.6.6.12.6.7" class="ltx_td ltx_nopad_r ltx_align_center">238.858</td>
</tr>
<tr id="S4.T1.8.6.6.13.7" class="ltx_tr">
<th id="S4.T1.8.6.6.13.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedHKD + Mask</th>
<td id="S4.T1.8.6.6.13.7.2" class="ltx_td ltx_align_center">56.286</td>
<td id="S4.T1.8.6.6.13.7.3" class="ltx_td ltx_align_center">53.546</td>
<td id="S4.T1.8.6.6.13.7.4" class="ltx_td ltx_align_center">50.544</td>
<td id="S4.T1.8.6.6.13.7.5" class="ltx_td ltx_align_center">47.832</td>
<td id="S4.T1.8.6.6.13.7.6" class="ltx_td ltx_align_center">43.376</td>
<td id="S4.T1.8.6.6.13.7.7" class="ltx_td ltx_nopad_r ltx_align_center">251.584</td>
</tr>
<tr id="S4.T1.8.6.6.14.8" class="ltx_tr">
<th id="S4.T1.8.6.6.14.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">PmmFL(<span id="S4.T1.8.6.6.14.8.1.1" class="ltx_text ltx_font_bold">Ours</span>) + FA</th>
<td id="S4.T1.8.6.6.14.8.2" class="ltx_td ltx_align_center ltx_border_t">56.144</td>
<td id="S4.T1.8.6.6.14.8.3" class="ltx_td ltx_align_center ltx_border_t">54.366</td>
<td id="S4.T1.8.6.6.14.8.4" class="ltx_td ltx_align_center ltx_border_t">50.556</td>
<td id="S4.T1.8.6.6.14.8.5" class="ltx_td ltx_align_center ltx_border_t">48.796</td>
<td id="S4.T1.8.6.6.14.8.6" class="ltx_td ltx_align_center ltx_border_t">46.168</td>
<td id="S4.T1.8.6.6.14.8.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">256.030</td>
</tr>
<tr id="S4.T1.8.6.6.15.9" class="ltx_tr">
<th id="S4.T1.8.6.6.15.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PmmFL(<span id="S4.T1.8.6.6.15.9.1.1" class="ltx_text ltx_font_bold">Ours</span>) + HKD</th>
<td id="S4.T1.8.6.6.15.9.2" class="ltx_td ltx_align_center">56.458</td>
<td id="S4.T1.8.6.6.15.9.3" class="ltx_td ltx_align_center">53.926</td>
<td id="S4.T1.8.6.6.15.9.4" class="ltx_td ltx_align_center">51.568</td>
<td id="S4.T1.8.6.6.15.9.5" class="ltx_td ltx_align_center">49.472</td>
<td id="S4.T1.8.6.6.15.9.6" class="ltx_td ltx_align_center">46.394</td>
<td id="S4.T1.8.6.6.15.9.7" class="ltx_td ltx_nopad_r ltx_align_center">257.818</td>
</tr>
<tr id="S4.T1.8.6.6.16.10" class="ltx_tr">
<th id="S4.T1.8.6.6.16.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">PmcmFL (<span id="S4.T1.8.6.6.16.10.1.1" class="ltx_text ltx_font_bold">Ours</span>)</th>
<td id="S4.T1.8.6.6.16.10.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.8.6.6.16.10.2.1" class="ltx_text ltx_font_bold">56.636*</span></td>
<td id="S4.T1.8.6.6.16.10.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.8.6.6.16.10.3.1" class="ltx_text ltx_font_bold">55.478*</span></td>
<td id="S4.T1.8.6.6.16.10.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.8.6.6.16.10.4.1" class="ltx_text ltx_font_bold">52.256*</span></td>
<td id="S4.T1.8.6.6.16.10.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.8.6.6.16.10.5.1" class="ltx_text ltx_font_bold">49.548*</span></td>
<td id="S4.T1.8.6.6.16.10.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.8.6.6.16.10.6.1" class="ltx_text ltx_font_bold">47.042*</span></td>
<td id="S4.T1.8.6.6.16.10.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S4.T1.8.6.6.16.10.7.1" class="ltx_text ltx_font_bold">260.960*</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p"><span id="S4.SS1.p1.2.1" class="ltx_text ltx_font_bold">Dataset.</span>  
Following CreamFL <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite>, we utilize the challenging VQAv2 dataset <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite> to evaluate our PmcmFL.
For the efficiency of the experiments, we construct a tiny VQA task, one-tenth the scale of the original VQA task.
The tiny VQA is a classification task of 310 classes, with 64,000 training samples and 5,000 testing samples.
The training data is distributed to 30 clients, employing the Dirichlet distribution (<math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><eq id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\alpha=0.1</annotation></semantics></math>) for non-IID data partition <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite>.
Following suggestions from previous work <cite class="ltx_cite ltx_citemacro_citep">(Feng et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>, we set an equal training missing rate of <math id="S4.SS1.p1.2.m2.5" class="ltx_Math" alttext="\rho_{train}=[0.1,0.2,0.3,0.4,0.5]" display="inline"><semantics id="S4.SS1.p1.2.m2.5a"><mrow id="S4.SS1.p1.2.m2.5.6" xref="S4.SS1.p1.2.m2.5.6.cmml"><msub id="S4.SS1.p1.2.m2.5.6.2" xref="S4.SS1.p1.2.m2.5.6.2.cmml"><mi id="S4.SS1.p1.2.m2.5.6.2.2" xref="S4.SS1.p1.2.m2.5.6.2.2.cmml">ρ</mi><mrow id="S4.SS1.p1.2.m2.5.6.2.3" xref="S4.SS1.p1.2.m2.5.6.2.3.cmml"><mi id="S4.SS1.p1.2.m2.5.6.2.3.2" xref="S4.SS1.p1.2.m2.5.6.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.5.6.2.3.1" xref="S4.SS1.p1.2.m2.5.6.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.2.m2.5.6.2.3.3" xref="S4.SS1.p1.2.m2.5.6.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.5.6.2.3.1a" xref="S4.SS1.p1.2.m2.5.6.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.2.m2.5.6.2.3.4" xref="S4.SS1.p1.2.m2.5.6.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.5.6.2.3.1b" xref="S4.SS1.p1.2.m2.5.6.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.2.m2.5.6.2.3.5" xref="S4.SS1.p1.2.m2.5.6.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.5.6.2.3.1c" xref="S4.SS1.p1.2.m2.5.6.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.2.m2.5.6.2.3.6" xref="S4.SS1.p1.2.m2.5.6.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.SS1.p1.2.m2.5.6.1" xref="S4.SS1.p1.2.m2.5.6.1.cmml">=</mo><mrow id="S4.SS1.p1.2.m2.5.6.3.2" xref="S4.SS1.p1.2.m2.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.2.m2.5.6.3.2.1" xref="S4.SS1.p1.2.m2.5.6.3.1.cmml">[</mo><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">0.1</mn><mo id="S4.SS1.p1.2.m2.5.6.3.2.2" xref="S4.SS1.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml">0.2</mn><mo id="S4.SS1.p1.2.m2.5.6.3.2.3" xref="S4.SS1.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.3.3" xref="S4.SS1.p1.2.m2.3.3.cmml">0.3</mn><mo id="S4.SS1.p1.2.m2.5.6.3.2.4" xref="S4.SS1.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.4.4" xref="S4.SS1.p1.2.m2.4.4.cmml">0.4</mn><mo id="S4.SS1.p1.2.m2.5.6.3.2.5" xref="S4.SS1.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.5.5" xref="S4.SS1.p1.2.m2.5.5.cmml">0.5</mn><mo stretchy="false" id="S4.SS1.p1.2.m2.5.6.3.2.6" xref="S4.SS1.p1.2.m2.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.5b"><apply id="S4.SS1.p1.2.m2.5.6.cmml" xref="S4.SS1.p1.2.m2.5.6"><eq id="S4.SS1.p1.2.m2.5.6.1.cmml" xref="S4.SS1.p1.2.m2.5.6.1"></eq><apply id="S4.SS1.p1.2.m2.5.6.2.cmml" xref="S4.SS1.p1.2.m2.5.6.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.5.6.2.1.cmml" xref="S4.SS1.p1.2.m2.5.6.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.5.6.2.2.cmml" xref="S4.SS1.p1.2.m2.5.6.2.2">𝜌</ci><apply id="S4.SS1.p1.2.m2.5.6.2.3.cmml" xref="S4.SS1.p1.2.m2.5.6.2.3"><times id="S4.SS1.p1.2.m2.5.6.2.3.1.cmml" xref="S4.SS1.p1.2.m2.5.6.2.3.1"></times><ci id="S4.SS1.p1.2.m2.5.6.2.3.2.cmml" xref="S4.SS1.p1.2.m2.5.6.2.3.2">𝑡</ci><ci id="S4.SS1.p1.2.m2.5.6.2.3.3.cmml" xref="S4.SS1.p1.2.m2.5.6.2.3.3">𝑟</ci><ci id="S4.SS1.p1.2.m2.5.6.2.3.4.cmml" xref="S4.SS1.p1.2.m2.5.6.2.3.4">𝑎</ci><ci id="S4.SS1.p1.2.m2.5.6.2.3.5.cmml" xref="S4.SS1.p1.2.m2.5.6.2.3.5">𝑖</ci><ci id="S4.SS1.p1.2.m2.5.6.2.3.6.cmml" xref="S4.SS1.p1.2.m2.5.6.2.3.6">𝑛</ci></apply></apply><list id="S4.SS1.p1.2.m2.5.6.3.1.cmml" xref="S4.SS1.p1.2.m2.5.6.3.2"><cn type="float" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">0.1</cn><cn type="float" id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2">0.2</cn><cn type="float" id="S4.SS1.p1.2.m2.3.3.cmml" xref="S4.SS1.p1.2.m2.3.3">0.3</cn><cn type="float" id="S4.SS1.p1.2.m2.4.4.cmml" xref="S4.SS1.p1.2.m2.4.4">0.4</cn><cn type="float" id="S4.SS1.p1.2.m2.5.5.cmml" xref="S4.SS1.p1.2.m2.5.5">0.5</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.5c">\rho_{train}=[0.1,0.2,0.3,0.4,0.5]</annotation></semantics></math> for each modality.
More details on the dataset are in Appendix <a href="#A4" title="Appendix D Details on the Dataset ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.3" class="ltx_p"><span id="S4.SS1.p2.3.1" class="ltx_text ltx_font_bold">Model.</span>  
For the encoder <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathcal{E}</annotation></semantics></math>, we utilize the same architecture as BEIT3-base <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib32" title="" class="ltx_ref">2023b</a>)</cite> along with its pre-train parameters.
For the deep fusion layer <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{F}" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\mathcal{F}</annotation></semantics></math>, the image CLS token and the text CLS token are concatenated and projected through an MLP.
For the task head <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\mathcal{G}</annotation></semantics></math>, the fusion representation is projected to logits using another MLP.
More details on the model architecture are in Appendix  <a href="#A5" title="Appendix E Details on the Model ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baseline.</span>  
We compare our PmcmFL with the most relevant existing FL frameworks.
Among them, 1) FedAvg+ignore, where training is conducted only on modality-complete data, ignoring data with modality missing; 2) FedMultimodal <cite class="ltx_cite ltx_citemacro_citep">(Feng et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>, Essentially an extension of FedAvg, using Zero Mask for missing modalities; 3) Fedmultimodal+random mask, where replaces Zero Mask with Gaussian Random Mask; 4) FedIoT+mask, a framework the same as FedAvg, where Mask is applied to missing modalities, using aggregation strategy is designed for multimodal FL in FedIoT <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite>. 5) FedPAC+mask, a framework based on FedAvg and Mask for missing modalities, using
prototype-based feature alignment (FA) in FedPAC <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a href="#bib.bib33" title="" class="ltx_ref">2023</a>)</cite>. 6) FedHKD+mask, a framework based on FedAvg and Mask for missing modalities, using prototype-based hyper knowledge distillation (HKD) in FedHKD <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib2" title="" class="ltx_ref">2023a</a>)</cite>.
To demonstrate the effectiveness of our Prototype Contrast, we ablate it to obtain the variant PmmFL(PmcmFL without Contrast), and introduce the following two baselines:
7) PmmFL+FA and 8) PmmFL+HKD, which replace Prototype Contrast with Feature Alignment (FA) and Hyper Knowledge Distillation (HKD), respectively.
We future compare with 9) CreamFL in simple modality missing scenarios.
More details on baselines are in Appendix  <a href="#A6" title="Appendix F Details on Baselines ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.2" class="ltx_p"><span id="S4.SS1.p4.2.1" class="ltx_text ltx_font_bold">Implement.</span>  
To enable fair comparisons, our experiments remain consistent on method-agnostic hyperparameters, including federated communication rounds, local training epochs, client selection rate, learning rate, optimizer parameters, and batch size.
For hyperparameters introduced by PmcmFL, to prevent them from overfitting to specific tasks, we only conducted a simple parameter search.
Only the weight <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\gamma</annotation></semantics></math> is searched within <math id="S4.SS1.p4.2.m2.5" class="ltx_Math" alttext="[5.0,1.0,0.5,0.1,0.01]" display="inline"><semantics id="S4.SS1.p4.2.m2.5a"><mrow id="S4.SS1.p4.2.m2.5.6.2" xref="S4.SS1.p4.2.m2.5.6.1.cmml"><mo stretchy="false" id="S4.SS1.p4.2.m2.5.6.2.1" xref="S4.SS1.p4.2.m2.5.6.1.cmml">[</mo><mn id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">5.0</mn><mo id="S4.SS1.p4.2.m2.5.6.2.2" xref="S4.SS1.p4.2.m2.5.6.1.cmml">,</mo><mn id="S4.SS1.p4.2.m2.2.2" xref="S4.SS1.p4.2.m2.2.2.cmml">1.0</mn><mo id="S4.SS1.p4.2.m2.5.6.2.3" xref="S4.SS1.p4.2.m2.5.6.1.cmml">,</mo><mn id="S4.SS1.p4.2.m2.3.3" xref="S4.SS1.p4.2.m2.3.3.cmml">0.5</mn><mo id="S4.SS1.p4.2.m2.5.6.2.4" xref="S4.SS1.p4.2.m2.5.6.1.cmml">,</mo><mn id="S4.SS1.p4.2.m2.4.4" xref="S4.SS1.p4.2.m2.4.4.cmml">0.1</mn><mo id="S4.SS1.p4.2.m2.5.6.2.5" xref="S4.SS1.p4.2.m2.5.6.1.cmml">,</mo><mn id="S4.SS1.p4.2.m2.5.5" xref="S4.SS1.p4.2.m2.5.5.cmml">0.01</mn><mo stretchy="false" id="S4.SS1.p4.2.m2.5.6.2.6" xref="S4.SS1.p4.2.m2.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.5b"><list id="S4.SS1.p4.2.m2.5.6.1.cmml" xref="S4.SS1.p4.2.m2.5.6.2"><cn type="float" id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">5.0</cn><cn type="float" id="S4.SS1.p4.2.m2.2.2.cmml" xref="S4.SS1.p4.2.m2.2.2">1.0</cn><cn type="float" id="S4.SS1.p4.2.m2.3.3.cmml" xref="S4.SS1.p4.2.m2.3.3">0.5</cn><cn type="float" id="S4.SS1.p4.2.m2.4.4.cmml" xref="S4.SS1.p4.2.m2.4.4">0.1</cn><cn type="float" id="S4.SS1.p4.2.m2.5.5.cmml" xref="S4.SS1.p4.2.m2.5.5">0.01</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.5c">[5.0,1.0,0.5,0.1,0.01]</annotation></semantics></math> to find the optimal value.
More Implementation details for all experiments can be found in Appendix <a href="#A7" title="Appendix G Implementation Details ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">G</span></a>.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p"><span id="S4.SS1.p5.1.1" class="ltx_text ltx_font_bold">Evaluation Metric.</span>  
We fix the random seed and utilize optimal accuracy in the last ten communication rounds as the final performance.
Note that all evaluations are conducted with modality-complete testing samples, except in experiments on inference with missing modalities (Sec. <a href="#S4.SS4" title="4.4 Inference with Missing Modalities ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>).
Appendix <a href="#A8" title="Appendix H Inference with Partial Modality Missing ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">H</span></a> provides accuracy under varying degrees of modality missing during the inference phase.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results of ablation studies under various missing rates. PC denotes Prototype Contrast and PM denotes Prototype Mask.</figcaption>
<table id="S4.T2.6.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S4.T2.1.1.1.2.1" class="ltx_text">PC</span></td>
<td id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S4.T2.1.1.1.3.1" class="ltx_text">PM</span></td>
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">Accuracy (%) on 5K Testing Samples (<math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\rho_{test}=0" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><msub id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.2.2" xref="S4.T2.1.1.1.1.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T2.1.1.1.1.m1.1.1.2.3" xref="S4.T2.1.1.1.1.m1.1.1.2.3.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.2.3.2" xref="S4.T2.1.1.1.1.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.1.1.1.1.m1.1.1.2.3.1" xref="S4.T2.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.1.1.1.1.m1.1.1.2.3.3" xref="S4.T2.1.1.1.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.T2.1.1.1.1.m1.1.1.2.3.1a" xref="S4.T2.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.1.1.1.1.m1.1.1.2.3.4" xref="S4.T2.1.1.1.1.m1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T2.1.1.1.1.m1.1.1.2.3.1b" xref="S4.T2.1.1.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.1.1.1.1.m1.1.1.2.3.5" xref="S4.T2.1.1.1.1.m1.1.1.2.3.5.cmml">t</mi></mrow></msub><mo id="S4.T2.1.1.1.1.m1.1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><eq id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1"></eq><apply id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S4.T2.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.2">𝜌</ci><apply id="S4.T2.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.3"><times id="S4.T2.1.1.1.1.m1.1.1.2.3.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.3.1"></times><ci id="S4.T2.1.1.1.1.m1.1.1.2.3.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T2.1.1.1.1.m1.1.1.2.3.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.3.3">𝑒</ci><ci id="S4.T2.1.1.1.1.m1.1.1.2.3.4.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.3.4">𝑠</ci><ci id="S4.T2.1.1.1.1.m1.1.1.2.3.5.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.3.5">𝑡</ci></apply></apply><cn type="integer" id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\rho_{test}=0</annotation></semantics></math>)</td>
<td id="S4.T2.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" rowspan="2"><span id="S4.T2.1.1.1.4.1" class="ltx_text"> Acc@sum</span></td>
</tr>
<tr id="S4.T2.6.6.6" class="ltx_tr">
<td id="S4.T2.2.2.2.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.2.2.2.1.m1.1" class="ltx_Math" alttext="\rho_{train}=10\%" display="inline"><semantics id="S4.T2.2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.cmml"><msub id="S4.T2.2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.2.1.m1.1.1.2.cmml"><mi id="S4.T2.2.2.2.1.m1.1.1.2.2" xref="S4.T2.2.2.2.1.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T2.2.2.2.1.m1.1.1.2.3" xref="S4.T2.2.2.2.1.m1.1.1.2.3.cmml"><mi id="S4.T2.2.2.2.1.m1.1.1.2.3.2" xref="S4.T2.2.2.2.1.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.2.2.1.m1.1.1.2.3.1" xref="S4.T2.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.2.2.2.1.m1.1.1.2.3.3" xref="S4.T2.2.2.2.1.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.2.2.1.m1.1.1.2.3.1a" xref="S4.T2.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.2.2.2.1.m1.1.1.2.3.4" xref="S4.T2.2.2.2.1.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.2.2.1.m1.1.1.2.3.1b" xref="S4.T2.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.2.2.2.1.m1.1.1.2.3.5" xref="S4.T2.2.2.2.1.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.2.2.1.m1.1.1.2.3.1c" xref="S4.T2.2.2.2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.2.2.2.1.m1.1.1.2.3.6" xref="S4.T2.2.2.2.1.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T2.2.2.2.1.m1.1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.1.cmml">=</mo><mrow id="S4.T2.2.2.2.1.m1.1.1.3" xref="S4.T2.2.2.2.1.m1.1.1.3.cmml"><mn id="S4.T2.2.2.2.1.m1.1.1.3.2" xref="S4.T2.2.2.2.1.m1.1.1.3.2.cmml">10</mn><mo id="S4.T2.2.2.2.1.m1.1.1.3.1" xref="S4.T2.2.2.2.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.1.m1.1b"><apply id="S4.T2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1"><eq id="S4.T2.2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1.1"></eq><apply id="S4.T2.2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.2.2.2.1.m1.1.1.2.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2">subscript</csymbol><ci id="S4.T2.2.2.2.1.m1.1.1.2.2.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2.2">𝜌</ci><apply id="S4.T2.2.2.2.1.m1.1.1.2.3.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2.3"><times id="S4.T2.2.2.2.1.m1.1.1.2.3.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2.3.1"></times><ci id="S4.T2.2.2.2.1.m1.1.1.2.3.2.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T2.2.2.2.1.m1.1.1.2.3.3.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T2.2.2.2.1.m1.1.1.2.3.4.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T2.2.2.2.1.m1.1.1.2.3.5.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T2.2.2.2.1.m1.1.1.2.3.6.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T2.2.2.2.1.m1.1.1.3.cmml" xref="S4.T2.2.2.2.1.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.2.2.2.1.m1.1.1.3.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T2.2.2.2.1.m1.1.1.3.2.cmml" xref="S4.T2.2.2.2.1.m1.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.1.m1.1c">\rho_{train}=10\%</annotation></semantics></math></td>
<td id="S4.T2.3.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.3.3.3.2.m1.1" class="ltx_Math" alttext="\rho_{train}=20\%" display="inline"><semantics id="S4.T2.3.3.3.2.m1.1a"><mrow id="S4.T2.3.3.3.2.m1.1.1" xref="S4.T2.3.3.3.2.m1.1.1.cmml"><msub id="S4.T2.3.3.3.2.m1.1.1.2" xref="S4.T2.3.3.3.2.m1.1.1.2.cmml"><mi id="S4.T2.3.3.3.2.m1.1.1.2.2" xref="S4.T2.3.3.3.2.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T2.3.3.3.2.m1.1.1.2.3" xref="S4.T2.3.3.3.2.m1.1.1.2.3.cmml"><mi id="S4.T2.3.3.3.2.m1.1.1.2.3.2" xref="S4.T2.3.3.3.2.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.3.3.3.2.m1.1.1.2.3.1" xref="S4.T2.3.3.3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.3.3.3.2.m1.1.1.2.3.3" xref="S4.T2.3.3.3.2.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T2.3.3.3.2.m1.1.1.2.3.1a" xref="S4.T2.3.3.3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.3.3.3.2.m1.1.1.2.3.4" xref="S4.T2.3.3.3.2.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T2.3.3.3.2.m1.1.1.2.3.1b" xref="S4.T2.3.3.3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.3.3.3.2.m1.1.1.2.3.5" xref="S4.T2.3.3.3.2.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T2.3.3.3.2.m1.1.1.2.3.1c" xref="S4.T2.3.3.3.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.3.3.3.2.m1.1.1.2.3.6" xref="S4.T2.3.3.3.2.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T2.3.3.3.2.m1.1.1.1" xref="S4.T2.3.3.3.2.m1.1.1.1.cmml">=</mo><mrow id="S4.T2.3.3.3.2.m1.1.1.3" xref="S4.T2.3.3.3.2.m1.1.1.3.cmml"><mn id="S4.T2.3.3.3.2.m1.1.1.3.2" xref="S4.T2.3.3.3.2.m1.1.1.3.2.cmml">20</mn><mo id="S4.T2.3.3.3.2.m1.1.1.3.1" xref="S4.T2.3.3.3.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.2.m1.1b"><apply id="S4.T2.3.3.3.2.m1.1.1.cmml" xref="S4.T2.3.3.3.2.m1.1.1"><eq id="S4.T2.3.3.3.2.m1.1.1.1.cmml" xref="S4.T2.3.3.3.2.m1.1.1.1"></eq><apply id="S4.T2.3.3.3.2.m1.1.1.2.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.3.3.3.2.m1.1.1.2.1.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2">subscript</csymbol><ci id="S4.T2.3.3.3.2.m1.1.1.2.2.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2.2">𝜌</ci><apply id="S4.T2.3.3.3.2.m1.1.1.2.3.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2.3"><times id="S4.T2.3.3.3.2.m1.1.1.2.3.1.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2.3.1"></times><ci id="S4.T2.3.3.3.2.m1.1.1.2.3.2.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T2.3.3.3.2.m1.1.1.2.3.3.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T2.3.3.3.2.m1.1.1.2.3.4.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T2.3.3.3.2.m1.1.1.2.3.5.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T2.3.3.3.2.m1.1.1.2.3.6.cmml" xref="S4.T2.3.3.3.2.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T2.3.3.3.2.m1.1.1.3.cmml" xref="S4.T2.3.3.3.2.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.3.3.3.2.m1.1.1.3.1.cmml" xref="S4.T2.3.3.3.2.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T2.3.3.3.2.m1.1.1.3.2.cmml" xref="S4.T2.3.3.3.2.m1.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.2.m1.1c">\rho_{train}=20\%</annotation></semantics></math></td>
<td id="S4.T2.4.4.4.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.4.4.4.3.m1.1" class="ltx_Math" alttext="\rho_{train}=30\%" display="inline"><semantics id="S4.T2.4.4.4.3.m1.1a"><mrow id="S4.T2.4.4.4.3.m1.1.1" xref="S4.T2.4.4.4.3.m1.1.1.cmml"><msub id="S4.T2.4.4.4.3.m1.1.1.2" xref="S4.T2.4.4.4.3.m1.1.1.2.cmml"><mi id="S4.T2.4.4.4.3.m1.1.1.2.2" xref="S4.T2.4.4.4.3.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T2.4.4.4.3.m1.1.1.2.3" xref="S4.T2.4.4.4.3.m1.1.1.2.3.cmml"><mi id="S4.T2.4.4.4.3.m1.1.1.2.3.2" xref="S4.T2.4.4.4.3.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.4.4.4.3.m1.1.1.2.3.1" xref="S4.T2.4.4.4.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.4.4.4.3.m1.1.1.2.3.3" xref="S4.T2.4.4.4.3.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T2.4.4.4.3.m1.1.1.2.3.1a" xref="S4.T2.4.4.4.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.4.4.4.3.m1.1.1.2.3.4" xref="S4.T2.4.4.4.3.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T2.4.4.4.3.m1.1.1.2.3.1b" xref="S4.T2.4.4.4.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.4.4.4.3.m1.1.1.2.3.5" xref="S4.T2.4.4.4.3.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T2.4.4.4.3.m1.1.1.2.3.1c" xref="S4.T2.4.4.4.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.4.4.4.3.m1.1.1.2.3.6" xref="S4.T2.4.4.4.3.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T2.4.4.4.3.m1.1.1.1" xref="S4.T2.4.4.4.3.m1.1.1.1.cmml">=</mo><mrow id="S4.T2.4.4.4.3.m1.1.1.3" xref="S4.T2.4.4.4.3.m1.1.1.3.cmml"><mn id="S4.T2.4.4.4.3.m1.1.1.3.2" xref="S4.T2.4.4.4.3.m1.1.1.3.2.cmml">30</mn><mo id="S4.T2.4.4.4.3.m1.1.1.3.1" xref="S4.T2.4.4.4.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.3.m1.1b"><apply id="S4.T2.4.4.4.3.m1.1.1.cmml" xref="S4.T2.4.4.4.3.m1.1.1"><eq id="S4.T2.4.4.4.3.m1.1.1.1.cmml" xref="S4.T2.4.4.4.3.m1.1.1.1"></eq><apply id="S4.T2.4.4.4.3.m1.1.1.2.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.4.4.4.3.m1.1.1.2.1.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2">subscript</csymbol><ci id="S4.T2.4.4.4.3.m1.1.1.2.2.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2.2">𝜌</ci><apply id="S4.T2.4.4.4.3.m1.1.1.2.3.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2.3"><times id="S4.T2.4.4.4.3.m1.1.1.2.3.1.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2.3.1"></times><ci id="S4.T2.4.4.4.3.m1.1.1.2.3.2.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T2.4.4.4.3.m1.1.1.2.3.3.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T2.4.4.4.3.m1.1.1.2.3.4.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T2.4.4.4.3.m1.1.1.2.3.5.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T2.4.4.4.3.m1.1.1.2.3.6.cmml" xref="S4.T2.4.4.4.3.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T2.4.4.4.3.m1.1.1.3.cmml" xref="S4.T2.4.4.4.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.4.4.4.3.m1.1.1.3.1.cmml" xref="S4.T2.4.4.4.3.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T2.4.4.4.3.m1.1.1.3.2.cmml" xref="S4.T2.4.4.4.3.m1.1.1.3.2">30</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.3.m1.1c">\rho_{train}=30\%</annotation></semantics></math></td>
<td id="S4.T2.5.5.5.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.5.5.5.4.m1.1" class="ltx_Math" alttext="\rho_{train}=40\%" display="inline"><semantics id="S4.T2.5.5.5.4.m1.1a"><mrow id="S4.T2.5.5.5.4.m1.1.1" xref="S4.T2.5.5.5.4.m1.1.1.cmml"><msub id="S4.T2.5.5.5.4.m1.1.1.2" xref="S4.T2.5.5.5.4.m1.1.1.2.cmml"><mi id="S4.T2.5.5.5.4.m1.1.1.2.2" xref="S4.T2.5.5.5.4.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T2.5.5.5.4.m1.1.1.2.3" xref="S4.T2.5.5.5.4.m1.1.1.2.3.cmml"><mi id="S4.T2.5.5.5.4.m1.1.1.2.3.2" xref="S4.T2.5.5.5.4.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.5.5.5.4.m1.1.1.2.3.1" xref="S4.T2.5.5.5.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.5.5.5.4.m1.1.1.2.3.3" xref="S4.T2.5.5.5.4.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T2.5.5.5.4.m1.1.1.2.3.1a" xref="S4.T2.5.5.5.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.5.5.5.4.m1.1.1.2.3.4" xref="S4.T2.5.5.5.4.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T2.5.5.5.4.m1.1.1.2.3.1b" xref="S4.T2.5.5.5.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.5.5.5.4.m1.1.1.2.3.5" xref="S4.T2.5.5.5.4.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T2.5.5.5.4.m1.1.1.2.3.1c" xref="S4.T2.5.5.5.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.5.5.5.4.m1.1.1.2.3.6" xref="S4.T2.5.5.5.4.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T2.5.5.5.4.m1.1.1.1" xref="S4.T2.5.5.5.4.m1.1.1.1.cmml">=</mo><mrow id="S4.T2.5.5.5.4.m1.1.1.3" xref="S4.T2.5.5.5.4.m1.1.1.3.cmml"><mn id="S4.T2.5.5.5.4.m1.1.1.3.2" xref="S4.T2.5.5.5.4.m1.1.1.3.2.cmml">40</mn><mo id="S4.T2.5.5.5.4.m1.1.1.3.1" xref="S4.T2.5.5.5.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.4.m1.1b"><apply id="S4.T2.5.5.5.4.m1.1.1.cmml" xref="S4.T2.5.5.5.4.m1.1.1"><eq id="S4.T2.5.5.5.4.m1.1.1.1.cmml" xref="S4.T2.5.5.5.4.m1.1.1.1"></eq><apply id="S4.T2.5.5.5.4.m1.1.1.2.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.5.5.5.4.m1.1.1.2.1.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2">subscript</csymbol><ci id="S4.T2.5.5.5.4.m1.1.1.2.2.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2.2">𝜌</ci><apply id="S4.T2.5.5.5.4.m1.1.1.2.3.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2.3"><times id="S4.T2.5.5.5.4.m1.1.1.2.3.1.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2.3.1"></times><ci id="S4.T2.5.5.5.4.m1.1.1.2.3.2.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T2.5.5.5.4.m1.1.1.2.3.3.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T2.5.5.5.4.m1.1.1.2.3.4.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T2.5.5.5.4.m1.1.1.2.3.5.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T2.5.5.5.4.m1.1.1.2.3.6.cmml" xref="S4.T2.5.5.5.4.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T2.5.5.5.4.m1.1.1.3.cmml" xref="S4.T2.5.5.5.4.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.5.5.5.4.m1.1.1.3.1.cmml" xref="S4.T2.5.5.5.4.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T2.5.5.5.4.m1.1.1.3.2.cmml" xref="S4.T2.5.5.5.4.m1.1.1.3.2">40</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.4.m1.1c">\rho_{train}=40\%</annotation></semantics></math></td>
<td id="S4.T2.6.6.6.5" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.6.6.6.5.m1.1" class="ltx_Math" alttext="\rho_{train}=50\%" display="inline"><semantics id="S4.T2.6.6.6.5.m1.1a"><mrow id="S4.T2.6.6.6.5.m1.1.1" xref="S4.T2.6.6.6.5.m1.1.1.cmml"><msub id="S4.T2.6.6.6.5.m1.1.1.2" xref="S4.T2.6.6.6.5.m1.1.1.2.cmml"><mi id="S4.T2.6.6.6.5.m1.1.1.2.2" xref="S4.T2.6.6.6.5.m1.1.1.2.2.cmml">ρ</mi><mrow id="S4.T2.6.6.6.5.m1.1.1.2.3" xref="S4.T2.6.6.6.5.m1.1.1.2.3.cmml"><mi id="S4.T2.6.6.6.5.m1.1.1.2.3.2" xref="S4.T2.6.6.6.5.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T2.6.6.6.5.m1.1.1.2.3.1" xref="S4.T2.6.6.6.5.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.6.6.6.5.m1.1.1.2.3.3" xref="S4.T2.6.6.6.5.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.T2.6.6.6.5.m1.1.1.2.3.1a" xref="S4.T2.6.6.6.5.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.6.6.6.5.m1.1.1.2.3.4" xref="S4.T2.6.6.6.5.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T2.6.6.6.5.m1.1.1.2.3.1b" xref="S4.T2.6.6.6.5.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.6.6.6.5.m1.1.1.2.3.5" xref="S4.T2.6.6.6.5.m1.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T2.6.6.6.5.m1.1.1.2.3.1c" xref="S4.T2.6.6.6.5.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T2.6.6.6.5.m1.1.1.2.3.6" xref="S4.T2.6.6.6.5.m1.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="S4.T2.6.6.6.5.m1.1.1.1" xref="S4.T2.6.6.6.5.m1.1.1.1.cmml">=</mo><mrow id="S4.T2.6.6.6.5.m1.1.1.3" xref="S4.T2.6.6.6.5.m1.1.1.3.cmml"><mn id="S4.T2.6.6.6.5.m1.1.1.3.2" xref="S4.T2.6.6.6.5.m1.1.1.3.2.cmml">50</mn><mo id="S4.T2.6.6.6.5.m1.1.1.3.1" xref="S4.T2.6.6.6.5.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.5.m1.1b"><apply id="S4.T2.6.6.6.5.m1.1.1.cmml" xref="S4.T2.6.6.6.5.m1.1.1"><eq id="S4.T2.6.6.6.5.m1.1.1.1.cmml" xref="S4.T2.6.6.6.5.m1.1.1.1"></eq><apply id="S4.T2.6.6.6.5.m1.1.1.2.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.6.6.6.5.m1.1.1.2.1.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2">subscript</csymbol><ci id="S4.T2.6.6.6.5.m1.1.1.2.2.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2.2">𝜌</ci><apply id="S4.T2.6.6.6.5.m1.1.1.2.3.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2.3"><times id="S4.T2.6.6.6.5.m1.1.1.2.3.1.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2.3.1"></times><ci id="S4.T2.6.6.6.5.m1.1.1.2.3.2.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2.3.2">𝑡</ci><ci id="S4.T2.6.6.6.5.m1.1.1.2.3.3.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2.3.3">𝑟</ci><ci id="S4.T2.6.6.6.5.m1.1.1.2.3.4.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2.3.4">𝑎</ci><ci id="S4.T2.6.6.6.5.m1.1.1.2.3.5.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2.3.5">𝑖</ci><ci id="S4.T2.6.6.6.5.m1.1.1.2.3.6.cmml" xref="S4.T2.6.6.6.5.m1.1.1.2.3.6">𝑛</ci></apply></apply><apply id="S4.T2.6.6.6.5.m1.1.1.3.cmml" xref="S4.T2.6.6.6.5.m1.1.1.3"><csymbol cd="latexml" id="S4.T2.6.6.6.5.m1.1.1.3.1.cmml" xref="S4.T2.6.6.6.5.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T2.6.6.6.5.m1.1.1.3.2.cmml" xref="S4.T2.6.6.6.5.m1.1.1.3.2">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.5.m1.1c">\rho_{train}=50\%</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.6.6.7.1" class="ltx_tr">
<td id="S4.T2.6.6.7.1.1" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.6.6.7.1.2" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.6.6.7.1.3" class="ltx_td ltx_align_center ltx_border_t">55.624</td>
<td id="S4.T2.6.6.7.1.4" class="ltx_td ltx_align_center ltx_border_t">52.542</td>
<td id="S4.T2.6.6.7.1.5" class="ltx_td ltx_align_center ltx_border_t">48.164</td>
<td id="S4.T2.6.6.7.1.6" class="ltx_td ltx_align_center ltx_border_t">47.288</td>
<td id="S4.T2.6.6.7.1.7" class="ltx_td ltx_align_center ltx_border_t">41.346</td>
<td id="S4.T2.6.6.7.1.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">244.964</td>
</tr>
<tr id="S4.T2.6.6.8.2" class="ltx_tr">
<td id="S4.T2.6.6.8.2.1" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.6.6.8.2.2" class="ltx_td"></td>
<td id="S4.T2.6.6.8.2.3" class="ltx_td ltx_align_center">55.948</td>
<td id="S4.T2.6.6.8.2.4" class="ltx_td ltx_align_center">53.588</td>
<td id="S4.T2.6.6.8.2.5" class="ltx_td ltx_align_center">50.982</td>
<td id="S4.T2.6.6.8.2.6" class="ltx_td ltx_align_center">47.422</td>
<td id="S4.T2.6.6.8.2.7" class="ltx_td ltx_align_center">44.454</td>
<td id="S4.T2.6.6.8.2.8" class="ltx_td ltx_nopad_r ltx_align_center">252.394</td>
</tr>
<tr id="S4.T2.6.6.9.3" class="ltx_tr">
<td id="S4.T2.6.6.9.3.1" class="ltx_td"></td>
<td id="S4.T2.6.6.9.3.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.6.6.9.3.3" class="ltx_td ltx_align_center">55.326</td>
<td id="S4.T2.6.6.9.3.4" class="ltx_td ltx_align_center">54.486</td>
<td id="S4.T2.6.6.9.3.5" class="ltx_td ltx_align_center">50.858</td>
<td id="S4.T2.6.6.9.3.6" class="ltx_td ltx_align_center">49.290</td>
<td id="S4.T2.6.6.9.3.7" class="ltx_td ltx_align_center">45.848</td>
<td id="S4.T2.6.6.9.3.8" class="ltx_td ltx_nopad_r ltx_align_center">255.808</td>
</tr>
<tr id="S4.T2.6.6.10.4" class="ltx_tr">
<td id="S4.T2.6.6.10.4.1" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S4.T2.6.6.10.4.2" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S4.T2.6.6.10.4.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.6.6.10.4.3.1" class="ltx_text ltx_font_bold">56.636</span></td>
<td id="S4.T2.6.6.10.4.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.6.6.10.4.4.1" class="ltx_text ltx_font_bold">55.478</span></td>
<td id="S4.T2.6.6.10.4.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.6.6.10.4.5.1" class="ltx_text ltx_font_bold">52.256</span></td>
<td id="S4.T2.6.6.10.4.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.6.6.10.4.6.1" class="ltx_text ltx_font_bold">49.548</span></td>
<td id="S4.T2.6.6.10.4.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.6.6.10.4.7.1" class="ltx_text ltx_font_bold">47.042</span></td>
<td id="S4.T2.6.6.10.4.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S4.T2.6.6.10.4.8.1" class="ltx_text ltx_font_bold">260.960</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>
Inference with 100% text modality missing.
Zero Mask and Random Mask are baseline methods for handling inference with missing modalities.
Others are our Prototype Mask with various matching algorithms.
</figcaption>
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T3.1.1.1.1.1" class="ltx_text">Methods</span></th>
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="4">Accuracy (%) on Unimodal Data</td>
</tr>
<tr id="S4.T3.1.2.2" class="ltx_tr">
<td id="S4.T3.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t">Mix-1</td>
<td id="S4.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Mix-10</td>
<td id="S4.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">Mix-20</td>
<td id="S4.T3.1.2.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">Mix-best</td>
</tr>
<tr id="S4.T3.1.3.3" class="ltx_tr">
<th id="S4.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Zero Mask</th>
<td id="S4.T3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">0.996</td>
<td id="S4.T3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">0.996</td>
<td id="S4.T3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">0.996</td>
<td id="S4.T3.1.3.3.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.996</td>
</tr>
<tr id="S4.T3.1.4.4" class="ltx_tr">
<th id="S4.T3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Random Mask</th>
<td id="S4.T3.1.4.4.2" class="ltx_td ltx_align_center">3.662</td>
<td id="S4.T3.1.4.4.3" class="ltx_td ltx_align_center">3.662</td>
<td id="S4.T3.1.4.4.4" class="ltx_td ltx_align_center">3.662</td>
<td id="S4.T3.1.4.4.5" class="ltx_td ltx_nopad_r ltx_align_center">3.662</td>
</tr>
<tr id="S4.T3.1.5.5" class="ltx_tr">
<th id="S4.T3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">L1 Metric</th>
<td id="S4.T3.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">6.358</td>
<td id="S4.T3.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t">6.170</td>
<td id="S4.T3.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t">6.784</td>
<td id="S4.T3.1.5.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">6.784</td>
</tr>
<tr id="S4.T3.1.6.6" class="ltx_tr">
<th id="S4.T3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">L2 Metric</th>
<td id="S4.T3.1.6.6.2" class="ltx_td ltx_align_center">5.454</td>
<td id="S4.T3.1.6.6.3" class="ltx_td ltx_align_center">5.238</td>
<td id="S4.T3.1.6.6.4" class="ltx_td ltx_align_center">5.782</td>
<td id="S4.T3.1.6.6.5" class="ltx_td ltx_nopad_r ltx_align_center">6.106</td>
</tr>
<tr id="S4.T3.1.7.7" class="ltx_tr">
<th id="S4.T3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">COS Metric</th>
<td id="S4.T3.1.7.7.2" class="ltx_td ltx_align_center">5.524</td>
<td id="S4.T3.1.7.7.3" class="ltx_td ltx_align_center">6.062</td>
<td id="S4.T3.1.7.7.4" class="ltx_td ltx_align_center">6.676</td>
<td id="S4.T3.1.7.7.5" class="ltx_td ltx_nopad_r ltx_align_center">6.938</td>
</tr>
<tr id="S4.T3.1.8.8" class="ltx_tr">
<th id="S4.T3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Classifier(max.)</th>
<td id="S4.T3.1.8.8.2" class="ltx_td ltx_align_center">26.956</td>
<td id="S4.T3.1.8.8.3" class="ltx_td ltx_align_center">27.022</td>
<td id="S4.T3.1.8.8.4" class="ltx_td ltx_align_center">27.022</td>
<td id="S4.T3.1.8.8.5" class="ltx_td ltx_nopad_r ltx_align_center">27.022</td>
</tr>
<tr id="S4.T3.1.9.9" class="ltx_tr">
<th id="S4.T3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Classifier(ens.)</th>
<td id="S4.T3.1.9.9.2" class="ltx_td ltx_align_center">27.090</td>
<td id="S4.T3.1.9.9.3" class="ltx_td ltx_align_center">27.090</td>
<td id="S4.T3.1.9.9.4" class="ltx_td ltx_align_center">27.090</td>
<td id="S4.T3.1.9.9.5" class="ltx_td ltx_nopad_r ltx_align_center">27.090</td>
</tr>
<tr id="S4.T3.1.10.10" class="ltx_tr">
<th id="S4.T3.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Classifier(avg.)</th>
<td id="S4.T3.1.10.10.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.10.10.2.1" class="ltx_text ltx_font_bold">27.502</span></td>
<td id="S4.T3.1.10.10.3" class="ltx_td ltx_align_center">27.092</td>
<td id="S4.T3.1.10.10.4" class="ltx_td ltx_align_center">27.092</td>
<td id="S4.T3.1.10.10.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T3.1.10.10.5.1" class="ltx_text ltx_font_bold">27.502</span></td>
</tr>
<tr id="S4.T3.1.11.11" class="ltx_tr">
<th id="S4.T3.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MLP-Prior(max.)</th>
<td id="S4.T3.1.11.11.2" class="ltx_td ltx_align_center">27.052</td>
<td id="S4.T3.1.11.11.3" class="ltx_td ltx_align_center">19.906</td>
<td id="S4.T3.1.11.11.4" class="ltx_td ltx_align_center">8.742</td>
<td id="S4.T3.1.11.11.5" class="ltx_td ltx_nopad_r ltx_align_center">27.052</td>
</tr>
<tr id="S4.T3.1.12.12" class="ltx_tr">
<th id="S4.T3.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MLP-Prior(ens.)</th>
<td id="S4.T3.1.12.12.2" class="ltx_td ltx_align_center">27.260</td>
<td id="S4.T3.1.12.12.3" class="ltx_td ltx_align_center">27.280</td>
<td id="S4.T3.1.12.12.4" class="ltx_td ltx_align_center">27.280</td>
<td id="S4.T3.1.12.12.5" class="ltx_td ltx_nopad_r ltx_align_center">27.280</td>
</tr>
<tr id="S4.T3.1.13.13" class="ltx_tr">
<th id="S4.T3.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">MLP-Prior(avg.)</th>
<td id="S4.T3.1.13.13.2" class="ltx_td ltx_align_center ltx_border_bb">5.858</td>
<td id="S4.T3.1.13.13.3" class="ltx_td ltx_align_center ltx_border_bb">5.702</td>
<td id="S4.T3.1.13.13.4" class="ltx_td ltx_align_center ltx_border_bb">5.996</td>
<td id="S4.T3.1.13.13.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">6.210</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Main Results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> displays the accuracy of the global model in all baselines and our PmcmFL.
Our PmcmFL framework generally achieves noticeable performance improvement over all baselines in all modality missing rates.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Compared to ignoring incomplete data, the Mask method significantly improves the performance of federated training with 50% modality missing (a 2.448% boost), indicating that Mask is effective in handling severe modality missing.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Compared to FedAvg, FedIoT leads to a performance decline (a 0.796% drop on Acc@sum), which indicates that assigning more aggregation weight to multimodal clients no longer works in our task scenarios.
Similarly, FedPAC leads to a performance decline (a 6.106% drop on Acc@sum), which is because the feature alignment (FA) employed by FedPAC, a strong regularization that narrows the distance between representations and prototypes through MSE, disrupts the semantic distinctiveness of representations.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">Compared to all the baselines, our PmcmFL achieves superior performance (9.376-24.404% boost on Acc@sum), demonstrating the effectiveness of our Prototype Mask and Contrast.
Furthermore, as the modality missing rate increases, the performance improvement brought about by our PmcmFL tends to be more significant (a 0.192% boost in 10% missing but a 3.666% boost in 50% missing).</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p">Compared to PmcmFL’s variants, slightly superior performance (3.14-4.93% boost on Acc@sum) indicates that our Prototype Contrast is more generalizable than Feature Alignment and Hyper Knowledge Distillation.
We further validate the better performance of PmcmFL compared with CreamFL in scenarios with a 100% missing rate of either modality.
The experimental results are in Appendix <a href="#A9" title="Appendix I Compare with CreamFL ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/tsne1.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="305" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F3.sf1.3.2" class="ltx_text" style="font-size:80%;">Representation distribution learned by different clients. Dots of the same color denote representation distribution for one client.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/tsne2.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="304" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F3.sf2.3.2" class="ltx_text" style="font-size:80%;">Representation distribution learned by the global model. Dots of the same color denote representations of the same class. The stars represent prototypes for corresponding classes.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>T-SNE visualization for qualitative studies.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Studies</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We study the effect of each PmcmFL component during training.
Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Experiment Setup ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> displays the results of ablation studies under various training modality missing rates.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">The results show that Prototype Contrast and Mask contribute to performance improvement over the baselines, with gains of 7.430% and 11.168% on Acc@sum, respectively.
Moreover, combining Prototype Contrast and Prototype Mask assist local training yields further performance boost.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Inference with Missing Modalities</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Table <a href="#S4.T3" title="Table 3 ‣ 4.1 Experiment Setup ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the testing accuracy of the global model in 100% text missing, demonstrating intuitively the performance of PmcmFL in handling inference with missing modalities.
We use the global model trained with 30% modality missing, and its accuracy is 52.256% in modality-complete testing samples.
For ProtoMix, top-1, top-10, top-20, and best prototype mix are exhibited.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">We can obviously see that the inference accuracy of Zero Mask and Random Mask, serving as baselines, is only 0.996% and 3.662%, respectively, which indicates that the modality missing issues severely impair the model’s inference accuracy.
In contrast, Prototype Mask achieves the highest accuracy of 27.502% (a 23.840% boost), demonstrating that our method helps restore modal inference accuracy.
Moreover, the experiments also demonstrate the effectiveness of our ProtoMix strategy.
More results and discussions can be found in Appendix  <a href="#A10" title="Appendix J Discussions on ProtoMix ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">J</span></a>.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Qualitative Studies</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We utilize T-SNE <cite class="ltx_cite ltx_citemacro_citep">(Van der Maaten &amp; Hinton, <a href="#bib.bib30" title="" class="ltx_ref">2008</a>)</cite> for visualization to qualitatively analyze the role of Prototypes Contrast in our FL framework.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">Figure <a href="#S4.F3.sf1" title="Figure 3(a) ‣ Figure 3 ‣ 4.2 Main Results ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> visualizes fused representation distribution learned by different clients.
We can observe that in FedAvg, some dots cluster by clients, indicating that each client forms its individual latent space.
When local models are aggregated into a global model, individual latent spaces hinder the formation of a unified latent space.
In contrast, in our PmcmFL, the heterogeneity of latent spaces among various clients is reduced due to prototypes acting as representation targets to guide local training.
</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">Figure <a href="#S4.F3.sf2" title="Figure 3(b) ‣ Figure 3 ‣ 4.2 Main Results ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a> visualizes the fused representation distribution learned by the global model.
We randomly selected samples of three classes in the testing set.
It can be observed that in FedAvg, dots from different classes are mixed, which is not conducive to subsequent classification tasks.
In contrast, in our PmcmFL, dots from different classes cluster around their respective prototypes, which validates our starting point of using prototypes for constructing contrastive loss.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/cost.png" id="S4.F4.sf1.g1" class="ltx_graphics ltx_img_square" width="258" height="210" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F4.sf1.3.2" class="ltx_text" style="font-size:80%;">Communication Overhead</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/eff.png" id="S4.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="281" height="214" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F4.sf2.3.2" class="ltx_text" style="font-size:80%;">Communication Efficiency</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Communication overhead and communication efficiency in six FL frameworks. Figure (a) shows the amount of parameters transmitted by different frameworks in one communication round. Figure (b) shows the optimal performance (%) of the global model when transmitting different parameters (MB).</figcaption>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Overhead and Efficiency of Communication</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">In our PmcmFL, the parameters transmitted during each federated communication round include model weights and the prototype library.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.1" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ 4.5 Qualitative Studies ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates different FL frameworks’ communication overhead and communication efficiency.
As shown, in our tiny VQA task, PmcmFL introduces only negligible additional communication overhead (+0.32%).
In the original VQA task, PmcmFL exhibits even lower communication overhead than FedHKD (+3.21% v.s. +5.43%).
Furthermore, we can observe that when transmitting the same amount of parameters, PmcmFL achieves optimal performance, demonstrating that our framework has the highest communication efficiency.</p>
</div>
</section>
<section id="S4.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Robustness to federated settings</h3>

<div id="S4.SS7.p1" class="ltx_para">
<p id="S4.SS7.p1.1" class="ltx_p">Figure <a href="#S4.F5" title="Figure 5 ‣ 4.7 Robustness to federated settings ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> illustrates the performance of various FL Frameworks across different communication rounds, client selection rates, local training epochs, and learning rates.
We conduct experiments with 50% modality missing while keeping all federated settings constant except the one being investigated.
Four representative FL frameworks are compared: 1) FedAvg with ignoring modality-incomplete data; 2) FedAvg with Gaussian Random Mask; 3) FedHKD, the existing one with optimal performance; 4) our PmcmFL.
The experimental results demonstrate that, under different FL settings, our PmcmFL consistently achieved optimal performance, showcasing robustness to FL settings.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/round.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_img_landscape" width="275" height="207" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F5.sf1.3.2" class="ltx_text" style="font-size:80%;">Communication rounds</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/select.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_img_landscape" width="275" height="207" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F5.sf2.3.2" class="ltx_text" style="font-size:80%;">Clients selection rates (%)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/epoch.png" id="S4.F5.sf3.g1" class="ltx_graphics ltx_img_landscape" width="275" height="207" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf3.2.1.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S4.F5.sf3.3.2" class="ltx_text" style="font-size:80%;">Local training epochs</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.13508/assets/pic/lr.png" id="S4.F5.sf4.g1" class="ltx_graphics ltx_img_landscape" width="275" height="207" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf4.4.2.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S4.F5.sf4.2.1" class="ltx_text" style="font-size:80%;">Learning rates (<math id="S4.F5.sf4.2.1.m1.1" class="ltx_Math" alttext="10^{-5}" display="inline"><semantics id="S4.F5.sf4.2.1.m1.1b"><msup id="S4.F5.sf4.2.1.m1.1.1" xref="S4.F5.sf4.2.1.m1.1.1.cmml"><mn id="S4.F5.sf4.2.1.m1.1.1.2" xref="S4.F5.sf4.2.1.m1.1.1.2.cmml">10</mn><mrow id="S4.F5.sf4.2.1.m1.1.1.3" xref="S4.F5.sf4.2.1.m1.1.1.3.cmml"><mo id="S4.F5.sf4.2.1.m1.1.1.3b" xref="S4.F5.sf4.2.1.m1.1.1.3.cmml">−</mo><mn id="S4.F5.sf4.2.1.m1.1.1.3.2" xref="S4.F5.sf4.2.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.F5.sf4.2.1.m1.1c"><apply id="S4.F5.sf4.2.1.m1.1.1.cmml" xref="S4.F5.sf4.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F5.sf4.2.1.m1.1.1.1.cmml" xref="S4.F5.sf4.2.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.F5.sf4.2.1.m1.1.1.2.cmml" xref="S4.F5.sf4.2.1.m1.1.1.2">10</cn><apply id="S4.F5.sf4.2.1.m1.1.1.3.cmml" xref="S4.F5.sf4.2.1.m1.1.1.3"><minus id="S4.F5.sf4.2.1.m1.1.1.3.1.cmml" xref="S4.F5.sf4.2.1.m1.1.1.3"></minus><cn type="integer" id="S4.F5.sf4.2.1.m1.1.1.3.2.cmml" xref="S4.F5.sf4.2.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.sf4.2.1.m1.1d">10^{-5}</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Compare the performance of our PmcmFL with baseline frameworks under different FL settings.
Our PmcmFL consistently achieves the best performance.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we investigate multimodal federated learning with uncertain modality missing in both training and inference.
Our work introduces a prototype library to empower the FL framework with the capability to alleviate performance degradation resulting from modality missing.
Based on the prototype library, we construct a task-calibrated training loss, a model-agnostic unimodal inference strategy, and a proximal term.
The effectiveness of our framework has been validated through comparisons with state-of-the-art methods under various missingness settings.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Our forthcoming efforts will center on riching semantics of prototypes, improving the prototype match accuracy, and extending Prototype Mask to a data augmentation method.
Furthermore, we recognize the potential of using prototypes to tackle issues with missing or inaccurate labels, and we also intend to explore this avenue.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Impact Statements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This paper presents work whose goal is to advance the field of Machine Learning, thereby facilitating the practical application of multimodal learning in real-world scenarios.
The dataset we use is publicly available and does not involve privacy issues.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al. (2022)</span>
<span class="ltx_bibblock">
Bao, H., Dong, L., Piao, S., and Wei, F.

</span>
<span class="ltx_bibblock">BEiT: BERT pre-training of image transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023a)</span>
<span class="ltx_bibblock">
Chen, H., Wang, C., and Vikalo, H.

</span>
<span class="ltx_bibblock">The best of both worlds: Accurate global and personalized models through federated learning with data-free hyper-knowledge distillation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2023a.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen &amp; Zhang (2022)</span>
<span class="ltx_bibblock">
Chen, J. and Zhang, A.

</span>
<span class="ltx_bibblock">Fedmsplit: Correlation-adaptive federated multi-task learning across multimodal split networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, pp.  87–96, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023b)</span>
<span class="ltx_bibblock">
Chen, X., Wang, X., Changpinyo, S., Piergiovanni, A. J., Padlewski, P., Salz, D., Goodman, S., Grycner, A., Mustafa, B., Beyer, L., Kolesnikov, A., Puigcerver, J., Ding, N., Rong, K., Akbari, H., Mishra, G., Xue, L., Thapliyal, A. V., Bradbury, J., and Kuo, W.

</span>
<span class="ltx_bibblock">Pali: A jointly-scaled multilingual language-image model.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2023b.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2023)</span>
<span class="ltx_bibblock">
Dai, Y., Chen, Z., Li, J., Heinecke, S., Sun, L., and Xu, R.

</span>
<span class="ltx_bibblock">Tackling data heterogeneity in federated learning with class prototypes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Thirty-Seventh AAAI Conference on Artificial Intelligence</em>, pp.  7314–7322, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Devlin, J., Chang, M., Lee, K., and Toutanova, K.

</span>
<span class="ltx_bibblock">BERT: pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics</em>, pp.  4171–4186, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2021)</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., Uszkoreit, J., and Houlsby, N.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. (2023)</span>
<span class="ltx_bibblock">
Feng, T., Bose, D., Zhang, T., Hebbar, R., Ramakrishna, A., Gupta, R., Zhang, M., Avestimehr, S., and Narayanan, S.

</span>
<span class="ltx_bibblock">Fedmultimodal: A benchmark for multimodal federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, pp.  4035–4045, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2017)</span>
<span class="ltx_bibblock">
Goyal, Y., Khot, T., Summers-Stay, D., Batra, D., and Parikh, D.

</span>
<span class="ltx_bibblock">Making the V in VQA matter: Elevating the role of image understanding in visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  6325–6334, 2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. (2019)</span>
<span class="ltx_bibblock">
Hsu, T. H., Qi, H., and Brown, M.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for federated visual classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1909.06335, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2022)</span>
<span class="ltx_bibblock">
Huang, W., Ye, M., and Du, B.

</span>
<span class="ltx_bibblock">Learn from others and be yourself in heterogeneous federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  10133–10143, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2023)</span>
<span class="ltx_bibblock">
Huang, W., Ye, M., Shi, Z., Li, H., and Du, B.

</span>
<span class="ltx_bibblock">Rethinking federated learning with domain shift: A prototype view.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  16312–16322, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2021)</span>
<span class="ltx_bibblock">
Kim, W., Son, B., and Kim, I.

</span>
<span class="ltx_bibblock">Vilt: Vision-and-language transformer without convolution or region supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on Machine Learning</em>, pp.  5583–5594, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Li, J., Li, F., Zhu, L., Cui, H., and Li, J.

</span>
<span class="ltx_bibblock">Prototype-guided knowledge transfer for federated unsupervised cross-modal hashing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 31st ACM International Conference on Multimedia</em>, pp.  1013–1022, 2023.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021)</span>
<span class="ltx_bibblock">
Li, Q., He, B., and Song, D.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  10713–10722, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liao et al. (2023)</span>
<span class="ltx_bibblock">
Liao, X., Liu, W., Chen, C., Zhou, P., Zhu, H., Tan, Y., Wang, J., and Qi, Y.

</span>
<span class="ltx_bibblock">Hyperfed: Hyperbolic prototypes exploration with consistent aggregation for non-iid data in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirty-Second International Joint Conference on Artificial Intelligence</em>, pp.  3957–3965, 2023.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Liu, J., Zhan, Y., Luo, X., Chen, Z., Wang, Y., and Xu, X.

</span>
<span class="ltx_bibblock">Prototype-based layered federated cross-modal hashing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Acoustics, Speech and Signal Processing</em>, pp.  1–2, 2023.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lyu et al. (2023)</span>
<span class="ltx_bibblock">
Lyu, F., Tang, C., Deng, Y., Liu, T., Zhang, Y., and Zhang, Y.

</span>
<span class="ltx_bibblock">A prototype-based knowledge distillation framework for heterogeneous federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">43rd IEEE International Conference on Distributed Computing Systems</em>, pp.  1–11, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2021)</span>
<span class="ltx_bibblock">
Ma, M., Ren, J., Zhao, L., Tulyakov, S., Wu, C., and Peng, X.

</span>
<span class="ltx_bibblock">SMIL: multimodal learning with severely missing modality.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Thirty-Fifth AAAI Conference on Artificial Intelligence</em>, pp.  2302–2310, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2022)</span>
<span class="ltx_bibblock">
Ma, M., Ren, J., Zhao, L., Testuggine, D., and Peng, X.

</span>
<span class="ltx_bibblock">Are multimodal transformers robust to missing modality?

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  18156–18165, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on Artificial Intelligence and Statistics</em>, volume 54 of <em id="bib.bib22.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  1273–1282, 2017.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mendieta et al. (2022)</span>
<span class="ltx_bibblock">
Mendieta, M., Yang, T., Wang, P., Lee, M., Ding, Z., and Chen, C.

</span>
<span class="ltx_bibblock">Local learning matters: Rethinking data heterogeneity in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  8387–8396, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2022)</span>
<span class="ltx_bibblock">
Peng, Z., Dong, L., Bao, H., Ye, Q., and Wei, F.

</span>
<span class="ltx_bibblock">BEiT v2: Masked image modeling with vector-quantized visual tokenizers.

</span>
<span class="ltx_bibblock">2022.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al. (2022)</span>
<span class="ltx_bibblock">
Qu, L., Zhou, Y., Liang, P. P., Xia, Y., Wang, F., Adeli, E., Fei-Fei, L., and Rubin, D. L.

</span>
<span class="ltx_bibblock">Rethinking architecture design for tackling data heterogeneity in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  10051–10061, 2022.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Radford, A., Kim, J. W., Hallacy, C., Ramesh, A., Goh, G., Agarwal, S., Sastry, G., Askell, A., Mishkin, P., Clark, J., et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on Machine Learning</em>, pp.  8748–8763, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramesh et al. (2022)</span>
<span class="ltx_bibblock">
Ramesh, A., Dhariwal, P., Nichol, A., Chu, C., and Chen, M.

</span>
<span class="ltx_bibblock">Hierarchical text-conditional image generation with CLIP latents.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2204.06125, 2022.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Snell et al. (2017)</span>
<span class="ltx_bibblock">
Snell, J., Swersky, K., and Zemel, R. S.

</span>
<span class="ltx_bibblock">Prototypical networks for few-shot learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, pp.  4077–4087, 2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022)</span>
<span class="ltx_bibblock">
Tan, Y., Long, G., Liu, L., Zhou, T., Lu, Q., Jiang, J., and Zhang, C.

</span>
<span class="ltx_bibblock">Fedproto: Federated prototype learning across heterogeneous clients.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Thirty-Sixth AAAI Conference on Artificial Intelligence</em>, pp.  8432–8440, 2022.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van der Maaten &amp; Hinton (2008)</span>
<span class="ltx_bibblock">
Van der Maaten, L. and Hinton, G.

</span>
<span class="ltx_bibblock">Visualizing data using t-sne.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Journal of machine learning research</em>, 9(11), 2008.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023a)</span>
<span class="ltx_bibblock">
Wang, H., Chen, Y., Ma, C., Avery, J., Hull, L., and Carneiro, G.

</span>
<span class="ltx_bibblock">Multi-modal learning with missing modality via shared-specific feature modelling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  15878–15887, 2023a.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023b)</span>
<span class="ltx_bibblock">
Wang, W., Bao, H., Dong, L., Bjorck, J., Peng, Z., Liu, Q., Aggarwal, K., Mohammed, O. K., Singhal, S., Som, S., and Wei, F.

</span>
<span class="ltx_bibblock">Image as a foreign language: BEIT pretraining for vision and vision-language tasks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  19175–19186, 2023b.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023)</span>
<span class="ltx_bibblock">
Xu, J., Tong, X., and Huang, S.

</span>
<span class="ltx_bibblock">Personalized federated learning with feature alignment and classifier collaboration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022)</span>
<span class="ltx_bibblock">
Yu, J., Wang, Z., Vasudevan, V., Yeung, L., Seyedhosseini, M., and Wu, Y.

</span>
<span class="ltx_bibblock">Coca: Contrastive captioners are image-text foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Transactions on Machine Learning Research</em>, 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
<span class="ltx_bibblock">
Yu, Q., Liu, Y., Wang, Y., Xu, K., and Liu, J.

</span>
<span class="ltx_bibblock">Multimodal federated learning via contrastive representation ensemble.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Zhang, H., Cissé, M., Dauphin, Y. N., and Lopez-Paz, D.

</span>
<span class="ltx_bibblock">mixup: Beyond empirical risk minimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2021)</span>
<span class="ltx_bibblock">
Zhao, J., Li, R., and Jin, Q.

</span>
<span class="ltx_bibblock">Missing modality imagination network for emotion recognition with uncertain missing modalities.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing</em>, pp.  2608–2618, 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2022)</span>
<span class="ltx_bibblock">
Zhao, Y., Barnaghi, P. M., and Haddadi, H.

</span>
<span class="ltx_bibblock">Multimodal federated learning on iot data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Seventh IEEE/ACM International Conference on Internet-of-Things Design and Implementation</em>, pp.  43–54, 2022.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2021)</span>
<span class="ltx_bibblock">
Zhu, Z., Hong, J., and Zhou, J.

</span>
<span class="ltx_bibblock">Data-free knowledge distillation for heterogeneous federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on Machine Learning</em>, pp.  12878–12889, 2021.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Extend to Other Multimodal Tasks</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">In the main body, we illustrate the framework of PmcmFL using a text-image multimodal classification task (VQA) as an example and apply VQA to evaluate the framework’s performance.
However, this does not imply that our PmcmFL is limited to specific modalities or tasks.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.1" class="ltx_p">On the contrary, as the PmcmFL framework does not depend on specific model structures and only requires the model to be abstractly divided into modal encoders, fusion layers, and task heads, PmcmFL can be directly extended to almost all <span id="A1.p2.1.1" class="ltx_text ltx_font_bold">multimodal classification tasks</span>.</p>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.1" class="ltx_p">In Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:other_task</span>, we list some datasets to which PmcmFL can be extended, including the modalities and tasks associated with these datasets. The table represents just the tip of the iceberg for multimodal tasks that require modal fusion.</p>
</div>
<figure id="A1.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Datasets that PmcmFL can be extended to.</figcaption>
<table id="A1.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.1.1.1" class="ltx_tr">
<th id="A1.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Datasets</th>
<th id="A1.T4.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="A1.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Modalities</th>
<th id="A1.T4.1.1.1.4" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="A1.T4.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Tasks</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.1.2.1" class="ltx_tr">
<td id="A1.T4.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">CrisisMMD</td>
<td id="A1.T4.1.2.1.2" class="ltx_td ltx_border_t"></td>
<td id="A1.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">Image, Text</td>
<td id="A1.T4.1.2.1.4" class="ltx_td ltx_border_t"></td>
<td id="A1.T4.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">Crisis Information Classification</td>
</tr>
<tr id="A1.T4.1.3.2" class="ltx_tr">
<td id="A1.T4.1.3.2.1" class="ltx_td ltx_align_center">Hateful-Memes</td>
<td id="A1.T4.1.3.2.2" class="ltx_td"></td>
<td id="A1.T4.1.3.2.3" class="ltx_td ltx_align_center">Image, Text</td>
<td id="A1.T4.1.3.2.4" class="ltx_td"></td>
<td id="A1.T4.1.3.2.5" class="ltx_td ltx_align_center">Hateful Content Detection</td>
</tr>
<tr id="A1.T4.1.4.3" class="ltx_tr">
<td id="A1.T4.1.4.3.1" class="ltx_td ltx_align_center">MOSI</td>
<td id="A1.T4.1.4.3.2" class="ltx_td"></td>
<td id="A1.T4.1.4.3.3" class="ltx_td ltx_align_center">Video, Audio, Text</td>
<td id="A1.T4.1.4.3.4" class="ltx_td"></td>
<td id="A1.T4.1.4.3.5" class="ltx_td ltx_align_center">Multimodal Sentiment Analysis</td>
</tr>
<tr id="A1.T4.1.5.4" class="ltx_tr">
<td id="A1.T4.1.5.4.1" class="ltx_td ltx_align_center">MELD</td>
<td id="A1.T4.1.5.4.2" class="ltx_td"></td>
<td id="A1.T4.1.5.4.3" class="ltx_td ltx_align_center">Audio, Text</td>
<td id="A1.T4.1.5.4.4" class="ltx_td"></td>
<td id="A1.T4.1.5.4.5" class="ltx_td ltx_align_center">Multimodal Sentiment Analysis</td>
</tr>
<tr id="A1.T4.1.6.5" class="ltx_tr">
<td id="A1.T4.1.6.5.1" class="ltx_td ltx_align_center ltx_border_bb">UCF101</td>
<td id="A1.T4.1.6.5.2" class="ltx_td ltx_border_bb"></td>
<td id="A1.T4.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">Video, Audio</td>
<td id="A1.T4.1.6.5.4" class="ltx_td ltx_border_bb"></td>
<td id="A1.T4.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb">Multimodal Action Recognition</td>
</tr>
</tbody>
</table>
</figure>
<div id="A1.p4" class="ltx_para">
<p id="A1.p4.1" class="ltx_p">We can see that the datasets to which PmcmFL can be extended encompass inputs from various modalities and involve a variety of task types.</p>
</div>
<div id="A1.p5" class="ltx_para">
<p id="A1.p5.1" class="ltx_p">As for the extension strategy, taking the multimodal sentiment classification task on the MOSI dataset as an example, one simply needs to replace the image-text encoder described in PmcmFL with a video encoder, speech encoder, and text encoder.
The fusion module can be specially designed for the task, along with a corresponding classification task head.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Algorithm of PmcmFL</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix B Algorithm of PmcmFL ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Algorithm <a href="#alg2" title="Algorithm 2 ‣ Appendix B Algorithm of PmcmFL ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrate the flowcharts of our PmcmFL during training and inference, respectively.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.32.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Training of PmcmFL.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.8" class="ltx_p ltx_figure_panel"><span id="alg1.8.1" class="ltx_text"><span id="alg1.8.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>
Number of federated communication rounds <math id="alg1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">T</annotation></semantics></math>,
number of clients <math id="alg1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">C</annotation></semantics></math>,
number of local epochs <math id="alg1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">E</annotation></semantics></math>,
server model,
local model <math id="alg1.4.m4.3" class="ltx_Math" alttext="(\mathcal{E}_{n},\mathcal{F}_{n},\mathcal{G}_{n})" display="inline"><semantics id="alg1.4.m4.3a"><mrow id="alg1.4.m4.3.3.3" xref="alg1.4.m4.3.3.4.cmml"><mo stretchy="false" id="alg1.4.m4.3.3.3.4" xref="alg1.4.m4.3.3.4.cmml">(</mo><msub id="alg1.4.m4.1.1.1.1" xref="alg1.4.m4.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.4.m4.1.1.1.1.2" xref="alg1.4.m4.1.1.1.1.2.cmml">ℰ</mi><mi id="alg1.4.m4.1.1.1.1.3" xref="alg1.4.m4.1.1.1.1.3.cmml">n</mi></msub><mo id="alg1.4.m4.3.3.3.5" xref="alg1.4.m4.3.3.4.cmml">,</mo><msub id="alg1.4.m4.2.2.2.2" xref="alg1.4.m4.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.4.m4.2.2.2.2.2" xref="alg1.4.m4.2.2.2.2.2.cmml">ℱ</mi><mi id="alg1.4.m4.2.2.2.2.3" xref="alg1.4.m4.2.2.2.2.3.cmml">n</mi></msub><mo id="alg1.4.m4.3.3.3.6" xref="alg1.4.m4.3.3.4.cmml">,</mo><msub id="alg1.4.m4.3.3.3.3" xref="alg1.4.m4.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.4.m4.3.3.3.3.2" xref="alg1.4.m4.3.3.3.3.2.cmml">𝒢</mi><mi id="alg1.4.m4.3.3.3.3.3" xref="alg1.4.m4.3.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="alg1.4.m4.3.3.3.7" xref="alg1.4.m4.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.m4.3b"><vector id="alg1.4.m4.3.3.4.cmml" xref="alg1.4.m4.3.3.3"><apply id="alg1.4.m4.1.1.1.1.cmml" xref="alg1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.1.1.cmml" xref="alg1.4.m4.1.1.1.1">subscript</csymbol><ci id="alg1.4.m4.1.1.1.1.2.cmml" xref="alg1.4.m4.1.1.1.1.2">ℰ</ci><ci id="alg1.4.m4.1.1.1.1.3.cmml" xref="alg1.4.m4.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.4.m4.2.2.2.2.cmml" xref="alg1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.4.m4.2.2.2.2.1.cmml" xref="alg1.4.m4.2.2.2.2">subscript</csymbol><ci id="alg1.4.m4.2.2.2.2.2.cmml" xref="alg1.4.m4.2.2.2.2.2">ℱ</ci><ci id="alg1.4.m4.2.2.2.2.3.cmml" xref="alg1.4.m4.2.2.2.2.3">𝑛</ci></apply><apply id="alg1.4.m4.3.3.3.3.cmml" xref="alg1.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="alg1.4.m4.3.3.3.3.1.cmml" xref="alg1.4.m4.3.3.3.3">subscript</csymbol><ci id="alg1.4.m4.3.3.3.3.2.cmml" xref="alg1.4.m4.3.3.3.3.2">𝒢</ci><ci id="alg1.4.m4.3.3.3.3.3.cmml" xref="alg1.4.m4.3.3.3.3.3">𝑛</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.3c">(\mathcal{E}_{n},\mathcal{F}_{n},\mathcal{G}_{n})</annotation></semantics></math>,
local learning rate <math id="alg1.5.m5.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.5.m5.1a"><mi id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><ci id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">\eta</annotation></semantics></math>,
dataset <math id="alg1.6.m6.3" class="ltx_Math" alttext="\mathcal{D}_{n}=(\mathcal{M}_{n},\mathcal{I}_{n},\mathcal{T}_{n})" display="inline"><semantics id="alg1.6.m6.3a"><mrow id="alg1.6.m6.3.3" xref="alg1.6.m6.3.3.cmml"><msub id="alg1.6.m6.3.3.5" xref="alg1.6.m6.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.6.m6.3.3.5.2" xref="alg1.6.m6.3.3.5.2.cmml">𝒟</mi><mi id="alg1.6.m6.3.3.5.3" xref="alg1.6.m6.3.3.5.3.cmml">n</mi></msub><mo id="alg1.6.m6.3.3.4" xref="alg1.6.m6.3.3.4.cmml">=</mo><mrow id="alg1.6.m6.3.3.3.3" xref="alg1.6.m6.3.3.3.4.cmml"><mo stretchy="false" id="alg1.6.m6.3.3.3.3.4" xref="alg1.6.m6.3.3.3.4.cmml">(</mo><msub id="alg1.6.m6.1.1.1.1.1" xref="alg1.6.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.6.m6.1.1.1.1.1.2" xref="alg1.6.m6.1.1.1.1.1.2.cmml">ℳ</mi><mi id="alg1.6.m6.1.1.1.1.1.3" xref="alg1.6.m6.1.1.1.1.1.3.cmml">n</mi></msub><mo id="alg1.6.m6.3.3.3.3.5" xref="alg1.6.m6.3.3.3.4.cmml">,</mo><msub id="alg1.6.m6.2.2.2.2.2" xref="alg1.6.m6.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.6.m6.2.2.2.2.2.2" xref="alg1.6.m6.2.2.2.2.2.2.cmml">ℐ</mi><mi id="alg1.6.m6.2.2.2.2.2.3" xref="alg1.6.m6.2.2.2.2.2.3.cmml">n</mi></msub><mo id="alg1.6.m6.3.3.3.3.6" xref="alg1.6.m6.3.3.3.4.cmml">,</mo><msub id="alg1.6.m6.3.3.3.3.3" xref="alg1.6.m6.3.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.6.m6.3.3.3.3.3.2" xref="alg1.6.m6.3.3.3.3.3.2.cmml">𝒯</mi><mi id="alg1.6.m6.3.3.3.3.3.3" xref="alg1.6.m6.3.3.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="alg1.6.m6.3.3.3.3.7" xref="alg1.6.m6.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.m6.3b"><apply id="alg1.6.m6.3.3.cmml" xref="alg1.6.m6.3.3"><eq id="alg1.6.m6.3.3.4.cmml" xref="alg1.6.m6.3.3.4"></eq><apply id="alg1.6.m6.3.3.5.cmml" xref="alg1.6.m6.3.3.5"><csymbol cd="ambiguous" id="alg1.6.m6.3.3.5.1.cmml" xref="alg1.6.m6.3.3.5">subscript</csymbol><ci id="alg1.6.m6.3.3.5.2.cmml" xref="alg1.6.m6.3.3.5.2">𝒟</ci><ci id="alg1.6.m6.3.3.5.3.cmml" xref="alg1.6.m6.3.3.5.3">𝑛</ci></apply><vector id="alg1.6.m6.3.3.3.4.cmml" xref="alg1.6.m6.3.3.3.3"><apply id="alg1.6.m6.1.1.1.1.1.cmml" xref="alg1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.6.m6.1.1.1.1.1.1.cmml" xref="alg1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="alg1.6.m6.1.1.1.1.1.2.cmml" xref="alg1.6.m6.1.1.1.1.1.2">ℳ</ci><ci id="alg1.6.m6.1.1.1.1.1.3.cmml" xref="alg1.6.m6.1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.6.m6.2.2.2.2.2.cmml" xref="alg1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.6.m6.2.2.2.2.2.1.cmml" xref="alg1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="alg1.6.m6.2.2.2.2.2.2.cmml" xref="alg1.6.m6.2.2.2.2.2.2">ℐ</ci><ci id="alg1.6.m6.2.2.2.2.2.3.cmml" xref="alg1.6.m6.2.2.2.2.2.3">𝑛</ci></apply><apply id="alg1.6.m6.3.3.3.3.3.cmml" xref="alg1.6.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.6.m6.3.3.3.3.3.1.cmml" xref="alg1.6.m6.3.3.3.3.3">subscript</csymbol><ci id="alg1.6.m6.3.3.3.3.3.2.cmml" xref="alg1.6.m6.3.3.3.3.3.2">𝒯</ci><ci id="alg1.6.m6.3.3.3.3.3.3.cmml" xref="alg1.6.m6.3.3.3.3.3.3">𝑛</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.3c">\mathcal{D}_{n}=(\mathcal{M}_{n},\mathcal{I}_{n},\mathcal{T}_{n})</annotation></semantics></math> of the <math id="alg1.7.m7.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.7.m7.1a"><mi id="alg1.7.m7.1.1" xref="alg1.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><ci id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">n</annotation></semantics></math>-th client
and fraction of clients <math id="alg1.8.m8.1" class="ltx_Math" alttext="s" display="inline"><semantics id="alg1.8.m8.1a"><mi id="alg1.8.m8.1.1" xref="alg1.8.m8.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m8.1b"><ci id="alg1.8.m8.1.1.cmml" xref="alg1.8.m8.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m8.1c">s</annotation></semantics></math> that are selected to perform computation in each round.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.9" class="ltx_p ltx_figure_panel"><span id="alg1.9.1" class="ltx_text"><span id="alg1.9.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>The final server model’s parameters <math id="alg1.9.m1.1" class="ltx_Math" alttext="\omega^{T}" display="inline"><semantics id="alg1.9.m1.1a"><msup id="alg1.9.m1.1.1" xref="alg1.9.m1.1.1.cmml"><mi id="alg1.9.m1.1.1.2" xref="alg1.9.m1.1.1.2.cmml">ω</mi><mi id="alg1.9.m1.1.1.3" xref="alg1.9.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.9.m1.1b"><apply id="alg1.9.m1.1.1.cmml" xref="alg1.9.m1.1.1"><csymbol cd="ambiguous" id="alg1.9.m1.1.1.1.cmml" xref="alg1.9.m1.1.1">superscript</csymbol><ci id="alg1.9.m1.1.1.2.cmml" xref="alg1.9.m1.1.1.2">𝜔</ci><ci id="alg1.9.m1.1.1.3.cmml" xref="alg1.9.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m1.1c">\omega^{T}</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.33" class="ltx_p ltx_figure_panel"><span id="alg1.33.1" class="ltx_text ltx_font_bold">ServerExecutes</span>:</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.10" class="ltx_p ltx_figure_panel">Initialize <math id="alg1.10.m1.1" class="ltx_Math" alttext="{\omega}^{0}" display="inline"><semantics id="alg1.10.m1.1a"><msup id="alg1.10.m1.1.1" xref="alg1.10.m1.1.1.cmml"><mi id="alg1.10.m1.1.1.2" xref="alg1.10.m1.1.1.2.cmml">ω</mi><mn id="alg1.10.m1.1.1.3" xref="alg1.10.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.10.m1.1b"><apply id="alg1.10.m1.1.1.cmml" xref="alg1.10.m1.1.1"><csymbol cd="ambiguous" id="alg1.10.m1.1.1.1.cmml" xref="alg1.10.m1.1.1">superscript</csymbol><ci id="alg1.10.m1.1.1.2.cmml" xref="alg1.10.m1.1.1.2">𝜔</ci><cn type="integer" id="alg1.10.m1.1.1.3.cmml" xref="alg1.10.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m1.1c">{\omega}^{0}</annotation></semantics></math> randomly;</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.11" class="ltx_p ltx_figure_panel">Initialize global prototypes <math id="alg1.11.m1.3" class="ltx_Math" alttext="\mathcal{P_{I}}_{-local},\mathcal{P_{T}}_{-local},\mathcal{P_{F}}_{-local}" display="inline"><semantics id="alg1.11.m1.3a"><mrow id="alg1.11.m1.3.3.3" xref="alg1.11.m1.3.3.4.cmml"><mmultiscripts id="alg1.11.m1.1.1.1.1" xref="alg1.11.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.11.m1.1.1.1.1.2.2" xref="alg1.11.m1.1.1.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.11.m1.1.1.1.1.2.3" xref="alg1.11.m1.1.1.1.1.2.3.cmml">ℐ</mi><mrow id="alg1.11.m1.1.1.1.1a" xref="alg1.11.m1.1.1.1.1.cmml"></mrow><mrow id="alg1.11.m1.1.1.1.1.3" xref="alg1.11.m1.1.1.1.1.3.cmml"><mo id="alg1.11.m1.1.1.1.1.3a" xref="alg1.11.m1.1.1.1.1.3.cmml">−</mo><mrow id="alg1.11.m1.1.1.1.1.3.2" xref="alg1.11.m1.1.1.1.1.3.2.cmml"><mi id="alg1.11.m1.1.1.1.1.3.2.2" xref="alg1.11.m1.1.1.1.1.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.1.1.1.1.3.2.1" xref="alg1.11.m1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.11.m1.1.1.1.1.3.2.3" xref="alg1.11.m1.1.1.1.1.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.1.1.1.1.3.2.1a" xref="alg1.11.m1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.11.m1.1.1.1.1.3.2.4" xref="alg1.11.m1.1.1.1.1.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.1.1.1.1.3.2.1b" xref="alg1.11.m1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.11.m1.1.1.1.1.3.2.5" xref="alg1.11.m1.1.1.1.1.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.1.1.1.1.3.2.1c" xref="alg1.11.m1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.11.m1.1.1.1.1.3.2.6" xref="alg1.11.m1.1.1.1.1.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.11.m1.1.1.1.1b" xref="alg1.11.m1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="alg1.11.m1.3.3.3.4" xref="alg1.11.m1.3.3.4.cmml">,</mo><mmultiscripts id="alg1.11.m1.2.2.2.2" xref="alg1.11.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.11.m1.2.2.2.2.2.2" xref="alg1.11.m1.2.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.11.m1.2.2.2.2.2.3" xref="alg1.11.m1.2.2.2.2.2.3.cmml">𝒯</mi><mrow id="alg1.11.m1.2.2.2.2a" xref="alg1.11.m1.2.2.2.2.cmml"></mrow><mrow id="alg1.11.m1.2.2.2.2.3" xref="alg1.11.m1.2.2.2.2.3.cmml"><mo id="alg1.11.m1.2.2.2.2.3a" xref="alg1.11.m1.2.2.2.2.3.cmml">−</mo><mrow id="alg1.11.m1.2.2.2.2.3.2" xref="alg1.11.m1.2.2.2.2.3.2.cmml"><mi id="alg1.11.m1.2.2.2.2.3.2.2" xref="alg1.11.m1.2.2.2.2.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.2.2.2.2.3.2.1" xref="alg1.11.m1.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.11.m1.2.2.2.2.3.2.3" xref="alg1.11.m1.2.2.2.2.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.2.2.2.2.3.2.1a" xref="alg1.11.m1.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.11.m1.2.2.2.2.3.2.4" xref="alg1.11.m1.2.2.2.2.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.2.2.2.2.3.2.1b" xref="alg1.11.m1.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.11.m1.2.2.2.2.3.2.5" xref="alg1.11.m1.2.2.2.2.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.2.2.2.2.3.2.1c" xref="alg1.11.m1.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.11.m1.2.2.2.2.3.2.6" xref="alg1.11.m1.2.2.2.2.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.11.m1.2.2.2.2b" xref="alg1.11.m1.2.2.2.2.cmml"></mrow></mmultiscripts><mo id="alg1.11.m1.3.3.3.5" xref="alg1.11.m1.3.3.4.cmml">,</mo><mmultiscripts id="alg1.11.m1.3.3.3.3" xref="alg1.11.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.11.m1.3.3.3.3.2.2" xref="alg1.11.m1.3.3.3.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.11.m1.3.3.3.3.2.3" xref="alg1.11.m1.3.3.3.3.2.3.cmml">ℱ</mi><mrow id="alg1.11.m1.3.3.3.3a" xref="alg1.11.m1.3.3.3.3.cmml"></mrow><mrow id="alg1.11.m1.3.3.3.3.3" xref="alg1.11.m1.3.3.3.3.3.cmml"><mo id="alg1.11.m1.3.3.3.3.3a" xref="alg1.11.m1.3.3.3.3.3.cmml">−</mo><mrow id="alg1.11.m1.3.3.3.3.3.2" xref="alg1.11.m1.3.3.3.3.3.2.cmml"><mi id="alg1.11.m1.3.3.3.3.3.2.2" xref="alg1.11.m1.3.3.3.3.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.3.3.3.3.3.2.1" xref="alg1.11.m1.3.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.11.m1.3.3.3.3.3.2.3" xref="alg1.11.m1.3.3.3.3.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.3.3.3.3.3.2.1a" xref="alg1.11.m1.3.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.11.m1.3.3.3.3.3.2.4" xref="alg1.11.m1.3.3.3.3.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.3.3.3.3.3.2.1b" xref="alg1.11.m1.3.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.11.m1.3.3.3.3.3.2.5" xref="alg1.11.m1.3.3.3.3.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.3.3.3.3.3.2.1c" xref="alg1.11.m1.3.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.11.m1.3.3.3.3.3.2.6" xref="alg1.11.m1.3.3.3.3.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.11.m1.3.3.3.3b" xref="alg1.11.m1.3.3.3.3.cmml"></mrow></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.m1.3b"><list id="alg1.11.m1.3.3.4.cmml" xref="alg1.11.m1.3.3.3"><apply id="alg1.11.m1.1.1.1.1.cmml" xref="alg1.11.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.11.m1.1.1.1.1.1.cmml" xref="alg1.11.m1.1.1.1.1">subscript</csymbol><apply id="alg1.11.m1.1.1.1.1.2.cmml" xref="alg1.11.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.11.m1.1.1.1.1.2.1.cmml" xref="alg1.11.m1.1.1.1.1">subscript</csymbol><ci id="alg1.11.m1.1.1.1.1.2.2.cmml" xref="alg1.11.m1.1.1.1.1.2.2">𝒫</ci><ci id="alg1.11.m1.1.1.1.1.2.3.cmml" xref="alg1.11.m1.1.1.1.1.2.3">ℐ</ci></apply><apply id="alg1.11.m1.1.1.1.1.3.cmml" xref="alg1.11.m1.1.1.1.1.3"><minus id="alg1.11.m1.1.1.1.1.3.1.cmml" xref="alg1.11.m1.1.1.1.1.3"></minus><apply id="alg1.11.m1.1.1.1.1.3.2.cmml" xref="alg1.11.m1.1.1.1.1.3.2"><times id="alg1.11.m1.1.1.1.1.3.2.1.cmml" xref="alg1.11.m1.1.1.1.1.3.2.1"></times><ci id="alg1.11.m1.1.1.1.1.3.2.2.cmml" xref="alg1.11.m1.1.1.1.1.3.2.2">𝑙</ci><ci id="alg1.11.m1.1.1.1.1.3.2.3.cmml" xref="alg1.11.m1.1.1.1.1.3.2.3">𝑜</ci><ci id="alg1.11.m1.1.1.1.1.3.2.4.cmml" xref="alg1.11.m1.1.1.1.1.3.2.4">𝑐</ci><ci id="alg1.11.m1.1.1.1.1.3.2.5.cmml" xref="alg1.11.m1.1.1.1.1.3.2.5">𝑎</ci><ci id="alg1.11.m1.1.1.1.1.3.2.6.cmml" xref="alg1.11.m1.1.1.1.1.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.11.m1.2.2.2.2.cmml" xref="alg1.11.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.11.m1.2.2.2.2.1.cmml" xref="alg1.11.m1.2.2.2.2">subscript</csymbol><apply id="alg1.11.m1.2.2.2.2.2.cmml" xref="alg1.11.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.11.m1.2.2.2.2.2.1.cmml" xref="alg1.11.m1.2.2.2.2">subscript</csymbol><ci id="alg1.11.m1.2.2.2.2.2.2.cmml" xref="alg1.11.m1.2.2.2.2.2.2">𝒫</ci><ci id="alg1.11.m1.2.2.2.2.2.3.cmml" xref="alg1.11.m1.2.2.2.2.2.3">𝒯</ci></apply><apply id="alg1.11.m1.2.2.2.2.3.cmml" xref="alg1.11.m1.2.2.2.2.3"><minus id="alg1.11.m1.2.2.2.2.3.1.cmml" xref="alg1.11.m1.2.2.2.2.3"></minus><apply id="alg1.11.m1.2.2.2.2.3.2.cmml" xref="alg1.11.m1.2.2.2.2.3.2"><times id="alg1.11.m1.2.2.2.2.3.2.1.cmml" xref="alg1.11.m1.2.2.2.2.3.2.1"></times><ci id="alg1.11.m1.2.2.2.2.3.2.2.cmml" xref="alg1.11.m1.2.2.2.2.3.2.2">𝑙</ci><ci id="alg1.11.m1.2.2.2.2.3.2.3.cmml" xref="alg1.11.m1.2.2.2.2.3.2.3">𝑜</ci><ci id="alg1.11.m1.2.2.2.2.3.2.4.cmml" xref="alg1.11.m1.2.2.2.2.3.2.4">𝑐</ci><ci id="alg1.11.m1.2.2.2.2.3.2.5.cmml" xref="alg1.11.m1.2.2.2.2.3.2.5">𝑎</ci><ci id="alg1.11.m1.2.2.2.2.3.2.6.cmml" xref="alg1.11.m1.2.2.2.2.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.11.m1.3.3.3.3.cmml" xref="alg1.11.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.11.m1.3.3.3.3.1.cmml" xref="alg1.11.m1.3.3.3.3">subscript</csymbol><apply id="alg1.11.m1.3.3.3.3.2.cmml" xref="alg1.11.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.11.m1.3.3.3.3.2.1.cmml" xref="alg1.11.m1.3.3.3.3">subscript</csymbol><ci id="alg1.11.m1.3.3.3.3.2.2.cmml" xref="alg1.11.m1.3.3.3.3.2.2">𝒫</ci><ci id="alg1.11.m1.3.3.3.3.2.3.cmml" xref="alg1.11.m1.3.3.3.3.2.3">ℱ</ci></apply><apply id="alg1.11.m1.3.3.3.3.3.cmml" xref="alg1.11.m1.3.3.3.3.3"><minus id="alg1.11.m1.3.3.3.3.3.1.cmml" xref="alg1.11.m1.3.3.3.3.3"></minus><apply id="alg1.11.m1.3.3.3.3.3.2.cmml" xref="alg1.11.m1.3.3.3.3.3.2"><times id="alg1.11.m1.3.3.3.3.3.2.1.cmml" xref="alg1.11.m1.3.3.3.3.3.2.1"></times><ci id="alg1.11.m1.3.3.3.3.3.2.2.cmml" xref="alg1.11.m1.3.3.3.3.3.2.2">𝑙</ci><ci id="alg1.11.m1.3.3.3.3.3.2.3.cmml" xref="alg1.11.m1.3.3.3.3.3.2.3">𝑜</ci><ci id="alg1.11.m1.3.3.3.3.3.2.4.cmml" xref="alg1.11.m1.3.3.3.3.3.2.4">𝑐</ci><ci id="alg1.11.m1.3.3.3.3.3.2.5.cmml" xref="alg1.11.m1.3.3.3.3.3.2.5">𝑎</ci><ci id="alg1.11.m1.3.3.3.3.3.2.6.cmml" xref="alg1.11.m1.3.3.3.3.3.2.6">𝑙</ci></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m1.3c">\mathcal{P_{I}}_{-local},\mathcal{P_{T}}_{-local},\mathcal{P_{F}}_{-local}</annotation></semantics></math> with zero tensors;</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.12" class="ltx_p ltx_figure_panel"><span id="alg1.12.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.12.1" class="ltx_emph ltx_font_italic"><math id="alg1.12.1.m1.4" class="ltx_Math" alttext="t=1,2,\cdots,T" display="inline"><semantics id="alg1.12.1.m1.4a"><mrow id="alg1.12.1.m1.4.5" xref="alg1.12.1.m1.4.5.cmml"><mi id="alg1.12.1.m1.4.5.2" xref="alg1.12.1.m1.4.5.2.cmml">t</mi><mo id="alg1.12.1.m1.4.5.1" xref="alg1.12.1.m1.4.5.1.cmml">=</mo><mrow id="alg1.12.1.m1.4.5.3.2" xref="alg1.12.1.m1.4.5.3.1.cmml"><mn id="alg1.12.1.m1.1.1" xref="alg1.12.1.m1.1.1.cmml">1</mn><mo id="alg1.12.1.m1.4.5.3.2.1" xref="alg1.12.1.m1.4.5.3.1.cmml">,</mo><mn id="alg1.12.1.m1.2.2" xref="alg1.12.1.m1.2.2.cmml">2</mn><mo id="alg1.12.1.m1.4.5.3.2.2" xref="alg1.12.1.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.12.1.m1.3.3" xref="alg1.12.1.m1.3.3.cmml">⋯</mi><mo id="alg1.12.1.m1.4.5.3.2.3" xref="alg1.12.1.m1.4.5.3.1.cmml">,</mo><mi id="alg1.12.1.m1.4.4" xref="alg1.12.1.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.12.1.m1.4b"><apply id="alg1.12.1.m1.4.5.cmml" xref="alg1.12.1.m1.4.5"><eq id="alg1.12.1.m1.4.5.1.cmml" xref="alg1.12.1.m1.4.5.1"></eq><ci id="alg1.12.1.m1.4.5.2.cmml" xref="alg1.12.1.m1.4.5.2">𝑡</ci><list id="alg1.12.1.m1.4.5.3.1.cmml" xref="alg1.12.1.m1.4.5.3.2"><cn type="integer" id="alg1.12.1.m1.1.1.cmml" xref="alg1.12.1.m1.1.1">1</cn><cn type="integer" id="alg1.12.1.m1.2.2.cmml" xref="alg1.12.1.m1.2.2">2</cn><ci id="alg1.12.1.m1.3.3.cmml" xref="alg1.12.1.m1.3.3">⋯</ci><ci id="alg1.12.1.m1.4.4.cmml" xref="alg1.12.1.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.1.m1.4c">t=1,2,\cdots,T</annotation></semantics></math></em> <span id="alg1.12.3" class="ltx_text ltx_font_bold">do</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg1.34" class="ltx_block ltx_figure_panel">
<div id="alg1.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Compute global prototypes <math id="alg1.13.m1.3" class="ltx_Math" alttext="\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}}" display="inline"><semantics id="alg1.13.m1.3a"><mrow id="alg1.13.m1.3.3.3" xref="alg1.13.m1.3.3.4.cmml"><msub id="alg1.13.m1.1.1.1.1" xref="alg1.13.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.13.m1.1.1.1.1.2" xref="alg1.13.m1.1.1.1.1.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.13.m1.1.1.1.1.3" xref="alg1.13.m1.1.1.1.1.3.cmml">ℐ</mi></msub><mo id="alg1.13.m1.3.3.3.4" xref="alg1.13.m1.3.3.4.cmml">,</mo><msub id="alg1.13.m1.2.2.2.2" xref="alg1.13.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.13.m1.2.2.2.2.2" xref="alg1.13.m1.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.13.m1.2.2.2.2.3" xref="alg1.13.m1.2.2.2.2.3.cmml">𝒯</mi></msub><mo id="alg1.13.m1.3.3.3.5" xref="alg1.13.m1.3.3.4.cmml">,</mo><msub id="alg1.13.m1.3.3.3.3" xref="alg1.13.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.13.m1.3.3.3.3.2" xref="alg1.13.m1.3.3.3.3.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.13.m1.3.3.3.3.3" xref="alg1.13.m1.3.3.3.3.3.cmml">ℱ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.13.m1.3b"><list id="alg1.13.m1.3.3.4.cmml" xref="alg1.13.m1.3.3.3"><apply id="alg1.13.m1.1.1.1.1.cmml" xref="alg1.13.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.13.m1.1.1.1.1.1.cmml" xref="alg1.13.m1.1.1.1.1">subscript</csymbol><ci id="alg1.13.m1.1.1.1.1.2.cmml" xref="alg1.13.m1.1.1.1.1.2">𝒫</ci><ci id="alg1.13.m1.1.1.1.1.3.cmml" xref="alg1.13.m1.1.1.1.1.3">ℐ</ci></apply><apply id="alg1.13.m1.2.2.2.2.cmml" xref="alg1.13.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.13.m1.2.2.2.2.1.cmml" xref="alg1.13.m1.2.2.2.2">subscript</csymbol><ci id="alg1.13.m1.2.2.2.2.2.cmml" xref="alg1.13.m1.2.2.2.2.2">𝒫</ci><ci id="alg1.13.m1.2.2.2.2.3.cmml" xref="alg1.13.m1.2.2.2.2.3">𝒯</ci></apply><apply id="alg1.13.m1.3.3.3.3.cmml" xref="alg1.13.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.13.m1.3.3.3.3.1.cmml" xref="alg1.13.m1.3.3.3.3">subscript</csymbol><ci id="alg1.13.m1.3.3.3.3.2.cmml" xref="alg1.13.m1.3.3.3.3.2">𝒫</ci><ci id="alg1.13.m1.3.3.3.3.3.cmml" xref="alg1.13.m1.3.3.3.3.3">ℱ</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.m1.3c">\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}}</annotation></semantics></math> according to Equation <a href="#S3.E1" title="Equation 1 ‣ 3.2 Constructing Prototype Library ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> <a href="#S3.E2" title="Equation 2 ‣ 3.2 Constructing Prototype Library ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> <a href="#S3.E3" title="Equation 3 ‣ 3.2 Constructing Prototype Library ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>;
<math id="alg1.14.m2.2" class="ltx_Math" alttext="\mathcal{P_{I}}_{-local},\mathcal{P_{T}}_{-local},\mathcal{P_{F}}_{-local}\leftarrow[~{}],[~{}],[~{}]" display="inline"><semantics id="alg1.14.m2.2a"><mrow id="alg1.14.m2.2.2.2" xref="alg1.14.m2.2.2.3.cmml"><mrow id="alg1.14.m2.1.1.1.1" xref="alg1.14.m2.1.1.1.1.cmml"><mrow id="alg1.14.m2.1.1.1.1.3.3" xref="alg1.14.m2.1.1.1.1.3.4.cmml"><mmultiscripts id="alg1.14.m2.1.1.1.1.1.1.1" xref="alg1.14.m2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.14.m2.1.1.1.1.1.1.1.2.2" xref="alg1.14.m2.1.1.1.1.1.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.14.m2.1.1.1.1.1.1.1.2.3" xref="alg1.14.m2.1.1.1.1.1.1.1.2.3.cmml">ℐ</mi><mrow id="alg1.14.m2.1.1.1.1.1.1.1a" xref="alg1.14.m2.1.1.1.1.1.1.1.cmml"></mrow><mrow id="alg1.14.m2.1.1.1.1.1.1.1.3" xref="alg1.14.m2.1.1.1.1.1.1.1.3.cmml"><mo id="alg1.14.m2.1.1.1.1.1.1.1.3a" xref="alg1.14.m2.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="alg1.14.m2.1.1.1.1.1.1.1.3.2" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.14.m2.1.1.1.1.1.1.1.3.2.2" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.1.1.1.3.2.1" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.1.1.1.3.2.3" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.1.1.1.3.2.1a" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.1.1.1.3.2.4" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.1.1.1.3.2.1b" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.1.1.1.3.2.5" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.1.1.1.3.2.1c" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.1.1.1.3.2.6" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.14.m2.1.1.1.1.1.1.1b" xref="alg1.14.m2.1.1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="alg1.14.m2.1.1.1.1.3.3.4" xref="alg1.14.m2.1.1.1.1.3.4.cmml">,</mo><mmultiscripts id="alg1.14.m2.1.1.1.1.2.2.2" xref="alg1.14.m2.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.14.m2.1.1.1.1.2.2.2.2.2" xref="alg1.14.m2.1.1.1.1.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.14.m2.1.1.1.1.2.2.2.2.3" xref="alg1.14.m2.1.1.1.1.2.2.2.2.3.cmml">𝒯</mi><mrow id="alg1.14.m2.1.1.1.1.2.2.2a" xref="alg1.14.m2.1.1.1.1.2.2.2.cmml"></mrow><mrow id="alg1.14.m2.1.1.1.1.2.2.2.3" xref="alg1.14.m2.1.1.1.1.2.2.2.3.cmml"><mo id="alg1.14.m2.1.1.1.1.2.2.2.3a" xref="alg1.14.m2.1.1.1.1.2.2.2.3.cmml">−</mo><mrow id="alg1.14.m2.1.1.1.1.2.2.2.3.2" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.cmml"><mi id="alg1.14.m2.1.1.1.1.2.2.2.3.2.2" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.2.2.2.3.2.1" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.2.2.2.3.2.3" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.2.2.2.3.2.1a" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.2.2.2.3.2.4" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.2.2.2.3.2.1b" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.2.2.2.3.2.5" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.2.2.2.3.2.1c" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.2.2.2.3.2.6" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.14.m2.1.1.1.1.2.2.2b" xref="alg1.14.m2.1.1.1.1.2.2.2.cmml"></mrow></mmultiscripts><mo id="alg1.14.m2.1.1.1.1.3.3.5" xref="alg1.14.m2.1.1.1.1.3.4.cmml">,</mo><mmultiscripts id="alg1.14.m2.1.1.1.1.3.3.3" xref="alg1.14.m2.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.14.m2.1.1.1.1.3.3.3.2.2" xref="alg1.14.m2.1.1.1.1.3.3.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.14.m2.1.1.1.1.3.3.3.2.3" xref="alg1.14.m2.1.1.1.1.3.3.3.2.3.cmml">ℱ</mi><mrow id="alg1.14.m2.1.1.1.1.3.3.3a" xref="alg1.14.m2.1.1.1.1.3.3.3.cmml"></mrow><mrow id="alg1.14.m2.1.1.1.1.3.3.3.3" xref="alg1.14.m2.1.1.1.1.3.3.3.3.cmml"><mo id="alg1.14.m2.1.1.1.1.3.3.3.3a" xref="alg1.14.m2.1.1.1.1.3.3.3.3.cmml">−</mo><mrow id="alg1.14.m2.1.1.1.1.3.3.3.3.2" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.cmml"><mi id="alg1.14.m2.1.1.1.1.3.3.3.3.2.2" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.3.3.3.3.2.1" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.3.3.3.3.2.3" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.3.3.3.3.2.1a" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.3.3.3.3.2.4" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.3.3.3.3.2.1b" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.3.3.3.3.2.5" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.14.m2.1.1.1.1.3.3.3.3.2.1c" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.14.m2.1.1.1.1.3.3.3.3.2.6" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.14.m2.1.1.1.1.3.3.3b" xref="alg1.14.m2.1.1.1.1.3.3.3.cmml"></mrow></mmultiscripts></mrow><mo stretchy="false" id="alg1.14.m2.1.1.1.1.4" xref="alg1.14.m2.1.1.1.1.4.cmml">←</mo><mrow id="alg1.14.m2.1.1.1.1.5.2" xref="alg1.14.m2.1.1.1.1.cmml"><mo rspace="0.330em" stretchy="false" id="alg1.14.m2.1.1.1.1.5.2.1" xref="alg1.14.m2.1.1.1.1.5.1.cmml">[</mo><mo stretchy="false" id="alg1.14.m2.1.1.1.1.5.2.2" xref="alg1.14.m2.1.1.1.1.5.1.cmml">]</mo></mrow></mrow><mo id="alg1.14.m2.2.2.2.3" xref="alg1.14.m2.2.2.3a.cmml">,</mo><mrow id="alg1.14.m2.2.2.2.2.2" xref="alg1.14.m2.2.2.2.2.3.cmml"><mrow id="alg1.14.m2.2.2.2.2.1.1.2" xref="alg1.14.m2.2.2.2.2.3.cmml"><mo rspace="0.330em" stretchy="false" id="alg1.14.m2.2.2.2.2.1.1.2.1" xref="alg1.14.m2.2.2.2.2.1.1.1.cmml">[</mo><mo stretchy="false" id="alg1.14.m2.2.2.2.2.1.1.2.2" xref="alg1.14.m2.2.2.2.2.1.1.1.cmml">]</mo></mrow><mo id="alg1.14.m2.2.2.2.2.2.3" xref="alg1.14.m2.2.2.2.2.3.cmml">,</mo><mrow id="alg1.14.m2.2.2.2.2.2.2.2" xref="alg1.14.m2.2.2.2.2.3.cmml"><mo rspace="0.330em" stretchy="false" id="alg1.14.m2.2.2.2.2.2.2.2.1" xref="alg1.14.m2.2.2.2.2.2.2.1.cmml">[</mo><mo stretchy="false" id="alg1.14.m2.2.2.2.2.2.2.2.2" xref="alg1.14.m2.2.2.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.m2.2b"><apply id="alg1.14.m2.2.2.3.cmml" xref="alg1.14.m2.2.2.2"><csymbol cd="ambiguous" id="alg1.14.m2.2.2.3a.cmml" xref="alg1.14.m2.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.14.m2.1.1.1.1.cmml" xref="alg1.14.m2.1.1.1.1"><ci id="alg1.14.m2.1.1.1.1.4.cmml" xref="alg1.14.m2.1.1.1.1.4">←</ci><list id="alg1.14.m2.1.1.1.1.3.4.cmml" xref="alg1.14.m2.1.1.1.1.3.3"><apply id="alg1.14.m2.1.1.1.1.1.1.1.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.14.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.14.m2.1.1.1.1.1.1.1.2.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.14.m2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.14.m2.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.2.2">𝒫</ci><ci id="alg1.14.m2.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.2.3">ℐ</ci></apply><apply id="alg1.14.m2.1.1.1.1.1.1.1.3.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3"><minus id="alg1.14.m2.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3"></minus><apply id="alg1.14.m2.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2"><times id="alg1.14.m2.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.1"></times><ci id="alg1.14.m2.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.2">𝑙</ci><ci id="alg1.14.m2.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.3">𝑜</ci><ci id="alg1.14.m2.1.1.1.1.1.1.1.3.2.4.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.4">𝑐</ci><ci id="alg1.14.m2.1.1.1.1.1.1.1.3.2.5.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.5">𝑎</ci><ci id="alg1.14.m2.1.1.1.1.1.1.1.3.2.6.cmml" xref="alg1.14.m2.1.1.1.1.1.1.1.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.14.m2.1.1.1.1.2.2.2.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.14.m2.1.1.1.1.2.2.2.1.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2">subscript</csymbol><apply id="alg1.14.m2.1.1.1.1.2.2.2.2.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.14.m2.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.14.m2.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.2.2">𝒫</ci><ci id="alg1.14.m2.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.2.3">𝒯</ci></apply><apply id="alg1.14.m2.1.1.1.1.2.2.2.3.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3"><minus id="alg1.14.m2.1.1.1.1.2.2.2.3.1.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3"></minus><apply id="alg1.14.m2.1.1.1.1.2.2.2.3.2.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2"><times id="alg1.14.m2.1.1.1.1.2.2.2.3.2.1.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.1"></times><ci id="alg1.14.m2.1.1.1.1.2.2.2.3.2.2.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.2">𝑙</ci><ci id="alg1.14.m2.1.1.1.1.2.2.2.3.2.3.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.3">𝑜</ci><ci id="alg1.14.m2.1.1.1.1.2.2.2.3.2.4.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.4">𝑐</ci><ci id="alg1.14.m2.1.1.1.1.2.2.2.3.2.5.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.5">𝑎</ci><ci id="alg1.14.m2.1.1.1.1.2.2.2.3.2.6.cmml" xref="alg1.14.m2.1.1.1.1.2.2.2.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.14.m2.1.1.1.1.3.3.3.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.14.m2.1.1.1.1.3.3.3.1.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3">subscript</csymbol><apply id="alg1.14.m2.1.1.1.1.3.3.3.2.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.14.m2.1.1.1.1.3.3.3.2.1.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3">subscript</csymbol><ci id="alg1.14.m2.1.1.1.1.3.3.3.2.2.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.2.2">𝒫</ci><ci id="alg1.14.m2.1.1.1.1.3.3.3.2.3.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.2.3">ℱ</ci></apply><apply id="alg1.14.m2.1.1.1.1.3.3.3.3.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3"><minus id="alg1.14.m2.1.1.1.1.3.3.3.3.1.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3"></minus><apply id="alg1.14.m2.1.1.1.1.3.3.3.3.2.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2"><times id="alg1.14.m2.1.1.1.1.3.3.3.3.2.1.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.1"></times><ci id="alg1.14.m2.1.1.1.1.3.3.3.3.2.2.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.2">𝑙</ci><ci id="alg1.14.m2.1.1.1.1.3.3.3.3.2.3.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.3">𝑜</ci><ci id="alg1.14.m2.1.1.1.1.3.3.3.3.2.4.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.4">𝑐</ci><ci id="alg1.14.m2.1.1.1.1.3.3.3.3.2.5.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.5">𝑎</ci><ci id="alg1.14.m2.1.1.1.1.3.3.3.3.2.6.cmml" xref="alg1.14.m2.1.1.1.1.3.3.3.3.2.6">𝑙</ci></apply></apply></apply></list><list id="alg1.14.m2.1.1.1.1.5.1.cmml" xref="alg1.14.m2.1.1.1.1.5.2.1"></list></apply><list id="alg1.14.m2.2.2.2.2.3.cmml" xref="alg1.14.m2.2.2.2.2.2"><list id="alg1.14.m2.2.2.2.2.1.1.1.cmml" xref="alg1.14.m2.2.2.2.2.1.1.2.1"></list><list id="alg1.14.m2.2.2.2.2.2.2.1.cmml" xref="alg1.14.m2.2.2.2.2.2.2.2.1"></list></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.m2.2c">\mathcal{P_{I}}_{-local},\mathcal{P_{T}}_{-local},\mathcal{P_{F}}_{-local}\leftarrow[~{}],[~{}],[~{}]</annotation></semantics></math>;
<math id="alg1.15.m3.1" class="ltx_Math" alttext="S_{t}\leftarrow" display="inline"><semantics id="alg1.15.m3.1a"><mrow id="alg1.15.m3.1.1" xref="alg1.15.m3.1.1.cmml"><msub id="alg1.15.m3.1.1.2" xref="alg1.15.m3.1.1.2.cmml"><mi id="alg1.15.m3.1.1.2.2" xref="alg1.15.m3.1.1.2.2.cmml">S</mi><mi id="alg1.15.m3.1.1.2.3" xref="alg1.15.m3.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.15.m3.1.1.1" xref="alg1.15.m3.1.1.1.cmml">←</mo><mi id="alg1.15.m3.1.1.3" xref="alg1.15.m3.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.15.m3.1b"><apply id="alg1.15.m3.1.1.cmml" xref="alg1.15.m3.1.1"><ci id="alg1.15.m3.1.1.1.cmml" xref="alg1.15.m3.1.1.1">←</ci><apply id="alg1.15.m3.1.1.2.cmml" xref="alg1.15.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.15.m3.1.1.2.1.cmml" xref="alg1.15.m3.1.1.2">subscript</csymbol><ci id="alg1.15.m3.1.1.2.2.cmml" xref="alg1.15.m3.1.1.2.2">𝑆</ci><ci id="alg1.15.m3.1.1.2.3.cmml" xref="alg1.15.m3.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.15.m3.1.1.3.cmml" xref="alg1.15.m3.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.m3.1c">S_{t}\leftarrow</annotation></semantics></math> random set of <math id="alg1.16.m4.3" class="ltx_Math" alttext="\max(s\cdot C,1)" display="inline"><semantics id="alg1.16.m4.3a"><mrow id="alg1.16.m4.3.3.1" xref="alg1.16.m4.3.3.2.cmml"><mi id="alg1.16.m4.1.1" xref="alg1.16.m4.1.1.cmml">max</mi><mo id="alg1.16.m4.3.3.1a" xref="alg1.16.m4.3.3.2.cmml">⁡</mo><mrow id="alg1.16.m4.3.3.1.1" xref="alg1.16.m4.3.3.2.cmml"><mo stretchy="false" id="alg1.16.m4.3.3.1.1.2" xref="alg1.16.m4.3.3.2.cmml">(</mo><mrow id="alg1.16.m4.3.3.1.1.1" xref="alg1.16.m4.3.3.1.1.1.cmml"><mi id="alg1.16.m4.3.3.1.1.1.2" xref="alg1.16.m4.3.3.1.1.1.2.cmml">s</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.16.m4.3.3.1.1.1.1" xref="alg1.16.m4.3.3.1.1.1.1.cmml">⋅</mo><mi id="alg1.16.m4.3.3.1.1.1.3" xref="alg1.16.m4.3.3.1.1.1.3.cmml">C</mi></mrow><mo id="alg1.16.m4.3.3.1.1.3" xref="alg1.16.m4.3.3.2.cmml">,</mo><mn id="alg1.16.m4.2.2" xref="alg1.16.m4.2.2.cmml">1</mn><mo stretchy="false" id="alg1.16.m4.3.3.1.1.4" xref="alg1.16.m4.3.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.16.m4.3b"><apply id="alg1.16.m4.3.3.2.cmml" xref="alg1.16.m4.3.3.1"><max id="alg1.16.m4.1.1.cmml" xref="alg1.16.m4.1.1"></max><apply id="alg1.16.m4.3.3.1.1.1.cmml" xref="alg1.16.m4.3.3.1.1.1"><ci id="alg1.16.m4.3.3.1.1.1.1.cmml" xref="alg1.16.m4.3.3.1.1.1.1">⋅</ci><ci id="alg1.16.m4.3.3.1.1.1.2.cmml" xref="alg1.16.m4.3.3.1.1.1.2">𝑠</ci><ci id="alg1.16.m4.3.3.1.1.1.3.cmml" xref="alg1.16.m4.3.3.1.1.1.3">𝐶</ci></apply><cn type="integer" id="alg1.16.m4.2.2.cmml" xref="alg1.16.m4.2.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.m4.3c">\max(s\cdot C,1)</annotation></semantics></math> clients;
<span id="alg1.18.3" class="ltx_text ltx_font_bold">for</span> <em id="alg1.18.2" class="ltx_emph">each client <math id="alg1.17.1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.17.1.1.m1.1a"><mi id="alg1.17.1.1.m1.1.1" xref="alg1.17.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.17.1.1.m1.1b"><ci id="alg1.17.1.1.m1.1.1.cmml" xref="alg1.17.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.1.1.m1.1c">n</annotation></semantics></math> in <math id="alg1.18.2.2.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="alg1.18.2.2.m2.1a"><msub id="alg1.18.2.2.m2.1.1" xref="alg1.18.2.2.m2.1.1.cmml"><mi id="alg1.18.2.2.m2.1.1.2" xref="alg1.18.2.2.m2.1.1.2.cmml">S</mi><mi id="alg1.18.2.2.m2.1.1.3" xref="alg1.18.2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.18.2.2.m2.1b"><apply id="alg1.18.2.2.m2.1.1.cmml" xref="alg1.18.2.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.18.2.2.m2.1.1.1.cmml" xref="alg1.18.2.2.m2.1.1">subscript</csymbol><ci id="alg1.18.2.2.m2.1.1.2.cmml" xref="alg1.18.2.2.m2.1.1.2">𝑆</ci><ci id="alg1.18.2.2.m2.1.1.3.cmml" xref="alg1.18.2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.2.2.m2.1c">S_{t}</annotation></semantics></math></em> <span id="alg1.18.4" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg1.24" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
send the global model’s parameters
<math id="alg1.19.m1.1" class="ltx_Math" alttext="\omega^{t-1}" display="inline"><semantics id="alg1.19.m1.1a"><msup id="alg1.19.m1.1.1" xref="alg1.19.m1.1.1.cmml"><mi id="alg1.19.m1.1.1.2" xref="alg1.19.m1.1.1.2.cmml">ω</mi><mrow id="alg1.19.m1.1.1.3" xref="alg1.19.m1.1.1.3.cmml"><mi id="alg1.19.m1.1.1.3.2" xref="alg1.19.m1.1.1.3.2.cmml">t</mi><mo id="alg1.19.m1.1.1.3.1" xref="alg1.19.m1.1.1.3.1.cmml">−</mo><mn id="alg1.19.m1.1.1.3.3" xref="alg1.19.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.19.m1.1b"><apply id="alg1.19.m1.1.1.cmml" xref="alg1.19.m1.1.1"><csymbol cd="ambiguous" id="alg1.19.m1.1.1.1.cmml" xref="alg1.19.m1.1.1">superscript</csymbol><ci id="alg1.19.m1.1.1.2.cmml" xref="alg1.19.m1.1.1.2">𝜔</ci><apply id="alg1.19.m1.1.1.3.cmml" xref="alg1.19.m1.1.1.3"><minus id="alg1.19.m1.1.1.3.1.cmml" xref="alg1.19.m1.1.1.3.1"></minus><ci id="alg1.19.m1.1.1.3.2.cmml" xref="alg1.19.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.19.m1.1.1.3.3.cmml" xref="alg1.19.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.m1.1c">\omega^{t-1}</annotation></semantics></math> and global prototypes <math id="alg1.20.m2.3" class="ltx_Math" alttext="\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}}" display="inline"><semantics id="alg1.20.m2.3a"><mrow id="alg1.20.m2.3.3.3" xref="alg1.20.m2.3.3.4.cmml"><msub id="alg1.20.m2.1.1.1.1" xref="alg1.20.m2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.20.m2.1.1.1.1.2" xref="alg1.20.m2.1.1.1.1.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.20.m2.1.1.1.1.3" xref="alg1.20.m2.1.1.1.1.3.cmml">ℐ</mi></msub><mo id="alg1.20.m2.3.3.3.4" xref="alg1.20.m2.3.3.4.cmml">,</mo><msub id="alg1.20.m2.2.2.2.2" xref="alg1.20.m2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.20.m2.2.2.2.2.2" xref="alg1.20.m2.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.20.m2.2.2.2.2.3" xref="alg1.20.m2.2.2.2.2.3.cmml">𝒯</mi></msub><mo id="alg1.20.m2.3.3.3.5" xref="alg1.20.m2.3.3.4.cmml">,</mo><msub id="alg1.20.m2.3.3.3.3" xref="alg1.20.m2.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.20.m2.3.3.3.3.2" xref="alg1.20.m2.3.3.3.3.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.20.m2.3.3.3.3.3" xref="alg1.20.m2.3.3.3.3.3.cmml">ℱ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.m2.3b"><list id="alg1.20.m2.3.3.4.cmml" xref="alg1.20.m2.3.3.3"><apply id="alg1.20.m2.1.1.1.1.cmml" xref="alg1.20.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.20.m2.1.1.1.1.1.cmml" xref="alg1.20.m2.1.1.1.1">subscript</csymbol><ci id="alg1.20.m2.1.1.1.1.2.cmml" xref="alg1.20.m2.1.1.1.1.2">𝒫</ci><ci id="alg1.20.m2.1.1.1.1.3.cmml" xref="alg1.20.m2.1.1.1.1.3">ℐ</ci></apply><apply id="alg1.20.m2.2.2.2.2.cmml" xref="alg1.20.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.20.m2.2.2.2.2.1.cmml" xref="alg1.20.m2.2.2.2.2">subscript</csymbol><ci id="alg1.20.m2.2.2.2.2.2.cmml" xref="alg1.20.m2.2.2.2.2.2">𝒫</ci><ci id="alg1.20.m2.2.2.2.2.3.cmml" xref="alg1.20.m2.2.2.2.2.3">𝒯</ci></apply><apply id="alg1.20.m2.3.3.3.3.cmml" xref="alg1.20.m2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.20.m2.3.3.3.3.1.cmml" xref="alg1.20.m2.3.3.3.3">subscript</csymbol><ci id="alg1.20.m2.3.3.3.3.2.cmml" xref="alg1.20.m2.3.3.3.3.2">𝒫</ci><ci id="alg1.20.m2.3.3.3.3.3.cmml" xref="alg1.20.m2.3.3.3.3.3">ℱ</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.m2.3c">\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}}</annotation></semantics></math> to client <math id="alg1.21.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.21.m3.1a"><mi id="alg1.21.m3.1.1" xref="alg1.21.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.21.m3.1b"><ci id="alg1.21.m3.1.1.cmml" xref="alg1.21.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.m3.1c">n</annotation></semantics></math>;
<math id="alg1.22.m4.4" class="ltx_Math" alttext="\omega^{t}_{n},\mathcal{P_{I}}_{n},\mathcal{P_{T}}_{n},\mathcal{P_{F}}_{n}\leftarrow" display="inline"><semantics id="alg1.22.m4.4a"><mrow id="alg1.22.m4.4.4" xref="alg1.22.m4.4.4.cmml"><mrow id="alg1.22.m4.4.4.4.4" xref="alg1.22.m4.4.4.4.5.cmml"><msubsup id="alg1.22.m4.1.1.1.1.1" xref="alg1.22.m4.1.1.1.1.1.cmml"><mi id="alg1.22.m4.1.1.1.1.1.2.2" xref="alg1.22.m4.1.1.1.1.1.2.2.cmml">ω</mi><mi id="alg1.22.m4.1.1.1.1.1.3" xref="alg1.22.m4.1.1.1.1.1.3.cmml">n</mi><mi id="alg1.22.m4.1.1.1.1.1.2.3" xref="alg1.22.m4.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.22.m4.4.4.4.4.5" xref="alg1.22.m4.4.4.4.5.cmml">,</mo><mmultiscripts id="alg1.22.m4.2.2.2.2.2" xref="alg1.22.m4.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.22.m4.2.2.2.2.2.2.2" xref="alg1.22.m4.2.2.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.22.m4.2.2.2.2.2.2.3" xref="alg1.22.m4.2.2.2.2.2.2.3.cmml">ℐ</mi><mrow id="alg1.22.m4.2.2.2.2.2a" xref="alg1.22.m4.2.2.2.2.2.cmml"></mrow><mi id="alg1.22.m4.2.2.2.2.2.3" xref="alg1.22.m4.2.2.2.2.2.3.cmml">n</mi><mrow id="alg1.22.m4.2.2.2.2.2b" xref="alg1.22.m4.2.2.2.2.2.cmml"></mrow></mmultiscripts><mo id="alg1.22.m4.4.4.4.4.6" xref="alg1.22.m4.4.4.4.5.cmml">,</mo><mmultiscripts id="alg1.22.m4.3.3.3.3.3" xref="alg1.22.m4.3.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.22.m4.3.3.3.3.3.2.2" xref="alg1.22.m4.3.3.3.3.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.22.m4.3.3.3.3.3.2.3" xref="alg1.22.m4.3.3.3.3.3.2.3.cmml">𝒯</mi><mrow id="alg1.22.m4.3.3.3.3.3a" xref="alg1.22.m4.3.3.3.3.3.cmml"></mrow><mi id="alg1.22.m4.3.3.3.3.3.3" xref="alg1.22.m4.3.3.3.3.3.3.cmml">n</mi><mrow id="alg1.22.m4.3.3.3.3.3b" xref="alg1.22.m4.3.3.3.3.3.cmml"></mrow></mmultiscripts><mo id="alg1.22.m4.4.4.4.4.7" xref="alg1.22.m4.4.4.4.5.cmml">,</mo><mmultiscripts id="alg1.22.m4.4.4.4.4.4" xref="alg1.22.m4.4.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.22.m4.4.4.4.4.4.2.2" xref="alg1.22.m4.4.4.4.4.4.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.22.m4.4.4.4.4.4.2.3" xref="alg1.22.m4.4.4.4.4.4.2.3.cmml">ℱ</mi><mrow id="alg1.22.m4.4.4.4.4.4a" xref="alg1.22.m4.4.4.4.4.4.cmml"></mrow><mi id="alg1.22.m4.4.4.4.4.4.3" xref="alg1.22.m4.4.4.4.4.4.3.cmml">n</mi><mrow id="alg1.22.m4.4.4.4.4.4b" xref="alg1.22.m4.4.4.4.4.4.cmml"></mrow></mmultiscripts></mrow><mo stretchy="false" id="alg1.22.m4.4.4.5" xref="alg1.22.m4.4.4.5.cmml">←</mo><mi id="alg1.22.m4.4.4.6" xref="alg1.22.m4.4.4.6.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.m4.4b"><apply id="alg1.22.m4.4.4.cmml" xref="alg1.22.m4.4.4"><ci id="alg1.22.m4.4.4.5.cmml" xref="alg1.22.m4.4.4.5">←</ci><list id="alg1.22.m4.4.4.4.5.cmml" xref="alg1.22.m4.4.4.4.4"><apply id="alg1.22.m4.1.1.1.1.1.cmml" xref="alg1.22.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.m4.1.1.1.1.1.1.cmml" xref="alg1.22.m4.1.1.1.1.1">subscript</csymbol><apply id="alg1.22.m4.1.1.1.1.1.2.cmml" xref="alg1.22.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.m4.1.1.1.1.1.2.1.cmml" xref="alg1.22.m4.1.1.1.1.1">superscript</csymbol><ci id="alg1.22.m4.1.1.1.1.1.2.2.cmml" xref="alg1.22.m4.1.1.1.1.1.2.2">𝜔</ci><ci id="alg1.22.m4.1.1.1.1.1.2.3.cmml" xref="alg1.22.m4.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.22.m4.1.1.1.1.1.3.cmml" xref="alg1.22.m4.1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.22.m4.2.2.2.2.2.cmml" xref="alg1.22.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.22.m4.2.2.2.2.2.1.cmml" xref="alg1.22.m4.2.2.2.2.2">subscript</csymbol><apply id="alg1.22.m4.2.2.2.2.2.2.cmml" xref="alg1.22.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.22.m4.2.2.2.2.2.2.1.cmml" xref="alg1.22.m4.2.2.2.2.2">subscript</csymbol><ci id="alg1.22.m4.2.2.2.2.2.2.2.cmml" xref="alg1.22.m4.2.2.2.2.2.2.2">𝒫</ci><ci id="alg1.22.m4.2.2.2.2.2.2.3.cmml" xref="alg1.22.m4.2.2.2.2.2.2.3">ℐ</ci></apply><ci id="alg1.22.m4.2.2.2.2.2.3.cmml" xref="alg1.22.m4.2.2.2.2.2.3">𝑛</ci></apply><apply id="alg1.22.m4.3.3.3.3.3.cmml" xref="alg1.22.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.22.m4.3.3.3.3.3.1.cmml" xref="alg1.22.m4.3.3.3.3.3">subscript</csymbol><apply id="alg1.22.m4.3.3.3.3.3.2.cmml" xref="alg1.22.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.22.m4.3.3.3.3.3.2.1.cmml" xref="alg1.22.m4.3.3.3.3.3">subscript</csymbol><ci id="alg1.22.m4.3.3.3.3.3.2.2.cmml" xref="alg1.22.m4.3.3.3.3.3.2.2">𝒫</ci><ci id="alg1.22.m4.3.3.3.3.3.2.3.cmml" xref="alg1.22.m4.3.3.3.3.3.2.3">𝒯</ci></apply><ci id="alg1.22.m4.3.3.3.3.3.3.cmml" xref="alg1.22.m4.3.3.3.3.3.3">𝑛</ci></apply><apply id="alg1.22.m4.4.4.4.4.4.cmml" xref="alg1.22.m4.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.22.m4.4.4.4.4.4.1.cmml" xref="alg1.22.m4.4.4.4.4.4">subscript</csymbol><apply id="alg1.22.m4.4.4.4.4.4.2.cmml" xref="alg1.22.m4.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.22.m4.4.4.4.4.4.2.1.cmml" xref="alg1.22.m4.4.4.4.4.4">subscript</csymbol><ci id="alg1.22.m4.4.4.4.4.4.2.2.cmml" xref="alg1.22.m4.4.4.4.4.4.2.2">𝒫</ci><ci id="alg1.22.m4.4.4.4.4.4.2.3.cmml" xref="alg1.22.m4.4.4.4.4.4.2.3">ℱ</ci></apply><ci id="alg1.22.m4.4.4.4.4.4.3.cmml" xref="alg1.22.m4.4.4.4.4.4.3">𝑛</ci></apply></list><csymbol cd="latexml" id="alg1.22.m4.4.4.6.cmml" xref="alg1.22.m4.4.4.6">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.m4.4c">\omega^{t}_{n},\mathcal{P_{I}}_{n},\mathcal{P_{T}}_{n},\mathcal{P_{F}}_{n}\leftarrow</annotation></semantics></math>
<span id="alg1.24.1" class="ltx_text ltx_font_bold">ClientLocalTraining</span>
<math id="alg1.23.m5.6" class="ltx_Math" alttext="(n,t,\omega^{t-1},\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}})" display="inline"><semantics id="alg1.23.m5.6a"><mrow id="alg1.23.m5.6.6.4" xref="alg1.23.m5.6.6.5.cmml"><mo stretchy="false" id="alg1.23.m5.6.6.4.5" xref="alg1.23.m5.6.6.5.cmml">(</mo><mi id="alg1.23.m5.1.1" xref="alg1.23.m5.1.1.cmml">n</mi><mo id="alg1.23.m5.6.6.4.6" xref="alg1.23.m5.6.6.5.cmml">,</mo><mi id="alg1.23.m5.2.2" xref="alg1.23.m5.2.2.cmml">t</mi><mo id="alg1.23.m5.6.6.4.7" xref="alg1.23.m5.6.6.5.cmml">,</mo><msup id="alg1.23.m5.3.3.1.1" xref="alg1.23.m5.3.3.1.1.cmml"><mi id="alg1.23.m5.3.3.1.1.2" xref="alg1.23.m5.3.3.1.1.2.cmml">ω</mi><mrow id="alg1.23.m5.3.3.1.1.3" xref="alg1.23.m5.3.3.1.1.3.cmml"><mi id="alg1.23.m5.3.3.1.1.3.2" xref="alg1.23.m5.3.3.1.1.3.2.cmml">t</mi><mo id="alg1.23.m5.3.3.1.1.3.1" xref="alg1.23.m5.3.3.1.1.3.1.cmml">−</mo><mn id="alg1.23.m5.3.3.1.1.3.3" xref="alg1.23.m5.3.3.1.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.23.m5.6.6.4.8" xref="alg1.23.m5.6.6.5.cmml">,</mo><msub id="alg1.23.m5.4.4.2.2" xref="alg1.23.m5.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.23.m5.4.4.2.2.2" xref="alg1.23.m5.4.4.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.23.m5.4.4.2.2.3" xref="alg1.23.m5.4.4.2.2.3.cmml">ℐ</mi></msub><mo id="alg1.23.m5.6.6.4.9" xref="alg1.23.m5.6.6.5.cmml">,</mo><msub id="alg1.23.m5.5.5.3.3" xref="alg1.23.m5.5.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.23.m5.5.5.3.3.2" xref="alg1.23.m5.5.5.3.3.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.23.m5.5.5.3.3.3" xref="alg1.23.m5.5.5.3.3.3.cmml">𝒯</mi></msub><mo id="alg1.23.m5.6.6.4.10" xref="alg1.23.m5.6.6.5.cmml">,</mo><msub id="alg1.23.m5.6.6.4.4" xref="alg1.23.m5.6.6.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.23.m5.6.6.4.4.2" xref="alg1.23.m5.6.6.4.4.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.23.m5.6.6.4.4.3" xref="alg1.23.m5.6.6.4.4.3.cmml">ℱ</mi></msub><mo stretchy="false" id="alg1.23.m5.6.6.4.11" xref="alg1.23.m5.6.6.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.23.m5.6b"><vector id="alg1.23.m5.6.6.5.cmml" xref="alg1.23.m5.6.6.4"><ci id="alg1.23.m5.1.1.cmml" xref="alg1.23.m5.1.1">𝑛</ci><ci id="alg1.23.m5.2.2.cmml" xref="alg1.23.m5.2.2">𝑡</ci><apply id="alg1.23.m5.3.3.1.1.cmml" xref="alg1.23.m5.3.3.1.1"><csymbol cd="ambiguous" id="alg1.23.m5.3.3.1.1.1.cmml" xref="alg1.23.m5.3.3.1.1">superscript</csymbol><ci id="alg1.23.m5.3.3.1.1.2.cmml" xref="alg1.23.m5.3.3.1.1.2">𝜔</ci><apply id="alg1.23.m5.3.3.1.1.3.cmml" xref="alg1.23.m5.3.3.1.1.3"><minus id="alg1.23.m5.3.3.1.1.3.1.cmml" xref="alg1.23.m5.3.3.1.1.3.1"></minus><ci id="alg1.23.m5.3.3.1.1.3.2.cmml" xref="alg1.23.m5.3.3.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.23.m5.3.3.1.1.3.3.cmml" xref="alg1.23.m5.3.3.1.1.3.3">1</cn></apply></apply><apply id="alg1.23.m5.4.4.2.2.cmml" xref="alg1.23.m5.4.4.2.2"><csymbol cd="ambiguous" id="alg1.23.m5.4.4.2.2.1.cmml" xref="alg1.23.m5.4.4.2.2">subscript</csymbol><ci id="alg1.23.m5.4.4.2.2.2.cmml" xref="alg1.23.m5.4.4.2.2.2">𝒫</ci><ci id="alg1.23.m5.4.4.2.2.3.cmml" xref="alg1.23.m5.4.4.2.2.3">ℐ</ci></apply><apply id="alg1.23.m5.5.5.3.3.cmml" xref="alg1.23.m5.5.5.3.3"><csymbol cd="ambiguous" id="alg1.23.m5.5.5.3.3.1.cmml" xref="alg1.23.m5.5.5.3.3">subscript</csymbol><ci id="alg1.23.m5.5.5.3.3.2.cmml" xref="alg1.23.m5.5.5.3.3.2">𝒫</ci><ci id="alg1.23.m5.5.5.3.3.3.cmml" xref="alg1.23.m5.5.5.3.3.3">𝒯</ci></apply><apply id="alg1.23.m5.6.6.4.4.cmml" xref="alg1.23.m5.6.6.4.4"><csymbol cd="ambiguous" id="alg1.23.m5.6.6.4.4.1.cmml" xref="alg1.23.m5.6.6.4.4">subscript</csymbol><ci id="alg1.23.m5.6.6.4.4.2.cmml" xref="alg1.23.m5.6.6.4.4.2">𝒫</ci><ci id="alg1.23.m5.6.6.4.4.3.cmml" xref="alg1.23.m5.6.6.4.4.3">ℱ</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.m5.6c">(n,t,\omega^{t-1},\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}})</annotation></semantics></math>;
<math id="alg1.24.m6.2" class="ltx_Math" alttext="\mathcal{P_{I}}_{-local},\mathcal{P_{T}}_{-local},\mathcal{P_{F}}_{-local}\leftarrow\mathcal{P_{I}}_{-local}+\mathcal{P_{I}}_{n},\mathcal{P_{T}}_{-local}+\mathcal{P_{T}}_{n},\mathcal{P_{F}}_{-local}+\mathcal{P_{F}}_{n}" display="inline"><semantics id="alg1.24.m6.2a"><mrow id="alg1.24.m6.2.2.2" xref="alg1.24.m6.2.2.3.cmml"><mrow id="alg1.24.m6.1.1.1.1" xref="alg1.24.m6.1.1.1.1.cmml"><mrow id="alg1.24.m6.1.1.1.1.3.3" xref="alg1.24.m6.1.1.1.1.3.4.cmml"><mmultiscripts id="alg1.24.m6.1.1.1.1.1.1.1" xref="alg1.24.m6.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.1.1.1.2.2" xref="alg1.24.m6.1.1.1.1.1.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.1.1.1.2.3" xref="alg1.24.m6.1.1.1.1.1.1.1.2.3.cmml">ℐ</mi><mrow id="alg1.24.m6.1.1.1.1.1.1.1a" xref="alg1.24.m6.1.1.1.1.1.1.1.cmml"></mrow><mrow id="alg1.24.m6.1.1.1.1.1.1.1.3" xref="alg1.24.m6.1.1.1.1.1.1.1.3.cmml"><mo id="alg1.24.m6.1.1.1.1.1.1.1.3a" xref="alg1.24.m6.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="alg1.24.m6.1.1.1.1.1.1.1.3.2" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.24.m6.1.1.1.1.1.1.1.3.2.2" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.1.1.1.3.2.1" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.1.1.1.3.2.3" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.1.1.1.3.2.1a" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.1.1.1.3.2.4" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.1.1.1.3.2.1b" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.1.1.1.3.2.5" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.1.1.1.3.2.1c" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.1.1.1.3.2.6" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.24.m6.1.1.1.1.1.1.1b" xref="alg1.24.m6.1.1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="alg1.24.m6.1.1.1.1.3.3.4" xref="alg1.24.m6.1.1.1.1.3.4.cmml">,</mo><mmultiscripts id="alg1.24.m6.1.1.1.1.2.2.2" xref="alg1.24.m6.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.2.2.2.2.2" xref="alg1.24.m6.1.1.1.1.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.2.2.2.2.3" xref="alg1.24.m6.1.1.1.1.2.2.2.2.3.cmml">𝒯</mi><mrow id="alg1.24.m6.1.1.1.1.2.2.2a" xref="alg1.24.m6.1.1.1.1.2.2.2.cmml"></mrow><mrow id="alg1.24.m6.1.1.1.1.2.2.2.3" xref="alg1.24.m6.1.1.1.1.2.2.2.3.cmml"><mo id="alg1.24.m6.1.1.1.1.2.2.2.3a" xref="alg1.24.m6.1.1.1.1.2.2.2.3.cmml">−</mo><mrow id="alg1.24.m6.1.1.1.1.2.2.2.3.2" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.cmml"><mi id="alg1.24.m6.1.1.1.1.2.2.2.3.2.2" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.2.2.2.3.2.1" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.2.2.2.3.2.3" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.2.2.2.3.2.1a" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.2.2.2.3.2.4" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.2.2.2.3.2.1b" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.2.2.2.3.2.5" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.2.2.2.3.2.1c" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.2.2.2.3.2.6" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.24.m6.1.1.1.1.2.2.2b" xref="alg1.24.m6.1.1.1.1.2.2.2.cmml"></mrow></mmultiscripts><mo id="alg1.24.m6.1.1.1.1.3.3.5" xref="alg1.24.m6.1.1.1.1.3.4.cmml">,</mo><mmultiscripts id="alg1.24.m6.1.1.1.1.3.3.3" xref="alg1.24.m6.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.3.3.3.2.2" xref="alg1.24.m6.1.1.1.1.3.3.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.3.3.3.2.3" xref="alg1.24.m6.1.1.1.1.3.3.3.2.3.cmml">ℱ</mi><mrow id="alg1.24.m6.1.1.1.1.3.3.3a" xref="alg1.24.m6.1.1.1.1.3.3.3.cmml"></mrow><mrow id="alg1.24.m6.1.1.1.1.3.3.3.3" xref="alg1.24.m6.1.1.1.1.3.3.3.3.cmml"><mo id="alg1.24.m6.1.1.1.1.3.3.3.3a" xref="alg1.24.m6.1.1.1.1.3.3.3.3.cmml">−</mo><mrow id="alg1.24.m6.1.1.1.1.3.3.3.3.2" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.cmml"><mi id="alg1.24.m6.1.1.1.1.3.3.3.3.2.2" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.3.3.3.3.2.1" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.3.3.3.3.2.3" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.3.3.3.3.2.1a" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.3.3.3.3.2.4" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.3.3.3.3.2.1b" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.3.3.3.3.2.5" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.3.3.3.3.2.1c" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.3.3.3.3.2.6" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.24.m6.1.1.1.1.3.3.3b" xref="alg1.24.m6.1.1.1.1.3.3.3.cmml"></mrow></mmultiscripts></mrow><mo stretchy="false" id="alg1.24.m6.1.1.1.1.4" xref="alg1.24.m6.1.1.1.1.4.cmml">←</mo><mrow id="alg1.24.m6.1.1.1.1.5" xref="alg1.24.m6.1.1.1.1.5.cmml"><mmultiscripts id="alg1.24.m6.1.1.1.1.5.2" xref="alg1.24.m6.1.1.1.1.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.5.2.2.2" xref="alg1.24.m6.1.1.1.1.5.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.5.2.2.3" xref="alg1.24.m6.1.1.1.1.5.2.2.3.cmml">ℐ</mi><mrow id="alg1.24.m6.1.1.1.1.5.2a" xref="alg1.24.m6.1.1.1.1.5.2.cmml"></mrow><mrow id="alg1.24.m6.1.1.1.1.5.2.3" xref="alg1.24.m6.1.1.1.1.5.2.3.cmml"><mo id="alg1.24.m6.1.1.1.1.5.2.3a" xref="alg1.24.m6.1.1.1.1.5.2.3.cmml">−</mo><mrow id="alg1.24.m6.1.1.1.1.5.2.3.2" xref="alg1.24.m6.1.1.1.1.5.2.3.2.cmml"><mi id="alg1.24.m6.1.1.1.1.5.2.3.2.2" xref="alg1.24.m6.1.1.1.1.5.2.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.5.2.3.2.1" xref="alg1.24.m6.1.1.1.1.5.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.5.2.3.2.3" xref="alg1.24.m6.1.1.1.1.5.2.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.5.2.3.2.1a" xref="alg1.24.m6.1.1.1.1.5.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.5.2.3.2.4" xref="alg1.24.m6.1.1.1.1.5.2.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.5.2.3.2.1b" xref="alg1.24.m6.1.1.1.1.5.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.5.2.3.2.5" xref="alg1.24.m6.1.1.1.1.5.2.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.1.1.1.1.5.2.3.2.1c" xref="alg1.24.m6.1.1.1.1.5.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.1.1.1.1.5.2.3.2.6" xref="alg1.24.m6.1.1.1.1.5.2.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.24.m6.1.1.1.1.5.2b" xref="alg1.24.m6.1.1.1.1.5.2.cmml"></mrow></mmultiscripts><mo id="alg1.24.m6.1.1.1.1.5.1" xref="alg1.24.m6.1.1.1.1.5.1.cmml">+</mo><mmultiscripts id="alg1.24.m6.1.1.1.1.5.3" xref="alg1.24.m6.1.1.1.1.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.5.3.2.2" xref="alg1.24.m6.1.1.1.1.5.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.1.1.1.1.5.3.2.3" xref="alg1.24.m6.1.1.1.1.5.3.2.3.cmml">ℐ</mi><mrow id="alg1.24.m6.1.1.1.1.5.3a" xref="alg1.24.m6.1.1.1.1.5.3.cmml"></mrow><mi id="alg1.24.m6.1.1.1.1.5.3.3" xref="alg1.24.m6.1.1.1.1.5.3.3.cmml">n</mi><mrow id="alg1.24.m6.1.1.1.1.5.3b" xref="alg1.24.m6.1.1.1.1.5.3.cmml"></mrow></mmultiscripts></mrow></mrow><mo id="alg1.24.m6.2.2.2.3" xref="alg1.24.m6.2.2.3a.cmml">,</mo><mrow id="alg1.24.m6.2.2.2.2.2" xref="alg1.24.m6.2.2.2.2.3.cmml"><mrow id="alg1.24.m6.2.2.2.2.1.1" xref="alg1.24.m6.2.2.2.2.1.1.cmml"><mmultiscripts id="alg1.24.m6.2.2.2.2.1.1.2" xref="alg1.24.m6.2.2.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.2.2.2.2.1.1.2.2.2" xref="alg1.24.m6.2.2.2.2.1.1.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.2.2.2.2.1.1.2.2.3" xref="alg1.24.m6.2.2.2.2.1.1.2.2.3.cmml">𝒯</mi><mrow id="alg1.24.m6.2.2.2.2.1.1.2a" xref="alg1.24.m6.2.2.2.2.1.1.2.cmml"></mrow><mrow id="alg1.24.m6.2.2.2.2.1.1.2.3" xref="alg1.24.m6.2.2.2.2.1.1.2.3.cmml"><mo id="alg1.24.m6.2.2.2.2.1.1.2.3a" xref="alg1.24.m6.2.2.2.2.1.1.2.3.cmml">−</mo><mrow id="alg1.24.m6.2.2.2.2.1.1.2.3.2" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.cmml"><mi id="alg1.24.m6.2.2.2.2.1.1.2.3.2.2" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.2.2.2.2.1.1.2.3.2.1" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.2.2.2.2.1.1.2.3.2.3" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.2.2.2.2.1.1.2.3.2.1a" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.2.2.2.2.1.1.2.3.2.4" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.2.2.2.2.1.1.2.3.2.1b" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.2.2.2.2.1.1.2.3.2.5" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.2.2.2.2.1.1.2.3.2.1c" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.2.2.2.2.1.1.2.3.2.6" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.24.m6.2.2.2.2.1.1.2b" xref="alg1.24.m6.2.2.2.2.1.1.2.cmml"></mrow></mmultiscripts><mo id="alg1.24.m6.2.2.2.2.1.1.1" xref="alg1.24.m6.2.2.2.2.1.1.1.cmml">+</mo><mmultiscripts id="alg1.24.m6.2.2.2.2.1.1.3" xref="alg1.24.m6.2.2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.2.2.2.2.1.1.3.2.2" xref="alg1.24.m6.2.2.2.2.1.1.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.2.2.2.2.1.1.3.2.3" xref="alg1.24.m6.2.2.2.2.1.1.3.2.3.cmml">𝒯</mi><mrow id="alg1.24.m6.2.2.2.2.1.1.3a" xref="alg1.24.m6.2.2.2.2.1.1.3.cmml"></mrow><mi id="alg1.24.m6.2.2.2.2.1.1.3.3" xref="alg1.24.m6.2.2.2.2.1.1.3.3.cmml">n</mi><mrow id="alg1.24.m6.2.2.2.2.1.1.3b" xref="alg1.24.m6.2.2.2.2.1.1.3.cmml"></mrow></mmultiscripts></mrow><mo id="alg1.24.m6.2.2.2.2.2.3" xref="alg1.24.m6.2.2.2.2.3.cmml">,</mo><mrow id="alg1.24.m6.2.2.2.2.2.2" xref="alg1.24.m6.2.2.2.2.2.2.cmml"><mmultiscripts id="alg1.24.m6.2.2.2.2.2.2.2" xref="alg1.24.m6.2.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.2.2.2.2.2.2.2.2.2" xref="alg1.24.m6.2.2.2.2.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.2.2.2.2.2.2.2.2.3" xref="alg1.24.m6.2.2.2.2.2.2.2.2.3.cmml">ℱ</mi><mrow id="alg1.24.m6.2.2.2.2.2.2.2a" xref="alg1.24.m6.2.2.2.2.2.2.2.cmml"></mrow><mrow id="alg1.24.m6.2.2.2.2.2.2.2.3" xref="alg1.24.m6.2.2.2.2.2.2.2.3.cmml"><mo id="alg1.24.m6.2.2.2.2.2.2.2.3a" xref="alg1.24.m6.2.2.2.2.2.2.2.3.cmml">−</mo><mrow id="alg1.24.m6.2.2.2.2.2.2.2.3.2" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.cmml"><mi id="alg1.24.m6.2.2.2.2.2.2.2.3.2.2" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.2.2.2.2.2.2.2.3.2.1" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.2.2.2.2.2.2.2.3.2.3" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.2.2.2.2.2.2.2.3.2.1a" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.2.2.2.2.2.2.2.3.2.4" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.2.2.2.2.2.2.2.3.2.1b" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.2.2.2.2.2.2.2.3.2.5" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.24.m6.2.2.2.2.2.2.2.3.2.1c" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg1.24.m6.2.2.2.2.2.2.2.3.2.6" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.6.cmml">l</mi></mrow></mrow><mrow id="alg1.24.m6.2.2.2.2.2.2.2b" xref="alg1.24.m6.2.2.2.2.2.2.2.cmml"></mrow></mmultiscripts><mo id="alg1.24.m6.2.2.2.2.2.2.1" xref="alg1.24.m6.2.2.2.2.2.2.1.cmml">+</mo><mmultiscripts id="alg1.24.m6.2.2.2.2.2.2.3" xref="alg1.24.m6.2.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.2.2.2.2.2.2.3.2.2" xref="alg1.24.m6.2.2.2.2.2.2.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.24.m6.2.2.2.2.2.2.3.2.3" xref="alg1.24.m6.2.2.2.2.2.2.3.2.3.cmml">ℱ</mi><mrow id="alg1.24.m6.2.2.2.2.2.2.3a" xref="alg1.24.m6.2.2.2.2.2.2.3.cmml"></mrow><mi id="alg1.24.m6.2.2.2.2.2.2.3.3" xref="alg1.24.m6.2.2.2.2.2.2.3.3.cmml">n</mi><mrow id="alg1.24.m6.2.2.2.2.2.2.3b" xref="alg1.24.m6.2.2.2.2.2.2.3.cmml"></mrow></mmultiscripts></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.24.m6.2b"><apply id="alg1.24.m6.2.2.3.cmml" xref="alg1.24.m6.2.2.2"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.3a.cmml" xref="alg1.24.m6.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.24.m6.1.1.1.1.cmml" xref="alg1.24.m6.1.1.1.1"><ci id="alg1.24.m6.1.1.1.1.4.cmml" xref="alg1.24.m6.1.1.1.1.4">←</ci><list id="alg1.24.m6.1.1.1.1.3.4.cmml" xref="alg1.24.m6.1.1.1.1.3.3"><apply id="alg1.24.m6.1.1.1.1.1.1.1.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.1.1.1.1.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.24.m6.1.1.1.1.1.1.1.2.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.24.m6.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.2.2">𝒫</ci><ci id="alg1.24.m6.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.2.3">ℐ</ci></apply><apply id="alg1.24.m6.1.1.1.1.1.1.1.3.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3"><minus id="alg1.24.m6.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3"></minus><apply id="alg1.24.m6.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2"><times id="alg1.24.m6.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.1"></times><ci id="alg1.24.m6.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.2">𝑙</ci><ci id="alg1.24.m6.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.3">𝑜</ci><ci id="alg1.24.m6.1.1.1.1.1.1.1.3.2.4.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.4">𝑐</ci><ci id="alg1.24.m6.1.1.1.1.1.1.1.3.2.5.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.5">𝑎</ci><ci id="alg1.24.m6.1.1.1.1.1.1.1.3.2.6.cmml" xref="alg1.24.m6.1.1.1.1.1.1.1.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.24.m6.1.1.1.1.2.2.2.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.2.2.2.1.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2">subscript</csymbol><apply id="alg1.24.m6.1.1.1.1.2.2.2.2.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.24.m6.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.2.2">𝒫</ci><ci id="alg1.24.m6.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.2.3">𝒯</ci></apply><apply id="alg1.24.m6.1.1.1.1.2.2.2.3.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3"><minus id="alg1.24.m6.1.1.1.1.2.2.2.3.1.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3"></minus><apply id="alg1.24.m6.1.1.1.1.2.2.2.3.2.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2"><times id="alg1.24.m6.1.1.1.1.2.2.2.3.2.1.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.1"></times><ci id="alg1.24.m6.1.1.1.1.2.2.2.3.2.2.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.2">𝑙</ci><ci id="alg1.24.m6.1.1.1.1.2.2.2.3.2.3.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.3">𝑜</ci><ci id="alg1.24.m6.1.1.1.1.2.2.2.3.2.4.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.4">𝑐</ci><ci id="alg1.24.m6.1.1.1.1.2.2.2.3.2.5.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.5">𝑎</ci><ci id="alg1.24.m6.1.1.1.1.2.2.2.3.2.6.cmml" xref="alg1.24.m6.1.1.1.1.2.2.2.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.24.m6.1.1.1.1.3.3.3.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.3.3.3.1.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3">subscript</csymbol><apply id="alg1.24.m6.1.1.1.1.3.3.3.2.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.3.3.3.2.1.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3">subscript</csymbol><ci id="alg1.24.m6.1.1.1.1.3.3.3.2.2.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.2.2">𝒫</ci><ci id="alg1.24.m6.1.1.1.1.3.3.3.2.3.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.2.3">ℱ</ci></apply><apply id="alg1.24.m6.1.1.1.1.3.3.3.3.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3"><minus id="alg1.24.m6.1.1.1.1.3.3.3.3.1.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3"></minus><apply id="alg1.24.m6.1.1.1.1.3.3.3.3.2.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2"><times id="alg1.24.m6.1.1.1.1.3.3.3.3.2.1.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.1"></times><ci id="alg1.24.m6.1.1.1.1.3.3.3.3.2.2.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.2">𝑙</ci><ci id="alg1.24.m6.1.1.1.1.3.3.3.3.2.3.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.3">𝑜</ci><ci id="alg1.24.m6.1.1.1.1.3.3.3.3.2.4.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.4">𝑐</ci><ci id="alg1.24.m6.1.1.1.1.3.3.3.3.2.5.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.5">𝑎</ci><ci id="alg1.24.m6.1.1.1.1.3.3.3.3.2.6.cmml" xref="alg1.24.m6.1.1.1.1.3.3.3.3.2.6">𝑙</ci></apply></apply></apply></list><apply id="alg1.24.m6.1.1.1.1.5.cmml" xref="alg1.24.m6.1.1.1.1.5"><plus id="alg1.24.m6.1.1.1.1.5.1.cmml" xref="alg1.24.m6.1.1.1.1.5.1"></plus><apply id="alg1.24.m6.1.1.1.1.5.2.cmml" xref="alg1.24.m6.1.1.1.1.5.2"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.5.2.1.cmml" xref="alg1.24.m6.1.1.1.1.5.2">subscript</csymbol><apply id="alg1.24.m6.1.1.1.1.5.2.2.cmml" xref="alg1.24.m6.1.1.1.1.5.2"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.5.2.2.1.cmml" xref="alg1.24.m6.1.1.1.1.5.2">subscript</csymbol><ci id="alg1.24.m6.1.1.1.1.5.2.2.2.cmml" xref="alg1.24.m6.1.1.1.1.5.2.2.2">𝒫</ci><ci id="alg1.24.m6.1.1.1.1.5.2.2.3.cmml" xref="alg1.24.m6.1.1.1.1.5.2.2.3">ℐ</ci></apply><apply id="alg1.24.m6.1.1.1.1.5.2.3.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3"><minus id="alg1.24.m6.1.1.1.1.5.2.3.1.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3"></minus><apply id="alg1.24.m6.1.1.1.1.5.2.3.2.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3.2"><times id="alg1.24.m6.1.1.1.1.5.2.3.2.1.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3.2.1"></times><ci id="alg1.24.m6.1.1.1.1.5.2.3.2.2.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3.2.2">𝑙</ci><ci id="alg1.24.m6.1.1.1.1.5.2.3.2.3.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3.2.3">𝑜</ci><ci id="alg1.24.m6.1.1.1.1.5.2.3.2.4.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3.2.4">𝑐</ci><ci id="alg1.24.m6.1.1.1.1.5.2.3.2.5.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3.2.5">𝑎</ci><ci id="alg1.24.m6.1.1.1.1.5.2.3.2.6.cmml" xref="alg1.24.m6.1.1.1.1.5.2.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.24.m6.1.1.1.1.5.3.cmml" xref="alg1.24.m6.1.1.1.1.5.3"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.5.3.1.cmml" xref="alg1.24.m6.1.1.1.1.5.3">subscript</csymbol><apply id="alg1.24.m6.1.1.1.1.5.3.2.cmml" xref="alg1.24.m6.1.1.1.1.5.3"><csymbol cd="ambiguous" id="alg1.24.m6.1.1.1.1.5.3.2.1.cmml" xref="alg1.24.m6.1.1.1.1.5.3">subscript</csymbol><ci id="alg1.24.m6.1.1.1.1.5.3.2.2.cmml" xref="alg1.24.m6.1.1.1.1.5.3.2.2">𝒫</ci><ci id="alg1.24.m6.1.1.1.1.5.3.2.3.cmml" xref="alg1.24.m6.1.1.1.1.5.3.2.3">ℐ</ci></apply><ci id="alg1.24.m6.1.1.1.1.5.3.3.cmml" xref="alg1.24.m6.1.1.1.1.5.3.3">𝑛</ci></apply></apply></apply><list id="alg1.24.m6.2.2.2.2.3.cmml" xref="alg1.24.m6.2.2.2.2.2"><apply id="alg1.24.m6.2.2.2.2.1.1.cmml" xref="alg1.24.m6.2.2.2.2.1.1"><plus id="alg1.24.m6.2.2.2.2.1.1.1.cmml" xref="alg1.24.m6.2.2.2.2.1.1.1"></plus><apply id="alg1.24.m6.2.2.2.2.1.1.2.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.2.2.1.1.2.1.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2">subscript</csymbol><apply id="alg1.24.m6.2.2.2.2.1.1.2.2.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.2.2.1.1.2.2.1.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2">subscript</csymbol><ci id="alg1.24.m6.2.2.2.2.1.1.2.2.2.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.2.2">𝒫</ci><ci id="alg1.24.m6.2.2.2.2.1.1.2.2.3.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.2.3">𝒯</ci></apply><apply id="alg1.24.m6.2.2.2.2.1.1.2.3.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3"><minus id="alg1.24.m6.2.2.2.2.1.1.2.3.1.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3"></minus><apply id="alg1.24.m6.2.2.2.2.1.1.2.3.2.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2"><times id="alg1.24.m6.2.2.2.2.1.1.2.3.2.1.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.1"></times><ci id="alg1.24.m6.2.2.2.2.1.1.2.3.2.2.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.2">𝑙</ci><ci id="alg1.24.m6.2.2.2.2.1.1.2.3.2.3.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.3">𝑜</ci><ci id="alg1.24.m6.2.2.2.2.1.1.2.3.2.4.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.4">𝑐</ci><ci id="alg1.24.m6.2.2.2.2.1.1.2.3.2.5.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.5">𝑎</ci><ci id="alg1.24.m6.2.2.2.2.1.1.2.3.2.6.cmml" xref="alg1.24.m6.2.2.2.2.1.1.2.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.24.m6.2.2.2.2.1.1.3.cmml" xref="alg1.24.m6.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.2.2.1.1.3.1.cmml" xref="alg1.24.m6.2.2.2.2.1.1.3">subscript</csymbol><apply id="alg1.24.m6.2.2.2.2.1.1.3.2.cmml" xref="alg1.24.m6.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.2.2.1.1.3.2.1.cmml" xref="alg1.24.m6.2.2.2.2.1.1.3">subscript</csymbol><ci id="alg1.24.m6.2.2.2.2.1.1.3.2.2.cmml" xref="alg1.24.m6.2.2.2.2.1.1.3.2.2">𝒫</ci><ci id="alg1.24.m6.2.2.2.2.1.1.3.2.3.cmml" xref="alg1.24.m6.2.2.2.2.1.1.3.2.3">𝒯</ci></apply><ci id="alg1.24.m6.2.2.2.2.1.1.3.3.cmml" xref="alg1.24.m6.2.2.2.2.1.1.3.3">𝑛</ci></apply></apply><apply id="alg1.24.m6.2.2.2.2.2.2.cmml" xref="alg1.24.m6.2.2.2.2.2.2"><plus id="alg1.24.m6.2.2.2.2.2.2.1.cmml" xref="alg1.24.m6.2.2.2.2.2.2.1"></plus><apply id="alg1.24.m6.2.2.2.2.2.2.2.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.2.2.2.2.2.1.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2">subscript</csymbol><apply id="alg1.24.m6.2.2.2.2.2.2.2.2.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.24.m6.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.2.2">𝒫</ci><ci id="alg1.24.m6.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.2.3">ℱ</ci></apply><apply id="alg1.24.m6.2.2.2.2.2.2.2.3.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3"><minus id="alg1.24.m6.2.2.2.2.2.2.2.3.1.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3"></minus><apply id="alg1.24.m6.2.2.2.2.2.2.2.3.2.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2"><times id="alg1.24.m6.2.2.2.2.2.2.2.3.2.1.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.1"></times><ci id="alg1.24.m6.2.2.2.2.2.2.2.3.2.2.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.2">𝑙</ci><ci id="alg1.24.m6.2.2.2.2.2.2.2.3.2.3.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.3">𝑜</ci><ci id="alg1.24.m6.2.2.2.2.2.2.2.3.2.4.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.4">𝑐</ci><ci id="alg1.24.m6.2.2.2.2.2.2.2.3.2.5.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.5">𝑎</ci><ci id="alg1.24.m6.2.2.2.2.2.2.2.3.2.6.cmml" xref="alg1.24.m6.2.2.2.2.2.2.2.3.2.6">𝑙</ci></apply></apply></apply><apply id="alg1.24.m6.2.2.2.2.2.2.3.cmml" xref="alg1.24.m6.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.2.2.2.2.3.1.cmml" xref="alg1.24.m6.2.2.2.2.2.2.3">subscript</csymbol><apply id="alg1.24.m6.2.2.2.2.2.2.3.2.cmml" xref="alg1.24.m6.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.24.m6.2.2.2.2.2.2.3.2.1.cmml" xref="alg1.24.m6.2.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.24.m6.2.2.2.2.2.2.3.2.2.cmml" xref="alg1.24.m6.2.2.2.2.2.2.3.2.2">𝒫</ci><ci id="alg1.24.m6.2.2.2.2.2.2.3.2.3.cmml" xref="alg1.24.m6.2.2.2.2.2.2.3.2.3">ℱ</ci></apply><ci id="alg1.24.m6.2.2.2.2.2.2.3.3.cmml" xref="alg1.24.m6.2.2.2.2.2.2.3.3">𝑛</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.m6.2c">\mathcal{P_{I}}_{-local},\mathcal{P_{T}}_{-local},\mathcal{P_{F}}_{-local}\leftarrow\mathcal{P_{I}}_{-local}+\mathcal{P_{I}}_{n},\mathcal{P_{T}}_{-local}+\mathcal{P_{T}}_{n},\mathcal{P_{F}}_{-local}+\mathcal{P_{F}}_{n}</annotation></semantics></math>;

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg1.35" class="ltx_block ltx_figure_panel">
<div id="alg1.25" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Local models are aggregated into the global model:
<math id="alg1.25.m1.2" class="ltx_Math" alttext="{\omega}^{t}={\sum}_{n\in S_{t}}\frac{|\mathcal{D}_{n}|}{|\mathcal{D}|}{{\omega}^{t}_{n}}" display="inline"><semantics id="alg1.25.m1.2a"><mrow id="alg1.25.m1.2.3" xref="alg1.25.m1.2.3.cmml"><msup id="alg1.25.m1.2.3.2" xref="alg1.25.m1.2.3.2.cmml"><mi id="alg1.25.m1.2.3.2.2" xref="alg1.25.m1.2.3.2.2.cmml">ω</mi><mi id="alg1.25.m1.2.3.2.3" xref="alg1.25.m1.2.3.2.3.cmml">t</mi></msup><mo rspace="0.111em" id="alg1.25.m1.2.3.1" xref="alg1.25.m1.2.3.1.cmml">=</mo><mrow id="alg1.25.m1.2.3.3" xref="alg1.25.m1.2.3.3.cmml"><msub id="alg1.25.m1.2.3.3.1" xref="alg1.25.m1.2.3.3.1.cmml"><mo id="alg1.25.m1.2.3.3.1.2" xref="alg1.25.m1.2.3.3.1.2.cmml">∑</mo><mrow id="alg1.25.m1.2.3.3.1.3" xref="alg1.25.m1.2.3.3.1.3.cmml"><mi id="alg1.25.m1.2.3.3.1.3.2" xref="alg1.25.m1.2.3.3.1.3.2.cmml">n</mi><mo id="alg1.25.m1.2.3.3.1.3.1" xref="alg1.25.m1.2.3.3.1.3.1.cmml">∈</mo><msub id="alg1.25.m1.2.3.3.1.3.3" xref="alg1.25.m1.2.3.3.1.3.3.cmml"><mi id="alg1.25.m1.2.3.3.1.3.3.2" xref="alg1.25.m1.2.3.3.1.3.3.2.cmml">S</mi><mi id="alg1.25.m1.2.3.3.1.3.3.3" xref="alg1.25.m1.2.3.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg1.25.m1.2.3.3.2" xref="alg1.25.m1.2.3.3.2.cmml"><mfrac id="alg1.25.m1.2.2" xref="alg1.25.m1.2.2.cmml"><mrow id="alg1.25.m1.1.1.1.1" xref="alg1.25.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.25.m1.1.1.1.1.2" xref="alg1.25.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.25.m1.1.1.1.1.1" xref="alg1.25.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.25.m1.1.1.1.1.1.2" xref="alg1.25.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.25.m1.1.1.1.1.1.3" xref="alg1.25.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="alg1.25.m1.1.1.1.1.3" xref="alg1.25.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.25.m1.2.2.2.3" xref="alg1.25.m1.2.2.2.2.cmml"><mo stretchy="false" id="alg1.25.m1.2.2.2.3.1" xref="alg1.25.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.25.m1.2.2.2.1" xref="alg1.25.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="alg1.25.m1.2.2.2.3.2" xref="alg1.25.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.25.m1.2.3.3.2.1" xref="alg1.25.m1.2.3.3.2.1.cmml">​</mo><msubsup id="alg1.25.m1.2.3.3.2.2" xref="alg1.25.m1.2.3.3.2.2.cmml"><mi id="alg1.25.m1.2.3.3.2.2.2.2" xref="alg1.25.m1.2.3.3.2.2.2.2.cmml">ω</mi><mi id="alg1.25.m1.2.3.3.2.2.3" xref="alg1.25.m1.2.3.3.2.2.3.cmml">n</mi><mi id="alg1.25.m1.2.3.3.2.2.2.3" xref="alg1.25.m1.2.3.3.2.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.25.m1.2b"><apply id="alg1.25.m1.2.3.cmml" xref="alg1.25.m1.2.3"><eq id="alg1.25.m1.2.3.1.cmml" xref="alg1.25.m1.2.3.1"></eq><apply id="alg1.25.m1.2.3.2.cmml" xref="alg1.25.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.25.m1.2.3.2.1.cmml" xref="alg1.25.m1.2.3.2">superscript</csymbol><ci id="alg1.25.m1.2.3.2.2.cmml" xref="alg1.25.m1.2.3.2.2">𝜔</ci><ci id="alg1.25.m1.2.3.2.3.cmml" xref="alg1.25.m1.2.3.2.3">𝑡</ci></apply><apply id="alg1.25.m1.2.3.3.cmml" xref="alg1.25.m1.2.3.3"><apply id="alg1.25.m1.2.3.3.1.cmml" xref="alg1.25.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.25.m1.2.3.3.1.1.cmml" xref="alg1.25.m1.2.3.3.1">subscript</csymbol><sum id="alg1.25.m1.2.3.3.1.2.cmml" xref="alg1.25.m1.2.3.3.1.2"></sum><apply id="alg1.25.m1.2.3.3.1.3.cmml" xref="alg1.25.m1.2.3.3.1.3"><in id="alg1.25.m1.2.3.3.1.3.1.cmml" xref="alg1.25.m1.2.3.3.1.3.1"></in><ci id="alg1.25.m1.2.3.3.1.3.2.cmml" xref="alg1.25.m1.2.3.3.1.3.2">𝑛</ci><apply id="alg1.25.m1.2.3.3.1.3.3.cmml" xref="alg1.25.m1.2.3.3.1.3.3"><csymbol cd="ambiguous" id="alg1.25.m1.2.3.3.1.3.3.1.cmml" xref="alg1.25.m1.2.3.3.1.3.3">subscript</csymbol><ci id="alg1.25.m1.2.3.3.1.3.3.2.cmml" xref="alg1.25.m1.2.3.3.1.3.3.2">𝑆</ci><ci id="alg1.25.m1.2.3.3.1.3.3.3.cmml" xref="alg1.25.m1.2.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.25.m1.2.3.3.2.cmml" xref="alg1.25.m1.2.3.3.2"><times id="alg1.25.m1.2.3.3.2.1.cmml" xref="alg1.25.m1.2.3.3.2.1"></times><apply id="alg1.25.m1.2.2.cmml" xref="alg1.25.m1.2.2"><divide id="alg1.25.m1.2.2.3.cmml" xref="alg1.25.m1.2.2"></divide><apply id="alg1.25.m1.1.1.1.2.cmml" xref="alg1.25.m1.1.1.1.1"><abs id="alg1.25.m1.1.1.1.2.1.cmml" xref="alg1.25.m1.1.1.1.1.2"></abs><apply id="alg1.25.m1.1.1.1.1.1.cmml" xref="alg1.25.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.25.m1.1.1.1.1.1.1.cmml" xref="alg1.25.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.25.m1.1.1.1.1.1.2.cmml" xref="alg1.25.m1.1.1.1.1.1.2">𝒟</ci><ci id="alg1.25.m1.1.1.1.1.1.3.cmml" xref="alg1.25.m1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="alg1.25.m1.2.2.2.2.cmml" xref="alg1.25.m1.2.2.2.3"><abs id="alg1.25.m1.2.2.2.2.1.cmml" xref="alg1.25.m1.2.2.2.3.1"></abs><ci id="alg1.25.m1.2.2.2.1.cmml" xref="alg1.25.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="alg1.25.m1.2.3.3.2.2.cmml" xref="alg1.25.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.25.m1.2.3.3.2.2.1.cmml" xref="alg1.25.m1.2.3.3.2.2">subscript</csymbol><apply id="alg1.25.m1.2.3.3.2.2.2.cmml" xref="alg1.25.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.25.m1.2.3.3.2.2.2.1.cmml" xref="alg1.25.m1.2.3.3.2.2">superscript</csymbol><ci id="alg1.25.m1.2.3.3.2.2.2.2.cmml" xref="alg1.25.m1.2.3.3.2.2.2.2">𝜔</ci><ci id="alg1.25.m1.2.3.3.2.2.2.3.cmml" xref="alg1.25.m1.2.3.3.2.2.2.3">𝑡</ci></apply><ci id="alg1.25.m1.2.3.3.2.2.3.cmml" xref="alg1.25.m1.2.3.3.2.2.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.m1.2c">{\omega}^{t}={\sum}_{n\in S_{t}}\frac{|\mathcal{D}_{n}|}{|\mathcal{D}|}{{\omega}^{t}_{n}}</annotation></semantics></math>

</div>
<div id="alg1.27" class="ltx_listingline">
<span id="alg1.27.2" class="ltx_text ltx_font_bold">ClientLocalTraining</span>
<math id="alg1.26.m1.6" class="ltx_Math" alttext="(n,t,{\omega}^{t-1},\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}})" display="inline"><semantics id="alg1.26.m1.6a"><mrow id="alg1.26.m1.6.6.4" xref="alg1.26.m1.6.6.5.cmml"><mo stretchy="false" id="alg1.26.m1.6.6.4.5" xref="alg1.26.m1.6.6.5.cmml">(</mo><mi id="alg1.26.m1.1.1" xref="alg1.26.m1.1.1.cmml">n</mi><mo id="alg1.26.m1.6.6.4.6" xref="alg1.26.m1.6.6.5.cmml">,</mo><mi id="alg1.26.m1.2.2" xref="alg1.26.m1.2.2.cmml">t</mi><mo id="alg1.26.m1.6.6.4.7" xref="alg1.26.m1.6.6.5.cmml">,</mo><msup id="alg1.26.m1.3.3.1.1" xref="alg1.26.m1.3.3.1.1.cmml"><mi id="alg1.26.m1.3.3.1.1.2" xref="alg1.26.m1.3.3.1.1.2.cmml">ω</mi><mrow id="alg1.26.m1.3.3.1.1.3" xref="alg1.26.m1.3.3.1.1.3.cmml"><mi id="alg1.26.m1.3.3.1.1.3.2" xref="alg1.26.m1.3.3.1.1.3.2.cmml">t</mi><mo id="alg1.26.m1.3.3.1.1.3.1" xref="alg1.26.m1.3.3.1.1.3.1.cmml">−</mo><mn id="alg1.26.m1.3.3.1.1.3.3" xref="alg1.26.m1.3.3.1.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.26.m1.6.6.4.8" xref="alg1.26.m1.6.6.5.cmml">,</mo><msub id="alg1.26.m1.4.4.2.2" xref="alg1.26.m1.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.26.m1.4.4.2.2.2" xref="alg1.26.m1.4.4.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.26.m1.4.4.2.2.3" xref="alg1.26.m1.4.4.2.2.3.cmml">ℐ</mi></msub><mo id="alg1.26.m1.6.6.4.9" xref="alg1.26.m1.6.6.5.cmml">,</mo><msub id="alg1.26.m1.5.5.3.3" xref="alg1.26.m1.5.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.26.m1.5.5.3.3.2" xref="alg1.26.m1.5.5.3.3.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.26.m1.5.5.3.3.3" xref="alg1.26.m1.5.5.3.3.3.cmml">𝒯</mi></msub><mo id="alg1.26.m1.6.6.4.10" xref="alg1.26.m1.6.6.5.cmml">,</mo><msub id="alg1.26.m1.6.6.4.4" xref="alg1.26.m1.6.6.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.26.m1.6.6.4.4.2" xref="alg1.26.m1.6.6.4.4.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.26.m1.6.6.4.4.3" xref="alg1.26.m1.6.6.4.4.3.cmml">ℱ</mi></msub><mo stretchy="false" id="alg1.26.m1.6.6.4.11" xref="alg1.26.m1.6.6.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.26.m1.6b"><vector id="alg1.26.m1.6.6.5.cmml" xref="alg1.26.m1.6.6.4"><ci id="alg1.26.m1.1.1.cmml" xref="alg1.26.m1.1.1">𝑛</ci><ci id="alg1.26.m1.2.2.cmml" xref="alg1.26.m1.2.2">𝑡</ci><apply id="alg1.26.m1.3.3.1.1.cmml" xref="alg1.26.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.26.m1.3.3.1.1.1.cmml" xref="alg1.26.m1.3.3.1.1">superscript</csymbol><ci id="alg1.26.m1.3.3.1.1.2.cmml" xref="alg1.26.m1.3.3.1.1.2">𝜔</ci><apply id="alg1.26.m1.3.3.1.1.3.cmml" xref="alg1.26.m1.3.3.1.1.3"><minus id="alg1.26.m1.3.3.1.1.3.1.cmml" xref="alg1.26.m1.3.3.1.1.3.1"></minus><ci id="alg1.26.m1.3.3.1.1.3.2.cmml" xref="alg1.26.m1.3.3.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.26.m1.3.3.1.1.3.3.cmml" xref="alg1.26.m1.3.3.1.1.3.3">1</cn></apply></apply><apply id="alg1.26.m1.4.4.2.2.cmml" xref="alg1.26.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg1.26.m1.4.4.2.2.1.cmml" xref="alg1.26.m1.4.4.2.2">subscript</csymbol><ci id="alg1.26.m1.4.4.2.2.2.cmml" xref="alg1.26.m1.4.4.2.2.2">𝒫</ci><ci id="alg1.26.m1.4.4.2.2.3.cmml" xref="alg1.26.m1.4.4.2.2.3">ℐ</ci></apply><apply id="alg1.26.m1.5.5.3.3.cmml" xref="alg1.26.m1.5.5.3.3"><csymbol cd="ambiguous" id="alg1.26.m1.5.5.3.3.1.cmml" xref="alg1.26.m1.5.5.3.3">subscript</csymbol><ci id="alg1.26.m1.5.5.3.3.2.cmml" xref="alg1.26.m1.5.5.3.3.2">𝒫</ci><ci id="alg1.26.m1.5.5.3.3.3.cmml" xref="alg1.26.m1.5.5.3.3.3">𝒯</ci></apply><apply id="alg1.26.m1.6.6.4.4.cmml" xref="alg1.26.m1.6.6.4.4"><csymbol cd="ambiguous" id="alg1.26.m1.6.6.4.4.1.cmml" xref="alg1.26.m1.6.6.4.4">subscript</csymbol><ci id="alg1.26.m1.6.6.4.4.2.cmml" xref="alg1.26.m1.6.6.4.4.2">𝒫</ci><ci id="alg1.26.m1.6.6.4.4.3.cmml" xref="alg1.26.m1.6.6.4.4.3">ℱ</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.m1.6c">(n,t,{\omega}^{t-1},\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}})</annotation></semantics></math>:
<span id="alg1.27.3" class="ltx_text ltx_font_bold">for</span> <em id="alg1.27.1" class="ltx_emph">epoch <math id="alg1.27.1.1.m1.3" class="ltx_Math" alttext="i=1,2,\cdots E" display="inline"><semantics id="alg1.27.1.1.m1.3a"><mrow id="alg1.27.1.1.m1.3.3" xref="alg1.27.1.1.m1.3.3.cmml"><mi id="alg1.27.1.1.m1.3.3.3" xref="alg1.27.1.1.m1.3.3.3.cmml">i</mi><mo id="alg1.27.1.1.m1.3.3.2" xref="alg1.27.1.1.m1.3.3.2.cmml">=</mo><mrow id="alg1.27.1.1.m1.3.3.1.1" xref="alg1.27.1.1.m1.3.3.1.2.cmml"><mn id="alg1.27.1.1.m1.1.1" xref="alg1.27.1.1.m1.1.1.cmml">1</mn><mo id="alg1.27.1.1.m1.3.3.1.1.2" xref="alg1.27.1.1.m1.3.3.1.2.cmml">,</mo><mn id="alg1.27.1.1.m1.2.2" xref="alg1.27.1.1.m1.2.2.cmml">2</mn><mo id="alg1.27.1.1.m1.3.3.1.1.3" xref="alg1.27.1.1.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.27.1.1.m1.3.3.1.1.1" xref="alg1.27.1.1.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="alg1.27.1.1.m1.3.3.1.1.1.2" xref="alg1.27.1.1.m1.3.3.1.1.1.2.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="alg1.27.1.1.m1.3.3.1.1.1.1" xref="alg1.27.1.1.m1.3.3.1.1.1.1.cmml">​</mo><mi id="alg1.27.1.1.m1.3.3.1.1.1.3" xref="alg1.27.1.1.m1.3.3.1.1.1.3.cmml">E</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.27.1.1.m1.3b"><apply id="alg1.27.1.1.m1.3.3.cmml" xref="alg1.27.1.1.m1.3.3"><eq id="alg1.27.1.1.m1.3.3.2.cmml" xref="alg1.27.1.1.m1.3.3.2"></eq><ci id="alg1.27.1.1.m1.3.3.3.cmml" xref="alg1.27.1.1.m1.3.3.3">𝑖</ci><list id="alg1.27.1.1.m1.3.3.1.2.cmml" xref="alg1.27.1.1.m1.3.3.1.1"><cn type="integer" id="alg1.27.1.1.m1.1.1.cmml" xref="alg1.27.1.1.m1.1.1">1</cn><cn type="integer" id="alg1.27.1.1.m1.2.2.cmml" xref="alg1.27.1.1.m1.2.2">2</cn><apply id="alg1.27.1.1.m1.3.3.1.1.1.cmml" xref="alg1.27.1.1.m1.3.3.1.1.1"><times id="alg1.27.1.1.m1.3.3.1.1.1.1.cmml" xref="alg1.27.1.1.m1.3.3.1.1.1.1"></times><ci id="alg1.27.1.1.m1.3.3.1.1.1.2.cmml" xref="alg1.27.1.1.m1.3.3.1.1.1.2">⋯</ci><ci id="alg1.27.1.1.m1.3.3.1.1.1.3.cmml" xref="alg1.27.1.1.m1.3.3.1.1.1.3">𝐸</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.1.1.m1.3c">i=1,2,\cdots E</annotation></semantics></math></em> <span id="alg1.27.4" class="ltx_text ltx_font_bold">do</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg1.36" class="ltx_block ltx_figure_panel">
<div id="alg1.28" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Local update
<math id="alg1.28.m1.11" class="ltx_Math" alttext="\omega^{(t,i)}_{n}\leftarrow\omega^{(t,i-1)}_{n}-\eta\nabla L(\mathcal{D}_{n},\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}};\omega^{(t-1,i-1)}_{n})" display="inline"><semantics id="alg1.28.m1.11a"><mrow id="alg1.28.m1.11.11" xref="alg1.28.m1.11.11.cmml"><msubsup id="alg1.28.m1.11.11.7" xref="alg1.28.m1.11.11.7.cmml"><mi id="alg1.28.m1.11.11.7.2.2" xref="alg1.28.m1.11.11.7.2.2.cmml">ω</mi><mi id="alg1.28.m1.11.11.7.3" xref="alg1.28.m1.11.11.7.3.cmml">n</mi><mrow id="alg1.28.m1.2.2.2.4" xref="alg1.28.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.28.m1.2.2.2.4.1" xref="alg1.28.m1.2.2.2.3.cmml">(</mo><mi id="alg1.28.m1.1.1.1.1" xref="alg1.28.m1.1.1.1.1.cmml">t</mi><mo id="alg1.28.m1.2.2.2.4.2" xref="alg1.28.m1.2.2.2.3.cmml">,</mo><mi id="alg1.28.m1.2.2.2.2" xref="alg1.28.m1.2.2.2.2.cmml">i</mi><mo stretchy="false" id="alg1.28.m1.2.2.2.4.3" xref="alg1.28.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.28.m1.11.11.6" xref="alg1.28.m1.11.11.6.cmml">←</mo><mrow id="alg1.28.m1.11.11.5" xref="alg1.28.m1.11.11.5.cmml"><msubsup id="alg1.28.m1.11.11.5.7" xref="alg1.28.m1.11.11.5.7.cmml"><mi id="alg1.28.m1.11.11.5.7.2.2" xref="alg1.28.m1.11.11.5.7.2.2.cmml">ω</mi><mi id="alg1.28.m1.11.11.5.7.3" xref="alg1.28.m1.11.11.5.7.3.cmml">n</mi><mrow id="alg1.28.m1.4.4.2.2" xref="alg1.28.m1.4.4.2.3.cmml"><mo stretchy="false" id="alg1.28.m1.4.4.2.2.2" xref="alg1.28.m1.4.4.2.3.cmml">(</mo><mi id="alg1.28.m1.3.3.1.1" xref="alg1.28.m1.3.3.1.1.cmml">t</mi><mo id="alg1.28.m1.4.4.2.2.3" xref="alg1.28.m1.4.4.2.3.cmml">,</mo><mrow id="alg1.28.m1.4.4.2.2.1" xref="alg1.28.m1.4.4.2.2.1.cmml"><mi id="alg1.28.m1.4.4.2.2.1.2" xref="alg1.28.m1.4.4.2.2.1.2.cmml">i</mi><mo id="alg1.28.m1.4.4.2.2.1.1" xref="alg1.28.m1.4.4.2.2.1.1.cmml">−</mo><mn id="alg1.28.m1.4.4.2.2.1.3" xref="alg1.28.m1.4.4.2.2.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.28.m1.4.4.2.2.4" xref="alg1.28.m1.4.4.2.3.cmml">)</mo></mrow></msubsup><mo id="alg1.28.m1.11.11.5.6" xref="alg1.28.m1.11.11.5.6.cmml">−</mo><mrow id="alg1.28.m1.11.11.5.5" xref="alg1.28.m1.11.11.5.5.cmml"><mi id="alg1.28.m1.11.11.5.5.7" xref="alg1.28.m1.11.11.5.5.7.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.28.m1.11.11.5.5.6" xref="alg1.28.m1.11.11.5.5.6.cmml">​</mo><mrow id="alg1.28.m1.11.11.5.5.8" xref="alg1.28.m1.11.11.5.5.8.cmml"><mo rspace="0.167em" id="alg1.28.m1.11.11.5.5.8.1" xref="alg1.28.m1.11.11.5.5.8.1.cmml">∇</mo><mi id="alg1.28.m1.11.11.5.5.8.2" xref="alg1.28.m1.11.11.5.5.8.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.28.m1.11.11.5.5.6a" xref="alg1.28.m1.11.11.5.5.6.cmml">​</mo><mrow id="alg1.28.m1.11.11.5.5.5.5" xref="alg1.28.m1.11.11.5.5.5.6.cmml"><mo stretchy="false" id="alg1.28.m1.11.11.5.5.5.5.6" xref="alg1.28.m1.11.11.5.5.5.6.cmml">(</mo><msub id="alg1.28.m1.7.7.1.1.1.1.1" xref="alg1.28.m1.7.7.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.28.m1.7.7.1.1.1.1.1.2" xref="alg1.28.m1.7.7.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.28.m1.7.7.1.1.1.1.1.3" xref="alg1.28.m1.7.7.1.1.1.1.1.3.cmml">n</mi></msub><mo id="alg1.28.m1.11.11.5.5.5.5.7" xref="alg1.28.m1.11.11.5.5.5.6.cmml">,</mo><msub id="alg1.28.m1.8.8.2.2.2.2.2" xref="alg1.28.m1.8.8.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.28.m1.8.8.2.2.2.2.2.2" xref="alg1.28.m1.8.8.2.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.28.m1.8.8.2.2.2.2.2.3" xref="alg1.28.m1.8.8.2.2.2.2.2.3.cmml">ℐ</mi></msub><mo id="alg1.28.m1.11.11.5.5.5.5.8" xref="alg1.28.m1.11.11.5.5.5.6.cmml">,</mo><msub id="alg1.28.m1.9.9.3.3.3.3.3" xref="alg1.28.m1.9.9.3.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.28.m1.9.9.3.3.3.3.3.2" xref="alg1.28.m1.9.9.3.3.3.3.3.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.28.m1.9.9.3.3.3.3.3.3" xref="alg1.28.m1.9.9.3.3.3.3.3.3.cmml">𝒯</mi></msub><mo id="alg1.28.m1.11.11.5.5.5.5.9" xref="alg1.28.m1.11.11.5.5.5.6.cmml">,</mo><msub id="alg1.28.m1.10.10.4.4.4.4.4" xref="alg1.28.m1.10.10.4.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.28.m1.10.10.4.4.4.4.4.2" xref="alg1.28.m1.10.10.4.4.4.4.4.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.28.m1.10.10.4.4.4.4.4.3" xref="alg1.28.m1.10.10.4.4.4.4.4.3.cmml">ℱ</mi></msub><mo id="alg1.28.m1.11.11.5.5.5.5.10" xref="alg1.28.m1.11.11.5.5.5.6.cmml">;</mo><msubsup id="alg1.28.m1.11.11.5.5.5.5.5" xref="alg1.28.m1.11.11.5.5.5.5.5.cmml"><mi id="alg1.28.m1.11.11.5.5.5.5.5.2.2" xref="alg1.28.m1.11.11.5.5.5.5.5.2.2.cmml">ω</mi><mi id="alg1.28.m1.11.11.5.5.5.5.5.3" xref="alg1.28.m1.11.11.5.5.5.5.5.3.cmml">n</mi><mrow id="alg1.28.m1.6.6.2.2" xref="alg1.28.m1.6.6.2.3.cmml"><mo stretchy="false" id="alg1.28.m1.6.6.2.2.3" xref="alg1.28.m1.6.6.2.3.cmml">(</mo><mrow id="alg1.28.m1.5.5.1.1.1" xref="alg1.28.m1.5.5.1.1.1.cmml"><mi id="alg1.28.m1.5.5.1.1.1.2" xref="alg1.28.m1.5.5.1.1.1.2.cmml">t</mi><mo id="alg1.28.m1.5.5.1.1.1.1" xref="alg1.28.m1.5.5.1.1.1.1.cmml">−</mo><mn id="alg1.28.m1.5.5.1.1.1.3" xref="alg1.28.m1.5.5.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.28.m1.6.6.2.2.4" xref="alg1.28.m1.6.6.2.3.cmml">,</mo><mrow id="alg1.28.m1.6.6.2.2.2" xref="alg1.28.m1.6.6.2.2.2.cmml"><mi id="alg1.28.m1.6.6.2.2.2.2" xref="alg1.28.m1.6.6.2.2.2.2.cmml">i</mi><mo id="alg1.28.m1.6.6.2.2.2.1" xref="alg1.28.m1.6.6.2.2.2.1.cmml">−</mo><mn id="alg1.28.m1.6.6.2.2.2.3" xref="alg1.28.m1.6.6.2.2.2.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.28.m1.6.6.2.2.5" xref="alg1.28.m1.6.6.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.28.m1.11.11.5.5.5.5.11" xref="alg1.28.m1.11.11.5.5.5.6.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.28.m1.11b"><apply id="alg1.28.m1.11.11.cmml" xref="alg1.28.m1.11.11"><ci id="alg1.28.m1.11.11.6.cmml" xref="alg1.28.m1.11.11.6">←</ci><apply id="alg1.28.m1.11.11.7.cmml" xref="alg1.28.m1.11.11.7"><csymbol cd="ambiguous" id="alg1.28.m1.11.11.7.1.cmml" xref="alg1.28.m1.11.11.7">subscript</csymbol><apply id="alg1.28.m1.11.11.7.2.cmml" xref="alg1.28.m1.11.11.7"><csymbol cd="ambiguous" id="alg1.28.m1.11.11.7.2.1.cmml" xref="alg1.28.m1.11.11.7">superscript</csymbol><ci id="alg1.28.m1.11.11.7.2.2.cmml" xref="alg1.28.m1.11.11.7.2.2">𝜔</ci><interval closure="open" id="alg1.28.m1.2.2.2.3.cmml" xref="alg1.28.m1.2.2.2.4"><ci id="alg1.28.m1.1.1.1.1.cmml" xref="alg1.28.m1.1.1.1.1">𝑡</ci><ci id="alg1.28.m1.2.2.2.2.cmml" xref="alg1.28.m1.2.2.2.2">𝑖</ci></interval></apply><ci id="alg1.28.m1.11.11.7.3.cmml" xref="alg1.28.m1.11.11.7.3">𝑛</ci></apply><apply id="alg1.28.m1.11.11.5.cmml" xref="alg1.28.m1.11.11.5"><minus id="alg1.28.m1.11.11.5.6.cmml" xref="alg1.28.m1.11.11.5.6"></minus><apply id="alg1.28.m1.11.11.5.7.cmml" xref="alg1.28.m1.11.11.5.7"><csymbol cd="ambiguous" id="alg1.28.m1.11.11.5.7.1.cmml" xref="alg1.28.m1.11.11.5.7">subscript</csymbol><apply id="alg1.28.m1.11.11.5.7.2.cmml" xref="alg1.28.m1.11.11.5.7"><csymbol cd="ambiguous" id="alg1.28.m1.11.11.5.7.2.1.cmml" xref="alg1.28.m1.11.11.5.7">superscript</csymbol><ci id="alg1.28.m1.11.11.5.7.2.2.cmml" xref="alg1.28.m1.11.11.5.7.2.2">𝜔</ci><interval closure="open" id="alg1.28.m1.4.4.2.3.cmml" xref="alg1.28.m1.4.4.2.2"><ci id="alg1.28.m1.3.3.1.1.cmml" xref="alg1.28.m1.3.3.1.1">𝑡</ci><apply id="alg1.28.m1.4.4.2.2.1.cmml" xref="alg1.28.m1.4.4.2.2.1"><minus id="alg1.28.m1.4.4.2.2.1.1.cmml" xref="alg1.28.m1.4.4.2.2.1.1"></minus><ci id="alg1.28.m1.4.4.2.2.1.2.cmml" xref="alg1.28.m1.4.4.2.2.1.2">𝑖</ci><cn type="integer" id="alg1.28.m1.4.4.2.2.1.3.cmml" xref="alg1.28.m1.4.4.2.2.1.3">1</cn></apply></interval></apply><ci id="alg1.28.m1.11.11.5.7.3.cmml" xref="alg1.28.m1.11.11.5.7.3">𝑛</ci></apply><apply id="alg1.28.m1.11.11.5.5.cmml" xref="alg1.28.m1.11.11.5.5"><times id="alg1.28.m1.11.11.5.5.6.cmml" xref="alg1.28.m1.11.11.5.5.6"></times><ci id="alg1.28.m1.11.11.5.5.7.cmml" xref="alg1.28.m1.11.11.5.5.7">𝜂</ci><apply id="alg1.28.m1.11.11.5.5.8.cmml" xref="alg1.28.m1.11.11.5.5.8"><ci id="alg1.28.m1.11.11.5.5.8.1.cmml" xref="alg1.28.m1.11.11.5.5.8.1">∇</ci><ci id="alg1.28.m1.11.11.5.5.8.2.cmml" xref="alg1.28.m1.11.11.5.5.8.2">𝐿</ci></apply><vector id="alg1.28.m1.11.11.5.5.5.6.cmml" xref="alg1.28.m1.11.11.5.5.5.5"><apply id="alg1.28.m1.7.7.1.1.1.1.1.cmml" xref="alg1.28.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.28.m1.7.7.1.1.1.1.1.1.cmml" xref="alg1.28.m1.7.7.1.1.1.1.1">subscript</csymbol><ci id="alg1.28.m1.7.7.1.1.1.1.1.2.cmml" xref="alg1.28.m1.7.7.1.1.1.1.1.2">𝒟</ci><ci id="alg1.28.m1.7.7.1.1.1.1.1.3.cmml" xref="alg1.28.m1.7.7.1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.28.m1.8.8.2.2.2.2.2.cmml" xref="alg1.28.m1.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.28.m1.8.8.2.2.2.2.2.1.cmml" xref="alg1.28.m1.8.8.2.2.2.2.2">subscript</csymbol><ci id="alg1.28.m1.8.8.2.2.2.2.2.2.cmml" xref="alg1.28.m1.8.8.2.2.2.2.2.2">𝒫</ci><ci id="alg1.28.m1.8.8.2.2.2.2.2.3.cmml" xref="alg1.28.m1.8.8.2.2.2.2.2.3">ℐ</ci></apply><apply id="alg1.28.m1.9.9.3.3.3.3.3.cmml" xref="alg1.28.m1.9.9.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.28.m1.9.9.3.3.3.3.3.1.cmml" xref="alg1.28.m1.9.9.3.3.3.3.3">subscript</csymbol><ci id="alg1.28.m1.9.9.3.3.3.3.3.2.cmml" xref="alg1.28.m1.9.9.3.3.3.3.3.2">𝒫</ci><ci id="alg1.28.m1.9.9.3.3.3.3.3.3.cmml" xref="alg1.28.m1.9.9.3.3.3.3.3.3">𝒯</ci></apply><apply id="alg1.28.m1.10.10.4.4.4.4.4.cmml" xref="alg1.28.m1.10.10.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.28.m1.10.10.4.4.4.4.4.1.cmml" xref="alg1.28.m1.10.10.4.4.4.4.4">subscript</csymbol><ci id="alg1.28.m1.10.10.4.4.4.4.4.2.cmml" xref="alg1.28.m1.10.10.4.4.4.4.4.2">𝒫</ci><ci id="alg1.28.m1.10.10.4.4.4.4.4.3.cmml" xref="alg1.28.m1.10.10.4.4.4.4.4.3">ℱ</ci></apply><apply id="alg1.28.m1.11.11.5.5.5.5.5.cmml" xref="alg1.28.m1.11.11.5.5.5.5.5"><csymbol cd="ambiguous" id="alg1.28.m1.11.11.5.5.5.5.5.1.cmml" xref="alg1.28.m1.11.11.5.5.5.5.5">subscript</csymbol><apply id="alg1.28.m1.11.11.5.5.5.5.5.2.cmml" xref="alg1.28.m1.11.11.5.5.5.5.5"><csymbol cd="ambiguous" id="alg1.28.m1.11.11.5.5.5.5.5.2.1.cmml" xref="alg1.28.m1.11.11.5.5.5.5.5">superscript</csymbol><ci id="alg1.28.m1.11.11.5.5.5.5.5.2.2.cmml" xref="alg1.28.m1.11.11.5.5.5.5.5.2.2">𝜔</ci><interval closure="open" id="alg1.28.m1.6.6.2.3.cmml" xref="alg1.28.m1.6.6.2.2"><apply id="alg1.28.m1.5.5.1.1.1.cmml" xref="alg1.28.m1.5.5.1.1.1"><minus id="alg1.28.m1.5.5.1.1.1.1.cmml" xref="alg1.28.m1.5.5.1.1.1.1"></minus><ci id="alg1.28.m1.5.5.1.1.1.2.cmml" xref="alg1.28.m1.5.5.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.28.m1.5.5.1.1.1.3.cmml" xref="alg1.28.m1.5.5.1.1.1.3">1</cn></apply><apply id="alg1.28.m1.6.6.2.2.2.cmml" xref="alg1.28.m1.6.6.2.2.2"><minus id="alg1.28.m1.6.6.2.2.2.1.cmml" xref="alg1.28.m1.6.6.2.2.2.1"></minus><ci id="alg1.28.m1.6.6.2.2.2.2.cmml" xref="alg1.28.m1.6.6.2.2.2.2">𝑖</ci><cn type="integer" id="alg1.28.m1.6.6.2.2.2.3.cmml" xref="alg1.28.m1.6.6.2.2.2.3">1</cn></apply></interval></apply><ci id="alg1.28.m1.11.11.5.5.5.5.5.3.cmml" xref="alg1.28.m1.11.11.5.5.5.5.5.3">𝑛</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.m1.11c">\omega^{(t,i)}_{n}\leftarrow\omega^{(t,i-1)}_{n}-\eta\nabla L(\mathcal{D}_{n},\mathcal{P_{I}},\mathcal{P_{T}},\mathcal{P_{F}};\omega^{(t-1,i-1)}_{n})</annotation></semantics></math>
according to Equation <a href="#S3.E8" title="Equation 8 ‣ 3.4 Prototypes as Learned Representation Targets ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>;
 
</div>
<div id="alg1.30" class="ltx_listingline">Compute local prototypes <math id="alg1.29.m1.3" class="ltx_Math" alttext="\mathcal{P_{I}}_{n},\mathcal{P_{T}}_{n},\mathcal{P_{F}}_{n}" display="inline"><semantics id="alg1.29.m1.3a"><mrow id="alg1.29.m1.3.3.3" xref="alg1.29.m1.3.3.4.cmml"><mmultiscripts id="alg1.29.m1.1.1.1.1" xref="alg1.29.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.29.m1.1.1.1.1.2.2" xref="alg1.29.m1.1.1.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.29.m1.1.1.1.1.2.3" xref="alg1.29.m1.1.1.1.1.2.3.cmml">ℐ</mi><mrow id="alg1.29.m1.1.1.1.1a" xref="alg1.29.m1.1.1.1.1.cmml"></mrow><mi id="alg1.29.m1.1.1.1.1.3" xref="alg1.29.m1.1.1.1.1.3.cmml">n</mi><mrow id="alg1.29.m1.1.1.1.1b" xref="alg1.29.m1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="alg1.29.m1.3.3.3.4" xref="alg1.29.m1.3.3.4.cmml">,</mo><mmultiscripts id="alg1.29.m1.2.2.2.2" xref="alg1.29.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.29.m1.2.2.2.2.2.2" xref="alg1.29.m1.2.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.29.m1.2.2.2.2.2.3" xref="alg1.29.m1.2.2.2.2.2.3.cmml">𝒯</mi><mrow id="alg1.29.m1.2.2.2.2a" xref="alg1.29.m1.2.2.2.2.cmml"></mrow><mi id="alg1.29.m1.2.2.2.2.3" xref="alg1.29.m1.2.2.2.2.3.cmml">n</mi><mrow id="alg1.29.m1.2.2.2.2b" xref="alg1.29.m1.2.2.2.2.cmml"></mrow></mmultiscripts><mo id="alg1.29.m1.3.3.3.5" xref="alg1.29.m1.3.3.4.cmml">,</mo><mmultiscripts id="alg1.29.m1.3.3.3.3" xref="alg1.29.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.29.m1.3.3.3.3.2.2" xref="alg1.29.m1.3.3.3.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.29.m1.3.3.3.3.2.3" xref="alg1.29.m1.3.3.3.3.2.3.cmml">ℱ</mi><mrow id="alg1.29.m1.3.3.3.3a" xref="alg1.29.m1.3.3.3.3.cmml"></mrow><mi id="alg1.29.m1.3.3.3.3.3" xref="alg1.29.m1.3.3.3.3.3.cmml">n</mi><mrow id="alg1.29.m1.3.3.3.3b" xref="alg1.29.m1.3.3.3.3.cmml"></mrow></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="alg1.29.m1.3b"><list id="alg1.29.m1.3.3.4.cmml" xref="alg1.29.m1.3.3.3"><apply id="alg1.29.m1.1.1.1.1.cmml" xref="alg1.29.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.29.m1.1.1.1.1.1.cmml" xref="alg1.29.m1.1.1.1.1">subscript</csymbol><apply id="alg1.29.m1.1.1.1.1.2.cmml" xref="alg1.29.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.29.m1.1.1.1.1.2.1.cmml" xref="alg1.29.m1.1.1.1.1">subscript</csymbol><ci id="alg1.29.m1.1.1.1.1.2.2.cmml" xref="alg1.29.m1.1.1.1.1.2.2">𝒫</ci><ci id="alg1.29.m1.1.1.1.1.2.3.cmml" xref="alg1.29.m1.1.1.1.1.2.3">ℐ</ci></apply><ci id="alg1.29.m1.1.1.1.1.3.cmml" xref="alg1.29.m1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.29.m1.2.2.2.2.cmml" xref="alg1.29.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.29.m1.2.2.2.2.1.cmml" xref="alg1.29.m1.2.2.2.2">subscript</csymbol><apply id="alg1.29.m1.2.2.2.2.2.cmml" xref="alg1.29.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.29.m1.2.2.2.2.2.1.cmml" xref="alg1.29.m1.2.2.2.2">subscript</csymbol><ci id="alg1.29.m1.2.2.2.2.2.2.cmml" xref="alg1.29.m1.2.2.2.2.2.2">𝒫</ci><ci id="alg1.29.m1.2.2.2.2.2.3.cmml" xref="alg1.29.m1.2.2.2.2.2.3">𝒯</ci></apply><ci id="alg1.29.m1.2.2.2.2.3.cmml" xref="alg1.29.m1.2.2.2.2.3">𝑛</ci></apply><apply id="alg1.29.m1.3.3.3.3.cmml" xref="alg1.29.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.29.m1.3.3.3.3.1.cmml" xref="alg1.29.m1.3.3.3.3">subscript</csymbol><apply id="alg1.29.m1.3.3.3.3.2.cmml" xref="alg1.29.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.29.m1.3.3.3.3.2.1.cmml" xref="alg1.29.m1.3.3.3.3">subscript</csymbol><ci id="alg1.29.m1.3.3.3.3.2.2.cmml" xref="alg1.29.m1.3.3.3.3.2.2">𝒫</ci><ci id="alg1.29.m1.3.3.3.3.2.3.cmml" xref="alg1.29.m1.3.3.3.3.2.3">ℱ</ci></apply><ci id="alg1.29.m1.3.3.3.3.3.cmml" xref="alg1.29.m1.3.3.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.29.m1.3c">\mathcal{P_{I}}_{n},\mathcal{P_{T}}_{n},\mathcal{P_{F}}_{n}</annotation></semantics></math> according to Equation <a href="#S3.E1" title="Equation 1 ‣ 3.2 Constructing Prototype Library ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> <a href="#S3.E2" title="Equation 2 ‣ 3.2 Constructing Prototype Library ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> <a href="#S3.E3" title="Equation 3 ‣ 3.2 Constructing Prototype Library ‣ 3 Methodology ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>;
Return <math id="alg1.30.m2.4" class="ltx_Math" alttext="\omega^{t}_{n},\mathcal{P_{I}}_{n},\mathcal{P_{T}}_{n},\mathcal{P_{F}}_{n}" display="inline"><semantics id="alg1.30.m2.4a"><mrow id="alg1.30.m2.4.4.4" xref="alg1.30.m2.4.4.5.cmml"><msubsup id="alg1.30.m2.1.1.1.1" xref="alg1.30.m2.1.1.1.1.cmml"><mi id="alg1.30.m2.1.1.1.1.2.2" xref="alg1.30.m2.1.1.1.1.2.2.cmml">ω</mi><mi id="alg1.30.m2.1.1.1.1.3" xref="alg1.30.m2.1.1.1.1.3.cmml">n</mi><mi id="alg1.30.m2.1.1.1.1.2.3" xref="alg1.30.m2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.30.m2.4.4.4.5" xref="alg1.30.m2.4.4.5.cmml">,</mo><mmultiscripts id="alg1.30.m2.2.2.2.2" xref="alg1.30.m2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.30.m2.2.2.2.2.2.2" xref="alg1.30.m2.2.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.30.m2.2.2.2.2.2.3" xref="alg1.30.m2.2.2.2.2.2.3.cmml">ℐ</mi><mrow id="alg1.30.m2.2.2.2.2a" xref="alg1.30.m2.2.2.2.2.cmml"></mrow><mi id="alg1.30.m2.2.2.2.2.3" xref="alg1.30.m2.2.2.2.2.3.cmml">n</mi><mrow id="alg1.30.m2.2.2.2.2b" xref="alg1.30.m2.2.2.2.2.cmml"></mrow></mmultiscripts><mo id="alg1.30.m2.4.4.4.6" xref="alg1.30.m2.4.4.5.cmml">,</mo><mmultiscripts id="alg1.30.m2.3.3.3.3" xref="alg1.30.m2.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.30.m2.3.3.3.3.2.2" xref="alg1.30.m2.3.3.3.3.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.30.m2.3.3.3.3.2.3" xref="alg1.30.m2.3.3.3.3.2.3.cmml">𝒯</mi><mrow id="alg1.30.m2.3.3.3.3a" xref="alg1.30.m2.3.3.3.3.cmml"></mrow><mi id="alg1.30.m2.3.3.3.3.3" xref="alg1.30.m2.3.3.3.3.3.cmml">n</mi><mrow id="alg1.30.m2.3.3.3.3b" xref="alg1.30.m2.3.3.3.3.cmml"></mrow></mmultiscripts><mo id="alg1.30.m2.4.4.4.7" xref="alg1.30.m2.4.4.5.cmml">,</mo><mmultiscripts id="alg1.30.m2.4.4.4.4" xref="alg1.30.m2.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.30.m2.4.4.4.4.2.2" xref="alg1.30.m2.4.4.4.4.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg1.30.m2.4.4.4.4.2.3" xref="alg1.30.m2.4.4.4.4.2.3.cmml">ℱ</mi><mrow id="alg1.30.m2.4.4.4.4a" xref="alg1.30.m2.4.4.4.4.cmml"></mrow><mi id="alg1.30.m2.4.4.4.4.3" xref="alg1.30.m2.4.4.4.4.3.cmml">n</mi><mrow id="alg1.30.m2.4.4.4.4b" xref="alg1.30.m2.4.4.4.4.cmml"></mrow></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="alg1.30.m2.4b"><list id="alg1.30.m2.4.4.5.cmml" xref="alg1.30.m2.4.4.4"><apply id="alg1.30.m2.1.1.1.1.cmml" xref="alg1.30.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.30.m2.1.1.1.1.1.cmml" xref="alg1.30.m2.1.1.1.1">subscript</csymbol><apply id="alg1.30.m2.1.1.1.1.2.cmml" xref="alg1.30.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.30.m2.1.1.1.1.2.1.cmml" xref="alg1.30.m2.1.1.1.1">superscript</csymbol><ci id="alg1.30.m2.1.1.1.1.2.2.cmml" xref="alg1.30.m2.1.1.1.1.2.2">𝜔</ci><ci id="alg1.30.m2.1.1.1.1.2.3.cmml" xref="alg1.30.m2.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.30.m2.1.1.1.1.3.cmml" xref="alg1.30.m2.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.30.m2.2.2.2.2.cmml" xref="alg1.30.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.30.m2.2.2.2.2.1.cmml" xref="alg1.30.m2.2.2.2.2">subscript</csymbol><apply id="alg1.30.m2.2.2.2.2.2.cmml" xref="alg1.30.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.30.m2.2.2.2.2.2.1.cmml" xref="alg1.30.m2.2.2.2.2">subscript</csymbol><ci id="alg1.30.m2.2.2.2.2.2.2.cmml" xref="alg1.30.m2.2.2.2.2.2.2">𝒫</ci><ci id="alg1.30.m2.2.2.2.2.2.3.cmml" xref="alg1.30.m2.2.2.2.2.2.3">ℐ</ci></apply><ci id="alg1.30.m2.2.2.2.2.3.cmml" xref="alg1.30.m2.2.2.2.2.3">𝑛</ci></apply><apply id="alg1.30.m2.3.3.3.3.cmml" xref="alg1.30.m2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.30.m2.3.3.3.3.1.cmml" xref="alg1.30.m2.3.3.3.3">subscript</csymbol><apply id="alg1.30.m2.3.3.3.3.2.cmml" xref="alg1.30.m2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.30.m2.3.3.3.3.2.1.cmml" xref="alg1.30.m2.3.3.3.3">subscript</csymbol><ci id="alg1.30.m2.3.3.3.3.2.2.cmml" xref="alg1.30.m2.3.3.3.3.2.2">𝒫</ci><ci id="alg1.30.m2.3.3.3.3.2.3.cmml" xref="alg1.30.m2.3.3.3.3.2.3">𝒯</ci></apply><ci id="alg1.30.m2.3.3.3.3.3.cmml" xref="alg1.30.m2.3.3.3.3.3">𝑛</ci></apply><apply id="alg1.30.m2.4.4.4.4.cmml" xref="alg1.30.m2.4.4.4.4"><csymbol cd="ambiguous" id="alg1.30.m2.4.4.4.4.1.cmml" xref="alg1.30.m2.4.4.4.4">subscript</csymbol><apply id="alg1.30.m2.4.4.4.4.2.cmml" xref="alg1.30.m2.4.4.4.4"><csymbol cd="ambiguous" id="alg1.30.m2.4.4.4.4.2.1.cmml" xref="alg1.30.m2.4.4.4.4">subscript</csymbol><ci id="alg1.30.m2.4.4.4.4.2.2.cmml" xref="alg1.30.m2.4.4.4.4.2.2">𝒫</ci><ci id="alg1.30.m2.4.4.4.4.2.3.cmml" xref="alg1.30.m2.4.4.4.4.2.3">ℱ</ci></apply><ci id="alg1.30.m2.4.4.4.4.3.cmml" xref="alg1.30.m2.4.4.4.4.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.30.m2.4c">\omega^{t}_{n},\mathcal{P_{I}}_{n},\mathcal{P_{T}}_{n},\mathcal{P_{F}}_{n}</annotation></semantics></math>;

</div>
</div>
</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.18.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Inference of PmcmFL.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.1" class="ltx_p ltx_figure_panel"><span id="alg2.1.1" class="ltx_text"><span id="alg2.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>
Server model <math id="alg2.1.m1.3" class="ltx_Math" alttext="(\mathcal{E},\mathcal{F},\mathcal{G})" display="inline"><semantics id="alg2.1.m1.3a"><mrow id="alg2.1.m1.3.4.2" xref="alg2.1.m1.3.4.1.cmml"><mo stretchy="false" id="alg2.1.m1.3.4.2.1" xref="alg2.1.m1.3.4.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.1.m1.1.1" xref="alg2.1.m1.1.1.cmml">ℰ</mi><mo id="alg2.1.m1.3.4.2.2" xref="alg2.1.m1.3.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg2.1.m1.2.2" xref="alg2.1.m1.2.2.cmml">ℱ</mi><mo id="alg2.1.m1.3.4.2.3" xref="alg2.1.m1.3.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg2.1.m1.3.3" xref="alg2.1.m1.3.3.cmml">𝒢</mi><mo stretchy="false" id="alg2.1.m1.3.4.2.4" xref="alg2.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.1.m1.3b"><vector id="alg2.1.m1.3.4.1.cmml" xref="alg2.1.m1.3.4.2"><ci id="alg2.1.m1.1.1.cmml" xref="alg2.1.m1.1.1">ℰ</ci><ci id="alg2.1.m1.2.2.cmml" xref="alg2.1.m1.2.2">ℱ</ci><ci id="alg2.1.m1.3.3.cmml" xref="alg2.1.m1.3.3">𝒢</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.m1.3c">(\mathcal{E},\mathcal{F},\mathcal{G})</annotation></semantics></math>,
Testing set.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.19" class="ltx_p ltx_figure_panel"><span id="alg2.19.1" class="ltx_text"><span id="alg2.19.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Labels for classification tasks</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.2" class="ltx_p ltx_figure_panel"><span id="alg2.2.2" class="ltx_text ltx_font_bold">if</span> <em id="alg2.2.1" class="ltx_emph">input is an image-text pair <math id="alg2.2.1.1.m1.2" class="ltx_Math" alttext="(i,t)" display="inline"><semantics id="alg2.2.1.1.m1.2a"><mrow id="alg2.2.1.1.m1.2.3.2" xref="alg2.2.1.1.m1.2.3.1.cmml"><mo stretchy="false" id="alg2.2.1.1.m1.2.3.2.1" xref="alg2.2.1.1.m1.2.3.1.cmml">(</mo><mi id="alg2.2.1.1.m1.1.1" xref="alg2.2.1.1.m1.1.1.cmml">i</mi><mo id="alg2.2.1.1.m1.2.3.2.2" xref="alg2.2.1.1.m1.2.3.1.cmml">,</mo><mi id="alg2.2.1.1.m1.2.2" xref="alg2.2.1.1.m1.2.2.cmml">t</mi><mo stretchy="false" id="alg2.2.1.1.m1.2.3.2.3" xref="alg2.2.1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.1.1.m1.2b"><interval closure="open" id="alg2.2.1.1.m1.2.3.1.cmml" xref="alg2.2.1.1.m1.2.3.2"><ci id="alg2.2.1.1.m1.1.1.cmml" xref="alg2.2.1.1.m1.1.1">𝑖</ci><ci id="alg2.2.1.1.m1.2.2.cmml" xref="alg2.2.1.1.m1.2.2">𝑡</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.1.1.m1.2c">(i,t)</annotation></semantics></math></em> <span id="alg2.2.3" class="ltx_text ltx_font_bold">then</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg2.20" class="ltx_block ltx_figure_panel">
<div id="alg2.3" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
  Compute <math id="alg2.3.m1.3" class="ltx_Math" alttext="logits=\mathcal{G(F(E}(i,t)))" display="inline"><semantics id="alg2.3.m1.3a"><mrow id="alg2.3.m1.3.3" xref="alg2.3.m1.3.3.cmml"><mrow id="alg2.3.m1.3.3.3" xref="alg2.3.m1.3.3.3.cmml"><mi id="alg2.3.m1.3.3.3.2" xref="alg2.3.m1.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.3.m1.3.3.3.1" xref="alg2.3.m1.3.3.3.1.cmml">​</mo><mi id="alg2.3.m1.3.3.3.3" xref="alg2.3.m1.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.3.m1.3.3.3.1a" xref="alg2.3.m1.3.3.3.1.cmml">​</mo><mi id="alg2.3.m1.3.3.3.4" xref="alg2.3.m1.3.3.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.3.m1.3.3.3.1b" xref="alg2.3.m1.3.3.3.1.cmml">​</mo><mi id="alg2.3.m1.3.3.3.5" xref="alg2.3.m1.3.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.3.m1.3.3.3.1c" xref="alg2.3.m1.3.3.3.1.cmml">​</mo><mi id="alg2.3.m1.3.3.3.6" xref="alg2.3.m1.3.3.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.3.m1.3.3.3.1d" xref="alg2.3.m1.3.3.3.1.cmml">​</mo><mi id="alg2.3.m1.3.3.3.7" xref="alg2.3.m1.3.3.3.7.cmml">s</mi></mrow><mo id="alg2.3.m1.3.3.2" xref="alg2.3.m1.3.3.2.cmml">=</mo><mrow id="alg2.3.m1.3.3.1" xref="alg2.3.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.3.m1.3.3.1.3" xref="alg2.3.m1.3.3.1.3.cmml">𝒢</mi><mo lspace="0em" rspace="0em" id="alg2.3.m1.3.3.1.2" xref="alg2.3.m1.3.3.1.2.cmml">​</mo><mrow id="alg2.3.m1.3.3.1.1.1" xref="alg2.3.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="alg2.3.m1.3.3.1.1.1.2" xref="alg2.3.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="alg2.3.m1.3.3.1.1.1.1" xref="alg2.3.m1.3.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.3.m1.3.3.1.1.1.1.3" xref="alg2.3.m1.3.3.1.1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="alg2.3.m1.3.3.1.1.1.1.2" xref="alg2.3.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="alg2.3.m1.3.3.1.1.1.1.1.1" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.3.m1.3.3.1.1.1.1.1.1.2" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.3.m1.3.3.1.1.1.1.1.1.1" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.3.m1.3.3.1.1.1.1.1.1.1.2" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.2.cmml">ℰ</mi><mo lspace="0em" rspace="0em" id="alg2.3.m1.3.3.1.1.1.1.1.1.1.1" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.2" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="alg2.3.m1.1.1" xref="alg2.3.m1.1.1.cmml">i</mi><mo id="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="alg2.3.m1.2.2" xref="alg2.3.m1.2.2.cmml">t</mi><mo stretchy="false" id="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.3.m1.3.3.1.1.1.1.1.1.3" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.3.m1.3.3.1.1.1.3" xref="alg2.3.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.3.m1.3b"><apply id="alg2.3.m1.3.3.cmml" xref="alg2.3.m1.3.3"><eq id="alg2.3.m1.3.3.2.cmml" xref="alg2.3.m1.3.3.2"></eq><apply id="alg2.3.m1.3.3.3.cmml" xref="alg2.3.m1.3.3.3"><times id="alg2.3.m1.3.3.3.1.cmml" xref="alg2.3.m1.3.3.3.1"></times><ci id="alg2.3.m1.3.3.3.2.cmml" xref="alg2.3.m1.3.3.3.2">𝑙</ci><ci id="alg2.3.m1.3.3.3.3.cmml" xref="alg2.3.m1.3.3.3.3">𝑜</ci><ci id="alg2.3.m1.3.3.3.4.cmml" xref="alg2.3.m1.3.3.3.4">𝑔</ci><ci id="alg2.3.m1.3.3.3.5.cmml" xref="alg2.3.m1.3.3.3.5">𝑖</ci><ci id="alg2.3.m1.3.3.3.6.cmml" xref="alg2.3.m1.3.3.3.6">𝑡</ci><ci id="alg2.3.m1.3.3.3.7.cmml" xref="alg2.3.m1.3.3.3.7">𝑠</ci></apply><apply id="alg2.3.m1.3.3.1.cmml" xref="alg2.3.m1.3.3.1"><times id="alg2.3.m1.3.3.1.2.cmml" xref="alg2.3.m1.3.3.1.2"></times><ci id="alg2.3.m1.3.3.1.3.cmml" xref="alg2.3.m1.3.3.1.3">𝒢</ci><apply id="alg2.3.m1.3.3.1.1.1.1.cmml" xref="alg2.3.m1.3.3.1.1.1"><times id="alg2.3.m1.3.3.1.1.1.1.2.cmml" xref="alg2.3.m1.3.3.1.1.1.1.2"></times><ci id="alg2.3.m1.3.3.1.1.1.1.3.cmml" xref="alg2.3.m1.3.3.1.1.1.1.3">ℱ</ci><apply id="alg2.3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.3.m1.3.3.1.1.1.1.1.1"><times id="alg2.3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.1"></times><ci id="alg2.3.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.2">ℰ</ci><interval closure="open" id="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.3.m1.3.3.1.1.1.1.1.1.1.3.2"><ci id="alg2.3.m1.1.1.cmml" xref="alg2.3.m1.1.1">𝑖</ci><ci id="alg2.3.m1.2.2.cmml" xref="alg2.3.m1.2.2">𝑡</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.m1.3c">logits=\mathcal{G(F(E}(i,t)))</annotation></semantics></math>

</div>
<div id="alg2.4" class="ltx_listingline">
<span id="alg2.4.2" class="ltx_text ltx_font_bold">else if</span> <em id="alg2.4.1" class="ltx_emph">input is an image <math id="alg2.4.1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.4.1.1.m1.1a"><mi id="alg2.4.1.1.m1.1.1" xref="alg2.4.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.4.1.1.m1.1b"><ci id="alg2.4.1.1.m1.1.1.cmml" xref="alg2.4.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.1.1.m1.1c">i</annotation></semantics></math></em> <span id="alg2.4.3" class="ltx_text ltx_font_bold">then</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg2.21" class="ltx_block ltx_figure_panel">
<div id="alg2.9" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
  Compute the image representation <math id="alg2.5.m1.2" class="ltx_Math" alttext="h^{(i)}=\mathcal{E}(i)" display="inline"><semantics id="alg2.5.m1.2a"><mrow id="alg2.5.m1.2.3" xref="alg2.5.m1.2.3.cmml"><msup id="alg2.5.m1.2.3.2" xref="alg2.5.m1.2.3.2.cmml"><mi id="alg2.5.m1.2.3.2.2" xref="alg2.5.m1.2.3.2.2.cmml">h</mi><mrow id="alg2.5.m1.1.1.1.3" xref="alg2.5.m1.2.3.2.cmml"><mo stretchy="false" id="alg2.5.m1.1.1.1.3.1" xref="alg2.5.m1.2.3.2.cmml">(</mo><mi id="alg2.5.m1.1.1.1.1" xref="alg2.5.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg2.5.m1.1.1.1.3.2" xref="alg2.5.m1.2.3.2.cmml">)</mo></mrow></msup><mo id="alg2.5.m1.2.3.1" xref="alg2.5.m1.2.3.1.cmml">=</mo><mrow id="alg2.5.m1.2.3.3" xref="alg2.5.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.5.m1.2.3.3.2" xref="alg2.5.m1.2.3.3.2.cmml">ℰ</mi><mo lspace="0em" rspace="0em" id="alg2.5.m1.2.3.3.1" xref="alg2.5.m1.2.3.3.1.cmml">​</mo><mrow id="alg2.5.m1.2.3.3.3.2" xref="alg2.5.m1.2.3.3.cmml"><mo stretchy="false" id="alg2.5.m1.2.3.3.3.2.1" xref="alg2.5.m1.2.3.3.cmml">(</mo><mi id="alg2.5.m1.2.2" xref="alg2.5.m1.2.2.cmml">i</mi><mo stretchy="false" id="alg2.5.m1.2.3.3.3.2.2" xref="alg2.5.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.m1.2b"><apply id="alg2.5.m1.2.3.cmml" xref="alg2.5.m1.2.3"><eq id="alg2.5.m1.2.3.1.cmml" xref="alg2.5.m1.2.3.1"></eq><apply id="alg2.5.m1.2.3.2.cmml" xref="alg2.5.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.5.m1.2.3.2.1.cmml" xref="alg2.5.m1.2.3.2">superscript</csymbol><ci id="alg2.5.m1.2.3.2.2.cmml" xref="alg2.5.m1.2.3.2.2">ℎ</ci><ci id="alg2.5.m1.1.1.1.1.cmml" xref="alg2.5.m1.1.1.1.1">𝑖</ci></apply><apply id="alg2.5.m1.2.3.3.cmml" xref="alg2.5.m1.2.3.3"><times id="alg2.5.m1.2.3.3.1.cmml" xref="alg2.5.m1.2.3.3.1"></times><ci id="alg2.5.m1.2.3.3.2.cmml" xref="alg2.5.m1.2.3.3.2">ℰ</ci><ci id="alg2.5.m1.2.2.cmml" xref="alg2.5.m1.2.2">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.m1.2c">h^{(i)}=\mathcal{E}(i)</annotation></semantics></math>; 
<br class="ltx_break">Search for the corresponding image prototype <math id="alg2.6.m2.1" class="ltx_Math" alttext="\mathcal{P_{I}}^{j}" display="inline"><semantics id="alg2.6.m2.1a"><mmultiscripts id="alg2.6.m2.1.1" xref="alg2.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.6.m2.1.1.2.2" xref="alg2.6.m2.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg2.6.m2.1.1.2.3" xref="alg2.6.m2.1.1.2.3.cmml">ℐ</mi><mrow id="alg2.6.m2.1.1a" xref="alg2.6.m2.1.1.cmml"></mrow><mrow id="alg2.6.m2.1.1b" xref="alg2.6.m2.1.1.cmml"></mrow><mi id="alg2.6.m2.1.1.3" xref="alg2.6.m2.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg2.6.m2.1b"><apply id="alg2.6.m2.1.1.cmml" xref="alg2.6.m2.1.1"><csymbol cd="ambiguous" id="alg2.6.m2.1.1.1.cmml" xref="alg2.6.m2.1.1">superscript</csymbol><apply id="alg2.6.m2.1.1.2.cmml" xref="alg2.6.m2.1.1"><csymbol cd="ambiguous" id="alg2.6.m2.1.1.2.1.cmml" xref="alg2.6.m2.1.1">subscript</csymbol><ci id="alg2.6.m2.1.1.2.2.cmml" xref="alg2.6.m2.1.1.2.2">𝒫</ci><ci id="alg2.6.m2.1.1.2.3.cmml" xref="alg2.6.m2.1.1.2.3">ℐ</ci></apply><ci id="alg2.6.m2.1.1.3.cmml" xref="alg2.6.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.m2.1c">\mathcal{P_{I}}^{j}</annotation></semantics></math> using matching function <math id="alg2.7.m3.2" class="ltx_Math" alttext="m(h^{(i)})" display="inline"><semantics id="alg2.7.m3.2a"><mrow id="alg2.7.m3.2.2" xref="alg2.7.m3.2.2.cmml"><mi id="alg2.7.m3.2.2.3" xref="alg2.7.m3.2.2.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.7.m3.2.2.2" xref="alg2.7.m3.2.2.2.cmml">​</mo><mrow id="alg2.7.m3.2.2.1.1" xref="alg2.7.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="alg2.7.m3.2.2.1.1.2" xref="alg2.7.m3.2.2.1.1.1.cmml">(</mo><msup id="alg2.7.m3.2.2.1.1.1" xref="alg2.7.m3.2.2.1.1.1.cmml"><mi id="alg2.7.m3.2.2.1.1.1.2" xref="alg2.7.m3.2.2.1.1.1.2.cmml">h</mi><mrow id="alg2.7.m3.1.1.1.3" xref="alg2.7.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="alg2.7.m3.1.1.1.3.1" xref="alg2.7.m3.2.2.1.1.1.cmml">(</mo><mi id="alg2.7.m3.1.1.1.1" xref="alg2.7.m3.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg2.7.m3.1.1.1.3.2" xref="alg2.7.m3.2.2.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg2.7.m3.2.2.1.1.3" xref="alg2.7.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.7.m3.2b"><apply id="alg2.7.m3.2.2.cmml" xref="alg2.7.m3.2.2"><times id="alg2.7.m3.2.2.2.cmml" xref="alg2.7.m3.2.2.2"></times><ci id="alg2.7.m3.2.2.3.cmml" xref="alg2.7.m3.2.2.3">𝑚</ci><apply id="alg2.7.m3.2.2.1.1.1.cmml" xref="alg2.7.m3.2.2.1.1"><csymbol cd="ambiguous" id="alg2.7.m3.2.2.1.1.1.1.cmml" xref="alg2.7.m3.2.2.1.1">superscript</csymbol><ci id="alg2.7.m3.2.2.1.1.1.2.cmml" xref="alg2.7.m3.2.2.1.1.1.2">ℎ</ci><ci id="alg2.7.m3.1.1.1.1.cmml" xref="alg2.7.m3.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.m3.2c">m(h^{(i)})</annotation></semantics></math>; 
<br class="ltx_break">Find the corresponding text prototype <math id="alg2.8.m4.1" class="ltx_Math" alttext="\mathcal{P_{T}}^{j}" display="inline"><semantics id="alg2.8.m4.1a"><mmultiscripts id="alg2.8.m4.1.1" xref="alg2.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.8.m4.1.1.2.2" xref="alg2.8.m4.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg2.8.m4.1.1.2.3" xref="alg2.8.m4.1.1.2.3.cmml">𝒯</mi><mrow id="alg2.8.m4.1.1a" xref="alg2.8.m4.1.1.cmml"></mrow><mrow id="alg2.8.m4.1.1b" xref="alg2.8.m4.1.1.cmml"></mrow><mi id="alg2.8.m4.1.1.3" xref="alg2.8.m4.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg2.8.m4.1b"><apply id="alg2.8.m4.1.1.cmml" xref="alg2.8.m4.1.1"><csymbol cd="ambiguous" id="alg2.8.m4.1.1.1.cmml" xref="alg2.8.m4.1.1">superscript</csymbol><apply id="alg2.8.m4.1.1.2.cmml" xref="alg2.8.m4.1.1"><csymbol cd="ambiguous" id="alg2.8.m4.1.1.2.1.cmml" xref="alg2.8.m4.1.1">subscript</csymbol><ci id="alg2.8.m4.1.1.2.2.cmml" xref="alg2.8.m4.1.1.2.2">𝒫</ci><ci id="alg2.8.m4.1.1.2.3.cmml" xref="alg2.8.m4.1.1.2.3">𝒯</ci></apply><ci id="alg2.8.m4.1.1.3.cmml" xref="alg2.8.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.m4.1c">\mathcal{P_{T}}^{j}</annotation></semantics></math> through the association in the prototype library; 
<br class="ltx_break">Compute <math id="alg2.9.m5.2" class="ltx_Math" alttext="logits=\mathcal{G(F(}h^{(i)},\mathcal{P_{T}}^{j}))" display="inline"><semantics id="alg2.9.m5.2a"><mrow id="alg2.9.m5.2.2" xref="alg2.9.m5.2.2.cmml"><mrow id="alg2.9.m5.2.2.3" xref="alg2.9.m5.2.2.3.cmml"><mi id="alg2.9.m5.2.2.3.2" xref="alg2.9.m5.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.9.m5.2.2.3.1" xref="alg2.9.m5.2.2.3.1.cmml">​</mo><mi id="alg2.9.m5.2.2.3.3" xref="alg2.9.m5.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.9.m5.2.2.3.1a" xref="alg2.9.m5.2.2.3.1.cmml">​</mo><mi id="alg2.9.m5.2.2.3.4" xref="alg2.9.m5.2.2.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.9.m5.2.2.3.1b" xref="alg2.9.m5.2.2.3.1.cmml">​</mo><mi id="alg2.9.m5.2.2.3.5" xref="alg2.9.m5.2.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.9.m5.2.2.3.1c" xref="alg2.9.m5.2.2.3.1.cmml">​</mo><mi id="alg2.9.m5.2.2.3.6" xref="alg2.9.m5.2.2.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.9.m5.2.2.3.1d" xref="alg2.9.m5.2.2.3.1.cmml">​</mo><mi id="alg2.9.m5.2.2.3.7" xref="alg2.9.m5.2.2.3.7.cmml">s</mi></mrow><mo id="alg2.9.m5.2.2.2" xref="alg2.9.m5.2.2.2.cmml">=</mo><mrow id="alg2.9.m5.2.2.1" xref="alg2.9.m5.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.9.m5.2.2.1.3" xref="alg2.9.m5.2.2.1.3.cmml">𝒢</mi><mo lspace="0em" rspace="0em" id="alg2.9.m5.2.2.1.2" xref="alg2.9.m5.2.2.1.2.cmml">​</mo><mrow id="alg2.9.m5.2.2.1.1.1" xref="alg2.9.m5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg2.9.m5.2.2.1.1.1.2" xref="alg2.9.m5.2.2.1.1.1.1.cmml">(</mo><mrow id="alg2.9.m5.2.2.1.1.1.1" xref="alg2.9.m5.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.9.m5.2.2.1.1.1.1.4" xref="alg2.9.m5.2.2.1.1.1.1.4.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="alg2.9.m5.2.2.1.1.1.1.3" xref="alg2.9.m5.2.2.1.1.1.1.3.cmml">​</mo><mrow id="alg2.9.m5.2.2.1.1.1.1.2.2" xref="alg2.9.m5.2.2.1.1.1.1.2.3.cmml"><mo stretchy="false" id="alg2.9.m5.2.2.1.1.1.1.2.2.3" xref="alg2.9.m5.2.2.1.1.1.1.2.3.cmml">(</mo><msup id="alg2.9.m5.2.2.1.1.1.1.1.1.1" xref="alg2.9.m5.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg2.9.m5.2.2.1.1.1.1.1.1.1.2" xref="alg2.9.m5.2.2.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="alg2.9.m5.1.1.1.3" xref="alg2.9.m5.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.9.m5.1.1.1.3.1" xref="alg2.9.m5.2.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="alg2.9.m5.1.1.1.1" xref="alg2.9.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg2.9.m5.1.1.1.3.2" xref="alg2.9.m5.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="alg2.9.m5.2.2.1.1.1.1.2.2.4" xref="alg2.9.m5.2.2.1.1.1.1.2.3.cmml">,</mo><mmultiscripts id="alg2.9.m5.2.2.1.1.1.1.2.2.2" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.2" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.3" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.3.cmml">𝒯</mi><mrow id="alg2.9.m5.2.2.1.1.1.1.2.2.2a" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.cmml"></mrow><mrow id="alg2.9.m5.2.2.1.1.1.1.2.2.2b" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.cmml"></mrow><mi id="alg2.9.m5.2.2.1.1.1.1.2.2.2.3" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.3.cmml">j</mi></mmultiscripts><mo stretchy="false" id="alg2.9.m5.2.2.1.1.1.1.2.2.5" xref="alg2.9.m5.2.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.9.m5.2.2.1.1.1.3" xref="alg2.9.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.m5.2b"><apply id="alg2.9.m5.2.2.cmml" xref="alg2.9.m5.2.2"><eq id="alg2.9.m5.2.2.2.cmml" xref="alg2.9.m5.2.2.2"></eq><apply id="alg2.9.m5.2.2.3.cmml" xref="alg2.9.m5.2.2.3"><times id="alg2.9.m5.2.2.3.1.cmml" xref="alg2.9.m5.2.2.3.1"></times><ci id="alg2.9.m5.2.2.3.2.cmml" xref="alg2.9.m5.2.2.3.2">𝑙</ci><ci id="alg2.9.m5.2.2.3.3.cmml" xref="alg2.9.m5.2.2.3.3">𝑜</ci><ci id="alg2.9.m5.2.2.3.4.cmml" xref="alg2.9.m5.2.2.3.4">𝑔</ci><ci id="alg2.9.m5.2.2.3.5.cmml" xref="alg2.9.m5.2.2.3.5">𝑖</ci><ci id="alg2.9.m5.2.2.3.6.cmml" xref="alg2.9.m5.2.2.3.6">𝑡</ci><ci id="alg2.9.m5.2.2.3.7.cmml" xref="alg2.9.m5.2.2.3.7">𝑠</ci></apply><apply id="alg2.9.m5.2.2.1.cmml" xref="alg2.9.m5.2.2.1"><times id="alg2.9.m5.2.2.1.2.cmml" xref="alg2.9.m5.2.2.1.2"></times><ci id="alg2.9.m5.2.2.1.3.cmml" xref="alg2.9.m5.2.2.1.3">𝒢</ci><apply id="alg2.9.m5.2.2.1.1.1.1.cmml" xref="alg2.9.m5.2.2.1.1.1"><times id="alg2.9.m5.2.2.1.1.1.1.3.cmml" xref="alg2.9.m5.2.2.1.1.1.1.3"></times><ci id="alg2.9.m5.2.2.1.1.1.1.4.cmml" xref="alg2.9.m5.2.2.1.1.1.1.4">ℱ</ci><interval closure="open" id="alg2.9.m5.2.2.1.1.1.1.2.3.cmml" xref="alg2.9.m5.2.2.1.1.1.1.2.2"><apply id="alg2.9.m5.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.9.m5.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.9.m5.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.9.m5.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.9.m5.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.9.m5.2.2.1.1.1.1.1.1.1.2">ℎ</ci><ci id="alg2.9.m5.1.1.1.1.cmml" xref="alg2.9.m5.1.1.1.1">𝑖</ci></apply><apply id="alg2.9.m5.2.2.1.1.1.1.2.2.2.cmml" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.9.m5.2.2.1.1.1.1.2.2.2.1.cmml" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.cmml" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.2">𝒫</ci><ci id="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.2.3">𝒯</ci></apply><ci id="alg2.9.m5.2.2.1.1.1.1.2.2.2.3.cmml" xref="alg2.9.m5.2.2.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.m5.2c">logits=\mathcal{G(F(}h^{(i)},\mathcal{P_{T}}^{j}))</annotation></semantics></math>;

</div>
<div id="alg2.10" class="ltx_listingline">
<span id="alg2.10.2" class="ltx_text ltx_font_bold">else if</span> <em id="alg2.10.1" class="ltx_emph">input is text <math id="alg2.10.1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg2.10.1.1.m1.1a"><mi id="alg2.10.1.1.m1.1.1" xref="alg2.10.1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg2.10.1.1.m1.1b"><ci id="alg2.10.1.1.m1.1.1.cmml" xref="alg2.10.1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.1.1.m1.1c">t</annotation></semantics></math></em> <span id="alg2.10.3" class="ltx_text ltx_font_bold">then</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="alg2.22" class="ltx_block ltx_figure_panel">
<div id="alg2.15" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
  Compute the text representation <math id="alg2.11.m1.2" class="ltx_Math" alttext="h^{(t)}=\mathcal{E}(t)" display="inline"><semantics id="alg2.11.m1.2a"><mrow id="alg2.11.m1.2.3" xref="alg2.11.m1.2.3.cmml"><msup id="alg2.11.m1.2.3.2" xref="alg2.11.m1.2.3.2.cmml"><mi id="alg2.11.m1.2.3.2.2" xref="alg2.11.m1.2.3.2.2.cmml">h</mi><mrow id="alg2.11.m1.1.1.1.3" xref="alg2.11.m1.2.3.2.cmml"><mo stretchy="false" id="alg2.11.m1.1.1.1.3.1" xref="alg2.11.m1.2.3.2.cmml">(</mo><mi id="alg2.11.m1.1.1.1.1" xref="alg2.11.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.11.m1.1.1.1.3.2" xref="alg2.11.m1.2.3.2.cmml">)</mo></mrow></msup><mo id="alg2.11.m1.2.3.1" xref="alg2.11.m1.2.3.1.cmml">=</mo><mrow id="alg2.11.m1.2.3.3" xref="alg2.11.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.11.m1.2.3.3.2" xref="alg2.11.m1.2.3.3.2.cmml">ℰ</mi><mo lspace="0em" rspace="0em" id="alg2.11.m1.2.3.3.1" xref="alg2.11.m1.2.3.3.1.cmml">​</mo><mrow id="alg2.11.m1.2.3.3.3.2" xref="alg2.11.m1.2.3.3.cmml"><mo stretchy="false" id="alg2.11.m1.2.3.3.3.2.1" xref="alg2.11.m1.2.3.3.cmml">(</mo><mi id="alg2.11.m1.2.2" xref="alg2.11.m1.2.2.cmml">t</mi><mo stretchy="false" id="alg2.11.m1.2.3.3.3.2.2" xref="alg2.11.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.m1.2b"><apply id="alg2.11.m1.2.3.cmml" xref="alg2.11.m1.2.3"><eq id="alg2.11.m1.2.3.1.cmml" xref="alg2.11.m1.2.3.1"></eq><apply id="alg2.11.m1.2.3.2.cmml" xref="alg2.11.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.11.m1.2.3.2.1.cmml" xref="alg2.11.m1.2.3.2">superscript</csymbol><ci id="alg2.11.m1.2.3.2.2.cmml" xref="alg2.11.m1.2.3.2.2">ℎ</ci><ci id="alg2.11.m1.1.1.1.1.cmml" xref="alg2.11.m1.1.1.1.1">𝑡</ci></apply><apply id="alg2.11.m1.2.3.3.cmml" xref="alg2.11.m1.2.3.3"><times id="alg2.11.m1.2.3.3.1.cmml" xref="alg2.11.m1.2.3.3.1"></times><ci id="alg2.11.m1.2.3.3.2.cmml" xref="alg2.11.m1.2.3.3.2">ℰ</ci><ci id="alg2.11.m1.2.2.cmml" xref="alg2.11.m1.2.2">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.m1.2c">h^{(t)}=\mathcal{E}(t)</annotation></semantics></math>; 
<br class="ltx_break">Search for the corresponding text prototype <math id="alg2.12.m2.1" class="ltx_Math" alttext="\mathcal{P_{T}}^{j}" display="inline"><semantics id="alg2.12.m2.1a"><mmultiscripts id="alg2.12.m2.1.1" xref="alg2.12.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.12.m2.1.1.2.2" xref="alg2.12.m2.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg2.12.m2.1.1.2.3" xref="alg2.12.m2.1.1.2.3.cmml">𝒯</mi><mrow id="alg2.12.m2.1.1a" xref="alg2.12.m2.1.1.cmml"></mrow><mrow id="alg2.12.m2.1.1b" xref="alg2.12.m2.1.1.cmml"></mrow><mi id="alg2.12.m2.1.1.3" xref="alg2.12.m2.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg2.12.m2.1b"><apply id="alg2.12.m2.1.1.cmml" xref="alg2.12.m2.1.1"><csymbol cd="ambiguous" id="alg2.12.m2.1.1.1.cmml" xref="alg2.12.m2.1.1">superscript</csymbol><apply id="alg2.12.m2.1.1.2.cmml" xref="alg2.12.m2.1.1"><csymbol cd="ambiguous" id="alg2.12.m2.1.1.2.1.cmml" xref="alg2.12.m2.1.1">subscript</csymbol><ci id="alg2.12.m2.1.1.2.2.cmml" xref="alg2.12.m2.1.1.2.2">𝒫</ci><ci id="alg2.12.m2.1.1.2.3.cmml" xref="alg2.12.m2.1.1.2.3">𝒯</ci></apply><ci id="alg2.12.m2.1.1.3.cmml" xref="alg2.12.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.m2.1c">\mathcal{P_{T}}^{j}</annotation></semantics></math> using matching function <math id="alg2.13.m3.2" class="ltx_Math" alttext="m(h^{(t)})" display="inline"><semantics id="alg2.13.m3.2a"><mrow id="alg2.13.m3.2.2" xref="alg2.13.m3.2.2.cmml"><mi id="alg2.13.m3.2.2.3" xref="alg2.13.m3.2.2.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.13.m3.2.2.2" xref="alg2.13.m3.2.2.2.cmml">​</mo><mrow id="alg2.13.m3.2.2.1.1" xref="alg2.13.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="alg2.13.m3.2.2.1.1.2" xref="alg2.13.m3.2.2.1.1.1.cmml">(</mo><msup id="alg2.13.m3.2.2.1.1.1" xref="alg2.13.m3.2.2.1.1.1.cmml"><mi id="alg2.13.m3.2.2.1.1.1.2" xref="alg2.13.m3.2.2.1.1.1.2.cmml">h</mi><mrow id="alg2.13.m3.1.1.1.3" xref="alg2.13.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="alg2.13.m3.1.1.1.3.1" xref="alg2.13.m3.2.2.1.1.1.cmml">(</mo><mi id="alg2.13.m3.1.1.1.1" xref="alg2.13.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.13.m3.1.1.1.3.2" xref="alg2.13.m3.2.2.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg2.13.m3.2.2.1.1.3" xref="alg2.13.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.13.m3.2b"><apply id="alg2.13.m3.2.2.cmml" xref="alg2.13.m3.2.2"><times id="alg2.13.m3.2.2.2.cmml" xref="alg2.13.m3.2.2.2"></times><ci id="alg2.13.m3.2.2.3.cmml" xref="alg2.13.m3.2.2.3">𝑚</ci><apply id="alg2.13.m3.2.2.1.1.1.cmml" xref="alg2.13.m3.2.2.1.1"><csymbol cd="ambiguous" id="alg2.13.m3.2.2.1.1.1.1.cmml" xref="alg2.13.m3.2.2.1.1">superscript</csymbol><ci id="alg2.13.m3.2.2.1.1.1.2.cmml" xref="alg2.13.m3.2.2.1.1.1.2">ℎ</ci><ci id="alg2.13.m3.1.1.1.1.cmml" xref="alg2.13.m3.1.1.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.m3.2c">m(h^{(t)})</annotation></semantics></math>; 
<br class="ltx_break">Find the corresponding text prototype <math id="alg2.14.m4.1" class="ltx_Math" alttext="\mathcal{P_{I}}^{j}" display="inline"><semantics id="alg2.14.m4.1a"><mmultiscripts id="alg2.14.m4.1.1" xref="alg2.14.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.14.m4.1.1.2.2" xref="alg2.14.m4.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg2.14.m4.1.1.2.3" xref="alg2.14.m4.1.1.2.3.cmml">ℐ</mi><mrow id="alg2.14.m4.1.1a" xref="alg2.14.m4.1.1.cmml"></mrow><mrow id="alg2.14.m4.1.1b" xref="alg2.14.m4.1.1.cmml"></mrow><mi id="alg2.14.m4.1.1.3" xref="alg2.14.m4.1.1.3.cmml">j</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg2.14.m4.1b"><apply id="alg2.14.m4.1.1.cmml" xref="alg2.14.m4.1.1"><csymbol cd="ambiguous" id="alg2.14.m4.1.1.1.cmml" xref="alg2.14.m4.1.1">superscript</csymbol><apply id="alg2.14.m4.1.1.2.cmml" xref="alg2.14.m4.1.1"><csymbol cd="ambiguous" id="alg2.14.m4.1.1.2.1.cmml" xref="alg2.14.m4.1.1">subscript</csymbol><ci id="alg2.14.m4.1.1.2.2.cmml" xref="alg2.14.m4.1.1.2.2">𝒫</ci><ci id="alg2.14.m4.1.1.2.3.cmml" xref="alg2.14.m4.1.1.2.3">ℐ</ci></apply><ci id="alg2.14.m4.1.1.3.cmml" xref="alg2.14.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.m4.1c">\mathcal{P_{I}}^{j}</annotation></semantics></math> through the association in the prototype library; 
<br class="ltx_break">Compute <math id="alg2.15.m5.2" class="ltx_Math" alttext="logits=\mathcal{G(F(}\mathcal{P_{I}}^{j},h^{(t)}))" display="inline"><semantics id="alg2.15.m5.2a"><mrow id="alg2.15.m5.2.2" xref="alg2.15.m5.2.2.cmml"><mrow id="alg2.15.m5.2.2.3" xref="alg2.15.m5.2.2.3.cmml"><mi id="alg2.15.m5.2.2.3.2" xref="alg2.15.m5.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.15.m5.2.2.3.1" xref="alg2.15.m5.2.2.3.1.cmml">​</mo><mi id="alg2.15.m5.2.2.3.3" xref="alg2.15.m5.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.15.m5.2.2.3.1a" xref="alg2.15.m5.2.2.3.1.cmml">​</mo><mi id="alg2.15.m5.2.2.3.4" xref="alg2.15.m5.2.2.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.15.m5.2.2.3.1b" xref="alg2.15.m5.2.2.3.1.cmml">​</mo><mi id="alg2.15.m5.2.2.3.5" xref="alg2.15.m5.2.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.15.m5.2.2.3.1c" xref="alg2.15.m5.2.2.3.1.cmml">​</mo><mi id="alg2.15.m5.2.2.3.6" xref="alg2.15.m5.2.2.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.15.m5.2.2.3.1d" xref="alg2.15.m5.2.2.3.1.cmml">​</mo><mi id="alg2.15.m5.2.2.3.7" xref="alg2.15.m5.2.2.3.7.cmml">s</mi></mrow><mo id="alg2.15.m5.2.2.2" xref="alg2.15.m5.2.2.2.cmml">=</mo><mrow id="alg2.15.m5.2.2.1" xref="alg2.15.m5.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.15.m5.2.2.1.3" xref="alg2.15.m5.2.2.1.3.cmml">𝒢</mi><mo lspace="0em" rspace="0em" id="alg2.15.m5.2.2.1.2" xref="alg2.15.m5.2.2.1.2.cmml">​</mo><mrow id="alg2.15.m5.2.2.1.1.1" xref="alg2.15.m5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg2.15.m5.2.2.1.1.1.2" xref="alg2.15.m5.2.2.1.1.1.1.cmml">(</mo><mrow id="alg2.15.m5.2.2.1.1.1.1" xref="alg2.15.m5.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.15.m5.2.2.1.1.1.1.4" xref="alg2.15.m5.2.2.1.1.1.1.4.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="alg2.15.m5.2.2.1.1.1.1.3" xref="alg2.15.m5.2.2.1.1.1.1.3.cmml">​</mo><mrow id="alg2.15.m5.2.2.1.1.1.1.2.2" xref="alg2.15.m5.2.2.1.1.1.1.2.3.cmml"><mo stretchy="false" id="alg2.15.m5.2.2.1.1.1.1.2.2.3" xref="alg2.15.m5.2.2.1.1.1.1.2.3.cmml">(</mo><mmultiscripts id="alg2.15.m5.2.2.1.1.1.1.1.1.1" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.2" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.2.cmml">𝒫</mi><mi class="ltx_font_mathcaligraphic" id="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.3" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.3.cmml">ℐ</mi><mrow id="alg2.15.m5.2.2.1.1.1.1.1.1.1a" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.cmml"></mrow><mrow id="alg2.15.m5.2.2.1.1.1.1.1.1.1b" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.cmml"></mrow><mi id="alg2.15.m5.2.2.1.1.1.1.1.1.1.3" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></mmultiscripts><mo id="alg2.15.m5.2.2.1.1.1.1.2.2.4" xref="alg2.15.m5.2.2.1.1.1.1.2.3.cmml">,</mo><msup id="alg2.15.m5.2.2.1.1.1.1.2.2.2" xref="alg2.15.m5.2.2.1.1.1.1.2.2.2.cmml"><mi id="alg2.15.m5.2.2.1.1.1.1.2.2.2.2" xref="alg2.15.m5.2.2.1.1.1.1.2.2.2.2.cmml">h</mi><mrow id="alg2.15.m5.1.1.1.3" xref="alg2.15.m5.2.2.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="alg2.15.m5.1.1.1.3.1" xref="alg2.15.m5.2.2.1.1.1.1.2.2.2.cmml">(</mo><mi id="alg2.15.m5.1.1.1.1" xref="alg2.15.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.15.m5.1.1.1.3.2" xref="alg2.15.m5.2.2.1.1.1.1.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg2.15.m5.2.2.1.1.1.1.2.2.5" xref="alg2.15.m5.2.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.15.m5.2.2.1.1.1.3" xref="alg2.15.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.15.m5.2b"><apply id="alg2.15.m5.2.2.cmml" xref="alg2.15.m5.2.2"><eq id="alg2.15.m5.2.2.2.cmml" xref="alg2.15.m5.2.2.2"></eq><apply id="alg2.15.m5.2.2.3.cmml" xref="alg2.15.m5.2.2.3"><times id="alg2.15.m5.2.2.3.1.cmml" xref="alg2.15.m5.2.2.3.1"></times><ci id="alg2.15.m5.2.2.3.2.cmml" xref="alg2.15.m5.2.2.3.2">𝑙</ci><ci id="alg2.15.m5.2.2.3.3.cmml" xref="alg2.15.m5.2.2.3.3">𝑜</ci><ci id="alg2.15.m5.2.2.3.4.cmml" xref="alg2.15.m5.2.2.3.4">𝑔</ci><ci id="alg2.15.m5.2.2.3.5.cmml" xref="alg2.15.m5.2.2.3.5">𝑖</ci><ci id="alg2.15.m5.2.2.3.6.cmml" xref="alg2.15.m5.2.2.3.6">𝑡</ci><ci id="alg2.15.m5.2.2.3.7.cmml" xref="alg2.15.m5.2.2.3.7">𝑠</ci></apply><apply id="alg2.15.m5.2.2.1.cmml" xref="alg2.15.m5.2.2.1"><times id="alg2.15.m5.2.2.1.2.cmml" xref="alg2.15.m5.2.2.1.2"></times><ci id="alg2.15.m5.2.2.1.3.cmml" xref="alg2.15.m5.2.2.1.3">𝒢</ci><apply id="alg2.15.m5.2.2.1.1.1.1.cmml" xref="alg2.15.m5.2.2.1.1.1"><times id="alg2.15.m5.2.2.1.1.1.1.3.cmml" xref="alg2.15.m5.2.2.1.1.1.1.3"></times><ci id="alg2.15.m5.2.2.1.1.1.1.4.cmml" xref="alg2.15.m5.2.2.1.1.1.1.4">ℱ</ci><interval closure="open" id="alg2.15.m5.2.2.1.1.1.1.2.3.cmml" xref="alg2.15.m5.2.2.1.1.1.1.2.2"><apply id="alg2.15.m5.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.15.m5.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.2">𝒫</ci><ci id="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.2.3">ℐ</ci></apply><ci id="alg2.15.m5.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.15.m5.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg2.15.m5.2.2.1.1.1.1.2.2.2.cmml" xref="alg2.15.m5.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.15.m5.2.2.1.1.1.1.2.2.2.1.cmml" xref="alg2.15.m5.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="alg2.15.m5.2.2.1.1.1.1.2.2.2.2.cmml" xref="alg2.15.m5.2.2.1.1.1.1.2.2.2.2">ℎ</ci><ci id="alg2.15.m5.1.1.1.1.cmml" xref="alg2.15.m5.1.1.1.1">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.m5.2c">logits=\mathcal{G(F(}\mathcal{P_{I}}^{j},h^{(t)}))</annotation></semantics></math>;

</div>
<div id="alg2.16" class="ltx_listingline">Calculate probability distribution and predict the label:
<math id="alg2.16.m1.1" class="ltx_Math" alttext="\hat{y}=\mathop{\textnormal{argmax}}\textnormal{Softmax}(logits)" display="inline"><semantics id="alg2.16.m1.1a"><mrow id="alg2.16.m1.1.1" xref="alg2.16.m1.1.1.cmml"><mover accent="true" id="alg2.16.m1.1.1.3" xref="alg2.16.m1.1.1.3.cmml"><mi id="alg2.16.m1.1.1.3.2" xref="alg2.16.m1.1.1.3.2.cmml">y</mi><mo id="alg2.16.m1.1.1.3.1" xref="alg2.16.m1.1.1.3.1.cmml">^</mo></mover><mo id="alg2.16.m1.1.1.2" xref="alg2.16.m1.1.1.2.cmml">=</mo><mrow id="alg2.16.m1.1.1.1" xref="alg2.16.m1.1.1.1.cmml"><mtext id="alg2.16.m1.1.1.1.2" xref="alg2.16.m1.1.1.1.2a.cmml">argmax</mtext><mrow id="alg2.16.m1.1.1.1.1" xref="alg2.16.m1.1.1.1.1.cmml"><mtext id="alg2.16.m1.1.1.1.1.3" xref="alg2.16.m1.1.1.1.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="alg2.16.m1.1.1.1.1.2" xref="alg2.16.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.16.m1.1.1.1.1.1.1" xref="alg2.16.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.16.m1.1.1.1.1.1.1.2" xref="alg2.16.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.16.m1.1.1.1.1.1.1.1" xref="alg2.16.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.16.m1.1.1.1.1.1.1.1.2" xref="alg2.16.m1.1.1.1.1.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.16.m1.1.1.1.1.1.1.1.1" xref="alg2.16.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.16.m1.1.1.1.1.1.1.1.3" xref="alg2.16.m1.1.1.1.1.1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.16.m1.1.1.1.1.1.1.1.1a" xref="alg2.16.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.16.m1.1.1.1.1.1.1.1.4" xref="alg2.16.m1.1.1.1.1.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.16.m1.1.1.1.1.1.1.1.1b" xref="alg2.16.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.16.m1.1.1.1.1.1.1.1.5" xref="alg2.16.m1.1.1.1.1.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.16.m1.1.1.1.1.1.1.1.1c" xref="alg2.16.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.16.m1.1.1.1.1.1.1.1.6" xref="alg2.16.m1.1.1.1.1.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.16.m1.1.1.1.1.1.1.1.1d" xref="alg2.16.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg2.16.m1.1.1.1.1.1.1.1.7" xref="alg2.16.m1.1.1.1.1.1.1.1.7.cmml">s</mi></mrow><mo stretchy="false" id="alg2.16.m1.1.1.1.1.1.1.3" xref="alg2.16.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.16.m1.1b"><apply id="alg2.16.m1.1.1.cmml" xref="alg2.16.m1.1.1"><eq id="alg2.16.m1.1.1.2.cmml" xref="alg2.16.m1.1.1.2"></eq><apply id="alg2.16.m1.1.1.3.cmml" xref="alg2.16.m1.1.1.3"><ci id="alg2.16.m1.1.1.3.1.cmml" xref="alg2.16.m1.1.1.3.1">^</ci><ci id="alg2.16.m1.1.1.3.2.cmml" xref="alg2.16.m1.1.1.3.2">𝑦</ci></apply><apply id="alg2.16.m1.1.1.1.cmml" xref="alg2.16.m1.1.1.1"><ci id="alg2.16.m1.1.1.1.2a.cmml" xref="alg2.16.m1.1.1.1.2"><mtext id="alg2.16.m1.1.1.1.2.cmml" xref="alg2.16.m1.1.1.1.2">argmax</mtext></ci><apply id="alg2.16.m1.1.1.1.1.cmml" xref="alg2.16.m1.1.1.1.1"><times id="alg2.16.m1.1.1.1.1.2.cmml" xref="alg2.16.m1.1.1.1.1.2"></times><ci id="alg2.16.m1.1.1.1.1.3a.cmml" xref="alg2.16.m1.1.1.1.1.3"><mtext id="alg2.16.m1.1.1.1.1.3.cmml" xref="alg2.16.m1.1.1.1.1.3">Softmax</mtext></ci><apply id="alg2.16.m1.1.1.1.1.1.1.1.cmml" xref="alg2.16.m1.1.1.1.1.1.1"><times id="alg2.16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.16.m1.1.1.1.1.1.1.1.1"></times><ci id="alg2.16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.16.m1.1.1.1.1.1.1.1.2">𝑙</ci><ci id="alg2.16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.16.m1.1.1.1.1.1.1.1.3">𝑜</ci><ci id="alg2.16.m1.1.1.1.1.1.1.1.4.cmml" xref="alg2.16.m1.1.1.1.1.1.1.1.4">𝑔</ci><ci id="alg2.16.m1.1.1.1.1.1.1.1.5.cmml" xref="alg2.16.m1.1.1.1.1.1.1.1.5">𝑖</ci><ci id="alg2.16.m1.1.1.1.1.1.1.1.6.cmml" xref="alg2.16.m1.1.1.1.1.1.1.1.6">𝑡</ci><ci id="alg2.16.m1.1.1.1.1.1.1.1.7.cmml" xref="alg2.16.m1.1.1.1.1.1.1.1.7">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.m1.1c">\hat{y}=\mathop{\textnormal{argmax}}\textnormal{Softmax}(logits)</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Details on Multiway Transformer</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">We will first introduce the differences between Multiway Transformers and regular Transformers here. We will also emphasize that although we use multi-head Transformers as encoders, any encoder architecture is applicable within the PmcmFL framework.</p>
</div>
<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Multiway Transformer</h3>

<div id="A3.SS1.p1" class="ltx_para">
<p id="A3.SS1.p1.1" class="ltx_p">In summary, a typical Transformer consists of Multi-Head Self-Attention layers (<span id="A3.SS1.p1.1.1" class="ltx_text ltx_font_bold">Attention</span>), Feedforward Networks (<span id="A3.SS1.p1.1.2" class="ltx_text ltx_font_bold">FFN</span>), Layer Normalizations, and Residual Connections.
The difference between Multiway Transformers and regular Transformers lies in the Attention layers and the FFNs. Specifically, the Attention layers in Multiway Transformer are modality-shared self-attention, and the FFNs are Modality-Specific Feedforward Networks (also known as Modality-Specific Experts Networks), meaning each modality has its own FFN.</p>
</div>
<div id="A3.SS1.p2" class="ltx_para">
<p id="A3.SS1.p2.7" class="ltx_p">We use images and text as examples to illustrate how Multiway Transformer switch encoding modes.
The input images and text are initially processed into sequences of tokens involving patchify or tokenization, together with positional encoding.
The initial token sequences (the image token sequence, the text token sequence, and the image-text token sequence) can be represented as:</p>
<table id="A3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E9.m1.2" class="ltx_Math" alttext="z^{0}_{i}=[z_{i0},z_{i1},\cdots,z_{iN_{i}}]," display="block"><semantics id="A3.E9.m1.2a"><mrow id="A3.E9.m1.2.2.1" xref="A3.E9.m1.2.2.1.1.cmml"><mrow id="A3.E9.m1.2.2.1.1" xref="A3.E9.m1.2.2.1.1.cmml"><msubsup id="A3.E9.m1.2.2.1.1.5" xref="A3.E9.m1.2.2.1.1.5.cmml"><mi id="A3.E9.m1.2.2.1.1.5.2.2" xref="A3.E9.m1.2.2.1.1.5.2.2.cmml">z</mi><mi id="A3.E9.m1.2.2.1.1.5.3" xref="A3.E9.m1.2.2.1.1.5.3.cmml">i</mi><mn id="A3.E9.m1.2.2.1.1.5.2.3" xref="A3.E9.m1.2.2.1.1.5.2.3.cmml">0</mn></msubsup><mo id="A3.E9.m1.2.2.1.1.4" xref="A3.E9.m1.2.2.1.1.4.cmml">=</mo><mrow id="A3.E9.m1.2.2.1.1.3.3" xref="A3.E9.m1.2.2.1.1.3.4.cmml"><mo stretchy="false" id="A3.E9.m1.2.2.1.1.3.3.4" xref="A3.E9.m1.2.2.1.1.3.4.cmml">[</mo><msub id="A3.E9.m1.2.2.1.1.1.1.1" xref="A3.E9.m1.2.2.1.1.1.1.1.cmml"><mi id="A3.E9.m1.2.2.1.1.1.1.1.2" xref="A3.E9.m1.2.2.1.1.1.1.1.2.cmml">z</mi><mrow id="A3.E9.m1.2.2.1.1.1.1.1.3" xref="A3.E9.m1.2.2.1.1.1.1.1.3.cmml"><mi id="A3.E9.m1.2.2.1.1.1.1.1.3.2" xref="A3.E9.m1.2.2.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.E9.m1.2.2.1.1.1.1.1.3.1" xref="A3.E9.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mn id="A3.E9.m1.2.2.1.1.1.1.1.3.3" xref="A3.E9.m1.2.2.1.1.1.1.1.3.3.cmml">0</mn></mrow></msub><mo id="A3.E9.m1.2.2.1.1.3.3.5" xref="A3.E9.m1.2.2.1.1.3.4.cmml">,</mo><msub id="A3.E9.m1.2.2.1.1.2.2.2" xref="A3.E9.m1.2.2.1.1.2.2.2.cmml"><mi id="A3.E9.m1.2.2.1.1.2.2.2.2" xref="A3.E9.m1.2.2.1.1.2.2.2.2.cmml">z</mi><mrow id="A3.E9.m1.2.2.1.1.2.2.2.3" xref="A3.E9.m1.2.2.1.1.2.2.2.3.cmml"><mi id="A3.E9.m1.2.2.1.1.2.2.2.3.2" xref="A3.E9.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.E9.m1.2.2.1.1.2.2.2.3.1" xref="A3.E9.m1.2.2.1.1.2.2.2.3.1.cmml">​</mo><mn id="A3.E9.m1.2.2.1.1.2.2.2.3.3" xref="A3.E9.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A3.E9.m1.2.2.1.1.3.3.6" xref="A3.E9.m1.2.2.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="A3.E9.m1.1.1" xref="A3.E9.m1.1.1.cmml">⋯</mi><mo id="A3.E9.m1.2.2.1.1.3.3.7" xref="A3.E9.m1.2.2.1.1.3.4.cmml">,</mo><msub id="A3.E9.m1.2.2.1.1.3.3.3" xref="A3.E9.m1.2.2.1.1.3.3.3.cmml"><mi id="A3.E9.m1.2.2.1.1.3.3.3.2" xref="A3.E9.m1.2.2.1.1.3.3.3.2.cmml">z</mi><mrow id="A3.E9.m1.2.2.1.1.3.3.3.3" xref="A3.E9.m1.2.2.1.1.3.3.3.3.cmml"><mi id="A3.E9.m1.2.2.1.1.3.3.3.3.2" xref="A3.E9.m1.2.2.1.1.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.E9.m1.2.2.1.1.3.3.3.3.1" xref="A3.E9.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><msub id="A3.E9.m1.2.2.1.1.3.3.3.3.3" xref="A3.E9.m1.2.2.1.1.3.3.3.3.3.cmml"><mi id="A3.E9.m1.2.2.1.1.3.3.3.3.3.2" xref="A3.E9.m1.2.2.1.1.3.3.3.3.3.2.cmml">N</mi><mi id="A3.E9.m1.2.2.1.1.3.3.3.3.3.3" xref="A3.E9.m1.2.2.1.1.3.3.3.3.3.3.cmml">i</mi></msub></mrow></msub><mo stretchy="false" id="A3.E9.m1.2.2.1.1.3.3.8" xref="A3.E9.m1.2.2.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="A3.E9.m1.2.2.1.2" xref="A3.E9.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E9.m1.2b"><apply id="A3.E9.m1.2.2.1.1.cmml" xref="A3.E9.m1.2.2.1"><eq id="A3.E9.m1.2.2.1.1.4.cmml" xref="A3.E9.m1.2.2.1.1.4"></eq><apply id="A3.E9.m1.2.2.1.1.5.cmml" xref="A3.E9.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="A3.E9.m1.2.2.1.1.5.1.cmml" xref="A3.E9.m1.2.2.1.1.5">subscript</csymbol><apply id="A3.E9.m1.2.2.1.1.5.2.cmml" xref="A3.E9.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="A3.E9.m1.2.2.1.1.5.2.1.cmml" xref="A3.E9.m1.2.2.1.1.5">superscript</csymbol><ci id="A3.E9.m1.2.2.1.1.5.2.2.cmml" xref="A3.E9.m1.2.2.1.1.5.2.2">𝑧</ci><cn type="integer" id="A3.E9.m1.2.2.1.1.5.2.3.cmml" xref="A3.E9.m1.2.2.1.1.5.2.3">0</cn></apply><ci id="A3.E9.m1.2.2.1.1.5.3.cmml" xref="A3.E9.m1.2.2.1.1.5.3">𝑖</ci></apply><list id="A3.E9.m1.2.2.1.1.3.4.cmml" xref="A3.E9.m1.2.2.1.1.3.3"><apply id="A3.E9.m1.2.2.1.1.1.1.1.cmml" xref="A3.E9.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.E9.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A3.E9.m1.2.2.1.1.1.1.1.2.cmml" xref="A3.E9.m1.2.2.1.1.1.1.1.2">𝑧</ci><apply id="A3.E9.m1.2.2.1.1.1.1.1.3.cmml" xref="A3.E9.m1.2.2.1.1.1.1.1.3"><times id="A3.E9.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A3.E9.m1.2.2.1.1.1.1.1.3.1"></times><ci id="A3.E9.m1.2.2.1.1.1.1.1.3.2.cmml" xref="A3.E9.m1.2.2.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="A3.E9.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A3.E9.m1.2.2.1.1.1.1.1.3.3">0</cn></apply></apply><apply id="A3.E9.m1.2.2.1.1.2.2.2.cmml" xref="A3.E9.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E9.m1.2.2.1.1.2.2.2.1.cmml" xref="A3.E9.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="A3.E9.m1.2.2.1.1.2.2.2.2.cmml" xref="A3.E9.m1.2.2.1.1.2.2.2.2">𝑧</ci><apply id="A3.E9.m1.2.2.1.1.2.2.2.3.cmml" xref="A3.E9.m1.2.2.1.1.2.2.2.3"><times id="A3.E9.m1.2.2.1.1.2.2.2.3.1.cmml" xref="A3.E9.m1.2.2.1.1.2.2.2.3.1"></times><ci id="A3.E9.m1.2.2.1.1.2.2.2.3.2.cmml" xref="A3.E9.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="A3.E9.m1.2.2.1.1.2.2.2.3.3.cmml" xref="A3.E9.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="A3.E9.m1.1.1.cmml" xref="A3.E9.m1.1.1">⋯</ci><apply id="A3.E9.m1.2.2.1.1.3.3.3.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A3.E9.m1.2.2.1.1.3.3.3.1.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3">subscript</csymbol><ci id="A3.E9.m1.2.2.1.1.3.3.3.2.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3.2">𝑧</ci><apply id="A3.E9.m1.2.2.1.1.3.3.3.3.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3.3"><times id="A3.E9.m1.2.2.1.1.3.3.3.3.1.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3.3.1"></times><ci id="A3.E9.m1.2.2.1.1.3.3.3.3.2.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3.3.2">𝑖</ci><apply id="A3.E9.m1.2.2.1.1.3.3.3.3.3.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="A3.E9.m1.2.2.1.1.3.3.3.3.3.1.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3.3.3">subscript</csymbol><ci id="A3.E9.m1.2.2.1.1.3.3.3.3.3.2.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3.3.3.2">𝑁</ci><ci id="A3.E9.m1.2.2.1.1.3.3.3.3.3.3.cmml" xref="A3.E9.m1.2.2.1.1.3.3.3.3.3.3">𝑖</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E9.m1.2c">z^{0}_{i}=[z_{i0},z_{i1},\cdots,z_{iN_{i}}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<table id="A3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E10.m1.2" class="ltx_Math" alttext="z^{0}_{t}=[z_{t0},z_{t1},\cdots,z_{tN_{t}}]," display="block"><semantics id="A3.E10.m1.2a"><mrow id="A3.E10.m1.2.2.1" xref="A3.E10.m1.2.2.1.1.cmml"><mrow id="A3.E10.m1.2.2.1.1" xref="A3.E10.m1.2.2.1.1.cmml"><msubsup id="A3.E10.m1.2.2.1.1.5" xref="A3.E10.m1.2.2.1.1.5.cmml"><mi id="A3.E10.m1.2.2.1.1.5.2.2" xref="A3.E10.m1.2.2.1.1.5.2.2.cmml">z</mi><mi id="A3.E10.m1.2.2.1.1.5.3" xref="A3.E10.m1.2.2.1.1.5.3.cmml">t</mi><mn id="A3.E10.m1.2.2.1.1.5.2.3" xref="A3.E10.m1.2.2.1.1.5.2.3.cmml">0</mn></msubsup><mo id="A3.E10.m1.2.2.1.1.4" xref="A3.E10.m1.2.2.1.1.4.cmml">=</mo><mrow id="A3.E10.m1.2.2.1.1.3.3" xref="A3.E10.m1.2.2.1.1.3.4.cmml"><mo stretchy="false" id="A3.E10.m1.2.2.1.1.3.3.4" xref="A3.E10.m1.2.2.1.1.3.4.cmml">[</mo><msub id="A3.E10.m1.2.2.1.1.1.1.1" xref="A3.E10.m1.2.2.1.1.1.1.1.cmml"><mi id="A3.E10.m1.2.2.1.1.1.1.1.2" xref="A3.E10.m1.2.2.1.1.1.1.1.2.cmml">z</mi><mrow id="A3.E10.m1.2.2.1.1.1.1.1.3" xref="A3.E10.m1.2.2.1.1.1.1.1.3.cmml"><mi id="A3.E10.m1.2.2.1.1.1.1.1.3.2" xref="A3.E10.m1.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E10.m1.2.2.1.1.1.1.1.3.1" xref="A3.E10.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mn id="A3.E10.m1.2.2.1.1.1.1.1.3.3" xref="A3.E10.m1.2.2.1.1.1.1.1.3.3.cmml">0</mn></mrow></msub><mo id="A3.E10.m1.2.2.1.1.3.3.5" xref="A3.E10.m1.2.2.1.1.3.4.cmml">,</mo><msub id="A3.E10.m1.2.2.1.1.2.2.2" xref="A3.E10.m1.2.2.1.1.2.2.2.cmml"><mi id="A3.E10.m1.2.2.1.1.2.2.2.2" xref="A3.E10.m1.2.2.1.1.2.2.2.2.cmml">z</mi><mrow id="A3.E10.m1.2.2.1.1.2.2.2.3" xref="A3.E10.m1.2.2.1.1.2.2.2.3.cmml"><mi id="A3.E10.m1.2.2.1.1.2.2.2.3.2" xref="A3.E10.m1.2.2.1.1.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E10.m1.2.2.1.1.2.2.2.3.1" xref="A3.E10.m1.2.2.1.1.2.2.2.3.1.cmml">​</mo><mn id="A3.E10.m1.2.2.1.1.2.2.2.3.3" xref="A3.E10.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A3.E10.m1.2.2.1.1.3.3.6" xref="A3.E10.m1.2.2.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="A3.E10.m1.1.1" xref="A3.E10.m1.1.1.cmml">⋯</mi><mo id="A3.E10.m1.2.2.1.1.3.3.7" xref="A3.E10.m1.2.2.1.1.3.4.cmml">,</mo><msub id="A3.E10.m1.2.2.1.1.3.3.3" xref="A3.E10.m1.2.2.1.1.3.3.3.cmml"><mi id="A3.E10.m1.2.2.1.1.3.3.3.2" xref="A3.E10.m1.2.2.1.1.3.3.3.2.cmml">z</mi><mrow id="A3.E10.m1.2.2.1.1.3.3.3.3" xref="A3.E10.m1.2.2.1.1.3.3.3.3.cmml"><mi id="A3.E10.m1.2.2.1.1.3.3.3.3.2" xref="A3.E10.m1.2.2.1.1.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E10.m1.2.2.1.1.3.3.3.3.1" xref="A3.E10.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><msub id="A3.E10.m1.2.2.1.1.3.3.3.3.3" xref="A3.E10.m1.2.2.1.1.3.3.3.3.3.cmml"><mi id="A3.E10.m1.2.2.1.1.3.3.3.3.3.2" xref="A3.E10.m1.2.2.1.1.3.3.3.3.3.2.cmml">N</mi><mi id="A3.E10.m1.2.2.1.1.3.3.3.3.3.3" xref="A3.E10.m1.2.2.1.1.3.3.3.3.3.3.cmml">t</mi></msub></mrow></msub><mo stretchy="false" id="A3.E10.m1.2.2.1.1.3.3.8" xref="A3.E10.m1.2.2.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="A3.E10.m1.2.2.1.2" xref="A3.E10.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E10.m1.2b"><apply id="A3.E10.m1.2.2.1.1.cmml" xref="A3.E10.m1.2.2.1"><eq id="A3.E10.m1.2.2.1.1.4.cmml" xref="A3.E10.m1.2.2.1.1.4"></eq><apply id="A3.E10.m1.2.2.1.1.5.cmml" xref="A3.E10.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="A3.E10.m1.2.2.1.1.5.1.cmml" xref="A3.E10.m1.2.2.1.1.5">subscript</csymbol><apply id="A3.E10.m1.2.2.1.1.5.2.cmml" xref="A3.E10.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="A3.E10.m1.2.2.1.1.5.2.1.cmml" xref="A3.E10.m1.2.2.1.1.5">superscript</csymbol><ci id="A3.E10.m1.2.2.1.1.5.2.2.cmml" xref="A3.E10.m1.2.2.1.1.5.2.2">𝑧</ci><cn type="integer" id="A3.E10.m1.2.2.1.1.5.2.3.cmml" xref="A3.E10.m1.2.2.1.1.5.2.3">0</cn></apply><ci id="A3.E10.m1.2.2.1.1.5.3.cmml" xref="A3.E10.m1.2.2.1.1.5.3">𝑡</ci></apply><list id="A3.E10.m1.2.2.1.1.3.4.cmml" xref="A3.E10.m1.2.2.1.1.3.3"><apply id="A3.E10.m1.2.2.1.1.1.1.1.cmml" xref="A3.E10.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.E10.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A3.E10.m1.2.2.1.1.1.1.1.2.cmml" xref="A3.E10.m1.2.2.1.1.1.1.1.2">𝑧</ci><apply id="A3.E10.m1.2.2.1.1.1.1.1.3.cmml" xref="A3.E10.m1.2.2.1.1.1.1.1.3"><times id="A3.E10.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A3.E10.m1.2.2.1.1.1.1.1.3.1"></times><ci id="A3.E10.m1.2.2.1.1.1.1.1.3.2.cmml" xref="A3.E10.m1.2.2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="A3.E10.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A3.E10.m1.2.2.1.1.1.1.1.3.3">0</cn></apply></apply><apply id="A3.E10.m1.2.2.1.1.2.2.2.cmml" xref="A3.E10.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E10.m1.2.2.1.1.2.2.2.1.cmml" xref="A3.E10.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="A3.E10.m1.2.2.1.1.2.2.2.2.cmml" xref="A3.E10.m1.2.2.1.1.2.2.2.2">𝑧</ci><apply id="A3.E10.m1.2.2.1.1.2.2.2.3.cmml" xref="A3.E10.m1.2.2.1.1.2.2.2.3"><times id="A3.E10.m1.2.2.1.1.2.2.2.3.1.cmml" xref="A3.E10.m1.2.2.1.1.2.2.2.3.1"></times><ci id="A3.E10.m1.2.2.1.1.2.2.2.3.2.cmml" xref="A3.E10.m1.2.2.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="A3.E10.m1.2.2.1.1.2.2.2.3.3.cmml" xref="A3.E10.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="A3.E10.m1.1.1.cmml" xref="A3.E10.m1.1.1">⋯</ci><apply id="A3.E10.m1.2.2.1.1.3.3.3.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A3.E10.m1.2.2.1.1.3.3.3.1.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3">subscript</csymbol><ci id="A3.E10.m1.2.2.1.1.3.3.3.2.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3.2">𝑧</ci><apply id="A3.E10.m1.2.2.1.1.3.3.3.3.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3.3"><times id="A3.E10.m1.2.2.1.1.3.3.3.3.1.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3.3.1"></times><ci id="A3.E10.m1.2.2.1.1.3.3.3.3.2.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3.3.2">𝑡</ci><apply id="A3.E10.m1.2.2.1.1.3.3.3.3.3.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="A3.E10.m1.2.2.1.1.3.3.3.3.3.1.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3.3.3">subscript</csymbol><ci id="A3.E10.m1.2.2.1.1.3.3.3.3.3.2.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3.3.3.2">𝑁</ci><ci id="A3.E10.m1.2.2.1.1.3.3.3.3.3.3.cmml" xref="A3.E10.m1.2.2.1.1.3.3.3.3.3.3">𝑡</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E10.m1.2c">z^{0}_{t}=[z_{t0},z_{t1},\cdots,z_{tN_{t}}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<table id="A3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E11.m1.3" class="ltx_Math" alttext="z^{0}=cat(z^{0}_{i},z^{0}_{t})=[z_{i0},\cdots,z_{iN_{i}},z_{t0},\cdots,z_{tN_{t}}]," display="block"><semantics id="A3.E11.m1.3a"><mrow id="A3.E11.m1.3.3.1" xref="A3.E11.m1.3.3.1.1.cmml"><mrow id="A3.E11.m1.3.3.1.1" xref="A3.E11.m1.3.3.1.1.cmml"><msup id="A3.E11.m1.3.3.1.1.8" xref="A3.E11.m1.3.3.1.1.8.cmml"><mi id="A3.E11.m1.3.3.1.1.8.2" xref="A3.E11.m1.3.3.1.1.8.2.cmml">z</mi><mn id="A3.E11.m1.3.3.1.1.8.3" xref="A3.E11.m1.3.3.1.1.8.3.cmml">0</mn></msup><mo id="A3.E11.m1.3.3.1.1.9" xref="A3.E11.m1.3.3.1.1.9.cmml">=</mo><mrow id="A3.E11.m1.3.3.1.1.2" xref="A3.E11.m1.3.3.1.1.2.cmml"><mi id="A3.E11.m1.3.3.1.1.2.4" xref="A3.E11.m1.3.3.1.1.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="A3.E11.m1.3.3.1.1.2.3" xref="A3.E11.m1.3.3.1.1.2.3.cmml">​</mo><mi id="A3.E11.m1.3.3.1.1.2.5" xref="A3.E11.m1.3.3.1.1.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="A3.E11.m1.3.3.1.1.2.3a" xref="A3.E11.m1.3.3.1.1.2.3.cmml">​</mo><mi id="A3.E11.m1.3.3.1.1.2.6" xref="A3.E11.m1.3.3.1.1.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E11.m1.3.3.1.1.2.3b" xref="A3.E11.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="A3.E11.m1.3.3.1.1.2.2.2" xref="A3.E11.m1.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="A3.E11.m1.3.3.1.1.2.2.2.3" xref="A3.E11.m1.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="A3.E11.m1.3.3.1.1.1.1.1.1" xref="A3.E11.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A3.E11.m1.3.3.1.1.1.1.1.1.2.2" xref="A3.E11.m1.3.3.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="A3.E11.m1.3.3.1.1.1.1.1.1.3" xref="A3.E11.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi><mn id="A3.E11.m1.3.3.1.1.1.1.1.1.2.3" xref="A3.E11.m1.3.3.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="A3.E11.m1.3.3.1.1.2.2.2.4" xref="A3.E11.m1.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="A3.E11.m1.3.3.1.1.2.2.2.2" xref="A3.E11.m1.3.3.1.1.2.2.2.2.cmml"><mi id="A3.E11.m1.3.3.1.1.2.2.2.2.2.2" xref="A3.E11.m1.3.3.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="A3.E11.m1.3.3.1.1.2.2.2.2.3" xref="A3.E11.m1.3.3.1.1.2.2.2.2.3.cmml">t</mi><mn id="A3.E11.m1.3.3.1.1.2.2.2.2.2.3" xref="A3.E11.m1.3.3.1.1.2.2.2.2.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="A3.E11.m1.3.3.1.1.2.2.2.5" xref="A3.E11.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E11.m1.3.3.1.1.10" xref="A3.E11.m1.3.3.1.1.10.cmml">=</mo><mrow id="A3.E11.m1.3.3.1.1.6.4" xref="A3.E11.m1.3.3.1.1.6.5.cmml"><mo stretchy="false" id="A3.E11.m1.3.3.1.1.6.4.5" xref="A3.E11.m1.3.3.1.1.6.5.cmml">[</mo><msub id="A3.E11.m1.3.3.1.1.3.1.1" xref="A3.E11.m1.3.3.1.1.3.1.1.cmml"><mi id="A3.E11.m1.3.3.1.1.3.1.1.2" xref="A3.E11.m1.3.3.1.1.3.1.1.2.cmml">z</mi><mrow id="A3.E11.m1.3.3.1.1.3.1.1.3" xref="A3.E11.m1.3.3.1.1.3.1.1.3.cmml"><mi id="A3.E11.m1.3.3.1.1.3.1.1.3.2" xref="A3.E11.m1.3.3.1.1.3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.E11.m1.3.3.1.1.3.1.1.3.1" xref="A3.E11.m1.3.3.1.1.3.1.1.3.1.cmml">​</mo><mn id="A3.E11.m1.3.3.1.1.3.1.1.3.3" xref="A3.E11.m1.3.3.1.1.3.1.1.3.3.cmml">0</mn></mrow></msub><mo id="A3.E11.m1.3.3.1.1.6.4.6" xref="A3.E11.m1.3.3.1.1.6.5.cmml">,</mo><mi mathvariant="normal" id="A3.E11.m1.1.1" xref="A3.E11.m1.1.1.cmml">⋯</mi><mo id="A3.E11.m1.3.3.1.1.6.4.7" xref="A3.E11.m1.3.3.1.1.6.5.cmml">,</mo><msub id="A3.E11.m1.3.3.1.1.4.2.2" xref="A3.E11.m1.3.3.1.1.4.2.2.cmml"><mi id="A3.E11.m1.3.3.1.1.4.2.2.2" xref="A3.E11.m1.3.3.1.1.4.2.2.2.cmml">z</mi><mrow id="A3.E11.m1.3.3.1.1.4.2.2.3" xref="A3.E11.m1.3.3.1.1.4.2.2.3.cmml"><mi id="A3.E11.m1.3.3.1.1.4.2.2.3.2" xref="A3.E11.m1.3.3.1.1.4.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.E11.m1.3.3.1.1.4.2.2.3.1" xref="A3.E11.m1.3.3.1.1.4.2.2.3.1.cmml">​</mo><msub id="A3.E11.m1.3.3.1.1.4.2.2.3.3" xref="A3.E11.m1.3.3.1.1.4.2.2.3.3.cmml"><mi id="A3.E11.m1.3.3.1.1.4.2.2.3.3.2" xref="A3.E11.m1.3.3.1.1.4.2.2.3.3.2.cmml">N</mi><mi id="A3.E11.m1.3.3.1.1.4.2.2.3.3.3" xref="A3.E11.m1.3.3.1.1.4.2.2.3.3.3.cmml">i</mi></msub></mrow></msub><mo id="A3.E11.m1.3.3.1.1.6.4.8" xref="A3.E11.m1.3.3.1.1.6.5.cmml">,</mo><msub id="A3.E11.m1.3.3.1.1.5.3.3" xref="A3.E11.m1.3.3.1.1.5.3.3.cmml"><mi id="A3.E11.m1.3.3.1.1.5.3.3.2" xref="A3.E11.m1.3.3.1.1.5.3.3.2.cmml">z</mi><mrow id="A3.E11.m1.3.3.1.1.5.3.3.3" xref="A3.E11.m1.3.3.1.1.5.3.3.3.cmml"><mi id="A3.E11.m1.3.3.1.1.5.3.3.3.2" xref="A3.E11.m1.3.3.1.1.5.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E11.m1.3.3.1.1.5.3.3.3.1" xref="A3.E11.m1.3.3.1.1.5.3.3.3.1.cmml">​</mo><mn id="A3.E11.m1.3.3.1.1.5.3.3.3.3" xref="A3.E11.m1.3.3.1.1.5.3.3.3.3.cmml">0</mn></mrow></msub><mo id="A3.E11.m1.3.3.1.1.6.4.9" xref="A3.E11.m1.3.3.1.1.6.5.cmml">,</mo><mi mathvariant="normal" id="A3.E11.m1.2.2" xref="A3.E11.m1.2.2.cmml">⋯</mi><mo id="A3.E11.m1.3.3.1.1.6.4.10" xref="A3.E11.m1.3.3.1.1.6.5.cmml">,</mo><msub id="A3.E11.m1.3.3.1.1.6.4.4" xref="A3.E11.m1.3.3.1.1.6.4.4.cmml"><mi id="A3.E11.m1.3.3.1.1.6.4.4.2" xref="A3.E11.m1.3.3.1.1.6.4.4.2.cmml">z</mi><mrow id="A3.E11.m1.3.3.1.1.6.4.4.3" xref="A3.E11.m1.3.3.1.1.6.4.4.3.cmml"><mi id="A3.E11.m1.3.3.1.1.6.4.4.3.2" xref="A3.E11.m1.3.3.1.1.6.4.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E11.m1.3.3.1.1.6.4.4.3.1" xref="A3.E11.m1.3.3.1.1.6.4.4.3.1.cmml">​</mo><msub id="A3.E11.m1.3.3.1.1.6.4.4.3.3" xref="A3.E11.m1.3.3.1.1.6.4.4.3.3.cmml"><mi id="A3.E11.m1.3.3.1.1.6.4.4.3.3.2" xref="A3.E11.m1.3.3.1.1.6.4.4.3.3.2.cmml">N</mi><mi id="A3.E11.m1.3.3.1.1.6.4.4.3.3.3" xref="A3.E11.m1.3.3.1.1.6.4.4.3.3.3.cmml">t</mi></msub></mrow></msub><mo stretchy="false" id="A3.E11.m1.3.3.1.1.6.4.11" xref="A3.E11.m1.3.3.1.1.6.5.cmml">]</mo></mrow></mrow><mo id="A3.E11.m1.3.3.1.2" xref="A3.E11.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E11.m1.3b"><apply id="A3.E11.m1.3.3.1.1.cmml" xref="A3.E11.m1.3.3.1"><and id="A3.E11.m1.3.3.1.1a.cmml" xref="A3.E11.m1.3.3.1"></and><apply id="A3.E11.m1.3.3.1.1b.cmml" xref="A3.E11.m1.3.3.1"><eq id="A3.E11.m1.3.3.1.1.9.cmml" xref="A3.E11.m1.3.3.1.1.9"></eq><apply id="A3.E11.m1.3.3.1.1.8.cmml" xref="A3.E11.m1.3.3.1.1.8"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.8.1.cmml" xref="A3.E11.m1.3.3.1.1.8">superscript</csymbol><ci id="A3.E11.m1.3.3.1.1.8.2.cmml" xref="A3.E11.m1.3.3.1.1.8.2">𝑧</ci><cn type="integer" id="A3.E11.m1.3.3.1.1.8.3.cmml" xref="A3.E11.m1.3.3.1.1.8.3">0</cn></apply><apply id="A3.E11.m1.3.3.1.1.2.cmml" xref="A3.E11.m1.3.3.1.1.2"><times id="A3.E11.m1.3.3.1.1.2.3.cmml" xref="A3.E11.m1.3.3.1.1.2.3"></times><ci id="A3.E11.m1.3.3.1.1.2.4.cmml" xref="A3.E11.m1.3.3.1.1.2.4">𝑐</ci><ci id="A3.E11.m1.3.3.1.1.2.5.cmml" xref="A3.E11.m1.3.3.1.1.2.5">𝑎</ci><ci id="A3.E11.m1.3.3.1.1.2.6.cmml" xref="A3.E11.m1.3.3.1.1.2.6">𝑡</ci><interval closure="open" id="A3.E11.m1.3.3.1.1.2.2.3.cmml" xref="A3.E11.m1.3.3.1.1.2.2.2"><apply id="A3.E11.m1.3.3.1.1.1.1.1.1.cmml" xref="A3.E11.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E11.m1.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A3.E11.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A3.E11.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="A3.E11.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="A3.E11.m1.3.3.1.1.1.1.1.1.2.2">𝑧</ci><cn type="integer" id="A3.E11.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="A3.E11.m1.3.3.1.1.1.1.1.1.2.3">0</cn></apply><ci id="A3.E11.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A3.E11.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A3.E11.m1.3.3.1.1.2.2.2.2.cmml" xref="A3.E11.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.2.2.2.2.1.cmml" xref="A3.E11.m1.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="A3.E11.m1.3.3.1.1.2.2.2.2.2.cmml" xref="A3.E11.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="A3.E11.m1.3.3.1.1.2.2.2.2">superscript</csymbol><ci id="A3.E11.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="A3.E11.m1.3.3.1.1.2.2.2.2.2.2">𝑧</ci><cn type="integer" id="A3.E11.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="A3.E11.m1.3.3.1.1.2.2.2.2.2.3">0</cn></apply><ci id="A3.E11.m1.3.3.1.1.2.2.2.2.3.cmml" xref="A3.E11.m1.3.3.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="A3.E11.m1.3.3.1.1c.cmml" xref="A3.E11.m1.3.3.1"><eq id="A3.E11.m1.3.3.1.1.10.cmml" xref="A3.E11.m1.3.3.1.1.10"></eq><share href="#A3.E11.m1.3.3.1.1.2.cmml" id="A3.E11.m1.3.3.1.1d.cmml" xref="A3.E11.m1.3.3.1"></share><list id="A3.E11.m1.3.3.1.1.6.5.cmml" xref="A3.E11.m1.3.3.1.1.6.4"><apply id="A3.E11.m1.3.3.1.1.3.1.1.cmml" xref="A3.E11.m1.3.3.1.1.3.1.1"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.3.1.1.1.cmml" xref="A3.E11.m1.3.3.1.1.3.1.1">subscript</csymbol><ci id="A3.E11.m1.3.3.1.1.3.1.1.2.cmml" xref="A3.E11.m1.3.3.1.1.3.1.1.2">𝑧</ci><apply id="A3.E11.m1.3.3.1.1.3.1.1.3.cmml" xref="A3.E11.m1.3.3.1.1.3.1.1.3"><times id="A3.E11.m1.3.3.1.1.3.1.1.3.1.cmml" xref="A3.E11.m1.3.3.1.1.3.1.1.3.1"></times><ci id="A3.E11.m1.3.3.1.1.3.1.1.3.2.cmml" xref="A3.E11.m1.3.3.1.1.3.1.1.3.2">𝑖</ci><cn type="integer" id="A3.E11.m1.3.3.1.1.3.1.1.3.3.cmml" xref="A3.E11.m1.3.3.1.1.3.1.1.3.3">0</cn></apply></apply><ci id="A3.E11.m1.1.1.cmml" xref="A3.E11.m1.1.1">⋯</ci><apply id="A3.E11.m1.3.3.1.1.4.2.2.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.4.2.2.1.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2">subscript</csymbol><ci id="A3.E11.m1.3.3.1.1.4.2.2.2.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2.2">𝑧</ci><apply id="A3.E11.m1.3.3.1.1.4.2.2.3.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2.3"><times id="A3.E11.m1.3.3.1.1.4.2.2.3.1.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2.3.1"></times><ci id="A3.E11.m1.3.3.1.1.4.2.2.3.2.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2.3.2">𝑖</ci><apply id="A3.E11.m1.3.3.1.1.4.2.2.3.3.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2.3.3"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.4.2.2.3.3.1.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2.3.3">subscript</csymbol><ci id="A3.E11.m1.3.3.1.1.4.2.2.3.3.2.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2.3.3.2">𝑁</ci><ci id="A3.E11.m1.3.3.1.1.4.2.2.3.3.3.cmml" xref="A3.E11.m1.3.3.1.1.4.2.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="A3.E11.m1.3.3.1.1.5.3.3.cmml" xref="A3.E11.m1.3.3.1.1.5.3.3"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.5.3.3.1.cmml" xref="A3.E11.m1.3.3.1.1.5.3.3">subscript</csymbol><ci id="A3.E11.m1.3.3.1.1.5.3.3.2.cmml" xref="A3.E11.m1.3.3.1.1.5.3.3.2">𝑧</ci><apply id="A3.E11.m1.3.3.1.1.5.3.3.3.cmml" xref="A3.E11.m1.3.3.1.1.5.3.3.3"><times id="A3.E11.m1.3.3.1.1.5.3.3.3.1.cmml" xref="A3.E11.m1.3.3.1.1.5.3.3.3.1"></times><ci id="A3.E11.m1.3.3.1.1.5.3.3.3.2.cmml" xref="A3.E11.m1.3.3.1.1.5.3.3.3.2">𝑡</ci><cn type="integer" id="A3.E11.m1.3.3.1.1.5.3.3.3.3.cmml" xref="A3.E11.m1.3.3.1.1.5.3.3.3.3">0</cn></apply></apply><ci id="A3.E11.m1.2.2.cmml" xref="A3.E11.m1.2.2">⋯</ci><apply id="A3.E11.m1.3.3.1.1.6.4.4.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.6.4.4.1.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4">subscript</csymbol><ci id="A3.E11.m1.3.3.1.1.6.4.4.2.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4.2">𝑧</ci><apply id="A3.E11.m1.3.3.1.1.6.4.4.3.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4.3"><times id="A3.E11.m1.3.3.1.1.6.4.4.3.1.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4.3.1"></times><ci id="A3.E11.m1.3.3.1.1.6.4.4.3.2.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4.3.2">𝑡</ci><apply id="A3.E11.m1.3.3.1.1.6.4.4.3.3.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4.3.3"><csymbol cd="ambiguous" id="A3.E11.m1.3.3.1.1.6.4.4.3.3.1.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4.3.3">subscript</csymbol><ci id="A3.E11.m1.3.3.1.1.6.4.4.3.3.2.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4.3.3.2">𝑁</ci><ci id="A3.E11.m1.3.3.1.1.6.4.4.3.3.3.cmml" xref="A3.E11.m1.3.3.1.1.6.4.4.3.3.3">𝑡</ci></apply></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E11.m1.3c">z^{0}=cat(z^{0}_{i},z^{0}_{t})=[z_{i0},\cdots,z_{iN_{i}},z_{t0},\cdots,z_{tN_{t}}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.p2.6" class="ltx_p">where <math id="A3.SS1.p2.1.m1.2" class="ltx_Math" alttext="z_{i*}" display="inline"><semantics id="A3.SS1.p2.1.m1.2a"><msub id="A3.SS1.p2.1.m1.2.3" xref="A3.SS1.p2.1.m1.2.3.cmml"><mi id="A3.SS1.p2.1.m1.2.3.2" xref="A3.SS1.p2.1.m1.2.3.2.cmml">z</mi><mrow id="A3.SS1.p2.1.m1.2.2.2.4" xref="A3.SS1.p2.1.m1.2.2.2.3.cmml"><mi id="A3.SS1.p2.1.m1.1.1.1.1" xref="A3.SS1.p2.1.m1.1.1.1.1.cmml">i</mi><mo lspace="0.222em" id="A3.SS1.p2.1.m1.2.2.2.4.1" xref="A3.SS1.p2.1.m1.2.2.2.3.cmml">⁣</mo><mo id="A3.SS1.p2.1.m1.2.2.2.2" xref="A3.SS1.p2.1.m1.2.2.2.2.cmml">∗</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.1.m1.2b"><apply id="A3.SS1.p2.1.m1.2.3.cmml" xref="A3.SS1.p2.1.m1.2.3"><csymbol cd="ambiguous" id="A3.SS1.p2.1.m1.2.3.1.cmml" xref="A3.SS1.p2.1.m1.2.3">subscript</csymbol><ci id="A3.SS1.p2.1.m1.2.3.2.cmml" xref="A3.SS1.p2.1.m1.2.3.2">𝑧</ci><list id="A3.SS1.p2.1.m1.2.2.2.3.cmml" xref="A3.SS1.p2.1.m1.2.2.2.4"><ci id="A3.SS1.p2.1.m1.1.1.1.1.cmml" xref="A3.SS1.p2.1.m1.1.1.1.1">𝑖</ci><times id="A3.SS1.p2.1.m1.2.2.2.2.cmml" xref="A3.SS1.p2.1.m1.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.1.m1.2c">z_{i*}</annotation></semantics></math> denotes the image token, <math id="A3.SS1.p2.2.m2.2" class="ltx_Math" alttext="z_{t*}" display="inline"><semantics id="A3.SS1.p2.2.m2.2a"><msub id="A3.SS1.p2.2.m2.2.3" xref="A3.SS1.p2.2.m2.2.3.cmml"><mi id="A3.SS1.p2.2.m2.2.3.2" xref="A3.SS1.p2.2.m2.2.3.2.cmml">z</mi><mrow id="A3.SS1.p2.2.m2.2.2.2.4" xref="A3.SS1.p2.2.m2.2.2.2.3.cmml"><mi id="A3.SS1.p2.2.m2.1.1.1.1" xref="A3.SS1.p2.2.m2.1.1.1.1.cmml">t</mi><mo lspace="0.222em" id="A3.SS1.p2.2.m2.2.2.2.4.1" xref="A3.SS1.p2.2.m2.2.2.2.3.cmml">⁣</mo><mo id="A3.SS1.p2.2.m2.2.2.2.2" xref="A3.SS1.p2.2.m2.2.2.2.2.cmml">∗</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.2.m2.2b"><apply id="A3.SS1.p2.2.m2.2.3.cmml" xref="A3.SS1.p2.2.m2.2.3"><csymbol cd="ambiguous" id="A3.SS1.p2.2.m2.2.3.1.cmml" xref="A3.SS1.p2.2.m2.2.3">subscript</csymbol><ci id="A3.SS1.p2.2.m2.2.3.2.cmml" xref="A3.SS1.p2.2.m2.2.3.2">𝑧</ci><list id="A3.SS1.p2.2.m2.2.2.2.3.cmml" xref="A3.SS1.p2.2.m2.2.2.2.4"><ci id="A3.SS1.p2.2.m2.1.1.1.1.cmml" xref="A3.SS1.p2.2.m2.1.1.1.1">𝑡</ci><times id="A3.SS1.p2.2.m2.2.2.2.2.cmml" xref="A3.SS1.p2.2.m2.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.2.m2.2c">z_{t*}</annotation></semantics></math> denotes the text token, <math id="A3.SS1.p2.3.m3.1" class="ltx_Math" alttext="z_{i0}" display="inline"><semantics id="A3.SS1.p2.3.m3.1a"><msub id="A3.SS1.p2.3.m3.1.1" xref="A3.SS1.p2.3.m3.1.1.cmml"><mi id="A3.SS1.p2.3.m3.1.1.2" xref="A3.SS1.p2.3.m3.1.1.2.cmml">z</mi><mrow id="A3.SS1.p2.3.m3.1.1.3" xref="A3.SS1.p2.3.m3.1.1.3.cmml"><mi id="A3.SS1.p2.3.m3.1.1.3.2" xref="A3.SS1.p2.3.m3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p2.3.m3.1.1.3.1" xref="A3.SS1.p2.3.m3.1.1.3.1.cmml">​</mo><mn id="A3.SS1.p2.3.m3.1.1.3.3" xref="A3.SS1.p2.3.m3.1.1.3.3.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.3.m3.1b"><apply id="A3.SS1.p2.3.m3.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.3.m3.1.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="A3.SS1.p2.3.m3.1.1.2.cmml" xref="A3.SS1.p2.3.m3.1.1.2">𝑧</ci><apply id="A3.SS1.p2.3.m3.1.1.3.cmml" xref="A3.SS1.p2.3.m3.1.1.3"><times id="A3.SS1.p2.3.m3.1.1.3.1.cmml" xref="A3.SS1.p2.3.m3.1.1.3.1"></times><ci id="A3.SS1.p2.3.m3.1.1.3.2.cmml" xref="A3.SS1.p2.3.m3.1.1.3.2">𝑖</ci><cn type="integer" id="A3.SS1.p2.3.m3.1.1.3.3.cmml" xref="A3.SS1.p2.3.m3.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.3.m3.1c">z_{i0}</annotation></semantics></math> denotes the image CLS token, <math id="A3.SS1.p2.4.m4.1" class="ltx_Math" alttext="z_{t0}" display="inline"><semantics id="A3.SS1.p2.4.m4.1a"><msub id="A3.SS1.p2.4.m4.1.1" xref="A3.SS1.p2.4.m4.1.1.cmml"><mi id="A3.SS1.p2.4.m4.1.1.2" xref="A3.SS1.p2.4.m4.1.1.2.cmml">z</mi><mrow id="A3.SS1.p2.4.m4.1.1.3" xref="A3.SS1.p2.4.m4.1.1.3.cmml"><mi id="A3.SS1.p2.4.m4.1.1.3.2" xref="A3.SS1.p2.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p2.4.m4.1.1.3.1" xref="A3.SS1.p2.4.m4.1.1.3.1.cmml">​</mo><mn id="A3.SS1.p2.4.m4.1.1.3.3" xref="A3.SS1.p2.4.m4.1.1.3.3.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.4.m4.1b"><apply id="A3.SS1.p2.4.m4.1.1.cmml" xref="A3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.4.m4.1.1.1.cmml" xref="A3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="A3.SS1.p2.4.m4.1.1.2.cmml" xref="A3.SS1.p2.4.m4.1.1.2">𝑧</ci><apply id="A3.SS1.p2.4.m4.1.1.3.cmml" xref="A3.SS1.p2.4.m4.1.1.3"><times id="A3.SS1.p2.4.m4.1.1.3.1.cmml" xref="A3.SS1.p2.4.m4.1.1.3.1"></times><ci id="A3.SS1.p2.4.m4.1.1.3.2.cmml" xref="A3.SS1.p2.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="A3.SS1.p2.4.m4.1.1.3.3.cmml" xref="A3.SS1.p2.4.m4.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.4.m4.1c">z_{t0}</annotation></semantics></math> denotes the text CLS token, <math id="A3.SS1.p2.5.m5.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="A3.SS1.p2.5.m5.1a"><msub id="A3.SS1.p2.5.m5.1.1" xref="A3.SS1.p2.5.m5.1.1.cmml"><mi id="A3.SS1.p2.5.m5.1.1.2" xref="A3.SS1.p2.5.m5.1.1.2.cmml">N</mi><mi id="A3.SS1.p2.5.m5.1.1.3" xref="A3.SS1.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.5.m5.1b"><apply id="A3.SS1.p2.5.m5.1.1.cmml" xref="A3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.5.m5.1.1.1.cmml" xref="A3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="A3.SS1.p2.5.m5.1.1.2.cmml" xref="A3.SS1.p2.5.m5.1.1.2">𝑁</ci><ci id="A3.SS1.p2.5.m5.1.1.3.cmml" xref="A3.SS1.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.5.m5.1c">N_{i}</annotation></semantics></math> and <math id="A3.SS1.p2.6.m6.1" class="ltx_Math" alttext="N_{t}" display="inline"><semantics id="A3.SS1.p2.6.m6.1a"><msub id="A3.SS1.p2.6.m6.1.1" xref="A3.SS1.p2.6.m6.1.1.cmml"><mi id="A3.SS1.p2.6.m6.1.1.2" xref="A3.SS1.p2.6.m6.1.1.2.cmml">N</mi><mi id="A3.SS1.p2.6.m6.1.1.3" xref="A3.SS1.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.6.m6.1b"><apply id="A3.SS1.p2.6.m6.1.1.cmml" xref="A3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.6.m6.1.1.1.cmml" xref="A3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="A3.SS1.p2.6.m6.1.1.2.cmml" xref="A3.SS1.p2.6.m6.1.1.2">𝑁</ci><ci id="A3.SS1.p2.6.m6.1.1.3.cmml" xref="A3.SS1.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.6.m6.1c">N_{t}</annotation></semantics></math> denote the number of image tokens and text tokens respectively.</p>
</div>
<div id="A3.SS1.p3" class="ltx_para">
<p id="A3.SS1.p3.5" class="ltx_p">For the Shared Self-Attention layer at <math id="A3.SS1.p3.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="A3.SS1.p3.1.m1.1a"><mi id="A3.SS1.p3.1.m1.1.1" xref="A3.SS1.p3.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.1.m1.1b"><ci id="A3.SS1.p3.1.m1.1.1.cmml" xref="A3.SS1.p3.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.1.m1.1c">l</annotation></semantics></math>-th encoding layer, we represent it as <math id="A3.SS1.p3.2.m2.1" class="ltx_Math" alttext="{Attention}^{l}(\cdot)" display="inline"><semantics id="A3.SS1.p3.2.m2.1a"><mrow id="A3.SS1.p3.2.m2.1.2" xref="A3.SS1.p3.2.m2.1.2.cmml"><mi id="A3.SS1.p3.2.m2.1.2.2" xref="A3.SS1.p3.2.m2.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.2.m2.1.2.3" xref="A3.SS1.p3.2.m2.1.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1a" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.2.m2.1.2.4" xref="A3.SS1.p3.2.m2.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1b" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.2.m2.1.2.5" xref="A3.SS1.p3.2.m2.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1c" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.2.m2.1.2.6" xref="A3.SS1.p3.2.m2.1.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1d" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.2.m2.1.2.7" xref="A3.SS1.p3.2.m2.1.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1e" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.2.m2.1.2.8" xref="A3.SS1.p3.2.m2.1.2.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1f" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.2.m2.1.2.9" xref="A3.SS1.p3.2.m2.1.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1g" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><msup id="A3.SS1.p3.2.m2.1.2.10" xref="A3.SS1.p3.2.m2.1.2.10.cmml"><mi id="A3.SS1.p3.2.m2.1.2.10.2" xref="A3.SS1.p3.2.m2.1.2.10.2.cmml">n</mi><mi id="A3.SS1.p3.2.m2.1.2.10.3" xref="A3.SS1.p3.2.m2.1.2.10.3.cmml">l</mi></msup><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.2.1h" xref="A3.SS1.p3.2.m2.1.2.1.cmml">​</mo><mrow id="A3.SS1.p3.2.m2.1.2.11.2" xref="A3.SS1.p3.2.m2.1.2.cmml"><mo stretchy="false" id="A3.SS1.p3.2.m2.1.2.11.2.1" xref="A3.SS1.p3.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A3.SS1.p3.2.m2.1.1" xref="A3.SS1.p3.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="A3.SS1.p3.2.m2.1.2.11.2.2" xref="A3.SS1.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.2.m2.1b"><apply id="A3.SS1.p3.2.m2.1.2.cmml" xref="A3.SS1.p3.2.m2.1.2"><times id="A3.SS1.p3.2.m2.1.2.1.cmml" xref="A3.SS1.p3.2.m2.1.2.1"></times><ci id="A3.SS1.p3.2.m2.1.2.2.cmml" xref="A3.SS1.p3.2.m2.1.2.2">𝐴</ci><ci id="A3.SS1.p3.2.m2.1.2.3.cmml" xref="A3.SS1.p3.2.m2.1.2.3">𝑡</ci><ci id="A3.SS1.p3.2.m2.1.2.4.cmml" xref="A3.SS1.p3.2.m2.1.2.4">𝑡</ci><ci id="A3.SS1.p3.2.m2.1.2.5.cmml" xref="A3.SS1.p3.2.m2.1.2.5">𝑒</ci><ci id="A3.SS1.p3.2.m2.1.2.6.cmml" xref="A3.SS1.p3.2.m2.1.2.6">𝑛</ci><ci id="A3.SS1.p3.2.m2.1.2.7.cmml" xref="A3.SS1.p3.2.m2.1.2.7">𝑡</ci><ci id="A3.SS1.p3.2.m2.1.2.8.cmml" xref="A3.SS1.p3.2.m2.1.2.8">𝑖</ci><ci id="A3.SS1.p3.2.m2.1.2.9.cmml" xref="A3.SS1.p3.2.m2.1.2.9">𝑜</ci><apply id="A3.SS1.p3.2.m2.1.2.10.cmml" xref="A3.SS1.p3.2.m2.1.2.10"><csymbol cd="ambiguous" id="A3.SS1.p3.2.m2.1.2.10.1.cmml" xref="A3.SS1.p3.2.m2.1.2.10">superscript</csymbol><ci id="A3.SS1.p3.2.m2.1.2.10.2.cmml" xref="A3.SS1.p3.2.m2.1.2.10.2">𝑛</ci><ci id="A3.SS1.p3.2.m2.1.2.10.3.cmml" xref="A3.SS1.p3.2.m2.1.2.10.3">𝑙</ci></apply><ci id="A3.SS1.p3.2.m2.1.1.cmml" xref="A3.SS1.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.2.m2.1c">{Attention}^{l}(\cdot)</annotation></semantics></math>.
For the Modality-Specific Expert Networks at <math id="A3.SS1.p3.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="A3.SS1.p3.3.m3.1a"><mi id="A3.SS1.p3.3.m3.1.1" xref="A3.SS1.p3.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.3.m3.1b"><ci id="A3.SS1.p3.3.m3.1.1.cmml" xref="A3.SS1.p3.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.3.m3.1c">l</annotation></semantics></math>-th encoding layer, we use <math id="A3.SS1.p3.4.m4.1" class="ltx_Math" alttext="{FFN}^{l}_{i}(\cdot)" display="inline"><semantics id="A3.SS1.p3.4.m4.1a"><mrow id="A3.SS1.p3.4.m4.1.2" xref="A3.SS1.p3.4.m4.1.2.cmml"><mi id="A3.SS1.p3.4.m4.1.2.2" xref="A3.SS1.p3.4.m4.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.4.m4.1.2.1" xref="A3.SS1.p3.4.m4.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.4.m4.1.2.3" xref="A3.SS1.p3.4.m4.1.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.4.m4.1.2.1a" xref="A3.SS1.p3.4.m4.1.2.1.cmml">​</mo><msubsup id="A3.SS1.p3.4.m4.1.2.4" xref="A3.SS1.p3.4.m4.1.2.4.cmml"><mi id="A3.SS1.p3.4.m4.1.2.4.2.2" xref="A3.SS1.p3.4.m4.1.2.4.2.2.cmml">N</mi><mi id="A3.SS1.p3.4.m4.1.2.4.3" xref="A3.SS1.p3.4.m4.1.2.4.3.cmml">i</mi><mi id="A3.SS1.p3.4.m4.1.2.4.2.3" xref="A3.SS1.p3.4.m4.1.2.4.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="A3.SS1.p3.4.m4.1.2.1b" xref="A3.SS1.p3.4.m4.1.2.1.cmml">​</mo><mrow id="A3.SS1.p3.4.m4.1.2.5.2" xref="A3.SS1.p3.4.m4.1.2.cmml"><mo stretchy="false" id="A3.SS1.p3.4.m4.1.2.5.2.1" xref="A3.SS1.p3.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A3.SS1.p3.4.m4.1.1" xref="A3.SS1.p3.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="A3.SS1.p3.4.m4.1.2.5.2.2" xref="A3.SS1.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.4.m4.1b"><apply id="A3.SS1.p3.4.m4.1.2.cmml" xref="A3.SS1.p3.4.m4.1.2"><times id="A3.SS1.p3.4.m4.1.2.1.cmml" xref="A3.SS1.p3.4.m4.1.2.1"></times><ci id="A3.SS1.p3.4.m4.1.2.2.cmml" xref="A3.SS1.p3.4.m4.1.2.2">𝐹</ci><ci id="A3.SS1.p3.4.m4.1.2.3.cmml" xref="A3.SS1.p3.4.m4.1.2.3">𝐹</ci><apply id="A3.SS1.p3.4.m4.1.2.4.cmml" xref="A3.SS1.p3.4.m4.1.2.4"><csymbol cd="ambiguous" id="A3.SS1.p3.4.m4.1.2.4.1.cmml" xref="A3.SS1.p3.4.m4.1.2.4">subscript</csymbol><apply id="A3.SS1.p3.4.m4.1.2.4.2.cmml" xref="A3.SS1.p3.4.m4.1.2.4"><csymbol cd="ambiguous" id="A3.SS1.p3.4.m4.1.2.4.2.1.cmml" xref="A3.SS1.p3.4.m4.1.2.4">superscript</csymbol><ci id="A3.SS1.p3.4.m4.1.2.4.2.2.cmml" xref="A3.SS1.p3.4.m4.1.2.4.2.2">𝑁</ci><ci id="A3.SS1.p3.4.m4.1.2.4.2.3.cmml" xref="A3.SS1.p3.4.m4.1.2.4.2.3">𝑙</ci></apply><ci id="A3.SS1.p3.4.m4.1.2.4.3.cmml" xref="A3.SS1.p3.4.m4.1.2.4.3">𝑖</ci></apply><ci id="A3.SS1.p3.4.m4.1.1.cmml" xref="A3.SS1.p3.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.4.m4.1c">{FFN}^{l}_{i}(\cdot)</annotation></semantics></math> and <math id="A3.SS1.p3.5.m5.1" class="ltx_Math" alttext="{FFN}^{l}_{t}(\cdot)" display="inline"><semantics id="A3.SS1.p3.5.m5.1a"><mrow id="A3.SS1.p3.5.m5.1.2" xref="A3.SS1.p3.5.m5.1.2.cmml"><mi id="A3.SS1.p3.5.m5.1.2.2" xref="A3.SS1.p3.5.m5.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.5.m5.1.2.1" xref="A3.SS1.p3.5.m5.1.2.1.cmml">​</mo><mi id="A3.SS1.p3.5.m5.1.2.3" xref="A3.SS1.p3.5.m5.1.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.SS1.p3.5.m5.1.2.1a" xref="A3.SS1.p3.5.m5.1.2.1.cmml">​</mo><msubsup id="A3.SS1.p3.5.m5.1.2.4" xref="A3.SS1.p3.5.m5.1.2.4.cmml"><mi id="A3.SS1.p3.5.m5.1.2.4.2.2" xref="A3.SS1.p3.5.m5.1.2.4.2.2.cmml">N</mi><mi id="A3.SS1.p3.5.m5.1.2.4.3" xref="A3.SS1.p3.5.m5.1.2.4.3.cmml">t</mi><mi id="A3.SS1.p3.5.m5.1.2.4.2.3" xref="A3.SS1.p3.5.m5.1.2.4.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="A3.SS1.p3.5.m5.1.2.1b" xref="A3.SS1.p3.5.m5.1.2.1.cmml">​</mo><mrow id="A3.SS1.p3.5.m5.1.2.5.2" xref="A3.SS1.p3.5.m5.1.2.cmml"><mo stretchy="false" id="A3.SS1.p3.5.m5.1.2.5.2.1" xref="A3.SS1.p3.5.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A3.SS1.p3.5.m5.1.1" xref="A3.SS1.p3.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="A3.SS1.p3.5.m5.1.2.5.2.2" xref="A3.SS1.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.5.m5.1b"><apply id="A3.SS1.p3.5.m5.1.2.cmml" xref="A3.SS1.p3.5.m5.1.2"><times id="A3.SS1.p3.5.m5.1.2.1.cmml" xref="A3.SS1.p3.5.m5.1.2.1"></times><ci id="A3.SS1.p3.5.m5.1.2.2.cmml" xref="A3.SS1.p3.5.m5.1.2.2">𝐹</ci><ci id="A3.SS1.p3.5.m5.1.2.3.cmml" xref="A3.SS1.p3.5.m5.1.2.3">𝐹</ci><apply id="A3.SS1.p3.5.m5.1.2.4.cmml" xref="A3.SS1.p3.5.m5.1.2.4"><csymbol cd="ambiguous" id="A3.SS1.p3.5.m5.1.2.4.1.cmml" xref="A3.SS1.p3.5.m5.1.2.4">subscript</csymbol><apply id="A3.SS1.p3.5.m5.1.2.4.2.cmml" xref="A3.SS1.p3.5.m5.1.2.4"><csymbol cd="ambiguous" id="A3.SS1.p3.5.m5.1.2.4.2.1.cmml" xref="A3.SS1.p3.5.m5.1.2.4">superscript</csymbol><ci id="A3.SS1.p3.5.m5.1.2.4.2.2.cmml" xref="A3.SS1.p3.5.m5.1.2.4.2.2">𝑁</ci><ci id="A3.SS1.p3.5.m5.1.2.4.2.3.cmml" xref="A3.SS1.p3.5.m5.1.2.4.2.3">𝑙</ci></apply><ci id="A3.SS1.p3.5.m5.1.2.4.3.cmml" xref="A3.SS1.p3.5.m5.1.2.4.3">𝑡</ci></apply><ci id="A3.SS1.p3.5.m5.1.1.cmml" xref="A3.SS1.p3.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.5.m5.1c">{FFN}^{l}_{t}(\cdot)</annotation></semantics></math> to respectively represent the vision expert network and the language expert network.
For the sake of clarity, we have omitted Residual Connections and Layer Normalizations.</p>
</div>
<div id="A3.SS1.p4" class="ltx_para">
<p id="A3.SS1.p4.1" class="ltx_p">When dealing with only image inputs, Multiway Transformer utilizes the attention module and the visual expert network at each encoding layer:</p>
<table id="A3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E12.m1.1" class="ltx_Math" alttext="z^{l}_{i}={{FFN}^{l}_{i}(Attention}^{l}(z^{l-1}_{i}))." display="block"><semantics id="A3.E12.m1.1a"><mrow id="A3.E12.m1.1.1.1" xref="A3.E12.m1.1.1.1.1.cmml"><mrow id="A3.E12.m1.1.1.1.1" xref="A3.E12.m1.1.1.1.1.cmml"><msubsup id="A3.E12.m1.1.1.1.1.3" xref="A3.E12.m1.1.1.1.1.3.cmml"><mi id="A3.E12.m1.1.1.1.1.3.2.2" xref="A3.E12.m1.1.1.1.1.3.2.2.cmml">z</mi><mi id="A3.E12.m1.1.1.1.1.3.3" xref="A3.E12.m1.1.1.1.1.3.3.cmml">i</mi><mi id="A3.E12.m1.1.1.1.1.3.2.3" xref="A3.E12.m1.1.1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="A3.E12.m1.1.1.1.1.2" xref="A3.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="A3.E12.m1.1.1.1.1.1" xref="A3.E12.m1.1.1.1.1.1.cmml"><mi id="A3.E12.m1.1.1.1.1.1.3" xref="A3.E12.m1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.2" xref="A3.E12.m1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E12.m1.1.1.1.1.1.4" xref="A3.E12.m1.1.1.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.2a" xref="A3.E12.m1.1.1.1.1.1.2.cmml">​</mo><msubsup id="A3.E12.m1.1.1.1.1.1.5" xref="A3.E12.m1.1.1.1.1.1.5.cmml"><mi id="A3.E12.m1.1.1.1.1.1.5.2.2" xref="A3.E12.m1.1.1.1.1.1.5.2.2.cmml">N</mi><mi id="A3.E12.m1.1.1.1.1.1.5.3" xref="A3.E12.m1.1.1.1.1.1.5.3.cmml">i</mi><mi id="A3.E12.m1.1.1.1.1.1.5.2.3" xref="A3.E12.m1.1.1.1.1.1.5.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.2b" xref="A3.E12.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E12.m1.1.1.1.1.1.1.1" xref="A3.E12.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E12.m1.1.1.1.1.1.1.1.2" xref="A3.E12.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E12.m1.1.1.1.1.1.1.1.1" xref="A3.E12.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.3" xref="A3.E12.m1.1.1.1.1.1.1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.4" xref="A3.E12.m1.1.1.1.1.1.1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2a" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.5" xref="A3.E12.m1.1.1.1.1.1.1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2b" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.6" xref="A3.E12.m1.1.1.1.1.1.1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2c" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.7" xref="A3.E12.m1.1.1.1.1.1.1.1.1.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2d" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.8" xref="A3.E12.m1.1.1.1.1.1.1.1.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2e" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.9" xref="A3.E12.m1.1.1.1.1.1.1.1.1.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2f" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.10" xref="A3.E12.m1.1.1.1.1.1.1.1.1.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2g" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="A3.E12.m1.1.1.1.1.1.1.1.1.11" xref="A3.E12.m1.1.1.1.1.1.1.1.1.11.cmml"><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.11.2" xref="A3.E12.m1.1.1.1.1.1.1.1.1.11.2.cmml">n</mi><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.11.3" xref="A3.E12.m1.1.1.1.1.1.1.1.1.11.3.cmml">l</mi></msup><mo lspace="0em" rspace="0em" id="A3.E12.m1.1.1.1.1.1.1.1.1.2h" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mrow id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">l</mi><mo id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A3.E12.m1.1.1.1.1.1.1.1.3" xref="A3.E12.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A3.E12.m1.1.1.1.2" xref="A3.E12.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E12.m1.1b"><apply id="A3.E12.m1.1.1.1.1.cmml" xref="A3.E12.m1.1.1.1"><eq id="A3.E12.m1.1.1.1.1.2.cmml" xref="A3.E12.m1.1.1.1.1.2"></eq><apply id="A3.E12.m1.1.1.1.1.3.cmml" xref="A3.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E12.m1.1.1.1.1.3.1.cmml" xref="A3.E12.m1.1.1.1.1.3">subscript</csymbol><apply id="A3.E12.m1.1.1.1.1.3.2.cmml" xref="A3.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E12.m1.1.1.1.1.3.2.1.cmml" xref="A3.E12.m1.1.1.1.1.3">superscript</csymbol><ci id="A3.E12.m1.1.1.1.1.3.2.2.cmml" xref="A3.E12.m1.1.1.1.1.3.2.2">𝑧</ci><ci id="A3.E12.m1.1.1.1.1.3.2.3.cmml" xref="A3.E12.m1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="A3.E12.m1.1.1.1.1.3.3.cmml" xref="A3.E12.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A3.E12.m1.1.1.1.1.1.cmml" xref="A3.E12.m1.1.1.1.1.1"><times id="A3.E12.m1.1.1.1.1.1.2.cmml" xref="A3.E12.m1.1.1.1.1.1.2"></times><ci id="A3.E12.m1.1.1.1.1.1.3.cmml" xref="A3.E12.m1.1.1.1.1.1.3">𝐹</ci><ci id="A3.E12.m1.1.1.1.1.1.4.cmml" xref="A3.E12.m1.1.1.1.1.1.4">𝐹</ci><apply id="A3.E12.m1.1.1.1.1.1.5.cmml" xref="A3.E12.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A3.E12.m1.1.1.1.1.1.5.1.cmml" xref="A3.E12.m1.1.1.1.1.1.5">subscript</csymbol><apply id="A3.E12.m1.1.1.1.1.1.5.2.cmml" xref="A3.E12.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A3.E12.m1.1.1.1.1.1.5.2.1.cmml" xref="A3.E12.m1.1.1.1.1.1.5">superscript</csymbol><ci id="A3.E12.m1.1.1.1.1.1.5.2.2.cmml" xref="A3.E12.m1.1.1.1.1.1.5.2.2">𝑁</ci><ci id="A3.E12.m1.1.1.1.1.1.5.2.3.cmml" xref="A3.E12.m1.1.1.1.1.1.5.2.3">𝑙</ci></apply><ci id="A3.E12.m1.1.1.1.1.1.5.3.cmml" xref="A3.E12.m1.1.1.1.1.1.5.3">𝑖</ci></apply><apply id="A3.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1"><times id="A3.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.2"></times><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.3">𝐴</ci><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.4">𝑡</ci><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.5.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.5">𝑡</ci><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.6.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.6">𝑒</ci><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.7.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.7">𝑛</ci><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.8.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.8">𝑡</ci><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.9.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.9">𝑖</ci><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.10.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.10">𝑜</ci><apply id="A3.E12.m1.1.1.1.1.1.1.1.1.11.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.11"><csymbol cd="ambiguous" id="A3.E12.m1.1.1.1.1.1.1.1.1.11.1.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.11">superscript</csymbol><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.11.2.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.11.2">𝑛</ci><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.11.3.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.11.3">𝑙</ci></apply><apply id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><apply id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"><minus id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑙</ci><cn type="integer" id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E12.m1.1c">z^{l}_{i}={{FFN}^{l}_{i}(Attention}^{l}(z^{l-1}_{i})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div id="A3.SS1.p5" class="ltx_para">
<p id="A3.SS1.p5.1" class="ltx_p">When dealing with only text inputs, Multiway Transformer utilizes the attention module and the language expert network at each encoding layer:</p>
<table id="A3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E13.m1.1" class="ltx_Math" alttext="z^{l}_{t}={{FFN}^{l}_{t}(Attention}^{l}(z^{l-1}_{t}))." display="block"><semantics id="A3.E13.m1.1a"><mrow id="A3.E13.m1.1.1.1" xref="A3.E13.m1.1.1.1.1.cmml"><mrow id="A3.E13.m1.1.1.1.1" xref="A3.E13.m1.1.1.1.1.cmml"><msubsup id="A3.E13.m1.1.1.1.1.3" xref="A3.E13.m1.1.1.1.1.3.cmml"><mi id="A3.E13.m1.1.1.1.1.3.2.2" xref="A3.E13.m1.1.1.1.1.3.2.2.cmml">z</mi><mi id="A3.E13.m1.1.1.1.1.3.3" xref="A3.E13.m1.1.1.1.1.3.3.cmml">t</mi><mi id="A3.E13.m1.1.1.1.1.3.2.3" xref="A3.E13.m1.1.1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="A3.E13.m1.1.1.1.1.2" xref="A3.E13.m1.1.1.1.1.2.cmml">=</mo><mrow id="A3.E13.m1.1.1.1.1.1" xref="A3.E13.m1.1.1.1.1.1.cmml"><mi id="A3.E13.m1.1.1.1.1.1.3" xref="A3.E13.m1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.2" xref="A3.E13.m1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E13.m1.1.1.1.1.1.4" xref="A3.E13.m1.1.1.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.2a" xref="A3.E13.m1.1.1.1.1.1.2.cmml">​</mo><msubsup id="A3.E13.m1.1.1.1.1.1.5" xref="A3.E13.m1.1.1.1.1.1.5.cmml"><mi id="A3.E13.m1.1.1.1.1.1.5.2.2" xref="A3.E13.m1.1.1.1.1.1.5.2.2.cmml">N</mi><mi id="A3.E13.m1.1.1.1.1.1.5.3" xref="A3.E13.m1.1.1.1.1.1.5.3.cmml">t</mi><mi id="A3.E13.m1.1.1.1.1.1.5.2.3" xref="A3.E13.m1.1.1.1.1.1.5.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.2b" xref="A3.E13.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E13.m1.1.1.1.1.1.1.1" xref="A3.E13.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E13.m1.1.1.1.1.1.1.1.2" xref="A3.E13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E13.m1.1.1.1.1.1.1.1.1" xref="A3.E13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.1.1.1.1.1.1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.4" xref="A3.E13.m1.1.1.1.1.1.1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2a" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.5" xref="A3.E13.m1.1.1.1.1.1.1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2b" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.6" xref="A3.E13.m1.1.1.1.1.1.1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2c" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.7" xref="A3.E13.m1.1.1.1.1.1.1.1.1.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2d" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.8" xref="A3.E13.m1.1.1.1.1.1.1.1.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2e" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.9" xref="A3.E13.m1.1.1.1.1.1.1.1.1.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2f" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.10" xref="A3.E13.m1.1.1.1.1.1.1.1.1.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2g" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="A3.E13.m1.1.1.1.1.1.1.1.1.11" xref="A3.E13.m1.1.1.1.1.1.1.1.1.11.cmml"><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.11.2" xref="A3.E13.m1.1.1.1.1.1.1.1.1.11.2.cmml">n</mi><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.11.3" xref="A3.E13.m1.1.1.1.1.1.1.1.1.11.3.cmml">l</mi></msup><mo lspace="0em" rspace="0em" id="A3.E13.m1.1.1.1.1.1.1.1.1.2h" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi><mrow id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">l</mi><mo id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A3.E13.m1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A3.E13.m1.1.1.1.2" xref="A3.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E13.m1.1b"><apply id="A3.E13.m1.1.1.1.1.cmml" xref="A3.E13.m1.1.1.1"><eq id="A3.E13.m1.1.1.1.1.2.cmml" xref="A3.E13.m1.1.1.1.1.2"></eq><apply id="A3.E13.m1.1.1.1.1.3.cmml" xref="A3.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13.m1.1.1.1.1.3.1.cmml" xref="A3.E13.m1.1.1.1.1.3">subscript</csymbol><apply id="A3.E13.m1.1.1.1.1.3.2.cmml" xref="A3.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13.m1.1.1.1.1.3.2.1.cmml" xref="A3.E13.m1.1.1.1.1.3">superscript</csymbol><ci id="A3.E13.m1.1.1.1.1.3.2.2.cmml" xref="A3.E13.m1.1.1.1.1.3.2.2">𝑧</ci><ci id="A3.E13.m1.1.1.1.1.3.2.3.cmml" xref="A3.E13.m1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="A3.E13.m1.1.1.1.1.3.3.cmml" xref="A3.E13.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A3.E13.m1.1.1.1.1.1.cmml" xref="A3.E13.m1.1.1.1.1.1"><times id="A3.E13.m1.1.1.1.1.1.2.cmml" xref="A3.E13.m1.1.1.1.1.1.2"></times><ci id="A3.E13.m1.1.1.1.1.1.3.cmml" xref="A3.E13.m1.1.1.1.1.1.3">𝐹</ci><ci id="A3.E13.m1.1.1.1.1.1.4.cmml" xref="A3.E13.m1.1.1.1.1.1.4">𝐹</ci><apply id="A3.E13.m1.1.1.1.1.1.5.cmml" xref="A3.E13.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A3.E13.m1.1.1.1.1.1.5.1.cmml" xref="A3.E13.m1.1.1.1.1.1.5">subscript</csymbol><apply id="A3.E13.m1.1.1.1.1.1.5.2.cmml" xref="A3.E13.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A3.E13.m1.1.1.1.1.1.5.2.1.cmml" xref="A3.E13.m1.1.1.1.1.1.5">superscript</csymbol><ci id="A3.E13.m1.1.1.1.1.1.5.2.2.cmml" xref="A3.E13.m1.1.1.1.1.1.5.2.2">𝑁</ci><ci id="A3.E13.m1.1.1.1.1.1.5.2.3.cmml" xref="A3.E13.m1.1.1.1.1.1.5.2.3">𝑙</ci></apply><ci id="A3.E13.m1.1.1.1.1.1.5.3.cmml" xref="A3.E13.m1.1.1.1.1.1.5.3">𝑡</ci></apply><apply id="A3.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1"><times id="A3.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.2"></times><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.3">𝐴</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.4">𝑡</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.5.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.5">𝑡</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.6.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.6">𝑒</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.7.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.7">𝑛</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.8.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.8">𝑡</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.9.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.9">𝑖</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.10.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.10">𝑜</ci><apply id="A3.E13.m1.1.1.1.1.1.1.1.1.11.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.11"><csymbol cd="ambiguous" id="A3.E13.m1.1.1.1.1.1.1.1.1.11.1.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.11">superscript</csymbol><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.11.2.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.11.2">𝑛</ci><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.11.3.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.11.3">𝑙</ci></apply><apply id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><apply id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"><minus id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑙</ci><cn type="integer" id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E13.m1.1c">z^{l}_{t}={{FFN}^{l}_{t}(Attention}^{l}(z^{l-1}_{t})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div id="A3.SS1.p6" class="ltx_para">
<p id="A3.SS1.p6.1" class="ltx_p">When dealing with image-text pairs, Multiway Transformer first employs the shared self-attention module for cross-modal interaction:</p>
<table id="A3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E14.m1.1" class="ltx_Math" alttext="a^{l}=cat(a^{l}_{i},a^{l}_{t})={Attention}^{l}(z^{l-1})." display="block"><semantics id="A3.E14.m1.1a"><mrow id="A3.E14.m1.1.1.1" xref="A3.E14.m1.1.1.1.1.cmml"><mrow id="A3.E14.m1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.cmml"><msup id="A3.E14.m1.1.1.1.1.5" xref="A3.E14.m1.1.1.1.1.5.cmml"><mi id="A3.E14.m1.1.1.1.1.5.2" xref="A3.E14.m1.1.1.1.1.5.2.cmml">a</mi><mi id="A3.E14.m1.1.1.1.1.5.3" xref="A3.E14.m1.1.1.1.1.5.3.cmml">l</mi></msup><mo id="A3.E14.m1.1.1.1.1.6" xref="A3.E14.m1.1.1.1.1.6.cmml">=</mo><mrow id="A3.E14.m1.1.1.1.1.2" xref="A3.E14.m1.1.1.1.1.2.cmml"><mi id="A3.E14.m1.1.1.1.1.2.4" xref="A3.E14.m1.1.1.1.1.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.2.3" xref="A3.E14.m1.1.1.1.1.2.3.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.2.5" xref="A3.E14.m1.1.1.1.1.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.2.3a" xref="A3.E14.m1.1.1.1.1.2.3.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.2.6" xref="A3.E14.m1.1.1.1.1.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.2.3b" xref="A3.E14.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="A3.E14.m1.1.1.1.1.2.2.2" xref="A3.E14.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="A3.E14.m1.1.1.1.1.2.2.2.3" xref="A3.E14.m1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="A3.E14.m1.1.1.1.1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E14.m1.1.1.1.1.1.1.1.1.2.2" xref="A3.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A3.E14.m1.1.1.1.1.1.1.1.1.3" xref="A3.E14.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="A3.E14.m1.1.1.1.1.1.1.1.1.2.3" xref="A3.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="A3.E14.m1.1.1.1.1.2.2.2.4" xref="A3.E14.m1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="A3.E14.m1.1.1.1.1.2.2.2.2" xref="A3.E14.m1.1.1.1.1.2.2.2.2.cmml"><mi id="A3.E14.m1.1.1.1.1.2.2.2.2.2.2" xref="A3.E14.m1.1.1.1.1.2.2.2.2.2.2.cmml">a</mi><mi id="A3.E14.m1.1.1.1.1.2.2.2.2.3" xref="A3.E14.m1.1.1.1.1.2.2.2.2.3.cmml">t</mi><mi id="A3.E14.m1.1.1.1.1.2.2.2.2.2.3" xref="A3.E14.m1.1.1.1.1.2.2.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="A3.E14.m1.1.1.1.1.2.2.2.5" xref="A3.E14.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E14.m1.1.1.1.1.7" xref="A3.E14.m1.1.1.1.1.7.cmml">=</mo><mrow id="A3.E14.m1.1.1.1.1.3" xref="A3.E14.m1.1.1.1.1.3.cmml"><mi id="A3.E14.m1.1.1.1.1.3.3" xref="A3.E14.m1.1.1.1.1.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.3.4" xref="A3.E14.m1.1.1.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2a" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.3.5" xref="A3.E14.m1.1.1.1.1.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2b" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.3.6" xref="A3.E14.m1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2c" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.3.7" xref="A3.E14.m1.1.1.1.1.3.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2d" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.3.8" xref="A3.E14.m1.1.1.1.1.3.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2e" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.3.9" xref="A3.E14.m1.1.1.1.1.3.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2f" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><mi id="A3.E14.m1.1.1.1.1.3.10" xref="A3.E14.m1.1.1.1.1.3.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2g" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><msup id="A3.E14.m1.1.1.1.1.3.11" xref="A3.E14.m1.1.1.1.1.3.11.cmml"><mi id="A3.E14.m1.1.1.1.1.3.11.2" xref="A3.E14.m1.1.1.1.1.3.11.2.cmml">n</mi><mi id="A3.E14.m1.1.1.1.1.3.11.3" xref="A3.E14.m1.1.1.1.1.3.11.3.cmml">l</mi></msup><mo lspace="0em" rspace="0em" id="A3.E14.m1.1.1.1.1.3.2h" xref="A3.E14.m1.1.1.1.1.3.2.cmml">​</mo><mrow id="A3.E14.m1.1.1.1.1.3.1.1" xref="A3.E14.m1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="A3.E14.m1.1.1.1.1.3.1.1.2" xref="A3.E14.m1.1.1.1.1.3.1.1.1.cmml">(</mo><msup id="A3.E14.m1.1.1.1.1.3.1.1.1" xref="A3.E14.m1.1.1.1.1.3.1.1.1.cmml"><mi id="A3.E14.m1.1.1.1.1.3.1.1.1.2" xref="A3.E14.m1.1.1.1.1.3.1.1.1.2.cmml">z</mi><mrow id="A3.E14.m1.1.1.1.1.3.1.1.1.3" xref="A3.E14.m1.1.1.1.1.3.1.1.1.3.cmml"><mi id="A3.E14.m1.1.1.1.1.3.1.1.1.3.2" xref="A3.E14.m1.1.1.1.1.3.1.1.1.3.2.cmml">l</mi><mo id="A3.E14.m1.1.1.1.1.3.1.1.1.3.1" xref="A3.E14.m1.1.1.1.1.3.1.1.1.3.1.cmml">−</mo><mn id="A3.E14.m1.1.1.1.1.3.1.1.1.3.3" xref="A3.E14.m1.1.1.1.1.3.1.1.1.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="A3.E14.m1.1.1.1.1.3.1.1.3" xref="A3.E14.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A3.E14.m1.1.1.1.2" xref="A3.E14.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E14.m1.1b"><apply id="A3.E14.m1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1"><and id="A3.E14.m1.1.1.1.1a.cmml" xref="A3.E14.m1.1.1.1"></and><apply id="A3.E14.m1.1.1.1.1b.cmml" xref="A3.E14.m1.1.1.1"><eq id="A3.E14.m1.1.1.1.1.6.cmml" xref="A3.E14.m1.1.1.1.1.6"></eq><apply id="A3.E14.m1.1.1.1.1.5.cmml" xref="A3.E14.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.5.1.cmml" xref="A3.E14.m1.1.1.1.1.5">superscript</csymbol><ci id="A3.E14.m1.1.1.1.1.5.2.cmml" xref="A3.E14.m1.1.1.1.1.5.2">𝑎</ci><ci id="A3.E14.m1.1.1.1.1.5.3.cmml" xref="A3.E14.m1.1.1.1.1.5.3">𝑙</ci></apply><apply id="A3.E14.m1.1.1.1.1.2.cmml" xref="A3.E14.m1.1.1.1.1.2"><times id="A3.E14.m1.1.1.1.1.2.3.cmml" xref="A3.E14.m1.1.1.1.1.2.3"></times><ci id="A3.E14.m1.1.1.1.1.2.4.cmml" xref="A3.E14.m1.1.1.1.1.2.4">𝑐</ci><ci id="A3.E14.m1.1.1.1.1.2.5.cmml" xref="A3.E14.m1.1.1.1.1.2.5">𝑎</ci><ci id="A3.E14.m1.1.1.1.1.2.6.cmml" xref="A3.E14.m1.1.1.1.1.2.6">𝑡</ci><interval closure="open" id="A3.E14.m1.1.1.1.1.2.2.3.cmml" xref="A3.E14.m1.1.1.1.1.2.2.2"><apply id="A3.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A3.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A3.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="A3.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A3.E14.m1.1.1.1.1.2.2.2.2.cmml" xref="A3.E14.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.2.2.2.2.1.cmml" xref="A3.E14.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="A3.E14.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.E14.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A3.E14.m1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="A3.E14.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A3.E14.m1.1.1.1.1.2.2.2.2.2.2">𝑎</ci><ci id="A3.E14.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A3.E14.m1.1.1.1.1.2.2.2.2.2.3">𝑙</ci></apply><ci id="A3.E14.m1.1.1.1.1.2.2.2.2.3.cmml" xref="A3.E14.m1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="A3.E14.m1.1.1.1.1c.cmml" xref="A3.E14.m1.1.1.1"><eq id="A3.E14.m1.1.1.1.1.7.cmml" xref="A3.E14.m1.1.1.1.1.7"></eq><share href="#A3.E14.m1.1.1.1.1.2.cmml" id="A3.E14.m1.1.1.1.1d.cmml" xref="A3.E14.m1.1.1.1"></share><apply id="A3.E14.m1.1.1.1.1.3.cmml" xref="A3.E14.m1.1.1.1.1.3"><times id="A3.E14.m1.1.1.1.1.3.2.cmml" xref="A3.E14.m1.1.1.1.1.3.2"></times><ci id="A3.E14.m1.1.1.1.1.3.3.cmml" xref="A3.E14.m1.1.1.1.1.3.3">𝐴</ci><ci id="A3.E14.m1.1.1.1.1.3.4.cmml" xref="A3.E14.m1.1.1.1.1.3.4">𝑡</ci><ci id="A3.E14.m1.1.1.1.1.3.5.cmml" xref="A3.E14.m1.1.1.1.1.3.5">𝑡</ci><ci id="A3.E14.m1.1.1.1.1.3.6.cmml" xref="A3.E14.m1.1.1.1.1.3.6">𝑒</ci><ci id="A3.E14.m1.1.1.1.1.3.7.cmml" xref="A3.E14.m1.1.1.1.1.3.7">𝑛</ci><ci id="A3.E14.m1.1.1.1.1.3.8.cmml" xref="A3.E14.m1.1.1.1.1.3.8">𝑡</ci><ci id="A3.E14.m1.1.1.1.1.3.9.cmml" xref="A3.E14.m1.1.1.1.1.3.9">𝑖</ci><ci id="A3.E14.m1.1.1.1.1.3.10.cmml" xref="A3.E14.m1.1.1.1.1.3.10">𝑜</ci><apply id="A3.E14.m1.1.1.1.1.3.11.cmml" xref="A3.E14.m1.1.1.1.1.3.11"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.3.11.1.cmml" xref="A3.E14.m1.1.1.1.1.3.11">superscript</csymbol><ci id="A3.E14.m1.1.1.1.1.3.11.2.cmml" xref="A3.E14.m1.1.1.1.1.3.11.2">𝑛</ci><ci id="A3.E14.m1.1.1.1.1.3.11.3.cmml" xref="A3.E14.m1.1.1.1.1.3.11.3">𝑙</ci></apply><apply id="A3.E14.m1.1.1.1.1.3.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.3.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.3.1.1">superscript</csymbol><ci id="A3.E14.m1.1.1.1.1.3.1.1.1.2.cmml" xref="A3.E14.m1.1.1.1.1.3.1.1.1.2">𝑧</ci><apply id="A3.E14.m1.1.1.1.1.3.1.1.1.3.cmml" xref="A3.E14.m1.1.1.1.1.3.1.1.1.3"><minus id="A3.E14.m1.1.1.1.1.3.1.1.1.3.1.cmml" xref="A3.E14.m1.1.1.1.1.3.1.1.1.3.1"></minus><ci id="A3.E14.m1.1.1.1.1.3.1.1.1.3.2.cmml" xref="A3.E14.m1.1.1.1.1.3.1.1.1.3.2">𝑙</ci><cn type="integer" id="A3.E14.m1.1.1.1.1.3.1.1.1.3.3.cmml" xref="A3.E14.m1.1.1.1.1.3.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E14.m1.1c">a^{l}=cat(a^{l}_{i},a^{l}_{t})={Attention}^{l}(z^{l-1}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.p6.2" class="ltx_p">Subsequently, individual expert networks are applied to tokens from the corresponding modality:</p>
<table id="A3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E15.m1.1" class="ltx_Math" alttext="z^{l}=cat({FFN}^{l}_{i}(a^{l}_{i}),{FFN}^{l}_{t}(a^{l}_{t}))." display="block"><semantics id="A3.E15.m1.1a"><mrow id="A3.E15.m1.1.1.1" xref="A3.E15.m1.1.1.1.1.cmml"><mrow id="A3.E15.m1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.cmml"><msup id="A3.E15.m1.1.1.1.1.4" xref="A3.E15.m1.1.1.1.1.4.cmml"><mi id="A3.E15.m1.1.1.1.1.4.2" xref="A3.E15.m1.1.1.1.1.4.2.cmml">z</mi><mi id="A3.E15.m1.1.1.1.1.4.3" xref="A3.E15.m1.1.1.1.1.4.3.cmml">l</mi></msup><mo id="A3.E15.m1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.3.cmml">=</mo><mrow id="A3.E15.m1.1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.2.cmml"><mi id="A3.E15.m1.1.1.1.1.2.4" xref="A3.E15.m1.1.1.1.1.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.3" xref="A3.E15.m1.1.1.1.1.2.3.cmml">​</mo><mi id="A3.E15.m1.1.1.1.1.2.5" xref="A3.E15.m1.1.1.1.1.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.3a" xref="A3.E15.m1.1.1.1.1.2.3.cmml">​</mo><mi id="A3.E15.m1.1.1.1.1.2.6" xref="A3.E15.m1.1.1.1.1.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.3b" xref="A3.E15.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="A3.E15.m1.1.1.1.1.2.2.2" xref="A3.E15.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="A3.E15.m1.1.1.1.1.2.2.2.3" xref="A3.E15.m1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="A3.E15.m1.1.1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.4" xref="A3.E15.m1.1.1.1.1.1.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.1.1.1.1.2a" xref="A3.E15.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msubsup id="A3.E15.m1.1.1.1.1.1.1.1.1.5" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5.cmml"><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.2" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.2.cmml">N</mi><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.5.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5.3.cmml">i</mi><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.1.1.1.1.2b" xref="A3.E15.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E15.m1.1.1.1.1.2.2.2.4" xref="A3.E15.m1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="A3.E15.m1.1.1.1.1.2.2.2.2" xref="A3.E15.m1.1.1.1.1.2.2.2.2.cmml"><mi id="A3.E15.m1.1.1.1.1.2.2.2.2.3" xref="A3.E15.m1.1.1.1.1.2.2.2.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.2.2.2.2" xref="A3.E15.m1.1.1.1.1.2.2.2.2.2.cmml">​</mo><mi id="A3.E15.m1.1.1.1.1.2.2.2.2.4" xref="A3.E15.m1.1.1.1.1.2.2.2.2.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.2.2.2.2a" xref="A3.E15.m1.1.1.1.1.2.2.2.2.2.cmml">​</mo><msubsup id="A3.E15.m1.1.1.1.1.2.2.2.2.5" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5.cmml"><mi id="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.2" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.2.cmml">N</mi><mi id="A3.E15.m1.1.1.1.1.2.2.2.2.5.3" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5.3.cmml">t</mi><mi id="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.3" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.2.2.2.2b" xref="A3.E15.m1.1.1.1.1.2.2.2.2.2.cmml">​</mo><mrow id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.2" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.cmml"><mi id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.2" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.2.cmml">a</mi><mi id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.3" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.3.cmml">t</mi><mi id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.3" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.3" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A3.E15.m1.1.1.1.1.2.2.2.5" xref="A3.E15.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A3.E15.m1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E15.m1.1b"><apply id="A3.E15.m1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1"><eq id="A3.E15.m1.1.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.3"></eq><apply id="A3.E15.m1.1.1.1.1.4.cmml" xref="A3.E15.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.4.1.cmml" xref="A3.E15.m1.1.1.1.1.4">superscript</csymbol><ci id="A3.E15.m1.1.1.1.1.4.2.cmml" xref="A3.E15.m1.1.1.1.1.4.2">𝑧</ci><ci id="A3.E15.m1.1.1.1.1.4.3.cmml" xref="A3.E15.m1.1.1.1.1.4.3">𝑙</ci></apply><apply id="A3.E15.m1.1.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.2"><times id="A3.E15.m1.1.1.1.1.2.3.cmml" xref="A3.E15.m1.1.1.1.1.2.3"></times><ci id="A3.E15.m1.1.1.1.1.2.4.cmml" xref="A3.E15.m1.1.1.1.1.2.4">𝑐</ci><ci id="A3.E15.m1.1.1.1.1.2.5.cmml" xref="A3.E15.m1.1.1.1.1.2.5">𝑎</ci><ci id="A3.E15.m1.1.1.1.1.2.6.cmml" xref="A3.E15.m1.1.1.1.1.2.6">𝑡</ci><interval closure="open" id="A3.E15.m1.1.1.1.1.2.2.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2"><apply id="A3.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1"><times id="A3.E15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.2"></times><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.3">𝐹</ci><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.4">𝐹</ci><apply id="A3.E15.m1.1.1.1.1.1.1.1.1.5.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.1.1.1.1.5.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5">subscript</csymbol><apply id="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5">superscript</csymbol><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.2">𝑁</ci><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5.2.3">𝑙</ci></apply><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.5.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.5.3">𝑖</ci></apply><apply id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A3.E15.m1.1.1.1.1.2.2.2.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2"><times id="A3.E15.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.2"></times><ci id="A3.E15.m1.1.1.1.1.2.2.2.2.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.3">𝐹</ci><ci id="A3.E15.m1.1.1.1.1.2.2.2.2.4.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.4">𝐹</ci><apply id="A3.E15.m1.1.1.1.1.2.2.2.2.5.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.2.2.2.2.5.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5">subscript</csymbol><apply id="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5">superscript</csymbol><ci id="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.2">𝑁</ci><ci id="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5.2.3">𝑙</ci></apply><ci id="A3.E15.m1.1.1.1.1.2.2.2.2.5.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.5.3">𝑡</ci></apply><apply id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1">subscript</csymbol><apply id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1">superscript</csymbol><ci id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.2">𝑎</ci><ci id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.2.3">𝑙</ci></apply><ci id="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.2.2.1.1.1.3">𝑡</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E15.m1.1c">z^{l}=cat({FFN}^{l}_{i}(a^{l}_{i}),{FFN}^{l}_{t}(a^{l}_{t})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div id="A3.SS1.p7" class="ltx_para">
<p id="A3.SS1.p7.1" class="ltx_p">By utilizing Modality-Specific Expert Networks, Multiway Transformers can switch to different encoders.</p>
</div>
</section>
<section id="A3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Decoupling Framework and Model</h3>

<div id="A3.SS2.p1" class="ltx_para">
<p id="A3.SS2.p1.1" class="ltx_p">It is important to highlight that <span id="A3.SS2.p1.1.1" class="ltx_text ltx_font_bold">PmcmFL is a universal framework and the encoders used in our PmcmFL are not limited to the Multiway Transformer</span>
In fact, our framework is flexible to incorporate with encoders of other architectures.</p>
</div>
<figure id="A3.F6" class="ltx_figure"><img src="/html/2312.13508/assets/pic_suppl/model.png" id="A3.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="161" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Comparison of general multimodal models and the multimodal model we used.
The main difference lies in the architecture of the encoder: we adopt the Multiway Transformer, whereas general multimodal models use modality-specific encoders.
</figcaption>
</figure>
<div id="A3.SS2.p2" class="ltx_para">
<p id="A3.SS2.p2.1" class="ltx_p">Figure <a href="#A3.F6" title="Figure 6 ‣ C.2 Decoupling Framework and Model ‣ Appendix C Details on Multiway Transformer ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> illustrates the general architecture of multimodal models and the architecture we use. The same as ours, general multimodal models consist of three main parts: modality-specific encoders, a fusion module, and a task head.</p>
</div>
<div id="A3.SS2.p3" class="ltx_para">
<p id="A3.SS2.p3.1" class="ltx_p">Due to the similar architecture, general multimodal models can be easily developed in our PmcmFL. To elaborate, we can construct a prototype library by utilizing the outputs of modality-specific encoders and the fusion module.
Based on the prototype library, PmcmFL can execute as usual.</p>
</div>
<div id="A3.SS2.p4" class="ltx_para">
<p id="A3.SS2.p4.1" class="ltx_p">It is worth noting that if the fusion module employs the Transformer architecture, it could be a wise move to integrate a module of bottleneck architecture after the modality-specific encoders to obtain low-dimension representation for computing prototypes, which will significantly reduce federated communication overhead.</p>
</div>
<div id="A3.SS2.p5" class="ltx_para">
<p id="A3.SS2.p5.1" class="ltx_p">The reason we adopt Multiway Transformer is due to its superior ability in handling multimodal interaction.
In our PmcmFL, Multiway Transformer not only functions as modality-specific encoders but also functions as dual-stream interactive encoders to achieve better modality fusion.</p>
</div>
</section>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Details on the Dataset</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">In this section, we provide a detailed description of the construction process for ting VQA, along with visualizations for non-IID data and modality missing.</p>
</div>
<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Tiny VQA</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.1" class="ltx_p">Due to the typically slower convergence of models in federated learning, the training cost is significantly increased.
The full scale of VQAv2 is too extensive for evaluating federated learning frameworks.
Therefore, we evaluate on a <span id="A4.SS1.p1.1.1" class="ltx_text ltx_font_bold">randomly selected subset</span> of VQAv2.
This approach has been demonstrated in prior works, such as CreamFL.</p>
</div>
<div id="A4.SS1.p2" class="ltx_para">
<p id="A4.SS1.p2.1" class="ltx_p">Our tiny VQA is a scaled-down version, reducing both label quantity and training data volume to one-tenth of the original VQA task.
The original VQA is commonly seen as a classification task with over 3,000 classes, supported by a vast training dataset exceeding 640,000 samples.
We refine the labels by excluding those with fewer than 180 occurrences, reshaping VQA into a classification challenge with 310 classes.
For training, we randomly chose 64,000 image-text pairs, equivalent to one-tenth of the combined original VQA task training and validation sets.
Additionally, our test set comprises 5,000 random image-text pairs randomly selected, ensuring none overlap with the training set.
All experiments are conducted on ting VQA, except when compared with CreamFL.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Visualization for Data Distribution</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.1" class="ltx_p">To simulate real-world scenarios, we distributed the training data of tiny VQA across 30 clients, using a Dirichlet distribution with a hyperparameter of 0.1 as the basis for non-IID partitioning.
Previous works involving non-IID have almost adopted this hyperparameter setting, which describes a severe non-IID scenario.</p>
</div>
<div id="A4.SS2.p2" class="ltx_para">
<p id="A4.SS2.p2.1" class="ltx_p">Additionally, to simulate uncertain modality missing, we assigned a fixed missing rate for each modality on every client, thereby conforming to the Bernoulli distribution.
In our experiments, we considered five missing ratios: 10%, 20%, 30%, 40%, and 50%.</p>
</div>
<div id="A4.SS2.p3" class="ltx_para">
<p id="A4.SS2.p3.1" class="ltx_p">We visualized the data/modality distribution to illustrate the corresponding non-IIDness and modalities missingness as follows.</p>
</div>
<figure id="A4.F7" class="ltx_figure"><img src="/html/2312.13508/assets/pic_suppl/noniid.png" id="A4.F7.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="287" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>The data distribution of diverse classes on each client. The size of the dots represents the amount of data.</figcaption>
</figure>
<figure id="A4.F8" class="ltx_figure"><img src="/html/2312.13508/assets/pic_suppl/missing.png" id="A4.F8.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="322" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>The modality distribution of various clients under different modality missing rates.
The size of the dots represents the amount of data.</figcaption>
</figure>
<div id="A4.SS2.p4" class="ltx_para">
<p id="A4.SS2.p4.1" class="ltx_p"><span id="A4.SS2.p4.1.1" class="ltx_text ltx_font_bold">Visualization for Non-IIDness.</span>
We selected 40 classes from a pool of 310, visualizing their distribution across various clients.
Figure <a href="#A4.F7" title="Figure 7 ‣ D.2 Visualization for Data Distribution ‣ Appendix D Details on the Dataset ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> displays the diversified results of the visualization, indicating the heterogeneous class distribution across clients.</p>
</div>
<div id="A4.SS2.p5" class="ltx_para">
<p id="A4.SS2.p5.1" class="ltx_p"><span id="A4.SS2.p5.1.1" class="ltx_text ltx_font_bold">Visualization for Modality Missingness.</span>
We visualized the modality distribution on various clients under different modality missing rates.
Figure <a href="#A4.F8" title="Figure 8 ‣ D.2 Visualization for Data Distribution ‣ Appendix D Details on the Dataset ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> displays the visualization results, showing the diversified modality distribution.</p>
</div>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Details on the Model</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">In this section, we explain the model architecture used in our experiments.</p>
</div>
<div id="A5.p2" class="ltx_para">
<p id="A5.p2.1" class="ltx_p">For the Multiway Transformer encoder, we employ the architecture of BEIT3-base, which consists of 12 encoding layers. Detailed model architecture can be found in BEIT3’s GitHub repository<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>BEIT3’s GitHub repository: <a target="_blank" href="https://github.com/microsoft/unilm/tree/master/beit3" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/microsoft/unilm/tree/master/beit3</a></span></span></span>.
We make no modifications to the encoder architecture and utilize its pre-trained weight (pre-training data does not include VQAv2).
It is worth noting that when the input is an image-text pair, the original model only uses the image CLS token for subsequent tasks, whereas we utilize both the image CLS and the text CLS token.
We simply add an additional output to accommodate our PmcmFL.</p>
</div>
<div id="A5.p3" class="ltx_para">
<p id="A5.p3.1" class="ltx_p">For the fusion module, we first apply layer normalization to the image CLS token and the text CLS token separately, then concatenate them. Subsequently, a linear layer and activation layer are applied to obtain the corresponding fusion representation.
The dimensions of both the CLS tokens and the fusion representations are 1×768.</p>
</div>
<div id="A5.p4" class="ltx_para">
<p id="A5.p4.1" class="ltx_p">For the task head, we use a linear layer to double the dimensions, followed by a layer normalization.
After an activation layer, we then use another linear layer to reduce the dimensions to 310, which corresponds to the number of classification categories.</p>
</div>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Details on Baselines</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.1" class="ltx_p">In this section, we elaborate on the details of the baselines.</p>
</div>
<section id="A6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.1 </span>Principle of Selection</h3>

<div id="A6.SS1.p1" class="ltx_para">
<p id="A6.SS1.p1.1" class="ltx_p">For training with modality missing, we propose two innovations: Prototype Mask and Prototype Contrast.
Prototype Mask is a strategy to address modality missing, while Prototype Contrast is a strategy to alleviate client heterogeneity and enhance the global model performance.
Based on these, we aim to select the most suitable baseline.</p>
</div>
<div id="A6.SS1.p2" class="ltx_para">
<p id="A6.SS1.p2.1" class="ltx_p"><span id="A6.SS1.p2.1.1" class="ltx_text ltx_font_bold">Handling modality missing.</span>  When modality is missing, the simplest approach is to ignore the incomplete data and only use the data with complete modalities for training. We refer to this approach as <span id="A6.SS1.p2.1.2" class="ltx_text ltx_font_bold">Ignore Missing</span>.
Previous works used zero tensors to replace the representation of the missing modality. We refer to this approach as <span id="A6.SS1.p2.1.3" class="ltx_text ltx_font_bold">zero Mask</span>.
A straightforward extension is to use a random tensor following a Gaussian distribution for masking, which we refer to as <span id="A6.SS1.p2.1.4" class="ltx_text ltx_font_bold">Random Mask</span>.
We consider these three strategies as baselines for handling the modality missing issue and compare them with our proposed Prototype Mask.</p>
</div>
<div id="A6.SS1.p3" class="ltx_para">
<p id="A6.SS1.p3.1" class="ltx_p"><span id="A6.SS1.p3.1.1" class="ltx_text ltx_font_bold">Improving the global model.</span>  Both non-independent and identically distributed (Non-IID) data and modality missing can lead to client heterogeneity, severely compromising the performance of the global model.
<span id="A6.SS1.p3.1.2" class="ltx_text ltx_font_bold">FedAvg</span>, as the fundamental federated learning algorithm, does not provide a solution to address non-IID issues.
<span id="A6.SS1.p3.1.3" class="ltx_text ltx_font_bold">FedProx</span> introduces a proximal term to constrain the updates of local models, demonstrating its effectiveness in mitigating the impact of non-IID scenarios.
<span id="A6.SS1.p3.1.4" class="ltx_text ltx_font_bold">FedIoT</span> tackles the problem from the perspective of model aggregation strategies, granting more aggregation weight to multimodal clients to alleviate the influence of modality-incomplete clients.
Prototype-based Feature Alignment (<span id="A6.SS1.p3.1.5" class="ltx_text ltx_font_bold">FA</span>) strategies in <span id="A6.SS1.p3.1.6" class="ltx_text ltx_font_bold">FedPAC</span> and Prototype-based Hyper Knowledge Distillation (<span id="A6.SS1.p3.1.7" class="ltx_text ltx_font_bold">HKD</span>) in <span id="A6.SS1.p3.1.8" class="ltx_text ltx_font_bold">FedHKD</span> are both optimal approaches aimed at mitigating non-IID challenges.
We consider these five federated learning frameworks as baselines for improving the global model and compare them with our proposed Prototype Contrast.</p>
</div>
</section>
<section id="A6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.2 </span>Implementation Details of Baselines</h3>

<div id="A6.SS2.p1" class="ltx_para">
<p id="A6.SS2.p1.1" class="ltx_p">We will elaborate on the implementation details of each baseline.</p>
</div>
<div id="A6.SS2.p2" class="ltx_para">
<p id="A6.SS2.p2.1" class="ltx_p"><span id="A6.SS2.p2.1.1" class="ltx_text ltx_font_bold">FedAvg + Ignore.</span>  Within the FedAvg framework, the training process involves disregarding all training data on clients with incomplete modalities and using only the data with complete modalities for training.</p>
</div>
<div id="A6.SS2.p3" class="ltx_para">
<p id="A6.SS2.p3.1" class="ltx_p"><span id="A6.SS2.p3.1.1" class="ltx_text ltx_font_bold">FedMultimodal (FedAvg + Zero Mask).</span>  Based on FedAvg, we adopt the Random Mask as the strategy for handling missing modalities.
This approach is consistent with FedMultimodal.</p>
</div>
<div id="A6.SS2.p4" class="ltx_para">
<p id="A6.SS2.p4.1" class="ltx_p"><span id="A6.SS2.p4.1.1" class="ltx_text ltx_font_bold">FedMultimodal + RM (FedAvg + Random Mask).</span>  Based on FedAvg, we adopt the Random Mask as the strategy for handling missing modalities.
Random tensors are obtained from a Gaussian distribution.</p>
</div>
<div id="A6.SS2.p5" class="ltx_para">
<p id="A6.SS2.p5.1" class="ltx_p">We compare three strategies for handling missing data under FedAvg and find that using the Random Mask yields the best results. Therefore, <span id="A6.SS2.p5.1.1" class="ltx_text ltx_font_bold">subsequent baselines all adopt Random Mask</span>.</p>
</div>
<div id="A6.SS2.p6" class="ltx_para">
<p id="A6.SS2.p6.1" class="ltx_p"><span id="A6.SS2.p6.1.1" class="ltx_text ltx_font_bold">FedProx + Random Mask.</span>  Based on FedAvg, we adopt the Random Mask as the strategy for handling missing modalities.
According to the relevant paper, the weight of the proximal term is set to 1.0.</p>
</div>
<div id="A6.SS2.p7" class="ltx_para">
<p id="A6.SS2.p7.1" class="ltx_p"><span id="A6.SS2.p7.1.1" class="ltx_text ltx_font_bold">FedIoT + Random Mask.</span>  Based on FedAvg, we adopt the Random Mask as the strategy for handling missing modalities.
According to the paper of FedIoT, we set 100 times the aggregation weight for image-text pairs.</p>
</div>
<div id="A6.SS2.p8" class="ltx_para">
<p id="A6.SS2.p8.1" class="ltx_p"><span id="A6.SS2.p8.1.1" class="ltx_text ltx_font_bold">FedPAC + Random Mask.</span>  Based on FedAvg, we adopt the Random Mask as the strategy for handling missing modalities.
We implement a feature alignment strategy on the fused representations.
According to the paper of FedPAC, the hyperparameter of feature alignment is set to 1.0.</p>
</div>
<div id="A6.SS2.p9" class="ltx_para">
<p id="A6.SS2.p9.1" class="ltx_p"><span id="A6.SS2.p9.1.1" class="ltx_text ltx_font_bold">FedHKD + Random Mask.</span>  Based on FedHKD, we adopt the Random Mask as the strategy for handling missing modalities.
Hyper knowledge distillation is applied in the fused representations
According to the paper of FedHKD, the hyperparameter of hyper knowledge distillation is set to 0.05.</p>
</div>
<div id="A6.SS2.p10" class="ltx_para">
<p id="A6.SS2.p10.1" class="ltx_p"><span id="A6.SS2.p10.1.1" class="ltx_text ltx_font_bold">PmmFL + FA.</span>  Based on FedAvg, we adopt the Prototype Mask as the strategy for handling missing modalities.
Feature alignment is applied to the fused representations, with the hyperparameter set to 1.0.</p>
</div>
<div id="A6.SS2.p11" class="ltx_para">
<p id="A6.SS2.p11.1" class="ltx_p"><span id="A6.SS2.p11.1.1" class="ltx_text ltx_font_bold">PmmFL + HKD.</span>  Based on FedAvg, we adopt the Prototype Mask as the strategy for handling missing modalities.
Hyper knowledge distillation is applied in the fused representations, with the hyperparameter set to 0.05.</p>
</div>
<div id="A6.SS2.p12" class="ltx_para">
<p id="A6.SS2.p12.1" class="ltx_p"><span id="A6.SS2.p12.1.1" class="ltx_text ltx_font_bold">CreamFL.</span>  We use the results reported by CreamFL.</p>
</div>
</section>
</section>
<section id="A7" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Implementation Details</h2>

<div id="A7.p1" class="ltx_para">
<p id="A7.p1.1" class="ltx_p">We will go through the implementation details of each experiment one by one.</p>
</div>
<div id="A7.p2" class="ltx_para">
<p id="A7.p2.1" class="ltx_p"><span id="A7.p2.1.1" class="ltx_text ltx_font_bold">Main Experiments.</span></p>
</div>
<div id="A7.p3" class="ltx_para">
<p id="A7.p3.1" class="ltx_p">The main experiment establishes consistent missing rates for each modality, specifically 0.1, 0.2, 0.3, 0.4, and 0.5.
We conducted testing using the modal complete test set and presented the results in Table <a href="#S4.T1" title="Table 1 ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (We conducted testing with modal partially missing data in Appendix <a href="#A8" title="Appendix H Inference with Partial Modality Missing ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">H</span></a>.).
All experiment results are averaged under five runs with fixed random seeds.
We considered a conventional federated setting for the main experiment.
We set the communication rounds to 30.
In each round, 5 clients are selected to participate in training (client selection rate is 0.167).
We referred to the BEIT3 GitHub repository for the learning rate and optimizer parameters.
The learning rate is fixed at 3e-5.
We use the AdamW optimizer with a weight decay set to 1e-4, a momentum of 0.9, and <math id="A7.p3.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A7.p3.1.m1.1a"><mi id="A7.p3.1.m1.1.1" xref="A7.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A7.p3.1.m1.1b"><ci id="A7.p3.1.m1.1.1.cmml" xref="A7.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.1.m1.1c">\beta</annotation></semantics></math> of [0.9, 0.98].
For the training loss, cross-entropy is used as the task loss, and the temperature for the prototype contrastive loss is set to 0.07, following the CLIP GitHub repository.
We only perform simple hyperparameter optimization for the weight of the prototype contrastive loss, selecting the optimal value from the set [5.0, 1.0, 0.5, 0.1, 0.01].
All experiments are conducted on 4 NVIDIA RTX 4090 GPUs using distributed data parallelism, with a total batch size of 48 (12 per GPU).</p>
</div>
<div id="A7.p4" class="ltx_para">
<p id="A7.p4.1" class="ltx_p"><span id="A7.p4.1.1" class="ltx_text ltx_font_bold">Ablation Studies.</span>
We conducted ablation studies on the Prototype Mask and Prototype Contrast in our PmcmFL.
The hyperparameter settings for the ablation experiments are the same as those for the main experiment.
Note that Sec. <a href="#S4.SS7" title="4.7 Robustness to federated settings ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.7</span></a> (Robustness to Federated Settings) can also be considered as an ablation study on federated settings.</p>
</div>
<div id="A7.p5" class="ltx_para">
<p id="A7.p5.1" class="ltx_p"><span id="A7.p5.1.1" class="ltx_text ltx_font_bold">Inference with Missing Modalities.</span>
To intuitively demonstrate the role of Prototype Masks during the inference phase, we conduct inference with the complete missing of one modality.
The model used for this experiment is the best-performing model trained in the primary experiment with 30% modality missing.
Without loss of generality, we omit 100% of the text modality during this experiment.
In this case, this experiment can also be regarded as an image unimodal inference experiment.</p>
</div>
<div id="A7.p6" class="ltx_para">
<p id="A7.p6.1" class="ltx_p">As described in the method section, we need to train a tiny model in the final round of federated communication to achieve the matching from representation to prototype.
For model-based matching, we trained tiny models on each client in the final round of federated communication.
The classification-based matching utilizes a 2.2M MLP architecture, accounting for less than 1% of the communication round’s overhead.
The model takes image representations as input for a 310-class classification task and undergoes 100 epochs of training on each client, with a single GPU training time of under 1 minute.
Similarly, the retrieval-based matching employs a 2.9M MLP architecture, constituting approximately 1% of the communication round’s overhead.
This model takes image representations as input and generates corresponding image prototypes.
Its training involves an initial 200 epochs with contrastive loss, followed by 500 epochs of MSE loss.
The training time on a single GPU is approximately 3-5 minutes.</p>
</div>
<div id="A7.p7" class="ltx_para">
<p id="A7.p7.1" class="ltx_p">The server needs to select or integrate these tiny models from the clients.
We experimented with three strategies to explore the utilization of tiny models from various clients: selecting the model with the maximum client samples, model parameter aggregation through FedAvg, and model ensemble.
The first strategy entails choosing the model from the client with the most data samples among the 30 clients.
The model aggregation strategy combines the 30 small models through FedAvg.
The model ensemble method merges classification probabilities or retrieval scores from individual models through weighted aggregation, with weights determined by the sample quantities of the respective clients.</p>
</div>
<div id="A7.p8" class="ltx_para">
<p id="A7.p8.1" class="ltx_p"><span id="A7.p8.1.1" class="ltx_text ltx_font_bold">Qualitative Studies.</span>
We choose the optimal model trained in the main experiment with 50% modality missing for quantitative experiments.
Associated client models are also utilized.</p>
</div>
<div id="A7.p9" class="ltx_para">
<p id="A7.p9.1" class="ltx_p">To compare the heterogeneity among client models under FedAvg and PmcmFL, we randomly selected three models from five client models and visualized their fused representation distributions on the testing set.
To compare the performance of the global models under FedAvg and PmcmFL, we selected three categories (with corresponding labels ’red’, ’blue’, and ’green’) from a total of 310 classes and visualized their fused representation distributions.</p>
</div>
<div id="A7.p10" class="ltx_para">
<p id="A7.p10.1" class="ltx_p"><span id="A7.p10.1.1" class="ltx_text ltx_font_bold">Communication Efficiency.</span>
The experiments on communication efficiency utilize the results derived from the main experiment with 50% modality missing.</p>
</div>
<div id="A7.p11" class="ltx_para">
<p id="A7.p11.1" class="ltx_p"><span id="A7.p11.1.1" class="ltx_text ltx_font_bold">Robustness for federated setting.</span>
This experiment can also be considered as an ablation study on federated settings.
We test PmcmFL’s robustness for varying communication rounds, client selection rates, local training epochs, and learning rates.
To evaluate the robustness for communication rounds, we set communication rounds to [5, 10, 15, 20, 25, 30], with a client selection rate fixed at 0.1, local training epochs set to 3, and a fixed learning rate of 3e-5.
To evaluate the robustness for client selection rates, we set client selection rates to [0.1, 0.167, 0.233, 0.333], with communication rounds of 20, local training epochs set to 3, and a fixed learning rate of 3e-5.
To evaluate the robustness for local training epochs, we set local training epochs to [1, 3, 5, 7], with communication rounds of 20, a client selection rate fixed at 0.1, and a fixed learning rate of 3e-5.
To evaluate the robustness for learning rates, we set learning rates to [1e-5, 3e-5, 5e-5, 7e-5], with communication rounds of 20, a client selection rate fixed at 0.1, and local training epochs set to 3.</p>
</div>
</section>
<section id="A8" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix H </span>Inference with Partial Modality Missing</h2>

<div id="A8.p1" class="ltx_para">
<p id="A8.p1.1" class="ltx_p">We train the model with modalities missing at rates of [10%, 20%, 30%, 40%, 50%], and performed inference on test sets with modalities missing at the same rates.</p>
</div>
<div id="A8.p2" class="ltx_para">
<p id="A8.p2.1" class="ltx_p">In baselines, Random Mask serves as the strategy for handling missing modalities, except for FedMultimodal (FedAvg + Zero Mask), which employs Zero Mask.
In our PmcmFL, the Prototype Mask is used for handling missing modalities.</p>
</div>
<div id="A8.p3" class="ltx_para">
<p id="A8.p3.1" class="ltx_p">The experimental results are shown in Table <a href="#A8.T5" title="Table 5 ‣ Appendix H Inference with Partial Modality Missing ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
We compare our PmcmFL with existing approaches, so the two variants of our framework (PmmFL+FA and PmmFL+HKD) are not presented in the table.</p>
</div>
<div id="A8.p4" class="ltx_para">
<p id="A8.p4.1" class="ltx_p">As can be seen, the experimental results demonstrate the superiority of our PmcmFL.</p>
</div>
<figure id="A8.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Comparison of PmcmFL with baselines under various missing rates.
Modality missing occurs in both the training and testing phases. In our approach, the Prototype Mask is also used during the inference phase. <math id="A8.T5.3.m1.1" class="ltx_Math" alttext="\rho_{train}" display="inline"><semantics id="A8.T5.3.m1.1b"><msub id="A8.T5.3.m1.1.1" xref="A8.T5.3.m1.1.1.cmml"><mi id="A8.T5.3.m1.1.1.2" xref="A8.T5.3.m1.1.1.2.cmml">ρ</mi><mrow id="A8.T5.3.m1.1.1.3" xref="A8.T5.3.m1.1.1.3.cmml"><mi id="A8.T5.3.m1.1.1.3.2" xref="A8.T5.3.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A8.T5.3.m1.1.1.3.1" xref="A8.T5.3.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.3.m1.1.1.3.3" xref="A8.T5.3.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A8.T5.3.m1.1.1.3.1b" xref="A8.T5.3.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.3.m1.1.1.3.4" xref="A8.T5.3.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A8.T5.3.m1.1.1.3.1c" xref="A8.T5.3.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.3.m1.1.1.3.5" xref="A8.T5.3.m1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A8.T5.3.m1.1.1.3.1d" xref="A8.T5.3.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.3.m1.1.1.3.6" xref="A8.T5.3.m1.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A8.T5.3.m1.1c"><apply id="A8.T5.3.m1.1.1.cmml" xref="A8.T5.3.m1.1.1"><csymbol cd="ambiguous" id="A8.T5.3.m1.1.1.1.cmml" xref="A8.T5.3.m1.1.1">subscript</csymbol><ci id="A8.T5.3.m1.1.1.2.cmml" xref="A8.T5.3.m1.1.1.2">𝜌</ci><apply id="A8.T5.3.m1.1.1.3.cmml" xref="A8.T5.3.m1.1.1.3"><times id="A8.T5.3.m1.1.1.3.1.cmml" xref="A8.T5.3.m1.1.1.3.1"></times><ci id="A8.T5.3.m1.1.1.3.2.cmml" xref="A8.T5.3.m1.1.1.3.2">𝑡</ci><ci id="A8.T5.3.m1.1.1.3.3.cmml" xref="A8.T5.3.m1.1.1.3.3">𝑟</ci><ci id="A8.T5.3.m1.1.1.3.4.cmml" xref="A8.T5.3.m1.1.1.3.4">𝑎</ci><ci id="A8.T5.3.m1.1.1.3.5.cmml" xref="A8.T5.3.m1.1.1.3.5">𝑖</ci><ci id="A8.T5.3.m1.1.1.3.6.cmml" xref="A8.T5.3.m1.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T5.3.m1.1d">\rho_{train}</annotation></semantics></math> and <math id="A8.T5.4.m2.1" class="ltx_Math" alttext="\rho_{test}" display="inline"><semantics id="A8.T5.4.m2.1b"><msub id="A8.T5.4.m2.1.1" xref="A8.T5.4.m2.1.1.cmml"><mi id="A8.T5.4.m2.1.1.2" xref="A8.T5.4.m2.1.1.2.cmml">ρ</mi><mrow id="A8.T5.4.m2.1.1.3" xref="A8.T5.4.m2.1.1.3.cmml"><mi id="A8.T5.4.m2.1.1.3.2" xref="A8.T5.4.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A8.T5.4.m2.1.1.3.1" xref="A8.T5.4.m2.1.1.3.1.cmml">​</mo><mi id="A8.T5.4.m2.1.1.3.3" xref="A8.T5.4.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A8.T5.4.m2.1.1.3.1b" xref="A8.T5.4.m2.1.1.3.1.cmml">​</mo><mi id="A8.T5.4.m2.1.1.3.4" xref="A8.T5.4.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="A8.T5.4.m2.1.1.3.1c" xref="A8.T5.4.m2.1.1.3.1.cmml">​</mo><mi id="A8.T5.4.m2.1.1.3.5" xref="A8.T5.4.m2.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A8.T5.4.m2.1c"><apply id="A8.T5.4.m2.1.1.cmml" xref="A8.T5.4.m2.1.1"><csymbol cd="ambiguous" id="A8.T5.4.m2.1.1.1.cmml" xref="A8.T5.4.m2.1.1">subscript</csymbol><ci id="A8.T5.4.m2.1.1.2.cmml" xref="A8.T5.4.m2.1.1.2">𝜌</ci><apply id="A8.T5.4.m2.1.1.3.cmml" xref="A8.T5.4.m2.1.1.3"><times id="A8.T5.4.m2.1.1.3.1.cmml" xref="A8.T5.4.m2.1.1.3.1"></times><ci id="A8.T5.4.m2.1.1.3.2.cmml" xref="A8.T5.4.m2.1.1.3.2">𝑡</ci><ci id="A8.T5.4.m2.1.1.3.3.cmml" xref="A8.T5.4.m2.1.1.3.3">𝑒</ci><ci id="A8.T5.4.m2.1.1.3.4.cmml" xref="A8.T5.4.m2.1.1.3.4">𝑠</ci><ci id="A8.T5.4.m2.1.1.3.5.cmml" xref="A8.T5.4.m2.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T5.4.m2.1d">\rho_{test}</annotation></semantics></math> denote the missing rates in the training phase and testing phase, respectively. We bold the best results under the same training and test missing rate.</figcaption>
<table id="A8.T5.6.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A8.T5.6.2.2" class="ltx_tr">
<th id="A8.T5.6.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="A8.T5.6.2.2.3.1" class="ltx_text">Methods</span></th>
<th id="A8.T5.5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="A8.T5.5.1.1.1.1" class="ltx_text"><math id="A8.T5.5.1.1.1.1.m1.1" class="ltx_Math" alttext="\rho_{test}" display="inline"><semantics id="A8.T5.5.1.1.1.1.m1.1a"><msub id="A8.T5.5.1.1.1.1.m1.1.1" xref="A8.T5.5.1.1.1.1.m1.1.1.cmml"><mi id="A8.T5.5.1.1.1.1.m1.1.1.2" xref="A8.T5.5.1.1.1.1.m1.1.1.2.cmml">ρ</mi><mrow id="A8.T5.5.1.1.1.1.m1.1.1.3" xref="A8.T5.5.1.1.1.1.m1.1.1.3.cmml"><mi id="A8.T5.5.1.1.1.1.m1.1.1.3.2" xref="A8.T5.5.1.1.1.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A8.T5.5.1.1.1.1.m1.1.1.3.1" xref="A8.T5.5.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.5.1.1.1.1.m1.1.1.3.3" xref="A8.T5.5.1.1.1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A8.T5.5.1.1.1.1.m1.1.1.3.1a" xref="A8.T5.5.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.5.1.1.1.1.m1.1.1.3.4" xref="A8.T5.5.1.1.1.1.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="A8.T5.5.1.1.1.1.m1.1.1.3.1b" xref="A8.T5.5.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.5.1.1.1.1.m1.1.1.3.5" xref="A8.T5.5.1.1.1.1.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A8.T5.5.1.1.1.1.m1.1b"><apply id="A8.T5.5.1.1.1.1.m1.1.1.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A8.T5.5.1.1.1.1.m1.1.1.1.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1">subscript</csymbol><ci id="A8.T5.5.1.1.1.1.m1.1.1.2.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1.2">𝜌</ci><apply id="A8.T5.5.1.1.1.1.m1.1.1.3.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1.3"><times id="A8.T5.5.1.1.1.1.m1.1.1.3.1.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1.3.1"></times><ci id="A8.T5.5.1.1.1.1.m1.1.1.3.2.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1.3.2">𝑡</ci><ci id="A8.T5.5.1.1.1.1.m1.1.1.3.3.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1.3.3">𝑒</ci><ci id="A8.T5.5.1.1.1.1.m1.1.1.3.4.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1.3.4">𝑠</ci><ci id="A8.T5.5.1.1.1.1.m1.1.1.3.5.cmml" xref="A8.T5.5.1.1.1.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T5.5.1.1.1.1.m1.1c">\rho_{test}</annotation></semantics></math></span></th>
<th id="A8.T5.6.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5"><math id="A8.T5.6.2.2.2.m1.1" class="ltx_Math" alttext="\rho_{train}" display="inline"><semantics id="A8.T5.6.2.2.2.m1.1a"><msub id="A8.T5.6.2.2.2.m1.1.1" xref="A8.T5.6.2.2.2.m1.1.1.cmml"><mi id="A8.T5.6.2.2.2.m1.1.1.2" xref="A8.T5.6.2.2.2.m1.1.1.2.cmml">ρ</mi><mrow id="A8.T5.6.2.2.2.m1.1.1.3" xref="A8.T5.6.2.2.2.m1.1.1.3.cmml"><mi id="A8.T5.6.2.2.2.m1.1.1.3.2" xref="A8.T5.6.2.2.2.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A8.T5.6.2.2.2.m1.1.1.3.1" xref="A8.T5.6.2.2.2.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.6.2.2.2.m1.1.1.3.3" xref="A8.T5.6.2.2.2.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A8.T5.6.2.2.2.m1.1.1.3.1a" xref="A8.T5.6.2.2.2.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.6.2.2.2.m1.1.1.3.4" xref="A8.T5.6.2.2.2.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="A8.T5.6.2.2.2.m1.1.1.3.1b" xref="A8.T5.6.2.2.2.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.6.2.2.2.m1.1.1.3.5" xref="A8.T5.6.2.2.2.m1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A8.T5.6.2.2.2.m1.1.1.3.1c" xref="A8.T5.6.2.2.2.m1.1.1.3.1.cmml">​</mo><mi id="A8.T5.6.2.2.2.m1.1.1.3.6" xref="A8.T5.6.2.2.2.m1.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A8.T5.6.2.2.2.m1.1b"><apply id="A8.T5.6.2.2.2.m1.1.1.cmml" xref="A8.T5.6.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A8.T5.6.2.2.2.m1.1.1.1.cmml" xref="A8.T5.6.2.2.2.m1.1.1">subscript</csymbol><ci id="A8.T5.6.2.2.2.m1.1.1.2.cmml" xref="A8.T5.6.2.2.2.m1.1.1.2">𝜌</ci><apply id="A8.T5.6.2.2.2.m1.1.1.3.cmml" xref="A8.T5.6.2.2.2.m1.1.1.3"><times id="A8.T5.6.2.2.2.m1.1.1.3.1.cmml" xref="A8.T5.6.2.2.2.m1.1.1.3.1"></times><ci id="A8.T5.6.2.2.2.m1.1.1.3.2.cmml" xref="A8.T5.6.2.2.2.m1.1.1.3.2">𝑡</ci><ci id="A8.T5.6.2.2.2.m1.1.1.3.3.cmml" xref="A8.T5.6.2.2.2.m1.1.1.3.3">𝑟</ci><ci id="A8.T5.6.2.2.2.m1.1.1.3.4.cmml" xref="A8.T5.6.2.2.2.m1.1.1.3.4">𝑎</ci><ci id="A8.T5.6.2.2.2.m1.1.1.3.5.cmml" xref="A8.T5.6.2.2.2.m1.1.1.3.5">𝑖</ci><ci id="A8.T5.6.2.2.2.m1.1.1.3.6.cmml" xref="A8.T5.6.2.2.2.m1.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T5.6.2.2.2.m1.1c">\rho_{train}</annotation></semantics></math></th>
<th id="A8.T5.6.2.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="A8.T5.6.2.2.4.1" class="ltx_text">Sum</span></th>
</tr>
<tr id="A8.T5.6.2.3.1" class="ltx_tr">
<th id="A8.T5.6.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">10%</th>
<th id="A8.T5.6.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">20%</th>
<th id="A8.T5.6.2.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">30%</th>
<th id="A8.T5.6.2.3.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">40%</th>
<th id="A8.T5.6.2.3.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">50%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A8.T5.6.2.4.1" class="ltx_tr">
<th id="A8.T5.6.2.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="5"><span id="A8.T5.6.2.4.1.1.1" class="ltx_text">FedAvg + Ignore</span></th>
<th id="A8.T5.6.2.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">10%</th>
<td id="A8.T5.6.2.4.1.3" class="ltx_td ltx_align_center ltx_border_t">52.016</td>
<td id="A8.T5.6.2.4.1.4" class="ltx_td ltx_align_center ltx_border_t">50.756</td>
<td id="A8.T5.6.2.4.1.5" class="ltx_td ltx_align_center ltx_border_t">46.812</td>
<td id="A8.T5.6.2.4.1.6" class="ltx_td ltx_align_center ltx_border_t">42.254</td>
<td id="A8.T5.6.2.4.1.7" class="ltx_td ltx_align_center ltx_border_t">36.720</td>
<td id="A8.T5.6.2.4.1.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">228.558</td>
</tr>
<tr id="A8.T5.6.2.5.2" class="ltx_tr">
<th id="A8.T5.6.2.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">20%</th>
<td id="A8.T5.6.2.5.2.2" class="ltx_td ltx_align_center">47.904</td>
<td id="A8.T5.6.2.5.2.3" class="ltx_td ltx_align_center">47.318</td>
<td id="A8.T5.6.2.5.2.4" class="ltx_td ltx_align_center">43.198</td>
<td id="A8.T5.6.2.5.2.5" class="ltx_td ltx_align_center">39.386</td>
<td id="A8.T5.6.2.5.2.6" class="ltx_td ltx_align_center">34.278</td>
<td id="A8.T5.6.2.5.2.7" class="ltx_td ltx_nopad_r ltx_align_center">212.084</td>
</tr>
<tr id="A8.T5.6.2.6.3" class="ltx_tr">
<th id="A8.T5.6.2.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">30%</th>
<td id="A8.T5.6.2.6.3.2" class="ltx_td ltx_align_center">42.490</td>
<td id="A8.T5.6.2.6.3.3" class="ltx_td ltx_align_center">43.138</td>
<td id="A8.T5.6.2.6.3.4" class="ltx_td ltx_align_center">39.250</td>
<td id="A8.T5.6.2.6.3.5" class="ltx_td ltx_align_center">36.340</td>
<td id="A8.T5.6.2.6.3.6" class="ltx_td ltx_align_center">31.802</td>
<td id="A8.T5.6.2.6.3.7" class="ltx_td ltx_nopad_r ltx_align_center">193.020</td>
</tr>
<tr id="A8.T5.6.2.7.4" class="ltx_tr">
<th id="A8.T5.6.2.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">40%</th>
<td id="A8.T5.6.2.7.4.2" class="ltx_td ltx_align_center">38.938</td>
<td id="A8.T5.6.2.7.4.3" class="ltx_td ltx_align_center">40.462</td>
<td id="A8.T5.6.2.7.4.4" class="ltx_td ltx_align_center">36.964</td>
<td id="A8.T5.6.2.7.4.5" class="ltx_td ltx_align_center">34.218</td>
<td id="A8.T5.6.2.7.4.6" class="ltx_td ltx_align_center">30.040</td>
<td id="A8.T5.6.2.7.4.7" class="ltx_td ltx_nopad_r ltx_align_center">180.622</td>
</tr>
<tr id="A8.T5.6.2.8.5" class="ltx_tr">
<th id="A8.T5.6.2.8.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">50%</th>
<td id="A8.T5.6.2.8.5.2" class="ltx_td ltx_align_center">33.760</td>
<td id="A8.T5.6.2.8.5.3" class="ltx_td ltx_align_center">36.180</td>
<td id="A8.T5.6.2.8.5.4" class="ltx_td ltx_align_center">33.406</td>
<td id="A8.T5.6.2.8.5.5" class="ltx_td ltx_align_center">30.492</td>
<td id="A8.T5.6.2.8.5.6" class="ltx_td ltx_align_center">26.926</td>
<td id="A8.T5.6.2.8.5.7" class="ltx_td ltx_nopad_r ltx_align_center">160.764</td>
</tr>
<tr id="A8.T5.6.2.9.6" class="ltx_tr">
<th id="A8.T5.6.2.9.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="5"><span id="A8.T5.6.2.9.6.1.1" class="ltx_text">FedMultimodal</span></th>
<th id="A8.T5.6.2.9.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">10%</th>
<td id="A8.T5.6.2.9.6.3" class="ltx_td ltx_align_center ltx_border_t">52.822</td>
<td id="A8.T5.6.2.9.6.4" class="ltx_td ltx_align_center ltx_border_t">50.288</td>
<td id="A8.T5.6.2.9.6.5" class="ltx_td ltx_align_center ltx_border_t">47.234</td>
<td id="A8.T5.6.2.9.6.6" class="ltx_td ltx_align_center ltx_border_t">44.478</td>
<td id="A8.T5.6.2.9.6.7" class="ltx_td ltx_align_center ltx_border_t">39.766</td>
<td id="A8.T5.6.2.9.6.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">234.588</td>
</tr>
<tr id="A8.T5.6.2.10.7" class="ltx_tr">
<th id="A8.T5.6.2.10.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">20%</th>
<td id="A8.T5.6.2.10.7.2" class="ltx_td ltx_align_center">50.310</td>
<td id="A8.T5.6.2.10.7.3" class="ltx_td ltx_align_center">47.624</td>
<td id="A8.T5.6.2.10.7.4" class="ltx_td ltx_align_center">45.056</td>
<td id="A8.T5.6.2.10.7.5" class="ltx_td ltx_align_center">42.280</td>
<td id="A8.T5.6.2.10.7.6" class="ltx_td ltx_align_center">38.366</td>
<td id="A8.T5.6.2.10.7.7" class="ltx_td ltx_nopad_r ltx_align_center">223.636</td>
</tr>
<tr id="A8.T5.6.2.11.8" class="ltx_tr">
<th id="A8.T5.6.2.11.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">30%</th>
<td id="A8.T5.6.2.11.8.2" class="ltx_td ltx_align_center">47.252</td>
<td id="A8.T5.6.2.11.8.3" class="ltx_td ltx_align_center">44.832</td>
<td id="A8.T5.6.2.11.8.4" class="ltx_td ltx_align_center">43.174</td>
<td id="A8.T5.6.2.11.8.5" class="ltx_td ltx_align_center">40.288</td>
<td id="A8.T5.6.2.11.8.6" class="ltx_td ltx_align_center">37.242</td>
<td id="A8.T5.6.2.11.8.7" class="ltx_td ltx_nopad_r ltx_align_center">212.788</td>
</tr>
<tr id="A8.T5.6.2.12.9" class="ltx_tr">
<th id="A8.T5.6.2.12.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">40%</th>
<td id="A8.T5.6.2.12.9.2" class="ltx_td ltx_align_center">45.496</td>
<td id="A8.T5.6.2.12.9.3" class="ltx_td ltx_align_center">43.034</td>
<td id="A8.T5.6.2.12.9.4" class="ltx_td ltx_align_center">41.904</td>
<td id="A8.T5.6.2.12.9.5" class="ltx_td ltx_align_center">38.824</td>
<td id="A8.T5.6.2.12.9.6" class="ltx_td ltx_align_center">36.228</td>
<td id="A8.T5.6.2.12.9.7" class="ltx_td ltx_nopad_r ltx_align_center">205.486</td>
</tr>
<tr id="A8.T5.6.2.13.10" class="ltx_tr">
<th id="A8.T5.6.2.13.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">50%</th>
<td id="A8.T5.6.2.13.10.2" class="ltx_td ltx_align_center">42.588</td>
<td id="A8.T5.6.2.13.10.3" class="ltx_td ltx_align_center">39.828</td>
<td id="A8.T5.6.2.13.10.4" class="ltx_td ltx_align_center">40.034</td>
<td id="A8.T5.6.2.13.10.5" class="ltx_td ltx_align_center">36.872</td>
<td id="A8.T5.6.2.13.10.6" class="ltx_td ltx_align_center">34.658</td>
<td id="A8.T5.6.2.13.10.7" class="ltx_td ltx_nopad_r ltx_align_center">193.980</td>
</tr>
<tr id="A8.T5.6.2.14.11" class="ltx_tr">
<th id="A8.T5.6.2.14.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="5"><span id="A8.T5.6.2.14.11.1.1" class="ltx_text">FedMultimodal + RM</span></th>
<th id="A8.T5.6.2.14.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">10%</th>
<td id="A8.T5.6.2.14.11.3" class="ltx_td ltx_align_center ltx_border_t">52.268</td>
<td id="A8.T5.6.2.14.11.4" class="ltx_td ltx_align_center ltx_border_t">50.242</td>
<td id="A8.T5.6.2.14.11.5" class="ltx_td ltx_align_center ltx_border_t">46.230</td>
<td id="A8.T5.6.2.14.11.6" class="ltx_td ltx_align_center ltx_border_t">45.352</td>
<td id="A8.T5.6.2.14.11.7" class="ltx_td ltx_align_center ltx_border_t">39.962</td>
<td id="A8.T5.6.2.14.11.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">234.054</td>
</tr>
<tr id="A8.T5.6.2.15.12" class="ltx_tr">
<th id="A8.T5.6.2.15.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">20%</th>
<td id="A8.T5.6.2.15.12.2" class="ltx_td ltx_align_center">49.176</td>
<td id="A8.T5.6.2.15.12.3" class="ltx_td ltx_align_center">47.602</td>
<td id="A8.T5.6.2.15.12.4" class="ltx_td ltx_align_center">43.954</td>
<td id="A8.T5.6.2.15.12.5" class="ltx_td ltx_align_center">43.368</td>
<td id="A8.T5.6.2.15.12.6" class="ltx_td ltx_align_center">38.460</td>
<td id="A8.T5.6.2.15.12.7" class="ltx_td ltx_nopad_r ltx_align_center">222.560</td>
</tr>
<tr id="A8.T5.6.2.16.13" class="ltx_tr">
<th id="A8.T5.6.2.16.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">30%</th>
<td id="A8.T5.6.2.16.13.2" class="ltx_td ltx_align_center">45.290</td>
<td id="A8.T5.6.2.16.13.3" class="ltx_td ltx_align_center">44.862</td>
<td id="A8.T5.6.2.16.13.4" class="ltx_td ltx_align_center">41.614</td>
<td id="A8.T5.6.2.16.13.5" class="ltx_td ltx_align_center">41.120</td>
<td id="A8.T5.6.2.16.13.6" class="ltx_td ltx_align_center">36.966</td>
<td id="A8.T5.6.2.16.13.7" class="ltx_td ltx_nopad_r ltx_align_center">209.852</td>
</tr>
<tr id="A8.T5.6.2.17.14" class="ltx_tr">
<th id="A8.T5.6.2.17.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">40%</th>
<td id="A8.T5.6.2.17.14.2" class="ltx_td ltx_align_center">42.554</td>
<td id="A8.T5.6.2.17.14.3" class="ltx_td ltx_align_center">42.958</td>
<td id="A8.T5.6.2.17.14.4" class="ltx_td ltx_align_center">39.844</td>
<td id="A8.T5.6.2.17.14.5" class="ltx_td ltx_align_center">39.862</td>
<td id="A8.T5.6.2.17.14.6" class="ltx_td ltx_align_center">35.870</td>
<td id="A8.T5.6.2.17.14.7" class="ltx_td ltx_nopad_r ltx_align_center">201.088</td>
</tr>
<tr id="A8.T5.6.2.18.15" class="ltx_tr">
<th id="A8.T5.6.2.18.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">50%</th>
<td id="A8.T5.6.2.18.15.2" class="ltx_td ltx_align_center">38.568</td>
<td id="A8.T5.6.2.18.15.3" class="ltx_td ltx_align_center">39.964</td>
<td id="A8.T5.6.2.18.15.4" class="ltx_td ltx_align_center">37.348</td>
<td id="A8.T5.6.2.18.15.5" class="ltx_td ltx_align_center">37.536</td>
<td id="A8.T5.6.2.18.15.6" class="ltx_td ltx_align_center">34.082</td>
<td id="A8.T5.6.2.18.15.7" class="ltx_td ltx_nopad_r ltx_align_center">187.498</td>
</tr>
<tr id="A8.T5.6.2.19.16" class="ltx_tr">
<th id="A8.T5.6.2.19.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="5"><span id="A8.T5.6.2.19.16.1.1" class="ltx_text">FedProx + Mask</span></th>
<th id="A8.T5.6.2.19.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">10%</th>
<td id="A8.T5.6.2.19.16.3" class="ltx_td ltx_align_center ltx_border_t">50.382</td>
<td id="A8.T5.6.2.19.16.4" class="ltx_td ltx_align_center ltx_border_t">47.392</td>
<td id="A8.T5.6.2.19.16.5" class="ltx_td ltx_align_center ltx_border_t">44.790</td>
<td id="A8.T5.6.2.19.16.6" class="ltx_td ltx_align_center ltx_border_t">45.234</td>
<td id="A8.T5.6.2.19.16.7" class="ltx_td ltx_align_center ltx_border_t">39.940</td>
<td id="A8.T5.6.2.19.16.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">227.738</td>
</tr>
<tr id="A8.T5.6.2.20.17" class="ltx_tr">
<th id="A8.T5.6.2.20.17.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">20%</th>
<td id="A8.T5.6.2.20.17.2" class="ltx_td ltx_align_center">48.094</td>
<td id="A8.T5.6.2.20.17.3" class="ltx_td ltx_align_center">44.978</td>
<td id="A8.T5.6.2.20.17.4" class="ltx_td ltx_align_center">42.848</td>
<td id="A8.T5.6.2.20.17.5" class="ltx_td ltx_align_center">43.170</td>
<td id="A8.T5.6.2.20.17.6" class="ltx_td ltx_align_center">38.462</td>
<td id="A8.T5.6.2.20.17.7" class="ltx_td ltx_nopad_r ltx_align_center">217.552</td>
</tr>
<tr id="A8.T5.6.2.21.18" class="ltx_tr">
<th id="A8.T5.6.2.21.18.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">30%</th>
<td id="A8.T5.6.2.21.18.2" class="ltx_td ltx_align_center">45.690</td>
<td id="A8.T5.6.2.21.18.3" class="ltx_td ltx_align_center">42.592</td>
<td id="A8.T5.6.2.21.18.4" class="ltx_td ltx_align_center">40.808</td>
<td id="A8.T5.6.2.21.18.5" class="ltx_td ltx_align_center">41.514</td>
<td id="A8.T5.6.2.21.18.6" class="ltx_td ltx_align_center">36.936</td>
<td id="A8.T5.6.2.21.18.7" class="ltx_td ltx_nopad_r ltx_align_center">207.540</td>
</tr>
<tr id="A8.T5.6.2.22.19" class="ltx_tr">
<th id="A8.T5.6.2.22.19.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">40%</th>
<td id="A8.T5.6.2.22.19.2" class="ltx_td ltx_align_center">44.300</td>
<td id="A8.T5.6.2.22.19.3" class="ltx_td ltx_align_center">41.002</td>
<td id="A8.T5.6.2.22.19.4" class="ltx_td ltx_align_center">39.414</td>
<td id="A8.T5.6.2.22.19.5" class="ltx_td ltx_align_center">40.240</td>
<td id="A8.T5.6.2.22.19.6" class="ltx_td ltx_align_center">35.806</td>
<td id="A8.T5.6.2.22.19.7" class="ltx_td ltx_nopad_r ltx_align_center">200.762</td>
</tr>
<tr id="A8.T5.6.2.23.20" class="ltx_tr">
<th id="A8.T5.6.2.23.20.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">50%</th>
<td id="A8.T5.6.2.23.20.2" class="ltx_td ltx_align_center">42.132</td>
<td id="A8.T5.6.2.23.20.3" class="ltx_td ltx_align_center">38.350</td>
<td id="A8.T5.6.2.23.20.4" class="ltx_td ltx_align_center">37.372</td>
<td id="A8.T5.6.2.23.20.5" class="ltx_td ltx_align_center">38.136</td>
<td id="A8.T5.6.2.23.20.6" class="ltx_td ltx_align_center">34.138</td>
<td id="A8.T5.6.2.23.20.7" class="ltx_td ltx_nopad_r ltx_align_center">190.128</td>
</tr>
<tr id="A8.T5.6.2.24.21" class="ltx_tr">
<th id="A8.T5.6.2.24.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="5"><span id="A8.T5.6.2.24.21.1.1" class="ltx_text">FedIoT + Mask</span></th>
<th id="A8.T5.6.2.24.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">10%</th>
<td id="A8.T5.6.2.24.21.3" class="ltx_td ltx_align_center ltx_border_t">52.714</td>
<td id="A8.T5.6.2.24.21.4" class="ltx_td ltx_align_center ltx_border_t">49.910</td>
<td id="A8.T5.6.2.24.21.5" class="ltx_td ltx_align_center ltx_border_t">45.698</td>
<td id="A8.T5.6.2.24.21.6" class="ltx_td ltx_align_center ltx_border_t">45.664</td>
<td id="A8.T5.6.2.24.21.7" class="ltx_td ltx_align_center ltx_border_t">40.604</td>
<td id="A8.T5.6.2.24.21.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">234.590</td>
</tr>
<tr id="A8.T5.6.2.25.22" class="ltx_tr">
<th id="A8.T5.6.2.25.22.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">20%</th>
<td id="A8.T5.6.2.25.22.2" class="ltx_td ltx_align_center">50.278</td>
<td id="A8.T5.6.2.25.22.3" class="ltx_td ltx_align_center">47.112</td>
<td id="A8.T5.6.2.25.22.4" class="ltx_td ltx_align_center">43.544</td>
<td id="A8.T5.6.2.25.22.5" class="ltx_td ltx_align_center">43.486</td>
<td id="A8.T5.6.2.25.22.6" class="ltx_td ltx_align_center">39.130</td>
<td id="A8.T5.6.2.25.22.7" class="ltx_td ltx_nopad_r ltx_align_center">223.550</td>
</tr>
<tr id="A8.T5.6.2.26.23" class="ltx_tr">
<th id="A8.T5.6.2.26.23.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">30%</th>
<td id="A8.T5.6.2.26.23.2" class="ltx_td ltx_align_center">47.572</td>
<td id="A8.T5.6.2.26.23.3" class="ltx_td ltx_align_center">44.694</td>
<td id="A8.T5.6.2.26.23.4" class="ltx_td ltx_align_center">41.266</td>
<td id="A8.T5.6.2.26.23.5" class="ltx_td ltx_align_center">41.456</td>
<td id="A8.T5.6.2.26.23.6" class="ltx_td ltx_align_center">37.430</td>
<td id="A8.T5.6.2.26.23.7" class="ltx_td ltx_nopad_r ltx_align_center">212.418</td>
</tr>
<tr id="A8.T5.6.2.27.24" class="ltx_tr">
<th id="A8.T5.6.2.27.24.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">40%</th>
<td id="A8.T5.6.2.27.24.2" class="ltx_td ltx_align_center">45.606</td>
<td id="A8.T5.6.2.27.24.3" class="ltx_td ltx_align_center">43.016</td>
<td id="A8.T5.6.2.27.24.4" class="ltx_td ltx_align_center">39.726</td>
<td id="A8.T5.6.2.27.24.5" class="ltx_td ltx_align_center">39.968</td>
<td id="A8.T5.6.2.27.24.6" class="ltx_td ltx_align_center">36.226</td>
<td id="A8.T5.6.2.27.24.7" class="ltx_td ltx_nopad_r ltx_align_center">204.542</td>
</tr>
<tr id="A8.T5.6.2.28.25" class="ltx_tr">
<th id="A8.T5.6.2.28.25.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">50%</th>
<td id="A8.T5.6.2.28.25.2" class="ltx_td ltx_align_center">43.164</td>
<td id="A8.T5.6.2.28.25.3" class="ltx_td ltx_align_center">40.000</td>
<td id="A8.T5.6.2.28.25.4" class="ltx_td ltx_align_center">37.420</td>
<td id="A8.T5.6.2.28.25.5" class="ltx_td ltx_align_center">37.494</td>
<td id="A8.T5.6.2.28.25.6" class="ltx_td ltx_align_center">34.430</td>
<td id="A8.T5.6.2.28.25.7" class="ltx_td ltx_nopad_r ltx_align_center">192.508</td>
</tr>
<tr id="A8.T5.6.2.29.26" class="ltx_tr">
<th id="A8.T5.6.2.29.26.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="5"><span id="A8.T5.6.2.29.26.1.1" class="ltx_text">FedPAC + Mask</span></th>
<th id="A8.T5.6.2.29.26.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">10%</th>
<td id="A8.T5.6.2.29.26.3" class="ltx_td ltx_align_center ltx_border_t">52.044</td>
<td id="A8.T5.6.2.29.26.4" class="ltx_td ltx_align_center ltx_border_t">48.640</td>
<td id="A8.T5.6.2.29.26.5" class="ltx_td ltx_align_center ltx_border_t">45.266</td>
<td id="A8.T5.6.2.29.26.6" class="ltx_td ltx_align_center ltx_border_t">43.950</td>
<td id="A8.T5.6.2.29.26.7" class="ltx_td ltx_align_center ltx_border_t">39.142</td>
<td id="A8.T5.6.2.29.26.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">229.042</td>
</tr>
<tr id="A8.T5.6.2.30.27" class="ltx_tr">
<th id="A8.T5.6.2.30.27.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">20%</th>
<td id="A8.T5.6.2.30.27.2" class="ltx_td ltx_align_center">49.738</td>
<td id="A8.T5.6.2.30.27.3" class="ltx_td ltx_align_center">46.094</td>
<td id="A8.T5.6.2.30.27.4" class="ltx_td ltx_align_center">43.266</td>
<td id="A8.T5.6.2.30.27.5" class="ltx_td ltx_align_center">41.934</td>
<td id="A8.T5.6.2.30.27.6" class="ltx_td ltx_align_center">37.618</td>
<td id="A8.T5.6.2.30.27.7" class="ltx_td ltx_nopad_r ltx_align_center">218.650</td>
</tr>
<tr id="A8.T5.6.2.31.28" class="ltx_tr">
<th id="A8.T5.6.2.31.28.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">30%</th>
<td id="A8.T5.6.2.31.28.2" class="ltx_td ltx_align_center">47.082</td>
<td id="A8.T5.6.2.31.28.3" class="ltx_td ltx_align_center">43.558</td>
<td id="A8.T5.6.2.31.28.4" class="ltx_td ltx_align_center">41.084</td>
<td id="A8.T5.6.2.31.28.5" class="ltx_td ltx_align_center">39.692</td>
<td id="A8.T5.6.2.31.28.6" class="ltx_td ltx_align_center">36.282</td>
<td id="A8.T5.6.2.31.28.7" class="ltx_td ltx_nopad_r ltx_align_center">207.698</td>
</tr>
<tr id="A8.T5.6.2.32.29" class="ltx_tr">
<th id="A8.T5.6.2.32.29.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">40%</th>
<td id="A8.T5.6.2.32.29.2" class="ltx_td ltx_align_center">45.402</td>
<td id="A8.T5.6.2.32.29.3" class="ltx_td ltx_align_center">42.024</td>
<td id="A8.T5.6.2.32.29.4" class="ltx_td ltx_align_center">39.656</td>
<td id="A8.T5.6.2.32.29.5" class="ltx_td ltx_align_center">38.258</td>
<td id="A8.T5.6.2.32.29.6" class="ltx_td ltx_align_center">35.376</td>
<td id="A8.T5.6.2.32.29.7" class="ltx_td ltx_nopad_r ltx_align_center">200.716</td>
</tr>
<tr id="A8.T5.6.2.33.30" class="ltx_tr">
<th id="A8.T5.6.2.33.30.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">50%</th>
<td id="A8.T5.6.2.33.30.2" class="ltx_td ltx_align_center">42.430</td>
<td id="A8.T5.6.2.33.30.3" class="ltx_td ltx_align_center">39.236</td>
<td id="A8.T5.6.2.33.30.4" class="ltx_td ltx_align_center">37.460</td>
<td id="A8.T5.6.2.33.30.5" class="ltx_td ltx_align_center">35.840</td>
<td id="A8.T5.6.2.33.30.6" class="ltx_td ltx_align_center">33.872</td>
<td id="A8.T5.6.2.33.30.7" class="ltx_td ltx_nopad_r ltx_align_center">188.838</td>
</tr>
<tr id="A8.T5.6.2.34.31" class="ltx_tr">
<th id="A8.T5.6.2.34.31.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="5"><span id="A8.T5.6.2.34.31.1.1" class="ltx_text">FedHKD + Mask</span></th>
<th id="A8.T5.6.2.34.31.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">10%</th>
<td id="A8.T5.6.2.34.31.3" class="ltx_td ltx_align_center ltx_border_t">53.774</td>
<td id="A8.T5.6.2.34.31.4" class="ltx_td ltx_align_center ltx_border_t">51.708</td>
<td id="A8.T5.6.2.34.31.5" class="ltx_td ltx_align_center ltx_border_t">48.298</td>
<td id="A8.T5.6.2.34.31.6" class="ltx_td ltx_align_center ltx_border_t">46.060</td>
<td id="A8.T5.6.2.34.31.7" class="ltx_td ltx_align_center ltx_border_t">42.256</td>
<td id="A8.T5.6.2.34.31.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">242.096</td>
</tr>
<tr id="A8.T5.6.2.35.32" class="ltx_tr">
<th id="A8.T5.6.2.35.32.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">20%</th>
<td id="A8.T5.6.2.35.32.2" class="ltx_td ltx_align_center">51.222</td>
<td id="A8.T5.6.2.35.32.3" class="ltx_td ltx_align_center">49.654</td>
<td id="A8.T5.6.2.35.32.4" class="ltx_td ltx_align_center">45.826</td>
<td id="A8.T5.6.2.35.32.5" class="ltx_td ltx_align_center">44.004</td>
<td id="A8.T5.6.2.35.32.6" class="ltx_td ltx_align_center">40.946</td>
<td id="A8.T5.6.2.35.32.7" class="ltx_td ltx_nopad_r ltx_align_center">231.652</td>
</tr>
<tr id="A8.T5.6.2.36.33" class="ltx_tr">
<th id="A8.T5.6.2.36.33.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">30%</th>
<td id="A8.T5.6.2.36.33.2" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.36.33.2.1" class="ltx_text ltx_font_bold">48.232</span></td>
<td id="A8.T5.6.2.36.33.3" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.36.33.3.1" class="ltx_text ltx_font_bold">47.498</span></td>
<td id="A8.T5.6.2.36.33.4" class="ltx_td ltx_align_center">43.186</td>
<td id="A8.T5.6.2.36.33.5" class="ltx_td ltx_align_center">42.064</td>
<td id="A8.T5.6.2.36.33.6" class="ltx_td ltx_align_center">39.654</td>
<td id="A8.T5.6.2.36.33.7" class="ltx_td ltx_nopad_r ltx_align_center">220.634</td>
</tr>
<tr id="A8.T5.6.2.37.34" class="ltx_tr">
<th id="A8.T5.6.2.37.34.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">40%</th>
<td id="A8.T5.6.2.37.34.2" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.37.34.2.1" class="ltx_text ltx_font_bold">46.524</span></td>
<td id="A8.T5.6.2.37.34.3" class="ltx_td ltx_align_center">45.306</td>
<td id="A8.T5.6.2.37.34.4" class="ltx_td ltx_align_center">41.590</td>
<td id="A8.T5.6.2.37.34.5" class="ltx_td ltx_align_center">40.962</td>
<td id="A8.T5.6.2.37.34.6" class="ltx_td ltx_align_center">37.908</td>
<td id="A8.T5.6.2.37.34.7" class="ltx_td ltx_nopad_r ltx_align_center">212.290</td>
</tr>
<tr id="A8.T5.6.2.38.35" class="ltx_tr">
<th id="A8.T5.6.2.38.35.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">50%</th>
<td id="A8.T5.6.2.38.35.2" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.38.35.2.1" class="ltx_text ltx_font_bold">43.632</span></td>
<td id="A8.T5.6.2.38.35.3" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.38.35.3.1" class="ltx_text ltx_font_bold">43.358</span></td>
<td id="A8.T5.6.2.38.35.4" class="ltx_td ltx_align_center">38.790</td>
<td id="A8.T5.6.2.38.35.5" class="ltx_td ltx_align_center">38.522</td>
<td id="A8.T5.6.2.38.35.6" class="ltx_td ltx_align_center">37.394</td>
<td id="A8.T5.6.2.38.35.7" class="ltx_td ltx_nopad_r ltx_align_center">201.696</td>
</tr>
<tr id="A8.T5.6.2.39.36" class="ltx_tr">
<th id="A8.T5.6.2.39.36.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" rowspan="5"><span id="A8.T5.6.2.39.36.1.1" class="ltx_text">PmcmFL(<span id="A8.T5.6.2.39.36.1.1.1" class="ltx_text ltx_font_bold">Ours</span>)</span></th>
<th id="A8.T5.6.2.39.36.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">10%</th>
<td id="A8.T5.6.2.39.36.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A8.T5.6.2.39.36.3.1" class="ltx_text ltx_font_bold">53.810</span></td>
<td id="A8.T5.6.2.39.36.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A8.T5.6.2.39.36.4.1" class="ltx_text ltx_font_bold">52.846</span></td>
<td id="A8.T5.6.2.39.36.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A8.T5.6.2.39.36.5.1" class="ltx_text ltx_font_bold">49.710</span></td>
<td id="A8.T5.6.2.39.36.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A8.T5.6.2.39.36.6.1" class="ltx_text ltx_font_bold">47.206</span></td>
<td id="A8.T5.6.2.39.36.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A8.T5.6.2.39.36.7.1" class="ltx_text ltx_font_bold">45.106</span></td>
<td id="A8.T5.6.2.39.36.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="A8.T5.6.2.39.36.8.1" class="ltx_text ltx_font_bold">248.678</span></td>
</tr>
<tr id="A8.T5.6.2.40.37" class="ltx_tr">
<th id="A8.T5.6.2.40.37.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">20%</th>
<td id="A8.T5.6.2.40.37.2" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.40.37.2.1" class="ltx_text ltx_font_bold">51.552</span></td>
<td id="A8.T5.6.2.40.37.3" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.40.37.3.1" class="ltx_text ltx_font_bold">50.606</span></td>
<td id="A8.T5.6.2.40.37.4" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.40.37.4.1" class="ltx_text ltx_font_bold">47.584</span></td>
<td id="A8.T5.6.2.40.37.5" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.40.37.5.1" class="ltx_text ltx_font_bold">45.428</span></td>
<td id="A8.T5.6.2.40.37.6" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.40.37.6.1" class="ltx_text ltx_font_bold">43.300</span></td>
<td id="A8.T5.6.2.40.37.7" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A8.T5.6.2.40.37.7.1" class="ltx_text ltx_font_bold">238.470</span></td>
</tr>
<tr id="A8.T5.6.2.41.38" class="ltx_tr">
<th id="A8.T5.6.2.41.38.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">30%</th>
<td id="A8.T5.6.2.41.38.2" class="ltx_td ltx_align_center">48.148</td>
<td id="A8.T5.6.2.41.38.3" class="ltx_td ltx_align_center">47.452</td>
<td id="A8.T5.6.2.41.38.4" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.41.38.4.1" class="ltx_text ltx_font_bold">44.916</span></td>
<td id="A8.T5.6.2.41.38.5" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.41.38.5.1" class="ltx_text ltx_font_bold">42.932</span></td>
<td id="A8.T5.6.2.41.38.6" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.41.38.6.1" class="ltx_text ltx_font_bold">41.054</span></td>
<td id="A8.T5.6.2.41.38.7" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A8.T5.6.2.41.38.7.1" class="ltx_text ltx_font_bold">224.502</span></td>
</tr>
<tr id="A8.T5.6.2.42.39" class="ltx_tr">
<th id="A8.T5.6.2.42.39.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">40%</th>
<td id="A8.T5.6.2.42.39.2" class="ltx_td ltx_align_center">45.792</td>
<td id="A8.T5.6.2.42.39.3" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.42.39.3.1" class="ltx_text ltx_font_bold">45.812</span></td>
<td id="A8.T5.6.2.42.39.4" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.42.39.4.1" class="ltx_text ltx_font_bold">42.874</span></td>
<td id="A8.T5.6.2.42.39.5" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.42.39.5.1" class="ltx_text ltx_font_bold">41.014</span></td>
<td id="A8.T5.6.2.42.39.6" class="ltx_td ltx_align_center"><span id="A8.T5.6.2.42.39.6.1" class="ltx_text ltx_font_bold">39.404</span></td>
<td id="A8.T5.6.2.42.39.7" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A8.T5.6.2.42.39.7.1" class="ltx_text ltx_font_bold">214.896</span></td>
</tr>
<tr id="A8.T5.6.2.43.40" class="ltx_tr">
<th id="A8.T5.6.2.43.40.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">50%</th>
<td id="A8.T5.6.2.43.40.2" class="ltx_td ltx_align_center ltx_border_bb">43.490</td>
<td id="A8.T5.6.2.43.40.3" class="ltx_td ltx_align_center ltx_border_bb">43.018</td>
<td id="A8.T5.6.2.43.40.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A8.T5.6.2.43.40.4.1" class="ltx_text ltx_font_bold">39.912</span></td>
<td id="A8.T5.6.2.43.40.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="A8.T5.6.2.43.40.5.1" class="ltx_text ltx_font_bold">39.132</span></td>
<td id="A8.T5.6.2.43.40.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="A8.T5.6.2.43.40.6.1" class="ltx_text ltx_font_bold">38.264</span></td>
<td id="A8.T5.6.2.43.40.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="A8.T5.6.2.43.40.7.1" class="ltx_text ltx_font_bold">203.816</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A9" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix I </span>Compare with CreamFL</h2>

<div id="A9.p1" class="ltx_para">
<p id="A9.p1.1" class="ltx_p">We compare PmcmFL with CreamFL, and due to the different task scenarios from the main experiment, we present the results here.</p>
</div>
<div id="A9.p2" class="ltx_para">
<p id="A9.p2.1" class="ltx_p">Similar to CreamFL, we conducted experiments in simple scenarios where there are only unimodal clients and modality-complete multimodal clients.
We train models on over 3000 of the most frequent answers (the original VQA task) and report the inference accuracy on 5K testing samples.
Table <a href="#A9.T6" title="Table 6 ‣ Appendix I Compare with CreamFL ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the results.</p>
</div>
<figure id="A9.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Comparison of PmcmFL with baselines in specific task scenarios.</figcaption>
<table id="A9.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A9.T6.1.1.1" class="ltx_tr">
<th id="A9.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Methods</th>
<td id="A9.T6.1.1.1.2" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt">Accuracy</td>
</tr>
<tr id="A9.T6.1.2.2" class="ltx_tr">
<th id="A9.T6.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</th>
<td id="A9.T6.1.2.2.2" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">52.54</td>
</tr>
<tr id="A9.T6.1.3.3" class="ltx_tr">
<th id="A9.T6.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedIoT</th>
<td id="A9.T6.1.3.3.2" class="ltx_td ltx_nopad_r ltx_align_center">53.06</td>
</tr>
<tr id="A9.T6.1.4.4" class="ltx_tr">
<th id="A9.T6.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedMD</th>
<td id="A9.T6.1.4.4.2" class="ltx_td ltx_nopad_r ltx_align_center">57.43</td>
</tr>
<tr id="A9.T6.1.5.5" class="ltx_tr">
<th id="A9.T6.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedET</th>
<td id="A9.T6.1.5.5.2" class="ltx_td ltx_nopad_r ltx_align_center">59.90</td>
</tr>
<tr id="A9.T6.1.6.6" class="ltx_tr">
<th id="A9.T6.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedGEMS</th>
<td id="A9.T6.1.6.6.2" class="ltx_td ltx_nopad_r ltx_align_center">60.23</td>
</tr>
<tr id="A9.T6.1.7.7" class="ltx_tr">
<th id="A9.T6.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reamFL+Avg</th>
<td id="A9.T6.1.7.7.2" class="ltx_td ltx_nopad_r ltx_align_center">58.64</td>
</tr>
<tr id="A9.T6.1.8.8" class="ltx_tr">
<th id="A9.T6.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reamFL+IoT</th>
<td id="A9.T6.1.8.8.2" class="ltx_td ltx_nopad_r ltx_align_center">59.64</td>
</tr>
<tr id="A9.T6.1.9.9" class="ltx_tr">
<th id="A9.T6.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CreamFL</th>
<td id="A9.T6.1.9.9.2" class="ltx_td ltx_nopad_r ltx_align_center">62.12</td>
</tr>
<tr id="A9.T6.1.10.10" class="ltx_tr">
<th id="A9.T6.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">PmcmFL(<span id="A9.T6.1.10.10.1.1" class="ltx_text ltx_font_bold">Ours</span>)</th>
<td id="A9.T6.1.10.10.2" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="A9.T6.1.10.10.2.1" class="ltx_text ltx_font_bold">65.53</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="A9.p3" class="ltx_para">
<p id="A9.p3.1" class="ltx_p">The results show our framework also achieves SOTA performance (a 3.38% boost compared with CreamFL).
This suggests that PmcmFL is equally applicable to specific task scenarios considered by previous works and outperforms methods specifically designed for such scenarios.</p>
</div>
<div id="A9.p4" class="ltx_para">
<p id="A9.p4.1" class="ltx_p">We believe that this performance improvement mainly stems from the utilization of the Multiway Transformer encoder, which excels in modality fusion and thus benefits the task.
This reflects the advantage of our federated framework compared with CreamFL, which cannot train the modality fusion module on the client.</p>
</div>
</section>
<section id="A10" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix J </span>Discussions on ProtoMix</h2>

<div id="A10.p1" class="ltx_para">
<p id="A10.p1.1" class="ltx_p">We first present the testing set matching accuracy for each matching method, followed by an explanation of the results generated by ProtoMix.</p>
</div>
<section id="A10.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">J.1 </span>Accuracy of Various Matching Strategies</h3>

<div id="A10.SS1.p1" class="ltx_para">
<p id="A10.SS1.p1.1" class="ltx_p">Table <a href="#A10.T7" title="Table 7 ‣ J.1 Accuracy of Various Matching Strategies ‣ Appendix J Discussions on ProtoMix ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> displays the matching accuracy of each matching strategy.
The data presented corresponds directly to Table <a href="#S4.T3" title="Table 3 ‣ 4.1 Experiment Setup ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="A10.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>The matching accuracy of various matching strategies under top-1, top-5, top-10, and top-20 matches.</figcaption>
<table id="A10.T7.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A10.T7.1.1.1" class="ltx_tr">
<th id="A10.T7.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="A10.T7.1.1.1.1.1" class="ltx_text">Methods</span></th>
<th id="A10.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4">Matching Accuracy (%)</th>
</tr>
<tr id="A10.T7.1.2.2" class="ltx_tr">
<th id="A10.T7.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Top1</th>
<th id="A10.T7.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Top5</th>
<th id="A10.T7.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Top10</th>
<th id="A10.T7.1.2.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t">Top20</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A10.T7.1.3.1" class="ltx_tr">
<th id="A10.T7.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">L1 Metric</th>
<td id="A10.T7.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">2.46</td>
<td id="A10.T7.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">5.94</td>
<td id="A10.T7.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">10.78</td>
<td id="A10.T7.1.3.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">28.46</td>
</tr>
<tr id="A10.T7.1.4.2" class="ltx_tr">
<th id="A10.T7.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">L2 Metric</th>
<td id="A10.T7.1.4.2.2" class="ltx_td ltx_align_center">1.04</td>
<td id="A10.T7.1.4.2.3" class="ltx_td ltx_align_center">3.14</td>
<td id="A10.T7.1.4.2.4" class="ltx_td ltx_align_center">4.94</td>
<td id="A10.T7.1.4.2.5" class="ltx_td ltx_nopad_r ltx_align_center">11.86</td>
</tr>
<tr id="A10.T7.1.5.3" class="ltx_tr">
<th id="A10.T7.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">COS Metric</th>
<td id="A10.T7.1.5.3.2" class="ltx_td ltx_align_center">1.04</td>
<td id="A10.T7.1.5.3.3" class="ltx_td ltx_align_center">3.32</td>
<td id="A10.T7.1.5.3.4" class="ltx_td ltx_align_center">6.84</td>
<td id="A10.T7.1.5.3.5" class="ltx_td ltx_nopad_r ltx_align_center">27.04</td>
</tr>
<tr id="A10.T7.1.6.4" class="ltx_tr">
<th id="A10.T7.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Classifier(max)</th>
<td id="A10.T7.1.6.4.2" class="ltx_td ltx_align_center">19.10</td>
<td id="A10.T7.1.6.4.3" class="ltx_td ltx_align_center">46.28</td>
<td id="A10.T7.1.6.4.4" class="ltx_td ltx_align_center">50.80</td>
<td id="A10.T7.1.6.4.5" class="ltx_td ltx_nopad_r ltx_align_center">55.16</td>
</tr>
<tr id="A10.T7.1.7.5" class="ltx_tr">
<th id="A10.T7.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Classifier(ens)</th>
<td id="A10.T7.1.7.5.2" class="ltx_td ltx_align_center">22.34</td>
<td id="A10.T7.1.7.5.3" class="ltx_td ltx_align_center">54.38</td>
<td id="A10.T7.1.7.5.4" class="ltx_td ltx_align_center">62.72</td>
<td id="A10.T7.1.7.5.5" class="ltx_td ltx_nopad_r ltx_align_center">69.14</td>
</tr>
<tr id="A10.T7.1.8.6" class="ltx_tr">
<th id="A10.T7.1.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Classifier(avg)</th>
<td id="A10.T7.1.8.6.2" class="ltx_td ltx_align_center">23.20</td>
<td id="A10.T7.1.8.6.3" class="ltx_td ltx_align_center">51.16</td>
<td id="A10.T7.1.8.6.4" class="ltx_td ltx_align_center">57.18</td>
<td id="A10.T7.1.8.6.5" class="ltx_td ltx_nopad_r ltx_align_center">62.74</td>
</tr>
<tr id="A10.T7.1.9.7" class="ltx_tr">
<th id="A10.T7.1.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MLP-Piror(max)</th>
<td id="A10.T7.1.9.7.2" class="ltx_td ltx_align_center">19.56</td>
<td id="A10.T7.1.9.7.3" class="ltx_td ltx_align_center">41.92</td>
<td id="A10.T7.1.9.7.4" class="ltx_td ltx_align_center">42.62</td>
<td id="A10.T7.1.9.7.5" class="ltx_td ltx_nopad_r ltx_align_center">43.46</td>
</tr>
<tr id="A10.T7.1.10.8" class="ltx_tr">
<th id="A10.T7.1.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MLP-Piror(ens)</th>
<td id="A10.T7.1.10.8.2" class="ltx_td ltx_align_center">21.70</td>
<td id="A10.T7.1.10.8.3" class="ltx_td ltx_align_center">47.92</td>
<td id="A10.T7.1.10.8.4" class="ltx_td ltx_align_center">52.38</td>
<td id="A10.T7.1.10.8.5" class="ltx_td ltx_nopad_r ltx_align_center">56.16</td>
</tr>
<tr id="A10.T7.1.11.9" class="ltx_tr">
<th id="A10.T7.1.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">MLP-Piror(avg)</th>
<td id="A10.T7.1.11.9.2" class="ltx_td ltx_align_center ltx_border_bb">0.36</td>
<td id="A10.T7.1.11.9.3" class="ltx_td ltx_align_center ltx_border_bb">4.32</td>
<td id="A10.T7.1.11.9.4" class="ltx_td ltx_align_center ltx_border_bb">5.36</td>
<td id="A10.T7.1.11.9.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">9.72</td>
</tr>
</tbody>
</table>
</figure>
<div id="A10.SS1.p2" class="ltx_para">
<p id="A10.SS1.p2.1" class="ltx_p">We can see that there is a significant difference in the matching accuracy of prototype matching strategies with different approaches.
The top-1 matching accuracy of the model-free matching strategy is only around 1.04-2.46%, while the top-1 prototype matching accuracy of the model-based matching strategy is approximately 19.10-23.20% (except for MLP-Prior with parameter aggregation).</p>
</div>
<div id="A10.SS1.p3" class="ltx_para">
<p id="A10.SS1.p3.1" class="ltx_p">In addition, compared to the top-1 matching accuracy, the matching accuracy for top-k (k=5, 10, 20) shows significant improvement.
This suggests that considering more prototypes may lead to obtaining more closely matched prototypes, which forms the basis for our proposal of Protomix.</p>
</div>
<div id="A10.SS1.p4" class="ltx_para">
<p id="A10.SS1.p4.1" class="ltx_p">Compared to Table <a href="#S4.T3" title="Table 3 ‣ 4.1 Experiment Setup ‣ 4 Experiment ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> in the main text, we observe a positive correlation between top-1 prototype matching accuracy and accuracy of inference with missing modalities.
The positive correlation is reasonable and the effect we desire, which also indicates that, for higher accuracy of inference with missing modalities, we should strive to improve the accuracy of prototype matching.
In fact, when we perform unimodal inference using the corresponding prototypes (prototype matching accuracy is 100% ), its accuracy can reach 43.314%, which is only 8.942% lower than the modality-complete inference.</p>
</div>
</section>
<section id="A10.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">J.2 </span>Analysis of ProtoMix</h3>

<div id="A10.SS2.p1" class="ltx_para">
<p id="A10.SS2.p1.1" class="ltx_p">Figure <a href="#A10.F9" title="Figure 9 ‣ J.2 Analysis of ProtoMix ‣ Appendix J Discussions on ProtoMix ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> displays all possible ProtoMix results for nine matching strategies.</p>
</div>
<figure id="A10.F9" class="ltx_figure"><img src="/html/2312.13508/assets/pic_suppl/protomix.png" id="A10.F9.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="449" height="377" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>All possible ProtoMix results for nine matching strategies.
The horizontal axis represents the k values in the top-k ProtoMix, while the vertical axis represents the corresponding accuracy of inference with missing modalities.
The horizontal line represents the accuracy of the top-1 ProtoMix.</figcaption>
</figure>
<div id="A10.SS2.p2" class="ltx_para">
<p id="A10.SS2.p2.1" class="ltx_p">We observe that almost all matching strategies benefit from ProtoMix, indicating that our proposed strategy of augmenting prototype semantics is effective.
However, the performance improvement brought by Top-k ProtoMix is very limited and does not correspond to the accuracy of Top-k prototype matching, which suggests that there is still significant space for improvement in our ProtoMix.</p>
</div>
<div id="A10.SS2.p3" class="ltx_para">
<p id="A10.SS2.p3.1" class="ltx_p">Additionally, we observed significant differences in the performance of ProtoMix under different matching strategies, and we will analyze them one by one.
There are two key factors influencing the performance of ProtoMix: prototype matching accuracy and matching confidence.</p>
</div>
<div id="A10.SS2.p4" class="ltx_para">
<p id="A10.SS2.p4.1" class="ltx_p">For the three model-free matching strategies, both matching accuracy and confidence are relatively low.
The results indicate that combining top-k prototypes with confidence-weighted fusion results in prototypes with more accurate semantics.</p>
</div>
<div id="A10.SS2.p5" class="ltx_para">
<p id="A10.SS2.p5.1" class="ltx_p">For the three classifier-based matching strategies, their matching accuracy is generally moderate, but the confidence in the top-1 match is exceptionally high.
We observed that both a single classifier and a parameter-aggregated classifier have 19.10% matching accuracy but almost boast over 99% confidence in the top-1 class.
The results in very little semantic information from other prototypes were obtained when combining top-k prototypes with confidence-weighted fusion.
Consequently, the inference accuracy remains the same regardless of how many prototypes are fused.
This limitation stems from the poor generalization ability of the classifier, as it tends to overfit the uneven distribution of client data during training on the client side.</p>
</div>
<div id="A10.SS2.p6" class="ltx_para">
<p id="A10.SS2.p6.1" class="ltx_p">For the three retrieval-based matching strategies, we observed that a single prior has 19.56% prototype matching accuracy and possesses a top-1 retrieval score with less prominent confidence, creating a difference between the maximum prior and the ensemble prior.
However, since parameter aggregation does not apply to non-classification tasks, the aggregated model exhibits low matching accuracy and confidence, leading to performance comparable to model-free matching strategies.</p>
</div>
</section>
</section>
<section id="A11" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix K </span>Additional Visualization</h2>

<section id="A11.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">K.1 </span>Representation Distribution among Clients</h3>

<div id="A11.SS1.p1" class="ltx_para">
<p id="A11.SS1.p1.1" class="ltx_p">We visualized more representation distributions learned by various clients.
Figure <a href="#A11.F10" title="Figure 10 ‣ K.1 Representation Distribution among Clients ‣ Appendix K Additional Visualization ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> displays the visualized results.
We observe that, compared to the baseline method FedAvg, our PmcmFL reduces the heterogeneity in the feature space among clients (i.e., mitigates client drift).</p>
</div>
<figure id="A11.F10" class="ltx_figure"><img src="/html/2312.13508/assets/pic_suppl/tsne1-suppl.png" id="A11.F10.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="446" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Representation Distribution among Clients.
Dots of the same color come from the same client. Compared to the baseline, our PmcmFL reduces heterogeneity between clients.</figcaption>
</figure>
</section>
<section id="A11.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">K.2 </span>Representation Distribution among Classes</h3>

<div id="A11.SS2.p1" class="ltx_para">
<p id="A11.SS2.p1.1" class="ltx_p">We visualized more representation distributions learned by the global model among various classes.
Figure <a href="#A11.F11" title="Figure 11 ‣ K.2 Representation Distribution among Classes ‣ Appendix K Additional Visualization ‣ Multimodal Federated Learning with Missing Modality via Prototype Mask and Contrast" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> displays the visualized results.
We can observe that, compared to the baseline method, our PmcmFL can cluster representations by class.</p>
</div>
<figure id="A11.F11" class="ltx_figure"><img src="/html/2312.13508/assets/pic_suppl/tsne2-suppl.png" id="A11.F11.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="568" height="568" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Representation Distribution among Classes.
Dots of the same color represent the fused representation of the same class. Compared to the baseline, our PmcmFL can cluster representations by class.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2312.13506" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2312.13508" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2312.13508">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2312.13508" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2312.13509" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 12:30:26 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
