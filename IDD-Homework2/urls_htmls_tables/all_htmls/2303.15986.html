<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.15986] Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks</title><meta property="og:description" content="There is a growing trend of cyberattacks against Internet of Things (IoT) devices; moreover, the sophistication and motivation of those attacks is increasing. The vast scale of IoT, diverse hardware and software, and b…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.15986">

<!--Generated on Thu Feb 29 17:32:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Anomaly detection,  Botnet,  Internet of Things,  Intrusion detection,  Machine learning,  Network security
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold" style="font-size:144%;">Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks</span></p>
</div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p"><span id="p2.1.1" class="ltx_text" style="font-size:173%;">This article has been accepted for publication in Computers &amp; Security</span></p>
</div>
<div id="p3" class="ltx_para">
<p id="p3.1" class="ltx_p"><span id="p3.1.1" class="ltx_text" style="font-size:173%;">Citation information: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://doi.org/10.1016/j.cose.2023.103299</span></span></p>
</div>
<div id="p4" class="ltx_para">
<p id="p4.1" class="ltx_p"><span id="p4.1.1" class="ltx_text" style="font-size:144%;">This is a PDF file of an article that has undergone enhancements after acceptance, such as the addition of a cover page and metadata, and formatting for readability, but it is not yet the definitive version of record. This version will undergo additional copyediting, typesetting and review before it is published in its final form, but we are providing this version to give early visibility of the article. Please note that, during the production process, errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.</span></p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<h1 class="ltx_title ltx_title_document">Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks
<span id="id1.id1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span></span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xabier Sáez-de-Cámara123, Jose Luis Flores1, Cristóbal Arellano1, Aitor Urbieta1 and Urko Zurutuza2
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">1Ikerlan Technology Research Centre, Basque Research and Technology Alliance (BRTA)
<br class="ltx_break">Arrasate-Mondragón, Spain
<br class="ltx_break">{xsaezdecamara, jlflores, carellano, aurbieta}@ikerlan.es
</span>
<span class="ltx_contact ltx_role_affiliation">2Mondragon Unibertsitatea
<br class="ltx_break">Arrasate-Mondragón, Spain
<br class="ltx_break">uzurutuza@mondragon.edu
</span>
<span class="ltx_contact ltx_role_affiliation">3Corresponding author
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">There is a growing trend of cyberattacks against Internet of Things (IoT) devices; moreover, the sophistication and motivation of those attacks is increasing. The vast scale of IoT, diverse hardware and software, and being typically placed in uncontrolled environments make traditional IT security mechanisms such as signature-based intrusion detection and prevention systems challenging to integrate. They also struggle to cope with the rapidly evolving IoT threat landscape due to long delays between the analysis and publication of the detection rules. Machine learning methods have shown faster response to emerging threats; however, model training architectures like cloud or edge computing face multiple drawbacks in IoT settings, including network overhead and data isolation arising from the large scale and heterogeneity that characterizes these networks.</p>
<p id="id3.id2" class="ltx_p">This work presents an architecture for training unsupervised models for network intrusion detection in large, distributed IoT and Industrial IoT (IIoT) deployments. We leverage Federated Learning (FL) to collaboratively train between peers and reduce isolation and network overhead problems. We build upon it to include an unsupervised device clustering algorithm fully integrated into the FL pipeline to address the heterogeneity issues that arise in FL settings. The architecture is implemented and evaluated using a testbed that includes various emulated IoT/IIoT devices and attackers interacting in a complex network topology comprising 100 emulated devices, 30 switches and 10 routers. The anomaly detection models are evaluated on real attacks performed by the testbed’s threat actors, including the entire Mirai malware lifecycle, an additional botnet based on the Merlin command and control server and other red-teaming tools performing scanning activities and multiple attacks targeting the emulated devices.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Anomaly detection, Botnet, Internet of Things, Intrusion detection, Machine learning, Network security

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The ever-growing adoption of the Internet of Things (IoT) is enabling manufacturers multiple benefits, such as productivity boosts, increased automation, cost savings, and the minimization of production errors and waste. This is achieved by connecting Internet-enabled devices, Cyber-Physical Systems (CPS) and other “things” with the ability to collect, monitor, analyze and share data to make decisions and interact with physical processes, often with little or no human intervention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. However, this high level of connectivity also brings a higher risk of cybersecurity breaches and a bigger attack surface both for domestic and industrial IoT devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Especially nowadays that many solutions are being replaced with commercial off-the-shelf devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> that prioritize fast market adoption and convenience over security <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Poor security practices and vulnerabilities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, coupled with the mass adoption and high interconnectivity, make IoT an attractive target for malware designers. A notable example is the 2016 Mirai worm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, which exploited the widespread use of weak or hardcoded passwords to compromise a diverse set of devices from various manufacturers. The sophistication of those threats continues to grow. Newer Mirai variants developed after the public release of its source code <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and other advanced IoT malware such as Mozi<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://malpedia.caad.fkie.fraunhofer.de/details/elf.mozi</span></span></span> and VPNFilter<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://malpedia.caad.fkie.fraunhofer.de/details/elf.vpnfilter</span></span></span> include additional functionality exploiting different protocols and software vulnerabilities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. The compromised devices are usually leveraged to perform different attack campaigns, including Distributed Denial of Service (DDoS) attacks, cryptocurrency mining, spamming or advertisement click fraud <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Exposed industrial IoT (IIoT) systems are also the targets of numerous attacks that may pose additional risks due to the critical nature of these devices, including ransomware, sabotage, intellectual property theft, or be used as a pivot point to infiltrate into other systems in the IT or OT infrastructure <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Several mitigation strategies have been proposed to defend against these threats. For instance, the use of specialized Operating Systems, the removal of nonessential services, reliable update mechanisms, event loggers and basic hardening operations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. However, those mitigations do not guarantee a secure environment; misconfigurations, the discovery of new vulnerabilities and zero-days still make IoT devices prone to attacks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. As an additional security layer, Intrusion Detection Systems (IDS) and Intrusion Prevention Systems (IPS) are commonly deployed to protect the network. However, traditional signature-based IDS and other methods, such as blocklists, struggle to keep up with new IoT threats due to the usage of obfuscation techniques, packed binaries, and string modifications by malware distributors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, rapid changes in botnet control infrastructure <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and long delays between the malware analysis and the publication of the corresponding rules <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Machine Learning (ML) and Deep Learning (DL) methods have shown promising results in developing IDS, exhibiting more flexibility and generalization than traditional signature-based detection methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. However, from the point of view of ML model training infrastructure, cloud-based centralized architectures exhibit many problems in IoT settings due to the massive scale and heterogeneity of these deployments. Problems such as high bandwidth consumption, network resource congestion and load balancing arise, leading to packet loss, transmission delays, high latency and traffic peaks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> that can adversely affect the training process or even make cloud training infeasible. In addition, data centralization can raise privacy concerns and the need to comply with regulations such as the General Data Protection Regulation (GDPR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. As an alternative, proposals to shift the computation toward the “edge” of the network are being made <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. While edge computing can alleviate some of the problems of centralized architectures, other additional issues like data islands and isolation arise, which can hinder the application of ML because it effectively reduces the volume of data available for training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">A promising alternative that could address the network overhead, privacy and data isolation issues and is gaining significant attention is Federated Learning (FL). FL is a ML setting introduced in 2016 by McMahan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> with the objective to train a single model (the global model) from data distributed at multiple remote devices (clients). The most particular characteristic about FL is that each device’s local training dataset does not leave the device; instead, each client independently computes some local model update and communicates the results to a central server, which aggregates the local updates from all the clients to train the global model iteratively. Data is kept locally on each device, and only model updates are transmitted to the aggregation server, which preserves data privacy requirements. Since model updates are typically smaller than the size of the dataset, network overhead problems can also be reduced. Additionally, data isolation is minimized because multiple clients participate in training the global model.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">However, there are still some difficulties to be considered for a practical FL deployment. Even though FL assumes that the data generation does not follow Independent and Identically Distributed (IID) assumptions across all the clients, in practice, highly non-IID settings can hinder global model convergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. This can happen in highly heterogeneous settings such as large IoT networks composed of devices communicating with a diverse set of protocols.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">To address the described issues, we propose a FL architecture for training anomaly-based IDS in large networks of heterogeneous IoT devices. To aggregate knowledge from all the devices, the system will leverage the FL framework to collaboratively train the anomaly detection models between multiple participants without sending each device’s local data, thus reducing network overhead and tackling data isolation and privacy considerations.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">In particular, to address the mentioned global model convergence problems that arise in typical FL settings with heterogeneous clients, we propose a clustered FL process that can be divided into two steps. First, before the local models are aggregated in the initial FL round, the local partially trained models from all the clients are clustered in a fully unsupervised way based on similarities between model parameters, following the hypothesis that clients with similar data distributions will converge towards models with similar parameter values. In this step, each client is assigned to a cluster center. Then, an independent FL training process is started for each identified cluster of devices. The contributions can be summarized as follows:</p>
</div>
<div id="S1.p9" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose and test a clustered FL architecture for unsupervised anomaly detection IDS model training applied to a network of heterogeneous IoT devices. We test and optimize different FL aggregation functions. The detection model is based on autoencoders trained on benign instances of IoT network traffic data to model their normal behavior. Attack traces are not used for training, only for evaluation; hence, a labeled attack dataset is unnecessary for model training.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose an unsupervised model fingerprinting for device clustering method to address global model convergence problems in heterogeneous FL settings. The method is performed on the local model updates; thus, there is no need to send additional metadata to the FL server, incorporate external fingerprinting tools or perform manual clustering. The method is fully integrated into the FL pipeline and does not need human intervention.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We evaluate the clustered FL architecture on an emulated network scenario based on the Gotham testbed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. The scenario includes 78 IoT and IIoT devices communicating with a diverse set of protocols (including MQTT, CoAP and RTSP) and different network behavior to emulate a heterogeneous environment. The IoT devices interact with 12 different cloud layer services and applications. Additionally, the scenario includes 10 attacker machines executing real IoT threats.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We provide experimental results for the trained FL models. Including comparisons with a state-of-the-art approach.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p">The rest of this paper is structured as follows. Section <a href="#S2" title="II Related Work ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> covers the related work. Section <a href="#S3" title="III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> discusses the proposed system model, including the FL process, the model fingerprinting for device clustering algorithm and the autoencoder anomaly detection model. Section <a href="#S4" title="IV IoT Testbed and Experimental Setup ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> details the IoT testbed and the data generation and collection setup. Section <a href="#S5" title="V Implementation ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> describes the implementation methodology of the experiments, and section <a href="#S6" title="VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a> shows the results. Finally, the paper is concluded in section <a href="#S7" title="VII Conclusions ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we are going to describe state-of-the-art publications related to the proposals in this work. First, we will review manuscripts that apply FL techniques for IoT intrusion or anomaly detection. Then, we will describe works about clustered FL methods.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Federated Learning for IoT Intrusion and Anomaly Detection</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Recently, several proposals have emerged that use FL techniques for IoT intrusion detection. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> Nguyen et al. present DÏot, an unsupervised system for network anomaly detection applied to consumer IoT devices for detecting Mirai-like worm behavior. First, an external fingerprinting tool groups all the devices based on their network behavior. Then, the FL process trains multiple global models, each one of them specific to an IoT device type group. However, one limiting factor in this approach is that a software for automatically identifying IoT device types must be available in each gateway prior to the FL process, making the model training and the device grouping not fully integrated into the same process and requiring additional time to deploy and train the system. Applied in a similar environment, Rey et al. develop in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> a framework based on FL to detect cyberattacks against IoT devices using the N-BaIoT dataset. Additionally, they evaluate several adversarial attacks against the proposed FL framework. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> Popoola et al. use the Bot-IoT and N-BaIoT datasets to train a single supervised classification global model in a FL setting and compares it with centralized and localized architectures. Another comparison between a FL intrusion detection scheme with a centralized and on-device training is shown by Rahman et al. in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Other proposals focus on training models, or ensembles of models, that combine different input data types or views. Attota et al. propose in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> an IDS using a multi-view ensemble of models trained with FL; three specific models are trained for each different view (network packets, unidirectional flow and bidirectional flow). Features are selected via a Grey Wolves optimization process. A random forest classifier is used to combine the prediction of the three models. Similarly, Quin et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> introduce a greedy feature selection algorithm to obtain appropriate feature sets according to a single attack type that each device wants to detect. They suggest training multiple global models by grouping the devices based on the feature set selected in each client and initiating an independent FL process for each group. However, in practice, this grouping method requires prior knowledge of attacks that may not be available in a realistic environment and leaks feature set information to the aggregation server. Additionally, devices can be under multiple types of attacks at different time intervals, which will not be detected based on this method. Zhao et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> train a single multi-task model in a FL setting to perform network anomaly detection, traffic classification and Tor traffic identification simultaneously using multiple input datasets.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Alternative architectures like hierarchical FL, are also being explored for IoT intrusion detection. Wang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> describe an FL architecture based on four levels and assumes some of them are untrusted. Saadat et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> compare a standard FL architecture with a hierarchical one in terms of model training loss progression and testing accuracy for the training of an IDS using a supervised multilayer neural network on the NSL-KDD dataset. Wei et al. apply it to a 5G network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">For more industrial approaches, in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> Li et al. present an IDS for industrial CPSs based on a FL scheme combined with a Paillier cryptosystem to increase the security of the model updates during the training. A recent example by Mothukuri et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> shows a FL-based IDS for IoT networks. They use a dataset composed of labeled network traffic data from industrial Modbus protocol. Kelli et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> propose an IDS for industrial DNP3 protocol specific attack detection combining FL and active learning to perform local model personalization for each client.</p>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.1" class="ltx_p">Alternative IoT attack detection approaches exist, such as UWPEE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, where they use a UAV to collect data from distributed IoT devices, and develop a detector based on wavelet packet energy entropy to detect attacks and assign trust to the devices. Outside of the network intrusion detection field, FL settings for IoT devices have also been proposed in sectors such as healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> and predictive maintenance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, to name a few.</p>
</div>
<div id="S2.SS1.p6" class="ltx_para">
<p id="S2.SS1.p6.1" class="ltx_p">Most of the proposed approaches use supervised methods for model training, while unsupervised methods do not receive as much attention in the literature. In a real deployment, obtaining labeled network data to train the models is not viable at a practical level. Extending FL to unsupervised methods is still an open challenge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Additionally, only a few papers consider the heterogeneity of IoT devices. In the cases where the heterogeneity is considered, they require a manual segmentation of the IoT devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, hardcoded device properties such as the 6-tuple in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, prior knowledge of attack types that target the IoT devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> or the help of external tools that are not fully integrated into the FL training pipeline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. Moreover, most datasets for intrusion detection were not designed to be applicable to large distributed IoT environments; therefore, many researchers resort to artificially partitioning the dataset to simulate distributed environments in which to apply FL, which is not indicative of a realistic heterogeneous IoT environment. Furthermore, most articles limit themselves to the order of 10 participating clients or less in the FL process, which does not reflect typical IoT environments, making it difficult to draw conclusions on the applicability of FL for IoT anomaly detection.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Clustered Federated Learning</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Even though FL is based on the assumption that data is non-IID, in practice, it can show convergence problems when learning a single global model in settings with many heterogeneous clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Several strategies have been proposed to address these challenges and increase the personalization of FL models. One of the strategies is based on client or data clustering, which is particularly suitable for environments with inherent partitioning among FL clients, as can occur in IoT settings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Sattler et al. propose Clustered FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, which groups the client population into clusters based on the cosine similarity of clients’ gradient updates. The clustering is performed as a post-processing step after the FL has converged. Ghosh et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> present an outlier robust clustering algorithm based on K-means that also considers an adversarial setting. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, Briggs et al. introduce a clustering step to group clients according to the similarity of their local updates using hierarchical clustering methods. Then, FL is performed on each group independently.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">Ghosh et al. develop IFCA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, which iteratively solves the estimation of cluster identities and model training. When the cluster structure is ambiguous, they leverage weight sharing techniques from multi-task learning. Contrary to our approach, it does not require a centralized clustering algorithm. However, since clients need to identify their own cluster membership, each client receives all k models, increasing transmission cost and client computation load. Additionally, the value of k must be known at the start of the FL process.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.1" class="ltx_p">A Community-based FL algorithm for processing medical records is presented by Huang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, which includes a clustering step to group the distributed data (not the clients) into several communities and a FL training step on each community. Their method requires two FL processes. The first one consists of training an autoencoder model for 1 FL round. The trained encoder is applied to each local data sample, and the averages are sent to the server to train a K-means model. In the second step, K different neural networks are trained in multiple rounds of FL. Each client receives and transmits all K models at each round. Locally, the Autoencoder and K-means are used to segment the data into K fractions, one for each global model, significantly increasing the client’s workload and data transmission.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.1" class="ltx_p">Duan et al. present FedGroup <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, a framework that groups the clients using a proposed metric based on the cosine similarity between the optimization direction. The number of groups needs to be known a priori, and the selection of this parameter is not thoroughly discussed. Before the client clustering, a subset of the clients need to perform full pretraining of the model. After the groups are identified, the FL training process begins. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, they propose an updated version that considers client distribution changes; when the shift is significant, they treat them as newcomer devices.</p>
</div>
<div id="S2.SS2.p6" class="ltx_para">
<p id="S2.SS2.p6.1" class="ltx_p">Xie et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> propose a multi-center aggregation algorithm to learn multiple global models in a supervised learning scenario. This is performed by solving a joint optimization problem that minimizes the supervised loss function and the distance to the nearest global model of each cluster. The number of global models K needs to be known a priori, and since K is embedded into the optimization problem, selecting the optimal value of K requires repeating several FL processes fully until convergence, difficulting its application in practical settings.</p>
</div>
<div id="S2.SS2.p7" class="ltx_para">
<p id="S2.SS2.p7.1" class="ltx_p">Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> exploit the natural geographical clustering of factories to group the clients and propose a method that considers the divergence in class label distribution between the clients’ data to minimize heterogeneity. However, the number of clusters needs to be selected prior to the training, and it requires data class labeling information, which is unsuitable for unsupervised approaches. Similarly, Hiessl et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> group clients with similar data distributions using two approaches. The first one requires labeled data. The second one sends clients’ training data statistics to the server, increasing communication costs and partially disclosing information.</p>
</div>
<div id="S2.SS2.p8" class="ltx_para">
<p id="S2.SS2.p8.1" class="ltx_p">Guo et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> mitigate the data imbalance by presenting a data adjustment method that finds the samples corresponding to the minority class label and oversamples them. They require the FL central server to have training data to infer the data distribution of the clients and retrain the global model on the oversampled data. When the data is insufficient, the server will dynamically group clients with an adequate data class balance and use them to refine the global model at each FL round.</p>
</div>
<div id="S2.SS2.p9" class="ltx_para">
<p id="S2.SS2.p9.1" class="ltx_p">Other lines of work relax the hard clustering assumptions, where a client is associated with a single cluster, to a soft clustering model that allows combining data from different distributions with varying mixture ratios, as in Ruan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>.</p>
</div>
<div id="S2.SS2.p10" class="ltx_para">
<p id="S2.SS2.p10.1" class="ltx_p">Our work differs from the previously referenced proposals on clustered FL in several ways. The approaches that group model parameters using centralized clustering algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> lead to high computation costs and may not be practical for setting with large models and a large number of clients. In contrast, we include parameter dimensionality reduction methods to mitigate that issue. Other proposals require each client to process K models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, increasing local computation and bandwidth load. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, the number of clusters needs to be known a priori, and selecting an optimal value for it requires completing the full clustered FL training, which is costly and complicates the hyperparameter selection step in practical settings. More importantly, all the approaches assume a supervised learning setting, and some require the presence of labels to perform the clustering or personalization process <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>. In contrast, our proposal and experimentation methodology focus on unsupervised settings. Finally, none of those methods were applied to the IoT security field. This paper presents a practical use of clustered FL methods to address IoT network attacks using clustering methods fully integrated into the FL training pipeline and unsupervised anomaly-based network intrusion detection models.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Proposed System Model</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">This section first shows a high-level overview of the proposed system architecture and the targeted deployment setting. Then, we present the proposed clustered FL architecture, describing our contributions on top of the standard FL process to include the integrated model fingerprinting for the device clustering step. We finally have a brief review of autoencoder neural networks for anomaly detection.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Deployment Setting and Architecture</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The proposed architecture to train the IDS is depicted in Figure <a href="#S3.F1" title="Figure 1 ‣ III-A Deployment Setting and Architecture ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. It comprises many clients and a central aggregation server and also shows potential attackers.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2303.15986/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="193" height="232" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Proposed system architecture. Each IoT device (FL clients) holds a copy of the ML model for local training and inference. The FL training process is mediated by the aggregation server. The FL aggregation server can also be part of the IoT cloud, but here it is shown separately for clarity.</figcaption>
</figure>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS1.4.1.1" class="ltx_text">III-A</span>1 </span>Clients</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.1" class="ltx_p">The proposed system is devised to operate in a large network of heterogeneous IoT devices such as gateways, CPS and industrial machines that communicate using different protocols. Those devices can be located in different network segments or geographically distributed, which may influence their behavior. The devices are constantly sending/receiving data to/from the cloud layer.</p>
</div>
<div id="S3.SS1.SSS1.p2" class="ltx_para">
<p id="S3.SS1.SSS1.p2.1" class="ltx_p">Each device is considered a client in the FL process. They are responsible for capturing relevant data, local ML model training, and model inference for anomaly detection after the training is completed. No training data is transmitted to the aggregation server, only model parameters and minimal metadata relevant to the FL process. Devices are expected to perform lightweight ML tasks, but for low-powered IoT devices such as sensors and actuators, the system is expected to be deployed at the hub or gateway level. In this work, we prioritize the use of lightweight ML models for anomaly detection to limit the computational overhead during model training or inference.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS2.4.1.1" class="ltx_text">III-A</span>2 </span>Aggregation server</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">It coordinates all the FL training process by initializing and distributing the model and training hyperparameters to the clients, receiving model updates from the clients, performing the model fingerprinting and device clustering, running the per cluster aggregation of the received models and sending the corresponding aggregated global model to each client. These steps are explained in the next subsection.</p>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS3.4.1.1" class="ltx_text">III-A</span>3 </span>Attackers</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para">
<p id="S3.SS1.SSS3.p1.1" class="ltx_p">In this paper, we consider two primary threat models. The first one considers external actors that remotely scan the IoT devices in the network, find vulnerable devices to exploit and remotely compromise them. The second assumes a local adversary compromising one or many IoT devices within the protected network and leveraging them to launch attacks against other devices in the same network or target external victims. In section <a href="#S4" title="IV IoT Testbed and Experimental Setup ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>, we will detail the different threat actors, attacks performed and malicious behavior.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Clustered Federated Learning Process for Heterogeneous Devices</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">For the FL deployment, we consider a typical cross-device setting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> with a large number of devices. However, due to availability guarantees required by many IoT devices, especially in industrial settings, we expect most devices to participate in the FL training process. This allows the server to maintain a persistent state for each client to perform the clustering step. In this work, we assume that no IoT device is infected prior to the FL model training and that none of them behave in an adversarial manner. Model poisoning attacks against FL are outside the scope of this paper, even if already considered in some academic works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Our clustered FL builds upon the generalized FL setting proposed by Reddi et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. This generalized FL setting, described in Algorithm <a href="#alg1" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, improves over standard FL optimization methods such as the popular Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> by including adaptive optimization methods for the local model training at each client and also at the server level during the model aggregation process.</p>
</div>
<figure id="S3.SS2.fig1" class="ltx_figure">
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.27" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.27.28" class="ltx_listingline">






</div>
<div id="alg1.27.29" class="ltx_listingline">

</div>
<div id="alg1.27.30" class="ltx_listingline">

</div>
<div id="alg1.1.1" class="ltx_listingline">
<span id="alg1.1.1.2" class="ltx_text ltx_font_bold">Function</span> <em id="alg1.1.1.1" class="ltx_emph ltx_font_typewriter">LocalTrain(<em id="alg1.1.1.1.1.1" class="ltx_emph ltx_font_serif ltx_font_italic"><math id="alg1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="alg1.1.1.1.1.1.m1.1a"><mi id="alg1.1.1.1.1.1.m1.1.1" xref="alg1.1.1.1.1.1.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.1.1.m1.1b"><ci id="alg1.1.1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.1.1.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.1.1.m1.1c">\mathbf{w}</annotation></semantics></math>, epochs</em>)</em><span id="alg1.1.1.3" class="ltx_text ltx_font_bold">:</span> 
</div>
<div id="alg1.2.2" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.2.2.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.2.2.1" class="ltx_emph ltx_font_italic">local epoch e <math id="alg1.2.2.1.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.2.2.1.m1.1a"><mo stretchy="false" id="alg1.2.2.1.m1.1.1" xref="alg1.2.2.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.2.2.1.m1.1b"><ci id="alg1.2.2.1.m1.1.1.cmml" xref="alg1.2.2.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.1.m1.1c">\leftarrow</annotation></semantics></math> 1 <span id="alg1.2.2.1.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> epochs</em> <span id="alg1.2.2.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.27.31" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.27.31.1" class="ltx_text ltx_font_bold">for</span> <em id="alg1.27.31.2" class="ltx_emph ltx_font_italic">batch b <span id="alg1.27.31.2.1" class="ltx_text ltx_font_bold ltx_font_upright">in</span> local training data</em> <span id="alg1.27.31.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.3.3" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.3.3.m1.1" class="ltx_Math" alttext="\mathbf{g}\leftarrow" display="inline"><semantics id="alg1.3.3.m1.1a"><mrow id="alg1.3.3.m1.1.1" xref="alg1.3.3.m1.1.1.cmml"><mi id="alg1.3.3.m1.1.1.2" xref="alg1.3.3.m1.1.1.2.cmml">𝐠</mi><mo stretchy="false" id="alg1.3.3.m1.1.1.1" xref="alg1.3.3.m1.1.1.1.cmml">←</mo><mi id="alg1.3.3.m1.1.1.3" xref="alg1.3.3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.1b"><apply id="alg1.3.3.m1.1.1.cmml" xref="alg1.3.3.m1.1.1"><ci id="alg1.3.3.m1.1.1.1.cmml" xref="alg1.3.3.m1.1.1.1">←</ci><ci id="alg1.3.3.m1.1.1.2.cmml" xref="alg1.3.3.m1.1.1.2">𝐠</ci><csymbol cd="latexml" id="alg1.3.3.m1.1.1.3.cmml" xref="alg1.3.3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m1.1c">\mathbf{g}\leftarrow</annotation></semantics></math> compute gradient
</div>
<div id="alg1.7.7" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.4.4.m1.1" class="ltx_Math" alttext="\mathbf{w}\leftarrow" display="inline"><semantics id="alg1.4.4.m1.1a"><mrow id="alg1.4.4.m1.1.1" xref="alg1.4.4.m1.1.1.cmml"><mi id="alg1.4.4.m1.1.1.2" xref="alg1.4.4.m1.1.1.2.cmml">𝐰</mi><mo stretchy="false" id="alg1.4.4.m1.1.1.1" xref="alg1.4.4.m1.1.1.1.cmml">←</mo><mi id="alg1.4.4.m1.1.1.3" xref="alg1.4.4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.4.m1.1b"><apply id="alg1.4.4.m1.1.1.cmml" xref="alg1.4.4.m1.1.1"><ci id="alg1.4.4.m1.1.1.1.cmml" xref="alg1.4.4.m1.1.1.1">←</ci><ci id="alg1.4.4.m1.1.1.2.cmml" xref="alg1.4.4.m1.1.1.2">𝐰</ci><csymbol cd="latexml" id="alg1.4.4.m1.1.1.3.cmml" xref="alg1.4.4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m1.1c">\mathbf{w}\leftarrow</annotation></semantics></math> <span id="alg1.7.7.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span>(<math id="alg1.5.5.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="alg1.5.5.m2.1a"><mi id="alg1.5.5.m2.1.1" xref="alg1.5.5.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="alg1.5.5.m2.1b"><ci id="alg1.5.5.m2.1.1.cmml" xref="alg1.5.5.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m2.1c">\mathbf{w}</annotation></semantics></math>, <math id="alg1.6.6.m3.1" class="ltx_Math" alttext="\mathbf{g}" display="inline"><semantics id="alg1.6.6.m3.1a"><mi id="alg1.6.6.m3.1.1" xref="alg1.6.6.m3.1.1.cmml">𝐠</mi><annotation-xml encoding="MathML-Content" id="alg1.6.6.m3.1b"><ci id="alg1.6.6.m3.1.1.cmml" xref="alg1.6.6.m3.1.1">𝐠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m3.1c">\mathbf{g}</annotation></semantics></math>, <math id="alg1.7.7.m4.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.7.7.m4.1a"><mi id="alg1.7.7.m4.1.1" xref="alg1.7.7.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.7.7.m4.1b"><ci id="alg1.7.7.m4.1.1.cmml" xref="alg1.7.7.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m4.1c">\eta</annotation></semantics></math>, e)
</div>
<div id="alg1.27.32" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.27.33" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="alg1.27.34" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.27.35" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="alg1.8.8" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.8.8.1" class="ltx_text ltx_font_bold">return</span> <math id="alg1.8.8.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="alg1.8.8.m1.1a"><mi id="alg1.8.8.m1.1.1" xref="alg1.8.8.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="alg1.8.8.m1.1b"><ci id="alg1.8.8.m1.1.1.cmml" xref="alg1.8.8.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.m1.1c">\mathbf{w}</annotation></semantics></math>, number of local training samples
</div>
<div id="alg1.27.36" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.27.37" class="ltx_listingline"> 
</div>
<div id="alg1.27.38" class="ltx_listingline">
</div>
<div id="alg1.27.39" class="ltx_listingline">

</div>
<div id="alg1.10.10" class="ltx_listingline">
<span id="alg1.10.10.1" class="ltx_text"><span id="alg1.10.10.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>A set of clients <math id="alg1.9.9.m1.1" class="ltx_Math" alttext="\cal C" display="inline"><semantics id="alg1.9.9.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.9.9.m1.1.1" xref="alg1.9.9.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.9.9.m1.1b"><ci id="alg1.9.9.m1.1.1.cmml" xref="alg1.9.9.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.m1.1c">\cal C</annotation></semantics></math>, initialized model <math id="alg1.10.10.m2.1" class="ltx_Math" alttext="\mathbf{W_{0}}" display="inline"><semantics id="alg1.10.10.m2.1a"><msub id="alg1.10.10.m2.1.1" xref="alg1.10.10.m2.1.1.cmml"><mi id="alg1.10.10.m2.1.1.2" xref="alg1.10.10.m2.1.1.2.cmml">𝐖</mi><mn id="alg1.10.10.m2.1.1.3" xref="alg1.10.10.m2.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.10.10.m2.1b"><apply id="alg1.10.10.m2.1.1.cmml" xref="alg1.10.10.m2.1.1"><csymbol cd="ambiguous" id="alg1.10.10.m2.1.1.1.cmml" xref="alg1.10.10.m2.1.1">subscript</csymbol><ci id="alg1.10.10.m2.1.1.2.cmml" xref="alg1.10.10.m2.1.1.2">𝐖</ci><cn type="integer" id="alg1.10.10.m2.1.1.3.cmml" xref="alg1.10.10.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m2.1c">\mathbf{W_{0}}</annotation></semantics></math>
</div>
<div id="alg1.11.11" class="ltx_listingline">
<span id="alg1.11.11.1" class="ltx_text"><span id="alg1.11.11.1.1" class="ltx_text ltx_font_bold">Result:</span> </span>Trained global model <math id="alg1.11.11.m1.1" class="ltx_Math" alttext="\mathbf{W_{G}}" display="inline"><semantics id="alg1.11.11.m1.1a"><msub id="alg1.11.11.m1.1.1" xref="alg1.11.11.m1.1.1.cmml"><mi id="alg1.11.11.m1.1.1.2" xref="alg1.11.11.m1.1.1.2.cmml">𝐖</mi><mi id="alg1.11.11.m1.1.1.3" xref="alg1.11.11.m1.1.1.3.cmml">𝐆</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.11.11.m1.1b"><apply id="alg1.11.11.m1.1.1.cmml" xref="alg1.11.11.m1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.m1.1.1.1.cmml" xref="alg1.11.11.m1.1.1">subscript</csymbol><ci id="alg1.11.11.m1.1.1.2.cmml" xref="alg1.11.11.m1.1.1.2">𝐖</ci><ci id="alg1.11.11.m1.1.1.3.cmml" xref="alg1.11.11.m1.1.1.3">𝐆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m1.1c">\mathbf{W_{G}}</annotation></semantics></math>
</div>
<div id="alg1.27.40" class="ltx_listingline">

</div>
<div id="alg1.12.12" class="ltx_listingline">E <math id="alg1.12.12.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.12.12.m1.1a"><mo stretchy="false" id="alg1.12.12.m1.1.1" xref="alg1.12.12.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.12.12.m1.1b"><ci id="alg1.12.12.m1.1.1.cmml" xref="alg1.12.12.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m1.1c">\leftarrow</annotation></semantics></math> number of local epochs
</div>
<div id="alg1.13.13" class="ltx_listingline">
R <math id="alg1.13.13.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.13.13.m1.1a"><mo stretchy="false" id="alg1.13.13.m1.1.1" xref="alg1.13.13.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.1b"><ci id="alg1.13.13.m1.1.1.cmml" xref="alg1.13.13.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m1.1c">\leftarrow</annotation></semantics></math> total federated learning rounds
</div>
<div id="alg1.14.14" class="ltx_listingline">
<math id="alg1.14.14.m1.1" class="ltx_Math" alttext="\mathbf{W_{G}}\leftarrow\mathbf{W_{0}}" display="inline"><semantics id="alg1.14.14.m1.1a"><mrow id="alg1.14.14.m1.1.1" xref="alg1.14.14.m1.1.1.cmml"><msub id="alg1.14.14.m1.1.1.2" xref="alg1.14.14.m1.1.1.2.cmml"><mi id="alg1.14.14.m1.1.1.2.2" xref="alg1.14.14.m1.1.1.2.2.cmml">𝐖</mi><mi id="alg1.14.14.m1.1.1.2.3" xref="alg1.14.14.m1.1.1.2.3.cmml">𝐆</mi></msub><mo stretchy="false" id="alg1.14.14.m1.1.1.1" xref="alg1.14.14.m1.1.1.1.cmml">←</mo><msub id="alg1.14.14.m1.1.1.3" xref="alg1.14.14.m1.1.1.3.cmml"><mi id="alg1.14.14.m1.1.1.3.2" xref="alg1.14.14.m1.1.1.3.2.cmml">𝐖</mi><mn id="alg1.14.14.m1.1.1.3.3" xref="alg1.14.14.m1.1.1.3.3.cmml">𝟎</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.14.m1.1b"><apply id="alg1.14.14.m1.1.1.cmml" xref="alg1.14.14.m1.1.1"><ci id="alg1.14.14.m1.1.1.1.cmml" xref="alg1.14.14.m1.1.1.1">←</ci><apply id="alg1.14.14.m1.1.1.2.cmml" xref="alg1.14.14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.14.14.m1.1.1.2.1.cmml" xref="alg1.14.14.m1.1.1.2">subscript</csymbol><ci id="alg1.14.14.m1.1.1.2.2.cmml" xref="alg1.14.14.m1.1.1.2.2">𝐖</ci><ci id="alg1.14.14.m1.1.1.2.3.cmml" xref="alg1.14.14.m1.1.1.2.3">𝐆</ci></apply><apply id="alg1.14.14.m1.1.1.3.cmml" xref="alg1.14.14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.14.14.m1.1.1.3.1.cmml" xref="alg1.14.14.m1.1.1.3">subscript</csymbol><ci id="alg1.14.14.m1.1.1.3.2.cmml" xref="alg1.14.14.m1.1.1.3.2">𝐖</ci><cn type="integer" id="alg1.14.14.m1.1.1.3.3.cmml" xref="alg1.14.14.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.m1.1c">\mathbf{W_{G}}\leftarrow\mathbf{W_{0}}</annotation></semantics></math>
</div>
<div id="alg1.27.41" class="ltx_listingline">
<span id="alg1.27.41.1" class="ltx_text ltx_font_bold">for</span> <em id="alg1.27.41.2" class="ltx_emph ltx_font_italic">federated learning round t = 1, 2, …, R</em> <span id="alg1.27.41.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.15.15" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.15.15.2" class="ltx_text ltx_font_bold">foreach</span> <em id="alg1.15.15.1" class="ltx_emph ltx_font_italic">client <math id="alg1.15.15.1.m1.1" class="ltx_Math" alttext="c\in\cal C" display="inline"><semantics id="alg1.15.15.1.m1.1a"><mrow id="alg1.15.15.1.m1.1.1" xref="alg1.15.15.1.m1.1.1.cmml"><mi id="alg1.15.15.1.m1.1.1.2" xref="alg1.15.15.1.m1.1.1.2.cmml">c</mi><mo id="alg1.15.15.1.m1.1.1.1" xref="alg1.15.15.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.15.15.1.m1.1.1.3" xref="alg1.15.15.1.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.15.15.1.m1.1b"><apply id="alg1.15.15.1.m1.1.1.cmml" xref="alg1.15.15.1.m1.1.1"><in id="alg1.15.15.1.m1.1.1.1.cmml" xref="alg1.15.15.1.m1.1.1.1"></in><ci id="alg1.15.15.1.m1.1.1.2.cmml" xref="alg1.15.15.1.m1.1.1.2">𝑐</ci><ci id="alg1.15.15.1.m1.1.1.3.cmml" xref="alg1.15.15.1.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.1.m1.1c">c\in\cal C</annotation></semantics></math> <span id="alg1.15.15.1.1" class="ltx_text ltx_font_bold ltx_font_upright">in parallel</span></em> <span id="alg1.15.15.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.16.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
receive <math id="alg1.16.16.m1.1" class="ltx_Math" alttext="\mathbf{W_{G}}" display="inline"><semantics id="alg1.16.16.m1.1a"><msub id="alg1.16.16.m1.1.1" xref="alg1.16.16.m1.1.1.cmml"><mi id="alg1.16.16.m1.1.1.2" xref="alg1.16.16.m1.1.1.2.cmml">𝐖</mi><mi id="alg1.16.16.m1.1.1.3" xref="alg1.16.16.m1.1.1.3.cmml">𝐆</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.16.16.m1.1b"><apply id="alg1.16.16.m1.1.1.cmml" xref="alg1.16.16.m1.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m1.1.1.1.cmml" xref="alg1.16.16.m1.1.1">subscript</csymbol><ci id="alg1.16.16.m1.1.1.2.cmml" xref="alg1.16.16.m1.1.1.2">𝐖</ci><ci id="alg1.16.16.m1.1.1.3.cmml" xref="alg1.16.16.m1.1.1.3">𝐆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m1.1c">\mathbf{W_{G}}</annotation></semantics></math> from the server
</div>
<div id="alg1.18.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.17.17.m1.2" class="ltx_Math" alttext="\mathbf{W_{c}},n_{c}\leftarrow" display="inline"><semantics id="alg1.17.17.m1.2a"><mrow id="alg1.17.17.m1.2.2" xref="alg1.17.17.m1.2.2.cmml"><mrow id="alg1.17.17.m1.2.2.2.2" xref="alg1.17.17.m1.2.2.2.3.cmml"><msub id="alg1.17.17.m1.1.1.1.1.1" xref="alg1.17.17.m1.1.1.1.1.1.cmml"><mi id="alg1.17.17.m1.1.1.1.1.1.2" xref="alg1.17.17.m1.1.1.1.1.1.2.cmml">𝐖</mi><mi id="alg1.17.17.m1.1.1.1.1.1.3" xref="alg1.17.17.m1.1.1.1.1.1.3.cmml">𝐜</mi></msub><mo id="alg1.17.17.m1.2.2.2.2.3" xref="alg1.17.17.m1.2.2.2.3.cmml">,</mo><msub id="alg1.17.17.m1.2.2.2.2.2" xref="alg1.17.17.m1.2.2.2.2.2.cmml"><mi id="alg1.17.17.m1.2.2.2.2.2.2" xref="alg1.17.17.m1.2.2.2.2.2.2.cmml">n</mi><mi id="alg1.17.17.m1.2.2.2.2.2.3" xref="alg1.17.17.m1.2.2.2.2.2.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="alg1.17.17.m1.2.2.3" xref="alg1.17.17.m1.2.2.3.cmml">←</mo><mi id="alg1.17.17.m1.2.2.4" xref="alg1.17.17.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.17.m1.2b"><apply id="alg1.17.17.m1.2.2.cmml" xref="alg1.17.17.m1.2.2"><ci id="alg1.17.17.m1.2.2.3.cmml" xref="alg1.17.17.m1.2.2.3">←</ci><list id="alg1.17.17.m1.2.2.2.3.cmml" xref="alg1.17.17.m1.2.2.2.2"><apply id="alg1.17.17.m1.1.1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.17.17.m1.1.1.1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.17.17.m1.1.1.1.1.1.2.cmml" xref="alg1.17.17.m1.1.1.1.1.1.2">𝐖</ci><ci id="alg1.17.17.m1.1.1.1.1.1.3.cmml" xref="alg1.17.17.m1.1.1.1.1.1.3">𝐜</ci></apply><apply id="alg1.17.17.m1.2.2.2.2.2.cmml" xref="alg1.17.17.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.17.17.m1.2.2.2.2.2.1.cmml" xref="alg1.17.17.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.17.17.m1.2.2.2.2.2.2.cmml" xref="alg1.17.17.m1.2.2.2.2.2.2">𝑛</ci><ci id="alg1.17.17.m1.2.2.2.2.2.3.cmml" xref="alg1.17.17.m1.2.2.2.2.2.3">𝑐</ci></apply></list><csymbol cd="latexml" id="alg1.17.17.m1.2.2.4.cmml" xref="alg1.17.17.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m1.2c">\mathbf{W_{c}},n_{c}\leftarrow</annotation></semantics></math> <span id="alg1.18.18.1" class="ltx_text ltx_font_typewriter">LocalTrain(<em id="alg1.18.18.1.1" class="ltx_emph ltx_font_serif ltx_font_italic"><math id="alg1.18.18.1.1.m1.1" class="ltx_Math" alttext="\mathbf{W_{G}}" display="inline"><semantics id="alg1.18.18.1.1.m1.1a"><msub id="alg1.18.18.1.1.m1.1.1" xref="alg1.18.18.1.1.m1.1.1.cmml"><mi id="alg1.18.18.1.1.m1.1.1.2" xref="alg1.18.18.1.1.m1.1.1.2.cmml">𝐖</mi><mi id="alg1.18.18.1.1.m1.1.1.3" xref="alg1.18.18.1.1.m1.1.1.3.cmml">𝐆</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.18.18.1.1.m1.1b"><apply id="alg1.18.18.1.1.m1.1.1.cmml" xref="alg1.18.18.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.18.18.1.1.m1.1.1.1.cmml" xref="alg1.18.18.1.1.m1.1.1">subscript</csymbol><ci id="alg1.18.18.1.1.m1.1.1.2.cmml" xref="alg1.18.18.1.1.m1.1.1.2">𝐖</ci><ci id="alg1.18.18.1.1.m1.1.1.3.cmml" xref="alg1.18.18.1.1.m1.1.1.3">𝐆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.1.1.m1.1c">\mathbf{W_{G}}</annotation></semantics></math>, E</em>)</span>
</div>
<div id="alg1.19.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
local model delta <math id="alg1.19.19.m1.1" class="ltx_Math" alttext="\Delta_{c}\leftarrow\mathbf{W_{c}}-\mathbf{W_{G}}" display="inline"><semantics id="alg1.19.19.m1.1a"><mrow id="alg1.19.19.m1.1.1" xref="alg1.19.19.m1.1.1.cmml"><msub id="alg1.19.19.m1.1.1.2" xref="alg1.19.19.m1.1.1.2.cmml"><mi mathvariant="normal" id="alg1.19.19.m1.1.1.2.2" xref="alg1.19.19.m1.1.1.2.2.cmml">Δ</mi><mi id="alg1.19.19.m1.1.1.2.3" xref="alg1.19.19.m1.1.1.2.3.cmml">c</mi></msub><mo stretchy="false" id="alg1.19.19.m1.1.1.1" xref="alg1.19.19.m1.1.1.1.cmml">←</mo><mrow id="alg1.19.19.m1.1.1.3" xref="alg1.19.19.m1.1.1.3.cmml"><msub id="alg1.19.19.m1.1.1.3.2" xref="alg1.19.19.m1.1.1.3.2.cmml"><mi id="alg1.19.19.m1.1.1.3.2.2" xref="alg1.19.19.m1.1.1.3.2.2.cmml">𝐖</mi><mi id="alg1.19.19.m1.1.1.3.2.3" xref="alg1.19.19.m1.1.1.3.2.3.cmml">𝐜</mi></msub><mo id="alg1.19.19.m1.1.1.3.1" xref="alg1.19.19.m1.1.1.3.1.cmml">−</mo><msub id="alg1.19.19.m1.1.1.3.3" xref="alg1.19.19.m1.1.1.3.3.cmml"><mi id="alg1.19.19.m1.1.1.3.3.2" xref="alg1.19.19.m1.1.1.3.3.2.cmml">𝐖</mi><mi id="alg1.19.19.m1.1.1.3.3.3" xref="alg1.19.19.m1.1.1.3.3.3.cmml">𝐆</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.1b"><apply id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1"><ci id="alg1.19.19.m1.1.1.1.cmml" xref="alg1.19.19.m1.1.1.1">←</ci><apply id="alg1.19.19.m1.1.1.2.cmml" xref="alg1.19.19.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.2.1.cmml" xref="alg1.19.19.m1.1.1.2">subscript</csymbol><ci id="alg1.19.19.m1.1.1.2.2.cmml" xref="alg1.19.19.m1.1.1.2.2">Δ</ci><ci id="alg1.19.19.m1.1.1.2.3.cmml" xref="alg1.19.19.m1.1.1.2.3">𝑐</ci></apply><apply id="alg1.19.19.m1.1.1.3.cmml" xref="alg1.19.19.m1.1.1.3"><minus id="alg1.19.19.m1.1.1.3.1.cmml" xref="alg1.19.19.m1.1.1.3.1"></minus><apply id="alg1.19.19.m1.1.1.3.2.cmml" xref="alg1.19.19.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.3.2.1.cmml" xref="alg1.19.19.m1.1.1.3.2">subscript</csymbol><ci id="alg1.19.19.m1.1.1.3.2.2.cmml" xref="alg1.19.19.m1.1.1.3.2.2">𝐖</ci><ci id="alg1.19.19.m1.1.1.3.2.3.cmml" xref="alg1.19.19.m1.1.1.3.2.3">𝐜</ci></apply><apply id="alg1.19.19.m1.1.1.3.3.cmml" xref="alg1.19.19.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.3.3.1.cmml" xref="alg1.19.19.m1.1.1.3.3">subscript</csymbol><ci id="alg1.19.19.m1.1.1.3.3.2.cmml" xref="alg1.19.19.m1.1.1.3.3.2">𝐖</ci><ci id="alg1.19.19.m1.1.1.3.3.3.cmml" xref="alg1.19.19.m1.1.1.3.3.3">𝐆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.1c">\Delta_{c}\leftarrow\mathbf{W_{c}}-\mathbf{W_{G}}</annotation></semantics></math>
</div>
<div id="alg1.20.20" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
send <math id="alg1.20.20.m1.2" class="ltx_Math" alttext="(\Delta_{c},n_{c})" display="inline"><semantics id="alg1.20.20.m1.2a"><mrow id="alg1.20.20.m1.2.2.2" xref="alg1.20.20.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.20.20.m1.2.2.2.3" xref="alg1.20.20.m1.2.2.3.cmml">(</mo><msub id="alg1.20.20.m1.1.1.1.1" xref="alg1.20.20.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.20.20.m1.1.1.1.1.2" xref="alg1.20.20.m1.1.1.1.1.2.cmml">Δ</mi><mi id="alg1.20.20.m1.1.1.1.1.3" xref="alg1.20.20.m1.1.1.1.1.3.cmml">c</mi></msub><mo id="alg1.20.20.m1.2.2.2.4" xref="alg1.20.20.m1.2.2.3.cmml">,</mo><msub id="alg1.20.20.m1.2.2.2.2" xref="alg1.20.20.m1.2.2.2.2.cmml"><mi id="alg1.20.20.m1.2.2.2.2.2" xref="alg1.20.20.m1.2.2.2.2.2.cmml">n</mi><mi id="alg1.20.20.m1.2.2.2.2.3" xref="alg1.20.20.m1.2.2.2.2.3.cmml">c</mi></msub><mo stretchy="false" id="alg1.20.20.m1.2.2.2.5" xref="alg1.20.20.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.20.m1.2b"><interval closure="open" id="alg1.20.20.m1.2.2.3.cmml" xref="alg1.20.20.m1.2.2.2"><apply id="alg1.20.20.m1.1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.20.20.m1.1.1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1.1">subscript</csymbol><ci id="alg1.20.20.m1.1.1.1.1.2.cmml" xref="alg1.20.20.m1.1.1.1.1.2">Δ</ci><ci id="alg1.20.20.m1.1.1.1.1.3.cmml" xref="alg1.20.20.m1.1.1.1.1.3">𝑐</ci></apply><apply id="alg1.20.20.m1.2.2.2.2.cmml" xref="alg1.20.20.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.20.20.m1.2.2.2.2.1.cmml" xref="alg1.20.20.m1.2.2.2.2">subscript</csymbol><ci id="alg1.20.20.m1.2.2.2.2.2.cmml" xref="alg1.20.20.m1.2.2.2.2.2">𝑛</ci><ci id="alg1.20.20.m1.2.2.2.2.3.cmml" xref="alg1.20.20.m1.2.2.2.2.3">𝑐</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m1.2c">(\Delta_{c},n_{c})</annotation></semantics></math> to the server
</div>
<div id="alg1.27.42" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.27.43" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div id="alg1.27.44" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.21.21" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg1.21.21.m1.1" class="ltx_Math" alttext="n\leftarrow\sum_{i\in\cal C}n_{i}" display="inline"><semantics id="alg1.21.21.m1.1a"><mrow id="alg1.21.21.m1.1.1" xref="alg1.21.21.m1.1.1.cmml"><mi id="alg1.21.21.m1.1.1.2" xref="alg1.21.21.m1.1.1.2.cmml">n</mi><mo rspace="0.111em" stretchy="false" id="alg1.21.21.m1.1.1.1" xref="alg1.21.21.m1.1.1.1.cmml">←</mo><mrow id="alg1.21.21.m1.1.1.3" xref="alg1.21.21.m1.1.1.3.cmml"><msub id="alg1.21.21.m1.1.1.3.1" xref="alg1.21.21.m1.1.1.3.1.cmml"><mo id="alg1.21.21.m1.1.1.3.1.2" xref="alg1.21.21.m1.1.1.3.1.2.cmml">∑</mo><mrow id="alg1.21.21.m1.1.1.3.1.3" xref="alg1.21.21.m1.1.1.3.1.3.cmml"><mi id="alg1.21.21.m1.1.1.3.1.3.2" xref="alg1.21.21.m1.1.1.3.1.3.2.cmml">i</mi><mo id="alg1.21.21.m1.1.1.3.1.3.1" xref="alg1.21.21.m1.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.21.21.m1.1.1.3.1.3.3" xref="alg1.21.21.m1.1.1.3.1.3.3.cmml">𝒞</mi></mrow></msub><msub id="alg1.21.21.m1.1.1.3.2" xref="alg1.21.21.m1.1.1.3.2.cmml"><mi id="alg1.21.21.m1.1.1.3.2.2" xref="alg1.21.21.m1.1.1.3.2.2.cmml">n</mi><mi id="alg1.21.21.m1.1.1.3.2.3" xref="alg1.21.21.m1.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.21.21.m1.1b"><apply id="alg1.21.21.m1.1.1.cmml" xref="alg1.21.21.m1.1.1"><ci id="alg1.21.21.m1.1.1.1.cmml" xref="alg1.21.21.m1.1.1.1">←</ci><ci id="alg1.21.21.m1.1.1.2.cmml" xref="alg1.21.21.m1.1.1.2">𝑛</ci><apply id="alg1.21.21.m1.1.1.3.cmml" xref="alg1.21.21.m1.1.1.3"><apply id="alg1.21.21.m1.1.1.3.1.cmml" xref="alg1.21.21.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.21.21.m1.1.1.3.1.1.cmml" xref="alg1.21.21.m1.1.1.3.1">subscript</csymbol><sum id="alg1.21.21.m1.1.1.3.1.2.cmml" xref="alg1.21.21.m1.1.1.3.1.2"></sum><apply id="alg1.21.21.m1.1.1.3.1.3.cmml" xref="alg1.21.21.m1.1.1.3.1.3"><in id="alg1.21.21.m1.1.1.3.1.3.1.cmml" xref="alg1.21.21.m1.1.1.3.1.3.1"></in><ci id="alg1.21.21.m1.1.1.3.1.3.2.cmml" xref="alg1.21.21.m1.1.1.3.1.3.2">𝑖</ci><ci id="alg1.21.21.m1.1.1.3.1.3.3.cmml" xref="alg1.21.21.m1.1.1.3.1.3.3">𝒞</ci></apply></apply><apply id="alg1.21.21.m1.1.1.3.2.cmml" xref="alg1.21.21.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.21.21.m1.1.1.3.2.1.cmml" xref="alg1.21.21.m1.1.1.3.2">subscript</csymbol><ci id="alg1.21.21.m1.1.1.3.2.2.cmml" xref="alg1.21.21.m1.1.1.3.2.2">𝑛</ci><ci id="alg1.21.21.m1.1.1.3.2.3.cmml" xref="alg1.21.21.m1.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m1.1c">n\leftarrow\sum_{i\in\cal C}n_{i}</annotation></semantics></math>
</div>
<div id="alg1.22.22" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
pseudogradient <math id="alg1.22.22.m1.1" class="ltx_Math" alttext="\mathbf{g_{G}}\leftarrow-\sum_{i\in\cal C}\frac{n_{i}}{n}\Delta_{i}" display="inline"><semantics id="alg1.22.22.m1.1a"><mrow id="alg1.22.22.m1.1.1" xref="alg1.22.22.m1.1.1.cmml"><msub id="alg1.22.22.m1.1.1.2" xref="alg1.22.22.m1.1.1.2.cmml"><mi id="alg1.22.22.m1.1.1.2.2" xref="alg1.22.22.m1.1.1.2.2.cmml">𝐠</mi><mi id="alg1.22.22.m1.1.1.2.3" xref="alg1.22.22.m1.1.1.2.3.cmml">𝐆</mi></msub><mo stretchy="false" id="alg1.22.22.m1.1.1.1" xref="alg1.22.22.m1.1.1.1.cmml">←</mo><mrow id="alg1.22.22.m1.1.1.3" xref="alg1.22.22.m1.1.1.3.cmml"><mo id="alg1.22.22.m1.1.1.3a" xref="alg1.22.22.m1.1.1.3.cmml">−</mo><mrow id="alg1.22.22.m1.1.1.3.2" xref="alg1.22.22.m1.1.1.3.2.cmml"><msub id="alg1.22.22.m1.1.1.3.2.1" xref="alg1.22.22.m1.1.1.3.2.1.cmml"><mo id="alg1.22.22.m1.1.1.3.2.1.2" xref="alg1.22.22.m1.1.1.3.2.1.2.cmml">∑</mo><mrow id="alg1.22.22.m1.1.1.3.2.1.3" xref="alg1.22.22.m1.1.1.3.2.1.3.cmml"><mi id="alg1.22.22.m1.1.1.3.2.1.3.2" xref="alg1.22.22.m1.1.1.3.2.1.3.2.cmml">i</mi><mo id="alg1.22.22.m1.1.1.3.2.1.3.1" xref="alg1.22.22.m1.1.1.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.22.22.m1.1.1.3.2.1.3.3" xref="alg1.22.22.m1.1.1.3.2.1.3.3.cmml">𝒞</mi></mrow></msub><mrow id="alg1.22.22.m1.1.1.3.2.2" xref="alg1.22.22.m1.1.1.3.2.2.cmml"><mfrac id="alg1.22.22.m1.1.1.3.2.2.2" xref="alg1.22.22.m1.1.1.3.2.2.2.cmml"><msub id="alg1.22.22.m1.1.1.3.2.2.2.2" xref="alg1.22.22.m1.1.1.3.2.2.2.2.cmml"><mi id="alg1.22.22.m1.1.1.3.2.2.2.2.2" xref="alg1.22.22.m1.1.1.3.2.2.2.2.2.cmml">n</mi><mi id="alg1.22.22.m1.1.1.3.2.2.2.2.3" xref="alg1.22.22.m1.1.1.3.2.2.2.2.3.cmml">i</mi></msub><mi id="alg1.22.22.m1.1.1.3.2.2.2.3" xref="alg1.22.22.m1.1.1.3.2.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.22.22.m1.1.1.3.2.2.1" xref="alg1.22.22.m1.1.1.3.2.2.1.cmml">​</mo><msub id="alg1.22.22.m1.1.1.3.2.2.3" xref="alg1.22.22.m1.1.1.3.2.2.3.cmml"><mi mathvariant="normal" id="alg1.22.22.m1.1.1.3.2.2.3.2" xref="alg1.22.22.m1.1.1.3.2.2.3.2.cmml">Δ</mi><mi id="alg1.22.22.m1.1.1.3.2.2.3.3" xref="alg1.22.22.m1.1.1.3.2.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.22.m1.1b"><apply id="alg1.22.22.m1.1.1.cmml" xref="alg1.22.22.m1.1.1"><ci id="alg1.22.22.m1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1">←</ci><apply id="alg1.22.22.m1.1.1.2.cmml" xref="alg1.22.22.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.2.1.cmml" xref="alg1.22.22.m1.1.1.2">subscript</csymbol><ci id="alg1.22.22.m1.1.1.2.2.cmml" xref="alg1.22.22.m1.1.1.2.2">𝐠</ci><ci id="alg1.22.22.m1.1.1.2.3.cmml" xref="alg1.22.22.m1.1.1.2.3">𝐆</ci></apply><apply id="alg1.22.22.m1.1.1.3.cmml" xref="alg1.22.22.m1.1.1.3"><minus id="alg1.22.22.m1.1.1.3.1.cmml" xref="alg1.22.22.m1.1.1.3"></minus><apply id="alg1.22.22.m1.1.1.3.2.cmml" xref="alg1.22.22.m1.1.1.3.2"><apply id="alg1.22.22.m1.1.1.3.2.1.cmml" xref="alg1.22.22.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.3.2.1.1.cmml" xref="alg1.22.22.m1.1.1.3.2.1">subscript</csymbol><sum id="alg1.22.22.m1.1.1.3.2.1.2.cmml" xref="alg1.22.22.m1.1.1.3.2.1.2"></sum><apply id="alg1.22.22.m1.1.1.3.2.1.3.cmml" xref="alg1.22.22.m1.1.1.3.2.1.3"><in id="alg1.22.22.m1.1.1.3.2.1.3.1.cmml" xref="alg1.22.22.m1.1.1.3.2.1.3.1"></in><ci id="alg1.22.22.m1.1.1.3.2.1.3.2.cmml" xref="alg1.22.22.m1.1.1.3.2.1.3.2">𝑖</ci><ci id="alg1.22.22.m1.1.1.3.2.1.3.3.cmml" xref="alg1.22.22.m1.1.1.3.2.1.3.3">𝒞</ci></apply></apply><apply id="alg1.22.22.m1.1.1.3.2.2.cmml" xref="alg1.22.22.m1.1.1.3.2.2"><times id="alg1.22.22.m1.1.1.3.2.2.1.cmml" xref="alg1.22.22.m1.1.1.3.2.2.1"></times><apply id="alg1.22.22.m1.1.1.3.2.2.2.cmml" xref="alg1.22.22.m1.1.1.3.2.2.2"><divide id="alg1.22.22.m1.1.1.3.2.2.2.1.cmml" xref="alg1.22.22.m1.1.1.3.2.2.2"></divide><apply id="alg1.22.22.m1.1.1.3.2.2.2.2.cmml" xref="alg1.22.22.m1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.3.2.2.2.2.1.cmml" xref="alg1.22.22.m1.1.1.3.2.2.2.2">subscript</csymbol><ci id="alg1.22.22.m1.1.1.3.2.2.2.2.2.cmml" xref="alg1.22.22.m1.1.1.3.2.2.2.2.2">𝑛</ci><ci id="alg1.22.22.m1.1.1.3.2.2.2.2.3.cmml" xref="alg1.22.22.m1.1.1.3.2.2.2.2.3">𝑖</ci></apply><ci id="alg1.22.22.m1.1.1.3.2.2.2.3.cmml" xref="alg1.22.22.m1.1.1.3.2.2.2.3">𝑛</ci></apply><apply id="alg1.22.22.m1.1.1.3.2.2.3.cmml" xref="alg1.22.22.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.3.2.2.3.1.cmml" xref="alg1.22.22.m1.1.1.3.2.2.3">subscript</csymbol><ci id="alg1.22.22.m1.1.1.3.2.2.3.2.cmml" xref="alg1.22.22.m1.1.1.3.2.2.3.2">Δ</ci><ci id="alg1.22.22.m1.1.1.3.2.2.3.3.cmml" xref="alg1.22.22.m1.1.1.3.2.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.m1.1c">\mathbf{g_{G}}\leftarrow-\sum_{i\in\cal C}\frac{n_{i}}{n}\Delta_{i}</annotation></semantics></math>
</div>
<div id="alg1.27.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.23.23.m1.1" class="ltx_Math" alttext="\mathbf{W_{G}}\leftarrow" display="inline"><semantics id="alg1.23.23.m1.1a"><mrow id="alg1.23.23.m1.1.1" xref="alg1.23.23.m1.1.1.cmml"><msub id="alg1.23.23.m1.1.1.2" xref="alg1.23.23.m1.1.1.2.cmml"><mi id="alg1.23.23.m1.1.1.2.2" xref="alg1.23.23.m1.1.1.2.2.cmml">𝐖</mi><mi id="alg1.23.23.m1.1.1.2.3" xref="alg1.23.23.m1.1.1.2.3.cmml">𝐆</mi></msub><mo stretchy="false" id="alg1.23.23.m1.1.1.1" xref="alg1.23.23.m1.1.1.1.cmml">←</mo><mi id="alg1.23.23.m1.1.1.3" xref="alg1.23.23.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.23.23.m1.1b"><apply id="alg1.23.23.m1.1.1.cmml" xref="alg1.23.23.m1.1.1"><ci id="alg1.23.23.m1.1.1.1.cmml" xref="alg1.23.23.m1.1.1.1">←</ci><apply id="alg1.23.23.m1.1.1.2.cmml" xref="alg1.23.23.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.23.23.m1.1.1.2.1.cmml" xref="alg1.23.23.m1.1.1.2">subscript</csymbol><ci id="alg1.23.23.m1.1.1.2.2.cmml" xref="alg1.23.23.m1.1.1.2.2">𝐖</ci><ci id="alg1.23.23.m1.1.1.2.3.cmml" xref="alg1.23.23.m1.1.1.2.3">𝐆</ci></apply><csymbol cd="latexml" id="alg1.23.23.m1.1.1.3.cmml" xref="alg1.23.23.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m1.1c">\mathbf{W_{G}}\leftarrow</annotation></semantics></math> <span id="alg1.27.27.1" class="ltx_text ltx_font_smallcaps">ServerOpt</span>(<math id="alg1.24.24.m2.1" class="ltx_Math" alttext="\mathbf{W_{G}}" display="inline"><semantics id="alg1.24.24.m2.1a"><msub id="alg1.24.24.m2.1.1" xref="alg1.24.24.m2.1.1.cmml"><mi id="alg1.24.24.m2.1.1.2" xref="alg1.24.24.m2.1.1.2.cmml">𝐖</mi><mi id="alg1.24.24.m2.1.1.3" xref="alg1.24.24.m2.1.1.3.cmml">𝐆</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.24.24.m2.1b"><apply id="alg1.24.24.m2.1.1.cmml" xref="alg1.24.24.m2.1.1"><csymbol cd="ambiguous" id="alg1.24.24.m2.1.1.1.cmml" xref="alg1.24.24.m2.1.1">subscript</csymbol><ci id="alg1.24.24.m2.1.1.2.cmml" xref="alg1.24.24.m2.1.1.2">𝐖</ci><ci id="alg1.24.24.m2.1.1.3.cmml" xref="alg1.24.24.m2.1.1.3">𝐆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m2.1c">\mathbf{W_{G}}</annotation></semantics></math>, <math id="alg1.25.25.m3.1" class="ltx_Math" alttext="\mathbf{g_{G}}" display="inline"><semantics id="alg1.25.25.m3.1a"><msub id="alg1.25.25.m3.1.1" xref="alg1.25.25.m3.1.1.cmml"><mi id="alg1.25.25.m3.1.1.2" xref="alg1.25.25.m3.1.1.2.cmml">𝐠</mi><mi id="alg1.25.25.m3.1.1.3" xref="alg1.25.25.m3.1.1.3.cmml">𝐆</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.25.25.m3.1b"><apply id="alg1.25.25.m3.1.1.cmml" xref="alg1.25.25.m3.1.1"><csymbol cd="ambiguous" id="alg1.25.25.m3.1.1.1.cmml" xref="alg1.25.25.m3.1.1">subscript</csymbol><ci id="alg1.25.25.m3.1.1.2.cmml" xref="alg1.25.25.m3.1.1.2">𝐠</ci><ci id="alg1.25.25.m3.1.1.3.cmml" xref="alg1.25.25.m3.1.1.3">𝐆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.m3.1c">\mathbf{g_{G}}</annotation></semantics></math>, <math id="alg1.26.26.m4.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="alg1.26.26.m4.1a"><msub id="alg1.26.26.m4.1.1" xref="alg1.26.26.m4.1.1.cmml"><mi id="alg1.26.26.m4.1.1.2" xref="alg1.26.26.m4.1.1.2.cmml">η</mi><mi id="alg1.26.26.m4.1.1.3" xref="alg1.26.26.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.26.26.m4.1b"><apply id="alg1.26.26.m4.1.1.cmml" xref="alg1.26.26.m4.1.1"><csymbol cd="ambiguous" id="alg1.26.26.m4.1.1.1.cmml" xref="alg1.26.26.m4.1.1">subscript</csymbol><ci id="alg1.26.26.m4.1.1.2.cmml" xref="alg1.26.26.m4.1.1.2">𝜂</ci><ci id="alg1.26.26.m4.1.1.3.cmml" xref="alg1.26.26.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.26.m4.1c">\eta_{s}</annotation></semantics></math>, <math id="alg1.27.27.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.27.27.m5.1a"><mi id="alg1.27.27.m5.1.1" xref="alg1.27.27.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.27.27.m5.1b"><ci id="alg1.27.27.m5.1.1.cmml" xref="alg1.27.27.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.27.m5.1c">t</annotation></semantics></math>)
</div>
<div id="alg1.27.45" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.27.46" class="ltx_listingline"> end for
</div>
<div id="alg1.27.47" class="ltx_listingline">
</div>
<div id="alg1.27.48" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.35.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Generalized federated learning process. The <span id="alg1.36.2" class="ltx_text ltx_font_smallcaps">ClientOpt</span>, <span id="alg1.37.3" class="ltx_text ltx_font_smallcaps">ServerOpt</span>, their respective learning rates (<math id="alg1.30.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.30.m1.1b"><mi id="alg1.30.m1.1.1" xref="alg1.30.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.30.m1.1c"><ci id="alg1.30.m1.1.1.cmml" xref="alg1.30.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.30.m1.1d">\eta</annotation></semantics></math>, <math id="alg1.31.m2.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="alg1.31.m2.1b"><msub id="alg1.31.m2.1.1" xref="alg1.31.m2.1.1.cmml"><mi id="alg1.31.m2.1.1.2" xref="alg1.31.m2.1.1.2.cmml">η</mi><mi id="alg1.31.m2.1.1.3" xref="alg1.31.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.31.m2.1c"><apply id="alg1.31.m2.1.1.cmml" xref="alg1.31.m2.1.1"><csymbol cd="ambiguous" id="alg1.31.m2.1.1.1.cmml" xref="alg1.31.m2.1.1">subscript</csymbol><ci id="alg1.31.m2.1.1.2.cmml" xref="alg1.31.m2.1.1.2">𝜂</ci><ci id="alg1.31.m2.1.1.3.cmml" xref="alg1.31.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.31.m2.1d">\eta_{s}</annotation></semantics></math>) and the pseudogradient concepts are explained in detail by Reddi et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite></figcaption>
</figure>
</figure>
<figure id="S3.SS2.fig2" class="ltx_figure">
<figure id="alg2" class="ltx_float ltx_algorithm">
<div id="alg2.44" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg2.44.45" class="ltx_listingline">






</div>
<div id="alg2.44.46" class="ltx_listingline">



</div>
<div id="alg2.1.1" class="ltx_listingline">
<span id="alg2.1.1.2" class="ltx_text ltx_font_bold">Function</span> <em id="alg2.1.1.1" class="ltx_emph ltx_font_typewriter">ModelFingerprinting(<em id="alg2.1.1.1.1.1" class="ltx_emph ltx_font_serif ltx_font_italic"><math id="alg2.1.1.1.1.1.m1.1" class="ltx_Math" alttext="weight\_list" display="inline"><semantics id="alg2.1.1.1.1.1.m1.1a"><mrow id="alg2.1.1.1.1.1.m1.1.1" xref="alg2.1.1.1.1.1.m1.1.1.cmml"><mi id="alg2.1.1.1.1.1.m1.1.1.2" xref="alg2.1.1.1.1.1.m1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.3" xref="alg2.1.1.1.1.1.m1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1a" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.4" xref="alg2.1.1.1.1.1.m1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1b" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.5" xref="alg2.1.1.1.1.1.m1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1c" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.6" xref="alg2.1.1.1.1.1.m1.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1d" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.7" xref="alg2.1.1.1.1.1.m1.1.1.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1e" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg2.1.1.1.1.1.m1.1.1.8" xref="alg2.1.1.1.1.1.m1.1.1.8.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1f" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.9" xref="alg2.1.1.1.1.1.m1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1g" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.10" xref="alg2.1.1.1.1.1.m1.1.1.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1h" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.11" xref="alg2.1.1.1.1.1.m1.1.1.11.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.1.1.1.m1.1.1.1i" xref="alg2.1.1.1.1.1.m1.1.1.1.cmml">​</mo><mi id="alg2.1.1.1.1.1.m1.1.1.12" xref="alg2.1.1.1.1.1.m1.1.1.12.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.1.1.1.1.1.m1.1b"><apply id="alg2.1.1.1.1.1.m1.1.1.cmml" xref="alg2.1.1.1.1.1.m1.1.1"><times id="alg2.1.1.1.1.1.m1.1.1.1.cmml" xref="alg2.1.1.1.1.1.m1.1.1.1"></times><ci id="alg2.1.1.1.1.1.m1.1.1.2.cmml" xref="alg2.1.1.1.1.1.m1.1.1.2">𝑤</ci><ci id="alg2.1.1.1.1.1.m1.1.1.3.cmml" xref="alg2.1.1.1.1.1.m1.1.1.3">𝑒</ci><ci id="alg2.1.1.1.1.1.m1.1.1.4.cmml" xref="alg2.1.1.1.1.1.m1.1.1.4">𝑖</ci><ci id="alg2.1.1.1.1.1.m1.1.1.5.cmml" xref="alg2.1.1.1.1.1.m1.1.1.5">𝑔</ci><ci id="alg2.1.1.1.1.1.m1.1.1.6.cmml" xref="alg2.1.1.1.1.1.m1.1.1.6">ℎ</ci><ci id="alg2.1.1.1.1.1.m1.1.1.7.cmml" xref="alg2.1.1.1.1.1.m1.1.1.7">𝑡</ci><ci id="alg2.1.1.1.1.1.m1.1.1.8.cmml" xref="alg2.1.1.1.1.1.m1.1.1.8">_</ci><ci id="alg2.1.1.1.1.1.m1.1.1.9.cmml" xref="alg2.1.1.1.1.1.m1.1.1.9">𝑙</ci><ci id="alg2.1.1.1.1.1.m1.1.1.10.cmml" xref="alg2.1.1.1.1.1.m1.1.1.10">𝑖</ci><ci id="alg2.1.1.1.1.1.m1.1.1.11.cmml" xref="alg2.1.1.1.1.1.m1.1.1.11">𝑠</ci><ci id="alg2.1.1.1.1.1.m1.1.1.12.cmml" xref="alg2.1.1.1.1.1.m1.1.1.12">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.1.1.1.m1.1c">weight\_list</annotation></semantics></math></em>)</em><span id="alg2.1.1.3" class="ltx_text ltx_font_bold">:</span> 
</div>
<div id="alg2.2.2" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.2.2.m1.1" class="ltx_Math" alttext="\cal W\leftarrow" display="inline"><semantics id="alg2.2.2.m1.1a"><mrow id="alg2.2.2.m1.1.1" xref="alg2.2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.2.2.m1.1.1.2" xref="alg2.2.2.m1.1.1.2.cmml">𝒲</mi><mo stretchy="false" id="alg2.2.2.m1.1.1.1" xref="alg2.2.2.m1.1.1.1.cmml">←</mo><mi id="alg2.2.2.m1.1.1.3" xref="alg2.2.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.2.m1.1b"><apply id="alg2.2.2.m1.1.1.cmml" xref="alg2.2.2.m1.1.1"><ci id="alg2.2.2.m1.1.1.1.cmml" xref="alg2.2.2.m1.1.1.1">←</ci><ci id="alg2.2.2.m1.1.1.2.cmml" xref="alg2.2.2.m1.1.1.2">𝒲</ci><csymbol cd="latexml" id="alg2.2.2.m1.1.1.3.cmml" xref="alg2.2.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.m1.1c">\cal W\leftarrow</annotation></semantics></math> empty list 
</div>
<div id="alg2.44.47" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.4.4" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg2.4.4.3" class="ltx_text ltx_font_bold">for</span> <em id="alg2.4.4.2" class="ltx_emph ltx_font_italic"><math id="alg2.3.3.1.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="alg2.3.3.1.m1.1a"><mi id="alg2.3.3.1.m1.1.1" xref="alg2.3.3.1.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="alg2.3.3.1.m1.1b"><ci id="alg2.3.3.1.m1.1.1.cmml" xref="alg2.3.3.1.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.1.m1.1c">\mathbf{w}</annotation></semantics></math> <span id="alg2.4.4.2.1" class="ltx_text ltx_font_bold ltx_font_upright">in</span> <math id="alg2.4.4.2.m2.1" class="ltx_Math" alttext="weight\_list" display="inline"><semantics id="alg2.4.4.2.m2.1a"><mrow id="alg2.4.4.2.m2.1.1" xref="alg2.4.4.2.m2.1.1.cmml"><mi id="alg2.4.4.2.m2.1.1.2" xref="alg2.4.4.2.m2.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.3" xref="alg2.4.4.2.m2.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1a" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.4" xref="alg2.4.4.2.m2.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1b" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.5" xref="alg2.4.4.2.m2.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1c" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.6" xref="alg2.4.4.2.m2.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1d" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.7" xref="alg2.4.4.2.m2.1.1.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1e" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg2.4.4.2.m2.1.1.8" xref="alg2.4.4.2.m2.1.1.8.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1f" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.9" xref="alg2.4.4.2.m2.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1g" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.10" xref="alg2.4.4.2.m2.1.1.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1h" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.11" xref="alg2.4.4.2.m2.1.1.11.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.2.m2.1.1.1i" xref="alg2.4.4.2.m2.1.1.1.cmml">​</mo><mi id="alg2.4.4.2.m2.1.1.12" xref="alg2.4.4.2.m2.1.1.12.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.4.4.2.m2.1b"><apply id="alg2.4.4.2.m2.1.1.cmml" xref="alg2.4.4.2.m2.1.1"><times id="alg2.4.4.2.m2.1.1.1.cmml" xref="alg2.4.4.2.m2.1.1.1"></times><ci id="alg2.4.4.2.m2.1.1.2.cmml" xref="alg2.4.4.2.m2.1.1.2">𝑤</ci><ci id="alg2.4.4.2.m2.1.1.3.cmml" xref="alg2.4.4.2.m2.1.1.3">𝑒</ci><ci id="alg2.4.4.2.m2.1.1.4.cmml" xref="alg2.4.4.2.m2.1.1.4">𝑖</ci><ci id="alg2.4.4.2.m2.1.1.5.cmml" xref="alg2.4.4.2.m2.1.1.5">𝑔</ci><ci id="alg2.4.4.2.m2.1.1.6.cmml" xref="alg2.4.4.2.m2.1.1.6">ℎ</ci><ci id="alg2.4.4.2.m2.1.1.7.cmml" xref="alg2.4.4.2.m2.1.1.7">𝑡</ci><ci id="alg2.4.4.2.m2.1.1.8.cmml" xref="alg2.4.4.2.m2.1.1.8">_</ci><ci id="alg2.4.4.2.m2.1.1.9.cmml" xref="alg2.4.4.2.m2.1.1.9">𝑙</ci><ci id="alg2.4.4.2.m2.1.1.10.cmml" xref="alg2.4.4.2.m2.1.1.10">𝑖</ci><ci id="alg2.4.4.2.m2.1.1.11.cmml" xref="alg2.4.4.2.m2.1.1.11">𝑠</ci><ci id="alg2.4.4.2.m2.1.1.12.cmml" xref="alg2.4.4.2.m2.1.1.12">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.2.m2.1c">weight\_list</annotation></semantics></math></em> <span id="alg2.4.4.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg2.6.6" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
append flattened <math id="alg2.5.5.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="alg2.5.5.m1.1a"><mi id="alg2.5.5.m1.1.1" xref="alg2.5.5.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="alg2.5.5.m1.1b"><ci id="alg2.5.5.m1.1.1.cmml" xref="alg2.5.5.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.m1.1c">\mathbf{w}</annotation></semantics></math> to <math id="alg2.6.6.m2.1" class="ltx_Math" alttext="\cal W" display="inline"><semantics id="alg2.6.6.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.6.6.m2.1.1" xref="alg2.6.6.m2.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg2.6.6.m2.1b"><ci id="alg2.6.6.m2.1.1.cmml" xref="alg2.6.6.m2.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.m2.1c">\cal W</annotation></semantics></math>
</div>
<div id="alg2.44.48" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.44.49" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="alg2.44.50" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg2.8.8" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.7.7.m1.1" class="ltx_Math" alttext="\cal W\leftarrow" display="inline"><semantics id="alg2.7.7.m1.1a"><mrow id="alg2.7.7.m1.1.1" xref="alg2.7.7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.7.7.m1.1.1.2" xref="alg2.7.7.m1.1.1.2.cmml">𝒲</mi><mo stretchy="false" id="alg2.7.7.m1.1.1.1" xref="alg2.7.7.m1.1.1.1.cmml">←</mo><mi id="alg2.7.7.m1.1.1.3" xref="alg2.7.7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.7.7.m1.1b"><apply id="alg2.7.7.m1.1.1.cmml" xref="alg2.7.7.m1.1.1"><ci id="alg2.7.7.m1.1.1.1.cmml" xref="alg2.7.7.m1.1.1.1">←</ci><ci id="alg2.7.7.m1.1.1.2.cmml" xref="alg2.7.7.m1.1.1.2">𝒲</ci><csymbol cd="latexml" id="alg2.7.7.m1.1.1.3.cmml" xref="alg2.7.7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.m1.1c">\cal W\leftarrow</annotation></semantics></math> apply PCA dimensionality reduction to <math id="alg2.8.8.m2.1" class="ltx_Math" alttext="\cal W" display="inline"><semantics id="alg2.8.8.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.8.8.m2.1.1" xref="alg2.8.8.m2.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg2.8.8.m2.1b"><ci id="alg2.8.8.m2.1.1.cmml" xref="alg2.8.8.m2.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.m2.1c">\cal W</annotation></semantics></math>
</div>
<div id="alg2.44.51" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.9.9" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.9.9.m1.1" class="ltx_Math" alttext="\cal S\leftarrow" display="inline"><semantics id="alg2.9.9.m1.1a"><mrow id="alg2.9.9.m1.1.1" xref="alg2.9.9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.9.9.m1.1.1.2" xref="alg2.9.9.m1.1.1.2.cmml">𝒮</mi><mo stretchy="false" id="alg2.9.9.m1.1.1.1" xref="alg2.9.9.m1.1.1.1.cmml">←</mo><mi id="alg2.9.9.m1.1.1.3" xref="alg2.9.9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.9.m1.1b"><apply id="alg2.9.9.m1.1.1.cmml" xref="alg2.9.9.m1.1.1"><ci id="alg2.9.9.m1.1.1.1.cmml" xref="alg2.9.9.m1.1.1.1">←</ci><ci id="alg2.9.9.m1.1.1.2.cmml" xref="alg2.9.9.m1.1.1.2">𝒮</ci><csymbol cd="latexml" id="alg2.9.9.m1.1.1.3.cmml" xref="alg2.9.9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.m1.1c">\cal S\leftarrow</annotation></semantics></math> empty list 
</div>
<div id="alg2.10.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.10.10.m1.1" class="ltx_Math" alttext="\cal L\leftarrow" display="inline"><semantics id="alg2.10.10.m1.1a"><mrow id="alg2.10.10.m1.1.1" xref="alg2.10.10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.10.10.m1.1.1.2" xref="alg2.10.10.m1.1.1.2.cmml">ℒ</mi><mo stretchy="false" id="alg2.10.10.m1.1.1.1" xref="alg2.10.10.m1.1.1.1.cmml">←</mo><mi id="alg2.10.10.m1.1.1.3" xref="alg2.10.10.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.10.m1.1b"><apply id="alg2.10.10.m1.1.1.cmml" xref="alg2.10.10.m1.1.1"><ci id="alg2.10.10.m1.1.1.1.cmml" xref="alg2.10.10.m1.1.1.1">←</ci><ci id="alg2.10.10.m1.1.1.2.cmml" xref="alg2.10.10.m1.1.1.2">ℒ</ci><csymbol cd="latexml" id="alg2.10.10.m1.1.1.3.cmml" xref="alg2.10.10.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.m1.1c">\cal L\leftarrow</annotation></semantics></math> empty list 
</div>
<div id="alg2.11.11" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.11.11.2" class="ltx_text ltx_font_bold">for</span> <em id="alg2.11.11.1" class="ltx_emph ltx_font_italic">n <math id="alg2.11.11.1.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.11.11.1.m1.1a"><mo stretchy="false" id="alg2.11.11.1.m1.1.1" xref="alg2.11.11.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.11.11.1.m1.1b"><ci id="alg2.11.11.1.m1.1.1.cmml" xref="alg2.11.11.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.1.m1.1c">\leftarrow</annotation></semantics></math> 2 <span id="alg2.11.11.1.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> max number of clusters</em> <span id="alg2.11.11.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg2.12.12" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
K-means clustering of <math id="alg2.12.12.m1.1" class="ltx_Math" alttext="\cal W" display="inline"><semantics id="alg2.12.12.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.12.12.m1.1.1" xref="alg2.12.12.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg2.12.12.m1.1b"><ci id="alg2.12.12.m1.1.1.cmml" xref="alg2.12.12.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.12.m1.1c">\cal W</annotation></semantics></math> into n clusters
</div>
<div id="alg2.13.13" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
append clustering labels to <math id="alg2.13.13.m1.1" class="ltx_Math" alttext="\cal L" display="inline"><semantics id="alg2.13.13.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.13.13.m1.1.1" xref="alg2.13.13.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg2.13.13.m1.1b"><ci id="alg2.13.13.m1.1.1.cmml" xref="alg2.13.13.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.13.m1.1c">\cal L</annotation></semantics></math>
</div>
<div id="alg2.14.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
append clustering quality score to <math id="alg2.14.14.m1.1" class="ltx_Math" alttext="\cal S" display="inline"><semantics id="alg2.14.14.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.14.14.m1.1.1" xref="alg2.14.14.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="alg2.14.14.m1.1b"><ci id="alg2.14.14.m1.1.1.cmml" xref="alg2.14.14.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.14.m1.1c">\cal S</annotation></semantics></math>

</div>
<div id="alg2.44.52" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="alg2.44.53" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg2.16.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg2.15.15.m1.1" class="ltx_Math" alttext="K\leftarrow" display="inline"><semantics id="alg2.15.15.m1.1a"><mrow id="alg2.15.15.m1.1.1" xref="alg2.15.15.m1.1.1.cmml"><mi id="alg2.15.15.m1.1.1.2" xref="alg2.15.15.m1.1.1.2.cmml">K</mi><mo stretchy="false" id="alg2.15.15.m1.1.1.1" xref="alg2.15.15.m1.1.1.1.cmml">←</mo><mi id="alg2.15.15.m1.1.1.3" xref="alg2.15.15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.15.15.m1.1b"><apply id="alg2.15.15.m1.1.1.cmml" xref="alg2.15.15.m1.1.1"><ci id="alg2.15.15.m1.1.1.1.cmml" xref="alg2.15.15.m1.1.1.1">←</ci><ci id="alg2.15.15.m1.1.1.2.cmml" xref="alg2.15.15.m1.1.1.2">𝐾</ci><csymbol cd="latexml" id="alg2.15.15.m1.1.1.3.cmml" xref="alg2.15.15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.15.m1.1c">K\leftarrow</annotation></semantics></math> number of clusters with optimal score in <math id="alg2.16.16.m2.1" class="ltx_Math" alttext="\cal S" display="inline"><semantics id="alg2.16.16.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.16.16.m2.1.1" xref="alg2.16.16.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="alg2.16.16.m2.1b"><ci id="alg2.16.16.m2.1.1.cmml" xref="alg2.16.16.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.16.m2.1c">\cal S</annotation></semantics></math>
</div>
<div id="alg2.44.54" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.19.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg2.19.19.1" class="ltx_text ltx_font_bold">return</span> labels from <math id="alg2.17.17.m1.1" class="ltx_Math" alttext="\cal L" display="inline"><semantics id="alg2.17.17.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.17.17.m1.1.1" xref="alg2.17.17.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg2.17.17.m1.1b"><ci id="alg2.17.17.m1.1.1.cmml" xref="alg2.17.17.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.17.m1.1c">\cal L</annotation></semantics></math> corresponding to <math id="alg2.18.18.m2.1" class="ltx_Math" alttext="n=K" display="inline"><semantics id="alg2.18.18.m2.1a"><mrow id="alg2.18.18.m2.1.1" xref="alg2.18.18.m2.1.1.cmml"><mi id="alg2.18.18.m2.1.1.2" xref="alg2.18.18.m2.1.1.2.cmml">n</mi><mo id="alg2.18.18.m2.1.1.1" xref="alg2.18.18.m2.1.1.1.cmml">=</mo><mi id="alg2.18.18.m2.1.1.3" xref="alg2.18.18.m2.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.18.18.m2.1b"><apply id="alg2.18.18.m2.1.1.cmml" xref="alg2.18.18.m2.1.1"><eq id="alg2.18.18.m2.1.1.1.cmml" xref="alg2.18.18.m2.1.1.1"></eq><ci id="alg2.18.18.m2.1.1.2.cmml" xref="alg2.18.18.m2.1.1.2">𝑛</ci><ci id="alg2.18.18.m2.1.1.3.cmml" xref="alg2.18.18.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.18.m2.1c">n=K</annotation></semantics></math>, <math id="alg2.19.19.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg2.19.19.m3.1a"><mi id="alg2.19.19.m3.1.1" xref="alg2.19.19.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.19.19.m3.1b"><ci id="alg2.19.19.m3.1.1.cmml" xref="alg2.19.19.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.19.19.m3.1c">K</annotation></semantics></math>
</div>
<div id="alg2.44.55" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.44.56" class="ltx_listingline"> 
</div>
<div id="alg2.44.57" class="ltx_listingline">
</div>
<div id="alg2.44.58" class="ltx_listingline">

</div>
<div id="alg2.20.20" class="ltx_listingline">
<span id="alg2.20.20.1" class="ltx_text"><span id="alg2.20.20.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>A set of clients <math id="alg2.20.20.m1.1" class="ltx_Math" alttext="\cal C" display="inline"><semantics id="alg2.20.20.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.20.20.m1.1.1" xref="alg2.20.20.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.20.20.m1.1b"><ci id="alg2.20.20.m1.1.1.cmml" xref="alg2.20.20.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.20.m1.1c">\cal C</annotation></semantics></math>
</div>
<div id="alg2.44.59" class="ltx_listingline">
<span id="alg2.44.59.1" class="ltx_text"><span id="alg2.44.59.1.1" class="ltx_text ltx_font_bold">Result:</span> </span>A set of global models
</div>
<div id="alg2.21.21" class="ltx_listingline">
initialize model <math id="alg2.21.21.m1.1" class="ltx_Math" alttext="\mathbf{W_{0}}" display="inline"><semantics id="alg2.21.21.m1.1a"><msub id="alg2.21.21.m1.1.1" xref="alg2.21.21.m1.1.1.cmml"><mi id="alg2.21.21.m1.1.1.2" xref="alg2.21.21.m1.1.1.2.cmml">𝐖</mi><mn id="alg2.21.21.m1.1.1.3" xref="alg2.21.21.m1.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.21.21.m1.1b"><apply id="alg2.21.21.m1.1.1.cmml" xref="alg2.21.21.m1.1.1"><csymbol cd="ambiguous" id="alg2.21.21.m1.1.1.1.cmml" xref="alg2.21.21.m1.1.1">subscript</csymbol><ci id="alg2.21.21.m1.1.1.2.cmml" xref="alg2.21.21.m1.1.1.2">𝐖</ci><cn type="integer" id="alg2.21.21.m1.1.1.3.cmml" xref="alg2.21.21.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.21.m1.1c">\mathbf{W_{0}}</annotation></semantics></math> on server
</div>
<div id="alg2.22.22" class="ltx_listingline">
<math id="alg2.22.22.m1.1" class="ltx_Math" alttext="\epsilon\leftarrow" display="inline"><semantics id="alg2.22.22.m1.1a"><mrow id="alg2.22.22.m1.1.1" xref="alg2.22.22.m1.1.1.cmml"><mi id="alg2.22.22.m1.1.1.2" xref="alg2.22.22.m1.1.1.2.cmml">ϵ</mi><mo stretchy="false" id="alg2.22.22.m1.1.1.1" xref="alg2.22.22.m1.1.1.1.cmml">←</mo><mi id="alg2.22.22.m1.1.1.3" xref="alg2.22.22.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.22.22.m1.1b"><apply id="alg2.22.22.m1.1.1.cmml" xref="alg2.22.22.m1.1.1"><ci id="alg2.22.22.m1.1.1.1.cmml" xref="alg2.22.22.m1.1.1.1">←</ci><ci id="alg2.22.22.m1.1.1.2.cmml" xref="alg2.22.22.m1.1.1.2">italic-ϵ</ci><csymbol cd="latexml" id="alg2.22.22.m1.1.1.3.cmml" xref="alg2.22.22.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.22.22.m1.1c">\epsilon\leftarrow</annotation></semantics></math> number of local epochs for clustering
</div>
<div id="alg2.44.60" class="ltx_listingline">

</div>
<div id="alg2.23.23" class="ltx_listingline">
<span id="alg2.23.23.2" class="ltx_text ltx_font_bold">foreach</span> <em id="alg2.23.23.1" class="ltx_emph ltx_font_italic">client c <math id="alg2.23.23.1.m1.1" class="ltx_Math" alttext="\in\cal C" display="inline"><semantics id="alg2.23.23.1.m1.1a"><mrow id="alg2.23.23.1.m1.1.1" xref="alg2.23.23.1.m1.1.1.cmml"><mi id="alg2.23.23.1.m1.1.1.2" xref="alg2.23.23.1.m1.1.1.2.cmml"></mi><mo id="alg2.23.23.1.m1.1.1.1" xref="alg2.23.23.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.23.23.1.m1.1.1.3" xref="alg2.23.23.1.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.23.23.1.m1.1b"><apply id="alg2.23.23.1.m1.1.1.cmml" xref="alg2.23.23.1.m1.1.1"><in id="alg2.23.23.1.m1.1.1.1.cmml" xref="alg2.23.23.1.m1.1.1.1"></in><csymbol cd="latexml" id="alg2.23.23.1.m1.1.1.2.cmml" xref="alg2.23.23.1.m1.1.1.2">absent</csymbol><ci id="alg2.23.23.1.m1.1.1.3.cmml" xref="alg2.23.23.1.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.23.23.1.m1.1c">\in\cal C</annotation></semantics></math> <span id="alg2.23.23.1.1" class="ltx_text ltx_font_bold ltx_font_upright">in parallel</span></em> <span id="alg2.23.23.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg2.24.24" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
receive <math id="alg2.24.24.m1.1" class="ltx_Math" alttext="\mathbf{W_{0}}" display="inline"><semantics id="alg2.24.24.m1.1a"><msub id="alg2.24.24.m1.1.1" xref="alg2.24.24.m1.1.1.cmml"><mi id="alg2.24.24.m1.1.1.2" xref="alg2.24.24.m1.1.1.2.cmml">𝐖</mi><mn id="alg2.24.24.m1.1.1.3" xref="alg2.24.24.m1.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.24.24.m1.1b"><apply id="alg2.24.24.m1.1.1.cmml" xref="alg2.24.24.m1.1.1"><csymbol cd="ambiguous" id="alg2.24.24.m1.1.1.1.cmml" xref="alg2.24.24.m1.1.1">subscript</csymbol><ci id="alg2.24.24.m1.1.1.2.cmml" xref="alg2.24.24.m1.1.1.2">𝐖</ci><cn type="integer" id="alg2.24.24.m1.1.1.3.cmml" xref="alg2.24.24.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.24.24.m1.1c">\mathbf{W_{0}}</annotation></semantics></math> from the server
</div>
<div id="alg2.27.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.25.25.m1.2" class="ltx_Math" alttext="\mathbf{W_{c}},n_{c}\leftarrow" display="inline"><semantics id="alg2.25.25.m1.2a"><mrow id="alg2.25.25.m1.2.2" xref="alg2.25.25.m1.2.2.cmml"><mrow id="alg2.25.25.m1.2.2.2.2" xref="alg2.25.25.m1.2.2.2.3.cmml"><msub id="alg2.25.25.m1.1.1.1.1.1" xref="alg2.25.25.m1.1.1.1.1.1.cmml"><mi id="alg2.25.25.m1.1.1.1.1.1.2" xref="alg2.25.25.m1.1.1.1.1.1.2.cmml">𝐖</mi><mi id="alg2.25.25.m1.1.1.1.1.1.3" xref="alg2.25.25.m1.1.1.1.1.1.3.cmml">𝐜</mi></msub><mo id="alg2.25.25.m1.2.2.2.2.3" xref="alg2.25.25.m1.2.2.2.3.cmml">,</mo><msub id="alg2.25.25.m1.2.2.2.2.2" xref="alg2.25.25.m1.2.2.2.2.2.cmml"><mi id="alg2.25.25.m1.2.2.2.2.2.2" xref="alg2.25.25.m1.2.2.2.2.2.2.cmml">n</mi><mi id="alg2.25.25.m1.2.2.2.2.2.3" xref="alg2.25.25.m1.2.2.2.2.2.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="alg2.25.25.m1.2.2.3" xref="alg2.25.25.m1.2.2.3.cmml">←</mo><mi id="alg2.25.25.m1.2.2.4" xref="alg2.25.25.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.25.25.m1.2b"><apply id="alg2.25.25.m1.2.2.cmml" xref="alg2.25.25.m1.2.2"><ci id="alg2.25.25.m1.2.2.3.cmml" xref="alg2.25.25.m1.2.2.3">←</ci><list id="alg2.25.25.m1.2.2.2.3.cmml" xref="alg2.25.25.m1.2.2.2.2"><apply id="alg2.25.25.m1.1.1.1.1.1.cmml" xref="alg2.25.25.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.25.25.m1.1.1.1.1.1.1.cmml" xref="alg2.25.25.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.25.25.m1.1.1.1.1.1.2.cmml" xref="alg2.25.25.m1.1.1.1.1.1.2">𝐖</ci><ci id="alg2.25.25.m1.1.1.1.1.1.3.cmml" xref="alg2.25.25.m1.1.1.1.1.1.3">𝐜</ci></apply><apply id="alg2.25.25.m1.2.2.2.2.2.cmml" xref="alg2.25.25.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.25.25.m1.2.2.2.2.2.1.cmml" xref="alg2.25.25.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.25.25.m1.2.2.2.2.2.2.cmml" xref="alg2.25.25.m1.2.2.2.2.2.2">𝑛</ci><ci id="alg2.25.25.m1.2.2.2.2.2.3.cmml" xref="alg2.25.25.m1.2.2.2.2.2.3">𝑐</ci></apply></list><csymbol cd="latexml" id="alg2.25.25.m1.2.2.4.cmml" xref="alg2.25.25.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.25.25.m1.2c">\mathbf{W_{c}},n_{c}\leftarrow</annotation></semantics></math> <span id="alg2.27.27.2" class="ltx_text ltx_font_typewriter">LocalTrain(<em id="alg2.27.27.2.2" class="ltx_emph ltx_font_serif ltx_font_italic"><math id="alg2.26.26.1.1.m1.1" class="ltx_Math" alttext="\mathbf{W_{0}}" display="inline"><semantics id="alg2.26.26.1.1.m1.1a"><msub id="alg2.26.26.1.1.m1.1.1" xref="alg2.26.26.1.1.m1.1.1.cmml"><mi id="alg2.26.26.1.1.m1.1.1.2" xref="alg2.26.26.1.1.m1.1.1.2.cmml">𝐖</mi><mn id="alg2.26.26.1.1.m1.1.1.3" xref="alg2.26.26.1.1.m1.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.26.26.1.1.m1.1b"><apply id="alg2.26.26.1.1.m1.1.1.cmml" xref="alg2.26.26.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.26.26.1.1.m1.1.1.1.cmml" xref="alg2.26.26.1.1.m1.1.1">subscript</csymbol><ci id="alg2.26.26.1.1.m1.1.1.2.cmml" xref="alg2.26.26.1.1.m1.1.1.2">𝐖</ci><cn type="integer" id="alg2.26.26.1.1.m1.1.1.3.cmml" xref="alg2.26.26.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.26.26.1.1.m1.1c">\mathbf{W_{0}}</annotation></semantics></math>, <math id="alg2.27.27.2.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="alg2.27.27.2.2.m2.1a"><mi id="alg2.27.27.2.2.m2.1.1" xref="alg2.27.27.2.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="alg2.27.27.2.2.m2.1b"><ci id="alg2.27.27.2.2.m2.1.1.cmml" xref="alg2.27.27.2.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.27.27.2.2.m2.1c">\epsilon</annotation></semantics></math></em>)</span>
</div>
<div id="alg2.28.28" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
send <math id="alg2.28.28.m1.1" class="ltx_Math" alttext="\mathbf{W_{c}}" display="inline"><semantics id="alg2.28.28.m1.1a"><msub id="alg2.28.28.m1.1.1" xref="alg2.28.28.m1.1.1.cmml"><mi id="alg2.28.28.m1.1.1.2" xref="alg2.28.28.m1.1.1.2.cmml">𝐖</mi><mi id="alg2.28.28.m1.1.1.3" xref="alg2.28.28.m1.1.1.3.cmml">𝐜</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.28.28.m1.1b"><apply id="alg2.28.28.m1.1.1.cmml" xref="alg2.28.28.m1.1.1"><csymbol cd="ambiguous" id="alg2.28.28.m1.1.1.1.cmml" xref="alg2.28.28.m1.1.1">subscript</csymbol><ci id="alg2.28.28.m1.1.1.2.cmml" xref="alg2.28.28.m1.1.1.2">𝐖</ci><ci id="alg2.28.28.m1.1.1.3.cmml" xref="alg2.28.28.m1.1.1.3">𝐜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.28.28.m1.1c">\mathbf{W_{c}}</annotation></semantics></math> to the server

</div>
<div id="alg2.44.61" class="ltx_listingline"> end foreach
</div>
<div id="alg2.30.30" class="ltx_listingline">
<math id="alg2.29.29.m1.1" class="ltx_Math" alttext="\cal W\leftarrow" display="inline"><semantics id="alg2.29.29.m1.1a"><mrow id="alg2.29.29.m1.1.1" xref="alg2.29.29.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.29.29.m1.1.1.2" xref="alg2.29.29.m1.1.1.2.cmml">𝒲</mi><mo stretchy="false" id="alg2.29.29.m1.1.1.1" xref="alg2.29.29.m1.1.1.1.cmml">←</mo><mi id="alg2.29.29.m1.1.1.3" xref="alg2.29.29.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.29.29.m1.1b"><apply id="alg2.29.29.m1.1.1.cmml" xref="alg2.29.29.m1.1.1"><ci id="alg2.29.29.m1.1.1.1.cmml" xref="alg2.29.29.m1.1.1.1">←</ci><ci id="alg2.29.29.m1.1.1.2.cmml" xref="alg2.29.29.m1.1.1.2">𝒲</ci><csymbol cd="latexml" id="alg2.29.29.m1.1.1.3.cmml" xref="alg2.29.29.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.29.29.m1.1c">\cal W\leftarrow</annotation></semantics></math> list of all the received <math id="alg2.30.30.m2.1" class="ltx_Math" alttext="\mathbf{W_{c\in\cal C}}" display="inline"><semantics id="alg2.30.30.m2.1a"><msub id="alg2.30.30.m2.1.1" xref="alg2.30.30.m2.1.1.cmml"><mi id="alg2.30.30.m2.1.1.2" xref="alg2.30.30.m2.1.1.2.cmml">𝐖</mi><mrow id="alg2.30.30.m2.1.1.3" xref="alg2.30.30.m2.1.1.3.cmml"><mi id="alg2.30.30.m2.1.1.3.2" xref="alg2.30.30.m2.1.1.3.2.cmml">𝐜</mi><mo id="alg2.30.30.m2.1.1.3.1" xref="alg2.30.30.m2.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.30.30.m2.1.1.3.3" xref="alg2.30.30.m2.1.1.3.3.cmml">𝒞</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.30.30.m2.1b"><apply id="alg2.30.30.m2.1.1.cmml" xref="alg2.30.30.m2.1.1"><csymbol cd="ambiguous" id="alg2.30.30.m2.1.1.1.cmml" xref="alg2.30.30.m2.1.1">subscript</csymbol><ci id="alg2.30.30.m2.1.1.2.cmml" xref="alg2.30.30.m2.1.1.2">𝐖</ci><apply id="alg2.30.30.m2.1.1.3.cmml" xref="alg2.30.30.m2.1.1.3"><in id="alg2.30.30.m2.1.1.3.1.cmml" xref="alg2.30.30.m2.1.1.3.1"></in><ci id="alg2.30.30.m2.1.1.3.2.cmml" xref="alg2.30.30.m2.1.1.3.2">𝐜</ci><ci id="alg2.30.30.m2.1.1.3.3.cmml" xref="alg2.30.30.m2.1.1.3.3">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.30.30.m2.1c">\mathbf{W_{c\in\cal C}}</annotation></semantics></math> 
</div>
<div id="alg2.44.62" class="ltx_listingline">

</div>
<div id="alg2.34.34" class="ltx_listingline">
<math id="alg2.31.31.m1.1" class="ltx_Math" alttext="\cal L" display="inline"><semantics id="alg2.31.31.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.31.31.m1.1.1" xref="alg2.31.31.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg2.31.31.m1.1b"><ci id="alg2.31.31.m1.1.1.cmml" xref="alg2.31.31.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.31.31.m1.1c">\cal L</annotation></semantics></math>, <math id="alg2.32.32.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg2.32.32.m2.1a"><mi id="alg2.32.32.m2.1.1" xref="alg2.32.32.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.32.32.m2.1b"><ci id="alg2.32.32.m2.1.1.cmml" xref="alg2.32.32.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.32.32.m2.1c">K</annotation></semantics></math> <math id="alg2.33.33.m3.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.33.33.m3.1a"><mo stretchy="false" id="alg2.33.33.m3.1.1" xref="alg2.33.33.m3.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.33.33.m3.1b"><ci id="alg2.33.33.m3.1.1.cmml" xref="alg2.33.33.m3.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.33.33.m3.1c">\leftarrow</annotation></semantics></math> <span id="alg2.34.34.1" class="ltx_text ltx_font_typewriter">ModelFingerprinting(<em id="alg2.34.34.1.1" class="ltx_emph ltx_font_serif ltx_font_italic"><math id="alg2.34.34.1.1.m1.1" class="ltx_Math" alttext="\cal W" display="inline"><semantics id="alg2.34.34.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.34.34.1.1.m1.1.1" xref="alg2.34.34.1.1.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg2.34.34.1.1.m1.1b"><ci id="alg2.34.34.1.1.m1.1.1.cmml" xref="alg2.34.34.1.1.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.34.34.1.1.m1.1c">\cal W</annotation></semantics></math></em>)</span>
</div>
<div id="alg2.44.63" class="ltx_listingline">

</div>
<div id="alg2.35.35" class="ltx_listingline">
<span id="alg2.35.35.2" class="ltx_text ltx_font_bold">foreach</span> <em id="alg2.35.35.1" class="ltx_emph ltx_font_italic">label <math id="alg2.35.35.1.m1.3" class="ltx_Math" alttext="k\in\{1,...,K\}" display="inline"><semantics id="alg2.35.35.1.m1.3a"><mrow id="alg2.35.35.1.m1.3.4" xref="alg2.35.35.1.m1.3.4.cmml"><mi id="alg2.35.35.1.m1.3.4.2" xref="alg2.35.35.1.m1.3.4.2.cmml">k</mi><mo id="alg2.35.35.1.m1.3.4.1" xref="alg2.35.35.1.m1.3.4.1.cmml">∈</mo><mrow id="alg2.35.35.1.m1.3.4.3.2" xref="alg2.35.35.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="alg2.35.35.1.m1.3.4.3.2.1" xref="alg2.35.35.1.m1.3.4.3.1.cmml">{</mo><mn id="alg2.35.35.1.m1.1.1" xref="alg2.35.35.1.m1.1.1.cmml">1</mn><mo id="alg2.35.35.1.m1.3.4.3.2.2" xref="alg2.35.35.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.35.35.1.m1.2.2" xref="alg2.35.35.1.m1.2.2.cmml">…</mi><mo id="alg2.35.35.1.m1.3.4.3.2.3" xref="alg2.35.35.1.m1.3.4.3.1.cmml">,</mo><mi id="alg2.35.35.1.m1.3.3" xref="alg2.35.35.1.m1.3.3.cmml">K</mi><mo stretchy="false" id="alg2.35.35.1.m1.3.4.3.2.4" xref="alg2.35.35.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.35.35.1.m1.3b"><apply id="alg2.35.35.1.m1.3.4.cmml" xref="alg2.35.35.1.m1.3.4"><in id="alg2.35.35.1.m1.3.4.1.cmml" xref="alg2.35.35.1.m1.3.4.1"></in><ci id="alg2.35.35.1.m1.3.4.2.cmml" xref="alg2.35.35.1.m1.3.4.2">𝑘</ci><set id="alg2.35.35.1.m1.3.4.3.1.cmml" xref="alg2.35.35.1.m1.3.4.3.2"><cn type="integer" id="alg2.35.35.1.m1.1.1.cmml" xref="alg2.35.35.1.m1.1.1">1</cn><ci id="alg2.35.35.1.m1.2.2.cmml" xref="alg2.35.35.1.m1.2.2">…</ci><ci id="alg2.35.35.1.m1.3.3.cmml" xref="alg2.35.35.1.m1.3.3">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.35.35.1.m1.3c">k\in\{1,...,K\}</annotation></semantics></math> <span id="alg2.35.35.1.1" class="ltx_text ltx_font_bold ltx_font_upright">in parallel</span></em> <span id="alg2.35.35.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg2.39.39" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.36.36.m1.1" class="ltx_Math" alttext="{\cal C}_{k}" display="inline"><semantics id="alg2.36.36.m1.1a"><msub id="alg2.36.36.m1.1.1" xref="alg2.36.36.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.36.36.m1.1.1.2" xref="alg2.36.36.m1.1.1.2.cmml">𝒞</mi><mi id="alg2.36.36.m1.1.1.3" xref="alg2.36.36.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.36.36.m1.1b"><apply id="alg2.36.36.m1.1.1.cmml" xref="alg2.36.36.m1.1.1"><csymbol cd="ambiguous" id="alg2.36.36.m1.1.1.1.cmml" xref="alg2.36.36.m1.1.1">subscript</csymbol><ci id="alg2.36.36.m1.1.1.2.cmml" xref="alg2.36.36.m1.1.1.2">𝒞</ci><ci id="alg2.36.36.m1.1.1.3.cmml" xref="alg2.36.36.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.36.36.m1.1c">{\cal C}_{k}</annotation></semantics></math> <math id="alg2.37.37.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.37.37.m2.1a"><mo stretchy="false" id="alg2.37.37.m2.1.1" xref="alg2.37.37.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.37.37.m2.1b"><ci id="alg2.37.37.m2.1.1.cmml" xref="alg2.37.37.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.37.37.m2.1c">\leftarrow</annotation></semantics></math> subset of clients <math id="alg2.38.38.m3.1" class="ltx_Math" alttext="\in\cal C" display="inline"><semantics id="alg2.38.38.m3.1a"><mrow id="alg2.38.38.m3.1.1" xref="alg2.38.38.m3.1.1.cmml"><mi id="alg2.38.38.m3.1.1.2" xref="alg2.38.38.m3.1.1.2.cmml"></mi><mo id="alg2.38.38.m3.1.1.1" xref="alg2.38.38.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.38.38.m3.1.1.3" xref="alg2.38.38.m3.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.38.38.m3.1b"><apply id="alg2.38.38.m3.1.1.cmml" xref="alg2.38.38.m3.1.1"><in id="alg2.38.38.m3.1.1.1.cmml" xref="alg2.38.38.m3.1.1.1"></in><csymbol cd="latexml" id="alg2.38.38.m3.1.1.2.cmml" xref="alg2.38.38.m3.1.1.2">absent</csymbol><ci id="alg2.38.38.m3.1.1.3.cmml" xref="alg2.38.38.m3.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.38.38.m3.1c">\in\cal C</annotation></semantics></math> with labels <math id="alg2.39.39.m4.1" class="ltx_Math" alttext="{\cal L}=k" display="inline"><semantics id="alg2.39.39.m4.1a"><mrow id="alg2.39.39.m4.1.1" xref="alg2.39.39.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.39.39.m4.1.1.2" xref="alg2.39.39.m4.1.1.2.cmml">ℒ</mi><mo id="alg2.39.39.m4.1.1.1" xref="alg2.39.39.m4.1.1.1.cmml">=</mo><mi id="alg2.39.39.m4.1.1.3" xref="alg2.39.39.m4.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.39.39.m4.1b"><apply id="alg2.39.39.m4.1.1.cmml" xref="alg2.39.39.m4.1.1"><eq id="alg2.39.39.m4.1.1.1.cmml" xref="alg2.39.39.m4.1.1.1"></eq><ci id="alg2.39.39.m4.1.1.2.cmml" xref="alg2.39.39.m4.1.1.2">ℒ</ci><ci id="alg2.39.39.m4.1.1.3.cmml" xref="alg2.39.39.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.39.39.m4.1c">{\cal L}=k</annotation></semantics></math>
</div>
<div id="alg2.42.42" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.40.40.m1.1" class="ltx_Math" alttext="\mathbf{W_{G}^{C=k}}\leftarrow" display="inline"><semantics id="alg2.40.40.m1.1a"><mrow id="alg2.40.40.m1.1.1" xref="alg2.40.40.m1.1.1.cmml"><msubsup id="alg2.40.40.m1.1.1.2" xref="alg2.40.40.m1.1.1.2.cmml"><mi id="alg2.40.40.m1.1.1.2.2.2" xref="alg2.40.40.m1.1.1.2.2.2.cmml">𝐖</mi><mi id="alg2.40.40.m1.1.1.2.2.3" xref="alg2.40.40.m1.1.1.2.2.3.cmml">𝐆</mi><mrow id="alg2.40.40.m1.1.1.2.3" xref="alg2.40.40.m1.1.1.2.3.cmml"><mi id="alg2.40.40.m1.1.1.2.3.2" xref="alg2.40.40.m1.1.1.2.3.2.cmml">𝐂</mi><mo id="alg2.40.40.m1.1.1.2.3.1" xref="alg2.40.40.m1.1.1.2.3.1.cmml">=</mo><mi id="alg2.40.40.m1.1.1.2.3.3" xref="alg2.40.40.m1.1.1.2.3.3.cmml">𝐤</mi></mrow></msubsup><mo stretchy="false" id="alg2.40.40.m1.1.1.1" xref="alg2.40.40.m1.1.1.1.cmml">←</mo><mi id="alg2.40.40.m1.1.1.3" xref="alg2.40.40.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.40.40.m1.1b"><apply id="alg2.40.40.m1.1.1.cmml" xref="alg2.40.40.m1.1.1"><ci id="alg2.40.40.m1.1.1.1.cmml" xref="alg2.40.40.m1.1.1.1">←</ci><apply id="alg2.40.40.m1.1.1.2.cmml" xref="alg2.40.40.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.40.40.m1.1.1.2.1.cmml" xref="alg2.40.40.m1.1.1.2">superscript</csymbol><apply id="alg2.40.40.m1.1.1.2.2.cmml" xref="alg2.40.40.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.40.40.m1.1.1.2.2.1.cmml" xref="alg2.40.40.m1.1.1.2">subscript</csymbol><ci id="alg2.40.40.m1.1.1.2.2.2.cmml" xref="alg2.40.40.m1.1.1.2.2.2">𝐖</ci><ci id="alg2.40.40.m1.1.1.2.2.3.cmml" xref="alg2.40.40.m1.1.1.2.2.3">𝐆</ci></apply><apply id="alg2.40.40.m1.1.1.2.3.cmml" xref="alg2.40.40.m1.1.1.2.3"><eq id="alg2.40.40.m1.1.1.2.3.1.cmml" xref="alg2.40.40.m1.1.1.2.3.1"></eq><ci id="alg2.40.40.m1.1.1.2.3.2.cmml" xref="alg2.40.40.m1.1.1.2.3.2">𝐂</ci><ci id="alg2.40.40.m1.1.1.2.3.3.cmml" xref="alg2.40.40.m1.1.1.2.3.3">𝐤</ci></apply></apply><csymbol cd="latexml" id="alg2.40.40.m1.1.1.3.cmml" xref="alg2.40.40.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.40.40.m1.1c">\mathbf{W_{G}^{C=k}}\leftarrow</annotation></semantics></math> average of <math id="alg2.41.41.m2.1" class="ltx_Math" alttext="\cal W" display="inline"><semantics id="alg2.41.41.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.41.41.m2.1.1" xref="alg2.41.41.m2.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg2.41.41.m2.1b"><ci id="alg2.41.41.m2.1.1.cmml" xref="alg2.41.41.m2.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.41.41.m2.1c">\cal W</annotation></semantics></math> with labels <math id="alg2.42.42.m3.1" class="ltx_Math" alttext="{\cal L}=k" display="inline"><semantics id="alg2.42.42.m3.1a"><mrow id="alg2.42.42.m3.1.1" xref="alg2.42.42.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.42.42.m3.1.1.2" xref="alg2.42.42.m3.1.1.2.cmml">ℒ</mi><mo id="alg2.42.42.m3.1.1.1" xref="alg2.42.42.m3.1.1.1.cmml">=</mo><mi id="alg2.42.42.m3.1.1.3" xref="alg2.42.42.m3.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.42.42.m3.1b"><apply id="alg2.42.42.m3.1.1.cmml" xref="alg2.42.42.m3.1.1"><eq id="alg2.42.42.m3.1.1.1.cmml" xref="alg2.42.42.m3.1.1.1"></eq><ci id="alg2.42.42.m3.1.1.2.cmml" xref="alg2.42.42.m3.1.1.2">ℒ</ci><ci id="alg2.42.42.m3.1.1.3.cmml" xref="alg2.42.42.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.42.42.m3.1c">{\cal L}=k</annotation></semantics></math>
</div>
<div id="alg2.44.44" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.43.43.m1.1" class="ltx_Math" alttext="\mathbf{W_{G}^{C=k}}\leftarrow" display="inline"><semantics id="alg2.43.43.m1.1a"><mrow id="alg2.43.43.m1.1.1" xref="alg2.43.43.m1.1.1.cmml"><msubsup id="alg2.43.43.m1.1.1.2" xref="alg2.43.43.m1.1.1.2.cmml"><mi id="alg2.43.43.m1.1.1.2.2.2" xref="alg2.43.43.m1.1.1.2.2.2.cmml">𝐖</mi><mi id="alg2.43.43.m1.1.1.2.2.3" xref="alg2.43.43.m1.1.1.2.2.3.cmml">𝐆</mi><mrow id="alg2.43.43.m1.1.1.2.3" xref="alg2.43.43.m1.1.1.2.3.cmml"><mi id="alg2.43.43.m1.1.1.2.3.2" xref="alg2.43.43.m1.1.1.2.3.2.cmml">𝐂</mi><mo id="alg2.43.43.m1.1.1.2.3.1" xref="alg2.43.43.m1.1.1.2.3.1.cmml">=</mo><mi id="alg2.43.43.m1.1.1.2.3.3" xref="alg2.43.43.m1.1.1.2.3.3.cmml">𝐤</mi></mrow></msubsup><mo stretchy="false" id="alg2.43.43.m1.1.1.1" xref="alg2.43.43.m1.1.1.1.cmml">←</mo><mi id="alg2.43.43.m1.1.1.3" xref="alg2.43.43.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.43.43.m1.1b"><apply id="alg2.43.43.m1.1.1.cmml" xref="alg2.43.43.m1.1.1"><ci id="alg2.43.43.m1.1.1.1.cmml" xref="alg2.43.43.m1.1.1.1">←</ci><apply id="alg2.43.43.m1.1.1.2.cmml" xref="alg2.43.43.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.43.43.m1.1.1.2.1.cmml" xref="alg2.43.43.m1.1.1.2">superscript</csymbol><apply id="alg2.43.43.m1.1.1.2.2.cmml" xref="alg2.43.43.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.43.43.m1.1.1.2.2.1.cmml" xref="alg2.43.43.m1.1.1.2">subscript</csymbol><ci id="alg2.43.43.m1.1.1.2.2.2.cmml" xref="alg2.43.43.m1.1.1.2.2.2">𝐖</ci><ci id="alg2.43.43.m1.1.1.2.2.3.cmml" xref="alg2.43.43.m1.1.1.2.2.3">𝐆</ci></apply><apply id="alg2.43.43.m1.1.1.2.3.cmml" xref="alg2.43.43.m1.1.1.2.3"><eq id="alg2.43.43.m1.1.1.2.3.1.cmml" xref="alg2.43.43.m1.1.1.2.3.1"></eq><ci id="alg2.43.43.m1.1.1.2.3.2.cmml" xref="alg2.43.43.m1.1.1.2.3.2">𝐂</ci><ci id="alg2.43.43.m1.1.1.2.3.3.cmml" xref="alg2.43.43.m1.1.1.2.3.3">𝐤</ci></apply></apply><csymbol cd="latexml" id="alg2.43.43.m1.1.1.3.cmml" xref="alg2.43.43.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.43.43.m1.1c">\mathbf{W_{G}^{C=k}}\leftarrow</annotation></semantics></math><span id="alg2.44.44.1" class="ltx_text ltx_font_typewriter">FederatedLearning<math id="alg2.44.44.1.m1.2" class="ltx_Math" alttext="({\cal C}_{k},\mathbf{W_{G}^{C=k}})" display="inline"><semantics id="alg2.44.44.1.m1.2a"><mrow id="alg2.44.44.1.m1.2.2.2" xref="alg2.44.44.1.m1.2.2.3.cmml"><mo stretchy="false" id="alg2.44.44.1.m1.2.2.2.3" xref="alg2.44.44.1.m1.2.2.3.cmml">(</mo><msub id="alg2.44.44.1.m1.1.1.1.1" xref="alg2.44.44.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.44.44.1.m1.1.1.1.1.2" xref="alg2.44.44.1.m1.1.1.1.1.2.cmml">𝒞</mi><mi id="alg2.44.44.1.m1.1.1.1.1.3" xref="alg2.44.44.1.m1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg2.44.44.1.m1.2.2.2.4" xref="alg2.44.44.1.m1.2.2.3.cmml">,</mo><msubsup id="alg2.44.44.1.m1.2.2.2.2" xref="alg2.44.44.1.m1.2.2.2.2.cmml"><mi id="alg2.44.44.1.m1.2.2.2.2.2.2" xref="alg2.44.44.1.m1.2.2.2.2.2.2.cmml">𝐖</mi><mi id="alg2.44.44.1.m1.2.2.2.2.2.3" xref="alg2.44.44.1.m1.2.2.2.2.2.3.cmml">𝐆</mi><mrow id="alg2.44.44.1.m1.2.2.2.2.3" xref="alg2.44.44.1.m1.2.2.2.2.3.cmml"><mi id="alg2.44.44.1.m1.2.2.2.2.3.2" xref="alg2.44.44.1.m1.2.2.2.2.3.2.cmml">𝐂</mi><mo id="alg2.44.44.1.m1.2.2.2.2.3.1" xref="alg2.44.44.1.m1.2.2.2.2.3.1.cmml">=</mo><mi id="alg2.44.44.1.m1.2.2.2.2.3.3" xref="alg2.44.44.1.m1.2.2.2.2.3.3.cmml">𝐤</mi></mrow></msubsup><mo stretchy="false" id="alg2.44.44.1.m1.2.2.2.5" xref="alg2.44.44.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.44.44.1.m1.2b"><interval closure="open" id="alg2.44.44.1.m1.2.2.3.cmml" xref="alg2.44.44.1.m1.2.2.2"><apply id="alg2.44.44.1.m1.1.1.1.1.cmml" xref="alg2.44.44.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.44.44.1.m1.1.1.1.1.1.cmml" xref="alg2.44.44.1.m1.1.1.1.1">subscript</csymbol><ci id="alg2.44.44.1.m1.1.1.1.1.2.cmml" xref="alg2.44.44.1.m1.1.1.1.1.2">𝒞</ci><ci id="alg2.44.44.1.m1.1.1.1.1.3.cmml" xref="alg2.44.44.1.m1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.44.44.1.m1.2.2.2.2.cmml" xref="alg2.44.44.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.44.44.1.m1.2.2.2.2.1.cmml" xref="alg2.44.44.1.m1.2.2.2.2">superscript</csymbol><apply id="alg2.44.44.1.m1.2.2.2.2.2.cmml" xref="alg2.44.44.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.44.44.1.m1.2.2.2.2.2.1.cmml" xref="alg2.44.44.1.m1.2.2.2.2">subscript</csymbol><ci id="alg2.44.44.1.m1.2.2.2.2.2.2.cmml" xref="alg2.44.44.1.m1.2.2.2.2.2.2">𝐖</ci><ci id="alg2.44.44.1.m1.2.2.2.2.2.3.cmml" xref="alg2.44.44.1.m1.2.2.2.2.2.3">𝐆</ci></apply><apply id="alg2.44.44.1.m1.2.2.2.2.3.cmml" xref="alg2.44.44.1.m1.2.2.2.2.3"><eq id="alg2.44.44.1.m1.2.2.2.2.3.1.cmml" xref="alg2.44.44.1.m1.2.2.2.2.3.1"></eq><ci id="alg2.44.44.1.m1.2.2.2.2.3.2.cmml" xref="alg2.44.44.1.m1.2.2.2.2.3.2">𝐂</ci><ci id="alg2.44.44.1.m1.2.2.2.2.3.3.cmml" xref="alg2.44.44.1.m1.2.2.2.2.3.3">𝐤</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.44.44.1.m1.2c">({\cal C}_{k},\mathbf{W_{G}^{C=k}})</annotation></semantics></math></span>
</div>
<div id="alg2.44.64" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.44.65" class="ltx_listingline"> end foreach
</div>
<div id="alg2.44.66" class="ltx_listingline">
</div>
<div id="alg2.44.67" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.48.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>Proposed clustered federated learning for heterogeneous clients. The <span id="alg2.49.2" class="ltx_text ltx_font_typewriter">LocalTrain</span> and <span id="alg2.50.3" class="ltx_text ltx_font_typewriter">FederatedLearning</span> functions are described in Algorithm <a href="#alg1" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</figcaption>
</figure>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.4" class="ltx_p">The proposed clustered FL is described in Algorithm <a href="#alg2" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. First, the aggregation server initializes the model weights <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{W_{0}}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">𝐖</mi><mn id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝐖</ci><cn type="integer" id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathbf{W_{0}}</annotation></semantics></math> and selects the training hyperparameters. Then, the server sends those values to all the participating clients. In the next step, each client partially trains <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{W_{0}}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">𝐖</mi><mn id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝐖</ci><cn type="integer" id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\mathbf{W_{0}}</annotation></semantics></math> using only its local data for <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\epsilon</annotation></semantics></math> epochs. The local training is performed using the <span id="S3.SS2.p3.4.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> gradient-based optimizer to minimize the local training loss. <span id="S3.SS2.p3.4.2" class="ltx_text ltx_font_smallcaps">ClientOpt</span> is an abstraction for optimizers such as SGD, Adam or RMSprop. After the local training, each client sends the partially trained model to the aggregation server. The aggregation server collects all the local models and uses them to group the clients into <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">K</annotation></semantics></math> clusters based on similarities between the trained model parameters (weights and biases). The grouping process is discussed in more detail in the next subsection.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.4" class="ltx_p">For each identified cluster <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">k</annotation></semantics></math>, an independent FL process is executed in parallel (Algorithm <a href="#alg1" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). We perform multiple FL rounds (R rounds) until the global model for each cluster converges, resulting in a set of <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">K</annotation></semantics></math> global models. At each round, the clients transmit the difference between the weights from the received global model at the start of the round and the locally updated model weights. The server uses these weight deltas to compute what the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> call as <span id="S3.SS2.p4.4.1" class="ltx_text ltx_font_italic">pseudo-gradient</span>, i.e., the negative of the averaged model deltas. The <span id="S3.SS2.p4.4.2" class="ltx_text ltx_font_italic">pseudo-gradient</span>, along with the server learning rate <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">η</mi><mi id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝜂</ci><ci id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">\eta_{s}</annotation></semantics></math> is used for the model aggregation process, which is generalized in the <span id="S3.SS2.p4.4.3" class="ltx_text ltx_font_smallcaps">ServerOpt</span> function as shown in Algorithm <a href="#alg1" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The <span id="S3.SS2.p4.4.4" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and <span id="S3.SS2.p4.4.5" class="ltx_text ltx_font_smallcaps">ServerOpt</span> abstraction allows incorporating momentum or other adaptive optimization methods to both client-side training and server-side model aggregation compared to the FedAvg algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. The popular FedAvg aggregation method can be considered a special case where <span id="S3.SS2.p4.4.6" class="ltx_text ltx_font_smallcaps">ServerOpt</span> is set to SGD with server learning rate <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="\eta_{s}=1.0" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><mrow id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><msub id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2.2" xref="S3.SS2.p4.4.m4.1.1.2.2.cmml">η</mi><mi id="S3.SS2.p4.4.m4.1.1.2.3" xref="S3.SS2.p4.4.m4.1.1.2.3.cmml">s</mi></msub><mo id="S3.SS2.p4.4.m4.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><eq id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1"></eq><apply id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.2.1.cmml" xref="S3.SS2.p4.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2.2">𝜂</ci><ci id="S3.SS2.p4.4.m4.1.1.2.3.cmml" xref="S3.SS2.p4.4.m4.1.1.2.3">𝑠</ci></apply><cn type="float" id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">\eta_{s}=1.0</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Model Fingerprinting for Device Clustering</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">In a network of heterogeneous devices, the underlying data distribution might not be IID. In a FL setting, a single global model complex enough could be able to fit the data properly; however, training a complex model in IoT devices might not be possible due to hardware constraints. Consequently, we will group the devices with similar behavior to create a set of global models specifically tailored to each group of devices. With this method, each IoT device is assigned a group label in an unsupervised manner that is going to be used during the FL process.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">The main advantages of using the locally trained model updates as inputs for the clustering method are that <span id="S3.SS3.p2.1.1" class="ltx_text ltx_font_italic">i)</span> there is no need to integrate any external device fingerprinting algorithms or manual methods, <span id="S3.SS3.p2.1.2" class="ltx_text ltx_font_italic">ii)</span> does not require waiting for a certain amount of time to identify the devices before starting the model training process and <span id="S3.SS3.p2.1.3" class="ltx_text ltx_font_italic">iii)</span> everything is completely integrated into the FL training pipeline.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.2" class="ltx_p">As detailed in Algorithm <a href="#alg2" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the first step for the model fingerprinting consists of partially training each local model for <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\epsilon</annotation></semantics></math> epochs, and sending the partially trained model to the aggregation server. Then, the server flattens the parameters (weights and biases) of each model and performs Principal Component Analysis (PCA) to reduce the dimensionality of the parameters. The reduced dimensionality helps speed up the computation of the clustering step and can limit the problems of clustering high dimensionality data in models with a considerable number of parameters. We use the K-means algorithm with the k-means++ initialization scheme <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> to cluster the reduced dimensionality data. The hypothesis is that clients with similar data distributions will converge to models with similar parameter (weights and biases) values, provided that all clients start from the same initial random model <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{W_{0}}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">𝐖</mi><mn id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝐖</ci><cn type="integer" id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\mathbf{W_{0}}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.2" class="ltx_p">Due to the unsupervised nature of our proposal, we will use internal clustering validation metrics to select an optimal value for the number of clusters <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">K</annotation></semantics></math>. Internal validation metrics do not rely on any external data and are mainly based on measures such as the compactness of samples within the same cluster and separation between different clusters <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>. Specifically, we will evaluate the following internal validation metrics: Silhouette <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>, Davies-Bouldin <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> and S_Dbw <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite> scores to select the value of <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">K</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.4.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.5.2" class="ltx_text ltx_font_italic">Anomaly Detection Model</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">In this paper, we are going to employ autoencoder neural networks as the anomaly detection models, which have already been used in similar domains for network-based attack detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>. We are going to prioritize lightweight autoencoders (small number of parameters), which makes them especially suitable for our deployment scenario because it not only requires less computational load for model training or inference in constrained devices, but also reduces the network traffic volume between the devices and the aggregation server during the FL rounds due to less number of parameters compared to more complex models.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.8" class="ltx_p">Autoencoders are unsupervised neural networks that attempt to replicate the input data on their output layer under some constraints to avoid learning the identity function. The autoencoder is composed of two networks, the encoder and the decoder. The encoder takes the input features <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{x}\in\mathbb{R}^{n}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">𝐱</mi><mo id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS4.p2.1.m1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><in id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1"></in><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝐱</ci><apply id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathbf{x}\in\mathbb{R}^{n}</annotation></semantics></math> and transforms them into a hidden encoded space  <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{h}\in\mathbb{R}^{e}" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mrow id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">𝐡</mi><mo id="S3.SS4.p2.2.m2.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml"><mi id="S3.SS4.p2.2.m2.1.1.3.2" xref="S3.SS4.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS4.p2.2.m2.1.1.3.3" xref="S3.SS4.p2.2.m2.1.1.3.3.cmml">e</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><in id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1"></in><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">𝐡</ci><apply id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.3.1.cmml" xref="S3.SS4.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.3.2.cmml" xref="S3.SS4.p2.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS4.p2.2.m2.1.1.3.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\mathbf{h}\in\mathbb{R}^{e}</annotation></semantics></math>, where <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="e&lt;n" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><mrow id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">e</mi><mo id="S3.SS4.p2.3.m3.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.cmml">&lt;</mo><mi id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><lt id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1"></lt><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">𝑒</ci><ci id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">e&lt;n</annotation></semantics></math> to impose a constraint to avoid learning the identity function. Then, the decoder transforms <math id="S3.SS4.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S3.SS4.p2.4.m4.1a"><mi id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><ci id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">\mathbf{h}</annotation></semantics></math> into <math id="S3.SS4.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{x^{\prime}}\in\mathbb{R}^{n}" display="inline"><semantics id="S3.SS4.p2.5.m5.1a"><mrow id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml"><msup id="S3.SS4.p2.5.m5.1.1.2" xref="S3.SS4.p2.5.m5.1.1.2.cmml"><mi id="S3.SS4.p2.5.m5.1.1.2.2" xref="S3.SS4.p2.5.m5.1.1.2.2.cmml">𝐱</mi><mo id="S3.SS4.p2.5.m5.1.1.2.3" xref="S3.SS4.p2.5.m5.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS4.p2.5.m5.1.1.1" xref="S3.SS4.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.5.m5.1.1.3" xref="S3.SS4.p2.5.m5.1.1.3.cmml"><mi id="S3.SS4.p2.5.m5.1.1.3.2" xref="S3.SS4.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS4.p2.5.m5.1.1.3.3" xref="S3.SS4.p2.5.m5.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1"><in id="S3.SS4.p2.5.m5.1.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1.1"></in><apply id="S3.SS4.p2.5.m5.1.1.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.2.1.cmml" xref="S3.SS4.p2.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.2.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2.2">𝐱</ci><ci id="S3.SS4.p2.5.m5.1.1.2.3.cmml" xref="S3.SS4.p2.5.m5.1.1.2.3">′</ci></apply><apply id="S3.SS4.p2.5.m5.1.1.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.3.1.cmml" xref="S3.SS4.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.3.2.cmml" xref="S3.SS4.p2.5.m5.1.1.3.2">ℝ</ci><ci id="S3.SS4.p2.5.m5.1.1.3.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">\mathbf{x^{\prime}}\in\mathbb{R}^{n}</annotation></semantics></math>. The objective of the autoencoder is to minimize the mean squared error (MSE, reconstruction error) between <math id="S3.SS4.p2.6.m6.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.SS4.p2.6.m6.1a"><mi id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><ci id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">\mathbf{x}</annotation></semantics></math> and <math id="S3.SS4.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{x^{\prime}}" display="inline"><semantics id="S3.SS4.p2.7.m7.1a"><msup id="S3.SS4.p2.7.m7.1.1" xref="S3.SS4.p2.7.m7.1.1.cmml"><mi id="S3.SS4.p2.7.m7.1.1.2" xref="S3.SS4.p2.7.m7.1.1.2.cmml">𝐱</mi><mo id="S3.SS4.p2.7.m7.1.1.3" xref="S3.SS4.p2.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.1b"><apply id="S3.SS4.p2.7.m7.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS4.p2.7.m7.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1.2">𝐱</ci><ci id="S3.SS4.p2.7.m7.1.1.3.cmml" xref="S3.SS4.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.1c">\mathbf{x^{\prime}}</annotation></semantics></math> as in equation (<a href="#S3.E1" title="In III-D Anomaly Detection Model ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The autoencoder is trained using the loss function shown in equation (<a href="#S3.E2" title="In III-D Anomaly Detection Model ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), which in addition to the MSE, it includes the <math id="S3.SS4.p2.8.m8.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S3.SS4.p2.8.m8.1a"><msub id="S3.SS4.p2.8.m8.1.1" xref="S3.SS4.p2.8.m8.1.1.cmml"><mi id="S3.SS4.p2.8.m8.1.1.2" xref="S3.SS4.p2.8.m8.1.1.2.cmml">L</mi><mn id="S3.SS4.p2.8.m8.1.1.3" xref="S3.SS4.p2.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m8.1b"><apply id="S3.SS4.p2.8.m8.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m8.1.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p2.8.m8.1.1.2.cmml" xref="S3.SS4.p2.8.m8.1.1.2">𝐿</ci><cn type="integer" id="S3.SS4.p2.8.m8.1.1.3.cmml" xref="S3.SS4.p2.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">L_{2}</annotation></semantics></math> regularization term.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="MSE=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-x_{i}^{\prime})^{2}." display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.3.1a" xref="S3.E1.m1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.3.4" xref="S3.E1.m1.1.1.1.1.3.4.cmml">E</mi></mrow><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mfrac id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml"><mn id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E1.m1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml">n</mi></munderover><msup id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msubsup></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo lspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">𝑀</ci><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝑆</ci><ci id="S3.E1.m1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.1.1.3.4">𝐸</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><divide id="S3.E1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.3"></divide><cn type="integer" id="S3.E1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">MSE=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-x_{i}^{\prime})^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\mathcal{L}=MSE+\lambda\sum_{i}w_{i}^{2}" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">ℒ</mi><mo id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mrow id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.3.2.2" xref="S3.E2.m1.1.1.3.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.3.2.1" xref="S3.E2.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E2.m1.1.1.3.2.3" xref="S3.E2.m1.1.1.3.2.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.3.2.1a" xref="S3.E2.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.E2.m1.1.1.3.2.4" xref="S3.E2.m1.1.1.3.2.4.cmml">E</mi></mrow><mo id="S3.E2.m1.1.1.3.1" xref="S3.E2.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.3.3.2" xref="S3.E2.m1.1.1.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.3.3.1" xref="S3.E2.m1.1.1.3.3.1.cmml">​</mo><mrow id="S3.E2.m1.1.1.3.3.3" xref="S3.E2.m1.1.1.3.3.3.cmml"><munder id="S3.E2.m1.1.1.3.3.3.1" xref="S3.E2.m1.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.1.1.3.3.3.1.2" xref="S3.E2.m1.1.1.3.3.3.1.2.cmml">∑</mo><mi id="S3.E2.m1.1.1.3.3.3.1.3" xref="S3.E2.m1.1.1.3.3.3.1.3.cmml">i</mi></munder><msubsup id="S3.E2.m1.1.1.3.3.3.2" xref="S3.E2.m1.1.1.3.3.3.2.cmml"><mi id="S3.E2.m1.1.1.3.3.3.2.2.2" xref="S3.E2.m1.1.1.3.3.3.2.2.2.cmml">w</mi><mi id="S3.E2.m1.1.1.3.3.3.2.2.3" xref="S3.E2.m1.1.1.3.3.3.2.2.3.cmml">i</mi><mn id="S3.E2.m1.1.1.3.3.3.2.3" xref="S3.E2.m1.1.1.3.3.3.2.3.cmml">2</mn></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"></eq><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">ℒ</ci><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><plus id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1"></plus><apply id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2"><times id="S3.E2.m1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.3.2.1"></times><ci id="S3.E2.m1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2">𝑀</ci><ci id="S3.E2.m1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3">𝑆</ci><ci id="S3.E2.m1.1.1.3.2.4.cmml" xref="S3.E2.m1.1.1.3.2.4">𝐸</ci></apply><apply id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3"><times id="S3.E2.m1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.3.3.2">𝜆</ci><apply id="S3.E2.m1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.3.3.3"><apply id="S3.E2.m1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.3.3.1.1.cmml" xref="S3.E2.m1.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E2.m1.1.1.3.3.3.1.2.cmml" xref="S3.E2.m1.1.1.3.3.3.1.2"></sum><ci id="S3.E2.m1.1.1.3.3.3.1.3.cmml" xref="S3.E2.m1.1.1.3.3.3.1.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.3.3.2.1.cmml" xref="S3.E2.m1.1.1.3.3.3.2">superscript</csymbol><apply id="S3.E2.m1.1.1.3.3.3.2.2.cmml" xref="S3.E2.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.3.3.2.2.1.cmml" xref="S3.E2.m1.1.1.3.3.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.3.3.3.2.2.2.cmml" xref="S3.E2.m1.1.1.3.3.3.2.2.2">𝑤</ci><ci id="S3.E2.m1.1.1.3.3.3.2.2.3.cmml" xref="S3.E2.m1.1.1.3.3.3.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.E2.m1.1.1.3.3.3.2.3.cmml" xref="S3.E2.m1.1.1.3.3.3.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\mathcal{L}=MSE+\lambda\sum_{i}w_{i}^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p5" class="ltx_para">
<p id="S3.SS4.p5.1" class="ltx_p">We train the autoencoder using samples of normal (legitimate or benign) IoT network traffic which does not contain attacks; this way, the model learns a representation of the normal behavior of these devices. Once the autoencoder is trained (using the proposed FL approach), it is evaluated on network traces containing legitimate and attack samples. The reconstruction error between the input and output layers is used as a measure of the anomaly level in the new incoming data. New network samples that came from a similar distribution as the training data will have a small reconstruction error; however, we expect that attack samples diverge from the trained data distribution, and thus, the reconstruction error will be higher.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">IoT Testbed and Experimental Setup</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we present the experimental setup. We begin with a description of the selected IoT testbed used to extract the dataset and implement the experiments, including a description of all the considered IoT device types and attackers. We then continue to detail the training and validation network traffic datasets generated with the testbed. For the validation datasets, we include a list of the malicious activities performed according to our threat model.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">IoT Testbed</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The experimental setup is based on the Gotham Testbed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, a testbed to perform large-scale IoT security experiments in a realistic and reproducible way. Gotham is built on top of the GNS3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite> network emulator, and it includes a repository of Docker images and QEMU-based virtual machines to emulate various IoT/IIoT devices, malware samples, servers and networking equipment such as switches and routers. To generate real network traffic traces, the emulated devices run real production libraries, network switching software (Open vSwitch) and routing operating systems (VyOS), as well as real malware samples and red-teaming tools, which are going to be briefly described in this section.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">To create the IoT scenario, we use the default case study scenario presented at <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> composed of many heterogeneous nodes. The scenario comprises three main networks connected by 10 routers and 30 switches: the city network, the cloud network and the threat network. The full details are explained in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, but here we will present a summary of the different emulated devices which are relevant for the discussion in the following sections.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS1.4.1.1" class="ltx_text">IV-A</span>1 </span>City network devices</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">The city network contains the emulated IoT/IIoT devices. The devices communicate with the cloud network using various protocols, including MQTT, CoAP (two protocols that are specifically designed and well-suited for machines with constrained resources and the IoT paradigm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>) and RTSP. Additionally, to increase the protocol heterogeneity, the devices generate background traffic such as DNS, NTP and ICMP. In total, there are 12 device templates to simulate a heterogeneous environment, as shown in Table <a href="#S4.T1" title="TABLE I ‣ IV-A1 City network devices ‣ IV-A IoT Testbed ‣ IV IoT Testbed and Experimental Setup ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Included IoT/IIoT device templates in the testbed scenario.</figcaption>
<table id="S4.T1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.3.1.1" class="ltx_tr">
<th id="S4.T1.3.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt">
<span id="S4.T1.3.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.1.1.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Template name</span></span>
</span>
</th>
<th id="S4.T1.3.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt">
<span id="S4.T1.3.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.1.1.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.1.1.2.1.1.1" class="ltx_text" style="font-size:90%;">Instances</span></span>
</span>
</th>
<th id="S4.T1.3.1.1.3" class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt">
<span id="S4.T1.3.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.1.1.3.1.1" class="ltx_p"><span id="S4.T1.3.1.1.3.1.1.1" class="ltx_text" style="font-size:90%;">Main protocol</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.3.2.1" class="ltx_tr">
<td id="S4.T1.3.2.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.3.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.2.1.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.2.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Air quality</span></span>
</span>
</td>
<td id="S4.T1.3.2.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.3.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.2.1.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.2.1.2.1.1.1" class="ltx_text" style="font-size:90%;">1</span></span>
</span>
</td>
<td id="S4.T1.3.2.1.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S4.T1.3.2.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.2.1.3.1.1" class="ltx_p"><span id="S4.T1.3.2.1.3.1.1.1" class="ltx_text" style="font-size:90%;">MQTT (plain)</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.3.2" class="ltx_tr">
<td id="S4.T1.3.3.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.3.2.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.3.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Building monitor</span></span>
</span>
</td>
<td id="S4.T1.3.3.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.3.2.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.3.2.2.1.1.1" class="ltx_text" style="font-size:90%;">5</span></span>
</span>
</td>
<td id="S4.T1.3.3.2.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.3.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.3.2.3.1.1" class="ltx_p"><span id="S4.T1.3.3.2.3.1.1.1" class="ltx_text" style="font-size:90%;">MQTT (plain)</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.4.3" class="ltx_tr">
<td id="S4.T1.3.4.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.4.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.4.3.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.4.3.1.1.1.1" class="ltx_text" style="font-size:90%;">City power</span></span>
</span>
</td>
<td id="S4.T1.3.4.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.4.3.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.4.3.2.1.1.1" class="ltx_text" style="font-size:90%;">1</span></span>
</span>
</td>
<td id="S4.T1.3.4.3.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.4.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.4.3.3.1.1" class="ltx_p"><span id="S4.T1.3.4.3.3.1.1.1" class="ltx_text" style="font-size:90%;">CoAP (plain)</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.5.4" class="ltx_tr">
<td id="S4.T1.3.5.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.5.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.5.4.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.5.4.1.1.1.1" class="ltx_text" style="font-size:90%;">Combined cycle</span></span>
</span>
</td>
<td id="S4.T1.3.5.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.5.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.5.4.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.5.4.2.1.1.1" class="ltx_text" style="font-size:90%;">10</span></span>
</span>
</td>
<td id="S4.T1.3.5.4.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.5.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.5.4.3.1.1" class="ltx_p"><span id="S4.T1.3.5.4.3.1.1.1" class="ltx_text" style="font-size:90%;">CoAP (plain)</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.6.5" class="ltx_tr">
<td id="S4.T1.3.6.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.6.5.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.6.5.1.1.1.1" class="ltx_text" style="font-size:90%;">Combined cycle tls</span></span>
</span>
</td>
<td id="S4.T1.3.6.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.6.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.6.5.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.6.5.2.1.1.1" class="ltx_text" style="font-size:90%;">5</span></span>
</span>
</td>
<td id="S4.T1.3.6.5.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.6.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.6.5.3.1.1" class="ltx_p"><span id="S4.T1.3.6.5.3.1.1.1" class="ltx_text" style="font-size:90%;">CoAP (DTLS)</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.7.6" class="ltx_tr">
<td id="S4.T1.3.7.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.7.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.7.6.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.7.6.1.1.1.1" class="ltx_text" style="font-size:90%;">Cooler motor</span></span>
</span>
</td>
<td id="S4.T1.3.7.6.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.7.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.7.6.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.7.6.2.1.1.1" class="ltx_text" style="font-size:90%;">15</span></span>
</span>
</td>
<td id="S4.T1.3.7.6.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.7.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.7.6.3.1.1" class="ltx_p"><span id="S4.T1.3.7.6.3.1.1.1" class="ltx_text" style="font-size:90%;">MQTT (plain and TLS)</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.8.7" class="ltx_tr">
<td id="S4.T1.3.8.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.8.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.8.7.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.8.7.1.1.1.1" class="ltx_text" style="font-size:90%;">Domotic monitor</span></span>
</span>
</td>
<td id="S4.T1.3.8.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.8.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.8.7.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.8.7.2.1.1.1" class="ltx_text" style="font-size:90%;">5</span></span>
</span>
</td>
<td id="S4.T1.3.8.7.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.8.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.8.7.3.1.1" class="ltx_p"><span id="S4.T1.3.8.7.3.1.1.1" class="ltx_text" style="font-size:90%;">MQTT (plain)</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.9.8" class="ltx_tr">
<td id="S4.T1.3.9.8.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.9.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.9.8.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.9.8.1.1.1.1" class="ltx_text" style="font-size:90%;">Hydraulic system</span></span>
</span>
</td>
<td id="S4.T1.3.9.8.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.9.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.9.8.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.9.8.2.1.1.1" class="ltx_text" style="font-size:90%;">15</span></span>
</span>
</td>
<td id="S4.T1.3.9.8.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.9.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.9.8.3.1.1" class="ltx_p"><span id="S4.T1.3.9.8.3.1.1.1" class="ltx_text" style="font-size:90%;">MQTT (plan and TLS)</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.10.9" class="ltx_tr">
<td id="S4.T1.3.10.9.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.10.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.10.9.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.10.9.1.1.1.1" class="ltx_text" style="font-size:90%;">IP camera street</span></span>
</span>
</td>
<td id="S4.T1.3.10.9.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.10.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.10.9.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.10.9.2.1.1.1" class="ltx_text" style="font-size:90%;">2</span></span>
</span>
</td>
<td id="S4.T1.3.10.9.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.10.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.10.9.3.1.1" class="ltx_p"><span id="S4.T1.3.10.9.3.1.1.1" class="ltx_text" style="font-size:90%;">RTSP</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.11.10" class="ltx_tr">
<td id="S4.T1.3.11.10.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.11.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.11.10.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.11.10.1.1.1.1" class="ltx_text" style="font-size:90%;">IP camera museum</span></span>
</span>
</td>
<td id="S4.T1.3.11.10.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.11.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.11.10.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.11.10.2.1.1.1" class="ltx_text" style="font-size:90%;">2</span></span>
</span>
</td>
<td id="S4.T1.3.11.10.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.11.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.11.10.3.1.1" class="ltx_p"><span id="S4.T1.3.11.10.3.1.1.1" class="ltx_text" style="font-size:90%;">RTSP</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.12.11" class="ltx_tr">
<td id="S4.T1.3.12.11.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.12.11.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.12.11.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.12.11.1.1.1.1" class="ltx_text" style="font-size:90%;">IP camera consumer</span></span>
</span>
</td>
<td id="S4.T1.3.12.11.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S4.T1.3.12.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.12.11.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.12.11.2.1.1.1" class="ltx_text" style="font-size:90%;">2</span></span>
</span>
</td>
<td id="S4.T1.3.12.11.3" class="ltx_td ltx_align_justify">
<span id="S4.T1.3.12.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.12.11.3.1.1" class="ltx_p"><span id="S4.T1.3.12.11.3.1.1.1" class="ltx_text" style="font-size:90%;">RTSP</span></span>
</span>
</td>
</tr>
<tr id="S4.T1.3.13.12" class="ltx_tr">
<td id="S4.T1.3.13.12.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r">
<span id="S4.T1.3.13.12.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.13.12.1.1.1" class="ltx_p" style="width:147.4pt;"><span id="S4.T1.3.13.12.1.1.1.1" class="ltx_text" style="font-size:90%;">Predictive maintenance</span></span>
</span>
</td>
<td id="S4.T1.3.13.12.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r">
<span id="S4.T1.3.13.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.13.12.2.1.1" class="ltx_p" style="width:56.4pt;"><span id="S4.T1.3.13.12.2.1.1.1" class="ltx_text" style="font-size:90%;">15</span></span>
</span>
</td>
<td id="S4.T1.3.13.12.3" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S4.T1.3.13.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.3.13.12.3.1.1" class="ltx_p"><span id="S4.T1.3.13.12.3.1.1.1" class="ltx_text" style="font-size:90%;">MQTT (plain and TLS)</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.1" class="ltx_p">Each device template presented in Table <a href="#S4.T1" title="TABLE I ‣ IV-A1 City network devices ‣ IV-A IoT Testbed ‣ IV IoT Testbed and Experimental Setup ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> has a distinct behavior. The telemetry payload size (from 10 bytes per payload to more than 7500 bytes per payload), format (JSON, XML, Base64) and periodicity of the communications vary between the templates. The telemetry data is transmitted in plain text for some nodes and over an encrypted channel using TLS or DTLS for other nodes. Some brokers at the cloud network accept unauthenticated clients, while others require clients to be authenticated with a username and a password before sending the data. For the MQTT-based nodes, some templates only publish to a single topic, while others publish to multiple topics. The CoAP-based nodes also serve different numbers of resources, nine for the City power and five resources for the Combined cycle nodes. Regarding data transmission behavior, some devices open a single connection with the cloud at the beginning of the transmission and keep it alive by periodically sending telemetry data and keep-alive messages. Other nodes open a new connection to the cloud, send the data and then close the connection each time they need to send telemetry.</p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.1" class="ltx_p">The Gotham testbed scenario includes a total of 78 instances of those device templates, as shown in Table <a href="#S4.T1" title="TABLE I ‣ IV-A1 City network devices ‣ IV-A IoT Testbed ‣ IV IoT Testbed and Experimental Setup ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>. To increase the heterogeneity, each instance has small random deviations and jitter following a normal distribution in the periodicity of the communications.</p>
</div>
<div id="S4.SS1.SSS1.p4" class="ltx_para">
<p id="S4.SS1.SSS1.p4.1" class="ltx_p">The distributed dataset generated by the testbed is highly non-IID due to all the different client behaviors implemented in it. It primarily includes high feature distribution skew and data quantity skew (all clients do not generate the same amount of data). Additionally, due to the data being network traces, samples can be non-independent. The described behaviors are some of the common ways in which data is non-IID, as described by Kairouz et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS2.4.1.1" class="ltx_text">IV-A</span>2 </span>Cloud network devices</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">The cloud network includes the necessary cloud services to enable communication with the devices in the city and threat networks. The services include many MQTT brokers, CoAP clients and IP camera streaming servers. Additionally, the cloud network includes nodes to provide DNS and NTP services.</p>
</div>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS3.4.1.1" class="ltx_text">IV-A</span>3 </span>Threat network devices</h4>

<div id="S4.SS1.SSS3.p1" class="ltx_para">
<p id="S4.SS1.SSS3.p1.1" class="ltx_p">To launch realistic attacks, the testbed scenario includes three threat actors.</p>
</div>
<section id="S4.SS1.SSS3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Maroni Crime Family</h5>

<div id="S4.SS1.SSS3.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS3.Px1.p1.1" class="ltx_p">It includes the real Mirai <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> malware. All the nodes in this threat actor were created based on the published Mirai source code <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, adapted and compiled to run on the testbed. The nodes include the (i) Mirai bot, (ii) Mirai Command and Control (C&amp;C) server, (iii) Mirai scan listener, (iv) Mirai loader and the (v) Mirai download server. All the nodes in this threat actor allow the execution of the whole Mirai malware lifecycle. We use this threat actor to perform the following attack activities:</p>
</div>
<div id="S4.SS1.SSS3.Px1.p2" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">(A1) Mirai C&amp;C communication</span>: Includes the periodic communication between the Mirai bots and the Mirai C&amp;C server.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">(A2) Mirai network scanning</span>: Each bot infected with Mirai scans the network in a pseudorandom order sending TCP SYN packets to the Telnet 23 and 2323 ports.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">(A3) Mirai brute forcing</span>: If the Mirai scanner detects an open telnet port, it tries to brute force the credentials using a list of common IoT usernames and passwords.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p"><span id="S4.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">(A4) Mirai reporting</span>: After a successful brute forcing, the Mirai bot reports the victim’s IP address, port, username and password to the Mirai scan listener.</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p"><span id="S4.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">(A5) Mirai ingress tool transfer</span>: Includes the infection phase of Mirai. The Mirai loader connects to vulnerable nodes listed in the Mirai scan listener server and proceeds to download and execute the malware.</p>
</div>
</li>
<li id="S4.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i6.p1" class="ltx_para">
<p id="S4.I1.i6.p1.1" class="ltx_p"><span id="S4.I1.i6.p1.1.1" class="ltx_text ltx_font_bold">(A6) Mirai remote command execution</span>: The Mirai bot master connects to the Mirai C&amp;C and sends commands to the bots to perform subsequent DoS attacks against other targets in the network.</p>
</div>
</li>
<li id="S4.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i7.p1" class="ltx_para">
<p id="S4.I1.i7.p1.1" class="ltx_p"><span id="S4.I1.i7.p1.1.1" class="ltx_text ltx_font_bold">(A7) Mirai denial of service attacks</span>: The following list enumerates the performed DoS attacks by the Mirai bots against the targets (it does not include all attack types supported by Mirai): (i) UDP plain attack, (ii) UDP attack, (iii) Valve Source engine attack, (iv) DNS attack, (v) TCP ACK attack, (vi) TCP SYN attack, (vii) GRE IP attack, (viii) GRE Ethernet attack. All attacks were performed for a duration of 10s. All attacks targeted other IoT devices in the city network, except for the DNS attack, which targeted the DNS server at the cloud network.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S4.SS1.SSS3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Falcone Crime Family</h5>

<div id="S4.SS1.SSS3.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS3.Px2.p1.1" class="ltx_p">This threat actor includes the Merlin <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite> cross-platform post-exploitation C&amp;C server, the Merlin agents and the hping3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> TCP/IP packet assembler and analyzer. The Merlin server supports multiple protocols for C&amp;C (HTTP/1.1 clear-text, HTTP/1.1 over TLS, HTTP/2, HTTP/2 clear-text (h2c), HTTP/3) and can execute code on the victims under its control. When a victim device is compromised with the Merlin agent, it starts communicating with the Merlin C&amp;C and becomes part of its botnet. We use this threat actor to perform the following attacks:</p>
</div>
<div id="S4.SS1.SSS3.Px2.p2" class="ltx_para">
<ul id="S4.I2" class="ltx_itemize">
<li id="S4.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i1.p1" class="ltx_para">
<p id="S4.I2.i1.p1.1" class="ltx_p"><span id="S4.I2.i1.p1.1.1" class="ltx_text ltx_font_bold">(A8) Merlin C&amp;C communication</span>: Periodic communication between the IoT nodes infected with the Merlin agent and the Merlin C&amp;C server.</p>
</div>
</li>
<li id="S4.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i2.p1" class="ltx_para">
<p id="S4.I2.i2.p1.1" class="ltx_p"><span id="S4.I2.i2.p1.1.1" class="ltx_text ltx_font_bold">(A9) Merlin ingress tool transfer</span>: The Merlin C&amp;C server transfers the hping3 binary into each of the compromised victims through the C&amp;C channel.</p>
</div>
</li>
<li id="S4.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i3.p1" class="ltx_para">
<p id="S4.I2.i3.p1.1" class="ltx_p"><span id="S4.I2.i3.p1.1.1" class="ltx_text ltx_font_bold">(A10) Merlin remote command execution</span>: The Merlin bot master connects to the Merlin C&amp;C and sends commands to the bots to perform subsequent DoS attacks against other targets in the network.</p>
</div>
</li>
<li id="S4.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i4.p1" class="ltx_para">
<p id="S4.I2.i4.p1.1" class="ltx_p"><span id="S4.I2.i4.p1.1.1" class="ltx_text ltx_font_bold">(A11) Merlin denial of service attacks</span>: The DoS attacks are implemented using hping3: (i) ICMP echo-request, (ii) UDP, (iii) TCP SYN and (iv) TCP ACK flood attacks. Each attack generates approximately 5000 packets at a 1 ms/packet rate. The UDP flood payload consists of 512 bytes of random data, with TTL set to 64 and TOS to 0, which corresponds to the default values for the UDP attack in Mirai.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S4.SS1.SSS3.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Calabrese Crime Family</h5>

<div id="S4.SS1.SSS3.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS3.Px3.p1.1" class="ltx_p">It includes many nodes performing network-wide scanning operations and launching attacks against the devices. It is comprised of nodes that include the Nmap and Masscan scanners and the AMP-Research tool for implementing amplification attacks against the CoAP servers. We use this threat actor to perform the following attacks:</p>
</div>
<div id="S4.SS1.SSS3.Px3.p2" class="ltx_para">
<ul id="S4.I3" class="ltx_itemize">
<li id="S4.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i1.p1" class="ltx_para">
<p id="S4.I3.i1.p1.1" class="ltx_p"><span id="S4.I3.i1.p1.1.1" class="ltx_text ltx_font_bold">(A12) Network-wide scans</span>: Masscan is used to scan the city network for the TCP ports 80,8000-8100,5683 at three different packet rates: (i) 100, (ii) 1000 and (iii) 10000 packets/s. Nmap is used to scan some IoT nodes to check for open UDP ports using three strategies: (iv) the 5683 port, (v) 600 random ports and (vi) the 1000 most used UDP ports.</p>
</div>
</li>
<li id="S4.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i2.p1" class="ltx_para">
<p id="S4.I3.i2.p1.1" class="ltx_p"><span id="S4.I3.i2.p1.1.1" class="ltx_text ltx_font_bold">(A13) CoAP amplification attack</span>: The attacker leverages a CoAP device in the city network to launch an amplification attack against a victim for a duration of 10s.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Data Generation and Collection Method</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The Gotham testbed allows the capturing of network traffic traces for dataset generation. The data captured under normal traffic conditions (without attacks) will be used to train the clustered FL anomaly detection models. Then, the validation data is captured, consisting of two sets: validation-normal and validation-attack. The validation-attack is further divided into different datasets depending on the attack scenario.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">All this data is captured in a federated way. Each device holds its own part of the data (captured on its network interface), as shown in Figure <a href="#S3.F1" title="Figure 1 ‣ III-A Deployment Setting and Architecture ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. This data is never aggregated into a single dataset.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS1.4.1.1" class="ltx_text">IV-B</span>1 </span>Normal traffic data</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">This data is composed of the normal behavior of the city network IoT/IIoT devices periodically communicating the telemetry and background data with the cloud. Network packet traces are collected for each device and saved in pcap format while the scenario runs without any attack. This dataset will be used for feature preprocessing, hyperparameter selection and the clustered FL training.</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p">The normal traffic data has been captured in a period including the first two hours (the first hour for the IP camera related devices, due to the high data volume they create), generating a total of 3.3 GB of raw packet data for all the 78 devices in the network.</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS2.4.1.1" class="ltx_text">IV-B</span>2 </span>Validation-normal traffic data</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">The validation-normal dataset consists of traces including only the normal behavior of the city network devices captured with the same methodology from the previously described normal dataset. However, it is extracted later so that it does not include the same events. It includes captures over a two-hour period (one hour for the IP cameras) starting after the end of the normal traffic capture. This data is not used during training; it will only be used for the anomaly threshold selection.</p>
</div>
</section>
<section id="S4.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS3.4.1.1" class="ltx_text">IV-B</span>3 </span>Validation-attack traffic data</h4>

<div id="S4.SS2.SSS3.p1" class="ltx_para">
<p id="S4.SS2.SSS3.p1.1" class="ltx_p">While the city network devices are performing their normal activities, the attacker nodes become active and start launching the previously mentioned attacks against the city network IoT/IIoT devices. The validation-attack traffic data is captured during this period and consists of both normal and attacking traces.</p>
</div>
<div id="S4.SS2.SSS3.p2" class="ltx_para">
<p id="S4.SS2.SSS3.p2.1" class="ltx_p">We configure the testbed’s three threat actors to create five attacking scenarios. For each scenario, we extract network packet captures from the city network devices.</p>
</div>
<section id="S4.SS2.SSS3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">validation-attack-mirai-scan-load</h5>

<div id="S4.SS2.SSS3.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS3.Px1.p1.1" class="ltx_p">Some city network devices are first configured to make them vulnerable to Mirai, as detailed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. The testbed’s Mirai bot node is activated (<span id="S4.SS2.SSS3.Px1.p1.1.1" class="ltx_text ltx_font_bold">A1</span>) and starts scanning all city network devices (<span id="S4.SS2.SSS3.Px1.p1.1.2" class="ltx_text ltx_font_bold">A2</span>). When vulnerable devices are identified, the Mirai bot performs the (<span id="S4.SS2.SSS3.Px1.p1.1.3" class="ltx_text ltx_font_bold">A3</span>) and (<span id="S4.SS2.SSS3.Px1.p1.1.4" class="ltx_text ltx_font_bold">A4</span>) activities. After a vulnerable device is reported, the (<span id="S4.SS2.SSS3.Px1.p1.1.5" class="ltx_text ltx_font_bold">A5</span>) activity is performed to integrate the device into the botnet. After becoming part of the botnet, the device repeats the described Mirai lifecycle.</p>
</div>
</section>
<section id="S4.SS2.SSS3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">validation-attack-mirai-cnc-dos</h5>

<div id="S4.SS2.SSS3.Px2.p1" class="ltx_para">
<p id="S4.SS2.SSS3.Px2.p1.1" class="ltx_p">This data also includes Mirai malware activity, but in this case, we recompile the Mirai bot binary to disable the scanning and brute-forcing modules. This modification is done to make Mirai stealthier. The modified Mirai bot is manually installed in some city network devices. After executing the bot, the C&amp;C communication activity starts (<span id="S4.SS2.SSS3.Px2.p1.1.1" class="ltx_text ltx_font_bold">A1</span>). By connecting to the Mirai C&amp;C server, we command each bot (<span id="S4.SS2.SSS3.Px2.p1.1.2" class="ltx_text ltx_font_bold">A6</span>) to launch multiple DoS attacks (<span id="S4.SS2.SSS3.Px2.p1.1.3" class="ltx_text ltx_font_bold">A7</span>) against random targets in the testbed.</p>
</div>
</section>
<section id="S4.SS2.SSS3.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">validation-attack-merlin-cnc-dos</h5>

<div id="S4.SS2.SSS3.Px3.p1" class="ltx_para">
<p id="S4.SS2.SSS3.Px3.p1.1" class="ltx_p">The Merlin agent is installed in some city network devices. After executing the agents, they connect to the Merlin server (<span id="S4.SS2.SSS3.Px3.p1.1.1" class="ltx_text ltx_font_bold">A8</span>). For each bot, the Merlin server performs (<span id="S4.SS2.SSS3.Px3.p1.1.2" class="ltx_text ltx_font_bold">A9</span>) and (<span id="S4.SS2.SSS3.Px3.p1.1.3" class="ltx_text ltx_font_bold">A10</span>). Finally, each bot is instructed to launch DoS attacks (<span id="S4.SS2.SSS3.Px3.p1.1.4" class="ltx_text ltx_font_bold">A11</span>) against random targets in the testbed.</p>
</div>
</section>
<section id="S4.SS2.SSS3.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">validation-attack-masscan</h5>

<div id="S4.SS2.SSS3.Px4.p1" class="ltx_para">
<p id="S4.SS2.SSS3.Px4.p1.1" class="ltx_p">Network traffic data is captured from the city network devices while they are being scanned by the Masscan node (<span id="S4.SS2.SSS3.Px4.p1.1.1" class="ltx_text ltx_font_bold">A12</span>).</p>
</div>
</section>
<section id="S4.SS2.SSS3.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">validation-attack-scan-amplification</h5>

<div id="S4.SS2.SSS3.Px5.p1" class="ltx_para">
<p id="S4.SS2.SSS3.Px5.p1.1" class="ltx_p">This data is captured on the CoAP-based city network devices. First, Nmap is used to scan the network (<span id="S4.SS2.SSS3.Px5.p1.1.1" class="ltx_text ltx_font_bold">A12</span>) to search for CoAP devices; then, those devices are leveraged to perform (<span id="S4.SS2.SSS3.Px5.p1.1.2" class="ltx_text ltx_font_bold">A13</span>) attacks against random targets in the testbed.</p>
</div>
</section>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.4.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.5.2" class="ltx_text ltx_font_italic">Machine Learning and Federated Learning Setup</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We used the PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> Python library to implement the ML models and training procedures. The FL model aggregation (the <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_smallcaps">ServerOpt</span> server-side optimization) is also implemented using the PyTorch library directly. For the client’s local training process, we used GNU Parallel <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite> to coordinate and execute all the jobs in parallel. We implemented the clustering algorithms, validation metrics, dimensionality reduction, etc. with scikit-learn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Implementation</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This section will describe the methodology followed to perform the experimentation. A visual representation of all the steps is shown in Figure <a href="#S5.F2" title="Figure 2 ‣ V Implementation ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We first explain the network data processing step, which includes filtering, feature extraction and preprocessing. Then, we detail the autoencoder model selection procedure. Next, we describe the implementation for the clustered FL process, starting from the model fingerprinting for device clustering, followed by the federated hyperparameter tuning and then the FL training process for each identified cluster. Finally, we review the trained models’ anomaly detection evaluation process and metrics. We additionally explain the baseline comparisons done with other state-of-the-art IDS methods.</p>
</div>
<figure id="S5.F2" class="ltx_figure"><img src="/html/2303.15986/assets/x2.png" id="S5.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="86" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Implementation method pipeline.</figcaption>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.4.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.5.2" class="ltx_text ltx_font_italic">Network Data Processing</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">After collecting the dataset, the raw pcap files are first filtered, then relevant network features are selected, and finally, those features are preprocessed to make them suitable as input to the ML models. Note that the dataset is federated and not centralized; each device holds its fraction of data.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">The first step consists of filtering the raw pcap files to drop all IPv6 and ARP packets. The filtered packets are passed to the feature extraction process. For each network packet in the filtered pcap file, a set of 11 features are extracted as listed in Table <a href="#S5.T2" title="TABLE II ‣ V-A Network Data Processing ‣ V Implementation ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. The source and destination IP addresses were discarded to prevent the model from learning the machines themselves instead of the attacking nature. The main reason for using those features is that attacking patterns from IoT malware such as Mirai includes options to craft packets with tweaked values for the payload size, IP header fields, and TCP flags, among others <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Additionally, the attack packet payload usually includes randomized or some fixed values that can lead to high or low entropy. By selecting those features and training on the normal traffic dataset, the model learns the distribution of normal IoT communication. Deviations from it (large MSE between the input and the autoencoder reconstructed output) allows to potentially detect not only Mirai but, in general, other malware with similar network attacking behavior and C&amp;C communication like the attacks performed with hping3 and Merlin C&amp;C as described in the previous section.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">Due to the different orders of magnitude of some features and the mixture of both numerical and categorical variables, a feature preprocessing step is necessary before using them as inputs for the ML models.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Selected packet feature names and descriptions.</figcaption>
<table id="S5.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.3.1.1" class="ltx_tr">
<th id="S5.T2.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="S5.T2.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Feature name</span></th>
<th id="S5.T2.3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Description</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.3.2.1" class="ltx_tr">
<td id="S5.T2.3.2.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S5.T2.3.2.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">len</span></td>
<td id="S5.T2.3.2.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.3.2.1.2.1" class="ltx_text" style="font-size:90%;">Full packet length in bytes.</span></td>
</tr>
<tr id="S5.T2.3.3.2" class="ltx_tr">
<td id="S5.T2.3.3.2.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.3.2.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">iat</span></td>
<td id="S5.T2.3.3.2.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.3.2.2.1" class="ltx_text" style="font-size:90%;">Inter arrival time from the previous packet.</span></td>
</tr>
<tr id="S5.T2.3.4.3" class="ltx_tr">
<td id="S5.T2.3.4.3.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.4.3.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">h</span></td>
<td id="S5.T2.3.4.3.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.4.3.2.1" class="ltx_text" style="font-size:90%;">Entropy (base 2) of the full packet.</span></td>
</tr>
<tr id="S5.T2.3.5.4" class="ltx_tr">
<td id="S5.T2.3.5.4.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.5.4.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">ip_tos</span></td>
<td id="S5.T2.3.5.4.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.5.4.2.1" class="ltx_text" style="font-size:90%;">IP type of service.</span></td>
</tr>
<tr id="S5.T2.3.6.5" class="ltx_tr">
<td id="S5.T2.3.6.5.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.6.5.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">ip_flags</span></td>
<td id="S5.T2.3.6.5.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.6.5.2.1" class="ltx_text" style="font-size:90%;">IP flags (MF, DF, R bits).</span></td>
</tr>
<tr id="S5.T2.3.7.6" class="ltx_tr">
<td id="S5.T2.3.7.6.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.7.6.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">ip_ttl</span></td>
<td id="S5.T2.3.7.6.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.7.6.2.1" class="ltx_text" style="font-size:90%;">IP time to live.</span></td>
</tr>
<tr id="S5.T2.3.8.7" class="ltx_tr">
<td id="S5.T2.3.8.7.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.8.7.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">ip_proto</span></td>
<td id="S5.T2.3.8.7.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.8.7.2.1" class="ltx_text" style="font-size:90%;">IP protocol (TCP, UDP, ICMP).</span></td>
</tr>
<tr id="S5.T2.3.9.8" class="ltx_tr">
<td id="S5.T2.3.9.8.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.9.8.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">src_port</span></td>
<td id="S5.T2.3.9.8.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.9.8.2.1" class="ltx_text" style="font-size:90%;">Source port number.</span></td>
</tr>
<tr id="S5.T2.3.10.9" class="ltx_tr">
<td id="S5.T2.3.10.9.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.10.9.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">dst_port</span></td>
<td id="S5.T2.3.10.9.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.10.9.2.1" class="ltx_text" style="font-size:90%;">Destination port number.</span></td>
</tr>
<tr id="S5.T2.3.11.10" class="ltx_tr">
<td id="S5.T2.3.11.10.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.3.11.10.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">tcp_flags</span></td>
<td id="S5.T2.3.11.10.2" class="ltx_td ltx_align_left"><span id="S5.T2.3.11.10.2.1" class="ltx_text" style="font-size:90%;">TCP flags (F, S, R, P, A, U, E, C, N).</span></td>
</tr>
<tr id="S5.T2.3.12.11" class="ltx_tr">
<td id="S5.T2.3.12.11.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S5.T2.3.12.11.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">tcp_win</span></td>
<td id="S5.T2.3.12.11.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.3.12.11.2.1" class="ltx_text" style="font-size:90%;">TCP window size.</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">The numerical features are normalized by the maximum value of each field defined in the TCP/IP stack. <span id="S5.SS1.p4.1.1" class="ltx_text ltx_font_typewriter">len</span> is divided by 1514 (the Ethernet maximum transmission unit plus the header), both <span id="S5.SS1.p4.1.2" class="ltx_text ltx_font_typewriter">ip_tos</span> and <span id="S5.SS1.p4.1.3" class="ltx_text ltx_font_typewriter">ip_ttl</span> are divided by 255 and <span id="S5.SS1.p4.1.4" class="ltx_text ltx_font_typewriter">tcp_win</span> is divided by 65535. <span id="S5.SS1.p4.1.5" class="ltx_text ltx_font_typewriter">h</span> is divided by 8 and <span id="S5.SS1.p4.1.6" class="ltx_text ltx_font_typewriter">iat</span> is transformed with the natural logarithm of <span id="S5.SS1.p4.1.7" class="ltx_text ltx_font_typewriter">iat</span> plus one. The categorical variables <span id="S5.SS1.p4.1.8" class="ltx_text ltx_font_typewriter">ip_flags</span>, <span id="S5.SS1.p4.1.9" class="ltx_text ltx_font_typewriter">ip_proto</span> and <span id="S5.SS1.p4.1.10" class="ltx_text ltx_font_typewriter">tcp_flags</span> are directly one-hot encoded.</p>
</div>
<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS1.SSS1.4.1.1" class="ltx_text">V-A</span>1 </span>Source and destination port feature processing</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.p1.1" class="ltx_p">The <span id="S5.SS1.SSS1.p1.1.1" class="ltx_text ltx_font_typewriter">src_port</span> and <span id="S5.SS1.SSS1.p1.1.2" class="ltx_text ltx_font_typewriter">dst_port</span> feature processing requires special consideration. The application port numbers are numerical features that can take <math id="S5.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="2^{16}" display="inline"><semantics id="S5.SS1.SSS1.p1.1.m1.1a"><msup id="S5.SS1.SSS1.p1.1.m1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.SSS1.p1.1.m1.1.1.2" xref="S5.SS1.SSS1.p1.1.m1.1.1.2.cmml">2</mn><mn id="S5.SS1.SSS1.p1.1.m1.1.1.3" xref="S5.SS1.SSS1.p1.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.1.m1.1b"><apply id="S5.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S5.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1.2">2</cn><cn type="integer" id="S5.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.1.m1.1c">2^{16}</annotation></semantics></math> different integer values; however, treating the ports just as a numerical feature does not maintain the semantics of the services that use those port numbers. In other words, port numbers that are numerically close to each other does not mean that the programs that communicate with those ports are used to perform similar tasks.</p>
</div>
<div id="S5.SS1.SSS1.p2" class="ltx_para">
<p id="S5.SS1.SSS1.p2.1" class="ltx_p">In this work, we are going to discretize the source and destination port numbers into a smaller number of bins using two different strategies: three-range discretization and hierarchical discretization. After the discretization, the bin numbers are one-hot encoded. In section <a href="#S6" title="VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>, we will evaluate the differences between the two strategies and select the most appropriate one for this use case.</p>
</div>
<section id="S5.SS1.SSS1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Three-range discretization</h5>

<div id="S5.SS1.SSS1.Px1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.Px1.p1.1" class="ltx_p">The source and destination port numbers are divided into the three ranges assigned by the Internet Assigned Numbers Authority (IANA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>: the System Ports, or Well Known Ports, from 0 to 1023; the User Ports, or Registered Ports, from 1024 to 49151; and the Dynamic Ports, or Ephemeral Ports, from 49152 to 65535. These ranges are large, and might not capture the semantics of the ports.</p>
</div>
<div id="S5.SS1.SSS1.Px1.p2" class="ltx_para">
<p id="S5.SS1.SSS1.Px1.p2.1" class="ltx_p">After all the previously mentioned transformations and using the three-range discretization for the source and destination ports, the 11 features of Table <a href="#S5.T2" title="TABLE II ‣ V-A Network Data Processing ‣ V Implementation ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> are transformed into a set of 27 features.</p>
</div>
</section>
<section id="S5.SS1.SSS1.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Hierarchical discretization</h5>

<div id="S5.SS1.SSS1.Px2.p1" class="ltx_para">
<p id="S5.SS1.SSS1.Px2.p1.1" class="ltx_p">The source and destination port numbers are discretized based on the generalization hierarchy presented in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite> and adapted to include information about the MQTT, CoAP and RTSP ports used in the testbed. The hierarchy used is summarized in Table <a href="#S5.T3" title="TABLE III ‣ Hierarchical discretization ‣ V-A1 Source and destination port feature processing ‣ V-A Network Data Processing ‣ V Implementation ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. When classifying a port number, bins from the top of the table have precedence over the bins from the bottom.</p>
</div>
<div id="S5.SS1.SSS1.Px2.p2" class="ltx_para">
<p id="S5.SS1.SSS1.Px2.p2.1" class="ltx_p">After all the previously mentioned transformations and using the hierarchical discretization for the source and destination ports, the 11 features of Table <a href="#S5.T2" title="TABLE II ‣ V-A Network Data Processing ‣ V Implementation ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> are transformed into a set of 69 features.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Port number generalization hierarchy.</figcaption>
<table id="S5.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.3.1.1" class="ltx_tr">
<th id="S5.T3.3.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt">
<span id="S5.T3.3.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.1.1.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Bin name</span></span>
</span>
</th>
<th id="S5.T3.3.1.1.2" class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt">
<span id="S5.T3.3.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.1.1.2.1.1" class="ltx_p"><span id="S5.T3.3.1.1.2.1.1.1" class="ltx_text" style="font-size:90%;">Ports</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.3.2.1" class="ltx_tr">
<td id="S5.T3.3.2.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S5.T3.3.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.2.1.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.2.1.1.1.1.1" class="ltx_text" style="font-size:90%;">mqttPorts</span></span>
</span>
</td>
<td id="S5.T3.3.2.1.2" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S5.T3.3.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.2.1.2.1.1" class="ltx_p"><span id="S5.T3.3.2.1.2.1.1.1" class="ltx_text" style="font-size:90%;">1883, 8883</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.3.2" class="ltx_tr">
<td id="S5.T3.3.3.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.3.2.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.3.2.1.1.1.1" class="ltx_text" style="font-size:90%;">coapPorts</span></span>
</span>
</td>
<td id="S5.T3.3.3.2.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.3.2.2.1.1" class="ltx_p"><span id="S5.T3.3.3.2.2.1.1.1" class="ltx_text" style="font-size:90%;">5683, 5684</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.4.3" class="ltx_tr">
<td id="S5.T3.3.4.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.4.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.4.3.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.4.3.1.1.1.1" class="ltx_text" style="font-size:90%;">rtspPorts</span></span>
</span>
</td>
<td id="S5.T3.3.4.3.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.4.3.2.1.1" class="ltx_p"><span id="S5.T3.3.4.3.2.1.1.1" class="ltx_text" style="font-size:90%;">8554, 8322, 8000 – 8003, 1935, 8888</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.5.4" class="ltx_tr">
<td id="S5.T3.3.5.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.5.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.5.4.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.5.4.1.1.1.1" class="ltx_text" style="font-size:90%;">httpPorts</span></span>
</span>
</td>
<td id="S5.T3.3.5.4.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.5.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.5.4.2.1.1" class="ltx_p"><span id="S5.T3.3.5.4.2.1.1.1" class="ltx_text" style="font-size:90%;">80, 280, 443, 591, 593, 777, 488, 1183, 1184, 2069, 2301, 2381, 8008, 8080</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.6.5" class="ltx_tr">
<td id="S5.T3.3.6.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.6.5.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.6.5.1.1.1.1" class="ltx_text" style="font-size:90%;">mailPorts</span></span>
</span>
</td>
<td id="S5.T3.3.6.5.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.6.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.6.5.2.1.1" class="ltx_p"><span id="S5.T3.3.6.5.2.1.1.1" class="ltx_text" style="font-size:90%;">24, 25, 50, 58, 61, 109, 110, 143, 158, 174, 209, 220, 406, 512, 585, 993, 995</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.7.6" class="ltx_tr">
<td id="S5.T3.3.7.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.7.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.7.6.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.7.6.1.1.1.1" class="ltx_text" style="font-size:90%;">dnsPorts</span></span>
</span>
</td>
<td id="S5.T3.3.7.6.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.7.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.7.6.2.1.1" class="ltx_p"><span id="S5.T3.3.7.6.2.1.1.1" class="ltx_text" style="font-size:90%;">42, 53, 81, 101, 105, 261</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.8.7" class="ltx_tr">
<td id="S5.T3.3.8.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.8.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.8.7.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.8.7.1.1.1.1" class="ltx_text" style="font-size:90%;">ftpPorts</span></span>
</span>
</td>
<td id="S5.T3.3.8.7.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.8.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.8.7.2.1.1" class="ltx_p"><span id="S5.T3.3.8.7.2.1.1.1" class="ltx_text" style="font-size:90%;">20, 21, 47, 69, 115, 152, 189, 349, 574, 662, 989, 990</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.9.8" class="ltx_tr">
<td id="S5.T3.3.9.8.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.9.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.9.8.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.9.8.1.1.1.1" class="ltx_text" style="font-size:90%;">shellPorts</span></span>
</span>
</td>
<td id="S5.T3.3.9.8.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.9.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.9.8.2.1.1" class="ltx_p"><span id="S5.T3.3.9.8.2.1.1.1" class="ltx_text" style="font-size:90%;">22, 23, 59, 87, 89, 107, 211, 221, 222, 513, 614, 759, 992</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.10.9" class="ltx_tr">
<td id="S5.T3.3.10.9.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.10.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.10.9.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.10.9.1.1.1.1" class="ltx_text" style="font-size:90%;">remoteExecPorts</span></span>
</span>
</td>
<td id="S5.T3.3.10.9.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.10.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.10.9.2.1.1" class="ltx_p"><span id="S5.T3.3.10.9.2.1.1.1" class="ltx_text" style="font-size:90%;">512, 514</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.11.10" class="ltx_tr">
<td id="S5.T3.3.11.10.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.11.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.11.10.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.11.10.1.1.1.1" class="ltx_text" style="font-size:90%;">authPorts</span></span>
</span>
</td>
<td id="S5.T3.3.11.10.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.11.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.11.10.2.1.1" class="ltx_p"><span id="S5.T3.3.11.10.2.1.1.1" class="ltx_text" style="font-size:90%;">13, 56, 113, 316, 353, 370, 749, 750</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.12.11" class="ltx_tr">
<td id="S5.T3.3.12.11.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.12.11.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.12.11.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.12.11.1.1.1.1" class="ltx_text" style="font-size:90%;">passwordPorts</span></span>
</span>
</td>
<td id="S5.T3.3.12.11.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.12.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.12.11.2.1.1" class="ltx_p"><span id="S5.T3.3.12.11.2.1.1.1" class="ltx_text" style="font-size:90%;">229, 464, 586, 774</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.13.12" class="ltx_tr">
<td id="S5.T3.3.13.12.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.13.12.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.13.12.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.13.12.1.1.1.1" class="ltx_text" style="font-size:90%;">newsPorts</span></span>
</span>
</td>
<td id="S5.T3.3.13.12.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.13.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.13.12.2.1.1" class="ltx_p"><span id="S5.T3.3.13.12.2.1.1.1" class="ltx_text" style="font-size:90%;">114, 119, 532, 563</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.14.13" class="ltx_tr">
<td id="S5.T3.3.14.13.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.14.13.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.14.13.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.14.13.1.1.1.1" class="ltx_text" style="font-size:90%;">chatPorts</span></span>
</span>
</td>
<td id="S5.T3.3.14.13.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.14.13.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.14.13.2.1.1" class="ltx_p"><span id="S5.T3.3.14.13.2.1.1.1" class="ltx_text" style="font-size:90%;">194, 258, 531, 994</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.15.14" class="ltx_tr">
<td id="S5.T3.3.15.14.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.15.14.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.15.14.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.15.14.1.1.1.1" class="ltx_text" style="font-size:90%;">printPorts</span></span>
</span>
</td>
<td id="S5.T3.3.15.14.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.15.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.15.14.2.1.1" class="ltx_p"><span id="S5.T3.3.15.14.2.1.1.1" class="ltx_text" style="font-size:90%;">35, 92, 170, 515, 631</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.16.15" class="ltx_tr">
<td id="S5.T3.3.16.15.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.16.15.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.16.15.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.16.15.1.1.1.1" class="ltx_text" style="font-size:90%;">timePorts</span></span>
</span>
</td>
<td id="S5.T3.3.16.15.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.16.15.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.16.15.2.1.1" class="ltx_p"><span id="S5.T3.3.16.15.2.1.1.1" class="ltx_text" style="font-size:90%;">13, 37, 52, 123, 519, 525</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.17.16" class="ltx_tr">
<td id="S5.T3.3.17.16.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.17.16.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.17.16.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.17.16.1.1.1.1" class="ltx_text" style="font-size:90%;">dbmsPorts</span></span>
</span>
</td>
<td id="S5.T3.3.17.16.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.17.16.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.17.16.2.1.1" class="ltx_p"><span id="S5.T3.3.17.16.2.1.1.1" class="ltx_text" style="font-size:90%;">65, 66, 118, 150, 156, 217</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.18.17" class="ltx_tr">
<td id="S5.T3.3.18.17.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.18.17.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.18.17.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.18.17.1.1.1.1" class="ltx_text" style="font-size:90%;">dhcpPorts</span></span>
</span>
</td>
<td id="S5.T3.3.18.17.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.18.17.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.18.17.2.1.1" class="ltx_p"><span id="S5.T3.3.18.17.2.1.1.1" class="ltx_text" style="font-size:90%;">546, 547, 647, 847</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.19.18" class="ltx_tr">
<td id="S5.T3.3.19.18.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.19.18.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.19.18.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.19.18.1.1.1.1" class="ltx_text" style="font-size:90%;">whoisPorts</span></span>
</span>
</td>
<td id="S5.T3.3.19.18.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.19.18.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.19.18.2.1.1" class="ltx_p"><span id="S5.T3.3.19.18.2.1.1.1" class="ltx_text" style="font-size:90%;">43, 63</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.20.19" class="ltx_tr">
<td id="S5.T3.3.20.19.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.20.19.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.20.19.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.20.19.1.1.1.1" class="ltx_text" style="font-size:90%;">netbiosPorts</span></span>
</span>
</td>
<td id="S5.T3.3.20.19.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.20.19.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.20.19.2.1.1" class="ltx_p"><span id="S5.T3.3.20.19.2.1.1.1" class="ltx_text" style="font-size:90%;">137 – 139</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.21.20" class="ltx_tr">
<td id="S5.T3.3.21.20.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.21.20.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.21.20.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.21.20.1.1.1.1" class="ltx_text" style="font-size:90%;">kerberosPorts</span></span>
</span>
</td>
<td id="S5.T3.3.21.20.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.21.20.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.21.20.2.1.1" class="ltx_p"><span id="S5.T3.3.21.20.2.1.1.1" class="ltx_text" style="font-size:90%;">88, 748, 750</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.22.21" class="ltx_tr">
<td id="S5.T3.3.22.21.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.22.21.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.22.21.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.22.21.1.1.1.1" class="ltx_text" style="font-size:90%;">RPCPorts</span></span>
</span>
</td>
<td id="S5.T3.3.22.21.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.22.21.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.22.21.2.1.1" class="ltx_p"><span id="S5.T3.3.22.21.2.1.1.1" class="ltx_text" style="font-size:90%;">111, 121, 369, 530, 567, 593, 602</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.23.22" class="ltx_tr">
<td id="S5.T3.3.23.22.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.23.22.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.23.22.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.23.22.1.1.1.1" class="ltx_text" style="font-size:90%;">snmpPorts</span></span>
</span>
</td>
<td id="S5.T3.3.23.22.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.23.22.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.23.22.2.1.1" class="ltx_p"><span id="S5.T3.3.23.22.2.1.1.1" class="ltx_text" style="font-size:90%;">161, 162, 391</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.24.23" class="ltx_tr">
<td id="S5.T3.3.24.23.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r">
<span id="S5.T3.3.24.23.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.24.23.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.24.23.1.1.1.1" class="ltx_text" style="font-size:90%;">privilegedPorts</span></span>
</span>
</td>
<td id="S5.T3.3.24.23.2" class="ltx_td ltx_align_justify">
<span id="S5.T3.3.24.23.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.24.23.2.1.1" class="ltx_p"><span id="S5.T3.3.24.23.2.1.1.1" class="ltx_text" style="font-size:90%;">0 – 1023</span></span>
</span>
</td>
</tr>
<tr id="S5.T3.3.25.24" class="ltx_tr">
<td id="S5.T3.3.25.24.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r">
<span id="S5.T3.3.25.24.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.25.24.1.1.1" class="ltx_p" style="width:117.1pt;"><span id="S5.T3.3.25.24.1.1.1.1" class="ltx_text" style="font-size:90%;">nonprivilegedPorts</span></span>
</span>
</td>
<td id="S5.T3.3.25.24.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S5.T3.3.25.24.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.3.25.24.2.1.1" class="ltx_p"><span id="S5.T3.3.25.24.2.1.1.1" class="ltx_text" style="font-size:90%;">1024 – 65535</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.4.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.5.2" class="ltx_text ltx_font_italic">Autoencoder Model Selection</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.5" class="ltx_p">In FL, there is a much larger set of hyperparameters to be tuned compared to a typical centralized ML setting. Those parameters include the ML model itself (number of layers, number of nodes per layer, activation functions, etc.), client-side optimizer algorithm <span id="S5.SS2.p1.5.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and learning rate <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\eta</annotation></semantics></math>, server-side optimizer algorithm <span id="S5.SS2.p1.5.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> and learning rate <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><msub id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">η</mi><mi id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2">𝜂</ci><ci id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\eta_{s}</annotation></semantics></math>, number of local training epochs <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">E</annotation></semantics></math>, number of FL rounds <math id="S5.SS2.p1.4.m4.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S5.SS2.p1.4.m4.1a"><mi id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><ci id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">R</annotation></semantics></math> and number of clients sampled per FL round <math id="S5.SS2.p1.5.m5.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S5.SS2.p1.5.m5.1a"><mi id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><ci id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">M</annotation></semantics></math>. Due to the infeasibility to explore all the combinations simultaneously, we are going to simplify the search tuning those hyperparameters step by step using different subsets of combinations. Additionally, considering the unsupervised nature of the problem (or rather semi-supervised, given that it is trained on normal data without attacks), the selection is going to be based on those values that minimize the MSE loss in fewer rounds/epochs.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">First, we start defining the general architecture of the autoencoder. We select a small subset of the normal traffic data (corresponding to various IoT clients) and use it to explore different autoencoder models. This exploration is not performed in a federated way. Each dataset is partitioned into 80% training and 20% evaluation. Among the tested models, we selected the simplest one (fewer parameters) that produced low enough evaluation loss to minimize overfitting problems.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.2" class="ltx_p">Regarding the minimization of overfitting problems, the autoencoder training loss function includes a <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><msub id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml">L</mi><mn id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">L_{2}</annotation></semantics></math> regularization term controlled by the <math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><mi id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><ci id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">\lambda</annotation></semantics></math> parameter, as noted in equation (<a href="#S3.E2" title="In III-D Anomaly Detection Model ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). The regularization directs the training in such a way as to make the model parameters smaller and prevent a single or few features from having too much weight in the model prediction results. While the autoencoder model selection step is performed in a non federated way, the final FL training process of the following steps can also have added advantages for preventing overfitting problems. According to McMahan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>, one of the benefits of model averaging in FL is that it produces a regularization effect similar to the one achieved by dropout. In this case, FL helps to mitigate the overfitting problems that can occur in clients with fewer training data samples.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p">The number of nodes for the input and output layer of the autoencoder is fixed to the same number as the input feature dimensions (which can be 27 or 69, depending on the discretization method for the source and destination ports). For the encoder part, we evaluated different combinations with 1, 2 and 3 hidden layers, with each following layer having half as many nodes as the previous one <math id="S5.SS2.p4.1.m1.1" class="ltx_Math" alttext="\lfloor\frac{\text{\# nodes previous layer}}{2}\rfloor" display="inline"><semantics id="S5.SS2.p4.1.m1.1a"><mrow id="S5.SS2.p4.1.m1.1.2.2" xref="S5.SS2.p4.1.m1.1.2.1.cmml"><mo stretchy="false" id="S5.SS2.p4.1.m1.1.2.2.1" xref="S5.SS2.p4.1.m1.1.2.1.1.cmml">⌊</mo><mfrac id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml"><mtext id="S5.SS2.p4.1.m1.1.1.2" xref="S5.SS2.p4.1.m1.1.1.2a.cmml"># nodes previous layer</mtext><mn id="S5.SS2.p4.1.m1.1.1.3" xref="S5.SS2.p4.1.m1.1.1.3.cmml">2</mn></mfrac><mo stretchy="false" id="S5.SS2.p4.1.m1.1.2.2.2" xref="S5.SS2.p4.1.m1.1.2.1.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><apply id="S5.SS2.p4.1.m1.1.2.1.cmml" xref="S5.SS2.p4.1.m1.1.2.2"><floor id="S5.SS2.p4.1.m1.1.2.1.1.cmml" xref="S5.SS2.p4.1.m1.1.2.2.1"></floor><apply id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1"><divide id="S5.SS2.p4.1.m1.1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1"></divide><ci id="S5.SS2.p4.1.m1.1.1.2a.cmml" xref="S5.SS2.p4.1.m1.1.1.2"><mtext mathsize="70%" id="S5.SS2.p4.1.m1.1.1.2.cmml" xref="S5.SS2.p4.1.m1.1.1.2"># nodes previous layer</mtext></ci><cn type="integer" id="S5.SS2.p4.1.m1.1.1.3.cmml" xref="S5.SS2.p4.1.m1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">\lfloor\frac{\text{\# nodes previous layer}}{2}\rfloor</annotation></semantics></math>, and a symmetric decoder. The selected autoencoder model and hyperparameters will be used in the next step: device clustering.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.4.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.5.2" class="ltx_text ltx_font_italic">Device Clustering</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">Using the selected autoencoder model from the previous step, the device clustering process begins, which consists of the first phase detailed in Algorithm <a href="#alg2" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">The FL server initializes the selected autoencoder model and distributes it to all IoT clients (78 nodes in the city network). Each client locally trains the model for <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mi id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\epsilon</annotation></semantics></math> epochs using as the <span id="S5.SS3.p2.1.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> optimizer, the optimizer selected from the previous step. The partially trained models are uploaded back to the server to start the model fingerprinting and clustering process. As detailed in Algorithm <a href="#alg2" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the server flattens the parameters of each model and performs PCA to reduce the dimensionality of the parameters. We are going to select the number of components needed to explain at least 90% of the variance. We use the K-means algorithm with the k-means++ initialization scheme to cluster the models, and hence the clients.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.3" class="ltx_p">The experiments are repeated for different values of <math id="S5.SS3.p3.1.m1.5" class="ltx_Math" alttext="\epsilon=1,2,4,8,16" display="inline"><semantics id="S5.SS3.p3.1.m1.5a"><mrow id="S5.SS3.p3.1.m1.5.6" xref="S5.SS3.p3.1.m1.5.6.cmml"><mi id="S5.SS3.p3.1.m1.5.6.2" xref="S5.SS3.p3.1.m1.5.6.2.cmml">ϵ</mi><mo id="S5.SS3.p3.1.m1.5.6.1" xref="S5.SS3.p3.1.m1.5.6.1.cmml">=</mo><mrow id="S5.SS3.p3.1.m1.5.6.3.2" xref="S5.SS3.p3.1.m1.5.6.3.1.cmml"><mn id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">1</mn><mo id="S5.SS3.p3.1.m1.5.6.3.2.1" xref="S5.SS3.p3.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS3.p3.1.m1.2.2" xref="S5.SS3.p3.1.m1.2.2.cmml">2</mn><mo id="S5.SS3.p3.1.m1.5.6.3.2.2" xref="S5.SS3.p3.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS3.p3.1.m1.3.3" xref="S5.SS3.p3.1.m1.3.3.cmml">4</mn><mo id="S5.SS3.p3.1.m1.5.6.3.2.3" xref="S5.SS3.p3.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS3.p3.1.m1.4.4" xref="S5.SS3.p3.1.m1.4.4.cmml">8</mn><mo id="S5.SS3.p3.1.m1.5.6.3.2.4" xref="S5.SS3.p3.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS3.p3.1.m1.5.5" xref="S5.SS3.p3.1.m1.5.5.cmml">16</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.5b"><apply id="S5.SS3.p3.1.m1.5.6.cmml" xref="S5.SS3.p3.1.m1.5.6"><eq id="S5.SS3.p3.1.m1.5.6.1.cmml" xref="S5.SS3.p3.1.m1.5.6.1"></eq><ci id="S5.SS3.p3.1.m1.5.6.2.cmml" xref="S5.SS3.p3.1.m1.5.6.2">italic-ϵ</ci><list id="S5.SS3.p3.1.m1.5.6.3.1.cmml" xref="S5.SS3.p3.1.m1.5.6.3.2"><cn type="integer" id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">1</cn><cn type="integer" id="S5.SS3.p3.1.m1.2.2.cmml" xref="S5.SS3.p3.1.m1.2.2">2</cn><cn type="integer" id="S5.SS3.p3.1.m1.3.3.cmml" xref="S5.SS3.p3.1.m1.3.3">4</cn><cn type="integer" id="S5.SS3.p3.1.m1.4.4.cmml" xref="S5.SS3.p3.1.m1.4.4">8</cn><cn type="integer" id="S5.SS3.p3.1.m1.5.5.cmml" xref="S5.SS3.p3.1.m1.5.5">16</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.5c">\epsilon=1,2,4,8,16</annotation></semantics></math> and <math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><mn id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><cn type="integer" id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">32</annotation></semantics></math>, and the optimal number of clusters <math id="S5.SS3.p3.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS3.p3.3.m3.1a"><mi id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><ci id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">K</annotation></semantics></math> is automatically selected based on the analysis of the following internal validation metrics: Silhouette, Davies-Bouldin and S_Dbw.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS4.4.1.1" class="ltx_text">V-D</span> </span><span id="S5.SS4.5.2" class="ltx_text ltx_font_italic">Federated Hyperparameter Tuning</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">In this step, we are going to tune the rest of the FL hyperparameters. Each cluster identified in the previous step will have its own federated hyperparameter tuning. First, we are going to tune the <span id="S5.SS4.p1.1.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and <span id="S5.SS4.p1.1.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> optimizer algorithms. Then, for the selected <span id="S5.SS4.p1.1.3" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and <span id="S5.SS4.p1.1.4" class="ltx_text ltx_font_smallcaps">ServerOpt</span>, we are going to further refine the client and server learning rates. While in the previous step of autoencoder model selection the client optimizer and learning rates were selected, these values might not be optimal for the FL training process.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.7" class="ltx_p">The <span id="S5.SS4.p2.7.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and <span id="S5.SS4.p2.7.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> are tuned by comparing multiple combinations of SGD (with and without momentum) and Adam optimizers both for the clients and the server. SGD is tested without momentum and with momentum set to <math id="S5.SS4.p2.1.m1.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S5.SS4.p2.1.m1.1a"><mn id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><cn type="float" id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">0.9</annotation></semantics></math> (as suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib71" title="" class="ltx_ref">71</a>]</cite>), for Adam two combinations are tested: <math id="S5.SS4.p2.2.m2.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S5.SS4.p2.2.m2.1a"><mrow id="S5.SS4.p2.2.m2.1.1" xref="S5.SS4.p2.2.m2.1.1.cmml"><msub id="S5.SS4.p2.2.m2.1.1.2" xref="S5.SS4.p2.2.m2.1.1.2.cmml"><mi id="S5.SS4.p2.2.m2.1.1.2.2" xref="S5.SS4.p2.2.m2.1.1.2.2.cmml">β</mi><mn id="S5.SS4.p2.2.m2.1.1.2.3" xref="S5.SS4.p2.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS4.p2.2.m2.1.1.1" xref="S5.SS4.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS4.p2.2.m2.1.1.3" xref="S5.SS4.p2.2.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.2.m2.1b"><apply id="S5.SS4.p2.2.m2.1.1.cmml" xref="S5.SS4.p2.2.m2.1.1"><eq id="S5.SS4.p2.2.m2.1.1.1.cmml" xref="S5.SS4.p2.2.m2.1.1.1"></eq><apply id="S5.SS4.p2.2.m2.1.1.2.cmml" xref="S5.SS4.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p2.2.m2.1.1.2.1.cmml" xref="S5.SS4.p2.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS4.p2.2.m2.1.1.2.2.cmml" xref="S5.SS4.p2.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S5.SS4.p2.2.m2.1.1.2.3.cmml" xref="S5.SS4.p2.2.m2.1.1.2.3">1</cn></apply><cn type="float" id="S5.SS4.p2.2.m2.1.1.3.cmml" xref="S5.SS4.p2.2.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.2.m2.1c">\beta_{1}=0.9</annotation></semantics></math>, <math id="S5.SS4.p2.3.m3.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S5.SS4.p2.3.m3.1a"><mrow id="S5.SS4.p2.3.m3.1.1" xref="S5.SS4.p2.3.m3.1.1.cmml"><msub id="S5.SS4.p2.3.m3.1.1.2" xref="S5.SS4.p2.3.m3.1.1.2.cmml"><mi id="S5.SS4.p2.3.m3.1.1.2.2" xref="S5.SS4.p2.3.m3.1.1.2.2.cmml">β</mi><mn id="S5.SS4.p2.3.m3.1.1.2.3" xref="S5.SS4.p2.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS4.p2.3.m3.1.1.1" xref="S5.SS4.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS4.p2.3.m3.1.1.3" xref="S5.SS4.p2.3.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.3.m3.1b"><apply id="S5.SS4.p2.3.m3.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1"><eq id="S5.SS4.p2.3.m3.1.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1.1"></eq><apply id="S5.SS4.p2.3.m3.1.1.2.cmml" xref="S5.SS4.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p2.3.m3.1.1.2.1.cmml" xref="S5.SS4.p2.3.m3.1.1.2">subscript</csymbol><ci id="S5.SS4.p2.3.m3.1.1.2.2.cmml" xref="S5.SS4.p2.3.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S5.SS4.p2.3.m3.1.1.2.3.cmml" xref="S5.SS4.p2.3.m3.1.1.2.3">2</cn></apply><cn type="float" id="S5.SS4.p2.3.m3.1.1.3.cmml" xref="S5.SS4.p2.3.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.3.m3.1c">\beta_{2}=0.999</annotation></semantics></math>, <math id="S5.SS4.p2.4.m4.1" class="ltx_Math" alttext="\epsilon=1\times 10^{-8}" display="inline"><semantics id="S5.SS4.p2.4.m4.1a"><mrow id="S5.SS4.p2.4.m4.1.1" xref="S5.SS4.p2.4.m4.1.1.cmml"><mi id="S5.SS4.p2.4.m4.1.1.2" xref="S5.SS4.p2.4.m4.1.1.2.cmml">ϵ</mi><mo id="S5.SS4.p2.4.m4.1.1.1" xref="S5.SS4.p2.4.m4.1.1.1.cmml">=</mo><mrow id="S5.SS4.p2.4.m4.1.1.3" xref="S5.SS4.p2.4.m4.1.1.3.cmml"><mn id="S5.SS4.p2.4.m4.1.1.3.2" xref="S5.SS4.p2.4.m4.1.1.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS4.p2.4.m4.1.1.3.1" xref="S5.SS4.p2.4.m4.1.1.3.1.cmml">×</mo><msup id="S5.SS4.p2.4.m4.1.1.3.3" xref="S5.SS4.p2.4.m4.1.1.3.3.cmml"><mn id="S5.SS4.p2.4.m4.1.1.3.3.2" xref="S5.SS4.p2.4.m4.1.1.3.3.2.cmml">10</mn><mrow id="S5.SS4.p2.4.m4.1.1.3.3.3" xref="S5.SS4.p2.4.m4.1.1.3.3.3.cmml"><mo id="S5.SS4.p2.4.m4.1.1.3.3.3a" xref="S5.SS4.p2.4.m4.1.1.3.3.3.cmml">−</mo><mn id="S5.SS4.p2.4.m4.1.1.3.3.3.2" xref="S5.SS4.p2.4.m4.1.1.3.3.3.2.cmml">8</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.4.m4.1b"><apply id="S5.SS4.p2.4.m4.1.1.cmml" xref="S5.SS4.p2.4.m4.1.1"><eq id="S5.SS4.p2.4.m4.1.1.1.cmml" xref="S5.SS4.p2.4.m4.1.1.1"></eq><ci id="S5.SS4.p2.4.m4.1.1.2.cmml" xref="S5.SS4.p2.4.m4.1.1.2">italic-ϵ</ci><apply id="S5.SS4.p2.4.m4.1.1.3.cmml" xref="S5.SS4.p2.4.m4.1.1.3"><times id="S5.SS4.p2.4.m4.1.1.3.1.cmml" xref="S5.SS4.p2.4.m4.1.1.3.1"></times><cn type="integer" id="S5.SS4.p2.4.m4.1.1.3.2.cmml" xref="S5.SS4.p2.4.m4.1.1.3.2">1</cn><apply id="S5.SS4.p2.4.m4.1.1.3.3.cmml" xref="S5.SS4.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS4.p2.4.m4.1.1.3.3.1.cmml" xref="S5.SS4.p2.4.m4.1.1.3.3">superscript</csymbol><cn type="integer" id="S5.SS4.p2.4.m4.1.1.3.3.2.cmml" xref="S5.SS4.p2.4.m4.1.1.3.3.2">10</cn><apply id="S5.SS4.p2.4.m4.1.1.3.3.3.cmml" xref="S5.SS4.p2.4.m4.1.1.3.3.3"><minus id="S5.SS4.p2.4.m4.1.1.3.3.3.1.cmml" xref="S5.SS4.p2.4.m4.1.1.3.3.3"></minus><cn type="integer" id="S5.SS4.p2.4.m4.1.1.3.3.3.2.cmml" xref="S5.SS4.p2.4.m4.1.1.3.3.3.2">8</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.4.m4.1c">\epsilon=1\times 10^{-8}</annotation></semantics></math> (default values defined in PyTorch) and <math id="S5.SS4.p2.5.m5.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S5.SS4.p2.5.m5.1a"><mrow id="S5.SS4.p2.5.m5.1.1" xref="S5.SS4.p2.5.m5.1.1.cmml"><msub id="S5.SS4.p2.5.m5.1.1.2" xref="S5.SS4.p2.5.m5.1.1.2.cmml"><mi id="S5.SS4.p2.5.m5.1.1.2.2" xref="S5.SS4.p2.5.m5.1.1.2.2.cmml">β</mi><mn id="S5.SS4.p2.5.m5.1.1.2.3" xref="S5.SS4.p2.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS4.p2.5.m5.1.1.1" xref="S5.SS4.p2.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS4.p2.5.m5.1.1.3" xref="S5.SS4.p2.5.m5.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.5.m5.1b"><apply id="S5.SS4.p2.5.m5.1.1.cmml" xref="S5.SS4.p2.5.m5.1.1"><eq id="S5.SS4.p2.5.m5.1.1.1.cmml" xref="S5.SS4.p2.5.m5.1.1.1"></eq><apply id="S5.SS4.p2.5.m5.1.1.2.cmml" xref="S5.SS4.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p2.5.m5.1.1.2.1.cmml" xref="S5.SS4.p2.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS4.p2.5.m5.1.1.2.2.cmml" xref="S5.SS4.p2.5.m5.1.1.2.2">𝛽</ci><cn type="integer" id="S5.SS4.p2.5.m5.1.1.2.3.cmml" xref="S5.SS4.p2.5.m5.1.1.2.3">1</cn></apply><cn type="float" id="S5.SS4.p2.5.m5.1.1.3.cmml" xref="S5.SS4.p2.5.m5.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.5.m5.1c">\beta_{1}=0.9</annotation></semantics></math>, <math id="S5.SS4.p2.6.m6.1" class="ltx_Math" alttext="\beta_{2}=0.99" display="inline"><semantics id="S5.SS4.p2.6.m6.1a"><mrow id="S5.SS4.p2.6.m6.1.1" xref="S5.SS4.p2.6.m6.1.1.cmml"><msub id="S5.SS4.p2.6.m6.1.1.2" xref="S5.SS4.p2.6.m6.1.1.2.cmml"><mi id="S5.SS4.p2.6.m6.1.1.2.2" xref="S5.SS4.p2.6.m6.1.1.2.2.cmml">β</mi><mn id="S5.SS4.p2.6.m6.1.1.2.3" xref="S5.SS4.p2.6.m6.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS4.p2.6.m6.1.1.1" xref="S5.SS4.p2.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS4.p2.6.m6.1.1.3" xref="S5.SS4.p2.6.m6.1.1.3.cmml">0.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.6.m6.1b"><apply id="S5.SS4.p2.6.m6.1.1.cmml" xref="S5.SS4.p2.6.m6.1.1"><eq id="S5.SS4.p2.6.m6.1.1.1.cmml" xref="S5.SS4.p2.6.m6.1.1.1"></eq><apply id="S5.SS4.p2.6.m6.1.1.2.cmml" xref="S5.SS4.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p2.6.m6.1.1.2.1.cmml" xref="S5.SS4.p2.6.m6.1.1.2">subscript</csymbol><ci id="S5.SS4.p2.6.m6.1.1.2.2.cmml" xref="S5.SS4.p2.6.m6.1.1.2.2">𝛽</ci><cn type="integer" id="S5.SS4.p2.6.m6.1.1.2.3.cmml" xref="S5.SS4.p2.6.m6.1.1.2.3">2</cn></apply><cn type="float" id="S5.SS4.p2.6.m6.1.1.3.cmml" xref="S5.SS4.p2.6.m6.1.1.3">0.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.6.m6.1c">\beta_{2}=0.99</annotation></semantics></math>, <math id="S5.SS4.p2.7.m7.1" class="ltx_Math" alttext="\epsilon=0.001" display="inline"><semantics id="S5.SS4.p2.7.m7.1a"><mrow id="S5.SS4.p2.7.m7.1.1" xref="S5.SS4.p2.7.m7.1.1.cmml"><mi id="S5.SS4.p2.7.m7.1.1.2" xref="S5.SS4.p2.7.m7.1.1.2.cmml">ϵ</mi><mo id="S5.SS4.p2.7.m7.1.1.1" xref="S5.SS4.p2.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS4.p2.7.m7.1.1.3" xref="S5.SS4.p2.7.m7.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.7.m7.1b"><apply id="S5.SS4.p2.7.m7.1.1.cmml" xref="S5.SS4.p2.7.m7.1.1"><eq id="S5.SS4.p2.7.m7.1.1.1.cmml" xref="S5.SS4.p2.7.m7.1.1.1"></eq><ci id="S5.SS4.p2.7.m7.1.1.2.cmml" xref="S5.SS4.p2.7.m7.1.1.2">italic-ϵ</ci><cn type="float" id="S5.SS4.p2.7.m7.1.1.3.cmml" xref="S5.SS4.p2.7.m7.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.7.m7.1c">\epsilon=0.001</annotation></semantics></math> (as suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib71" title="" class="ltx_ref">71</a>]</cite>). In total, 16 combinations are evaluated. Each client trains on 80% of its local data and is evaluated on the remaining 20%; both losses are reported to the aggregation server. We select the optimizer combination that minimizes the average evaluation loss across all the cluster clients in fewer FL training rounds.</p>
</div>
<div id="S5.SS4.p3" class="ltx_para">
<p id="S5.SS4.p3.3" class="ltx_p">Then, the <math id="S5.SS4.p3.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S5.SS4.p3.1.m1.1a"><mi id="S5.SS4.p3.1.m1.1.1" xref="S5.SS4.p3.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.1.m1.1b"><ci id="S5.SS4.p3.1.m1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.1.m1.1c">\eta</annotation></semantics></math> and <math id="S5.SS4.p3.2.m2.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="S5.SS4.p3.2.m2.1a"><msub id="S5.SS4.p3.2.m2.1.1" xref="S5.SS4.p3.2.m2.1.1.cmml"><mi id="S5.SS4.p3.2.m2.1.1.2" xref="S5.SS4.p3.2.m2.1.1.2.cmml">η</mi><mi id="S5.SS4.p3.2.m2.1.1.3" xref="S5.SS4.p3.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.2.m2.1b"><apply id="S5.SS4.p3.2.m2.1.1.cmml" xref="S5.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p3.2.m2.1.1.1.cmml" xref="S5.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p3.2.m2.1.1.2.cmml" xref="S5.SS4.p3.2.m2.1.1.2">𝜂</ci><ci id="S5.SS4.p3.2.m2.1.1.3.cmml" xref="S5.SS4.p3.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.2.m2.1c">\eta_{s}</annotation></semantics></math> learning rates are refined via grid search. For all the hyperparameter tuning we set <math id="S5.SS4.p3.3.m3.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S5.SS4.p3.3.m3.1a"><mrow id="S5.SS4.p3.3.m3.1.1" xref="S5.SS4.p3.3.m3.1.1.cmml"><mi id="S5.SS4.p3.3.m3.1.1.2" xref="S5.SS4.p3.3.m3.1.1.2.cmml">E</mi><mo id="S5.SS4.p3.3.m3.1.1.1" xref="S5.SS4.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS4.p3.3.m3.1.1.3" xref="S5.SS4.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.3.m3.1b"><apply id="S5.SS4.p3.3.m3.1.1.cmml" xref="S5.SS4.p3.3.m3.1.1"><eq id="S5.SS4.p3.3.m3.1.1.1.cmml" xref="S5.SS4.p3.3.m3.1.1.1"></eq><ci id="S5.SS4.p3.3.m3.1.1.2.cmml" xref="S5.SS4.p3.3.m3.1.1.2">𝐸</ci><cn type="integer" id="S5.SS4.p3.3.m3.1.1.3.cmml" xref="S5.SS4.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.3.m3.1c">E=1</annotation></semantics></math>, and use the same random seed to initialize the ML model parameters in order to reduce the effects of the random model initialization noise.</p>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS5.4.1.1" class="ltx_text">V-E</span> </span><span id="S5.SS5.5.2" class="ltx_text ltx_font_italic">Clustered Federated Learning</span>
</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.4" class="ltx_p">After the device clustering and federated hyperparameter tuning steps, we perform the clustered federated learning using the fine-tuned <span id="S5.SS5.p1.4.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and <span id="S5.SS5.p1.4.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> optimizers and their respective learning rates. We perform <math id="S5.SS5.p1.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S5.SS5.p1.1.m1.1a"><mi id="S5.SS5.p1.1.m1.1.1" xref="S5.SS5.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.1.m1.1b"><ci id="S5.SS5.p1.1.m1.1.1.cmml" xref="S5.SS5.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.1.m1.1c">R</annotation></semantics></math> FL rounds to train the <math id="S5.SS5.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS5.p1.2.m2.1a"><mi id="S5.SS5.p1.2.m2.1.1" xref="S5.SS5.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.2.m2.1b"><ci id="S5.SS5.p1.2.m2.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.2.m2.1c">K</annotation></semantics></math> global models, one for each identified cluster. In this case, we repeat the process for different values of the number of local training epochs <math id="S5.SS5.p1.3.m3.3" class="ltx_Math" alttext="E=1,2,4" display="inline"><semantics id="S5.SS5.p1.3.m3.3a"><mrow id="S5.SS5.p1.3.m3.3.4" xref="S5.SS5.p1.3.m3.3.4.cmml"><mi id="S5.SS5.p1.3.m3.3.4.2" xref="S5.SS5.p1.3.m3.3.4.2.cmml">E</mi><mo id="S5.SS5.p1.3.m3.3.4.1" xref="S5.SS5.p1.3.m3.3.4.1.cmml">=</mo><mrow id="S5.SS5.p1.3.m3.3.4.3.2" xref="S5.SS5.p1.3.m3.3.4.3.1.cmml"><mn id="S5.SS5.p1.3.m3.1.1" xref="S5.SS5.p1.3.m3.1.1.cmml">1</mn><mo id="S5.SS5.p1.3.m3.3.4.3.2.1" xref="S5.SS5.p1.3.m3.3.4.3.1.cmml">,</mo><mn id="S5.SS5.p1.3.m3.2.2" xref="S5.SS5.p1.3.m3.2.2.cmml">2</mn><mo id="S5.SS5.p1.3.m3.3.4.3.2.2" xref="S5.SS5.p1.3.m3.3.4.3.1.cmml">,</mo><mn id="S5.SS5.p1.3.m3.3.3" xref="S5.SS5.p1.3.m3.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.3.m3.3b"><apply id="S5.SS5.p1.3.m3.3.4.cmml" xref="S5.SS5.p1.3.m3.3.4"><eq id="S5.SS5.p1.3.m3.3.4.1.cmml" xref="S5.SS5.p1.3.m3.3.4.1"></eq><ci id="S5.SS5.p1.3.m3.3.4.2.cmml" xref="S5.SS5.p1.3.m3.3.4.2">𝐸</ci><list id="S5.SS5.p1.3.m3.3.4.3.1.cmml" xref="S5.SS5.p1.3.m3.3.4.3.2"><cn type="integer" id="S5.SS5.p1.3.m3.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1">1</cn><cn type="integer" id="S5.SS5.p1.3.m3.2.2.cmml" xref="S5.SS5.p1.3.m3.2.2">2</cn><cn type="integer" id="S5.SS5.p1.3.m3.3.3.cmml" xref="S5.SS5.p1.3.m3.3.3">4</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.3.m3.3c">E=1,2,4</annotation></semantics></math> and <math id="S5.SS5.p1.4.m4.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S5.SS5.p1.4.m4.1a"><mn id="S5.SS5.p1.4.m4.1.1" xref="S5.SS5.p1.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.4.m4.1b"><cn type="integer" id="S5.SS5.p1.4.m4.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.4.m4.1c">8</annotation></semantics></math> to evaluate its effect on the training process.</p>
</div>
<div id="S5.SS5.p2" class="ltx_para">
<p id="S5.SS5.p2.1" class="ltx_p">Similar to the previous steps, each client trains on 80% of its local data and evaluates the model on the remaining 20%. Each client records the loss for the training and evaluation splits after the local model training and sends it to the server. This is repeated for all the FL rounds. This way, the server can monitor both the training and evaluation loss progression and check if there are any overfitting signs.</p>
</div>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS6.4.1.1" class="ltx_text">V-F</span> </span><span id="S5.SS6.5.2" class="ltx_text ltx_font_italic">Anomaly Detection</span>
</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.1" class="ltx_p">After training the models with FL, we are going to evaluate the anomaly detection performance of the resulting <math id="S5.SS6.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS6.p1.1.m1.1a"><mi id="S5.SS6.p1.1.m1.1.1" xref="S5.SS6.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.1.m1.1b"><ci id="S5.SS6.p1.1.m1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.1.m1.1c">K</annotation></semantics></math> global models. Recall that at this step, each device holds a local copy of the global model that corresponds to its cluster. To estimate the unsupervised anomaly detection capabilities, we are going to use the validation-normal and validation-attack datasets.</p>
</div>
<section id="S5.SS6.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS6.SSS1.4.1.1" class="ltx_text">V-F</span>1 </span>Threshold selection</h4>

<div id="S5.SS6.SSS1.p1" class="ltx_para">
<p id="S5.SS6.SSS1.p1.1" class="ltx_p">For each client, we will first evaluate the trained global model on its corresponding validation-normal dataset to estimate the anomaly detection threshold. Note that the evaluation is local; therefore, each device will compute its own threshold value. We will opt for a simplistic approach and select the largest MSE from the validation-normal dataset as the threshold. Packets with <math id="S5.SS6.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\text{MSE}&gt;\text{threshold}" display="inline"><semantics id="S5.SS6.SSS1.p1.1.m1.1a"><mrow id="S5.SS6.SSS1.p1.1.m1.1.1" xref="S5.SS6.SSS1.p1.1.m1.1.1.cmml"><mtext id="S5.SS6.SSS1.p1.1.m1.1.1.2" xref="S5.SS6.SSS1.p1.1.m1.1.1.2a.cmml">MSE</mtext><mo id="S5.SS6.SSS1.p1.1.m1.1.1.1" xref="S5.SS6.SSS1.p1.1.m1.1.1.1.cmml">&gt;</mo><mtext id="S5.SS6.SSS1.p1.1.m1.1.1.3" xref="S5.SS6.SSS1.p1.1.m1.1.1.3a.cmml">threshold</mtext></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.SSS1.p1.1.m1.1b"><apply id="S5.SS6.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS6.SSS1.p1.1.m1.1.1"><gt id="S5.SS6.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS6.SSS1.p1.1.m1.1.1.1"></gt><ci id="S5.SS6.SSS1.p1.1.m1.1.1.2a.cmml" xref="S5.SS6.SSS1.p1.1.m1.1.1.2"><mtext id="S5.SS6.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS6.SSS1.p1.1.m1.1.1.2">MSE</mtext></ci><ci id="S5.SS6.SSS1.p1.1.m1.1.1.3a.cmml" xref="S5.SS6.SSS1.p1.1.m1.1.1.3"><mtext id="S5.SS6.SSS1.p1.1.m1.1.1.3.cmml" xref="S5.SS6.SSS1.p1.1.m1.1.1.3">threshold</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.SSS1.p1.1.m1.1c">\text{MSE}&gt;\text{threshold}</annotation></semantics></math> will be considered anomalous. Then, we will evaluate the same model on the multiple validation-attack datasets to identify all the anomalous packets.</p>
</div>
</section>
<section id="S5.SS6.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS6.SSS2.4.1.1" class="ltx_text">V-F</span>2 </span>Anomaly detection performance</h4>

<div id="S5.SS6.SSS2.p1" class="ltx_para">
<p id="S5.SS6.SSS2.p1.1" class="ltx_p">The anomaly detection performance is measured by evaluating the trained global models on the multiple validation-attack datasets detailed in section <a href="#S4.SS2" title="IV-B Data Generation and Collection Method ‣ IV IoT Testbed and Experimental Setup ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span></span></a>. To obtain performance metrics, we will manually label the validation-attack datasets to provide ground truth labels to be compared with the detected anomalies from the autoencoder. The labeling process is based on the known IP addresses of the attacker, victim, IoT and cloud nodes, and attack timestamps extracted from the scenario. We recall that this ground truth labeling is only used to compute the performance metrics and is never used for training; also, the IP addresses are never used for model training. In a real deployment, prior labeling of the network data might not be feasible, but here it will give us an estimate of the performance of the global models to detect the attacks considered in our threat model; however, note that the manual labeling process is a heuristic and might misclassify some packets.</p>
</div>
<div id="S5.SS6.SSS2.p2" class="ltx_para">
<p id="S5.SS6.SSS2.p2.1" class="ltx_p">We provide the standard confusion matrix metrics: true positives (TP), false negatives (FN), false positives (FP), true negatives (TN) and their derivate metrics, including accuracy, F1 score and Matthews correlation coefficient (MCC).</p>
</div>
</section>
</section>
<section id="S5.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS7.4.1.1" class="ltx_text">V-G</span> </span><span id="S5.SS7.5.2" class="ltx_text ltx_font_italic">Baseline experimental comparisons</span>
</h3>

<div id="S5.SS7.p1" class="ltx_para">
<p id="S5.SS7.p1.1" class="ltx_p">We are considering Kitsune <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> network IDS and two non-clustered FL approaches for the baseline experimental comparisons.</p>
</div>
<section id="S5.SS7.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS7.SSS1.4.1.1" class="ltx_text">V-G</span>1 </span>Kitsune</h4>

<div id="S5.SS7.SSS1.p1" class="ltx_para">
<p id="S5.SS7.SSS1.p1.1" class="ltx_p">Kitsune is a state-of-the-art network IDS that uses an ensemble of autoencoders trained in an unsupervised and online manner. The similarities of being unsupervised and based on autoencoders make it an interesting comparison; however, there are some fundamental differences between Kitsune and the proposed method. First, Kitsune does not use FL to train the model; it is deployed in each machine and only uses local data. Second, Kitsune uses features based on temporal statistics of network packets taken over multiple damped windows; instead, we extract features obtained from each packet in isolation. Third, Kitsune is trained in an online manner, so the training is performed using one sample at a time instead of multiple training iterations over batches of the data. Another difference is that Kitsune does not filter IPv6 or ARP packets.</p>
</div>
</section>
<section id="S5.SS7.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS7.SSS2.4.1.1" class="ltx_text">V-G</span>2 </span>non-clustered FL with weighted aggregation</h4>

<div id="S5.SS7.SSS2.p1" class="ltx_para">
<p id="S5.SS7.SSS2.p1.1" class="ltx_p">This FL baseline is identical to the proposed approach from Algorithm <a href="#alg2" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, except that the clustering step is removed. That is, we consider <math id="S5.SS7.SSS2.p1.1.m1.1" class="ltx_Math" alttext="K=1" display="inline"><semantics id="S5.SS7.SSS2.p1.1.m1.1a"><mrow id="S5.SS7.SSS2.p1.1.m1.1.1" xref="S5.SS7.SSS2.p1.1.m1.1.1.cmml"><mi id="S5.SS7.SSS2.p1.1.m1.1.1.2" xref="S5.SS7.SSS2.p1.1.m1.1.1.2.cmml">K</mi><mo id="S5.SS7.SSS2.p1.1.m1.1.1.1" xref="S5.SS7.SSS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS7.SSS2.p1.1.m1.1.1.3" xref="S5.SS7.SSS2.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.SSS2.p1.1.m1.1b"><apply id="S5.SS7.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS7.SSS2.p1.1.m1.1.1"><eq id="S5.SS7.SSS2.p1.1.m1.1.1.1.cmml" xref="S5.SS7.SSS2.p1.1.m1.1.1.1"></eq><ci id="S5.SS7.SSS2.p1.1.m1.1.1.2.cmml" xref="S5.SS7.SSS2.p1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S5.SS7.SSS2.p1.1.m1.1.1.3.cmml" xref="S5.SS7.SSS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.SSS2.p1.1.m1.1c">K=1</annotation></semantics></math> (all clients belong to the same cluster), and the objective is to train a single global model that fits all the clients in the federated network.</p>
</div>
</section>
<section id="S5.SS7.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS7.SSS3.4.1.1" class="ltx_text">V-G</span>3 </span>non-clustered FL without weighted aggregation</h4>

<div id="S5.SS7.SSS3.p1" class="ltx_para">
<p id="S5.SS7.SSS3.p1.1" class="ltx_p">In the server model aggregation step, the contribution of each client is weighted by the number of training samples used by that client (Algorithm <a href="#alg1" title="In III-B Clustered Federated Learning Process for Heterogeneous Devices ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). This process can bias the global model towards clients with more training samples. Hence, this FL baseline is the same as the previous non-clustered FL baseline (<math id="S5.SS7.SSS3.p1.1.m1.1" class="ltx_Math" alttext="K=1" display="inline"><semantics id="S5.SS7.SSS3.p1.1.m1.1a"><mrow id="S5.SS7.SSS3.p1.1.m1.1.1" xref="S5.SS7.SSS3.p1.1.m1.1.1.cmml"><mi id="S5.SS7.SSS3.p1.1.m1.1.1.2" xref="S5.SS7.SSS3.p1.1.m1.1.1.2.cmml">K</mi><mo id="S5.SS7.SSS3.p1.1.m1.1.1.1" xref="S5.SS7.SSS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS7.SSS3.p1.1.m1.1.1.3" xref="S5.SS7.SSS3.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.SSS3.p1.1.m1.1b"><apply id="S5.SS7.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS7.SSS3.p1.1.m1.1.1"><eq id="S5.SS7.SSS3.p1.1.m1.1.1.1.cmml" xref="S5.SS7.SSS3.p1.1.m1.1.1.1"></eq><ci id="S5.SS7.SSS3.p1.1.m1.1.1.2.cmml" xref="S5.SS7.SSS3.p1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S5.SS7.SSS3.p1.1.m1.1.1.3.cmml" xref="S5.SS7.SSS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.SSS3.p1.1.m1.1c">K=1</annotation></semantics></math>, single global model for all clients), except that at the server aggregation step, the contribution of all clients will be equally weighted.</p>
</div>
<div id="S5.SS7.SSS3.p2" class="ltx_para">
<p id="S5.SS7.SSS3.p2.1" class="ltx_p">Both non-clustered FL baselines are used to experimentally compare whether clustering offers significant advantages for unsupervised anomaly detection in FL settings.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Results</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this section, we present the results obtained from the experiments described in section <a href="#S5" title="V Implementation ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS1.4.1.1" class="ltx_text">VI-A</span> </span><span id="S6.SS1.5.2" class="ltx_text ltx_font_italic">Autoencoder Model Selection</span>
</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">As previously stated, the input and output shapes of the autoencoder are the same as the number of input data feature dimensions. Depending on the selected source and destination port discretization method from the network data processing step, the dimensions are 27 or 69 for the three-range and hierarchical discretization, respectively. For the autoencoder model selection, we will consider both cases. The distinction between the two methods will be shown later in the device clustering results.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.4" class="ltx_p">We detected no significant improvement in the validation loss after 2 hidden encoder layers, irrespective of the port discretization method. Thus, for the three-range discretization method, the final autoencoder model is a two hidden layer encoder with 13 and 6 nodes, respectively, and a symmetric decoder with 6 and 13 nodes. For the hierarchical discretization, the encoder layers include 34 and 17 nodes with a symmetric decoder. We use the <math id="S6.SS1.p2.1.m1.1" class="ltx_Math" alttext="ReLU" display="inline"><semantics id="S6.SS1.p2.1.m1.1a"><mrow id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml"><mi id="S6.SS1.p2.1.m1.1.1.2" xref="S6.SS1.p2.1.m1.1.1.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S6.SS1.p2.1.m1.1.1.1" xref="S6.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S6.SS1.p2.1.m1.1.1.3" xref="S6.SS1.p2.1.m1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S6.SS1.p2.1.m1.1.1.1a" xref="S6.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S6.SS1.p2.1.m1.1.1.4" xref="S6.SS1.p2.1.m1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S6.SS1.p2.1.m1.1.1.1b" xref="S6.SS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S6.SS1.p2.1.m1.1.1.5" xref="S6.SS1.p2.1.m1.1.1.5.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.1b"><apply id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1"><times id="S6.SS1.p2.1.m1.1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1.1"></times><ci id="S6.SS1.p2.1.m1.1.1.2.cmml" xref="S6.SS1.p2.1.m1.1.1.2">𝑅</ci><ci id="S6.SS1.p2.1.m1.1.1.3.cmml" xref="S6.SS1.p2.1.m1.1.1.3">𝑒</ci><ci id="S6.SS1.p2.1.m1.1.1.4.cmml" xref="S6.SS1.p2.1.m1.1.1.4">𝐿</ci><ci id="S6.SS1.p2.1.m1.1.1.5.cmml" xref="S6.SS1.p2.1.m1.1.1.5">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.1c">ReLU</annotation></semantics></math> activation function after each layer. The optimizer is Adam with a <math id="S6.SS1.p2.2.m2.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.SS1.p2.2.m2.1a"><mrow id="S6.SS1.p2.2.m2.1.1" xref="S6.SS1.p2.2.m2.1.1.cmml"><mn id="S6.SS1.p2.2.m2.1.1.2" xref="S6.SS1.p2.2.m2.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S6.SS1.p2.2.m2.1.1.1" xref="S6.SS1.p2.2.m2.1.1.1.cmml">×</mo><msup id="S6.SS1.p2.2.m2.1.1.3" xref="S6.SS1.p2.2.m2.1.1.3.cmml"><mn id="S6.SS1.p2.2.m2.1.1.3.2" xref="S6.SS1.p2.2.m2.1.1.3.2.cmml">10</mn><mrow id="S6.SS1.p2.2.m2.1.1.3.3" xref="S6.SS1.p2.2.m2.1.1.3.3.cmml"><mo id="S6.SS1.p2.2.m2.1.1.3.3a" xref="S6.SS1.p2.2.m2.1.1.3.3.cmml">−</mo><mn id="S6.SS1.p2.2.m2.1.1.3.3.2" xref="S6.SS1.p2.2.m2.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.2.m2.1b"><apply id="S6.SS1.p2.2.m2.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1"><times id="S6.SS1.p2.2.m2.1.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1.1"></times><cn type="integer" id="S6.SS1.p2.2.m2.1.1.2.cmml" xref="S6.SS1.p2.2.m2.1.1.2">1</cn><apply id="S6.SS1.p2.2.m2.1.1.3.cmml" xref="S6.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.p2.2.m2.1.1.3.1.cmml" xref="S6.SS1.p2.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S6.SS1.p2.2.m2.1.1.3.2.cmml" xref="S6.SS1.p2.2.m2.1.1.3.2">10</cn><apply id="S6.SS1.p2.2.m2.1.1.3.3.cmml" xref="S6.SS1.p2.2.m2.1.1.3.3"><minus id="S6.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="S6.SS1.p2.2.m2.1.1.3.3"></minus><cn type="integer" id="S6.SS1.p2.2.m2.1.1.3.3.2.cmml" xref="S6.SS1.p2.2.m2.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.2.m2.1c">1\times 10^{-3}</annotation></semantics></math> learning rate, <math id="S6.SS1.p2.3.m3.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S6.SS1.p2.3.m3.1a"><msub id="S6.SS1.p2.3.m3.1.1" xref="S6.SS1.p2.3.m3.1.1.cmml"><mi id="S6.SS1.p2.3.m3.1.1.2" xref="S6.SS1.p2.3.m3.1.1.2.cmml">L</mi><mn id="S6.SS1.p2.3.m3.1.1.3" xref="S6.SS1.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.3.m3.1b"><apply id="S6.SS1.p2.3.m3.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.3.m3.1.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS1.p2.3.m3.1.1.2.cmml" xref="S6.SS1.p2.3.m3.1.1.2">𝐿</ci><cn type="integer" id="S6.SS1.p2.3.m3.1.1.3.cmml" xref="S6.SS1.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.3.m3.1c">L_{2}</annotation></semantics></math> regularization weight from equation (<a href="#S3.E2" title="In III-D Anomaly Detection Model ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) <math id="S6.SS1.p2.4.m4.1" class="ltx_Math" alttext="\lambda=1\times 10^{-5}" display="inline"><semantics id="S6.SS1.p2.4.m4.1a"><mrow id="S6.SS1.p2.4.m4.1.1" xref="S6.SS1.p2.4.m4.1.1.cmml"><mi id="S6.SS1.p2.4.m4.1.1.2" xref="S6.SS1.p2.4.m4.1.1.2.cmml">λ</mi><mo id="S6.SS1.p2.4.m4.1.1.1" xref="S6.SS1.p2.4.m4.1.1.1.cmml">=</mo><mrow id="S6.SS1.p2.4.m4.1.1.3" xref="S6.SS1.p2.4.m4.1.1.3.cmml"><mn id="S6.SS1.p2.4.m4.1.1.3.2" xref="S6.SS1.p2.4.m4.1.1.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S6.SS1.p2.4.m4.1.1.3.1" xref="S6.SS1.p2.4.m4.1.1.3.1.cmml">×</mo><msup id="S6.SS1.p2.4.m4.1.1.3.3" xref="S6.SS1.p2.4.m4.1.1.3.3.cmml"><mn id="S6.SS1.p2.4.m4.1.1.3.3.2" xref="S6.SS1.p2.4.m4.1.1.3.3.2.cmml">10</mn><mrow id="S6.SS1.p2.4.m4.1.1.3.3.3" xref="S6.SS1.p2.4.m4.1.1.3.3.3.cmml"><mo id="S6.SS1.p2.4.m4.1.1.3.3.3a" xref="S6.SS1.p2.4.m4.1.1.3.3.3.cmml">−</mo><mn id="S6.SS1.p2.4.m4.1.1.3.3.3.2" xref="S6.SS1.p2.4.m4.1.1.3.3.3.2.cmml">5</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.4.m4.1b"><apply id="S6.SS1.p2.4.m4.1.1.cmml" xref="S6.SS1.p2.4.m4.1.1"><eq id="S6.SS1.p2.4.m4.1.1.1.cmml" xref="S6.SS1.p2.4.m4.1.1.1"></eq><ci id="S6.SS1.p2.4.m4.1.1.2.cmml" xref="S6.SS1.p2.4.m4.1.1.2">𝜆</ci><apply id="S6.SS1.p2.4.m4.1.1.3.cmml" xref="S6.SS1.p2.4.m4.1.1.3"><times id="S6.SS1.p2.4.m4.1.1.3.1.cmml" xref="S6.SS1.p2.4.m4.1.1.3.1"></times><cn type="integer" id="S6.SS1.p2.4.m4.1.1.3.2.cmml" xref="S6.SS1.p2.4.m4.1.1.3.2">1</cn><apply id="S6.SS1.p2.4.m4.1.1.3.3.cmml" xref="S6.SS1.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S6.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="S6.SS1.p2.4.m4.1.1.3.3">superscript</csymbol><cn type="integer" id="S6.SS1.p2.4.m4.1.1.3.3.2.cmml" xref="S6.SS1.p2.4.m4.1.1.3.3.2">10</cn><apply id="S6.SS1.p2.4.m4.1.1.3.3.3.cmml" xref="S6.SS1.p2.4.m4.1.1.3.3.3"><minus id="S6.SS1.p2.4.m4.1.1.3.3.3.1.cmml" xref="S6.SS1.p2.4.m4.1.1.3.3.3"></minus><cn type="integer" id="S6.SS1.p2.4.m4.1.1.3.3.3.2.cmml" xref="S6.SS1.p2.4.m4.1.1.3.3.3.2">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.4.m4.1c">\lambda=1\times 10^{-5}</annotation></semantics></math> and a batch size of 32.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS2.4.1.1" class="ltx_text">VI-B</span> </span><span id="S6.SS2.5.2" class="ltx_text ltx_font_italic">Device Clustering</span>
</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.9" class="ltx_p">The clustering experiments are repeated for the two port discretization methods and multiple values of the local training epochs <math id="S6.SS2.p1.1.m1.5" class="ltx_Math" alttext="\epsilon=1,2,4,8,16" display="inline"><semantics id="S6.SS2.p1.1.m1.5a"><mrow id="S6.SS2.p1.1.m1.5.6" xref="S6.SS2.p1.1.m1.5.6.cmml"><mi id="S6.SS2.p1.1.m1.5.6.2" xref="S6.SS2.p1.1.m1.5.6.2.cmml">ϵ</mi><mo id="S6.SS2.p1.1.m1.5.6.1" xref="S6.SS2.p1.1.m1.5.6.1.cmml">=</mo><mrow id="S6.SS2.p1.1.m1.5.6.3.2" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml"><mn id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml">1</mn><mo id="S6.SS2.p1.1.m1.5.6.3.2.1" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.2.2" xref="S6.SS2.p1.1.m1.2.2.cmml">2</mn><mo id="S6.SS2.p1.1.m1.5.6.3.2.2" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.3.3" xref="S6.SS2.p1.1.m1.3.3.cmml">4</mn><mo id="S6.SS2.p1.1.m1.5.6.3.2.3" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.4.4" xref="S6.SS2.p1.1.m1.4.4.cmml">8</mn><mo id="S6.SS2.p1.1.m1.5.6.3.2.4" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.5.5" xref="S6.SS2.p1.1.m1.5.5.cmml">16</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.5b"><apply id="S6.SS2.p1.1.m1.5.6.cmml" xref="S6.SS2.p1.1.m1.5.6"><eq id="S6.SS2.p1.1.m1.5.6.1.cmml" xref="S6.SS2.p1.1.m1.5.6.1"></eq><ci id="S6.SS2.p1.1.m1.5.6.2.cmml" xref="S6.SS2.p1.1.m1.5.6.2">italic-ϵ</ci><list id="S6.SS2.p1.1.m1.5.6.3.1.cmml" xref="S6.SS2.p1.1.m1.5.6.3.2"><cn type="integer" id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1">1</cn><cn type="integer" id="S6.SS2.p1.1.m1.2.2.cmml" xref="S6.SS2.p1.1.m1.2.2">2</cn><cn type="integer" id="S6.SS2.p1.1.m1.3.3.cmml" xref="S6.SS2.p1.1.m1.3.3">4</cn><cn type="integer" id="S6.SS2.p1.1.m1.4.4.cmml" xref="S6.SS2.p1.1.m1.4.4">8</cn><cn type="integer" id="S6.SS2.p1.1.m1.5.5.cmml" xref="S6.SS2.p1.1.m1.5.5">16</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.5c">\epsilon=1,2,4,8,16</annotation></semantics></math> and <math id="S6.SS2.p1.2.m2.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S6.SS2.p1.2.m2.1a"><mn id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><cn type="integer" id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">32</annotation></semantics></math> using the client optimizer parameters obtained from the previous autoencoder model selection step. For each value of <math id="S6.SS2.p1.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS2.p1.3.m3.1a"><mi id="S6.SS2.p1.3.m3.1.1" xref="S6.SS2.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.3.m3.1b"><ci id="S6.SS2.p1.3.m3.1.1.cmml" xref="S6.SS2.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.3.m3.1c">\epsilon</annotation></semantics></math>, to identify the optimal number of clusters <math id="S6.SS2.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.p1.4.m4.1a"><mi id="S6.SS2.p1.4.m4.1.1" xref="S6.SS2.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.4.m4.1b"><ci id="S6.SS2.p1.4.m4.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.4.m4.1c">K</annotation></semantics></math>, we perform K-means clustering with <math id="S6.SS2.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.p1.5.m5.1a"><mi id="S6.SS2.p1.5.m5.1.1" xref="S6.SS2.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.5.m5.1b"><ci id="S6.SS2.p1.5.m5.1.1.cmml" xref="S6.SS2.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.5.m5.1c">K</annotation></semantics></math> ranging from <math id="S6.SS2.p1.6.m6.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S6.SS2.p1.6.m6.1a"><mn id="S6.SS2.p1.6.m6.1.1" xref="S6.SS2.p1.6.m6.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.6.m6.1b"><cn type="integer" id="S6.SS2.p1.6.m6.1.1.cmml" xref="S6.SS2.p1.6.m6.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.6.m6.1c">2</annotation></semantics></math> to <math id="S6.SS2.p1.7.m7.1" class="ltx_Math" alttext="40" display="inline"><semantics id="S6.SS2.p1.7.m7.1a"><mn id="S6.SS2.p1.7.m7.1.1" xref="S6.SS2.p1.7.m7.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.7.m7.1b"><cn type="integer" id="S6.SS2.p1.7.m7.1.1.cmml" xref="S6.SS2.p1.7.m7.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.7.m7.1c">40</annotation></semantics></math> cluster centroids. The results for <math id="S6.SS2.p1.8.m8.1" class="ltx_Math" alttext="\epsilon=4" display="inline"><semantics id="S6.SS2.p1.8.m8.1a"><mrow id="S6.SS2.p1.8.m8.1.1" xref="S6.SS2.p1.8.m8.1.1.cmml"><mi id="S6.SS2.p1.8.m8.1.1.2" xref="S6.SS2.p1.8.m8.1.1.2.cmml">ϵ</mi><mo id="S6.SS2.p1.8.m8.1.1.1" xref="S6.SS2.p1.8.m8.1.1.1.cmml">=</mo><mn id="S6.SS2.p1.8.m8.1.1.3" xref="S6.SS2.p1.8.m8.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.8.m8.1b"><apply id="S6.SS2.p1.8.m8.1.1.cmml" xref="S6.SS2.p1.8.m8.1.1"><eq id="S6.SS2.p1.8.m8.1.1.1.cmml" xref="S6.SS2.p1.8.m8.1.1.1"></eq><ci id="S6.SS2.p1.8.m8.1.1.2.cmml" xref="S6.SS2.p1.8.m8.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS2.p1.8.m8.1.1.3.cmml" xref="S6.SS2.p1.8.m8.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.8.m8.1c">\epsilon=4</annotation></semantics></math> using the three-range port discretization method are shown in Figure <a href="#S6.F3" title="Figure 3 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, while the results for <math id="S6.SS2.p1.9.m9.1" class="ltx_Math" alttext="\epsilon=4" display="inline"><semantics id="S6.SS2.p1.9.m9.1a"><mrow id="S6.SS2.p1.9.m9.1.1" xref="S6.SS2.p1.9.m9.1.1.cmml"><mi id="S6.SS2.p1.9.m9.1.1.2" xref="S6.SS2.p1.9.m9.1.1.2.cmml">ϵ</mi><mo id="S6.SS2.p1.9.m9.1.1.1" xref="S6.SS2.p1.9.m9.1.1.1.cmml">=</mo><mn id="S6.SS2.p1.9.m9.1.1.3" xref="S6.SS2.p1.9.m9.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.9.m9.1b"><apply id="S6.SS2.p1.9.m9.1.1.cmml" xref="S6.SS2.p1.9.m9.1.1"><eq id="S6.SS2.p1.9.m9.1.1.1.cmml" xref="S6.SS2.p1.9.m9.1.1.1"></eq><ci id="S6.SS2.p1.9.m9.1.1.2.cmml" xref="S6.SS2.p1.9.m9.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS2.p1.9.m9.1.1.3.cmml" xref="S6.SS2.p1.9.m9.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.9.m9.1c">\epsilon=4</annotation></semantics></math> using the hierarchical discretization method are shown in Figure <a href="#S6.F4" title="Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.5" class="ltx_p">The unsupervised clustering quality scores are shown in Figure <a href="#S6.F3.sf1" title="In Figure 3 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3a</span></a> and Figure <a href="#S6.F4.sf1" title="In Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4a</span></a>. For Silhouette higher scores represent better clusters, for Davies-Bouldin and S_Dbw lower scores represent better clusters. The dotted vertical line marks the selected <math id="S6.SS2.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.p2.1.m1.1a"><mi id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.1b"><ci id="S6.SS2.p2.1.m1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.1c">K</annotation></semantics></math> for each discretization method. For the three-range discretization, the Silhouette score is maximized at <math id="S6.SS2.p2.2.m2.1" class="ltx_Math" alttext="K=16" display="inline"><semantics id="S6.SS2.p2.2.m2.1a"><mrow id="S6.SS2.p2.2.m2.1.1" xref="S6.SS2.p2.2.m2.1.1.cmml"><mi id="S6.SS2.p2.2.m2.1.1.2" xref="S6.SS2.p2.2.m2.1.1.2.cmml">K</mi><mo id="S6.SS2.p2.2.m2.1.1.1" xref="S6.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS2.p2.2.m2.1.1.3" xref="S6.SS2.p2.2.m2.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.2.m2.1b"><apply id="S6.SS2.p2.2.m2.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1"><eq id="S6.SS2.p2.2.m2.1.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1.1"></eq><ci id="S6.SS2.p2.2.m2.1.1.2.cmml" xref="S6.SS2.p2.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.p2.2.m2.1.1.3.cmml" xref="S6.SS2.p2.2.m2.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.2.m2.1c">K=16</annotation></semantics></math>, and the Davies-Bouldin score shows a dip at the same point. For S_Dbw the score is monotonously decreasing; however, 16 is a good number of clusters based on the elbow method. For the hierarchical discretization method, the Silhouette score is maximized at <math id="S6.SS2.p2.3.m3.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S6.SS2.p2.3.m3.1a"><mrow id="S6.SS2.p2.3.m3.1.1" xref="S6.SS2.p2.3.m3.1.1.cmml"><mi id="S6.SS2.p2.3.m3.1.1.2" xref="S6.SS2.p2.3.m3.1.1.2.cmml">K</mi><mo id="S6.SS2.p2.3.m3.1.1.1" xref="S6.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS2.p2.3.m3.1.1.3" xref="S6.SS2.p2.3.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.3.m3.1b"><apply id="S6.SS2.p2.3.m3.1.1.cmml" xref="S6.SS2.p2.3.m3.1.1"><eq id="S6.SS2.p2.3.m3.1.1.1.cmml" xref="S6.SS2.p2.3.m3.1.1.1"></eq><ci id="S6.SS2.p2.3.m3.1.1.2.cmml" xref="S6.SS2.p2.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.p2.3.m3.1.1.3.cmml" xref="S6.SS2.p2.3.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.3.m3.1c">K=8</annotation></semantics></math> and both Davies-Bouldin and S_Dbw show a dip at that point. A 2D projection of the model fingerprints and the clustering results is represented in Figure <a href="#S6.F3.sf3" title="In Figure 3 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3c</span></a> with <math id="S6.SS2.p2.4.m4.1" class="ltx_Math" alttext="K=16" display="inline"><semantics id="S6.SS2.p2.4.m4.1a"><mrow id="S6.SS2.p2.4.m4.1.1" xref="S6.SS2.p2.4.m4.1.1.cmml"><mi id="S6.SS2.p2.4.m4.1.1.2" xref="S6.SS2.p2.4.m4.1.1.2.cmml">K</mi><mo id="S6.SS2.p2.4.m4.1.1.1" xref="S6.SS2.p2.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS2.p2.4.m4.1.1.3" xref="S6.SS2.p2.4.m4.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.4.m4.1b"><apply id="S6.SS2.p2.4.m4.1.1.cmml" xref="S6.SS2.p2.4.m4.1.1"><eq id="S6.SS2.p2.4.m4.1.1.1.cmml" xref="S6.SS2.p2.4.m4.1.1.1"></eq><ci id="S6.SS2.p2.4.m4.1.1.2.cmml" xref="S6.SS2.p2.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.p2.4.m4.1.1.3.cmml" xref="S6.SS2.p2.4.m4.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.4.m4.1c">K=16</annotation></semantics></math> and Figure <a href="#S6.F4.sf3" title="In Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4c</span></a> with <math id="S6.SS2.p2.5.m5.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S6.SS2.p2.5.m5.1a"><mrow id="S6.SS2.p2.5.m5.1.1" xref="S6.SS2.p2.5.m5.1.1.cmml"><mi id="S6.SS2.p2.5.m5.1.1.2" xref="S6.SS2.p2.5.m5.1.1.2.cmml">K</mi><mo id="S6.SS2.p2.5.m5.1.1.1" xref="S6.SS2.p2.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS2.p2.5.m5.1.1.3" xref="S6.SS2.p2.5.m5.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.5.m5.1b"><apply id="S6.SS2.p2.5.m5.1.1.cmml" xref="S6.SS2.p2.5.m5.1.1"><eq id="S6.SS2.p2.5.m5.1.1.1.cmml" xref="S6.SS2.p2.5.m5.1.1.1"></eq><ci id="S6.SS2.p2.5.m5.1.1.2.cmml" xref="S6.SS2.p2.5.m5.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.p2.5.m5.1.1.3.cmml" xref="S6.SS2.p2.5.m5.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.5.m5.1c">K=8</annotation></semantics></math>.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.3" class="ltx_p">Due to the differences in the clustering results depending on the port discretization strategy, we perform an additional experiment. For each strategy, we measure the similarity between the K-means clustering labels and the ground truth clustering using the adjusted Rand index, adjusted mutual information score and the V-measure score. To create the ground truth labeling, we assign each instance a label based on its template type according to the data in Table <a href="#S4.T1" title="TABLE I ‣ IV-A1 City network devices ‣ IV-A IoT Testbed ‣ IV IoT Testbed and Experimental Setup ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> (12 different labels). The results are shown in Figure <a href="#S6.F3.sf2" title="In Figure 3 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3b</span></a> and Figure <a href="#S6.F4.sf2" title="In Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4b</span></a>. For the three-port discretization, the score is maximized when <math id="S6.SS2.p3.1.m1.1" class="ltx_Math" alttext="K=12" display="inline"><semantics id="S6.SS2.p3.1.m1.1a"><mrow id="S6.SS2.p3.1.m1.1.1" xref="S6.SS2.p3.1.m1.1.1.cmml"><mi id="S6.SS2.p3.1.m1.1.1.2" xref="S6.SS2.p3.1.m1.1.1.2.cmml">K</mi><mo id="S6.SS2.p3.1.m1.1.1.1" xref="S6.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS2.p3.1.m1.1.1.3" xref="S6.SS2.p3.1.m1.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.1.m1.1b"><apply id="S6.SS2.p3.1.m1.1.1.cmml" xref="S6.SS2.p3.1.m1.1.1"><eq id="S6.SS2.p3.1.m1.1.1.1.cmml" xref="S6.SS2.p3.1.m1.1.1.1"></eq><ci id="S6.SS2.p3.1.m1.1.1.2.cmml" xref="S6.SS2.p3.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.p3.1.m1.1.1.3.cmml" xref="S6.SS2.p3.1.m1.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.1.m1.1c">K=12</annotation></semantics></math> (in contrast to the <math id="S6.SS2.p3.2.m2.1" class="ltx_Math" alttext="K=16" display="inline"><semantics id="S6.SS2.p3.2.m2.1a"><mrow id="S6.SS2.p3.2.m2.1.1" xref="S6.SS2.p3.2.m2.1.1.cmml"><mi id="S6.SS2.p3.2.m2.1.1.2" xref="S6.SS2.p3.2.m2.1.1.2.cmml">K</mi><mo id="S6.SS2.p3.2.m2.1.1.1" xref="S6.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS2.p3.2.m2.1.1.3" xref="S6.SS2.p3.2.m2.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.2.m2.1b"><apply id="S6.SS2.p3.2.m2.1.1.cmml" xref="S6.SS2.p3.2.m2.1.1"><eq id="S6.SS2.p3.2.m2.1.1.1.cmml" xref="S6.SS2.p3.2.m2.1.1.1"></eq><ci id="S6.SS2.p3.2.m2.1.1.2.cmml" xref="S6.SS2.p3.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.p3.2.m2.1.1.3.cmml" xref="S6.SS2.p3.2.m2.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.2.m2.1c">K=16</annotation></semantics></math> from the internal validation metrics). The results for the hierarchical discretization method in Figure <a href="#S6.F4.sf2" title="In Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4b</span></a> show a maximum in <math id="S6.SS2.p3.3.m3.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S6.SS2.p3.3.m3.1a"><mrow id="S6.SS2.p3.3.m3.1.1" xref="S6.SS2.p3.3.m3.1.1.cmml"><mi id="S6.SS2.p3.3.m3.1.1.2" xref="S6.SS2.p3.3.m3.1.1.2.cmml">K</mi><mo id="S6.SS2.p3.3.m3.1.1.1" xref="S6.SS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS2.p3.3.m3.1.1.3" xref="S6.SS2.p3.3.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.3.m3.1b"><apply id="S6.SS2.p3.3.m3.1.1.cmml" xref="S6.SS2.p3.3.m3.1.1"><eq id="S6.SS2.p3.3.m3.1.1.1.cmml" xref="S6.SS2.p3.3.m3.1.1.1"></eq><ci id="S6.SS2.p3.3.m3.1.1.2.cmml" xref="S6.SS2.p3.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.p3.3.m3.1.1.3.cmml" xref="S6.SS2.p3.3.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.3.m3.1c">K=8</annotation></semantics></math> (same results as with the internal validation metrics) and overall higher scores compared to the previous method.</p>
</div>
<div id="S6.SS2.p4" class="ltx_para">
<p id="S6.SS2.p4.3" class="ltx_p">Using the hierarchical discretization method, we obtain an agreement in the optimal value for <math id="S6.SS2.p4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.p4.1.m1.1a"><mi id="S6.SS2.p4.1.m1.1.1" xref="S6.SS2.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p4.1.m1.1b"><ci id="S6.SS2.p4.1.m1.1.1.cmml" xref="S6.SS2.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p4.1.m1.1c">K</annotation></semantics></math> between the unsupervised clustering and the similarity with the ground truth scores. It also creates a clearer distinction between the clusters (Figure <a href="#S6.F4.sf3" title="In Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4c</span></a>) compared to the three-port discretization method (Figure <a href="#S6.F3.sf3" title="In Figure 3 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3c</span></a>). Additionally, it may be desirable to lean towards small <math id="S6.SS2.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.p4.2.m2.1a"><mi id="S6.SS2.p4.2.m2.1.1" xref="S6.SS2.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p4.2.m2.1b"><ci id="S6.SS2.p4.2.m2.1.1.cmml" xref="S6.SS2.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p4.2.m2.1c">K</annotation></semantics></math> values so that the FL process benefits from a larger cohort size for each cluster. From now on, we are going to use the hierarchical discretization method and <math id="S6.SS2.p4.3.m3.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S6.SS2.p4.3.m3.1a"><mrow id="S6.SS2.p4.3.m3.1.1" xref="S6.SS2.p4.3.m3.1.1.cmml"><mi id="S6.SS2.p4.3.m3.1.1.2" xref="S6.SS2.p4.3.m3.1.1.2.cmml">K</mi><mo id="S6.SS2.p4.3.m3.1.1.1" xref="S6.SS2.p4.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS2.p4.3.m3.1.1.3" xref="S6.SS2.p4.3.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p4.3.m3.1b"><apply id="S6.SS2.p4.3.m3.1.1.cmml" xref="S6.SS2.p4.3.m3.1.1"><eq id="S6.SS2.p4.3.m3.1.1.1.cmml" xref="S6.SS2.p4.3.m3.1.1.1"></eq><ci id="S6.SS2.p4.3.m3.1.1.2.cmml" xref="S6.SS2.p4.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.p4.3.m3.1.1.3.cmml" xref="S6.SS2.p4.3.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p4.3.m3.1c">K=8</annotation></semantics></math> for the rest of the experimentation.</p>
</div>
<div id="S6.SS2.p5" class="ltx_para">
<p id="S6.SS2.p5.2" class="ltx_p">In real deployment settings, where there might be no ground truth labels for the device types, only unsupervised internal clustering validation metrics will be available to analyze the clustering quality. Hence, from the experimental results, we infer that in order to select the number of clusters <math id="S6.SS2.p5.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.p5.1.m1.1a"><mi id="S6.SS2.p5.1.m1.1.1" xref="S6.SS2.p5.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p5.1.m1.1b"><ci id="S6.SS2.p5.1.m1.1.1.cmml" xref="S6.SS2.p5.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p5.1.m1.1c">K</annotation></semantics></math>, a robust approach is first to consider the value that maximizes the Silhouette score. In cases where there are different values of <math id="S6.SS2.p5.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.p5.2.m2.1a"><mi id="S6.SS2.p5.2.m2.1.1" xref="S6.SS2.p5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p5.2.m2.1b"><ci id="S6.SS2.p5.2.m2.1.1.cmml" xref="S6.SS2.p5.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p5.2.m2.1c">K</annotation></semantics></math> with similar scores, break ties by considering the Davies-Bouldin and S_Dbw metrics.</p>
</div>
<div id="S6.SS2.p6" class="ltx_para">
<p id="S6.SS2.p6.1" class="ltx_p">The device clustering results from Figure <a href="#S6.F4.sf3" title="In Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4c</span></a> are shown in Table <a href="#S6.T4" title="TABLE IV ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. All the IP camera related devices are grouped into the same cluster. Interestingly, for devices of the same type, the clustering method can distinguish between those communicating via plain text or over an encrypted channel; for example, the Predictive maintenance devices in Cluster 5 and Cluster 6 or the Combined cycle in Cluster 2 and Cluster 7. Clusters 0, 2 and 4 are composed of heterogeneous devices; however, the devices in the same cluster communicate using the same primary protocol: MQTT, CoAP and RTSP, respectively.</p>
</div>
<div id="S6.SS2.p7" class="ltx_para">
<p id="S6.SS2.p7.7" class="ltx_p">Regarding the clustering results for the other tested values of <math id="S6.SS2.p7.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS2.p7.1.m1.1a"><mi id="S6.SS2.p7.1.m1.1.1" xref="S6.SS2.p7.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p7.1.m1.1b"><ci id="S6.SS2.p7.1.m1.1.1.cmml" xref="S6.SS2.p7.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p7.1.m1.1c">\epsilon</annotation></semantics></math>, the results in the <math id="S6.SS2.p7.2.m2.1" class="ltx_Math" alttext="\epsilon=8" display="inline"><semantics id="S6.SS2.p7.2.m2.1a"><mrow id="S6.SS2.p7.2.m2.1.1" xref="S6.SS2.p7.2.m2.1.1.cmml"><mi id="S6.SS2.p7.2.m2.1.1.2" xref="S6.SS2.p7.2.m2.1.1.2.cmml">ϵ</mi><mo id="S6.SS2.p7.2.m2.1.1.1" xref="S6.SS2.p7.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS2.p7.2.m2.1.1.3" xref="S6.SS2.p7.2.m2.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p7.2.m2.1b"><apply id="S6.SS2.p7.2.m2.1.1.cmml" xref="S6.SS2.p7.2.m2.1.1"><eq id="S6.SS2.p7.2.m2.1.1.1.cmml" xref="S6.SS2.p7.2.m2.1.1.1"></eq><ci id="S6.SS2.p7.2.m2.1.1.2.cmml" xref="S6.SS2.p7.2.m2.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS2.p7.2.m2.1.1.3.cmml" xref="S6.SS2.p7.2.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p7.2.m2.1c">\epsilon=8</annotation></semantics></math> case are very similar to the discussed <math id="S6.SS2.p7.3.m3.1" class="ltx_Math" alttext="\epsilon=4" display="inline"><semantics id="S6.SS2.p7.3.m3.1a"><mrow id="S6.SS2.p7.3.m3.1.1" xref="S6.SS2.p7.3.m3.1.1.cmml"><mi id="S6.SS2.p7.3.m3.1.1.2" xref="S6.SS2.p7.3.m3.1.1.2.cmml">ϵ</mi><mo id="S6.SS2.p7.3.m3.1.1.1" xref="S6.SS2.p7.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS2.p7.3.m3.1.1.3" xref="S6.SS2.p7.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p7.3.m3.1b"><apply id="S6.SS2.p7.3.m3.1.1.cmml" xref="S6.SS2.p7.3.m3.1.1"><eq id="S6.SS2.p7.3.m3.1.1.1.cmml" xref="S6.SS2.p7.3.m3.1.1.1"></eq><ci id="S6.SS2.p7.3.m3.1.1.2.cmml" xref="S6.SS2.p7.3.m3.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS2.p7.3.m3.1.1.3.cmml" xref="S6.SS2.p7.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p7.3.m3.1c">\epsilon=4</annotation></semantics></math> case, where the unsupervised and supervised clustering validation metrics agree on the optimal number of groups. However, in some cases, the number of clusters decreases to 7, merging the groups of the same device types that communicate in plain or over an encrypted channel. In the <math id="S6.SS2.p7.4.m4.1" class="ltx_Math" alttext="\epsilon=2" display="inline"><semantics id="S6.SS2.p7.4.m4.1a"><mrow id="S6.SS2.p7.4.m4.1.1" xref="S6.SS2.p7.4.m4.1.1.cmml"><mi id="S6.SS2.p7.4.m4.1.1.2" xref="S6.SS2.p7.4.m4.1.1.2.cmml">ϵ</mi><mo id="S6.SS2.p7.4.m4.1.1.1" xref="S6.SS2.p7.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS2.p7.4.m4.1.1.3" xref="S6.SS2.p7.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p7.4.m4.1b"><apply id="S6.SS2.p7.4.m4.1.1.cmml" xref="S6.SS2.p7.4.m4.1.1"><eq id="S6.SS2.p7.4.m4.1.1.1.cmml" xref="S6.SS2.p7.4.m4.1.1.1"></eq><ci id="S6.SS2.p7.4.m4.1.1.2.cmml" xref="S6.SS2.p7.4.m4.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS2.p7.4.m4.1.1.3.cmml" xref="S6.SS2.p7.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p7.4.m4.1c">\epsilon=2</annotation></semantics></math> case, the number of clusters according to the unsupervised metrics is 9, and in the <math id="S6.SS2.p7.5.m5.1" class="ltx_Math" alttext="\epsilon=1" display="inline"><semantics id="S6.SS2.p7.5.m5.1a"><mrow id="S6.SS2.p7.5.m5.1.1" xref="S6.SS2.p7.5.m5.1.1.cmml"><mi id="S6.SS2.p7.5.m5.1.1.2" xref="S6.SS2.p7.5.m5.1.1.2.cmml">ϵ</mi><mo id="S6.SS2.p7.5.m5.1.1.1" xref="S6.SS2.p7.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS2.p7.5.m5.1.1.3" xref="S6.SS2.p7.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p7.5.m5.1b"><apply id="S6.SS2.p7.5.m5.1.1.cmml" xref="S6.SS2.p7.5.m5.1.1"><eq id="S6.SS2.p7.5.m5.1.1.1.cmml" xref="S6.SS2.p7.5.m5.1.1.1"></eq><ci id="S6.SS2.p7.5.m5.1.1.2.cmml" xref="S6.SS2.p7.5.m5.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS2.p7.5.m5.1.1.3.cmml" xref="S6.SS2.p7.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p7.5.m5.1c">\epsilon=1</annotation></semantics></math> case, it is increased to 11. Both cases tend to split the groups formed by the IP camera devices and Predictive maintenance ones. For <math id="S6.SS2.p7.6.m6.1" class="ltx_Math" alttext="\epsilon=16" display="inline"><semantics id="S6.SS2.p7.6.m6.1a"><mrow id="S6.SS2.p7.6.m6.1.1" xref="S6.SS2.p7.6.m6.1.1.cmml"><mi id="S6.SS2.p7.6.m6.1.1.2" xref="S6.SS2.p7.6.m6.1.1.2.cmml">ϵ</mi><mo id="S6.SS2.p7.6.m6.1.1.1" xref="S6.SS2.p7.6.m6.1.1.1.cmml">=</mo><mn id="S6.SS2.p7.6.m6.1.1.3" xref="S6.SS2.p7.6.m6.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p7.6.m6.1b"><apply id="S6.SS2.p7.6.m6.1.1.cmml" xref="S6.SS2.p7.6.m6.1.1"><eq id="S6.SS2.p7.6.m6.1.1.1.cmml" xref="S6.SS2.p7.6.m6.1.1.1"></eq><ci id="S6.SS2.p7.6.m6.1.1.2.cmml" xref="S6.SS2.p7.6.m6.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS2.p7.6.m6.1.1.3.cmml" xref="S6.SS2.p7.6.m6.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p7.6.m6.1c">\epsilon=16</annotation></semantics></math> and 32, the number of identified clusters using unsupervised metrics also tends to increase to around 11 and 17, respectively; moreover, for both cases, the supervised metrics still show the optimum at 8, indicating a discrepancy between the unsupervised and supervised metrics for higher values of <math id="S6.SS2.p7.7.m7.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS2.p7.7.m7.1a"><mi id="S6.SS2.p7.7.m7.1.1" xref="S6.SS2.p7.7.m7.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p7.7.m7.1b"><ci id="S6.SS2.p7.7.m7.1.1.cmml" xref="S6.SS2.p7.7.m7.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p7.7.m7.1c">\epsilon</annotation></semantics></math>.</p>
</div>
<figure id="S6.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x3.png" id="S6.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Unsupervised clustering quality scores.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x4.png" id="S6.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Clustering quality scores compared to ground truth labeling.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x5.png" id="S6.F3.sf3.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>2D projection of the model fingerprints clustered into <math id="S6.F3.sf3.2.m1.1" class="ltx_Math" alttext="K=16" display="inline"><semantics id="S6.F3.sf3.2.m1.1b"><mrow id="S6.F3.sf3.2.m1.1.1" xref="S6.F3.sf3.2.m1.1.1.cmml"><mi id="S6.F3.sf3.2.m1.1.1.2" xref="S6.F3.sf3.2.m1.1.1.2.cmml">K</mi><mo id="S6.F3.sf3.2.m1.1.1.1" xref="S6.F3.sf3.2.m1.1.1.1.cmml">=</mo><mn id="S6.F3.sf3.2.m1.1.1.3" xref="S6.F3.sf3.2.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F3.sf3.2.m1.1c"><apply id="S6.F3.sf3.2.m1.1.1.cmml" xref="S6.F3.sf3.2.m1.1.1"><eq id="S6.F3.sf3.2.m1.1.1.1.cmml" xref="S6.F3.sf3.2.m1.1.1.1"></eq><ci id="S6.F3.sf3.2.m1.1.1.2.cmml" xref="S6.F3.sf3.2.m1.1.1.2">𝐾</ci><cn type="integer" id="S6.F3.sf3.2.m1.1.1.3.cmml" xref="S6.F3.sf3.2.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.sf3.2.m1.1d">K=16</annotation></semantics></math> groups.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Device clustering results for <math id="S6.F3.2.m1.1" class="ltx_Math" alttext="\epsilon=4" display="inline"><semantics id="S6.F3.2.m1.1b"><mrow id="S6.F3.2.m1.1.1" xref="S6.F3.2.m1.1.1.cmml"><mi id="S6.F3.2.m1.1.1.2" xref="S6.F3.2.m1.1.1.2.cmml">ϵ</mi><mo id="S6.F3.2.m1.1.1.1" xref="S6.F3.2.m1.1.1.1.cmml">=</mo><mn id="S6.F3.2.m1.1.1.3" xref="S6.F3.2.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F3.2.m1.1c"><apply id="S6.F3.2.m1.1.1.cmml" xref="S6.F3.2.m1.1.1"><eq id="S6.F3.2.m1.1.1.1.cmml" xref="S6.F3.2.m1.1.1.1"></eq><ci id="S6.F3.2.m1.1.1.2.cmml" xref="S6.F3.2.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.F3.2.m1.1.1.3.cmml" xref="S6.F3.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.2.m1.1d">\epsilon=4</annotation></semantics></math> using the three-range discretization strategy for the source and destination ports.</figcaption>
</figure>
<figure id="S6.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x6.png" id="S6.F4.sf1.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Unsupervised clustering quality scores.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x7.png" id="S6.F4.sf2.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Clustering quality scores compared to ground truth labeling.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x8.png" id="S6.F4.sf3.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>2D projection of the model fingerprints clustered into <math id="S6.F4.sf3.2.m1.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S6.F4.sf3.2.m1.1b"><mrow id="S6.F4.sf3.2.m1.1.1" xref="S6.F4.sf3.2.m1.1.1.cmml"><mi id="S6.F4.sf3.2.m1.1.1.2" xref="S6.F4.sf3.2.m1.1.1.2.cmml">K</mi><mo id="S6.F4.sf3.2.m1.1.1.1" xref="S6.F4.sf3.2.m1.1.1.1.cmml">=</mo><mn id="S6.F4.sf3.2.m1.1.1.3" xref="S6.F4.sf3.2.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.sf3.2.m1.1c"><apply id="S6.F4.sf3.2.m1.1.1.cmml" xref="S6.F4.sf3.2.m1.1.1"><eq id="S6.F4.sf3.2.m1.1.1.1.cmml" xref="S6.F4.sf3.2.m1.1.1.1"></eq><ci id="S6.F4.sf3.2.m1.1.1.2.cmml" xref="S6.F4.sf3.2.m1.1.1.2">𝐾</ci><cn type="integer" id="S6.F4.sf3.2.m1.1.1.3.cmml" xref="S6.F4.sf3.2.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.sf3.2.m1.1d">K=8</annotation></semantics></math> groups.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Device clustering results for <math id="S6.F4.2.m1.1" class="ltx_Math" alttext="\epsilon=4" display="inline"><semantics id="S6.F4.2.m1.1b"><mrow id="S6.F4.2.m1.1.1" xref="S6.F4.2.m1.1.1.cmml"><mi id="S6.F4.2.m1.1.1.2" xref="S6.F4.2.m1.1.1.2.cmml">ϵ</mi><mo id="S6.F4.2.m1.1.1.1" xref="S6.F4.2.m1.1.1.1.cmml">=</mo><mn id="S6.F4.2.m1.1.1.3" xref="S6.F4.2.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.2.m1.1c"><apply id="S6.F4.2.m1.1.1.cmml" xref="S6.F4.2.m1.1.1"><eq id="S6.F4.2.m1.1.1.1.cmml" xref="S6.F4.2.m1.1.1.1"></eq><ci id="S6.F4.2.m1.1.1.2.cmml" xref="S6.F4.2.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.F4.2.m1.1.1.3.cmml" xref="S6.F4.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.2.m1.1d">\epsilon=4</annotation></semantics></math> using the hierarchical discretization strategy for the source and destination ports.</figcaption>
</figure>
<figure id="S6.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Unsupervised clustering results using the hierarchical port discretization strategy for <math id="S6.T4.3.m1.1" class="ltx_Math" alttext="\epsilon=4" display="inline"><semantics id="S6.T4.3.m1.1b"><mrow id="S6.T4.3.m1.1.1" xref="S6.T4.3.m1.1.1.cmml"><mi id="S6.T4.3.m1.1.1.2" xref="S6.T4.3.m1.1.1.2.cmml">ϵ</mi><mo id="S6.T4.3.m1.1.1.1" xref="S6.T4.3.m1.1.1.1.cmml">=</mo><mn id="S6.T4.3.m1.1.1.3" xref="S6.T4.3.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.3.m1.1c"><apply id="S6.T4.3.m1.1.1.cmml" xref="S6.T4.3.m1.1.1"><eq id="S6.T4.3.m1.1.1.1.cmml" xref="S6.T4.3.m1.1.1.1"></eq><ci id="S6.T4.3.m1.1.1.2.cmml" xref="S6.T4.3.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.T4.3.m1.1.1.3.cmml" xref="S6.T4.3.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.3.m1.1d">\epsilon=4</annotation></semantics></math> and <math id="S6.T4.4.m2.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S6.T4.4.m2.1b"><mrow id="S6.T4.4.m2.1.1" xref="S6.T4.4.m2.1.1.cmml"><mi id="S6.T4.4.m2.1.1.2" xref="S6.T4.4.m2.1.1.2.cmml">K</mi><mo id="S6.T4.4.m2.1.1.1" xref="S6.T4.4.m2.1.1.1.cmml">=</mo><mn id="S6.T4.4.m2.1.1.3" xref="S6.T4.4.m2.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.4.m2.1c"><apply id="S6.T4.4.m2.1.1.cmml" xref="S6.T4.4.m2.1.1"><eq id="S6.T4.4.m2.1.1.1.cmml" xref="S6.T4.4.m2.1.1.1"></eq><ci id="S6.T4.4.m2.1.1.2.cmml" xref="S6.T4.4.m2.1.1.2">𝐾</ci><cn type="integer" id="S6.T4.4.m2.1.1.3.cmml" xref="S6.T4.4.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.4.m2.1d">K=8</annotation></semantics></math>.</figcaption>
<table id="S6.T4.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T4.9.1.1" class="ltx_tr">
<th id="S6.T4.9.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><span id="S6.T4.9.1.1.1.1" class="ltx_text" style="font-size:90%;">Cluster name</span></th>
<th id="S6.T4.9.1.1.2" class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt">
<span id="S6.T4.9.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.1.1.2.1.1" class="ltx_p"><span id="S6.T4.9.1.1.2.1.1.1" class="ltx_text" style="font-size:90%;">Cluster contents</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T4.9.2.1" class="ltx_tr">
<th id="S6.T4.9.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T4.9.2.1.1.1" class="ltx_text" style="font-size:90%;">Cluster 0</span></th>
<td id="S6.T4.9.2.1.2" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S6.T4.9.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.2.1.2.1.1" class="ltx_p"><span id="S6.T4.9.2.1.2.1.1.1" class="ltx_text" style="font-size:90%;">Air quality (x1), Building monitor (x5), Domotic monitor (x5)</span></span>
</span>
</td>
</tr>
<tr id="S6.T4.9.3.2" class="ltx_tr">
<th id="S6.T4.9.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.9.3.2.1.1" class="ltx_text" style="font-size:90%;">Cluster 1</span></th>
<td id="S6.T4.9.3.2.2" class="ltx_td ltx_align_justify">
<span id="S6.T4.9.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.3.2.2.1.1" class="ltx_p"><span id="S6.T4.9.3.2.2.1.1.1" class="ltx_text" style="font-size:90%;">Hydraulic system (x15)</span></span>
</span>
</td>
</tr>
<tr id="S6.T4.9.4.3" class="ltx_tr">
<th id="S6.T4.9.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.9.4.3.1.1" class="ltx_text" style="font-size:90%;">Cluster 2</span></th>
<td id="S6.T4.9.4.3.2" class="ltx_td ltx_align_justify">
<span id="S6.T4.9.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.4.3.2.1.1" class="ltx_p"><span id="S6.T4.9.4.3.2.1.1.1" class="ltx_text" style="font-size:90%;">City power (x1), Combined cycle (x10)</span></span>
</span>
</td>
</tr>
<tr id="S6.T4.9.5.4" class="ltx_tr">
<th id="S6.T4.9.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.9.5.4.1.1" class="ltx_text" style="font-size:90%;">Cluster 3</span></th>
<td id="S6.T4.9.5.4.2" class="ltx_td ltx_align_justify">
<span id="S6.T4.9.5.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.5.4.2.1.1" class="ltx_p"><span id="S6.T4.9.5.4.2.1.1.1" class="ltx_text" style="font-size:90%;">Cooler motor (x15)</span></span>
</span>
</td>
</tr>
<tr id="S6.T4.9.6.5" class="ltx_tr">
<th id="S6.T4.9.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.9.6.5.1.1" class="ltx_text" style="font-size:90%;">Cluster 4</span></th>
<td id="S6.T4.9.6.5.2" class="ltx_td ltx_align_justify">
<span id="S6.T4.9.6.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.6.5.2.1.1" class="ltx_p"><span id="S6.T4.9.6.5.2.1.1.1" class="ltx_text" style="font-size:90%;">IP camera museum (x2), IP camera street (x2), IP camera consumer (x2)</span></span>
</span>
</td>
</tr>
<tr id="S6.T4.9.7.6" class="ltx_tr">
<th id="S6.T4.9.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.9.7.6.1.1" class="ltx_text" style="font-size:90%;">Cluster 5</span></th>
<td id="S6.T4.9.7.6.2" class="ltx_td ltx_align_justify">
<span id="S6.T4.9.7.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.7.6.2.1.1" class="ltx_p"><span id="S6.T4.9.7.6.2.1.1.1" class="ltx_text" style="font-size:90%;">Predictive maintenance (x10)</span></span>
</span>
</td>
</tr>
<tr id="S6.T4.9.8.7" class="ltx_tr">
<th id="S6.T4.9.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.9.8.7.1.1" class="ltx_text" style="font-size:90%;">Cluster 6</span></th>
<td id="S6.T4.9.8.7.2" class="ltx_td ltx_align_justify">
<span id="S6.T4.9.8.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.8.7.2.1.1" class="ltx_p"><span id="S6.T4.9.8.7.2.1.1.1" class="ltx_text" style="font-size:90%;">Predictive maintenance (x5)</span></span>
</span>
</td>
</tr>
<tr id="S6.T4.9.9.8" class="ltx_tr">
<th id="S6.T4.9.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S6.T4.9.9.8.1.1" class="ltx_text" style="font-size:90%;">Cluster 7</span></th>
<td id="S6.T4.9.9.8.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S6.T4.9.9.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T4.9.9.8.2.1.1" class="ltx_p"><span id="S6.T4.9.9.8.2.1.1.1" class="ltx_text" style="font-size:90%;">Combined cycle tls (x5)</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S6.SS2.p8" class="ltx_para">
<p id="S6.SS2.p8.1" class="ltx_p">From Figure <a href="#S6.F4.sf3" title="In Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4c</span></a>, while some clusters are clearly separated from the rest, others, such as clusters 0, 1 and 7 or clusters 6 and 5, seem to be close in the 2D projection. The dimensionality of the model fingerprints is the same as the number of PCA components needed to explain at least 90% of the model parameter variance, which in this particular case is 23. Figure <a href="#S6.F4.sf3" title="In Figure 4 ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4c</span></a> only shows the first two dimensions, corresponding to approximately 40% of the explained variance. This might indicate that clusters that are close to each other in the 2D representation are also close in the higher-dimensional space. When the training data amount of each device is insufficient or due to the random model initialization influence, the clustering results’ stability might be affected for those groups close to each other. In order to study the clustering stability, we are going to perform an additional experiment.</p>
</div>
<section id="S6.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S6.SS2.SSS1.4.1.1" class="ltx_text">VI-B</span>1 </span>Cluster stability for varying training data size</h4>

<div id="S6.SS2.SSS1.p1" class="ltx_para">
<p id="S6.SS2.SSS1.p1.2" class="ltx_p">In this experiment, we will repeat the device clustering process for the <math id="S6.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\epsilon=4" display="inline"><semantics id="S6.SS2.SSS1.p1.1.m1.1a"><mrow id="S6.SS2.SSS1.p1.1.m1.1.1" xref="S6.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S6.SS2.SSS1.p1.1.m1.1.1.2" xref="S6.SS2.SSS1.p1.1.m1.1.1.2.cmml">ϵ</mi><mo id="S6.SS2.SSS1.p1.1.m1.1.1.1" xref="S6.SS2.SSS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS2.SSS1.p1.1.m1.1.1.3" xref="S6.SS2.SSS1.p1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p1.1.m1.1b"><apply id="S6.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S6.SS2.SSS1.p1.1.m1.1.1"><eq id="S6.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S6.SS2.SSS1.p1.1.m1.1.1.1"></eq><ci id="S6.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S6.SS2.SSS1.p1.1.m1.1.1.2">italic-ϵ</ci><cn type="integer" id="S6.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S6.SS2.SSS1.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p1.1.m1.1c">\epsilon=4</annotation></semantics></math> and the hierarchical discretization port method case. However, we will vary the fraction of training data used to partially train the models. The server initializes an autoencoder model, and each client will randomly subsample a fraction of its own local training data. The clustering procedure is the same as explained before, only that each client performs local training for <math id="S6.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS2.SSS1.p1.2.m2.1a"><mi id="S6.SS2.SSS1.p1.2.m2.1.1" xref="S6.SS2.SSS1.p1.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p1.2.m2.1b"><ci id="S6.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S6.SS2.SSS1.p1.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p1.2.m2.1c">\epsilon</annotation></semantics></math> epochs using only the specified fraction of the data. A different experiment is conducted for the following fractions: 1%, 10%, 20%, 30%, 40%, 50%, 60%, 70%, 80%, 90% and 99%. All those experiments are going to be further repeated 30 times to account for any variability in the results due to the random model initialization effect at the server and the random subsampling process at each device.</p>
</div>
<div id="S6.SS2.SSS1.p2" class="ltx_para">
<p id="S6.SS2.SSS1.p2.5" class="ltx_p">To measure the cluster stability for varying training data sizes, we select <math id="S6.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S6.SS2.SSS1.p2.1.m1.1a"><mrow id="S6.SS2.SSS1.p2.1.m1.1.1" xref="S6.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S6.SS2.SSS1.p2.1.m1.1.1.2" xref="S6.SS2.SSS1.p2.1.m1.1.1.2.cmml">K</mi><mo id="S6.SS2.SSS1.p2.1.m1.1.1.1" xref="S6.SS2.SSS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS2.SSS1.p2.1.m1.1.1.3" xref="S6.SS2.SSS1.p2.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p2.1.m1.1b"><apply id="S6.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S6.SS2.SSS1.p2.1.m1.1.1"><eq id="S6.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S6.SS2.SSS1.p2.1.m1.1.1.1"></eq><ci id="S6.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S6.SS2.SSS1.p2.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S6.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S6.SS2.SSS1.p2.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p2.1.m1.1c">K=8</annotation></semantics></math> and compare the clustering results of the new experiments with the clustering results obtained in Table <a href="#S6.T4" title="TABLE IV ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. The similarity is measured using the adjusted Rand score. A value of <math id="S6.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.SS2.SSS1.p2.2.m2.1a"><mn id="S6.SS2.SSS1.p2.2.m2.1.1" xref="S6.SS2.SSS1.p2.2.m2.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p2.2.m2.1b"><cn type="float" id="S6.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S6.SS2.SSS1.p2.2.m2.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p2.2.m2.1c">1.0</annotation></semantics></math> is obtained when the clusterings are identical, and values near <math id="S6.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="0.0" display="inline"><semantics id="S6.SS2.SSS1.p2.3.m3.1a"><mn id="S6.SS2.SSS1.p2.3.m3.1.1" xref="S6.SS2.SSS1.p2.3.m3.1.1.cmml">0.0</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p2.3.m3.1b"><cn type="float" id="S6.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S6.SS2.SSS1.p2.3.m3.1.1">0.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p2.3.m3.1c">0.0</annotation></semantics></math> indicate random labeling. The results are shown in Figure <a href="#S6.F5" title="Figure 5 ‣ VI-B1 Cluster stability for varying training data size ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. For training data fractions <math id="S6.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\geq 50\%" display="inline"><semantics id="S6.SS2.SSS1.p2.4.m4.1a"><mrow id="S6.SS2.SSS1.p2.4.m4.1.1" xref="S6.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S6.SS2.SSS1.p2.4.m4.1.1.2" xref="S6.SS2.SSS1.p2.4.m4.1.1.2.cmml"></mi><mo id="S6.SS2.SSS1.p2.4.m4.1.1.1" xref="S6.SS2.SSS1.p2.4.m4.1.1.1.cmml">≥</mo><mrow id="S6.SS2.SSS1.p2.4.m4.1.1.3" xref="S6.SS2.SSS1.p2.4.m4.1.1.3.cmml"><mn id="S6.SS2.SSS1.p2.4.m4.1.1.3.2" xref="S6.SS2.SSS1.p2.4.m4.1.1.3.2.cmml">50</mn><mo id="S6.SS2.SSS1.p2.4.m4.1.1.3.1" xref="S6.SS2.SSS1.p2.4.m4.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p2.4.m4.1b"><apply id="S6.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S6.SS2.SSS1.p2.4.m4.1.1"><geq id="S6.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S6.SS2.SSS1.p2.4.m4.1.1.1"></geq><csymbol cd="latexml" id="S6.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S6.SS2.SSS1.p2.4.m4.1.1.2">absent</csymbol><apply id="S6.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S6.SS2.SSS1.p2.4.m4.1.1.3"><csymbol cd="latexml" id="S6.SS2.SSS1.p2.4.m4.1.1.3.1.cmml" xref="S6.SS2.SSS1.p2.4.m4.1.1.3.1">percent</csymbol><cn type="integer" id="S6.SS2.SSS1.p2.4.m4.1.1.3.2.cmml" xref="S6.SS2.SSS1.p2.4.m4.1.1.3.2">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p2.4.m4.1c">\geq 50\%</annotation></semantics></math>, the majority of runs achieve a score of <math id="S6.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.SS2.SSS1.p2.5.m5.1a"><mn id="S6.SS2.SSS1.p2.5.m5.1.1" xref="S6.SS2.SSS1.p2.5.m5.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p2.5.m5.1b"><cn type="float" id="S6.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S6.SS2.SSS1.p2.5.m5.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p2.5.m5.1c">1.0</annotation></semantics></math>, showing that the clustering results are mostly stable, but some outliers appear. The number of outliers is reduced with increasing training data fraction. When the training data fraction is reduced below 50%, the clustering quality is negatively affected.</p>
</div>
<figure id="S6.F5" class="ltx_figure"><img src="/html/2303.15986/assets/x9.png" id="S6.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="285" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Cluster stability results for varying training data sizes. Each training data fraction percentage shows a boxplot for 30 repetitions of the adjusted Rand score with the clustering results from Table <a href="#S6.T4" title="TABLE IV ‣ VI-B Device Clustering ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> (<math id="S6.F5.2.m1.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S6.F5.2.m1.1b"><mrow id="S6.F5.2.m1.1.1" xref="S6.F5.2.m1.1.1.cmml"><mi id="S6.F5.2.m1.1.1.2" xref="S6.F5.2.m1.1.1.2.cmml">K</mi><mo id="S6.F5.2.m1.1.1.1" xref="S6.F5.2.m1.1.1.1.cmml">=</mo><mn id="S6.F5.2.m1.1.1.3" xref="S6.F5.2.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F5.2.m1.1c"><apply id="S6.F5.2.m1.1.1.cmml" xref="S6.F5.2.m1.1.1"><eq id="S6.F5.2.m1.1.1.1.cmml" xref="S6.F5.2.m1.1.1.1"></eq><ci id="S6.F5.2.m1.1.1.2.cmml" xref="S6.F5.2.m1.1.1.2">𝐾</ci><cn type="integer" id="S6.F5.2.m1.1.1.3.cmml" xref="S6.F5.2.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F5.2.m1.1d">K=8</annotation></semantics></math>). Circles indicate outliers, i.e., samples outside 1.5x of the inter-quartile range. The orange line in each boxplot shows the medians.</figcaption>
</figure>
<div id="S6.SS2.SSS1.p3" class="ltx_para">
<p id="S6.SS2.SSS1.p3.4" class="ltx_p">We also note that for small training data fractions, the optimal value of <math id="S6.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.SSS1.p3.1.m1.1a"><mi id="S6.SS2.SSS1.p3.1.m1.1.1" xref="S6.SS2.SSS1.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p3.1.m1.1b"><ci id="S6.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S6.SS2.SSS1.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p3.1.m1.1c">K</annotation></semantics></math> shown by unsupervised internal clustering validation metrics tends to decrease, is more unstable from repetition to repetition and diverges considerably from the optimal value shown by supervised clustering metrics using the ground truth labeling. The contrary occurs when the training data fraction is <math id="S6.SS2.SSS1.p3.2.m2.1" class="ltx_Math" alttext="\geq 60\%" display="inline"><semantics id="S6.SS2.SSS1.p3.2.m2.1a"><mrow id="S6.SS2.SSS1.p3.2.m2.1.1" xref="S6.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S6.SS2.SSS1.p3.2.m2.1.1.2" xref="S6.SS2.SSS1.p3.2.m2.1.1.2.cmml"></mi><mo id="S6.SS2.SSS1.p3.2.m2.1.1.1" xref="S6.SS2.SSS1.p3.2.m2.1.1.1.cmml">≥</mo><mrow id="S6.SS2.SSS1.p3.2.m2.1.1.3" xref="S6.SS2.SSS1.p3.2.m2.1.1.3.cmml"><mn id="S6.SS2.SSS1.p3.2.m2.1.1.3.2" xref="S6.SS2.SSS1.p3.2.m2.1.1.3.2.cmml">60</mn><mo id="S6.SS2.SSS1.p3.2.m2.1.1.3.1" xref="S6.SS2.SSS1.p3.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p3.2.m2.1b"><apply id="S6.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S6.SS2.SSS1.p3.2.m2.1.1"><geq id="S6.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S6.SS2.SSS1.p3.2.m2.1.1.1"></geq><csymbol cd="latexml" id="S6.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S6.SS2.SSS1.p3.2.m2.1.1.2">absent</csymbol><apply id="S6.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S6.SS2.SSS1.p3.2.m2.1.1.3"><csymbol cd="latexml" id="S6.SS2.SSS1.p3.2.m2.1.1.3.1.cmml" xref="S6.SS2.SSS1.p3.2.m2.1.1.3.1">percent</csymbol><cn type="integer" id="S6.SS2.SSS1.p3.2.m2.1.1.3.2.cmml" xref="S6.SS2.SSS1.p3.2.m2.1.1.3.2">60</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p3.2.m2.1c">\geq 60\%</annotation></semantics></math>, where the unsupervised and supervised metrics are close, and <math id="S6.SS2.SSS1.p3.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S6.SS2.SSS1.p3.3.m3.1a"><mi id="S6.SS2.SSS1.p3.3.m3.1.1" xref="S6.SS2.SSS1.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p3.3.m3.1b"><ci id="S6.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S6.SS2.SSS1.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p3.3.m3.1c">K</annotation></semantics></math> is around <math id="S6.SS2.SSS1.p3.4.m4.1" class="ltx_Math" alttext="8\pm 1" display="inline"><semantics id="S6.SS2.SSS1.p3.4.m4.1a"><mrow id="S6.SS2.SSS1.p3.4.m4.1.1" xref="S6.SS2.SSS1.p3.4.m4.1.1.cmml"><mn id="S6.SS2.SSS1.p3.4.m4.1.1.2" xref="S6.SS2.SSS1.p3.4.m4.1.1.2.cmml">8</mn><mo id="S6.SS2.SSS1.p3.4.m4.1.1.1" xref="S6.SS2.SSS1.p3.4.m4.1.1.1.cmml">±</mo><mn id="S6.SS2.SSS1.p3.4.m4.1.1.3" xref="S6.SS2.SSS1.p3.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p3.4.m4.1b"><apply id="S6.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S6.SS2.SSS1.p3.4.m4.1.1"><csymbol cd="latexml" id="S6.SS2.SSS1.p3.4.m4.1.1.1.cmml" xref="S6.SS2.SSS1.p3.4.m4.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S6.SS2.SSS1.p3.4.m4.1.1.2.cmml" xref="S6.SS2.SSS1.p3.4.m4.1.1.2">8</cn><cn type="integer" id="S6.SS2.SSS1.p3.4.m4.1.1.3.cmml" xref="S6.SS2.SSS1.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p3.4.m4.1c">8\pm 1</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS3.4.1.1" class="ltx_text">VI-C</span> </span><span id="S6.SS3.5.2" class="ltx_text ltx_font_italic">Federated Hyperparameter Tuning</span>
</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.3" class="ltx_p">To select the <span id="S6.SS3.p1.3.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and <span id="S6.SS3.p1.3.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> optimizer algorithms, for each cluster we performed 16 trials consisting of different combinations of SGD and Adam as defined in Table <a href="#S6.T5" title="TABLE V ‣ VI-C Federated Hyperparameter Tuning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>. Client learning rates are fixed to <math id="S6.SS3.p1.1.m1.1" class="ltx_Math" alttext="\eta=1\times 10^{-3}" display="inline"><semantics id="S6.SS3.p1.1.m1.1a"><mrow id="S6.SS3.p1.1.m1.1.1" xref="S6.SS3.p1.1.m1.1.1.cmml"><mi id="S6.SS3.p1.1.m1.1.1.2" xref="S6.SS3.p1.1.m1.1.1.2.cmml">η</mi><mo id="S6.SS3.p1.1.m1.1.1.1" xref="S6.SS3.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S6.SS3.p1.1.m1.1.1.3" xref="S6.SS3.p1.1.m1.1.1.3.cmml"><mn id="S6.SS3.p1.1.m1.1.1.3.2" xref="S6.SS3.p1.1.m1.1.1.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S6.SS3.p1.1.m1.1.1.3.1" xref="S6.SS3.p1.1.m1.1.1.3.1.cmml">×</mo><msup id="S6.SS3.p1.1.m1.1.1.3.3" xref="S6.SS3.p1.1.m1.1.1.3.3.cmml"><mn id="S6.SS3.p1.1.m1.1.1.3.3.2" xref="S6.SS3.p1.1.m1.1.1.3.3.2.cmml">10</mn><mrow id="S6.SS3.p1.1.m1.1.1.3.3.3" xref="S6.SS3.p1.1.m1.1.1.3.3.3.cmml"><mo id="S6.SS3.p1.1.m1.1.1.3.3.3a" xref="S6.SS3.p1.1.m1.1.1.3.3.3.cmml">−</mo><mn id="S6.SS3.p1.1.m1.1.1.3.3.3.2" xref="S6.SS3.p1.1.m1.1.1.3.3.3.2.cmml">3</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.1b"><apply id="S6.SS3.p1.1.m1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1"><eq id="S6.SS3.p1.1.m1.1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1"></eq><ci id="S6.SS3.p1.1.m1.1.1.2.cmml" xref="S6.SS3.p1.1.m1.1.1.2">𝜂</ci><apply id="S6.SS3.p1.1.m1.1.1.3.cmml" xref="S6.SS3.p1.1.m1.1.1.3"><times id="S6.SS3.p1.1.m1.1.1.3.1.cmml" xref="S6.SS3.p1.1.m1.1.1.3.1"></times><cn type="integer" id="S6.SS3.p1.1.m1.1.1.3.2.cmml" xref="S6.SS3.p1.1.m1.1.1.3.2">1</cn><apply id="S6.SS3.p1.1.m1.1.1.3.3.cmml" xref="S6.SS3.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S6.SS3.p1.1.m1.1.1.3.3.1.cmml" xref="S6.SS3.p1.1.m1.1.1.3.3">superscript</csymbol><cn type="integer" id="S6.SS3.p1.1.m1.1.1.3.3.2.cmml" xref="S6.SS3.p1.1.m1.1.1.3.3.2">10</cn><apply id="S6.SS3.p1.1.m1.1.1.3.3.3.cmml" xref="S6.SS3.p1.1.m1.1.1.3.3.3"><minus id="S6.SS3.p1.1.m1.1.1.3.3.3.1.cmml" xref="S6.SS3.p1.1.m1.1.1.3.3.3"></minus><cn type="integer" id="S6.SS3.p1.1.m1.1.1.3.3.3.2.cmml" xref="S6.SS3.p1.1.m1.1.1.3.3.3.2">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.1c">\eta=1\times 10^{-3}</annotation></semantics></math> and the <math id="S6.SS3.p1.2.m2.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S6.SS3.p1.2.m2.1a"><msub id="S6.SS3.p1.2.m2.1.1" xref="S6.SS3.p1.2.m2.1.1.cmml"><mi id="S6.SS3.p1.2.m2.1.1.2" xref="S6.SS3.p1.2.m2.1.1.2.cmml">L</mi><mn id="S6.SS3.p1.2.m2.1.1.3" xref="S6.SS3.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.2.m2.1b"><apply id="S6.SS3.p1.2.m2.1.1.cmml" xref="S6.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS3.p1.2.m2.1.1.1.cmml" xref="S6.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S6.SS3.p1.2.m2.1.1.2.cmml" xref="S6.SS3.p1.2.m2.1.1.2">𝐿</ci><cn type="integer" id="S6.SS3.p1.2.m2.1.1.3.cmml" xref="S6.SS3.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.2.m2.1c">L_{2}</annotation></semantics></math> regularization weight from equation (<a href="#S3.E2" title="In III-D Anomaly Detection Model ‣ III Proposed System Model ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) is set to <math id="S6.SS3.p1.3.m3.1" class="ltx_Math" alttext="\lambda=1\times 10^{-5}" display="inline"><semantics id="S6.SS3.p1.3.m3.1a"><mrow id="S6.SS3.p1.3.m3.1.1" xref="S6.SS3.p1.3.m3.1.1.cmml"><mi id="S6.SS3.p1.3.m3.1.1.2" xref="S6.SS3.p1.3.m3.1.1.2.cmml">λ</mi><mo id="S6.SS3.p1.3.m3.1.1.1" xref="S6.SS3.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S6.SS3.p1.3.m3.1.1.3" xref="S6.SS3.p1.3.m3.1.1.3.cmml"><mn id="S6.SS3.p1.3.m3.1.1.3.2" xref="S6.SS3.p1.3.m3.1.1.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S6.SS3.p1.3.m3.1.1.3.1" xref="S6.SS3.p1.3.m3.1.1.3.1.cmml">×</mo><msup id="S6.SS3.p1.3.m3.1.1.3.3" xref="S6.SS3.p1.3.m3.1.1.3.3.cmml"><mn id="S6.SS3.p1.3.m3.1.1.3.3.2" xref="S6.SS3.p1.3.m3.1.1.3.3.2.cmml">10</mn><mrow id="S6.SS3.p1.3.m3.1.1.3.3.3" xref="S6.SS3.p1.3.m3.1.1.3.3.3.cmml"><mo id="S6.SS3.p1.3.m3.1.1.3.3.3a" xref="S6.SS3.p1.3.m3.1.1.3.3.3.cmml">−</mo><mn id="S6.SS3.p1.3.m3.1.1.3.3.3.2" xref="S6.SS3.p1.3.m3.1.1.3.3.3.2.cmml">5</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.3.m3.1b"><apply id="S6.SS3.p1.3.m3.1.1.cmml" xref="S6.SS3.p1.3.m3.1.1"><eq id="S6.SS3.p1.3.m3.1.1.1.cmml" xref="S6.SS3.p1.3.m3.1.1.1"></eq><ci id="S6.SS3.p1.3.m3.1.1.2.cmml" xref="S6.SS3.p1.3.m3.1.1.2">𝜆</ci><apply id="S6.SS3.p1.3.m3.1.1.3.cmml" xref="S6.SS3.p1.3.m3.1.1.3"><times id="S6.SS3.p1.3.m3.1.1.3.1.cmml" xref="S6.SS3.p1.3.m3.1.1.3.1"></times><cn type="integer" id="S6.SS3.p1.3.m3.1.1.3.2.cmml" xref="S6.SS3.p1.3.m3.1.1.3.2">1</cn><apply id="S6.SS3.p1.3.m3.1.1.3.3.cmml" xref="S6.SS3.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S6.SS3.p1.3.m3.1.1.3.3.1.cmml" xref="S6.SS3.p1.3.m3.1.1.3.3">superscript</csymbol><cn type="integer" id="S6.SS3.p1.3.m3.1.1.3.3.2.cmml" xref="S6.SS3.p1.3.m3.1.1.3.3.2">10</cn><apply id="S6.SS3.p1.3.m3.1.1.3.3.3.cmml" xref="S6.SS3.p1.3.m3.1.1.3.3.3"><minus id="S6.SS3.p1.3.m3.1.1.3.3.3.1.cmml" xref="S6.SS3.p1.3.m3.1.1.3.3.3"></minus><cn type="integer" id="S6.SS3.p1.3.m3.1.1.3.3.3.2.cmml" xref="S6.SS3.p1.3.m3.1.1.3.3.3.2">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.3.m3.1c">\lambda=1\times 10^{-5}</annotation></semantics></math>.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para">
<p id="S6.SS3.p2.1" class="ltx_p">We show the results of the mean evaluation loss progression for 100 FL rounds and all the trials for Clusters 0, 2 and 4 in Figure <a href="#S6.F6" title="Figure 6 ‣ VI-C Federated Hyperparameter Tuning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, as these three clusters are more complex than the others because they are formed by heterogeneous devices. In general, including adaptive optimization methods for <span id="S6.SS3.p2.1.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span>, <span id="S6.SS3.p2.1.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> or both provides faster convergence and smaller losses compared to the standard SGD; however, some combinations have difficulty to converge, showing an increasing loss trend as in Trial 10 for Cluster 0 (Figure <a href="#S6.F6.sf1" title="In Figure 6 ‣ VI-C Federated Hyperparameter Tuning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6a</span></a>). For Cluster 0, Trial 9 clearly shows faster convergence speeds and a smaller evaluation loss after 100 FL rounds. Trial 12 also shows a similar evaluation loss at the last round, but at a much slower convergence rate. For Clusters 2 and 4 (Figure <a href="#S6.F6.sf2" title="In Figure 6 ‣ VI-C Federated Hyperparameter Tuning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6b</span></a> and Figure <a href="#S6.F6.sf3" title="In Figure 6 ‣ VI-C Federated Hyperparameter Tuning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6c</span></a>), Trials 9 and 10 show the best performance. Trial 10 from Cluster 2 reaches a smaller loss than Trial 9; however, by fine tuning the Trial 9 learning rates, it can reach the same loss values.</p>
</div>
<div id="S6.SS3.p3" class="ltx_para">
<p id="S6.SS3.p3.2" class="ltx_p">The client and server learning rates (<math id="S6.SS3.p3.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S6.SS3.p3.1.m1.1a"><mi id="S6.SS3.p3.1.m1.1.1" xref="S6.SS3.p3.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p3.1.m1.1b"><ci id="S6.SS3.p3.1.m1.1.1.cmml" xref="S6.SS3.p3.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p3.1.m1.1c">\eta</annotation></semantics></math> and <math id="S6.SS3.p3.2.m2.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="S6.SS3.p3.2.m2.1a"><msub id="S6.SS3.p3.2.m2.1.1" xref="S6.SS3.p3.2.m2.1.1.cmml"><mi id="S6.SS3.p3.2.m2.1.1.2" xref="S6.SS3.p3.2.m2.1.1.2.cmml">η</mi><mi id="S6.SS3.p3.2.m2.1.1.3" xref="S6.SS3.p3.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p3.2.m2.1b"><apply id="S6.SS3.p3.2.m2.1.1.cmml" xref="S6.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS3.p3.2.m2.1.1.1.cmml" xref="S6.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S6.SS3.p3.2.m2.1.1.2.cmml" xref="S6.SS3.p3.2.m2.1.1.2">𝜂</ci><ci id="S6.SS3.p3.2.m2.1.1.3.cmml" xref="S6.SS3.p3.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p3.2.m2.1c">\eta_{s}</annotation></semantics></math>, respectively) for each cluster are fine tuned by performing a grid search varying both values simultaneously. The results are shown in the heat maps from Figure <a href="#S6.F7" title="Figure 7 ‣ VI-C Federated Hyperparameter Tuning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. The heat maps show the logarithm of the evaluation loss after 60 FL rounds; darker colors show a smaller loss. For the three cases, many combinations achieve a similar low loss; we are going to select the combination with a smaller loss for all cases.</p>
</div>
<div id="S6.SS3.p4" class="ltx_para">
<p id="S6.SS3.p4.6" class="ltx_p">The final optimizer selection are as follows. Cluster 0 <span id="S6.SS3.p4.6.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> is Adam1 with <math id="S6.SS3.p4.1.m1.1" class="ltx_Math" alttext="\eta=0.005" display="inline"><semantics id="S6.SS3.p4.1.m1.1a"><mrow id="S6.SS3.p4.1.m1.1.1" xref="S6.SS3.p4.1.m1.1.1.cmml"><mi id="S6.SS3.p4.1.m1.1.1.2" xref="S6.SS3.p4.1.m1.1.1.2.cmml">η</mi><mo id="S6.SS3.p4.1.m1.1.1.1" xref="S6.SS3.p4.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS3.p4.1.m1.1.1.3" xref="S6.SS3.p4.1.m1.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.1.m1.1b"><apply id="S6.SS3.p4.1.m1.1.1.cmml" xref="S6.SS3.p4.1.m1.1.1"><eq id="S6.SS3.p4.1.m1.1.1.1.cmml" xref="S6.SS3.p4.1.m1.1.1.1"></eq><ci id="S6.SS3.p4.1.m1.1.1.2.cmml" xref="S6.SS3.p4.1.m1.1.1.2">𝜂</ci><cn type="float" id="S6.SS3.p4.1.m1.1.1.3.cmml" xref="S6.SS3.p4.1.m1.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.1.m1.1c">\eta=0.005</annotation></semantics></math>, and <span id="S6.SS3.p4.6.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> is SGD with <math id="S6.SS3.p4.2.m2.1" class="ltx_Math" alttext="\eta_{s}=0.75" display="inline"><semantics id="S6.SS3.p4.2.m2.1a"><mrow id="S6.SS3.p4.2.m2.1.1" xref="S6.SS3.p4.2.m2.1.1.cmml"><msub id="S6.SS3.p4.2.m2.1.1.2" xref="S6.SS3.p4.2.m2.1.1.2.cmml"><mi id="S6.SS3.p4.2.m2.1.1.2.2" xref="S6.SS3.p4.2.m2.1.1.2.2.cmml">η</mi><mi id="S6.SS3.p4.2.m2.1.1.2.3" xref="S6.SS3.p4.2.m2.1.1.2.3.cmml">s</mi></msub><mo id="S6.SS3.p4.2.m2.1.1.1" xref="S6.SS3.p4.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS3.p4.2.m2.1.1.3" xref="S6.SS3.p4.2.m2.1.1.3.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.2.m2.1b"><apply id="S6.SS3.p4.2.m2.1.1.cmml" xref="S6.SS3.p4.2.m2.1.1"><eq id="S6.SS3.p4.2.m2.1.1.1.cmml" xref="S6.SS3.p4.2.m2.1.1.1"></eq><apply id="S6.SS3.p4.2.m2.1.1.2.cmml" xref="S6.SS3.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.p4.2.m2.1.1.2.1.cmml" xref="S6.SS3.p4.2.m2.1.1.2">subscript</csymbol><ci id="S6.SS3.p4.2.m2.1.1.2.2.cmml" xref="S6.SS3.p4.2.m2.1.1.2.2">𝜂</ci><ci id="S6.SS3.p4.2.m2.1.1.2.3.cmml" xref="S6.SS3.p4.2.m2.1.1.2.3">𝑠</ci></apply><cn type="float" id="S6.SS3.p4.2.m2.1.1.3.cmml" xref="S6.SS3.p4.2.m2.1.1.3">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.2.m2.1c">\eta_{s}=0.75</annotation></semantics></math>. Cluster 2 <span id="S6.SS3.p4.6.3" class="ltx_text ltx_font_smallcaps">ClientOpt</span> is Adam1 with <math id="S6.SS3.p4.3.m3.1" class="ltx_Math" alttext="\eta=0.005" display="inline"><semantics id="S6.SS3.p4.3.m3.1a"><mrow id="S6.SS3.p4.3.m3.1.1" xref="S6.SS3.p4.3.m3.1.1.cmml"><mi id="S6.SS3.p4.3.m3.1.1.2" xref="S6.SS3.p4.3.m3.1.1.2.cmml">η</mi><mo id="S6.SS3.p4.3.m3.1.1.1" xref="S6.SS3.p4.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS3.p4.3.m3.1.1.3" xref="S6.SS3.p4.3.m3.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.3.m3.1b"><apply id="S6.SS3.p4.3.m3.1.1.cmml" xref="S6.SS3.p4.3.m3.1.1"><eq id="S6.SS3.p4.3.m3.1.1.1.cmml" xref="S6.SS3.p4.3.m3.1.1.1"></eq><ci id="S6.SS3.p4.3.m3.1.1.2.cmml" xref="S6.SS3.p4.3.m3.1.1.2">𝜂</ci><cn type="float" id="S6.SS3.p4.3.m3.1.1.3.cmml" xref="S6.SS3.p4.3.m3.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.3.m3.1c">\eta=0.005</annotation></semantics></math>, and <span id="S6.SS3.p4.6.4" class="ltx_text ltx_font_smallcaps">ServerOpt</span> is SGD with <math id="S6.SS3.p4.4.m4.1" class="ltx_Math" alttext="\eta_{s}=1.25" display="inline"><semantics id="S6.SS3.p4.4.m4.1a"><mrow id="S6.SS3.p4.4.m4.1.1" xref="S6.SS3.p4.4.m4.1.1.cmml"><msub id="S6.SS3.p4.4.m4.1.1.2" xref="S6.SS3.p4.4.m4.1.1.2.cmml"><mi id="S6.SS3.p4.4.m4.1.1.2.2" xref="S6.SS3.p4.4.m4.1.1.2.2.cmml">η</mi><mi id="S6.SS3.p4.4.m4.1.1.2.3" xref="S6.SS3.p4.4.m4.1.1.2.3.cmml">s</mi></msub><mo id="S6.SS3.p4.4.m4.1.1.1" xref="S6.SS3.p4.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS3.p4.4.m4.1.1.3" xref="S6.SS3.p4.4.m4.1.1.3.cmml">1.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.4.m4.1b"><apply id="S6.SS3.p4.4.m4.1.1.cmml" xref="S6.SS3.p4.4.m4.1.1"><eq id="S6.SS3.p4.4.m4.1.1.1.cmml" xref="S6.SS3.p4.4.m4.1.1.1"></eq><apply id="S6.SS3.p4.4.m4.1.1.2.cmml" xref="S6.SS3.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.p4.4.m4.1.1.2.1.cmml" xref="S6.SS3.p4.4.m4.1.1.2">subscript</csymbol><ci id="S6.SS3.p4.4.m4.1.1.2.2.cmml" xref="S6.SS3.p4.4.m4.1.1.2.2">𝜂</ci><ci id="S6.SS3.p4.4.m4.1.1.2.3.cmml" xref="S6.SS3.p4.4.m4.1.1.2.3">𝑠</ci></apply><cn type="float" id="S6.SS3.p4.4.m4.1.1.3.cmml" xref="S6.SS3.p4.4.m4.1.1.3">1.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.4.m4.1c">\eta_{s}=1.25</annotation></semantics></math>. Cluster 4 <span id="S6.SS3.p4.6.5" class="ltx_text ltx_font_smallcaps">ClientOpt</span> is Adam1 with <math id="S6.SS3.p4.5.m5.1" class="ltx_Math" alttext="\eta=0.001" display="inline"><semantics id="S6.SS3.p4.5.m5.1a"><mrow id="S6.SS3.p4.5.m5.1.1" xref="S6.SS3.p4.5.m5.1.1.cmml"><mi id="S6.SS3.p4.5.m5.1.1.2" xref="S6.SS3.p4.5.m5.1.1.2.cmml">η</mi><mo id="S6.SS3.p4.5.m5.1.1.1" xref="S6.SS3.p4.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS3.p4.5.m5.1.1.3" xref="S6.SS3.p4.5.m5.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.5.m5.1b"><apply id="S6.SS3.p4.5.m5.1.1.cmml" xref="S6.SS3.p4.5.m5.1.1"><eq id="S6.SS3.p4.5.m5.1.1.1.cmml" xref="S6.SS3.p4.5.m5.1.1.1"></eq><ci id="S6.SS3.p4.5.m5.1.1.2.cmml" xref="S6.SS3.p4.5.m5.1.1.2">𝜂</ci><cn type="float" id="S6.SS3.p4.5.m5.1.1.3.cmml" xref="S6.SS3.p4.5.m5.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.5.m5.1c">\eta=0.001</annotation></semantics></math>, and <span id="S6.SS3.p4.6.6" class="ltx_text ltx_font_smallcaps">ServerOpt</span> is SGD with <math id="S6.SS3.p4.6.m6.1" class="ltx_Math" alttext="\eta_{s}=1.5" display="inline"><semantics id="S6.SS3.p4.6.m6.1a"><mrow id="S6.SS3.p4.6.m6.1.1" xref="S6.SS3.p4.6.m6.1.1.cmml"><msub id="S6.SS3.p4.6.m6.1.1.2" xref="S6.SS3.p4.6.m6.1.1.2.cmml"><mi id="S6.SS3.p4.6.m6.1.1.2.2" xref="S6.SS3.p4.6.m6.1.1.2.2.cmml">η</mi><mi id="S6.SS3.p4.6.m6.1.1.2.3" xref="S6.SS3.p4.6.m6.1.1.2.3.cmml">s</mi></msub><mo id="S6.SS3.p4.6.m6.1.1.1" xref="S6.SS3.p4.6.m6.1.1.1.cmml">=</mo><mn id="S6.SS3.p4.6.m6.1.1.3" xref="S6.SS3.p4.6.m6.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.6.m6.1b"><apply id="S6.SS3.p4.6.m6.1.1.cmml" xref="S6.SS3.p4.6.m6.1.1"><eq id="S6.SS3.p4.6.m6.1.1.1.cmml" xref="S6.SS3.p4.6.m6.1.1.1"></eq><apply id="S6.SS3.p4.6.m6.1.1.2.cmml" xref="S6.SS3.p4.6.m6.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.p4.6.m6.1.1.2.1.cmml" xref="S6.SS3.p4.6.m6.1.1.2">subscript</csymbol><ci id="S6.SS3.p4.6.m6.1.1.2.2.cmml" xref="S6.SS3.p4.6.m6.1.1.2.2">𝜂</ci><ci id="S6.SS3.p4.6.m6.1.1.2.3.cmml" xref="S6.SS3.p4.6.m6.1.1.2.3">𝑠</ci></apply><cn type="float" id="S6.SS3.p4.6.m6.1.1.3.cmml" xref="S6.SS3.p4.6.m6.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.6.m6.1c">\eta_{s}=1.5</annotation></semantics></math>.</p>
</div>
<figure id="S6.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE V: </span><span id="S6.T5.67.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and <span id="S6.T5.68.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> combinations for each hyperparameter tuning trial. “SGD” is SGD without momentum, “SGDm” refers to SGD with momentum <math id="S6.T5.10.m1.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S6.T5.10.m1.1b"><mn id="S6.T5.10.m1.1.1" xref="S6.T5.10.m1.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S6.T5.10.m1.1c"><cn type="float" id="S6.T5.10.m1.1.1.cmml" xref="S6.T5.10.m1.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.10.m1.1d">0.9</annotation></semantics></math>, “Adam1” refers to <math id="S6.T5.11.m2.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.T5.11.m2.1b"><mrow id="S6.T5.11.m2.1.1" xref="S6.T5.11.m2.1.1.cmml"><msub id="S6.T5.11.m2.1.1.2" xref="S6.T5.11.m2.1.1.2.cmml"><mi id="S6.T5.11.m2.1.1.2.2" xref="S6.T5.11.m2.1.1.2.2.cmml">β</mi><mn id="S6.T5.11.m2.1.1.2.3" xref="S6.T5.11.m2.1.1.2.3.cmml">1</mn></msub><mo id="S6.T5.11.m2.1.1.1" xref="S6.T5.11.m2.1.1.1.cmml">=</mo><mn id="S6.T5.11.m2.1.1.3" xref="S6.T5.11.m2.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.11.m2.1c"><apply id="S6.T5.11.m2.1.1.cmml" xref="S6.T5.11.m2.1.1"><eq id="S6.T5.11.m2.1.1.1.cmml" xref="S6.T5.11.m2.1.1.1"></eq><apply id="S6.T5.11.m2.1.1.2.cmml" xref="S6.T5.11.m2.1.1.2"><csymbol cd="ambiguous" id="S6.T5.11.m2.1.1.2.1.cmml" xref="S6.T5.11.m2.1.1.2">subscript</csymbol><ci id="S6.T5.11.m2.1.1.2.2.cmml" xref="S6.T5.11.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S6.T5.11.m2.1.1.2.3.cmml" xref="S6.T5.11.m2.1.1.2.3">1</cn></apply><cn type="float" id="S6.T5.11.m2.1.1.3.cmml" xref="S6.T5.11.m2.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.11.m2.1d">\beta_{1}=0.9</annotation></semantics></math>, <math id="S6.T5.12.m3.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S6.T5.12.m3.1b"><mrow id="S6.T5.12.m3.1.1" xref="S6.T5.12.m3.1.1.cmml"><msub id="S6.T5.12.m3.1.1.2" xref="S6.T5.12.m3.1.1.2.cmml"><mi id="S6.T5.12.m3.1.1.2.2" xref="S6.T5.12.m3.1.1.2.2.cmml">β</mi><mn id="S6.T5.12.m3.1.1.2.3" xref="S6.T5.12.m3.1.1.2.3.cmml">2</mn></msub><mo id="S6.T5.12.m3.1.1.1" xref="S6.T5.12.m3.1.1.1.cmml">=</mo><mn id="S6.T5.12.m3.1.1.3" xref="S6.T5.12.m3.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.12.m3.1c"><apply id="S6.T5.12.m3.1.1.cmml" xref="S6.T5.12.m3.1.1"><eq id="S6.T5.12.m3.1.1.1.cmml" xref="S6.T5.12.m3.1.1.1"></eq><apply id="S6.T5.12.m3.1.1.2.cmml" xref="S6.T5.12.m3.1.1.2"><csymbol cd="ambiguous" id="S6.T5.12.m3.1.1.2.1.cmml" xref="S6.T5.12.m3.1.1.2">subscript</csymbol><ci id="S6.T5.12.m3.1.1.2.2.cmml" xref="S6.T5.12.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S6.T5.12.m3.1.1.2.3.cmml" xref="S6.T5.12.m3.1.1.2.3">2</cn></apply><cn type="float" id="S6.T5.12.m3.1.1.3.cmml" xref="S6.T5.12.m3.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.12.m3.1d">\beta_{2}=0.999</annotation></semantics></math>, <math id="S6.T5.13.m4.1" class="ltx_Math" alttext="\epsilon=1\times 10^{-8}" display="inline"><semantics id="S6.T5.13.m4.1b"><mrow id="S6.T5.13.m4.1.1" xref="S6.T5.13.m4.1.1.cmml"><mi id="S6.T5.13.m4.1.1.2" xref="S6.T5.13.m4.1.1.2.cmml">ϵ</mi><mo id="S6.T5.13.m4.1.1.1" xref="S6.T5.13.m4.1.1.1.cmml">=</mo><mrow id="S6.T5.13.m4.1.1.3" xref="S6.T5.13.m4.1.1.3.cmml"><mn id="S6.T5.13.m4.1.1.3.2" xref="S6.T5.13.m4.1.1.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S6.T5.13.m4.1.1.3.1" xref="S6.T5.13.m4.1.1.3.1.cmml">×</mo><msup id="S6.T5.13.m4.1.1.3.3" xref="S6.T5.13.m4.1.1.3.3.cmml"><mn id="S6.T5.13.m4.1.1.3.3.2" xref="S6.T5.13.m4.1.1.3.3.2.cmml">10</mn><mrow id="S6.T5.13.m4.1.1.3.3.3" xref="S6.T5.13.m4.1.1.3.3.3.cmml"><mo id="S6.T5.13.m4.1.1.3.3.3b" xref="S6.T5.13.m4.1.1.3.3.3.cmml">−</mo><mn id="S6.T5.13.m4.1.1.3.3.3.2" xref="S6.T5.13.m4.1.1.3.3.3.2.cmml">8</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.13.m4.1c"><apply id="S6.T5.13.m4.1.1.cmml" xref="S6.T5.13.m4.1.1"><eq id="S6.T5.13.m4.1.1.1.cmml" xref="S6.T5.13.m4.1.1.1"></eq><ci id="S6.T5.13.m4.1.1.2.cmml" xref="S6.T5.13.m4.1.1.2">italic-ϵ</ci><apply id="S6.T5.13.m4.1.1.3.cmml" xref="S6.T5.13.m4.1.1.3"><times id="S6.T5.13.m4.1.1.3.1.cmml" xref="S6.T5.13.m4.1.1.3.1"></times><cn type="integer" id="S6.T5.13.m4.1.1.3.2.cmml" xref="S6.T5.13.m4.1.1.3.2">1</cn><apply id="S6.T5.13.m4.1.1.3.3.cmml" xref="S6.T5.13.m4.1.1.3.3"><csymbol cd="ambiguous" id="S6.T5.13.m4.1.1.3.3.1.cmml" xref="S6.T5.13.m4.1.1.3.3">superscript</csymbol><cn type="integer" id="S6.T5.13.m4.1.1.3.3.2.cmml" xref="S6.T5.13.m4.1.1.3.3.2">10</cn><apply id="S6.T5.13.m4.1.1.3.3.3.cmml" xref="S6.T5.13.m4.1.1.3.3.3"><minus id="S6.T5.13.m4.1.1.3.3.3.1.cmml" xref="S6.T5.13.m4.1.1.3.3.3"></minus><cn type="integer" id="S6.T5.13.m4.1.1.3.3.3.2.cmml" xref="S6.T5.13.m4.1.1.3.3.3.2">8</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.13.m4.1d">\epsilon=1\times 10^{-8}</annotation></semantics></math> and “Adam2” refers to Adam <math id="S6.T5.14.m5.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S6.T5.14.m5.1b"><mrow id="S6.T5.14.m5.1.1" xref="S6.T5.14.m5.1.1.cmml"><msub id="S6.T5.14.m5.1.1.2" xref="S6.T5.14.m5.1.1.2.cmml"><mi id="S6.T5.14.m5.1.1.2.2" xref="S6.T5.14.m5.1.1.2.2.cmml">β</mi><mn id="S6.T5.14.m5.1.1.2.3" xref="S6.T5.14.m5.1.1.2.3.cmml">1</mn></msub><mo id="S6.T5.14.m5.1.1.1" xref="S6.T5.14.m5.1.1.1.cmml">=</mo><mn id="S6.T5.14.m5.1.1.3" xref="S6.T5.14.m5.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.14.m5.1c"><apply id="S6.T5.14.m5.1.1.cmml" xref="S6.T5.14.m5.1.1"><eq id="S6.T5.14.m5.1.1.1.cmml" xref="S6.T5.14.m5.1.1.1"></eq><apply id="S6.T5.14.m5.1.1.2.cmml" xref="S6.T5.14.m5.1.1.2"><csymbol cd="ambiguous" id="S6.T5.14.m5.1.1.2.1.cmml" xref="S6.T5.14.m5.1.1.2">subscript</csymbol><ci id="S6.T5.14.m5.1.1.2.2.cmml" xref="S6.T5.14.m5.1.1.2.2">𝛽</ci><cn type="integer" id="S6.T5.14.m5.1.1.2.3.cmml" xref="S6.T5.14.m5.1.1.2.3">1</cn></apply><cn type="float" id="S6.T5.14.m5.1.1.3.cmml" xref="S6.T5.14.m5.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.14.m5.1d">\beta_{1}=0.9</annotation></semantics></math>, <math id="S6.T5.15.m6.1" class="ltx_Math" alttext="\beta_{2}=0.99" display="inline"><semantics id="S6.T5.15.m6.1b"><mrow id="S6.T5.15.m6.1.1" xref="S6.T5.15.m6.1.1.cmml"><msub id="S6.T5.15.m6.1.1.2" xref="S6.T5.15.m6.1.1.2.cmml"><mi id="S6.T5.15.m6.1.1.2.2" xref="S6.T5.15.m6.1.1.2.2.cmml">β</mi><mn id="S6.T5.15.m6.1.1.2.3" xref="S6.T5.15.m6.1.1.2.3.cmml">2</mn></msub><mo id="S6.T5.15.m6.1.1.1" xref="S6.T5.15.m6.1.1.1.cmml">=</mo><mn id="S6.T5.15.m6.1.1.3" xref="S6.T5.15.m6.1.1.3.cmml">0.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.15.m6.1c"><apply id="S6.T5.15.m6.1.1.cmml" xref="S6.T5.15.m6.1.1"><eq id="S6.T5.15.m6.1.1.1.cmml" xref="S6.T5.15.m6.1.1.1"></eq><apply id="S6.T5.15.m6.1.1.2.cmml" xref="S6.T5.15.m6.1.1.2"><csymbol cd="ambiguous" id="S6.T5.15.m6.1.1.2.1.cmml" xref="S6.T5.15.m6.1.1.2">subscript</csymbol><ci id="S6.T5.15.m6.1.1.2.2.cmml" xref="S6.T5.15.m6.1.1.2.2">𝛽</ci><cn type="integer" id="S6.T5.15.m6.1.1.2.3.cmml" xref="S6.T5.15.m6.1.1.2.3">2</cn></apply><cn type="float" id="S6.T5.15.m6.1.1.3.cmml" xref="S6.T5.15.m6.1.1.3">0.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.15.m6.1d">\beta_{2}=0.99</annotation></semantics></math>, <math id="S6.T5.16.m7.1" class="ltx_Math" alttext="\epsilon=10^{-3}" display="inline"><semantics id="S6.T5.16.m7.1b"><mrow id="S6.T5.16.m7.1.1" xref="S6.T5.16.m7.1.1.cmml"><mi id="S6.T5.16.m7.1.1.2" xref="S6.T5.16.m7.1.1.2.cmml">ϵ</mi><mo id="S6.T5.16.m7.1.1.1" xref="S6.T5.16.m7.1.1.1.cmml">=</mo><msup id="S6.T5.16.m7.1.1.3" xref="S6.T5.16.m7.1.1.3.cmml"><mn id="S6.T5.16.m7.1.1.3.2" xref="S6.T5.16.m7.1.1.3.2.cmml">10</mn><mrow id="S6.T5.16.m7.1.1.3.3" xref="S6.T5.16.m7.1.1.3.3.cmml"><mo id="S6.T5.16.m7.1.1.3.3b" xref="S6.T5.16.m7.1.1.3.3.cmml">−</mo><mn id="S6.T5.16.m7.1.1.3.3.2" xref="S6.T5.16.m7.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.16.m7.1c"><apply id="S6.T5.16.m7.1.1.cmml" xref="S6.T5.16.m7.1.1"><eq id="S6.T5.16.m7.1.1.1.cmml" xref="S6.T5.16.m7.1.1.1"></eq><ci id="S6.T5.16.m7.1.1.2.cmml" xref="S6.T5.16.m7.1.1.2">italic-ϵ</ci><apply id="S6.T5.16.m7.1.1.3.cmml" xref="S6.T5.16.m7.1.1.3"><csymbol cd="ambiguous" id="S6.T5.16.m7.1.1.3.1.cmml" xref="S6.T5.16.m7.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.16.m7.1.1.3.2.cmml" xref="S6.T5.16.m7.1.1.3.2">10</cn><apply id="S6.T5.16.m7.1.1.3.3.cmml" xref="S6.T5.16.m7.1.1.3.3"><minus id="S6.T5.16.m7.1.1.3.3.1.cmml" xref="S6.T5.16.m7.1.1.3.3"></minus><cn type="integer" id="S6.T5.16.m7.1.1.3.3.2.cmml" xref="S6.T5.16.m7.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.16.m7.1d">\epsilon=10^{-3}</annotation></semantics></math>. <math id="S6.T5.17.m8.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S6.T5.17.m8.1b"><mi id="S6.T5.17.m8.1.1" xref="S6.T5.17.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S6.T5.17.m8.1c"><ci id="S6.T5.17.m8.1.1.cmml" xref="S6.T5.17.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.17.m8.1d">\lambda</annotation></semantics></math> is set to <math id="S6.T5.18.m9.1" class="ltx_Math" alttext="1\times 10^{-5}" display="inline"><semantics id="S6.T5.18.m9.1b"><mrow id="S6.T5.18.m9.1.1" xref="S6.T5.18.m9.1.1.cmml"><mn id="S6.T5.18.m9.1.1.2" xref="S6.T5.18.m9.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S6.T5.18.m9.1.1.1" xref="S6.T5.18.m9.1.1.1.cmml">×</mo><msup id="S6.T5.18.m9.1.1.3" xref="S6.T5.18.m9.1.1.3.cmml"><mn id="S6.T5.18.m9.1.1.3.2" xref="S6.T5.18.m9.1.1.3.2.cmml">10</mn><mrow id="S6.T5.18.m9.1.1.3.3" xref="S6.T5.18.m9.1.1.3.3.cmml"><mo id="S6.T5.18.m9.1.1.3.3b" xref="S6.T5.18.m9.1.1.3.3.cmml">−</mo><mn id="S6.T5.18.m9.1.1.3.3.2" xref="S6.T5.18.m9.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.18.m9.1c"><apply id="S6.T5.18.m9.1.1.cmml" xref="S6.T5.18.m9.1.1"><times id="S6.T5.18.m9.1.1.1.cmml" xref="S6.T5.18.m9.1.1.1"></times><cn type="integer" id="S6.T5.18.m9.1.1.2.cmml" xref="S6.T5.18.m9.1.1.2">1</cn><apply id="S6.T5.18.m9.1.1.3.cmml" xref="S6.T5.18.m9.1.1.3"><csymbol cd="ambiguous" id="S6.T5.18.m9.1.1.3.1.cmml" xref="S6.T5.18.m9.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.18.m9.1.1.3.2.cmml" xref="S6.T5.18.m9.1.1.3.2">10</cn><apply id="S6.T5.18.m9.1.1.3.3.cmml" xref="S6.T5.18.m9.1.1.3.3"><minus id="S6.T5.18.m9.1.1.3.3.1.cmml" xref="S6.T5.18.m9.1.1.3.3"></minus><cn type="integer" id="S6.T5.18.m9.1.1.3.3.2.cmml" xref="S6.T5.18.m9.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.18.m9.1d">1\times 10^{-5}</annotation></semantics></math> for all trials.</figcaption>
<table id="S6.T5.52" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T5.20.2" class="ltx_tr">
<th id="S6.T5.20.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><span id="S6.T5.20.2.3.1" class="ltx_text" style="font-size:90%;">Trial</span></th>
<th id="S6.T5.20.2.4" class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt">
<span id="S6.T5.20.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.20.2.4.1.1" class="ltx_p"><span id="S6.T5.20.2.4.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">ClientOpt</span></span>
</span>
</th>
<th id="S6.T5.19.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S6.T5.19.1.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S6.T5.19.1.1.m1.1a"><mi mathsize="90%" id="S6.T5.19.1.1.m1.1.1" xref="S6.T5.19.1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S6.T5.19.1.1.m1.1b"><ci id="S6.T5.19.1.1.m1.1.1.cmml" xref="S6.T5.19.1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.19.1.1.m1.1c">\eta</annotation></semantics></math></th>
<th id="S6.T5.20.2.5" class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt">
<span id="S6.T5.20.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.20.2.5.1.1" class="ltx_p"><span id="S6.T5.20.2.5.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">ServerOpt</span></span>
</span>
</th>
<th id="S6.T5.20.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><math id="S6.T5.20.2.2.m1.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="S6.T5.20.2.2.m1.1a"><msub id="S6.T5.20.2.2.m1.1.1" xref="S6.T5.20.2.2.m1.1.1.cmml"><mi mathsize="90%" id="S6.T5.20.2.2.m1.1.1.2" xref="S6.T5.20.2.2.m1.1.1.2.cmml">η</mi><mi mathsize="90%" id="S6.T5.20.2.2.m1.1.1.3" xref="S6.T5.20.2.2.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S6.T5.20.2.2.m1.1b"><apply id="S6.T5.20.2.2.m1.1.1.cmml" xref="S6.T5.20.2.2.m1.1.1"><csymbol cd="ambiguous" id="S6.T5.20.2.2.m1.1.1.1.cmml" xref="S6.T5.20.2.2.m1.1.1">subscript</csymbol><ci id="S6.T5.20.2.2.m1.1.1.2.cmml" xref="S6.T5.20.2.2.m1.1.1.2">𝜂</ci><ci id="S6.T5.20.2.2.m1.1.1.3.cmml" xref="S6.T5.20.2.2.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.20.2.2.m1.1c">\eta_{s}</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T5.22.4" class="ltx_tr">
<th id="S6.T5.22.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T5.22.4.3.1" class="ltx_text" style="font-size:90%;">Trial 1</span></th>
<td id="S6.T5.22.4.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S6.T5.22.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.22.4.4.1.1" class="ltx_p"><span id="S6.T5.22.4.4.1.1.1" class="ltx_text" style="font-size:90%;">SGD</span></span>
</span>
</td>
<td id="S6.T5.21.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="S6.T5.21.3.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.21.3.1.m1.1a"><mrow id="S6.T5.21.3.1.m1.1.1" xref="S6.T5.21.3.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.21.3.1.m1.1.1.2" xref="S6.T5.21.3.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.21.3.1.m1.1.1.1" xref="S6.T5.21.3.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.21.3.1.m1.1.1.3" xref="S6.T5.21.3.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.21.3.1.m1.1.1.3.2" xref="S6.T5.21.3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.21.3.1.m1.1.1.3.3" xref="S6.T5.21.3.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.21.3.1.m1.1.1.3.3a" xref="S6.T5.21.3.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.21.3.1.m1.1.1.3.3.2" xref="S6.T5.21.3.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.21.3.1.m1.1b"><apply id="S6.T5.21.3.1.m1.1.1.cmml" xref="S6.T5.21.3.1.m1.1.1"><times id="S6.T5.21.3.1.m1.1.1.1.cmml" xref="S6.T5.21.3.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.21.3.1.m1.1.1.2.cmml" xref="S6.T5.21.3.1.m1.1.1.2">1</cn><apply id="S6.T5.21.3.1.m1.1.1.3.cmml" xref="S6.T5.21.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.21.3.1.m1.1.1.3.1.cmml" xref="S6.T5.21.3.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.21.3.1.m1.1.1.3.2.cmml" xref="S6.T5.21.3.1.m1.1.1.3.2">10</cn><apply id="S6.T5.21.3.1.m1.1.1.3.3.cmml" xref="S6.T5.21.3.1.m1.1.1.3.3"><minus id="S6.T5.21.3.1.m1.1.1.3.3.1.cmml" xref="S6.T5.21.3.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.21.3.1.m1.1.1.3.3.2.cmml" xref="S6.T5.21.3.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.21.3.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.22.4.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S6.T5.22.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.22.4.5.1.1" class="ltx_p"><span id="S6.T5.22.4.5.1.1.1" class="ltx_text" style="font-size:90%;">SGD</span></span>
</span>
</td>
<td id="S6.T5.22.4.2" class="ltx_td ltx_align_left ltx_border_t"><math id="S6.T5.22.4.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.T5.22.4.2.m1.1a"><mn mathsize="90%" id="S6.T5.22.4.2.m1.1.1" xref="S6.T5.22.4.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.T5.22.4.2.m1.1b"><cn type="float" id="S6.T5.22.4.2.m1.1.1.cmml" xref="S6.T5.22.4.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.22.4.2.m1.1c">1.0</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.24.6" class="ltx_tr">
<th id="S6.T5.24.6.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.24.6.3.1" class="ltx_text" style="font-size:90%;">Trial 2</span></th>
<td id="S6.T5.24.6.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.24.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.24.6.4.1.1" class="ltx_p"><span id="S6.T5.24.6.4.1.1.1" class="ltx_text" style="font-size:90%;">SGD</span></span>
</span>
</td>
<td id="S6.T5.23.5.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.23.5.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.23.5.1.m1.1a"><mrow id="S6.T5.23.5.1.m1.1.1" xref="S6.T5.23.5.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.23.5.1.m1.1.1.2" xref="S6.T5.23.5.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.23.5.1.m1.1.1.1" xref="S6.T5.23.5.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.23.5.1.m1.1.1.3" xref="S6.T5.23.5.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.23.5.1.m1.1.1.3.2" xref="S6.T5.23.5.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.23.5.1.m1.1.1.3.3" xref="S6.T5.23.5.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.23.5.1.m1.1.1.3.3a" xref="S6.T5.23.5.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.23.5.1.m1.1.1.3.3.2" xref="S6.T5.23.5.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.23.5.1.m1.1b"><apply id="S6.T5.23.5.1.m1.1.1.cmml" xref="S6.T5.23.5.1.m1.1.1"><times id="S6.T5.23.5.1.m1.1.1.1.cmml" xref="S6.T5.23.5.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.23.5.1.m1.1.1.2.cmml" xref="S6.T5.23.5.1.m1.1.1.2">1</cn><apply id="S6.T5.23.5.1.m1.1.1.3.cmml" xref="S6.T5.23.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.23.5.1.m1.1.1.3.1.cmml" xref="S6.T5.23.5.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.23.5.1.m1.1.1.3.2.cmml" xref="S6.T5.23.5.1.m1.1.1.3.2">10</cn><apply id="S6.T5.23.5.1.m1.1.1.3.3.cmml" xref="S6.T5.23.5.1.m1.1.1.3.3"><minus id="S6.T5.23.5.1.m1.1.1.3.3.1.cmml" xref="S6.T5.23.5.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.23.5.1.m1.1.1.3.3.2.cmml" xref="S6.T5.23.5.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.23.5.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.24.6.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.24.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.24.6.5.1.1" class="ltx_p"><span id="S6.T5.24.6.5.1.1.1" class="ltx_text" style="font-size:90%;">SGDm</span></span>
</span>
</td>
<td id="S6.T5.24.6.2" class="ltx_td ltx_align_left"><math id="S6.T5.24.6.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.T5.24.6.2.m1.1a"><mn mathsize="90%" id="S6.T5.24.6.2.m1.1.1" xref="S6.T5.24.6.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.T5.24.6.2.m1.1b"><cn type="float" id="S6.T5.24.6.2.m1.1.1.cmml" xref="S6.T5.24.6.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.24.6.2.m1.1c">1.0</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.26.8" class="ltx_tr">
<th id="S6.T5.26.8.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.26.8.3.1" class="ltx_text" style="font-size:90%;">Trial 3</span></th>
<td id="S6.T5.26.8.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.26.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.26.8.4.1.1" class="ltx_p"><span id="S6.T5.26.8.4.1.1.1" class="ltx_text" style="font-size:90%;">SGD</span></span>
</span>
</td>
<td id="S6.T5.25.7.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.25.7.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.25.7.1.m1.1a"><mrow id="S6.T5.25.7.1.m1.1.1" xref="S6.T5.25.7.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.25.7.1.m1.1.1.2" xref="S6.T5.25.7.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.25.7.1.m1.1.1.1" xref="S6.T5.25.7.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.25.7.1.m1.1.1.3" xref="S6.T5.25.7.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.25.7.1.m1.1.1.3.2" xref="S6.T5.25.7.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.25.7.1.m1.1.1.3.3" xref="S6.T5.25.7.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.25.7.1.m1.1.1.3.3a" xref="S6.T5.25.7.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.25.7.1.m1.1.1.3.3.2" xref="S6.T5.25.7.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.25.7.1.m1.1b"><apply id="S6.T5.25.7.1.m1.1.1.cmml" xref="S6.T5.25.7.1.m1.1.1"><times id="S6.T5.25.7.1.m1.1.1.1.cmml" xref="S6.T5.25.7.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.25.7.1.m1.1.1.2.cmml" xref="S6.T5.25.7.1.m1.1.1.2">1</cn><apply id="S6.T5.25.7.1.m1.1.1.3.cmml" xref="S6.T5.25.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.25.7.1.m1.1.1.3.1.cmml" xref="S6.T5.25.7.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.25.7.1.m1.1.1.3.2.cmml" xref="S6.T5.25.7.1.m1.1.1.3.2">10</cn><apply id="S6.T5.25.7.1.m1.1.1.3.3.cmml" xref="S6.T5.25.7.1.m1.1.1.3.3"><minus id="S6.T5.25.7.1.m1.1.1.3.3.1.cmml" xref="S6.T5.25.7.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.25.7.1.m1.1.1.3.3.2.cmml" xref="S6.T5.25.7.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.25.7.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.26.8.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.26.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.26.8.5.1.1" class="ltx_p"><span id="S6.T5.26.8.5.1.1.1" class="ltx_text" style="font-size:90%;">Adam1</span></span>
</span>
</td>
<td id="S6.T5.26.8.2" class="ltx_td ltx_align_left"><math id="S6.T5.26.8.2.m1.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S6.T5.26.8.2.m1.1a"><mrow id="S6.T5.26.8.2.m1.1.1" xref="S6.T5.26.8.2.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.26.8.2.m1.1.1.2" xref="S6.T5.26.8.2.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.26.8.2.m1.1.1.1" xref="S6.T5.26.8.2.m1.1.1.1.cmml">×</mo><msup id="S6.T5.26.8.2.m1.1.1.3" xref="S6.T5.26.8.2.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.26.8.2.m1.1.1.3.2" xref="S6.T5.26.8.2.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.26.8.2.m1.1.1.3.3" xref="S6.T5.26.8.2.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.26.8.2.m1.1.1.3.3a" xref="S6.T5.26.8.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.26.8.2.m1.1.1.3.3.2" xref="S6.T5.26.8.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.26.8.2.m1.1b"><apply id="S6.T5.26.8.2.m1.1.1.cmml" xref="S6.T5.26.8.2.m1.1.1"><times id="S6.T5.26.8.2.m1.1.1.1.cmml" xref="S6.T5.26.8.2.m1.1.1.1"></times><cn type="integer" id="S6.T5.26.8.2.m1.1.1.2.cmml" xref="S6.T5.26.8.2.m1.1.1.2">1</cn><apply id="S6.T5.26.8.2.m1.1.1.3.cmml" xref="S6.T5.26.8.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.26.8.2.m1.1.1.3.1.cmml" xref="S6.T5.26.8.2.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.26.8.2.m1.1.1.3.2.cmml" xref="S6.T5.26.8.2.m1.1.1.3.2">10</cn><apply id="S6.T5.26.8.2.m1.1.1.3.3.cmml" xref="S6.T5.26.8.2.m1.1.1.3.3"><minus id="S6.T5.26.8.2.m1.1.1.3.3.1.cmml" xref="S6.T5.26.8.2.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.26.8.2.m1.1.1.3.3.2.cmml" xref="S6.T5.26.8.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.26.8.2.m1.1c">1\times 10^{-2}</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.28.10" class="ltx_tr">
<th id="S6.T5.28.10.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.28.10.3.1" class="ltx_text" style="font-size:90%;">Trial 4</span></th>
<td id="S6.T5.28.10.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.28.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.28.10.4.1.1" class="ltx_p"><span id="S6.T5.28.10.4.1.1.1" class="ltx_text" style="font-size:90%;">SGD</span></span>
</span>
</td>
<td id="S6.T5.27.9.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.27.9.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.27.9.1.m1.1a"><mrow id="S6.T5.27.9.1.m1.1.1" xref="S6.T5.27.9.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.27.9.1.m1.1.1.2" xref="S6.T5.27.9.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.27.9.1.m1.1.1.1" xref="S6.T5.27.9.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.27.9.1.m1.1.1.3" xref="S6.T5.27.9.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.27.9.1.m1.1.1.3.2" xref="S6.T5.27.9.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.27.9.1.m1.1.1.3.3" xref="S6.T5.27.9.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.27.9.1.m1.1.1.3.3a" xref="S6.T5.27.9.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.27.9.1.m1.1.1.3.3.2" xref="S6.T5.27.9.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.27.9.1.m1.1b"><apply id="S6.T5.27.9.1.m1.1.1.cmml" xref="S6.T5.27.9.1.m1.1.1"><times id="S6.T5.27.9.1.m1.1.1.1.cmml" xref="S6.T5.27.9.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.27.9.1.m1.1.1.2.cmml" xref="S6.T5.27.9.1.m1.1.1.2">1</cn><apply id="S6.T5.27.9.1.m1.1.1.3.cmml" xref="S6.T5.27.9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.27.9.1.m1.1.1.3.1.cmml" xref="S6.T5.27.9.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.27.9.1.m1.1.1.3.2.cmml" xref="S6.T5.27.9.1.m1.1.1.3.2">10</cn><apply id="S6.T5.27.9.1.m1.1.1.3.3.cmml" xref="S6.T5.27.9.1.m1.1.1.3.3"><minus id="S6.T5.27.9.1.m1.1.1.3.3.1.cmml" xref="S6.T5.27.9.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.27.9.1.m1.1.1.3.3.2.cmml" xref="S6.T5.27.9.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.27.9.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.28.10.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.28.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.28.10.5.1.1" class="ltx_p"><span id="S6.T5.28.10.5.1.1.1" class="ltx_text" style="font-size:90%;">Adam2</span></span>
</span>
</td>
<td id="S6.T5.28.10.2" class="ltx_td ltx_align_left"><math id="S6.T5.28.10.2.m1.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S6.T5.28.10.2.m1.1a"><mrow id="S6.T5.28.10.2.m1.1.1" xref="S6.T5.28.10.2.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.28.10.2.m1.1.1.2" xref="S6.T5.28.10.2.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.28.10.2.m1.1.1.1" xref="S6.T5.28.10.2.m1.1.1.1.cmml">×</mo><msup id="S6.T5.28.10.2.m1.1.1.3" xref="S6.T5.28.10.2.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.28.10.2.m1.1.1.3.2" xref="S6.T5.28.10.2.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.28.10.2.m1.1.1.3.3" xref="S6.T5.28.10.2.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.28.10.2.m1.1.1.3.3a" xref="S6.T5.28.10.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.28.10.2.m1.1.1.3.3.2" xref="S6.T5.28.10.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.28.10.2.m1.1b"><apply id="S6.T5.28.10.2.m1.1.1.cmml" xref="S6.T5.28.10.2.m1.1.1"><times id="S6.T5.28.10.2.m1.1.1.1.cmml" xref="S6.T5.28.10.2.m1.1.1.1"></times><cn type="integer" id="S6.T5.28.10.2.m1.1.1.2.cmml" xref="S6.T5.28.10.2.m1.1.1.2">1</cn><apply id="S6.T5.28.10.2.m1.1.1.3.cmml" xref="S6.T5.28.10.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.28.10.2.m1.1.1.3.1.cmml" xref="S6.T5.28.10.2.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.28.10.2.m1.1.1.3.2.cmml" xref="S6.T5.28.10.2.m1.1.1.3.2">10</cn><apply id="S6.T5.28.10.2.m1.1.1.3.3.cmml" xref="S6.T5.28.10.2.m1.1.1.3.3"><minus id="S6.T5.28.10.2.m1.1.1.3.3.1.cmml" xref="S6.T5.28.10.2.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.28.10.2.m1.1.1.3.3.2.cmml" xref="S6.T5.28.10.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.28.10.2.m1.1c">1\times 10^{-2}</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.30.12" class="ltx_tr">
<th id="S6.T5.30.12.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.30.12.3.1" class="ltx_text" style="font-size:90%;">Trial 5</span></th>
<td id="S6.T5.30.12.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.30.12.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.30.12.4.1.1" class="ltx_p"><span id="S6.T5.30.12.4.1.1.1" class="ltx_text" style="font-size:90%;">SGDm</span></span>
</span>
</td>
<td id="S6.T5.29.11.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.29.11.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.29.11.1.m1.1a"><mrow id="S6.T5.29.11.1.m1.1.1" xref="S6.T5.29.11.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.29.11.1.m1.1.1.2" xref="S6.T5.29.11.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.29.11.1.m1.1.1.1" xref="S6.T5.29.11.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.29.11.1.m1.1.1.3" xref="S6.T5.29.11.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.29.11.1.m1.1.1.3.2" xref="S6.T5.29.11.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.29.11.1.m1.1.1.3.3" xref="S6.T5.29.11.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.29.11.1.m1.1.1.3.3a" xref="S6.T5.29.11.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.29.11.1.m1.1.1.3.3.2" xref="S6.T5.29.11.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.29.11.1.m1.1b"><apply id="S6.T5.29.11.1.m1.1.1.cmml" xref="S6.T5.29.11.1.m1.1.1"><times id="S6.T5.29.11.1.m1.1.1.1.cmml" xref="S6.T5.29.11.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.29.11.1.m1.1.1.2.cmml" xref="S6.T5.29.11.1.m1.1.1.2">1</cn><apply id="S6.T5.29.11.1.m1.1.1.3.cmml" xref="S6.T5.29.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.29.11.1.m1.1.1.3.1.cmml" xref="S6.T5.29.11.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.29.11.1.m1.1.1.3.2.cmml" xref="S6.T5.29.11.1.m1.1.1.3.2">10</cn><apply id="S6.T5.29.11.1.m1.1.1.3.3.cmml" xref="S6.T5.29.11.1.m1.1.1.3.3"><minus id="S6.T5.29.11.1.m1.1.1.3.3.1.cmml" xref="S6.T5.29.11.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.29.11.1.m1.1.1.3.3.2.cmml" xref="S6.T5.29.11.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.29.11.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.30.12.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.30.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.30.12.5.1.1" class="ltx_p"><span id="S6.T5.30.12.5.1.1.1" class="ltx_text" style="font-size:90%;">SGD</span></span>
</span>
</td>
<td id="S6.T5.30.12.2" class="ltx_td ltx_align_left"><math id="S6.T5.30.12.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.T5.30.12.2.m1.1a"><mn mathsize="90%" id="S6.T5.30.12.2.m1.1.1" xref="S6.T5.30.12.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.T5.30.12.2.m1.1b"><cn type="float" id="S6.T5.30.12.2.m1.1.1.cmml" xref="S6.T5.30.12.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.30.12.2.m1.1c">1.0</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.32.14" class="ltx_tr">
<th id="S6.T5.32.14.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.32.14.3.1" class="ltx_text" style="font-size:90%;">Trial 6</span></th>
<td id="S6.T5.32.14.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.32.14.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.32.14.4.1.1" class="ltx_p"><span id="S6.T5.32.14.4.1.1.1" class="ltx_text" style="font-size:90%;">SGDm</span></span>
</span>
</td>
<td id="S6.T5.31.13.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.31.13.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.31.13.1.m1.1a"><mrow id="S6.T5.31.13.1.m1.1.1" xref="S6.T5.31.13.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.31.13.1.m1.1.1.2" xref="S6.T5.31.13.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.31.13.1.m1.1.1.1" xref="S6.T5.31.13.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.31.13.1.m1.1.1.3" xref="S6.T5.31.13.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.31.13.1.m1.1.1.3.2" xref="S6.T5.31.13.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.31.13.1.m1.1.1.3.3" xref="S6.T5.31.13.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.31.13.1.m1.1.1.3.3a" xref="S6.T5.31.13.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.31.13.1.m1.1.1.3.3.2" xref="S6.T5.31.13.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.31.13.1.m1.1b"><apply id="S6.T5.31.13.1.m1.1.1.cmml" xref="S6.T5.31.13.1.m1.1.1"><times id="S6.T5.31.13.1.m1.1.1.1.cmml" xref="S6.T5.31.13.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.31.13.1.m1.1.1.2.cmml" xref="S6.T5.31.13.1.m1.1.1.2">1</cn><apply id="S6.T5.31.13.1.m1.1.1.3.cmml" xref="S6.T5.31.13.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.31.13.1.m1.1.1.3.1.cmml" xref="S6.T5.31.13.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.31.13.1.m1.1.1.3.2.cmml" xref="S6.T5.31.13.1.m1.1.1.3.2">10</cn><apply id="S6.T5.31.13.1.m1.1.1.3.3.cmml" xref="S6.T5.31.13.1.m1.1.1.3.3"><minus id="S6.T5.31.13.1.m1.1.1.3.3.1.cmml" xref="S6.T5.31.13.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.31.13.1.m1.1.1.3.3.2.cmml" xref="S6.T5.31.13.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.31.13.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.32.14.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.32.14.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.32.14.5.1.1" class="ltx_p"><span id="S6.T5.32.14.5.1.1.1" class="ltx_text" style="font-size:90%;">SGDm</span></span>
</span>
</td>
<td id="S6.T5.32.14.2" class="ltx_td ltx_align_left"><math id="S6.T5.32.14.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.T5.32.14.2.m1.1a"><mn mathsize="90%" id="S6.T5.32.14.2.m1.1.1" xref="S6.T5.32.14.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.T5.32.14.2.m1.1b"><cn type="float" id="S6.T5.32.14.2.m1.1.1.cmml" xref="S6.T5.32.14.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.32.14.2.m1.1c">1.0</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.34.16" class="ltx_tr">
<th id="S6.T5.34.16.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.34.16.3.1" class="ltx_text" style="font-size:90%;">Trial 7</span></th>
<td id="S6.T5.34.16.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.34.16.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.34.16.4.1.1" class="ltx_p"><span id="S6.T5.34.16.4.1.1.1" class="ltx_text" style="font-size:90%;">SGDm</span></span>
</span>
</td>
<td id="S6.T5.33.15.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.33.15.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.33.15.1.m1.1a"><mrow id="S6.T5.33.15.1.m1.1.1" xref="S6.T5.33.15.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.33.15.1.m1.1.1.2" xref="S6.T5.33.15.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.33.15.1.m1.1.1.1" xref="S6.T5.33.15.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.33.15.1.m1.1.1.3" xref="S6.T5.33.15.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.33.15.1.m1.1.1.3.2" xref="S6.T5.33.15.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.33.15.1.m1.1.1.3.3" xref="S6.T5.33.15.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.33.15.1.m1.1.1.3.3a" xref="S6.T5.33.15.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.33.15.1.m1.1.1.3.3.2" xref="S6.T5.33.15.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.33.15.1.m1.1b"><apply id="S6.T5.33.15.1.m1.1.1.cmml" xref="S6.T5.33.15.1.m1.1.1"><times id="S6.T5.33.15.1.m1.1.1.1.cmml" xref="S6.T5.33.15.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.33.15.1.m1.1.1.2.cmml" xref="S6.T5.33.15.1.m1.1.1.2">1</cn><apply id="S6.T5.33.15.1.m1.1.1.3.cmml" xref="S6.T5.33.15.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.33.15.1.m1.1.1.3.1.cmml" xref="S6.T5.33.15.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.33.15.1.m1.1.1.3.2.cmml" xref="S6.T5.33.15.1.m1.1.1.3.2">10</cn><apply id="S6.T5.33.15.1.m1.1.1.3.3.cmml" xref="S6.T5.33.15.1.m1.1.1.3.3"><minus id="S6.T5.33.15.1.m1.1.1.3.3.1.cmml" xref="S6.T5.33.15.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.33.15.1.m1.1.1.3.3.2.cmml" xref="S6.T5.33.15.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.33.15.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.34.16.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.34.16.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.34.16.5.1.1" class="ltx_p"><span id="S6.T5.34.16.5.1.1.1" class="ltx_text" style="font-size:90%;">Adam1</span></span>
</span>
</td>
<td id="S6.T5.34.16.2" class="ltx_td ltx_align_left"><math id="S6.T5.34.16.2.m1.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S6.T5.34.16.2.m1.1a"><mrow id="S6.T5.34.16.2.m1.1.1" xref="S6.T5.34.16.2.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.34.16.2.m1.1.1.2" xref="S6.T5.34.16.2.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.34.16.2.m1.1.1.1" xref="S6.T5.34.16.2.m1.1.1.1.cmml">×</mo><msup id="S6.T5.34.16.2.m1.1.1.3" xref="S6.T5.34.16.2.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.34.16.2.m1.1.1.3.2" xref="S6.T5.34.16.2.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.34.16.2.m1.1.1.3.3" xref="S6.T5.34.16.2.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.34.16.2.m1.1.1.3.3a" xref="S6.T5.34.16.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.34.16.2.m1.1.1.3.3.2" xref="S6.T5.34.16.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.34.16.2.m1.1b"><apply id="S6.T5.34.16.2.m1.1.1.cmml" xref="S6.T5.34.16.2.m1.1.1"><times id="S6.T5.34.16.2.m1.1.1.1.cmml" xref="S6.T5.34.16.2.m1.1.1.1"></times><cn type="integer" id="S6.T5.34.16.2.m1.1.1.2.cmml" xref="S6.T5.34.16.2.m1.1.1.2">1</cn><apply id="S6.T5.34.16.2.m1.1.1.3.cmml" xref="S6.T5.34.16.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.34.16.2.m1.1.1.3.1.cmml" xref="S6.T5.34.16.2.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.34.16.2.m1.1.1.3.2.cmml" xref="S6.T5.34.16.2.m1.1.1.3.2">10</cn><apply id="S6.T5.34.16.2.m1.1.1.3.3.cmml" xref="S6.T5.34.16.2.m1.1.1.3.3"><minus id="S6.T5.34.16.2.m1.1.1.3.3.1.cmml" xref="S6.T5.34.16.2.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.34.16.2.m1.1.1.3.3.2.cmml" xref="S6.T5.34.16.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.34.16.2.m1.1c">1\times 10^{-2}</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.36.18" class="ltx_tr">
<th id="S6.T5.36.18.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.36.18.3.1" class="ltx_text" style="font-size:90%;">Trial 8</span></th>
<td id="S6.T5.36.18.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.36.18.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.36.18.4.1.1" class="ltx_p"><span id="S6.T5.36.18.4.1.1.1" class="ltx_text" style="font-size:90%;">SGDm</span></span>
</span>
</td>
<td id="S6.T5.35.17.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.35.17.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.35.17.1.m1.1a"><mrow id="S6.T5.35.17.1.m1.1.1" xref="S6.T5.35.17.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.35.17.1.m1.1.1.2" xref="S6.T5.35.17.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.35.17.1.m1.1.1.1" xref="S6.T5.35.17.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.35.17.1.m1.1.1.3" xref="S6.T5.35.17.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.35.17.1.m1.1.1.3.2" xref="S6.T5.35.17.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.35.17.1.m1.1.1.3.3" xref="S6.T5.35.17.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.35.17.1.m1.1.1.3.3a" xref="S6.T5.35.17.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.35.17.1.m1.1.1.3.3.2" xref="S6.T5.35.17.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.35.17.1.m1.1b"><apply id="S6.T5.35.17.1.m1.1.1.cmml" xref="S6.T5.35.17.1.m1.1.1"><times id="S6.T5.35.17.1.m1.1.1.1.cmml" xref="S6.T5.35.17.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.35.17.1.m1.1.1.2.cmml" xref="S6.T5.35.17.1.m1.1.1.2">1</cn><apply id="S6.T5.35.17.1.m1.1.1.3.cmml" xref="S6.T5.35.17.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.35.17.1.m1.1.1.3.1.cmml" xref="S6.T5.35.17.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.35.17.1.m1.1.1.3.2.cmml" xref="S6.T5.35.17.1.m1.1.1.3.2">10</cn><apply id="S6.T5.35.17.1.m1.1.1.3.3.cmml" xref="S6.T5.35.17.1.m1.1.1.3.3"><minus id="S6.T5.35.17.1.m1.1.1.3.3.1.cmml" xref="S6.T5.35.17.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.35.17.1.m1.1.1.3.3.2.cmml" xref="S6.T5.35.17.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.35.17.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.36.18.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.36.18.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.36.18.5.1.1" class="ltx_p"><span id="S6.T5.36.18.5.1.1.1" class="ltx_text" style="font-size:90%;">Adam2</span></span>
</span>
</td>
<td id="S6.T5.36.18.2" class="ltx_td ltx_align_left"><math id="S6.T5.36.18.2.m1.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S6.T5.36.18.2.m1.1a"><mrow id="S6.T5.36.18.2.m1.1.1" xref="S6.T5.36.18.2.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.36.18.2.m1.1.1.2" xref="S6.T5.36.18.2.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.36.18.2.m1.1.1.1" xref="S6.T5.36.18.2.m1.1.1.1.cmml">×</mo><msup id="S6.T5.36.18.2.m1.1.1.3" xref="S6.T5.36.18.2.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.36.18.2.m1.1.1.3.2" xref="S6.T5.36.18.2.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.36.18.2.m1.1.1.3.3" xref="S6.T5.36.18.2.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.36.18.2.m1.1.1.3.3a" xref="S6.T5.36.18.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.36.18.2.m1.1.1.3.3.2" xref="S6.T5.36.18.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.36.18.2.m1.1b"><apply id="S6.T5.36.18.2.m1.1.1.cmml" xref="S6.T5.36.18.2.m1.1.1"><times id="S6.T5.36.18.2.m1.1.1.1.cmml" xref="S6.T5.36.18.2.m1.1.1.1"></times><cn type="integer" id="S6.T5.36.18.2.m1.1.1.2.cmml" xref="S6.T5.36.18.2.m1.1.1.2">1</cn><apply id="S6.T5.36.18.2.m1.1.1.3.cmml" xref="S6.T5.36.18.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.36.18.2.m1.1.1.3.1.cmml" xref="S6.T5.36.18.2.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.36.18.2.m1.1.1.3.2.cmml" xref="S6.T5.36.18.2.m1.1.1.3.2">10</cn><apply id="S6.T5.36.18.2.m1.1.1.3.3.cmml" xref="S6.T5.36.18.2.m1.1.1.3.3"><minus id="S6.T5.36.18.2.m1.1.1.3.3.1.cmml" xref="S6.T5.36.18.2.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.36.18.2.m1.1.1.3.3.2.cmml" xref="S6.T5.36.18.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.36.18.2.m1.1c">1\times 10^{-2}</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.38.20" class="ltx_tr">
<th id="S6.T5.38.20.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.38.20.3.1" class="ltx_text" style="font-size:90%;">Trial 9</span></th>
<td id="S6.T5.38.20.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.38.20.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.38.20.4.1.1" class="ltx_p"><span id="S6.T5.38.20.4.1.1.1" class="ltx_text" style="font-size:90%;">Adam1</span></span>
</span>
</td>
<td id="S6.T5.37.19.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.37.19.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.37.19.1.m1.1a"><mrow id="S6.T5.37.19.1.m1.1.1" xref="S6.T5.37.19.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.37.19.1.m1.1.1.2" xref="S6.T5.37.19.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.37.19.1.m1.1.1.1" xref="S6.T5.37.19.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.37.19.1.m1.1.1.3" xref="S6.T5.37.19.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.37.19.1.m1.1.1.3.2" xref="S6.T5.37.19.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.37.19.1.m1.1.1.3.3" xref="S6.T5.37.19.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.37.19.1.m1.1.1.3.3a" xref="S6.T5.37.19.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.37.19.1.m1.1.1.3.3.2" xref="S6.T5.37.19.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.37.19.1.m1.1b"><apply id="S6.T5.37.19.1.m1.1.1.cmml" xref="S6.T5.37.19.1.m1.1.1"><times id="S6.T5.37.19.1.m1.1.1.1.cmml" xref="S6.T5.37.19.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.37.19.1.m1.1.1.2.cmml" xref="S6.T5.37.19.1.m1.1.1.2">1</cn><apply id="S6.T5.37.19.1.m1.1.1.3.cmml" xref="S6.T5.37.19.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.37.19.1.m1.1.1.3.1.cmml" xref="S6.T5.37.19.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.37.19.1.m1.1.1.3.2.cmml" xref="S6.T5.37.19.1.m1.1.1.3.2">10</cn><apply id="S6.T5.37.19.1.m1.1.1.3.3.cmml" xref="S6.T5.37.19.1.m1.1.1.3.3"><minus id="S6.T5.37.19.1.m1.1.1.3.3.1.cmml" xref="S6.T5.37.19.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.37.19.1.m1.1.1.3.3.2.cmml" xref="S6.T5.37.19.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.37.19.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.38.20.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.38.20.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.38.20.5.1.1" class="ltx_p"><span id="S6.T5.38.20.5.1.1.1" class="ltx_text" style="font-size:90%;">SGD</span></span>
</span>
</td>
<td id="S6.T5.38.20.2" class="ltx_td ltx_align_left"><math id="S6.T5.38.20.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.T5.38.20.2.m1.1a"><mn mathsize="90%" id="S6.T5.38.20.2.m1.1.1" xref="S6.T5.38.20.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.T5.38.20.2.m1.1b"><cn type="float" id="S6.T5.38.20.2.m1.1.1.cmml" xref="S6.T5.38.20.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.38.20.2.m1.1c">1.0</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.40.22" class="ltx_tr">
<th id="S6.T5.40.22.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.40.22.3.1" class="ltx_text" style="font-size:90%;">Trial 10</span></th>
<td id="S6.T5.40.22.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.40.22.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.40.22.4.1.1" class="ltx_p"><span id="S6.T5.40.22.4.1.1.1" class="ltx_text" style="font-size:90%;">Adam1</span></span>
</span>
</td>
<td id="S6.T5.39.21.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.39.21.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.39.21.1.m1.1a"><mrow id="S6.T5.39.21.1.m1.1.1" xref="S6.T5.39.21.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.39.21.1.m1.1.1.2" xref="S6.T5.39.21.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.39.21.1.m1.1.1.1" xref="S6.T5.39.21.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.39.21.1.m1.1.1.3" xref="S6.T5.39.21.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.39.21.1.m1.1.1.3.2" xref="S6.T5.39.21.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.39.21.1.m1.1.1.3.3" xref="S6.T5.39.21.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.39.21.1.m1.1.1.3.3a" xref="S6.T5.39.21.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.39.21.1.m1.1.1.3.3.2" xref="S6.T5.39.21.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.39.21.1.m1.1b"><apply id="S6.T5.39.21.1.m1.1.1.cmml" xref="S6.T5.39.21.1.m1.1.1"><times id="S6.T5.39.21.1.m1.1.1.1.cmml" xref="S6.T5.39.21.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.39.21.1.m1.1.1.2.cmml" xref="S6.T5.39.21.1.m1.1.1.2">1</cn><apply id="S6.T5.39.21.1.m1.1.1.3.cmml" xref="S6.T5.39.21.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.39.21.1.m1.1.1.3.1.cmml" xref="S6.T5.39.21.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.39.21.1.m1.1.1.3.2.cmml" xref="S6.T5.39.21.1.m1.1.1.3.2">10</cn><apply id="S6.T5.39.21.1.m1.1.1.3.3.cmml" xref="S6.T5.39.21.1.m1.1.1.3.3"><minus id="S6.T5.39.21.1.m1.1.1.3.3.1.cmml" xref="S6.T5.39.21.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.39.21.1.m1.1.1.3.3.2.cmml" xref="S6.T5.39.21.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.39.21.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.40.22.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.40.22.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.40.22.5.1.1" class="ltx_p"><span id="S6.T5.40.22.5.1.1.1" class="ltx_text" style="font-size:90%;">SGDm</span></span>
</span>
</td>
<td id="S6.T5.40.22.2" class="ltx_td ltx_align_left"><math id="S6.T5.40.22.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.T5.40.22.2.m1.1a"><mn mathsize="90%" id="S6.T5.40.22.2.m1.1.1" xref="S6.T5.40.22.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.T5.40.22.2.m1.1b"><cn type="float" id="S6.T5.40.22.2.m1.1.1.cmml" xref="S6.T5.40.22.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.40.22.2.m1.1c">1.0</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.42.24" class="ltx_tr">
<th id="S6.T5.42.24.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.42.24.3.1" class="ltx_text" style="font-size:90%;">Trial 11</span></th>
<td id="S6.T5.42.24.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.42.24.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.42.24.4.1.1" class="ltx_p"><span id="S6.T5.42.24.4.1.1.1" class="ltx_text" style="font-size:90%;">Adam1</span></span>
</span>
</td>
<td id="S6.T5.41.23.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.41.23.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.41.23.1.m1.1a"><mrow id="S6.T5.41.23.1.m1.1.1" xref="S6.T5.41.23.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.41.23.1.m1.1.1.2" xref="S6.T5.41.23.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.41.23.1.m1.1.1.1" xref="S6.T5.41.23.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.41.23.1.m1.1.1.3" xref="S6.T5.41.23.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.41.23.1.m1.1.1.3.2" xref="S6.T5.41.23.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.41.23.1.m1.1.1.3.3" xref="S6.T5.41.23.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.41.23.1.m1.1.1.3.3a" xref="S6.T5.41.23.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.41.23.1.m1.1.1.3.3.2" xref="S6.T5.41.23.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.41.23.1.m1.1b"><apply id="S6.T5.41.23.1.m1.1.1.cmml" xref="S6.T5.41.23.1.m1.1.1"><times id="S6.T5.41.23.1.m1.1.1.1.cmml" xref="S6.T5.41.23.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.41.23.1.m1.1.1.2.cmml" xref="S6.T5.41.23.1.m1.1.1.2">1</cn><apply id="S6.T5.41.23.1.m1.1.1.3.cmml" xref="S6.T5.41.23.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.41.23.1.m1.1.1.3.1.cmml" xref="S6.T5.41.23.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.41.23.1.m1.1.1.3.2.cmml" xref="S6.T5.41.23.1.m1.1.1.3.2">10</cn><apply id="S6.T5.41.23.1.m1.1.1.3.3.cmml" xref="S6.T5.41.23.1.m1.1.1.3.3"><minus id="S6.T5.41.23.1.m1.1.1.3.3.1.cmml" xref="S6.T5.41.23.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.41.23.1.m1.1.1.3.3.2.cmml" xref="S6.T5.41.23.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.41.23.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.42.24.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.42.24.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.42.24.5.1.1" class="ltx_p"><span id="S6.T5.42.24.5.1.1.1" class="ltx_text" style="font-size:90%;">Adam1</span></span>
</span>
</td>
<td id="S6.T5.42.24.2" class="ltx_td ltx_align_left"><math id="S6.T5.42.24.2.m1.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S6.T5.42.24.2.m1.1a"><mrow id="S6.T5.42.24.2.m1.1.1" xref="S6.T5.42.24.2.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.42.24.2.m1.1.1.2" xref="S6.T5.42.24.2.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.42.24.2.m1.1.1.1" xref="S6.T5.42.24.2.m1.1.1.1.cmml">×</mo><msup id="S6.T5.42.24.2.m1.1.1.3" xref="S6.T5.42.24.2.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.42.24.2.m1.1.1.3.2" xref="S6.T5.42.24.2.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.42.24.2.m1.1.1.3.3" xref="S6.T5.42.24.2.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.42.24.2.m1.1.1.3.3a" xref="S6.T5.42.24.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.42.24.2.m1.1.1.3.3.2" xref="S6.T5.42.24.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.42.24.2.m1.1b"><apply id="S6.T5.42.24.2.m1.1.1.cmml" xref="S6.T5.42.24.2.m1.1.1"><times id="S6.T5.42.24.2.m1.1.1.1.cmml" xref="S6.T5.42.24.2.m1.1.1.1"></times><cn type="integer" id="S6.T5.42.24.2.m1.1.1.2.cmml" xref="S6.T5.42.24.2.m1.1.1.2">1</cn><apply id="S6.T5.42.24.2.m1.1.1.3.cmml" xref="S6.T5.42.24.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.42.24.2.m1.1.1.3.1.cmml" xref="S6.T5.42.24.2.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.42.24.2.m1.1.1.3.2.cmml" xref="S6.T5.42.24.2.m1.1.1.3.2">10</cn><apply id="S6.T5.42.24.2.m1.1.1.3.3.cmml" xref="S6.T5.42.24.2.m1.1.1.3.3"><minus id="S6.T5.42.24.2.m1.1.1.3.3.1.cmml" xref="S6.T5.42.24.2.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.42.24.2.m1.1.1.3.3.2.cmml" xref="S6.T5.42.24.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.42.24.2.m1.1c">1\times 10^{-2}</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.44.26" class="ltx_tr">
<th id="S6.T5.44.26.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.44.26.3.1" class="ltx_text" style="font-size:90%;">Trial 12</span></th>
<td id="S6.T5.44.26.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.44.26.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.44.26.4.1.1" class="ltx_p"><span id="S6.T5.44.26.4.1.1.1" class="ltx_text" style="font-size:90%;">Adam1</span></span>
</span>
</td>
<td id="S6.T5.43.25.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.43.25.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.43.25.1.m1.1a"><mrow id="S6.T5.43.25.1.m1.1.1" xref="S6.T5.43.25.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.43.25.1.m1.1.1.2" xref="S6.T5.43.25.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.43.25.1.m1.1.1.1" xref="S6.T5.43.25.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.43.25.1.m1.1.1.3" xref="S6.T5.43.25.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.43.25.1.m1.1.1.3.2" xref="S6.T5.43.25.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.43.25.1.m1.1.1.3.3" xref="S6.T5.43.25.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.43.25.1.m1.1.1.3.3a" xref="S6.T5.43.25.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.43.25.1.m1.1.1.3.3.2" xref="S6.T5.43.25.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.43.25.1.m1.1b"><apply id="S6.T5.43.25.1.m1.1.1.cmml" xref="S6.T5.43.25.1.m1.1.1"><times id="S6.T5.43.25.1.m1.1.1.1.cmml" xref="S6.T5.43.25.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.43.25.1.m1.1.1.2.cmml" xref="S6.T5.43.25.1.m1.1.1.2">1</cn><apply id="S6.T5.43.25.1.m1.1.1.3.cmml" xref="S6.T5.43.25.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.43.25.1.m1.1.1.3.1.cmml" xref="S6.T5.43.25.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.43.25.1.m1.1.1.3.2.cmml" xref="S6.T5.43.25.1.m1.1.1.3.2">10</cn><apply id="S6.T5.43.25.1.m1.1.1.3.3.cmml" xref="S6.T5.43.25.1.m1.1.1.3.3"><minus id="S6.T5.43.25.1.m1.1.1.3.3.1.cmml" xref="S6.T5.43.25.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.43.25.1.m1.1.1.3.3.2.cmml" xref="S6.T5.43.25.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.43.25.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.44.26.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.44.26.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.44.26.5.1.1" class="ltx_p"><span id="S6.T5.44.26.5.1.1.1" class="ltx_text" style="font-size:90%;">Adam2</span></span>
</span>
</td>
<td id="S6.T5.44.26.2" class="ltx_td ltx_align_left"><math id="S6.T5.44.26.2.m1.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S6.T5.44.26.2.m1.1a"><mrow id="S6.T5.44.26.2.m1.1.1" xref="S6.T5.44.26.2.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.44.26.2.m1.1.1.2" xref="S6.T5.44.26.2.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.44.26.2.m1.1.1.1" xref="S6.T5.44.26.2.m1.1.1.1.cmml">×</mo><msup id="S6.T5.44.26.2.m1.1.1.3" xref="S6.T5.44.26.2.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.44.26.2.m1.1.1.3.2" xref="S6.T5.44.26.2.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.44.26.2.m1.1.1.3.3" xref="S6.T5.44.26.2.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.44.26.2.m1.1.1.3.3a" xref="S6.T5.44.26.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.44.26.2.m1.1.1.3.3.2" xref="S6.T5.44.26.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.44.26.2.m1.1b"><apply id="S6.T5.44.26.2.m1.1.1.cmml" xref="S6.T5.44.26.2.m1.1.1"><times id="S6.T5.44.26.2.m1.1.1.1.cmml" xref="S6.T5.44.26.2.m1.1.1.1"></times><cn type="integer" id="S6.T5.44.26.2.m1.1.1.2.cmml" xref="S6.T5.44.26.2.m1.1.1.2">1</cn><apply id="S6.T5.44.26.2.m1.1.1.3.cmml" xref="S6.T5.44.26.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.44.26.2.m1.1.1.3.1.cmml" xref="S6.T5.44.26.2.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.44.26.2.m1.1.1.3.2.cmml" xref="S6.T5.44.26.2.m1.1.1.3.2">10</cn><apply id="S6.T5.44.26.2.m1.1.1.3.3.cmml" xref="S6.T5.44.26.2.m1.1.1.3.3"><minus id="S6.T5.44.26.2.m1.1.1.3.3.1.cmml" xref="S6.T5.44.26.2.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.44.26.2.m1.1.1.3.3.2.cmml" xref="S6.T5.44.26.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.44.26.2.m1.1c">1\times 10^{-2}</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.46.28" class="ltx_tr">
<th id="S6.T5.46.28.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.46.28.3.1" class="ltx_text" style="font-size:90%;">Trial 13</span></th>
<td id="S6.T5.46.28.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.46.28.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.46.28.4.1.1" class="ltx_p"><span id="S6.T5.46.28.4.1.1.1" class="ltx_text" style="font-size:90%;">Adam2</span></span>
</span>
</td>
<td id="S6.T5.45.27.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.45.27.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.45.27.1.m1.1a"><mrow id="S6.T5.45.27.1.m1.1.1" xref="S6.T5.45.27.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.45.27.1.m1.1.1.2" xref="S6.T5.45.27.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.45.27.1.m1.1.1.1" xref="S6.T5.45.27.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.45.27.1.m1.1.1.3" xref="S6.T5.45.27.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.45.27.1.m1.1.1.3.2" xref="S6.T5.45.27.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.45.27.1.m1.1.1.3.3" xref="S6.T5.45.27.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.45.27.1.m1.1.1.3.3a" xref="S6.T5.45.27.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.45.27.1.m1.1.1.3.3.2" xref="S6.T5.45.27.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.45.27.1.m1.1b"><apply id="S6.T5.45.27.1.m1.1.1.cmml" xref="S6.T5.45.27.1.m1.1.1"><times id="S6.T5.45.27.1.m1.1.1.1.cmml" xref="S6.T5.45.27.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.45.27.1.m1.1.1.2.cmml" xref="S6.T5.45.27.1.m1.1.1.2">1</cn><apply id="S6.T5.45.27.1.m1.1.1.3.cmml" xref="S6.T5.45.27.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.45.27.1.m1.1.1.3.1.cmml" xref="S6.T5.45.27.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.45.27.1.m1.1.1.3.2.cmml" xref="S6.T5.45.27.1.m1.1.1.3.2">10</cn><apply id="S6.T5.45.27.1.m1.1.1.3.3.cmml" xref="S6.T5.45.27.1.m1.1.1.3.3"><minus id="S6.T5.45.27.1.m1.1.1.3.3.1.cmml" xref="S6.T5.45.27.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.45.27.1.m1.1.1.3.3.2.cmml" xref="S6.T5.45.27.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.45.27.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.46.28.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.46.28.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.46.28.5.1.1" class="ltx_p"><span id="S6.T5.46.28.5.1.1.1" class="ltx_text" style="font-size:90%;">SGD</span></span>
</span>
</td>
<td id="S6.T5.46.28.2" class="ltx_td ltx_align_left"><math id="S6.T5.46.28.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.T5.46.28.2.m1.1a"><mn mathsize="90%" id="S6.T5.46.28.2.m1.1.1" xref="S6.T5.46.28.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.T5.46.28.2.m1.1b"><cn type="float" id="S6.T5.46.28.2.m1.1.1.cmml" xref="S6.T5.46.28.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.46.28.2.m1.1c">1.0</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.48.30" class="ltx_tr">
<th id="S6.T5.48.30.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.48.30.3.1" class="ltx_text" style="font-size:90%;">Trial 14</span></th>
<td id="S6.T5.48.30.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.48.30.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.48.30.4.1.1" class="ltx_p"><span id="S6.T5.48.30.4.1.1.1" class="ltx_text" style="font-size:90%;">Adam2</span></span>
</span>
</td>
<td id="S6.T5.47.29.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.47.29.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.47.29.1.m1.1a"><mrow id="S6.T5.47.29.1.m1.1.1" xref="S6.T5.47.29.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.47.29.1.m1.1.1.2" xref="S6.T5.47.29.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.47.29.1.m1.1.1.1" xref="S6.T5.47.29.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.47.29.1.m1.1.1.3" xref="S6.T5.47.29.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.47.29.1.m1.1.1.3.2" xref="S6.T5.47.29.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.47.29.1.m1.1.1.3.3" xref="S6.T5.47.29.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.47.29.1.m1.1.1.3.3a" xref="S6.T5.47.29.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.47.29.1.m1.1.1.3.3.2" xref="S6.T5.47.29.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.47.29.1.m1.1b"><apply id="S6.T5.47.29.1.m1.1.1.cmml" xref="S6.T5.47.29.1.m1.1.1"><times id="S6.T5.47.29.1.m1.1.1.1.cmml" xref="S6.T5.47.29.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.47.29.1.m1.1.1.2.cmml" xref="S6.T5.47.29.1.m1.1.1.2">1</cn><apply id="S6.T5.47.29.1.m1.1.1.3.cmml" xref="S6.T5.47.29.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.47.29.1.m1.1.1.3.1.cmml" xref="S6.T5.47.29.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.47.29.1.m1.1.1.3.2.cmml" xref="S6.T5.47.29.1.m1.1.1.3.2">10</cn><apply id="S6.T5.47.29.1.m1.1.1.3.3.cmml" xref="S6.T5.47.29.1.m1.1.1.3.3"><minus id="S6.T5.47.29.1.m1.1.1.3.3.1.cmml" xref="S6.T5.47.29.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.47.29.1.m1.1.1.3.3.2.cmml" xref="S6.T5.47.29.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.47.29.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.48.30.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.48.30.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.48.30.5.1.1" class="ltx_p"><span id="S6.T5.48.30.5.1.1.1" class="ltx_text" style="font-size:90%;">SGDm</span></span>
</span>
</td>
<td id="S6.T5.48.30.2" class="ltx_td ltx_align_left"><math id="S6.T5.48.30.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S6.T5.48.30.2.m1.1a"><mn mathsize="90%" id="S6.T5.48.30.2.m1.1.1" xref="S6.T5.48.30.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S6.T5.48.30.2.m1.1b"><cn type="float" id="S6.T5.48.30.2.m1.1.1.cmml" xref="S6.T5.48.30.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.48.30.2.m1.1c">1.0</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.50.32" class="ltx_tr">
<th id="S6.T5.50.32.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.50.32.3.1" class="ltx_text" style="font-size:90%;">Trial 15</span></th>
<td id="S6.T5.50.32.4" class="ltx_td ltx_align_justify">
<span id="S6.T5.50.32.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.50.32.4.1.1" class="ltx_p"><span id="S6.T5.50.32.4.1.1.1" class="ltx_text" style="font-size:90%;">Adam2</span></span>
</span>
</td>
<td id="S6.T5.49.31.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S6.T5.49.31.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.49.31.1.m1.1a"><mrow id="S6.T5.49.31.1.m1.1.1" xref="S6.T5.49.31.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.49.31.1.m1.1.1.2" xref="S6.T5.49.31.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.49.31.1.m1.1.1.1" xref="S6.T5.49.31.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.49.31.1.m1.1.1.3" xref="S6.T5.49.31.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.49.31.1.m1.1.1.3.2" xref="S6.T5.49.31.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.49.31.1.m1.1.1.3.3" xref="S6.T5.49.31.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.49.31.1.m1.1.1.3.3a" xref="S6.T5.49.31.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.49.31.1.m1.1.1.3.3.2" xref="S6.T5.49.31.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.49.31.1.m1.1b"><apply id="S6.T5.49.31.1.m1.1.1.cmml" xref="S6.T5.49.31.1.m1.1.1"><times id="S6.T5.49.31.1.m1.1.1.1.cmml" xref="S6.T5.49.31.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.49.31.1.m1.1.1.2.cmml" xref="S6.T5.49.31.1.m1.1.1.2">1</cn><apply id="S6.T5.49.31.1.m1.1.1.3.cmml" xref="S6.T5.49.31.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.49.31.1.m1.1.1.3.1.cmml" xref="S6.T5.49.31.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.49.31.1.m1.1.1.3.2.cmml" xref="S6.T5.49.31.1.m1.1.1.3.2">10</cn><apply id="S6.T5.49.31.1.m1.1.1.3.3.cmml" xref="S6.T5.49.31.1.m1.1.1.3.3"><minus id="S6.T5.49.31.1.m1.1.1.3.3.1.cmml" xref="S6.T5.49.31.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.49.31.1.m1.1.1.3.3.2.cmml" xref="S6.T5.49.31.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.49.31.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.50.32.5" class="ltx_td ltx_align_justify">
<span id="S6.T5.50.32.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.50.32.5.1.1" class="ltx_p"><span id="S6.T5.50.32.5.1.1.1" class="ltx_text" style="font-size:90%;">Adam1</span></span>
</span>
</td>
<td id="S6.T5.50.32.2" class="ltx_td ltx_align_left"><math id="S6.T5.50.32.2.m1.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S6.T5.50.32.2.m1.1a"><mrow id="S6.T5.50.32.2.m1.1.1" xref="S6.T5.50.32.2.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.50.32.2.m1.1.1.2" xref="S6.T5.50.32.2.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.50.32.2.m1.1.1.1" xref="S6.T5.50.32.2.m1.1.1.1.cmml">×</mo><msup id="S6.T5.50.32.2.m1.1.1.3" xref="S6.T5.50.32.2.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.50.32.2.m1.1.1.3.2" xref="S6.T5.50.32.2.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.50.32.2.m1.1.1.3.3" xref="S6.T5.50.32.2.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.50.32.2.m1.1.1.3.3a" xref="S6.T5.50.32.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.50.32.2.m1.1.1.3.3.2" xref="S6.T5.50.32.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.50.32.2.m1.1b"><apply id="S6.T5.50.32.2.m1.1.1.cmml" xref="S6.T5.50.32.2.m1.1.1"><times id="S6.T5.50.32.2.m1.1.1.1.cmml" xref="S6.T5.50.32.2.m1.1.1.1"></times><cn type="integer" id="S6.T5.50.32.2.m1.1.1.2.cmml" xref="S6.T5.50.32.2.m1.1.1.2">1</cn><apply id="S6.T5.50.32.2.m1.1.1.3.cmml" xref="S6.T5.50.32.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.50.32.2.m1.1.1.3.1.cmml" xref="S6.T5.50.32.2.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.50.32.2.m1.1.1.3.2.cmml" xref="S6.T5.50.32.2.m1.1.1.3.2">10</cn><apply id="S6.T5.50.32.2.m1.1.1.3.3.cmml" xref="S6.T5.50.32.2.m1.1.1.3.3"><minus id="S6.T5.50.32.2.m1.1.1.3.3.1.cmml" xref="S6.T5.50.32.2.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.50.32.2.m1.1.1.3.3.2.cmml" xref="S6.T5.50.32.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.50.32.2.m1.1c">1\times 10^{-2}</annotation></semantics></math></td>
</tr>
<tr id="S6.T5.52.34" class="ltx_tr">
<th id="S6.T5.52.34.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S6.T5.52.34.3.1" class="ltx_text" style="font-size:90%;">Trial 16</span></th>
<td id="S6.T5.52.34.4" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S6.T5.52.34.4.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.52.34.4.1.1" class="ltx_p"><span id="S6.T5.52.34.4.1.1.1" class="ltx_text" style="font-size:90%;">Adam2</span></span>
</span>
</td>
<td id="S6.T5.51.33.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><math id="S6.T5.51.33.1.m1.1" class="ltx_Math" alttext="1\times 10^{-3}" display="inline"><semantics id="S6.T5.51.33.1.m1.1a"><mrow id="S6.T5.51.33.1.m1.1.1" xref="S6.T5.51.33.1.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.51.33.1.m1.1.1.2" xref="S6.T5.51.33.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.51.33.1.m1.1.1.1" xref="S6.T5.51.33.1.m1.1.1.1.cmml">×</mo><msup id="S6.T5.51.33.1.m1.1.1.3" xref="S6.T5.51.33.1.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.51.33.1.m1.1.1.3.2" xref="S6.T5.51.33.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.51.33.1.m1.1.1.3.3" xref="S6.T5.51.33.1.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.51.33.1.m1.1.1.3.3a" xref="S6.T5.51.33.1.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.51.33.1.m1.1.1.3.3.2" xref="S6.T5.51.33.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.51.33.1.m1.1b"><apply id="S6.T5.51.33.1.m1.1.1.cmml" xref="S6.T5.51.33.1.m1.1.1"><times id="S6.T5.51.33.1.m1.1.1.1.cmml" xref="S6.T5.51.33.1.m1.1.1.1"></times><cn type="integer" id="S6.T5.51.33.1.m1.1.1.2.cmml" xref="S6.T5.51.33.1.m1.1.1.2">1</cn><apply id="S6.T5.51.33.1.m1.1.1.3.cmml" xref="S6.T5.51.33.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.51.33.1.m1.1.1.3.1.cmml" xref="S6.T5.51.33.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.51.33.1.m1.1.1.3.2.cmml" xref="S6.T5.51.33.1.m1.1.1.3.2">10</cn><apply id="S6.T5.51.33.1.m1.1.1.3.3.cmml" xref="S6.T5.51.33.1.m1.1.1.3.3"><minus id="S6.T5.51.33.1.m1.1.1.3.3.1.cmml" xref="S6.T5.51.33.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.51.33.1.m1.1.1.3.3.2.cmml" xref="S6.T5.51.33.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.51.33.1.m1.1c">1\times 10^{-3}</annotation></semantics></math></td>
<td id="S6.T5.52.34.5" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S6.T5.52.34.5.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T5.52.34.5.1.1" class="ltx_p"><span id="S6.T5.52.34.5.1.1.1" class="ltx_text" style="font-size:90%;">Adam2</span></span>
</span>
</td>
<td id="S6.T5.52.34.2" class="ltx_td ltx_align_left ltx_border_bb"><math id="S6.T5.52.34.2.m1.1" class="ltx_Math" alttext="1\times 10^{-2}" display="inline"><semantics id="S6.T5.52.34.2.m1.1a"><mrow id="S6.T5.52.34.2.m1.1.1" xref="S6.T5.52.34.2.m1.1.1.cmml"><mn mathsize="90%" id="S6.T5.52.34.2.m1.1.1.2" xref="S6.T5.52.34.2.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S6.T5.52.34.2.m1.1.1.1" xref="S6.T5.52.34.2.m1.1.1.1.cmml">×</mo><msup id="S6.T5.52.34.2.m1.1.1.3" xref="S6.T5.52.34.2.m1.1.1.3.cmml"><mn mathsize="90%" id="S6.T5.52.34.2.m1.1.1.3.2" xref="S6.T5.52.34.2.m1.1.1.3.2.cmml">10</mn><mrow id="S6.T5.52.34.2.m1.1.1.3.3" xref="S6.T5.52.34.2.m1.1.1.3.3.cmml"><mo mathsize="90%" id="S6.T5.52.34.2.m1.1.1.3.3a" xref="S6.T5.52.34.2.m1.1.1.3.3.cmml">−</mo><mn mathsize="90%" id="S6.T5.52.34.2.m1.1.1.3.3.2" xref="S6.T5.52.34.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.52.34.2.m1.1b"><apply id="S6.T5.52.34.2.m1.1.1.cmml" xref="S6.T5.52.34.2.m1.1.1"><times id="S6.T5.52.34.2.m1.1.1.1.cmml" xref="S6.T5.52.34.2.m1.1.1.1"></times><cn type="integer" id="S6.T5.52.34.2.m1.1.1.2.cmml" xref="S6.T5.52.34.2.m1.1.1.2">1</cn><apply id="S6.T5.52.34.2.m1.1.1.3.cmml" xref="S6.T5.52.34.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.T5.52.34.2.m1.1.1.3.1.cmml" xref="S6.T5.52.34.2.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.T5.52.34.2.m1.1.1.3.2.cmml" xref="S6.T5.52.34.2.m1.1.1.3.2">10</cn><apply id="S6.T5.52.34.2.m1.1.1.3.3.cmml" xref="S6.T5.52.34.2.m1.1.1.3.3"><minus id="S6.T5.52.34.2.m1.1.1.3.3.1.cmml" xref="S6.T5.52.34.2.m1.1.1.3.3"></minus><cn type="integer" id="S6.T5.52.34.2.m1.1.1.3.3.2.cmml" xref="S6.T5.52.34.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.52.34.2.m1.1c">1\times 10^{-2}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S6.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x10.png" id="S6.F6.sf1.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Cluster 0 (MQTT).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x11.png" id="S6.F6.sf2.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Cluster 2 (CoAP).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x12.png" id="S6.F6.sf3.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Cluster 4 (Camera).</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Federated hyperparameter tuning, <span id="S6.F6.5.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> and <span id="S6.F6.6.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> optimizer selection. <math id="S6.F6.2.m1.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S6.F6.2.m1.1b"><mrow id="S6.F6.2.m1.1.1" xref="S6.F6.2.m1.1.1.cmml"><mi id="S6.F6.2.m1.1.1.2" xref="S6.F6.2.m1.1.1.2.cmml">E</mi><mo id="S6.F6.2.m1.1.1.1" xref="S6.F6.2.m1.1.1.1.cmml">=</mo><mn id="S6.F6.2.m1.1.1.3" xref="S6.F6.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F6.2.m1.1c"><apply id="S6.F6.2.m1.1.1.cmml" xref="S6.F6.2.m1.1.1"><eq id="S6.F6.2.m1.1.1.1.cmml" xref="S6.F6.2.m1.1.1.1"></eq><ci id="S6.F6.2.m1.1.1.2.cmml" xref="S6.F6.2.m1.1.1.2">𝐸</ci><cn type="integer" id="S6.F6.2.m1.1.1.3.cmml" xref="S6.F6.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F6.2.m1.1d">E=1</annotation></semantics></math>. The trials are defined in Table <a href="#S6.T5" title="TABLE V ‣ VI-C Federated Hyperparameter Tuning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</figcaption>
</figure>
<figure id="S6.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x13.png" id="S6.F7.sf1.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Cluster 0 (MQTT). Grid search for Trial 9.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x14.png" id="S6.F7.sf2.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Cluster 2 (CoAP). Grid search for Trial 9.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F7.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x15.png" id="S6.F7.sf3.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Cluster 4 (Camera). Grid search for Trial 9.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Federated hyperparameter tuning, <math id="S6.F7.3.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S6.F7.3.m1.1b"><mi id="S6.F7.3.m1.1.1" xref="S6.F7.3.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S6.F7.3.m1.1c"><ci id="S6.F7.3.m1.1.1.cmml" xref="S6.F7.3.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.3.m1.1d">\eta</annotation></semantics></math> and <math id="S6.F7.4.m2.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="S6.F7.4.m2.1b"><msub id="S6.F7.4.m2.1.1" xref="S6.F7.4.m2.1.1.cmml"><mi id="S6.F7.4.m2.1.1.2" xref="S6.F7.4.m2.1.1.2.cmml">η</mi><mi id="S6.F7.4.m2.1.1.3" xref="S6.F7.4.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S6.F7.4.m2.1c"><apply id="S6.F7.4.m2.1.1.cmml" xref="S6.F7.4.m2.1.1"><csymbol cd="ambiguous" id="S6.F7.4.m2.1.1.1.cmml" xref="S6.F7.4.m2.1.1">subscript</csymbol><ci id="S6.F7.4.m2.1.1.2.cmml" xref="S6.F7.4.m2.1.1.2">𝜂</ci><ci id="S6.F7.4.m2.1.1.3.cmml" xref="S6.F7.4.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F7.4.m2.1d">\eta_{s}</annotation></semantics></math> learning rate grid search. The values represent base 10 logarithm of the evaluation loss after 60 FL rounds.</figcaption>
</figure>
</section>
<section id="S6.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS4.4.1.1" class="ltx_text">VI-D</span> </span><span id="S6.SS4.5.2" class="ltx_text ltx_font_italic">Clustered Federated Learning</span>
</h3>

<div id="S6.SS4.p1" class="ltx_para">
<p id="S6.SS4.p1.3" class="ltx_p">The final FL training process is performed using the client-side and server-side optimizers and learning rates obtained after the federated hyperparameter tuning described in the previous step for each identified cluster. We repeated the experiments for different values of the number of local training epochs <math id="S6.SS4.p1.1.m1.3" class="ltx_Math" alttext="E=1,2,4" display="inline"><semantics id="S6.SS4.p1.1.m1.3a"><mrow id="S6.SS4.p1.1.m1.3.4" xref="S6.SS4.p1.1.m1.3.4.cmml"><mi id="S6.SS4.p1.1.m1.3.4.2" xref="S6.SS4.p1.1.m1.3.4.2.cmml">E</mi><mo id="S6.SS4.p1.1.m1.3.4.1" xref="S6.SS4.p1.1.m1.3.4.1.cmml">=</mo><mrow id="S6.SS4.p1.1.m1.3.4.3.2" xref="S6.SS4.p1.1.m1.3.4.3.1.cmml"><mn id="S6.SS4.p1.1.m1.1.1" xref="S6.SS4.p1.1.m1.1.1.cmml">1</mn><mo id="S6.SS4.p1.1.m1.3.4.3.2.1" xref="S6.SS4.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S6.SS4.p1.1.m1.2.2" xref="S6.SS4.p1.1.m1.2.2.cmml">2</mn><mo id="S6.SS4.p1.1.m1.3.4.3.2.2" xref="S6.SS4.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S6.SS4.p1.1.m1.3.3" xref="S6.SS4.p1.1.m1.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.1.m1.3b"><apply id="S6.SS4.p1.1.m1.3.4.cmml" xref="S6.SS4.p1.1.m1.3.4"><eq id="S6.SS4.p1.1.m1.3.4.1.cmml" xref="S6.SS4.p1.1.m1.3.4.1"></eq><ci id="S6.SS4.p1.1.m1.3.4.2.cmml" xref="S6.SS4.p1.1.m1.3.4.2">𝐸</ci><list id="S6.SS4.p1.1.m1.3.4.3.1.cmml" xref="S6.SS4.p1.1.m1.3.4.3.2"><cn type="integer" id="S6.SS4.p1.1.m1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1">1</cn><cn type="integer" id="S6.SS4.p1.1.m1.2.2.cmml" xref="S6.SS4.p1.1.m1.2.2">2</cn><cn type="integer" id="S6.SS4.p1.1.m1.3.3.cmml" xref="S6.SS4.p1.1.m1.3.3">4</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.1.m1.3c">E=1,2,4</annotation></semantics></math> and 8. Increasing the number of local training epochs generally leads to lower loss values and fewer FL rounds to reach convergence at the expense of more local computation time. However, we also observed an increased variance in the loss distribution across the devices of the cluster when using large numbers of local training epochs. The training results for <math id="S6.SS4.p1.2.m2.1" class="ltx_Math" alttext="E=4" display="inline"><semantics id="S6.SS4.p1.2.m2.1a"><mrow id="S6.SS4.p1.2.m2.1.1" xref="S6.SS4.p1.2.m2.1.1.cmml"><mi id="S6.SS4.p1.2.m2.1.1.2" xref="S6.SS4.p1.2.m2.1.1.2.cmml">E</mi><mo id="S6.SS4.p1.2.m2.1.1.1" xref="S6.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS4.p1.2.m2.1.1.3" xref="S6.SS4.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.2.m2.1b"><apply id="S6.SS4.p1.2.m2.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1"><eq id="S6.SS4.p1.2.m2.1.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1.1"></eq><ci id="S6.SS4.p1.2.m2.1.1.2.cmml" xref="S6.SS4.p1.2.m2.1.1.2">𝐸</ci><cn type="integer" id="S6.SS4.p1.2.m2.1.1.3.cmml" xref="S6.SS4.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.2.m2.1c">E=4</annotation></semantics></math> local epochs and <math id="S6.SS4.p1.3.m3.1" class="ltx_Math" alttext="R=100" display="inline"><semantics id="S6.SS4.p1.3.m3.1a"><mrow id="S6.SS4.p1.3.m3.1.1" xref="S6.SS4.p1.3.m3.1.1.cmml"><mi id="S6.SS4.p1.3.m3.1.1.2" xref="S6.SS4.p1.3.m3.1.1.2.cmml">R</mi><mo id="S6.SS4.p1.3.m3.1.1.1" xref="S6.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS4.p1.3.m3.1.1.3" xref="S6.SS4.p1.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.3.m3.1b"><apply id="S6.SS4.p1.3.m3.1.1.cmml" xref="S6.SS4.p1.3.m3.1.1"><eq id="S6.SS4.p1.3.m3.1.1.1.cmml" xref="S6.SS4.p1.3.m3.1.1.1"></eq><ci id="S6.SS4.p1.3.m3.1.1.2.cmml" xref="S6.SS4.p1.3.m3.1.1.2">𝑅</ci><cn type="integer" id="S6.SS4.p1.3.m3.1.1.3.cmml" xref="S6.SS4.p1.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.3.m3.1c">R=100</annotation></semantics></math> FL rounds are shown in Figure <a href="#S6.F8" title="Figure 8 ‣ VI-D Clustered Federated Learning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> for Clusters 0, 2 and 4. Each boxplot shows the evaluation loss distribution across the devices of the cluster at a certain FL round.</p>
</div>
<div id="S6.SS4.p2" class="ltx_para">
<p id="S6.SS4.p2.1" class="ltx_p">The progression of both training and evaluation losses was checked, there was a small gap between the training and evaluation loss, however, this gap remained more or less constant for all the FL rounds and did not show overfitting patterns.</p>
</div>
<figure id="S6.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x16.png" id="S6.F8.sf1.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Cluster 0 (MQTT).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x17.png" id="S6.F8.sf2.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Cluster 2 (CoAP).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F8.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x18.png" id="S6.F8.sf3.g1" class="ltx_graphics ltx_img_square" width="147" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Cluster 4 (Camera).</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Clustered FL training progression for <math id="S6.F8.4.m1.1" class="ltx_Math" alttext="E=4" display="inline"><semantics id="S6.F8.4.m1.1b"><mrow id="S6.F8.4.m1.1.1" xref="S6.F8.4.m1.1.1.cmml"><mi id="S6.F8.4.m1.1.1.2" xref="S6.F8.4.m1.1.1.2.cmml">E</mi><mo id="S6.F8.4.m1.1.1.1" xref="S6.F8.4.m1.1.1.1.cmml">=</mo><mn id="S6.F8.4.m1.1.1.3" xref="S6.F8.4.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F8.4.m1.1c"><apply id="S6.F8.4.m1.1.1.cmml" xref="S6.F8.4.m1.1.1"><eq id="S6.F8.4.m1.1.1.1.cmml" xref="S6.F8.4.m1.1.1.1"></eq><ci id="S6.F8.4.m1.1.1.2.cmml" xref="S6.F8.4.m1.1.1.2">𝐸</ci><cn type="integer" id="S6.F8.4.m1.1.1.3.cmml" xref="S6.F8.4.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F8.4.m1.1d">E=4</annotation></semantics></math> local training epochs and <math id="S6.F8.5.m2.1" class="ltx_Math" alttext="R=100" display="inline"><semantics id="S6.F8.5.m2.1b"><mrow id="S6.F8.5.m2.1.1" xref="S6.F8.5.m2.1.1.cmml"><mi id="S6.F8.5.m2.1.1.2" xref="S6.F8.5.m2.1.1.2.cmml">R</mi><mo id="S6.F8.5.m2.1.1.1" xref="S6.F8.5.m2.1.1.1.cmml">=</mo><mn id="S6.F8.5.m2.1.1.3" xref="S6.F8.5.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F8.5.m2.1c"><apply id="S6.F8.5.m2.1.1.cmml" xref="S6.F8.5.m2.1.1"><eq id="S6.F8.5.m2.1.1.1.cmml" xref="S6.F8.5.m2.1.1.1"></eq><ci id="S6.F8.5.m2.1.1.2.cmml" xref="S6.F8.5.m2.1.1.2">𝑅</ci><cn type="integer" id="S6.F8.5.m2.1.1.3.cmml" xref="S6.F8.5.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F8.5.m2.1d">R=100</annotation></semantics></math> FL rounds (blue boxplots). It is compared with isolated edge training where each device trains on its own dataset for <math id="S6.F8.6.m3.1" class="ltx_Math" alttext="R\times E=400" display="inline"><semantics id="S6.F8.6.m3.1b"><mrow id="S6.F8.6.m3.1.1" xref="S6.F8.6.m3.1.1.cmml"><mrow id="S6.F8.6.m3.1.1.2" xref="S6.F8.6.m3.1.1.2.cmml"><mi id="S6.F8.6.m3.1.1.2.2" xref="S6.F8.6.m3.1.1.2.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S6.F8.6.m3.1.1.2.1" xref="S6.F8.6.m3.1.1.2.1.cmml">×</mo><mi id="S6.F8.6.m3.1.1.2.3" xref="S6.F8.6.m3.1.1.2.3.cmml">E</mi></mrow><mo id="S6.F8.6.m3.1.1.1" xref="S6.F8.6.m3.1.1.1.cmml">=</mo><mn id="S6.F8.6.m3.1.1.3" xref="S6.F8.6.m3.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F8.6.m3.1c"><apply id="S6.F8.6.m3.1.1.cmml" xref="S6.F8.6.m3.1.1"><eq id="S6.F8.6.m3.1.1.1.cmml" xref="S6.F8.6.m3.1.1.1"></eq><apply id="S6.F8.6.m3.1.1.2.cmml" xref="S6.F8.6.m3.1.1.2"><times id="S6.F8.6.m3.1.1.2.1.cmml" xref="S6.F8.6.m3.1.1.2.1"></times><ci id="S6.F8.6.m3.1.1.2.2.cmml" xref="S6.F8.6.m3.1.1.2.2">𝑅</ci><ci id="S6.F8.6.m3.1.1.2.3.cmml" xref="S6.F8.6.m3.1.1.2.3">𝐸</ci></apply><cn type="integer" id="S6.F8.6.m3.1.1.3.cmml" xref="S6.F8.6.m3.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F8.6.m3.1d">R\times E=400</annotation></semantics></math> epochs (orange boxplots).</figcaption>
</figure>
<section id="S6.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S6.SS4.SSS1.4.1.1" class="ltx_text">VI-D</span>1 </span>Training baseline</h4>

<div id="S6.SS4.SSS1.p1" class="ltx_para">
<p id="S6.SS4.SSS1.p1.1" class="ltx_p">As a training baseline, we performed additional experiments to compare the training evaluation loss progression between FL and isolated edge training, where each device trains on its local data without cooperation. In isolated training, each device in the cluster starts with a random initialization of the autoencoder and trains it using the same client-side optimizer as in the FL case. The training is performed for a total of <math id="S6.SS4.SSS1.p1.1.m1.1" class="ltx_Math" alttext="R\times E" display="inline"><semantics id="S6.SS4.SSS1.p1.1.m1.1a"><mrow id="S6.SS4.SSS1.p1.1.m1.1.1" xref="S6.SS4.SSS1.p1.1.m1.1.1.cmml"><mi id="S6.SS4.SSS1.p1.1.m1.1.1.2" xref="S6.SS4.SSS1.p1.1.m1.1.1.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S6.SS4.SSS1.p1.1.m1.1.1.1" xref="S6.SS4.SSS1.p1.1.m1.1.1.1.cmml">×</mo><mi id="S6.SS4.SSS1.p1.1.m1.1.1.3" xref="S6.SS4.SSS1.p1.1.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.SSS1.p1.1.m1.1b"><apply id="S6.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S6.SS4.SSS1.p1.1.m1.1.1"><times id="S6.SS4.SSS1.p1.1.m1.1.1.1.cmml" xref="S6.SS4.SSS1.p1.1.m1.1.1.1"></times><ci id="S6.SS4.SSS1.p1.1.m1.1.1.2.cmml" xref="S6.SS4.SSS1.p1.1.m1.1.1.2">𝑅</ci><ci id="S6.SS4.SSS1.p1.1.m1.1.1.3.cmml" xref="S6.SS4.SSS1.p1.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.SSS1.p1.1.m1.1c">R\times E</annotation></semantics></math> epochs so that the amount of local training performed by each device is comparable to the FL case. The comparison is shown in Figure <a href="#S6.F8" title="Figure 8 ‣ VI-D Clustered Federated Learning ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<div id="S6.SS4.SSS1.p2" class="ltx_para">
<p id="S6.SS4.SSS1.p2.1" class="ltx_p">For Clusters 0 and 2, there is a noticeable gap in the evaluation loss between the FL and isolated training methods, where FL shows a faster convergence rate, especially in early rounds. For Cluster 4, while FL shows a lower average loss, the loss distribution is similar to the isolated training.</p>
</div>
<div id="S6.SS4.SSS1.p3" class="ltx_para">
<p id="S6.SS4.SSS1.p3.1" class="ltx_p">This difference might be explained due to the different training data volumes generated by each device. Cluster 4 devices generate a much larger data volume because they are comprised of image streaming devices, ranging between 300 to 800 MB of raw pcap data; this extensive training data can benefit local isolated training. However, the raw pcap data for Cluster 0 devices ranges approximately between 230 KB to 270 KB. For Cluster 2 devices, the raw data is between 100 KB to 170 KB. This suggests the advantages of using FL for devices that generate a low volume of training data samples.</p>
</div>
</section>
</section>
<section id="S6.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS5.4.1.1" class="ltx_text">VI-E</span> </span><span id="S6.SS5.5.2" class="ltx_text ltx_font_italic">Anomaly Detection</span>
</h3>

<div id="S6.SS5.p1" class="ltx_para">
<p id="S6.SS5.p1.1" class="ltx_p">Here we provide the anomaly detection performance results for clusters 0, 2 and 4 by evaluating the trained global models from the previous step on the multiple validation-attack datasets described in section <a href="#S4.SS2" title="IV-B Data Generation and Collection Method ‣ IV IoT Testbed and Experimental Setup ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span></span></a>. The number of packets (normal and attack) after filtering the pcaps is shown in table <a href="#S6.T6" title="TABLE VI ‣ VI-E Anomaly Detection ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>. As explained in section <a href="#S5" title="V Implementation ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>, the anomaly threshold of each device is selected so that there are no false positives in the device’s validation-normal dataset. The attack packets are considered as the positive class.</p>
</div>
<figure id="S6.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>The number of packets after the IPv6 and ARP filtering step in the validation-attack datasets.</figcaption>
<table id="S6.T6.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T6.3.1.1" class="ltx_tr">
<th id="S6.T6.3.1.1.1" class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_r ltx_border_tt">
<span id="S6.T6.3.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T6.3.1.1.1.1.1" class="ltx_p"><span id="S6.T6.3.1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">validation-attack-*</span></span>
</span>
</th>
<td id="S6.T6.3.1.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S6.T6.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Cluster 0</span></td>
<td id="S6.T6.3.1.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S6.T6.3.1.1.3.1" class="ltx_text" style="font-size:90%;">Cluster 2</span></td>
<td id="S6.T6.3.1.1.4" class="ltx_td ltx_align_left ltx_border_tt"><span id="S6.T6.3.1.1.4.1" class="ltx_text" style="font-size:90%;">Cluster 4</span></td>
</tr>
<tr id="S6.T6.3.2.2" class="ltx_tr">
<th id="S6.T6.3.2.2.1" class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S6.T6.3.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T6.3.2.2.1.1.1" class="ltx_p"><span id="S6.T6.3.2.2.1.1.1.1" class="ltx_text" style="font-size:90%;">mirai-scan-load</span></span>
</span>
</th>
<td id="S6.T6.3.2.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T6.3.2.2.2.1" class="ltx_text" style="font-size:90%;">110,354</span></td>
<td id="S6.T6.3.2.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S6.T6.3.2.2.3.1" class="ltx_text" style="font-size:90%;">70,592</span></td>
<td id="S6.T6.3.2.2.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T6.3.2.2.4.1" class="ltx_text" style="font-size:90%;">888,833</span></td>
</tr>
<tr id="S6.T6.3.3.3" class="ltx_tr">
<th id="S6.T6.3.3.3.1" class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_r">
<span id="S6.T6.3.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T6.3.3.3.1.1.1" class="ltx_p"><span id="S6.T6.3.3.3.1.1.1.1" class="ltx_text" style="font-size:90%;">mirai-cnc-dos</span></span>
</span>
</th>
<td id="S6.T6.3.3.3.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S6.T6.3.3.3.2.1" class="ltx_text" style="font-size:90%;">6,810,612</span></td>
<td id="S6.T6.3.3.3.3" class="ltx_td ltx_align_left ltx_border_r"><span id="S6.T6.3.3.3.3.1" class="ltx_text" style="font-size:90%;">7,777,427</span></td>
<td id="S6.T6.3.3.3.4" class="ltx_td ltx_align_left"><span id="S6.T6.3.3.3.4.1" class="ltx_text" style="font-size:90%;">7,924,688</span></td>
</tr>
<tr id="S6.T6.3.4.4" class="ltx_tr">
<th id="S6.T6.3.4.4.1" class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_r">
<span id="S6.T6.3.4.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T6.3.4.4.1.1.1" class="ltx_p"><span id="S6.T6.3.4.4.1.1.1.1" class="ltx_text" style="font-size:90%;">merlin-cnc-dos</span></span>
</span>
</th>
<td id="S6.T6.3.4.4.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S6.T6.3.4.4.2.1" class="ltx_text" style="font-size:90%;">32,282</span></td>
<td id="S6.T6.3.4.4.3" class="ltx_td ltx_align_left ltx_border_r"><span id="S6.T6.3.4.4.3.1" class="ltx_text" style="font-size:90%;">31,014</span></td>
<td id="S6.T6.3.4.4.4" class="ltx_td ltx_align_left"><span id="S6.T6.3.4.4.4.1" class="ltx_text" style="font-size:90%;">868,586</span></td>
</tr>
<tr id="S6.T6.3.5.5" class="ltx_tr">
<th id="S6.T6.3.5.5.1" class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_r">
<span id="S6.T6.3.5.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T6.3.5.5.1.1.1" class="ltx_p"><span id="S6.T6.3.5.5.1.1.1.1" class="ltx_text" style="font-size:90%;">masscan</span></span>
</span>
</th>
<td id="S6.T6.3.5.5.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S6.T6.3.5.5.2.1" class="ltx_text" style="font-size:90%;">816</span></td>
<td id="S6.T6.3.5.5.3" class="ltx_td ltx_align_left ltx_border_r"><span id="S6.T6.3.5.5.3.1" class="ltx_text" style="font-size:90%;">571</span></td>
<td id="S6.T6.3.5.5.4" class="ltx_td ltx_align_left"><span id="S6.T6.3.5.5.4.1" class="ltx_text" style="font-size:90%;">203,814</span></td>
</tr>
<tr id="S6.T6.3.6.6" class="ltx_tr">
<th id="S6.T6.3.6.6.1" class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_bb ltx_border_r">
<span id="S6.T6.3.6.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T6.3.6.6.1.1.1" class="ltx_p"><span id="S6.T6.3.6.6.1.1.1.1" class="ltx_text" style="font-size:90%;">scan-amplification</span></span>
</span>
</th>
<td id="S6.T6.3.6.6.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S6.T6.3.6.6.2.1" class="ltx_text" style="font-size:90%;">n/a</span></td>
<td id="S6.T6.3.6.6.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S6.T6.3.6.6.3.1" class="ltx_text" style="font-size:90%;">68,422</span></td>
<td id="S6.T6.3.6.6.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S6.T6.3.6.6.4.1" class="ltx_text" style="font-size:90%;">n/a</span></td>
</tr>
</tbody>
</table>
</figure>
<section id="S6.SS5.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S6.SS5.SSS1.4.1.1" class="ltx_text">VI-E</span>1 </span>Cluster 0 (MQTT)</h4>

<div id="S6.SS5.SSS1.p1" class="ltx_para">
<p id="S6.SS5.SSS1.p1.1" class="ltx_p">We evaluate the global model of Cluster 0 on the four validation-attack datasets captured from one instance of the Building monitor device.</p>
</div>
<div id="S6.SS5.SSS1.p2" class="ltx_para">
<p id="S6.SS5.SSS1.p2.1" class="ltx_p">For the mirai-scan-load data, the reconstruction error of all anomalous packets is above the threshold, and the normal packets have a low reconstruction error except for a single false positive: TP, FN, FP, TN = 108532, 0, 1, 1821 (0.9999 accuracy, 0.9999 F1 and 0.9997 MCC). Similarly, for the masscan data the model correctly classified all packets: TP, FN, FP, TN = 528, 0, 0, 288 (1.0 accuracy, F1 and MCC).</p>
</div>
<div id="S6.SS5.SSS1.p3" class="ltx_para">
<p id="S6.SS5.SSS1.p3.1" class="ltx_p">For the mirai-cnc-dos and merlin-cnc-dos datasets, some false negatives are reported. In the mirai-cnc-dos case, the C&amp;C activity and seven out of eight DoS attacks were all correctly classified; however, some (but not all) of the attack packets corresponding to the same time frame when the DNS attack was being performed were below the anomaly threshold: TP, FN, FP, TN = 6743222, 66190, 0, 1200 (0.9903 accuracy, 0.9951 F1 and 0.1328 MCC). For the merlin-cnc-dos case, the C&amp;C activity, ingress tool transfer and three out of four attacks were all correctly classified. The model did not detect the anomalous packets corresponding to the ICMP flood attack: TP, FN, FP, TN = 25828, 5277, 0, 1177 (0.8365 accuracy, 0.9073 F1 and 0.3891 MCC). The reconstruction error scatter plot for the merlin-cnc-dos case is shown in Figure <a href="#S6.F9.sf1" title="In Figure 9 ‣ VI-E3 Cluster 4 (Camera) ‣ VI-E Anomaly Detection ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9a</span></a>.</p>
</div>
</section>
<section id="S6.SS5.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S6.SS5.SSS2.4.1.1" class="ltx_text">VI-E</span>2 </span>Cluster 2 (CoAP)</h4>

<div id="S6.SS5.SSS2.p1" class="ltx_para">
<p id="S6.SS5.SSS2.p1.1" class="ltx_p">The global model of Cluster 2 is evaluated on the five validation-attack datasets captured from one instance of the Combined cycle device.</p>
</div>
<div id="S6.SS5.SSS2.p2" class="ltx_para">
<p id="S6.SS5.SSS2.p2.1" class="ltx_p">This model correctly classified all normal and anomalous packets for all the validation-attack datasets except for a single false negative packet. The mirai-scan-load case obtained: TP, FN, FP, TN = 70195, 0, 0, 397 (1.0 accuracy, F1 and MCC). For the mirai-cnc-dos data: TP, FN, FP, TN = 7777173, 0, 0, 254 (1.0 accuracy, F1 and MCC). In the merlin-cnc-dos case: TP, FN, FP, TN = 30754, 0, 0, 260 (1.0 accuracy, F1 and MCC). The masscan data obtained: TP, FN, FP, TN = 522, 0, 0, 49 (1.0 accuracy, F1 and MCC). And lastly, the scan-amplification: TP, FN, FP, TN = 68237, 1, 0, 184 (0.9999 accuracy, 0.9999 F1 and 0.9973 MCC). The reconstruction error for the scan-amplification dataset is shown in Figure <a href="#S6.F9.sf2" title="In Figure 9 ‣ VI-E3 Cluster 4 (Camera) ‣ VI-E Anomaly Detection ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9b</span></a>.</p>
</div>
</section>
<section id="S6.SS5.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S6.SS5.SSS3.4.1.1" class="ltx_text">VI-E</span>3 </span>Cluster 4 (Camera)</h4>

<div id="S6.SS5.SSS3.p1" class="ltx_para">
<p id="S6.SS5.SSS3.p1.1" class="ltx_p">We evaluate the global model of Cluster 4 on the four validation-attack datasets captured from one instance of the IP camera museum.</p>
</div>
<div id="S6.SS5.SSS3.p2" class="ltx_para">
<p id="S6.SS5.SSS3.p2.1" class="ltx_p">For the mirai-scan-load data, the reconstruction error of all anomalous packets is above the threshold, and the normal packets are correctly classified except for a false positive: TP, FN, FP, TN = 81604, 0, 1, 807228 (0.9999 accuracy, 0.9999 F1 and 0.9999 MCC). This case is shown in Figure <a href="#S6.F9.sf3" title="In Figure 9 ‣ VI-E3 Cluster 4 (Camera) ‣ VI-E Anomaly Detection ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9c</span></a>. The number of false positives and false negatives is slightly increased in the mirai-cnc-dos dataset, part (but not all) of the packets corresponding to the time frame where the Mirai GRE IP and GRE Ethernet attacks are below the threshold: TP, FN, FP, TN = 7424929, 224, 4, 499531 (0.9999 accuracy, 0.9999 F1 and 0.9997 MCC).</p>
</div>
<div id="S6.SS5.SSS3.p3" class="ltx_para">
<p id="S6.SS5.SSS3.p3.1" class="ltx_p">For the merlin-cnc-dos dataset, all the packets were correctly classified: TP, FN, FP, TN = 30990, 0, 0, 837596 (1.0 accuracy, F1 and MCC). Similarly, the packets of the masscan dataset were also correctly classified: TP, FN, FP, TN = 548, 0, 0, 203266 (1.0 accuracy, F1 and MCC).</p>
</div>
<figure id="S6.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F9.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x19.png" id="S6.F9.sf1.g1" class="ltx_graphics ltx_img_landscape" width="147" height="91" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Cluster 0 global model evaluated on validation-attack-merlin-cnc-dos dataset for the same cluster. (A) start Merlin agent. (B) hping3 upload. (C), (D), (E) and (F) ICMP, UDP, SYN and ACK attacks, respectively. (G) stop Merlin agent. The (C) event packets are below the threshold.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F9.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x20.png" id="S6.F9.sf2.g1" class="ltx_graphics ltx_img_landscape" width="147" height="91" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Cluster 2 global model evaluated on validation-attack-scan-amplification dataset for the same cluster. (A)–(B) Nmap random port scan. (C) Nmap port 5683 scan. (D)–(E) Nmap top 1000 ports scan. (F) CoAP amplification attack.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F9.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x21.png" id="S6.F9.sf3.g1" class="ltx_graphics ltx_img_landscape" width="147" height="91" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Cluster 4 global model evaluated on validation-attack-mirai-scan-load dataset for the same cluster. (A) testbed’s Mirai bot is started. (B) This Cluster 4 device (IP camera museum) gets infected with Mirai. Packets labeled as ’Others’ are other Mirai-infected IoT devices scanning the network.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Anomaly detection examples. Dotted line indicates the anomaly threshold, packets with MSE above the threshold are considered anomalous.</figcaption>
</figure>
</section>
</section>
<section id="S6.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS6.4.1.1" class="ltx_text">VI-F</span> </span><span id="S6.SS6.5.2" class="ltx_text ltx_font_italic">Baseline experimental comparisons</span>
</h3>

<div id="S6.SS6.p1" class="ltx_para">
<p id="S6.SS6.p1.1" class="ltx_p">Here we provide anomaly detection performance results for the considered baseline approaches.</p>
</div>
<section id="S6.SS6.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S6.SS6.SSS1.4.1.1" class="ltx_text">VI-F</span>1 </span>Kitsune</h4>

<div id="S6.SS6.SSS1.p1" class="ltx_para">
<p id="S6.SS6.SSS1.p1.1" class="ltx_p">For the comparison with Kitsune, we use its publicly available Python implementation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite>. We configure Kitsune to use the default parameters (<math id="S6.SS6.SSS1.p1.1.m1.1" class="ltx_Math" alttext="m=10" display="inline"><semantics id="S6.SS6.SSS1.p1.1.m1.1a"><mrow id="S6.SS6.SSS1.p1.1.m1.1.1" xref="S6.SS6.SSS1.p1.1.m1.1.1.cmml"><mi id="S6.SS6.SSS1.p1.1.m1.1.1.2" xref="S6.SS6.SSS1.p1.1.m1.1.1.2.cmml">m</mi><mo id="S6.SS6.SSS1.p1.1.m1.1.1.1" xref="S6.SS6.SSS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS1.p1.1.m1.1.1.3" xref="S6.SS6.SSS1.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS1.p1.1.m1.1b"><apply id="S6.SS6.SSS1.p1.1.m1.1.1.cmml" xref="S6.SS6.SSS1.p1.1.m1.1.1"><eq id="S6.SS6.SSS1.p1.1.m1.1.1.1.cmml" xref="S6.SS6.SSS1.p1.1.m1.1.1.1"></eq><ci id="S6.SS6.SSS1.p1.1.m1.1.1.2.cmml" xref="S6.SS6.SSS1.p1.1.m1.1.1.2">𝑚</ci><cn type="integer" id="S6.SS6.SSS1.p1.1.m1.1.1.3.cmml" xref="S6.SS6.SSS1.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS1.p1.1.m1.1c">m=10</annotation></semantics></math> maximum size for any autoencoder in the ensemble layer). Kitsune does not use FL, so for each device on which we deploy it, we use its corresponding normal traffic data for training (the first 10% to learn Kitsune’s feature mapping and the remaining 90% for the training of the autoencoder ensemble itself). Then, it is evaluated on the device’s corresponding validation-attack datasets. In this comparison experiment, we are not primarily interested in the results of the anomaly detection metrics; however, we are interested in what kind of attacks or malicious behavior detection our proposed method differs from Kitsune.</p>
</div>
<div id="S6.SS6.SSS1.p2" class="ltx_para">
<p id="S6.SS6.SSS1.p2.1" class="ltx_p">Regarding the mirai-scan-load dataset, the measured metrics ranged from 0.9729 – 0.9771 accuracy, 0.9861 – 0.9883 F1 and 0.3518 – 0.4525 MCC depending on the device type. Overall, most packets related to the Mirai scanning, brute-forcing and malware loading stages appeared above the anomaly threshold. However, most Mirai C&amp;C related traffic went undetected.</p>
</div>
<div id="S6.SS6.SSS1.p3" class="ltx_para">
<p id="S6.SS6.SSS1.p3.1" class="ltx_p">The results on the Mirai C&amp;C related traffic are best observed on the mirai-cnc-dos datasets, shown in Figure <a href="#S6.F10.sf2" title="In Figure 10 ‣ VI-F1 Kitsune ‣ VI-F Baseline experimental comparisons ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10b</span></a>. The measured metrics are 0.9998 accuracy, 0.9999 F1 and 0.7397 MCC. Kitsune correctly detected all the performed DoS attacks as anomalous, but failed to detect the C&amp;C related traffic. During the period between the Mirai bot activation and the first attack, the device periodically communicates with the Mirai C&amp;C server. This traffic went undetected for Kitsune as its reconstruction error is close to the error for normal traffic. In contrast, while our proposed method failed to detect some packets related to the DoS attacks, all the Mirai C&amp;C traffic is well separated from the normal activity, as shown in Figure <a href="#S6.F10.sf1" title="In Figure 10 ‣ VI-F1 Kitsune ‣ VI-F Baseline experimental comparisons ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10a</span></a>.</p>
</div>
<div id="S6.SS6.SSS1.p4" class="ltx_para">
<p id="S6.SS6.SSS1.p4.1" class="ltx_p">The masscan dataset also shows significant differences between Kitsune and the proposed clustered FL model. The measured metrics ranged from 0.7781-0.8122 accuracy, 0.8026-0.8865 F1 and 0.4665-0.5971 MCC. All the low-volume scanning activity and a significant number of packets from the medium-volume scanning activity were below Kitsune’s threshold, as shown in Figure <a href="#S6.F11.sf2" title="In Figure 11 ‣ VI-F1 Kitsune ‣ VI-F Baseline experimental comparisons ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11b</span></a>. However, our proposed method detected all activity irrespective of the scanning rate, as shown in Figure <a href="#S6.F11.sf1" title="In Figure 11 ‣ VI-F1 Kitsune ‣ VI-F Baseline experimental comparisons ‣ VI Results ‣ Clustered Federated Learning Architecture for Network Anomaly Detection in Large Scale Heterogeneous IoT Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11a</span></a>.</p>
</div>
<div id="S6.SS6.SSS1.p5" class="ltx_para">
<p id="S6.SS6.SSS1.p5.1" class="ltx_p">Unlike Mirai’s C&amp;C behavior, Kitsune was able to detect the Merlin C&amp;C activity, which is noisier than Mirai’s. Some packets related to the ICMP attack went undetected; however, all attacks included packets above the anomaly threshold: 0.9791 accuracy, 0.9891 F1 and 0.7392 MCC. Most anomalous packets from the scan-amplification data were also correctly classified: 0.9912 accuracy, 0.9955 F1 and 0.5988.</p>
</div>
<figure id="S6.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S6.F10.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x22.png" id="S6.F10.sf1.g1" class="ltx_graphics ltx_img_landscape" width="225" height="139" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Proposed clustered FL method.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S6.F10.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x23.png" id="S6.F10.sf2.g1" class="ltx_graphics ltx_img_landscape" width="225" height="139" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Kitsune.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Anomaly detection results for the validation-attack-mirai-cnc-dos dataset on one of the Building monitor devices. (A) Start Mirai bot on the device. (B)–(C) DoS attacks. (D) stop Mirai bot. Dotted line indicates the anomaly threshold.</figcaption>
</figure>
<figure id="S6.F11" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S6.F11.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x24.png" id="S6.F11.sf1.g1" class="ltx_graphics ltx_img_landscape" width="225" height="139" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Proposed clustered FL method.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S6.F11.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.15986/assets/x25.png" id="S6.F11.sf2.g1" class="ltx_graphics ltx_img_landscape" width="225" height="139" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Kitsune.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Anomaly detection results for the validation-attack-masscan dataset on one of the Building monitor devices. (A) Masscan node performs low-volume scan. (B) Masscan node performs medium-volume scan. (C) Masscan node performs high volume scan. Dotted line indicates the anomaly threshold.</figcaption>
</figure>
</section>
<section id="S6.SS6.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S6.SS6.SSS2.4.1.1" class="ltx_text">VI-F</span>2 </span>non-clustered FL with weighted aggregation</h4>

<div id="S6.SS6.SSS2.p1" class="ltx_para">
<p id="S6.SS6.SSS2.p1.5" class="ltx_p">In this baseline, we train a single global model for all the clients, i.e., we are considering the <math id="S6.SS6.SSS2.p1.1.m1.1" class="ltx_Math" alttext="K=1" display="inline"><semantics id="S6.SS6.SSS2.p1.1.m1.1a"><mrow id="S6.SS6.SSS2.p1.1.m1.1.1" xref="S6.SS6.SSS2.p1.1.m1.1.1.cmml"><mi id="S6.SS6.SSS2.p1.1.m1.1.1.2" xref="S6.SS6.SSS2.p1.1.m1.1.1.2.cmml">K</mi><mo id="S6.SS6.SSS2.p1.1.m1.1.1.1" xref="S6.SS6.SSS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS2.p1.1.m1.1.1.3" xref="S6.SS6.SSS2.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS2.p1.1.m1.1b"><apply id="S6.SS6.SSS2.p1.1.m1.1.1.cmml" xref="S6.SS6.SSS2.p1.1.m1.1.1"><eq id="S6.SS6.SSS2.p1.1.m1.1.1.1.cmml" xref="S6.SS6.SSS2.p1.1.m1.1.1.1"></eq><ci id="S6.SS6.SSS2.p1.1.m1.1.1.2.cmml" xref="S6.SS6.SSS2.p1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S6.SS6.SSS2.p1.1.m1.1.1.3.cmml" xref="S6.SS6.SSS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS2.p1.1.m1.1c">K=1</annotation></semantics></math> case. The architecture for the anomaly detection autoencoder model is the same as in the clustered FL approach. We performed the federated hyperparameter tuning step, and the final optimizer selection is as follows: <span id="S6.SS6.SSS2.p1.5.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> is Adam1 with <math id="S6.SS6.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\eta=0.005" display="inline"><semantics id="S6.SS6.SSS2.p1.2.m2.1a"><mrow id="S6.SS6.SSS2.p1.2.m2.1.1" xref="S6.SS6.SSS2.p1.2.m2.1.1.cmml"><mi id="S6.SS6.SSS2.p1.2.m2.1.1.2" xref="S6.SS6.SSS2.p1.2.m2.1.1.2.cmml">η</mi><mo id="S6.SS6.SSS2.p1.2.m2.1.1.1" xref="S6.SS6.SSS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS2.p1.2.m2.1.1.3" xref="S6.SS6.SSS2.p1.2.m2.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS2.p1.2.m2.1b"><apply id="S6.SS6.SSS2.p1.2.m2.1.1.cmml" xref="S6.SS6.SSS2.p1.2.m2.1.1"><eq id="S6.SS6.SSS2.p1.2.m2.1.1.1.cmml" xref="S6.SS6.SSS2.p1.2.m2.1.1.1"></eq><ci id="S6.SS6.SSS2.p1.2.m2.1.1.2.cmml" xref="S6.SS6.SSS2.p1.2.m2.1.1.2">𝜂</ci><cn type="float" id="S6.SS6.SSS2.p1.2.m2.1.1.3.cmml" xref="S6.SS6.SSS2.p1.2.m2.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS2.p1.2.m2.1c">\eta=0.005</annotation></semantics></math>, and <span id="S6.SS6.SSS2.p1.5.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> is SGD with <math id="S6.SS6.SSS2.p1.3.m3.1" class="ltx_Math" alttext="\eta_{s}=1.25" display="inline"><semantics id="S6.SS6.SSS2.p1.3.m3.1a"><mrow id="S6.SS6.SSS2.p1.3.m3.1.1" xref="S6.SS6.SSS2.p1.3.m3.1.1.cmml"><msub id="S6.SS6.SSS2.p1.3.m3.1.1.2" xref="S6.SS6.SSS2.p1.3.m3.1.1.2.cmml"><mi id="S6.SS6.SSS2.p1.3.m3.1.1.2.2" xref="S6.SS6.SSS2.p1.3.m3.1.1.2.2.cmml">η</mi><mi id="S6.SS6.SSS2.p1.3.m3.1.1.2.3" xref="S6.SS6.SSS2.p1.3.m3.1.1.2.3.cmml">s</mi></msub><mo id="S6.SS6.SSS2.p1.3.m3.1.1.1" xref="S6.SS6.SSS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS2.p1.3.m3.1.1.3" xref="S6.SS6.SSS2.p1.3.m3.1.1.3.cmml">1.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS2.p1.3.m3.1b"><apply id="S6.SS6.SSS2.p1.3.m3.1.1.cmml" xref="S6.SS6.SSS2.p1.3.m3.1.1"><eq id="S6.SS6.SSS2.p1.3.m3.1.1.1.cmml" xref="S6.SS6.SSS2.p1.3.m3.1.1.1"></eq><apply id="S6.SS6.SSS2.p1.3.m3.1.1.2.cmml" xref="S6.SS6.SSS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS6.SSS2.p1.3.m3.1.1.2.1.cmml" xref="S6.SS6.SSS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S6.SS6.SSS2.p1.3.m3.1.1.2.2.cmml" xref="S6.SS6.SSS2.p1.3.m3.1.1.2.2">𝜂</ci><ci id="S6.SS6.SSS2.p1.3.m3.1.1.2.3.cmml" xref="S6.SS6.SSS2.p1.3.m3.1.1.2.3">𝑠</ci></apply><cn type="float" id="S6.SS6.SSS2.p1.3.m3.1.1.3.cmml" xref="S6.SS6.SSS2.p1.3.m3.1.1.3">1.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS2.p1.3.m3.1c">\eta_{s}=1.25</annotation></semantics></math>. The full FL training is performed with <math id="S6.SS6.SSS2.p1.4.m4.1" class="ltx_Math" alttext="E=4" display="inline"><semantics id="S6.SS6.SSS2.p1.4.m4.1a"><mrow id="S6.SS6.SSS2.p1.4.m4.1.1" xref="S6.SS6.SSS2.p1.4.m4.1.1.cmml"><mi id="S6.SS6.SSS2.p1.4.m4.1.1.2" xref="S6.SS6.SSS2.p1.4.m4.1.1.2.cmml">E</mi><mo id="S6.SS6.SSS2.p1.4.m4.1.1.1" xref="S6.SS6.SSS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS2.p1.4.m4.1.1.3" xref="S6.SS6.SSS2.p1.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS2.p1.4.m4.1b"><apply id="S6.SS6.SSS2.p1.4.m4.1.1.cmml" xref="S6.SS6.SSS2.p1.4.m4.1.1"><eq id="S6.SS6.SSS2.p1.4.m4.1.1.1.cmml" xref="S6.SS6.SSS2.p1.4.m4.1.1.1"></eq><ci id="S6.SS6.SSS2.p1.4.m4.1.1.2.cmml" xref="S6.SS6.SSS2.p1.4.m4.1.1.2">𝐸</ci><cn type="integer" id="S6.SS6.SSS2.p1.4.m4.1.1.3.cmml" xref="S6.SS6.SSS2.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS2.p1.4.m4.1c">E=4</annotation></semantics></math> and <math id="S6.SS6.SSS2.p1.5.m5.1" class="ltx_Math" alttext="R=100" display="inline"><semantics id="S6.SS6.SSS2.p1.5.m5.1a"><mrow id="S6.SS6.SSS2.p1.5.m5.1.1" xref="S6.SS6.SSS2.p1.5.m5.1.1.cmml"><mi id="S6.SS6.SSS2.p1.5.m5.1.1.2" xref="S6.SS6.SSS2.p1.5.m5.1.1.2.cmml">R</mi><mo id="S6.SS6.SSS2.p1.5.m5.1.1.1" xref="S6.SS6.SSS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS2.p1.5.m5.1.1.3" xref="S6.SS6.SSS2.p1.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS2.p1.5.m5.1b"><apply id="S6.SS6.SSS2.p1.5.m5.1.1.cmml" xref="S6.SS6.SSS2.p1.5.m5.1.1"><eq id="S6.SS6.SSS2.p1.5.m5.1.1.1.cmml" xref="S6.SS6.SSS2.p1.5.m5.1.1.1"></eq><ci id="S6.SS6.SSS2.p1.5.m5.1.1.2.cmml" xref="S6.SS6.SSS2.p1.5.m5.1.1.2">𝑅</ci><cn type="integer" id="S6.SS6.SSS2.p1.5.m5.1.1.3.cmml" xref="S6.SS6.SSS2.p1.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS2.p1.5.m5.1c">R=100</annotation></semantics></math>, as in the clustered case. Finally, we evaluate the trained global model on the mentioned validation-attack datasets. The anomaly detection threshold is selected in the same way as in the clustered version.</p>
</div>
<div id="S6.SS6.SSS2.p2" class="ltx_para">
<p id="S6.SS6.SSS2.p2.1" class="ltx_p">The evaluation of the global model on the devices that belonged to Cluster 0 and Cluster 2 resulted in subpar anomaly detection performance. All presented some normal packet instances with high reconstruction error that raised the anomaly detection threshold. The reconstruction error of anomalous samples was close to the error for normal traffic samples, yielding a near-zero value for F1 and MCC. While the anomaly detection performance could be improved by lowering the threshold at the expense of more false positives, most attacks would still be misclassified for all the tested validation-attack datasets.</p>
</div>
<div id="S6.SS6.SSS2.p3" class="ltx_para">
<p id="S6.SS6.SSS2.p3.1" class="ltx_p">On the contrary, the evaluation of the global model on the devices that belonged to Cluster 4 offered good anomaly detection performance, similar to the performance of the clustered anomaly detection version. While the anomaly detection threshold was larger than the clustered one due to some packets with higher reconstruction error, most anomalous packets were above the threshold. The measured metrics were greater than 0.9999 F1 or 0.9997 MCC for all the tested validation-attack datasets.</p>
</div>
<div id="S6.SS6.SSS2.p4" class="ltx_para">
<p id="S6.SS6.SSS2.p4.1" class="ltx_p">This baseline shows that the single FL global model is highly biased towards the six devices that belonged to Cluster 4 (IP cameras and stream consumers), which generate more data volume compared to the rest of the devices in the network. This effect might be caused because the aggregation server weights the client’s contribution based on the number of training samples of that client. To adjust for this effect, the following FL baseline will equally weigh the contribution of all the federated clients.</p>
</div>
</section>
<section id="S6.SS6.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S6.SS6.SSS3.4.1.1" class="ltx_text">VI-F</span>3 </span>non-clustered FL without weighted aggregation</h4>

<div id="S6.SS6.SSS3.p1" class="ltx_para">
<p id="S6.SS6.SSS3.p1.5" class="ltx_p">We train a single global model (<math id="S6.SS6.SSS3.p1.1.m1.1" class="ltx_Math" alttext="K=1" display="inline"><semantics id="S6.SS6.SSS3.p1.1.m1.1a"><mrow id="S6.SS6.SSS3.p1.1.m1.1.1" xref="S6.SS6.SSS3.p1.1.m1.1.1.cmml"><mi id="S6.SS6.SSS3.p1.1.m1.1.1.2" xref="S6.SS6.SSS3.p1.1.m1.1.1.2.cmml">K</mi><mo id="S6.SS6.SSS3.p1.1.m1.1.1.1" xref="S6.SS6.SSS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS3.p1.1.m1.1.1.3" xref="S6.SS6.SSS3.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS3.p1.1.m1.1b"><apply id="S6.SS6.SSS3.p1.1.m1.1.1.cmml" xref="S6.SS6.SSS3.p1.1.m1.1.1"><eq id="S6.SS6.SSS3.p1.1.m1.1.1.1.cmml" xref="S6.SS6.SSS3.p1.1.m1.1.1.1"></eq><ci id="S6.SS6.SSS3.p1.1.m1.1.1.2.cmml" xref="S6.SS6.SSS3.p1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S6.SS6.SSS3.p1.1.m1.1.1.3.cmml" xref="S6.SS6.SSS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS3.p1.1.m1.1c">K=1</annotation></semantics></math>) using the same architecture for the anomaly detection autoencoder model as in the previous cases, but equally weighting the contribution of all the federated clients instead of by the amount of training data on each client. We use the following optimizers: <span id="S6.SS6.SSS3.p1.5.1" class="ltx_text ltx_font_smallcaps">ClientOpt</span> is Adam1 with <math id="S6.SS6.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\eta=0.005" display="inline"><semantics id="S6.SS6.SSS3.p1.2.m2.1a"><mrow id="S6.SS6.SSS3.p1.2.m2.1.1" xref="S6.SS6.SSS3.p1.2.m2.1.1.cmml"><mi id="S6.SS6.SSS3.p1.2.m2.1.1.2" xref="S6.SS6.SSS3.p1.2.m2.1.1.2.cmml">η</mi><mo id="S6.SS6.SSS3.p1.2.m2.1.1.1" xref="S6.SS6.SSS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS3.p1.2.m2.1.1.3" xref="S6.SS6.SSS3.p1.2.m2.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS3.p1.2.m2.1b"><apply id="S6.SS6.SSS3.p1.2.m2.1.1.cmml" xref="S6.SS6.SSS3.p1.2.m2.1.1"><eq id="S6.SS6.SSS3.p1.2.m2.1.1.1.cmml" xref="S6.SS6.SSS3.p1.2.m2.1.1.1"></eq><ci id="S6.SS6.SSS3.p1.2.m2.1.1.2.cmml" xref="S6.SS6.SSS3.p1.2.m2.1.1.2">𝜂</ci><cn type="float" id="S6.SS6.SSS3.p1.2.m2.1.1.3.cmml" xref="S6.SS6.SSS3.p1.2.m2.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS3.p1.2.m2.1c">\eta=0.005</annotation></semantics></math>, and <span id="S6.SS6.SSS3.p1.5.2" class="ltx_text ltx_font_smallcaps">ServerOpt</span> is SGD with <math id="S6.SS6.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\eta_{s}=1.0" display="inline"><semantics id="S6.SS6.SSS3.p1.3.m3.1a"><mrow id="S6.SS6.SSS3.p1.3.m3.1.1" xref="S6.SS6.SSS3.p1.3.m3.1.1.cmml"><msub id="S6.SS6.SSS3.p1.3.m3.1.1.2" xref="S6.SS6.SSS3.p1.3.m3.1.1.2.cmml"><mi id="S6.SS6.SSS3.p1.3.m3.1.1.2.2" xref="S6.SS6.SSS3.p1.3.m3.1.1.2.2.cmml">η</mi><mi id="S6.SS6.SSS3.p1.3.m3.1.1.2.3" xref="S6.SS6.SSS3.p1.3.m3.1.1.2.3.cmml">s</mi></msub><mo id="S6.SS6.SSS3.p1.3.m3.1.1.1" xref="S6.SS6.SSS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS3.p1.3.m3.1.1.3" xref="S6.SS6.SSS3.p1.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS3.p1.3.m3.1b"><apply id="S6.SS6.SSS3.p1.3.m3.1.1.cmml" xref="S6.SS6.SSS3.p1.3.m3.1.1"><eq id="S6.SS6.SSS3.p1.3.m3.1.1.1.cmml" xref="S6.SS6.SSS3.p1.3.m3.1.1.1"></eq><apply id="S6.SS6.SSS3.p1.3.m3.1.1.2.cmml" xref="S6.SS6.SSS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.SS6.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S6.SS6.SSS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S6.SS6.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S6.SS6.SSS3.p1.3.m3.1.1.2.2">𝜂</ci><ci id="S6.SS6.SSS3.p1.3.m3.1.1.2.3.cmml" xref="S6.SS6.SSS3.p1.3.m3.1.1.2.3">𝑠</ci></apply><cn type="float" id="S6.SS6.SSS3.p1.3.m3.1.1.3.cmml" xref="S6.SS6.SSS3.p1.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS3.p1.3.m3.1c">\eta_{s}=1.0</annotation></semantics></math>. The full FL training is performed with <math id="S6.SS6.SSS3.p1.4.m4.1" class="ltx_Math" alttext="E=4" display="inline"><semantics id="S6.SS6.SSS3.p1.4.m4.1a"><mrow id="S6.SS6.SSS3.p1.4.m4.1.1" xref="S6.SS6.SSS3.p1.4.m4.1.1.cmml"><mi id="S6.SS6.SSS3.p1.4.m4.1.1.2" xref="S6.SS6.SSS3.p1.4.m4.1.1.2.cmml">E</mi><mo id="S6.SS6.SSS3.p1.4.m4.1.1.1" xref="S6.SS6.SSS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS3.p1.4.m4.1.1.3" xref="S6.SS6.SSS3.p1.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS3.p1.4.m4.1b"><apply id="S6.SS6.SSS3.p1.4.m4.1.1.cmml" xref="S6.SS6.SSS3.p1.4.m4.1.1"><eq id="S6.SS6.SSS3.p1.4.m4.1.1.1.cmml" xref="S6.SS6.SSS3.p1.4.m4.1.1.1"></eq><ci id="S6.SS6.SSS3.p1.4.m4.1.1.2.cmml" xref="S6.SS6.SSS3.p1.4.m4.1.1.2">𝐸</ci><cn type="integer" id="S6.SS6.SSS3.p1.4.m4.1.1.3.cmml" xref="S6.SS6.SSS3.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS3.p1.4.m4.1c">E=4</annotation></semantics></math> and <math id="S6.SS6.SSS3.p1.5.m5.1" class="ltx_Math" alttext="R=100" display="inline"><semantics id="S6.SS6.SSS3.p1.5.m5.1a"><mrow id="S6.SS6.SSS3.p1.5.m5.1.1" xref="S6.SS6.SSS3.p1.5.m5.1.1.cmml"><mi id="S6.SS6.SSS3.p1.5.m5.1.1.2" xref="S6.SS6.SSS3.p1.5.m5.1.1.2.cmml">R</mi><mo id="S6.SS6.SSS3.p1.5.m5.1.1.1" xref="S6.SS6.SSS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S6.SS6.SSS3.p1.5.m5.1.1.3" xref="S6.SS6.SSS3.p1.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.SSS3.p1.5.m5.1b"><apply id="S6.SS6.SSS3.p1.5.m5.1.1.cmml" xref="S6.SS6.SSS3.p1.5.m5.1.1"><eq id="S6.SS6.SSS3.p1.5.m5.1.1.1.cmml" xref="S6.SS6.SSS3.p1.5.m5.1.1.1"></eq><ci id="S6.SS6.SSS3.p1.5.m5.1.1.2.cmml" xref="S6.SS6.SSS3.p1.5.m5.1.1.2">𝑅</ci><cn type="integer" id="S6.SS6.SSS3.p1.5.m5.1.1.3.cmml" xref="S6.SS6.SSS3.p1.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.SSS3.p1.5.m5.1c">R=100</annotation></semantics></math>, as in the previous cases.</p>
</div>
<div id="S6.SS6.SSS3.p2" class="ltx_para">
<p id="S6.SS6.SSS3.p2.1" class="ltx_p">The evaluation of the global model on the devices that belonged to Cluster 2 showed bad anomaly detection performance, similar to the previous baseline results with near zero metrics for F1 and MCC. However, the devices that belonged to Cluster 0 and Cluster 4 showed better anomaly detection metrics, but worse than the clustered FL approach: For the mirai-scan-load dataset, Cluster 0 showed 0.441 accuracy, 0.603 F1 and 0.111 MCC; Cluster 4 showed 0.947 accuracy, 0.599 F1, 0.636 MCC. For mirai-cnc-dos, Cluster 0 showed 0.213 accuracy, 0.194 F1 and 0.119 MCC; Cluster 4 showed 0.180 accuracy, 0.222 F1 and 0.094 MCC. For the merlin-cnc-dos dataset, Cluster 0 showed 0.146 accuracy, 0.205 F1 and 0.068 MCC; Cluster 4 showed 0.972 accuracy, 0.348 F1 and 0.452 MCC. Finally, for the masscan dataset, Cluster 0 showed 0.783 accuracy, 0.799 F1 and 0.642 MCC; Cluster 4 showed 0.999 accuracy, 0.816 F1 and 0.830 MCC.</p>
</div>
</section>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span id="S7.1.1" class="ltx_text ltx_font_smallcaps">Conclusions</span>
</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this work, we have proposed a clustered FL architecture that allows training unsupervised anomaly and intrusion detection models in large networks of heterogeneous IoT devices. The proposed FL architecture does not need supervised data labeling, making it appropriate for real deployments where precise network traffic labeling is not feasible. To address the problems that arise with FL in heterogeneous environments, the proposed architecture includes an unsupervised device clustering algorithm that works by inspecting the parameters of the partially trained models. This clustering method is fully integrated into the FL training pipeline. It does not rely on any external fingerprinting tools or manual clustering methods, which can ease the implementation of FL-based architectures in deployment settings.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">The architecture was implemented and evaluated on an emulated testbed comprised of multiple heterogeneous IoT and IIoT devices running real production libraries that generate traffic with a diverse set of network protocols. The proposed device clustering method showed successful grouping of the devices with similar communication patterns. However, as shown in the experiments, it must be noted that the clustering quality can be reduced in cases where the local training data in each device is not sufficient. Nevertheless, there was a wide margin of training data amount where the clustering results were mainly stable, and this can be mitigated by ensuring enough data is available before starting the process. It may also be advisable for the server to do several repetitions of the clustering step to ensure the stability of the process. Since the clustering step does not require much local training computation and only one round of communication is needed, it does not incur much cost. Additionally, training using FL exhibited a faster model convergence rate compared to the isolated edge method, especially for the devices that generate low volumes of training data.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.1" class="ltx_p">The global models were evaluated on real attacks showing low false positive rates and high detection for most of the attacks. While few DoS-based attacks were not correctly classified as anomalous for some of the device clusters, the proposed model successfully detected stealthier malicious actions such as the Mirai C&amp;C heartbeat packets and slow scanning activities. In contrast, the comparison with the ML-based Kitsune network IDS showed that Kitsune correctly detected those DoS attacks but misclassified stealthier activity. This can indicate that for a more comprehensive detection, we could deploy alongside the clustered FL model a simpler model that, for instance, uses the frequency of packets over a time window to detect generic volumetric attacks. Additionally, the proposed clustered approach outperformed non-clustered FL baselines. Training a single global model for all the heterogeneous devices showed high bias towards the devices that generate more training data or a lack of generalization of the single global model. This highlights the advantage of personalization using clustered FL approaches for unsupervised network anomaly detection.</p>
</div>
<div id="S7.p4" class="ltx_para">
<p id="S7.p4.1" class="ltx_p">The IoT device types considered in the experimental scenario are devices with low mobility capabilities. The inclusion of devices with high mobility, such as intelligent vehicles and UAVs, presents additional challenges due to their frequent transitions between multiple wireless networks with varying quality of service. This movement can cause continuous changes in the extracted network features. Evaluating or adapting unsupervised clustered FL approaches in high mobility settings is a future line of work. If the data distribution of a device changes after the clustering process but before finishing the complete FL training, dynamic or soft clustering approaches might be considered to increase the flexibility when dealing with high-mobility IoT networks. Additionally, analyzing the root cause of an anomaly to distinguish intrusions or attacks between other causes, such as device updates, is another line of future work.</p>
</div>
<div id="S7.p5" class="ltx_para">
<p id="S7.p5.1" class="ltx_p">Lastly, we note that the unsupervised model training assumes that the devices are operating in normal conditions (i.e., during the training phase, the devices are not compromised). This assumption might not hold for some adversarial settings. Future work can include exploring how compromised or adversarial devices in the network affect the unsupervised device clustering stage of the proposed method. Compromised devices might deviate from other normal devices that should belong to the same cluster. This drift might be indicative of anomalous behavior, and the device can be flagged or filtered out before the FL process starts.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">The European commission financially supported this work through Horizon Europe program under the IDUNN project (grant agreement number 101021911). It was also partially supported by the Department of Economic Development, Sustainability and Environment of the Basque Government under the ELKARTEK 2023 program, project BEACON (with registration number 2023RTE00242510). Urko Zurutuza is part of the Intelligent Systems for Industrial Systems research group of Mondragon Unibertsitatea (IT1676-22), supported by the Department of Education, Universities and Research of the Basque Government.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
H. Boyes, B. Hallaq, J. Cunningham, and T. Watson, “The industrial internet
of things (IIoT): An analysis framework,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Computers in Industry</em>,
vol. 101, pp. 1–12, Oct. 2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
E. Sisinni, A. Saifullah, S. Han, U. Jennehag, and M. Gidlund, “Industrial
Internet of Things: Challenges, Opportunities, and Directions,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE
Transactions on Industrial Informatics</em>, vol. 14, no. 11, pp.
4724–4734, Nov. 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
M. H. U. Rehman, I. Yaqoob, K. Salah, M. Imran, P. P. Jayaraman, and C. Perera,
“The role of big data analytics in industrial Internet of Things,”
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems</em>, vol. 99, pp. 247–259, Oct.
2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
M. S. Jalali, J. P. Kaiser, M. Siegel, and S. Madnick, “The Internet of
Things Promises New Benefits and Risks A Systematic Analysis of Adoption
Dynamics of IoT Products,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Security &amp; Privacy</em>, vol. 17,
no. 2, pp. 39–48, Mar. 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
N. Neshenko, E. Bou-Harb, J. Crichigno, G. Kaddoum, and N. Ghani,
“Demystifying iot security: An exhaustive survey on iot vulnerabilities and
a first empirical look on internet-scale iot exploitations,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE
Communications Surveys Tutorials</em>, vol. 21, no. 3, pp. 2702–2733, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M. Antonakakis, T. April, M. Bailey, M. Bernhard, E. Bursztein, J. Cochran,
Z. Durumeric, J. A. Halderman, L. Invernizzi, M. Kallitsis, D. Kumar,
C. Lever, Z. Ma, J. Mason, D. Menscher, C. Seaman, N. Sullivan, K. Thomas,
and Y. Zhou, “Understanding the mirai botnet,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">26th USENIX
Security Symposium (USENIX Security 17)</em>.   Vancouver, BC: USENIX Association, Aug. 2017, pp. 1093–1110.
[Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.usenix.org/conference/usenixsecurity17/technical-sessions/presentation/antonakakis</span>

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
J. Gamblin. Leaked mirai source code for research/ioc development purposes.
Accessed 2023/02/07. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/jgamblin/Mirai-Source-Code</span>

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
P.-A. Vervier and Y. Shen, “Before Toasters Rise Up: A View into the Emerging
IoT Threat Landscape,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Research in Attacks, Intrusions, and
Defenses, RAID 2018</em>, ser. Lecture Notes in Computer Science, Bailey, M
and Holz, T and Stamatogiannakis, M and Ioannidis, S, Ed., vol. 11050,
2018, pp. 556–576, 21st International Symposium on Research in Attacks,
Intrusions and Defenses (RAID), Heraklion, GREECE, SEP 10-12, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
G. Kambourakis, M. Anagnostopoulos, W. Meng, and P. Zhou, <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Botnets:
Architectures, Countermeasures, and Challenges</em>.   CRC Press, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
A.-R. Sadeghi, C. Wachsmann, and M. Waidner, “Security and Privacy Challenges
in Industrial Internet of Things,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">2015 52nd ACM/EDAC/IEEE Design
Automation Conference (DAC)</em>, ser. Design Automation Conference DAC,
2015, 52nd ACM/EDAC/IEEE Design Automation Conference (DAC), New York, NY,
JUN 08-12, 2015.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. McLaughlin, C. Konstantinou, X. Wang, L. Davi, A.-R. Sadeghi, M. Maniatakos,
and R. Karri, “The Cybersecurity Landscape in Industrial Control
Systems,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, vol. 104, no. 5, SI, pp.
1039–1057, May 2016.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
G. Kambourakis, C. Kolias, and A. Stavrou, “The Mirai Botnet and the IoT
Zombie Armies,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">MILCOM 2017 - 2017 IEEE Military Communications
Conference (MILCOM)</em>, ser. IEEE Military Communications Conference,
2017, pp. 267–272, IEEE Military Communications Conference (MILCOM),
Baltimore, MD, OCT 23-25, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
F. Meneghello, M. Calore, D. Zucchetto, M. Polese, and A. Zanella, “Iot:
Internet of threats? a survey of practical security vulnerabilities in real
iot devices,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>, vol. 6, no. 5, pp.
8182–8201, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
A. Costin and J. Zaddach, “Iot malware: Comprehensive survey, analysis
framework and case studies,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">BlackHat USA</em>, 2018.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. A. Ferrag, L. Maglaras, S. Moschoyiannis, and H. Janicke, “Deep learning
for cyber security intrusion detection: Approaches, datasets, and comparative
study,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Journal of Information Security and Applications</em>,
vol. 50, Feb. 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
W. Yu, F. Liang, X. He, W. G. Hatcher, C. Lu, J. Lin, and X. Yang, “A Survey
on the Edge Computing for the Internet of Things,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>,
vol. 6, pp. 6900–6919, 2018.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
European Parliament and Council of the European Union. (2016, 4) Regulation
(eu) 2016/679 of the european parliament and of the council of 27 april 2016
on the protection of natural persons with regard to the processing of
personal data and on the free movement of such data, and repealing directive
95/46/ec (general data protection regulation). Accessed 2023/02/07. [Online].
Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://eur-lex.europa.eu/eli/reg/2016/679</span>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Y. Zhang, H. Huang, L.-X. Yang, Y. Xiang, and M. Li, “Serious Challenges and
Potential Solutions for the Industrial Internet of Things with Edge
Intelligence,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">IEEE Network</em>, vol. 33, no. 5, pp. 41–45,
Oct. 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y. Liu, S. Garg, J. Nie, Y. Zhang, Z. Xiong, J. Kang, and M. S. Hossain,
“Deep Anomaly Detection for Time-Series Data in Industrial IoT: A
Communication-Efficient On-Device Federated Learning Approach,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE
Internet of Things Journal</em>, vol. 8, no. 8, pp. 6348–6358, Apr.
2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
J. Konečný, H. B. McMahan, F. X. Yu, P. Richtárik, A. T.
Suresh, and D. Bacon, “Federated learning: Strategies for improving
communication efficiency,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1610.05492, 2016. [Online].
Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://arxiv.org/abs/1610.05492</span>

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, A. N. Bhagoji,
K. Bonawitz, Z. Charles, G. Cormode, R. Cummings, R. G. L. D’Oliveira, S. E.
Rouayheb, D. Evans, J. Gardner, Z. Garrett, A. Gascón, B. Ghazi, P. B.
Gibbons, M. Gruteser, Z. Harchaoui, C. He, L. He, Z. Huo, B. Hutchinson,
J. Hsu, M. Jaggi, T. Javidi, G. Joshi, M. Khodak, J. Konečný,
A. Korolova, F. Koushanfar, S. Koyejo, T. Lepoint, Y. Liu, P. Mittal,
M. Mohri, R. Nock, A. Özgür, R. Pagh, M. Raykova, H. Qi,
D. Ramage, R. Raskar, D. Song, W. Song, S. U. Stich, Z. Sun, A. T. Suresh,
F. Tramèr, P. Vepakomma, J. Wang, L. Xiong, Z. Xu, Q. Yang, F. X. Yu,
H. Yu, and S. Zhao, “Advances and open problems in federated learning,”
<em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1912.04977, 2019. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://arxiv.org/abs/1912.04977</span>

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
X. Sáez-de-Cámara, J. L. Flores, C. Arellano, A. Urbieta, and
U. Zurutuza, “Gotham testbed: A reproducible iot testbed for security
experiments and dataset generation,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Dependable
and Secure Computing</em>, pp. 1–18, 2023.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
T. D. Nguyen, S. Marchal, M. Miettinen, H. Fereidooni, N. Asokan, and A.-R.
Sadeghi, “DIoT: A Federated Self-learning Anomaly Detection System for
IoT,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">2019 IEEE 39th International Conference on Distributed
Computing Systems (ICDCS)</em>, ser. IEEE International Conference on
Distributed Computing Systems, 2019, pp. 756–767, 39th IEEE
International Conference on Distributed Computing Systems (ICDCS),
Richardson, TX, JUL 07-09, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
V. Rey, P. M. S. Sánchez, A. H. Celdrán, G. Bovet, and M. Jaggi,
“Federated learning for malware detection in iot devices,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">CoRR</em>,
vol. abs/2104.09994, 2021. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://arxiv.org/abs/2104.09994</span>

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
S. I. Popoola, R. Ande, B. Adebisi, G. Gui, M. Hammoudeh, and O. Jogunola,
“Federated deep learning for zero-day botnet attack detection in iot edge
devices,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>, pp. 1–1, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
S. A. Rahman, H. Tout, C. Talhi, and A. Mourad, “Internet of Things intrusion
Detection: Centralized, On-Device, or Federated Learning?” <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE
Network</em>, vol. 34, no. 6, pp. 310–317, Sep. 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
D. C. Attota, V. Mothukuri, R. M. Parizi, and S. Pouriyeh, “An ensemble
multi-view federated learning intrusion detection for iot,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE
Access</em>, vol. 9, pp. 117 734–117 745, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Qin and M. Kondo, “Federated learning-based network intrusion detection
with a feature selection approach,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">2021 International Conference
on Electrical, Communication, and Computer Engineering (ICECCE)</em>, 2021, pp.
1–6.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Y. Zhao, J. Chen, D. Wu, J. Teng, and S. Yu, “Multi-Task Network Anomaly
Detection using Federated Learning,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">SoICT 2019: Proceedings of
the Tenth International Symposium on Information and Communication
Technology</em>, 2019, pp. 273–279, 10th International Symposium on
Information and Communication Technology (SoICT), VIETNAM, DEC 04-06, 2019.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
X. Wang, S. Garg, H. Lin, J. Hu, G. Kaddoum, M. J. Piran, and M. S. Hossain,
“Towards accurate anomaly detection in industrial internet-of-things using
hierarchical federated learning,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>,
pp. 1–1, 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
H. Saadat, A. Aboumadi, A. Mohamed, A. Erbad, and M. Guizani, “Hierarchical
federated learning for collaborative ids in iot applications,” in <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">2021
10th Mediterranean Conference on Embedded Computing (MECO)</em>, 2021, pp. 1–6.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Y. Wei, S. Zhou, S. Leng, S. Maharjan, and Y. Zhang, “Federated learning
empowered end-edge-cloud cooperation for 5g hetnet security,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">IEEE
Network</em>, vol. 35, no. 2, pp. 88–94, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
B. Li, Y. Wu, J. Song, R. Lu, T. Li, and L. Zhao, “DeepFed: Federated Deep
Learning for Intrusion Detection in Industrial Cyber-Physical Systems,”
<em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Industrial Informatics</em>, vol. 17, no. 8, pp.
5615–5624, Aug. 2021.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
V. Mothukuri, P. Khare, R. M. Parizi, S. Pouriyeh, A. Dehghantanha, and
G. Srivastava, “Federated learning-based anomaly detection for iot security
attacks,” <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>, 2021.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
V. Kelli, V. Argyriou, T. Lagkas, G. Fragulis, E. Grigoriou, and
P. Sarigiannidis, “Ids for industrial applications: A federated learning
approach with active personalization,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Sensors</em>, vol. 21, no. 20,
2021. [Online]. Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.mdpi.com/1424-8220/21/20/6743</span>

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Z. Xie, Z. Li, J. Gui, A. Liu, N. N. Xiong, and S. Zhang, “Uwpee: Using uav
and wavelet packet energy entropy to predict traffic-based attacks under
limited communication, computing and caching for 6g wireless systems,”
<em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems</em>, vol. 140, pp. 238–252, 2023.
[Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.sciencedirect.com/science/article/pii/S0167739X22003260</span>

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
W. Schneble and G. Thamilarasu, “Attack detection using federated learning in
medical cyber-physical systems,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">2019 28th International Conference
on Computer Communication and Networks, ICCCN</em>, 2019, pp. 1–8.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Y. Chen, X. Qin, J. Wang, C. Yu, and W. Gao, “FedHealth: A Federated Transfer
Learning Framework for Wearable Healthcare,” <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">IEEE Intelligent
Systems</em>, vol. 35, no. 4, pp. 83–93, Apr. 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
L. Huang, A. L. Shea, H. Qian, A. Masurkar, H. Deng, and D. Liu, “Patient
clustering improves efficiency of federated machine learning to predict
mortality and hospital stay time using distributed electronic medical
records,” <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Journal of Biomedical Informatics</em>, vol. 99, p. 103291,
2019. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.sciencedirect.com/science/article/pii/S1532046419302102</span>

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
A. Z. Tan, H. Yu, L. Cui, and Q. Yang, “Towards personalized federated
learning,” <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>,
pp. 1–17, 2022.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Sattler, Felix and Müller, Klaus-Robert and Samek, Wojciech, “Clustered
Federated Learning: Model-Agnostic Distributed Multitask Optimization Under
Privacy Constraints,” <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and
Learning Systems</em>, pp. 1–13, 2020.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
A. Ghosh, J. Hong, D. Yin, and K. Ramchandran, “Robust federated learning in a
heterogeneous environment,” <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1906.06629, 2019.
[Online]. Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://arxiv.org/abs/1906.06629</span>

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
C. Briggs, Z. Fan, and P. Andras, “Federated learning with hierarchical
clustering of local updates to improve training on non-iid data,” in
<em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">2020 International Joint Conference on Neural Networks (IJCNN)</em>, 2020,
pp. 1–9.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
A. Ghosh, J. Chung, D. Yin, and K. Ramchandran, “An efficient framework for
clustered federated learning,” in <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>, H. Larochelle, M. Ranzato, R. Hadsell, M. Balcan, and
H. Lin, Eds., vol. 33.   Curran
Associates, Inc., 2020, pp. 19 586–19 597. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://proceedings.neurips.cc/paper/2020/file/e32cc80bf07915058ce90722ee17bb71-Paper.pdf</span>

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
M. Duan, D. Liu, X. Ji, R. Liu, L. Liang, X. Chen, and Y. Tan, “Fedgroup:
Efficient federated learning via decomposed similarity-based clustering,” in
<em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">2021 IEEE Intl Conf on Parallel &amp; Distributed Processing with
Applications, Big Data &amp; Cloud Computing, Sustainable Computing &amp;
Communications, Social Computing &amp; Networking
(ISPA/BDCloud/SocialCom/SustainCom)</em>, 2021, pp. 228–237.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
M. Duan, D. Liu, X. Ji, Y. Wu, L. Liang, X. Chen, Y. Tan, and A. Ren,
“Flexible clustered federated learning for client-level data distribution
shift,” <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems</em>,
vol. 33, no. 11, pp. 2661–2674, 2022.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
M. Xie, G. Long, T. Shen, T. Zhou, X. Wang, J. Jiang, and C. Zhang,
“Multi-center federated learning,” <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2108.08647, 2021.
[Online]. Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://arxiv.org/abs/2108.08647</span>

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Z. Li, Y. He, H. Yu, J. Kang, X. Li, Z. Xu, and D. Niyato, “Data
heterogeneity-robust federated learning via group client selection in
industrial iot,” <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>, vol. 9, no. 18, pp.
17 844–17 857, 2022.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
T. Hiessl, S. Rezapour Lakani, J. Kemnitz, D. Schall, and S. Schulte,
“Cohort-based federated learning services for industrial collaboration on
the edge,” <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Journal of Parallel and Distributed Computing</em>, vol. 167,
pp. 64–76, 2022. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.sciencedirect.com/science/article/pii/S0743731522000995</span>

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
J. Guo, J. Wu, A. Liu, and N. N. Xiong, “Lightfed: An efficient and secure
federated edge learning system on model splitting,” <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions
on Parallel and Distributed Systems</em>, vol. 33, no. 11, pp. 2701–2713, 2022.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Y. Ruan and C. Joe-Wong, “Fedsoft: Soft clustered federated learning with
proximal local updating,” <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on
Artificial Intelligence</em>, vol. 36, no. 7, pp. 8124–8131, Jun. 2022.
[Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://ojs.aaai.org/index.php/AAAI/article/view/20785</span>

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
E. Bagdasaryan, A. Veit, Y. Hua, D. Estrin, and V. Shmatikov, “How to backdoor
federated learning,” in <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Twenty Third International
Conference on Artificial Intelligence and Statistics</em>, ser. Proceedings of
Machine Learning Research, S. Chiappa and R. Calandra, Eds., vol. 108.   PMLR, 26–28 Aug 2020, pp. 2938–2948.
[Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://proceedings.mlr.press/v108/bagdasaryan20a.html</span>

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
S. J. Reddi, Z. Charles, M. Zaheer, Z. Garrett, K. Rush, J. Konečný,
S. Kumar, and H. B. McMahan, “Adaptive federated optimization,” in
<em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations, ICLR 2021,
Virtual Event, Austria, May 3-7, 2021</em>.   OpenReview.net, 2021. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://openreview.net/forum?id=LkFG3lB13U5</span>

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-Efficient Learning of Deep Networks from Decentralized
Data,” in <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics</em>, ser. Proceedings of Machine Learning
Research, A. Singh and J. Zhu, Eds., vol. 54.   Fort Lauderdale, FL, USA: PMLR, 20–22 Apr 2017, pp. 1273–1282.
[Online]. Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://proceedings.mlr.press/v54/mcmahan17a.html</span>

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
D. Arthur and S. Vassilvitskii, “k-means++: The Advantages of Careful
Seeding,” Stanford InfoLab, techreport 2006-13, Jun. 2006.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Y. Liu, Z. Li, H. Xiong, X. Gao, and J. Wu, “Understanding of internal
clustering validation measures,” in <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">2010 IEEE International
Conference on Data Mining</em>.   IEEE,
Dec. 2010, pp. 911–916.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
P. J. Rousseeuw, “Silhouettes: A graphical aid to the interpretation and
validation of cluster analysis,” <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Journal of Computational and Applied
Mathematics</em>, vol. 20, pp. 53–65, 1987. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.sciencedirect.com/science/article/pii/0377042787901257</span>

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
D. L. Davies and D. W. Bouldin, “A cluster separation measure,” <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">IEEE
Transactions on Pattern Analysis and Machine Intelligence</em>, vol. PAMI-1,
no. 2, pp. 224–227, Apr. 1979.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
M. Halkidi and M. Vazirgiannis, “Clustering validity assessment: finding the
optimal partitioning of a data set,” in <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings 2001 IEEE
International Conference on Data Mining</em>.   IEEE Comput. Soc, 2001, pp. 187–194.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Y. Mirsky, T. Doitshman, Y. Elovici, and A. Shabtai, “Kitsune: An ensemble of
autoencoders for online network intrusion detection,” in <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">25th Annual
Network and Distributed System Security Symposium, NDSS 2018, San Diego,
California, USA, February 18-21, 2018</em>.   The Internet Society, 2018. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://wp.internetsociety.org/ndss/wp-content/uploads/sites/25/2018/02/ndss2018\_03A-3\_Mirsky\_paper.pdf</span>

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Y. Meidan, M. Bohadana, Y. Mathov, Y. Mirsky, A. Shabtai, D. Breitenbacher, and
Y. Elovici, “N-BaIoT—network-based detection of IoT botnet
attacks using deep autoencoders,” <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">IEEE Pervasive Computing</em>,
vol. 17, no. 3, pp. 12–22, Jul. 2018.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
J. Grossmann <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">et al.</em> Graphical network simulator 3. Accessed 2023/02/07.
[Online]. Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.gns3.com/</span>

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
R. Minerva, A. Biru, and D. Rotondi, “Towards a definition of the internet of
things (iot),” <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">IEEE Internet Initiative</em>, vol. 1, no. 1, pp. 1–86,
2015.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
R. V. Tuyl. Merlin is a cross-platform post-exploitation http/2 command &amp;
control server and agent written in golang. Accessed 2023/02/07. [Online].
Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/Ne0nd0g/merlin</span>

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
S. Sanfilippo. hping network tool. Accessed 2023/02/07. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/antirez/hping</span>

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen,
Z. Lin, N. Gimelshein, L. Antiga, A. Desmaison, A. Kopf, E. Yang, Z. DeVito,
M. Raison, A. Tejani, S. Chilamkurthy, B. Steiner, L. Fang, J. Bai, and
S. Chintala, “Pytorch: An imperative style, high-performance deep learning
library,” in <em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 32</em>,
H. Wallach, H. Larochelle, A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett, Eds.   Curran Associates, Inc., 2019, pp. 8024–8035. [Online].
Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://papers.neurips.cc/paper/9015-pytorch-an-imperative-style-high-performance-deep-learning-library.pdf</span>

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
O. Tange, “GNU parallel: The command-line power tool,” <em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">login Usenix
Mag.</em>, vol. 36, no. 1, 2011. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.usenix.org/publications/login/february-2011-volume-36-number-1/gnu-parallel-command-line-power-tool</span>

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel,
M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos,
D. Cournapeau, M. Brucher, M. Perrot, and E. Duchesnay, “Scikit-learn:
Machine learning in Python,” <em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>,
vol. 12, pp. 2825–2830, 2011.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
M. Cotton, L. Eggert, J. Touch, M. Westerlund, and S. Cheshire, “Internet
assigned numbers authority (iana) procedures for the management of the
service name and transport protocol port number registry,” Internet Requests
for Comments, RFC Editor, BCP 165, August 2011.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
U. Zurutuza, R. Uribeetxeberria, and D. Zamboni, “A data mining approach for
analysis of worm activity through automatic signature generation,” in
<em id="bib.bib70.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 1st ACM Workshop on Workshop on AISec</em>, ser. AISec
’08.   New York, NY, USA: Association
for Computing Machinery, 2008, p. 61–70. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://doi.org/10.1145/1456377.1456394</span>

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
J. Wang, Z. Charles, Z. Xu, G. Joshi, H. B. McMahan, B. A. y Arcas,
M. Al-Shedivat, G. Andrew, S. Avestimehr, K. Daly, D. Data, S. N. Diggavi,
H. Eichner, A. Gadhikar, Z. Garrett, A. M. Girgis, F. Hanzely, A. Hard,
C. He, S. Horvath, Z. Huo, A. Ingerman, M. Jaggi, T. Javidi, P. Kairouz,
S. Kale, S. P. Karimireddy, J. Konečný, S. Koyejo, T. Li, L. Liu,
M. Mohri, H. Qi, S. J. Reddi, P. Richtárik, K. Singhal, V. Smith,
M. Soltanolkotabi, W. Song, A. T. Suresh, S. U. Stich, A. Talwalkar, H. Wang,
B. E. Woodworth, S. Wu, F. X. Yu, H. Yuan, M. Zaheer, M. Zhang, T. Zhang,
C. Zheng, C. Zhu, and W. Zhu, “A field guide to federated optimization,”
<em id="bib.bib71.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2107.06917, 2021. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://arxiv.org/abs/2107.06917</span>

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
Y. Mirsky. Python implementation of kitsune. Accessed 2023/02/07. [Online].
Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/ymirsky/Kitsune-py</span>

</span>
</li>
</ul>
</section>
<div id="p5" class="ltx_para">
<p id="p5.1" class="ltx_p"><span id="p5.1.1" class="ltx_text ltx_font_bold">Xabier Sáez de Cámara</span> received his B.Sc. degree in Physics and Electronic Engineering from the Faculty of Science and Technology of the Basque Country University in 2015 and 2016, respectively. He holds an M.Sc. in Computational Engineering and Intelligent Systems from the University of the Basque Country. He is currently a Ph.D. student at IKERLAN in the Cybersecurity in Digital Platforms team and the Data Analysis and Cybersecurity research area at Mondragon Unibertsitatea, working on intrusion detection methods in IoT networks.
<br class="ltx_break"></p>
</div>
<div id="p6" class="ltx_para">
<p id="p6.1" class="ltx_p"><span id="p6.1.1" class="ltx_text ltx_font_bold">Jose Luis Flores</span> is a researcher at Ikerlan Technology Research Center within the Cybersecurity in Embedded Systems team. He holds a M.Sc. in Robotics and Advanced Control from the University of the Basque Country. His main interest is related to Artificial Intelligence and Cybersecurity. As such, the main lines he works on in each organization are Embedded System security at Ikerlan, and Machine Learning and Optimization at the university.
<br class="ltx_break"></p>
</div>
<div id="p7" class="ltx_para">
<p id="p7.1" class="ltx_p"><span id="p7.1.1" class="ltx_text ltx_font_bold">Dr. Cristóbal Arellano</span> studied Computer Engineering at the University of the Basque Country, where he obtained his Ph.D. degree (with international mention) in Web Information Systems in 2013 (Cum Laude unanimously). He has been with IKERLAN since 2015 as a researcher and he currently is part of the Cybersecurity in Digital Platforms team. His current research interests include Cybersecurity in Cloud Platforms, Device Identity Management, DevSecOps, Federated Learning, Vulnerability Monitoring and Threat Detection. He has participated as an author or co-author in conferences such as WWW, ICWE, WISE, etc. He also has participated and led multiple European funded projects such as FP7 MONDO, UTEST, H2020 QUALITY and H2020 IDUNN.
<br class="ltx_break"></p>
</div>
<div id="p8" class="ltx_para">
<p id="p8.1" class="ltx_p"><span id="p8.1.1" class="ltx_text ltx_font_bold">Dr. Aitor Urbieta</span> studied Computer Engineering at the University of Mondragon, where he obtained his Ph.D. degree (with international mention) in Computer Science in 2010 (Cum Laude unanimously). He has been with IKERLAN since 2007 where he currently leads the Cybersecurity in Digital Platforms research team. His current research interests include Cybersecurity in Digital Platforms, Internet of Things (IoT), Cybersecurity in Communication Protocols, Federated Learning, Blockchain, End-To-End Security, Vulnerability Monitoring, Threat Detection, Fog Computing, Edge Computing and IoT environment validation. He has participated as an author or co-author in more than 30 scientific publications in the previously mentioned areas, some of them Q1, published in national and international conferences and articles in JCR journals.
<br class="ltx_break"></p>
</div>
<div id="p9" class="ltx_para">
<p id="p9.1" class="ltx_p"><span id="p9.1.1" class="ltx_text ltx_font_bold">Dr. Urko Zurutuza</span> is the principal investigator of the Intelligent Systems for Industrial Systems research group, and coordinator of the Data Analysis and Cybersecurity research area. He obtained his PhD in January 2008 at Mondragon Unibertsitatea, in collaboration with the Zürich IBM Research Lab. His research interests revolve around applications of Machine Learning to real world problems, and specially Cybersecurity. He has published more than 20 articles in high impact journals, more than 55 publications in blind peer-reviewed conferences, edited 3 books (2 of them as conference proceedings), and coauthored 7 book chapters. He is member of the Board of Directors of RENIC (National Network of Excellence in Cybersecurity Research), and serves in Steering Boards of leading international conferences such as DIMVA or RAID.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.15985" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.15986" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.15986">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.15986" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.15987" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 17:32:59 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
