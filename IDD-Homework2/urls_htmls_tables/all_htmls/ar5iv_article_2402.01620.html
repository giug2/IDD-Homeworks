<article class="ltx_document">
 <div class="ltx_para" id="p1">
  <p class="ltx_p" id="p1.1">
   marginparsep has been altered.
   <br class="ltx_break"/>
   topmargin has been altered.
   <br class="ltx_break"/>
   marginparpush has been altered.
   <br class="ltx_break"/>
   <span class="ltx_text ltx_font_bold ltx_font_italic" id="p1.1.1">
    The page layout violates the ICML style.
   </span>
   Please do not change the page layout, or include packages like geometry,
savetrees, or fullpage, which change it for you.
We’re not able to reliably undo arbitrary changes to the style. Please remove
the offending package(s), or layout-changing commands and try again.
  </p>
 </div>
 <div class="ltx_para ltx_align_center" id="p3">
  <p class="ltx_p" id="p3.1">
   <span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;">
   </span>
  </p>
 </div>
 <div class="ltx_para ltx_align_center" id="p4">
  <p class="ltx_p" id="p4.1">
   <span class="ltx_text ltx_font_smallcaps" id="p4.1.1">
    MAGDi
   </span>
   <span class="ltx_text ltx_font_bold" id="p4.1.2">
    : Structured Distillation of Multi-Agent Interaction Graphs
    <br class="ltx_break"/>
    Improves Reasoning in Smaller Language Models
   </span>
  </p>
 </div>
 <div class="ltx_para ltx_align_center" id="p5">
  <p class="ltx_p" id="p5.1">
   <span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;">
   </span>
  </p>
 </div>
 <div class="ltx_para" id="p6">
  <p class="ltx_p ltx_align_center" id="p6.1">
   <span class="ltx_text ltx_font_bold" id="p6.1.1">
    Justin Chih-Yao Chen
   </span>
   <sup class="ltx_sup" id="p6.1.2">
    *
   </sup>
   <sup class="ltx_sup" id="p6.1.3">
    1
   </sup>
   <span class="ltx_text ltx_font_bold" id="p6.1.4">
    Swarnadeep Saha
   </span>
   <sup class="ltx_sup" id="p6.1.5">
    *
   </sup>
   <sup class="ltx_sup" id="p6.1.6">
    1
   </sup>
   <span class="ltx_text ltx_font_bold" id="p6.1.7">
    Elias Stengel-Eskin
   </span>
   <sup class="ltx_sup" id="p6.1.8">
    1
   </sup>
   <span class="ltx_text ltx_font_bold" id="p6.1.9">
    Mohit Bansal
   </span>
   <sup class="ltx_sup" id="p6.1.10">
    1
   </sup>
  </p>
 </div>
 <div class="ltx_para ltx_noindent" id="p7">
  <br class="ltx_break"/>
 </div>
 <span class="ltx_note ltx_role_footnotetext" id="footnotex1">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     footnotetext:
    </span>
    <sup class="ltx_sup" id="footnotex1.1">
     *
    </sup>
    Equal contribution
    <sup class="ltx_sup" id="footnotex1.2">
     1
    </sup>
    UNC Chapel Hill.
Correspondence to: Justin Chih-Yao Chen &lt;cyaochen@cs.unc.edu&gt;.
    <br class="ltx_break"/>
   </span>
  </span>
 </span>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id1.id1">
   Multi-agent interactions between Large Language Model (LLM) agents have shown major improvements on diverse reasoning tasks. However, these involve long generations from multiple models across several rounds, making them expensive.
Moreover, these multi-agent approaches fail to provide a final, single model for efficient inference.
To address this, we introduce
   <span class="ltx_text ltx_font_smallcaps" id="id1.id1.1">
    MAGDi
   </span>
   , a new method for
   <em class="ltx_emph ltx_font_italic" id="id1.id1.2">
    structured distillation of the reasoning interactions between multiple LLMs into smaller LMs
   </em>
   .
   <span class="ltx_text ltx_font_smallcaps" id="id1.id1.3">
    MAGDi
   </span>
   teaches smaller models by representing multi-agent interactions as graphs,
augmenting a base student model with a graph encoder, and distilling knowledge using three objective functions: next-token prediction, a contrastive loss between correct and incorrect reasoning, and a graph-based objective to model the interaction structure.
Experiments on seven widely-used commonsense and math reasoning benchmarks show that
   <span class="ltx_text ltx_font_smallcaps" id="id1.id1.4">
    MAGDi
   </span>
   improves the reasoning capabilities of smaller models, outperforming several methods that distill from a single teacher and multiple teachers. Moreover,
   <span class="ltx_text ltx_font_smallcaps" id="id1.id1.5">
    MAGDi
   </span>
   also demonstrates an order of magnitude higher efficiency over its teachers.
We conduct extensive analyses to show that
   <span class="ltx_text ltx_font_smallcaps" id="id1.id1.6">
    MAGDi
   </span>
   (1) enhances the generalizability to out-of-domain tasks, (2) scales positively with the size and strength of the base student model, and (3) obtains larger improvements (via our multi-teacher training) when applying self-consistency – an inference technique that relies on model diversity.
   <span class="ltx_note ltx_role_footnote" id="footnote1">
    <sup class="ltx_note_mark">
     1
    </sup>
    <span class="ltx_note_outer">
     <span class="ltx_note_content">
      <sup class="ltx_note_mark">
       1
      </sup>
      <span class="ltx_tag ltx_tag_note">
       1
      </span>
      Code/data:
      <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/dinobby/MAGDi" target="_blank" title="">
       https://github.com/dinobby/MAGDi
      </a>
      .
     </span>
    </span>
   </span>
  </p>
 </div>
 <figure class="ltx_figure" id="S0.F1">
  <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="246" id="S0.F1.g1" src="/html/2402.01620/assets/x1.png" width="461"/>
  <figcaption class="ltx_caption ltx_centering">
   <span class="ltx_tag ltx_tag_figure">
    Figure 1:
   </span>
   Overview of our distillation method. Given a reasoning problem, multiple teacher-LLMs engage in a multi-round discussion, leading to the generation of a multi-agent interaction graph (MAG). Then our structured distillation method,
   <span class="ltx_text ltx_font_smallcaps" id="S0.F1.2.1">
    MAGDi
   </span>
   distills reasoning knowledge from these graphs into a base student model.
  </figcaption>
 </figure>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para ltx_noindent" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Debate and dialogue are natural ways to improve reasoning: we form our best ideas not in isolation, but by refining and discussing them with others.
Similarly, we can improve Large Language Models (LLMs) – which often exhibit impressive multi-step reasoning capabilities
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wei et al.,
     <a class="ltx_ref" href="#bib.bib45" title="">
      2022
     </a>
     ; Kojima et al.,
     <a class="ltx_ref" href="#bib.bib27" title="">
      2022
     </a>
     )
    </cite>
    – by allowing multiple LLM instances to interact in a discussion
    <cite class="ltx_cite ltx_citemacro_citep">
     (Du et al.,
     <a class="ltx_ref" href="#bib.bib16" title="">
      2023
     </a>
     ; Chen et al.,
     <a class="ltx_ref" href="#bib.bib6" title="">
      2023b
     </a>
     ; Wu et al.,
     <a class="ltx_ref" href="#bib.bib49" title="">
      2023
     </a>
     )
    </cite>
    .
These interactive frameworks enable each agent to iteratively refine its reasoning by obtaining feedback from others, thereby leading to a better consensus at the end of multiple interaction rounds.
   </p>
  </div>
  <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_bottom" id="S1.F2" style="width:307.3pt;">
   <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S1.F2.1.1.g1" src="/html/2402.01620/assets/x2.png" width="518"/>
   <br class="ltx_break ltx_break"/>
   <div class="ltx_logical-block ltx_figure_panel ltx_minipage ltx_align_bottom" id="S1.F2.5" style="width:487.8pt;">
    <div class="ltx_logical-block ltx_minipage ltx_align_bottom" id="S1.F2.3.2" style="width:487.8pt;">
     <figure class="ltx_figure ltx_minipage ltx_align_bottom" id="S1.F2.2.1.1.1" style="width:87.8pt;">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="276" id="S1.F2.2.1.1.1.g1" src="/html/2402.01620/assets/x3.png" width="518"/>
     </figure>
     <figure class="ltx_figure ltx_minipage ltx_align_bottom" id="S1.F2.3.2.2.1" style="width:87.8pt;">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="276" id="S1.F2.3.2.2.1.g1" src="/html/2402.01620/assets/x4.png" width="518"/>
     </figure>
    </div>
    <div class="ltx_logical-block ltx_minipage ltx_align_bottom" id="S1.F2.5.4" style="width:487.8pt;">
     <figure class="ltx_figure ltx_minipage ltx_align_bottom" id="S1.F2.4.3.1.1" style="width:87.8pt;">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="279" id="S1.F2.4.3.1.1.g1" src="/html/2402.01620/assets/x5.png" width="518"/>
     </figure>
     <figure class="ltx_figure ltx_minipage ltx_align_bottom" id="S1.F2.5.4.2.1" style="width:87.8pt;">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="278" id="S1.F2.5.4.2.1.g1" src="/html/2402.01620/assets/x6.png" width="518"/>
     </figure>
    </div>
   </div>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     Figure 2:
    </span>
    <span class="ltx_text ltx_font_bold" id="S1.F2.9.1">
     Left (a):
    </span>
    Illustration of a Multi-Agent Interaction Graph (MAG) constructed with GPT4, Bard, and Claude2 collaboratively solving a math reasoning problem over three discussion rounds.
    <span class="ltx_text ltx_font_bold" id="S1.F2.10.2">
     Right (b-e):
    </span>
    The four levels that characterize our structured distillation method (
    <span class="ltx_text ltx_font_smallcaps" id="S1.F2.11.3">
     MAGDi
    </span>
    ); each level progressively distills knowledge from the highlighted components of a MAG.
   </figcaption>
  </figure>
  <div class="ltx_para ltx_noindent" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    Discussion frameworks are typically built on top of proprietary models, e.g., GPT-4, Bard, Claude, etc., which can act as general conversational agents, handle long contexts, and follow instructions
    <cite class="ltx_cite ltx_citemacro_citep">
     (Bubeck et al.,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2023
     </a>
     )
    </cite>
    .
However, these models are also computationally and monetarily expensive, especially when used in multi-round interactions, which require numerous long-token length inference calls to the underlying LLMs.
    <span class="ltx_note ltx_role_footnote" id="footnote2">
     <sup class="ltx_note_mark">
      2
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        2
       </sup>
       <span class="ltx_tag ltx_tag_note">
        2
       </span>
       For example, one such multi-LLM interaction method, ReConcile
       <cite class="ltx_cite ltx_citemacro_citep">
        (Chen et al.,
        <a class="ltx_ref" href="#bib.bib6" title="">
         2023b
        </a>
        )
       </cite>
       uses around 1900 tokens per sample on a math reasoning task, with other discussion-based methods (e.g.,
       <cite class="ltx_cite ltx_citemacro_citet">
        Du et al. (
        <a class="ltx_ref" href="#bib.bib16" title="">
         2023
        </a>
        ); Wu et al. (
        <a class="ltx_ref" href="#bib.bib49" title="">
         2023
        </a>
        )
       </cite>
       ) using even larger token budgets.
      </span>
     </span>
    </span>
    Moreover, these frameworks do not result in a final, joint model that can then be directly used for inference and instead require invoking all interacting LLMs at test time.
To reduce this cost and train a small, affordable yet capable model, we tackle the problem of teaching reasoning to smaller language models via
    <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">
     structured distillation of the interactions between multiple stronger teacher models
    </em>
    .
Specifically, we develop a structured distillation method,
    <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">
     M
    </span>
    ulti-
    <span class="ltx_text ltx_font_bold" id="S1.p2.1.3">
     A
    </span>
    gent Interaction
    <span class="ltx_text ltx_font_bold" id="S1.p2.1.4">
     G
    </span>
    raphs
    <span class="ltx_text ltx_font_bold" id="S1.p2.1.5">
     Di
    </span>
    stillation, or
    <span class="ltx_text ltx_font_smallcaps" id="S1.p2.1.6">
     MAGDi
    </span>
    , that enables a student model to learn from multi-teacher interactions, with the goal of developing a performant and efficient standalone alternative to expensive multi-agent setups. On seven popular benchmarks in both commonsense and math reasoning, we find increasing improvements over distillation baselines as we incorporate more levels of teacher interactions and structure.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    Multi-agent, multi-round interactions are characterized by their participating agents, the number of interaction rounds, and an interaction function defining what information an agent has access to while generating its responses.
This function gives rise to a structure between agents and rounds. To learn from this structure, we represent it in
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">
     M
    </span>
    ulti-
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">
     A
    </span>
    gent Interaction
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.3">
     G
    </span>
    raphs (MAG),
a graph-based encoding of multi-agent interactions (§
    <a class="ltx_ref" href="#S3.SS1" title="3.1 Multi-Agent Interaction Graph (MAG) ‣ 3 Method">
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    ).
See Fig.
    <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    for an example. Concretely, a MAG is a directed acyclic graph (DAG) wherein each node represents an agent’s generation (in this case, the Chain-of-Thought reasoning
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wei et al.,
     <a class="ltx_ref" href="#bib.bib45" title="">
      2022
     </a>
     )
    </cite>
    for a given problem) in a discussion round, annotated with a binary label indicating whether the answer is correct.
The edges denote the discussion’s structure, indicating which previous turns agents are responding to.
MAGs are an intuitive and generalizable way of representing the levels of many multi-agent interactions with varying conversation patterns
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wu et al.,
     <a class="ltx_ref" href="#bib.bib49" title="">
      2023
     </a>
     )
    </cite>
    , and will allow us to distill this information into a student model for performing zero-shot inference from just the question (i.e., MAGs are not required at test-time).
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Given a reasoning problem, MAGs capture rich knowledge of (1) diverse
    <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">
     pre-
    </em>
    and
    <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">
     post-interaction correct reasoning chains
    </em>
    generated by different LLMs (green nodes in Fig.
    <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    ), (2) diverse and challenging
    <em class="ltx_emph ltx_font_italic" id="S1.p4.1.3">
     incorrect reasoning chains
    </em>
    generated by different LLMs that are refined over interaction rounds (red nodes in Fig.
    <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    ), and (3) an
    <em class="ltx_emph ltx_font_italic" id="S1.p4.1.4">
     iterative and structured (graph-based) interaction process
    </em>
    that enables this refinement of model reasoning (edges in Fig.
    <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    ).
We capture all this knowledge via the following four levels of MAG components, which are then used in our distillation method,
    <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.5">
     MAGDi
    </span>
    (§
    <a class="ltx_ref" href="#S3.SS4" title="3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
     <span class="ltx_text ltx_ref_tag">
      3.4
     </span>
    </a>
    ), and further tested as part of our experiments (§
    <a class="ltx_ref" href="#S5.SS1" title="5.1 Main Results ‣ 5 Results and Analysis">
     <span class="ltx_text ltx_ref_tag">
      5.1
     </span>
    </a>
    ).
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p5">
   <ul class="ltx_itemize" id="S1.I1">
    <li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
     <div class="ltx_para" id="S1.I1.i1.p1">
      <p class="ltx_p" id="S1.I1.i1.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">
        Level 1: Learning from multiple teachers.
       </span>
       The student learns from the correct reasoning of
       <em class="ltx_emph ltx_font_italic" id="S1.I1.i1.p1.1.2">
        multiple
       </em>
       teachers, rather than one (correct pre-interaction nodes in a MAG, Fig.
       <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
        <span class="ltx_text ltx_ref_tag">
         2
        </span>
       </a>
       ).
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
     <div class="ltx_para" id="S1.I1.i2.p1">
      <p class="ltx_p" id="S1.I1.i2.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">
        Level 2: Learning from teacher interactions.
       </span>
       The student learns from both pre- and
       <em class="ltx_emph ltx_font_italic" id="S1.I1.i2.p1.1.2">
        post-interaction
       </em>
       data between multiple teachers (all correct nodes in a MAG, Fig.
       <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
        <span class="ltx_text ltx_ref_tag">
         2
        </span>
       </a>
       ).
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
     <div class="ltx_para" id="S1.I1.i3.p1">
      <p class="ltx_p" id="S1.I1.i3.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">
        Level 3: Learning from negative reasoning.
       </span>
       The student additionally distills from
       <em class="ltx_emph ltx_font_italic" id="S1.I1.i3.p1.1.2">
        negative or incorrect
       </em>
       reasoning from the teacher models (all nodes in a MAG, Fig.
       <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
        <span class="ltx_text ltx_ref_tag">
         2
        </span>
       </a>
       ).
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
     <div class="ltx_para ltx_noindent" id="S1.I1.i4.p1">
      <p class="ltx_p" id="S1.I1.i4.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">
        Level 4: Learning from structure.
       </span>
       The student learns from the output and
       <em class="ltx_emph ltx_font_italic" id="S1.I1.i4.p1.1.2">
        graph-structure
       </em>
       of teacher LLM interactions (all nodes and edges in a MAG, Fig.
       <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
        <span class="ltx_text ltx_ref_tag">
         2
        </span>
       </a>
       ).
      </p>
     </div>
    </li>
   </ul>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p6">
   <p class="ltx_p" id="S1.p6.1">
    Note that each level builds on the prior levels, motivating our main research question:
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p7">
   <p class="ltx_p" id="S1.p7.1">
    <em class="ltx_emph ltx_font_italic" id="S1.p7.1.1">
     <span class="ltx_text ltx_font_bold" id="S1.p7.1.1.1">
      Research Question:
     </span>
     How can we effectively distill from diverse teacher interactions into a smaller, efficient student model across increasing levels of interaction structure, also demonstrating scalability and generalizability?
    </em>
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p8">
   <p class="ltx_p" id="S1.p8.1">
    These levels also shape
    <span class="ltx_text ltx_font_smallcaps" id="S1.p8.1.1">
     MAGDi
    </span>
    , our structured distillation method.
    <span class="ltx_text ltx_font_smallcaps" id="S1.p8.1.2">
     MAGDi
    </span>
    enables a student model to learn from our graph-structured interaction data (MAGs), with the goal of developing a performant and efficient standalone alternative to expensive multi-agent setups.
We first construct a training dataset of MAGs from a high-performing multi-agent discussion framework
    <cite class="ltx_cite ltx_citemacro_citep">
     (Chen et al.,
     <a class="ltx_ref" href="#bib.bib6" title="">
      2023b
     </a>
     )
    </cite>
    , featuring discussions between three API-based LLMs: GPT-4, Bard, and Claude2 (§
    <a class="ltx_ref" href="#S3.SS2" title="3.2 Training Data (MAG) Construction ‣ 3 Method">
     <span class="ltx_text ltx_ref_tag">
      3.2
     </span>
    </a>
    ).
We then develop student models augmented with a Graph Neural Network (GNN) for learning
    <em class="ltx_emph ltx_font_italic" id="S1.p8.1.3">
     structure-aware
    </em>
    representations of positive (correct) and negative (incorrect) reasoning chains and fine-tune them on MAG data.
    <span class="ltx_text ltx_font_smallcaps" id="S1.p8.1.4">
     MAGDi
    </span>
    ’s three fine-tuning objectives are aligned to the four levels: (1) next-token prediction (Levels 1-2), (2) a contrastive loss between correct and incorrect reasoning (Level 3), and (3) a graph-based node classification loss (Level 4).
These objectives capture all useful signals in MAGs (i.e., teachers’
    <em class="ltx_emph ltx_font_italic" id="S1.p8.1.5">
     correct
    </em>
    and
    <em class="ltx_emph ltx_font_italic" id="S1.p8.1.6">
     incorrect
    </em>
    reasoning as well as their underlying
    <em class="ltx_emph ltx_font_italic" id="S1.p8.1.7">
     conversation structure
    </em>
    ). At test time, the distilled model performs zero-shot inference given just the
    <em class="ltx_emph ltx_font_italic" id="S1.p8.1.8">
     question
    </em>
    and the
    <em class="ltx_emph ltx_font_italic" id="S1.p8.1.9">
     base model
    </em>
    (without the GNN).
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p9">
   <p class="ltx_p" id="S1.p9.1">
    We evaluate
    <span class="ltx_text ltx_font_smallcaps" id="S1.p9.1.1">
     MAGDi
    </span>
    ’s effectiveness on seven widely-used commonsense (StrategyQA, CommonsenseQA, ARC-c, BoolQ) and math (GSM8K, MATH, SVAMP) reasoning benchmarks, consistently establishing the following findings across datasets and domains:
   </p>
   <ul class="ltx_itemize" id="S1.I2">
    <li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I2.i1.p1">
      <p class="ltx_p" id="S1.I2.i1.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I2.i1.p1.1.1">
        Multi-teacher distillation improves student performance.
       </span>
       When compared directly to distilling from a single teacher, distilling from
       <em class="ltx_emph ltx_font_italic" id="S1.I2.i1.p1.1.2">
        multiple teachers
       </em>
       improves performance (Level 1).
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I2.i2.p1">
      <p class="ltx_p" id="S1.I2.i2.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I2.i2.p1.1.1">
        The value of teacher interactions
       </span>
       : Distilling from the
       <em class="ltx_emph ltx_font_italic" id="S1.I2.i2.p1.1.2">
        post-interaction
       </em>
       outputs of teachers further improves students (Level 2).
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I2.i3.p1">
      <p class="ltx_p" id="S1.I2.i3.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I2.i3.p1.1.1">
        Negative reasoning helps.
       </span>
       Adding a contrastive objective to learn from
       <em class="ltx_emph ltx_font_italic" id="S1.I2.i3.p1.1.2">
        incorrect
       </em>
       reasoning provides a valuable signal to the student model (Level 3).
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I2.i4" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I2.i4.p1">
      <p class="ltx_p" id="S1.I2.i4.p1.2">
       <span class="ltx_text ltx_font_bold" id="S1.I2.i4.p1.2.1">
        Distilling from structure maximizes accuracy.
       </span>
       When
       <span class="ltx_text ltx_font_smallcaps" id="S1.I2.i4.p1.2.2">
        MAGDi
       </span>
       distills from the first 3 levels
       <em class="ltx_emph ltx_font_italic" id="S1.I2.i4.p1.2.3">
        and the structure
       </em>
       of a MAG, the student achieves the highest accuracy, e.g., up to
       <math alttext="10\%" class="ltx_Math" display="inline" id="S1.I2.i4.p1.1.m1.1">
        <semantics id="S1.I2.i4.p1.1.m1.1a">
         <mrow id="S1.I2.i4.p1.1.m1.1.1" xref="S1.I2.i4.p1.1.m1.1.1.cmml">
          <mn id="S1.I2.i4.p1.1.m1.1.1.2" xref="S1.I2.i4.p1.1.m1.1.1.2.cmml">
           10
          </mn>
          <mo id="S1.I2.i4.p1.1.m1.1.1.1" xref="S1.I2.i4.p1.1.m1.1.1.1.cmml">
           %
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S1.I2.i4.p1.1.m1.1b">
          <apply id="S1.I2.i4.p1.1.m1.1.1.cmml" xref="S1.I2.i4.p1.1.m1.1.1">
           <csymbol cd="latexml" id="S1.I2.i4.p1.1.m1.1.1.1.cmml" xref="S1.I2.i4.p1.1.m1.1.1.1">
            percent
           </csymbol>
           <cn id="S1.I2.i4.p1.1.m1.1.1.2.cmml" type="integer" xref="S1.I2.i4.p1.1.m1.1.1.2">
            10
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S1.I2.i4.p1.1.m1.1c">
          10\%
         </annotation>
        </semantics>
       </math>
       absolute improvement over a zero-shot baseline and up to
       <math alttext="4\%" class="ltx_Math" display="inline" id="S1.I2.i4.p1.2.m2.1">
        <semantics id="S1.I2.i4.p1.2.m2.1a">
         <mrow id="S1.I2.i4.p1.2.m2.1.1" xref="S1.I2.i4.p1.2.m2.1.1.cmml">
          <mn id="S1.I2.i4.p1.2.m2.1.1.2" xref="S1.I2.i4.p1.2.m2.1.1.2.cmml">
           4
          </mn>
          <mo id="S1.I2.i4.p1.2.m2.1.1.1" xref="S1.I2.i4.p1.2.m2.1.1.1.cmml">
           %
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S1.I2.i4.p1.2.m2.1b">
          <apply id="S1.I2.i4.p1.2.m2.1.1.cmml" xref="S1.I2.i4.p1.2.m2.1.1">
           <csymbol cd="latexml" id="S1.I2.i4.p1.2.m2.1.1.1.cmml" xref="S1.I2.i4.p1.2.m2.1.1.1">
            percent
           </csymbol>
           <cn id="S1.I2.i4.p1.2.m2.1.1.2.cmml" type="integer" xref="S1.I2.i4.p1.2.m2.1.1.2">
            4
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S1.I2.i4.p1.2.m2.1c">
          4\%
         </annotation>
        </semantics>
       </math>
       over the best single-teacher baseline.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I2.i5" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para ltx_noindent" id="S1.I2.i5.p1">
      <p class="ltx_p" id="S1.I2.i5.p1.1">
       <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.I2.i5.p1.1.1">
        MAGDi
        <span class="ltx_text ltx_font_upright" id="S1.I2.i5.p1.1.1.1">
         balances performance with efficiency.
        </span>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="S1.I2.i5.p1.1.2">
        MAGDi
       </span>
       -distilled models reduce the number of tokens predicted at test time by up to
       <math alttext="9" class="ltx_Math" display="inline" id="S1.I2.i5.p1.1.m1.1">
        <semantics id="S1.I2.i5.p1.1.m1.1a">
         <mn id="S1.I2.i5.p1.1.m1.1.1" xref="S1.I2.i5.p1.1.m1.1.1.cmml">
          9
         </mn>
         <annotation-xml encoding="MathML-Content" id="S1.I2.i5.p1.1.m1.1b">
          <cn id="S1.I2.i5.p1.1.m1.1.1.cmml" type="integer" xref="S1.I2.i5.p1.1.m1.1.1">
           9
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S1.I2.i5.p1.1.m1.1c">
          9
         </annotation>
        </semantics>
       </math>
       x while outperforming all single-teacher distillation baselines.
      </p>
     </div>
    </li>
   </ul>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p10">
   <p class="ltx_p" id="S1.p10.1">
    Building on these results, we further analyze
    <span class="ltx_text ltx_font_smallcaps" id="S1.p10.1.1">
     MAGDi
    </span>
    along the following axes:
   </p>
   <ul class="ltx_itemize" id="S1.I3">
    <li class="ltx_item" id="S1.I3.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I3.i1.p1">
      <p class="ltx_p" id="S1.I3.i1.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I3.i1.p1.1.1">
        Generalizability.
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="S1.I3.i1.p1.1.2">
        MAGDi
       </span>
       can be used to produce a unified joint multi-task learning model that performs well on multiple domains at once and also generalizes well to held-out datasets not seen during training.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I3.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I3.i2.p1">
      <p class="ltx_p" id="S1.I3.i2.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I3.i2.p1.1.1">
        Scalability.
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="S1.I3.i2.p1.1.2">
        MAGDi
       </span>
       scales positively with the size and strength of the base student model.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I3.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para ltx_noindent" id="S1.I3.i3.p1">
      <p class="ltx_p" id="S1.I3.i3.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I3.i3.p1.1.1">
        Diversity.
       </span>
       The output diversity resulting from our multi-teacher training improves self-consistency
       <cite class="ltx_cite ltx_citemacro_citep">
        (Wang et al.,
        <a class="ltx_ref" href="#bib.bib44" title="">
         2023
        </a>
        )
       </cite>
       , an inference-time ensemble method relying on diverse model answers.
      </p>
     </div>
    </li>
   </ul>
  </div>
  <figure class="ltx_figure" id="S1.F3">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="173" id="S1.F3.g1" src="/html/2402.01620/assets/x7.png" width="518"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 3:
    </span>
    <span class="ltx_text ltx_font_bold" id="S1.F3.3.1">
     Training Data Construction:
    </span>
    Given a reasoning problem, multiple teachers go through a multi-round discussion process, generating multi-agent interaction graphs (MAGs).
    <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.F3.4.2">
     MAGDi
     <span class="ltx_text ltx_font_upright" id="S1.F3.4.2.1">
      :
     </span>
    </span>
    Our structured distillation method augments a base student model with a Graph Neural Network (specifically, a GCN) to learn structure-aware representations of reasoning chains. The resultant model is then fine-tuned with a combination of three objectives involving positive chains, negative chains, and the underlying interactions.
   </figcaption>
  </figure>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Work
  </h2>
  <div class="ltx_para ltx_noindent" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">
     Knowledge Distillation.
    </span>
    Knowledge distillation has proven effective in transferring knowledge from a larger teacher model to a more compact student model
    <cite class="ltx_cite ltx_citemacro_cite">
     Hinton et al. (
     <a class="ltx_ref" href="#bib.bib21" title="">
      2015
     </a>
     ); Buciluǎ et al. (
     <a class="ltx_ref" href="#bib.bib3" title="">
      2006
     </a>
     ); Chen et al. (
     <a class="ltx_ref" href="#bib.bib7" title="">
      2020
     </a>
     )
    </cite>
    including distillation from multiple teacher models
    <cite class="ltx_cite ltx_citemacro_citep">
     (You et al.,
     <a class="ltx_ref" href="#bib.bib52" title="">
      2017
     </a>
     ; Yang et al.,
     <a class="ltx_ref" href="#bib.bib50" title="">
      2020
     </a>
     )
    </cite>
    .
Following recent work, we focus on distillation from
    <em class="ltx_emph ltx_font_italic" id="S2.p1.1.2">
     samples
    </em>
    from a model distribution, or symbolic distillation
    <cite class="ltx_cite ltx_citemacro_citep">
     (West et al.,
     <a class="ltx_ref" href="#bib.bib48" title="">
      2022
     </a>
     )
    </cite>
    , a form of distillation especially common on LLMs, e.g. in instruction tuning
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wang et al.,
     <a class="ltx_ref" href="#bib.bib44" title="">
      2023
     </a>
     ; Taori et al.,
     <a class="ltx_ref" href="#bib.bib43" title="">
      2023
     </a>
     ; Chiang et al.,
     <a class="ltx_ref" href="#bib.bib10" title="">
      2023
     </a>
     )
    </cite>
    , where instruction-question-answer triples are sourced from a teacher model.
In reasoning with LLMs specifically, recent work has distilled reasoning knowledge from a
    <em class="ltx_emph ltx_font_italic" id="S2.p1.1.3">
     single
    </em>
    larger teacher model to a smaller student model
    <cite class="ltx_cite ltx_citemacro_cite">
     Magister et al. (
     <a class="ltx_ref" href="#bib.bib32" title="">
      2023
     </a>
     ); Shridhar et al. (
     <a class="ltx_ref" href="#bib.bib40" title="">
      2023
     </a>
     ); Fu et al. (
     <a class="ltx_ref" href="#bib.bib17" title="">
      2023
     </a>
     ); Ho et al. (
     <a class="ltx_ref" href="#bib.bib22" title="">
      2023
     </a>
     ); Saha et al. (
     <a class="ltx_ref" href="#bib.bib38" title="">
      2023
     </a>
     ); Mukherjee et al. (
     <a class="ltx_ref" href="#bib.bib34" title="">
      2023
     </a>
     ); Mitra et al. (
     <a class="ltx_ref" href="#bib.bib33" title="">
      2023
     </a>
     ); Li et al. (
     <a class="ltx_ref" href="#bib.bib29" title="">
      2023
     </a>
     ); Deng et al. (
     <a class="ltx_ref" href="#bib.bib15" title="">
      2023
     </a>
     ); Liu et al. (
     <a class="ltx_ref" href="#bib.bib31" title="">
      2023
     </a>
     )
    </cite>
    using Chain-of-Thought prompting
    <cite class="ltx_cite ltx_citemacro_citep">
     (CoT; Wei et al.,
     <a class="ltx_ref" href="#bib.bib45" title="">
      2022
     </a>
     )
    </cite>
    and also, a combination of multiple prompting techniques
    <cite class="ltx_cite ltx_citemacro_citep">
     (Chenglin et al.,
     <a class="ltx_ref" href="#bib.bib9" title="">
      2023
     </a>
     ; Mukherjee et al.,
     <a class="ltx_ref" href="#bib.bib34" title="">
      2023
     </a>
     ; Mitra et al.,
     <a class="ltx_ref" href="#bib.bib33" title="">
      2023
     </a>
     )
    </cite>
    .
Past work has also distilled modular trajectories from a GPT-4 teacher for solving interactive tasks
    <cite class="ltx_cite ltx_citemacro_citep">
     (Chen et al.,
     <a class="ltx_ref" href="#bib.bib4" title="">
      2023a
     </a>
     ; Yin et al.,
     <a class="ltx_ref" href="#bib.bib51" title="">
      2023
     </a>
     )
    </cite>
    .
Overall, different from these single-teacher settings, we delve into the realm of knowledge distillation from
    <em class="ltx_emph ltx_font_italic" id="S2.p1.1.4">
     multiple teachers
    </em>
    .
Going one step further, we learn from the
    <em class="ltx_emph ltx_font_italic" id="S2.p1.1.5">
     interactions
    </em>
    between teachers, bringing in fresh challenges on flexibly representing and modeling these interactions.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p2">
   <p class="ltx_p" id="S2.p2.1">
    <span class="ltx_text ltx_font_bold" id="S2.p2.1.1">
     Graph-based Interactions.
    </span>
    Dialogues, debates, and multi-party conversations
    <cite class="ltx_cite ltx_citemacro_citep">
     (Kirchhoff &amp; Ostendorf,
     <a class="ltx_ref" href="#bib.bib26" title="">
      2003
     </a>
     ; Leifeld,
     <a class="ltx_ref" href="#bib.bib28" title="">
      2018
     </a>
     ; Wei et al.,
     <a class="ltx_ref" href="#bib.bib46" title="">
      2023
     </a>
     )
    </cite>
    have a long, rich history of being modeled as graphs for different downstream tasks such as emotion and sentiment identification
    <cite class="ltx_cite ltx_citemacro_citep">
     (Ghosal et al.,
     <a class="ltx_ref" href="#bib.bib19" title="">
      2019
     </a>
     ; Shen et al.,
     <a class="ltx_ref" href="#bib.bib39" title="">
      2021
     </a>
     )
    </cite>
    , dialogue act recognition
    <cite class="ltx_cite ltx_citemacro_citep">
     (Qin et al.,
     <a class="ltx_ref" href="#bib.bib37" title="">
      2021
     </a>
     )
    </cite>
    , dialogue summarization
    <cite class="ltx_cite ltx_citemacro_citep">
     (Chen &amp; Yang,
     <a class="ltx_ref" href="#bib.bib5" title="">
      2021
     </a>
     )
    </cite>
    , and machine reading
    <cite class="ltx_cite ltx_citemacro_citep">
     (Ouyang et al.,
     <a class="ltx_ref" href="#bib.bib35" title="">
      2021
     </a>
     )
    </cite>
    .
Our motivation in this work differs in two major respects. Firstly, we focus on model-model interactions rather than the human-human or human-model interactions from past work.
Secondly, our objective is to enhance reasoning capabilities in smaller student models through structured distillation, as opposed to utilizing graph modeling for downstream graph tasks.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Method
  </h2>
  <div class="ltx_para ltx_noindent" id="S3.p1">
   <p class="ltx_p" id="S3.p1.1">
    In Sec.
    <a class="ltx_ref" href="#S3.SS1" title="3.1 Multi-Agent Interaction Graph (MAG) ‣ 3 Method">
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    , we provide a general, formal description of MAG, our graph-based representation of multi-agent interactions. Sec.
    <a class="ltx_ref" href="#S3.SS2" title="3.2 Training Data (MAG) Construction ‣ 3 Method">
     <span class="ltx_text ltx_ref_tag">
      3.2
     </span>
    </a>
    then describes the construction of MAGs for several tasks that will serve as training data for distillation.
In Sec.
    <a class="ltx_ref" href="#S3.SS3" title="3.3 Statistics of Training Data (MAGs) ‣ 3 Method">
     <span class="ltx_text ltx_ref_tag">
      3.3
     </span>
    </a>
    , we analyze this training data in terms of its structural properties. Lastly, in Sec.
    <a class="ltx_ref" href="#S3.SS4" title="3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
     <span class="ltx_text ltx_ref_tag">
      3.4
     </span>
    </a>
    , we describe
    <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.1">
     MAGDi
    </span>
    , our structured distillation method for learning from MAGs.
   </p>
  </div>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Multi-Agent Interaction Graph (MAG)
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.10">
     <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.10.1">
      Definition.
     </span>
     Consider a collaborative multi-agent setting, where
     <math alttext="\mathcal{A}=\{A_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1">
      <semantics id="S3.SS1.p1.1.m1.1a">
       <mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">
         𝒜
        </mi>
        <mo id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">
         =
        </mo>
        <msubsup id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">
         <mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.cmml">
          <mo id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.cmml">
           {
          </mo>
          <msub id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml">
           <mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.cmml">
            A
           </mi>
           <mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.cmml">
           }
          </mo>
         </mrow>
         <mrow id="S3.SS1.p1.1.m1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.3.cmml">
          <mi id="S3.SS1.p1.1.m1.1.1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.1.1.3.2.cmml">
           i
          </mi>
          <mo id="S3.SS1.p1.1.m1.1.1.1.1.3.1" xref="S3.SS1.p1.1.m1.1.1.1.1.3.1.cmml">
           =
          </mo>
          <mn id="S3.SS1.p1.1.m1.1.1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.1.1.3.3.cmml">
           1
          </mn>
         </mrow>
         <mi id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.3.cmml">
          n
         </mi>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b">
        <apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">
         <eq id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">
         </eq>
         <ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">
          𝒜
         </ci>
         <apply id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1">
           superscript
          </csymbol>
          <apply id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1">
            subscript
           </csymbol>
           <set id="S3.SS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1">
            <apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2">
              𝐴
             </ci>
             <ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.3">
              𝑖
             </ci>
            </apply>
           </set>
           <apply id="S3.SS1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.3">
            <eq id="S3.SS1.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.3.1">
            </eq>
            <ci id="S3.SS1.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.3.2">
             𝑖
            </ci>
            <cn id="S3.SS1.p1.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.1.1.3.3">
             1
            </cn>
           </apply>
          </apply>
          <ci id="S3.SS1.p1.1.m1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3">
           𝑛
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">
        \mathcal{A}=\{A_{i}\}_{i=1}^{n}
       </annotation>
      </semantics>
     </math>
     agents are interacting with each other for
     <math alttext="r" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1">
      <semantics id="S3.SS1.p1.2.m2.1a">
       <mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">
        r
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b">
        <ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">
         𝑟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">
        r
       </annotation>
      </semantics>
     </math>
     rounds to solve a task. A multi-agent interaction graph (MAG) is a structured encoding of the interactions between these
     <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1">
      <semantics id="S3.SS1.p1.3.m3.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">
        𝒜
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b">
        <ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">
         𝒜
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">
        \mathcal{A}
       </annotation>
      </semantics>
     </math>
     agents over
     <math alttext="r" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1">
      <semantics id="S3.SS1.p1.4.m4.1a">
       <mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">
        r
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b">
        <ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">
         𝑟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">
        r
       </annotation>
      </semantics>
     </math>
     rounds. Formally, a MAG is a Directed Acyclic Graph
     <math alttext="\mathcal{G}=(\mathcal{V},\mathcal{E})" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.2">
      <semantics id="S3.SS1.p1.5.m5.2a">
       <mrow id="S3.SS1.p1.5.m5.2.3" xref="S3.SS1.p1.5.m5.2.3.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.2.3.2" xref="S3.SS1.p1.5.m5.2.3.2.cmml">
         𝒢
        </mi>
        <mo id="S3.SS1.p1.5.m5.2.3.1" xref="S3.SS1.p1.5.m5.2.3.1.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p1.5.m5.2.3.3.2" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">
         <mo id="S3.SS1.p1.5.m5.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">
          (
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">
          𝒱
         </mi>
         <mo id="S3.SS1.p1.5.m5.2.3.3.2.2" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.2.2" xref="S3.SS1.p1.5.m5.2.2.cmml">
          ℰ
         </mi>
         <mo id="S3.SS1.p1.5.m5.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.2b">
        <apply id="S3.SS1.p1.5.m5.2.3.cmml" xref="S3.SS1.p1.5.m5.2.3">
         <eq id="S3.SS1.p1.5.m5.2.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.1">
         </eq>
         <ci id="S3.SS1.p1.5.m5.2.3.2.cmml" xref="S3.SS1.p1.5.m5.2.3.2">
          𝒢
         </ci>
         <interval closure="open" id="S3.SS1.p1.5.m5.2.3.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.3.2">
          <ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">
           𝒱
          </ci>
          <ci id="S3.SS1.p1.5.m5.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2">
           ℰ
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.2c">
        \mathcal{G}=(\mathcal{V},\mathcal{E})
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1">
      <semantics id="S3.SS1.p1.6.m6.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">
        𝒱
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b">
        <ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">
         𝒱
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">
        \mathcal{V}
       </annotation>
      </semantics>
     </math>
     is a set of nodes and
     <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1">
      <semantics id="S3.SS1.p1.7.m7.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">
        ℰ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b">
        <ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">
         ℰ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">
        \mathcal{E}
       </annotation>
      </semantics>
     </math>
     is a set of directed edges. A node
     <math alttext="v_{i,j}\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.2">
      <semantics id="S3.SS1.p1.8.m8.2a">
       <mrow id="S3.SS1.p1.8.m8.2.3" xref="S3.SS1.p1.8.m8.2.3.cmml">
        <msub id="S3.SS1.p1.8.m8.2.3.2" xref="S3.SS1.p1.8.m8.2.3.2.cmml">
         <mi id="S3.SS1.p1.8.m8.2.3.2.2" xref="S3.SS1.p1.8.m8.2.3.2.2.cmml">
          v
         </mi>
         <mrow id="S3.SS1.p1.8.m8.2.2.2.4" xref="S3.SS1.p1.8.m8.2.2.2.3.cmml">
          <mi id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.cmml">
           i
          </mi>
          <mo id="S3.SS1.p1.8.m8.2.2.2.4.1" xref="S3.SS1.p1.8.m8.2.2.2.3.cmml">
           ,
          </mo>
          <mi id="S3.SS1.p1.8.m8.2.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.2.cmml">
           j
          </mi>
         </mrow>
        </msub>
        <mo id="S3.SS1.p1.8.m8.2.3.1" xref="S3.SS1.p1.8.m8.2.3.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.2.3.3" xref="S3.SS1.p1.8.m8.2.3.3.cmml">
         𝒱
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.2b">
        <apply id="S3.SS1.p1.8.m8.2.3.cmml" xref="S3.SS1.p1.8.m8.2.3">
         <in id="S3.SS1.p1.8.m8.2.3.1.cmml" xref="S3.SS1.p1.8.m8.2.3.1">
         </in>
         <apply id="S3.SS1.p1.8.m8.2.3.2.cmml" xref="S3.SS1.p1.8.m8.2.3.2">
          <csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.2.3.2.1.cmml" xref="S3.SS1.p1.8.m8.2.3.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p1.8.m8.2.3.2.2.cmml" xref="S3.SS1.p1.8.m8.2.3.2.2">
           𝑣
          </ci>
          <list id="S3.SS1.p1.8.m8.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.2.2.2.4">
           <ci id="S3.SS1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1">
            𝑖
           </ci>
           <ci id="S3.SS1.p1.8.m8.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2">
            𝑗
           </ci>
          </list>
         </apply>
         <ci id="S3.SS1.p1.8.m8.2.3.3.cmml" xref="S3.SS1.p1.8.m8.2.3.3">
          𝒱
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.2c">
        v_{i,j}\in\mathcal{V}
       </annotation>
      </semantics>
     </math>
     represents the output of an agent
     <math alttext="A_{i}\in\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1">
      <semantics id="S3.SS1.p1.9.m9.1a">
       <mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">
        <msub id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">
         <mi id="S3.SS1.p1.9.m9.1.1.2.2" xref="S3.SS1.p1.9.m9.1.1.2.2.cmml">
          A
         </mi>
         <mi id="S3.SS1.p1.9.m9.1.1.2.3" xref="S3.SS1.p1.9.m9.1.1.2.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">
         𝒜
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b">
        <apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">
         <in id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1">
         </in>
         <apply id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2.2">
           𝐴
          </ci>
          <ci id="S3.SS1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">
          𝒜
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">
        A_{i}\in\mathcal{A}
       </annotation>
      </semantics>
     </math>
     in interaction round
     <math alttext="j\in[0,r]" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.2">
      <semantics id="S3.SS1.p1.10.m10.2a">
       <mrow id="S3.SS1.p1.10.m10.2.3" xref="S3.SS1.p1.10.m10.2.3.cmml">
        <mi id="S3.SS1.p1.10.m10.2.3.2" xref="S3.SS1.p1.10.m10.2.3.2.cmml">
         j
        </mi>
        <mo id="S3.SS1.p1.10.m10.2.3.1" xref="S3.SS1.p1.10.m10.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS1.p1.10.m10.2.3.3.2" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">
         <mo id="S3.SS1.p1.10.m10.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">
          [
         </mo>
         <mn id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">
          0
         </mn>
         <mo id="S3.SS1.p1.10.m10.2.3.3.2.2" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p1.10.m10.2.2" xref="S3.SS1.p1.10.m10.2.2.cmml">
          r
         </mi>
         <mo id="S3.SS1.p1.10.m10.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.2b">
        <apply id="S3.SS1.p1.10.m10.2.3.cmml" xref="S3.SS1.p1.10.m10.2.3">
         <in id="S3.SS1.p1.10.m10.2.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.1">
         </in>
         <ci id="S3.SS1.p1.10.m10.2.3.2.cmml" xref="S3.SS1.p1.10.m10.2.3.2">
          𝑗
         </ci>
         <interval closure="closed" id="S3.SS1.p1.10.m10.2.3.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.3.2">
          <cn id="S3.SS1.p1.10.m10.1.1.cmml" type="integer" xref="S3.SS1.p1.10.m10.1.1">
           0
          </cn>
          <ci id="S3.SS1.p1.10.m10.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2">
           𝑟
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.2c">
        j\in[0,r]
       </annotation>
      </semantics>
     </math>
     .
     <span class="ltx_note ltx_role_footnote" id="footnote3">
      <sup class="ltx_note_mark">
       3
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         3
        </sup>
        <span class="ltx_tag ltx_tag_note">
         3
        </span>
        Round 0 refers to an agent’s pre-interaction output.
       </span>
      </span>
     </span>
     For example, see Fig.
     <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     where each node represents an agent’s Chain-of-Thought reasoning to the question. Edges denote conditional dependencies between the agents’ interactions and encode how an agent’s output is refined over interaction rounds. Specifically, we define a directed edge between two nodes if the target node’s generation is conditioned on the source node’s generation.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.8">
     <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.8.1">
      Example of a MAG.
     </span>
     MAGs can be generally defined for arbitrary agents and interaction patterns.
We focus on reasoning problems as a general class of domains where interaction has positive impacts, defining MAGs for LLM agents on commonsense and math reasoning tasks.
Past works have defined several such interaction frameworks
     <cite class="ltx_cite ltx_citemacro_cite">
      Du et al. (
      <a class="ltx_ref" href="#bib.bib16" title="">
       2023
      </a>
      ); Liang et al. (
      <a class="ltx_ref" href="#bib.bib30" title="">
       2023
      </a>
      ); Chen et al. (
      <a class="ltx_ref" href="#bib.bib6" title="">
       2023b
      </a>
      )
     </cite>
     for which MAGs can be defined. Of these, we choose
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.8.2">
      ReConcile
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      (Chen et al.,
      <a class="ltx_ref" href="#bib.bib6" title="">
       2023b
      </a>
      )
     </cite>
     as our interaction framework because of (1) its performance: it obtains the highest performance across multiple benchmarks, and (2) its flexibility: it allows each agent to converse in natural language following the generic Chain-of-Thought reasoning paradigm and thus, can be readily applied to any downstream task where CoT is applicable. MAGs make minimal assumptions about the contents of nodes and hence, can be similarly defined for agents conversing using other prompting techniques
     <cite class="ltx_cite ltx_citemacro_citep">
      (Chen et al.,
      <a class="ltx_ref" href="#bib.bib8" title="">
       2022
      </a>
      )
     </cite>
     . Fig.
     <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     shows an example of a
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.8.3">
      ReConcile
     </span>
     -based MAG for a math problem. Since the nodes in a MAG represent model responses (either correct or incorrect), we additionally annotate each node
     <math alttext="v\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1">
      <semantics id="S3.SS1.p2.1.m1.1a">
       <mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">
        <mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">
         v
        </mi>
        <mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">
         𝒱
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b">
        <apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">
         <in id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1">
         </in>
         <ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">
          𝑣
         </ci>
         <ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">
          𝒱
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">
        v\in\mathcal{V}
       </annotation>
      </semantics>
     </math>
     with a binary label
     <math alttext="y_{v}\in\{0,1\}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.2">
      <semantics id="S3.SS1.p2.2.m2.2a">
       <mrow id="S3.SS1.p2.2.m2.2.3" xref="S3.SS1.p2.2.m2.2.3.cmml">
        <msub id="S3.SS1.p2.2.m2.2.3.2" xref="S3.SS1.p2.2.m2.2.3.2.cmml">
         <mi id="S3.SS1.p2.2.m2.2.3.2.2" xref="S3.SS1.p2.2.m2.2.3.2.2.cmml">
          y
         </mi>
         <mi id="S3.SS1.p2.2.m2.2.3.2.3" xref="S3.SS1.p2.2.m2.2.3.2.3.cmml">
          v
         </mi>
        </msub>
        <mo id="S3.SS1.p2.2.m2.2.3.1" xref="S3.SS1.p2.2.m2.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS1.p2.2.m2.2.3.3.2" xref="S3.SS1.p2.2.m2.2.3.3.1.cmml">
         <mo id="S3.SS1.p2.2.m2.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.2.m2.2.3.3.1.cmml">
          {
         </mo>
         <mn id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">
          0
         </mn>
         <mo id="S3.SS1.p2.2.m2.2.3.3.2.2" xref="S3.SS1.p2.2.m2.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="S3.SS1.p2.2.m2.2.2" xref="S3.SS1.p2.2.m2.2.2.cmml">
          1
         </mn>
         <mo id="S3.SS1.p2.2.m2.2.3.3.2.3" stretchy="false" xref="S3.SS1.p2.2.m2.2.3.3.1.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.2b">
        <apply id="S3.SS1.p2.2.m2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.3">
         <in id="S3.SS1.p2.2.m2.2.3.1.cmml" xref="S3.SS1.p2.2.m2.2.3.1">
         </in>
         <apply id="S3.SS1.p2.2.m2.2.3.2.cmml" xref="S3.SS1.p2.2.m2.2.3.2">
          <csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.3.2.1.cmml" xref="S3.SS1.p2.2.m2.2.3.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p2.2.m2.2.3.2.2.cmml" xref="S3.SS1.p2.2.m2.2.3.2.2">
           𝑦
          </ci>
          <ci id="S3.SS1.p2.2.m2.2.3.2.3.cmml" xref="S3.SS1.p2.2.m2.2.3.2.3">
           𝑣
          </ci>
         </apply>
         <set id="S3.SS1.p2.2.m2.2.3.3.1.cmml" xref="S3.SS1.p2.2.m2.2.3.3.2">
          <cn id="S3.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1">
           0
          </cn>
          <cn id="S3.SS1.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS1.p2.2.m2.2.2">
           1
          </cn>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.2c">
        y_{v}\in\{0,1\}
       </annotation>
      </semantics>
     </math>
     , indicating the correctness of the answer. These are marked with green and red circles in Fig.
     <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . We refer to these two sets of nodes as
     <math alttext="\mathcal{V}^{+}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1">
      <semantics id="S3.SS1.p2.3.m3.1a">
       <msup id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">
         𝒱
        </mi>
        <mo id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">
         +
        </mo>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b">
        <apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">
          𝒱
         </ci>
         <plus id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">
         </plus>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">
        \mathcal{V}^{+}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\mathcal{V}^{-}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1">
      <semantics id="S3.SS1.p2.4.m4.1a">
       <msup id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">
         𝒱
        </mi>
        <mo id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">
         −
        </mo>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b">
        <apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">
          𝒱
         </ci>
         <minus id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">
         </minus>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">
        \mathcal{V}^{-}
       </annotation>
      </semantics>
     </math>
     respectively such that
     <math alttext="\mathcal{V}=\mathcal{V}^{+}\bigcup\mathcal{V}^{-}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1">
      <semantics id="S3.SS1.p2.5.m5.1a">
       <mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">
         𝒱
        </mi>
        <mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">
         <msup id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.2.2.cmml">
           𝒱
          </mi>
          <mo id="S3.SS1.p2.5.m5.1.1.3.2.3" xref="S3.SS1.p2.5.m5.1.1.3.2.3.cmml">
           +
          </mo>
         </msup>
         <mo id="S3.SS1.p2.5.m5.1.1.3.1" lspace="0em" rspace="0em" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">
          ​
         </mo>
         <mrow id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml">
          <mo id="S3.SS1.p2.5.m5.1.1.3.3.1" xref="S3.SS1.p2.5.m5.1.1.3.3.1.cmml">
           ⋃
          </mo>
          <msup id="S3.SS1.p2.5.m5.1.1.3.3.2" xref="S3.SS1.p2.5.m5.1.1.3.3.2.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.3.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.3.2.2.cmml">
            𝒱
           </mi>
           <mo id="S3.SS1.p2.5.m5.1.1.3.3.2.3" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.cmml">
            −
           </mo>
          </msup>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b">
        <apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">
         <eq id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1">
         </eq>
         <ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">
          𝒱
         </ci>
         <apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">
          <times id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1">
          </times>
          <apply id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">
           <csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">
            superscript
           </csymbol>
           <ci id="S3.SS1.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.2">
            𝒱
           </ci>
           <plus id="S3.SS1.p2.5.m5.1.1.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3">
           </plus>
          </apply>
          <apply id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3">
           <union id="S3.SS1.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.1">
           </union>
           <apply id="S3.SS1.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2">
            <csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2">
             superscript
            </csymbol>
            <ci id="S3.SS1.p2.5.m5.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.2">
             𝒱
            </ci>
            <minus id="S3.SS1.p2.5.m5.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3">
            </minus>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">
        \mathcal{V}=\mathcal{V}^{+}\bigcup\mathcal{V}^{-}
       </annotation>
      </semantics>
     </math>
     . Following the interaction pattern of
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.8.4">
      ReConcile
     </span>
     that conditions each subsequent round of interaction on
     <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.8.5">
      all
     </em>
     agent outputs from the previous round,
we define edges from all source nodes
     <math alttext="v_{i,j}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.2">
      <semantics id="S3.SS1.p2.6.m6.2a">
       <msub id="S3.SS1.p2.6.m6.2.3" xref="S3.SS1.p2.6.m6.2.3.cmml">
        <mi id="S3.SS1.p2.6.m6.2.3.2" xref="S3.SS1.p2.6.m6.2.3.2.cmml">
         v
        </mi>
        <mrow id="S3.SS1.p2.6.m6.2.2.2.4" xref="S3.SS1.p2.6.m6.2.2.2.3.cmml">
         <mi id="S3.SS1.p2.6.m6.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.cmml">
          i
         </mi>
         <mo id="S3.SS1.p2.6.m6.2.2.2.4.1" xref="S3.SS1.p2.6.m6.2.2.2.3.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p2.6.m6.2.2.2.2" xref="S3.SS1.p2.6.m6.2.2.2.2.cmml">
          j
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.2b">
        <apply id="S3.SS1.p2.6.m6.2.3.cmml" xref="S3.SS1.p2.6.m6.2.3">
         <csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.3.1.cmml" xref="S3.SS1.p2.6.m6.2.3">
          subscript
         </csymbol>
         <ci id="S3.SS1.p2.6.m6.2.3.2.cmml" xref="S3.SS1.p2.6.m6.2.3.2">
          𝑣
         </ci>
         <list id="S3.SS1.p2.6.m6.2.2.2.3.cmml" xref="S3.SS1.p2.6.m6.2.2.2.4">
          <ci id="S3.SS1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1">
           𝑖
          </ci>
          <ci id="S3.SS1.p2.6.m6.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2">
           𝑗
          </ci>
         </list>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.2c">
        v_{i,j}
       </annotation>
      </semantics>
     </math>
     to all target nodes
     <math alttext="v_{k,j+1}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.2">
      <semantics id="S3.SS1.p2.7.m7.2a">
       <msub id="S3.SS1.p2.7.m7.2.3" xref="S3.SS1.p2.7.m7.2.3.cmml">
        <mi id="S3.SS1.p2.7.m7.2.3.2" xref="S3.SS1.p2.7.m7.2.3.2.cmml">
         v
        </mi>
        <mrow id="S3.SS1.p2.7.m7.2.2.2.2" xref="S3.SS1.p2.7.m7.2.2.2.3.cmml">
         <mi id="S3.SS1.p2.7.m7.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.1.cmml">
          k
         </mi>
         <mo id="S3.SS1.p2.7.m7.2.2.2.2.2" xref="S3.SS1.p2.7.m7.2.2.2.3.cmml">
          ,
         </mo>
         <mrow id="S3.SS1.p2.7.m7.2.2.2.2.1" xref="S3.SS1.p2.7.m7.2.2.2.2.1.cmml">
          <mi id="S3.SS1.p2.7.m7.2.2.2.2.1.2" xref="S3.SS1.p2.7.m7.2.2.2.2.1.2.cmml">
           j
          </mi>
          <mo id="S3.SS1.p2.7.m7.2.2.2.2.1.1" xref="S3.SS1.p2.7.m7.2.2.2.2.1.1.cmml">
           +
          </mo>
          <mn id="S3.SS1.p2.7.m7.2.2.2.2.1.3" xref="S3.SS1.p2.7.m7.2.2.2.2.1.3.cmml">
           1
          </mn>
         </mrow>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.2b">
        <apply id="S3.SS1.p2.7.m7.2.3.cmml" xref="S3.SS1.p2.7.m7.2.3">
         <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.2.3.1.cmml" xref="S3.SS1.p2.7.m7.2.3">
          subscript
         </csymbol>
         <ci id="S3.SS1.p2.7.m7.2.3.2.cmml" xref="S3.SS1.p2.7.m7.2.3.2">
          𝑣
         </ci>
         <list id="S3.SS1.p2.7.m7.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.2.2.2.2">
          <ci id="S3.SS1.p2.7.m7.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1">
           𝑘
          </ci>
          <apply id="S3.SS1.p2.7.m7.2.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.2.2.2.2.1">
           <plus id="S3.SS1.p2.7.m7.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.7.m7.2.2.2.2.1.1">
           </plus>
           <ci id="S3.SS1.p2.7.m7.2.2.2.2.1.2.cmml" xref="S3.SS1.p2.7.m7.2.2.2.2.1.2">
            𝑗
           </ci>
           <cn id="S3.SS1.p2.7.m7.2.2.2.2.1.3.cmml" type="integer" xref="S3.SS1.p2.7.m7.2.2.2.2.1.3">
            1
           </cn>
          </apply>
         </list>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.2c">
        v_{k,j+1}
       </annotation>
      </semantics>
     </math>
     , i.e.,
     <math alttext="(v_{i,j},v_{k,j+1})\in\mathcal{E}~{}\forall i,k\in[1,n],\forall j\in[0,r]" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.10">
      <semantics id="S3.SS1.p2.8.m8.10a">
       <mrow id="S3.SS1.p2.8.m8.10.10.2" xref="S3.SS1.p2.8.m8.10.10.3.cmml">
        <mrow id="S3.SS1.p2.8.m8.9.9.1.1" xref="S3.SS1.p2.8.m8.9.9.1.1.cmml">
         <mrow id="S3.SS1.p2.8.m8.9.9.1.1.2.2" xref="S3.SS1.p2.8.m8.9.9.1.1.2.3.cmml">
          <mo id="S3.SS1.p2.8.m8.9.9.1.1.2.2.3" stretchy="false" xref="S3.SS1.p2.8.m8.9.9.1.1.2.3.cmml">
           (
          </mo>
          <msub id="S3.SS1.p2.8.m8.9.9.1.1.1.1.1" xref="S3.SS1.p2.8.m8.9.9.1.1.1.1.1.cmml">
           <mi id="S3.SS1.p2.8.m8.9.9.1.1.1.1.1.2" xref="S3.SS1.p2.8.m8.9.9.1.1.1.1.1.2.cmml">
            v
           </mi>
           <mrow id="S3.SS1.p2.8.m8.2.2.2.4" xref="S3.SS1.p2.8.m8.2.2.2.3.cmml">
            <mi id="S3.SS1.p2.8.m8.1.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.1.cmml">
             i
            </mi>
            <mo id="S3.SS1.p2.8.m8.2.2.2.4.1" xref="S3.SS1.p2.8.m8.2.2.2.3.cmml">
             ,
            </mo>
            <mi id="S3.SS1.p2.8.m8.2.2.2.2" xref="S3.SS1.p2.8.m8.2.2.2.2.cmml">
             j
            </mi>
           </mrow>
          </msub>
          <mo id="S3.SS1.p2.8.m8.9.9.1.1.2.2.4" xref="S3.SS1.p2.8.m8.9.9.1.1.2.3.cmml">
           ,
          </mo>
          <msub id="S3.SS1.p2.8.m8.9.9.1.1.2.2.2" xref="S3.SS1.p2.8.m8.9.9.1.1.2.2.2.cmml">
           <mi id="S3.SS1.p2.8.m8.9.9.1.1.2.2.2.2" xref="S3.SS1.p2.8.m8.9.9.1.1.2.2.2.2.cmml">
            v
           </mi>
           <mrow id="S3.SS1.p2.8.m8.4.4.2.2" xref="S3.SS1.p2.8.m8.4.4.2.3.cmml">
            <mi id="S3.SS1.p2.8.m8.3.3.1.1" xref="S3.SS1.p2.8.m8.3.3.1.1.cmml">
             k
            </mi>
            <mo id="S3.SS1.p2.8.m8.4.4.2.2.2" xref="S3.SS1.p2.8.m8.4.4.2.3.cmml">
             ,
            </mo>
            <mrow id="S3.SS1.p2.8.m8.4.4.2.2.1" xref="S3.SS1.p2.8.m8.4.4.2.2.1.cmml">
             <mi id="S3.SS1.p2.8.m8.4.4.2.2.1.2" xref="S3.SS1.p2.8.m8.4.4.2.2.1.2.cmml">
              j
             </mi>
             <mo id="S3.SS1.p2.8.m8.4.4.2.2.1.1" xref="S3.SS1.p2.8.m8.4.4.2.2.1.1.cmml">
              +
             </mo>
             <mn id="S3.SS1.p2.8.m8.4.4.2.2.1.3" xref="S3.SS1.p2.8.m8.4.4.2.2.1.3.cmml">
              1
             </mn>
            </mrow>
           </mrow>
          </msub>
          <mo id="S3.SS1.p2.8.m8.9.9.1.1.2.2.5" stretchy="false" xref="S3.SS1.p2.8.m8.9.9.1.1.2.3.cmml">
           )
          </mo>
         </mrow>
         <mo id="S3.SS1.p2.8.m8.9.9.1.1.3" xref="S3.SS1.p2.8.m8.9.9.1.1.3.cmml">
          ∈
         </mo>
         <mrow id="S3.SS1.p2.8.m8.9.9.1.1.4" xref="S3.SS1.p2.8.m8.9.9.1.1.4.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.8.m8.9.9.1.1.4.2" xref="S3.SS1.p2.8.m8.9.9.1.1.4.2.cmml">
           ℰ
          </mi>
          <mo id="S3.SS1.p2.8.m8.9.9.1.1.4.1" lspace="0.497em" rspace="0em" xref="S3.SS1.p2.8.m8.9.9.1.1.4.1.cmml">
           ​
          </mo>
          <mrow id="S3.SS1.p2.8.m8.9.9.1.1.4.3" xref="S3.SS1.p2.8.m8.9.9.1.1.4.3.cmml">
           <mo id="S3.SS1.p2.8.m8.9.9.1.1.4.3.1" rspace="0.167em" xref="S3.SS1.p2.8.m8.9.9.1.1.4.3.1.cmml">
            ∀
           </mo>
           <mi id="S3.SS1.p2.8.m8.9.9.1.1.4.3.2" xref="S3.SS1.p2.8.m8.9.9.1.1.4.3.2.cmml">
            i
           </mi>
          </mrow>
         </mrow>
        </mrow>
        <mo id="S3.SS1.p2.8.m8.10.10.2.3" xref="S3.SS1.p2.8.m8.10.10.3a.cmml">
         ,
        </mo>
        <mrow id="S3.SS1.p2.8.m8.10.10.2.2.2" xref="S3.SS1.p2.8.m8.10.10.2.2.3.cmml">
         <mrow id="S3.SS1.p2.8.m8.10.10.2.2.1.1" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.cmml">
          <mi id="S3.SS1.p2.8.m8.10.10.2.2.1.1.2" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.2.cmml">
           k
          </mi>
          <mo id="S3.SS1.p2.8.m8.10.10.2.2.1.1.1" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.1.cmml">
           ∈
          </mo>
          <mrow id="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.2" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.1.cmml">
           <mo id="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.2.1" stretchy="false" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.1.cmml">
            [
           </mo>
           <mn id="S3.SS1.p2.8.m8.5.5" xref="S3.SS1.p2.8.m8.5.5.cmml">
            1
           </mn>
           <mo id="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.2.2" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.1.cmml">
            ,
           </mo>
           <mi id="S3.SS1.p2.8.m8.6.6" xref="S3.SS1.p2.8.m8.6.6.cmml">
            n
           </mi>
           <mo id="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.2.3" stretchy="false" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.1.cmml">
            ]
           </mo>
          </mrow>
         </mrow>
         <mo id="S3.SS1.p2.8.m8.10.10.2.2.2.3" xref="S3.SS1.p2.8.m8.10.10.2.2.3a.cmml">
          ,
         </mo>
         <mrow id="S3.SS1.p2.8.m8.10.10.2.2.2.2" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.cmml">
          <mrow id="S3.SS1.p2.8.m8.10.10.2.2.2.2.2" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.cmml">
           <mo id="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.1" rspace="0.167em" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.1.cmml">
            ∀
           </mo>
           <mi id="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.2" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.2.cmml">
            j
           </mi>
          </mrow>
          <mo id="S3.SS1.p2.8.m8.10.10.2.2.2.2.1" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.1.cmml">
           ∈
          </mo>
          <mrow id="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.2" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.1.cmml">
           <mo id="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.2.1" stretchy="false" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.1.cmml">
            [
           </mo>
           <mn id="S3.SS1.p2.8.m8.7.7" xref="S3.SS1.p2.8.m8.7.7.cmml">
            0
           </mn>
           <mo id="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.2.2" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.1.cmml">
            ,
           </mo>
           <mi id="S3.SS1.p2.8.m8.8.8" xref="S3.SS1.p2.8.m8.8.8.cmml">
            r
           </mi>
           <mo id="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.2.3" stretchy="false" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.1.cmml">
            ]
           </mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.10b">
        <apply id="S3.SS1.p2.8.m8.10.10.3.cmml" xref="S3.SS1.p2.8.m8.10.10.2">
         <csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.10.10.3a.cmml" xref="S3.SS1.p2.8.m8.10.10.2.3">
          formulae-sequence
         </csymbol>
         <apply id="S3.SS1.p2.8.m8.9.9.1.1.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1">
          <in id="S3.SS1.p2.8.m8.9.9.1.1.3.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.3">
          </in>
          <interval closure="open" id="S3.SS1.p2.8.m8.9.9.1.1.2.3.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.2.2">
           <apply id="S3.SS1.p2.8.m8.9.9.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.9.9.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S3.SS1.p2.8.m8.9.9.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.1.1.1.2">
             𝑣
            </ci>
            <list id="S3.SS1.p2.8.m8.2.2.2.3.cmml" xref="S3.SS1.p2.8.m8.2.2.2.4">
             <ci id="S3.SS1.p2.8.m8.1.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1.1">
              𝑖
             </ci>
             <ci id="S3.SS1.p2.8.m8.2.2.2.2.cmml" xref="S3.SS1.p2.8.m8.2.2.2.2">
              𝑗
             </ci>
            </list>
           </apply>
           <apply id="S3.SS1.p2.8.m8.9.9.1.1.2.2.2.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.2.2.2">
            <csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.9.9.1.1.2.2.2.1.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.2.2.2">
             subscript
            </csymbol>
            <ci id="S3.SS1.p2.8.m8.9.9.1.1.2.2.2.2.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.2.2.2.2">
             𝑣
            </ci>
            <list id="S3.SS1.p2.8.m8.4.4.2.3.cmml" xref="S3.SS1.p2.8.m8.4.4.2.2">
             <ci id="S3.SS1.p2.8.m8.3.3.1.1.cmml" xref="S3.SS1.p2.8.m8.3.3.1.1">
              𝑘
             </ci>
             <apply id="S3.SS1.p2.8.m8.4.4.2.2.1.cmml" xref="S3.SS1.p2.8.m8.4.4.2.2.1">
              <plus id="S3.SS1.p2.8.m8.4.4.2.2.1.1.cmml" xref="S3.SS1.p2.8.m8.4.4.2.2.1.1">
              </plus>
              <ci id="S3.SS1.p2.8.m8.4.4.2.2.1.2.cmml" xref="S3.SS1.p2.8.m8.4.4.2.2.1.2">
               𝑗
              </ci>
              <cn id="S3.SS1.p2.8.m8.4.4.2.2.1.3.cmml" type="integer" xref="S3.SS1.p2.8.m8.4.4.2.2.1.3">
               1
              </cn>
             </apply>
            </list>
           </apply>
          </interval>
          <apply id="S3.SS1.p2.8.m8.9.9.1.1.4.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.4">
           <times id="S3.SS1.p2.8.m8.9.9.1.1.4.1.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.4.1">
           </times>
           <ci id="S3.SS1.p2.8.m8.9.9.1.1.4.2.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.4.2">
            ℰ
           </ci>
           <apply id="S3.SS1.p2.8.m8.9.9.1.1.4.3.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.4.3">
            <csymbol cd="latexml" id="S3.SS1.p2.8.m8.9.9.1.1.4.3.1.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.4.3.1">
             for-all
            </csymbol>
            <ci id="S3.SS1.p2.8.m8.9.9.1.1.4.3.2.cmml" xref="S3.SS1.p2.8.m8.9.9.1.1.4.3.2">
             𝑖
            </ci>
           </apply>
          </apply>
         </apply>
         <apply id="S3.SS1.p2.8.m8.10.10.2.2.3.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.2">
          <csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.10.10.2.2.3a.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.2.3">
           formulae-sequence
          </csymbol>
          <apply id="S3.SS1.p2.8.m8.10.10.2.2.1.1.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1">
           <in id="S3.SS1.p2.8.m8.10.10.2.2.1.1.1.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.1">
           </in>
           <ci id="S3.SS1.p2.8.m8.10.10.2.2.1.1.2.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.2">
            𝑘
           </ci>
           <interval closure="closed" id="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.1.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.1.1.3.2">
            <cn id="S3.SS1.p2.8.m8.5.5.cmml" type="integer" xref="S3.SS1.p2.8.m8.5.5">
             1
            </cn>
            <ci id="S3.SS1.p2.8.m8.6.6.cmml" xref="S3.SS1.p2.8.m8.6.6">
             𝑛
            </ci>
           </interval>
          </apply>
          <apply id="S3.SS1.p2.8.m8.10.10.2.2.2.2.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2">
           <in id="S3.SS1.p2.8.m8.10.10.2.2.2.2.1.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.1">
           </in>
           <apply id="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.2">
            <csymbol cd="latexml" id="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.1">
             for-all
            </csymbol>
            <ci id="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.2.2">
             𝑗
            </ci>
           </apply>
           <interval closure="closed" id="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.1.cmml" xref="S3.SS1.p2.8.m8.10.10.2.2.2.2.3.2">
            <cn id="S3.SS1.p2.8.m8.7.7.cmml" type="integer" xref="S3.SS1.p2.8.m8.7.7">
             0
            </cn>
            <ci id="S3.SS1.p2.8.m8.8.8.cmml" xref="S3.SS1.p2.8.m8.8.8">
             𝑟
            </ci>
           </interval>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.10c">
        (v_{i,j},v_{k,j+1})\in\mathcal{E}~{}\forall i,k\in[1,n],\forall j\in[0,r]
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Training Data (MAG) Construction
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.5">
     With the specifics of a MAG defined, we now want to construct these graphs for a given task. These would then serve as data for training distilled models. Given a reasoning problem (e.g., a math word problem), we follow
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.5.1">
      ReConcile
     </span>
     and use GPT-4, Bard, and Claude2 as the three interacting LLM agents for a maximum of three rounds (see
     <cite class="ltx_cite ltx_citemacro_citet">
      Chen et al. (
      <a class="ltx_ref" href="#bib.bib6" title="">
       2023b
      </a>
      )
     </cite>
     for further details of the framework).
The discussion continues until a consensus is reached, i.e., all agents agree on the same answer.
This means that when there is no interaction (i.e., all agents’ initial answers are the same), a MAG will have 3 disconnected nodes, one for each agent (and no edges). When there is a single round of interaction, it will have 6 nodes and 9 edges, and so on. In summary, for a given task, our training data will consist of graphs that can be grouped into four structural types, based on the number of interaction rounds. We will refer to these graph types as
     <math alttext="\mathcal{G}_{0}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1">
      <semantics id="S3.SS2.p1.1.m1.1a">
       <msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">
         𝒢
        </mi>
        <mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">
         0
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b">
        <apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">
          𝒢
         </ci>
         <cn id="S3.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.3">
          0
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">
        \mathcal{G}_{0}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\mathcal{G}_{1}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1">
      <semantics id="S3.SS2.p1.2.m2.1a">
       <msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">
         𝒢
        </mi>
        <mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">
         1
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b">
        <apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">
          𝒢
         </ci>
         <cn id="S3.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">
        \mathcal{G}_{1}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\mathcal{G}_{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1">
      <semantics id="S3.SS2.p1.3.m3.1a">
       <msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">
         𝒢
        </mi>
        <mn id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">
         2
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b">
        <apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">
          𝒢
         </ci>
         <cn id="S3.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.3">
          2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">
        \mathcal{G}_{2}
       </annotation>
      </semantics>
     </math>
     , and
     <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1">
      <semantics id="S3.SS2.p1.4.m4.1a">
       <msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">
         𝒢
        </mi>
        <mn id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">
         3
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b">
        <apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">
          𝒢
         </ci>
         <cn id="S3.SS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p1.4.m4.1.1.3">
          3
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">
        \mathcal{G}_{3}
       </annotation>
      </semantics>
     </math>
     (with the subscript denoting the number of rounds). Fig.
     <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     is an example of a
     <math alttext="\mathcal{G}_{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1">
      <semantics id="S3.SS2.p1.5.m5.1a">
       <msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">
         𝒢
        </mi>
        <mn id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">
         2
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b">
        <apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">
          𝒢
         </ci>
         <cn id="S3.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p1.5.m5.1.1.3">
          2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">
        \mathcal{G}_{2}
       </annotation>
      </semantics>
     </math>
     graph.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">
      Benchmarks.
     </span>
     Following the above framework, we construct MAGs for 5 widely-used benchmarks on commonsense and math reasoning: (1) StrategyQA
     <cite class="ltx_cite ltx_citemacro_cite">
      Geva et al. (
      <a class="ltx_ref" href="#bib.bib18" title="">
       2021
      </a>
      )
     </cite>
     , (2) CommonsenseQA
     <cite class="ltx_cite ltx_citemacro_cite">
      Talmor et al. (
      <a class="ltx_ref" href="#bib.bib42" title="">
       2019
      </a>
      ); Aggarwal et al. (
      <a class="ltx_ref" href="#bib.bib1" title="">
       2021
      </a>
      )
     </cite>
     , (3) AI2 Reasoning Challenge
     <cite class="ltx_cite ltx_citemacro_cite">
      Clark et al. (
      <a class="ltx_ref" href="#bib.bib12" title="">
       2018
      </a>
      )
     </cite>
     , (4) GSM8K
     <cite class="ltx_cite ltx_citemacro_cite">
      Cobbe et al. (
      <a class="ltx_ref" href="#bib.bib13" title="">
       2021
      </a>
      )
     </cite>
     and (5) MATH
     <cite class="ltx_cite ltx_citemacro_cite">
      Hendrycks et al. (
      <a class="ltx_ref" href="#bib.bib20" title="">
       2021
      </a>
      )
     </cite>
     .
We also experiment with 2 OOD datasets: BoolQ
     <cite class="ltx_cite ltx_citemacro_citep">
      (Clark et al.,
      <a class="ltx_ref" href="#bib.bib11" title="">
       2019
      </a>
      )
     </cite>
     and SVAMP
     <cite class="ltx_cite ltx_citemacro_citep">
      (Patel et al.,
      <a class="ltx_ref" href="#bib.bib36" title="">
       2021
      </a>
      )
     </cite>
     for which we
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.2">
      do not
     </em>
     construct MAGs and are exclusively used to test the transfer of our model.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    Statistics of Training Data (MAGs)
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.1">
     We construct
     <math alttext="1000" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1">
      <semantics id="S3.SS3.p1.1.m1.1a">
       <mn id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">
        1000
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b">
        <cn id="S3.SS3.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p1.1.m1.1.1">
         1000
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">
        1000
       </annotation>
      </semantics>
     </math>
     training MAGs for each in-domain benchmark. We categorize the data along three dimensions: rounds, agents, and graph structures. See Appendix
     <a class="ltx_ref" href="#A2.T8" title="In Appendix B Further Analyses of MAGDi">
      <span class="ltx_text ltx_ref_tag">
       Table
      </span>
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     for statistics along each dimension and for each benchmark.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">
      Round.
     </span>
     Recall that a MAG consists of nodes belonging to different interaction rounds
     <math alttext="i\in[0,3]" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.2">
      <semantics id="S3.SS3.p2.1.m1.2a">
       <mrow id="S3.SS3.p2.1.m1.2.3" xref="S3.SS3.p2.1.m1.2.3.cmml">
        <mi id="S3.SS3.p2.1.m1.2.3.2" xref="S3.SS3.p2.1.m1.2.3.2.cmml">
         i
        </mi>
        <mo id="S3.SS3.p2.1.m1.2.3.1" xref="S3.SS3.p2.1.m1.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS3.p2.1.m1.2.3.3.2" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">
         <mo id="S3.SS3.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">
          [
         </mo>
         <mn id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">
          0
         </mn>
         <mo id="S3.SS3.p2.1.m1.2.3.3.2.2" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">
          3
         </mn>
         <mo id="S3.SS3.p2.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b">
        <apply id="S3.SS3.p2.1.m1.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3">
         <in id="S3.SS3.p2.1.m1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.1">
         </in>
         <ci id="S3.SS3.p2.1.m1.2.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.2">
          𝑖
         </ci>
         <interval closure="closed" id="S3.SS3.p2.1.m1.2.3.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2">
          <cn id="S3.SS3.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p2.1.m1.1.1">
           0
          </cn>
          <cn id="S3.SS3.p2.1.m1.2.2.cmml" type="integer" xref="S3.SS3.p2.1.m1.2.2">
           3
          </cn>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">
        i\in[0,3]
       </annotation>
      </semantics>
     </math>
     . All datasets have more nodes in lower rounds, indicating that consensus between agents is typically achieved in these earlier rounds.
The number of nodes in the later rounds is also an indicator of the difficulty of the benchmark. For example, MATH has the most number of round-3 nodes, suggesting that even after two rounds of discussion, the strong teacher LLMs do not converge on a single answer.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p3">
    <p class="ltx_p" id="S3.SS3.p3.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p3.1.1">
      Agent.
     </span>
     We can also group the MAG nodes based on the agent generating the response at that node (GPT4/Claude2/Bard). The number of nodes for each agent is the same because all agents engage in all rounds.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p4">
    <p class="ltx_p" id="S3.SS3.p4.2">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p4.2.1">
      Graph Structure.
     </span>
     Lastly, we also show the break-down of different MAG structures. Like nodes,
     <math alttext="\mathcal{G}_{0}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1">
      <semantics id="S3.SS3.p4.1.m1.1a">
       <msub id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">
         𝒢
        </mi>
        <mn id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml">
         0
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b">
        <apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">
          𝒢
         </ci>
         <cn id="S3.SS3.p4.1.m1.1.1.3.cmml" type="integer" xref="S3.SS3.p4.1.m1.1.1.3">
          0
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">
        \mathcal{G}_{0}
       </annotation>
      </semantics>
     </math>
     graphs are the most represented in our datasets while
     <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1">
      <semantics id="S3.SS3.p4.2.m2.1a">
       <msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">
         𝒢
        </mi>
        <mn id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">
         3
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b">
        <apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">
          𝒢
         </ci>
         <cn id="S3.SS3.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p4.2.m2.1.1.3">
          3
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">
        \mathcal{G}_{3}
       </annotation>
      </semantics>
     </math>
     graphs are the least, and all graph structures add up to to 1K data points per task. We show examples of MAGs in Appendix
     <a class="ltx_ref" href="#A4" title="Appendix D Qualitative Examples of MAG">
      <span class="ltx_text ltx_ref_tag">
       D
      </span>
     </a>
     . Using these MAGs as supervision, we train task-specific and multi-task distilled models, as discussed below.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.4
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.1.1">
     MAGDi
    </span>
    : Structured Distillation from MAGs
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p1">
    <p class="ltx_p" id="S3.SS4.p1.1">
     We now discuss our proposed structured distillation method,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.1.1">
      MAGDi
     </span>
     , that distills reasoning capabilities into a smaller student model via multi-teacher interaction graphs (MAGs).
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p2">
    <p class="ltx_p" id="S3.SS4.p2.3">
     <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S3.SS4.p2.3.1">
      MAGDi
      <span class="ltx_text ltx_font_upright" id="S3.SS4.p2.3.1.1">
       Overview.
      </span>
     </span>
     Broadly,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.3.2">
      MAGDi
     </span>
     performs structured distillation by augmenting a student model (e.g., Mistral-7B-Instruct or LLaMA-2-7B-Chat) with a light-weight Graph Neural Network (GNN) that is responsible for modeling the ‘structure’ in structured distillation (see Fig.
     <a class="ltx_ref" href="#S1.F3" title="Figure 3 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ‘
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.3.3">
      MAGDi
     </span>
     Components’). This augmented student model is then fine-tuned with a combination of three objectives that distill knowledge from the positive nodes, negative nodes, and the edges (i.e., interactions) in a MAG (see Fig.
     <a class="ltx_ref" href="#S1.F3" title="Figure 3 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ‘
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.3.4">
      MAGDi
     </span>
     Objectives for Distillaton’). We denote the base model as
     <math alttext="p_{\theta}(\cdot)" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1">
      <semantics id="S3.SS4.p2.1.m1.1a">
       <mrow id="S3.SS4.p2.1.m1.1.2" xref="S3.SS4.p2.1.m1.1.2.cmml">
        <msub id="S3.SS4.p2.1.m1.1.2.2" xref="S3.SS4.p2.1.m1.1.2.2.cmml">
         <mi id="S3.SS4.p2.1.m1.1.2.2.2" xref="S3.SS4.p2.1.m1.1.2.2.2.cmml">
          p
         </mi>
         <mi id="S3.SS4.p2.1.m1.1.2.2.3" xref="S3.SS4.p2.1.m1.1.2.2.3.cmml">
          θ
         </mi>
        </msub>
        <mo id="S3.SS4.p2.1.m1.1.2.1" lspace="0em" rspace="0em" xref="S3.SS4.p2.1.m1.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p2.1.m1.1.2.3.2" xref="S3.SS4.p2.1.m1.1.2.cmml">
         <mo id="S3.SS4.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS4.p2.1.m1.1.2.cmml">
          (
         </mo>
         <mo id="S3.SS4.p2.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS4.p2.1.m1.1.1.cmml">
          ⋅
         </mo>
         <mo id="S3.SS4.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS4.p2.1.m1.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b">
        <apply id="S3.SS4.p2.1.m1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.2">
         <times id="S3.SS4.p2.1.m1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.2.1">
         </times>
         <apply id="S3.SS4.p2.1.m1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.2.2">
          <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.2.2.1.cmml" xref="S3.SS4.p2.1.m1.1.2.2">
           subscript
          </csymbol>
          <ci id="S3.SS4.p2.1.m1.1.2.2.2.cmml" xref="S3.SS4.p2.1.m1.1.2.2.2">
           𝑝
          </ci>
          <ci id="S3.SS4.p2.1.m1.1.2.2.3.cmml" xref="S3.SS4.p2.1.m1.1.2.2.3">
           𝜃
          </ci>
         </apply>
         <ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">
          ⋅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">
        p_{\theta}(\cdot)
       </annotation>
      </semantics>
     </math>
     and the input reasoning problem as
     <math alttext="q" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1">
      <semantics id="S3.SS4.p2.2.m2.1a">
       <mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">
        q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b">
        <ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">
         𝑞
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">
        q
       </annotation>
      </semantics>
     </math>
     . For brevity, we denote the generation at any MAG node as a variable-length sequence of tokens:
     <math alttext="\textbf{x}=\{x_{1},x_{2},...,x_{|\textbf{x}|}\}" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.5">
      <semantics id="S3.SS4.p2.3.m3.5a">
       <mrow id="S3.SS4.p2.3.m3.5.5" xref="S3.SS4.p2.3.m3.5.5.cmml">
        <mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.3.m3.5.5.5" xref="S3.SS4.p2.3.m3.5.5.5a.cmml">
         x
        </mtext>
        <mo id="S3.SS4.p2.3.m3.5.5.4" xref="S3.SS4.p2.3.m3.5.5.4.cmml">
         =
        </mo>
        <mrow id="S3.SS4.p2.3.m3.5.5.3.3" xref="S3.SS4.p2.3.m3.5.5.3.4.cmml">
         <mo id="S3.SS4.p2.3.m3.5.5.3.3.4" stretchy="false" xref="S3.SS4.p2.3.m3.5.5.3.4.cmml">
          {
         </mo>
         <msub id="S3.SS4.p2.3.m3.3.3.1.1.1" xref="S3.SS4.p2.3.m3.3.3.1.1.1.cmml">
          <mi id="S3.SS4.p2.3.m3.3.3.1.1.1.2" xref="S3.SS4.p2.3.m3.3.3.1.1.1.2.cmml">
           x
          </mi>
          <mn id="S3.SS4.p2.3.m3.3.3.1.1.1.3" xref="S3.SS4.p2.3.m3.3.3.1.1.1.3.cmml">
           1
          </mn>
         </msub>
         <mo id="S3.SS4.p2.3.m3.5.5.3.3.5" xref="S3.SS4.p2.3.m3.5.5.3.4.cmml">
          ,
         </mo>
         <msub id="S3.SS4.p2.3.m3.4.4.2.2.2" xref="S3.SS4.p2.3.m3.4.4.2.2.2.cmml">
          <mi id="S3.SS4.p2.3.m3.4.4.2.2.2.2" xref="S3.SS4.p2.3.m3.4.4.2.2.2.2.cmml">
           x
          </mi>
          <mn id="S3.SS4.p2.3.m3.4.4.2.2.2.3" xref="S3.SS4.p2.3.m3.4.4.2.2.2.3.cmml">
           2
          </mn>
         </msub>
         <mo id="S3.SS4.p2.3.m3.5.5.3.3.6" xref="S3.SS4.p2.3.m3.5.5.3.4.cmml">
          ,
         </mo>
         <mi id="S3.SS4.p2.3.m3.2.2" mathvariant="normal" xref="S3.SS4.p2.3.m3.2.2.cmml">
          …
         </mi>
         <mo id="S3.SS4.p2.3.m3.5.5.3.3.7" xref="S3.SS4.p2.3.m3.5.5.3.4.cmml">
          ,
         </mo>
         <msub id="S3.SS4.p2.3.m3.5.5.3.3.3" xref="S3.SS4.p2.3.m3.5.5.3.3.3.cmml">
          <mi id="S3.SS4.p2.3.m3.5.5.3.3.3.2" xref="S3.SS4.p2.3.m3.5.5.3.3.3.2.cmml">
           x
          </mi>
          <mrow id="S3.SS4.p2.3.m3.1.1.1.3" xref="S3.SS4.p2.3.m3.1.1.1.2.cmml">
           <mo id="S3.SS4.p2.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS4.p2.3.m3.1.1.1.2.1.cmml">
            |
           </mo>
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.3.m3.1.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.1a.cmml">
            x
           </mtext>
           <mo id="S3.SS4.p2.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS4.p2.3.m3.1.1.1.2.1.cmml">
            |
           </mo>
          </mrow>
         </msub>
         <mo id="S3.SS4.p2.3.m3.5.5.3.3.8" stretchy="false" xref="S3.SS4.p2.3.m3.5.5.3.4.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.5b">
        <apply id="S3.SS4.p2.3.m3.5.5.cmml" xref="S3.SS4.p2.3.m3.5.5">
         <eq id="S3.SS4.p2.3.m3.5.5.4.cmml" xref="S3.SS4.p2.3.m3.5.5.4">
         </eq>
         <ci id="S3.SS4.p2.3.m3.5.5.5a.cmml" xref="S3.SS4.p2.3.m3.5.5.5">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.3.m3.5.5.5.cmml" xref="S3.SS4.p2.3.m3.5.5.5">
           x
          </mtext>
         </ci>
         <set id="S3.SS4.p2.3.m3.5.5.3.4.cmml" xref="S3.SS4.p2.3.m3.5.5.3.3">
          <apply id="S3.SS4.p2.3.m3.3.3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.3.3.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.3.3.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS4.p2.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS4.p2.3.m3.3.3.1.1.1.2">
            𝑥
           </ci>
           <cn id="S3.SS4.p2.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS4.p2.3.m3.3.3.1.1.1.3">
            1
           </cn>
          </apply>
          <apply id="S3.SS4.p2.3.m3.4.4.2.2.2.cmml" xref="S3.SS4.p2.3.m3.4.4.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.4.4.2.2.2.1.cmml" xref="S3.SS4.p2.3.m3.4.4.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS4.p2.3.m3.4.4.2.2.2.2.cmml" xref="S3.SS4.p2.3.m3.4.4.2.2.2.2">
            𝑥
           </ci>
           <cn id="S3.SS4.p2.3.m3.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS4.p2.3.m3.4.4.2.2.2.3">
            2
           </cn>
          </apply>
          <ci id="S3.SS4.p2.3.m3.2.2.cmml" xref="S3.SS4.p2.3.m3.2.2">
           …
          </ci>
          <apply id="S3.SS4.p2.3.m3.5.5.3.3.3.cmml" xref="S3.SS4.p2.3.m3.5.5.3.3.3">
           <csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.5.5.3.3.3.1.cmml" xref="S3.SS4.p2.3.m3.5.5.3.3.3">
            subscript
           </csymbol>
           <ci id="S3.SS4.p2.3.m3.5.5.3.3.3.2.cmml" xref="S3.SS4.p2.3.m3.5.5.3.3.3.2">
            𝑥
           </ci>
           <apply id="S3.SS4.p2.3.m3.1.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.1.3">
            <abs id="S3.SS4.p2.3.m3.1.1.1.2.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1.3.1">
            </abs>
            <ci id="S3.SS4.p2.3.m3.1.1.1.1a.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1">
             <mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.3.m3.1.1.1.1.cmml" mathsize="70%" xref="S3.SS4.p2.3.m3.1.1.1.1">
              x
             </mtext>
            </ci>
           </apply>
          </apply>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.5c">
        \textbf{x}=\{x_{1},x_{2},...,x_{|\textbf{x}|}\}
       </annotation>
      </semantics>
     </math>
     . Below, we describe the three objectives for structurally distilling student LMs.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p3">
    <p class="ltx_p" id="S3.SS4.p3.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p3.1.1">
      Objective 1: Learning from Positive Reasoning.
     </span>
     Learning from a teacher LLM’s
     <span class="ltx_text ltx_font_italic" id="S3.SS4.p3.1.2">
      correct
     </span>
     reasoning has been shown to improve smaller models
     <cite class="ltx_cite ltx_citemacro_citep">
      (Magister et al.,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2023
      </a>
      ; Li et al.,
      <a class="ltx_ref" href="#bib.bib29" title="">
       2023
      </a>
      )
     </cite>
     . Hence,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.1.3">
      MAGDi
     </span>
     first fine-tunes the student model on all
     <em class="ltx_emph ltx_font_italic" id="S3.SS4.p3.1.4">
      correct
     </em>
     reasoning chains
     <math alttext="\textbf{x}^{+}\in\mathcal{V}^{+}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1">
      <semantics id="S3.SS4.p3.1.m1.1a">
       <mrow id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">
        <msup id="S3.SS4.p3.1.m1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.2.cmml">
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.1.m1.1.1.2.2" xref="S3.SS4.p3.1.m1.1.1.2.2a.cmml">
          x
         </mtext>
         <mo id="S3.SS4.p3.1.m1.1.1.2.3" xref="S3.SS4.p3.1.m1.1.1.2.3.cmml">
          +
         </mo>
        </msup>
        <mo id="S3.SS4.p3.1.m1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.1.m1.1.1.3.2" xref="S3.SS4.p3.1.m1.1.1.3.2.cmml">
          𝒱
         </mi>
         <mo id="S3.SS4.p3.1.m1.1.1.3.3" xref="S3.SS4.p3.1.m1.1.1.3.3.cmml">
          +
         </mo>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b">
        <apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">
         <in id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1">
         </in>
         <apply id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.1.2">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.1.m1.1.1.2.2a.cmml" xref="S3.SS4.p3.1.m1.1.1.2.2">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.1.m1.1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2.2">
            x
           </mtext>
          </ci>
          <plus id="S3.SS4.p3.1.m1.1.1.2.3.cmml" xref="S3.SS4.p3.1.m1.1.1.2.3">
          </plus>
         </apply>
         <apply id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.3.1.cmml" xref="S3.SS4.p3.1.m1.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.1.m1.1.1.3.2.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2">
           𝒱
          </ci>
          <plus id="S3.SS4.p3.1.m1.1.1.3.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3.3">
          </plus>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">
        \textbf{x}^{+}\in\mathcal{V}^{+}
       </annotation>
      </semantics>
     </math>
     using a standard next-token prediction objective (see Fig.
     <a class="ltx_ref" href="#S1.F3" title="Figure 3 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ‘Learning from Positive Reasoning’). The loss is defined as follows.
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S3.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\mathcal{L}^{+}=-\sum_{\textbf{x}^{+}\in\mathcal{V}^{+}}\sum_{i=1}^{|\textbf{x}^{+}|}\log p_{\theta}(x^{+}_{i}|\textbf{x}^{+}_{&lt;i},q)" class="ltx_Math" display="block" id="S3.E1.m1.3">
         <semantics id="S3.E1.m1.3a">
          <mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">
           <msup id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml">
            <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.3.2" xref="S3.E1.m1.3.3.3.2.cmml">
             ℒ
            </mi>
            <mo id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">
             +
            </mo>
           </msup>
           <mo id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">
            =
           </mo>
           <mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml">
            <mo id="S3.E1.m1.3.3.1a" xref="S3.E1.m1.3.3.1.cmml">
             −
            </mo>
            <mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml">
             <munder id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">
              <mo id="S3.E1.m1.3.3.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E1.m1.3.3.1.1.2.2.cmml">
               ∑
              </mo>
              <mrow id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml">
               <msup id="S3.E1.m1.3.3.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.2.3.2.cmml">
                <mtext class="ltx_mathvariant_bold" id="S3.E1.m1.3.3.1.1.2.3.2.2" xref="S3.E1.m1.3.3.1.1.2.3.2.2a.cmml">
                 x
                </mtext>
                <mo id="S3.E1.m1.3.3.1.1.2.3.2.3" xref="S3.E1.m1.3.3.1.1.2.3.2.3.cmml">
                 +
                </mo>
               </msup>
               <mo id="S3.E1.m1.3.3.1.1.2.3.1" xref="S3.E1.m1.3.3.1.1.2.3.1.cmml">
                ∈
               </mo>
               <msup id="S3.E1.m1.3.3.1.1.2.3.3" xref="S3.E1.m1.3.3.1.1.2.3.3.cmml">
                <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.2.3.3.2" xref="S3.E1.m1.3.3.1.1.2.3.3.2.cmml">
                 𝒱
                </mi>
                <mo id="S3.E1.m1.3.3.1.1.2.3.3.3" xref="S3.E1.m1.3.3.1.1.2.3.3.3.cmml">
                 +
                </mo>
               </msup>
              </mrow>
             </munder>
             <mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml">
              <munderover id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">
               <mo id="S3.E1.m1.3.3.1.1.1.2.2.2" movablelimits="false" xref="S3.E1.m1.3.3.1.1.1.2.2.2.cmml">
                ∑
               </mo>
               <mrow id="S3.E1.m1.3.3.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.2.2.3.cmml">
                <mi id="S3.E1.m1.3.3.1.1.1.2.2.3.2" xref="S3.E1.m1.3.3.1.1.1.2.2.3.2.cmml">
                 i
                </mi>
                <mo id="S3.E1.m1.3.3.1.1.1.2.2.3.1" xref="S3.E1.m1.3.3.1.1.1.2.2.3.1.cmml">
                 =
                </mo>
                <mn id="S3.E1.m1.3.3.1.1.1.2.2.3.3" xref="S3.E1.m1.3.3.1.1.1.2.2.3.3.cmml">
                 1
                </mn>
               </mrow>
               <mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.2.cmml">
                <mo id="S3.E1.m1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">
                 |
                </mo>
                <msup id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml">
                 <mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2a.cmml">
                  x
                 </mtext>
                 <mo id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">
                  +
                 </mo>
                </msup>
                <mo id="S3.E1.m1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">
                 |
                </mo>
               </mrow>
              </munderover>
              <mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml">
               <mrow id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml">
                <mi id="S3.E1.m1.3.3.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml">
                 log
                </mi>
                <mo id="S3.E1.m1.3.3.1.1.1.1.3a" lspace="0.167em" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml">
                 ⁡
                </mo>
                <msub id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.cmml">
                 <mi id="S3.E1.m1.3.3.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml">
                  p
                 </mi>
                 <mi id="S3.E1.m1.3.3.1.1.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.cmml">
                  θ
                 </mi>
                </msub>
               </mrow>
               <mo id="S3.E1.m1.3.3.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">
                <mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">
                 <msubsup id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">
                  <mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml">
                   x
                  </mi>
                  <mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">
                   i
                  </mi>
                  <mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml">
                   +
                  </mo>
                 </msubsup>
                 <mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">
                  |
                 </mo>
                 <mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">
                  <msubsup id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mtext class="ltx_mathvariant_bold" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">
                    x
                   </mtext>
                   <mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    <mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                    </mi>
                    <mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">
                     &lt;
                    </mo>
                    <mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                     i
                    </mi>
                   </mrow>
                   <mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                    +
                   </mo>
                  </msubsup>
                  <mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">
                   ,
                  </mo>
                  <mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">
                   q
                  </mi>
                 </mrow>
                </mrow>
                <mo id="S3.E1.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b">
           <apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">
            <eq id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2">
            </eq>
            <apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3">
             <csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3">
              superscript
             </csymbol>
             <ci id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2">
              ℒ
             </ci>
             <plus id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3">
             </plus>
            </apply>
            <apply id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1">
             <minus id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1">
             </minus>
             <apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1">
              <apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2">
               <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2">
                subscript
               </csymbol>
               <sum id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2">
               </sum>
               <apply id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3">
                <in id="S3.E1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.3.1">
                </in>
                <apply id="S3.E1.m1.3.3.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2">
                 <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2">
                  superscript
                 </csymbol>
                 <ci id="S3.E1.m1.3.3.1.1.2.3.2.2a.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2.2">
                  <mtext class="ltx_mathvariant_bold" id="S3.E1.m1.3.3.1.1.2.3.2.2.cmml" mathsize="70%" xref="S3.E1.m1.3.3.1.1.2.3.2.2">
                   x
                  </mtext>
                 </ci>
                 <plus id="S3.E1.m1.3.3.1.1.2.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2.3">
                 </plus>
                </apply>
                <apply id="S3.E1.m1.3.3.1.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3.3">
                 <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.3.3">
                  superscript
                 </csymbol>
                 <ci id="S3.E1.m1.3.3.1.1.2.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.3.3.2">
                  𝒱
                 </ci>
                 <plus id="S3.E1.m1.3.3.1.1.2.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3.3.3">
                 </plus>
                </apply>
               </apply>
              </apply>
              <apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1">
               <apply id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2">
                <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2">
                 superscript
                </csymbol>
                <apply id="S3.E1.m1.3.3.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2">
                 <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2">
                  subscript
                 </csymbol>
                 <sum id="S3.E1.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.2">
                 </sum>
                 <apply id="S3.E1.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.3">
                  <eq id="S3.E1.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.3.1">
                  </eq>
                  <ci id="S3.E1.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.3.2">
                   𝑖
                  </ci>
                  <cn id="S3.E1.m1.3.3.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.2.2.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
                <apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1">
                 <abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">
                 </abs>
                 <apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">
                   superscript
                  </csymbol>
                  <ci id="S3.E1.m1.1.1.1.1.1.2a.cmml" xref="S3.E1.m1.1.1.1.1.1.2">
                   <mtext class="ltx_mathvariant_bold" id="S3.E1.m1.1.1.1.1.1.2.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.1.2">
                    x
                   </mtext>
                  </ci>
                  <plus id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">
                  </plus>
                 </apply>
                </apply>
               </apply>
               <apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1">
                <times id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">
                </times>
                <apply id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3">
                 <log id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.1">
                 </log>
                 <apply id="S3.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2">
                  <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2">
                   subscript
                  </csymbol>
                  <ci id="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2">
                   𝑝
                  </ci>
                  <ci id="S3.E1.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3">
                   𝜃
                  </ci>
                 </apply>
                </apply>
                <apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1">
                 <csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2">
                  conditional
                 </csymbol>
                 <apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3">
                  <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3">
                   subscript
                  </csymbol>
                  <apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3">
                   <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3">
                    superscript
                   </csymbol>
                   <ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.2">
                    𝑥
                   </ci>
                   <plus id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.3">
                   </plus>
                  </apply>
                  <ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3">
                   𝑖
                  </ci>
                 </apply>
                 <list id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1">
                  <apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">
                    <csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">
                     superscript
                    </csymbol>
                    <ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">
                     <mtext class="ltx_mathvariant_bold" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">
                      x
                     </mtext>
                    </ci>
                    <plus id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3">
                    </plus>
                   </apply>
                   <apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">
                    <lt id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1">
                    </lt>
                    <csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">
                     absent
                    </csymbol>
                    <ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">
                     𝑖
                    </ci>
                   </apply>
                  </apply>
                  <ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">
                   𝑞
                  </ci>
                 </list>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E1.m1.3c">
           \mathcal{L}^{+}=-\sum_{\textbf{x}^{+}\in\mathcal{V}^{+}}\sum_{i=1}^{|\textbf{x}^{+}|}\log p_{\theta}(x^{+}_{i}|\textbf{x}^{+}_{&lt;i},q)
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS4.p3.11">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p3.11.1">
      Objective 2: Learning from Negative Reasoning.
     </span>
     Teacher LLMs also make mistakes, particularly when solving more challenging problems. However, instead of discarding these,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.11.2">
      MAGDi
     </span>
     treats them as
     <em class="ltx_emph ltx_font_italic" id="S3.SS4.p3.11.3">
      challenging
     </em>
     negatives (generated by a strong teacher) that a student model can learn from by contrasting with positive chains.
Given a positive reasoning chain
     <math alttext="\textbf{x}^{+}\in\mathcal{V}^{+}" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m1.1">
      <semantics id="S3.SS4.p3.2.m1.1a">
       <mrow id="S3.SS4.p3.2.m1.1.1" xref="S3.SS4.p3.2.m1.1.1.cmml">
        <msup id="S3.SS4.p3.2.m1.1.1.2" xref="S3.SS4.p3.2.m1.1.1.2.cmml">
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.2.m1.1.1.2.2" xref="S3.SS4.p3.2.m1.1.1.2.2a.cmml">
          x
         </mtext>
         <mo id="S3.SS4.p3.2.m1.1.1.2.3" xref="S3.SS4.p3.2.m1.1.1.2.3.cmml">
          +
         </mo>
        </msup>
        <mo id="S3.SS4.p3.2.m1.1.1.1" xref="S3.SS4.p3.2.m1.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S3.SS4.p3.2.m1.1.1.3" xref="S3.SS4.p3.2.m1.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.2.m1.1.1.3.2" xref="S3.SS4.p3.2.m1.1.1.3.2.cmml">
          𝒱
         </mi>
         <mo id="S3.SS4.p3.2.m1.1.1.3.3" xref="S3.SS4.p3.2.m1.1.1.3.3.cmml">
          +
         </mo>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m1.1b">
        <apply id="S3.SS4.p3.2.m1.1.1.cmml" xref="S3.SS4.p3.2.m1.1.1">
         <in id="S3.SS4.p3.2.m1.1.1.1.cmml" xref="S3.SS4.p3.2.m1.1.1.1">
         </in>
         <apply id="S3.SS4.p3.2.m1.1.1.2.cmml" xref="S3.SS4.p3.2.m1.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p3.2.m1.1.1.2.1.cmml" xref="S3.SS4.p3.2.m1.1.1.2">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.2.m1.1.1.2.2a.cmml" xref="S3.SS4.p3.2.m1.1.1.2.2">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.2.m1.1.1.2.2.cmml" xref="S3.SS4.p3.2.m1.1.1.2.2">
            x
           </mtext>
          </ci>
          <plus id="S3.SS4.p3.2.m1.1.1.2.3.cmml" xref="S3.SS4.p3.2.m1.1.1.2.3">
          </plus>
         </apply>
         <apply id="S3.SS4.p3.2.m1.1.1.3.cmml" xref="S3.SS4.p3.2.m1.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS4.p3.2.m1.1.1.3.1.cmml" xref="S3.SS4.p3.2.m1.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.2.m1.1.1.3.2.cmml" xref="S3.SS4.p3.2.m1.1.1.3.2">
           𝒱
          </ci>
          <plus id="S3.SS4.p3.2.m1.1.1.3.3.cmml" xref="S3.SS4.p3.2.m1.1.1.3.3">
          </plus>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.2.m1.1c">
        \textbf{x}^{+}\in\mathcal{V}^{+}
       </annotation>
      </semantics>
     </math>
     and a negative reasoning chain
     <math alttext="\textbf{x}^{-}\in\mathcal{V}^{-}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m2.1">
      <semantics id="S3.SS4.p3.3.m2.1a">
       <mrow id="S3.SS4.p3.3.m2.1.1" xref="S3.SS4.p3.3.m2.1.1.cmml">
        <msup id="S3.SS4.p3.3.m2.1.1.2" xref="S3.SS4.p3.3.m2.1.1.2.cmml">
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.3.m2.1.1.2.2" xref="S3.SS4.p3.3.m2.1.1.2.2a.cmml">
          x
         </mtext>
         <mo id="S3.SS4.p3.3.m2.1.1.2.3" xref="S3.SS4.p3.3.m2.1.1.2.3.cmml">
          −
         </mo>
        </msup>
        <mo id="S3.SS4.p3.3.m2.1.1.1" xref="S3.SS4.p3.3.m2.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S3.SS4.p3.3.m2.1.1.3" xref="S3.SS4.p3.3.m2.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.3.m2.1.1.3.2" xref="S3.SS4.p3.3.m2.1.1.3.2.cmml">
          𝒱
         </mi>
         <mo id="S3.SS4.p3.3.m2.1.1.3.3" xref="S3.SS4.p3.3.m2.1.1.3.3.cmml">
          −
         </mo>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m2.1b">
        <apply id="S3.SS4.p3.3.m2.1.1.cmml" xref="S3.SS4.p3.3.m2.1.1">
         <in id="S3.SS4.p3.3.m2.1.1.1.cmml" xref="S3.SS4.p3.3.m2.1.1.1">
         </in>
         <apply id="S3.SS4.p3.3.m2.1.1.2.cmml" xref="S3.SS4.p3.3.m2.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p3.3.m2.1.1.2.1.cmml" xref="S3.SS4.p3.3.m2.1.1.2">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.3.m2.1.1.2.2a.cmml" xref="S3.SS4.p3.3.m2.1.1.2.2">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.3.m2.1.1.2.2.cmml" xref="S3.SS4.p3.3.m2.1.1.2.2">
            x
           </mtext>
          </ci>
          <minus id="S3.SS4.p3.3.m2.1.1.2.3.cmml" xref="S3.SS4.p3.3.m2.1.1.2.3">
          </minus>
         </apply>
         <apply id="S3.SS4.p3.3.m2.1.1.3.cmml" xref="S3.SS4.p3.3.m2.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS4.p3.3.m2.1.1.3.1.cmml" xref="S3.SS4.p3.3.m2.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.3.m2.1.1.3.2.cmml" xref="S3.SS4.p3.3.m2.1.1.3.2">
           𝒱
          </ci>
          <minus id="S3.SS4.p3.3.m2.1.1.3.3.cmml" xref="S3.SS4.p3.3.m2.1.1.3.3">
          </minus>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.3.m2.1c">
        \textbf{x}^{-}\in\mathcal{V}^{-}
       </annotation>
      </semantics>
     </math>
     , we first extract representations of these chains by performing a weighted average pool over the final layer’s hidden representations of the constituent tokens. We represent these as
     <math alttext="h_{\textbf{x}^{+}}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m3.1">
      <semantics id="S3.SS4.p3.4.m3.1a">
       <mrow id="S3.SS4.p3.4.m3.1.1" xref="S3.SS4.p3.4.m3.1.1.cmml">
        <msub id="S3.SS4.p3.4.m3.1.1.2" xref="S3.SS4.p3.4.m3.1.1.2.cmml">
         <mi id="S3.SS4.p3.4.m3.1.1.2.2" xref="S3.SS4.p3.4.m3.1.1.2.2.cmml">
          h
         </mi>
         <msup id="S3.SS4.p3.4.m3.1.1.2.3" xref="S3.SS4.p3.4.m3.1.1.2.3.cmml">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.4.m3.1.1.2.3.2" xref="S3.SS4.p3.4.m3.1.1.2.3.2a.cmml">
           x
          </mtext>
          <mo id="S3.SS4.p3.4.m3.1.1.2.3.3" xref="S3.SS4.p3.4.m3.1.1.2.3.3.cmml">
           +
          </mo>
         </msup>
        </msub>
        <mo id="S3.SS4.p3.4.m3.1.1.1" xref="S3.SS4.p3.4.m3.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S3.SS4.p3.4.m3.1.1.3" xref="S3.SS4.p3.4.m3.1.1.3.cmml">
         <mi id="S3.SS4.p3.4.m3.1.1.3.2" xref="S3.SS4.p3.4.m3.1.1.3.2.cmml">
          ℝ
         </mi>
         <mi id="S3.SS4.p3.4.m3.1.1.3.3" xref="S3.SS4.p3.4.m3.1.1.3.3.cmml">
          d
         </mi>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m3.1b">
        <apply id="S3.SS4.p3.4.m3.1.1.cmml" xref="S3.SS4.p3.4.m3.1.1">
         <in id="S3.SS4.p3.4.m3.1.1.1.cmml" xref="S3.SS4.p3.4.m3.1.1.1">
         </in>
         <apply id="S3.SS4.p3.4.m3.1.1.2.cmml" xref="S3.SS4.p3.4.m3.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p3.4.m3.1.1.2.1.cmml" xref="S3.SS4.p3.4.m3.1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS4.p3.4.m3.1.1.2.2.cmml" xref="S3.SS4.p3.4.m3.1.1.2.2">
           ℎ
          </ci>
          <apply id="S3.SS4.p3.4.m3.1.1.2.3.cmml" xref="S3.SS4.p3.4.m3.1.1.2.3">
           <csymbol cd="ambiguous" id="S3.SS4.p3.4.m3.1.1.2.3.1.cmml" xref="S3.SS4.p3.4.m3.1.1.2.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p3.4.m3.1.1.2.3.2a.cmml" xref="S3.SS4.p3.4.m3.1.1.2.3.2">
            <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.4.m3.1.1.2.3.2.cmml" mathsize="70%" xref="S3.SS4.p3.4.m3.1.1.2.3.2">
             x
            </mtext>
           </ci>
           <plus id="S3.SS4.p3.4.m3.1.1.2.3.3.cmml" xref="S3.SS4.p3.4.m3.1.1.2.3.3">
           </plus>
          </apply>
         </apply>
         <apply id="S3.SS4.p3.4.m3.1.1.3.cmml" xref="S3.SS4.p3.4.m3.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS4.p3.4.m3.1.1.3.1.cmml" xref="S3.SS4.p3.4.m3.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.4.m3.1.1.3.2.cmml" xref="S3.SS4.p3.4.m3.1.1.3.2">
           ℝ
          </ci>
          <ci id="S3.SS4.p3.4.m3.1.1.3.3.cmml" xref="S3.SS4.p3.4.m3.1.1.3.3">
           𝑑
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.4.m3.1c">
        h_{\textbf{x}^{+}}\in\mathbb{R}^{d}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="h_{\textbf{x}^{-}}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m4.1">
      <semantics id="S3.SS4.p3.5.m4.1a">
       <mrow id="S3.SS4.p3.5.m4.1.1" xref="S3.SS4.p3.5.m4.1.1.cmml">
        <msub id="S3.SS4.p3.5.m4.1.1.2" xref="S3.SS4.p3.5.m4.1.1.2.cmml">
         <mi id="S3.SS4.p3.5.m4.1.1.2.2" xref="S3.SS4.p3.5.m4.1.1.2.2.cmml">
          h
         </mi>
         <msup id="S3.SS4.p3.5.m4.1.1.2.3" xref="S3.SS4.p3.5.m4.1.1.2.3.cmml">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.5.m4.1.1.2.3.2" xref="S3.SS4.p3.5.m4.1.1.2.3.2a.cmml">
           x
          </mtext>
          <mo id="S3.SS4.p3.5.m4.1.1.2.3.3" xref="S3.SS4.p3.5.m4.1.1.2.3.3.cmml">
           −
          </mo>
         </msup>
        </msub>
        <mo id="S3.SS4.p3.5.m4.1.1.1" xref="S3.SS4.p3.5.m4.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S3.SS4.p3.5.m4.1.1.3" xref="S3.SS4.p3.5.m4.1.1.3.cmml">
         <mi id="S3.SS4.p3.5.m4.1.1.3.2" xref="S3.SS4.p3.5.m4.1.1.3.2.cmml">
          ℝ
         </mi>
         <mi id="S3.SS4.p3.5.m4.1.1.3.3" xref="S3.SS4.p3.5.m4.1.1.3.3.cmml">
          d
         </mi>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m4.1b">
        <apply id="S3.SS4.p3.5.m4.1.1.cmml" xref="S3.SS4.p3.5.m4.1.1">
         <in id="S3.SS4.p3.5.m4.1.1.1.cmml" xref="S3.SS4.p3.5.m4.1.1.1">
         </in>
         <apply id="S3.SS4.p3.5.m4.1.1.2.cmml" xref="S3.SS4.p3.5.m4.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p3.5.m4.1.1.2.1.cmml" xref="S3.SS4.p3.5.m4.1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS4.p3.5.m4.1.1.2.2.cmml" xref="S3.SS4.p3.5.m4.1.1.2.2">
           ℎ
          </ci>
          <apply id="S3.SS4.p3.5.m4.1.1.2.3.cmml" xref="S3.SS4.p3.5.m4.1.1.2.3">
           <csymbol cd="ambiguous" id="S3.SS4.p3.5.m4.1.1.2.3.1.cmml" xref="S3.SS4.p3.5.m4.1.1.2.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p3.5.m4.1.1.2.3.2a.cmml" xref="S3.SS4.p3.5.m4.1.1.2.3.2">
            <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.5.m4.1.1.2.3.2.cmml" mathsize="70%" xref="S3.SS4.p3.5.m4.1.1.2.3.2">
             x
            </mtext>
           </ci>
           <minus id="S3.SS4.p3.5.m4.1.1.2.3.3.cmml" xref="S3.SS4.p3.5.m4.1.1.2.3.3">
           </minus>
          </apply>
         </apply>
         <apply id="S3.SS4.p3.5.m4.1.1.3.cmml" xref="S3.SS4.p3.5.m4.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS4.p3.5.m4.1.1.3.1.cmml" xref="S3.SS4.p3.5.m4.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.5.m4.1.1.3.2.cmml" xref="S3.SS4.p3.5.m4.1.1.3.2">
           ℝ
          </ci>
          <ci id="S3.SS4.p3.5.m4.1.1.3.3.cmml" xref="S3.SS4.p3.5.m4.1.1.3.3">
           𝑑
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.5.m4.1c">
        h_{\textbf{x}^{-}}\in\mathbb{R}^{d}
       </annotation>
      </semantics>
     </math>
     respectively where
     <math alttext="d" class="ltx_Math" display="inline" id="S3.SS4.p3.6.m5.1">
      <semantics id="S3.SS4.p3.6.m5.1a">
       <mi id="S3.SS4.p3.6.m5.1.1" xref="S3.SS4.p3.6.m5.1.1.cmml">
        d
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m5.1b">
        <ci id="S3.SS4.p3.6.m5.1.1.cmml" xref="S3.SS4.p3.6.m5.1.1">
         𝑑
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.6.m5.1c">
        d
       </annotation>
      </semantics>
     </math>
     is the embedding dimension. Using a projection matrix and a
     <math alttext="\tanh" class="ltx_Math" display="inline" id="S3.SS4.p3.7.m6.1">
      <semantics id="S3.SS4.p3.7.m6.1a">
       <mi id="S3.SS4.p3.7.m6.1.1" xref="S3.SS4.p3.7.m6.1.1.cmml">
        tanh
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m6.1b">
        <tanh id="S3.SS4.p3.7.m6.1.1.cmml" xref="S3.SS4.p3.7.m6.1.1">
        </tanh>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.7.m6.1c">
        \tanh
       </annotation>
      </semantics>
     </math>
     activation, we further project these embeddings to two scalar scores
     <math alttext="s_{\textbf{x}^{+}}\in[-1,1]" class="ltx_Math" display="inline" id="S3.SS4.p3.8.m7.2">
      <semantics id="S3.SS4.p3.8.m7.2a">
       <mrow id="S3.SS4.p3.8.m7.2.2" xref="S3.SS4.p3.8.m7.2.2.cmml">
        <msub id="S3.SS4.p3.8.m7.2.2.3" xref="S3.SS4.p3.8.m7.2.2.3.cmml">
         <mi id="S3.SS4.p3.8.m7.2.2.3.2" xref="S3.SS4.p3.8.m7.2.2.3.2.cmml">
          s
         </mi>
         <msup id="S3.SS4.p3.8.m7.2.2.3.3" xref="S3.SS4.p3.8.m7.2.2.3.3.cmml">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.8.m7.2.2.3.3.2" xref="S3.SS4.p3.8.m7.2.2.3.3.2a.cmml">
           x
          </mtext>
          <mo id="S3.SS4.p3.8.m7.2.2.3.3.3" xref="S3.SS4.p3.8.m7.2.2.3.3.3.cmml">
           +
          </mo>
         </msup>
        </msub>
        <mo id="S3.SS4.p3.8.m7.2.2.2" xref="S3.SS4.p3.8.m7.2.2.2.cmml">
         ∈
        </mo>
        <mrow id="S3.SS4.p3.8.m7.2.2.1.1" xref="S3.SS4.p3.8.m7.2.2.1.2.cmml">
         <mo id="S3.SS4.p3.8.m7.2.2.1.1.2" stretchy="false" xref="S3.SS4.p3.8.m7.2.2.1.2.cmml">
          [
         </mo>
         <mrow id="S3.SS4.p3.8.m7.2.2.1.1.1" xref="S3.SS4.p3.8.m7.2.2.1.1.1.cmml">
          <mo id="S3.SS4.p3.8.m7.2.2.1.1.1a" xref="S3.SS4.p3.8.m7.2.2.1.1.1.cmml">
           −
          </mo>
          <mn id="S3.SS4.p3.8.m7.2.2.1.1.1.2" xref="S3.SS4.p3.8.m7.2.2.1.1.1.2.cmml">
           1
          </mn>
         </mrow>
         <mo id="S3.SS4.p3.8.m7.2.2.1.1.3" xref="S3.SS4.p3.8.m7.2.2.1.2.cmml">
          ,
         </mo>
         <mn id="S3.SS4.p3.8.m7.1.1" xref="S3.SS4.p3.8.m7.1.1.cmml">
          1
         </mn>
         <mo id="S3.SS4.p3.8.m7.2.2.1.1.4" stretchy="false" xref="S3.SS4.p3.8.m7.2.2.1.2.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.8.m7.2b">
        <apply id="S3.SS4.p3.8.m7.2.2.cmml" xref="S3.SS4.p3.8.m7.2.2">
         <in id="S3.SS4.p3.8.m7.2.2.2.cmml" xref="S3.SS4.p3.8.m7.2.2.2">
         </in>
         <apply id="S3.SS4.p3.8.m7.2.2.3.cmml" xref="S3.SS4.p3.8.m7.2.2.3">
          <csymbol cd="ambiguous" id="S3.SS4.p3.8.m7.2.2.3.1.cmml" xref="S3.SS4.p3.8.m7.2.2.3">
           subscript
          </csymbol>
          <ci id="S3.SS4.p3.8.m7.2.2.3.2.cmml" xref="S3.SS4.p3.8.m7.2.2.3.2">
           𝑠
          </ci>
          <apply id="S3.SS4.p3.8.m7.2.2.3.3.cmml" xref="S3.SS4.p3.8.m7.2.2.3.3">
           <csymbol cd="ambiguous" id="S3.SS4.p3.8.m7.2.2.3.3.1.cmml" xref="S3.SS4.p3.8.m7.2.2.3.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p3.8.m7.2.2.3.3.2a.cmml" xref="S3.SS4.p3.8.m7.2.2.3.3.2">
            <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.8.m7.2.2.3.3.2.cmml" mathsize="70%" xref="S3.SS4.p3.8.m7.2.2.3.3.2">
             x
            </mtext>
           </ci>
           <plus id="S3.SS4.p3.8.m7.2.2.3.3.3.cmml" xref="S3.SS4.p3.8.m7.2.2.3.3.3">
           </plus>
          </apply>
         </apply>
         <interval closure="closed" id="S3.SS4.p3.8.m7.2.2.1.2.cmml" xref="S3.SS4.p3.8.m7.2.2.1.1">
          <apply id="S3.SS4.p3.8.m7.2.2.1.1.1.cmml" xref="S3.SS4.p3.8.m7.2.2.1.1.1">
           <minus id="S3.SS4.p3.8.m7.2.2.1.1.1.1.cmml" xref="S3.SS4.p3.8.m7.2.2.1.1.1">
           </minus>
           <cn id="S3.SS4.p3.8.m7.2.2.1.1.1.2.cmml" type="integer" xref="S3.SS4.p3.8.m7.2.2.1.1.1.2">
            1
           </cn>
          </apply>
          <cn id="S3.SS4.p3.8.m7.1.1.cmml" type="integer" xref="S3.SS4.p3.8.m7.1.1">
           1
          </cn>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.8.m7.2c">
        s_{\textbf{x}^{+}}\in[-1,1]
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="s_{\textbf{x}^{-}}\in[-1,1]" class="ltx_Math" display="inline" id="S3.SS4.p3.9.m8.2">
      <semantics id="S3.SS4.p3.9.m8.2a">
       <mrow id="S3.SS4.p3.9.m8.2.2" xref="S3.SS4.p3.9.m8.2.2.cmml">
        <msub id="S3.SS4.p3.9.m8.2.2.3" xref="S3.SS4.p3.9.m8.2.2.3.cmml">
         <mi id="S3.SS4.p3.9.m8.2.2.3.2" xref="S3.SS4.p3.9.m8.2.2.3.2.cmml">
          s
         </mi>
         <msup id="S3.SS4.p3.9.m8.2.2.3.3" xref="S3.SS4.p3.9.m8.2.2.3.3.cmml">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.9.m8.2.2.3.3.2" xref="S3.SS4.p3.9.m8.2.2.3.3.2a.cmml">
           x
          </mtext>
          <mo id="S3.SS4.p3.9.m8.2.2.3.3.3" xref="S3.SS4.p3.9.m8.2.2.3.3.3.cmml">
           −
          </mo>
         </msup>
        </msub>
        <mo id="S3.SS4.p3.9.m8.2.2.2" xref="S3.SS4.p3.9.m8.2.2.2.cmml">
         ∈
        </mo>
        <mrow id="S3.SS4.p3.9.m8.2.2.1.1" xref="S3.SS4.p3.9.m8.2.2.1.2.cmml">
         <mo id="S3.SS4.p3.9.m8.2.2.1.1.2" stretchy="false" xref="S3.SS4.p3.9.m8.2.2.1.2.cmml">
          [
         </mo>
         <mrow id="S3.SS4.p3.9.m8.2.2.1.1.1" xref="S3.SS4.p3.9.m8.2.2.1.1.1.cmml">
          <mo id="S3.SS4.p3.9.m8.2.2.1.1.1a" xref="S3.SS4.p3.9.m8.2.2.1.1.1.cmml">
           −
          </mo>
          <mn id="S3.SS4.p3.9.m8.2.2.1.1.1.2" xref="S3.SS4.p3.9.m8.2.2.1.1.1.2.cmml">
           1
          </mn>
         </mrow>
         <mo id="S3.SS4.p3.9.m8.2.2.1.1.3" xref="S3.SS4.p3.9.m8.2.2.1.2.cmml">
          ,
         </mo>
         <mn id="S3.SS4.p3.9.m8.1.1" xref="S3.SS4.p3.9.m8.1.1.cmml">
          1
         </mn>
         <mo id="S3.SS4.p3.9.m8.2.2.1.1.4" stretchy="false" xref="S3.SS4.p3.9.m8.2.2.1.2.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.9.m8.2b">
        <apply id="S3.SS4.p3.9.m8.2.2.cmml" xref="S3.SS4.p3.9.m8.2.2">
         <in id="S3.SS4.p3.9.m8.2.2.2.cmml" xref="S3.SS4.p3.9.m8.2.2.2">
         </in>
         <apply id="S3.SS4.p3.9.m8.2.2.3.cmml" xref="S3.SS4.p3.9.m8.2.2.3">
          <csymbol cd="ambiguous" id="S3.SS4.p3.9.m8.2.2.3.1.cmml" xref="S3.SS4.p3.9.m8.2.2.3">
           subscript
          </csymbol>
          <ci id="S3.SS4.p3.9.m8.2.2.3.2.cmml" xref="S3.SS4.p3.9.m8.2.2.3.2">
           𝑠
          </ci>
          <apply id="S3.SS4.p3.9.m8.2.2.3.3.cmml" xref="S3.SS4.p3.9.m8.2.2.3.3">
           <csymbol cd="ambiguous" id="S3.SS4.p3.9.m8.2.2.3.3.1.cmml" xref="S3.SS4.p3.9.m8.2.2.3.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p3.9.m8.2.2.3.3.2a.cmml" xref="S3.SS4.p3.9.m8.2.2.3.3.2">
            <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.9.m8.2.2.3.3.2.cmml" mathsize="70%" xref="S3.SS4.p3.9.m8.2.2.3.3.2">
             x
            </mtext>
           </ci>
           <minus id="S3.SS4.p3.9.m8.2.2.3.3.3.cmml" xref="S3.SS4.p3.9.m8.2.2.3.3.3">
           </minus>
          </apply>
         </apply>
         <interval closure="closed" id="S3.SS4.p3.9.m8.2.2.1.2.cmml" xref="S3.SS4.p3.9.m8.2.2.1.1">
          <apply id="S3.SS4.p3.9.m8.2.2.1.1.1.cmml" xref="S3.SS4.p3.9.m8.2.2.1.1.1">
           <minus id="S3.SS4.p3.9.m8.2.2.1.1.1.1.cmml" xref="S3.SS4.p3.9.m8.2.2.1.1.1">
           </minus>
           <cn id="S3.SS4.p3.9.m8.2.2.1.1.1.2.cmml" type="integer" xref="S3.SS4.p3.9.m8.2.2.1.1.1.2">
            1
           </cn>
          </apply>
          <cn id="S3.SS4.p3.9.m8.1.1.cmml" type="integer" xref="S3.SS4.p3.9.m8.1.1">
           1
          </cn>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.9.m8.2c">
        s_{\textbf{x}^{-}}\in[-1,1]
       </annotation>
      </semantics>
     </math>
     .
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.11.4">
      MAGDi
     </span>
     then optimizes for the following margin-based objective
     <cite class="ltx_cite ltx_citemacro_cite">
      Cortes &amp; Vapnik (
      <a class="ltx_ref" href="#bib.bib14" title="">
       1995
      </a>
      )
     </cite>
     for pairs of positive and negative chains {
     <math alttext="\textbf{x}^{+},\textbf{x}^{-}" class="ltx_Math" display="inline" id="S3.SS4.p3.10.m9.2">
      <semantics id="S3.SS4.p3.10.m9.2a">
       <mrow id="S3.SS4.p3.10.m9.2.2.2" xref="S3.SS4.p3.10.m9.2.2.3.cmml">
        <msup id="S3.SS4.p3.10.m9.1.1.1.1" xref="S3.SS4.p3.10.m9.1.1.1.1.cmml">
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.10.m9.1.1.1.1.2" xref="S3.SS4.p3.10.m9.1.1.1.1.2a.cmml">
          x
         </mtext>
         <mo id="S3.SS4.p3.10.m9.1.1.1.1.3" xref="S3.SS4.p3.10.m9.1.1.1.1.3.cmml">
          +
         </mo>
        </msup>
        <mo id="S3.SS4.p3.10.m9.2.2.2.3" xref="S3.SS4.p3.10.m9.2.2.3.cmml">
         ,
        </mo>
        <msup id="S3.SS4.p3.10.m9.2.2.2.2" xref="S3.SS4.p3.10.m9.2.2.2.2.cmml">
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.10.m9.2.2.2.2.2" xref="S3.SS4.p3.10.m9.2.2.2.2.2a.cmml">
          x
         </mtext>
         <mo id="S3.SS4.p3.10.m9.2.2.2.2.3" xref="S3.SS4.p3.10.m9.2.2.2.2.3.cmml">
          −
         </mo>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.10.m9.2b">
        <list id="S3.SS4.p3.10.m9.2.2.3.cmml" xref="S3.SS4.p3.10.m9.2.2.2">
         <apply id="S3.SS4.p3.10.m9.1.1.1.1.cmml" xref="S3.SS4.p3.10.m9.1.1.1.1">
          <csymbol cd="ambiguous" id="S3.SS4.p3.10.m9.1.1.1.1.1.cmml" xref="S3.SS4.p3.10.m9.1.1.1.1">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.10.m9.1.1.1.1.2a.cmml" xref="S3.SS4.p3.10.m9.1.1.1.1.2">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.10.m9.1.1.1.1.2.cmml" xref="S3.SS4.p3.10.m9.1.1.1.1.2">
            x
           </mtext>
          </ci>
          <plus id="S3.SS4.p3.10.m9.1.1.1.1.3.cmml" xref="S3.SS4.p3.10.m9.1.1.1.1.3">
          </plus>
         </apply>
         <apply id="S3.SS4.p3.10.m9.2.2.2.2.cmml" xref="S3.SS4.p3.10.m9.2.2.2.2">
          <csymbol cd="ambiguous" id="S3.SS4.p3.10.m9.2.2.2.2.1.cmml" xref="S3.SS4.p3.10.m9.2.2.2.2">
           superscript
          </csymbol>
          <ci id="S3.SS4.p3.10.m9.2.2.2.2.2a.cmml" xref="S3.SS4.p3.10.m9.2.2.2.2.2">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p3.10.m9.2.2.2.2.2.cmml" xref="S3.SS4.p3.10.m9.2.2.2.2.2">
            x
           </mtext>
          </ci>
          <minus id="S3.SS4.p3.10.m9.2.2.2.2.3.cmml" xref="S3.SS4.p3.10.m9.2.2.2.2.3">
          </minus>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.10.m9.2c">
        \textbf{x}^{+},\textbf{x}^{-}
       </annotation>
      </semantics>
     </math>
     }
     <math alttext="\in\mathcal{V}^{+}\times\mathcal{V}^{-}" class="ltx_Math" display="inline" id="S3.SS4.p3.11.m10.1">
      <semantics id="S3.SS4.p3.11.m10.1a">
       <mrow id="S3.SS4.p3.11.m10.1.1" xref="S3.SS4.p3.11.m10.1.1.cmml">
        <mi id="S3.SS4.p3.11.m10.1.1.2" xref="S3.SS4.p3.11.m10.1.1.2.cmml">
        </mi>
        <mo id="S3.SS4.p3.11.m10.1.1.1" xref="S3.SS4.p3.11.m10.1.1.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS4.p3.11.m10.1.1.3" xref="S3.SS4.p3.11.m10.1.1.3.cmml">
         <msup id="S3.SS4.p3.11.m10.1.1.3.2" xref="S3.SS4.p3.11.m10.1.1.3.2.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.11.m10.1.1.3.2.2" xref="S3.SS4.p3.11.m10.1.1.3.2.2.cmml">
           𝒱
          </mi>
          <mo id="S3.SS4.p3.11.m10.1.1.3.2.3" xref="S3.SS4.p3.11.m10.1.1.3.2.3.cmml">
           +
          </mo>
         </msup>
         <mo id="S3.SS4.p3.11.m10.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.11.m10.1.1.3.1.cmml">
          ×
         </mo>
         <msup id="S3.SS4.p3.11.m10.1.1.3.3" xref="S3.SS4.p3.11.m10.1.1.3.3.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.11.m10.1.1.3.3.2" xref="S3.SS4.p3.11.m10.1.1.3.3.2.cmml">
           𝒱
          </mi>
          <mo id="S3.SS4.p3.11.m10.1.1.3.3.3" xref="S3.SS4.p3.11.m10.1.1.3.3.3.cmml">
           −
          </mo>
         </msup>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.11.m10.1b">
        <apply id="S3.SS4.p3.11.m10.1.1.cmml" xref="S3.SS4.p3.11.m10.1.1">
         <in id="S3.SS4.p3.11.m10.1.1.1.cmml" xref="S3.SS4.p3.11.m10.1.1.1">
         </in>
         <csymbol cd="latexml" id="S3.SS4.p3.11.m10.1.1.2.cmml" xref="S3.SS4.p3.11.m10.1.1.2">
          absent
         </csymbol>
         <apply id="S3.SS4.p3.11.m10.1.1.3.cmml" xref="S3.SS4.p3.11.m10.1.1.3">
          <times id="S3.SS4.p3.11.m10.1.1.3.1.cmml" xref="S3.SS4.p3.11.m10.1.1.3.1">
          </times>
          <apply id="S3.SS4.p3.11.m10.1.1.3.2.cmml" xref="S3.SS4.p3.11.m10.1.1.3.2">
           <csymbol cd="ambiguous" id="S3.SS4.p3.11.m10.1.1.3.2.1.cmml" xref="S3.SS4.p3.11.m10.1.1.3.2">
            superscript
           </csymbol>
           <ci id="S3.SS4.p3.11.m10.1.1.3.2.2.cmml" xref="S3.SS4.p3.11.m10.1.1.3.2.2">
            𝒱
           </ci>
           <plus id="S3.SS4.p3.11.m10.1.1.3.2.3.cmml" xref="S3.SS4.p3.11.m10.1.1.3.2.3">
           </plus>
          </apply>
          <apply id="S3.SS4.p3.11.m10.1.1.3.3.cmml" xref="S3.SS4.p3.11.m10.1.1.3.3">
           <csymbol cd="ambiguous" id="S3.SS4.p3.11.m10.1.1.3.3.1.cmml" xref="S3.SS4.p3.11.m10.1.1.3.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p3.11.m10.1.1.3.3.2.cmml" xref="S3.SS4.p3.11.m10.1.1.3.3.2">
            𝒱
           </ci>
           <minus id="S3.SS4.p3.11.m10.1.1.3.3.3.cmml" xref="S3.SS4.p3.11.m10.1.1.3.3.3">
           </minus>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.11.m10.1c">
        \in\mathcal{V}^{+}\times\mathcal{V}^{-}
       </annotation>
      </semantics>
     </math>
     in a MAG (see Fig.
     <a class="ltx_ref" href="#S1.F3" title="Figure 3 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ‘Learning from Negative Reasoning’).
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S3.E2">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\mathcal{L}^{-}=\sum_{\textbf{x}^{+}\in\mathcal{V}^{+}}\sum_{\textbf{x}^{-}\in\mathcal{V}^{-}}\max(0,\rho-s_{\textbf{x}^{+}}+s_{\textbf{x}^{-}})" class="ltx_Math" display="block" id="S3.E2.m1.3">
         <semantics id="S3.E2.m1.3a">
          <mrow id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">
           <msup id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml">
            <mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.3.2" xref="S3.E2.m1.3.3.3.2.cmml">
             ℒ
            </mi>
            <mo id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml">
             −
            </mo>
           </msup>
           <mo id="S3.E2.m1.3.3.2" rspace="0.111em" xref="S3.E2.m1.3.3.2.cmml">
            =
           </mo>
           <mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.cmml">
            <munder id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.2.cmml">
             <mo id="S3.E2.m1.3.3.1.2.2" movablelimits="false" rspace="0em" xref="S3.E2.m1.3.3.1.2.2.cmml">
              ∑
             </mo>
             <mrow id="S3.E2.m1.3.3.1.2.3" xref="S3.E2.m1.3.3.1.2.3.cmml">
              <msup id="S3.E2.m1.3.3.1.2.3.2" xref="S3.E2.m1.3.3.1.2.3.2.cmml">
               <mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.2.3.2.2" xref="S3.E2.m1.3.3.1.2.3.2.2a.cmml">
                x
               </mtext>
               <mo id="S3.E2.m1.3.3.1.2.3.2.3" xref="S3.E2.m1.3.3.1.2.3.2.3.cmml">
                +
               </mo>
              </msup>
              <mo id="S3.E2.m1.3.3.1.2.3.1" xref="S3.E2.m1.3.3.1.2.3.1.cmml">
               ∈
              </mo>
              <msup id="S3.E2.m1.3.3.1.2.3.3" xref="S3.E2.m1.3.3.1.2.3.3.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.1.2.3.3.2" xref="S3.E2.m1.3.3.1.2.3.3.2.cmml">
                𝒱
               </mi>
               <mo id="S3.E2.m1.3.3.1.2.3.3.3" xref="S3.E2.m1.3.3.1.2.3.3.3.cmml">
                +
               </mo>
              </msup>
             </mrow>
            </munder>
            <mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">
             <munder id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml">
              <mo id="S3.E2.m1.3.3.1.1.2.2" movablelimits="false" xref="S3.E2.m1.3.3.1.1.2.2.cmml">
               ∑
              </mo>
              <mrow id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">
               <msup id="S3.E2.m1.3.3.1.1.2.3.2" xref="S3.E2.m1.3.3.1.1.2.3.2.cmml">
                <mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.2.3.2.2" xref="S3.E2.m1.3.3.1.1.2.3.2.2a.cmml">
                 x
                </mtext>
                <mo id="S3.E2.m1.3.3.1.1.2.3.2.3" xref="S3.E2.m1.3.3.1.1.2.3.2.3.cmml">
                 −
                </mo>
               </msup>
               <mo id="S3.E2.m1.3.3.1.1.2.3.1" xref="S3.E2.m1.3.3.1.1.2.3.1.cmml">
                ∈
               </mo>
               <msup id="S3.E2.m1.3.3.1.1.2.3.3" xref="S3.E2.m1.3.3.1.1.2.3.3.cmml">
                <mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.1.1.2.3.3.2" xref="S3.E2.m1.3.3.1.1.2.3.3.2.cmml">
                 𝒱
                </mi>
                <mo id="S3.E2.m1.3.3.1.1.2.3.3.3" xref="S3.E2.m1.3.3.1.1.2.3.3.3.cmml">
                 −
                </mo>
               </msup>
              </mrow>
             </munder>
             <mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.2.cmml">
              <mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">
               max
              </mi>
              <mo id="S3.E2.m1.3.3.1.1.1.1a" xref="S3.E2.m1.3.3.1.1.1.2.cmml">
               ⁡
              </mo>
              <mrow id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.2.cmml">
               <mo id="S3.E2.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.2.cmml">
                (
               </mo>
               <mn id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">
                0
               </mn>
               <mo id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.2.cmml">
                ,
               </mo>
               <mrow id="S3.E2.m1.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml">
                <mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml">
                 <mi id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.cmml">
                  ρ
                 </mi>
                 <mo id="S3.E2.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.1.cmml">
                  −
                 </mo>
                 <msub id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml">
                  <mi id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">
                   s
                  </mi>
                  <msup id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">
                   <mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.2a.cmml">
                    x
                   </mtext>
                   <mo id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.3.cmml">
                    +
                   </mo>
                  </msup>
                 </msub>
                </mrow>
                <mo id="S3.E2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml">
                 +
                </mo>
                <msub id="S3.E2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.cmml">
                 <mi id="S3.E2.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.2.cmml">
                  s
                 </mi>
                 <msup id="S3.E2.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.cmml">
                  <mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.2a.cmml">
                   x
                  </mtext>
                  <mo id="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.3.cmml">
                   −
                  </mo>
                 </msup>
                </msub>
               </mrow>
               <mo id="S3.E2.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b">
           <apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">
            <eq id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2">
            </eq>
            <apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3">
             <csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3">
              superscript
             </csymbol>
             <ci id="S3.E2.m1.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.2">
              ℒ
             </ci>
             <minus id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3">
             </minus>
            </apply>
            <apply id="S3.E2.m1.3.3.1.cmml" xref="S3.E2.m1.3.3.1">
             <apply id="S3.E2.m1.3.3.1.2.cmml" xref="S3.E2.m1.3.3.1.2">
              <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.2.1.cmml" xref="S3.E2.m1.3.3.1.2">
               subscript
              </csymbol>
              <sum id="S3.E2.m1.3.3.1.2.2.cmml" xref="S3.E2.m1.3.3.1.2.2">
              </sum>
              <apply id="S3.E2.m1.3.3.1.2.3.cmml" xref="S3.E2.m1.3.3.1.2.3">
               <in id="S3.E2.m1.3.3.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.2.3.1">
               </in>
               <apply id="S3.E2.m1.3.3.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.2.3.2">
                <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.2.3.2.1.cmml" xref="S3.E2.m1.3.3.1.2.3.2">
                 superscript
                </csymbol>
                <ci id="S3.E2.m1.3.3.1.2.3.2.2a.cmml" xref="S3.E2.m1.3.3.1.2.3.2.2">
                 <mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.2.3.2.2.cmml" mathsize="70%" xref="S3.E2.m1.3.3.1.2.3.2.2">
                  x
                 </mtext>
                </ci>
                <plus id="S3.E2.m1.3.3.1.2.3.2.3.cmml" xref="S3.E2.m1.3.3.1.2.3.2.3">
                </plus>
               </apply>
               <apply id="S3.E2.m1.3.3.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.2.3.3">
                <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.2.3.3.1.cmml" xref="S3.E2.m1.3.3.1.2.3.3">
                 superscript
                </csymbol>
                <ci id="S3.E2.m1.3.3.1.2.3.3.2.cmml" xref="S3.E2.m1.3.3.1.2.3.3.2">
                 𝒱
                </ci>
                <plus id="S3.E2.m1.3.3.1.2.3.3.3.cmml" xref="S3.E2.m1.3.3.1.2.3.3.3">
                </plus>
               </apply>
              </apply>
             </apply>
             <apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">
              <apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2">
               <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2">
                subscript
               </csymbol>
               <sum id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2">
               </sum>
               <apply id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3">
                <in id="S3.E2.m1.3.3.1.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.3.1">
                </in>
                <apply id="S3.E2.m1.3.3.1.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.3.2">
                 <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.3.2">
                  superscript
                 </csymbol>
                 <ci id="S3.E2.m1.3.3.1.1.2.3.2.2a.cmml" xref="S3.E2.m1.3.3.1.1.2.3.2.2">
                  <mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.2.3.2.2.cmml" mathsize="70%" xref="S3.E2.m1.3.3.1.1.2.3.2.2">
                   x
                  </mtext>
                 </ci>
                 <minus id="S3.E2.m1.3.3.1.1.2.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3.2.3">
                 </minus>
                </apply>
                <apply id="S3.E2.m1.3.3.1.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3.3">
                 <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.3.3">
                  superscript
                 </csymbol>
                 <ci id="S3.E2.m1.3.3.1.1.2.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.3.3.2">
                  𝒱
                 </ci>
                 <minus id="S3.E2.m1.3.3.1.1.2.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3.3.3">
                 </minus>
                </apply>
               </apply>
              </apply>
              <apply id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1">
               <max id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">
               </max>
               <cn id="S3.E2.m1.2.2.cmml" type="integer" xref="S3.E2.m1.2.2">
                0
               </cn>
               <apply id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1">
                <plus id="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1">
                </plus>
                <apply id="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2">
                 <minus id="S3.E2.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.1">
                 </minus>
                 <ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2">
                  𝜌
                 </ci>
                 <apply id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3">
                  <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3">
                   subscript
                  </csymbol>
                  <ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.2">
                   𝑠
                  </ci>
                  <apply id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3">
                   <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3">
                    superscript
                   </csymbol>
                   <ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.2a.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.2">
                    <mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.2.cmml" mathsize="70%" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.2">
                     x
                    </mtext>
                   </ci>
                   <plus id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.3">
                   </plus>
                  </apply>
                 </apply>
                </apply>
                <apply id="S3.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="S3.E2.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.2">
                  𝑠
                 </ci>
                 <apply id="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.3">
                  <csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.3">
                   superscript
                  </csymbol>
                  <ci id="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.2a.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.2">
                   <mtext class="ltx_mathvariant_bold" id="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" mathsize="70%" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.2">
                    x
                   </mtext>
                  </ci>
                  <minus id="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.3.3">
                  </minus>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E2.m1.3c">
           \mathcal{L}^{-}=\sum_{\textbf{x}^{+}\in\mathcal{V}^{+}}\sum_{\textbf{x}^{-}\in\mathcal{V}^{-}}\max(0,\rho-s_{\textbf{x}^{+}}+s_{\textbf{x}^{-}})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS4.p3.12">
     where
     <math alttext="\rho\in[-1,1]" class="ltx_Math" display="inline" id="S3.SS4.p3.12.m1.2">
      <semantics id="S3.SS4.p3.12.m1.2a">
       <mrow id="S3.SS4.p3.12.m1.2.2" xref="S3.SS4.p3.12.m1.2.2.cmml">
        <mi id="S3.SS4.p3.12.m1.2.2.3" xref="S3.SS4.p3.12.m1.2.2.3.cmml">
         ρ
        </mi>
        <mo id="S3.SS4.p3.12.m1.2.2.2" xref="S3.SS4.p3.12.m1.2.2.2.cmml">
         ∈
        </mo>
        <mrow id="S3.SS4.p3.12.m1.2.2.1.1" xref="S3.SS4.p3.12.m1.2.2.1.2.cmml">
         <mo id="S3.SS4.p3.12.m1.2.2.1.1.2" stretchy="false" xref="S3.SS4.p3.12.m1.2.2.1.2.cmml">
          [
         </mo>
         <mrow id="S3.SS4.p3.12.m1.2.2.1.1.1" xref="S3.SS4.p3.12.m1.2.2.1.1.1.cmml">
          <mo id="S3.SS4.p3.12.m1.2.2.1.1.1a" xref="S3.SS4.p3.12.m1.2.2.1.1.1.cmml">
           −
          </mo>
          <mn id="S3.SS4.p3.12.m1.2.2.1.1.1.2" xref="S3.SS4.p3.12.m1.2.2.1.1.1.2.cmml">
           1
          </mn>
         </mrow>
         <mo id="S3.SS4.p3.12.m1.2.2.1.1.3" xref="S3.SS4.p3.12.m1.2.2.1.2.cmml">
          ,
         </mo>
         <mn id="S3.SS4.p3.12.m1.1.1" xref="S3.SS4.p3.12.m1.1.1.cmml">
          1
         </mn>
         <mo id="S3.SS4.p3.12.m1.2.2.1.1.4" stretchy="false" xref="S3.SS4.p3.12.m1.2.2.1.2.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.12.m1.2b">
        <apply id="S3.SS4.p3.12.m1.2.2.cmml" xref="S3.SS4.p3.12.m1.2.2">
         <in id="S3.SS4.p3.12.m1.2.2.2.cmml" xref="S3.SS4.p3.12.m1.2.2.2">
         </in>
         <ci id="S3.SS4.p3.12.m1.2.2.3.cmml" xref="S3.SS4.p3.12.m1.2.2.3">
          𝜌
         </ci>
         <interval closure="closed" id="S3.SS4.p3.12.m1.2.2.1.2.cmml" xref="S3.SS4.p3.12.m1.2.2.1.1">
          <apply id="S3.SS4.p3.12.m1.2.2.1.1.1.cmml" xref="S3.SS4.p3.12.m1.2.2.1.1.1">
           <minus id="S3.SS4.p3.12.m1.2.2.1.1.1.1.cmml" xref="S3.SS4.p3.12.m1.2.2.1.1.1">
           </minus>
           <cn id="S3.SS4.p3.12.m1.2.2.1.1.1.2.cmml" type="integer" xref="S3.SS4.p3.12.m1.2.2.1.1.1.2">
            1
           </cn>
          </apply>
          <cn id="S3.SS4.p3.12.m1.1.1.cmml" type="integer" xref="S3.SS4.p3.12.m1.1.1">
           1
          </cn>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.12.m1.2c">
        \rho\in[-1,1]
       </annotation>
      </semantics>
     </math>
     is the margin (set to 1 in our experiments).
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p4">
    <p class="ltx_p" id="S3.SS4.p4.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p4.1.1">
      Objective 3: Learning from Interaction.
     </span>
     Beyond distillation from the correct and incorrect nodes,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p4.1.2">
      MAGDi
     </span>
     is also intended to distill from the entire conversational
     <em class="ltx_emph ltx_font_italic" id="S3.SS4.p4.1.3">
      structure
     </em>
     present in the teachers’ discussion. This would allow the student model to summarize the discussion process and acquire knowledge of how a teacher refines its reasoning chain in each discussion round. Hence, while the previous two objectives assumed nodes to be a disconnected set,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p4.1.4">
      MAGDi
     </span>
     removes this assumption by also modeling the edges.
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p4.1.5">
      MAGDi
     </span>
     achieves this by augmenting the base student model with a Graph Convolution Network (GCN) module
     <cite class="ltx_cite ltx_citemacro_cite">
      Kipf &amp; Welling (
      <a class="ltx_ref" href="#bib.bib25" title="">
       2017
      </a>
      )
     </cite>
     . The goal of the GCN is to learn improved, ‘structure-aware’ representations of reasoning chains (nodes) such that the student model learns to discriminate between correct and incorrect nodes in a MAG, eventually leading to better generation of reasoning chains.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p5">
    <p class="ltx_p" id="S3.SS4.p5.2">
     Given any positive or negative node
     <math alttext="\textbf{x}\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS4.p5.1.m1.1">
      <semantics id="S3.SS4.p5.1.m1.1a">
       <mrow id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml">
        <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.1.m1.1.1.2" xref="S3.SS4.p5.1.m1.1.1.2a.cmml">
         x
        </mtext>
        <mo id="S3.SS4.p5.1.m1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.1.m1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.3.cmml">
         𝒱
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b">
        <apply id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1">
         <in id="S3.SS4.p5.1.m1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1">
         </in>
         <ci id="S3.SS4.p5.1.m1.1.1.2a.cmml" xref="S3.SS4.p5.1.m1.1.1.2">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.1.m1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.2">
           x
          </mtext>
         </ci>
         <ci id="S3.SS4.p5.1.m1.1.1.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3">
          𝒱
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">
        \textbf{x}\in\mathcal{V}
       </annotation>
      </semantics>
     </math>
     ,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p5.2.1">
      MAGDi
     </span>
     generates a node representation
     <math alttext="h_{\textbf{x}}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS4.p5.2.m2.1">
      <semantics id="S3.SS4.p5.2.m2.1a">
       <mrow id="S3.SS4.p5.2.m2.1.1" xref="S3.SS4.p5.2.m2.1.1.cmml">
        <msub id="S3.SS4.p5.2.m2.1.1.2" xref="S3.SS4.p5.2.m2.1.1.2.cmml">
         <mi id="S3.SS4.p5.2.m2.1.1.2.2" xref="S3.SS4.p5.2.m2.1.1.2.2.cmml">
          h
         </mi>
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.2.m2.1.1.2.3" xref="S3.SS4.p5.2.m2.1.1.2.3a.cmml">
          x
         </mtext>
        </msub>
        <mo id="S3.SS4.p5.2.m2.1.1.1" xref="S3.SS4.p5.2.m2.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S3.SS4.p5.2.m2.1.1.3" xref="S3.SS4.p5.2.m2.1.1.3.cmml">
         <mi id="S3.SS4.p5.2.m2.1.1.3.2" xref="S3.SS4.p5.2.m2.1.1.3.2.cmml">
          ℝ
         </mi>
         <mi id="S3.SS4.p5.2.m2.1.1.3.3" xref="S3.SS4.p5.2.m2.1.1.3.3.cmml">
          d
         </mi>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b">
        <apply id="S3.SS4.p5.2.m2.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1">
         <in id="S3.SS4.p5.2.m2.1.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1.1">
         </in>
         <apply id="S3.SS4.p5.2.m2.1.1.2.cmml" xref="S3.SS4.p5.2.m2.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.1.1.2.1.cmml" xref="S3.SS4.p5.2.m2.1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS4.p5.2.m2.1.1.2.2.cmml" xref="S3.SS4.p5.2.m2.1.1.2.2">
           ℎ
          </ci>
          <ci id="S3.SS4.p5.2.m2.1.1.2.3a.cmml" xref="S3.SS4.p5.2.m2.1.1.2.3">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p5.2.m2.1.1.2.3">
            x
           </mtext>
          </ci>
         </apply>
         <apply id="S3.SS4.p5.2.m2.1.1.3.cmml" xref="S3.SS4.p5.2.m2.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.1.1.3.1.cmml" xref="S3.SS4.p5.2.m2.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS4.p5.2.m2.1.1.3.2.cmml" xref="S3.SS4.p5.2.m2.1.1.3.2">
           ℝ
          </ci>
          <ci id="S3.SS4.p5.2.m2.1.1.3.3.cmml" xref="S3.SS4.p5.2.m2.1.1.3.3">
           𝑑
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">
        h_{\textbf{x}}\in\mathbb{R}^{d}
       </annotation>
      </semantics>
     </math>
     from the base LM. It then learns structure-aware representations of these nodes with a two-layer GCN
using the following equation:
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="h^{(l+1)}_{\textbf{x}}=\sigma(D^{-1}Mh^{(l)}_{\textbf{x}}W^{(l)})" class="ltx_Math" display="block" id="S3.Ex1.m1.4">
         <semantics id="S3.Ex1.m1.4a">
          <mrow id="S3.Ex1.m1.4.4" xref="S3.Ex1.m1.4.4.cmml">
           <msubsup id="S3.Ex1.m1.4.4.3" xref="S3.Ex1.m1.4.4.3.cmml">
            <mi id="S3.Ex1.m1.4.4.3.2.2" xref="S3.Ex1.m1.4.4.3.2.2.cmml">
             h
            </mi>
            <mtext class="ltx_mathvariant_bold" id="S3.Ex1.m1.4.4.3.3" xref="S3.Ex1.m1.4.4.3.3a.cmml">
             x
            </mtext>
            <mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml">
             <mo id="S3.Ex1.m1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml">
              <mi id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.2.cmml">
               l
              </mi>
              <mo id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">
               +
              </mo>
              <mn id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.3.cmml">
               1
              </mn>
             </mrow>
             <mo id="S3.Ex1.m1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </msubsup>
           <mo id="S3.Ex1.m1.4.4.2" xref="S3.Ex1.m1.4.4.2.cmml">
            =
           </mo>
           <mrow id="S3.Ex1.m1.4.4.1" xref="S3.Ex1.m1.4.4.1.cmml">
            <mi id="S3.Ex1.m1.4.4.1.3" xref="S3.Ex1.m1.4.4.1.3.cmml">
             σ
            </mi>
            <mo id="S3.Ex1.m1.4.4.1.2" lspace="0em" rspace="0em" xref="S3.Ex1.m1.4.4.1.2.cmml">
             ​
            </mo>
            <mrow id="S3.Ex1.m1.4.4.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.cmml">
             <mo id="S3.Ex1.m1.4.4.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.4.4.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="S3.Ex1.m1.4.4.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.cmml">
              <msup id="S3.Ex1.m1.4.4.1.1.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.1.2.cmml">
               <mi id="S3.Ex1.m1.4.4.1.1.1.1.2.2" xref="S3.Ex1.m1.4.4.1.1.1.1.2.2.cmml">
                D
               </mi>
               <mrow id="S3.Ex1.m1.4.4.1.1.1.1.2.3" xref="S3.Ex1.m1.4.4.1.1.1.1.2.3.cmml">
                <mo id="S3.Ex1.m1.4.4.1.1.1.1.2.3a" xref="S3.Ex1.m1.4.4.1.1.1.1.2.3.cmml">
                 −
                </mo>
                <mn id="S3.Ex1.m1.4.4.1.1.1.1.2.3.2" xref="S3.Ex1.m1.4.4.1.1.1.1.2.3.2.cmml">
                 1
                </mn>
               </mrow>
              </msup>
              <mo id="S3.Ex1.m1.4.4.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.Ex1.m1.4.4.1.1.1.1.1.cmml">
               ​
              </mo>
              <mi id="S3.Ex1.m1.4.4.1.1.1.1.3" xref="S3.Ex1.m1.4.4.1.1.1.1.3.cmml">
               M
              </mi>
              <mo id="S3.Ex1.m1.4.4.1.1.1.1.1a" lspace="0em" rspace="0em" xref="S3.Ex1.m1.4.4.1.1.1.1.1.cmml">
               ​
              </mo>
              <msubsup id="S3.Ex1.m1.4.4.1.1.1.1.4" xref="S3.Ex1.m1.4.4.1.1.1.1.4.cmml">
               <mi id="S3.Ex1.m1.4.4.1.1.1.1.4.2.2" xref="S3.Ex1.m1.4.4.1.1.1.1.4.2.2.cmml">
                h
               </mi>
               <mtext class="ltx_mathvariant_bold" id="S3.Ex1.m1.4.4.1.1.1.1.4.3" xref="S3.Ex1.m1.4.4.1.1.1.1.4.3a.cmml">
                x
               </mtext>
               <mrow id="S3.Ex1.m1.2.2.1.3" xref="S3.Ex1.m1.4.4.1.1.1.1.4.cmml">
                <mo id="S3.Ex1.m1.2.2.1.3.1" stretchy="false" xref="S3.Ex1.m1.4.4.1.1.1.1.4.cmml">
                 (
                </mo>
                <mi id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.1.cmml">
                 l
                </mi>
                <mo id="S3.Ex1.m1.2.2.1.3.2" stretchy="false" xref="S3.Ex1.m1.4.4.1.1.1.1.4.cmml">
                 )
                </mo>
               </mrow>
              </msubsup>
              <mo id="S3.Ex1.m1.4.4.1.1.1.1.1b" lspace="0em" rspace="0em" xref="S3.Ex1.m1.4.4.1.1.1.1.1.cmml">
               ​
              </mo>
              <msup id="S3.Ex1.m1.4.4.1.1.1.1.5" xref="S3.Ex1.m1.4.4.1.1.1.1.5.cmml">
               <mi id="S3.Ex1.m1.4.4.1.1.1.1.5.2" xref="S3.Ex1.m1.4.4.1.1.1.1.5.2.cmml">
                W
               </mi>
               <mrow id="S3.Ex1.m1.3.3.1.3" xref="S3.Ex1.m1.4.4.1.1.1.1.5.cmml">
                <mo id="S3.Ex1.m1.3.3.1.3.1" stretchy="false" xref="S3.Ex1.m1.4.4.1.1.1.1.5.cmml">
                 (
                </mo>
                <mi id="S3.Ex1.m1.3.3.1.1" xref="S3.Ex1.m1.3.3.1.1.cmml">
                 l
                </mi>
                <mo id="S3.Ex1.m1.3.3.1.3.2" stretchy="false" xref="S3.Ex1.m1.4.4.1.1.1.1.5.cmml">
                 )
                </mo>
               </mrow>
              </msup>
             </mrow>
             <mo id="S3.Ex1.m1.4.4.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.4.4.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.4b">
           <apply id="S3.Ex1.m1.4.4.cmml" xref="S3.Ex1.m1.4.4">
            <eq id="S3.Ex1.m1.4.4.2.cmml" xref="S3.Ex1.m1.4.4.2">
            </eq>
            <apply id="S3.Ex1.m1.4.4.3.cmml" xref="S3.Ex1.m1.4.4.3">
             <csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.3.1.cmml" xref="S3.Ex1.m1.4.4.3">
              subscript
             </csymbol>
             <apply id="S3.Ex1.m1.4.4.3.2.cmml" xref="S3.Ex1.m1.4.4.3">
              <csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.3.2.1.cmml" xref="S3.Ex1.m1.4.4.3">
               superscript
              </csymbol>
              <ci id="S3.Ex1.m1.4.4.3.2.2.cmml" xref="S3.Ex1.m1.4.4.3.2.2">
               ℎ
              </ci>
              <apply id="S3.Ex1.m1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1">
               <plus id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">
               </plus>
               <ci id="S3.Ex1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.2">
                𝑙
               </ci>
               <cn id="S3.Ex1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex1.m1.1.1.1.1.1.3">
                1
               </cn>
              </apply>
             </apply>
             <ci id="S3.Ex1.m1.4.4.3.3a.cmml" xref="S3.Ex1.m1.4.4.3.3">
              <mtext class="ltx_mathvariant_bold" id="S3.Ex1.m1.4.4.3.3.cmml" mathsize="70%" xref="S3.Ex1.m1.4.4.3.3">
               x
              </mtext>
             </ci>
            </apply>
            <apply id="S3.Ex1.m1.4.4.1.cmml" xref="S3.Ex1.m1.4.4.1">
             <times id="S3.Ex1.m1.4.4.1.2.cmml" xref="S3.Ex1.m1.4.4.1.2">
             </times>
             <ci id="S3.Ex1.m1.4.4.1.3.cmml" xref="S3.Ex1.m1.4.4.1.3">
              𝜎
             </ci>
             <apply id="S3.Ex1.m1.4.4.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1">
              <times id="S3.Ex1.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1">
              </times>
              <apply id="S3.Ex1.m1.4.4.1.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.2">
               <csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.2">
                superscript
               </csymbol>
               <ci id="S3.Ex1.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.2.2">
                𝐷
               </ci>
               <apply id="S3.Ex1.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.2.3">
                <minus id="S3.Ex1.m1.4.4.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.2.3">
                </minus>
                <cn id="S3.Ex1.m1.4.4.1.1.1.1.2.3.2.cmml" type="integer" xref="S3.Ex1.m1.4.4.1.1.1.1.2.3.2">
                 1
                </cn>
               </apply>
              </apply>
              <ci id="S3.Ex1.m1.4.4.1.1.1.1.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.3">
               𝑀
              </ci>
              <apply id="S3.Ex1.m1.4.4.1.1.1.1.4.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.4">
               <csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.4.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.4">
                subscript
               </csymbol>
               <apply id="S3.Ex1.m1.4.4.1.1.1.1.4.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.4">
                <csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.4.2.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.4">
                 superscript
                </csymbol>
                <ci id="S3.Ex1.m1.4.4.1.1.1.1.4.2.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.4.2.2">
                 ℎ
                </ci>
                <ci id="S3.Ex1.m1.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1">
                 𝑙
                </ci>
               </apply>
               <ci id="S3.Ex1.m1.4.4.1.1.1.1.4.3a.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.4.3">
                <mtext class="ltx_mathvariant_bold" id="S3.Ex1.m1.4.4.1.1.1.1.4.3.cmml" mathsize="70%" xref="S3.Ex1.m1.4.4.1.1.1.1.4.3">
                 x
                </mtext>
               </ci>
              </apply>
              <apply id="S3.Ex1.m1.4.4.1.1.1.1.5.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.5">
               <csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.5.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.5">
                superscript
               </csymbol>
               <ci id="S3.Ex1.m1.4.4.1.1.1.1.5.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.5.2">
                𝑊
               </ci>
               <ci id="S3.Ex1.m1.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1">
                𝑙
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.Ex1.m1.4c">
           h^{(l+1)}_{\textbf{x}}=\sigma(D^{-1}Mh^{(l)}_{\textbf{x}}W^{(l)})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS4.p5.17">
     where
     <math alttext="M\in|\mathcal{V}|\times|\mathcal{V}|" class="ltx_Math" display="inline" id="S3.SS4.p5.3.m1.2">
      <semantics id="S3.SS4.p5.3.m1.2a">
       <mrow id="S3.SS4.p5.3.m1.2.3" xref="S3.SS4.p5.3.m1.2.3.cmml">
        <mi id="S3.SS4.p5.3.m1.2.3.2" xref="S3.SS4.p5.3.m1.2.3.2.cmml">
         M
        </mi>
        <mo id="S3.SS4.p5.3.m1.2.3.1" xref="S3.SS4.p5.3.m1.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS4.p5.3.m1.2.3.3" xref="S3.SS4.p5.3.m1.2.3.3.cmml">
         <mrow id="S3.SS4.p5.3.m1.2.3.3.2.2" xref="S3.SS4.p5.3.m1.2.3.3.2.1.cmml">
          <mo id="S3.SS4.p5.3.m1.2.3.3.2.2.1" stretchy="false" xref="S3.SS4.p5.3.m1.2.3.3.2.1.1.cmml">
           |
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.3.m1.1.1" xref="S3.SS4.p5.3.m1.1.1.cmml">
           𝒱
          </mi>
          <mo id="S3.SS4.p5.3.m1.2.3.3.2.2.2" rspace="0.055em" stretchy="false" xref="S3.SS4.p5.3.m1.2.3.3.2.1.1.cmml">
           |
          </mo>
         </mrow>
         <mo id="S3.SS4.p5.3.m1.2.3.3.1" rspace="0.222em" xref="S3.SS4.p5.3.m1.2.3.3.1.cmml">
          ×
         </mo>
         <mrow id="S3.SS4.p5.3.m1.2.3.3.3.2" xref="S3.SS4.p5.3.m1.2.3.3.3.1.cmml">
          <mo id="S3.SS4.p5.3.m1.2.3.3.3.2.1" stretchy="false" xref="S3.SS4.p5.3.m1.2.3.3.3.1.1.cmml">
           |
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.3.m1.2.2" xref="S3.SS4.p5.3.m1.2.2.cmml">
           𝒱
          </mi>
          <mo id="S3.SS4.p5.3.m1.2.3.3.3.2.2" stretchy="false" xref="S3.SS4.p5.3.m1.2.3.3.3.1.1.cmml">
           |
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.m1.2b">
        <apply id="S3.SS4.p5.3.m1.2.3.cmml" xref="S3.SS4.p5.3.m1.2.3">
         <in id="S3.SS4.p5.3.m1.2.3.1.cmml" xref="S3.SS4.p5.3.m1.2.3.1">
         </in>
         <ci id="S3.SS4.p5.3.m1.2.3.2.cmml" xref="S3.SS4.p5.3.m1.2.3.2">
          𝑀
         </ci>
         <apply id="S3.SS4.p5.3.m1.2.3.3.cmml" xref="S3.SS4.p5.3.m1.2.3.3">
          <times id="S3.SS4.p5.3.m1.2.3.3.1.cmml" xref="S3.SS4.p5.3.m1.2.3.3.1">
          </times>
          <apply id="S3.SS4.p5.3.m1.2.3.3.2.1.cmml" xref="S3.SS4.p5.3.m1.2.3.3.2.2">
           <abs id="S3.SS4.p5.3.m1.2.3.3.2.1.1.cmml" xref="S3.SS4.p5.3.m1.2.3.3.2.2.1">
           </abs>
           <ci id="S3.SS4.p5.3.m1.1.1.cmml" xref="S3.SS4.p5.3.m1.1.1">
            𝒱
           </ci>
          </apply>
          <apply id="S3.SS4.p5.3.m1.2.3.3.3.1.cmml" xref="S3.SS4.p5.3.m1.2.3.3.3.2">
           <abs id="S3.SS4.p5.3.m1.2.3.3.3.1.1.cmml" xref="S3.SS4.p5.3.m1.2.3.3.3.2.1">
           </abs>
           <ci id="S3.SS4.p5.3.m1.2.2.cmml" xref="S3.SS4.p5.3.m1.2.2">
            𝒱
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.3.m1.2c">
        M\in|\mathcal{V}|\times|\mathcal{V}|
       </annotation>
      </semantics>
     </math>
     is the adjacency matrix with self-connections,
     <math alttext="D" class="ltx_Math" display="inline" id="S3.SS4.p5.4.m2.1">
      <semantics id="S3.SS4.p5.4.m2.1a">
       <mi id="S3.SS4.p5.4.m2.1.1" xref="S3.SS4.p5.4.m2.1.1.cmml">
        D
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.4.m2.1b">
        <ci id="S3.SS4.p5.4.m2.1.1.cmml" xref="S3.SS4.p5.4.m2.1.1">
         𝐷
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.4.m2.1c">
        D
       </annotation>
      </semantics>
     </math>
     is the diagonal degree matrix of
     <math alttext="M" class="ltx_Math" display="inline" id="S3.SS4.p5.5.m3.1">
      <semantics id="S3.SS4.p5.5.m3.1a">
       <mi id="S3.SS4.p5.5.m3.1.1" xref="S3.SS4.p5.5.m3.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.5.m3.1b">
        <ci id="S3.SS4.p5.5.m3.1.1.cmml" xref="S3.SS4.p5.5.m3.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.5.m3.1c">
        M
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS4.p5.6.m4.1">
      <semantics id="S3.SS4.p5.6.m4.1a">
       <mi id="S3.SS4.p5.6.m4.1.1" xref="S3.SS4.p5.6.m4.1.1.cmml">
        σ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.6.m4.1b">
        <ci id="S3.SS4.p5.6.m4.1.1.cmml" xref="S3.SS4.p5.6.m4.1.1">
         𝜎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.6.m4.1c">
        \sigma
       </annotation>
      </semantics>
     </math>
     is the ReLU activation function,
     <math alttext="h^{(l)}_{\textbf{x}}" class="ltx_Math" display="inline" id="S3.SS4.p5.7.m5.1">
      <semantics id="S3.SS4.p5.7.m5.1a">
       <msubsup id="S3.SS4.p5.7.m5.1.2" xref="S3.SS4.p5.7.m5.1.2.cmml">
        <mi id="S3.SS4.p5.7.m5.1.2.2.2" xref="S3.SS4.p5.7.m5.1.2.2.2.cmml">
         h
        </mi>
        <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.7.m5.1.2.3" xref="S3.SS4.p5.7.m5.1.2.3a.cmml">
         x
        </mtext>
        <mrow id="S3.SS4.p5.7.m5.1.1.1.3" xref="S3.SS4.p5.7.m5.1.2.cmml">
         <mo id="S3.SS4.p5.7.m5.1.1.1.3.1" stretchy="false" xref="S3.SS4.p5.7.m5.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS4.p5.7.m5.1.1.1.1" xref="S3.SS4.p5.7.m5.1.1.1.1.cmml">
          l
         </mi>
         <mo id="S3.SS4.p5.7.m5.1.1.1.3.2" stretchy="false" xref="S3.SS4.p5.7.m5.1.2.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.7.m5.1b">
        <apply id="S3.SS4.p5.7.m5.1.2.cmml" xref="S3.SS4.p5.7.m5.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p5.7.m5.1.2.1.cmml" xref="S3.SS4.p5.7.m5.1.2">
          subscript
         </csymbol>
         <apply id="S3.SS4.p5.7.m5.1.2.2.cmml" xref="S3.SS4.p5.7.m5.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p5.7.m5.1.2.2.1.cmml" xref="S3.SS4.p5.7.m5.1.2">
           superscript
          </csymbol>
          <ci id="S3.SS4.p5.7.m5.1.2.2.2.cmml" xref="S3.SS4.p5.7.m5.1.2.2.2">
           ℎ
          </ci>
          <ci id="S3.SS4.p5.7.m5.1.1.1.1.cmml" xref="S3.SS4.p5.7.m5.1.1.1.1">
           𝑙
          </ci>
         </apply>
         <ci id="S3.SS4.p5.7.m5.1.2.3a.cmml" xref="S3.SS4.p5.7.m5.1.2.3">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.7.m5.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p5.7.m5.1.2.3">
           x
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.7.m5.1c">
        h^{(l)}_{\textbf{x}}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="h^{(l+1)}_{\textbf{x}}" class="ltx_Math" display="inline" id="S3.SS4.p5.8.m6.1">
      <semantics id="S3.SS4.p5.8.m6.1a">
       <msubsup id="S3.SS4.p5.8.m6.1.2" xref="S3.SS4.p5.8.m6.1.2.cmml">
        <mi id="S3.SS4.p5.8.m6.1.2.2.2" xref="S3.SS4.p5.8.m6.1.2.2.2.cmml">
         h
        </mi>
        <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.8.m6.1.2.3" xref="S3.SS4.p5.8.m6.1.2.3a.cmml">
         x
        </mtext>
        <mrow id="S3.SS4.p5.8.m6.1.1.1.1" xref="S3.SS4.p5.8.m6.1.1.1.1.1.cmml">
         <mo id="S3.SS4.p5.8.m6.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.8.m6.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p5.8.m6.1.1.1.1.1" xref="S3.SS4.p5.8.m6.1.1.1.1.1.cmml">
          <mi id="S3.SS4.p5.8.m6.1.1.1.1.1.2" xref="S3.SS4.p5.8.m6.1.1.1.1.1.2.cmml">
           l
          </mi>
          <mo id="S3.SS4.p5.8.m6.1.1.1.1.1.1" xref="S3.SS4.p5.8.m6.1.1.1.1.1.1.cmml">
           +
          </mo>
          <mn id="S3.SS4.p5.8.m6.1.1.1.1.1.3" xref="S3.SS4.p5.8.m6.1.1.1.1.1.3.cmml">
           1
          </mn>
         </mrow>
         <mo id="S3.SS4.p5.8.m6.1.1.1.1.3" stretchy="false" xref="S3.SS4.p5.8.m6.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.8.m6.1b">
        <apply id="S3.SS4.p5.8.m6.1.2.cmml" xref="S3.SS4.p5.8.m6.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p5.8.m6.1.2.1.cmml" xref="S3.SS4.p5.8.m6.1.2">
          subscript
         </csymbol>
         <apply id="S3.SS4.p5.8.m6.1.2.2.cmml" xref="S3.SS4.p5.8.m6.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p5.8.m6.1.2.2.1.cmml" xref="S3.SS4.p5.8.m6.1.2">
           superscript
          </csymbol>
          <ci id="S3.SS4.p5.8.m6.1.2.2.2.cmml" xref="S3.SS4.p5.8.m6.1.2.2.2">
           ℎ
          </ci>
          <apply id="S3.SS4.p5.8.m6.1.1.1.1.1.cmml" xref="S3.SS4.p5.8.m6.1.1.1.1">
           <plus id="S3.SS4.p5.8.m6.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.8.m6.1.1.1.1.1.1">
           </plus>
           <ci id="S3.SS4.p5.8.m6.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.8.m6.1.1.1.1.1.2">
            𝑙
           </ci>
           <cn id="S3.SS4.p5.8.m6.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p5.8.m6.1.1.1.1.1.3">
            1
           </cn>
          </apply>
         </apply>
         <ci id="S3.SS4.p5.8.m6.1.2.3a.cmml" xref="S3.SS4.p5.8.m6.1.2.3">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.8.m6.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p5.8.m6.1.2.3">
           x
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.8.m6.1c">
        h^{(l+1)}_{\textbf{x}}
       </annotation>
      </semantics>
     </math>
     are the input and updated node representations of the
     <math alttext="l" class="ltx_Math" display="inline" id="S3.SS4.p5.9.m7.1">
      <semantics id="S3.SS4.p5.9.m7.1a">
       <mi id="S3.SS4.p5.9.m7.1.1" xref="S3.SS4.p5.9.m7.1.1.cmml">
        l
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.9.m7.1b">
        <ci id="S3.SS4.p5.9.m7.1.1.cmml" xref="S3.SS4.p5.9.m7.1.1">
         𝑙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.9.m7.1c">
        l
       </annotation>
      </semantics>
     </math>
     -th layer. We set
     <math alttext="h^{(0)}_{\textbf{x}}=h_{\textbf{x}}" class="ltx_Math" display="inline" id="S3.SS4.p5.10.m8.1">
      <semantics id="S3.SS4.p5.10.m8.1a">
       <mrow id="S3.SS4.p5.10.m8.1.2" xref="S3.SS4.p5.10.m8.1.2.cmml">
        <msubsup id="S3.SS4.p5.10.m8.1.2.2" xref="S3.SS4.p5.10.m8.1.2.2.cmml">
         <mi id="S3.SS4.p5.10.m8.1.2.2.2.2" xref="S3.SS4.p5.10.m8.1.2.2.2.2.cmml">
          h
         </mi>
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.10.m8.1.2.2.3" xref="S3.SS4.p5.10.m8.1.2.2.3a.cmml">
          x
         </mtext>
         <mrow id="S3.SS4.p5.10.m8.1.1.1.3" xref="S3.SS4.p5.10.m8.1.2.2.cmml">
          <mo id="S3.SS4.p5.10.m8.1.1.1.3.1" stretchy="false" xref="S3.SS4.p5.10.m8.1.2.2.cmml">
           (
          </mo>
          <mn id="S3.SS4.p5.10.m8.1.1.1.1" xref="S3.SS4.p5.10.m8.1.1.1.1.cmml">
           0
          </mn>
          <mo id="S3.SS4.p5.10.m8.1.1.1.3.2" stretchy="false" xref="S3.SS4.p5.10.m8.1.2.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p5.10.m8.1.2.1" xref="S3.SS4.p5.10.m8.1.2.1.cmml">
         =
        </mo>
        <msub id="S3.SS4.p5.10.m8.1.2.3" xref="S3.SS4.p5.10.m8.1.2.3.cmml">
         <mi id="S3.SS4.p5.10.m8.1.2.3.2" xref="S3.SS4.p5.10.m8.1.2.3.2.cmml">
          h
         </mi>
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.10.m8.1.2.3.3" xref="S3.SS4.p5.10.m8.1.2.3.3a.cmml">
          x
         </mtext>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.10.m8.1b">
        <apply id="S3.SS4.p5.10.m8.1.2.cmml" xref="S3.SS4.p5.10.m8.1.2">
         <eq id="S3.SS4.p5.10.m8.1.2.1.cmml" xref="S3.SS4.p5.10.m8.1.2.1">
         </eq>
         <apply id="S3.SS4.p5.10.m8.1.2.2.cmml" xref="S3.SS4.p5.10.m8.1.2.2">
          <csymbol cd="ambiguous" id="S3.SS4.p5.10.m8.1.2.2.1.cmml" xref="S3.SS4.p5.10.m8.1.2.2">
           subscript
          </csymbol>
          <apply id="S3.SS4.p5.10.m8.1.2.2.2.cmml" xref="S3.SS4.p5.10.m8.1.2.2">
           <csymbol cd="ambiguous" id="S3.SS4.p5.10.m8.1.2.2.2.1.cmml" xref="S3.SS4.p5.10.m8.1.2.2">
            superscript
           </csymbol>
           <ci id="S3.SS4.p5.10.m8.1.2.2.2.2.cmml" xref="S3.SS4.p5.10.m8.1.2.2.2.2">
            ℎ
           </ci>
           <cn id="S3.SS4.p5.10.m8.1.1.1.1.cmml" type="integer" xref="S3.SS4.p5.10.m8.1.1.1.1">
            0
           </cn>
          </apply>
          <ci id="S3.SS4.p5.10.m8.1.2.2.3a.cmml" xref="S3.SS4.p5.10.m8.1.2.2.3">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.10.m8.1.2.2.3.cmml" mathsize="70%" xref="S3.SS4.p5.10.m8.1.2.2.3">
            x
           </mtext>
          </ci>
         </apply>
         <apply id="S3.SS4.p5.10.m8.1.2.3.cmml" xref="S3.SS4.p5.10.m8.1.2.3">
          <csymbol cd="ambiguous" id="S3.SS4.p5.10.m8.1.2.3.1.cmml" xref="S3.SS4.p5.10.m8.1.2.3">
           subscript
          </csymbol>
          <ci id="S3.SS4.p5.10.m8.1.2.3.2.cmml" xref="S3.SS4.p5.10.m8.1.2.3.2">
           ℎ
          </ci>
          <ci id="S3.SS4.p5.10.m8.1.2.3.3a.cmml" xref="S3.SS4.p5.10.m8.1.2.3.3">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.10.m8.1.2.3.3.cmml" mathsize="70%" xref="S3.SS4.p5.10.m8.1.2.3.3">
            x
           </mtext>
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.10.m8.1c">
        h^{(0)}_{\textbf{x}}=h_{\textbf{x}}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="W^{(l)}" class="ltx_Math" display="inline" id="S3.SS4.p5.11.m9.1">
      <semantics id="S3.SS4.p5.11.m9.1a">
       <msup id="S3.SS4.p5.11.m9.1.2" xref="S3.SS4.p5.11.m9.1.2.cmml">
        <mi id="S3.SS4.p5.11.m9.1.2.2" xref="S3.SS4.p5.11.m9.1.2.2.cmml">
         W
        </mi>
        <mrow id="S3.SS4.p5.11.m9.1.1.1.3" xref="S3.SS4.p5.11.m9.1.2.cmml">
         <mo id="S3.SS4.p5.11.m9.1.1.1.3.1" stretchy="false" xref="S3.SS4.p5.11.m9.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS4.p5.11.m9.1.1.1.1" xref="S3.SS4.p5.11.m9.1.1.1.1.cmml">
          l
         </mi>
         <mo id="S3.SS4.p5.11.m9.1.1.1.3.2" stretchy="false" xref="S3.SS4.p5.11.m9.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.11.m9.1b">
        <apply id="S3.SS4.p5.11.m9.1.2.cmml" xref="S3.SS4.p5.11.m9.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p5.11.m9.1.2.1.cmml" xref="S3.SS4.p5.11.m9.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS4.p5.11.m9.1.2.2.cmml" xref="S3.SS4.p5.11.m9.1.2.2">
          𝑊
         </ci>
         <ci id="S3.SS4.p5.11.m9.1.1.1.1.cmml" xref="S3.SS4.p5.11.m9.1.1.1.1">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.11.m9.1c">
        W^{(l)}
       </annotation>
      </semantics>
     </math>
     as the weight matrix of the
     <math alttext="l" class="ltx_Math" display="inline" id="S3.SS4.p5.12.m10.1">
      <semantics id="S3.SS4.p5.12.m10.1a">
       <mi id="S3.SS4.p5.12.m10.1.1" xref="S3.SS4.p5.12.m10.1.1.cmml">
        l
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.12.m10.1b">
        <ci id="S3.SS4.p5.12.m10.1.1.cmml" xref="S3.SS4.p5.12.m10.1.1">
         𝑙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.12.m10.1c">
        l
       </annotation>
      </semantics>
     </math>
     -th layer. After two layers of message passing, we obtain the final node representation
     <math alttext="h^{(L)}_{\textbf{x}}" class="ltx_Math" display="inline" id="S3.SS4.p5.13.m11.1">
      <semantics id="S3.SS4.p5.13.m11.1a">
       <msubsup id="S3.SS4.p5.13.m11.1.2" xref="S3.SS4.p5.13.m11.1.2.cmml">
        <mi id="S3.SS4.p5.13.m11.1.2.2.2" xref="S3.SS4.p5.13.m11.1.2.2.2.cmml">
         h
        </mi>
        <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.13.m11.1.2.3" xref="S3.SS4.p5.13.m11.1.2.3a.cmml">
         x
        </mtext>
        <mrow id="S3.SS4.p5.13.m11.1.1.1.3" xref="S3.SS4.p5.13.m11.1.2.cmml">
         <mo id="S3.SS4.p5.13.m11.1.1.1.3.1" stretchy="false" xref="S3.SS4.p5.13.m11.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS4.p5.13.m11.1.1.1.1" xref="S3.SS4.p5.13.m11.1.1.1.1.cmml">
          L
         </mi>
         <mo id="S3.SS4.p5.13.m11.1.1.1.3.2" stretchy="false" xref="S3.SS4.p5.13.m11.1.2.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.13.m11.1b">
        <apply id="S3.SS4.p5.13.m11.1.2.cmml" xref="S3.SS4.p5.13.m11.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p5.13.m11.1.2.1.cmml" xref="S3.SS4.p5.13.m11.1.2">
          subscript
         </csymbol>
         <apply id="S3.SS4.p5.13.m11.1.2.2.cmml" xref="S3.SS4.p5.13.m11.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p5.13.m11.1.2.2.1.cmml" xref="S3.SS4.p5.13.m11.1.2">
           superscript
          </csymbol>
          <ci id="S3.SS4.p5.13.m11.1.2.2.2.cmml" xref="S3.SS4.p5.13.m11.1.2.2.2">
           ℎ
          </ci>
          <ci id="S3.SS4.p5.13.m11.1.1.1.1.cmml" xref="S3.SS4.p5.13.m11.1.1.1.1">
           𝐿
          </ci>
         </apply>
         <ci id="S3.SS4.p5.13.m11.1.2.3a.cmml" xref="S3.SS4.p5.13.m11.1.2.3">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.13.m11.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p5.13.m11.1.2.3">
           x
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.13.m11.1c">
        h^{(L)}_{\textbf{x}}
       </annotation>
      </semantics>
     </math>
     , which is now conditioned on the graph structure.
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p5.17.1">
      MAGDi
     </span>
     then projects
     <math alttext="h^{(L)}_{\textbf{x}}" class="ltx_Math" display="inline" id="S3.SS4.p5.14.m12.1">
      <semantics id="S3.SS4.p5.14.m12.1a">
       <msubsup id="S3.SS4.p5.14.m12.1.2" xref="S3.SS4.p5.14.m12.1.2.cmml">
        <mi id="S3.SS4.p5.14.m12.1.2.2.2" xref="S3.SS4.p5.14.m12.1.2.2.2.cmml">
         h
        </mi>
        <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.14.m12.1.2.3" xref="S3.SS4.p5.14.m12.1.2.3a.cmml">
         x
        </mtext>
        <mrow id="S3.SS4.p5.14.m12.1.1.1.3" xref="S3.SS4.p5.14.m12.1.2.cmml">
         <mo id="S3.SS4.p5.14.m12.1.1.1.3.1" stretchy="false" xref="S3.SS4.p5.14.m12.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS4.p5.14.m12.1.1.1.1" xref="S3.SS4.p5.14.m12.1.1.1.1.cmml">
          L
         </mi>
         <mo id="S3.SS4.p5.14.m12.1.1.1.3.2" stretchy="false" xref="S3.SS4.p5.14.m12.1.2.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.14.m12.1b">
        <apply id="S3.SS4.p5.14.m12.1.2.cmml" xref="S3.SS4.p5.14.m12.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p5.14.m12.1.2.1.cmml" xref="S3.SS4.p5.14.m12.1.2">
          subscript
         </csymbol>
         <apply id="S3.SS4.p5.14.m12.1.2.2.cmml" xref="S3.SS4.p5.14.m12.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p5.14.m12.1.2.2.1.cmml" xref="S3.SS4.p5.14.m12.1.2">
           superscript
          </csymbol>
          <ci id="S3.SS4.p5.14.m12.1.2.2.2.cmml" xref="S3.SS4.p5.14.m12.1.2.2.2">
           ℎ
          </ci>
          <ci id="S3.SS4.p5.14.m12.1.1.1.1.cmml" xref="S3.SS4.p5.14.m12.1.1.1.1">
           𝐿
          </ci>
         </apply>
         <ci id="S3.SS4.p5.14.m12.1.2.3a.cmml" xref="S3.SS4.p5.14.m12.1.2.3">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.14.m12.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p5.14.m12.1.2.3">
           x
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.14.m12.1c">
        h^{(L)}_{\textbf{x}}
       </annotation>
      </semantics>
     </math>
     with a linear layer parameterized by
     <math alttext="W_{c}\in\mathbb{R}^{d\times C}" class="ltx_Math" display="inline" id="S3.SS4.p5.15.m13.1">
      <semantics id="S3.SS4.p5.15.m13.1a">
       <mrow id="S3.SS4.p5.15.m13.1.1" xref="S3.SS4.p5.15.m13.1.1.cmml">
        <msub id="S3.SS4.p5.15.m13.1.1.2" xref="S3.SS4.p5.15.m13.1.1.2.cmml">
         <mi id="S3.SS4.p5.15.m13.1.1.2.2" xref="S3.SS4.p5.15.m13.1.1.2.2.cmml">
          W
         </mi>
         <mi id="S3.SS4.p5.15.m13.1.1.2.3" xref="S3.SS4.p5.15.m13.1.1.2.3.cmml">
          c
         </mi>
        </msub>
        <mo id="S3.SS4.p5.15.m13.1.1.1" xref="S3.SS4.p5.15.m13.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S3.SS4.p5.15.m13.1.1.3" xref="S3.SS4.p5.15.m13.1.1.3.cmml">
         <mi id="S3.SS4.p5.15.m13.1.1.3.2" xref="S3.SS4.p5.15.m13.1.1.3.2.cmml">
          ℝ
         </mi>
         <mrow id="S3.SS4.p5.15.m13.1.1.3.3" xref="S3.SS4.p5.15.m13.1.1.3.3.cmml">
          <mi id="S3.SS4.p5.15.m13.1.1.3.3.2" xref="S3.SS4.p5.15.m13.1.1.3.3.2.cmml">
           d
          </mi>
          <mo id="S3.SS4.p5.15.m13.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p5.15.m13.1.1.3.3.1.cmml">
           ×
          </mo>
          <mi id="S3.SS4.p5.15.m13.1.1.3.3.3" xref="S3.SS4.p5.15.m13.1.1.3.3.3.cmml">
           C
          </mi>
         </mrow>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.15.m13.1b">
        <apply id="S3.SS4.p5.15.m13.1.1.cmml" xref="S3.SS4.p5.15.m13.1.1">
         <in id="S3.SS4.p5.15.m13.1.1.1.cmml" xref="S3.SS4.p5.15.m13.1.1.1">
         </in>
         <apply id="S3.SS4.p5.15.m13.1.1.2.cmml" xref="S3.SS4.p5.15.m13.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS4.p5.15.m13.1.1.2.1.cmml" xref="S3.SS4.p5.15.m13.1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS4.p5.15.m13.1.1.2.2.cmml" xref="S3.SS4.p5.15.m13.1.1.2.2">
           𝑊
          </ci>
          <ci id="S3.SS4.p5.15.m13.1.1.2.3.cmml" xref="S3.SS4.p5.15.m13.1.1.2.3">
           𝑐
          </ci>
         </apply>
         <apply id="S3.SS4.p5.15.m13.1.1.3.cmml" xref="S3.SS4.p5.15.m13.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS4.p5.15.m13.1.1.3.1.cmml" xref="S3.SS4.p5.15.m13.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS4.p5.15.m13.1.1.3.2.cmml" xref="S3.SS4.p5.15.m13.1.1.3.2">
           ℝ
          </ci>
          <apply id="S3.SS4.p5.15.m13.1.1.3.3.cmml" xref="S3.SS4.p5.15.m13.1.1.3.3">
           <times id="S3.SS4.p5.15.m13.1.1.3.3.1.cmml" xref="S3.SS4.p5.15.m13.1.1.3.3.1">
           </times>
           <ci id="S3.SS4.p5.15.m13.1.1.3.3.2.cmml" xref="S3.SS4.p5.15.m13.1.1.3.3.2">
            𝑑
           </ci>
           <ci id="S3.SS4.p5.15.m13.1.1.3.3.3.cmml" xref="S3.SS4.p5.15.m13.1.1.3.3.3">
            𝐶
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.15.m13.1c">
        W_{c}\in\mathbb{R}^{d\times C}
       </annotation>
      </semantics>
     </math>
     (where
     <math alttext="C" class="ltx_Math" display="inline" id="S3.SS4.p5.16.m14.1">
      <semantics id="S3.SS4.p5.16.m14.1a">
       <mi id="S3.SS4.p5.16.m14.1.1" xref="S3.SS4.p5.16.m14.1.1.cmml">
        C
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.16.m14.1b">
        <ci id="S3.SS4.p5.16.m14.1.1.cmml" xref="S3.SS4.p5.16.m14.1.1">
         𝐶
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.16.m14.1c">
        C
       </annotation>
      </semantics>
     </math>
     is the number of node labels)
and applies the softmax function to derive the probability distribution over the node labels
     <math alttext="\hat{y}_{\textbf{x}}=\text{softmax}(h^{(L)}_{\textbf{x}}W_{c})" class="ltx_Math" display="inline" id="S3.SS4.p5.17.m15.2">
      <semantics id="S3.SS4.p5.17.m15.2a">
       <mrow id="S3.SS4.p5.17.m15.2.2" xref="S3.SS4.p5.17.m15.2.2.cmml">
        <msub id="S3.SS4.p5.17.m15.2.2.3" xref="S3.SS4.p5.17.m15.2.2.3.cmml">
         <mover accent="true" id="S3.SS4.p5.17.m15.2.2.3.2" xref="S3.SS4.p5.17.m15.2.2.3.2.cmml">
          <mi id="S3.SS4.p5.17.m15.2.2.3.2.2" xref="S3.SS4.p5.17.m15.2.2.3.2.2.cmml">
           y
          </mi>
          <mo id="S3.SS4.p5.17.m15.2.2.3.2.1" xref="S3.SS4.p5.17.m15.2.2.3.2.1.cmml">
           ^
          </mo>
         </mover>
         <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.17.m15.2.2.3.3" xref="S3.SS4.p5.17.m15.2.2.3.3a.cmml">
          x
         </mtext>
        </msub>
        <mo id="S3.SS4.p5.17.m15.2.2.2" xref="S3.SS4.p5.17.m15.2.2.2.cmml">
         =
        </mo>
        <mrow id="S3.SS4.p5.17.m15.2.2.1" xref="S3.SS4.p5.17.m15.2.2.1.cmml">
         <mtext id="S3.SS4.p5.17.m15.2.2.1.3" xref="S3.SS4.p5.17.m15.2.2.1.3a.cmml">
          softmax
         </mtext>
         <mo id="S3.SS4.p5.17.m15.2.2.1.2" lspace="0em" rspace="0em" xref="S3.SS4.p5.17.m15.2.2.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS4.p5.17.m15.2.2.1.1.1" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.cmml">
          <mo id="S3.SS4.p5.17.m15.2.2.1.1.1.2" stretchy="false" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.cmml">
           (
          </mo>
          <mrow id="S3.SS4.p5.17.m15.2.2.1.1.1.1" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.cmml">
           <msubsup id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.cmml">
            <mi id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.2.2" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.2.2.cmml">
             h
            </mi>
            <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.3" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.3a.cmml">
             x
            </mtext>
            <mrow id="S3.SS4.p5.17.m15.1.1.1.3" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.cmml">
             <mo id="S3.SS4.p5.17.m15.1.1.1.3.1" stretchy="false" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.cmml">
              (
             </mo>
             <mi id="S3.SS4.p5.17.m15.1.1.1.1" xref="S3.SS4.p5.17.m15.1.1.1.1.cmml">
              L
             </mi>
             <mo id="S3.SS4.p5.17.m15.1.1.1.3.2" stretchy="false" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.cmml">
              )
             </mo>
            </mrow>
           </msubsup>
           <mo id="S3.SS4.p5.17.m15.2.2.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.1.cmml">
            ​
           </mo>
           <msub id="S3.SS4.p5.17.m15.2.2.1.1.1.1.3" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.cmml">
            <mi id="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.2" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.2.cmml">
             W
            </mi>
            <mi id="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.3" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.3.cmml">
             c
            </mi>
           </msub>
          </mrow>
          <mo id="S3.SS4.p5.17.m15.2.2.1.1.1.3" stretchy="false" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.17.m15.2b">
        <apply id="S3.SS4.p5.17.m15.2.2.cmml" xref="S3.SS4.p5.17.m15.2.2">
         <eq id="S3.SS4.p5.17.m15.2.2.2.cmml" xref="S3.SS4.p5.17.m15.2.2.2">
         </eq>
         <apply id="S3.SS4.p5.17.m15.2.2.3.cmml" xref="S3.SS4.p5.17.m15.2.2.3">
          <csymbol cd="ambiguous" id="S3.SS4.p5.17.m15.2.2.3.1.cmml" xref="S3.SS4.p5.17.m15.2.2.3">
           subscript
          </csymbol>
          <apply id="S3.SS4.p5.17.m15.2.2.3.2.cmml" xref="S3.SS4.p5.17.m15.2.2.3.2">
           <ci id="S3.SS4.p5.17.m15.2.2.3.2.1.cmml" xref="S3.SS4.p5.17.m15.2.2.3.2.1">
            ^
           </ci>
           <ci id="S3.SS4.p5.17.m15.2.2.3.2.2.cmml" xref="S3.SS4.p5.17.m15.2.2.3.2.2">
            𝑦
           </ci>
          </apply>
          <ci id="S3.SS4.p5.17.m15.2.2.3.3a.cmml" xref="S3.SS4.p5.17.m15.2.2.3.3">
           <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.17.m15.2.2.3.3.cmml" mathsize="70%" xref="S3.SS4.p5.17.m15.2.2.3.3">
            x
           </mtext>
          </ci>
         </apply>
         <apply id="S3.SS4.p5.17.m15.2.2.1.cmml" xref="S3.SS4.p5.17.m15.2.2.1">
          <times id="S3.SS4.p5.17.m15.2.2.1.2.cmml" xref="S3.SS4.p5.17.m15.2.2.1.2">
          </times>
          <ci id="S3.SS4.p5.17.m15.2.2.1.3a.cmml" xref="S3.SS4.p5.17.m15.2.2.1.3">
           <mtext id="S3.SS4.p5.17.m15.2.2.1.3.cmml" xref="S3.SS4.p5.17.m15.2.2.1.3">
            softmax
           </mtext>
          </ci>
          <apply id="S3.SS4.p5.17.m15.2.2.1.1.1.1.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1">
           <times id="S3.SS4.p5.17.m15.2.2.1.1.1.1.1.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.1">
           </times>
           <apply id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2">
            <csymbol cd="ambiguous" id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2">
             subscript
            </csymbol>
            <apply id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2">
             <csymbol cd="ambiguous" id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.2.1.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2">
              superscript
             </csymbol>
             <ci id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.2.2">
              ℎ
             </ci>
             <ci id="S3.SS4.p5.17.m15.1.1.1.1.cmml" xref="S3.SS4.p5.17.m15.1.1.1.1">
              𝐿
             </ci>
            </apply>
            <ci id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.3a.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.3">
             <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.2.3">
              x
             </mtext>
            </ci>
           </apply>
           <apply id="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.3">
            <csymbol cd="ambiguous" id="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.1.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.3">
             subscript
            </csymbol>
            <ci id="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.2.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.2">
             𝑊
            </ci>
            <ci id="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.3.cmml" xref="S3.SS4.p5.17.m15.2.2.1.1.1.1.3.3">
             𝑐
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.17.m15.2c">
        \hat{y}_{\textbf{x}}=\text{softmax}(h^{(L)}_{\textbf{x}}W_{c})
       </annotation>
      </semantics>
     </math>
     .
Finally, we use cross-entropy loss for the (correct/incorrect) node classification objective over all nodes in a MAG (see Fig.
     <a class="ltx_ref" href="#S1.F3" title="Figure 3 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ‘Learning from Interaction’),
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S3.E3">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\mathcal{L}_{I}=-\sum_{\textbf{x}\in\mathcal{V}}\sum_{i=1}^{C}y_{\textbf{x}}^{(i)}\log(\hat{y}_{\textbf{x}}^{(i)})" class="ltx_Math" display="block" id="S3.E3.m1.4">
         <semantics id="S3.E3.m1.4a">
          <mrow id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">
           <msub id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml">
            <mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.3.2" xref="S3.E3.m1.4.4.3.2.cmml">
             ℒ
            </mi>
            <mi id="S3.E3.m1.4.4.3.3" xref="S3.E3.m1.4.4.3.3.cmml">
             I
            </mi>
           </msub>
           <mo id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.2.cmml">
            =
           </mo>
           <mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.cmml">
            <mo id="S3.E3.m1.4.4.1a" xref="S3.E3.m1.4.4.1.cmml">
             −
            </mo>
            <mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml">
             <munder id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml">
              <mo id="S3.E3.m1.4.4.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E3.m1.4.4.1.1.2.2.cmml">
               ∑
              </mo>
              <mrow id="S3.E3.m1.4.4.1.1.2.3" xref="S3.E3.m1.4.4.1.1.2.3.cmml">
               <mtext class="ltx_mathvariant_bold" id="S3.E3.m1.4.4.1.1.2.3.2" xref="S3.E3.m1.4.4.1.1.2.3.2a.cmml">
                x
               </mtext>
               <mo id="S3.E3.m1.4.4.1.1.2.3.1" xref="S3.E3.m1.4.4.1.1.2.3.1.cmml">
                ∈
               </mo>
               <mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.1.1.2.3.3" xref="S3.E3.m1.4.4.1.1.2.3.3.cmml">
                𝒱
               </mi>
              </mrow>
             </munder>
             <mrow id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml">
              <munderover id="S3.E3.m1.4.4.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.2.cmml">
               <mo id="S3.E3.m1.4.4.1.1.1.2.2.2" movablelimits="false" xref="S3.E3.m1.4.4.1.1.1.2.2.2.cmml">
                ∑
               </mo>
               <mrow id="S3.E3.m1.4.4.1.1.1.2.2.3" xref="S3.E3.m1.4.4.1.1.1.2.2.3.cmml">
                <mi id="S3.E3.m1.4.4.1.1.1.2.2.3.2" xref="S3.E3.m1.4.4.1.1.1.2.2.3.2.cmml">
                 i
                </mi>
                <mo id="S3.E3.m1.4.4.1.1.1.2.2.3.1" xref="S3.E3.m1.4.4.1.1.1.2.2.3.1.cmml">
                 =
                </mo>
                <mn id="S3.E3.m1.4.4.1.1.1.2.2.3.3" xref="S3.E3.m1.4.4.1.1.1.2.2.3.3.cmml">
                 1
                </mn>
               </mrow>
               <mi id="S3.E3.m1.4.4.1.1.1.2.3" xref="S3.E3.m1.4.4.1.1.1.2.3.cmml">
                C
               </mi>
              </munderover>
              <mrow id="S3.E3.m1.4.4.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.cmml">
               <msubsup id="S3.E3.m1.4.4.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.3.cmml">
                <mi id="S3.E3.m1.4.4.1.1.1.1.3.2.2" xref="S3.E3.m1.4.4.1.1.1.1.3.2.2.cmml">
                 y
                </mi>
                <mtext class="ltx_mathvariant_bold" id="S3.E3.m1.4.4.1.1.1.1.3.2.3" xref="S3.E3.m1.4.4.1.1.1.1.3.2.3a.cmml">
                 x
                </mtext>
                <mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.3.cmml">
                 <mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.3.cmml">
                  (
                 </mo>
                 <mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">
                  i
                 </mi>
                 <mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.3.cmml">
                  )
                 </mo>
                </mrow>
               </msubsup>
               <mo id="S3.E3.m1.4.4.1.1.1.1.2" lspace="0.167em" rspace="0em" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">
                <mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">
                 log
                </mi>
                <mo id="S3.E3.m1.4.4.1.1.1.1.1.1a" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">
                 ⁡
                </mo>
                <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">
                 <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">
                  (
                 </mo>
                 <msubsup id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml">
                  <mover accent="true" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">
                   <mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">
                    y
                   </mi>
                   <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml">
                    ^
                   </mo>
                  </mover>
                  <mtext class="ltx_mathvariant_bold" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.3a.cmml">
                   x
                  </mtext>
                  <mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml">
                   <mo id="S3.E3.m1.2.2.1.3.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml">
                    (
                   </mo>
                   <mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">
                    i
                   </mi>
                   <mo id="S3.E3.m1.2.2.1.3.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml">
                    )
                   </mo>
                  </mrow>
                 </msubsup>
                 <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b">
           <apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">
            <eq id="S3.E3.m1.4.4.2.cmml" xref="S3.E3.m1.4.4.2">
            </eq>
            <apply id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3">
             <csymbol cd="ambiguous" id="S3.E3.m1.4.4.3.1.cmml" xref="S3.E3.m1.4.4.3">
              subscript
             </csymbol>
             <ci id="S3.E3.m1.4.4.3.2.cmml" xref="S3.E3.m1.4.4.3.2">
              ℒ
             </ci>
             <ci id="S3.E3.m1.4.4.3.3.cmml" xref="S3.E3.m1.4.4.3.3">
              𝐼
             </ci>
            </apply>
            <apply id="S3.E3.m1.4.4.1.cmml" xref="S3.E3.m1.4.4.1">
             <minus id="S3.E3.m1.4.4.1.2.cmml" xref="S3.E3.m1.4.4.1">
             </minus>
             <apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1.1">
              <apply id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2">
               <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2">
                subscript
               </csymbol>
               <sum id="S3.E3.m1.4.4.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2">
               </sum>
               <apply id="S3.E3.m1.4.4.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.3">
                <in id="S3.E3.m1.4.4.1.1.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.2.3.1">
                </in>
                <ci id="S3.E3.m1.4.4.1.1.2.3.2a.cmml" xref="S3.E3.m1.4.4.1.1.2.3.2">
                 <mtext class="ltx_mathvariant_bold" id="S3.E3.m1.4.4.1.1.2.3.2.cmml" mathsize="70%" xref="S3.E3.m1.4.4.1.1.2.3.2">
                  x
                 </mtext>
                </ci>
                <ci id="S3.E3.m1.4.4.1.1.2.3.3.cmml" xref="S3.E3.m1.4.4.1.1.2.3.3">
                 𝒱
                </ci>
               </apply>
              </apply>
              <apply id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1">
               <apply id="S3.E3.m1.4.4.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.2">
                <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.2">
                 superscript
                </csymbol>
                <apply id="S3.E3.m1.4.4.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.2">
                 <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.2">
                  subscript
                 </csymbol>
                 <sum id="S3.E3.m1.4.4.1.1.1.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.2.2.2">
                 </sum>
                 <apply id="S3.E3.m1.4.4.1.1.1.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.1.2.2.3">
                  <eq id="S3.E3.m1.4.4.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.2.2.3.1">
                  </eq>
                  <ci id="S3.E3.m1.4.4.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.2.2.3.2">
                   𝑖
                  </ci>
                  <cn id="S3.E3.m1.4.4.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.1.2.2.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
                <ci id="S3.E3.m1.4.4.1.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.1.2.3">
                 𝐶
                </ci>
               </apply>
               <apply id="S3.E3.m1.4.4.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1">
                <times id="S3.E3.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2">
                </times>
                <apply id="S3.E3.m1.4.4.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3">
                  superscript
                 </csymbol>
                 <apply id="S3.E3.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3">
                  <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3">
                   subscript
                  </csymbol>
                  <ci id="S3.E3.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3.2.2">
                   𝑦
                  </ci>
                  <ci id="S3.E3.m1.4.4.1.1.1.1.3.2.3a.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3.2.3">
                   <mtext class="ltx_mathvariant_bold" id="S3.E3.m1.4.4.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E3.m1.4.4.1.1.1.1.3.2.3">
                    x
                   </mtext>
                  </ci>
                 </apply>
                 <ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">
                  𝑖
                 </ci>
                </apply>
                <apply id="S3.E3.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1">
                 <log id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">
                 </log>
                 <apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1">
                   superscript
                  </csymbol>
                  <apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2">
                    <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.1">
                     ^
                    </ci>
                    <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">
                     𝑦
                    </ci>
                   </apply>
                   <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.3">
                    <mtext class="ltx_mathvariant_bold" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.3">
                     x
                    </mtext>
                   </ci>
                  </apply>
                  <ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">
                   𝑖
                  </ci>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E3.m1.4c">
           \mathcal{L}_{I}=-\sum_{\textbf{x}\in\mathcal{V}}\sum_{i=1}^{C}y_{\textbf{x}}^{(i)}\log(\hat{y}_{\textbf{x}}^{(i)})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (3)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS4.p5.19">
     where
     <math alttext="y_{\textbf{x}}" class="ltx_Math" display="inline" id="S3.SS4.p5.18.m1.1">
      <semantics id="S3.SS4.p5.18.m1.1a">
       <msub id="S3.SS4.p5.18.m1.1.1" xref="S3.SS4.p5.18.m1.1.1.cmml">
        <mi id="S3.SS4.p5.18.m1.1.1.2" xref="S3.SS4.p5.18.m1.1.1.2.cmml">
         y
        </mi>
        <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.18.m1.1.1.3" xref="S3.SS4.p5.18.m1.1.1.3a.cmml">
         x
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.18.m1.1b">
        <apply id="S3.SS4.p5.18.m1.1.1.cmml" xref="S3.SS4.p5.18.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS4.p5.18.m1.1.1.1.cmml" xref="S3.SS4.p5.18.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS4.p5.18.m1.1.1.2.cmml" xref="S3.SS4.p5.18.m1.1.1.2">
          𝑦
         </ci>
         <ci id="S3.SS4.p5.18.m1.1.1.3a.cmml" xref="S3.SS4.p5.18.m1.1.1.3">
          <mtext class="ltx_mathvariant_bold" id="S3.SS4.p5.18.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p5.18.m1.1.1.3">
           x
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.18.m1.1c">
        y_{\textbf{x}}
       </annotation>
      </semantics>
     </math>
     is a one-hot encoding of the ground-truth label of a node
     <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.SS4.p5.19.1">
      x
     </span>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p6">
    <p class="ltx_p" id="S3.SS4.p6.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p6.1.1">
      Final Objective.
     </span>
     Our final loss,
     <math alttext="\mathcal{L}_{\mathit{MAG}}" class="ltx_Math" display="inline" id="S3.SS4.p6.1.m1.1">
      <semantics id="S3.SS4.p6.1.m1.1a">
       <msub id="S3.SS4.p6.1.m1.1.1" xref="S3.SS4.p6.1.m1.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS4.p6.1.m1.1.1.2" xref="S3.SS4.p6.1.m1.1.1.2.cmml">
         ℒ
        </mi>
        <mi id="S3.SS4.p6.1.m1.1.1.3" xref="S3.SS4.p6.1.m1.1.1.3.cmml">
         𝑀𝐴𝐺
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p6.1.m1.1b">
        <apply id="S3.SS4.p6.1.m1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS4.p6.1.m1.1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS4.p6.1.m1.1.1.2.cmml" xref="S3.SS4.p6.1.m1.1.1.2">
          ℒ
         </ci>
         <ci id="S3.SS4.p6.1.m1.1.1.3.cmml" xref="S3.SS4.p6.1.m1.1.1.3">
          𝑀𝐴𝐺
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p6.1.m1.1c">
        \mathcal{L}_{\mathit{MAG}}
       </annotation>
      </semantics>
     </math>
     , as defined below, is a weighted combination of the three losses.
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S3.E4">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\mathcal{L}_{\mathit{MAG}}=\alpha\mathcal{L}^{+}+\beta\mathcal{L}^{-}+\gamma\mathcal{L}_{I}" class="ltx_Math" display="block" id="S3.E4.m1.1">
         <semantics id="S3.E4.m1.1a">
          <mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">
           <msub id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">
            <mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.2.2" xref="S3.E4.m1.1.1.2.2.cmml">
             ℒ
            </mi>
            <mi id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3.cmml">
             𝑀𝐴𝐺
            </mi>
           </msub>
           <mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">
            =
           </mo>
           <mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">
            <mrow id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">
             <mi id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml">
              α
             </mi>
             <mo id="S3.E4.m1.1.1.3.2.1" lspace="0em" rspace="0em" xref="S3.E4.m1.1.1.3.2.1.cmml">
              ​
             </mo>
             <msup id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.3.2.3.2" xref="S3.E4.m1.1.1.3.2.3.2.cmml">
               ℒ
              </mi>
              <mo id="S3.E4.m1.1.1.3.2.3.3" xref="S3.E4.m1.1.1.3.2.3.3.cmml">
               +
              </mo>
             </msup>
            </mrow>
            <mo id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">
             +
            </mo>
            <mrow id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml">
             <mi id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml">
              β
             </mi>
             <mo id="S3.E4.m1.1.1.3.3.1" lspace="0em" rspace="0em" xref="S3.E4.m1.1.1.3.3.1.cmml">
              ​
             </mo>
             <msup id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.3.3.3.2" xref="S3.E4.m1.1.1.3.3.3.2.cmml">
               ℒ
              </mi>
              <mo id="S3.E4.m1.1.1.3.3.3.3" xref="S3.E4.m1.1.1.3.3.3.3.cmml">
               −
              </mo>
             </msup>
            </mrow>
            <mo id="S3.E4.m1.1.1.3.1a" xref="S3.E4.m1.1.1.3.1.cmml">
             +
            </mo>
            <mrow id="S3.E4.m1.1.1.3.4" xref="S3.E4.m1.1.1.3.4.cmml">
             <mi id="S3.E4.m1.1.1.3.4.2" xref="S3.E4.m1.1.1.3.4.2.cmml">
              γ
             </mi>
             <mo id="S3.E4.m1.1.1.3.4.1" lspace="0em" rspace="0em" xref="S3.E4.m1.1.1.3.4.1.cmml">
              ​
             </mo>
             <msub id="S3.E4.m1.1.1.3.4.3" xref="S3.E4.m1.1.1.3.4.3.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.3.4.3.2" xref="S3.E4.m1.1.1.3.4.3.2.cmml">
               ℒ
              </mi>
              <mi id="S3.E4.m1.1.1.3.4.3.3" xref="S3.E4.m1.1.1.3.4.3.3.cmml">
               I
              </mi>
             </msub>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b">
           <apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">
            <eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1">
            </eq>
            <apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2">
             <csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.2">
              subscript
             </csymbol>
             <ci id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2.2">
              ℒ
             </ci>
             <ci id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3">
              𝑀𝐴𝐺
             </ci>
            </apply>
            <apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3">
             <plus id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1">
             </plus>
             <apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">
              <times id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2.1">
              </times>
              <ci id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2">
               𝛼
              </ci>
              <apply id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3">
               <csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.3.1.cmml" xref="S3.E4.m1.1.1.3.2.3">
                superscript
               </csymbol>
               <ci id="S3.E4.m1.1.1.3.2.3.2.cmml" xref="S3.E4.m1.1.1.3.2.3.2">
                ℒ
               </ci>
               <plus id="S3.E4.m1.1.1.3.2.3.3.cmml" xref="S3.E4.m1.1.1.3.2.3.3">
               </plus>
              </apply>
             </apply>
             <apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3">
              <times id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.1">
              </times>
              <ci id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2">
               𝛽
              </ci>
              <apply id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3">
               <csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.3">
                superscript
               </csymbol>
               <ci id="S3.E4.m1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2">
                ℒ
               </ci>
               <minus id="S3.E4.m1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3.3">
               </minus>
              </apply>
             </apply>
             <apply id="S3.E4.m1.1.1.3.4.cmml" xref="S3.E4.m1.1.1.3.4">
              <times id="S3.E4.m1.1.1.3.4.1.cmml" xref="S3.E4.m1.1.1.3.4.1">
              </times>
              <ci id="S3.E4.m1.1.1.3.4.2.cmml" xref="S3.E4.m1.1.1.3.4.2">
               𝛾
              </ci>
              <apply id="S3.E4.m1.1.1.3.4.3.cmml" xref="S3.E4.m1.1.1.3.4.3">
               <csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.4.3.1.cmml" xref="S3.E4.m1.1.1.3.4.3">
                subscript
               </csymbol>
               <ci id="S3.E4.m1.1.1.3.4.3.2.cmml" xref="S3.E4.m1.1.1.3.4.3.2">
                ℒ
               </ci>
               <ci id="S3.E4.m1.1.1.3.4.3.3.cmml" xref="S3.E4.m1.1.1.3.4.3.3">
                𝐼
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E4.m1.1c">
           \mathcal{L}_{\mathit{MAG}}=\alpha\mathcal{L}^{+}+\beta\mathcal{L}^{-}+\gamma\mathcal{L}_{I}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS4.p6.4">
     with
     <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS4.p6.2.m1.1">
      <semantics id="S3.SS4.p6.2.m1.1a">
       <mi id="S3.SS4.p6.2.m1.1.1" xref="S3.SS4.p6.2.m1.1.1.cmml">
        α
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p6.2.m1.1b">
        <ci id="S3.SS4.p6.2.m1.1.1.cmml" xref="S3.SS4.p6.2.m1.1.1">
         𝛼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p6.2.m1.1c">
        \alpha
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS4.p6.3.m2.1">
      <semantics id="S3.SS4.p6.3.m2.1a">
       <mi id="S3.SS4.p6.3.m2.1.1" xref="S3.SS4.p6.3.m2.1.1.cmml">
        β
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p6.3.m2.1b">
        <ci id="S3.SS4.p6.3.m2.1.1.cmml" xref="S3.SS4.p6.3.m2.1.1">
         𝛽
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p6.3.m2.1c">
        \beta
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\gamma\in[0,1]" class="ltx_Math" display="inline" id="S3.SS4.p6.4.m3.2">
      <semantics id="S3.SS4.p6.4.m3.2a">
       <mrow id="S3.SS4.p6.4.m3.2.3" xref="S3.SS4.p6.4.m3.2.3.cmml">
        <mi id="S3.SS4.p6.4.m3.2.3.2" xref="S3.SS4.p6.4.m3.2.3.2.cmml">
         γ
        </mi>
        <mo id="S3.SS4.p6.4.m3.2.3.1" xref="S3.SS4.p6.4.m3.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS4.p6.4.m3.2.3.3.2" xref="S3.SS4.p6.4.m3.2.3.3.1.cmml">
         <mo id="S3.SS4.p6.4.m3.2.3.3.2.1" stretchy="false" xref="S3.SS4.p6.4.m3.2.3.3.1.cmml">
          [
         </mo>
         <mn id="S3.SS4.p6.4.m3.1.1" xref="S3.SS4.p6.4.m3.1.1.cmml">
          0
         </mn>
         <mo id="S3.SS4.p6.4.m3.2.3.3.2.2" xref="S3.SS4.p6.4.m3.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="S3.SS4.p6.4.m3.2.2" xref="S3.SS4.p6.4.m3.2.2.cmml">
          1
         </mn>
         <mo id="S3.SS4.p6.4.m3.2.3.3.2.3" stretchy="false" xref="S3.SS4.p6.4.m3.2.3.3.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p6.4.m3.2b">
        <apply id="S3.SS4.p6.4.m3.2.3.cmml" xref="S3.SS4.p6.4.m3.2.3">
         <in id="S3.SS4.p6.4.m3.2.3.1.cmml" xref="S3.SS4.p6.4.m3.2.3.1">
         </in>
         <ci id="S3.SS4.p6.4.m3.2.3.2.cmml" xref="S3.SS4.p6.4.m3.2.3.2">
          𝛾
         </ci>
         <interval closure="closed" id="S3.SS4.p6.4.m3.2.3.3.1.cmml" xref="S3.SS4.p6.4.m3.2.3.3.2">
          <cn id="S3.SS4.p6.4.m3.1.1.cmml" type="integer" xref="S3.SS4.p6.4.m3.1.1">
           0
          </cn>
          <cn id="S3.SS4.p6.4.m3.2.2.cmml" type="integer" xref="S3.SS4.p6.4.m3.2.2">
           1
          </cn>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p6.4.m3.2c">
        \gamma\in[0,1]
       </annotation>
      </semantics>
     </math>
     being the respective weights.
    </p>
   </div>
   <section class="ltx_paragraph" id="S3.SS4.SSS0.Px1">
    <h4 class="ltx_title ltx_title_paragraph">
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.SSS0.Px1.1.1">
      MAGDi
     </span>
     Inference.
    </h4>
    <div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px1.p1">
     <p class="ltx_p" id="S3.SS4.SSS0.Px1.p1.1">
      The GCN module is only used during the distillation process. Hence, at test time, the student model performs zero-shot inference given just the question and uses only the same number of parameters and architecture as the base student model.
     </p>
    </div>
    <figure class="ltx_table" id="S3.T1">
     <figcaption class="ltx_caption ltx_centering">
      <span class="ltx_tag ltx_tag_table">
       Table 1:
      </span>
      Comparison of structured distillation (
      <span class="ltx_text ltx_font_smallcaps" id="S3.T1.7.1">
       MAGDi
      </span>
      ) with no teacher, single-teacher, and multi-teacher distillation baselines. Firstly,
      <span class="ltx_text ltx_font_smallcaps" id="S3.T1.8.2">
       MAGDi
      </span>
      outperforms
      <em class="ltx_emph ltx_font_italic" id="S3.T1.9.3">
       all
      </em>
      baselines across
      <em class="ltx_emph ltx_font_italic" id="S3.T1.10.4">
       all
      </em>
      five reasoning benchmarks. On average,
      <span class="ltx_text ltx_font_smallcaps" id="S3.T1.11.5">
       MAGDi
      </span>
      outperforms the strongest
      <span class="ltx_text ltx_font_smallcaps" id="S3.T1.12.6">
       SiT
      </span>
      -GPT4 baseline by 4.61% and the no teacher baseline by 10.71%. Secondly, knowledge distillation from each component of MAG improves the student model, as demonstrated by a consistent increase in performance from Level 1 to Level 4.
     </figcaption>
     <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.13" style="width:487.8pt;height:84.7pt;vertical-align:-0.5pt;">
      <span class="ltx_transformed_inner" style="transform:translate(-277.6pt,47.9pt) scale(0.467661787244027,0.467661787244027) ;">
       <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.13.1">
        <tbody class="ltx_tbody">
         <tr class="ltx_tr" id="S3.T1.13.1.1.1">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T1.13.1.1.1.1" rowspan="2">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.1.1.1.1">
            Distillation Type
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T1.13.1.1.1.2" rowspan="2">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.1.1.2.1">
            Distillation Data
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T1.13.1.1.1.3" rowspan="2">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.1.1.3.1">
            Distilled Model
           </span>
          </th>
          <td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S3.T1.13.1.1.1.4">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.1.1.4.1">
            Datasets
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.13.1.1.1.5" rowspan="2">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.1.1.5.1">
            Average Acc
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.2.2">
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.2.2.1">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.2.2.1.1">
            StrategyQA
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.2.2.2">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.2.2.2.1">
            CSQA
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.2.2.3">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.2.2.3.1">
            ARC-c
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.2.2.4">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.2.2.4.1">
            GSM8K
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.13.1.2.2.5">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.2.2.5.1">
            MATH
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.3.3">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.3.3.1">
           No Teacher
           <cite class="ltx_cite ltx_citemacro_citep">
            (Jiang et al.,
            <a class="ltx_ref" href="#bib.bib24" title="">
             2023
            </a>
            )
           </cite>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.3.3.2">
           -
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.3.3.3">
           Mistral-7B-Instruct
          </th>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.3.3.4">
           61.57
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.3.3.5">
           57.89
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.3.3.6">
           60.32
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.3.3.7">
           44.05
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.13.1.3.3.8">
           7.02
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.3.3.9">
           46.17
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.4.4">
          <th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.4.4.1">
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.4.4.2">
           <span class="ltx_text" id="S3.T1.13.1.4.4.2.1" style="background-color:#ECECEC;">
            Claude2
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.4.4.3">
           <span class="ltx_text ltx_font_smallcaps" id="S3.T1.13.1.4.4.3.1" style="background-color:#ECECEC;">
            SiT
            <span class="ltx_text ltx_font_upright" id="S3.T1.13.1.4.4.3.1.1">
             -Claude2
            </span>
           </span>
          </th>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.4.4.4">
           <span class="ltx_text" id="S3.T1.13.1.4.4.4.1" style="background-color:#ECECEC;">
            64.39
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.4.4.5">
           <span class="ltx_text" id="S3.T1.13.1.4.4.5.1" style="background-color:#ECECEC;">
            64.18
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.4.4.6">
           <span class="ltx_text" id="S3.T1.13.1.4.4.6.1" style="background-color:#ECECEC;">
            68.24
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.4.4.7">
           <span class="ltx_text" id="S3.T1.13.1.4.4.7.1" style="background-color:#ECECEC;">
            45.34
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.13.1.4.4.8">
           <span class="ltx_text" id="S3.T1.13.1.4.4.8.1" style="background-color:#ECECEC;">
            7.24
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.4.4.9">
           <span class="ltx_text" id="S3.T1.13.1.4.4.9.1" style="background-color:#ECECEC;">
            49.89
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.5.5">
          <th class="ltx_td ltx_th ltx_th_row" id="S3.T1.13.1.5.5.1">
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.5.5.2">
           <span class="ltx_text" id="S3.T1.13.1.5.5.2.1" style="background-color:#ECECEC;">
            Bard
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.5.5.3">
           <span class="ltx_text ltx_font_smallcaps" id="S3.T1.13.1.5.5.3.1" style="background-color:#ECECEC;">
            SiT
            <span class="ltx_text ltx_font_upright" id="S3.T1.13.1.5.5.3.1.1">
             -Bard
            </span>
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.5.5.4">
           <span class="ltx_text" id="S3.T1.13.1.5.5.4.1" style="background-color:#ECECEC;">
            68.56
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.5.5.5">
           <span class="ltx_text" id="S3.T1.13.1.5.5.5.1" style="background-color:#ECECEC;">
            65.06
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.5.5.6">
           <span class="ltx_text" id="S3.T1.13.1.5.5.6.1" style="background-color:#ECECEC;">
            66.87
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.5.5.7">
           <span class="ltx_text" id="S3.T1.13.1.5.5.7.1" style="background-color:#ECECEC;">
            45.61
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.13.1.5.5.8">
           <span class="ltx_text" id="S3.T1.13.1.5.5.8.1" style="background-color:#ECECEC;">
            7.06
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.5.5.9">
           <span class="ltx_text" id="S3.T1.13.1.5.5.9.1" style="background-color:#ECECEC;">
            50.63
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.6.6" style="background-color:#ECECEC;">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.6.6.1">
           <span class="ltx_text" id="S3.T1.13.1.6.6.1.1" style="background-color:#ECECEC;">
            Single-Teacher
            <cite class="ltx_cite ltx_citemacro_citep">
             (Li et al.,
             <a class="ltx_ref" href="#bib.bib29" title="">
              2023
             </a>
             ; Magister et al.,
             <a class="ltx_ref" href="#bib.bib32" title="">
              2023
             </a>
             ; Fu et al.,
             <a class="ltx_ref" href="#bib.bib17" title="">
              2023
             </a>
             ; Ho et al.,
             <a class="ltx_ref" href="#bib.bib22" title="">
              2023
             </a>
             )
            </cite>
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.6.6.2">
           <span class="ltx_text" id="S3.T1.13.1.6.6.2.1" style="background-color:#ECECEC;">
            GPT-4
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.6.6.3">
           <span class="ltx_text ltx_font_smallcaps" id="S3.T1.13.1.6.6.3.1" style="background-color:#ECECEC;">
            SiT
            <span class="ltx_text ltx_font_upright" id="S3.T1.13.1.6.6.3.1.1">
             -GPT4
            </span>
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.6.6.4">
           <span class="ltx_text" id="S3.T1.13.1.6.6.4.1" style="background-color:#ECECEC;">
            69.96
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.6.6.5">
           <span class="ltx_text" id="S3.T1.13.1.6.6.5.1" style="background-color:#ECECEC;">
            66.87
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.6.6.6">
           <span class="ltx_text" id="S3.T1.13.1.6.6.6.1" style="background-color:#ECECEC;">
            68.91
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.6.6.7">
           <span class="ltx_text" id="S3.T1.13.1.6.6.7.1" style="background-color:#ECECEC;">
            47.38
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.13.1.6.6.8">
           <span class="ltx_text" id="S3.T1.13.1.6.6.8.1" style="background-color:#ECECEC;">
            8.24
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.6.6.9">
           <span class="ltx_text" id="S3.T1.13.1.6.6.9.1" style="background-color:#ECECEC;">
            52.27
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.7.7">
          <th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.7.7.1">
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.7.7.2">
           <span class="ltx_text" id="S3.T1.13.1.7.7.2.1" style="background-color:#E6E6FF;">
            Round-0 Nodes
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.13.1.7.7.3">
           <span class="ltx_text ltx_font_smallcaps" id="S3.T1.13.1.7.7.3.1" style="background-color:#E6E6FF;">
            MAGDi
            <span class="ltx_text ltx_font_upright" id="S3.T1.13.1.7.7.3.1.1">
             -R0 [Level 1]
            </span>
           </span>
          </th>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.7.7.4">
           <span class="ltx_text" id="S3.T1.13.1.7.7.4.1" style="background-color:#E6E6FF;">
            71.18
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.7.7.5">
           <span class="ltx_text" id="S3.T1.13.1.7.7.5.1" style="background-color:#E6E6FF;">
            67.36
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.7.7.6">
           <span class="ltx_text" id="S3.T1.13.1.7.7.6.1" style="background-color:#E6E6FF;">
            72.06
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.7.7.7">
           <span class="ltx_text" id="S3.T1.13.1.7.7.7.1" style="background-color:#E6E6FF;">
            48.52
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.13.1.7.7.8">
           <span class="ltx_text" id="S3.T1.13.1.7.7.8.1" style="background-color:#E6E6FF;">
            9.72
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.1.7.7.9">
           <span class="ltx_text" id="S3.T1.13.1.7.7.9.1" style="background-color:#E6E6FF;">
            53.77 [
            <span class="ltx_text" id="S3.T1.13.1.7.7.9.1.1" style="color:#009B55;background-color:#E6E6FF;">
             + 1.50%
            </span>
            ]
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.8.8">
          <th class="ltx_td ltx_th ltx_th_row" id="S3.T1.13.1.8.8.1">
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.8.8.2">
           <span class="ltx_text" id="S3.T1.13.1.8.8.2.1" style="background-color:#E6E6FF;">
            Correct Nodes
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.8.8.3">
           <span class="ltx_text ltx_font_smallcaps" id="S3.T1.13.1.8.8.3.1" style="background-color:#E6E6FF;">
            MAGDi
            <span class="ltx_text ltx_font_upright" id="S3.T1.13.1.8.8.3.1.1">
             -CN [Level 2]
            </span>
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.8.8.4">
           <span class="ltx_text" id="S3.T1.13.1.8.8.4.1" style="background-color:#E6E6FF;">
            71.62
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.8.8.5">
           <span class="ltx_text" id="S3.T1.13.1.8.8.5.1" style="background-color:#E6E6FF;">
            69.31
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.8.8.6">
           <span class="ltx_text" id="S3.T1.13.1.8.8.6.1" style="background-color:#E6E6FF;">
            72.34
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.8.8.7">
           <span class="ltx_text" id="S3.T1.13.1.8.8.7.1" style="background-color:#E6E6FF;">
            50.11
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.13.1.8.8.8">
           <span class="ltx_text" id="S3.T1.13.1.8.8.8.1" style="background-color:#E6E6FF;">
            10.66
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.8.8.9">
           <span class="ltx_text" id="S3.T1.13.1.8.8.9.1" style="background-color:#E6E6FF;">
            54.81 [
            <span class="ltx_text" id="S3.T1.13.1.8.8.9.1.1" style="color:#009B55;background-color:#E6E6FF;">
             + 2.54%
            </span>
            ]
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.9.9">
          <th class="ltx_td ltx_th ltx_th_row" id="S3.T1.13.1.9.9.1">
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.9.9.2">
           <span class="ltx_text" id="S3.T1.13.1.9.9.2.1" style="background-color:#E6E6FF;">
            All Nodes
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.13.1.9.9.3">
           <span class="ltx_text ltx_font_smallcaps" id="S3.T1.13.1.9.9.3.1" style="background-color:#E6E6FF;">
            MAGDi
            <span class="ltx_text ltx_font_upright" id="S3.T1.13.1.9.9.3.1.1">
             -AN [Level 3]
            </span>
           </span>
          </th>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.9.9.4">
           <span class="ltx_text" id="S3.T1.13.1.9.9.4.1" style="background-color:#E6E6FF;">
            72.10
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.9.9.5">
           <span class="ltx_text" id="S3.T1.13.1.9.9.5.1" style="background-color:#E6E6FF;">
            70.65
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.9.9.6">
           <span class="ltx_text" id="S3.T1.13.1.9.9.6.1" style="background-color:#E6E6FF;">
            71.92
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.9.9.7">
           <span class="ltx_text" id="S3.T1.13.1.9.9.7.1" style="background-color:#E6E6FF;">
            50.69
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.13.1.9.9.8">
           <span class="ltx_text" id="S3.T1.13.1.9.9.8.1" style="background-color:#E6E6FF;">
            11.98
           </span>
          </td>
          <td class="ltx_td ltx_align_center" id="S3.T1.13.1.9.9.9">
           <span class="ltx_text" id="S3.T1.13.1.9.9.9.1" style="background-color:#E6E6FF;">
            55.47 [
            <span class="ltx_text" id="S3.T1.13.1.9.9.9.1.1" style="color:#009B55;background-color:#E6E6FF;">
             + 3.20%
            </span>
            ]
           </span>
          </td>
         </tr>
         <tr class="ltx_tr" id="S3.T1.13.1.10.10" style="background-color:#E6E6FF;">
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.13.1.10.10.1">
           <span class="ltx_text" id="S3.T1.13.1.10.10.1.1" style="background-color:#E6E6FF;">
            Multi-Teacher (Ours)
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.13.1.10.10.2">
           <span class="ltx_text" id="S3.T1.13.1.10.10.2.1" style="background-color:#E6E6FF;">
            MAG
           </span>
          </th>
          <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.13.1.10.10.3">
           <span class="ltx_text ltx_font_smallcaps" id="S3.T1.13.1.10.10.3.1" style="background-color:#E6E6FF;">
            MAGDi
            <span class="ltx_text ltx_font_upright" id="S3.T1.13.1.10.10.3.1.1">
             [Level 4]
            </span>
           </span>
          </th>
          <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.13.1.10.10.4">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.10.10.4.1" style="background-color:#E6E6FF;">
            74.24
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.13.1.10.10.5">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.10.10.5.1" style="background-color:#E6E6FF;">
            72.56
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.13.1.10.10.6">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.10.10.6.1" style="background-color:#E6E6FF;">
            72.61
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.13.1.10.10.7">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.10.10.7.1" style="background-color:#E6E6FF;">
            52.27
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.13.1.10.10.8">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.10.10.8.1" style="background-color:#E6E6FF;">
            12.76
           </span>
          </td>
          <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.13.1.10.10.9">
           <span class="ltx_text ltx_font_bold" id="S3.T1.13.1.10.10.9.1" style="background-color:#E6E6FF;">
            56.88 [
            <span class="ltx_text" id="S3.T1.13.1.10.10.9.1.1" style="color:#009B55;">
             + 4.61%
            </span>
            ]
           </span>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
     </div>
    </figure>
   </section>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Experimental Setup
  </h2>
  <div class="ltx_para ltx_noindent" id="S4.p1">
   <p class="ltx_p" id="S4.p1.1">
    <span class="ltx_text ltx_font_bold" id="S4.p1.1.1">
     Implementation Details.
    </span>
    We test our structured distillation method,
    <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.2">
     MAGDi
    </span>
    , with three instruction-tuned student models that are of different scales and belong to different model families: Mistral-7B-Instruct, LLaMA-2-7B-Chat, and LLaMA-2-13B-Chat.
We train both task-specific distilled models (i.e., trained and tested on a single downstream task) and also one joint multi-task distilled model (trained on all in-domain tasks together and then tested on each in-domain and out-of-domain task). The multi-task model represents our unified model for OOD tasks. For conciseness, we refer
    <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.3">
     MAGDi
    </span>
    to the
    <em class="ltx_emph ltx_font_italic" id="S4.p1.1.4">
     resultant task-specific models
    </em>
    and
    <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.5">
     MAGDi
    </span>
    -MT will refer to the
    <em class="ltx_emph ltx_font_italic" id="S4.p1.1.6">
     resultant multi-task model
    </em>
    . See Appendix
    <a class="ltx_ref" href="#A1" title="Appendix A Implementation Details of MAGDi">
     <span class="ltx_text ltx_ref_tag">
      A
     </span>
    </a>
    for other implementation details.
   </p>
  </div>
  <section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
   <h4 class="ltx_title ltx_title_paragraph">
    Baselines.
   </h4>
   <div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p1">
    <p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.1">
     We group all methods into three categories of ‘Distillation Source Type’, described as follows.
     <span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px1.p1.1.1">
      (1) No Teacher.
     </span>
     The lower bound of our distilled models is the zero-shot base model (e.g., Mistral-7B-Instruct).
     <span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px1.p1.1.2">
      (2) Single-Teacher.
     </span>
     Our next set of baselines only uses training data from a single teacher (out of the three agents used to construct MAGs). This follows multiple prior works
     <cite class="ltx_cite ltx_citemacro_citep">
      (Li et al.,
      <a class="ltx_ref" href="#bib.bib29" title="">
       2023
      </a>
      ; Magister et al.,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2023
      </a>
      ; Fu et al.,
      <a class="ltx_ref" href="#bib.bib17" title="">
       2023
      </a>
      ; Ho et al.,
      <a class="ltx_ref" href="#bib.bib22" title="">
       2023
      </a>
      )
     </cite>
     that fine-tune student models on CoT reasoning using the next-token prediction objective (Equation
     <a class="ltx_ref" href="#S3.E1" title="Equation 1 ‣ 3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ). In particular, we fine-tune three student models with one of GPT-4, Bard, or Claude2 as the teacher using
     <em class="ltx_emph ltx_font_italic" id="S4.SS0.SSS0.Px1.p1.1.3">
      only
     </em>
     the positive samples from the respective teacher model. We will refer to these
     <span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px1.p1.1.4">
      Si
     </span>
     ngle-
     <span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px1.p1.1.5">
      T
     </span>
     eacher distilled models as
     <span class="ltx_text ltx_font_smallcaps" id="S4.SS0.SSS0.Px1.p1.1.6">
      SiT
     </span>
     . Then
     <span class="ltx_text ltx_font_smallcaps" id="S4.SS0.SSS0.Px1.p1.1.7">
      SiT
     </span>
     -GPT4, for example, will refer to a distilled model trained with only GPT4 as the teacher.
     <span class="ltx_text ltx_font_bold" id="S4.SS0.SSS0.Px1.p1.1.8">
      (3) Multi-Teacher.
     </span>
     Multi-teacher models correspond to distilled models trained with variants of our proposed
     <span class="ltx_text ltx_font_smallcaps" id="S4.SS0.SSS0.Px1.p1.1.9">
      MAGDi
     </span>
     method. Hence, these also directly demonstrate the utility of the levels in Fig.
     <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
    </p>
    <ul class="ltx_itemize" id="S4.I1">
     <li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S4.I1.i1.p1">
       <p class="ltx_p" id="S4.I1.i1.p1.1">
        <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.I1.i1.p1.1.1">
         MAGDi
         <span class="ltx_text ltx_font_upright" id="S4.I1.i1.p1.1.1.1">
          -R0 (Level 1).
         </span>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S4.I1.i1.p1.1.2">
         MAGDi
        </span>
        -R0 refers to a model that is fine-tuned only on the
        <em class="ltx_emph ltx_font_italic" id="S4.I1.i1.p1.1.3">
         Round-0
        </em>
        (pre-interaction) correct reasoning of multiple teachers (i.e., GPT-4, Bard, and Claude2) using only the
        <math alttext="\mathcal{L}^{+}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1">
         <semantics id="S4.I1.i1.p1.1.m1.1a">
          <msup id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mo id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">
            +
           </mo>
          </msup>
          <annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b">
           <apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">
             superscript
            </csymbol>
            <ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">
             ℒ
            </ci>
            <plus id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">
            </plus>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">
           \mathcal{L}^{+}
          </annotation>
         </semantics>
        </math>
        objective defined in Eqn.
        <a class="ltx_ref" href="#S3.E1" title="Equation 1 ‣ 3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
         <span class="ltx_text ltx_ref_tag">
          1
         </span>
        </a>
        , i.e., Level 1 of
        <span class="ltx_text ltx_font_smallcaps" id="S4.I1.i1.p1.1.4">
         MAGDi
        </span>
        .
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S4.I1.i2.p1">
       <p class="ltx_p" id="S4.I1.i2.p1.1">
        <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.I1.i2.p1.1.1">
         MAGDi
         <span class="ltx_text ltx_font_upright" id="S4.I1.i2.p1.1.1.1">
          -CN (Level 2).
         </span>
        </span>
        Next,
        <span class="ltx_text ltx_font_smallcaps" id="S4.I1.i2.p1.1.2">
         MAGDi
        </span>
        -CN is a distilled model that is trained on
        <em class="ltx_emph ltx_font_italic" id="S4.I1.i2.p1.1.3">
         all correct
        </em>
        (pre- and post-interaction) reasoning from all teachers with again the same
        <math alttext="\mathcal{L}^{+}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1">
         <semantics id="S4.I1.i2.p1.1.m1.1a">
          <msup id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mo id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml">
            +
           </mo>
          </msup>
          <annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b">
           <apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">
             superscript
            </csymbol>
            <ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">
             ℒ
            </ci>
            <plus id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">
            </plus>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">
           \mathcal{L}^{+}
          </annotation>
         </semantics>
        </math>
        loss, corresponding to Level 2 of
        <span class="ltx_text ltx_font_smallcaps" id="S4.I1.i2.p1.1.4">
         MAGDi
        </span>
        .
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S4.I1.i3.p1">
       <p class="ltx_p" id="S4.I1.i3.p1.2">
        <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.I1.i3.p1.2.1">
         MAGDi
         <span class="ltx_text ltx_font_upright" id="S4.I1.i3.p1.2.1.1">
          -AN (Level 3).
         </span>
        </span>
        Going one step further,
        <span class="ltx_text ltx_font_smallcaps" id="S4.I1.i3.p1.2.2">
         MAGDi
        </span>
        -AN is a distilled model that is trained on
        <em class="ltx_emph ltx_font_italic" id="S4.I1.i3.p1.2.3">
         all nodes
        </em>
        (correct and incorrect) from all teachers. Hence, this is trained with both
        <math alttext="\mathcal{L}^{+}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1">
         <semantics id="S4.I1.i3.p1.1.m1.1a">
          <msup id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S4.I1.i3.p1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.2.cmml">
            ℒ
           </mi>
           <mo id="S4.I1.i3.p1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.3.cmml">
            +
           </mo>
          </msup>
          <annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b">
           <apply id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">
             superscript
            </csymbol>
            <ci id="S4.I1.i3.p1.1.m1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.2">
             ℒ
            </ci>
            <plus id="S4.I1.i3.p1.1.m1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3">
            </plus>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">
           \mathcal{L}^{+}
          </annotation>
         </semantics>
        </math>
        and
        <math alttext="\mathcal{L}^{-}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.1">
         <semantics id="S4.I1.i3.p1.2.m2.1a">
          <msup id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S4.I1.i3.p1.2.m2.1.1.2" xref="S4.I1.i3.p1.2.m2.1.1.2.cmml">
            ℒ
           </mi>
           <mo id="S4.I1.i3.p1.2.m2.1.1.3" xref="S4.I1.i3.p1.2.m2.1.1.3.cmml">
            −
           </mo>
          </msup>
          <annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b">
           <apply id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">
            <csymbol cd="ambiguous" id="S4.I1.i3.p1.2.m2.1.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">
             superscript
            </csymbol>
            <ci id="S4.I1.i3.p1.2.m2.1.1.2.cmml" xref="S4.I1.i3.p1.2.m2.1.1.2">
             ℒ
            </ci>
            <minus id="S4.I1.i3.p1.2.m2.1.1.3.cmml" xref="S4.I1.i3.p1.2.m2.1.1.3">
            </minus>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">
           \mathcal{L}^{-}
          </annotation>
         </semantics>
        </math>
        objectives in Equations
        <a class="ltx_ref" href="#S3.E1" title="Equation 1 ‣ 3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
         <span class="ltx_text ltx_ref_tag">
          1
         </span>
        </a>
        and
        <a class="ltx_ref" href="#S3.E2" title="Equation 2 ‣ 3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
         <span class="ltx_text ltx_ref_tag">
          2
         </span>
        </a>
        .
Note that all three models for Levels 1-3 are
        <em class="ltx_emph ltx_font_italic" id="S4.I1.i3.p1.2.4">
         unstructured
        </em>
        multi-teacher distilled models that view MAGs as a set of correct and incorrect nodes.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para ltx_noindent" id="S4.I1.i4.p1">
       <p class="ltx_p" id="S4.I1.i4.p1.1">
        <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.I1.i4.p1.1.1">
         MAGDi
         <span class="ltx_text ltx_font_upright" id="S4.I1.i4.p1.1.1.1">
          (Level 4).
         </span>
        </span>
        This is our final full method that distills knowledge from
        <em class="ltx_emph ltx_font_italic" id="S4.I1.i4.p1.1.2">
         all nodes and edges
        </em>
        of a MAG using all three objectives as described in Equation
        <a class="ltx_ref" href="#S3.E4" title="Equation 4 ‣ 3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
         <span class="ltx_text ltx_ref_tag">
          4
         </span>
        </a>
        .
       </p>
      </div>
     </li>
    </ul>
   </div>
   <figure class="ltx_table" id="S4.T2">
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 2:
     </span>
     Comparison of the token counts generated by
     <span class="ltx_text ltx_font_smallcaps" id="S4.T2.3.1">
      ReConcile
     </span>
     (a multi-agent interaction framework) and
     <span class="ltx_text ltx_font_smallcaps" id="S4.T2.4.2">
      MAGDi
     </span>
     .
    </figcaption>
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.5" style="width:411.9pt;height:228.8pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(92.5pt,-51.4pt) scale(1.81592293532094,1.81592293532094) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.5.1">
       <thead class="ltx_thead">
        <tr class="ltx_tr" id="S4.T2.5.1.1.1">
         <th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S4.T2.5.1.1.1.1">
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.5.1.1.1.2">
          <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T2.5.1.1.1.2.1">
           ReConcile
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.5.1.1.1.3">
          <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T2.5.1.1.1.3.1">
           MAGDi
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.5.1.1.1.4">
          <span class="ltx_text ltx_font_bold" id="S4.T2.5.1.1.1.4.1">
           Reduction
          </span>
         </th>
        </tr>
       </thead>
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S4.T2.5.1.2.1">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.5.1.2.1.1">
          StrategyQA
         </th>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.1.2">
          924.5
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.1.3">
          107.5
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.1.4">
          8.6x
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.5.1.3.2">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.5.1.3.2.1">
          CSQA
         </th>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.3.2.2">
          936.9
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.3.2.3">
          104.2
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.3.2.4">
          9.0x
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.5.1.4.3">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.5.1.4.3.1">
          ARC-c
         </th>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.3.2">
          448.3
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.3.3">
          86.4
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.3.4">
          5.2x
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.5.1.5.4">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.5.1.5.4.1">
          GSM8K
         </th>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.4.2">
          642.3
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.4.3">
          141.6
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.4.4">
          4.5x
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.5.1.6.5">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.5.1.6.5.1">
          MATH
         </th>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.5.2">
          1900.1
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.5.3">
          645.0
         </td>
         <td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.5.4">
          2.9x
         </td>
        </tr>
        <tr class="ltx_tr" id="S4.T2.5.1.7.6">
         <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T2.5.1.7.6.1">
          Average
         </th>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.1.7.6.2">
          970.4
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.1.7.6.3">
          216.9
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.1.7.6.4">
          4.5x
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
   </figure>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Results and Analysis
  </h2>
  <section class="ltx_subsection" id="S5.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.1
    </span>
    Main Results
   </h3>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p1">
    <p class="ltx_p" id="S5.SS1.p1.1">
     Our primary results demonstrate the effectiveness of
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.1">
      MAGDi
     </span>
     across five reasoning benchmarks over different single-teacher and multi-teacher distillation setups. For the main results, we use Mistral-7B-Instruct as the student model and train task-specific distilled models (see Sec.
     <a class="ltx_ref" href="#S5.SS2" title="5.2 Analysis: Generalizability, Scalability, Diversity ‣ 5 Results and Analysis">
      <span class="ltx_text ltx_ref_tag">
       5.2
      </span>
     </a>
     for experiments with multi-task models with larger students belonging to different model families). We report accuracy for each task. Based on Table
     <a class="ltx_ref" href="#S3.T1" title="Table 1 ‣ MAGDi Inference. ‣ 3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     results, we summarize our main conclusions below, addressing our research question posed in
     <a class="ltx_ref" href="#S1" title="1 Introduction">
      <span class="ltx_text ltx_ref_tag">
       Section
      </span>
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     : How can we distill diverse teacher interactions into a smaller and more efficient student, utilizing the
     <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.2">
      increasing levels of interaction structure in a MAG
     </em>
     ?
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p2">
    <p class="ltx_p" id="S5.SS1.p2.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">
      Level 1: Distillation from multiple teachers outperforms distillation from the single strongest teacher.
     </span>
     Knowledge distillation from the correct reasoning chains of multiple teachers i.e., GPT-4, Bard, and Claude2, outperforms distillation from the single strongest teacher by an average of 1.50% (see
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p2.1.2">
      MAGDi
     </span>
     -R0 row versus
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p2.1.3">
      SiT
     </span>
     -GPT4 row). Different teachers bring diversity in their reasoning, leading to improved reasoning capabilities of the student model.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p3">
    <p class="ltx_p" id="S5.SS1.p3.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">
      Level 2: Distillation from pre- and post-interaction reasoning outperforms only pre-interaction reasoning.
     </span>
     Training a student model on all correct reasoning chains after multiple teacher models have interacted further improves the student’s reasoning. Fine-tuning on post-interaction reasoning chains effectively increases the training data and its usefulness is validated through an overall 2.54% improvement, compared to the best single-teacher model (see
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p3.1.2">
      MAGDi
     </span>
     -CN row versus
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p3.1.3">
      SiT
     </span>
     -GPT4 row).
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p4">
    <p class="ltx_p" id="S5.SS1.p4.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">
      Level 3: Negative reasoning chains further improve distillation.
     </span>
     A student model that additionally learns by contrasting between positive and negative chains improves over all previous levels and the single-teacher baselines. Our
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p4.1.2">
      MAGDi
     </span>
     -AN model obtains an overall average improvement of 3.20% (see
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p4.1.3">
      MAGDi
     </span>
     -AN row versus
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p4.1.4">
      SiT
     </span>
     -GPT4 row).
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p5">
    <p class="ltx_p" id="S5.SS1.p5.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p5.1.1">
      Level 4: Structured distillation from interactions outperforms all multi-teacher baselines.
     </span>
     Our final structured distillation method,
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p5.1.2">
      MAGDi
     </span>
     , that distills knowledge from both the outputs (nodes) and structure (edges) of multi-agent interactions, obtains the largest improvement and outperforms all single- and multi-teacher models. When applied to Mistral-7B-Instruct,
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p5.1.3">
      MAGDi
     </span>
     surpasses a model that learns only from GPT4 by an average of 4.61%.
Out of all the levels, distillation from interactions brings the most improvements (both individually and across all five benchmarks), specifically demonstrating the utility of modeling the conversation structure of multi-agent discussions. Overall, compared to the base model,
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p5.1.4">
      MAGDi
     </span>
     improves the student’s reasoning capabilities by a significant 10.71% (46.17
     <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.SS1.p5.1.m1.1">
      <semantics id="S5.SS1.p5.1.m1.1a">
       <mo id="S5.SS1.p5.1.m1.1.1" stretchy="false" xref="S5.SS1.p5.1.m1.1.1.cmml">
        →
       </mo>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p5.1.m1.1b">
        <ci id="S5.SS1.p5.1.m1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1">
         →
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p5.1.m1.1c">
        \rightarrow
       </annotation>
      </semantics>
     </math>
     56.88) while maintaining similar inference-time efficiency.
    </p>
   </div>
   <figure class="ltx_figure" id="S5.F4">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="196" id="S5.F4.g1" src="/html/2402.01620/assets/x8.png" width="461"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 4:
     </span>
     Trade-off between performance and efficiency.
     <span class="ltx_text ltx_font_smallcaps" id="S5.F4.5.1">
      MAGDi
     </span>
     exceeds the Pareto frontier of prior work, surpassing single-teacher models in performance and surpassing
     <span class="ltx_text ltx_font_smallcaps" id="S5.F4.6.2">
      ReConcile
     </span>
     in efficiency, defined as
     <math alttext="1/avg(tokens)" class="ltx_Math" display="inline" id="S5.F4.2.m1.1">
      <semantics id="S5.F4.2.m1.1b">
       <mrow id="S5.F4.2.m1.1.1" xref="S5.F4.2.m1.1.1.cmml">
        <mrow id="S5.F4.2.m1.1.1.3" xref="S5.F4.2.m1.1.1.3.cmml">
         <mn id="S5.F4.2.m1.1.1.3.2" xref="S5.F4.2.m1.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S5.F4.2.m1.1.1.3.1" xref="S5.F4.2.m1.1.1.3.1.cmml">
          /
         </mo>
         <mi id="S5.F4.2.m1.1.1.3.3" xref="S5.F4.2.m1.1.1.3.3.cmml">
          a
         </mi>
        </mrow>
        <mo id="S5.F4.2.m1.1.1.2" lspace="0em" rspace="0em" xref="S5.F4.2.m1.1.1.2.cmml">
         ​
        </mo>
        <mi id="S5.F4.2.m1.1.1.4" xref="S5.F4.2.m1.1.1.4.cmml">
         v
        </mi>
        <mo id="S5.F4.2.m1.1.1.2b" lspace="0em" rspace="0em" xref="S5.F4.2.m1.1.1.2.cmml">
         ​
        </mo>
        <mi id="S5.F4.2.m1.1.1.5" xref="S5.F4.2.m1.1.1.5.cmml">
         g
        </mi>
        <mo id="S5.F4.2.m1.1.1.2c" lspace="0em" rspace="0em" xref="S5.F4.2.m1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S5.F4.2.m1.1.1.1.1" xref="S5.F4.2.m1.1.1.1.1.1.cmml">
         <mo id="S5.F4.2.m1.1.1.1.1.2" stretchy="false" xref="S5.F4.2.m1.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S5.F4.2.m1.1.1.1.1.1" xref="S5.F4.2.m1.1.1.1.1.1.cmml">
          <mi id="S5.F4.2.m1.1.1.1.1.1.2" xref="S5.F4.2.m1.1.1.1.1.1.2.cmml">
           t
          </mi>
          <mo id="S5.F4.2.m1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="S5.F4.2.m1.1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="S5.F4.2.m1.1.1.1.1.1.3" xref="S5.F4.2.m1.1.1.1.1.1.3.cmml">
           o
          </mi>
          <mo id="S5.F4.2.m1.1.1.1.1.1.1b" lspace="0em" rspace="0em" xref="S5.F4.2.m1.1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="S5.F4.2.m1.1.1.1.1.1.4" xref="S5.F4.2.m1.1.1.1.1.1.4.cmml">
           k
          </mi>
          <mo id="S5.F4.2.m1.1.1.1.1.1.1c" lspace="0em" rspace="0em" xref="S5.F4.2.m1.1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="S5.F4.2.m1.1.1.1.1.1.5" xref="S5.F4.2.m1.1.1.1.1.1.5.cmml">
           e
          </mi>
          <mo id="S5.F4.2.m1.1.1.1.1.1.1d" lspace="0em" rspace="0em" xref="S5.F4.2.m1.1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="S5.F4.2.m1.1.1.1.1.1.6" xref="S5.F4.2.m1.1.1.1.1.1.6.cmml">
           n
          </mi>
          <mo id="S5.F4.2.m1.1.1.1.1.1.1e" lspace="0em" rspace="0em" xref="S5.F4.2.m1.1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="S5.F4.2.m1.1.1.1.1.1.7" xref="S5.F4.2.m1.1.1.1.1.1.7.cmml">
           s
          </mi>
         </mrow>
         <mo id="S5.F4.2.m1.1.1.1.1.3" stretchy="false" xref="S5.F4.2.m1.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.F4.2.m1.1c">
        <apply id="S5.F4.2.m1.1.1.cmml" xref="S5.F4.2.m1.1.1">
         <times id="S5.F4.2.m1.1.1.2.cmml" xref="S5.F4.2.m1.1.1.2">
         </times>
         <apply id="S5.F4.2.m1.1.1.3.cmml" xref="S5.F4.2.m1.1.1.3">
          <divide id="S5.F4.2.m1.1.1.3.1.cmml" xref="S5.F4.2.m1.1.1.3.1">
          </divide>
          <cn id="S5.F4.2.m1.1.1.3.2.cmml" type="integer" xref="S5.F4.2.m1.1.1.3.2">
           1
          </cn>
          <ci id="S5.F4.2.m1.1.1.3.3.cmml" xref="S5.F4.2.m1.1.1.3.3">
           𝑎
          </ci>
         </apply>
         <ci id="S5.F4.2.m1.1.1.4.cmml" xref="S5.F4.2.m1.1.1.4">
          𝑣
         </ci>
         <ci id="S5.F4.2.m1.1.1.5.cmml" xref="S5.F4.2.m1.1.1.5">
          𝑔
         </ci>
         <apply id="S5.F4.2.m1.1.1.1.1.1.cmml" xref="S5.F4.2.m1.1.1.1.1">
          <times id="S5.F4.2.m1.1.1.1.1.1.1.cmml" xref="S5.F4.2.m1.1.1.1.1.1.1">
          </times>
          <ci id="S5.F4.2.m1.1.1.1.1.1.2.cmml" xref="S5.F4.2.m1.1.1.1.1.1.2">
           𝑡
          </ci>
          <ci id="S5.F4.2.m1.1.1.1.1.1.3.cmml" xref="S5.F4.2.m1.1.1.1.1.1.3">
           𝑜
          </ci>
          <ci id="S5.F4.2.m1.1.1.1.1.1.4.cmml" xref="S5.F4.2.m1.1.1.1.1.1.4">
           𝑘
          </ci>
          <ci id="S5.F4.2.m1.1.1.1.1.1.5.cmml" xref="S5.F4.2.m1.1.1.1.1.1.5">
           𝑒
          </ci>
          <ci id="S5.F4.2.m1.1.1.1.1.1.6.cmml" xref="S5.F4.2.m1.1.1.1.1.1.6">
           𝑛
          </ci>
          <ci id="S5.F4.2.m1.1.1.1.1.1.7.cmml" xref="S5.F4.2.m1.1.1.1.1.1.7">
           𝑠
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.F4.2.m1.1d">
        1/avg(tokens)
       </annotation>
      </semantics>
     </math>
     .
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p6">
    <p class="ltx_p" id="S5.SS1.p6.1">
     <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.SS1.p6.1.1">
      MAGDi
      <span class="ltx_text ltx_font_upright" id="S5.SS1.p6.1.1.1">
       improves inference efficiency compared to
      </span>
      ReConcile
      <span class="ltx_text ltx_font_upright" id="S5.SS1.p6.1.1.2">
       .
      </span>
     </span>
     Compared to
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.2">
      ReConcile
     </span>
     ,
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.3">
      MAGDi
     </span>
     also drastically improves inference efficiency.
Because the sizes of gated models like those used in
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.4">
      ReConcile
     </span>
     are not known, we measure efficiency via number of output tokens generated.
     <span class="ltx_note ltx_role_footnote" id="footnote4">
      <sup class="ltx_note_mark">
       4
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         4
        </sup>
        <span class="ltx_tag ltx_tag_note">
         4
        </span>
        This metric is extremely strict and under-estimates our efficiency gains, as each of the gated LLMs used by
        <span class="ltx_text ltx_font_smallcaps" id="footnote4.1">
         ReConcile
        </span>
        exceeds 7B parameters, and each example for
        <span class="ltx_text ltx_font_smallcaps" id="footnote4.2">
         ReConcile
        </span>
        involves multiple inference calls.
       </span>
      </span>
     </span>
     As shown in Table
     <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ Baselines. ‣ 4 Experimental Setup">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     ,
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.5">
      MAGDi
     </span>
     achieves up to a
     <math alttext="9" class="ltx_Math" display="inline" id="S5.SS1.p6.1.m1.1">
      <semantics id="S5.SS1.p6.1.m1.1a">
       <mn id="S5.SS1.p6.1.m1.1.1" xref="S5.SS1.p6.1.m1.1.1.cmml">
        9
       </mn>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p6.1.m1.1b">
        <cn id="S5.SS1.p6.1.m1.1.1.cmml" type="integer" xref="S5.SS1.p6.1.m1.1.1">
         9
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p6.1.m1.1c">
        9
       </annotation>
      </semantics>
     </math>
     x reduction in token count.
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.6">
      MAGDi
     </span>
     obtains this efficiency by always answering questions in one inference call; this differs from
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.7">
      ReConcile
     </span>
     which has to go through up to twelve (expensive) LLM inference calls (involving 3 agents for the initial round and another 3 rounds).
Moreover,
     <a class="ltx_ref" href="#S5.F4" title="In 5.1 Main Results ‣ 5 Results and Analysis">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     shows the trade-off between token efficiency and performance (averaged across datasets).
While
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.8">
      ReConcile
     </span>
     (as the upper-bound) has the best performance, it also produces the most tokens (cf.
     <a class="ltx_ref" href="#S4.T2" title="In Baselines. ‣ 4 Experimental Setup">
      <span class="ltx_text ltx_ref_tag">
       Table
      </span>
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     ); the zero-shot and single-teacher models are more efficient than
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.9">
      ReConcile
     </span>
     but suffer in terms of performance.
On the other hand,
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.10">
      MAGDi
     </span>
     achieves a better balance of efficiency and performance than these baselines, with more efficiency than
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p6.1.11">
      ReConcile
     </span>
     and higher performance than the zero-shot and prior single-teacher distillation methods.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.2
    </span>
    Analysis: Generalizability, Scalability, Diversity
   </h3>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p1">
    <p class="ltx_p" id="S5.SS2.p1.1">
     <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.SS2.p1.1.1">
      MAGDi
      <span class="ltx_text ltx_font_upright" id="S5.SS2.p1.1.1.1">
       can be used to train one joint multi-task model.
      </span>
     </span>
     In our main experiments (Sec.
     <a class="ltx_ref" href="#S5.SS1" title="5.1 Main Results ‣ 5 Results and Analysis">
      <span class="ltx_text ltx_ref_tag">
       5.1
      </span>
     </a>
     ), we fine-tuned task-specific models with structured distillation. While these multi-teacher task-specific models show clear benefits over single-teacher models, we would ideally like
     <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.1.2">
      one joint
     </em>
     model that can tackle all tasks. Therefore, we train a joint multi-task model (
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p1.1.3">
      MAGDi
     </span>
     -MT) by combining training data from all five benchmarks and evaluating it together on all benchmarks.
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p1.1.4">
      MAGDi
     </span>
     -MT obtains an average accuracy that is within 1% of task-specific models (56.89% versus 55.12%), showing its applicability for training a joint model (refer to Appendix Table
     <a class="ltx_ref" href="#A2.T9" title="Table 9 ‣ Appendix B Further Analyses of MAGDi">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     for the full table).
    </p>
   </div>
   <figure class="ltx_table" id="S5.T3">
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 3:
     </span>
     Out-of-domain comparison between Single-Teacher Multi-Task (
     <span class="ltx_text ltx_font_smallcaps" id="S5.T3.5.1">
      SiT
     </span>
     -GPT4-MT) and
     <span class="ltx_text ltx_font_smallcaps" id="S5.T3.6.2">
      MAGDi
     </span>
     Multi-Task (
     <span class="ltx_text ltx_font_smallcaps" id="S5.T3.7.3">
      MAGDi
     </span>
     -MT) models.
     <span class="ltx_text ltx_font_smallcaps" id="S5.T3.8.4">
      MAGDi
     </span>
     -MT performs up to 7% better than the single-teacher baseline even on OOD datasets (57.52 vs. 64.30).
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.9">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S5.T3.9.1.1">
       <th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T3.9.1.1.1">
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.9.1.1.2">
        <span class="ltx_text ltx_font_bold" id="S5.T3.9.1.1.2.1">
         BoolQ
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.9.1.1.3">
        <span class="ltx_text ltx_font_bold" id="S5.T3.9.1.1.3.1">
         SVAMP
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T3.9.2.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.9.2.1.1">
        SiT-GPT4-MT
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.2.1.2">
        60.70
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.9.2.1.3">
        57.52
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T3.9.3.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T3.9.3.2.1">
        MAGDi-MT
       </th>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.9.3.2.2">
        <span class="ltx_text ltx_font_bold" id="S5.T3.9.3.2.2.1">
         63.98
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.9.3.2.3">
        <span class="ltx_text ltx_font_bold" id="S5.T3.9.3.2.3.1">
         64.30
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p2">
    <p class="ltx_p" id="S5.SS2.p2.2">
     <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.SS2.p2.2.1">
      MAGDi
      <span class="ltx_text ltx_font_upright" id="S5.SS2.p2.2.1.1">
       generalizes to OOD tasks.
      </span>
     </span>
     We also evaluate
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p2.2.2">
      MAGDi
     </span>
     -MT on two out-of-domain benchmarks (BoolQ for commonsense reasoning and SVAMP for math) that were not included in multi-task training. As shown in Table
     <a class="ltx_ref" href="#S5.T3" title="Table 3 ‣ 5.2 Analysis: Generalizability, Scalability, Diversity ‣ 5 Results and Analysis">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ,
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p2.2.3">
      MAGDi
     </span>
     outperforms single-teacher distillation by to
     <math alttext="3\%" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1">
      <semantics id="S5.SS2.p2.1.m1.1a">
       <mrow id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">
        <mn id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml">
         3
        </mn>
        <mo id="S5.SS2.p2.1.m1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.cmml">
         %
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b">
        <apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">
         <csymbol cd="latexml" id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1">
          percent
         </csymbol>
         <cn id="S5.SS2.p2.1.m1.1.1.2.cmml" type="integer" xref="S5.SS2.p2.1.m1.1.1.2">
          3
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">
        3\%
       </annotation>
      </semantics>
     </math>
     on BoolQ and
     <math alttext="7\%" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.1">
      <semantics id="S5.SS2.p2.2.m2.1a">
       <mrow id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">
        <mn id="S5.SS2.p2.2.m2.1.1.2" xref="S5.SS2.p2.2.m2.1.1.2.cmml">
         7
        </mn>
        <mo id="S5.SS2.p2.2.m2.1.1.1" xref="S5.SS2.p2.2.m2.1.1.1.cmml">
         %
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b">
        <apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">
         <csymbol cd="latexml" id="S5.SS2.p2.2.m2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1.1">
          percent
         </csymbol>
         <cn id="S5.SS2.p2.2.m2.1.1.2.cmml" type="integer" xref="S5.SS2.p2.2.m2.1.1.2">
          7
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">
        7\%
       </annotation>
      </semantics>
     </math>
     on SVAMP. The broader implication of this is that the single takeaway
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p2.2.4">
      MAGDi
     </span>
     -MT model maintains good performance on OOD tasks and continues to outperform single-teacher baselines on new datasets.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p3">
    <p class="ltx_p" id="S5.SS2.p3.1">
     <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.SS2.p3.1.1">
      MAGDi
      <span class="ltx_text ltx_font_upright" id="S5.SS2.p3.1.1.1">
       scales positively with better base models.
      </span>
     </span>
     We now study the scaling properties of structured distillation by varying the base student model. In particular, we train three structurally distilled models with
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p3.1.2">
      MAGDi
     </span>
     , using LLaMA-2-7B-Chat, LLaMA-2-13B-Chat, and Mistral-7B-Instruct as the base models. In Fig.
     <a class="ltx_ref" href="#S5.F5" title="Figure 5 ‣ 5.2 Analysis: Generalizability, Scalability, Diversity ‣ 5 Results and Analysis">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     , we plot the average accuracy of all five benchmarks (and see Table
     <a class="ltx_ref" href="#A2.T5" title="Table 5 ‣ Appendix B Further Analyses of MAGDi">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     for individual results). The ordering of the three models is based on their zero-shot performance. We observe that
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p3.1.3">
      MAGDi
     </span>
     brings consistent improvements over all base models, maintaining proportionate gains. Overall, the scaling trend of
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p3.1.4">
      MAGDi
     </span>
     suggests that structured distillation should continue to improve even stronger students. See Appendix
     <a class="ltx_ref" href="#A2" title="Appendix B Further Analyses of MAGDi">
      <span class="ltx_text ltx_ref_tag">
       B
      </span>
     </a>
     for other analyses of
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p3.1.5">
      MAGDi
     </span>
     e.g., the effect of the amount of training data and different graph structures.
    </p>
   </div>
   <figure class="ltx_figure" id="S5.F5">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="200" id="S5.F5.g1" src="/html/2402.01620/assets/x9.png" width="438"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 5:
     </span>
     Scaling results of
     <span class="ltx_text ltx_font_smallcaps" id="S5.F5.7.1">
      MAGDi
     </span>
     with different base student models. As the average (zero-shot) performance of the base model improves (Mistral-7B
     <math alttext="&gt;" class="ltx_Math" display="inline" id="S5.F5.3.m1.1">
      <semantics id="S5.F5.3.m1.1b">
       <mo id="S5.F5.3.m1.1.1" xref="S5.F5.3.m1.1.1.cmml">
        &gt;
       </mo>
       <annotation-xml encoding="MathML-Content" id="S5.F5.3.m1.1c">
        <gt id="S5.F5.3.m1.1.1.cmml" xref="S5.F5.3.m1.1.1">
        </gt>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.F5.3.m1.1d">
        &gt;
       </annotation>
      </semantics>
     </math>
     LLaMA-2-13B
     <math alttext="&gt;" class="ltx_Math" display="inline" id="S5.F5.4.m2.1">
      <semantics id="S5.F5.4.m2.1b">
       <mo id="S5.F5.4.m2.1.1" xref="S5.F5.4.m2.1.1.cmml">
        &gt;
       </mo>
       <annotation-xml encoding="MathML-Content" id="S5.F5.4.m2.1c">
        <gt id="S5.F5.4.m2.1.1.cmml" xref="S5.F5.4.m2.1.1">
        </gt>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.F5.4.m2.1d">
        &gt;
       </annotation>
      </semantics>
     </math>
     LLaMA-2-7B),
     <span class="ltx_text ltx_font_smallcaps" id="S5.F5.8.2">
      MAGDi
     </span>
     shows a corresponding increase.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S5.T4">
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 4:
     </span>
     Self-consistency with
     <span class="ltx_text ltx_font_smallcaps" id="S5.T4.2.1">
      MAGDi
     </span>
     on GSM8K achieves the largest gain (up to 15%) compared to the same with the base student model and the single-teacher distilled model.
    </figcaption>
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T4.3" style="width:433.6pt;height:77.7pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(66.1pt,-11.9pt) scale(1.43900144529467,1.43900144529467) ;">
      <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.3.1">
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S5.T4.3.1.1.1">
         <td class="ltx_td ltx_border_tt" id="S5.T4.3.1.1.1.1">
         </td>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.3.1.1.1.2">
          <span class="ltx_text ltx_font_bold" id="S5.T4.3.1.1.1.2.1">
           Mistral-7B
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.3.1.1.1.3">
          <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.T4.3.1.1.1.3.1">
           SiT
           <span class="ltx_text ltx_font_upright" id="S5.T4.3.1.1.1.3.1.1">
            -GPT4
           </span>
          </span>
         </th>
         <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.3.1.1.1.4">
          <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.T4.3.1.1.1.4.1">
           MAGDi
          </span>
         </th>
        </tr>
        <tr class="ltx_tr" id="S5.T4.3.1.2.2">
         <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.3.1.2.2.1">
          w/o SC
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.2.2.2">
          44.05
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.2.2.3">
          47.38
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.2.2.4">
          52.27
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T4.3.1.3.3">
         <td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T4.3.1.3.3.1">
          w/ SC
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.3.1.3.3.2">
          48.44 [
          <span class="ltx_text" id="S5.T4.3.1.3.3.2.1" style="color:#009B55;">
           + 4.39%
          </span>
          ]
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.3.1.3.3.3">
          58.62 [
          <span class="ltx_text" id="S5.T4.3.1.3.3.3.1" style="color:#009B55;">
           + 11.24%
          </span>
          ]
         </td>
         <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.3.1.3.3.4">
          <span class="ltx_text ltx_font_bold" id="S5.T4.3.1.3.3.4.1">
           67.42 [
           <span class="ltx_text" id="S5.T4.3.1.3.3.4.1.1" style="color:#009B55;">
            + 15.15%
           </span>
           ]
          </span>
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
   </figure>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p4">
    <p class="ltx_p" id="S5.SS2.p4.1">
     <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S5.SS2.p4.1.1">
      MAGDi
      <span class="ltx_text ltx_font_upright" id="S5.SS2.p4.1.1.1">
       boosts self-consistency.
      </span>
     </span>
     We hypothesize that a student model that learns from
     <em class="ltx_emph ltx_font_italic" id="S5.SS2.p4.1.2">
      multiple teachers
     </em>
     will exhibit better diversity in its generations. To test this, we combine
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p4.1.3">
      MAGDi
     </span>
     with an ensemble method like Self-Consistency (SC)
     <cite class="ltx_cite ltx_citemacro_cite">
      Wang et al. (
      <a class="ltx_ref" href="#bib.bib44" title="">
       2023
      </a>
      )
     </cite>
     . SC computes a majority vote over model answers and has proven effective for reasoning tasks; SC’s improvements are predicated on answer diversity (since a majority vote over the versions of the same answer would not yield any improvements). We show that self-consistency with our
     <em class="ltx_emph ltx_font_italic" id="S5.SS2.p4.1.4">
      multi-teacher distilled model
     </em>
     outperforms the same with (1) the base model and more importantly, (2) a single-teacher distilled model. As shown in Table
     <a class="ltx_ref" href="#S5.T4" title="Table 4 ‣ 5.2 Analysis: Generalizability, Scalability, Diversity ‣ 5 Results and Analysis">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , on GSM8K, SC between 10 responses improves accuracy by 15% when applied to a
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p4.1.5">
      MAGDi
     </span>
     -trained student, compared to only 4% improvement for the base model (Mistral-7B-Instruct) and 11% for the single-teacher model (
     <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p4.1.6">
      SiT
     </span>
     -GPT4). Broadly, this suggests that inference-time algorithms relying on a model’s inherent diversity can be boosted from multi-teacher distillation.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Conclusion
  </h2>
  <div class="ltx_para ltx_noindent" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    We have tackled the problem of structured distillation from multi-agent interactions as a way to equip much smaller and more efficient language models with improved reasoning capabilities.
To achieve this goal, we proposed a graph-based representation of these interactions, generated graphs for training, and developed a structured distillation method for learning from these interaction graphs.
Our results show the effectiveness, generalizability, and scalability of structured distillation across multiple reasoning benchmarks.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="Sx1">
  <h2 class="ltx_title ltx_title_section">
   Acknowledgements
  </h2>
  <div class="ltx_para ltx_noindent" id="Sx1.p1">
   <p class="ltx_p" id="Sx1.p1.1">
    We thank Peter Hase and Archiki Prasad for useful feedback and suggestions regarding experiments. This work was supported by NSF-CAREER Award 1846185, NSF-AI Engage Institute DRL-2112635, DARPA MCS Grant N66001-19-2-4031, Accelerate Foundation Models Research program, and a Google PhD Fellowship. The views contained in this article are those of the authors and not of the funding agency.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="Sx2">
  <h2 class="ltx_title ltx_title_section">
   Broader Impacts
  </h2>
  <div class="ltx_para ltx_noindent" id="Sx2.p1">
   <p class="ltx_p" id="Sx2.p1.1">
    The computing resources used by LLMs incur a substantial carbon footprint
    <cite class="ltx_cite ltx_citemacro_citep">
     (Strubell et al.,
     <a class="ltx_ref" href="#bib.bib41" title="">
      2019
     </a>
     )
    </cite>
    , and running them in interactive multi-agent settings like
    <span class="ltx_text ltx_font_smallcaps" id="Sx2.p1.1.1">
     ReConcile
    </span>
    further increases these environmental costs.
    <span class="ltx_text ltx_font_smallcaps" id="Sx2.p1.1.2">
     MAGDi
    </span>
    distills from several LLMs into a single more efficient and smaller LM, thus reducing the environmental cost of running LLMs while still maintaining strong performance.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="Sx2.p2">
   <p class="ltx_p" id="Sx2.p2.1">
    The LLMs
    <span class="ltx_text ltx_font_smallcaps" id="Sx2.p2.1.1">
     MAGDi
    </span>
    distills from – and the student models it distills into – can reflect stereotypes, biases, and other negative traits present in their pre-training data
    <cite class="ltx_cite ltx_citemacro_citep">
     (Weidinger et al.,
     <a class="ltx_ref" href="#bib.bib47" title="">
      2021
     </a>
     )
    </cite>
    , which we do not have control over.
Our distilled LLMs have the same capacity for undesirable generation as their teacher models and their respective zero-shot variants; as such, the models resulting from
    <span class="ltx_text ltx_font_smallcaps" id="Sx2.p2.1.2">
     MAGDi
    </span>
    distillation have the same potential for misuse as any LLM or method distilling from LLMs.
More studies are needed to evaluate and mitigate such biases in LLMs.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Aggarwal et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Aggarwal, S., Mandowara, D., Agrawal, V., Khandelwal, D., Singla, P., and Garg, D.
    </span>
    <span class="ltx_bibblock">
     Explanations for CommonsenseQA: New Dataset and Models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">
      Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)
     </em>
     , pp.  3050–3065. Association for Computational Linguistics, 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.acl-long.238/" target="_blank" title="">
      https://aclanthology.org/2021.acl-long.238/
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bubeck et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Bubeck, S., Chandrasekaran, V., Eldan, R., Gehrke, J., Horvitz, E., Kamar, E., Lee, P., Lee, Y. T., Li, Y., Lundberg, S., et al.
    </span>
    <span class="ltx_bibblock">
     Sparks of artificial general intelligence: Early experiments with gpt-4.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">
      arXiv preprint arXiv:2303.12712
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2303.12712" target="_blank" title="">
      https://arxiv.org/abs/2303.12712
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Buciluǎ et al. (2006)
    </span>
    <span class="ltx_bibblock">
     Buciluǎ, C., Caruana, R., and Niculescu-Mizil, A.
    </span>
    <span class="ltx_bibblock">
     Model compression.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">
      Proceedings of the 12th ACM SIGKDD international conference on Knowledge discovery and data mining
     </em>
     , pp.  535–541, 2006.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://dl.acm.org/doi/abs/10.1145/1150402.1150464" target="_blank" title="">
      https://dl.acm.org/doi/abs/10.1145/1150402.1150464
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. (2023a)
    </span>
    <span class="ltx_bibblock">
     Chen, B., Shu, C., Shareghi, E., Collier, N., Narasimhan, K., and Yao, S.
    </span>
    <span class="ltx_bibblock">
     Fireact: Toward language agent fine-tuning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      arXiv preprint arXiv:2310.05915
     </em>
     , 2023a.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.05915" target="_blank" title="">
      https://arxiv.org/abs/2310.05915
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen &amp; Yang (2021)
    </span>
    <span class="ltx_bibblock">
     Chen, J. and Yang, D.
    </span>
    <span class="ltx_bibblock">
     Structure-aware abstractive conversation summarization via discourse and action graphs.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">
      Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies
     </em>
     , pp.  1380–1391, 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.naacl-main.109/" target="_blank" title="">
      https://aclanthology.org/2021.naacl-main.109/
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. (2023b)
    </span>
    <span class="ltx_bibblock">
     Chen, J. C.-Y., Saha, S., and Bansal, M.
    </span>
    <span class="ltx_bibblock">
     Reconcile: Round-table conference improves reasoning via consensus among diverse llms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">
      arXiv preprint arXiv:2309.13007
     </em>
     , 2023b.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2309.13007" target="_blank" title="">
      https://arxiv.org/abs/2309.13007
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Chen, T., Kornblith, S., Swersky, K., Norouzi, M., and Hinton, G. E.
    </span>
    <span class="ltx_bibblock">
     Big self-supervised models are strong semi-supervised learners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">
      Advances in neural information processing systems
     </em>
     , 33:22243–22255, 2020.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2006.10029" target="_blank" title="">
      https://arxiv.org/abs/2006.10029
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Chen, W., Ma, X., Wang, X., and Cohen, W. W.
    </span>
    <span class="ltx_bibblock">
     Program of thoughts prompting: Disentangling computation from reasoning for numerical reasoning tasks.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">
      arXiv preprint arXiv:2211.12588
     </em>
     , 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2211.12588" target="_blank" title="">
      https://arxiv.org/abs/2211.12588
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chenglin et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Chenglin, L., Qianglong, C., Caiyu, W., and Yin, Z.
    </span>
    <span class="ltx_bibblock">
     Mixed distillation helps smaller language model better reasoning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">
      arXiv preprint arXiv:2312.10730
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2312.10730" target="_blank" title="">
      https://arxiv.org/abs/2312.10730
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chiang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Chiang, W.-L., Li, Z., Lin, Z., Sheng, Y., Wu, Z., Zhang, H., Zheng, L., Zhuang, S., Zhuang, Y., Gonzalez, J. E., Stoica, I., and Xing, E. P.
    </span>
    <span class="ltx_bibblock">
     Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality, March 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://lmsys.org/blog/2023-03-30-vicuna/" target="_blank" title="">
      https://lmsys.org/blog/2023-03-30-vicuna/
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Clark et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Clark, C., Lee, K., Chang, M.-W., Kwiatkowski, T., Collins, M., and Toutanova, K.
    </span>
    <span class="ltx_bibblock">
     BoolQ: Exploring the surprising difficulty of natural yes/no questions.
    </span>
    <span class="ltx_bibblock">
     In Burstein, J., Doran, C., and Solorio, T. (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">
      Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)
     </em>
     , pp.  2924–2936, Minneapolis, Minnesota, June 2019. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/N19-1300
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/N19-1300" target="_blank" title="">
      https://aclanthology.org/N19-1300
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Clark et al. (2018)
    </span>
    <span class="ltx_bibblock">
     Clark, P., Cowhey, I., Etzioni, O., Khot, T., Sabharwal, A., Schoenick, C., and Tafjord, O.
    </span>
    <span class="ltx_bibblock">
     Think you have solved question answering? try arc, the ai2 reasoning challenge.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      arXiv preprint arXiv:1803.05457
     </em>
     , 2018.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1803.05457" target="_blank" title="">
      https://arxiv.org/abs/1803.05457
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cobbe et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Cobbe, K., Kosaraju, V., Bavarian, M., Chen, M., Jun, H., Kaiser, L., Plappert, M., Tworek, J., Hilton, J., Nakano, R., Hesse, C., and Schulman, J.
    </span>
    <span class="ltx_bibblock">
     Training verifiers to solve math word problems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      arXiv preprint arXiv:2110.14168
     </em>
     , 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2110.14168" target="_blank" title="">
      https://arxiv.org/abs/2110.14168
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cortes &amp; Vapnik (1995)
    </span>
    <span class="ltx_bibblock">
     Cortes, C. and Vapnik, V.
    </span>
    <span class="ltx_bibblock">
     Support-vector networks.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">
      Machine learning
     </em>
     , 20:273–297, 1995.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Deng et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Deng, Y., Prasad, K., Fernandez, R., Smolensky, P., Chaudhary, V., and Shieber, S.
    </span>
    <span class="ltx_bibblock">
     Implicit chain of thought reasoning via knowledge distillation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">
      arXiv preprint arXiv:2311.01460
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2311.01460" target="_blank" title="">
      https://arxiv.org/abs/2311.01460
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Du et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Du, Y., Li, S., Torralba, A., Tenenbaum, J. B., and Mordatch, I.
    </span>
    <span class="ltx_bibblock">
     Improving factuality and reasoning in language models through multiagent debate, 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2305.14325" target="_blank" title="">
      https://arxiv.org/abs/2305.14325
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Fu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Fu, Y., Peng, H., Ou, L., Sabharwal, A., and Khot, T.
    </span>
    <span class="ltx_bibblock">
     Specializing smaller language models towards multi-step reasoning.
    </span>
    <span class="ltx_bibblock">
     In Krause, A., Brunskill, E., Cho, K., Engelhardt, B., Sabato, S., and Scarlett, J. (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      Proceedings of the 40th International Conference on Machine Learning
     </em>
     , volume 202 of
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.2.2">
      Proceedings of Machine Learning Research
     </em>
     , pp.  10421–10430. PMLR, 23–29 Jul 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v202/fu23d.html" target="_blank" title="">
      https://proceedings.mlr.press/v202/fu23d.html
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Geva et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Geva, M., Khashabi, D., Segal, E., Khot, T., Roth, D., and Berant, J.
    </span>
    <span class="ltx_bibblock">
     Did aristotle use a laptop? a question answering benchmark with implicit reasoning strategies.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">
      Transactions of the Association for Computational Linguistics
     </em>
     , 9:346–361, 2021.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.1162/tacl˙a˙00370
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.tacl-1.21" target="_blank" title="">
      https://aclanthology.org/2021.tacl-1.21
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ghosal et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Ghosal, D., Majumder, N., Poria, S., Chhaya, N., and Gelbukh, A.
    </span>
    <span class="ltx_bibblock">
     Dialoguegcn: A graph convolutional neural network for emotion recognition in conversation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">
      Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)
     </em>
     , pp.  154–164, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hendrycks et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Hendrycks, D., Burns, C., Kadavath, S., Arora, A., Basart, S., Tang, E., Song, D., and Steinhardt, J.
    </span>
    <span class="ltx_bibblock">
     Measuring mathematical problem solving with the math dataset.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">
      NeurIPS
     </em>
     , 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2103.03874" target="_blank" title="">
      https://arxiv.org/abs/2103.03874
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hinton et al. (2015)
    </span>
    <span class="ltx_bibblock">
     Hinton, G., Vinyals, O., and Dean, J.
    </span>
    <span class="ltx_bibblock">
     Distilling the knowledge in a neural network.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">
      arXiv preprint arXiv:1503.02531
     </em>
     , 2015.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1503.02531" target="_blank" title="">
      https://arxiv.org/abs/1503.02531
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ho et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Ho, N., Schmid, L., and Yun, S.-Y.
    </span>
    <span class="ltx_bibblock">
     Large language models are reasoning teachers.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">
      Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)
     </em>
     , pp.  14852–14882, Toronto, Canada, July 2023. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/2023.acl-long.830
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.acl-long.830" target="_blank" title="">
      https://aclanthology.org/2023.acl-long.830
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hu et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Hu, E. J., Shen, Y., Wallis, P., Allen-Zhu, Z., Li, Y., Wang, S., Wang, L., and Chen, W.
    </span>
    <span class="ltx_bibblock">
     LoRA: Low-rank adaptation of large language models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">
      International Conference on Learning Representations
     </em>
     , 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=nZeVKeeFYf9" target="_blank" title="">
      https://openreview.net/forum?id=nZeVKeeFYf9
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jiang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Jiang, A. Q., Sablayrolles, A., Mensch, A., Bamford, C., Chaplot, D. S., Casas, D. d. l., Bressand, F., Lengyel, G., Lample, G., Saulnier, L., et al.
    </span>
    <span class="ltx_bibblock">
     Mistral 7b.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">
      arXiv preprint arXiv:2310.06825
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.06825" target="_blank" title="">
      https://arxiv.org/abs/2310.06825
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kipf &amp; Welling (2017)
    </span>
    <span class="ltx_bibblock">
     Kipf, T. N. and Welling, M.
    </span>
    <span class="ltx_bibblock">
     Semi-supervised classification with graph convolutional networks.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      International Conference on Learning Representations
     </em>
     , 2017.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=SJU4ayYgl" target="_blank" title="">
      https://openreview.net/forum?id=SJU4ayYgl
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kirchhoff &amp; Ostendorf (2003)
    </span>
    <span class="ltx_bibblock">
     Kirchhoff, K. and Ostendorf, M.
    </span>
    <span class="ltx_bibblock">
     Directions for multi-party human-computer interaction research.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">
      Proceedings of the HLT-NAACL 2003 Workshop on Research Directions in Dialogue Processing
     </em>
     , pp.  7–9, 2003.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/W03-0703/" target="_blank" title="">
      https://aclanthology.org/W03-0703/
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kojima et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Kojima, T., Gu, S. S., Reid, M., Matsuo, Y., and Iwasawa, Y.
    </span>
    <span class="ltx_bibblock">
     Large language models are zero-shot reasoners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">
      Advances in neural information processing systems
     </em>
     , 35:22199–22213, 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2205.11916" target="_blank" title="">
      https://arxiv.org/abs/2205.11916
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Leifeld (2018)
    </span>
    <span class="ltx_bibblock">
     Leifeld, P.
    </span>
    <span class="ltx_bibblock">
     Discourse network analysis. policy debates as dynamic networks,[w:] jn victor, ah montgomery, m. lubell (red.), 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Li, L. H., Hessel, J., Yu, Y., Ren, X., Chang, K.-W., and Choi, Y.
    </span>
    <span class="ltx_bibblock">
     Symbolic chain-of-thought distillation: Small models can also “think” step-by-step.
    </span>
    <span class="ltx_bibblock">
     In Rogers, A., Boyd-Graber, J., and Okazaki, N. (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)
     </em>
     , pp.  2665–2679, Toronto, Canada, July 2023. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/2023.acl-long.150
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.acl-long.150" target="_blank" title="">
      https://aclanthology.org/2023.acl-long.150
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Liang, T., He, Z., Jiao, W., Wang, X., Wang, Y., Wang, R., Yang, Y., Tu, Z., and Shi, S.
    </span>
    <span class="ltx_bibblock">
     Encouraging divergent thinking in large language models through multi-agent debate.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      arXiv preprint arXiv:2305.19118
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2305.19118" target="_blank" title="">
      https://arxiv.org/abs/2305.19118
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Liu, B., Bubeck, S., Eldan, R., Kulkarni, J., Li, Y., Nguyen, A., Ward, R., and Zhang, Y.
    </span>
    <span class="ltx_bibblock">
     Tinygsm: achieving
     <math alttext="&gt;" class="ltx_Math" display="inline" id="bib.bib31.1.m1.1">
      <semantics id="bib.bib31.1.m1.1a">
       <mo id="bib.bib31.1.m1.1.1" xref="bib.bib31.1.m1.1.1.cmml">
        &gt;
       </mo>
       <annotation-xml encoding="MathML-Content" id="bib.bib31.1.m1.1b">
        <gt id="bib.bib31.1.m1.1.1.cmml" xref="bib.bib31.1.m1.1.1">
        </gt>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="bib.bib31.1.m1.1c">
        &gt;
       </annotation>
      </semantics>
     </math>
     80% on gsm8k with small language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib31.2.1">
      arXiv preprint arXiv:2312.09241
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2312.09241" target="_blank" title="">
      https://arxiv.org/abs/2312.09241
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Magister et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Magister, L. C., Mallinson, J., Adamek, J., Malmi, E., and Severyn, A.
    </span>
    <span class="ltx_bibblock">
     Teaching small language models to reason.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">
      Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers)
     </em>
     , pp.  1773–1781, Toronto, Canada, July 2023. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/2023.acl-short.151
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.acl-short.151" target="_blank" title="">
      https://aclanthology.org/2023.acl-short.151
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Mitra et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Mitra, A., Del Corro, L., Mahajan, S., Codas, A., Simoes, C., Agarwal, S., Chen, X., Razdaibiedina, A., Jones, E., Aggarwal, K., et al.
    </span>
    <span class="ltx_bibblock">
     Orca 2: Teaching small language models how to reason.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">
      arXiv preprint arXiv:2311.11045
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2311.11045" target="_blank" title="">
      https://arxiv.org/abs/2311.11045
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Mukherjee et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Mukherjee, S., Mitra, A., Jawahar, G., Agarwal, S., Palangi, H., and Awadallah, A.
    </span>
    <span class="ltx_bibblock">
     Orca: Progressive learning from complex explanation traces of gpt-4.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">
      arXiv preprint arXiv:2306.02707
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2306.02707" target="_blank" title="">
      https://arxiv.org/abs/2306.02707
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ouyang et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Ouyang, S., Zhang, Z., and Zhao, H.
    </span>
    <span class="ltx_bibblock">
     Dialogue graph modeling for conversational machine reading.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">
      Findings of the Association for Computational Linguistics: ACL-IJCNLP 2021
     </em>
     , pp.  3158–3169, 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2012.14827" target="_blank" title="">
      https://arxiv.org/abs/2012.14827
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Patel et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Patel, A., Bhattamishra, S., and Goyal, N.
    </span>
    <span class="ltx_bibblock">
     Are NLP models really able to solve simple math word problems?
    </span>
    <span class="ltx_bibblock">
     In Toutanova, K., Rumshisky, A., Zettlemoyer, L., Hakkani-Tur, D., Beltagy, I., Bethard, S., Cotterell, R., Chakraborty, T., and Zhou, Y. (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">
      Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies
     </em>
     , pp.  2080–2094, Online, June 2021. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/2021.naacl-main.168
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.naacl-main.168" target="_blank" title="">
      https://aclanthology.org/2021.naacl-main.168
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Qin et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Qin, L., Li, Z., Che, W., Ni, M., and Liu, T.
    </span>
    <span class="ltx_bibblock">
     Co-gat: A co-interactive graph attention network for joint dialog act recognition and sentiment classification.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">
      Proceedings of the AAAI conference on artificial intelligence
     </em>
     , volume 35, pp.  13709–13717, 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2012.13260" target="_blank" title="">
      https://arxiv.org/abs/2012.13260
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Saha et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Saha, S., Hase, P., and Bansal, M.
    </span>
    <span class="ltx_bibblock">
     Can language models teach weaker agents? teacher explanations improve students via personalization.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">
      NeurIPS
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2306.09299" target="_blank" title="">
      https://arxiv.org/abs/2306.09299
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shen et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Shen, W., Wu, S., Yang, Y., and Quan, X.
    </span>
    <span class="ltx_bibblock">
     Directed acyclic graph network for conversational emotion recognition.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">
      Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)
     </em>
     , pp.  1551–1560, 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2105.12907" target="_blank" title="">
      https://arxiv.org/abs/2105.12907
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shridhar et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Shridhar, K., Stolfo, A., and Sachan, M.
    </span>
    <span class="ltx_bibblock">
     Distilling reasoning capabilities into smaller language models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">
      Findings of the Association for Computational Linguistics: ACL 2023
     </em>
     , pp.  7059–7073, 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2212.00193" target="_blank" title="">
      https://arxiv.org/abs/2212.00193
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Strubell et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Strubell, E., Ganesh, A., and McCallum, A.
    </span>
    <span class="ltx_bibblock">
     Energy and policy considerations for deep learning in nlp.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">
      Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics
     </em>
     , pp.  3645–3650, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Talmor et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Talmor, A., Herzig, J., Lourie, N., and Berant, J.
    </span>
    <span class="ltx_bibblock">
     CommonsenseQA: A question answering challenge targeting commonsense knowledge.
    </span>
    <span class="ltx_bibblock">
     In Burstein, J., Doran, C., and Solorio, T. (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">
      Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)
     </em>
     , pp.  4149–4158, Minneapolis, Minnesota, June 2019. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/N19-1421
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/N19-1421" target="_blank" title="">
      https://aclanthology.org/N19-1421
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Taori et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Taori, R., Gulrajani, I., Zhang, T., Dubois, Y., Li, X., Guestrin, C., Liang, P., and Hashimoto, T. B.
    </span>
    <span class="ltx_bibblock">
     Stanford alpaca: An instruction-following llama model, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Wang, Y., Kordi, Y., Mishra, S., Liu, A., Smith, N. A., Khashabi, D., and Hajishirzi, H.
    </span>
    <span class="ltx_bibblock">
     Self-instruct: Aligning language models with self-generated instructions.
    </span>
    <span class="ltx_bibblock">
     In Rogers, A., Boyd-Graber, J., and Okazaki, N. (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">
      Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)
     </em>
     , pp.  13484–13508, Toronto, Canada, July 2023. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/2023.acl-long.754
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.acl-long.754" target="_blank" title="">
      https://aclanthology.org/2023.acl-long.754
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wei et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Wei, J., Wang, X., Schuurmans, D., Bosma, M., Xia, F., Chi, E., Le, Q. V., Zhou, D., et al.
    </span>
    <span class="ltx_bibblock">
     Chain-of-thought prompting elicits reasoning in large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 35:24824–24837, 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2201.11903" target="_blank" title="">
      https://arxiv.org/abs/2201.11903
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wei et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Wei, J., Shuster, K., Szlam, A., Weston, J., Urbanek, J., and Komeili, M.
    </span>
    <span class="ltx_bibblock">
     Multi-party chat: Conversational agents in group settings with humans and models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">
      arXiv preprint arXiv:2304.13835
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2304.13835" target="_blank" title="">
      https://arxiv.org/abs/2304.13835
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Weidinger et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Weidinger, L., Mellor, J., Rauh, M., Griffin, C., Uesato, J., Huang, P.-S., Cheng, M., Glaese, M., Balle, B., Kasirzadeh, A., et al.
    </span>
    <span class="ltx_bibblock">
     Ethical and social risks of harm from language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">
      arXiv preprint arXiv:2112.04359
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     West et al. (2022)
    </span>
    <span class="ltx_bibblock">
     West, P., Bhagavatula, C., Hessel, J., Hwang, J., Jiang, L., Le Bras, R., Lu, X., Welleck, S., and Choi, Y.
    </span>
    <span class="ltx_bibblock">
     Symbolic knowledge distillation: from general language models to commonsense models.
    </span>
    <span class="ltx_bibblock">
     In Carpuat, M., de Marneffe, M.-C., and Meza Ruiz, I. V. (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">
      Proceedings of the 2022 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies
     </em>
     , pp.  4602–4625, Seattle, United States, July 2022. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/2022.naacl-main.341
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2022.naacl-main.341" target="_blank" title="">
      https://aclanthology.org/2022.naacl-main.341
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Wu, Q., Bansal, G., Zhang, J., Wu, Y., Zhang, S., Zhu, E., Li, B., Jiang, L., Zhang, X., and Wang, C.
    </span>
    <span class="ltx_bibblock">
     Autogen: Enabling next-gen llm applications via multi-agent conversation framework.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">
      arXiv preprint arXiv:2308.08155
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2308.08155" target="_blank" title="">
      https://arxiv.org/abs/2308.08155
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yang et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Yang, Z., Shou, L., Gong, M., Lin, W., and Jiang, D.
    </span>
    <span class="ltx_bibblock">
     Model compression with two-stage multi-teacher knowledge distillation for web question answering system.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">
      Proceedings of the 13th International Conference on Web Search and Data Mining
     </em>
     , pp.  690–698, 2020.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1910.08381" target="_blank" title="">
      https://arxiv.org/abs/1910.08381
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yin et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Yin, D., Brahman, F., Ravichander, A., Chandu, K., Chang, K.-W., Choi, Y., and Lin, B. Y.
    </span>
    <span class="ltx_bibblock">
     Lumos: Learning agents with unified data, modular design, and open-source llms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">
      arXiv preprint arXiv:2311.05657
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2311.05657" target="_blank" title="">
      https://arxiv.org/abs/2311.05657
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     You et al. (2017)
    </span>
    <span class="ltx_bibblock">
     You, S., Xu, C., Xu, C., and Tao, D.
    </span>
    <span class="ltx_bibblock">
     Learning from multiple teacher networks.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">
      Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining
     </em>
     , pp.  1285–1294, 2017.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://dl.acm.org/doi/pdf/10.1145/3097983.3098135" target="_blank" title="">
      https://dl.acm.org/doi/pdf/10.1145/3097983.3098135
     </a>
     .
    </span>
   </li>
  </ul>
 </section>
 <section class="ltx_appendix" id="Ax1">
  <h2 class="ltx_title ltx_title_appendix">
   Appendix
  </h2>
  <figure class="ltx_figure" id="Ax1.F6">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="118" id="Ax1.F6.g1" src="/html/2402.01620/assets/x10.png" width="207"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 6:
    </span>
    Results with scaling training data on StrategyQA and GSM8K. With structured distillation, student accuracy increases with an increase in training data.
   </figcaption>
  </figure>
 </section>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Implementation Details of
   <span class="ltx_text ltx_font_smallcaps" id="A1.1.1">
    MAGDi
   </span>
  </h2>
  <section class="ltx_paragraph" id="A1.SS0.SSS0.Px1">
   <h4 class="ltx_title ltx_title_paragraph">
    Learning from Negative Reasoning.
   </h4>
   <div class="ltx_para ltx_noindent" id="A1.SS0.SSS0.Px1.p1">
    <p class="ltx_p" id="A1.SS0.SSS0.Px1.p1.1">
     We provide additional details about
     <span class="ltx_text ltx_font_smallcaps" id="A1.SS0.SSS0.Px1.p1.1.1">
      MAGDi
     </span>
     ’s contrastive objective in Equation
     <a class="ltx_ref" href="#S3.E2" title="Equation 2 ‣ 3.4 MAGDi: Structured Distillation from MAGs ‣ 3 Method">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . In practice, since a MAG can have many nodes, computing the contrastive loss for every possible positive and negative pair can be prohibitively expensive. In such cases, we randomly sample nodes from the minority group to pair up with the nodes from the majority group. For instance, if there are 5 positive and 3 negative nodes in a MAG, then it naturally forms three pairs and for the remaining 2 positives, we randomly sample 2 negatives to pair with them.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="A1.SS0.SSS0.Px2">
   <h4 class="ltx_title ltx_title_paragraph">
    Model Training.
   </h4>
   <div class="ltx_para ltx_noindent" id="A1.SS0.SSS0.Px2.p1">
    <p class="ltx_p" id="A1.SS0.SSS0.Px2.p1.3">
     <span class="ltx_text ltx_font_smallcaps" id="A1.SS0.SSS0.Px2.p1.3.1">
      MAGDi
     </span>
     -distilled models are fine-tuned using Low-Rank Adaptation (LoRA) for efficiency
     <cite class="ltx_cite ltx_citemacro_cite">
      Hu et al. (
      <a class="ltx_ref" href="#bib.bib23" title="">
       2022
      </a>
      )
     </cite>
     . We set the rank to 16 and alpha to 32. We fine-tune the student model for 10 epochs using a learning rate of 5e-6 and a batch size of 16. For the hyperparameters
     <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.1.m1.1">
      <semantics id="A1.SS0.SSS0.Px2.p1.1.m1.1a">
       <mi id="A1.SS0.SSS0.Px2.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">
        α
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.1.m1.1b">
        <ci id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1">
         𝛼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.1.m1.1c">
        \alpha
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\beta" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.2.m2.1">
      <semantics id="A1.SS0.SSS0.Px2.p1.2.m2.1a">
       <mi id="A1.SS0.SSS0.Px2.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">
        β
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.2.m2.1b">
        <ci id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1">
         𝛽
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.2.m2.1c">
        \beta
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\gamma" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.3.m3.1">
      <semantics id="A1.SS0.SSS0.Px2.p1.3.m3.1a">
       <mi id="A1.SS0.SSS0.Px2.p1.3.m3.1.1" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">
        γ
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.3.m3.1b">
        <ci id="A1.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.1">
         𝛾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.3.m3.1c">
        \gamma
       </annotation>
      </semantics>
     </math>
     , please refer to our code implementation for detailed settings in each dataset. All of our experiments are run on four RTX A6000 with 48G memory each.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_appendix" id="A2">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix B
   </span>
   Further Analyses of
   <span class="ltx_text ltx_font_smallcaps" id="A2.1.1">
    MAGDi
   </span>
  </h2>
  <div class="ltx_para ltx_noindent" id="A2.p1">
   <p class="ltx_p" id="A2.p1.1">
    <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="A2.p1.1.1">
     MAGDi
     <span class="ltx_text ltx_font_upright" id="A2.p1.1.1.1">
      scales positively with better base models.
     </span>
    </span>
    In Table
    <a class="ltx_ref" href="#A2.T5" title="Table 5 ‣ Appendix B Further Analyses of MAGDi">
     <span class="ltx_text ltx_ref_tag">
      5
     </span>
    </a>
    , we show
    <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.2">
     MAGDi
    </span>
    ’s scaling trends on StrategyQA, CommonsenseQA, GSM8K and MATH. Here we apply
    <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.3">
     MAGDi
    </span>
    to three base models: Mistral-7B-Instruct, LLaMA-2-7B-Chat, and LLaMA-2-13B-Chat. Across all these benchmarks,
    <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.4">
     MAGDi
    </span>
    demonstrates consistent gains on top of all base models.
   </p>
  </div>
  <figure class="ltx_table" id="A2.T5">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 5:
    </span>
    Results of
    <span class="ltx_text ltx_font_smallcaps" id="A2.T5.8.1">
     MAGDi
    </span>
    with different base student models (LLaMA-2-7B-Chat, LLaMA-2-13B-Chat, and Mistral-7B-Instruct). First, across all benchmarks and for all three base models,
    <span class="ltx_text ltx_font_smallcaps" id="A2.T5.9.2">
     MAGDi
    </span>
    outperforms no teacher baselines by a large margin. Second, the effect of structured distillation correlates with the performance of the base model (Mistral-7B
    <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.T5.3.m1.1">
     <semantics id="A2.T5.3.m1.1b">
      <mo id="A2.T5.3.m1.1.1" xref="A2.T5.3.m1.1.1.cmml">
       &gt;
      </mo>
      <annotation-xml encoding="MathML-Content" id="A2.T5.3.m1.1c">
       <gt id="A2.T5.3.m1.1.1.cmml" xref="A2.T5.3.m1.1.1">
       </gt>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.T5.3.m1.1d">
       &gt;
      </annotation>
     </semantics>
    </math>
    LLaMA-2-13B
    <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.T5.4.m2.1">
     <semantics id="A2.T5.4.m2.1b">
      <mo id="A2.T5.4.m2.1.1" xref="A2.T5.4.m2.1.1.cmml">
       &gt;
      </mo>
      <annotation-xml encoding="MathML-Content" id="A2.T5.4.m2.1c">
       <gt id="A2.T5.4.m2.1.1.cmml" xref="A2.T5.4.m2.1.1">
       </gt>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.T5.4.m2.1d">
       &gt;
      </annotation>
     </semantics>
    </math>
    LLaMA-2-7B), highlighting the scaling properties of
    <span class="ltx_text ltx_font_smallcaps" id="A2.T5.10.3">
     MAGDi
    </span>
    .
   </figcaption>
   <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A2.T5.11" style="width:433.6pt;height:163.5pt;vertical-align:-0.0pt;">
    <span class="ltx_transformed_inner" style="transform:translate(49.7pt,-18.7pt) scale(1.29745217384277,1.29745217384277) ;">
     <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T5.11.1">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="A2.T5.11.1.1.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T5.11.1.1.1.1">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.1.1.1.1">
          Base
         </span>
        </th>
        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T5.11.1.1.1.2">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.1.1.2.1">
          Distilled
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T5.11.1.1.1.3">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.1.1.3.1">
          StrategyQA
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T5.11.1.1.1.4">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.1.1.4.1">
          CSQA
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T5.11.1.1.1.5">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.1.1.5.1">
          GSM8K
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T5.11.1.1.1.6">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.1.1.6.1">
          MATH
         </span>
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="A2.T5.11.1.2.1">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T5.11.1.2.1.1" rowspan="2">
         <span class="ltx_text" id="A2.T5.11.1.2.1.1.1">
          LLaMA-2-7B
         </span>
        </th>
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T5.11.1.2.1.2">
         No Teacher
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.2.1.3">
         51.53
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.2.1.4">
         46.81
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.2.1.5">
         18.60
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.2.1.6">
         2.50
        </td>
       </tr>
       <tr class="ltx_tr" id="A2.T5.11.1.3.2">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T5.11.1.3.2.1">
         MAGDi
        </th>
        <td class="ltx_td ltx_align_center" id="A2.T5.11.1.3.2.2">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.3.2.2.1">
          66.81
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A2.T5.11.1.3.2.3">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.3.2.3.1">
          66.73
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A2.T5.11.1.3.2.4">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.3.2.4.1">
          28.36
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A2.T5.11.1.3.2.5">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.3.2.5.1">
          5.76
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A2.T5.11.1.4.3">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T5.11.1.4.3.1" rowspan="2">
         <span class="ltx_text" id="A2.T5.11.1.4.3.1.1">
          LLaMA-2-13B
         </span>
        </th>
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T5.11.1.4.3.2">
         No Teacher
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.4.3.3">
         58.52
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.4.3.4">
         51.73
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.4.3.5">
         31.77
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.4.3.6">
         3.90
        </td>
       </tr>
       <tr class="ltx_tr" id="A2.T5.11.1.5.4">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T5.11.1.5.4.1">
         MAGDi
        </th>
        <td class="ltx_td ltx_align_center" id="A2.T5.11.1.5.4.2">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.5.4.2.1">
          69.00
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A2.T5.11.1.5.4.3">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.5.4.3.1">
          67.05
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A2.T5.11.1.5.4.4">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.5.4.4.1">
          40.56
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A2.T5.11.1.5.4.5">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.5.4.5.1">
          6.46
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="A2.T5.11.1.6.5">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A2.T5.11.1.6.5.1" rowspan="2">
         <span class="ltx_text" id="A2.T5.11.1.6.5.1.1">
          Mistral-7B
         </span>
        </th>
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T5.11.1.6.5.2">
         No Teacher
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.6.5.3">
         61.57
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.6.5.4">
         57.89
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.6.5.5">
         44.05
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T5.11.1.6.5.6">
         7.02
        </td>
       </tr>
       <tr class="ltx_tr" id="A2.T5.11.1.7.6">
        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T5.11.1.7.6.1">
         MAGDi
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T5.11.1.7.6.2">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.7.6.2.1">
          74.24
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T5.11.1.7.6.3">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.7.6.3.1">
          72.56
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T5.11.1.7.6.4">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.7.6.4.1">
          52.27
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T5.11.1.7.6.5">
         <span class="ltx_text ltx_font_bold" id="A2.T5.11.1.7.6.5.1">
          12.76
         </span>
        </td>
       </tr>
      </tbody>
     </table>
    </span>
   </div>
  </figure>
  <figure class="ltx_table" id="A2.T6">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 6:
    </span>
    Dataset licenses
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T6.1">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A2.T6.1.1.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T6.1.1.1.1">
       <span class="ltx_text ltx_font_bold" id="A2.T6.1.1.1.1.1">
        Dataset
       </span>
      </th>
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T6.1.1.1.2">
       <span class="ltx_text ltx_font_bold" id="A2.T6.1.1.1.2.1">
        License
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A2.T6.1.2.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T6.1.2.1.1">
       StrategyQA
      </th>
      <td class="ltx_td ltx_align_left ltx_border_t" id="A2.T6.1.2.1.2">
       MIT License (
       <a class="ltx_ref ltx_href" href="https://github.com/eladsegal/strategyqa/blob/main/LICENSE" target="_blank" title="">
        License
       </a>
       )
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T6.1.3.2">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T6.1.3.2.1">
       CommonsenseQA
      </th>
      <td class="ltx_td ltx_align_left" id="A2.T6.1.3.2.2">
       MIT License (
       <a class="ltx_ref ltx_href" href="https://github.com/jonathanherzig/commonsenseqa/issues/5" target="_blank" title="">
        License
       </a>
       )
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T6.1.4.3">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T6.1.4.3.1">
       ARC-c
      </th>
      <td class="ltx_td ltx_align_left" id="A2.T6.1.4.3.2">
       CC BY-SA 4.0 (
       <a class="ltx_ref ltx_href" href="https://allenai.org/data/arc" target="_blank" title="">
        License
       </a>
       )
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T6.1.5.4">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T6.1.5.4.1">
       GSM8K
      </th>
      <td class="ltx_td ltx_align_left" id="A2.T6.1.5.4.2">
       MIT License (
       <a class="ltx_ref ltx_href" href="https://github.com/openai/grade-school-math/blob/master/LICENSE" target="_blank" title="">
        License
       </a>
       )
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T6.1.6.5">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T6.1.6.5.1">
       MATH
      </th>
      <td class="ltx_td ltx_align_left" id="A2.T6.1.6.5.2">
       MIT License (
       <a class="ltx_ref ltx_href" href="https://github.com/hendrycks/math/blob/main/LICENSE" target="_blank" title="">
        License
       </a>
       )
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T6.1.7.6">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T6.1.7.6.1">
       BooQ
      </th>
      <td class="ltx_td ltx_align_left" id="A2.T6.1.7.6.2">
       CC BY-SA 3.0 (
       <a class="ltx_ref ltx_href" href="https://github.com/google-research-datasets/boolean-questions" target="_blank" title="">
        License
       </a>
       )
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T6.1.8.7">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T6.1.8.7.1">
       SVAMP
      </th>
      <td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T6.1.8.7.2">
       MIT License (
       <a class="ltx_ref ltx_href" href="https://github.com/arkilpatel/SVAMP/blob/main/LICENSE" target="_blank" title="">
        License
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <div class="ltx_para ltx_noindent" id="A2.p2">
   <p class="ltx_p" id="A2.p2.1">
    <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="A2.p2.1.1">
     MAGDi
     <span class="ltx_text ltx_font_upright" id="A2.p2.1.1.1">
      scales positively with the amount of training data.
     </span>
    </span>
    Next, we analyze the scaling properties of
    <span class="ltx_text ltx_font_smallcaps" id="A2.p2.1.2">
     MAGDi
    </span>
    by varying the amount of training data. We train distilled models with
    <span class="ltx_text ltx_font_smallcaps" id="A2.p2.1.3">
     MAGDi
    </span>
    (using Mistral-7B-Instruct as the base model) by varying the amount of training data from 100 to 1000 samples. Figure
    <a class="ltx_ref" href="#Ax1.F6" title="Figure 6 ‣ Appendix">
     <span class="ltx_text ltx_ref_tag">
      6
     </span>
    </a>
    shows that with more data,
    <span class="ltx_text ltx_font_smallcaps" id="A2.p2.1.4">
     MAGDi
    </span>
    exhibits better performance – e.g., on StrategyQA, training on 1K MAGs improves reasoning performance by 10.88% compared to training on 500 samples. This suggests that
    <span class="ltx_text ltx_font_smallcaps" id="A2.p2.1.5">
     MAGDi
    </span>
    may bring additional improvements with a larger training corpus.
   </p>
  </div>
  <div class="ltx_para" id="A2.p3">
   <p class="ltx_p" id="A2.p3.4">
    <span class="ltx_text ltx_font_bold" id="A2.p3.4.1">
     Dense interaction graphs distill significant knowledge to students.
    </span>
    Recall that the MAGs in our corpus have distinct structures, with
    <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="A2.p3.1.m1.1">
     <semantics id="A2.p3.1.m1.1a">
      <msub id="A2.p3.1.m1.1.1" xref="A2.p3.1.m1.1.1.cmml">
       <mi class="ltx_font_mathcaligraphic" id="A2.p3.1.m1.1.1.2" xref="A2.p3.1.m1.1.1.2.cmml">
        𝒢
       </mi>
       <mn id="A2.p3.1.m1.1.1.3" xref="A2.p3.1.m1.1.1.3.cmml">
        3
       </mn>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A2.p3.1.m1.1b">
       <apply id="A2.p3.1.m1.1.1.cmml" xref="A2.p3.1.m1.1.1">
        <csymbol cd="ambiguous" id="A2.p3.1.m1.1.1.1.cmml" xref="A2.p3.1.m1.1.1">
         subscript
        </csymbol>
        <ci id="A2.p3.1.m1.1.1.2.cmml" xref="A2.p3.1.m1.1.1.2">
         𝒢
        </ci>
        <cn id="A2.p3.1.m1.1.1.3.cmml" type="integer" xref="A2.p3.1.m1.1.1.3">
         3
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p3.1.m1.1c">
       \mathcal{G}_{3}
      </annotation>
     </semantics>
    </math>
    being the densest graph (having the most nodes and edges). We show that removing these
    <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="A2.p3.2.m2.1">
     <semantics id="A2.p3.2.m2.1a">
      <msub id="A2.p3.2.m2.1.1" xref="A2.p3.2.m2.1.1.cmml">
       <mi class="ltx_font_mathcaligraphic" id="A2.p3.2.m2.1.1.2" xref="A2.p3.2.m2.1.1.2.cmml">
        𝒢
       </mi>
       <mn id="A2.p3.2.m2.1.1.3" xref="A2.p3.2.m2.1.1.3.cmml">
        3
       </mn>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A2.p3.2.m2.1b">
       <apply id="A2.p3.2.m2.1.1.cmml" xref="A2.p3.2.m2.1.1">
        <csymbol cd="ambiguous" id="A2.p3.2.m2.1.1.1.cmml" xref="A2.p3.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="A2.p3.2.m2.1.1.2.cmml" xref="A2.p3.2.m2.1.1.2">
         𝒢
        </ci>
        <cn id="A2.p3.2.m2.1.1.3.cmml" type="integer" xref="A2.p3.2.m2.1.1.3">
         3
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p3.2.m2.1c">
       \mathcal{G}_{3}
      </annotation>
     </semantics>
    </math>
    graphs from our training corpus leads to a significant drop in student accuracy. As shown in Table
    <a class="ltx_ref" href="#A2.T7" title="Table 7 ‣ Appendix B Further Analyses of MAGDi">
     <span class="ltx_text ltx_ref_tag">
      7
     </span>
    </a>
    , structured distillation on CSQA without the
    <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="A2.p3.3.m3.1">
     <semantics id="A2.p3.3.m3.1a">
      <msub id="A2.p3.3.m3.1.1" xref="A2.p3.3.m3.1.1.cmml">
       <mi class="ltx_font_mathcaligraphic" id="A2.p3.3.m3.1.1.2" xref="A2.p3.3.m3.1.1.2.cmml">
        𝒢
       </mi>
       <mn id="A2.p3.3.m3.1.1.3" xref="A2.p3.3.m3.1.1.3.cmml">
        3
       </mn>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A2.p3.3.m3.1b">
       <apply id="A2.p3.3.m3.1.1.cmml" xref="A2.p3.3.m3.1.1">
        <csymbol cd="ambiguous" id="A2.p3.3.m3.1.1.1.cmml" xref="A2.p3.3.m3.1.1">
         subscript
        </csymbol>
        <ci id="A2.p3.3.m3.1.1.2.cmml" xref="A2.p3.3.m3.1.1.2">
         𝒢
        </ci>
        <cn id="A2.p3.3.m3.1.1.3.cmml" type="integer" xref="A2.p3.3.m3.1.1.3">
         3
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p3.3.m3.1c">
       \mathcal{G}_{3}
      </annotation>
     </semantics>
    </math>
    graphs causes student performance to drop by 2% and additionally removing the
    <math alttext="\mathcal{G}_{2}" class="ltx_Math" display="inline" id="A2.p3.4.m4.1">
     <semantics id="A2.p3.4.m4.1a">
      <msub id="A2.p3.4.m4.1.1" xref="A2.p3.4.m4.1.1.cmml">
       <mi class="ltx_font_mathcaligraphic" id="A2.p3.4.m4.1.1.2" xref="A2.p3.4.m4.1.1.2.cmml">
        𝒢
       </mi>
       <mn id="A2.p3.4.m4.1.1.3" xref="A2.p3.4.m4.1.1.3.cmml">
        2
       </mn>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A2.p3.4.m4.1b">
       <apply id="A2.p3.4.m4.1.1.cmml" xref="A2.p3.4.m4.1.1">
        <csymbol cd="ambiguous" id="A2.p3.4.m4.1.1.1.cmml" xref="A2.p3.4.m4.1.1">
         subscript
        </csymbol>
        <ci id="A2.p3.4.m4.1.1.2.cmml" xref="A2.p3.4.m4.1.1.2">
         𝒢
        </ci>
        <cn id="A2.p3.4.m4.1.1.3.cmml" type="integer" xref="A2.p3.4.m4.1.1.3">
         2
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p3.4.m4.1c">
       \mathcal{G}_{2}
      </annotation>
     </semantics>
    </math>
    graphs causes a further drop of 1%. Our result thus highlights the importance of distillation from denser graphs (even if they are sparsely represented in the corpus).
   </p>
  </div>
  <figure class="ltx_table" id="A2.T7">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 7:
    </span>
    Removing denser interaction graphs (e.g.,
    <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="A2.T7.3.m1.1">
     <semantics id="A2.T7.3.m1.1b">
      <msub id="A2.T7.3.m1.1.1" xref="A2.T7.3.m1.1.1.cmml">
       <mi class="ltx_font_mathcaligraphic" id="A2.T7.3.m1.1.1.2" xref="A2.T7.3.m1.1.1.2.cmml">
        𝒢
       </mi>
       <mn id="A2.T7.3.m1.1.1.3" xref="A2.T7.3.m1.1.1.3.cmml">
        3
       </mn>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A2.T7.3.m1.1c">
       <apply id="A2.T7.3.m1.1.1.cmml" xref="A2.T7.3.m1.1.1">
        <csymbol cd="ambiguous" id="A2.T7.3.m1.1.1.1.cmml" xref="A2.T7.3.m1.1.1">
         subscript
        </csymbol>
        <ci id="A2.T7.3.m1.1.1.2.cmml" xref="A2.T7.3.m1.1.1.2">
         𝒢
        </ci>
        <cn id="A2.T7.3.m1.1.1.3.cmml" type="integer" xref="A2.T7.3.m1.1.1.3">
         3
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.T7.3.m1.1d">
       \mathcal{G}_{3}
      </annotation>
     </semantics>
    </math>
    or
    <math alttext="\mathcal{G}_{2}" class="ltx_Math" display="inline" id="A2.T7.4.m2.1">
     <semantics id="A2.T7.4.m2.1b">
      <msub id="A2.T7.4.m2.1.1" xref="A2.T7.4.m2.1.1.cmml">
       <mi class="ltx_font_mathcaligraphic" id="A2.T7.4.m2.1.1.2" xref="A2.T7.4.m2.1.1.2.cmml">
        𝒢
       </mi>
       <mn id="A2.T7.4.m2.1.1.3" xref="A2.T7.4.m2.1.1.3.cmml">
        2
       </mn>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A2.T7.4.m2.1c">
       <apply id="A2.T7.4.m2.1.1.cmml" xref="A2.T7.4.m2.1.1">
        <csymbol cd="ambiguous" id="A2.T7.4.m2.1.1.1.cmml" xref="A2.T7.4.m2.1.1">
         subscript
        </csymbol>
        <ci id="A2.T7.4.m2.1.1.2.cmml" xref="A2.T7.4.m2.1.1.2">
         𝒢
        </ci>
        <cn id="A2.T7.4.m2.1.1.3.cmml" type="integer" xref="A2.T7.4.m2.1.1.3">
         2
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.T7.4.m2.1d">
       \mathcal{G}_{2}
      </annotation>
     </semantics>
    </math>
    ) from CSQA training corpus leads to a significant drop in student accuracy, highlighting the importance of learning from such graphs.
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T7.7">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A2.T7.7.4.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T7.7.4.1.1">
       <span class="ltx_text ltx_font_bold" id="A2.T7.7.4.1.1.1">
        Training MAGs
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T7.7.4.1.2">
       <span class="ltx_text ltx_font_bold" id="A2.T7.7.4.1.2.1">
        Accuracy
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A2.T7.7.5.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T7.7.5.1.1">
       All
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.7.5.1.2">
       72.56
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T7.5.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T7.5.1.1">
       w/o
       <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="A2.T7.5.1.1.m1.1">
        <semantics id="A2.T7.5.1.1.m1.1a">
         <msub id="A2.T7.5.1.1.m1.1.1" xref="A2.T7.5.1.1.m1.1.1.cmml">
          <mi class="ltx_font_mathcaligraphic" id="A2.T7.5.1.1.m1.1.1.2" xref="A2.T7.5.1.1.m1.1.1.2.cmml">
           𝒢
          </mi>
          <mn id="A2.T7.5.1.1.m1.1.1.3" xref="A2.T7.5.1.1.m1.1.1.3.cmml">
           3
          </mn>
         </msub>
         <annotation-xml encoding="MathML-Content" id="A2.T7.5.1.1.m1.1b">
          <apply id="A2.T7.5.1.1.m1.1.1.cmml" xref="A2.T7.5.1.1.m1.1.1">
           <csymbol cd="ambiguous" id="A2.T7.5.1.1.m1.1.1.1.cmml" xref="A2.T7.5.1.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="A2.T7.5.1.1.m1.1.1.2.cmml" xref="A2.T7.5.1.1.m1.1.1.2">
            𝒢
           </ci>
           <cn id="A2.T7.5.1.1.m1.1.1.3.cmml" type="integer" xref="A2.T7.5.1.1.m1.1.1.3">
            3
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.T7.5.1.1.m1.1c">
          \mathcal{G}_{3}
         </annotation>
        </semantics>
       </math>
      </th>
      <td class="ltx_td ltx_align_center" id="A2.T7.5.1.2">
       70.65
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T7.7.3">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T7.7.3.2">
       w/o
       <math alttext="\mathcal{G}_{2}" class="ltx_Math" display="inline" id="A2.T7.6.2.1.m1.1">
        <semantics id="A2.T7.6.2.1.m1.1a">
         <msub id="A2.T7.6.2.1.m1.1.1" xref="A2.T7.6.2.1.m1.1.1.cmml">
          <mi class="ltx_font_mathcaligraphic" id="A2.T7.6.2.1.m1.1.1.2" xref="A2.T7.6.2.1.m1.1.1.2.cmml">
           𝒢
          </mi>
          <mn id="A2.T7.6.2.1.m1.1.1.3" xref="A2.T7.6.2.1.m1.1.1.3.cmml">
           2
          </mn>
         </msub>
         <annotation-xml encoding="MathML-Content" id="A2.T7.6.2.1.m1.1b">
          <apply id="A2.T7.6.2.1.m1.1.1.cmml" xref="A2.T7.6.2.1.m1.1.1">
           <csymbol cd="ambiguous" id="A2.T7.6.2.1.m1.1.1.1.cmml" xref="A2.T7.6.2.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="A2.T7.6.2.1.m1.1.1.2.cmml" xref="A2.T7.6.2.1.m1.1.1.2">
            𝒢
           </ci>
           <cn id="A2.T7.6.2.1.m1.1.1.3.cmml" type="integer" xref="A2.T7.6.2.1.m1.1.1.3">
            2
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.T7.6.2.1.m1.1c">
          \mathcal{G}_{2}
         </annotation>
        </semantics>
       </math>
       &amp;
       <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="A2.T7.7.3.2.m2.1">
        <semantics id="A2.T7.7.3.2.m2.1a">
         <msub id="A2.T7.7.3.2.m2.1.1" xref="A2.T7.7.3.2.m2.1.1.cmml">
          <mi class="ltx_font_mathcaligraphic" id="A2.T7.7.3.2.m2.1.1.2" xref="A2.T7.7.3.2.m2.1.1.2.cmml">
           𝒢
          </mi>
          <mn id="A2.T7.7.3.2.m2.1.1.3" xref="A2.T7.7.3.2.m2.1.1.3.cmml">
           3
          </mn>
         </msub>
         <annotation-xml encoding="MathML-Content" id="A2.T7.7.3.2.m2.1b">
          <apply id="A2.T7.7.3.2.m2.1.1.cmml" xref="A2.T7.7.3.2.m2.1.1">
           <csymbol cd="ambiguous" id="A2.T7.7.3.2.m2.1.1.1.cmml" xref="A2.T7.7.3.2.m2.1.1">
            subscript
           </csymbol>
           <ci id="A2.T7.7.3.2.m2.1.1.2.cmml" xref="A2.T7.7.3.2.m2.1.1.2">
            𝒢
           </ci>
           <cn id="A2.T7.7.3.2.m2.1.1.3.cmml" type="integer" xref="A2.T7.7.3.2.m2.1.1.3">
            3
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.T7.7.3.2.m2.1c">
          \mathcal{G}_{3}
         </annotation>
        </semantics>
       </math>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.7.3.3">
       69.65
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <figure class="ltx_table" id="A2.T8">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 8:
    </span>
    Training and test statistics for five benchmarks. Our training corpus (i.e., MAGs) is categorized along three dimensions: (1)
    <span class="ltx_text ltx_font_bold" id="A2.T8.8.1">
     Round:
    </span>
    number of nodes belonging to each interaction round, (2)
    <span class="ltx_text ltx_font_bold" id="A2.T8.9.2">
     Agent:
    </span>
    number of nodes belonging to each agent (GPT4/Bard/Claude2), and (3)
    <span class="ltx_text ltx_font_bold" id="A2.T8.10.3">
     Graph:
    </span>
    number of graphs with a specific graph structure.
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T8.4">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A2.T8.4.5.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T8.4.5.1.1" rowspan="2">
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.5.1.1.1">
        Task
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="A2.T8.4.5.1.2">
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.5.1.2.1">
        Train
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.4.5.1.3" rowspan="2">
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.5.1.3.1">
        Test
       </span>
      </th>
     </tr>
     <tr class="ltx_tr" id="A2.T8.4.4">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T8.4.4.5">
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.4.5.1">
        Round (0 / 1 / 2 / 3)
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T8.4.4.6">
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.4.6.1">
        Agent (Each)
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T8.4.4.4">
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.4.4.4">
        Graph (
        <math alttext="\mathcal{G}_{0}" class="ltx_Math" display="inline" id="A2.T8.1.1.1.1.m1.1">
         <semantics id="A2.T8.1.1.1.1.m1.1a">
          <msub id="A2.T8.1.1.1.1.m1.1.1" xref="A2.T8.1.1.1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A2.T8.1.1.1.1.m1.1.1.2" xref="A2.T8.1.1.1.1.m1.1.1.2.cmml">
            𝒢
           </mi>
           <mn id="A2.T8.1.1.1.1.m1.1.1.3" xref="A2.T8.1.1.1.1.m1.1.1.3.cmml">
            0
           </mn>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A2.T8.1.1.1.1.m1.1b">
           <apply id="A2.T8.1.1.1.1.m1.1.1.cmml" xref="A2.T8.1.1.1.1.m1.1.1">
            <csymbol cd="ambiguous" id="A2.T8.1.1.1.1.m1.1.1.1.cmml" xref="A2.T8.1.1.1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="A2.T8.1.1.1.1.m1.1.1.2.cmml" xref="A2.T8.1.1.1.1.m1.1.1.2">
             𝒢
            </ci>
            <cn id="A2.T8.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="A2.T8.1.1.1.1.m1.1.1.3">
             0
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A2.T8.1.1.1.1.m1.1c">
           \mathcal{G}_{0}
          </annotation>
         </semantics>
        </math>
        /
        <math alttext="\mathcal{G}_{1}" class="ltx_Math" display="inline" id="A2.T8.2.2.2.2.m2.1">
         <semantics id="A2.T8.2.2.2.2.m2.1a">
          <msub id="A2.T8.2.2.2.2.m2.1.1" xref="A2.T8.2.2.2.2.m2.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A2.T8.2.2.2.2.m2.1.1.2" xref="A2.T8.2.2.2.2.m2.1.1.2.cmml">
            𝒢
           </mi>
           <mn id="A2.T8.2.2.2.2.m2.1.1.3" xref="A2.T8.2.2.2.2.m2.1.1.3.cmml">
            1
           </mn>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A2.T8.2.2.2.2.m2.1b">
           <apply id="A2.T8.2.2.2.2.m2.1.1.cmml" xref="A2.T8.2.2.2.2.m2.1.1">
            <csymbol cd="ambiguous" id="A2.T8.2.2.2.2.m2.1.1.1.cmml" xref="A2.T8.2.2.2.2.m2.1.1">
             subscript
            </csymbol>
            <ci id="A2.T8.2.2.2.2.m2.1.1.2.cmml" xref="A2.T8.2.2.2.2.m2.1.1.2">
             𝒢
            </ci>
            <cn id="A2.T8.2.2.2.2.m2.1.1.3.cmml" type="integer" xref="A2.T8.2.2.2.2.m2.1.1.3">
             1
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A2.T8.2.2.2.2.m2.1c">
           \mathcal{G}_{1}
          </annotation>
         </semantics>
        </math>
        /
        <math alttext="\mathcal{G}_{2}" class="ltx_Math" display="inline" id="A2.T8.3.3.3.3.m3.1">
         <semantics id="A2.T8.3.3.3.3.m3.1a">
          <msub id="A2.T8.3.3.3.3.m3.1.1" xref="A2.T8.3.3.3.3.m3.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A2.T8.3.3.3.3.m3.1.1.2" xref="A2.T8.3.3.3.3.m3.1.1.2.cmml">
            𝒢
           </mi>
           <mn id="A2.T8.3.3.3.3.m3.1.1.3" xref="A2.T8.3.3.3.3.m3.1.1.3.cmml">
            2
           </mn>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A2.T8.3.3.3.3.m3.1b">
           <apply id="A2.T8.3.3.3.3.m3.1.1.cmml" xref="A2.T8.3.3.3.3.m3.1.1">
            <csymbol cd="ambiguous" id="A2.T8.3.3.3.3.m3.1.1.1.cmml" xref="A2.T8.3.3.3.3.m3.1.1">
             subscript
            </csymbol>
            <ci id="A2.T8.3.3.3.3.m3.1.1.2.cmml" xref="A2.T8.3.3.3.3.m3.1.1.2">
             𝒢
            </ci>
            <cn id="A2.T8.3.3.3.3.m3.1.1.3.cmml" type="integer" xref="A2.T8.3.3.3.3.m3.1.1.3">
             2
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A2.T8.3.3.3.3.m3.1c">
           \mathcal{G}_{2}
          </annotation>
         </semantics>
        </math>
        /
        <math alttext="\mathcal{G}_{3}" class="ltx_Math" display="inline" id="A2.T8.4.4.4.4.m4.1">
         <semantics id="A2.T8.4.4.4.4.m4.1a">
          <msub id="A2.T8.4.4.4.4.m4.1.1" xref="A2.T8.4.4.4.4.m4.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="A2.T8.4.4.4.4.m4.1.1.2" xref="A2.T8.4.4.4.4.m4.1.1.2.cmml">
            𝒢
           </mi>
           <mn id="A2.T8.4.4.4.4.m4.1.1.3" xref="A2.T8.4.4.4.4.m4.1.1.3.cmml">
            3
           </mn>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A2.T8.4.4.4.4.m4.1b">
           <apply id="A2.T8.4.4.4.4.m4.1.1.cmml" xref="A2.T8.4.4.4.4.m4.1.1">
            <csymbol cd="ambiguous" id="A2.T8.4.4.4.4.m4.1.1.1.cmml" xref="A2.T8.4.4.4.4.m4.1.1">
             subscript
            </csymbol>
            <ci id="A2.T8.4.4.4.4.m4.1.1.2.cmml" xref="A2.T8.4.4.4.4.m4.1.1.2">
             𝒢
            </ci>
            <cn id="A2.T8.4.4.4.4.m4.1.1.3.cmml" type="integer" xref="A2.T8.4.4.4.4.m4.1.1.3">
             3
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A2.T8.4.4.4.4.m4.1c">
           \mathcal{G}_{3}
          </annotation>
         </semantics>
        </math>
        / All)
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A2.T8.4.6.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T8.4.6.1.1">
       StrategyQA
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.4.6.1.2">
       3K / 843 / 438 / 102
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.4.6.1.3">
       1.4K
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.4.6.1.4">
       719 / 135 / 112 / 34 /
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.6.1.4.1">
        1K
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.4.6.1.5">
       229
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T8.4.7.2">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.4.7.2.1">
       CSQA
      </th>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.7.2.2">
       3K / 2.1K / 942 / 627
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.7.2.3">
       2.2K
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.7.2.4">
       306 / 380 / 105 / 209 /
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.7.2.4.1">
        1K
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.7.2.5">
       2.2K
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T8.4.8.3">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.4.8.3.1">
       ARC-c
      </th>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.8.3.2">
       3K / 792 / 288 / 153
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.8.3.3">
       1.4K
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.8.3.4">
       736 / 168 / 45 / 51 /
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.8.3.4.1">
        1K
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.8.3.5">
       1.1K
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T8.4.9.4">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.4.9.4.1">
       GSM8K
      </th>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.9.4.2">
       3K / 1.3K / 588 / 354
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.9.4.3">
       1.7K
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.9.4.4">
       557 / 247 / 78 / 118 /
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.9.4.4.1">
        1K
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A2.T8.4.9.4.5">
       1.3K
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T8.4.10.5">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T8.4.10.5.1">
       MATH
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.4.10.5.2">
       3K / 2.3K / 1.5K / 1.2K
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.4.10.5.3">
       2.7K
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.4.10.5.4">
       215 / 269 / 89 / 427 /
       <span class="ltx_text ltx_font_bold" id="A2.T8.4.10.5.4.1">
        1K
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.4.10.5.5">
       5K
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <figure class="ltx_table" id="A2.T9">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 9:
    </span>
    Comparison between task-specific
    <span class="ltx_text ltx_font_smallcaps" id="A2.T9.5.1">
     MAGDi
    </span>
    models and the joint multi-task
    <span class="ltx_text ltx_font_smallcaps" id="A2.T9.6.2">
     MAGDi
    </span>
    model (
    <span class="ltx_text ltx_font_smallcaps" id="A2.T9.7.3">
     MAGDi
    </span>
    -MT). On average,
    <span class="ltx_text ltx_font_smallcaps" id="A2.T9.8.4">
     MAGDi
    </span>
    -MT’s accuracy is within 1% of task-specific models.
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T9.9">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A2.T9.9.1.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T9.9.1.1.1">
       <span class="ltx_text ltx_font_bold" id="A2.T9.9.1.1.1.1">
        Distilled Model
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.9.1.1.2">
       <span class="ltx_text ltx_font_bold" id="A2.T9.9.1.1.2.1">
        StrategyQA
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.9.1.1.3">
       <span class="ltx_text ltx_font_bold" id="A2.T9.9.1.1.3.1">
        CSQA
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.9.1.1.4">
       <span class="ltx_text ltx_font_bold" id="A2.T9.9.1.1.4.1">
        ARC-c
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.9.1.1.5">
       <span class="ltx_text ltx_font_bold" id="A2.T9.9.1.1.5.1">
        GSM8K
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.9.1.1.6">
       <span class="ltx_text ltx_font_bold" id="A2.T9.9.1.1.6.1">
        MATH
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T9.9.1.1.7">
       <span class="ltx_text ltx_font_bold" id="A2.T9.9.1.1.7.1">
        Average Accuracy
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A2.T9.9.2.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T9.9.2.1.1">
       <span class="ltx_text ltx_font_smallcaps" id="A2.T9.9.2.1.1.1">
        MAGDi
       </span>
       -MT
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.9.2.1.2">
       70.74
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.9.2.1.3">
       71.73
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.9.2.1.4">
       72.87
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.9.2.1.5">
       49.51
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.9.2.1.6">
       10.76
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.9.2.1.7">
       55.12
      </td>
     </tr>
     <tr class="ltx_tr" id="A2.T9.9.3.2">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T9.9.3.2.1">
       <span class="ltx_text ltx_font_smallcaps" id="A2.T9.9.3.2.1.1">
        MAGDi
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.9.3.2.2">
       74.24
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.9.3.2.3">
       72.56
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.9.3.2.4">
       72.61
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.9.3.2.5">
       52.27
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.9.3.2.6">
       12.76
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.9.3.2.7">
       56.89
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
  <figure class="ltx_figure" id="A2.F7">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="204" id="A2.F7.g1" src="/html/2402.01620/assets/x11.png" width="467"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 7:
    </span>
    An example of a MAG from the ARC-c dataset.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A2.F8">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="222" id="A2.F8.g1" src="/html/2402.01620/assets/x12.png" width="467"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 8:
    </span>
    An example of a MAG from the GSM8K dataset.
   </figcaption>
  </figure>
 </section>
 <section class="ltx_appendix" id="A3">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix C
   </span>
   Benchmark Licenses
  </h2>
  <div class="ltx_para ltx_noindent" id="A3.p1">
   <p class="ltx_p" id="A3.p1.1">
    The licenses of the seven datasets we used are in Table
    <a class="ltx_ref" href="#A2.T6" title="Table 6 ‣ Appendix B Further Analyses of MAGDi">
     <span class="ltx_text ltx_ref_tag">
      6
     </span>
    </a>
    .
   </p>
  </div>
 </section>
 <section class="ltx_appendix" id="A4">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix D
   </span>
   Qualitative Examples of MAG
  </h2>
  <div class="ltx_para ltx_noindent" id="A4.p1">
   <p class="ltx_p" id="A4.p1.1">
    See Fig.
    <a class="ltx_ref" href="#A2.F7" title="Figure 7 ‣ Appendix B Further Analyses of MAGDi">
     <span class="ltx_text ltx_ref_tag">
      7
     </span>
    </a>
    and Fig.
    <a class="ltx_ref" href="#A2.F8" title="Figure 8 ‣ Appendix B Further Analyses of MAGDi">
     <span class="ltx_text ltx_ref_tag">
      8
     </span>
    </a>
    for two examples of MAGs.
   </p>
  </div>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <div about="" class="ltx_rdf" content="Justin Chih-Yao Chen, Swarnadeep Saha, Elias Stengel-Eskin, Mohit Bansal" property="dcterms:creator">
 </div>
 <div about="" class="ltx_rdf" property="dcterms:subject">
 </div>
 <div about="" class="ltx_rdf" content="Proceedings of the International Conference on Machine Learning 2024" property="dcterms:subject">
 </div>
 <div about="" class="ltx_rdf" content="MAGDi: Structured Distillation of Multi-Agent Interaction Graphs \\
Improves Reasoning in Smaller Language Models" property="dcterms:title">
 </div>
</article>
