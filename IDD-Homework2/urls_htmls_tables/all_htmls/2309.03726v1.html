<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2309.03726] INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION</title><meta property="og:description" content="Transformer-based architectures have recently demonstrated remarkable performance in the Visual Question Answering (VQA) task. However, such models are likely to disregard crucial visual cues and often rely on multimod…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2309.03726">

<!--Generated on Wed Feb 28 07:13:18 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Transformer-based architectures have recently demonstrated remarkable performance in the Visual Question Answering (VQA) task. However, such models are likely to disregard crucial visual cues and often rely on multimodal shortcuts and inherent biases of the language modality to predict the correct answer, a phenomenon commonly referred to as <span id="id1.id1.1" class="ltx_text ltx_font_italic">lack of visual grounding</span>. In this work, we alleviate this shortcoming through a novel architecture for visual question answering that leverages <span id="id1.id1.2" class="ltx_text ltx_font_italic">common sense reasoning as a supervisory signal</span>. Reasoning supervision takes the form of a textual justification of the correct answer, with such annotations being already available on large-scale Visual Common Sense Reasoning (VCR) datasets. The model’s visual attention is guided toward important elements of the scene through a similarity loss that aligns the learned attention distributions guided by the question and the correct reasoning. We demonstrate both quantitatively and qualitatively that the proposed approach can boost the model’s visual perception capability and lead to performance increase, without requiring training on explicit grounding annotations.</p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— </span></span>
Visual Question Answering, Visual Grounding, Interpretability, Attention Similarity</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Models for Visual Question Answering (VQA) provide answers to natural language questions about an image by perceiving both textual and image cues. VQA lies at the intersection of vision and language and has recently generated significant research interest. Existing methods aim to tackle the task via deep multi-layer transformer architectures, attending to linguistic and visual tokens <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. However, despite their superior performance, attempts to diagnose these models’ robustness and reasoning capability have revealed that they often rely on linguistic biases and shallow correlations to generate the correct answer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. The language modality has been proven a strong signal that is easy to exploit, causing the model to overlook visual information and rely on shallow patterns, such as correlations between words in the question <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. It has been shown that the performance of recent models can clearly degrade under evaluation settings that penalize reliance on such spurious correlations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2309.03726/assets/market3.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="225" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.5.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>This work proposes a novel mechanism for leveraging <span id="S1.F1.6.2" class="ltx_text ltx_font_italic">common sense reasoning as a supervisory signal</span>. Our VQA model, guided by the correct reasoning <span id="S1.F1.7.3" class="ltx_text ltx_font_smallcaps">(R:[person1] is holding the cigarette)</span>, is able to attend to the appropriate image regions and accurately select the right answer <span id="S1.F1.8.4" class="ltx_text ltx_font_smallcaps">(A:[person1] is smoking)</span>.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">This tendency of recent models to reason about the correct answer without attending to the relevant image areas has been referred to as <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">lack of visual grounding</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. To alleviate this, a line of work explores techniques for training VQA models that are sensitive to the same image regions as human annotators, commonly by enforcing alignment with human attention maps <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. While such methods can reduce reliance on language biases, they also require explicit grounding supervision that is rarely available. In this work, we explore an alternative approach towards attending to informative image regions, that does not require explicit grounding supervision, but leverages instead <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">common sense reasoning</span> as a supervisory signal.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We take advantage of the fact that reasoning-level supervision in the form of textual justification of why an answer is true, is already available in large-scale Visual Commonsense Reasoning datasets like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. For example, in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, to answer the <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">question</span> <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">‘What is <span id="S1.p3.1.2.1" class="ltx_text ltx_font_smallcaps">[person1]</span> doing?’</span>, the <span id="S1.p3.1.3" class="ltx_text ltx_font_bold">reasoning</span> <span id="S1.p3.1.4" class="ltx_text ltx_font_italic">’<span id="S1.p3.1.4.1" class="ltx_text ltx_font_smallcaps">[person1]</span> is holding a cigarette and is leaned over it’</span> can accurately guide a model’s visual attention towards predicting the correct <span id="S1.p3.1.5" class="ltx_text ltx_font_bold">answer</span>, <span id="S1.p3.1.6" class="ltx_text ltx_font_italic">‘<span id="S1.p3.1.6.1" class="ltx_text ltx_font_smallcaps">[person1]</span> is smoking’</span>. The correct reasoning often contains details of the scene and references to objects and people relevant to the right answer. Our VQA model is trained to utilize reasoning supervision as a proxy signal to generate interpretable attention maps that guide visual attention toward informative image regions.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our proposed framework processes question/answer pairs using a multilayer BERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> transformer architecture. A separate visual attention stream is incorporated to generate two attention distributions, one conditioned on the question and the other on the correct reasoning. We distill knowledge from the reasoning attention to our VQA model through a similarity loss term, that encourages question and reasoning attention alignment. Our model can accurately capture the visual components required to find the correct answer and produce interpretable, human-like attention maps, thus boosting baseline performance. We evaluate our pipeline both quantitatively and qualitatively on the Visual Commonsense Reasoning dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, a large-scale dataset for cognition-level visual understanding. To the best of our knowledge, we are one of the first works to employ implicit attention guidance, free from explicit grounding supervision in a vision-language transformer setting.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>RELATED WORK</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">The main VQA paradigm is multi-layer transformers operating on joint image-text embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. These methods benefit from extensive pre-training on large-scale VL datasets, to extract meaningful image-text representations and align visio-linguistic clues. One notable example is VL-BERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, a model that is pre-trained on text-only corpora with standard Masked Language Modeling (MLM) as well as visual-linguistic corpora via predicting randomly masked words and Regions of Interest (RoIs) of the image.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Despite superior performance, state-of-the-art VQA models can often make decisions by relying on shortcuts and statistical regularities instead of comprehending the scene as demonstrated in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Similarly, authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> identify that VQA models exploit co-occurrences of words in the question and object segments in the image, which they define as multimodal shortcuts.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">In an attempt to counter shortcuts and language priors, some methods encourage the model to effectively attend to visual components and infer visual relationships. The authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> align gradient-based explanations with human attention annotations via a ranking loss to guide the network to focus on the correct image regions. The authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> train an attention auxiliary model with ground truth human-labeled attention maps and consequently apply human-like attention supervision to an attention-based VQA model. Another work in this direction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> proposes a method that automatically selects region and object annotations from Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> that serve as labels for implementing visual grounding as an auxiliary task for VQA. In contrast to these approaches, this work mitigates over-reliance on language priors without requiring annotated attention maps. We train our network instead, to look at the image and attend to meaningful visual evidence through reasoning supervision.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2309.03726/assets/x1.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="389" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.5.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>Proposed VAQ architecture: Our model comprises 2 main streams that operate in parallel, a <span id="S2.F2.6.2" class="ltx_text ltx_font_italic">language</span> and a <span id="S2.F2.7.3" class="ltx_text ltx_font_italic">visual</span> stream. The output of the 2 streams is fused via Hadamard multiplication to obtain the final prediction. During training, we utilize a <span id="S2.F2.8.4" class="ltx_text ltx_font_italic">reasoning</span> attention decoder to distil reasoning information into the model, through a similarity loss between question and reasoning-guided attention maps. Reasoning supervision leads in the formation of interpretable attention maps.</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>METHODOLOGY</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.14" class="ltx_p"><span id="S3.p1.14.1" class="ltx_text ltx_font_bold">Problem statement.</span>
A VQA model is tasked with answering natural language questions from the visual content of a scene. Given a dataset <math id="S3.p1.1.m1.4" class="ltx_Math" alttext="\mathcal{X}=\{u_{i},q_{i},a_{i},r_{i}\}_{i=1}^{N}" display="inline"><semantics id="S3.p1.1.m1.4a"><mrow id="S3.p1.1.m1.4.4" xref="S3.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.4.4.6" xref="S3.p1.1.m1.4.4.6.cmml">𝒳</mi><mo id="S3.p1.1.m1.4.4.5" xref="S3.p1.1.m1.4.4.5.cmml">=</mo><msubsup id="S3.p1.1.m1.4.4.4" xref="S3.p1.1.m1.4.4.4.cmml"><mrow id="S3.p1.1.m1.4.4.4.4.4.4" xref="S3.p1.1.m1.4.4.4.4.4.5.cmml"><mo stretchy="false" id="S3.p1.1.m1.4.4.4.4.4.4.5" xref="S3.p1.1.m1.4.4.4.4.4.5.cmml">{</mo><msub id="S3.p1.1.m1.1.1.1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.1.1.1.1.1.2" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2.cmml">u</mi><mi id="S3.p1.1.m1.1.1.1.1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p1.1.m1.4.4.4.4.4.4.6" xref="S3.p1.1.m1.4.4.4.4.4.5.cmml">,</mo><msub id="S3.p1.1.m1.2.2.2.2.2.2.2" xref="S3.p1.1.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.p1.1.m1.2.2.2.2.2.2.2.2" xref="S3.p1.1.m1.2.2.2.2.2.2.2.2.cmml">q</mi><mi id="S3.p1.1.m1.2.2.2.2.2.2.2.3" xref="S3.p1.1.m1.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.p1.1.m1.4.4.4.4.4.4.7" xref="S3.p1.1.m1.4.4.4.4.4.5.cmml">,</mo><msub id="S3.p1.1.m1.3.3.3.3.3.3.3" xref="S3.p1.1.m1.3.3.3.3.3.3.3.cmml"><mi id="S3.p1.1.m1.3.3.3.3.3.3.3.2" xref="S3.p1.1.m1.3.3.3.3.3.3.3.2.cmml">a</mi><mi id="S3.p1.1.m1.3.3.3.3.3.3.3.3" xref="S3.p1.1.m1.3.3.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.p1.1.m1.4.4.4.4.4.4.8" xref="S3.p1.1.m1.4.4.4.4.4.5.cmml">,</mo><msub id="S3.p1.1.m1.4.4.4.4.4.4.4" xref="S3.p1.1.m1.4.4.4.4.4.4.4.cmml"><mi id="S3.p1.1.m1.4.4.4.4.4.4.4.2" xref="S3.p1.1.m1.4.4.4.4.4.4.4.2.cmml">r</mi><mi id="S3.p1.1.m1.4.4.4.4.4.4.4.3" xref="S3.p1.1.m1.4.4.4.4.4.4.4.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p1.1.m1.4.4.4.4.4.4.9" xref="S3.p1.1.m1.4.4.4.4.4.5.cmml">}</mo></mrow><mrow id="S3.p1.1.m1.4.4.4.4.6" xref="S3.p1.1.m1.4.4.4.4.6.cmml"><mi id="S3.p1.1.m1.4.4.4.4.6.2" xref="S3.p1.1.m1.4.4.4.4.6.2.cmml">i</mi><mo id="S3.p1.1.m1.4.4.4.4.6.1" xref="S3.p1.1.m1.4.4.4.4.6.1.cmml">=</mo><mn id="S3.p1.1.m1.4.4.4.4.6.3" xref="S3.p1.1.m1.4.4.4.4.6.3.cmml">1</mn></mrow><mi id="S3.p1.1.m1.4.4.4.6" xref="S3.p1.1.m1.4.4.4.6.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.4b"><apply id="S3.p1.1.m1.4.4.cmml" xref="S3.p1.1.m1.4.4"><eq id="S3.p1.1.m1.4.4.5.cmml" xref="S3.p1.1.m1.4.4.5"></eq><ci id="S3.p1.1.m1.4.4.6.cmml" xref="S3.p1.1.m1.4.4.6">𝒳</ci><apply id="S3.p1.1.m1.4.4.4.cmml" xref="S3.p1.1.m1.4.4.4"><csymbol cd="ambiguous" id="S3.p1.1.m1.4.4.4.5.cmml" xref="S3.p1.1.m1.4.4.4">superscript</csymbol><apply id="S3.p1.1.m1.4.4.4.4.cmml" xref="S3.p1.1.m1.4.4.4"><csymbol cd="ambiguous" id="S3.p1.1.m1.4.4.4.4.5.cmml" xref="S3.p1.1.m1.4.4.4">subscript</csymbol><set id="S3.p1.1.m1.4.4.4.4.4.5.cmml" xref="S3.p1.1.m1.4.4.4.4.4.4"><apply id="S3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.2">𝑢</ci><ci id="S3.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.p1.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2.2.2.2.2.2">𝑞</ci><ci id="S3.p1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.p1.1.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.p1.1.m1.3.3.3.3.3.3.3.cmml" xref="S3.p1.1.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.p1.1.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S3.p1.1.m1.3.3.3.3.3.3.3.2.cmml" xref="S3.p1.1.m1.3.3.3.3.3.3.3.2">𝑎</ci><ci id="S3.p1.1.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.p1.1.m1.3.3.3.3.3.3.3.3">𝑖</ci></apply><apply id="S3.p1.1.m1.4.4.4.4.4.4.4.cmml" xref="S3.p1.1.m1.4.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.p1.1.m1.4.4.4.4.4.4.4.1.cmml" xref="S3.p1.1.m1.4.4.4.4.4.4.4">subscript</csymbol><ci id="S3.p1.1.m1.4.4.4.4.4.4.4.2.cmml" xref="S3.p1.1.m1.4.4.4.4.4.4.4.2">𝑟</ci><ci id="S3.p1.1.m1.4.4.4.4.4.4.4.3.cmml" xref="S3.p1.1.m1.4.4.4.4.4.4.4.3">𝑖</ci></apply></set><apply id="S3.p1.1.m1.4.4.4.4.6.cmml" xref="S3.p1.1.m1.4.4.4.4.6"><eq id="S3.p1.1.m1.4.4.4.4.6.1.cmml" xref="S3.p1.1.m1.4.4.4.4.6.1"></eq><ci id="S3.p1.1.m1.4.4.4.4.6.2.cmml" xref="S3.p1.1.m1.4.4.4.4.6.2">𝑖</ci><cn type="integer" id="S3.p1.1.m1.4.4.4.4.6.3.cmml" xref="S3.p1.1.m1.4.4.4.4.6.3">1</cn></apply></apply><ci id="S3.p1.1.m1.4.4.4.6.cmml" xref="S3.p1.1.m1.4.4.4.6">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.4c">\mathcal{X}=\{u_{i},q_{i},a_{i},r_{i}\}_{i=1}^{N}</annotation></semantics></math> of <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">N</annotation></semantics></math> images where <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="u_{i}\in V" display="inline"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><msub id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml"><mi id="S3.p1.3.m3.1.1.2.2" xref="S3.p1.3.m3.1.1.2.2.cmml">u</mi><mi id="S3.p1.3.m3.1.1.2.3" xref="S3.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.3.m3.1.1.1" xref="S3.p1.3.m3.1.1.1.cmml">∈</mo><mi id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><in id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1"></in><apply id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.2.1.cmml" xref="S3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.2.cmml" xref="S3.p1.3.m3.1.1.2.2">𝑢</ci><ci id="S3.p1.3.m3.1.1.2.3.cmml" xref="S3.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">u_{i}\in V</annotation></semantics></math> is the visual input with question <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="q_{i}\in Q" display="inline"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><msub id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml"><mi id="S3.p1.4.m4.1.1.2.2" xref="S3.p1.4.m4.1.1.2.2.cmml">q</mi><mi id="S3.p1.4.m4.1.1.2.3" xref="S3.p1.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.4.m4.1.1.1" xref="S3.p1.4.m4.1.1.1.cmml">∈</mo><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><in id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1"></in><apply id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.2.1.cmml" xref="S3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.2.cmml" xref="S3.p1.4.m4.1.1.2.2">𝑞</ci><ci id="S3.p1.4.m4.1.1.2.3.cmml" xref="S3.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">q_{i}\in Q</annotation></semantics></math>, reasoning <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="r_{i}\in R" display="inline"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><msub id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml"><mi id="S3.p1.5.m5.1.1.2.2" xref="S3.p1.5.m5.1.1.2.2.cmml">r</mi><mi id="S3.p1.5.m5.1.1.2.3" xref="S3.p1.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">∈</mo><mi id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><in id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></in><apply id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.2.1.cmml" xref="S3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.2.cmml" xref="S3.p1.5.m5.1.1.2.2">𝑟</ci><ci id="S3.p1.5.m5.1.1.2.3.cmml" xref="S3.p1.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">r_{i}\in R</annotation></semantics></math> and groundtruth answer <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="a_{i}\in A" display="inline"><semantics id="S3.p1.6.m6.1a"><mrow id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><msub id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml"><mi id="S3.p1.6.m6.1.1.2.2" xref="S3.p1.6.m6.1.1.2.2.cmml">a</mi><mi id="S3.p1.6.m6.1.1.2.3" xref="S3.p1.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.6.m6.1.1.1" xref="S3.p1.6.m6.1.1.1.cmml">∈</mo><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><in id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1"></in><apply id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.2.1.cmml" xref="S3.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.2.cmml" xref="S3.p1.6.m6.1.1.2.2">𝑎</ci><ci id="S3.p1.6.m6.1.1.2.3.cmml" xref="S3.p1.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">a_{i}\in A</annotation></semantics></math>, our goal is to learn a function <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="f:Q\times V\rightarrow\mathbb{R}^{A}" display="inline"><semantics id="S3.p1.7.m7.1a"><mrow id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">f</mi><mo lspace="0.278em" rspace="0.278em" id="S3.p1.7.m7.1.1.1" xref="S3.p1.7.m7.1.1.1.cmml">:</mo><mrow id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml"><mrow id="S3.p1.7.m7.1.1.3.2" xref="S3.p1.7.m7.1.1.3.2.cmml"><mi id="S3.p1.7.m7.1.1.3.2.2" xref="S3.p1.7.m7.1.1.3.2.2.cmml">Q</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.7.m7.1.1.3.2.1" xref="S3.p1.7.m7.1.1.3.2.1.cmml">×</mo><mi id="S3.p1.7.m7.1.1.3.2.3" xref="S3.p1.7.m7.1.1.3.2.3.cmml">V</mi></mrow><mo stretchy="false" id="S3.p1.7.m7.1.1.3.1" xref="S3.p1.7.m7.1.1.3.1.cmml">→</mo><msup id="S3.p1.7.m7.1.1.3.3" xref="S3.p1.7.m7.1.1.3.3.cmml"><mi id="S3.p1.7.m7.1.1.3.3.2" xref="S3.p1.7.m7.1.1.3.3.2.cmml">ℝ</mi><mi id="S3.p1.7.m7.1.1.3.3.3" xref="S3.p1.7.m7.1.1.3.3.3.cmml">A</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><ci id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1">:</ci><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝑓</ci><apply id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3"><ci id="S3.p1.7.m7.1.1.3.1.cmml" xref="S3.p1.7.m7.1.1.3.1">→</ci><apply id="S3.p1.7.m7.1.1.3.2.cmml" xref="S3.p1.7.m7.1.1.3.2"><times id="S3.p1.7.m7.1.1.3.2.1.cmml" xref="S3.p1.7.m7.1.1.3.2.1"></times><ci id="S3.p1.7.m7.1.1.3.2.2.cmml" xref="S3.p1.7.m7.1.1.3.2.2">𝑄</ci><ci id="S3.p1.7.m7.1.1.3.2.3.cmml" xref="S3.p1.7.m7.1.1.3.2.3">𝑉</ci></apply><apply id="S3.p1.7.m7.1.1.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.3.3.1.cmml" xref="S3.p1.7.m7.1.1.3.3">superscript</csymbol><ci id="S3.p1.7.m7.1.1.3.3.2.cmml" xref="S3.p1.7.m7.1.1.3.3.2">ℝ</ci><ci id="S3.p1.7.m7.1.1.3.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3.3">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">f:Q\times V\rightarrow\mathbb{R}^{A}</annotation></semantics></math> that predicts a distribution <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="P(A)" display="inline"><semantics id="S3.p1.8.m8.1a"><mrow id="S3.p1.8.m8.1.2" xref="S3.p1.8.m8.1.2.cmml"><mi id="S3.p1.8.m8.1.2.2" xref="S3.p1.8.m8.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p1.8.m8.1.2.1" xref="S3.p1.8.m8.1.2.1.cmml">​</mo><mrow id="S3.p1.8.m8.1.2.3.2" xref="S3.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S3.p1.8.m8.1.2.3.2.1" xref="S3.p1.8.m8.1.2.cmml">(</mo><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">A</mi><mo stretchy="false" id="S3.p1.8.m8.1.2.3.2.2" xref="S3.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.2.cmml" xref="S3.p1.8.m8.1.2"><times id="S3.p1.8.m8.1.2.1.cmml" xref="S3.p1.8.m8.1.2.1"></times><ci id="S3.p1.8.m8.1.2.2.cmml" xref="S3.p1.8.m8.1.2.2">𝑃</ci><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">P(A)</annotation></semantics></math> over possible answers in <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">A</annotation></semantics></math>. Our proposed pipeline consists of two parallel streams, a <span id="S3.p1.14.2" class="ltx_text ltx_font_italic">language stream</span> with model parameters <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S3.p1.10.m10.1a"><msub id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml"><mi id="S3.p1.10.m10.1.1.2" xref="S3.p1.10.m10.1.1.2.cmml">θ</mi><mi id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.cmml" xref="S3.p1.10.m10.1.1">subscript</csymbol><ci id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1.2">𝜃</ci><ci id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">\theta_{L}</annotation></semantics></math> and a <span id="S3.p1.14.3" class="ltx_text ltx_font_italic">visual attention stream</span> with model parameters <math id="S3.p1.11.m11.1" class="ltx_Math" alttext="\theta_{V_{q}}" display="inline"><semantics id="S3.p1.11.m11.1a"><msub id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml"><mi id="S3.p1.11.m11.1.1.2" xref="S3.p1.11.m11.1.1.2.cmml">θ</mi><msub id="S3.p1.11.m11.1.1.3" xref="S3.p1.11.m11.1.1.3.cmml"><mi id="S3.p1.11.m11.1.1.3.2" xref="S3.p1.11.m11.1.1.3.2.cmml">V</mi><mi id="S3.p1.11.m11.1.1.3.3" xref="S3.p1.11.m11.1.1.3.3.cmml">q</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><apply id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.1.1.cmml" xref="S3.p1.11.m11.1.1">subscript</csymbol><ci id="S3.p1.11.m11.1.1.2.cmml" xref="S3.p1.11.m11.1.1.2">𝜃</ci><apply id="S3.p1.11.m11.1.1.3.cmml" xref="S3.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.1.3.1.cmml" xref="S3.p1.11.m11.1.1.3">subscript</csymbol><ci id="S3.p1.11.m11.1.1.3.2.cmml" xref="S3.p1.11.m11.1.1.3.2">𝑉</ci><ci id="S3.p1.11.m11.1.1.3.3.cmml" xref="S3.p1.11.m11.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">\theta_{V_{q}}</annotation></semantics></math> and <math id="S3.p1.12.m12.1" class="ltx_Math" alttext="\theta_{V_{r}}" display="inline"><semantics id="S3.p1.12.m12.1a"><msub id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml"><mi id="S3.p1.12.m12.1.1.2" xref="S3.p1.12.m12.1.1.2.cmml">θ</mi><msub id="S3.p1.12.m12.1.1.3" xref="S3.p1.12.m12.1.1.3.cmml"><mi id="S3.p1.12.m12.1.1.3.2" xref="S3.p1.12.m12.1.1.3.2.cmml">V</mi><mi id="S3.p1.12.m12.1.1.3.3" xref="S3.p1.12.m12.1.1.3.3.cmml">r</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><apply id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.p1.12.m12.1.1.1.cmml" xref="S3.p1.12.m12.1.1">subscript</csymbol><ci id="S3.p1.12.m12.1.1.2.cmml" xref="S3.p1.12.m12.1.1.2">𝜃</ci><apply id="S3.p1.12.m12.1.1.3.cmml" xref="S3.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.p1.12.m12.1.1.3.1.cmml" xref="S3.p1.12.m12.1.1.3">subscript</csymbol><ci id="S3.p1.12.m12.1.1.3.2.cmml" xref="S3.p1.12.m12.1.1.3.2">𝑉</ci><ci id="S3.p1.12.m12.1.1.3.3.cmml" xref="S3.p1.12.m12.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">\theta_{V_{r}}</annotation></semantics></math> (question and reasoning guided attention decoder that we will discuss next). During training, we will utilize reasoning supervision as an additional supervisory signal, thus modeling <math id="S3.p1.13.m13.1" class="ltx_Math" alttext="P(A|u_{i},q_{i},r_{i};(\theta_{L},\theta_{V_{q}},\theta_{V_{r}}))" display="inline"><semantics id="S3.p1.13.m13.1a"><mrow id="S3.p1.13.m13.1.1" xref="S3.p1.13.m13.1.1.cmml"><mi id="S3.p1.13.m13.1.1.3" xref="S3.p1.13.m13.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p1.13.m13.1.1.2" xref="S3.p1.13.m13.1.1.2.cmml">​</mo><mrow id="S3.p1.13.m13.1.1.1.1" xref="S3.p1.13.m13.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.13.m13.1.1.1.1.2" xref="S3.p1.13.m13.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.13.m13.1.1.1.1.1" xref="S3.p1.13.m13.1.1.1.1.1.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.6" xref="S3.p1.13.m13.1.1.1.1.1.6.cmml">A</mi><mo fence="false" id="S3.p1.13.m13.1.1.1.1.1.5" xref="S3.p1.13.m13.1.1.1.1.1.5.cmml">|</mo><mrow id="S3.p1.13.m13.1.1.1.1.1.4.4" xref="S3.p1.13.m13.1.1.1.1.1.4.5.cmml"><msub id="S3.p1.13.m13.1.1.1.1.1.1.1.1" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.1.1.1.2" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.2.cmml">u</mi><mi id="S3.p1.13.m13.1.1.1.1.1.1.1.1.3" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p1.13.m13.1.1.1.1.1.4.4.5" xref="S3.p1.13.m13.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.p1.13.m13.1.1.1.1.1.2.2.2" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.2.2.2.2" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.2.cmml">q</mi><mi id="S3.p1.13.m13.1.1.1.1.1.2.2.2.3" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.p1.13.m13.1.1.1.1.1.4.4.6" xref="S3.p1.13.m13.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.p1.13.m13.1.1.1.1.1.3.3.3" xref="S3.p1.13.m13.1.1.1.1.1.3.3.3.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.3.3.3.2" xref="S3.p1.13.m13.1.1.1.1.1.3.3.3.2.cmml">r</mi><mi id="S3.p1.13.m13.1.1.1.1.1.3.3.3.3" xref="S3.p1.13.m13.1.1.1.1.1.3.3.3.3.cmml">i</mi></msub><mo id="S3.p1.13.m13.1.1.1.1.1.4.4.7" xref="S3.p1.13.m13.1.1.1.1.1.4.5.cmml">;</mo><mrow id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.4.cmml"><mo stretchy="false" id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.4" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.4.cmml">(</mo><msub id="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.2" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.2.cmml">θ</mi><mi id="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.3" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.3.cmml">L</mi></msub><mo id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.5" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.4.cmml">,</mo><msub id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.2" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.2.cmml">θ</mi><msub id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.2" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.2.cmml">V</mi><mi id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.3" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.3.cmml">q</mi></msub></msub><mo id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.6" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.4.cmml">,</mo><msub id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.2" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.2.cmml">θ</mi><msub id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.cmml"><mi id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.2" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.2.cmml">V</mi><mi id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.3" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.3.cmml">r</mi></msub></msub><mo stretchy="false" id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.7" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.4.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.p1.13.m13.1.1.1.1.3" xref="S3.p1.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><apply id="S3.p1.13.m13.1.1.cmml" xref="S3.p1.13.m13.1.1"><times id="S3.p1.13.m13.1.1.2.cmml" xref="S3.p1.13.m13.1.1.2"></times><ci id="S3.p1.13.m13.1.1.3.cmml" xref="S3.p1.13.m13.1.1.3">𝑃</ci><apply id="S3.p1.13.m13.1.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1"><csymbol cd="latexml" id="S3.p1.13.m13.1.1.1.1.1.5.cmml" xref="S3.p1.13.m13.1.1.1.1.1.5">conditional</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.6.cmml" xref="S3.p1.13.m13.1.1.1.1.1.6">𝐴</ci><list id="S3.p1.13.m13.1.1.1.1.1.4.5.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4"><apply id="S3.p1.13.m13.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.2">𝑢</ci><ci id="S3.p1.13.m13.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p1.13.m13.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.2">𝑞</ci><ci id="S3.p1.13.m13.1.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.p1.13.m13.1.1.1.1.1.3.3.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.3.3.3.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.3.3.3.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.3.3.3.2">𝑟</ci><ci id="S3.p1.13.m13.1.1.1.1.1.3.3.3.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.3.3.3.3">𝑖</ci></apply><vector id="S3.p1.13.m13.1.1.1.1.1.4.4.4.4.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3"><apply id="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.2">𝜃</ci><ci id="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.1.1.3">𝐿</ci></apply><apply id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.2">𝜃</ci><apply id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.2">𝑉</ci><ci id="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.2.2.3.3">𝑞</ci></apply></apply><apply id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.2">𝜃</ci><apply id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.1.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3">subscript</csymbol><ci id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.2.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.2">𝑉</ci><ci id="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.3.cmml" xref="S3.p1.13.m13.1.1.1.1.1.4.4.4.3.3.3.3">𝑟</ci></apply></apply></vector></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">P(A|u_{i},q_{i},r_{i};(\theta_{L},\theta_{V_{q}},\theta_{V_{r}}))</annotation></semantics></math> that simplifies to <math id="S3.p1.14.m14.1" class="ltx_Math" alttext="P(A|u_{i},q_{i};(\theta_{L},\theta_{V_{q}}))" display="inline"><semantics id="S3.p1.14.m14.1a"><mrow id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml"><mi id="S3.p1.14.m14.1.1.3" xref="S3.p1.14.m14.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p1.14.m14.1.1.2" xref="S3.p1.14.m14.1.1.2.cmml">​</mo><mrow id="S3.p1.14.m14.1.1.1.1" xref="S3.p1.14.m14.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.14.m14.1.1.1.1.2" xref="S3.p1.14.m14.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.14.m14.1.1.1.1.1" xref="S3.p1.14.m14.1.1.1.1.1.cmml"><mi id="S3.p1.14.m14.1.1.1.1.1.5" xref="S3.p1.14.m14.1.1.1.1.1.5.cmml">A</mi><mo fence="false" id="S3.p1.14.m14.1.1.1.1.1.4" xref="S3.p1.14.m14.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.p1.14.m14.1.1.1.1.1.3.3" xref="S3.p1.14.m14.1.1.1.1.1.3.4.cmml"><msub id="S3.p1.14.m14.1.1.1.1.1.1.1.1" xref="S3.p1.14.m14.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.14.m14.1.1.1.1.1.1.1.1.2" xref="S3.p1.14.m14.1.1.1.1.1.1.1.1.2.cmml">u</mi><mi id="S3.p1.14.m14.1.1.1.1.1.1.1.1.3" xref="S3.p1.14.m14.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p1.14.m14.1.1.1.1.1.3.3.4" xref="S3.p1.14.m14.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.p1.14.m14.1.1.1.1.1.2.2.2" xref="S3.p1.14.m14.1.1.1.1.1.2.2.2.cmml"><mi id="S3.p1.14.m14.1.1.1.1.1.2.2.2.2" xref="S3.p1.14.m14.1.1.1.1.1.2.2.2.2.cmml">q</mi><mi id="S3.p1.14.m14.1.1.1.1.1.2.2.2.3" xref="S3.p1.14.m14.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.p1.14.m14.1.1.1.1.1.3.3.5" xref="S3.p1.14.m14.1.1.1.1.1.3.4.cmml">;</mo><mrow id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.3.cmml"><mo stretchy="false" id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.3" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.3.cmml">(</mo><msub id="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.cmml"><mi id="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.2" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.2.cmml">θ</mi><mi id="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.3" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.3.cmml">L</mi></msub><mo id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.4" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.3.cmml">,</mo><msub id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.cmml"><mi id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.2" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.2.cmml">θ</mi><msub id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.cmml"><mi id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.2" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.2.cmml">V</mi><mi id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.3" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.3.cmml">q</mi></msub></msub><mo stretchy="false" id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.5" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.p1.14.m14.1.1.1.1.3" xref="S3.p1.14.m14.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><apply id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1"><times id="S3.p1.14.m14.1.1.2.cmml" xref="S3.p1.14.m14.1.1.2"></times><ci id="S3.p1.14.m14.1.1.3.cmml" xref="S3.p1.14.m14.1.1.3">𝑃</ci><apply id="S3.p1.14.m14.1.1.1.1.1.cmml" xref="S3.p1.14.m14.1.1.1.1"><csymbol cd="latexml" id="S3.p1.14.m14.1.1.1.1.1.4.cmml" xref="S3.p1.14.m14.1.1.1.1.1.4">conditional</csymbol><ci id="S3.p1.14.m14.1.1.1.1.1.5.cmml" xref="S3.p1.14.m14.1.1.1.1.1.5">𝐴</ci><list id="S3.p1.14.m14.1.1.1.1.1.3.4.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3"><apply id="S3.p1.14.m14.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.14.m14.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.14.m14.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.14.m14.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.14.m14.1.1.1.1.1.1.1.1.2">𝑢</ci><ci id="S3.p1.14.m14.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.14.m14.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p1.14.m14.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.14.m14.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.14.m14.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.p1.14.m14.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.14.m14.1.1.1.1.1.2.2.2.2">𝑞</ci><ci id="S3.p1.14.m14.1.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.14.m14.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.14.m14.1.1.1.1.1.3.3.3.3.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2"><apply id="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.1.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1">subscript</csymbol><ci id="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.2.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.2">𝜃</ci><ci id="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.3.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.1.1.3">𝐿</ci></apply><apply id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.1.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2">subscript</csymbol><ci id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.2.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.2">𝜃</ci><apply id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.1.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3">subscript</csymbol><ci id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.2.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.2">𝑉</ci><ci id="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.3.cmml" xref="S3.p1.14.m14.1.1.1.1.1.3.3.3.2.2.3.3">𝑞</ci></apply></apply></interval></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">P(A|u_{i},q_{i};(\theta_{L},\theta_{V_{q}}))</annotation></semantics></math> at test time. 
<br class="ltx_break"></p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p"><span id="S3.p2.1.1" class="ltx_text ltx_font_bold">Language Stream.</span>
The first stream is language-focused and aims to generate an informative representation of the input question and answer sentence pairs by modeling their relationship. The core of its architecture is a bi-directional 12-layer transformer initialized with weights from BERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. It takes a sequence of word embeddings of the question and answer as input (separated by a separation element [SEP]) and adds a sequence positional embedding to each token. The final output feature <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="x_{[CLS]}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.2" xref="S3.p2.1.m1.1.2.cmml"><mi id="S3.p2.1.m1.1.2.2" xref="S3.p2.1.m1.1.2.2.cmml">x</mi><mrow id="S3.p2.1.m1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.p2.1.m1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p2.1.m1.1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.1.1.1.1a" xref="S3.p2.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p2.1.m1.1.1.1.1.1.4" xref="S3.p2.1.m1.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.2.cmml" xref="S3.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.2.1.cmml" xref="S3.p2.1.m1.1.2">subscript</csymbol><ci id="S3.p2.1.m1.1.2.2.cmml" xref="S3.p2.1.m1.1.2.2">𝑥</ci><apply id="S3.p2.1.m1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.p2.1.m1.1.1.1.2.1.cmml" xref="S3.p2.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1"><times id="S3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1"></times><ci id="S3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2">𝐶</ci><ci id="S3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3">𝐿</ci><ci id="S3.p2.1.m1.1.1.1.1.1.4.cmml" xref="S3.p2.1.m1.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">x_{[CLS]}</annotation></semantics></math> of the [CLS] element is used to obtain the final pooled linguistic representation. 
<br class="ltx_break"></p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.1" class="ltx_p"><span id="S3.p3.1.1" class="ltx_text ltx_font_bold">Visual Attention Stream.</span>
The visual attention stream consists of two 9-layer transformer decoders. The first one generates an attention vector over the image features guided by the question, and the second an attention vector over the image features guided by the correct reasoning. We take advantage of the cross-attention module to perceive multimodal information and capture relationships between image features and word embeddings. The process is as follows: The image is first processed via the backbone of a ResNet-50-FPN to extract visual appearance features. The output is a feature map <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{F}\in\mathbb{R}^{H\times W\times 256}" display="inline"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">ℱ</mi><mo id="S3.p3.1.m1.1.1.1" xref="S3.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml"><mi id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3.cmml"><mi id="S3.p3.1.m1.1.1.3.3.2" xref="S3.p3.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p3.1.m1.1.1.3.3.1" xref="S3.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.p3.1.m1.1.1.3.3.3" xref="S3.p3.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p3.1.m1.1.1.3.3.1a" xref="S3.p3.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.p3.1.m1.1.1.3.3.4" xref="S3.p3.1.m1.1.1.3.3.4.cmml">256</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><in id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1"></in><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">ℱ</ci><apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S3.p3.1.m1.1.1.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3"><times id="S3.p3.1.m1.1.1.3.3.1.cmml" xref="S3.p3.1.m1.1.1.3.3.1"></times><ci id="S3.p3.1.m1.1.1.3.3.2.cmml" xref="S3.p3.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.p3.1.m1.1.1.3.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3.3">𝑊</ci><cn type="integer" id="S3.p3.1.m1.1.1.3.3.4.cmml" xref="S3.p3.1.m1.1.1.3.3.4">256</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathcal{F}\in\mathbb{R}^{H\times W\times 256}</annotation></semantics></math>, which we treat as a sequence of 256-dimensional image features. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, a visual geometric embedding is added to each input token to inject 2D awareness into the model. We also encode the question and correct reasoning language tokens via a pre-trained BERT model, which yields a 786-dim representation for each word.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.7" class="ltx_p">Question and reasoning word embeddings are used as input to the corresponding question and reasoning transformer decoders (functioning as query tokens). The image visual features <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{F}" display="inline"><semantics id="S3.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\mathcal{F}</annotation></semantics></math> are used to generate the keys and values. Then, the attention weights are calculated based on the pairwise similarity of the query and key elements. The output of each decoder is an attention distribution over the image regions <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="\alpha\in\mathbb{R}^{H\times W}" display="inline"><semantics id="S3.p4.2.m2.1a"><mrow id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">α</mi><mo id="S3.p4.2.m2.1.1.1" xref="S3.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml"><mi id="S3.p4.2.m2.1.1.3.2" xref="S3.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p4.2.m2.1.1.3.3" xref="S3.p4.2.m2.1.1.3.3.cmml"><mi id="S3.p4.2.m2.1.1.3.3.2" xref="S3.p4.2.m2.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p4.2.m2.1.1.3.3.1" xref="S3.p4.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.p4.2.m2.1.1.3.3.3" xref="S3.p4.2.m2.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><in id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1.1"></in><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝛼</ci><apply id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.3.1.cmml" xref="S3.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.p4.2.m2.1.1.3.2.cmml" xref="S3.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.p4.2.m2.1.1.3.3.cmml" xref="S3.p4.2.m2.1.1.3.3"><times id="S3.p4.2.m2.1.1.3.3.1.cmml" xref="S3.p4.2.m2.1.1.3.3.1"></times><ci id="S3.p4.2.m2.1.1.3.3.2.cmml" xref="S3.p4.2.m2.1.1.3.3.2">𝐻</ci><ci id="S3.p4.2.m2.1.1.3.3.3.cmml" xref="S3.p4.2.m2.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\alpha\in\mathbb{R}^{H\times W}</annotation></semantics></math>, conditioned on either the word embeddings of the question (referred to as <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="\alpha^{Q}" display="inline"><semantics id="S3.p4.3.m3.1a"><msup id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">α</mi><mi id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">superscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝛼</ci><ci id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\alpha^{Q}</annotation></semantics></math>) or the word embeddings of the correct reasoning (referred to as <math id="S3.p4.4.m4.1" class="ltx_Math" alttext="\alpha^{R}" display="inline"><semantics id="S3.p4.4.m4.1a"><msup id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml"><mi id="S3.p4.4.m4.1.1.2" xref="S3.p4.4.m4.1.1.2.cmml">α</mi><mi id="S3.p4.4.m4.1.1.3" xref="S3.p4.4.m4.1.1.3.cmml">R</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.1.1.cmml" xref="S3.p4.4.m4.1.1">superscript</csymbol><ci id="S3.p4.4.m4.1.1.2.cmml" xref="S3.p4.4.m4.1.1.2">𝛼</ci><ci id="S3.p4.4.m4.1.1.3.cmml" xref="S3.p4.4.m4.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">\alpha^{R}</annotation></semantics></math>).
In practice, to obtain the final attention vectors <math id="S3.p4.5.m5.1" class="ltx_Math" alttext="\alpha^{Q}" display="inline"><semantics id="S3.p4.5.m5.1a"><msup id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml"><mi id="S3.p4.5.m5.1.1.2" xref="S3.p4.5.m5.1.1.2.cmml">α</mi><mi id="S3.p4.5.m5.1.1.3" xref="S3.p4.5.m5.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.1.cmml" xref="S3.p4.5.m5.1.1">superscript</csymbol><ci id="S3.p4.5.m5.1.1.2.cmml" xref="S3.p4.5.m5.1.1.2">𝛼</ci><ci id="S3.p4.5.m5.1.1.3.cmml" xref="S3.p4.5.m5.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">\alpha^{Q}</annotation></semantics></math> and <math id="S3.p4.6.m6.1" class="ltx_Math" alttext="\alpha^{R}" display="inline"><semantics id="S3.p4.6.m6.1a"><msup id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml"><mi id="S3.p4.6.m6.1.1.2" xref="S3.p4.6.m6.1.1.2.cmml">α</mi><mi id="S3.p4.6.m6.1.1.3" xref="S3.p4.6.m6.1.1.3.cmml">R</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><apply id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p4.6.m6.1.1.1.cmml" xref="S3.p4.6.m6.1.1">superscript</csymbol><ci id="S3.p4.6.m6.1.1.2.cmml" xref="S3.p4.6.m6.1.1.2">𝛼</ci><ci id="S3.p4.6.m6.1.1.3.cmml" xref="S3.p4.6.m6.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">\alpha^{R}</annotation></semantics></math>, we compute the average per-head attention of the last layer generated by the <math id="S3.p4.7.m7.1" class="ltx_Math" alttext="[CLS]" display="inline"><semantics id="S3.p4.7.m7.1a"><mrow id="S3.p4.7.m7.1.1.1" xref="S3.p4.7.m7.1.1.2.cmml"><mo stretchy="false" id="S3.p4.7.m7.1.1.1.2" xref="S3.p4.7.m7.1.1.2.1.cmml">[</mo><mrow id="S3.p4.7.m7.1.1.1.1" xref="S3.p4.7.m7.1.1.1.1.cmml"><mi id="S3.p4.7.m7.1.1.1.1.2" xref="S3.p4.7.m7.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.p4.7.m7.1.1.1.1.1" xref="S3.p4.7.m7.1.1.1.1.1.cmml">​</mo><mi id="S3.p4.7.m7.1.1.1.1.3" xref="S3.p4.7.m7.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.p4.7.m7.1.1.1.1.1a" xref="S3.p4.7.m7.1.1.1.1.1.cmml">​</mo><mi id="S3.p4.7.m7.1.1.1.1.4" xref="S3.p4.7.m7.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="S3.p4.7.m7.1.1.1.3" xref="S3.p4.7.m7.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><apply id="S3.p4.7.m7.1.1.2.cmml" xref="S3.p4.7.m7.1.1.1"><csymbol cd="latexml" id="S3.p4.7.m7.1.1.2.1.cmml" xref="S3.p4.7.m7.1.1.1.2">delimited-[]</csymbol><apply id="S3.p4.7.m7.1.1.1.1.cmml" xref="S3.p4.7.m7.1.1.1.1"><times id="S3.p4.7.m7.1.1.1.1.1.cmml" xref="S3.p4.7.m7.1.1.1.1.1"></times><ci id="S3.p4.7.m7.1.1.1.1.2.cmml" xref="S3.p4.7.m7.1.1.1.1.2">𝐶</ci><ci id="S3.p4.7.m7.1.1.1.1.3.cmml" xref="S3.p4.7.m7.1.1.1.1.3">𝐿</ci><ci id="S3.p4.7.m7.1.1.1.1.4.cmml" xref="S3.p4.7.m7.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">[CLS]</annotation></semantics></math> token over the image features.</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.4" class="ltx_p">The generated attention map <math id="S3.p5.1.m1.1" class="ltx_Math" alttext="\alpha^{Q}" display="inline"><semantics id="S3.p5.1.m1.1a"><msup id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml"><mi id="S3.p5.1.m1.1.1.2" xref="S3.p5.1.m1.1.1.2.cmml">α</mi><mi id="S3.p5.1.m1.1.1.3" xref="S3.p5.1.m1.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.1.cmml" xref="S3.p5.1.m1.1.1">superscript</csymbol><ci id="S3.p5.1.m1.1.1.2.cmml" xref="S3.p5.1.m1.1.1.2">𝛼</ci><ci id="S3.p5.1.m1.1.1.3.cmml" xref="S3.p5.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\alpha^{Q}</annotation></semantics></math>, is then used to take the <span id="S3.p5.4.1" class="ltx_text ltx_font_italic">weighted sum</span> over the image features <math id="S3.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{F}" display="inline"><semantics id="S3.p5.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><ci id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\mathcal{F}</annotation></semantics></math>, which is passed through a linear layer to obtain the final <span id="S3.p5.4.2" class="ltx_text ltx_font_italic">attended-by-the-question</span> representation of the image, <math id="S3.p5.3.m3.1" class="ltx_Math" alttext="V_{q}" display="inline"><semantics id="S3.p5.3.m3.1a"><msub id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml"><mi id="S3.p5.3.m3.1.1.2" xref="S3.p5.3.m3.1.1.2.cmml">V</mi><mi id="S3.p5.3.m3.1.1.3" xref="S3.p5.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><apply id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p5.3.m3.1.1.1.cmml" xref="S3.p5.3.m3.1.1">subscript</csymbol><ci id="S3.p5.3.m3.1.1.2.cmml" xref="S3.p5.3.m3.1.1.2">𝑉</ci><ci id="S3.p5.3.m3.1.1.3.cmml" xref="S3.p5.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">V_{q}</annotation></semantics></math>. The same operation is performed to obtain the <span id="S3.p5.4.3" class="ltx_text ltx_font_italic">attended-by-the-reasoning</span> image representation <math id="S3.p5.4.m4.1" class="ltx_Math" alttext="V_{r}" display="inline"><semantics id="S3.p5.4.m4.1a"><msub id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml"><mi id="S3.p5.4.m4.1.1.2" xref="S3.p5.4.m4.1.1.2.cmml">V</mi><mi id="S3.p5.4.m4.1.1.3" xref="S3.p5.4.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><apply id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p5.4.m4.1.1.1.cmml" xref="S3.p5.4.m4.1.1">subscript</csymbol><ci id="S3.p5.4.m4.1.1.2.cmml" xref="S3.p5.4.m4.1.1.2">𝑉</ci><ci id="S3.p5.4.m4.1.1.3.cmml" xref="S3.p5.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">V_{r}</annotation></semantics></math>. Formally,</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.34" class="ltx_Math" alttext="\begin{split}V_{q}=Linear(\alpha^{Q}\odot\mathcal{F})\\
V_{r}=Linear(\alpha^{R}\odot\mathcal{F})\end{split}" display="block"><semantics id="S3.E1.m1.34a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E1.m1.34.34.4" xref="S3.E1.m1.32.32.2.cmml"><mtr id="S3.E1.m1.34.34.4a" xref="S3.E1.m1.32.32.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.34.34.4b" xref="S3.E1.m1.32.32.2.cmml"><mrow id="S3.E1.m1.33.33.3.31.16.16" xref="S3.E1.m1.32.32.2.cmml"><msub id="S3.E1.m1.33.33.3.31.16.16.17" xref="S3.E1.m1.32.32.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">V</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml">q</mi></msub><mo id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E1.m1.33.33.3.31.16.16.16" xref="S3.E1.m1.32.32.2.cmml"><mi id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.33.33.3.31.16.16.16.2" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.5.5.5.5.5.5" xref="S3.E1.m1.5.5.5.5.5.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.33.33.3.31.16.16.16.2a" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.6.6.6.6.6.6" xref="S3.E1.m1.6.6.6.6.6.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.33.33.3.31.16.16.16.2b" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.7.7.7.7.7.7" xref="S3.E1.m1.7.7.7.7.7.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.33.33.3.31.16.16.16.2c" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.8.8.8.8.8.8" xref="S3.E1.m1.8.8.8.8.8.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.33.33.3.31.16.16.16.2d" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.9.9.9.9.9.9" xref="S3.E1.m1.9.9.9.9.9.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.33.33.3.31.16.16.16.2e" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mrow id="S3.E1.m1.33.33.3.31.16.16.16.1.1" xref="S3.E1.m1.32.32.2.cmml"><mo stretchy="false" id="S3.E1.m1.10.10.10.10.10.10" xref="S3.E1.m1.32.32.2a.cmml">(</mo><mrow id="S3.E1.m1.33.33.3.31.16.16.16.1.1.1" xref="S3.E1.m1.32.32.2.cmml"><msup id="S3.E1.m1.33.33.3.31.16.16.16.1.1.1.1" xref="S3.E1.m1.32.32.2.cmml"><mi id="S3.E1.m1.11.11.11.11.11.11" xref="S3.E1.m1.11.11.11.11.11.11.cmml">α</mi><mi id="S3.E1.m1.12.12.12.12.12.12.1" xref="S3.E1.m1.12.12.12.12.12.12.1.cmml">Q</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.13.13.13.13.13.13" xref="S3.E1.m1.13.13.13.13.13.13.cmml">⊙</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.14.14.14.14.14.14" xref="S3.E1.m1.14.14.14.14.14.14.cmml">ℱ</mi></mrow><mo stretchy="false" id="S3.E1.m1.15.15.15.15.15.15" xref="S3.E1.m1.32.32.2a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E1.m1.34.34.4c" xref="S3.E1.m1.32.32.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.34.34.4d" xref="S3.E1.m1.32.32.2.cmml"><mrow id="S3.E1.m1.34.34.4.32.16.16" xref="S3.E1.m1.32.32.2.cmml"><msub id="S3.E1.m1.34.34.4.32.16.16.17" xref="S3.E1.m1.32.32.2.cmml"><mi id="S3.E1.m1.16.16.16.1.1.1" xref="S3.E1.m1.16.16.16.1.1.1.cmml">V</mi><mi id="S3.E1.m1.17.17.17.2.2.2.1" xref="S3.E1.m1.17.17.17.2.2.2.1.cmml">r</mi></msub><mo id="S3.E1.m1.18.18.18.3.3.3" xref="S3.E1.m1.18.18.18.3.3.3.cmml">=</mo><mrow id="S3.E1.m1.34.34.4.32.16.16.16" xref="S3.E1.m1.32.32.2.cmml"><mi id="S3.E1.m1.19.19.19.4.4.4" xref="S3.E1.m1.19.19.19.4.4.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.4.32.16.16.16.2" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.20.20.20.5.5.5" xref="S3.E1.m1.20.20.20.5.5.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.4.32.16.16.16.2a" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.21.21.21.6.6.6" xref="S3.E1.m1.21.21.21.6.6.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.4.32.16.16.16.2b" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.22.22.22.7.7.7" xref="S3.E1.m1.22.22.22.7.7.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.4.32.16.16.16.2c" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.23.23.23.8.8.8" xref="S3.E1.m1.23.23.23.8.8.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.4.32.16.16.16.2d" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mi id="S3.E1.m1.24.24.24.9.9.9" xref="S3.E1.m1.24.24.24.9.9.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.4.32.16.16.16.2e" xref="S3.E1.m1.32.32.2a.cmml">​</mo><mrow id="S3.E1.m1.34.34.4.32.16.16.16.1.1" xref="S3.E1.m1.32.32.2.cmml"><mo stretchy="false" id="S3.E1.m1.25.25.25.10.10.10" xref="S3.E1.m1.32.32.2a.cmml">(</mo><mrow id="S3.E1.m1.34.34.4.32.16.16.16.1.1.1" xref="S3.E1.m1.32.32.2.cmml"><msup id="S3.E1.m1.34.34.4.32.16.16.16.1.1.1.1" xref="S3.E1.m1.32.32.2.cmml"><mi id="S3.E1.m1.26.26.26.11.11.11" xref="S3.E1.m1.26.26.26.11.11.11.cmml">α</mi><mi id="S3.E1.m1.27.27.27.12.12.12.1" xref="S3.E1.m1.27.27.27.12.12.12.1.cmml">R</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.28.28.28.13.13.13" xref="S3.E1.m1.28.28.28.13.13.13.cmml">⊙</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.29.29.29.14.14.14" xref="S3.E1.m1.29.29.29.14.14.14.cmml">ℱ</mi></mrow><mo stretchy="false" id="S3.E1.m1.30.30.30.15.15.15" xref="S3.E1.m1.32.32.2a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.34b"><apply id="S3.E1.m1.32.32.2.cmml" xref="S3.E1.m1.34.34.4"><and id="S3.E1.m1.32.32.2a.cmml" xref="S3.E1.m1.33.33.3.31.16.16.16.2"></and><apply id="S3.E1.m1.32.32.2b.cmml" xref="S3.E1.m1.34.34.4"><eq id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3"></eq><apply id="S3.E1.m1.32.32.2.4.cmml" xref="S3.E1.m1.34.34.4"><csymbol cd="ambiguous" id="S3.E1.m1.32.32.2.4.1.cmml" xref="S3.E1.m1.33.33.3.31.16.16.16.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝑉</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1">𝑞</ci></apply><apply id="S3.E1.m1.31.31.1.1.cmml" xref="S3.E1.m1.34.34.4"><times id="S3.E1.m1.31.31.1.1.2.cmml" xref="S3.E1.m1.33.33.3.31.16.16.16.2"></times><ci id="S3.E1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4.4">𝐿</ci><ci id="S3.E1.m1.5.5.5.5.5.5.cmml" xref="S3.E1.m1.5.5.5.5.5.5">𝑖</ci><ci id="S3.E1.m1.6.6.6.6.6.6.cmml" xref="S3.E1.m1.6.6.6.6.6.6">𝑛</ci><ci id="S3.E1.m1.7.7.7.7.7.7.cmml" xref="S3.E1.m1.7.7.7.7.7.7">𝑒</ci><ci id="S3.E1.m1.8.8.8.8.8.8.cmml" xref="S3.E1.m1.8.8.8.8.8.8">𝑎</ci><ci id="S3.E1.m1.9.9.9.9.9.9.cmml" xref="S3.E1.m1.9.9.9.9.9.9">𝑟</ci><apply id="S3.E1.m1.31.31.1.1.1.1.1.cmml" xref="S3.E1.m1.34.34.4"><csymbol cd="latexml" id="S3.E1.m1.13.13.13.13.13.13.cmml" xref="S3.E1.m1.13.13.13.13.13.13">direct-product</csymbol><apply id="S3.E1.m1.31.31.1.1.1.1.1.2.cmml" xref="S3.E1.m1.34.34.4"><csymbol cd="ambiguous" id="S3.E1.m1.31.31.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.34.34.4">superscript</csymbol><ci id="S3.E1.m1.11.11.11.11.11.11.cmml" xref="S3.E1.m1.11.11.11.11.11.11">𝛼</ci><ci id="S3.E1.m1.12.12.12.12.12.12.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1">𝑄</ci></apply><ci id="S3.E1.m1.14.14.14.14.14.14.cmml" xref="S3.E1.m1.14.14.14.14.14.14">ℱ</ci></apply><apply id="S3.E1.m1.31.31.1.1.9.cmml" xref="S3.E1.m1.34.34.4"><csymbol cd="ambiguous" id="S3.E1.m1.31.31.1.1.9.1.cmml" xref="S3.E1.m1.33.33.3.31.16.16.16.2">subscript</csymbol><ci id="S3.E1.m1.16.16.16.1.1.1.cmml" xref="S3.E1.m1.16.16.16.1.1.1">𝑉</ci><ci id="S3.E1.m1.17.17.17.2.2.2.1.cmml" xref="S3.E1.m1.17.17.17.2.2.2.1">𝑟</ci></apply></apply></apply><apply id="S3.E1.m1.32.32.2c.cmml" xref="S3.E1.m1.34.34.4"><eq id="S3.E1.m1.18.18.18.3.3.3.cmml" xref="S3.E1.m1.18.18.18.3.3.3"></eq><share href="#S3.E1.m1.31.31.1.1.cmml" id="S3.E1.m1.32.32.2d.cmml" xref="S3.E1.m1.33.33.3.31.16.16.16.2"></share><apply id="S3.E1.m1.32.32.2.2.cmml" xref="S3.E1.m1.34.34.4"><times id="S3.E1.m1.32.32.2.2.2.cmml" xref="S3.E1.m1.33.33.3.31.16.16.16.2"></times><ci id="S3.E1.m1.19.19.19.4.4.4.cmml" xref="S3.E1.m1.19.19.19.4.4.4">𝐿</ci><ci id="S3.E1.m1.20.20.20.5.5.5.cmml" xref="S3.E1.m1.20.20.20.5.5.5">𝑖</ci><ci id="S3.E1.m1.21.21.21.6.6.6.cmml" xref="S3.E1.m1.21.21.21.6.6.6">𝑛</ci><ci id="S3.E1.m1.22.22.22.7.7.7.cmml" xref="S3.E1.m1.22.22.22.7.7.7">𝑒</ci><ci id="S3.E1.m1.23.23.23.8.8.8.cmml" xref="S3.E1.m1.23.23.23.8.8.8">𝑎</ci><ci id="S3.E1.m1.24.24.24.9.9.9.cmml" xref="S3.E1.m1.24.24.24.9.9.9">𝑟</ci><apply id="S3.E1.m1.32.32.2.2.1.1.1.cmml" xref="S3.E1.m1.34.34.4"><csymbol cd="latexml" id="S3.E1.m1.28.28.28.13.13.13.cmml" xref="S3.E1.m1.28.28.28.13.13.13">direct-product</csymbol><apply id="S3.E1.m1.32.32.2.2.1.1.1.2.cmml" xref="S3.E1.m1.34.34.4"><csymbol cd="ambiguous" id="S3.E1.m1.32.32.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.34.34.4">superscript</csymbol><ci id="S3.E1.m1.26.26.26.11.11.11.cmml" xref="S3.E1.m1.26.26.26.11.11.11">𝛼</ci><ci id="S3.E1.m1.27.27.27.12.12.12.1.cmml" xref="S3.E1.m1.27.27.27.12.12.12.1">𝑅</ci></apply><ci id="S3.E1.m1.29.29.29.14.14.14.cmml" xref="S3.E1.m1.29.29.29.14.14.14">ℱ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.34c">\begin{split}V_{q}=Linear(\alpha^{Q}\odot\mathcal{F})\\
V_{r}=Linear(\alpha^{R}\odot\mathcal{F})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<br class="ltx_break">
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2309.03726/assets/resultfig.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="500" height="152" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.4.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>Comparison of question-guided attention maps (only the question attention decoder) before <span id="S3.F3.5.2" class="ltx_text ltx_font_italic">(first row)</span>, and after finetuning with reasoning supervision <span id="S3.F3.6.3" class="ltx_text ltx_font_italic">(second row)</span>. We observe that the finetuned model is able to attend to informative regions.</figcaption>
</figure>
<div id="S3.p6" class="ltx_para ltx_noindent">
<p id="S3.p6.7" class="ltx_p"><span id="S3.p6.7.1" class="ltx_text ltx_font_bold">Combining Language and Visual Streams.</span>
The model outputs two separate predictions, one conditioned on the question <math id="S3.p6.1.m1.1" class="ltx_Math" alttext="y_{q}" display="inline"><semantics id="S3.p6.1.m1.1a"><msub id="S3.p6.1.m1.1.1" xref="S3.p6.1.m1.1.1.cmml"><mi id="S3.p6.1.m1.1.1.2" xref="S3.p6.1.m1.1.1.2.cmml">y</mi><mi id="S3.p6.1.m1.1.1.3" xref="S3.p6.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.1b"><apply id="S3.p6.1.m1.1.1.cmml" xref="S3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p6.1.m1.1.1.1.cmml" xref="S3.p6.1.m1.1.1">subscript</csymbol><ci id="S3.p6.1.m1.1.1.2.cmml" xref="S3.p6.1.m1.1.1.2">𝑦</ci><ci id="S3.p6.1.m1.1.1.3.cmml" xref="S3.p6.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.m1.1c">y_{q}</annotation></semantics></math> and the other on the correct reasoning <math id="S3.p6.2.m2.1" class="ltx_Math" alttext="y_{r}" display="inline"><semantics id="S3.p6.2.m2.1a"><msub id="S3.p6.2.m2.1.1" xref="S3.p6.2.m2.1.1.cmml"><mi id="S3.p6.2.m2.1.1.2" xref="S3.p6.2.m2.1.1.2.cmml">y</mi><mi id="S3.p6.2.m2.1.1.3" xref="S3.p6.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p6.2.m2.1b"><apply id="S3.p6.2.m2.1.1.cmml" xref="S3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p6.2.m2.1.1.1.cmml" xref="S3.p6.2.m2.1.1">subscript</csymbol><ci id="S3.p6.2.m2.1.1.2.cmml" xref="S3.p6.2.m2.1.1.2">𝑦</ci><ci id="S3.p6.2.m2.1.1.3.cmml" xref="S3.p6.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.2.m2.1c">y_{r}</annotation></semantics></math>. These are produced by fusing the outputs of the <span id="S3.p6.7.2" class="ltx_text ltx_font_italic">language stream</span> <math id="S3.p6.3.m3.1" class="ltx_Math" alttext="x_{[CLS]}" display="inline"><semantics id="S3.p6.3.m3.1a"><msub id="S3.p6.3.m3.1.2" xref="S3.p6.3.m3.1.2.cmml"><mi id="S3.p6.3.m3.1.2.2" xref="S3.p6.3.m3.1.2.2.cmml">x</mi><mrow id="S3.p6.3.m3.1.1.1.1" xref="S3.p6.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S3.p6.3.m3.1.1.1.1.2" xref="S3.p6.3.m3.1.1.1.2.1.cmml">[</mo><mrow id="S3.p6.3.m3.1.1.1.1.1" xref="S3.p6.3.m3.1.1.1.1.1.cmml"><mi id="S3.p6.3.m3.1.1.1.1.1.2" xref="S3.p6.3.m3.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.p6.3.m3.1.1.1.1.1.1" xref="S3.p6.3.m3.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p6.3.m3.1.1.1.1.1.3" xref="S3.p6.3.m3.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.p6.3.m3.1.1.1.1.1.1a" xref="S3.p6.3.m3.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p6.3.m3.1.1.1.1.1.4" xref="S3.p6.3.m3.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="S3.p6.3.m3.1.1.1.1.3" xref="S3.p6.3.m3.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p6.3.m3.1b"><apply id="S3.p6.3.m3.1.2.cmml" xref="S3.p6.3.m3.1.2"><csymbol cd="ambiguous" id="S3.p6.3.m3.1.2.1.cmml" xref="S3.p6.3.m3.1.2">subscript</csymbol><ci id="S3.p6.3.m3.1.2.2.cmml" xref="S3.p6.3.m3.1.2.2">𝑥</ci><apply id="S3.p6.3.m3.1.1.1.2.cmml" xref="S3.p6.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.p6.3.m3.1.1.1.2.1.cmml" xref="S3.p6.3.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.p6.3.m3.1.1.1.1.1.cmml" xref="S3.p6.3.m3.1.1.1.1.1"><times id="S3.p6.3.m3.1.1.1.1.1.1.cmml" xref="S3.p6.3.m3.1.1.1.1.1.1"></times><ci id="S3.p6.3.m3.1.1.1.1.1.2.cmml" xref="S3.p6.3.m3.1.1.1.1.1.2">𝐶</ci><ci id="S3.p6.3.m3.1.1.1.1.1.3.cmml" xref="S3.p6.3.m3.1.1.1.1.1.3">𝐿</ci><ci id="S3.p6.3.m3.1.1.1.1.1.4.cmml" xref="S3.p6.3.m3.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.3.m3.1c">x_{[CLS]}</annotation></semantics></math> and the <span id="S3.p6.7.3" class="ltx_text ltx_font_italic">visual attention stream</span>, via Hadamard multiplication and then passing them through a softmax classifier <math id="S3.p6.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.p6.4.m4.1a"><mi id="S3.p6.4.m4.1.1" xref="S3.p6.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.p6.4.m4.1b"><ci id="S3.p6.4.m4.1.1.cmml" xref="S3.p6.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.4.m4.1c">s</annotation></semantics></math>, thus <math id="S3.p6.5.m5.2" class="ltx_Math" alttext="y^{q}=s(x_{[CLS]}\odot V_{q})" display="inline"><semantics id="S3.p6.5.m5.2a"><mrow id="S3.p6.5.m5.2.2" xref="S3.p6.5.m5.2.2.cmml"><msup id="S3.p6.5.m5.2.2.3" xref="S3.p6.5.m5.2.2.3.cmml"><mi id="S3.p6.5.m5.2.2.3.2" xref="S3.p6.5.m5.2.2.3.2.cmml">y</mi><mi id="S3.p6.5.m5.2.2.3.3" xref="S3.p6.5.m5.2.2.3.3.cmml">q</mi></msup><mo id="S3.p6.5.m5.2.2.2" xref="S3.p6.5.m5.2.2.2.cmml">=</mo><mrow id="S3.p6.5.m5.2.2.1" xref="S3.p6.5.m5.2.2.1.cmml"><mi id="S3.p6.5.m5.2.2.1.3" xref="S3.p6.5.m5.2.2.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p6.5.m5.2.2.1.2" xref="S3.p6.5.m5.2.2.1.2.cmml">​</mo><mrow id="S3.p6.5.m5.2.2.1.1.1" xref="S3.p6.5.m5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.p6.5.m5.2.2.1.1.1.2" xref="S3.p6.5.m5.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.p6.5.m5.2.2.1.1.1.1" xref="S3.p6.5.m5.2.2.1.1.1.1.cmml"><msub id="S3.p6.5.m5.2.2.1.1.1.1.2" xref="S3.p6.5.m5.2.2.1.1.1.1.2.cmml"><mi id="S3.p6.5.m5.2.2.1.1.1.1.2.2" xref="S3.p6.5.m5.2.2.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.p6.5.m5.1.1.1.1" xref="S3.p6.5.m5.1.1.1.2.cmml"><mo stretchy="false" id="S3.p6.5.m5.1.1.1.1.2" xref="S3.p6.5.m5.1.1.1.2.1.cmml">[</mo><mrow id="S3.p6.5.m5.1.1.1.1.1" xref="S3.p6.5.m5.1.1.1.1.1.cmml"><mi id="S3.p6.5.m5.1.1.1.1.1.2" xref="S3.p6.5.m5.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.p6.5.m5.1.1.1.1.1.1" xref="S3.p6.5.m5.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p6.5.m5.1.1.1.1.1.3" xref="S3.p6.5.m5.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.p6.5.m5.1.1.1.1.1.1a" xref="S3.p6.5.m5.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p6.5.m5.1.1.1.1.1.4" xref="S3.p6.5.m5.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="S3.p6.5.m5.1.1.1.1.3" xref="S3.p6.5.m5.1.1.1.2.1.cmml">]</mo></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.p6.5.m5.2.2.1.1.1.1.1" xref="S3.p6.5.m5.2.2.1.1.1.1.1.cmml">⊙</mo><msub id="S3.p6.5.m5.2.2.1.1.1.1.3" xref="S3.p6.5.m5.2.2.1.1.1.1.3.cmml"><mi id="S3.p6.5.m5.2.2.1.1.1.1.3.2" xref="S3.p6.5.m5.2.2.1.1.1.1.3.2.cmml">V</mi><mi id="S3.p6.5.m5.2.2.1.1.1.1.3.3" xref="S3.p6.5.m5.2.2.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo stretchy="false" id="S3.p6.5.m5.2.2.1.1.1.3" xref="S3.p6.5.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.5.m5.2b"><apply id="S3.p6.5.m5.2.2.cmml" xref="S3.p6.5.m5.2.2"><eq id="S3.p6.5.m5.2.2.2.cmml" xref="S3.p6.5.m5.2.2.2"></eq><apply id="S3.p6.5.m5.2.2.3.cmml" xref="S3.p6.5.m5.2.2.3"><csymbol cd="ambiguous" id="S3.p6.5.m5.2.2.3.1.cmml" xref="S3.p6.5.m5.2.2.3">superscript</csymbol><ci id="S3.p6.5.m5.2.2.3.2.cmml" xref="S3.p6.5.m5.2.2.3.2">𝑦</ci><ci id="S3.p6.5.m5.2.2.3.3.cmml" xref="S3.p6.5.m5.2.2.3.3">𝑞</ci></apply><apply id="S3.p6.5.m5.2.2.1.cmml" xref="S3.p6.5.m5.2.2.1"><times id="S3.p6.5.m5.2.2.1.2.cmml" xref="S3.p6.5.m5.2.2.1.2"></times><ci id="S3.p6.5.m5.2.2.1.3.cmml" xref="S3.p6.5.m5.2.2.1.3">𝑠</ci><apply id="S3.p6.5.m5.2.2.1.1.1.1.cmml" xref="S3.p6.5.m5.2.2.1.1.1"><csymbol cd="latexml" id="S3.p6.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.p6.5.m5.2.2.1.1.1.1.1">direct-product</csymbol><apply id="S3.p6.5.m5.2.2.1.1.1.1.2.cmml" xref="S3.p6.5.m5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p6.5.m5.2.2.1.1.1.1.2.1.cmml" xref="S3.p6.5.m5.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.p6.5.m5.2.2.1.1.1.1.2.2.cmml" xref="S3.p6.5.m5.2.2.1.1.1.1.2.2">𝑥</ci><apply id="S3.p6.5.m5.1.1.1.2.cmml" xref="S3.p6.5.m5.1.1.1.1"><csymbol cd="latexml" id="S3.p6.5.m5.1.1.1.2.1.cmml" xref="S3.p6.5.m5.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.p6.5.m5.1.1.1.1.1.cmml" xref="S3.p6.5.m5.1.1.1.1.1"><times id="S3.p6.5.m5.1.1.1.1.1.1.cmml" xref="S3.p6.5.m5.1.1.1.1.1.1"></times><ci id="S3.p6.5.m5.1.1.1.1.1.2.cmml" xref="S3.p6.5.m5.1.1.1.1.1.2">𝐶</ci><ci id="S3.p6.5.m5.1.1.1.1.1.3.cmml" xref="S3.p6.5.m5.1.1.1.1.1.3">𝐿</ci><ci id="S3.p6.5.m5.1.1.1.1.1.4.cmml" xref="S3.p6.5.m5.1.1.1.1.1.4">𝑆</ci></apply></apply></apply><apply id="S3.p6.5.m5.2.2.1.1.1.1.3.cmml" xref="S3.p6.5.m5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p6.5.m5.2.2.1.1.1.1.3.1.cmml" xref="S3.p6.5.m5.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.p6.5.m5.2.2.1.1.1.1.3.2.cmml" xref="S3.p6.5.m5.2.2.1.1.1.1.3.2">𝑉</ci><ci id="S3.p6.5.m5.2.2.1.1.1.1.3.3.cmml" xref="S3.p6.5.m5.2.2.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.5.m5.2c">y^{q}=s(x_{[CLS]}\odot V_{q})</annotation></semantics></math> and <math id="S3.p6.6.m6.2" class="ltx_Math" alttext="y^{r}=s(x_{[CLS]}\odot V_{r})" display="inline"><semantics id="S3.p6.6.m6.2a"><mrow id="S3.p6.6.m6.2.2" xref="S3.p6.6.m6.2.2.cmml"><msup id="S3.p6.6.m6.2.2.3" xref="S3.p6.6.m6.2.2.3.cmml"><mi id="S3.p6.6.m6.2.2.3.2" xref="S3.p6.6.m6.2.2.3.2.cmml">y</mi><mi id="S3.p6.6.m6.2.2.3.3" xref="S3.p6.6.m6.2.2.3.3.cmml">r</mi></msup><mo id="S3.p6.6.m6.2.2.2" xref="S3.p6.6.m6.2.2.2.cmml">=</mo><mrow id="S3.p6.6.m6.2.2.1" xref="S3.p6.6.m6.2.2.1.cmml"><mi id="S3.p6.6.m6.2.2.1.3" xref="S3.p6.6.m6.2.2.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p6.6.m6.2.2.1.2" xref="S3.p6.6.m6.2.2.1.2.cmml">​</mo><mrow id="S3.p6.6.m6.2.2.1.1.1" xref="S3.p6.6.m6.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.p6.6.m6.2.2.1.1.1.2" xref="S3.p6.6.m6.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.p6.6.m6.2.2.1.1.1.1" xref="S3.p6.6.m6.2.2.1.1.1.1.cmml"><msub id="S3.p6.6.m6.2.2.1.1.1.1.2" xref="S3.p6.6.m6.2.2.1.1.1.1.2.cmml"><mi id="S3.p6.6.m6.2.2.1.1.1.1.2.2" xref="S3.p6.6.m6.2.2.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.p6.6.m6.1.1.1.1" xref="S3.p6.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S3.p6.6.m6.1.1.1.1.2" xref="S3.p6.6.m6.1.1.1.2.1.cmml">[</mo><mrow id="S3.p6.6.m6.1.1.1.1.1" xref="S3.p6.6.m6.1.1.1.1.1.cmml"><mi id="S3.p6.6.m6.1.1.1.1.1.2" xref="S3.p6.6.m6.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.p6.6.m6.1.1.1.1.1.1" xref="S3.p6.6.m6.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p6.6.m6.1.1.1.1.1.3" xref="S3.p6.6.m6.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.p6.6.m6.1.1.1.1.1.1a" xref="S3.p6.6.m6.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p6.6.m6.1.1.1.1.1.4" xref="S3.p6.6.m6.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="S3.p6.6.m6.1.1.1.1.3" xref="S3.p6.6.m6.1.1.1.2.1.cmml">]</mo></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.p6.6.m6.2.2.1.1.1.1.1" xref="S3.p6.6.m6.2.2.1.1.1.1.1.cmml">⊙</mo><msub id="S3.p6.6.m6.2.2.1.1.1.1.3" xref="S3.p6.6.m6.2.2.1.1.1.1.3.cmml"><mi id="S3.p6.6.m6.2.2.1.1.1.1.3.2" xref="S3.p6.6.m6.2.2.1.1.1.1.3.2.cmml">V</mi><mi id="S3.p6.6.m6.2.2.1.1.1.1.3.3" xref="S3.p6.6.m6.2.2.1.1.1.1.3.3.cmml">r</mi></msub></mrow><mo stretchy="false" id="S3.p6.6.m6.2.2.1.1.1.3" xref="S3.p6.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.6.m6.2b"><apply id="S3.p6.6.m6.2.2.cmml" xref="S3.p6.6.m6.2.2"><eq id="S3.p6.6.m6.2.2.2.cmml" xref="S3.p6.6.m6.2.2.2"></eq><apply id="S3.p6.6.m6.2.2.3.cmml" xref="S3.p6.6.m6.2.2.3"><csymbol cd="ambiguous" id="S3.p6.6.m6.2.2.3.1.cmml" xref="S3.p6.6.m6.2.2.3">superscript</csymbol><ci id="S3.p6.6.m6.2.2.3.2.cmml" xref="S3.p6.6.m6.2.2.3.2">𝑦</ci><ci id="S3.p6.6.m6.2.2.3.3.cmml" xref="S3.p6.6.m6.2.2.3.3">𝑟</ci></apply><apply id="S3.p6.6.m6.2.2.1.cmml" xref="S3.p6.6.m6.2.2.1"><times id="S3.p6.6.m6.2.2.1.2.cmml" xref="S3.p6.6.m6.2.2.1.2"></times><ci id="S3.p6.6.m6.2.2.1.3.cmml" xref="S3.p6.6.m6.2.2.1.3">𝑠</ci><apply id="S3.p6.6.m6.2.2.1.1.1.1.cmml" xref="S3.p6.6.m6.2.2.1.1.1"><csymbol cd="latexml" id="S3.p6.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.p6.6.m6.2.2.1.1.1.1.1">direct-product</csymbol><apply id="S3.p6.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.p6.6.m6.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p6.6.m6.2.2.1.1.1.1.2.1.cmml" xref="S3.p6.6.m6.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.p6.6.m6.2.2.1.1.1.1.2.2.cmml" xref="S3.p6.6.m6.2.2.1.1.1.1.2.2">𝑥</ci><apply id="S3.p6.6.m6.1.1.1.2.cmml" xref="S3.p6.6.m6.1.1.1.1"><csymbol cd="latexml" id="S3.p6.6.m6.1.1.1.2.1.cmml" xref="S3.p6.6.m6.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.p6.6.m6.1.1.1.1.1.cmml" xref="S3.p6.6.m6.1.1.1.1.1"><times id="S3.p6.6.m6.1.1.1.1.1.1.cmml" xref="S3.p6.6.m6.1.1.1.1.1.1"></times><ci id="S3.p6.6.m6.1.1.1.1.1.2.cmml" xref="S3.p6.6.m6.1.1.1.1.1.2">𝐶</ci><ci id="S3.p6.6.m6.1.1.1.1.1.3.cmml" xref="S3.p6.6.m6.1.1.1.1.1.3">𝐿</ci><ci id="S3.p6.6.m6.1.1.1.1.1.4.cmml" xref="S3.p6.6.m6.1.1.1.1.1.4">𝑆</ci></apply></apply></apply><apply id="S3.p6.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.p6.6.m6.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p6.6.m6.2.2.1.1.1.1.3.1.cmml" xref="S3.p6.6.m6.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.p6.6.m6.2.2.1.1.1.1.3.2.cmml" xref="S3.p6.6.m6.2.2.1.1.1.1.3.2">𝑉</ci><ci id="S3.p6.6.m6.2.2.1.1.1.1.3.3.cmml" xref="S3.p6.6.m6.2.2.1.1.1.1.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.6.m6.2c">y^{r}=s(x_{[CLS]}\odot V_{r})</annotation></semantics></math>. At test time, <math id="S3.p6.7.m7.1" class="ltx_Math" alttext="y^{q}" display="inline"><semantics id="S3.p6.7.m7.1a"><msup id="S3.p6.7.m7.1.1" xref="S3.p6.7.m7.1.1.cmml"><mi id="S3.p6.7.m7.1.1.2" xref="S3.p6.7.m7.1.1.2.cmml">y</mi><mi id="S3.p6.7.m7.1.1.3" xref="S3.p6.7.m7.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p6.7.m7.1b"><apply id="S3.p6.7.m7.1.1.cmml" xref="S3.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p6.7.m7.1.1.1.cmml" xref="S3.p6.7.m7.1.1">superscript</csymbol><ci id="S3.p6.7.m7.1.1.2.cmml" xref="S3.p6.7.m7.1.1.2">𝑦</ci><ci id="S3.p6.7.m7.1.1.3.cmml" xref="S3.p6.7.m7.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.7.m7.1c">y^{q}</annotation></semantics></math> is used to provide predictions over possible answers. 
<br class="ltx_break"></p>
</div>
<div id="S3.p7" class="ltx_para ltx_noindent">
<p id="S3.p7.3" class="ltx_p"><span id="S3.p7.3.1" class="ltx_text ltx_font_bold">Training.</span>
Our training pipeline consists of 2 stages. In the first stage, we train with two cross-entropy loss terms <math id="S3.p7.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{q}" display="inline"><semantics id="S3.p7.1.m1.1a"><msub id="S3.p7.1.m1.1.1" xref="S3.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p7.1.m1.1.1.2" xref="S3.p7.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.p7.1.m1.1.1.3" xref="S3.p7.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p7.1.m1.1b"><apply id="S3.p7.1.m1.1.1.cmml" xref="S3.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p7.1.m1.1.1.1.cmml" xref="S3.p7.1.m1.1.1">subscript</csymbol><ci id="S3.p7.1.m1.1.1.2.cmml" xref="S3.p7.1.m1.1.1.2">ℒ</ci><ci id="S3.p7.1.m1.1.1.3.cmml" xref="S3.p7.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.1.m1.1c">\mathcal{L}_{q}</annotation></semantics></math> and <math id="S3.p7.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{r}" display="inline"><semantics id="S3.p7.2.m2.1a"><msub id="S3.p7.2.m2.1.1" xref="S3.p7.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p7.2.m2.1.1.2" xref="S3.p7.2.m2.1.1.2.cmml">ℒ</mi><mi id="S3.p7.2.m2.1.1.3" xref="S3.p7.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p7.2.m2.1b"><apply id="S3.p7.2.m2.1.1.cmml" xref="S3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p7.2.m2.1.1.1.cmml" xref="S3.p7.2.m2.1.1">subscript</csymbol><ci id="S3.p7.2.m2.1.1.2.cmml" xref="S3.p7.2.m2.1.1.2">ℒ</ci><ci id="S3.p7.2.m2.1.1.3.cmml" xref="S3.p7.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.2.m2.1c">\mathcal{L}_{r}</annotation></semantics></math> w.r.t the ground truth answer <math id="S3.p7.3.m3.1" class="ltx_Math" alttext="[a_{i}]" display="inline"><semantics id="S3.p7.3.m3.1a"><mrow id="S3.p7.3.m3.1.1.1" xref="S3.p7.3.m3.1.1.2.cmml"><mo stretchy="false" id="S3.p7.3.m3.1.1.1.2" xref="S3.p7.3.m3.1.1.2.1.cmml">[</mo><msub id="S3.p7.3.m3.1.1.1.1" xref="S3.p7.3.m3.1.1.1.1.cmml"><mi id="S3.p7.3.m3.1.1.1.1.2" xref="S3.p7.3.m3.1.1.1.1.2.cmml">a</mi><mi id="S3.p7.3.m3.1.1.1.1.3" xref="S3.p7.3.m3.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p7.3.m3.1.1.1.3" xref="S3.p7.3.m3.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.3.m3.1b"><apply id="S3.p7.3.m3.1.1.2.cmml" xref="S3.p7.3.m3.1.1.1"><csymbol cd="latexml" id="S3.p7.3.m3.1.1.2.1.cmml" xref="S3.p7.3.m3.1.1.1.2">delimited-[]</csymbol><apply id="S3.p7.3.m3.1.1.1.1.cmml" xref="S3.p7.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.p7.3.m3.1.1.1.1.1.cmml" xref="S3.p7.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.p7.3.m3.1.1.1.1.2.cmml" xref="S3.p7.3.m3.1.1.1.1.2">𝑎</ci><ci id="S3.p7.3.m3.1.1.1.1.3.cmml" xref="S3.p7.3.m3.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.3.m3.1c">[a_{i}]</annotation></semantics></math>, or</p>
</div>
<div id="S3.p8" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.6" class="ltx_Math" alttext="\mathcal{L}_{stage_{1}}=-\frac{1}{N}\sum_{i}^{N}\log(y_{i}^{q})[a_{i}]-\frac{1}{N}\sum_{i}^{N}\log(y_{i}^{r})[a_{i}]" display="block"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml"><msub id="S3.E2.m1.6.6.6" xref="S3.E2.m1.6.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.6.2" xref="S3.E2.m1.6.6.6.2.cmml">ℒ</mi><mrow id="S3.E2.m1.6.6.6.3" xref="S3.E2.m1.6.6.6.3.cmml"><mi id="S3.E2.m1.6.6.6.3.2" xref="S3.E2.m1.6.6.6.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.3.1" xref="S3.E2.m1.6.6.6.3.1.cmml">​</mo><mi id="S3.E2.m1.6.6.6.3.3" xref="S3.E2.m1.6.6.6.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.3.1a" xref="S3.E2.m1.6.6.6.3.1.cmml">​</mo><mi id="S3.E2.m1.6.6.6.3.4" xref="S3.E2.m1.6.6.6.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.3.1b" xref="S3.E2.m1.6.6.6.3.1.cmml">​</mo><mi id="S3.E2.m1.6.6.6.3.5" xref="S3.E2.m1.6.6.6.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.3.1c" xref="S3.E2.m1.6.6.6.3.1.cmml">​</mo><msub id="S3.E2.m1.6.6.6.3.6" xref="S3.E2.m1.6.6.6.3.6.cmml"><mi id="S3.E2.m1.6.6.6.3.6.2" xref="S3.E2.m1.6.6.6.3.6.2.cmml">e</mi><mn id="S3.E2.m1.6.6.6.3.6.3" xref="S3.E2.m1.6.6.6.3.6.3.cmml">1</mn></msub></mrow></msub><mo id="S3.E2.m1.6.6.5" xref="S3.E2.m1.6.6.5.cmml">=</mo><mrow id="S3.E2.m1.6.6.4" xref="S3.E2.m1.6.6.4.cmml"><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml"><mo id="S3.E2.m1.4.4.2.2a" xref="S3.E2.m1.4.4.2.2.cmml">−</mo><mrow id="S3.E2.m1.4.4.2.2.2" xref="S3.E2.m1.4.4.2.2.2.cmml"><mfrac id="S3.E2.m1.4.4.2.2.2.4" xref="S3.E2.m1.4.4.2.2.2.4.cmml"><mn id="S3.E2.m1.4.4.2.2.2.4.2" xref="S3.E2.m1.4.4.2.2.2.4.2.cmml">1</mn><mi id="S3.E2.m1.4.4.2.2.2.4.3" xref="S3.E2.m1.4.4.2.2.2.4.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.cmml"><munderover id="S3.E2.m1.4.4.2.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E2.m1.4.4.2.2.2.2.3.2.2" xref="S3.E2.m1.4.4.2.2.2.2.3.2.2.cmml">∑</mo><mi id="S3.E2.m1.4.4.2.2.2.2.3.2.3" xref="S3.E2.m1.4.4.2.2.2.2.3.2.3.cmml">i</mi><mi id="S3.E2.m1.4.4.2.2.2.2.3.3" xref="S3.E2.m1.4.4.2.2.2.2.3.3.cmml">N</mi></munderover><mrow id="S3.E2.m1.4.4.2.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.2.cmml"><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">log</mi><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.1a" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">q</mi></msubsup><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.2.2.2.2.2.2.1" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.2.2.2.2.2.2.1.2" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.1.cmml">[</mo><msub id="S3.E2.m1.4.4.2.2.2.2.2.2.1.1" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.2" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.2.cmml">a</mi><mi id="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.3" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.4.4.2.2.2.2.2.2.1.3" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.6.6.4.5" xref="S3.E2.m1.6.6.4.5.cmml">−</mo><mrow id="S3.E2.m1.6.6.4.4" xref="S3.E2.m1.6.6.4.4.cmml"><mfrac id="S3.E2.m1.6.6.4.4.4" xref="S3.E2.m1.6.6.4.4.4.cmml"><mn id="S3.E2.m1.6.6.4.4.4.2" xref="S3.E2.m1.6.6.4.4.4.2.cmml">1</mn><mi id="S3.E2.m1.6.6.4.4.4.3" xref="S3.E2.m1.6.6.4.4.4.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.4.4.3" xref="S3.E2.m1.6.6.4.4.3.cmml">​</mo><mrow id="S3.E2.m1.6.6.4.4.2" xref="S3.E2.m1.6.6.4.4.2.cmml"><munderover id="S3.E2.m1.6.6.4.4.2.3" xref="S3.E2.m1.6.6.4.4.2.3.cmml"><mo movablelimits="false" id="S3.E2.m1.6.6.4.4.2.3.2.2" xref="S3.E2.m1.6.6.4.4.2.3.2.2.cmml">∑</mo><mi id="S3.E2.m1.6.6.4.4.2.3.2.3" xref="S3.E2.m1.6.6.4.4.2.3.2.3.cmml">i</mi><mi id="S3.E2.m1.6.6.4.4.2.3.3" xref="S3.E2.m1.6.6.4.4.2.3.3.cmml">N</mi></munderover><mrow id="S3.E2.m1.6.6.4.4.2.2" xref="S3.E2.m1.6.6.4.4.2.2.cmml"><mrow id="S3.E2.m1.5.5.3.3.1.1.1.1" xref="S3.E2.m1.5.5.3.3.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">log</mi><mo id="S3.E2.m1.5.5.3.3.1.1.1.1a" xref="S3.E2.m1.5.5.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.3.3.1.1.1.1.1" xref="S3.E2.m1.5.5.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.3.3.1.1.1.1.1.2" xref="S3.E2.m1.5.5.3.3.1.1.1.2.cmml">(</mo><msubsup id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.3" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo stretchy="false" id="S3.E2.m1.5.5.3.3.1.1.1.1.1.3" xref="S3.E2.m1.5.5.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.4.4.2.2.3" xref="S3.E2.m1.6.6.4.4.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.6.6.4.4.2.2.2.1" xref="S3.E2.m1.6.6.4.4.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.4.4.2.2.2.1.2" xref="S3.E2.m1.6.6.4.4.2.2.2.2.1.cmml">[</mo><msub id="S3.E2.m1.6.6.4.4.2.2.2.1.1" xref="S3.E2.m1.6.6.4.4.2.2.2.1.1.cmml"><mi id="S3.E2.m1.6.6.4.4.2.2.2.1.1.2" xref="S3.E2.m1.6.6.4.4.2.2.2.1.1.2.cmml">a</mi><mi id="S3.E2.m1.6.6.4.4.2.2.2.1.1.3" xref="S3.E2.m1.6.6.4.4.2.2.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.6.6.4.4.2.2.2.1.3" xref="S3.E2.m1.6.6.4.4.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><eq id="S3.E2.m1.6.6.5.cmml" xref="S3.E2.m1.6.6.5"></eq><apply id="S3.E2.m1.6.6.6.cmml" xref="S3.E2.m1.6.6.6"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.1.cmml" xref="S3.E2.m1.6.6.6">subscript</csymbol><ci id="S3.E2.m1.6.6.6.2.cmml" xref="S3.E2.m1.6.6.6.2">ℒ</ci><apply id="S3.E2.m1.6.6.6.3.cmml" xref="S3.E2.m1.6.6.6.3"><times id="S3.E2.m1.6.6.6.3.1.cmml" xref="S3.E2.m1.6.6.6.3.1"></times><ci id="S3.E2.m1.6.6.6.3.2.cmml" xref="S3.E2.m1.6.6.6.3.2">𝑠</ci><ci id="S3.E2.m1.6.6.6.3.3.cmml" xref="S3.E2.m1.6.6.6.3.3">𝑡</ci><ci id="S3.E2.m1.6.6.6.3.4.cmml" xref="S3.E2.m1.6.6.6.3.4">𝑎</ci><ci id="S3.E2.m1.6.6.6.3.5.cmml" xref="S3.E2.m1.6.6.6.3.5">𝑔</ci><apply id="S3.E2.m1.6.6.6.3.6.cmml" xref="S3.E2.m1.6.6.6.3.6"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.6.1.cmml" xref="S3.E2.m1.6.6.6.3.6">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.6.2.cmml" xref="S3.E2.m1.6.6.6.3.6.2">𝑒</ci><cn type="integer" id="S3.E2.m1.6.6.6.3.6.3.cmml" xref="S3.E2.m1.6.6.6.3.6.3">1</cn></apply></apply></apply><apply id="S3.E2.m1.6.6.4.cmml" xref="S3.E2.m1.6.6.4"><minus id="S3.E2.m1.6.6.4.5.cmml" xref="S3.E2.m1.6.6.4.5"></minus><apply id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2"><minus id="S3.E2.m1.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2"></minus><apply id="S3.E2.m1.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2"><times id="S3.E2.m1.4.4.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.3"></times><apply id="S3.E2.m1.4.4.2.2.2.4.cmml" xref="S3.E2.m1.4.4.2.2.2.4"><divide id="S3.E2.m1.4.4.2.2.2.4.1.cmml" xref="S3.E2.m1.4.4.2.2.2.4"></divide><cn type="integer" id="S3.E2.m1.4.4.2.2.2.4.2.cmml" xref="S3.E2.m1.4.4.2.2.2.4.2">1</cn><ci id="S3.E2.m1.4.4.2.2.2.4.3.cmml" xref="S3.E2.m1.4.4.2.2.2.4.3">𝑁</ci></apply><apply id="S3.E2.m1.4.4.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2"><apply id="S3.E2.m1.4.4.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.3.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.3">superscript</csymbol><apply id="S3.E2.m1.4.4.2.2.2.2.3.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.3.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.3">subscript</csymbol><sum id="S3.E2.m1.4.4.2.2.2.2.3.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.3.2.2"></sum><ci id="S3.E2.m1.4.4.2.2.2.2.3.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.4.4.2.2.2.2.3.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.3.3">𝑁</ci></apply><apply id="S3.E2.m1.4.4.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2"><times id="S3.E2.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.3"></times><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1"><log id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"></log><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply><apply id="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.4.4.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.2">𝑎</ci><ci id="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.6.6.4.4.cmml" xref="S3.E2.m1.6.6.4.4"><times id="S3.E2.m1.6.6.4.4.3.cmml" xref="S3.E2.m1.6.6.4.4.3"></times><apply id="S3.E2.m1.6.6.4.4.4.cmml" xref="S3.E2.m1.6.6.4.4.4"><divide id="S3.E2.m1.6.6.4.4.4.1.cmml" xref="S3.E2.m1.6.6.4.4.4"></divide><cn type="integer" id="S3.E2.m1.6.6.4.4.4.2.cmml" xref="S3.E2.m1.6.6.4.4.4.2">1</cn><ci id="S3.E2.m1.6.6.4.4.4.3.cmml" xref="S3.E2.m1.6.6.4.4.4.3">𝑁</ci></apply><apply id="S3.E2.m1.6.6.4.4.2.cmml" xref="S3.E2.m1.6.6.4.4.2"><apply id="S3.E2.m1.6.6.4.4.2.3.cmml" xref="S3.E2.m1.6.6.4.4.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.4.4.2.3.1.cmml" xref="S3.E2.m1.6.6.4.4.2.3">superscript</csymbol><apply id="S3.E2.m1.6.6.4.4.2.3.2.cmml" xref="S3.E2.m1.6.6.4.4.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.4.4.2.3.2.1.cmml" xref="S3.E2.m1.6.6.4.4.2.3">subscript</csymbol><sum id="S3.E2.m1.6.6.4.4.2.3.2.2.cmml" xref="S3.E2.m1.6.6.4.4.2.3.2.2"></sum><ci id="S3.E2.m1.6.6.4.4.2.3.2.3.cmml" xref="S3.E2.m1.6.6.4.4.2.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.6.6.4.4.2.3.3.cmml" xref="S3.E2.m1.6.6.4.4.2.3.3">𝑁</ci></apply><apply id="S3.E2.m1.6.6.4.4.2.2.cmml" xref="S3.E2.m1.6.6.4.4.2.2"><times id="S3.E2.m1.6.6.4.4.2.2.3.cmml" xref="S3.E2.m1.6.6.4.4.2.2.3"></times><apply id="S3.E2.m1.5.5.3.3.1.1.1.2.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1"><log id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"></log><apply id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S3.E2.m1.6.6.4.4.2.2.2.2.cmml" xref="S3.E2.m1.6.6.4.4.2.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.4.4.2.2.2.2.1.cmml" xref="S3.E2.m1.6.6.4.4.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.6.6.4.4.2.2.2.1.1.cmml" xref="S3.E2.m1.6.6.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.4.4.2.2.2.1.1.1.cmml" xref="S3.E2.m1.6.6.4.4.2.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.4.4.2.2.2.1.1.2.cmml" xref="S3.E2.m1.6.6.4.4.2.2.2.1.1.2">𝑎</ci><ci id="S3.E2.m1.6.6.4.4.2.2.2.1.1.3.cmml" xref="S3.E2.m1.6.6.4.4.2.2.2.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">\mathcal{L}_{stage_{1}}=-\frac{1}{N}\sum_{i}^{N}\log(y_{i}^{q})[a_{i}]-\frac{1}{N}\sum_{i}^{N}\log(y_{i}^{r})[a_{i}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p9" class="ltx_para">
<p id="S3.p9.7" class="ltx_p">In the second stage, we distill knowledge from the reasoning decoder by aligning the attention distributions conditioned on the question <math id="S3.p9.1.m1.1" class="ltx_Math" alttext="\alpha^{Q}" display="inline"><semantics id="S3.p9.1.m1.1a"><msup id="S3.p9.1.m1.1.1" xref="S3.p9.1.m1.1.1.cmml"><mi id="S3.p9.1.m1.1.1.2" xref="S3.p9.1.m1.1.1.2.cmml">α</mi><mi id="S3.p9.1.m1.1.1.3" xref="S3.p9.1.m1.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p9.1.m1.1b"><apply id="S3.p9.1.m1.1.1.cmml" xref="S3.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p9.1.m1.1.1.1.cmml" xref="S3.p9.1.m1.1.1">superscript</csymbol><ci id="S3.p9.1.m1.1.1.2.cmml" xref="S3.p9.1.m1.1.1.2">𝛼</ci><ci id="S3.p9.1.m1.1.1.3.cmml" xref="S3.p9.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.1.m1.1c">\alpha^{Q}</annotation></semantics></math> to the attention distributions conditioned on the correct reasoning <math id="S3.p9.2.m2.1" class="ltx_Math" alttext="\alpha^{R}" display="inline"><semantics id="S3.p9.2.m2.1a"><msup id="S3.p9.2.m2.1.1" xref="S3.p9.2.m2.1.1.cmml"><mi id="S3.p9.2.m2.1.1.2" xref="S3.p9.2.m2.1.1.2.cmml">α</mi><mi id="S3.p9.2.m2.1.1.3" xref="S3.p9.2.m2.1.1.3.cmml">R</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p9.2.m2.1b"><apply id="S3.p9.2.m2.1.1.cmml" xref="S3.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p9.2.m2.1.1.1.cmml" xref="S3.p9.2.m2.1.1">superscript</csymbol><ci id="S3.p9.2.m2.1.1.2.cmml" xref="S3.p9.2.m2.1.1.2">𝛼</ci><ci id="S3.p9.2.m2.1.1.3.cmml" xref="S3.p9.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.2.m2.1c">\alpha^{R}</annotation></semantics></math>. To that end, we freeze the weights of the reasoning attention decoder and only fine-tune the question attention decoder (through <math id="S3.p9.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{q}" display="inline"><semantics id="S3.p9.3.m3.1a"><msub id="S3.p9.3.m3.1.1" xref="S3.p9.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p9.3.m3.1.1.2" xref="S3.p9.3.m3.1.1.2.cmml">ℒ</mi><mi id="S3.p9.3.m3.1.1.3" xref="S3.p9.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p9.3.m3.1b"><apply id="S3.p9.3.m3.1.1.cmml" xref="S3.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p9.3.m3.1.1.1.cmml" xref="S3.p9.3.m3.1.1">subscript</csymbol><ci id="S3.p9.3.m3.1.1.2.cmml" xref="S3.p9.3.m3.1.1.2">ℒ</ci><ci id="S3.p9.3.m3.1.1.3.cmml" xref="S3.p9.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.3.m3.1c">\mathcal{L}_{q}</annotation></semantics></math>) while also utilizing an attention similarity loss, formulated as the forward Kullback-Leibler divergence between attention maps <math id="S3.p9.4.m4.1" class="ltx_Math" alttext="\alpha^{Q}" display="inline"><semantics id="S3.p9.4.m4.1a"><msup id="S3.p9.4.m4.1.1" xref="S3.p9.4.m4.1.1.cmml"><mi id="S3.p9.4.m4.1.1.2" xref="S3.p9.4.m4.1.1.2.cmml">α</mi><mi id="S3.p9.4.m4.1.1.3" xref="S3.p9.4.m4.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p9.4.m4.1b"><apply id="S3.p9.4.m4.1.1.cmml" xref="S3.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p9.4.m4.1.1.1.cmml" xref="S3.p9.4.m4.1.1">superscript</csymbol><ci id="S3.p9.4.m4.1.1.2.cmml" xref="S3.p9.4.m4.1.1.2">𝛼</ci><ci id="S3.p9.4.m4.1.1.3.cmml" xref="S3.p9.4.m4.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.4.m4.1c">\alpha^{Q}</annotation></semantics></math> and <math id="S3.p9.5.m5.1" class="ltx_Math" alttext="\alpha^{R}" display="inline"><semantics id="S3.p9.5.m5.1a"><msup id="S3.p9.5.m5.1.1" xref="S3.p9.5.m5.1.1.cmml"><mi id="S3.p9.5.m5.1.1.2" xref="S3.p9.5.m5.1.1.2.cmml">α</mi><mi id="S3.p9.5.m5.1.1.3" xref="S3.p9.5.m5.1.1.3.cmml">R</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p9.5.m5.1b"><apply id="S3.p9.5.m5.1.1.cmml" xref="S3.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p9.5.m5.1.1.1.cmml" xref="S3.p9.5.m5.1.1">superscript</csymbol><ci id="S3.p9.5.m5.1.1.2.cmml" xref="S3.p9.5.m5.1.1.2">𝛼</ci><ci id="S3.p9.5.m5.1.1.3.cmml" xref="S3.p9.5.m5.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.5.m5.1c">\alpha^{R}</annotation></semantics></math>, or <math id="S3.p9.6.m6.1" class="ltx_math_unparsed" alttext="D_{KL}(\alpha^{Q}||\alpha^{R})" display="inline"><semantics id="S3.p9.6.m6.1a"><mrow id="S3.p9.6.m6.1b"><msub id="S3.p9.6.m6.1.1"><mi id="S3.p9.6.m6.1.1.2">D</mi><mrow id="S3.p9.6.m6.1.1.3"><mi id="S3.p9.6.m6.1.1.3.2">K</mi><mo lspace="0em" rspace="0em" id="S3.p9.6.m6.1.1.3.1">​</mo><mi id="S3.p9.6.m6.1.1.3.3">L</mi></mrow></msub><mrow id="S3.p9.6.m6.1.2"><mo stretchy="false" id="S3.p9.6.m6.1.2.1">(</mo><msup id="S3.p9.6.m6.1.2.2"><mi id="S3.p9.6.m6.1.2.2.2">α</mi><mi id="S3.p9.6.m6.1.2.2.3">Q</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.p9.6.m6.1.2.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.p9.6.m6.1.2.4">|</mo><msup id="S3.p9.6.m6.1.2.5"><mi id="S3.p9.6.m6.1.2.5.2">α</mi><mi id="S3.p9.6.m6.1.2.5.3">R</mi></msup><mo stretchy="false" id="S3.p9.6.m6.1.2.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.p9.6.m6.1c">D_{KL}(\alpha^{Q}||\alpha^{R})</annotation></semantics></math>. The complete <math id="S3.p9.7.m7.1" class="ltx_Math" alttext="\mathcal{L}_{stage_{2}}" display="inline"><semantics id="S3.p9.7.m7.1a"><msub id="S3.p9.7.m7.1.1" xref="S3.p9.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p9.7.m7.1.1.2" xref="S3.p9.7.m7.1.1.2.cmml">ℒ</mi><mrow id="S3.p9.7.m7.1.1.3" xref="S3.p9.7.m7.1.1.3.cmml"><mi id="S3.p9.7.m7.1.1.3.2" xref="S3.p9.7.m7.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p9.7.m7.1.1.3.1" xref="S3.p9.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.p9.7.m7.1.1.3.3" xref="S3.p9.7.m7.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p9.7.m7.1.1.3.1a" xref="S3.p9.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.p9.7.m7.1.1.3.4" xref="S3.p9.7.m7.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p9.7.m7.1.1.3.1b" xref="S3.p9.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.p9.7.m7.1.1.3.5" xref="S3.p9.7.m7.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.p9.7.m7.1.1.3.1c" xref="S3.p9.7.m7.1.1.3.1.cmml">​</mo><msub id="S3.p9.7.m7.1.1.3.6" xref="S3.p9.7.m7.1.1.3.6.cmml"><mi id="S3.p9.7.m7.1.1.3.6.2" xref="S3.p9.7.m7.1.1.3.6.2.cmml">e</mi><mn id="S3.p9.7.m7.1.1.3.6.3" xref="S3.p9.7.m7.1.1.3.6.3.cmml">2</mn></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p9.7.m7.1b"><apply id="S3.p9.7.m7.1.1.cmml" xref="S3.p9.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p9.7.m7.1.1.1.cmml" xref="S3.p9.7.m7.1.1">subscript</csymbol><ci id="S3.p9.7.m7.1.1.2.cmml" xref="S3.p9.7.m7.1.1.2">ℒ</ci><apply id="S3.p9.7.m7.1.1.3.cmml" xref="S3.p9.7.m7.1.1.3"><times id="S3.p9.7.m7.1.1.3.1.cmml" xref="S3.p9.7.m7.1.1.3.1"></times><ci id="S3.p9.7.m7.1.1.3.2.cmml" xref="S3.p9.7.m7.1.1.3.2">𝑠</ci><ci id="S3.p9.7.m7.1.1.3.3.cmml" xref="S3.p9.7.m7.1.1.3.3">𝑡</ci><ci id="S3.p9.7.m7.1.1.3.4.cmml" xref="S3.p9.7.m7.1.1.3.4">𝑎</ci><ci id="S3.p9.7.m7.1.1.3.5.cmml" xref="S3.p9.7.m7.1.1.3.5">𝑔</ci><apply id="S3.p9.7.m7.1.1.3.6.cmml" xref="S3.p9.7.m7.1.1.3.6"><csymbol cd="ambiguous" id="S3.p9.7.m7.1.1.3.6.1.cmml" xref="S3.p9.7.m7.1.1.3.6">subscript</csymbol><ci id="S3.p9.7.m7.1.1.3.6.2.cmml" xref="S3.p9.7.m7.1.1.3.6.2">𝑒</ci><cn type="integer" id="S3.p9.7.m7.1.1.3.6.3.cmml" xref="S3.p9.7.m7.1.1.3.6.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.7.m7.1c">\mathcal{L}_{stage_{2}}</annotation></semantics></math> loss is:</p>
</div>
<div id="S3.p10" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="\mathcal{L}_{stage_{2}}=-\frac{1}{N}\sum_{i}^{N}\log(y_{i}^{q})[a_{i}]+\frac{1}{N}\sum_{i}^{N}\alpha^{Q}_{i}\log(\frac{\alpha^{Q}_{i}}{\alpha^{R}_{i}})" display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><msub id="S3.E3.m1.5.5.4" xref="S3.E3.m1.5.5.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.4.2" xref="S3.E3.m1.5.5.4.2.cmml">ℒ</mi><mrow id="S3.E3.m1.5.5.4.3" xref="S3.E3.m1.5.5.4.3.cmml"><mi id="S3.E3.m1.5.5.4.3.2" xref="S3.E3.m1.5.5.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.4.3.1" xref="S3.E3.m1.5.5.4.3.1.cmml">​</mo><mi id="S3.E3.m1.5.5.4.3.3" xref="S3.E3.m1.5.5.4.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.4.3.1a" xref="S3.E3.m1.5.5.4.3.1.cmml">​</mo><mi id="S3.E3.m1.5.5.4.3.4" xref="S3.E3.m1.5.5.4.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.4.3.1b" xref="S3.E3.m1.5.5.4.3.1.cmml">​</mo><mi id="S3.E3.m1.5.5.4.3.5" xref="S3.E3.m1.5.5.4.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.4.3.1c" xref="S3.E3.m1.5.5.4.3.1.cmml">​</mo><msub id="S3.E3.m1.5.5.4.3.6" xref="S3.E3.m1.5.5.4.3.6.cmml"><mi id="S3.E3.m1.5.5.4.3.6.2" xref="S3.E3.m1.5.5.4.3.6.2.cmml">e</mi><mn id="S3.E3.m1.5.5.4.3.6.3" xref="S3.E3.m1.5.5.4.3.6.3.cmml">2</mn></msub></mrow></msub><mo id="S3.E3.m1.5.5.3" xref="S3.E3.m1.5.5.3.cmml">=</mo><mrow id="S3.E3.m1.5.5.2" xref="S3.E3.m1.5.5.2.cmml"><mrow id="S3.E3.m1.5.5.2.2" xref="S3.E3.m1.5.5.2.2.cmml"><mo id="S3.E3.m1.5.5.2.2a" xref="S3.E3.m1.5.5.2.2.cmml">−</mo><mrow id="S3.E3.m1.5.5.2.2.2" xref="S3.E3.m1.5.5.2.2.2.cmml"><mfrac id="S3.E3.m1.5.5.2.2.2.4" xref="S3.E3.m1.5.5.2.2.2.4.cmml"><mn id="S3.E3.m1.5.5.2.2.2.4.2" xref="S3.E3.m1.5.5.2.2.2.4.2.cmml">1</mn><mi id="S3.E3.m1.5.5.2.2.2.4.3" xref="S3.E3.m1.5.5.2.2.2.4.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.2.2.2.3" xref="S3.E3.m1.5.5.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m1.5.5.2.2.2.2" xref="S3.E3.m1.5.5.2.2.2.2.cmml"><munderover id="S3.E3.m1.5.5.2.2.2.2.3" xref="S3.E3.m1.5.5.2.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E3.m1.5.5.2.2.2.2.3.2.2" xref="S3.E3.m1.5.5.2.2.2.2.3.2.2.cmml">∑</mo><mi id="S3.E3.m1.5.5.2.2.2.2.3.2.3" xref="S3.E3.m1.5.5.2.2.2.2.3.2.3.cmml">i</mi><mi id="S3.E3.m1.5.5.2.2.2.2.3.3" xref="S3.E3.m1.5.5.2.2.2.2.3.3.cmml">N</mi></munderover><mrow id="S3.E3.m1.5.5.2.2.2.2.2" xref="S3.E3.m1.5.5.2.2.2.2.2.cmml"><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">log</mi><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1a" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">q</mi></msubsup><mo stretchy="false" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.2.2.2.2.2.3" xref="S3.E3.m1.5.5.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m1.5.5.2.2.2.2.2.2.1" xref="S3.E3.m1.5.5.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.2.2.2.2.2.2.1.2" xref="S3.E3.m1.5.5.2.2.2.2.2.2.2.1.cmml">[</mo><msub id="S3.E3.m1.5.5.2.2.2.2.2.2.1.1" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.2" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.2.cmml">a</mi><mi id="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.3" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E3.m1.5.5.2.2.2.2.2.2.1.3" xref="S3.E3.m1.5.5.2.2.2.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.2.3" xref="S3.E3.m1.5.5.2.3.cmml">+</mo><mrow id="S3.E3.m1.5.5.2.4" xref="S3.E3.m1.5.5.2.4.cmml"><mfrac id="S3.E3.m1.5.5.2.4.2" xref="S3.E3.m1.5.5.2.4.2.cmml"><mn id="S3.E3.m1.5.5.2.4.2.2" xref="S3.E3.m1.5.5.2.4.2.2.cmml">1</mn><mi id="S3.E3.m1.5.5.2.4.2.3" xref="S3.E3.m1.5.5.2.4.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.2.4.1" xref="S3.E3.m1.5.5.2.4.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.2.4.3" xref="S3.E3.m1.5.5.2.4.3.cmml"><munderover id="S3.E3.m1.5.5.2.4.3.1" xref="S3.E3.m1.5.5.2.4.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.5.5.2.4.3.1.2.2" xref="S3.E3.m1.5.5.2.4.3.1.2.2.cmml">∑</mo><mi id="S3.E3.m1.5.5.2.4.3.1.2.3" xref="S3.E3.m1.5.5.2.4.3.1.2.3.cmml">i</mi><mi id="S3.E3.m1.5.5.2.4.3.1.3" xref="S3.E3.m1.5.5.2.4.3.1.3.cmml">N</mi></munderover><mrow id="S3.E3.m1.5.5.2.4.3.2" xref="S3.E3.m1.5.5.2.4.3.2.cmml"><msubsup id="S3.E3.m1.5.5.2.4.3.2.2" xref="S3.E3.m1.5.5.2.4.3.2.2.cmml"><mi id="S3.E3.m1.5.5.2.4.3.2.2.2.2" xref="S3.E3.m1.5.5.2.4.3.2.2.2.2.cmml">α</mi><mi id="S3.E3.m1.5.5.2.4.3.2.2.3" xref="S3.E3.m1.5.5.2.4.3.2.2.3.cmml">i</mi><mi id="S3.E3.m1.5.5.2.4.3.2.2.2.3" xref="S3.E3.m1.5.5.2.4.3.2.2.2.3.cmml">Q</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.5.5.2.4.3.2.1" xref="S3.E3.m1.5.5.2.4.3.2.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.2.4.3.2.3.2" xref="S3.E3.m1.5.5.2.4.3.2.3.1.cmml"><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">log</mi><mo id="S3.E3.m1.5.5.2.4.3.2.3.2a" xref="S3.E3.m1.5.5.2.4.3.2.3.1.cmml">⁡</mo><mrow id="S3.E3.m1.5.5.2.4.3.2.3.2.1" xref="S3.E3.m1.5.5.2.4.3.2.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.2.4.3.2.3.2.1.1" xref="S3.E3.m1.5.5.2.4.3.2.3.1.cmml">(</mo><mfrac id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><msubsup id="S3.E3.m1.3.3.2" xref="S3.E3.m1.3.3.2.cmml"><mi id="S3.E3.m1.3.3.2.2.2" xref="S3.E3.m1.3.3.2.2.2.cmml">α</mi><mi id="S3.E3.m1.3.3.2.3" xref="S3.E3.m1.3.3.2.3.cmml">i</mi><mi id="S3.E3.m1.3.3.2.2.3" xref="S3.E3.m1.3.3.2.2.3.cmml">Q</mi></msubsup><msubsup id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml"><mi id="S3.E3.m1.3.3.3.2.2" xref="S3.E3.m1.3.3.3.2.2.cmml">α</mi><mi id="S3.E3.m1.3.3.3.3" xref="S3.E3.m1.3.3.3.3.cmml">i</mi><mi id="S3.E3.m1.3.3.3.2.3" xref="S3.E3.m1.3.3.3.2.3.cmml">R</mi></msubsup></mfrac><mo stretchy="false" id="S3.E3.m1.5.5.2.4.3.2.3.2.1.2" xref="S3.E3.m1.5.5.2.4.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.3.cmml" xref="S3.E3.m1.5.5.3"></eq><apply id="S3.E3.m1.5.5.4.cmml" xref="S3.E3.m1.5.5.4"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.cmml" xref="S3.E3.m1.5.5.4">subscript</csymbol><ci id="S3.E3.m1.5.5.4.2.cmml" xref="S3.E3.m1.5.5.4.2">ℒ</ci><apply id="S3.E3.m1.5.5.4.3.cmml" xref="S3.E3.m1.5.5.4.3"><times id="S3.E3.m1.5.5.4.3.1.cmml" xref="S3.E3.m1.5.5.4.3.1"></times><ci id="S3.E3.m1.5.5.4.3.2.cmml" xref="S3.E3.m1.5.5.4.3.2">𝑠</ci><ci id="S3.E3.m1.5.5.4.3.3.cmml" xref="S3.E3.m1.5.5.4.3.3">𝑡</ci><ci id="S3.E3.m1.5.5.4.3.4.cmml" xref="S3.E3.m1.5.5.4.3.4">𝑎</ci><ci id="S3.E3.m1.5.5.4.3.5.cmml" xref="S3.E3.m1.5.5.4.3.5">𝑔</ci><apply id="S3.E3.m1.5.5.4.3.6.cmml" xref="S3.E3.m1.5.5.4.3.6"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.3.6.1.cmml" xref="S3.E3.m1.5.5.4.3.6">subscript</csymbol><ci id="S3.E3.m1.5.5.4.3.6.2.cmml" xref="S3.E3.m1.5.5.4.3.6.2">𝑒</ci><cn type="integer" id="S3.E3.m1.5.5.4.3.6.3.cmml" xref="S3.E3.m1.5.5.4.3.6.3">2</cn></apply></apply></apply><apply id="S3.E3.m1.5.5.2.cmml" xref="S3.E3.m1.5.5.2"><plus id="S3.E3.m1.5.5.2.3.cmml" xref="S3.E3.m1.5.5.2.3"></plus><apply id="S3.E3.m1.5.5.2.2.cmml" xref="S3.E3.m1.5.5.2.2"><minus id="S3.E3.m1.5.5.2.2.3.cmml" xref="S3.E3.m1.5.5.2.2"></minus><apply id="S3.E3.m1.5.5.2.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2"><times id="S3.E3.m1.5.5.2.2.2.3.cmml" xref="S3.E3.m1.5.5.2.2.2.3"></times><apply id="S3.E3.m1.5.5.2.2.2.4.cmml" xref="S3.E3.m1.5.5.2.2.2.4"><divide id="S3.E3.m1.5.5.2.2.2.4.1.cmml" xref="S3.E3.m1.5.5.2.2.2.4"></divide><cn type="integer" id="S3.E3.m1.5.5.2.2.2.4.2.cmml" xref="S3.E3.m1.5.5.2.2.2.4.2">1</cn><ci id="S3.E3.m1.5.5.2.2.2.4.3.cmml" xref="S3.E3.m1.5.5.2.2.2.4.3">𝑁</ci></apply><apply id="S3.E3.m1.5.5.2.2.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2.2"><apply id="S3.E3.m1.5.5.2.2.2.2.3.cmml" xref="S3.E3.m1.5.5.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.2.2.2.3.1.cmml" xref="S3.E3.m1.5.5.2.2.2.2.3">superscript</csymbol><apply id="S3.E3.m1.5.5.2.2.2.2.3.2.cmml" xref="S3.E3.m1.5.5.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.5.5.2.2.2.2.3">subscript</csymbol><sum id="S3.E3.m1.5.5.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2.2.3.2.2"></sum><ci id="S3.E3.m1.5.5.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.5.5.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.5.5.2.2.2.2.3.3.cmml" xref="S3.E3.m1.5.5.2.2.2.2.3.3">𝑁</ci></apply><apply id="S3.E3.m1.5.5.2.2.2.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2"><times id="S3.E3.m1.5.5.2.2.2.2.2.3.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2.3"></times><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1"><log id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"></log><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply><apply id="S3.E3.m1.5.5.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.5.5.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.2">𝑎</ci><ci id="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2.2.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E3.m1.5.5.2.4.cmml" xref="S3.E3.m1.5.5.2.4"><times id="S3.E3.m1.5.5.2.4.1.cmml" xref="S3.E3.m1.5.5.2.4.1"></times><apply id="S3.E3.m1.5.5.2.4.2.cmml" xref="S3.E3.m1.5.5.2.4.2"><divide id="S3.E3.m1.5.5.2.4.2.1.cmml" xref="S3.E3.m1.5.5.2.4.2"></divide><cn type="integer" id="S3.E3.m1.5.5.2.4.2.2.cmml" xref="S3.E3.m1.5.5.2.4.2.2">1</cn><ci id="S3.E3.m1.5.5.2.4.2.3.cmml" xref="S3.E3.m1.5.5.2.4.2.3">𝑁</ci></apply><apply id="S3.E3.m1.5.5.2.4.3.cmml" xref="S3.E3.m1.5.5.2.4.3"><apply id="S3.E3.m1.5.5.2.4.3.1.cmml" xref="S3.E3.m1.5.5.2.4.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.4.3.1.1.cmml" xref="S3.E3.m1.5.5.2.4.3.1">superscript</csymbol><apply id="S3.E3.m1.5.5.2.4.3.1.2.cmml" xref="S3.E3.m1.5.5.2.4.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.4.3.1.2.1.cmml" xref="S3.E3.m1.5.5.2.4.3.1">subscript</csymbol><sum id="S3.E3.m1.5.5.2.4.3.1.2.2.cmml" xref="S3.E3.m1.5.5.2.4.3.1.2.2"></sum><ci id="S3.E3.m1.5.5.2.4.3.1.2.3.cmml" xref="S3.E3.m1.5.5.2.4.3.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.5.5.2.4.3.1.3.cmml" xref="S3.E3.m1.5.5.2.4.3.1.3">𝑁</ci></apply><apply id="S3.E3.m1.5.5.2.4.3.2.cmml" xref="S3.E3.m1.5.5.2.4.3.2"><times id="S3.E3.m1.5.5.2.4.3.2.1.cmml" xref="S3.E3.m1.5.5.2.4.3.2.1"></times><apply id="S3.E3.m1.5.5.2.4.3.2.2.cmml" xref="S3.E3.m1.5.5.2.4.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.4.3.2.2.1.cmml" xref="S3.E3.m1.5.5.2.4.3.2.2">subscript</csymbol><apply id="S3.E3.m1.5.5.2.4.3.2.2.2.cmml" xref="S3.E3.m1.5.5.2.4.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.4.3.2.2.2.1.cmml" xref="S3.E3.m1.5.5.2.4.3.2.2">superscript</csymbol><ci id="S3.E3.m1.5.5.2.4.3.2.2.2.2.cmml" xref="S3.E3.m1.5.5.2.4.3.2.2.2.2">𝛼</ci><ci id="S3.E3.m1.5.5.2.4.3.2.2.2.3.cmml" xref="S3.E3.m1.5.5.2.4.3.2.2.2.3">𝑄</ci></apply><ci id="S3.E3.m1.5.5.2.4.3.2.2.3.cmml" xref="S3.E3.m1.5.5.2.4.3.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.5.5.2.4.3.2.3.1.cmml" xref="S3.E3.m1.5.5.2.4.3.2.3.2"><log id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"></log><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><divide id="S3.E3.m1.3.3.1.cmml" xref="S3.E3.m1.3.3"></divide><apply id="S3.E3.m1.3.3.2.cmml" xref="S3.E3.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.1.cmml" xref="S3.E3.m1.3.3.2">subscript</csymbol><apply id="S3.E3.m1.3.3.2.2.cmml" xref="S3.E3.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.1.cmml" xref="S3.E3.m1.3.3.2">superscript</csymbol><ci id="S3.E3.m1.3.3.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2">𝛼</ci><ci id="S3.E3.m1.3.3.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.3">𝑄</ci></apply><ci id="S3.E3.m1.3.3.2.3.cmml" xref="S3.E3.m1.3.3.2.3">𝑖</ci></apply><apply id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3">subscript</csymbol><apply id="S3.E3.m1.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.2.1.cmml" xref="S3.E3.m1.3.3.3">superscript</csymbol><ci id="S3.E3.m1.3.3.3.2.2.cmml" xref="S3.E3.m1.3.3.3.2.2">𝛼</ci><ci id="S3.E3.m1.3.3.3.2.3.cmml" xref="S3.E3.m1.3.3.3.2.3">𝑅</ci></apply><ci id="S3.E3.m1.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\mathcal{L}_{stage_{2}}=-\frac{1}{N}\sum_{i}^{N}\log(y_{i}^{q})[a_{i}]+\frac{1}{N}\sum_{i}^{N}\alpha^{Q}_{i}\log(\frac{\alpha^{Q}_{i}}{\alpha^{R}_{i}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p11" class="ltx_para">
<p id="S3.p11.1" class="ltx_p">The whole process is illustrated in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 RELATED WORK ‣ INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Our model is trained for 11 epochs for stage 1 and then finetuned for 5 more epochs in stage 2.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>EXPERIMENTS</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_bold">Dataset.</span>
We validate our VQA model on the Visual Commonsense Reasoning dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, which consists of 290k QA problems derived from 110k movie scenes. Four possible answers and four rationales are provided for each question, but we use only the correct rationale/reasoning. Note that reasoning is only used during training as additional supervision. 
<br class="ltx_break"></p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.4" class="ltx_p"><span id="S4.p2.4.1" class="ltx_text ltx_font_bold">Quantitative Evaluation.</span>
Results in terms of model accuracy are reported in Table <a href="#S4.T1" title="Table 1 ‣ 4 EXPERIMENTS ‣ INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Our baseline model (only the question decoder) achieves <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="61.2\%" display="inline"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mn id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">61.2</mn><mo id="S4.p2.1.m1.1.1.1" xref="S4.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">61.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">61.2\%</annotation></semantics></math> accuracy on the validation set. Finetuning by aligning question and reasoning attention distributions yields <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="63.9\%" display="inline"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mn id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">63.9</mn><mo id="S4.p2.2.m2.1.1.1" xref="S4.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">63.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">63.9\%</annotation></semantics></math>, that is a <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="2.7\%" display="inline"><semantics id="S4.p2.3.m3.1a"><mrow id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mn id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">2.7</mn><mo id="S4.p2.3.m3.1.1.1" xref="S4.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">2.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">2.7\%</annotation></semantics></math> absolute improvement, thus demonstrating the benefit of reasoning supervision. We note that our main goal is to propose a novel training strategy for boosting a VQA model’s visual explanatory strength by exploiting reasoning as an alternative supervisory signal. Thus, we do not directly compare to methods such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> that contain a larger number of parameters, leverage large-scale VL and video pretraining or ground-truth object bounding boxes. For comparison, the best performance reported in R2C <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> was <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="63.8\%" display="inline"><semantics id="S4.p2.4.m4.1a"><mrow id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mn id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml">63.8</mn><mo id="S4.p2.4.m4.1.1.1" xref="S4.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1.1">percent</csymbol><cn type="float" id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2">63.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">63.8\%</annotation></semantics></math>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Model</th>
<th id="S4.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Acc(%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.3.1" class="ltx_tr">
<th id="S4.T1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S4.T1.1.3.1.1.1" class="ltx_text ltx_font_italic">Baseline model</span></th>
<td id="S4.T1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">61.2</td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S4.T1.1.1.2.1" class="ltx_text ltx_font_italic">Reasoning Supervision</span></th>
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{63.9}" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">63.9</mn><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><cn type="float" id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">63.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\mathbf{63.9}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.4.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>Accuracy of the baseline and our proposed model finetuned with <span id="S4.T1.5.2" class="ltx_text ltx_font_italic">reasoning supervision</span> on VCR.</figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1" class="ltx_tr">
<th id="S4.T2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt">Model</th>
<th id="S4.T2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Acc(%)</th>
<th id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">(<math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="+" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><plus id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">+</annotation></semantics></math><span id="S4.T2.1.1.1.1" class="ltx_text ltx_font_italic">masking</span>) Acc(%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.2.2" class="ltx_tr">
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.2.2.2.1" class="ltx_text ltx_font_italic">Baseline model</span></td>
<td id="S4.T2.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">61.2</td>
<td id="S4.T2.2.2.1" class="ltx_td ltx_align_center ltx_border_t">59.3 <math id="S4.T2.2.2.1.m1.1" class="ltx_Math" alttext="(-1.9)" display="inline"><semantics id="S4.T2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.1.m1.1.1.1" xref="S4.T2.2.2.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S4.T2.2.2.1.m1.1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T2.2.2.1.m1.1.1.1.1" xref="S4.T2.2.2.1.m1.1.1.1.1.cmml"><mo id="S4.T2.2.2.1.m1.1.1.1.1a" xref="S4.T2.2.2.1.m1.1.1.1.1.cmml">−</mo><mn id="S4.T2.2.2.1.m1.1.1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.1.1.2.cmml">1.9</mn></mrow><mo stretchy="false" id="S4.T2.2.2.1.m1.1.1.1.3" xref="S4.T2.2.2.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><apply id="S4.T2.2.2.1.m1.1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1"><minus id="S4.T2.2.2.1.m1.1.1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1"></minus><cn type="float" id="S4.T2.2.2.1.m1.1.1.1.1.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.2">1.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">(-1.9)</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.3.3" class="ltx_tr">
<td id="S4.T2.3.3.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S4.T2.3.3.2.1" class="ltx_text ltx_font_italic">Reasoning Supervision</span></td>
<td id="S4.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">63.9</td>
<td id="S4.T2.3.3.1" class="ltx_td ltx_align_center ltx_border_bb">61.1 <math id="S4.T2.3.3.1.m1.1" class="ltx_Math" alttext="(-2.8)" display="inline"><semantics id="S4.T2.3.3.1.m1.1a"><mrow id="S4.T2.3.3.1.m1.1.1.1" xref="S4.T2.3.3.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S4.T2.3.3.1.m1.1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.T2.3.3.1.m1.1.1.1.1" xref="S4.T2.3.3.1.m1.1.1.1.1.cmml"><mo id="S4.T2.3.3.1.m1.1.1.1.1a" xref="S4.T2.3.3.1.m1.1.1.1.1.cmml">−</mo><mn id="S4.T2.3.3.1.m1.1.1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.1.1.2.cmml">2.8</mn></mrow><mo stretchy="false" id="S4.T2.3.3.1.m1.1.1.1.3" xref="S4.T2.3.3.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.1b"><apply id="S4.T2.3.3.1.m1.1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1"><minus id="S4.T2.3.3.1.m1.1.1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1"></minus><cn type="float" id="S4.T2.3.3.1.m1.1.1.1.1.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.2">2.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.1c">(-2.8)</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.5.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>Performance drop on the VCR validation set due to object masking.</figcaption>
</figure>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.2" class="ltx_p">To further investigate our model’s ability to leverage the visual modality, we perform an ablation study where we mask the visual features of the objects/people referenced by the question at test time and measure the effect on accuracy. Results are reported in Table <a href="#S4.T2" title="Table 2 ‣ 4 EXPERIMENTS ‣ INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We observe that the baseline VQA model (that does not fully alleviate the lack of visual grounding) suffers a lesser performance degradation of <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="1.9\%" display="inline"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mn id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">1.9</mn><mo id="S4.p3.1.m1.1.1.1" xref="S4.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">1.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">1.9\%</annotation></semantics></math> compared to <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="2.8\%" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mn id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">2.8</mn><mo id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><csymbol cd="latexml" id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">2.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">2.8\%</annotation></semantics></math> for our finetuned model (on reasoning supervision). This is a different manifestation of the fact, that the baseline model is over-reliant on the language modality, thus performance is penalized less when visual information is not available due to object masking. 
<br class="ltx_break"></p>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.1" class="ltx_p"><span id="S4.p4.1.1" class="ltx_text ltx_font_bold">Visual Results.</span>
In Fig. <a href="#S3.F3" title="Figure 3 ‣ 3 METHODOLOGY ‣ INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we visualize attention maps (<math id="S4.p4.1.m1.1" class="ltx_Math" alttext="\alpha^{Q}" display="inline"><semantics id="S4.p4.1.m1.1a"><msup id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mi id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml">α</mi><mi id="S4.p4.1.m1.1.1.3" xref="S4.p4.1.m1.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1">superscript</csymbol><ci id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2">𝛼</ci><ci id="S4.p4.1.m1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\alpha^{Q}</annotation></semantics></math>) for both the baseline model <span id="S4.p4.1.2" class="ltx_text ltx_font_italic">(above)</span> and finetuned model (with reasoning supervision) <span id="S4.p4.1.3" class="ltx_text ltx_font_italic">(below)</span>. The correct reasoning can intuitively provide important guidance during training. For example, for the question <span id="S4.p4.1.4" class="ltx_text ltx_font_smallcaps">(Q: Which person is the lead for this dance group?)</span>, the reasoning <span id="S4.p4.1.5" class="ltx_text ltx_font_smallcaps">(R: [1] is in the middle, which is generally where the main dancer goes)</span>) clearly explains the dynamics of different elements of the scene. This information is distilled to our VQA model through our attention similarity loss. In Fig. <a href="#S3.F3" title="Figure 3 ‣ 3 METHODOLOGY ‣ INTERPRETABLE VISUAL QUESTION ANSWERING VIA REASONING SUPERVISION" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we observe that after fine-tuning, visual attention improves. Our method is able to produce interpretable, human-like attention maps, thus being able to predict the correct answer by perceiving relevant visual concepts.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>CONCLUSION</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work, we alleviate the lack of visual grounding through reasoning supervision. This additional supervision takes the form of textual justifications of the correct answer and it’s already available for VCR datasets. We incorporate a similarity loss that encourages the alignment between the visual attention maps (guided by the question and correct reasoning) thus improving the model’s visual perception capability. We demonstrate qualitatively and quantitatively that reasoning information can lead to interpretable attention maps and performance increase for visual question answering.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Xiujun Li, Xi Yin, Chunyuan Li, Xiaowei Hu, Pengchuan Zhang, Lei Zhang, Lijuan
Wang, Houdong Hu, Li Dong, Furu Wei, Yejin Choi, and Jianfeng Gao,

</span>
<span class="ltx_bibblock">“Oscar: Object-semantics aligned pre-training for vision-language
tasks,”

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">ECCV 2020</span>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Weijie Su, Xizhou Zhu, Yue Cao, Bin Li, Lewei Lu, Furu Wei, and Jifeng Dai,

</span>
<span class="ltx_bibblock">“Vl-bert: Pre-training of generic visual-linguistic
representations,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Yen-Chun Chen, Linjie Li, Licheng Yu, Ahmed El Kholy, Faisal Ahmed, Zhe Gan,
Yu Cheng, and Jingjing Liu,

</span>
<span class="ltx_bibblock">“Uniter: Universal image-text representation learning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Pengchuan Zhang, Xiujun Li, Xiaowei Hu, Jianwei Yang, Lei Zhang, Lijuan Wang,
Yejin Choi, and Jianfeng Gao,

</span>
<span class="ltx_bibblock">“Vinvl: Making visual representations matter in vision-language
models,”

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Hao Tan and Mohit Bansal,

</span>
<span class="ltx_bibblock">“Lxmert: Learning cross-modality encoder representations from
transformers,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing</span>, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Tejas Gokhale, Pratyay Banerjee, Chitta Baral, and Yezhou Yang,

</span>
<span class="ltx_bibblock">“MUTANT: A training paradigm for out-of-distribution
generalization in visual question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2020 Conference on Empirical Methods in
Natural Language Processing (EMNLP)</span>, 2020, pp. 878–892.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Qingyi Si, Yuanxin Liu, Fandong Meng, Zheng Lin, Peng Fu, Yanan Cao, Weiping
Wang, and Jie Zhou,

</span>
<span class="ltx_bibblock">“Towards robust visual question answering: Making the most of biased
samples via contrastive learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">ArXiv</span>, vol. abs/2210.04563, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh,

</span>
<span class="ltx_bibblock">“Making the v in vqa matter: Elevating the role of image
understanding in visual question answering,”

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">IJCV</span>, 2016.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Aishwarya Agrawal, Dhruv Batra, Devi Parikh, and Aniruddha Kembhavi,

</span>
<span class="ltx_bibblock">“Don’t just assume; look and answer: Overcoming priors for visual
question answering,”

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">2018 IEEE/CVF Conference on Computer Vision and Pattern
Recognition</span>, pp. 4971–4980, 2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Keren Ye and Adriana Kovashka,

</span>
<span class="ltx_bibblock">“A case study of the shortcut effects in visual commonsense
reasoning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">AAAI</span>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Vipul Gupta, Zhuowan Li, Adam Kortylewski, Chenyu Zhang, Yingwei Li, and Alan
Yuille,

</span>
<span class="ltx_bibblock">“Swapmix: Diagnosing and regularizing the over-reliance on visual
context in visual question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Ramprasaath R. Selvaraju, Stefan Lee, Yilin Shen, Hongxia Jin, Shalini Ghosh,
Larry Heck, Dhruv Batra, and Devi Parikh,

</span>
<span class="ltx_bibblock">“Taking a hint: Leveraging explanations to make vision and language
models more grounded,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Chongyan Chen, Samreen Anjum, and Danna Gurari,

</span>
<span class="ltx_bibblock">“Grounding answers for visual questions asked by visually impaired
people,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Tingting Qiao, Jianfeng Dong, and Duanqing Xu,

</span>
<span class="ltx_bibblock">“Exploring human-like attention supervision in visual question
answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">AAAI</span>, 2018.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Rowan Zellers, Yonatan Bisk, Ali Farhadi, and Yejin Choi,

</span>
<span class="ltx_bibblock">“From recognition to cognition: Visual commonsense reasoning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">CVPR</span>, June 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova,

</span>
<span class="ltx_bibblock">“Bert: Pre-training of deep bidirectional transformers for language
understanding,”

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">ArXiv</span>, vol. abs/1810.04805, 2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Corentin Dancette, Remi Cadene, Damien Teney, and Matthieu Cord,

</span>
<span class="ltx_bibblock">“Beyond question-based biases: Assessing multimodal shortcut
learning in visual question answering,” 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Yundong Zhang, Juan Carlos Niebles, and Alvaro Soto,

</span>
<span class="ltx_bibblock">“Interpretable visual question answering by visual grounding from
attention supervision mining,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">WACV</span>, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A. Shamma,
Michael S. Bernstein, and Li Fei-Fei,

</span>
<span class="ltx_bibblock">“Visual genome: Connecting language and vision using crowdsourced
dense image annotations,”

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">IJCV</span>, 2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Rowan Zellers, Ximing Lu, Jack Hessel, Youngjae Yu, Jae Sung Park, Jize Cao,
Ali Farhadi, and Yejin Choi,

</span>
<span class="ltx_bibblock">“Merlot: Multimodal neural script knowledge models,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Ramprasaath R. Selvaraju, Purva Tendulkar, Devi Parikh, Eric Horvitz, Marco
Tulio Ribeiro, Besmira Nushi, and Ece Kamar,

</span>
<span class="ltx_bibblock">“Squinting at vqa models: Introspecting vqa models with
sub-questions,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2020.

</span>
</li>
</ul>
</section>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p"></p>
</div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2309.03725" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2309.03726" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2309.03726">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2309.03726" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2309.03727" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 07:13:18 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
